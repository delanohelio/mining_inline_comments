{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1ODczOTI3", "number": 1707, "title": "Fix NettyTransportClient.getCurrentId is not threadsafe(#1705)", "bodyText": "Signed-off-by: cj power4j@outlook.com\nDescribe what this PR does / why we need it\nDoes this pull request fix one issue?\nFixes #1705\nDescribe how you did it\nDescribe how to verify it\nSpecial notes for reviews", "createdAt": "2020-08-30T07:07:07Z", "url": "https://github.com/alibaba/Sentinel/pull/1707", "merged": true, "mergeCommit": {"oid": "34fc435ce5c5aae4c77eb5903c35b9d47e9a89b0"}, "closed": true, "closedAt": "2020-09-14T15:23:01Z", "author": {"login": "John-Chan"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdD4tR8gH2gAyNDc1ODczOTI3OmUzYzUxYWFkYjI0YjJmZDA0Mzk4OTZjODVlYmQ0Nzk2YjExNzg3MjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdI0u5ZgFqTQ4Nzg3NzU0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e3c51aadb24b2fd0439896c85ebd4796b1178723", "author": {"user": {"login": "John-Chan", "name": "cj"}}, "url": "https://github.com/alibaba/Sentinel/commit/e3c51aadb24b2fd0439896c85ebd4796b1178723", "committedDate": "2020-08-30T07:03:09Z", "message": "Fix NettyTransportClient.getCurrentId is not threadsafe(#1705)\n\nSigned-off-by: cj <power4j@outlook.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MTkyMTgz", "url": "https://github.com/alibaba/Sentinel/pull/1707#pullrequestreview-478192183", "createdAt": "2020-08-30T10:50:36Z", "commit": {"oid": "e3c51aadb24b2fd0439896c85ebd4796b1178723"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQxMDo1MDozN1rOHJh2vQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQxMDo1MDozN1rOHJh2vQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTc1MzkxNw==", "bodyText": "In the case of concurrency, if idGenerator.get() bigger than MAX_ID,  idGenerator will not be set(0) forever\u3002", "url": "https://github.com/alibaba/Sentinel/pull/1707#discussion_r479753917", "createdAt": "2020-08-30T10:50:37Z", "author": {"login": "liqiangz"}, "path": "sentinel-cluster/sentinel-cluster-client-default/src/main/java/com/alibaba/csp/sentinel/cluster/client/NettyTransportClient.java", "diffHunk": "@@ -238,9 +238,7 @@ public ClusterResponse sendRequest(ClusterRequest request) throws Exception {\n     }\n \n     private int getCurrentId() {\n-        if (idGenerator.get() > MAX_ID) {\n-            idGenerator.set(0);\n-        }\n+        idGenerator.compareAndSet(MAX_ID, 0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3c51aadb24b2fd0439896c85ebd4796b1178723"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67d011ff652aac3bc90e15531313b1062168ba09", "author": {"user": {"login": "John-Chan", "name": "cj"}}, "url": "https://github.com/alibaba/Sentinel/commit/67d011ff652aac3bc90e15531313b1062168ba09", "committedDate": "2020-08-31T03:22:04Z", "message": "Ensure id increment in range"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3ODc3NTQz", "url": "https://github.com/alibaba/Sentinel/pull/1707#pullrequestreview-487877543", "createdAt": "2020-09-14T15:14:55Z", "commit": {"oid": "67d011ff652aac3bc90e15531313b1062168ba09"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3844, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}