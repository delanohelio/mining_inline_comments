{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5OTc1NjQw", "number": 1678, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwMToxMjoyNVrOEb0cQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwMToxMjoyNVrOEb0cQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3NjA2MjEwOnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-spring-webflux-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/spring/webflux/SentinelWebFluxIntegrationTest.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQwMToxMjoyNVrOHF-djg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMDo1NDowN1rOHHGr-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjAyODMwMg==", "bodyText": "I don't think this url is configured by  the routerFunction way.\nyes, the test case works fine, but it can not prove the adaptor works well with routerFunction.", "url": "https://github.com/alibaba/Sentinel/pull/1678#discussion_r476028302", "createdAt": "2020-08-25T01:12:25Z", "author": {"login": "lawulu"}, "path": "sentinel-adapter/sentinel-spring-webflux-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/spring/webflux/SentinelWebFluxIntegrationTest.java", "diffHunk": "@@ -71,6 +71,30 @@ public void testWebFluxFilterBasic() throws Exception {\n         assertEquals(1, cn.passQps(), 0.01);\n     }\n \n+    @Test\n+    public void testWebFluxRouterFunction() throws Exception {\n+\n+        String url = \"/router/hello\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7c60ade8e229120ede88ee62849e60d81f39c84d"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjA0MTg3NQ==", "bodyText": "PRs are welcomed if there are any unresolved problems.", "url": "https://github.com/alibaba/Sentinel/pull/1678#discussion_r476041875", "createdAt": "2020-08-25T01:33:05Z", "author": {"login": "sczyh30"}, "path": "sentinel-adapter/sentinel-spring-webflux-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/spring/webflux/SentinelWebFluxIntegrationTest.java", "diffHunk": "@@ -71,6 +71,30 @@ public void testWebFluxFilterBasic() throws Exception {\n         assertEquals(1, cn.passQps(), 0.01);\n     }\n \n+    @Test\n+    public void testWebFluxRouterFunction() throws Exception {\n+\n+        String url = \"/router/hello\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjAyODMwMg=="}, "originalCommit": {"oid": "7c60ade8e229120ede88ee62849e60d81f39c84d"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjE5MDg5NA==", "bodyText": "Do you mean run a server like this?@lawulu\nHttpHandler httpHandler = RouterFunctions.toHttpHandler(route);\nHttpServlet servlet = new ServletHttpHandlerAdapter(httpHandler);\nTomcat server = new Tomcat();\nContext rootContext = server.addContext(\"\",\n  System.getProperty(\"java.io.tmpdir\"));\nTomcat.addServlet(rootContext, \"servlet\", servlet);  \nrootContext.addServletMapping(\"/\", \"servlet\");\ntomcatServer.start();", "url": "https://github.com/alibaba/Sentinel/pull/1678#discussion_r476190894", "createdAt": "2020-08-25T05:43:38Z", "author": {"login": "liqiangz"}, "path": "sentinel-adapter/sentinel-spring-webflux-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/spring/webflux/SentinelWebFluxIntegrationTest.java", "diffHunk": "@@ -71,6 +71,30 @@ public void testWebFluxFilterBasic() throws Exception {\n         assertEquals(1, cn.passQps(), 0.01);\n     }\n \n+    @Test\n+    public void testWebFluxRouterFunction() throws Exception {\n+\n+        String url = \"/router/hello\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjAyODMwMg=="}, "originalCommit": {"oid": "7c60ade8e229120ede88ee62849e60d81f39c84d"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIwNzIxNg==", "bodyText": "No\uff0cyou can refer to https://docs.spring.io/spring-framework/docs/5.0.0.BUILD-SNAPSHOT/spring-framework-reference/html/web-reactive.html\nThere is an example:\nRouterFunction<ServerResponse> helloWorldRoute = RouterFunctions.route(RequestPredicates.path(\"/hello-world\"), request -> Response.ok().body(fromObject(\"Hello World\"))); \nIn this way, the  filter based on WebFilter does not work. Users should use HandlerFilterFunction instead.\nUnfortunately, there is no ready solution\u3002 @liqiangz", "url": "https://github.com/alibaba/Sentinel/pull/1678#discussion_r477207216", "createdAt": "2020-08-26T10:45:04Z", "author": {"login": "lawulu"}, "path": "sentinel-adapter/sentinel-spring-webflux-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/spring/webflux/SentinelWebFluxIntegrationTest.java", "diffHunk": "@@ -71,6 +71,30 @@ public void testWebFluxFilterBasic() throws Exception {\n         assertEquals(1, cn.passQps(), 0.01);\n     }\n \n+    @Test\n+    public void testWebFluxRouterFunction() throws Exception {\n+\n+        String url = \"/router/hello\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjAyODMwMg=="}, "originalCommit": {"oid": "7c60ade8e229120ede88ee62849e60d81f39c84d"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIxMTY0MQ==", "bodyText": "Could you please provide a demo for this?", "url": "https://github.com/alibaba/Sentinel/pull/1678#discussion_r477211641", "createdAt": "2020-08-26T10:54:07Z", "author": {"login": "sczyh30"}, "path": "sentinel-adapter/sentinel-spring-webflux-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/spring/webflux/SentinelWebFluxIntegrationTest.java", "diffHunk": "@@ -71,6 +71,30 @@ public void testWebFluxFilterBasic() throws Exception {\n         assertEquals(1, cn.passQps(), 0.01);\n     }\n \n+    @Test\n+    public void testWebFluxRouterFunction() throws Exception {\n+\n+        String url = \"/router/hello\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjAyODMwMg=="}, "originalCommit": {"oid": "7c60ade8e229120ede88ee62849e60d81f39c84d"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4105, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}