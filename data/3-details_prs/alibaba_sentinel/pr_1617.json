{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxMDA0NTk0", "number": 1617, "title": "Fix #1573: Support customized origin parser in Apache Dubbo 2.7.x adapter", "bodyText": "Describe what this PR does / why we need it\n#1573\nDoes this pull request fix one issue?\nSupport customized origin parser in Apache Dubbo 2.7.x adapter\nDescribe how you did it\ncreate DubboOriginParser\uff0cDubboAdapterGlobalConfig\nDescribe how to verify it\nReference DubboFallbackRegistryTest DubboOriginRegistryTest\nSpecial notes for reviews\nBy drawing on #1555 and #1572.", "createdAt": "2020-07-17T10:26:41Z", "url": "https://github.com/alibaba/Sentinel/pull/1617", "merged": true, "mergeCommit": {"oid": "197b7db440185faaffd5a682962fb613777513da"}, "closed": true, "closedAt": "2020-08-19T02:31:41Z", "author": {"login": "JiangZian"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1b0hCAH2gAyNDUxMDA0NTk0OmNiZjNkMjIxYzE0NDNiM2M1ZDQyNjE0OTIzMmFjMTgxMzUwNWE5YTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdASKbZgFqTQ3MDA4MTY1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cbf3d221c1443b3c5d426149232ac1813505a9a5", "author": {"user": {"login": "JiangZian", "name": "M4Y"}}, "url": "https://github.com/alibaba/Sentinel/commit/cbf3d221c1443b3c5d426149232ac1813505a9a5", "committedDate": "2020-07-16T09:28:52Z", "message": "fix #1573"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0bbf5fa88985a6e7a81fc6a1b955ec8b896a9eff", "author": {"user": {"login": "JiangZian", "name": "M4Y"}}, "url": "https://github.com/alibaba/Sentinel/commit/0bbf5fa88985a6e7a81fc6a1b955ec8b896a9eff", "committedDate": "2020-07-17T10:19:08Z", "message": "Refer to the previous scheme and optimize the configuration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95b755fb65bbbacffae7b82fa523f9d5aca34798", "author": {"user": {"login": "JiangZian", "name": "M4Y"}}, "url": "https://github.com/alibaba/Sentinel/commit/95b755fb65bbbacffae7b82fa523f9d5aca34798", "committedDate": "2020-07-20T02:00:08Z", "message": "Polish Dubbo 2.7.x adapter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NzU4Mjkx", "url": "https://github.com/alibaba/Sentinel/pull/1617#pullrequestreview-456758291", "createdAt": "2020-07-28T15:35:09Z", "commit": {"oid": "95b755fb65bbbacffae7b82fa523f9d5aca34798"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTozNTowOVrOG4SiPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTozNTowOVrOG4SiPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY3NzExOA==", "bodyText": "originParse seems a typo, adding Since 1.8.0 can help user who use old verison.\nMaybe the document can refer to #1572", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r461677118", "createdAt": "2020-07-28T15:35:09Z", "author": {"login": "cdfive"}, "path": "sentinel-adapter/sentinel-apache-dubbo-adapter/README.md", "diffHunk": "@@ -65,4 +65,10 @@ flow control, degrade or system load protection. You can implement your own `Dub\n and then register to `DubboFallbackRegistry`. If no fallback is configured, Sentinel will wrap the `BlockException`\n then directly throw it out.\n \n-Besides, we can also leverage [Dubbo mock mechanism](http://dubbo.apache.org/en-us/docs/user/demos/local-mock.html) to provide fallback implementation of degraded Dubbo services.\n\\ No newline at end of file\n+Besides, we can also leverage [Dubbo mock mechanism](http://dubbo.apache.org/en-us/docs/user/demos/local-mock.html) to provide fallback implementation of degraded Dubbo services.\n+\n+## Global dubbo provider origin parse\n+\n+Sentinel Dubbo Adapter supports global origin parse for provider.\n+You can implement your own `DubboOriginParser` interface\n+and then register to `DubboAdapterGlobalConfig`. If no originParse is configured, Sentinel will user dubbo url property application.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b755fb65bbbacffae7b82fa523f9d5aca34798"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NzYxMDYx", "url": "https://github.com/alibaba/Sentinel/pull/1617#pullrequestreview-456761061", "createdAt": "2020-07-28T15:38:12Z", "commit": {"oid": "95b755fb65bbbacffae7b82fa523f9d5aca34798"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTozODoxMlrOG4SqbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQxNTozODoxMlrOG4SqbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTY3OTIxMw==", "bodyText": "getMethodResourceName has prefix configuration function, interfaceResouceName may also need this, and getInterfaceResourceName can be added.Also refer to PR of dubbo-adaptor of 2.6.", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r461679213", "createdAt": "2020-07-28T15:38:12Z", "author": {"login": "cdfive"}, "path": "sentinel-adapter/sentinel-apache-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/DubboUtils.java", "diffHunk": "@@ -57,20 +57,20 @@ public static String getResourceName(Invoker<?> invoker, Invocation invocation,\n         return buf.toString();\n     }\n \n-    public static String getResourceName(Invoker<?> invoker, Invocation invocation, String prefix) {\n+    public static String getMethodResourceName(Invoker<?> invoker, Invocation invocation, String prefix) {\n         if (StringUtil.isNotBlank(prefix)) {\n             return new StringBuilder(64)\n                     .append(prefix)\n-                    .append(getResourceName(invoker, invocation, DubboConfig.getDubboInterfaceGroupAndVersionEnabled()))\n+                    .append(getMethodResourceName(invoker, invocation, DubboAdapterGlobalConfig.getDubboInterfaceGroupAndVersionEnabled()))\n                     .toString();\n         } else {\n-            return getResourceName(invoker, invocation, DubboConfig.getDubboInterfaceGroupAndVersionEnabled());\n+            return getMethodResourceName(invoker, invocation, DubboAdapterGlobalConfig.getDubboInterfaceGroupAndVersionEnabled());\n         }\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b755fb65bbbacffae7b82fa523f9d5aca34798"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce8cd6e43d79eb3744f1a49dd90b1893dbd85a25", "author": {"user": {"login": "JiangZian", "name": "M4Y"}}, "url": "https://github.com/alibaba/Sentinel/commit/ce8cd6e43d79eb3744f1a49dd90b1893dbd85a25", "committedDate": "2020-07-30T08:28:16Z", "message": "add interfaceResouceName with prefix and useGroupAndVersion configuration function"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MTIwODcy", "url": "https://github.com/alibaba/Sentinel/pull/1617#pullrequestreview-465120872", "createdAt": "2020-08-11T14:25:19Z", "commit": {"oid": "ce8cd6e43d79eb3744f1a49dd90b1893dbd85a25"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNDoyNToxOVrOG-6euA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNDoyNToxOVrOG-6euA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODYyMzAzMg==", "bodyText": "A unused import.", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r468623032", "createdAt": "2020-08-11T14:25:19Z", "author": {"login": "cdfive"}, "path": "sentinel-adapter/sentinel-apache-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParser.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n+\n+import com.alibaba.csp.sentinel.context.Context;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce8cd6e43d79eb3744f1a49dd90b1893dbd85a25"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82355873033fafe2c8403c8025b347ea8895ea37", "author": {"user": {"login": "JiangZian", "name": "M4Y"}}, "url": "https://github.com/alibaba/Sentinel/commit/82355873033fafe2c8403c8025b347ea8895ea37", "committedDate": "2020-08-12T01:23:02Z", "message": "fix a unused import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3Mjg0NTIy", "url": "https://github.com/alibaba/Sentinel/pull/1617#pullrequestreview-467284522", "createdAt": "2020-08-14T03:29:27Z", "commit": {"oid": "82355873033fafe2c8403c8025b347ea8895ea37"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQwMzoyOToyN1rOHAmT4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQwMzoyOToyN1rOHAmT4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDM4OTcyOQ==", "bodyText": "If redirect registry related logic to DubboAdapterGlobalConfig:\n\nThese static internal variables should be removed.\nThis legacy registry should be marked as deprecated and add more comments.", "url": "https://github.com/alibaba/Sentinel/pull/1617#discussion_r470389729", "createdAt": "2020-08-14T03:29:27Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/fallback/DubboFallbackRegistry.java", "diffHunk": "@@ -33,21 +34,21 @@\n     private static volatile DubboFallback providerFallback = new DefaultDubboFallback();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82355873033fafe2c8403c8025b347ea8895ea37"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "549d35a4336a341ab515576a896dc51882ff8715", "author": {"user": {"login": "JiangZian", "name": "M4Y"}}, "url": "https://github.com/alibaba/Sentinel/commit/549d35a4336a341ab515576a896dc51882ff8715", "committedDate": "2020-08-17T02:06:25Z", "message": "Get rid of unwanted dependencies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwMDc5NDMw", "url": "https://github.com/alibaba/Sentinel/pull/1617#pullrequestreview-470079430", "createdAt": "2020-08-19T02:18:43Z", "commit": {"oid": "549d35a4336a341ab515576a896dc51882ff8715"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwMDgxNjU0", "url": "https://github.com/alibaba/Sentinel/pull/1617#pullrequestreview-470081654", "createdAt": "2020-08-19T02:26:55Z", "commit": {"oid": "549d35a4336a341ab515576a896dc51882ff8715"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4000, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}