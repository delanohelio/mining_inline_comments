{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzODQzMDEw", "number": 1455, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjowNjoyNVrOEEhHCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjo1Mjo0M1rOEEhhdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMTcyMjMyOnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjowNjoyNVrOGiMGMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNDo0NDo0N1rOGvBfTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwMjk2Mw==", "bodyText": "custom should be customize", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r438502963", "createdAt": "2020-06-11T02:06:25Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "diffHunk": "@@ -0,0 +1,64 @@\n+# Sentinel Apache Httpclient Adapter\n+\n+## Introduction\n+\n+Sentinel provides integration for OkHttp client to enable flow control for web requests.\n+\n+Add the following dependency in `pom.xml` (if you are using Maven):\n+\n+```xml\n+<dependency>\n+    <groupId>com.alibaba.csp</groupId>\n+    <artifactId>sentinel-apache-httpclient-adapter</artifactId>\n+    <version>x.y.z</version>\n+</dependency>\n+```\n+\n+We can use the `SentinelApacheHttpClientBuilder` when `CloseableHttpClient` at initialization, for example:\n+\n+```java\n+CloseableHttpClient httpclient = new SentinelApacheHttpClientBuilder().build();\n+```\n+\n+## Configuration\n+\n+- `SentinelApacheHttpClientConfig` configuration:\n+\n+| name | description | type | default value |\n+|------|------------|------|-------|\n+| prefix | custom resource prefix | `String` | `httpclient:` |\n+| extractor | custom resource extractor | `ApacheHttpClientResourceExtractor` | `DefaultApacheHttpClientResourceExtractor` |\n+| fallback | handle request when it is blocked | `ApacheHttpClientFallback` | `DefaultApacheHttpClientFallback` |\n+\n+### extractor (resource extractor)\n+\n+We can define `ApacheHttpClientResourceExtractor` to custom resource extractor replace `DefaultApacheHttpClientResourceExtractor`, for example: httpclient:GET:/httpclient/back/1 ==> httpclient:GET:/httpclient/back/{id}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk2MDY1Mw==", "bodyText": "fixed", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r451960653", "createdAt": "2020-07-09T04:44:47Z", "author": {"login": "zhaoyuguang"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "diffHunk": "@@ -0,0 +1,64 @@\n+# Sentinel Apache Httpclient Adapter\n+\n+## Introduction\n+\n+Sentinel provides integration for OkHttp client to enable flow control for web requests.\n+\n+Add the following dependency in `pom.xml` (if you are using Maven):\n+\n+```xml\n+<dependency>\n+    <groupId>com.alibaba.csp</groupId>\n+    <artifactId>sentinel-apache-httpclient-adapter</artifactId>\n+    <version>x.y.z</version>\n+</dependency>\n+```\n+\n+We can use the `SentinelApacheHttpClientBuilder` when `CloseableHttpClient` at initialization, for example:\n+\n+```java\n+CloseableHttpClient httpclient = new SentinelApacheHttpClientBuilder().build();\n+```\n+\n+## Configuration\n+\n+- `SentinelApacheHttpClientConfig` configuration:\n+\n+| name | description | type | default value |\n+|------|------------|------|-------|\n+| prefix | custom resource prefix | `String` | `httpclient:` |\n+| extractor | custom resource extractor | `ApacheHttpClientResourceExtractor` | `DefaultApacheHttpClientResourceExtractor` |\n+| fallback | handle request when it is blocked | `ApacheHttpClientFallback` | `DefaultApacheHttpClientFallback` |\n+\n+### extractor (resource extractor)\n+\n+We can define `ApacheHttpClientResourceExtractor` to custom resource extractor replace `DefaultApacheHttpClientResourceExtractor`, for example: httpclient:GET:/httpclient/back/1 ==> httpclient:GET:/httpclient/back/{id}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwMjk2Mw=="}, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMTcyODkwOnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjoxMDo1OVrOGiMKPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNDo0NDo1MlrOGvBfaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwMzk5OQ==", "bodyText": "It may be better if we pointed out that SentinelApacheHttpClientBuilder was a fully functioned  client builder,\nor we can produce a best practice example. (timeouts, configuration, etc)", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r438503999", "createdAt": "2020-06-11T02:10:59Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "diffHunk": "@@ -0,0 +1,64 @@\n+# Sentinel Apache Httpclient Adapter\n+\n+## Introduction\n+\n+Sentinel provides integration for OkHttp client to enable flow control for web requests.\n+\n+Add the following dependency in `pom.xml` (if you are using Maven):\n+\n+```xml\n+<dependency>\n+    <groupId>com.alibaba.csp</groupId>\n+    <artifactId>sentinel-apache-httpclient-adapter</artifactId>\n+    <version>x.y.z</version>\n+</dependency>\n+```\n+\n+We can use the `SentinelApacheHttpClientBuilder` when `CloseableHttpClient` at initialization, for example:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk2MDY4MA==", "bodyText": "fixed", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r451960680", "createdAt": "2020-07-09T04:44:52Z", "author": {"login": "zhaoyuguang"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "diffHunk": "@@ -0,0 +1,64 @@\n+# Sentinel Apache Httpclient Adapter\n+\n+## Introduction\n+\n+Sentinel provides integration for OkHttp client to enable flow control for web requests.\n+\n+Add the following dependency in `pom.xml` (if you are using Maven):\n+\n+```xml\n+<dependency>\n+    <groupId>com.alibaba.csp</groupId>\n+    <artifactId>sentinel-apache-httpclient-adapter</artifactId>\n+    <version>x.y.z</version>\n+</dependency>\n+```\n+\n+We can use the `SentinelApacheHttpClientBuilder` when `CloseableHttpClient` at initialization, for example:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwMzk5OQ=="}, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMTczMTE5OnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjoxMjozOFrOGiMLrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNDo0NDo1NlrOGvBfdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwNDM2Ng==", "bodyText": "It's not a regular expression but a PREFIX. Better to fix the naming and replace contains with startsWith.", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r438504366", "createdAt": "2020-06-11T02:12:38Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "diffHunk": "@@ -0,0 +1,64 @@\n+# Sentinel Apache Httpclient Adapter\n+\n+## Introduction\n+\n+Sentinel provides integration for OkHttp client to enable flow control for web requests.\n+\n+Add the following dependency in `pom.xml` (if you are using Maven):\n+\n+```xml\n+<dependency>\n+    <groupId>com.alibaba.csp</groupId>\n+    <artifactId>sentinel-apache-httpclient-adapter</artifactId>\n+    <version>x.y.z</version>\n+</dependency>\n+```\n+\n+We can use the `SentinelApacheHttpClientBuilder` when `CloseableHttpClient` at initialization, for example:\n+\n+```java\n+CloseableHttpClient httpclient = new SentinelApacheHttpClientBuilder().build();\n+```\n+\n+## Configuration\n+\n+- `SentinelApacheHttpClientConfig` configuration:\n+\n+| name | description | type | default value |\n+|------|------------|------|-------|\n+| prefix | custom resource prefix | `String` | `httpclient:` |\n+| extractor | custom resource extractor | `ApacheHttpClientResourceExtractor` | `DefaultApacheHttpClientResourceExtractor` |\n+| fallback | handle request when it is blocked | `ApacheHttpClientFallback` | `DefaultApacheHttpClientFallback` |\n+\n+### extractor (resource extractor)\n+\n+We can define `ApacheHttpClientResourceExtractor` to custom resource extractor replace `DefaultApacheHttpClientResourceExtractor`, for example: httpclient:GET:/httpclient/back/1 ==> httpclient:GET:/httpclient/back/{id}\n+\n+```java\n+SentinelApacheHttpClientConfig.setExtractor(new ApacheHttpClientResourceExtractor() {\n+\n+    @Override\n+    public String extractor(String method, String uri, HttpRequestWrapper request) {\n+        String regex = \"/httpclient/back/\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk2MDY5Mw==", "bodyText": "fixed", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r451960693", "createdAt": "2020-07-09T04:44:56Z", "author": {"login": "zhaoyuguang"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "diffHunk": "@@ -0,0 +1,64 @@\n+# Sentinel Apache Httpclient Adapter\n+\n+## Introduction\n+\n+Sentinel provides integration for OkHttp client to enable flow control for web requests.\n+\n+Add the following dependency in `pom.xml` (if you are using Maven):\n+\n+```xml\n+<dependency>\n+    <groupId>com.alibaba.csp</groupId>\n+    <artifactId>sentinel-apache-httpclient-adapter</artifactId>\n+    <version>x.y.z</version>\n+</dependency>\n+```\n+\n+We can use the `SentinelApacheHttpClientBuilder` when `CloseableHttpClient` at initialization, for example:\n+\n+```java\n+CloseableHttpClient httpclient = new SentinelApacheHttpClientBuilder().build();\n+```\n+\n+## Configuration\n+\n+- `SentinelApacheHttpClientConfig` configuration:\n+\n+| name | description | type | default value |\n+|------|------------|------|-------|\n+| prefix | custom resource prefix | `String` | `httpclient:` |\n+| extractor | custom resource extractor | `ApacheHttpClientResourceExtractor` | `DefaultApacheHttpClientResourceExtractor` |\n+| fallback | handle request when it is blocked | `ApacheHttpClientFallback` | `DefaultApacheHttpClientFallback` |\n+\n+### extractor (resource extractor)\n+\n+We can define `ApacheHttpClientResourceExtractor` to custom resource extractor replace `DefaultApacheHttpClientResourceExtractor`, for example: httpclient:GET:/httpclient/back/1 ==> httpclient:GET:/httpclient/back/{id}\n+\n+```java\n+SentinelApacheHttpClientConfig.setExtractor(new ApacheHttpClientResourceExtractor() {\n+\n+    @Override\n+    public String extractor(String method, String uri, HttpRequestWrapper request) {\n+        String regex = \"/httpclient/back/\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwNDM2Ng=="}, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMTc2MTMyOnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/extractor/ApacheHttpClientResourceExtractor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjozMzowOVrOGiMfBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNDo0NToyNVrOGvBgIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwOTMxNg==", "bodyText": "In my opinion both parameter #1 and #2 has been wrapped in parameter #3 they are unnecessary.", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r438509316", "createdAt": "2020-06-11T02:33:09Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/extractor/ApacheHttpClientResourceExtractor.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor;\n+\n+import org.apache.http.client.methods.HttpRequestWrapper;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public interface ApacheHttpClientResourceExtractor {\n+\n+    String extractor(String method, String uri, HttpRequestWrapper request);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk2MDg2NA==", "bodyText": "The first & two parameters are removed", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r451960864", "createdAt": "2020-07-09T04:45:25Z", "author": {"login": "zhaoyuguang"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/extractor/ApacheHttpClientResourceExtractor.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor;\n+\n+import org.apache.http.client.methods.HttpRequestWrapper;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public interface ApacheHttpClientResourceExtractor {\n+\n+    String extractor(String method, String uri, HttpRequestWrapper request);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUwOTMxNg=="}, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMTc3NjgwOnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/config/SentinelApacheHttpClientConfig.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjo0NDoxMVrOGiMo9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNDo0NTo0NFrOGvBgbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMTg2MQ==", "bodyText": "The design for additional configuration is quite straightforward. We can't have different configurations between different clients in this design.\nAdapters should follow the ways what they are adapted to follow. HttpClient way is that we can do kinds of decoration, configurations of sockets / interpreters / connection manager / etc. , before we generate the client instance while the client will focus on executing requests. So we should follow this design instead of global shared configuration. It should be extended as new methods of SentinelApacheHttpClientBuilder.", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r438511861", "createdAt": "2020-06-11T02:44:11Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/config/SentinelApacheHttpClientConfig.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.apache.httpclient.config;\n+\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor.ApacheHttpClientResourceExtractor;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor.DefaultApacheHttpClientResourceExtractor;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.fallback.ApacheHttpClientFallback;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.fallback.DefaultApacheHttpClientFallback;\n+import com.alibaba.csp.sentinel.util.AssertUtil;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public final class SentinelApacheHttpClientConfig {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk2MDk0MA==", "bodyText": "Converted to an internal property of the Builder", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r451960940", "createdAt": "2020-07-09T04:45:44Z", "author": {"login": "zhaoyuguang"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/config/SentinelApacheHttpClientConfig.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.apache.httpclient.config;\n+\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor.ApacheHttpClientResourceExtractor;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor.DefaultApacheHttpClientResourceExtractor;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.fallback.ApacheHttpClientFallback;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.fallback.DefaultApacheHttpClientFallback;\n+import com.alibaba.csp.sentinel.util.AssertUtil;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public final class SentinelApacheHttpClientConfig {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMTg2MQ=="}, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMTc3ODAyOnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/config/SentinelApacheHttpClientConfig.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjo0NTowNVrOGiMpsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNjoxMzoxMlrOGvDBIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMjA1MQ==", "bodyText": "And surely we will not need the default ones if we implement it as per instance configuration.", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r438512051", "createdAt": "2020-06-11T02:45:05Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/config/SentinelApacheHttpClientConfig.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.apache.httpclient.config;\n+\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor.ApacheHttpClientResourceExtractor;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor.DefaultApacheHttpClientResourceExtractor;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.fallback.ApacheHttpClientFallback;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.fallback.DefaultApacheHttpClientFallback;\n+import com.alibaba.csp.sentinel.util.AssertUtil;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public final class SentinelApacheHttpClientConfig {\n+\n+    private static volatile String prefix = \"httpclient:\";\n+    private static volatile ApacheHttpClientResourceExtractor extractor = new DefaultApacheHttpClientResourceExtractor();\n+    private static volatile ApacheHttpClientFallback fallback = new DefaultApacheHttpClientFallback();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk4NTY5OQ==", "bodyText": "Converted to an internal property of the Builder", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r451985699", "createdAt": "2020-07-09T06:13:12Z", "author": {"login": "zhaoyuguang"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/config/SentinelApacheHttpClientConfig.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.apache.httpclient.config;\n+\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor.ApacheHttpClientResourceExtractor;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor.DefaultApacheHttpClientResourceExtractor;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.fallback.ApacheHttpClientFallback;\n+import com.alibaba.csp.sentinel.adapter.apache.httpclient.fallback.DefaultApacheHttpClientFallback;\n+import com.alibaba.csp.sentinel.util.AssertUtil;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public final class SentinelApacheHttpClientConfig {\n+\n+    private static volatile String prefix = \"httpclient:\";\n+    private static volatile ApacheHttpClientResourceExtractor extractor = new DefaultApacheHttpClientResourceExtractor();\n+    private static volatile ApacheHttpClientFallback fallback = new DefaultApacheHttpClientFallback();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMjA1MQ=="}, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMTc4MjI1OnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjo0NzozNFrOGiMsWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNjoxMjo1M1rOGvDArw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMjcyOQ==", "bodyText": "Better to provide a CloseableHttpResponse example here and consider whether it's necessary to provide a default implementation of CloseableHttpResponse because it's only an interface.", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r438512729", "createdAt": "2020-06-11T02:47:34Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "diffHunk": "@@ -0,0 +1,64 @@\n+# Sentinel Apache Httpclient Adapter\n+\n+## Introduction\n+\n+Sentinel provides integration for OkHttp client to enable flow control for web requests.\n+\n+Add the following dependency in `pom.xml` (if you are using Maven):\n+\n+```xml\n+<dependency>\n+    <groupId>com.alibaba.csp</groupId>\n+    <artifactId>sentinel-apache-httpclient-adapter</artifactId>\n+    <version>x.y.z</version>\n+</dependency>\n+```\n+\n+We can use the `SentinelApacheHttpClientBuilder` when `CloseableHttpClient` at initialization, for example:\n+\n+```java\n+CloseableHttpClient httpclient = new SentinelApacheHttpClientBuilder().build();\n+```\n+\n+## Configuration\n+\n+- `SentinelApacheHttpClientConfig` configuration:\n+\n+| name | description | type | default value |\n+|------|------------|------|-------|\n+| prefix | custom resource prefix | `String` | `httpclient:` |\n+| extractor | custom resource extractor | `ApacheHttpClientResourceExtractor` | `DefaultApacheHttpClientResourceExtractor` |\n+| fallback | handle request when it is blocked | `ApacheHttpClientFallback` | `DefaultApacheHttpClientFallback` |\n+\n+### extractor (resource extractor)\n+\n+We can define `ApacheHttpClientResourceExtractor` to custom resource extractor replace `DefaultApacheHttpClientResourceExtractor`, for example: httpclient:GET:/httpclient/back/1 ==> httpclient:GET:/httpclient/back/{id}\n+\n+```java\n+SentinelApacheHttpClientConfig.setExtractor(new ApacheHttpClientResourceExtractor() {\n+\n+    @Override\n+    public String extractor(String method, String uri, HttpRequestWrapper request) {\n+        String regex = \"/httpclient/back/\";\n+        if (uri.contains(regex)) {\n+            uri = uri.substring(0, uri.indexOf(regex) + regex.length()) + \"{id}\";\n+        }\n+        return method + \":\" + uri;\n+    }\n+});\n+```\n+\n+### fallback (Block handling)\n+\n+We can define `ApacheHttpClientFallback` to handle request is blocked according to the actual scenario, for example:\n+\n+```java\n+public class DefaultApacheHttpClientFallback implements ApacheHttpClientFallback {\n+\n+    @Override\n+    public CloseableHttpResponse handle(HttpRequestWrapper request, BlockException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk4NTU4Mw==", "bodyText": "fallback just  a demo", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r451985583", "createdAt": "2020-07-09T06:12:53Z", "author": {"login": "zhaoyuguang"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/README.md", "diffHunk": "@@ -0,0 +1,64 @@\n+# Sentinel Apache Httpclient Adapter\n+\n+## Introduction\n+\n+Sentinel provides integration for OkHttp client to enable flow control for web requests.\n+\n+Add the following dependency in `pom.xml` (if you are using Maven):\n+\n+```xml\n+<dependency>\n+    <groupId>com.alibaba.csp</groupId>\n+    <artifactId>sentinel-apache-httpclient-adapter</artifactId>\n+    <version>x.y.z</version>\n+</dependency>\n+```\n+\n+We can use the `SentinelApacheHttpClientBuilder` when `CloseableHttpClient` at initialization, for example:\n+\n+```java\n+CloseableHttpClient httpclient = new SentinelApacheHttpClientBuilder().build();\n+```\n+\n+## Configuration\n+\n+- `SentinelApacheHttpClientConfig` configuration:\n+\n+| name | description | type | default value |\n+|------|------------|------|-------|\n+| prefix | custom resource prefix | `String` | `httpclient:` |\n+| extractor | custom resource extractor | `ApacheHttpClientResourceExtractor` | `DefaultApacheHttpClientResourceExtractor` |\n+| fallback | handle request when it is blocked | `ApacheHttpClientFallback` | `DefaultApacheHttpClientFallback` |\n+\n+### extractor (resource extractor)\n+\n+We can define `ApacheHttpClientResourceExtractor` to custom resource extractor replace `DefaultApacheHttpClientResourceExtractor`, for example: httpclient:GET:/httpclient/back/1 ==> httpclient:GET:/httpclient/back/{id}\n+\n+```java\n+SentinelApacheHttpClientConfig.setExtractor(new ApacheHttpClientResourceExtractor() {\n+\n+    @Override\n+    public String extractor(String method, String uri, HttpRequestWrapper request) {\n+        String regex = \"/httpclient/back/\";\n+        if (uri.contains(regex)) {\n+            uri = uri.substring(0, uri.indexOf(regex) + regex.length()) + \"{id}\";\n+        }\n+        return method + \":\" + uri;\n+    }\n+});\n+```\n+\n+### fallback (Block handling)\n+\n+We can define `ApacheHttpClientFallback` to handle request is blocked according to the actual scenario, for example:\n+\n+```java\n+public class DefaultApacheHttpClientFallback implements ApacheHttpClientFallback {\n+\n+    @Override\n+    public CloseableHttpResponse handle(HttpRequestWrapper request, BlockException e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMjcyOQ=="}, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMTc4NjA1OnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/extractor/DefaultApacheHttpClientResourceExtractor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjo1MDoxNlrOGiMuzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOVQwNjoxMjozMlrOGvDAQQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMzM1Nw==", "bodyText": "As the default implementation i can't quite agree with including METHOD in resource name.\nPlease go for advices from other reviewers, too.", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r438513357", "createdAt": "2020-06-11T02:50:16Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/extractor/DefaultApacheHttpClientResourceExtractor.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor;\n+\n+import org.apache.http.client.methods.HttpRequestWrapper;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public class DefaultApacheHttpClientResourceExtractor implements ApacheHttpClientResourceExtractor {\n+\n+    @Override\n+    public String extractor(String method, String uri, HttpRequestWrapper request) {\n+        return method + \":\" + uri;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTk4NTQ3Mw==", "bodyText": "method  has remove", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r451985473", "createdAt": "2020-07-09T06:12:32Z", "author": {"login": "zhaoyuguang"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/extractor/DefaultApacheHttpClientResourceExtractor.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.apache.httpclient.extractor;\n+\n+import org.apache.http.client.methods.HttpRequestWrapper;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public class DefaultApacheHttpClientResourceExtractor implements ApacheHttpClientResourceExtractor {\n+\n+    @Override\n+    public String extractor(String method, String uri, HttpRequestWrapper request) {\n+        return method + \":\" + uri;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMzM1Nw=="}, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMTc4OTk3OnYy", "diffSide": "RIGHT", "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/fallback/DefaultApacheHttpClientFallback.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjo1Mjo0M1rOGiMxNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQwMjo1Mjo0M1rOGiMxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODUxMzk3NA==", "bodyText": "I suggest that Exception propagation can be implemented in the customized chain directly.", "url": "https://github.com/alibaba/Sentinel/pull/1455#discussion_r438513974", "createdAt": "2020-06-11T02:52:43Z", "author": {"login": "jasonjoo2010"}, "path": "sentinel-adapter/sentinel-apache-httpclient-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/apache/httpclient/fallback/DefaultApacheHttpClientFallback.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.apache.httpclient.fallback;\n+\n+import com.alibaba.csp.sentinel.slots.block.BlockException;\n+import com.alibaba.csp.sentinel.slots.block.SentinelRpcException;\n+import org.apache.http.HttpException;\n+import org.apache.http.HttpRequest;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpRequestWrapper;\n+import org.apache.http.protocol.HttpContext;\n+\n+import java.io.IOException;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public class DefaultApacheHttpClientFallback implements ApacheHttpClientFallback {\n+\n+    @Override\n+    public CloseableHttpResponse handle(HttpRequestWrapper request, BlockException e) {\n+        // Just wrap and throw the exception.\n+        throw new SentinelRpcException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4501ae832d7677def1d504fdb630d8a7c2cd2e82"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4166, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}