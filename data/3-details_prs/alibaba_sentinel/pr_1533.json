{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMxMjMxNjQw", "number": 1533, "title": "webmvc-adapter: improve set entry in request to avoid ErrorEntryFreeException", "bodyText": "Describe what this PR does / why we need it\nThe AbstractSentinelInterceptor of sentinel-spring-webmvc-adapter may enter twice under some circumstances, such no view page exists\nDoes this pull request fix one issue?\nRelate to #1531, #1482\nDescribe how you did it\nRefator setEntryInRequest method, if attribute key already exists in request, we don't call SphU.entry to create Entry, then Entry get from request can exit normally in afterCompletion method.\nDescribe how to verify it\nAdd a tmp test Controller in sentinel-demo-spring-webmvc to verify if it works.\n@Controller\n@RequestMapping(\"/\")\npublic class TmpTestController {\n\n    @RequestMapping(\"/view_not_exists\")\n    public String view_not_exists() {\n        return \"/view_not_exists.html\";\n    }\n}\nSpecial notes for reviews\nThe tmp test Controller is used for debug and test, so it has not been committed.", "createdAt": "2020-06-08T15:42:13Z", "url": "https://github.com/alibaba/Sentinel/pull/1533", "merged": true, "mergeCommit": {"oid": "a1ce97677c4883efa576fcfbb3ec4962b2989cf4"}, "closed": true, "closedAt": "2020-08-19T15:55:12Z", "author": {"login": "cdfive"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcpSNOlgH2gAyNDMxMjMxNjQwOjk1ZjUwZTNlZDIxMjIwZWM1ZDc0ZTEyYmM0NDA2NmNiZDZlY2IzZTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAdrG3AFqTQ3MDU5NTc2Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "95f50e3ed21220ec5d74e12bc44066cbd6ecb3e9", "author": {"user": {"login": "cdfive", "name": null}}, "url": "https://github.com/alibaba/Sentinel/commit/95f50e3ed21220ec5d74e12bc44066cbd6ecb3e9", "committedDate": "2020-06-08T15:29:43Z", "message": "If attribute key already exists in request, don't create entry to avoid ErrorEntryFreeException"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NzMwOTI2", "url": "https://github.com/alibaba/Sentinel/pull/1533#pullrequestreview-459730926", "createdAt": "2020-08-03T03:39:50Z", "commit": {"oid": "95f50e3ed21220ec5d74e12bc44066cbd6ecb3e9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwMzozOTo1MFrOG6rNfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwMzozOTo1MFrOG6rNfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE3ODU1Ng==", "bodyText": "Could you please add some comments regarding the related issue?", "url": "https://github.com/alibaba/Sentinel/pull/1533#discussion_r464178556", "createdAt": "2020-08-03T03:39:50Z", "author": {"login": "sczyh30"}, "path": "sentinel-adapter/sentinel-spring-webmvc-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/spring/webmvc/AbstractSentinelInterceptor.java", "diffHunk": "@@ -110,12 +108,13 @@ public void postHandle(HttpServletRequest request, HttpServletResponse response,\n                            ModelAndView modelAndView) throws Exception {\n     }\n \n-    protected void setEntryInRequest(HttpServletRequest request, String name, Entry entry) {\n+    protected void setEntryInRequest(HttpServletRequest request, String name, String resourceName) throws BlockException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95f50e3ed21220ec5d74e12bc44066cbd6ecb3e9"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bd0ccf49041950919df663254cb107400c39069", "author": {"user": {"login": "cdfive", "name": null}}, "url": "https://github.com/alibaba/Sentinel/commit/9bd0ccf49041950919df663254cb107400c39069", "committedDate": "2020-08-03T15:28:58Z", "message": "Add comments and related issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNTk1NzY3", "url": "https://github.com/alibaba/Sentinel/pull/1533#pullrequestreview-470595767", "createdAt": "2020-08-19T15:51:35Z", "commit": {"oid": "9bd0ccf49041950919df663254cb107400c39069"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3970, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}