{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5MDU3MDIz", "number": 1042, "title": "OKAPI-945: Document dockerRegistries [] and [ {} ]", "bodyText": "[] is zero registries and disables pull requests.\n[{}] is unauthenticated DockerHub.", "createdAt": "2020-11-11T09:06:19Z", "url": "https://github.com/folio-org/okapi/pull/1042", "merged": true, "mergeCommit": {"oid": "7844da7e16bfc6cdb612200a96fa10e04142e616"}, "closed": true, "closedAt": "2020-11-16T15:51:54Z", "author": {"login": "julianladisch"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbaKrRgH2gAyNTE5MDU3MDIzOjI3YzgzMDBlYTExYTM3ZTdjNzQzZTJlNzAyMjM5YTcyMTE0Mzc3ZjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddGyWgAH2gAyNTE5MDU3MDIzOmVjYjgzNjc3ZmZhM2YyYzk5YTMwMGRkYWE3MzhhZGQyZjQ4Yzc3NzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "27c8300ea11a37e7c743e2e702239a72114377f2", "author": {"user": {"login": "julianladisch", "name": null}}, "url": "https://github.com/folio-org/okapi/commit/27c8300ea11a37e7c743e2e702239a72114377f2", "committedDate": "2020-11-11T09:02:23Z", "message": "OKAPI-945: Document dockerRegistries [] and [ {} ]\n\n[] is zero registries and disables pull requests.\n[{}] is unauthenticated DockerHub."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fb3c475d033ec0e7de996fe7c4f38bc2d02faf1", "author": {"user": {"login": "julianladisch", "name": null}}, "url": "https://github.com/folio-org/okapi/commit/4fb3c475d033ec0e7de996fe7c4f38bc2d02faf1", "committedDate": "2020-11-11T09:17:30Z", "message": "Avoid line wrap"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MTM4NjM4", "url": "https://github.com/folio-org/okapi/pull/1042#pullrequestreview-528138638", "createdAt": "2020-11-11T12:44:04Z", "commit": {"oid": "4fb3c475d033ec0e7de996fe7c4f38bc2d02faf1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MTg4MTMy", "url": "https://github.com/folio-org/okapi/pull/1042#pullrequestreview-528188132", "createdAt": "2020-11-11T13:51:05Z", "commit": {"oid": "27c8300ea11a37e7c743e2e702239a72114377f2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxMzo1MTowNVrOHxN-qA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMVQxMzo1MTowNVrOHxN-qA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTM3MTMwNA==", "bodyText": "I think it's better to assign a message for this by adding an entry in okapi-core/src/main/resources/infra-messages/Messages_en.properties", "url": "https://github.com/folio-org/okapi/pull/1042#discussion_r521371304", "createdAt": "2020-11-11T13:51:05Z", "author": {"login": "adamdickmeiss"}, "path": "okapi-core/src/main/java/org/folio/okapi/service/impl/DockerModuleHandle.java", "diffHunk": "@@ -37,6 +37,10 @@\n @java.lang.SuppressWarnings({\"squid:S1192\"})\n public class DockerModuleHandle implements ModuleHandle {\n \n+  static final String DOCKER_REGISTRIES_EMPTY_LIST =\n+      \"dockerRegistries=[] contains no registry and disables docker pull. \"\n+          + \"For unauthenticated pull from DockerHub use [ {} ].\";\n+\n   private final Logger logger;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27c8300ea11a37e7c743e2e702239a72114377f2"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4NDE4NTYx", "url": "https://github.com/folio-org/okapi/pull/1042#pullrequestreview-528418561", "createdAt": "2020-11-11T18:10:54Z", "commit": {"oid": "4fb3c475d033ec0e7de996fe7c4f38bc2d02faf1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecba7e210bde6a941544618cf8d574058525989f", "author": {"user": {"login": "wafschneider", "name": "Wayne Schneider"}}, "url": "https://github.com/folio-org/okapi/commit/ecba7e210bde6a941544618cf8d574058525989f", "committedDate": "2020-11-11T18:50:02Z", "message": "Align default behavior in dist/okapi.sh with documented behavior for dockerRegistries."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4ODIxMzA1", "url": "https://github.com/folio-org/okapi/pull/1042#pullrequestreview-528821305", "createdAt": "2020-11-12T07:51:20Z", "commit": {"oid": "ecba7e210bde6a941544618cf8d574058525989f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af2262a1a42e2eedc1262352c6701265dae7874b", "author": {"user": {"login": "julianladisch", "name": null}}, "url": "https://github.com/folio-org/okapi/commit/af2262a1a42e2eedc1262352c6701265dae7874b", "committedDate": "2020-11-12T12:04:25Z", "message": "Quote \"${docker_registries:-[\\{\\}]}\", exit on JSON failure"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MjIwMzY4", "url": "https://github.com/folio-org/okapi/pull/1042#pullrequestreview-529220368", "createdAt": "2020-11-12T15:45:12Z", "commit": {"oid": "af2262a1a42e2eedc1262352c6701265dae7874b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNTo0NToxMlrOHyA81w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNTo0NToxMlrOHyA81w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjIwNjQyMw==", "bodyText": "@julianladisch in my testing using Ubuntu Focal, if $docker_registries is undefined, this fails if quoted (though it works if $docker_registries is defined). I confess I'm not sure why. Did it work in your testing?", "url": "https://github.com/folio-org/okapi/pull/1042#discussion_r522206423", "createdAt": "2020-11-12T15:45:12Z", "author": {"login": "wafschneider"}, "path": "dist/okapi.sh", "diffHunk": "@@ -46,7 +53,7 @@ parse_okapi_conf()  {\n          chmod 600 \"${PID_DIR}/okapi-runtime.conf\"\n          # include postgres connection arguments only if defined\n          jq -n --arg WARNING \"AUTOMATICALLY CREATED FILE, DO NOT EDIT!\"    \\\n-               --argjson dockerRegistries  ${docker_registries:-[\\{\\}]}    \\\n+               --argjson dockerRegistries  \"${docker_registries:-[\\{\\}]}\"  \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af2262a1a42e2eedc1262352c6701265dae7874b"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7643807fb9b8ccb864c3c92262b5b59f1a1baf00", "author": {"user": {"login": "julianladisch", "name": null}}, "url": "https://github.com/folio-org/okapi/commit/7643807fb9b8ccb864c3c92262b5b59f1a1baf00", "committedDate": "2020-11-16T15:22:36Z", "message": "Fix wrong { masking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecb83677ffa3f2c99a300ddaa738add2f48c7774", "author": {"user": {"login": "julianladisch", "name": null}}, "url": "https://github.com/folio-org/okapi/commit/ecb83677ffa3f2c99a300ddaa738add2f48c7774", "committedDate": "2020-11-16T15:35:28Z", "message": "Merge branch 'master' into OKAPI-945-dockerRegistries-empty-list"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2917, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}