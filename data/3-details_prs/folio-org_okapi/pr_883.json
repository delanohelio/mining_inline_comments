{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2NjgwMTUy", "number": 883, "title": "Okapi 796 reduce decoding module descriptors", "bodyText": "", "createdAt": "2020-02-18T15:24:45Z", "url": "https://github.com/folio-org/okapi/pull/883", "merged": true, "mergeCommit": {"oid": "46224953793f01788dbe271dcba3a7d11e4241a0"}, "closed": true, "closedAt": "2020-02-25T14:39:52Z", "author": {"login": "adamdickmeiss"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFieuRAH2gAyMzc2NjgwMTUyOjYxYTNkMGI3ODk5MTE1OTA0MWUyMmEyY2VjNGIyZjRlNWJiM2RhM2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcHyUYYAFqTM2NDE0Njg3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "61a3d0b78991159041e22a2cec4b2f4e5bb3da3a", "author": {"user": {"login": "adamdickmeiss", "name": "Adam Dickmeiss"}}, "url": "https://github.com/folio-org/okapi/commit/61a3d0b78991159041e22a2cec4b2f4e5bb3da3a", "committedDate": "2020-02-18T14:06:02Z", "message": "Fix checked cast warnings WRT CompList tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a451d72f9df79cada5e4b487e45474fa288c4435", "author": {"user": {"login": "adamdickmeiss", "name": "Adam Dickmeiss"}}, "url": "https://github.com/folio-org/okapi/commit/a451d72f9df79cada5e4b487e45474fa288c4435", "committedDate": "2020-02-18T14:59:53Z", "message": "OkapiPerformance on test phase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4ff172ea7b11181e219c49ec0c50e5c5dfd4d0d", "author": {"user": {"login": "adamdickmeiss", "name": "Adam Dickmeiss"}}, "url": "https://github.com/folio-org/okapi/commit/d4ff172ea7b11181e219c49ec0c50e5c5dfd4d0d", "committedDate": "2020-02-18T15:03:12Z", "message": "dumpHeaders when exceeding 2K OKAPI-795"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d607e6eb3d9d89760f9fdbee2f457dc158094541", "author": {"user": {"login": "adamdickmeiss", "name": "Adam Dickmeiss"}}, "url": "https://github.com/folio-org/okapi/commit/d607e6eb3d9d89760f9fdbee2f457dc158094541", "committedDate": "2020-02-18T15:03:12Z", "message": "Cache enabled modules OKAPI-796\n\nModule Descriptors consider immutable."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6397ee87282bb33e2396bf688507425372fb01f1", "author": {"user": {"login": "adamdickmeiss", "name": "Adam Dickmeiss"}}, "url": "https://github.com/folio-org/okapi/commit/6397ee87282bb33e2396bf688507425372fb01f1", "committedDate": "2020-02-18T15:24:24Z", "message": "Merge branch 'master' into okapi-796-reduce-decoding-module-descriptors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMjQ3MDMy", "url": "https://github.com/folio-org/okapi/pull/883#pullrequestreview-363247032", "createdAt": "2020-02-24T09:19:46Z", "commit": {"oid": "6397ee87282bb33e2396bf688507425372fb01f1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwOToxOTo0NlrOFtZmkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwOToxOTo0NlrOFtZmkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzE0OTcxMg==", "bodyText": "Is this a cache? If yes, can you rename it to enabledModulesCache?", "url": "https://github.com/folio-org/okapi/pull/883#discussion_r383149712", "createdAt": "2020-02-24T09:19:46Z", "author": {"login": "julianladisch"}, "path": "okapi-core/src/main/java/org/folio/okapi/managers/ModuleManager.java", "diffHunk": "@@ -38,6 +38,7 @@\n   private String mapName = \"modules\";\n   private LockedTypedMap1<ModuleDescriptor> modules\n     = new LockedTypedMap1<>(ModuleDescriptor.class);\n+  private Map<String,ModuleDescriptor> enabledModules = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6397ee87282bb33e2396bf688507425372fb01f1"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMjQ3ODIz", "url": "https://github.com/folio-org/okapi/pull/883#pullrequestreview-363247823", "createdAt": "2020-02-24T09:21:19Z", "commit": {"oid": "6397ee87282bb33e2396bf688507425372fb01f1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwOToyMToxOVrOFtZo_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwOToyMToxOVrOFtZo_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzE1MDMzMg==", "bodyText": "Is the cache pruned when ModuleManager.update or ModuleManager.delete is called, and are there unit tests for update and delete?", "url": "https://github.com/folio-org/okapi/pull/883#discussion_r383150332", "createdAt": "2020-02-24T09:21:19Z", "author": {"login": "julianladisch"}, "path": "okapi-core/src/main/java/org/folio/okapi/managers/ModuleManager.java", "diffHunk": "@@ -38,6 +38,7 @@\n   private String mapName = \"modules\";\n   private LockedTypedMap1<ModuleDescriptor> modules\n     = new LockedTypedMap1<>(ModuleDescriptor.class);\n+  private Map<String,ModuleDescriptor> enabledModules = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6397ee87282bb33e2396bf688507425372fb01f1"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MDEyMjE3", "url": "https://github.com/folio-org/okapi/pull/883#pullrequestreview-364012217", "createdAt": "2020-02-25T10:02:43Z", "commit": {"oid": "6397ee87282bb33e2396bf688507425372fb01f1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDowMjo0M1rOFt_01w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQxMDowMjo0M1rOFt_01w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mzc3NTk1OQ==", "bodyText": "Can you also change\nif (sz > limit) {\n\nto\nif (sz > limit && logger.isInfoEnabled()) {\n\nand remove the unused StringBuilder from dumpHeaders?", "url": "https://github.com/folio-org/okapi/pull/883#discussion_r383775959", "createdAt": "2020-02-25T10:02:43Z", "author": {"login": "julianladisch"}, "path": "okapi-core/src/main/java/org/folio/okapi/managers/ProxyService.java", "diffHunk": "@@ -685,7 +685,7 @@ private void proxyRequestResponse10(Iterator<ModuleInstance> it,\n \n   private void copyHeaders(HttpClientRequest cReq, RoutingContext ctx, ModuleInstance mi) {\n     int sz = 0;\n-    int limit = 5; // all headers dumped\n+    int limit = 2000; // all headers dumped", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6397ee87282bb33e2396bf688507425372fb01f1"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ea387059e62ef2ce856e5c5a62ffad9d9415446", "author": {"user": {"login": "adamdickmeiss", "name": "Adam Dickmeiss"}}, "url": "https://github.com/folio-org/okapi/commit/5ea387059e62ef2ce856e5c5a62ffad9d9415446", "committedDate": "2020-02-25T12:28:23Z", "message": "Invalidate MD cache entry on DELETE/PUT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56aa6197d8b08b5fcdd9a42a0a7c85249bce54ea", "author": {"user": {"login": "adamdickmeiss", "name": "Adam Dickmeiss"}}, "url": "https://github.com/folio-org/okapi/commit/56aa6197d8b08b5fcdd9a42a0a7c85249bce54ea", "committedDate": "2020-02-25T12:35:13Z", "message": "Changes to header logging"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0MTQ2ODcz", "url": "https://github.com/folio-org/okapi/pull/883#pullrequestreview-364146873", "createdAt": "2020-02-25T13:41:04Z", "commit": {"oid": "56aa6197d8b08b5fcdd9a42a0a7c85249bce54ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2927, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}