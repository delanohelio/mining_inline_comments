{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3NTA5ODkw", "number": 316, "title": "JUnit cleanup", "bodyText": "The project uses JUnit Jupiter 5.4.0, but still has the old JUnit 4.12 in its classpath via transitive dependencies. This leads to the fact that code from JUnit 4.12 can be (and is!) used even though it's not supposed to be, and may break if the transitive dependencies upgrade their own dependencies.\nThis PR cleans up these usages so the test suite uses strictly JUnit Jupiter classes.\nIt includes the following changes (see individual commits for additional details)\n\nRemoves unused JUnit 4 imports\nUses assertions from org.junit.jupiter.api.Assertions instead of org.junit.Assert or junit.framework.TestCase\nIndexerIntegrationTest used JUnit 4's FixMethodOrder annotation to fix the order in which the tests are executed, which did not work, as this annotation is not honored by the JUnit Jupiter runner. Since the test passes and the method order isn't important any more, this annotation was removed.\nKubernetesTest explicitly initialized a KubernetesServer instance, in JUnit 4 style. The test was rewritten to use the modern EnableKubernetesMockClient test extension, and in the process remove some boiler-plate code associated with the KubernetesServer.", "createdAt": "2020-10-04T22:37:45Z", "url": "https://github.com/dedica-team/nivio/pull/316", "merged": true, "mergeCommit": {"oid": "90302acfd550d2808201372c4c964d2f8667cc25"}, "closed": true, "closedAt": "2020-10-05T10:41:00Z", "author": {"login": "mureinik"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPWP2BgH2gAyNDk3NTA5ODkwOmEwOWM5YmJiMzFkMjY3YzZlZTVhZDJlM2Q0YzZjZjc1M2Q1YWQ4NTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPe2SigBqjM4Mzg5OTcwNjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a09c9bbb31d267c6ee5ad2e3d4c6cf753d5ad850", "author": {"user": {"login": "mureinik", "name": "Allon Murienik"}}, "url": "https://github.com/dedica-team/nivio/commit/a09c9bbb31d267c6ee5ad2e3d4c6cf753d5ad850", "committedDate": "2020-10-04T21:41:19Z", "message": "MessagingServiceTest import\n\nRemove an unused org.junit.Before import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNzI0NzU5", "url": "https://github.com/dedica-team/nivio/pull/316#pullrequestreview-501724759", "createdAt": "2020-10-05T05:07:52Z", "commit": {"oid": "6af6577d61f8190f9903ee447553cb567534d2ae"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQwNTowNzo1MlrOHcNyTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQwNTowODozOVrOHcNy8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM0ODA0NQ==", "bodyText": "Thanks for your efforts, but method ordering is not necessary anymore. I've checked that the tests run without it. It also does not make sense anymore because nivio works differently now since when method ordering was introduced.\nI think you can remove it.", "url": "https://github.com/dedica-team/nivio/pull/316#discussion_r499348045", "createdAt": "2020-10-05T05:07:52Z", "author": {"login": "bonndan"}, "path": "src/test/java/de/bonndan/nivio/input/IndexerIntegrationTest.java", "diffHunk": "@@ -30,7 +29,7 @@\n @SpringBootTest\n @ExtendWith(MockitoExtension.class)\n @ActiveProfiles(\"test\")\n-@FixMethodOrder(MethodSorters.NAME_ASCENDING)\n+@TestMethodOrder(Alphanumeric.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6af6577d61f8190f9903ee447553cb567534d2ae"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM0ODIxMQ==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/dedica-team/nivio/pull/316#discussion_r499348211", "createdAt": "2020-10-05T05:08:39Z", "author": {"login": "bonndan"}, "path": "src/test/java/de/bonndan/nivio/input/KubernetesTest.java", "diffHunk": "@@ -18,22 +17,16 @@\n import java.util.List;\n import java.util.Map;\n \n-import static org.junit.Assert.assertNotNull;\n import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n \n+@EnableKubernetesMockClient(crud = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6af6577d61f8190f9903ee447553cb567534d2ae"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8ca6c38ed7a4631e290e3eb322b689f8eb7c49b", "author": {"user": {"login": "mureinik", "name": "Allon Murienik"}}, "url": "https://github.com/dedica-team/nivio/commit/f8ca6c38ed7a4631e290e3eb322b689f8eb7c49b", "committedDate": "2020-10-05T07:41:34Z", "message": "IndexerIntegrationTest: Fix method order\n\nIndexerIntegerationTest is annotated with JUnit 4's\norg.junit.FixMethodOrder, and is intended to have its tests executed\nin an alphabetical order.\n\nHowever, the JUnit Jupiter test runner does not honor this annotation,\nand the order of execution is not alphabetical. Given that the test\npasses regardless of the order and this annotation is not honored\nanyway, it can just be removed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9fb6e7b399d88fe4205d9a6f00ceef9aeceaeef", "author": {"user": {"login": "mureinik", "name": "Allon Murienik"}}, "url": "https://github.com/dedica-team/nivio/commit/b9fb6e7b399d88fe4205d9a6f00ceef9aeceaeef", "committedDate": "2020-10-05T07:42:16Z", "message": "Fix assertions\n\nSome test classes in the project use assertions from JUnit 4's\norg.junit.Assert class, or even junit.framework.TestCase class.\nThis patch cleans up the code and replaces them with the corresponding\nmethods from the modern org.junit.jupiter.api.Assertions."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f3e4e80025f894ca92a6781fb1857c5205463fc", "author": {"user": {"login": "mureinik", "name": "Allon Murienik"}}, "url": "https://github.com/dedica-team/nivio/commit/9f3e4e80025f894ca92a6781fb1857c5205463fc", "committedDate": "2020-10-05T07:42:16Z", "message": "Rewrite KubernetesTest as a JUnit Jupiter exception\n\nBy instantiating an\nio.fabric8.kubernetes.client.server.mock.KubernetesServer object, the\nKubernetesTest implicitly using JUnit 4 classes under the hood.\n\nThis patch replaces that class with the modern\n@EnableKubernetesMockClient extension, allowing for a fully JUnit\nJupiter runtime. As a side bonus, so of the boilerplate code\nassociated with a KubernetesServer is removed, and the test is cleaner\nand easier to maintain."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6af6577d61f8190f9903ee447553cb567534d2ae", "author": {"user": {"login": "mureinik", "name": "Allon Murienik"}}, "url": "https://github.com/dedica-team/nivio/commit/6af6577d61f8190f9903ee447553cb567534d2ae", "committedDate": "2020-10-04T22:05:57Z", "message": "Rewrite KubernetesTest as a JUnit Jupiter exception\n\nBy instantiating an\nio.fabric8.kubernetes.client.server.mock.KubernetesServer object, the\nKubernetesTest implicitly using JUnit 4 classes under the hood.\n\nThis patch replaces that class with the modern\n@EnableKubernetesMockClient extension, allowing for a fully JUnit\nJupiter runtime. As a side bonus, so of the boilerplate code\nassociated with a KubernetesServer is removed, and the test is cleaner\nand easier to maintain."}, "afterCommit": {"oid": "9f3e4e80025f894ca92a6781fb1857c5205463fc", "author": {"user": {"login": "mureinik", "name": "Allon Murienik"}}, "url": "https://github.com/dedica-team/nivio/commit/9f3e4e80025f894ca92a6781fb1857c5205463fc", "committedDate": "2020-10-05T07:42:16Z", "message": "Rewrite KubernetesTest as a JUnit Jupiter exception\n\nBy instantiating an\nio.fabric8.kubernetes.client.server.mock.KubernetesServer object, the\nKubernetesTest implicitly using JUnit 4 classes under the hood.\n\nThis patch replaces that class with the modern\n@EnableKubernetesMockClient extension, allowing for a fully JUnit\nJupiter runtime. As a side bonus, so of the boilerplate code\nassociated with a KubernetesServer is removed, and the test is cleaner\nand easier to maintain."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1898, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}