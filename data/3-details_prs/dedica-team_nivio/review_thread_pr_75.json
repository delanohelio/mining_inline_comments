{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwMzEyNTY2", "number": 75, "reviewThreads": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxNDoxNToxNVrODWjeig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTozMzoxOFrODWrOFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0OTc2NTIyOnYy", "diffSide": "RIGHT", "path": "src/main/java/de/bonndan/nivio/output/jgraphx/FinalGraph.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxNDoxNToxNVrOFbYH5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNjo1NTo1OVrOFb81qg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDI1MTEwOQ==", "bodyText": "\"It receives\"... ?", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364251109", "createdAt": "2020-01-08T14:15:15Z", "author": {"login": "jpgoelz"}, "path": "src/main/java/de/bonndan/nivio/output/jgraphx/FinalGraph.java", "diffHunk": "@@ -9,31 +9,47 @@\n import com.mxgraph.view.mxGraph;\n import com.mxgraph.view.mxStyleRegistry;\n import com.mxgraph.view.mxStylesheet;\n+\n import de.bonndan.nivio.model.*;\n import de.bonndan.nivio.output.*;\n+import de.bonndan.nivio.output.Rendered;\n import de.bonndan.nivio.util.RootPath;\n+\n+import de.bonndan.nivio.output.Icon;\n+import de.bonndan.nivio.output.IconService;\n+import de.bonndan.nivio.output.LocalServer;\n+\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.util.StringUtils;\n \n import java.io.File;\n import java.net.MalformedURLException;\n import java.util.*;\n+import java.util.List;\n import java.util.concurrent.atomic.AtomicInteger;\n import java.util.stream.Stream;\n \n import static de.bonndan.nivio.model.Status.UNKNOWN;\n import static de.bonndan.nivio.output.Color.getGroupColor;\n \n-public class FinalGraph {\n+/**\n+ * This class is responsible for rendering services and groups nicely with bells and whistles.\n+ * <p>\n+ * It receives", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg1MjY1MA==", "bodyText": "done", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364852650", "createdAt": "2020-01-09T16:55:59Z", "author": {"login": "bonndan"}, "path": "src/main/java/de/bonndan/nivio/output/jgraphx/FinalGraph.java", "diffHunk": "@@ -9,31 +9,47 @@\n import com.mxgraph.view.mxGraph;\n import com.mxgraph.view.mxStyleRegistry;\n import com.mxgraph.view.mxStylesheet;\n+\n import de.bonndan.nivio.model.*;\n import de.bonndan.nivio.output.*;\n+import de.bonndan.nivio.output.Rendered;\n import de.bonndan.nivio.util.RootPath;\n+\n+import de.bonndan.nivio.output.Icon;\n+import de.bonndan.nivio.output.IconService;\n+import de.bonndan.nivio.output.LocalServer;\n+\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.util.StringUtils;\n \n import java.io.File;\n import java.net.MalformedURLException;\n import java.util.*;\n+import java.util.List;\n import java.util.concurrent.atomic.AtomicInteger;\n import java.util.stream.Stream;\n \n import static de.bonndan.nivio.model.Status.UNKNOWN;\n import static de.bonndan.nivio.output.Color.getGroupColor;\n \n-public class FinalGraph {\n+/**\n+ * This class is responsible for rendering services and groups nicely with bells and whistles.\n+ * <p>\n+ * It receives", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDI1MTEwOQ=="}, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDkyNzE1OnYy", "diffSide": "RIGHT", "path": "src/main/app/src/NGroup.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo0OToxMVrOFbjboQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo0OToxMVrOFbjboQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQzNjM4NQ==", "bodyText": "5 * size (add spaces)", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364436385", "createdAt": "2020-01-08T20:49:11Z", "author": {"login": "jpgoelz"}, "path": "src/main/app/src/NGroup.js", "diffHunk": "@@ -0,0 +1,42 @@\n+import React, {Component} from 'react';\n+import PropTypes from 'prop-types';\n+import {HexUtils} from 'react-hexgrid';\n+\n+class NGroup extends Component {\n+\n+    static propTypes = {\n+        group: PropTypes.object,\n+        cellStyle: PropTypes.oneOfType([\n+            PropTypes.string,\n+            PropTypes.object\n+        ])\n+    };\n+\n+    static contextTypes = {\n+        layout: PropTypes.object\n+    };\n+\n+    render() {\n+        const {group, cellStyle} = this.props;\n+        const {layout} = this.context;\n+        const fill = group.color;\n+        const fillId = (fill) ? `#${fill}` : null;\n+        const start = group.start;\n+        const end = group.end;\n+        const size = 40;\n+        let startPoint = HexUtils.hexToPixel(start, layout);\n+        let endPoint = HexUtils.hexToPixel(end, layout);\n+        let width = endPoint.x - startPoint.x + 4 * size;\n+        let height = endPoint.y - startPoint.y + 5*size;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk1MDc3OnYy", "diffSide": "RIGHT", "path": "src/main/app/src/NGroup.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo1ODo0MVrOFbjqTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwNzowNzo0MlrOFcLvYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MDE0Mg==", "bodyText": "Maybe there is a better, more readable approach to this than doing the calculations within the JSX?", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364440142", "createdAt": "2020-01-08T20:58:41Z", "author": {"login": "jpgoelz"}, "path": "src/main/app/src/NGroup.js", "diffHunk": "@@ -0,0 +1,42 @@\n+import React, {Component} from 'react';\n+import PropTypes from 'prop-types';\n+import {HexUtils} from 'react-hexgrid';\n+\n+class NGroup extends Component {\n+\n+    static propTypes = {\n+        group: PropTypes.object,\n+        cellStyle: PropTypes.oneOfType([\n+            PropTypes.string,\n+            PropTypes.object\n+        ])\n+    };\n+\n+    static contextTypes = {\n+        layout: PropTypes.object\n+    };\n+\n+    render() {\n+        const {group, cellStyle} = this.props;\n+        const {layout} = this.context;\n+        const fill = group.color;\n+        const fillId = (fill) ? `#${fill}` : null;\n+        const start = group.start;\n+        const end = group.end;\n+        const size = 40;\n+        let startPoint = HexUtils.hexToPixel(start, layout);\n+        let endPoint = HexUtils.hexToPixel(end, layout);\n+        let width = endPoint.x - startPoint.x + 4 * size;\n+        let height = endPoint.y - startPoint.y + 5*size;\n+        return (\n+            <g>\n+                <rect x={startPoint.x - 2 * size} y={startPoint.y - 2* size} rx=\"50\" ry=\"50\" width={width} height={height}\n+                      style={cellStyle}\n+                      stroke={fillId} fill={fillId} className=\"group\"/>\n+                <text x={startPoint.x - 2 * size + width/2} y={startPoint.y + height - 3*size} fill={fillId}  font-size=\"24\" width={width} textAnchor={'middle'}>{group.name}</text>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA5NjgwMA==", "bodyText": "can be refactored in develop branch", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r365096800", "createdAt": "2020-01-10T07:07:42Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/NGroup.js", "diffHunk": "@@ -0,0 +1,42 @@\n+import React, {Component} from 'react';\n+import PropTypes from 'prop-types';\n+import {HexUtils} from 'react-hexgrid';\n+\n+class NGroup extends Component {\n+\n+    static propTypes = {\n+        group: PropTypes.object,\n+        cellStyle: PropTypes.oneOfType([\n+            PropTypes.string,\n+            PropTypes.object\n+        ])\n+    };\n+\n+    static contextTypes = {\n+        layout: PropTypes.object\n+    };\n+\n+    render() {\n+        const {group, cellStyle} = this.props;\n+        const {layout} = this.context;\n+        const fill = group.color;\n+        const fillId = (fill) ? `#${fill}` : null;\n+        const start = group.start;\n+        const end = group.end;\n+        const size = 40;\n+        let startPoint = HexUtils.hexToPixel(start, layout);\n+        let endPoint = HexUtils.hexToPixel(end, layout);\n+        let width = endPoint.x - startPoint.x + 4 * size;\n+        let height = endPoint.y - startPoint.y + 5*size;\n+        return (\n+            <g>\n+                <rect x={startPoint.x - 2 * size} y={startPoint.y - 2* size} rx=\"50\" ry=\"50\" width={width} height={height}\n+                      style={cellStyle}\n+                      stroke={fillId} fill={fillId} className=\"group\"/>\n+                <text x={startPoint.x - 2 * size + width/2} y={startPoint.y + height - 3*size} fill={fillId}  font-size=\"24\" width={width} textAnchor={'middle'}>{group.name}</text>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MDE0Mg=="}, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk1NTE5OnYy", "diffSide": "RIGHT", "path": "src/main/app/src/NLabel.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowMDozNFrOFbjtKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowMDozNFrOFbjtKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MDg3NA==", "bodyText": "Remove spaces within <div>.", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364440874", "createdAt": "2020-01-08T21:00:34Z", "author": {"login": "jpgoelz"}, "path": "src/main/app/src/NLabel.js", "diffHunk": "@@ -0,0 +1,59 @@\n+import React, {Component} from 'react';\n+import PropTypes from 'prop-types';\n+import NText from \"./NText\";\n+\n+class NLabel extends Component {\n+\n+    static propTypes = {\n+        item: PropTypes.object,\n+        x: PropTypes.oneOfType([\n+            PropTypes.string,\n+            PropTypes.number\n+        ]),\n+        y: PropTypes.oneOfType([\n+            PropTypes.string,\n+            PropTypes.number\n+        ]),\n+        className: PropTypes.string,\n+        width: PropTypes.number,\n+        size: PropTypes.number,\n+        padding: PropTypes.number\n+    };\n+\n+    constructor() {\n+        super();\n+        this.state = {showDetails: false};\n+    }\n+\n+    itemPopup(e) {\n+        this.setState({showDetails: !this.state.showDetails})\n+    }\n+\n+    render() {\n+        const {size, item, padding, width} = this.props;\n+        let showDetails = this.state.showDetails;\n+        let style = showDetails ? {display: 'block'} : {display: 'none'};\n+        return (\n+            <g className={'label'}>\n+                <rect x={size + padding} y={-10} rx=\"10\" ry=\"10\" fill={'white'} width={width} height={size / 2}/>\n+                <NText key={item.identifier} x={size + padding + (width / 2)} y={5}\n+                       width={width} item={item} onClick={e => this.itemPopup(e, this)}/>\n+\n+                <foreignObject width={width} height=\"220\" y={padding} x={size + padding } style={style}>\n+                    <div className=\"details\">\n+                        {item.landscapeItem.description && (<div >\"{item.landscapeItem.description}\"<br /></div>)}\n+                        {item.landscapeItem.owner && (<div >Owner: {item.landscapeItem.owner}</div>)}\n+                        {item.landscapeItem.team && (<div >Team: {item.landscapeItem.team}</div>)}\n+                        {item.landscapeItem.contact && (<div >Contact: {item.landscapeItem.contact}</div>)}\n+                        {item.landscapeItem.software && (<div >Software: {item.landscapeItem.software}</div>)}\n+                        {item.landscapeItem.version && (<div >Version: {item.landscapeItem.version}</div>)}\n+                        {item.landscapeItem.lifecycle && (<div >Lifecycle: {item.landscapeItem.lifecycle}</div>)}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk2MTAyOnYy", "diffSide": "RIGHT", "path": "src/main/app/src/Nexagon.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowMzoxMlrOFbjw5A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwNzowODoxMVrOFcLvwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MTgyOA==", "bodyText": "Is this correct or was it supposed to be named NHexagon?", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364441828", "createdAt": "2020-01-08T21:03:12Z", "author": {"login": "jpgoelz"}, "path": "src/main/app/src/Nexagon.js", "diffHunk": "@@ -0,0 +1,61 @@\n+import React, {Component} from 'react';\n+import PropTypes from 'prop-types';\n+import classNames from 'classnames';\n+import {Hex, HexUtils} from 'react-hexgrid';\n+\n+\n+class Nexagon extends Component {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA5Njg5OA==", "bodyText": "The whole naming can be refactored later", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r365096898", "createdAt": "2020-01-10T07:08:11Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/Nexagon.js", "diffHunk": "@@ -0,0 +1,61 @@\n+import React, {Component} from 'react';\n+import PropTypes from 'prop-types';\n+import classNames from 'classnames';\n+import {Hex, HexUtils} from 'react-hexgrid';\n+\n+\n+class Nexagon extends Component {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MTgyOA=="}, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk2NzU3OnYy", "diffSide": "RIGHT", "path": "src/main/app/src/PathFinder.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNjoxMFrOFbj1Mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwNzowODo1M1rOFcLwZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MjkzMQ==", "bodyText": "let instead of var", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364442931", "createdAt": "2020-01-08T21:06:10Z", "author": {"login": "jpgoelz"}, "path": "src/main/app/src/PathFinder.js", "diffHunk": "@@ -0,0 +1,87 @@\n+import {HexUtils} from 'react-hexgrid';\n+import TilePath from \"./TilePath\";\n+\n+class PathFinder {\n+\n+    constructor(occupied) {\n+        this.occupied = occupied;\n+    }\n+\n+    findPaths(paths, target) {\n+\n+        paths.forEach(path => {\n+            let source = path.tiles[path.tiles.length - 1];\n+            let distance = HexUtils.distance(source, target);\n+\n+            if (distance === 0) {\n+                path.close();\n+            }\n+\n+            let possibleSteps = HexUtils.neighbours(source)\n+                .filter(neigh => this.isSame(neigh, target) || !this.isOccupied(neigh))\n+                .filter(neigh => {\n+                    //return neighbours which are closer to the target\n+                    let ndist = HexUtils.distance(neigh, target);\n+                    return ndist < distance;\n+                });\n+            /*console.log(possibleSteps.length + \" poss. steps (\" +\n+                possibleSteps.map(hex => hex.q + \",\" + hex.r).join(\"; \")\n+                + \") in distance \" + distance + \" from \" + source.q + \",\" + source.r\n+                + \" to \" + target.q + \",\" + target.r);\n+             */\n+\n+            if (possibleSteps.length === 0) { //TODO wrong, wont go back\n+                path.close()\n+            } else {\n+\n+                //prolong path and create clones if there are more possibilties\n+                let template = new TilePath();\n+                template.tiles = path.tiles;\n+                path.tiles.push(possibleSteps.shift());\n+\n+                for (var i = 0; i < possibleSteps.length; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA5NzA2MA==", "bodyText": "done", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r365097060", "createdAt": "2020-01-10T07:08:53Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/PathFinder.js", "diffHunk": "@@ -0,0 +1,87 @@\n+import {HexUtils} from 'react-hexgrid';\n+import TilePath from \"./TilePath\";\n+\n+class PathFinder {\n+\n+    constructor(occupied) {\n+        this.occupied = occupied;\n+    }\n+\n+    findPaths(paths, target) {\n+\n+        paths.forEach(path => {\n+            let source = path.tiles[path.tiles.length - 1];\n+            let distance = HexUtils.distance(source, target);\n+\n+            if (distance === 0) {\n+                path.close();\n+            }\n+\n+            let possibleSteps = HexUtils.neighbours(source)\n+                .filter(neigh => this.isSame(neigh, target) || !this.isOccupied(neigh))\n+                .filter(neigh => {\n+                    //return neighbours which are closer to the target\n+                    let ndist = HexUtils.distance(neigh, target);\n+                    return ndist < distance;\n+                });\n+            /*console.log(possibleSteps.length + \" poss. steps (\" +\n+                possibleSteps.map(hex => hex.q + \",\" + hex.r).join(\"; \")\n+                + \") in distance \" + distance + \" from \" + source.q + \",\" + source.r\n+                + \" to \" + target.q + \",\" + target.r);\n+             */\n+\n+            if (possibleSteps.length === 0) { //TODO wrong, wont go back\n+                path.close()\n+            } else {\n+\n+                //prolong path and create clones if there are more possibilties\n+                let template = new TilePath();\n+                template.tiles = path.tiles;\n+                path.tiles.push(possibleSteps.shift());\n+\n+                for (var i = 0; i < possibleSteps.length; i++) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MjkzMQ=="}, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MDk4NjMxOnYy", "diffSide": "RIGHT", "path": "src/main/app/src/TilePath.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMToxNDoxOVrOFbkBjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMToxNDoxOVrOFbkBjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0NjA5NA==", "bodyText": "You should really run Reformat Code on this file (Ctrl+Alt+L). \ud83d\ude43 Loads of missing spaces.", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364446094", "createdAt": "2020-01-08T21:14:19Z", "author": {"login": "jpgoelz"}, "path": "src/main/app/src/TilePath.js", "diffHunk": "@@ -0,0 +1,94 @@\n+import {HexUtils} from \"react-hexgrid\";\n+\n+class TilePath {\n+\n+    constructor(tile) {\n+        this.tiles = [];\n+        this.bends = [];\n+        if (tile !== undefined)\n+            this.tiles.push(tile);\n+        this.closed = false;\n+    }\n+\n+    close() {\n+        if (this.closed)\n+            return;\n+\n+        this.closed = true;\n+\n+        let i =0;\n+        for (i = 1; i < this.tiles.length - 1; i++) {\n+            let prev = this.tiles[i - 1];\n+            let cur = this.tiles[i];\n+            let next = this.tiles[i+1];\n+            let qBend = (prev.q === cur.q && next.q !== cur.q) || (prev.q !== cur.q && next.q === cur.q);\n+            let rBend = (prev.r === cur.r && next.r !== cur.r) || (prev.r !== cur.r && next.r === cur.r);\n+            if (qBend || rBend)\n+                this.bends.push(cur);\n+        }\n+\n+    }\n+\n+    reducePoints() {\n+        //reduce tiles (not first or last)\n+\n+\n+        /*\n+        let reduced = [];\n+        console.log(drop);\n+        for (i = 0; i < this.tiles.length; i++) {\n+            if (drop.indexOf(i) !== -1)\n+                continue;\n+            reduced.push(this.tiles[i]);\n+        }\n+        this.tiles = reduced;\n+         */\n+    }\n+\n+    getPoints(layout) {\n+        let points = 'M';\n+        for (var i = 0; i < this.tiles.length; i++) {\n+            let hex = this.tiles[i];\n+            if (this._isBend(hex)) {\n+                //cubic curve\n+                let prev = HexUtils.hexToPixel(this.tiles[i-1], layout);\n+                let point = HexUtils.hexToPixel(this.tiles[i], layout);\n+                let next = HexUtils.hexToPixel(this.tiles[i+1], layout);\n+\n+                let newBefore = {};\n+                newBefore.x = prev.x + (point.x -prev.x)/2;\n+                newBefore.y = prev.y + (point.y -prev.y)/2;\n+                points += ` ${newBefore.x},${newBefore.y} ` ;\n+                //points = points.substr(0, points.length-1);\n+                points += `Q ${point.x},${point.y} ` ;\n+\n+                let newAfter = {};\n+                newAfter.x = next.x + (point.x -next.x)/2;\n+                newAfter.y = next.y + (point.y -next.y)/2;\n+                points += ` ${newAfter.x},${newAfter.y} L` ;\n+            } else {\n+                let p = HexUtils.hexToPixel(hex, layout);\n+                points += ` ${p.x},${p.y} L` ;\n+            }\n+        }\n+        return points.substr(0, points.length -1);\n+    }\n+\n+    _isBend(hex) {\n+        if (this.bends.length === 0)\n+            return false;\n+\n+        for (var i = 0; i < this.bends.length; i++) {\n+            if (this.bends[i].q === hex.q && this.bends[i].r === hex.r)\n+                return true;\n+        }\n+\n+        return false;\n+    }\n+\n+    getSpeed() {\n+        return this.tiles.length - this.bends.length;\n+    }\n+}\n+\n+export default TilePath;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 94}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MTAxMDI3OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/bonndan/nivio/output/jgraphx/FinalGraph.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMToyNDoxMVrOFbkRAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMToyNDoxMVrOFbkRAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ1MDA1MQ==", "bodyText": "Why do you import Rendered, Icon, IconService and LocalServer specifically if you already import de.bonndan.nivio.output.*?", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364450051", "createdAt": "2020-01-08T21:24:11Z", "author": {"login": "jpgoelz"}, "path": "src/main/java/de/bonndan/nivio/output/jgraphx/FinalGraph.java", "diffHunk": "@@ -9,31 +9,47 @@\n import com.mxgraph.view.mxGraph;\n import com.mxgraph.view.mxStyleRegistry;\n import com.mxgraph.view.mxStylesheet;\n+\n import de.bonndan.nivio.model.*;\n import de.bonndan.nivio.output.*;\n+import de.bonndan.nivio.output.Rendered;\n import de.bonndan.nivio.util.RootPath;\n+\n+import de.bonndan.nivio.output.Icon;\n+import de.bonndan.nivio.output.IconService;\n+import de.bonndan.nivio.output.LocalServer;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MTAxMTEzOnYy", "diffSide": "RIGHT", "path": "src/main/java/de/bonndan/nivio/output/jgraphx/FinalGraph.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMToyNDozNVrOFbkRjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMToyNDozNVrOFbkRjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ1MDE4OA==", "bodyText": "...again.", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364450188", "createdAt": "2020-01-08T21:24:35Z", "author": {"login": "jpgoelz"}, "path": "src/main/java/de/bonndan/nivio/output/jgraphx/FinalGraph.java", "diffHunk": "@@ -9,31 +9,47 @@\n import com.mxgraph.view.mxGraph;\n import com.mxgraph.view.mxStyleRegistry;\n import com.mxgraph.view.mxStylesheet;\n+\n import de.bonndan.nivio.model.*;\n import de.bonndan.nivio.output.*;\n+import de.bonndan.nivio.output.Rendered;\n import de.bonndan.nivio.util.RootPath;\n+\n+import de.bonndan.nivio.output.Icon;\n+import de.bonndan.nivio.output.IconService;\n+import de.bonndan.nivio.output.LocalServer;\n+\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.util.StringUtils;\n \n import java.io.File;\n import java.net.MalformedURLException;\n import java.util.*;\n+import java.util.List;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MTAyMTg0OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/bonndan/nivio/output/jgraphx/RenderedXYMapFactory.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMToyODoyOVrOFbkX4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwNzowNzoyM1rOFcLvFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ1MTgxMA==", "bodyText": "Can't you extract this into a method (using some kind of Point)? It get's repeated in lines 93-102.", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364451810", "createdAt": "2020-01-08T21:28:29Z", "author": {"login": "jpgoelz"}, "path": "src/main/java/de/bonndan/nivio/output/jgraphx/RenderedXYMapFactory.java", "diffHunk": "@@ -0,0 +1,118 @@\n+package de.bonndan.nivio.output.jgraphx;\n+\n+import com.mxgraph.model.mxCell;\n+import com.mxgraph.model.mxGeometry;\n+import com.mxgraph.view.mxGraph;\n+import de.bonndan.nivio.model.LandscapeImpl;\n+import de.bonndan.nivio.output.IconService;\n+import de.bonndan.nivio.output.Rendered;\n+import de.bonndan.nivio.output.map.*;\n+\n+import java.util.concurrent.atomic.AtomicInteger;\n+import java.util.concurrent.atomic.AtomicLong;\n+\n+public class RenderedXYMapFactory implements MapFactory<mxGraph, mxCell> {\n+\n+    public static final int SIZE_FACTOR = 40;\n+    private final IconService iconService;\n+\n+    public RenderedXYMapFactory(IconService iconService) {\n+        this.iconService = iconService;\n+    }\n+\n+    public RenderedXYMap getRenderedMap(LandscapeImpl landscape, Rendered<mxGraph, mxCell> rendered) {\n+        RenderedXYMap renderedMap = from(rendered);\n+\n+        AtomicInteger minX = new AtomicInteger(0);\n+        AtomicInteger maxX = new AtomicInteger(0);\n+        AtomicInteger minY = new AtomicInteger(0);\n+        AtomicInteger maxY = new AtomicInteger(0);\n+        renderedMap.items.forEach(item -> {\n+            if (item.x < minX.get())\n+                minX.set((int) item.x);\n+            if (item.x > maxX.get())\n+                maxX.set((int) item.x);\n+            if (item.y < minY.get())\n+                minY.set((int) item.y);\n+            if (item.y > maxY.get())\n+                maxY.set((int) item.y);\n+        });\n+\n+        renderedMap.landscape = landscape.getName();\n+        renderedMap.sizeFactor = SIZE_FACTOR;\n+        renderedMap.width = maxX.get() - minX.get();\n+        renderedMap.height = maxY.get() - minY.get();\n+        int size = Math.max(renderedMap.width, renderedMap.height) / SIZE_FACTOR;\n+\n+        renderedMap.items.forEach(item -> item.size = size);\n+        renderedMap.groups.forEach(groupMapItem -> groupMapItem.size = size);\n+\n+        return renderedMap;\n+    }\n+\n+    RenderedXYMap from(Rendered<mxGraph, mxCell> rendered) {\n+        RenderedXYMap renderedMap = new RenderedXYMap();\n+\n+        rendered.getItemObjects().forEach((item, cell) -> {\n+            mxGeometry geometry = cell.getGeometry();\n+\n+            long x;\n+            long y;\n+            if (cell.getParent().getGeometry() != null) {\n+                x = Math.round(geometry.getX() + cell.getParent().getGeometry().getX());\n+                y = Math.round(geometry.getY() + cell.getParent().getGeometry().getY());\n+            } else {\n+                x = Math.round(geometry.getX());\n+                y = Math.round(geometry.getY());\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA5NjcyNg==", "bodyText": "done.", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r365096726", "createdAt": "2020-01-10T07:07:23Z", "author": {"login": "bonndan"}, "path": "src/main/java/de/bonndan/nivio/output/jgraphx/RenderedXYMapFactory.java", "diffHunk": "@@ -0,0 +1,118 @@\n+package de.bonndan.nivio.output.jgraphx;\n+\n+import com.mxgraph.model.mxCell;\n+import com.mxgraph.model.mxGeometry;\n+import com.mxgraph.view.mxGraph;\n+import de.bonndan.nivio.model.LandscapeImpl;\n+import de.bonndan.nivio.output.IconService;\n+import de.bonndan.nivio.output.Rendered;\n+import de.bonndan.nivio.output.map.*;\n+\n+import java.util.concurrent.atomic.AtomicInteger;\n+import java.util.concurrent.atomic.AtomicLong;\n+\n+public class RenderedXYMapFactory implements MapFactory<mxGraph, mxCell> {\n+\n+    public static final int SIZE_FACTOR = 40;\n+    private final IconService iconService;\n+\n+    public RenderedXYMapFactory(IconService iconService) {\n+        this.iconService = iconService;\n+    }\n+\n+    public RenderedXYMap getRenderedMap(LandscapeImpl landscape, Rendered<mxGraph, mxCell> rendered) {\n+        RenderedXYMap renderedMap = from(rendered);\n+\n+        AtomicInteger minX = new AtomicInteger(0);\n+        AtomicInteger maxX = new AtomicInteger(0);\n+        AtomicInteger minY = new AtomicInteger(0);\n+        AtomicInteger maxY = new AtomicInteger(0);\n+        renderedMap.items.forEach(item -> {\n+            if (item.x < minX.get())\n+                minX.set((int) item.x);\n+            if (item.x > maxX.get())\n+                maxX.set((int) item.x);\n+            if (item.y < minY.get())\n+                minY.set((int) item.y);\n+            if (item.y > maxY.get())\n+                maxY.set((int) item.y);\n+        });\n+\n+        renderedMap.landscape = landscape.getName();\n+        renderedMap.sizeFactor = SIZE_FACTOR;\n+        renderedMap.width = maxX.get() - minX.get();\n+        renderedMap.height = maxY.get() - minY.get();\n+        int size = Math.max(renderedMap.width, renderedMap.height) / SIZE_FACTOR;\n+\n+        renderedMap.items.forEach(item -> item.size = size);\n+        renderedMap.groups.forEach(groupMapItem -> groupMapItem.size = size);\n+\n+        return renderedMap;\n+    }\n+\n+    RenderedXYMap from(Rendered<mxGraph, mxCell> rendered) {\n+        RenderedXYMap renderedMap = new RenderedXYMap();\n+\n+        rendered.getItemObjects().forEach((item, cell) -> {\n+            mxGeometry geometry = cell.getGeometry();\n+\n+            long x;\n+            long y;\n+            if (cell.getParent().getGeometry() != null) {\n+                x = Math.round(geometry.getX() + cell.getParent().getGeometry().getX());\n+                y = Math.round(geometry.getY() + cell.getParent().getGeometry().getY());\n+            } else {\n+                x = Math.round(geometry.getX());\n+                y = Math.round(geometry.getY());\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ1MTgxMA=="}, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MTAyNjM0OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/bonndan/nivio/output/map/Hex.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTozMDoxOVrOFbkazg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwNjo1ODowM1rOFcLnUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ1MjU1OA==", "bodyText": "Move static fields to the top of the class.", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364452558", "createdAt": "2020-01-08T21:30:19Z", "author": {"login": "jpgoelz"}, "path": "src/main/java/de/bonndan/nivio/output/map/Hex.java", "diffHunk": "@@ -0,0 +1,82 @@\n+package de.bonndan.nivio.output.map;\n+\n+import java.util.ArrayList;\n+\n+public class Hex {\n+    public Hex(int q, int r, int s) {\n+        this.q = q;\n+        this.r = r;\n+        this.s = s;\n+        if (q + r + s != 0) throw new IllegalArgumentException(\"q + r + s must be 0\");\n+    }\n+\n+    public final int q;\n+    public final int r;\n+    public final int s;\n+\n+    public Hex add(Hex b) {\n+        return new Hex(q + b.q, r + b.r, s + b.s);\n+    }\n+\n+\n+    public Hex subtract(Hex b) {\n+        return new Hex(q - b.q, r - b.r, s - b.s);\n+    }\n+\n+\n+    public Hex scale(int k) {\n+        return new Hex(q * k, r * k, s * k);\n+    }\n+\n+\n+    public Hex rotateLeft() {\n+        return new Hex(-s, -q, -r);\n+    }\n+\n+\n+    public Hex rotateRight() {\n+        return new Hex(-r, -s, -q);\n+    }\n+\n+    static public ArrayList<Hex> directions = new ArrayList<Hex>() {{\n+        add(new Hex(1, 0, -1));\n+        add(new Hex(1, -1, 0));\n+        add(new Hex(0, -1, 1));\n+        add(new Hex(-1, 0, 1));\n+        add(new Hex(-1, 1, 0));\n+        add(new Hex(0, 1, -1));\n+    }};\n+\n+    static public Hex direction(int direction) {\n+        return Hex.directions.get(direction);\n+    }\n+\n+\n+    public Hex neighbor(int direction) {\n+        return add(Hex.direction(direction));\n+    }\n+\n+    static public ArrayList<Hex> diagonals = new ArrayList<Hex>() {{\n+        add(new Hex(2, -1, -1));\n+        add(new Hex(1, -2, 1));\n+        add(new Hex(-1, -1, 2));\n+        add(new Hex(-2, 1, 1));\n+        add(new Hex(-1, 2, -1));\n+        add(new Hex(1, 1, -2));\n+    }};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA5NDczNw==", "bodyText": "done", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r365094737", "createdAt": "2020-01-10T06:58:03Z", "author": {"login": "bonndan"}, "path": "src/main/java/de/bonndan/nivio/output/map/Hex.java", "diffHunk": "@@ -0,0 +1,82 @@\n+package de.bonndan.nivio.output.map;\n+\n+import java.util.ArrayList;\n+\n+public class Hex {\n+    public Hex(int q, int r, int s) {\n+        this.q = q;\n+        this.r = r;\n+        this.s = s;\n+        if (q + r + s != 0) throw new IllegalArgumentException(\"q + r + s must be 0\");\n+    }\n+\n+    public final int q;\n+    public final int r;\n+    public final int s;\n+\n+    public Hex add(Hex b) {\n+        return new Hex(q + b.q, r + b.r, s + b.s);\n+    }\n+\n+\n+    public Hex subtract(Hex b) {\n+        return new Hex(q - b.q, r - b.r, s - b.s);\n+    }\n+\n+\n+    public Hex scale(int k) {\n+        return new Hex(q * k, r * k, s * k);\n+    }\n+\n+\n+    public Hex rotateLeft() {\n+        return new Hex(-s, -q, -r);\n+    }\n+\n+\n+    public Hex rotateRight() {\n+        return new Hex(-r, -s, -q);\n+    }\n+\n+    static public ArrayList<Hex> directions = new ArrayList<Hex>() {{\n+        add(new Hex(1, 0, -1));\n+        add(new Hex(1, -1, 0));\n+        add(new Hex(0, -1, 1));\n+        add(new Hex(-1, 0, 1));\n+        add(new Hex(-1, 1, 0));\n+        add(new Hex(0, 1, -1));\n+    }};\n+\n+    static public Hex direction(int direction) {\n+        return Hex.directions.get(direction);\n+    }\n+\n+\n+    public Hex neighbor(int direction) {\n+        return add(Hex.direction(direction));\n+    }\n+\n+    static public ArrayList<Hex> diagonals = new ArrayList<Hex>() {{\n+        add(new Hex(2, -1, -1));\n+        add(new Hex(1, -2, 1));\n+        add(new Hex(-1, -1, 2));\n+        add(new Hex(-2, 1, 1));\n+        add(new Hex(-1, 2, -1));\n+        add(new Hex(1, 1, -2));\n+    }};", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ1MjU1OA=="}, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1MTAzMzgzOnYy", "diffSide": "RIGHT", "path": "src/main/java/de/bonndan/nivio/output/map/MapItem.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTozMzoxOFrOFbkfhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTozMzoxOFrOFbkfhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ1Mzc2Ng==", "bodyText": "remove", "url": "https://github.com/dedica-team/nivio/pull/75#discussion_r364453766", "createdAt": "2020-01-08T21:33:18Z", "author": {"login": "jpgoelz"}, "path": "src/main/java/de/bonndan/nivio/output/map/MapItem.java", "diffHunk": "@@ -0,0 +1,45 @@\n+package de.bonndan.nivio.output.map;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import de.bonndan.nivio.model.LandscapeItem;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2f7f1b0ea0262fe6033f3f117cddc20f392888"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4065, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}