{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMTcyNDcz", "number": 319, "title": "WIP: 317 Removing interfaces", "bodyText": "", "createdAt": "2020-10-11T17:12:07Z", "url": "https://github.com/dedica-team/nivio/pull/319", "merged": true, "mergeCommit": {"oid": "de14d74b5b065f051987cb164a77904491f047c0"}, "closed": true, "closedAt": "2020-10-15T17:41:31Z", "author": {"login": "mfbieber"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRO9BKAH2gAyNTAxMTcyNDczOmFmYWMwNWJjN2ZlOTkwNThjOGFlN2Y2NTU5NTc3MWNmMTc5ZGI5NjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdS0vcAgH2gAyNTAxMTcyNDczOjAwMzg3NTIyMDc4NTM3NGFmYWRhNjU3NWNkYmZmN2ExNGRiYmRmOWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "afac05bc7fe99058c8ae7f65595771cf179db966", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/afac05bc7fe99058c8ae7f65595771cf179db966", "committedDate": "2020-10-10T18:19:16Z", "message": "WIP: removing Interfaces from Description objects"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef56c0b9b2f68739b6be1f588b585ab83fba14d4", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/ef56c0b9b2f68739b6be1f588b585ab83fba14d4", "committedDate": "2020-10-11T17:06:53Z", "message": "WIP: removing interfaces also from impl objects. Compiling, 2 tests failing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "252e979ff4fdc424a10aa39aff23f8a3e5c2a775", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/252e979ff4fdc424a10aa39aff23f8a3e5c2a775", "committedDate": "2020-10-11T17:11:26Z", "message": "WIP: deleted interfaces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a863cbd9ebe81bf91b428717d5b6bb06a7a153a0", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/a863cbd9ebe81bf91b428717d5b6bb06a7a153a0", "committedDate": "2020-10-11T17:15:07Z", "message": "renamed LandscapeImpl to Landscape"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c645a4132545e3480534287938d6e1ef59052988", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/c645a4132545e3480534287938d6e1ef59052988", "committedDate": "2020-10-12T16:29:15Z", "message": "fixed constructor usage in ItemFactory and jackson-databind dependency"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MjAwMzY0", "url": "https://github.com/dedica-team/nivio/pull/319#pullrequestreview-506200364", "createdAt": "2020-10-11T17:31:28Z", "commit": {"oid": "a863cbd9ebe81bf91b428717d5b6bb06a7a153a0"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxNzozMToyOVrOHfpPtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxNzo0MTozN1rOHfpTrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk0MzY2OQ==", "bodyText": "\ud83d\udc4d might work, since we'd never process a landscape graph", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r502943669", "createdAt": "2020-10-11T17:31:29Z", "author": {"login": "bonndan"}, "path": "src/main/java/de/bonndan/nivio/ProcessingException.java", "diffHunk": "@@ -12,24 +11,24 @@\n  */\n public class ProcessingException extends RuntimeException {\n \n-    private final Landscape landscape;\n+    private final LandscapeDescription landscapeDescription;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a863cbd9ebe81bf91b428717d5b6bb06a7a153a0"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk0Mzk4NQ==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r502943985", "createdAt": "2020-10-11T17:34:24Z", "author": {"login": "bonndan"}, "path": "src/main/java/de/bonndan/nivio/model/Landscape.java", "diffHunk": "@@ -1,20 +1,247 @@\n package de.bonndan.nivio.model;\n \n+import com.fasterxml.jackson.annotation.JsonGetter;\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.annotation.JsonInclude;\n import de.bonndan.nivio.LandscapeConfig;\n+import de.bonndan.nivio.assessment.Assessable;\n+import de.bonndan.nivio.assessment.StatusValue;\n+import de.bonndan.nivio.input.ProcessLog;\n+import io.swagger.v3.oas.annotations.media.Schema;\n+import org.springframework.lang.NonNull;\n+import org.springframework.util.StringUtils;\n \n-import java.util.Map;\n+import javax.validation.constraints.Pattern;\n+import java.time.LocalDateTime;\n+import java.util.*;\n+import java.util.stream.Collectors;\n \n-public interface Landscape extends Component, Linked {\n+import static de.bonndan.nivio.model.Item.IDENTIFIER_VALIDATION;\n+\n+/**\n+ * Think of a group of servers and apps, like a \"project\", \"workspace\" or stage.\n+ */\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+public class Landscape implements Linked, Component, Labeled, Assessable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a863cbd9ebe81bf91b428717d5b6bb06a7a153a0"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk0NDM2NQ==", "bodyText": "\ud83d\udc4d the code is improving", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r502944365", "createdAt": "2020-10-11T17:38:17Z", "author": {"login": "bonndan"}, "path": "src/main/java/de/bonndan/nivio/output/map/RenderCache.java", "diffHunk": "@@ -67,9 +66,9 @@ private void createCacheEntry(LandscapeImpl landscape) {\n     @Override\n     public void onApplicationEvent(ProcessingFinishedEvent processingFinishedEvent) {\n         Landscape landscape = processingFinishedEvent.getLandscape();\n-        if (landscape instanceof LandscapeImpl) {\n+        if (landscape != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a863cbd9ebe81bf91b428717d5b6bb06a7a153a0"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk0NDY4NQ==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r502944685", "createdAt": "2020-10-11T17:41:37Z", "author": {"login": "bonndan"}, "path": "src/main/java/de/bonndan/nivio/input/IndexEventListener.java", "diffHunk": "@@ -22,7 +22,7 @@ public IndexEventListener(Indexer indexer) {\n \n     @Override\n     public void onApplicationEvent(IndexEvent event) {\n-        LandscapeDescription description = (LandscapeDescription) event.getLandscape();\n+        LandscapeDescription description = event.getLandscape();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a863cbd9ebe81bf91b428717d5b6bb06a7a153a0"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b02c634365b9ceef860a49c6ea13f9f184bd40b8", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/b02c634365b9ceef860a49c6ea13f9f184bd40b8", "committedDate": "2020-10-12T17:42:58Z", "message": "removed unneded factory method and fixed the test that used it"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0ef2d615911bfecb325ab001e3c2cc4d8079baf", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/b0ef2d615911bfecb325ab001e3c2cc4d8079baf", "committedDate": "2020-10-12T17:51:09Z", "message": "removed unneded pick(Item item) and fixed test to work with ItemDescription"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88108cdf9751e2b3d4dd4c5b97ba51bfb6144ce3", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/88108cdf9751e2b3d4dd4c5b97ba51bfb6144ce3", "committedDate": "2020-10-12T17:55:56Z", "message": "removed unneded method in ItemMatcher"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NzkxMzUx", "url": "https://github.com/dedica-team/nivio/pull/319#pullrequestreview-506791351", "createdAt": "2020-10-12T17:14:36Z", "commit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "state": "COMMENTED", "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxNzoxNDozNlrOHgG63A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQxODowNDo1NlrOHgIaLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQyOTg1Mg==", "bodyText": "Do IndexEvents always work with the LandscapeDescriptions? Or do they also need to work with the Landscape objects?", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503429852", "createdAt": "2020-10-12T17:14:36Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/IndexEvent.java", "diffHunk": "@@ -1,39 +1,48 @@\n package de.bonndan.nivio;\n \n+import com.fasterxml.jackson.core.JsonGenerator;\n+import com.fasterxml.jackson.databind.JsonSerializer;\n+import com.fasterxml.jackson.databind.SerializerProvider;\n+import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n import de.bonndan.nivio.input.dto.LandscapeDescription;\n-import de.bonndan.nivio.model.Landscape;\n+\n+import java.io.IOException;\n \n /**\n  * Event is fired to (re)index a landscape.\n- *\n- *\n- *\n  */\n public class IndexEvent extends ProcessingEvent {\n \n-    private final Landscape landscape;\n     private final String message;\n+    private final LandscapeDescription landscapeDescription;\n \n     /**\n      * @param source triggering class\n-     * @param landscape landscape description\n+     * @param landscapeDescription landscape description\n      * @param message message for the UI\n      */\n-    public IndexEvent(Object source, Landscape landscape, String message) {\n+    public IndexEvent(Object source, LandscapeDescription landscapeDescription, String message) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQzMDI1Ng==", "bodyText": "Is this also correct, that this one works with the LandscapeDescription and not the Landscape object?", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503430256", "createdAt": "2020-10-12T17:15:23Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/ProcessingErrorEvent.java", "diffHunk": "@@ -20,9 +26,16 @@ public ProcessingException getException() {\n         return exception;\n     }\n \n-    @Override\n-    public Landscape getLandscape() {\n-        return exception.getLandscape();\n+    @JsonSerialize(using = PLS.class)\n+    public LandscapeDescription getLandscape() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQzMDYyNQ==", "bodyText": "This has been moved to the specific events, since some of them use the LandscapeDescription and others the Landscape object.", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503430625", "createdAt": "2020-10-12T17:16:10Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/ProcessingEvent.java", "diffHunk": "@@ -30,9 +22,6 @@ public ProcessingEvent(Object source) {\n         super(source);\n     }\n \n-    @JsonSerialize(using = PLS.class)\n-    public abstract Landscape getLandscape();\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQzMTAxOQ==", "bodyText": "The ProcessingException (and the processing in general) work with the LandscapeDescription, correct?", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503431019", "createdAt": "2020-10-12T17:17:01Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/ProcessingException.java", "diffHunk": "@@ -12,24 +11,24 @@\n  */\n public class ProcessingException extends RuntimeException {\n \n-    private final Landscape landscape;\n+    private final LandscapeDescription landscapeDescription;\n \n-    public ProcessingException(Landscape landscape, String message) {\n+    public ProcessingException(LandscapeDescription landscapeDescription, String message) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQzMTQxOQ==", "bodyText": "The ProcessingFinishedEvent does not work with the LandscapeDescription, but with the Landscape object == the result of the processing operations. Is this correct?", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503431419", "createdAt": "2020-10-12T17:17:55Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/ProcessingFinishedEvent.java", "diffHunk": "@@ -22,11 +28,18 @@ public ProcessingFinishedEvent(LandscapeDescription source, Landscape landscape)\n         this.landscape = landscape;\n     }\n \n-    @Override\n+    @JsonSerialize(using = PLS.class)\n     public Landscape getLandscape() {\n         return landscape;\n     }\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQzMzc2OA==", "bodyText": "The logic of creating the Item from the ItemDescription is in the added function, see below.", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503433768", "createdAt": "2020-10-12T17:23:08Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/input/DiffResolver.java", "diffHunk": "@@ -20,27 +20,26 @@ protected DiffResolver(ProcessLog processLog) {\n     }\n \n     @Override\n-    public void process(LandscapeDescription input, LandscapeImpl landscape) {\n+    public void process(LandscapeDescription input, Landscape landscape) {\n         Set<Item> existingItems = landscape.getItems().all();\n \n         //insert new ones\n-        List<LandscapeItem> newItems = added(input.getItemDescriptions().all(), existingItems);\n+        List<Item> newItems = added(input.getItemDescriptions().all(), existingItems, landscape);\n         Set<Item> inLandscape = new HashSet<>();\n         processLog.info(\"Adding \" + newItems.size() + \" items in env \" + landscape.getIdentifier());\n         newItems.forEach(\n-                serviceDescription -> {\n-                    processLog.info(\"Creating new service \" + serviceDescription.getIdentifier() + \" in env \" + input.getIdentifier());\n-                    Item created = ItemFactory.fromDescription(serviceDescription, landscape);\n-                    inLandscape.add(created);\n+                newItem -> {\n+                    processLog.info(\"Creating new service \" + newItem.getIdentifier() + \" in env \" + input.getIdentifier());\n+                    inLandscape.add(newItem);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQzNTE0OA==", "bodyText": "Here an Item object is generated from its ItemDescription. Before, it could have been an Item or an ItemDescription. It compared Item with ItemDescription, but now it only compares Item with Item.", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503435148", "createdAt": "2020-10-12T17:26:08Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/input/DiffResolver.java", "diffHunk": "@@ -79,36 +78,47 @@ public void process(LandscapeDescription input, LandscapeImpl landscape) {\n             return new ArrayList<>();\n         }\n \n-        List<LandscapeItem> removed = removed(kept, all);\n+        List<Item> removed = removed(kept, all);\n         logger.info(\"Removing \" + removed.size() + \" sources in env \" + landscapeDescription.getIdentifier());\n         return removed;\n     }\n \n     /**\n-     * Returns all elements kept in the second list.\n+     * Returns all items that are also present in the new itemDescriptions\n      */\n-    static List<LandscapeItem> kept(Collection<? extends LandscapeItem> items1, Collection<? extends LandscapeItem> items2) {\n-        return items2.stream().filter(item -> exists(item, items1)).collect(Collectors.toList());\n+    static List<Item> kept(Collection<? extends ItemDescription> newItems, Collection<? extends Item> items, Landscape landscape) {\n+        return items.stream()\n+                .filter(item -> presentInNewItems(item, newItems, landscape))\n+                .collect(Collectors.toList());\n     }\n \n     /**\n      * Returns all elements removed from the second list.\n      */\n-    static List<LandscapeItem> removed(Collection<? extends LandscapeItem> items1, Collection<? extends LandscapeItem> items2) {\n-        return items2.stream().filter(item -> !exists(item, items1)).collect(Collectors.toList());\n+    static List<Item> removed(Collection<? extends Item> items, Collection<? extends Item> itemDescriptions) {\n+        return itemDescriptions.stream()\n+                .filter(item -> doesNotExistAsItem(item, items))\n+                .collect(Collectors.toList());\n     }\n \n     /**\n      * Returns all elements which are not in the second list\n      */\n-    static List<LandscapeItem> added(Collection<? extends LandscapeItem> items1, Collection<? extends LandscapeItem> existing) {\n-        return items1.stream()\n-                .filter(item -> !exists(item, existing))\n+    static List<Item> added(Collection<? extends ItemDescription> itemDescriptions, Collection<? extends Item> existingItems, Landscape landscape) {\n+        return itemDescriptions.stream()\n+                .map(itemDescription -> ItemFactory.fromDescription(itemDescription, landscape))\n+                .filter(newItem -> doesNotExistAsItem(newItem, existingItems))\n                 .collect(Collectors.toList());\n     }\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 119}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ0MDE0Mw==", "bodyText": "I needed to have a method for !exists that compares two Item objects and exists for Item and ItemDescription. This makes the stream operations in kept simpler.", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503440143", "createdAt": "2020-10-12T17:36:49Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/input/DiffResolver.java", "diffHunk": "@@ -79,36 +78,47 @@ public void process(LandscapeDescription input, LandscapeImpl landscape) {\n             return new ArrayList<>();\n         }\n \n-        List<LandscapeItem> removed = removed(kept, all);\n+        List<Item> removed = removed(kept, all);\n         logger.info(\"Removing \" + removed.size() + \" sources in env \" + landscapeDescription.getIdentifier());\n         return removed;\n     }\n \n     /**\n-     * Returns all elements kept in the second list.\n+     * Returns all items that are also present in the new itemDescriptions\n      */\n-    static List<LandscapeItem> kept(Collection<? extends LandscapeItem> items1, Collection<? extends LandscapeItem> items2) {\n-        return items2.stream().filter(item -> exists(item, items1)).collect(Collectors.toList());\n+    static List<Item> kept(Collection<? extends ItemDescription> newItems, Collection<? extends Item> items, Landscape landscape) {\n+        return items.stream()\n+                .filter(item -> presentInNewItems(item, newItems, landscape))\n+                .collect(Collectors.toList());\n     }\n \n     /**\n      * Returns all elements removed from the second list.\n      */\n-    static List<LandscapeItem> removed(Collection<? extends LandscapeItem> items1, Collection<? extends LandscapeItem> items2) {\n-        return items2.stream().filter(item -> !exists(item, items1)).collect(Collectors.toList());\n+    static List<Item> removed(Collection<? extends Item> items, Collection<? extends Item> itemDescriptions) {\n+        return itemDescriptions.stream()\n+                .filter(item -> doesNotExistAsItem(item, items))\n+                .collect(Collectors.toList());\n     }\n \n     /**\n      * Returns all elements which are not in the second list\n      */\n-    static List<LandscapeItem> added(Collection<? extends LandscapeItem> items1, Collection<? extends LandscapeItem> existing) {\n-        return items1.stream()\n-                .filter(item -> !exists(item, existing))\n+    static List<Item> added(Collection<? extends ItemDescription> itemDescriptions, Collection<? extends Item> existingItems, Landscape landscape) {\n+        return itemDescriptions.stream()\n+                .map(itemDescription -> ItemFactory.fromDescription(itemDescription, landscape))\n+                .filter(newItem -> doesNotExistAsItem(newItem, existingItems))\n                 .collect(Collectors.toList());\n     }\n \n-    private static boolean exists(LandscapeItem item, Collection<? extends LandscapeItem> items) {\n-        return items.stream().anyMatch(\n+    private static boolean presentInNewItems(Item item, Collection<? extends ItemDescription> newItems, Landscape landscape) {\n+        return newItems.stream()\n+                .map(newItem -> ItemFactory.fromDescription(newItem, landscape))\n+                .anyMatch(inList -> ItemMatcher.forTarget(item).isSimilarTo(inList));\n+    }\n+\n+    private static boolean doesNotExistAsItem(Item item, Collection<? extends Item> items) {\n+        return items.stream().noneMatch(\n                 inList -> ItemMatcher.forTarget(item).isSimilarTo(inList)\n         );", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 131}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ0MTMyMw==", "bodyText": "Here I needed to copy the factory method. Is this correct that we want to generate a LandscapeDescription also from an outdatedLandscape (Landscape object, e.g. in ObserverRegistry)? But also from an outdatedDescription (LandscapeDescription object)?", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503441323", "createdAt": "2020-10-12T17:39:17Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/input/LandscapeDescriptionFactory.java", "diffHunk": "@@ -37,16 +37,34 @@ public LandscapeDescriptionFactory(FileFetcher fileFetcher) {\n     /**\n      * Returns a {@link LandscapeDescription}s from config file url.\n      *\n-     * @param old an outdated landscape / description\n+     * @param outdatedLandscape an outdated landscape\n      * @return the description or null if the source is no URL\n      */\n     @Nullable\n-    public LandscapeDescription from(Landscape old) {\n+    public LandscapeDescription from(Landscape outdatedLandscape) {\n         try {\n-            URL url = new URL(old.getSource());\n+            URL url = new URL(outdatedLandscape.getSource());\n             return from(url);\n         } catch (MalformedURLException e) {\n-            String msg = \"Source in landscape \" + old.getIdentifier() + \" might be no url: \" + old.getSource();\n+            String msg = \"Source in landscape \" + outdatedLandscape.getIdentifier() + \" might be no url: \" + outdatedLandscape.getSource();\n+            LOGGER.info(msg);\n+            return null;\n+        }\n+    }\n+\n+    /**\n+     * Returns a {@link LandscapeDescription}s from config file url.\n+     *\n+     * @param outdatedDescription an outdated description\n+     * @return the description or null if the source is no URL\n+     */\n+    @Nullable\n+    public LandscapeDescription from(LandscapeDescription outdatedDescription) {\n+        try {\n+            URL url = new URL(outdatedDescription.getSource());\n+            return from(url);\n+        } catch (MalformedURLException e) {\n+            String msg = \"Source in landscape \" + outdatedDescription.getIdentifier() + \" might be no url: \" + outdatedDescription.getSource();\n             LOGGER.info(msg);\n             return null;\n         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ0MTg5Nw==", "bodyText": "The second one is only used in a test. I will fix this!", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503441897", "createdAt": "2020-10-12T17:40:34Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/input/LandscapeDescriptionFactory.java", "diffHunk": "@@ -37,16 +37,34 @@ public LandscapeDescriptionFactory(FileFetcher fileFetcher) {\n     /**\n      * Returns a {@link LandscapeDescription}s from config file url.\n      *\n-     * @param old an outdated landscape / description\n+     * @param outdatedLandscape an outdated landscape\n      * @return the description or null if the source is no URL\n      */\n     @Nullable\n-    public LandscapeDescription from(Landscape old) {\n+    public LandscapeDescription from(Landscape outdatedLandscape) {\n         try {\n-            URL url = new URL(old.getSource());\n+            URL url = new URL(outdatedLandscape.getSource());\n             return from(url);\n         } catch (MalformedURLException e) {\n-            String msg = \"Source in landscape \" + old.getIdentifier() + \" might be no url: \" + old.getSource();\n+            String msg = \"Source in landscape \" + outdatedLandscape.getIdentifier() + \" might be no url: \" + outdatedLandscape.getSource();\n+            LOGGER.info(msg);\n+            return null;\n+        }\n+    }\n+\n+    /**\n+     * Returns a {@link LandscapeDescription}s from config file url.\n+     *\n+     * @param outdatedDescription an outdated description\n+     * @return the description or null if the source is no URL\n+     */\n+    @Nullable\n+    public LandscapeDescription from(LandscapeDescription outdatedDescription) {\n+        try {\n+            URL url = new URL(outdatedDescription.getSource());\n+            return from(url);\n+        } catch (MalformedURLException e) {\n+            String msg = \"Source in landscape \" + outdatedDescription.getIdentifier() + \" might be no url: \" + outdatedDescription.getSource();\n             LOGGER.info(msg);\n             return null;\n         }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ0MTMyMw=="}, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ0ODY0Nw==", "bodyText": "This is a code duplication I could not remove. We compare ItemDescriptions with this matcher in ItemDescriptions.findAll()", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503448647", "createdAt": "2020-10-12T17:55:10Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/model/ItemMatcher.java", "diffHunk": "@@ -134,6 +139,30 @@ public boolean isSimilarTo(LandscapeItem item) {\n         return equalsLandscape && equalsGroup && equalsItem;\n     }\n \n+    public boolean isSimilarTo(ItemDescription itemDescription) {\n+        FullyQualifiedIdentifier otherItemFQI = itemDescription.getFullyQualifiedIdentifier();\n+\n+        boolean equalsLandscape;\n+        if (StringUtils.isEmpty(landscape) || StringUtils.isEmpty(otherItemFQI.getLandscape()))\n+            equalsLandscape = true; //ignoring landscape because not set\n+        else\n+            equalsLandscape = landscape.equalsIgnoreCase(otherItemFQI.getLandscape());\n+\n+        boolean equalsGroup;\n+        if (StringUtils.isEmpty(group) || StringUtils.isEmpty(otherItemFQI.getGroup()))\n+            equalsGroup = true;\n+        else\n+            equalsGroup = this.group.equalsIgnoreCase(otherItemFQI.getGroup());\n+\n+        boolean equalsItem;\n+        if (StringUtils.isEmpty(this.item) || StringUtils.isEmpty(otherItemFQI.getItem()))\n+            equalsItem = true;\n+        else\n+            equalsItem = this.item.equalsIgnoreCase(otherItemFQI.getItem());\n+\n+        return equalsLandscape && equalsGroup && equalsItem;\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQ1NDI1Mw==", "bodyText": "This is another duplication. These are only used in tests. Do we still need those? What are we testing with those that our code is not doing? Why are they deprecated?", "url": "https://github.com/dedica-team/nivio/pull/319#discussion_r503454253", "createdAt": "2020-10-12T18:04:56Z", "author": {"login": "mfbieber"}, "path": "src/main/java/de/bonndan/nivio/model/RelationType.java", "diffHunk": "@@ -31,7 +32,18 @@ public static RelationType from(String relationType) {\n      * @return filtered subset\n      */\n     @Deprecated\n-    public List<RelationItem> filter(Collection<? extends RelationItem> all) {\n-        return all.stream().filter(relationItem -> this.equals(relationItem.getType())).collect(Collectors.toList());\n+    public List<Relation> filter(Collection<? extends Relation> all) {\n+        return all.stream().filter(relation -> this.equals(relation.getType())).collect(Collectors.toList());\n+    }\n+\n+    /**\n+     * Filters a list of relations for equal type.\n+     *\n+     * @param all all relations\n+     * @return filtered subset\n+     */\n+    @Deprecated\n+    public List<RelationDescription> filterRelationDescription(Collection<? extends RelationDescription> all) {\n+        return all.stream().filter(relation -> this.equals(relation.getType())).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c645a4132545e3480534287938d6e1ef59052988"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fea5ef7fa532a248d88ab17ed992fc6128046ba", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/7fea5ef7fa532a248d88ab17ed992fc6128046ba", "committedDate": "2020-10-15T16:40:40Z", "message": "removed deprecated filter methods in RelationType"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "003875220785374afada6575cdbff7a14dbbdf9f", "author": {"user": {"login": "mfbieber", "name": "Michelle Fernandez Bieber"}}, "url": "https://github.com/dedica-team/nivio/commit/003875220785374afada6575cdbff7a14dbbdf9f", "committedDate": "2020-10-15T16:54:45Z", "message": "removed one duplicated isSimilarTo method in ItemMatcher by using directly the FullyQualifiedIdentifier"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1901, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}