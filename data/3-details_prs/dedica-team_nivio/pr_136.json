{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0NDc1MDQ3", "number": 136, "title": "Refactor Context/API, fix changes from backend rework", "bodyText": "Closes #133\nCloses #126\nCloses #134 \"read data from the API instead of html inclusion, remove html item endpoint\"\nRemove console :(", "createdAt": "2020-05-07T05:52:54Z", "url": "https://github.com/dedica-team/nivio/pull/136", "merged": true, "mergeCommit": {"oid": "2e93438eef39b57ce13e9717ace22cd184f40ba1"}, "closed": true, "closedAt": "2020-05-08T08:53:45Z", "author": {"login": "MarvinSchoening"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcez0PpAH2gAyNDE0NDc1MDQ3OjQzNGU5NDIyNmEwNWMyMTA3NmRhOTgwYTA5NjEyNjg3MjZlNjc5Y2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABce87rfAH2gAyNDE0NDc1MDQ3OmVkMWRhMTljNWZjYTljYTQ1ODU4NmVjMjBmMTViYjExZDNlMTgzNWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "434e94226a05c21076da980a0961268726e679cc", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/434e94226a05c21076da980a0961268726e679cc", "committedDate": "2020-05-07T02:26:02Z", "message": "first changes to fix backend rework"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2172939edeb4807cd686502190adafe7ba54f8b", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/e2172939edeb4807cd686502190adafe7ba54f8b", "committedDate": "2020-05-07T02:36:16Z", "message": "Merge branch 'develop' into refactoring/context-api"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17280cab55f400d93bdd10001235a34eafdfb4cb", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/17280cab55f400d93bdd10001235a34eafdfb4cb", "committedDate": "2020-05-07T02:50:31Z", "message": "fix tests and remove react console mock"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e2c32c966f5de6d08c087996b888124b5722fc1", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/0e2c32c966f5de6d08c087996b888124b5722fc1", "committedDate": "2020-05-07T03:41:01Z", "message": "add dateformat for easy formatting, remove landscape context, add Item interface and use it in LandscapeItem"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b75b40b1ad228427182edb43b7786dc151c3b15", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/0b75b40b1ad228427182edb43b7786dc151c3b15", "committedDate": "2020-05-07T03:48:40Z", "message": "add titleBar in landscapeoverview layout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ebb7754f203c79b0efe84c97453c0760515b677", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/2ebb7754f203c79b0efe84c97453c0760515b677", "committedDate": "2020-05-07T04:05:36Z", "message": "dont show pure json in landscapeItem, still needs rework"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9532e4ef14d3e090467cb783b100ea3530b56a98", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/9532e4ef14d3e090467cb783b100ea3530b56a98", "committedDate": "2020-05-07T05:22:08Z", "message": "extract all api calls into an APIClient"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1665bdd5032bd1a53365f775ea838b18916a6cbc", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/1665bdd5032bd1a53365f775ea838b18916a6cbc", "committedDate": "2020-05-07T05:49:07Z", "message": "change apiClient to a single get function with route as parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f6e77957508078e8e3d6b3fdf208ffed2eccaee", "author": {"user": {"login": "MarvinSchoening", "name": "Marvin Sch\u00f6ning"}}, "url": "https://github.com/dedica-team/nivio/commit/4f6e77957508078e8e3d6b3fdf208ffed2eccaee", "committedDate": "2020-05-07T05:54:04Z", "message": "reroll env changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6223a00bcf886a33942eaae3c33e7305aaf3af1e", "author": {"user": {"login": "MarvinSchoening", "name": "Marvin Sch\u00f6ning"}}, "url": "https://github.com/dedica-team/nivio/commit/6223a00bcf886a33942eaae3c33e7305aaf3af1e", "committedDate": "2020-05-07T05:54:48Z", "message": "Update .env"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "465e90e69398846a0c715c6dd6df2c903ba7739f", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/465e90e69398846a0c715c6dd6df2c903ba7739f", "committedDate": "2020-05-07T06:00:19Z", "message": "fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47a43c42bf7fc59831893512ca481fc8e88d640a", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/47a43c42bf7fc59831893512ca481fc8e88d640a", "committedDate": "2020-05-07T06:06:19Z", "message": "npm run format"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/f344ae930b52e67093afb34a91652574aa0e7d9b", "committedDate": "2020-05-07T06:06:36Z", "message": "Merge branch 'refactoring/context-api' of https://github.com/dedica-team/nivio into refactoring/context-api"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTc3NTcw", "url": "https://github.com/dedica-team/nivio/pull/136#pullrequestreview-407177570", "createdAt": "2020-05-07T06:21:09Z", "commit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjoyMTowOVrOGRv9yw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjoyMTowOVrOGRv9yw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI2NDg0Mw==", "bodyText": "What is actually the difference in JS?", "url": "https://github.com/dedica-team/nivio/pull/136#discussion_r421264843", "createdAt": "2020-05-07T06:21:09Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/App.tsx", "diffHunk": "@@ -5,7 +5,7 @@ import LandscapeOverview from './Components/LandscapeComponent/LandscapeOverview\n import Landscape from './Components/LandscapeComponent/Landscape/Landscape';\n import Man from './Components/ManComponent/Man';\n import Layout from './Components/LayoutComponent/Layout';\n-import Events from \"./Components/EventComponent/Events\";\n+import Events from './Components/EventComponent/Events';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTg3MzQ0", "url": "https://github.com/dedica-team/nivio/pull/136#pullrequestreview-407187344", "createdAt": "2020-05-07T06:42:43Z", "commit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0Mjo0M1rOGRweJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0Mjo0M1rOGRweJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI3MzEyNw==", "bodyText": "We should think about removing the attributes width, height, x,y  from the API. These are leftovers from times when to hex map was drawn in the frontend.", "url": "https://github.com/dedica-team/nivio/pull/136#discussion_r421273127", "createdAt": "2020-05-07T06:42:43Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/interfaces.ts", "diffHunk": "@@ -1,10 +1,35 @@\n export interface ILandscape {\n-    name: string;\n-    identifier: string;\n-    description?: string;\n-    contact?: string;\n-    teams: string[];\n-    groups?: string[];\n-    items?: string[];\n-    lastUpdate?: string;\n+  name: string;\n+  identifier: string;\n+  description?: string;\n+  teams?: object[]; // TODO: Create interface\n+  items?: IItem[];\n+  groups?: object[]; // TODO: Create interface\n+  lastUpdate?: string;\n+  overallState?: string;\n+}\n+\n+export interface IItem {\n+  color?: string;\n+  contact?: string;\n+  description?: string;\n+  fill?: string;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTg3OTM5", "url": "https://github.com/dedica-team/nivio/pull/136#pullrequestreview-407187939", "createdAt": "2020-05-07T06:43:56Z", "commit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0Mzo1NlrOGRwgFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0Mzo1NlrOGRwgFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI3MzYyMw==", "bodyText": "Pls check if this appears at all. ProvidedBy is a shortcut for configuring landscapes long before internal processing is done.", "url": "https://github.com/dedica-team/nivio/pull/136#discussion_r421273623", "createdAt": "2020-05-07T06:43:56Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/interfaces.ts", "diffHunk": "@@ -1,10 +1,35 @@\n export interface ILandscape {\n-    name: string;\n-    identifier: string;\n-    description?: string;\n-    contact?: string;\n-    teams: string[];\n-    groups?: string[];\n-    items?: string[];\n-    lastUpdate?: string;\n+  name: string;\n+  identifier: string;\n+  description?: string;\n+  teams?: object[]; // TODO: Create interface\n+  items?: IItem[];\n+  groups?: object[]; // TODO: Create interface\n+  lastUpdate?: string;\n+  overallState?: string;\n+}\n+\n+export interface IItem {\n+  color?: string;\n+  contact?: string;\n+  description?: string;\n+  fill?: string;\n+  fullyQualifiedIdentifier?: string;\n+  group?: string;\n+  height?: number;\n+  icon?: string;\n+  identifier: string;\n+  interfaces?: Array<Object>;\n+  labels?: Object;\n+  lifecycle?: String;\n+  links?: Object;\n+  name?: String;\n+  owner?: String;\n+  providedBy?: Array<Object>;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTg4MTg1", "url": "https://github.com/dedica-team/nivio/pull/136#pullrequestreview-407188185", "createdAt": "2020-05-07T06:44:26Z", "commit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0NDoyNlrOGRwg5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0NDoyNlrOGRwg5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI3MzgzMQ==", "bodyText": "fqi is mandatory", "url": "https://github.com/dedica-team/nivio/pull/136#discussion_r421273831", "createdAt": "2020-05-07T06:44:26Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/interfaces.ts", "diffHunk": "@@ -1,10 +1,35 @@\n export interface ILandscape {\n-    name: string;\n-    identifier: string;\n-    description?: string;\n-    contact?: string;\n-    teams: string[];\n-    groups?: string[];\n-    items?: string[];\n-    lastUpdate?: string;\n+  name: string;\n+  identifier: string;\n+  description?: string;\n+  teams?: object[]; // TODO: Create interface\n+  items?: IItem[];\n+  groups?: object[]; // TODO: Create interface\n+  lastUpdate?: string;\n+  overallState?: string;\n+}\n+\n+export interface IItem {\n+  color?: string;\n+  contact?: string;\n+  description?: string;\n+  fill?: string;\n+  fullyQualifiedIdentifier?: string;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTg4MjM0", "url": "https://github.com/dedica-team/nivio/pull/136#pullrequestreview-407188234", "createdAt": "2020-05-07T06:44:34Z", "commit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0NDozNFrOGRwhGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0NDozNFrOGRwhGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI3Mzg4MA==", "bodyText": "name is mandatory", "url": "https://github.com/dedica-team/nivio/pull/136#discussion_r421273880", "createdAt": "2020-05-07T06:44:34Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/interfaces.ts", "diffHunk": "@@ -1,10 +1,35 @@\n export interface ILandscape {\n-    name: string;\n-    identifier: string;\n-    description?: string;\n-    contact?: string;\n-    teams: string[];\n-    groups?: string[];\n-    items?: string[];\n-    lastUpdate?: string;\n+  name: string;\n+  identifier: string;\n+  description?: string;\n+  teams?: object[]; // TODO: Create interface\n+  items?: IItem[];\n+  groups?: object[]; // TODO: Create interface\n+  lastUpdate?: string;\n+  overallState?: string;\n+}\n+\n+export interface IItem {\n+  color?: string;\n+  contact?: string;\n+  description?: string;\n+  fill?: string;\n+  fullyQualifiedIdentifier?: string;\n+  group?: string;\n+  height?: number;\n+  icon?: string;\n+  identifier: string;\n+  interfaces?: Array<Object>;\n+  labels?: Object;\n+  lifecycle?: String;\n+  links?: Object;\n+  name?: String;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTg5MTA3", "url": "https://github.com/dedica-team/nivio/pull/136#pullrequestreview-407189107", "createdAt": "2020-05-07T06:46:28Z", "commit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0NjoyOFrOGRwj9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0NjoyOFrOGRwj9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI3NDYxMw==", "bodyText": "see LandscapeDTO, I think overallState has been removed", "url": "https://github.com/dedica-team/nivio/pull/136#discussion_r421274613", "createdAt": "2020-05-07T06:46:28Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/interfaces.ts", "diffHunk": "@@ -1,10 +1,35 @@\n export interface ILandscape {\n-    name: string;\n-    identifier: string;\n-    description?: string;\n-    contact?: string;\n-    teams: string[];\n-    groups?: string[];\n-    items?: string[];\n-    lastUpdate?: string;\n+  name: string;\n+  identifier: string;\n+  description?: string;\n+  teams?: object[]; // TODO: Create interface\n+  items?: IItem[];\n+  groups?: object[]; // TODO: Create interface\n+  lastUpdate?: string;\n+  overallState?: string;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTg5ODkx", "url": "https://github.com/dedica-team/nivio/pull/136#pullrequestreview-407189891", "createdAt": "2020-05-07T06:48:04Z", "commit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0ODowNVrOGRwmhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNjo0ODowNVrOGRwmhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI3NTI2OQ==", "bodyText": "We can leave this for now. I've made a wireframe to discuss future changes.", "url": "https://github.com/dedica-team/nivio/pull/136#discussion_r421275269", "createdAt": "2020-05-07T06:48:05Z", "author": {"login": "bonndan"}, "path": "src/main/app/src/Components/LandscapeComponent/Item/LandscapeItem.tsx", "diffHunk": "@@ -1,36 +1,46 @@\n-import React, { useEffect, useState } from 'react';\n+import React, { useEffect, useState, useCallback } from 'react';\n+import { get } from '../../../utils/API/APIClient';\n import './LandscapeItem.scss';\n \n+import { IItem } from '../../../interfaces';\n+\n interface Props {\n   element: Element;\n }\n \n /**\n  * Returns a choosen Landscape Item if informations are available\n  * @param element Choosen SVG Element from our Landscape Component\n- * TODO load assessment data\n- * TODO maybe use data from landscape context\n  */\n const LandscapeItem: React.FC<Props> = ({ element }) => {\n-  const [html, setHtml] = useState<string>(`Not Found :(`);\n+  const [item, setItem] = useState<IItem | null>();\n+  const [loadItem, setLoadItem] = useState<boolean>(true);\n   const [topic, setTopic] = useState<string | null>(null);\n \n+  const getItem = useCallback(async () => {\n+    if (loadItem && topic) {\n+      setItem(await get(`/api/${topic}`));\n+      setLoadItem(false);\n+    }\n+  }, [loadItem, topic]);\n+\n   useEffect(() => {\n     let topic = element.getAttribute('data-identifier');\n     setTopic(topic);\n     if (topic !== null) {\n-      console.log(topic);\n-      fetch(process.env.REACT_APP_BACKEND_URL + '/api/' + topic)\n-        .then((response) => {\n-          return response.json();\n-        })\n-        .then((data) => {\n-          setHtml(JSON.stringify(data));\n-        });\n+      getItem();\n     }\n-  }, [element, topic, html]);\n+  }, [element, topic, getItem]);\n \n-  return <div className='landscapeItemContent'>{html}</div>;\n+  return (", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f344ae930b52e67093afb34a91652574aa0e7d9b"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f311baf2324bc520f5911525e6de74970003de2", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/4f311baf2324bc520f5911525e6de74970003de2", "committedDate": "2020-05-07T13:02:36Z", "message": "update interfaces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed1da19c5fca9ca458586ec20f15bb11d3e1835a", "author": {"user": null}, "url": "https://github.com/dedica-team/nivio/commit/ed1da19c5fca9ca458586ec20f15bb11d3e1835a", "committedDate": "2020-05-07T13:03:18Z", "message": "remove overall state from landscape overview"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2992, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}