{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NDUyNTgz", "number": 1248, "title": "[Minor] Adding delete docs to QuickStart", "bodyText": "Adding delete docs to QuickStart\n\nVerify this pull request\nThis pull request is a trivial rework / code cleanup without any test coverage.\nVerified locally.\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-01-18T18:40:27Z", "url": "https://github.com/apache/hudi/pull/1248", "merged": true, "mergeCommit": {"oid": "5964367084a2cc7d4e540b8cd235e08b3774e5af"}, "closed": true, "closedAt": "2020-01-23T06:32:36Z", "author": {"login": "nsivabalan"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7n-pRgFqTM0NDk1Njk3OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb82DwtABqjI5NzAxMTIwODM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0OTU2OTc4", "url": "https://github.com/apache/hudi/pull/1248#pullrequestreview-344956978", "createdAt": "2020-01-18T18:48:09Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxODo0ODowOVrOFfLuYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxODo0OTowNVrOFfLujQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MjI3Mw==", "bodyText": "could we avoid doing the insert again?  can we not reuse from the insert/update done above?", "url": "https://github.com/apache/hudi/pull/1248#discussion_r368242273", "createdAt": "2020-01-18T18:48:09Z", "author": {"login": "vinothchandar"}, "path": "docs/quickstart.md", "diffHunk": "@@ -109,6 +109,57 @@ Notice that the save mode is now `Append`. In general, always use append mode un\n [Querying](#query) the data again will now show updated trips. Each write operation generates a new [commit](http://hudi.incubator.apache.org/concepts.html) \n denoted by the timestamp. Look for changes in `_hoodie_commit_time`, `rider`, `driver` fields for the same `_hoodie_record_key`s in previous commit. \n \n+## Delete data {#deletes}\n+Delete records for the HoodieKeys passed in. Lets first generate a new batch of insert and delete the same. Query to verify\n+that all records are deleted.\n+\n+```\n+val inserts = convertToStringList(dataGen.generateInserts(10))", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MjMxNw==", "bodyText": "ideally,. we just have this part and remove everything above this line, to keep the quickstart small", "url": "https://github.com/apache/hudi/pull/1248#discussion_r368242317", "createdAt": "2020-01-18T18:49:05Z", "author": {"login": "vinothchandar"}, "path": "docs/quickstart.md", "diffHunk": "@@ -109,6 +109,57 @@ Notice that the save mode is now `Append`. In general, always use append mode un\n [Querying](#query) the data again will now show updated trips. Each write operation generates a new [commit](http://hudi.incubator.apache.org/concepts.html) \n denoted by the timestamp. Look for changes in `_hoodie_commit_time`, `rider`, `driver` fields for the same `_hoodie_record_key`s in previous commit. \n \n+## Delete data {#deletes}\n+Delete records for the HoodieKeys passed in. Lets first generate a new batch of insert and delete the same. Query to verify\n+that all records are deleted.\n+\n+```\n+val inserts = convertToStringList(dataGen.generateInserts(10))\n+val df = spark.read.json(spark.sparkContext.parallelize(inserts, 2))\n+df.write.format(\"org.apache.hudi\").\n+    options(getQuickstartWriteConfigs).\n+    option(PRECOMBINE_FIELD_OPT_KEY, \"ts\").\n+    option(RECORDKEY_FIELD_OPT_KEY, \"uuid\").\n+    option(PARTITIONPATH_FIELD_OPT_KEY, \"partitionpath\").\n+    option(TABLE_NAME, tableName).\n+    mode(Overwrite).\n+    save(basePath);\n+\n+// Fetch the rider value for the batch of records inserted just now\n+val roDeleteViewDF = spark.\n+    read.\n+    format(\"org.apache.hudi\").\n+    load(basePath + \"/*/*/*/*\")\n+roDeleteViewDF.registerTempTable(\"hudi_ro_table\")\n+spark.sql(\"select distinct rider from  hudi_ro_table where\").show()\n+\n+// replace the rider value in below query to a value from above. \"rider-213\" is first batch and \"rider-284\" is second batch.\n+val ds = spark.sql(\"select uuid, partitionPath from hudi_ro_table where rider = 'rider-284'\")\n+\n+// issue deletes", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 31}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MTE3NTQ3", "url": "https://github.com/apache/hudi/pull/1248#pullrequestreview-346117547", "createdAt": "2020-01-21T19:02:34Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f42f1feff9131a027b0a2e40157d7a9ea5b7799", "author": {"user": {"login": "nsivabalan", "name": "Sivabalan Narayanan"}}, "url": "https://github.com/apache/hudi/commit/8f42f1feff9131a027b0a2e40157d7a9ea5b7799", "committedDate": "2020-01-22T13:49:12Z", "message": "Adding delete docs to QuickStart"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "8f42f1feff9131a027b0a2e40157d7a9ea5b7799", "author": {"user": {"login": "nsivabalan", "name": "Sivabalan Narayanan"}}, "url": "https://github.com/apache/hudi/commit/8f42f1feff9131a027b0a2e40157d7a9ea5b7799", "committedDate": "2020-01-22T13:49:12Z", "message": "Adding delete docs to QuickStart"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4104, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}