{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyMjUwNzc2", "number": 1654, "title": "HUDI-921 Remove inlineCompactionEvery method in HoodieCompactionConfig.Builder", "bodyText": "What is the purpose of the pull request\ninlineCompactionEvery method in HoodieCompactionConfig.Builder is incorrectly setting number of delta commits to INLINE_COMPACT_PROP property which is boolean variable\nI think withMaxNumDeltaCommitsBeforeCompaction method is doing the purpose of setting num of delta commits before compaction.\nSo, I am proposing to remove inlineCompactionEvery method, which is not used anywhere\nBrief change log\n\nRemove inlineCompactionEvery method from HoodieCompactionConfig.Builder\n\nVerify this pull request\nThis pull request is a trivial rework / code cleanup without any test coverage.\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-05-23T09:54:33Z", "url": "https://github.com/apache/hudi/pull/1654", "merged": true, "mergeCommit": {"oid": "d3edac4612bde2fa9deca9536801dbc48961fb95"}, "closed": true, "closedAt": "2020-05-24T08:09:19Z", "author": {"login": "sathyaprakashg"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABckDwABAH2gAyNDIyMjUwNzc2OjgwNDQzZTY1NmZjZjNiN2M4YTI5NWQyZDYzOGY1ODc2MmU5MDRiMzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABckW5jkAFqTQxNzMzNjQ3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "80443e656fcf3b7c8a295d2d638f58762e904b31", "author": {"user": null}, "url": "https://github.com/apache/hudi/commit/80443e656fcf3b7c8a295d2d638f58762e904b31", "committedDate": "2020-05-23T09:49:30Z", "message": "HUDI-921 Remove inlineCompactionEvery method in HoodieCompactionConfig.Builder"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MjgxOTQ0", "url": "https://github.com/apache/hudi/pull/1654#pullrequestreview-417281944", "createdAt": "2020-05-23T14:13:26Z", "commit": {"oid": "80443e656fcf3b7c8a295d2d638f58762e904b31"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MzMxODAy", "url": "https://github.com/apache/hudi/pull/1654#pullrequestreview-417331802", "createdAt": "2020-05-24T06:49:37Z", "commit": {"oid": "80443e656fcf3b7c8a295d2d638f58762e904b31"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQwNjo0OTozN1rOGZtCOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQwNjo0OTozN1rOGZtCOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYwNTQzNQ==", "bodyText": "this is wrong nonetheless.. we can remove this method..\nbut the issue you faced may not be due to this? I see LogFileSizeBasedCompactionStrategy is the default strategy, which chooses the largest log files for compaction (like I mentioned, we check if compaction has to be scheduled at the end of each delta commit), upto a certain size .. This default is very large (probably due to the data volumes at uber)//\n  public static final String DEFAULT_TARGET_IO_PER_COMPACTION_IN_MB = String.valueOf(500 * 1024);\nAnd it keeps compacting all the logs, thus..\nCould you try setting hoodie.compaction.target.io=1 (i.e allow upto just 1MB, artifically low threshold) and see if the log files are there.. We can also revisit if we can lower the limit for that in this PR.", "url": "https://github.com/apache/hudi/pull/1654#discussion_r429605435", "createdAt": "2020-05-24T06:49:37Z", "author": {"login": "vinothchandar"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieCompactionConfig.java", "diffHunk": "@@ -147,11 +147,6 @@ public Builder withInlineCompaction(Boolean inlineCompaction) {\n       return this;\n     }\n \n-    public Builder inlineCompactionEvery(int deltaCommits) {\n-      props.setProperty(INLINE_COMPACT_PROP, String.valueOf(deltaCommits));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80443e656fcf3b7c8a295d2d638f58762e904b31"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MzM2NDcy", "url": "https://github.com/apache/hudi/pull/1654#pullrequestreview-417336472", "createdAt": "2020-05-24T08:08:08Z", "commit": {"oid": "80443e656fcf3b7c8a295d2d638f58762e904b31"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3178, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}