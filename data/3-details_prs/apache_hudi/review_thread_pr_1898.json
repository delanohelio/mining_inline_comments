{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYxNTA1MTcy", "number": 1898, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNzozNjoyNlrOEUsg4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMTowMjo0MlrOEUwbrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwMTM2MjkxOnYy", "diffSide": "RIGHT", "path": "hudi-utilities/src/test/java/org/apache/hudi/utilities/functional/TestHoodieDeltaStreamer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNzozNjoyNlrOG7CggA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNzozNjoyNlrOG7CggA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU2MDI1Ng==", "bodyText": "can be removed.", "url": "https://github.com/apache/hudi/pull/1898#discussion_r464560256", "createdAt": "2020-08-03T17:36:26Z", "author": {"login": "bvaradar"}, "path": "hudi-utilities/src/test/java/org/apache/hudi/utilities/functional/TestHoodieDeltaStreamer.java", "diffHunk": "@@ -394,6 +414,95 @@ public void testProps() {\n         props.getString(\"hoodie.datasource.write.keygenerator.class\"));\n   }\n \n+  private static HoodieDeltaStreamer.Config getBaseConfig() {\n+    // Base config with all required fields\n+    HoodieDeltaStreamer.Config base = new HoodieDeltaStreamer.Config();\n+    base.targetBasePath = TGT_BASE_PATH_VALUE;\n+    base.tableType = TABLE_TYPE_VALUE;\n+    base.targetTableName = TARGET_TABLE_VALUE;\n+    return base;\n+  }\n+\n+  private static Stream<Arguments> provideValidCliArgs() {\n+\n+    HoodieDeltaStreamer.Config base = getBaseConfig();\n+    // String parameter\n+    HoodieDeltaStreamer.Config conf1 = getBaseConfig();\n+    conf1.baseFileFormat = BASE_FILE_FORMAT_VALUE;\n+\n+    // Integer parameter\n+    HoodieDeltaStreamer.Config conf2 = getBaseConfig();\n+    conf2.sourceLimit = Long.parseLong(SOURCE_LIMIT_VALUE);\n+\n+    // Boolean Parameter\n+    HoodieDeltaStreamer.Config conf3 = getBaseConfig();\n+    conf3.enableHiveSync = true;\n+\n+    // ArrayList Parameter with 1 value\n+    HoodieDeltaStreamer.Config conf4 = getBaseConfig();\n+    conf4.configs = Arrays.asList(HOODIE_CONF_VALUE1);\n+\n+    // ArrayList Parameter with comma separated values\n+    HoodieDeltaStreamer.Config conf5 = getBaseConfig();\n+    conf5.configs = Arrays.asList(HOODIE_CONF_VALUE2);\n+\n+    // Multiple ArrayList values\n+    HoodieDeltaStreamer.Config conf6 = getBaseConfig();\n+    conf6.configs = Arrays.asList(HOODIE_CONF_VALUE1, HOODIE_CONF_VALUE2);\n+\n+    // Super set of all cases\n+    HoodieDeltaStreamer.Config conf = getBaseConfig();\n+    conf.baseFileFormat = BASE_FILE_FORMAT_VALUE;\n+    conf.sourceLimit = Long.parseLong(SOURCE_LIMIT_VALUE);\n+    conf.enableHiveSync = true;\n+    conf.configs = Arrays.asList(HOODIE_CONF_VALUE1, HOODIE_CONF_VALUE2);\n+\n+    String[] allConfig = new String[]{TGT_BASE_PATH_PARAM, TGT_BASE_PATH_VALUE, SOURCE_LIMIT_PARAM,\n+        SOURCE_LIMIT_VALUE, TABLE_TYPE_PARAM, TABLE_TYPE_VALUE, TARGET_TABLE_PARAM, TARGET_TABLE_VALUE,\n+        BASE_FILE_FORMAT_PARAM, BASE_FILE_FORMAT_VALUE, ENABLE_HIVE_SYNC_PARAM, HOODIE_CONF_PARAM, HOODIE_CONF_VALUE1,\n+        HOODIE_CONF_PARAM, HOODIE_CONF_VALUE2};\n+\n+    return Stream.of(\n+            // Base\n+            Arguments.of(new String[] {TGT_BASE_PATH_PARAM, TGT_BASE_PATH_VALUE,\n+                TABLE_TYPE_PARAM, TABLE_TYPE_VALUE, TARGET_TABLE_PARAM, TARGET_TABLE_VALUE}, base),\n+            // String\n+            Arguments.of(new String[] {TGT_BASE_PATH_PARAM, TGT_BASE_PATH_VALUE,\n+                TABLE_TYPE_PARAM, TABLE_TYPE_VALUE, TARGET_TABLE_PARAM, TARGET_TABLE_VALUE,\n+                BASE_FILE_FORMAT_PARAM, BASE_FILE_FORMAT_VALUE}, conf1),\n+            // Integer\n+            Arguments.of(new String[] {TGT_BASE_PATH_PARAM, TGT_BASE_PATH_VALUE,\n+                TABLE_TYPE_PARAM, TABLE_TYPE_VALUE, TARGET_TABLE_PARAM, TARGET_TABLE_VALUE,\n+                SOURCE_LIMIT_PARAM, SOURCE_LIMIT_VALUE}, conf2),\n+            // Boolean\n+            Arguments.of(new String[] {TGT_BASE_PATH_PARAM, TGT_BASE_PATH_VALUE,\n+                TABLE_TYPE_PARAM, TABLE_TYPE_VALUE, TARGET_TABLE_PARAM, TARGET_TABLE_VALUE,\n+                ENABLE_HIVE_SYNC_PARAM}, conf3),\n+            // Array List 1\n+            Arguments.of(new String[] {TGT_BASE_PATH_PARAM, TGT_BASE_PATH_VALUE,\n+                TABLE_TYPE_PARAM, TABLE_TYPE_VALUE, TARGET_TABLE_PARAM, TARGET_TABLE_VALUE,\n+                HOODIE_CONF_PARAM, HOODIE_CONF_VALUE1}, conf4),\n+            // Array List with comma\n+            Arguments.of(new String[] {TGT_BASE_PATH_PARAM, TGT_BASE_PATH_VALUE,\n+                TABLE_TYPE_PARAM, TABLE_TYPE_VALUE, TARGET_TABLE_PARAM, TARGET_TABLE_VALUE,\n+                HOODIE_CONF_PARAM, HOODIE_CONF_VALUE2}, conf5),\n+            // Array list with multiple values\n+            Arguments.of(new String[] {TGT_BASE_PATH_PARAM, TGT_BASE_PATH_VALUE,\n+                TABLE_TYPE_PARAM, TABLE_TYPE_VALUE, TARGET_TABLE_PARAM, TARGET_TABLE_VALUE,\n+                HOODIE_CONF_PARAM, HOODIE_CONF_VALUE1, HOODIE_CONF_PARAM, HOODIE_CONF_VALUE2}, conf6),\n+            // All\n+            Arguments.of(allConfig, conf)\n+    );\n+  }\n+  \n+  @ParameterizedTest\n+  @MethodSource(\"provideValidCliArgs\")\n+  public void testValidCommandLineArgs(String[] args, HoodieDeltaStreamer.Config expected) {\n+    System.out.println(\"Expected: \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c9840d3a6edd70fb881d341323863111f4800db"}, "originalPosition": 132}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwMTM4OTE1OnYy", "diffSide": "RIGHT", "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNzo0MTowOVrOG7CxFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QxNzo0ODoxOFrOG7DBnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU2NDUwMA==", "bodyText": "Question : Any specific reason why equals/hashcode are added ? Was it added as part of general  best-practices ?", "url": "https://github.com/apache/hudi/pull/1898#discussion_r464564500", "createdAt": "2020-08-03T17:41:09Z", "author": {"login": "bvaradar"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -306,16 +317,106 @@ public boolean isInlineCompactionEnabled() {\n       return !continuousMode && !forceDisableCompaction\n           && HoodieTableType.MERGE_ON_READ.equals(HoodieTableType.valueOf(tableType));\n     }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c9840d3a6edd70fb881d341323863111f4800db"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU2ODczNQ==", "bodyText": "Yes I wanted to add equals() for better testability and hence added hashcode() as both go hand-in-hand", "url": "https://github.com/apache/hudi/pull/1898#discussion_r464568735", "createdAt": "2020-08-03T17:48:18Z", "author": {"login": "sreeram26"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -306,16 +317,106 @@ public boolean isInlineCompactionEnabled() {\n       return !continuousMode && !forceDisableCompaction\n           && HoodieTableType.MERGE_ON_READ.equals(HoodieTableType.valueOf(tableType));\n     }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDU2NDUwMA=="}, "originalCommit": {"oid": "8c9840d3a6edd70fb881d341323863111f4800db"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkwMjAwNDkyOnYy", "diffSide": "RIGHT", "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMTowMjo0MlrOG7Iomg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQxNjo0MzoyNFrOG7ouEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY2MDYzNA==", "bodyText": "How about making this class public and moving it to a more general package e.g. hudi-common?\nThere are some other classes which might also need this VoidSplitter, e.g. https://github.com/apache/hudi/blob/master/hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java#L280, https://github.com/apache/hudi/blob/master/hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java#L92", "url": "https://github.com/apache/hudi/pull/1898#discussion_r464660634", "createdAt": "2020-08-03T21:02:42Z", "author": {"login": "zhedoubushishi"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -165,6 +168,12 @@ public Operation convert(String value) throws ParameterException {\n     }\n   }\n \n+  private static final class VoidSplitter implements IParameterSplitter {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "99a09437f114fb7690d0b1100d17545c7d1eca47"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY4MTU3OQ==", "bodyText": "I was a little skeptical about making this change apply for all CLIs. But on second thought, looked at documentation and README files, all of them have --hoodie-conf A --hoodie-conf B way so no one in theory should be sending --hoodie-conf A,B in their usecases. So will move it to common and apply this change for all of the classes using hoodie-conf", "url": "https://github.com/apache/hudi/pull/1898#discussion_r464681579", "createdAt": "2020-08-03T21:52:21Z", "author": {"login": "sreeram26"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -165,6 +168,12 @@ public Operation convert(String value) throws ParameterException {\n     }\n   }\n \n+  private static final class VoidSplitter implements IParameterSplitter {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY2MDYzNA=="}, "originalCommit": {"oid": "99a09437f114fb7690d0b1100d17545c7d1eca47"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcwNjE3NQ==", "bodyText": "Thanks for confirming!", "url": "https://github.com/apache/hudi/pull/1898#discussion_r464706175", "createdAt": "2020-08-03T23:03:22Z", "author": {"login": "zhedoubushishi"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -165,6 +168,12 @@ public Operation convert(String value) throws ParameterException {\n     }\n   }\n \n+  private static final class VoidSplitter implements IParameterSplitter {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY2MDYzNA=="}, "originalCommit": {"oid": "99a09437f114fb7690d0b1100d17545c7d1eca47"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTE4NjMyMw==", "bodyText": "@zhedoubushishi : Lets not bring in jcommander dependency to hudi-common. hudi-common is a core package used across different environments. This can be made the first level class but lets keep it in hudi-utilities : org.apache.hudi.utilities", "url": "https://github.com/apache/hudi/pull/1898#discussion_r465186323", "createdAt": "2020-08-04T16:43:24Z", "author": {"login": "bvaradar"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -165,6 +168,12 @@ public Operation convert(String value) throws ParameterException {\n     }\n   }\n \n+  private static final class VoidSplitter implements IParameterSplitter {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY2MDYzNA=="}, "originalCommit": {"oid": "99a09437f114fb7690d0b1100d17545c7d1eca47"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4382, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}