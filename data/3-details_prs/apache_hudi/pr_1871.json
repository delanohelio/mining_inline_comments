{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2MDk1MDQ2", "number": 1871, "title": "[HUDI-781] Introduce HoodieTestTable for test preparation", "bodyText": "Make HoodieTestTable the sole class for creating hoodie data/metadata files for testing\nConsolidate relevant util methods to HoodieTestTable\n\nTrying to draw a line between\n\nwhat a dev needs to code for test and\nwhat the helper APIs can provide to reduce code\n\nThe rationale is based on: a developer owns how the test data looks like (e.g. file id, partition path), while the APIs guide a developer what kinds of data allowed to create (e.g. inflight commit, marker, log, etc), and provide handy usage pattern (in this case builder pattern)\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-07-24T06:05:00Z", "url": "https://github.com/apache/hudi/pull/1871", "merged": true, "mergeCommit": {"oid": "b2e703d4427abca02b053fa4444cd5058aa256ef"}, "closed": true, "closedAt": "2020-08-11T01:44:04Z", "author": {"login": "xushiyan"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5JoB3ABqjM1OTE4ODQ4NjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9sv4VgFqTQ2NDY5NDEzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4b6a20f6a47f1cdc86d2a670fcd4ca8b83cc3876", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/4b6a20f6a47f1cdc86d2a670fcd4ca8b83cc3876", "committedDate": "2020-07-24T06:37:26Z", "message": "some fix"}, "afterCommit": {"oid": "5a2dd741b29810a6b7100649c1dbfde5541af56e", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/5a2dd741b29810a6b7100649c1dbfde5541af56e", "committedDate": "2020-07-27T22:32:29Z", "message": "[HUDI-781] Introduce HoodieDataPrep for test preparation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e153b242d56dc40ecceb689250e2a531c05f436f", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/e153b242d56dc40ecceb689250e2a531c05f436f", "committedDate": "2020-07-27T22:38:27Z", "message": "deprecate APIs in HoodieTestUtils"}, "afterCommit": {"oid": "7e61dea97d6a68061a34c775c096d83b603037b2", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/7e61dea97d6a68061a34c775c096d83b603037b2", "committedDate": "2020-07-27T22:45:56Z", "message": "deprecate APIs in HoodieTestUtils"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7ceb05f6cb4f8e43ad4941317b1b2bc10e81b36f", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/7ceb05f6cb4f8e43ad4941317b1b2bc10e81b36f", "committedDate": "2020-07-27T22:50:27Z", "message": "move IOType to hudi-common"}, "afterCommit": {"oid": "bd5aac8554a955208b91199132e40bd00544f68d", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/bd5aac8554a955208b91199132e40bd00544f68d", "committedDate": "2020-07-28T01:29:19Z", "message": "move IOType to hudi-common"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "24be1d42f46c832fbb0505ad056f21422aadfad4", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/24be1d42f46c832fbb0505ad056f21422aadfad4", "committedDate": "2020-07-28T02:10:41Z", "message": "fix import"}, "afterCommit": {"oid": "ef4c4aaeffc339176eb8d20143f6212b1b24732e", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/ef4c4aaeffc339176eb8d20143f6212b1b24732e", "committedDate": "2020-07-29T03:41:41Z", "message": "[HUDI-781] Introduce HoodieDataPrep for test preparation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ef4c4aaeffc339176eb8d20143f6212b1b24732e", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/ef4c4aaeffc339176eb8d20143f6212b1b24732e", "committedDate": "2020-07-29T03:41:41Z", "message": "[HUDI-781] Introduce HoodieDataPrep for test preparation"}, "afterCommit": {"oid": "4ff643299f5289c8ef2cfa038c48902d28b8fb85", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/4ff643299f5289c8ef2cfa038c48902d28b8fb85", "committedDate": "2020-08-04T15:54:46Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ff643299f5289c8ef2cfa038c48902d28b8fb85", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/4ff643299f5289c8ef2cfa038c48902d28b8fb85", "committedDate": "2020-08-04T15:54:46Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}, "afterCommit": {"oid": "12a1ed2868a69ee165611687521050973a0260ae", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/12a1ed2868a69ee165611687521050973a0260ae", "committedDate": "2020-08-06T03:52:02Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "12a1ed2868a69ee165611687521050973a0260ae", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/12a1ed2868a69ee165611687521050973a0260ae", "committedDate": "2020-08-06T03:52:02Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}, "afterCommit": {"oid": "33e09d027dcc44a5c7c0a9878ef8d9bcf7fe1af0", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/33e09d027dcc44a5c7c0a9878ef8d9bcf7fe1af0", "committedDate": "2020-08-08T00:53:31Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "33e09d027dcc44a5c7c0a9878ef8d9bcf7fe1af0", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/33e09d027dcc44a5c7c0a9878ef8d9bcf7fe1af0", "committedDate": "2020-08-08T00:53:31Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}, "afterCommit": {"oid": "051175392fc24955007fa77e0381305ac9ac4d93", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/051175392fc24955007fa77e0381305ac9ac4d93", "committedDate": "2020-08-08T02:53:09Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "051175392fc24955007fa77e0381305ac9ac4d93", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/051175392fc24955007fa77e0381305ac9ac4d93", "committedDate": "2020-08-08T02:53:09Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}, "afterCommit": {"oid": "bfcdd491225ab05543b12a8672e3b356b03238f0", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/bfcdd491225ab05543b12a8672e3b356b03238f0", "committedDate": "2020-08-08T05:48:42Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNzIxMzY0", "url": "https://github.com/apache/hudi/pull/1871#pullrequestreview-463721364", "createdAt": "2020-08-08T05:56:53Z", "commit": {"oid": "bfcdd491225ab05543b12a8672e3b356b03238f0"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwNTo1Njo1NFrOG9t1LA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwNjowMDo0OVrOG9t2Ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM2NzIxMg==", "bodyText": "deleted APIs that turn out be to useful moved to org.apache.hudi.common.testutils.FilesTestUtils", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467367212", "createdAt": "2020-08-08T05:56:54Z", "author": {"login": "xushiyan"}, "path": "hudi-client/src/test/java/org/apache/hudi/testutils/HoodieClientTestUtils.java", "diffHunk": "@@ -74,57 +74,6 @@\n public class HoodieClientTestUtils {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bfcdd491225ab05543b12a8672e3b356b03238f0"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM2NzQwMA==", "bodyText": "not used", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467367400", "createdAt": "2020-08-08T05:59:33Z", "author": {"login": "xushiyan"}, "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/HoodieTestUtils.java", "diffHunk": "@@ -99,7 +99,6 @@\n  */\n public class HoodieTestUtils {\n \n-  public static final String TEST_EXTENSION = \".test\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bfcdd491225ab05543b12a8672e3b356b03238f0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM2NzUwNg==", "bodyText": "mark private to prevent new usage. to be replaced with HoodieTestTable, too.", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467367506", "createdAt": "2020-08-08T06:00:49Z", "author": {"login": "xushiyan"}, "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/HoodieTestUtils.java", "diffHunk": "@@ -279,8 +268,8 @@ public static String createDataFile(String basePath, String partitionPath, Strin\n     return fileID;\n   }\n \n-  public static String createDataFileFixLength(String basePath, String partitionPath, String instantTime, String fileID,\n-      long length) throws IOException {\n+  private static String createDataFileFixLength(String basePath, String partitionPath, String instantTime, String fileID,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bfcdd491225ab05543b12a8672e3b356b03238f0"}, "originalPosition": 106}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16fee78ac5926324f3ac6b3ecbf1168452f60e45", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/16fee78ac5926324f3ac6b3ecbf1168452f60e45", "committedDate": "2020-08-08T06:40:51Z", "message": "Trigger"}, "afterCommit": {"oid": "322aad91ca3d5eecc36ec3c4dbe6749f7d435172", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/322aad91ca3d5eecc36ec3c4dbe6749f7d435172", "committedDate": "2020-08-08T20:33:44Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "322aad91ca3d5eecc36ec3c4dbe6749f7d435172", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/322aad91ca3d5eecc36ec3c4dbe6749f7d435172", "committedDate": "2020-08-08T20:33:44Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}, "afterCommit": {"oid": "ddb560111ec9c752867c0e41752e83396a562664", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/ddb560111ec9c752867c0e41752e83396a562664", "committedDate": "2020-08-08T21:54:24Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzODQwNDE3", "url": "https://github.com/apache/hudi/pull/1871#pullrequestreview-463840417", "createdAt": "2020-08-09T03:29:07Z", "commit": {"oid": "ddb560111ec9c752867c0e41752e83396a562664"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQwMzoyOTowN1rOG93zog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQxMjoyNDo0N1rOG96qfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUzMDY1OA==", "bodyText": "IMO, The name of this class may make readers confused? It seems to represent that it is a utility class about testing file function. WDYT about renaming it to FileMockUtils?", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467530658", "createdAt": "2020-08-09T03:29:07Z", "author": {"login": "yanghua"}, "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/FilesTestUtils.java", "diffHunk": "@@ -0,0 +1,104 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.hudi.common.testutils;\n+\n+import org.apache.hudi.common.fs.FSUtils;\n+import org.apache.hudi.common.model.HoodieFileFormat;\n+import org.apache.hudi.common.model.IOType;\n+import org.apache.hudi.common.table.HoodieTableMetaClient;\n+import org.apache.hudi.common.table.timeline.HoodieTimeline;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.RandomAccessFile;\n+import java.nio.file.Files;\n+import java.nio.file.Paths;\n+\n+public class FilesTestUtils {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddb560111ec9c752867c0e41752e83396a562664"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzUzMTk1Nw==", "bodyText": "IMO, mock is a better naming than fake. mock is a more generic term in test field. Just a thought.", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467531957", "createdAt": "2020-08-09T03:48:12Z", "author": {"login": "yanghua"}, "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/FilesTestUtils.java", "diffHunk": "@@ -0,0 +1,104 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.hudi.common.testutils;\n+\n+import org.apache.hudi.common.fs.FSUtils;\n+import org.apache.hudi.common.model.HoodieFileFormat;\n+import org.apache.hudi.common.model.IOType;\n+import org.apache.hudi.common.table.HoodieTableMetaClient;\n+import org.apache.hudi.common.table.timeline.HoodieTimeline;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.RandomAccessFile;\n+import java.nio.file.Files;\n+import java.nio.file.Paths;\n+\n+public class FilesTestUtils {\n+\n+  private static void fakeMetaFile(String basePath, String instantTime, String suffix) throws IOException {\n+    String parentPath = basePath + \"/\" + HoodieTableMetaClient.METAFOLDER_NAME;\n+    new File(parentPath).mkdirs();\n+    new File(parentPath + \"/\" + instantTime + suffix).createNewFile();\n+  }\n+\n+  public static void fakeCommit(String basePath, String instantTime) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddb560111ec9c752867c0e41752e83396a562664"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU3NzEzOQ==", "bodyText": "Using Files.createFile(...) may be better?", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467577139", "createdAt": "2020-08-09T12:20:58Z", "author": {"login": "yanghua"}, "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/FilesTestUtils.java", "diffHunk": "@@ -0,0 +1,104 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.hudi.common.testutils;\n+\n+import org.apache.hudi.common.fs.FSUtils;\n+import org.apache.hudi.common.model.HoodieFileFormat;\n+import org.apache.hudi.common.model.IOType;\n+import org.apache.hudi.common.table.HoodieTableMetaClient;\n+import org.apache.hudi.common.table.timeline.HoodieTimeline;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.RandomAccessFile;\n+import java.nio.file.Files;\n+import java.nio.file.Paths;\n+\n+public class FilesTestUtils {\n+\n+  private static void fakeMetaFile(String basePath, String instantTime, String suffix) throws IOException {\n+    String parentPath = basePath + \"/\" + HoodieTableMetaClient.METAFOLDER_NAME;\n+    new File(parentPath).mkdirs();\n+    new File(parentPath + \"/\" + instantTime + suffix).createNewFile();\n+  }\n+\n+  public static void fakeCommit(String basePath, String instantTime) throws IOException {\n+    fakeMetaFile(basePath, instantTime, HoodieTimeline.COMMIT_EXTENSION);\n+  }\n+\n+  public static void fakeRequestedCommit(String basePath, String instantTime) throws IOException {\n+    fakeMetaFile(basePath, instantTime, HoodieTimeline.REQUESTED_COMMIT_EXTENSION);\n+  }\n+\n+  public static void fakeInflightCommit(String basePath, String instantTime) throws IOException {\n+    fakeMetaFile(basePath, instantTime, HoodieTimeline.INFLIGHT_COMMIT_EXTENSION);\n+  }\n+\n+  public static void fakeDeltaCommit(String basePath, String instantTime) throws IOException {\n+    fakeMetaFile(basePath, instantTime, HoodieTimeline.DELTA_COMMIT_EXTENSION);\n+  }\n+\n+  public static void fakeRequestedDeltaCommit(String basePath, String instantTime) throws IOException {\n+    fakeMetaFile(basePath, instantTime, HoodieTimeline.REQUESTED_DELTA_COMMIT_EXTENSION);\n+  }\n+\n+  public static void fakeInflightDeltaCommit(String basePath, String instantTime) throws IOException {\n+    fakeMetaFile(basePath, instantTime, HoodieTimeline.INFLIGHT_DELTA_COMMIT_EXTENSION);\n+  }\n+\n+  public static void fakeDataFile(String basePath, String partitionPath, String instantTime, String fileId)\n+      throws Exception {\n+    fakeDataFile(basePath, partitionPath, instantTime, fileId, 0);\n+  }\n+\n+  public static void fakeDataFile(String basePath, String partitionPath, String instantTime, String fileId, long length)\n+      throws Exception {\n+    String parentPath = String.format(\"%s/%s\", basePath, partitionPath);\n+    new File(parentPath).mkdirs();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddb560111ec9c752867c0e41752e83396a562664"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU3NzQ3MQ==", "bodyText": "Does this indentation style break the rule of the project?", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467577471", "createdAt": "2020-08-09T12:24:47Z", "author": {"login": "yanghua"}, "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/HoodieTestUtils.java", "diffHunk": "@@ -307,31 +299,26 @@ public static String createNewLogFile(FileSystem fs, String basePath, String par\n     return fileID;\n   }\n \n-  public static void createCompactionCommitFiles(FileSystem fs, String basePath, String... instantTimes)\n-      throws IOException {\n-    for (String instantTime : instantTimes) {\n-      boolean createFile = fs.createNewFile(new Path(basePath + \"/\" + HoodieTableMetaClient.METAFOLDER_NAME + \"/\"\n-          + HoodieTimeline.makeCommitFileName(instantTime)));\n-      if (!createFile) {\n-        throw new IOException(\"cannot create commit file for commit \" + instantTime);\n-      }\n-    }\n-  }\n-\n   public static void createCompactionRequest(HoodieTableMetaClient metaClient, String instant,\n-      List<Pair<String, FileSlice>> fileSliceList) throws IOException {\n+                                             List<Pair<String, FileSlice>> fileSliceList) throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddb560111ec9c752867c0e41752e83396a562664"}, "originalPosition": 141}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ddb560111ec9c752867c0e41752e83396a562664", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/ddb560111ec9c752867c0e41752e83396a562664", "committedDate": "2020-08-08T21:54:24Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}, "afterCommit": {"oid": "bf30a880892e2edb8f4f1f0740449ce3dd2aeb3f", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/bf30a880892e2edb8f4f1f0740449ce3dd2aeb3f", "committedDate": "2020-08-10T02:35:57Z", "message": "Use Files API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25e34cb49310a4cbab5640e9dac46080a189b760", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/25e34cb49310a4cbab5640e9dac46080a189b760", "committedDate": "2020-08-10T06:49:04Z", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b261c36d2dae6b4f3cb7259c25ddee39825d942", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/5b261c36d2dae6b4f3cb7259c25ddee39825d942", "committedDate": "2020-08-10T03:33:10Z", "message": "add TODO for newly added APIs"}, "afterCommit": {"oid": "9a1d1f3224b3aba14da1f8bec3092d6efe957640", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/9a1d1f3224b3aba14da1f8bec3092d6efe957640", "committedDate": "2020-08-10T06:49:05Z", "message": "rename FilesTestUtils to FileCreateUtils and rename APIs using `create`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce7c979304cc169685d493be9cb4434328afd2f2", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/ce7c979304cc169685d493be9cb4434328afd2f2", "committedDate": "2020-08-10T07:56:13Z", "message": "Use Files API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9abe1d29ef8d82c057bbd480bbc2b9f38e31cb7a", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/9abe1d29ef8d82c057bbd480bbc2b9f38e31cb7a", "committedDate": "2020-08-10T07:56:13Z", "message": "revert the indentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69e99fc9437e55248a8508f430088271616dd9d0", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/69e99fc9437e55248a8508f430088271616dd9d0", "committedDate": "2020-08-10T07:56:13Z", "message": "add TODO for newly added APIs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c841a398870142c5e153d924094dbd086d154e4", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/0c841a398870142c5e153d924094dbd086d154e4", "committedDate": "2020-08-10T07:56:13Z", "message": "rename FilesTestUtils to FileCreateUtils and rename APIs using `create`"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a1d1f3224b3aba14da1f8bec3092d6efe957640", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/9a1d1f3224b3aba14da1f8bec3092d6efe957640", "committedDate": "2020-08-10T06:49:05Z", "message": "rename FilesTestUtils to FileCreateUtils and rename APIs using `create`"}, "afterCommit": {"oid": "0c841a398870142c5e153d924094dbd086d154e4", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/0c841a398870142c5e153d924094dbd086d154e4", "committedDate": "2020-08-10T07:56:13Z", "message": "rename FilesTestUtils to FileCreateUtils and rename APIs using `create`"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0MTMxMTEz", "url": "https://github.com/apache/hudi/pull/1871#pullrequestreview-464131113", "createdAt": "2020-08-10T10:57:25Z", "commit": {"oid": "0c841a398870142c5e153d924094dbd086d154e4"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMDo1NzoyNVrOG-J6QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMDo1Nzo1NVrOG-J7Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzgyNzI2NA==", "bodyText": "Can we use Paths.get() to reduce link path parts via /?", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467827264", "createdAt": "2020-08-10T10:57:25Z", "author": {"login": "yanghua"}, "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/HoodieTestUtils.java", "diffHunk": "@@ -237,11 +229,12 @@ public static void createPendingCleanFiles(HoodieTableMetaClient metaClient, Str\n \n   public static void createCorruptedPendingCleanFiles(HoodieTableMetaClient metaClient, String commitTime) {\n     Arrays.asList(HoodieTimeline.makeRequestedCleanerFileName(commitTime),\n-        HoodieTimeline.makeInflightCleanerFileName(commitTime)).forEach(f -> {\n+        HoodieTimeline.makeInflightCleanerFileName(commitTime))\n+        .forEach(f -> {\n           FSDataOutputStream os = null;\n           try {\n             Path commitFile = new Path(\n-                    metaClient.getBasePath() + \"/\" + HoodieTableMetaClient.METAFOLDER_NAME + \"/\" + f);\n+                metaClient.getBasePath() + \"/\" + HoodieTableMetaClient.METAFOLDER_NAME + \"/\" + f);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c841a398870142c5e153d924094dbd086d154e4"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzgyNzQ2Nw==", "bodyText": "Why do we need to break the forEach?", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467827467", "createdAt": "2020-08-10T10:57:55Z", "author": {"login": "yanghua"}, "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/HoodieTestUtils.java", "diffHunk": "@@ -237,11 +229,12 @@ public static void createPendingCleanFiles(HoodieTableMetaClient metaClient, Str\n \n   public static void createCorruptedPendingCleanFiles(HoodieTableMetaClient metaClient, String commitTime) {\n     Arrays.asList(HoodieTimeline.makeRequestedCleanerFileName(commitTime),\n-        HoodieTimeline.makeInflightCleanerFileName(commitTime)).forEach(f -> {\n+        HoodieTimeline.makeInflightCleanerFileName(commitTime))\n+        .forEach(f -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c841a398870142c5e153d924094dbd086d154e4"}, "originalPosition": 92}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33b0d1073938ca8d1cfe95ca873792fcaf0522b5", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/33b0d1073938ca8d1cfe95ca873792fcaf0522b5", "committedDate": "2020-08-10T16:28:42Z", "message": "use Paths API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0Njk0MTM5", "url": "https://github.com/apache/hudi/pull/1871#pullrequestreview-464694139", "createdAt": "2020-08-11T01:43:35Z", "commit": {"oid": "33b0d1073938ca8d1cfe95ca873792fcaf0522b5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4707, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}