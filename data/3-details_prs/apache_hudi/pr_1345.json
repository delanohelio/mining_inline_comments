{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3OTM3MjA4", "number": 1345, "title": "[HUDI-618] Adding unit tests for PriorityBasedFileSystemView", "bodyText": "What is the purpose of the pull request\n\nThis PR is to address the JIRA ticket - HUDI-618\nAdded unit tests for org.apache.hudi.common.table.view. PriorityBasedFileSystemView\nRefactored DRY code in org.apache.hudi.common.table.view.RemoteHoodieTableFileSystemView\n\nBrief change log\n\nAdded unit tests to org.apache.hudi.common.table.view. PriorityBasedFileSystemView for improving code coverage\n\nVerify this pull request\n\nChecked code coverage to ensure all methods and branches are covered\nRun all tests to ensure refactoring didn't break anything\n\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-02-20T19:38:08Z", "url": "https://github.com/apache/hudi/pull/1345", "merged": true, "mergeCommit": {"oid": "b7f35be452078f2941fb98a310b385c3afd971fc"}, "closed": true, "closedAt": "2020-02-26T18:55:03Z", "author": {"login": "ramachandranms"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGQNAfgH2gAyMzc3OTM3MjA4OmNkZWU5NTU3Mzc1YmM2M2RiMzdmMDNkMmZmMGVkMTlmOGFiZDc5YWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcILZKbgFqTM2NTE1NTA5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cdee9557375bc63db37f03d2ff0ed19f8abd79ad", "author": {"user": {"login": "ramachandranms", "name": "Ramachandran M S"}}, "url": "https://github.com/apache/hudi/commit/cdee9557375bc63db37f03d2ff0ed19f8abd79ad", "committedDate": "2020-02-20T19:22:19Z", "message": "Adding unit tests for PriorityBasedFileSystemView"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d791b155e4198c62f1325b10fd06a30652e52a1", "author": {"user": {"login": "ramachandranms", "name": "Ramachandran M S"}}, "url": "https://github.com/apache/hudi/commit/4d791b155e4198c62f1325b10fd06a30652e52a1", "committedDate": "2020-02-20T19:59:18Z", "message": "Adding missing licence to test file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51f3d61c6446f5d65bd743c6e8b47eeaae0ace4b", "author": {"user": {"login": "ramachandranms", "name": "Ramachandran M S"}}, "url": "https://github.com/apache/hudi/commit/51f3d61c6446f5d65bd743c6e8b47eeaae0ace4b", "committedDate": "2020-02-20T21:56:05Z", "message": "Renaming test file to match naming convention"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MTU1MDkx", "url": "https://github.com/apache/hudi/pull/1345#pullrequestreview-365155091", "createdAt": "2020-02-26T18:53:42Z", "commit": {"oid": "51f3d61c6446f5d65bd743c6e8b47eeaae0ace4b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxODo1Mzo0MlrOFu342g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxODo1Mzo0MlrOFu342g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY5NDQ5MA==", "bodyText": "Thanks for the cleanup.", "url": "https://github.com/apache/hudi/pull/1345#discussion_r384694490", "createdAt": "2020-02-26T18:53:42Z", "author": {"login": "bvaradar"}, "path": "hudi-common/src/main/java/org/apache/hudi/common/table/view/RemoteHoodieTableFileSystemView.java", "diffHunk": "@@ -207,20 +207,18 @@ public RemoteHoodieTableFileSystemView(String server, int port, HoodieTableMetaC\n   @Override\n   public Stream<HoodieBaseFile> getLatestBaseFiles(String partitionPath) {\n     Map<String, String> paramsMap = getParamsWithPartitionPath(partitionPath);\n-    try {\n-      List<BaseFileDTO> dataFiles = executeRequest(LATEST_PARTITION_DATA_FILES_URL, paramsMap,\n-          new TypeReference<List<BaseFileDTO>>() {}, RequestMethod.GET);\n-      return dataFiles.stream().map(BaseFileDTO::toHoodieBaseFile);\n-    } catch (IOException e) {\n-      throw new HoodieRemoteException(e);\n-    }\n+    return getLatestBaseFilesFromParams(paramsMap, LATEST_PARTITION_DATA_FILES_URL);\n   }\n \n   @Override\n   public Stream<HoodieBaseFile> getLatestBaseFiles() {\n     Map<String, String> paramsMap = getParams();\n+    return getLatestBaseFilesFromParams(paramsMap, LATEST_ALL_DATA_FILES);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51f3d61c6446f5d65bd743c6e8b47eeaae0ace4b"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3602, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}