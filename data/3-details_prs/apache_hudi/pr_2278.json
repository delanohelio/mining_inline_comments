{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2NTI2MDUx", "number": 2278, "title": "[HUDI-1412] Make HoodieWriteConfig support setting different default \u2026", "bodyText": "\u2026value according to engine type\nTips\n\nThank you very much for contributing to Apache Hudi.\nPlease review https://hudi.apache.org/contributing.html before opening a pull request.\n\nWhat is the purpose of the pull request\nMake HoodieWriteConfig support setting different default value according to engine type\nBrief change log\nCurrently, HoodieIndexConfig set its default index type to bloom, which is suitable for spark engine.\nBut\uff0csince hoodie has supported flink engine, we should support default values setted according to engine user used.\nVerify this pull request\nThis pull request is already covered by existing tests, such as org.apache.hudi.config.TestHoodieWriteConfig#testDefaultIndexAccordingToEngineType.\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-11-24T14:40:33Z", "url": "https://github.com/apache/hudi/pull/2278", "merged": true, "mergeCommit": {"oid": "de2fbeac334e65abee38f5f5867805ad07b8dcd2"}, "closed": true, "closedAt": "2020-12-07T01:29:54Z", "author": {"login": "wangxianghu"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfq40tABqjQwMzMxOTgyNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdjrRYKgFqTU0NTc3OTEwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "12b85dc303715a4e302dd995b5ff5a973888993a", "author": {"user": {"login": "wangxianghu", "name": "wangxianghu"}}, "url": "https://github.com/apache/hudi/commit/12b85dc303715a4e302dd995b5ff5a973888993a", "committedDate": "2020-11-24T14:32:43Z", "message": "[HUDI-1412] Make HoodieWriteConfig support setting different default value according to engine type"}, "afterCommit": {"oid": "40c6d2374dabac1586fc50d56659c36b907735e1", "author": {"user": {"login": "wangxianghu", "name": "wangxianghu"}}, "url": "https://github.com/apache/hudi/commit/40c6d2374dabac1586fc50d56659c36b907735e1", "committedDate": "2020-11-24T14:44:35Z", "message": "[HUDI-1412] Make HoodieWriteConfig support setting different default value according to engine type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5OTA5MzE3", "url": "https://github.com/apache/hudi/pull/2278#pullrequestreview-539909317", "createdAt": "2020-11-27T11:30:24Z", "commit": {"oid": "40c6d2374dabac1586fc50d56659c36b907735e1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTozMDoyNFrOH67BQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTozMDoyNFrOH67BQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTU0NjQzNQ==", "bodyText": "Can we put this definition into hudi-client-common?", "url": "https://github.com/apache/hudi/pull/2278#discussion_r531546435", "createdAt": "2020-11-27T11:30:24Z", "author": {"login": "yanghua"}, "path": "hudi-common/src/main/java/org/apache/hudi/common/model/EngineType.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.common.model;\n+\n+/**\n+ * Hoodie data processing engine. support only Apache Spark and Apache Flink for now.\n+ */\n+public enum EngineType {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c6d2374dabac1586fc50d56659c36b907735e1"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwNDczNTQx", "url": "https://github.com/apache/hudi/pull/2278#pullrequestreview-540473541", "createdAt": "2020-11-29T12:06:22Z", "commit": {"oid": "40c6d2374dabac1586fc50d56659c36b907735e1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOVQxMjowNjoyMlrOH7i6_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOVQxMjowNjoyMlrOH7i6_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjIwMDE5MA==", "bodyText": "Are there other configurations that are different in different engines, and if there are many, are they easy to implement in this way?", "url": "https://github.com/apache/hudi/pull/2278#discussion_r532200190", "createdAt": "2020-11-29T12:06:22Z", "author": {"login": "shenh062326"}, "path": "hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieIndexConfig.java", "diffHunk": "@@ -278,5 +299,16 @@ public HoodieIndexConfig build() {\n       HoodieIndex.IndexType.valueOf(props.getProperty(INDEX_TYPE_PROP));\n       return config;\n     }\n+\n+    private String getDefaultIndexType(EngineType engineType) {\n+      switch (engineType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c6d2374dabac1586fc50d56659c36b907735e1"}, "originalPosition": 73}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58ef8d6b8bbcda89adfe6d2e54e73ddbe9c994a1", "author": {"user": {"login": "wangxianghu", "name": "wangxianghu"}}, "url": "https://github.com/apache/hudi/commit/58ef8d6b8bbcda89adfe6d2e54e73ddbe9c994a1", "committedDate": "2020-12-04T08:06:41Z", "message": "[HUDI-1412] Make HoodieWriteConfig support setting different default value according to engine type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1d818e49c7f7f47e2655eac69b17594ded5b502", "author": {"user": {"login": "wangxianghu", "name": "wangxianghu"}}, "url": "https://github.com/apache/hudi/commit/f1d818e49c7f7f47e2655eac69b17594ded5b502", "committedDate": "2020-12-04T08:10:31Z", "message": "move EngineType to hudi-client-common modeule"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "37b075a2d9993d954e2458b64255c672c65d3604", "author": {"user": {"login": "wangxianghu", "name": "wangxianghu"}}, "url": "https://github.com/apache/hudi/commit/37b075a2d9993d954e2458b64255c672c65d3604", "committedDate": "2020-12-04T07:36:42Z", "message": "move EngineType to hudi-client-common modeule"}, "afterCommit": {"oid": "f1d818e49c7f7f47e2655eac69b17594ded5b502", "author": {"user": {"login": "wangxianghu", "name": "wangxianghu"}}, "url": "https://github.com/apache/hudi/commit/f1d818e49c7f7f47e2655eac69b17594ded5b502", "committedDate": "2020-12-04T08:10:31Z", "message": "move EngineType to hudi-client-common modeule"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1MDE5MDQ1", "url": "https://github.com/apache/hudi/pull/2278#pullrequestreview-545019045", "createdAt": "2020-12-04T14:43:58Z", "commit": {"oid": "f1d818e49c7f7f47e2655eac69b17594ded5b502"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNDo0Mzo1OFrOH_T7bA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxNDo0Mzo1OFrOH_T7bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE0ODg0NA==", "bodyText": "how about adding a method withEngineType() instead of making it a Builder constructor param?", "url": "https://github.com/apache/hudi/pull/2278#discussion_r536148844", "createdAt": "2020-12-04T14:43:58Z", "author": {"login": "leesf"}, "path": "hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "diffHunk": "@@ -789,6 +809,14 @@ public Long getMaxMemoryPerPartitionMerge() {\n     private boolean isConsistencyGuardSet = false;\n     private boolean isCallbackConfigSet = false;\n \n+    public Builder() {\n+      this(EngineType.SPARK);\n+    }\n+\n+    public Builder(EngineType engineType) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1d818e49c7f7f47e2655eac69b17594ded5b502"}, "originalPosition": 81}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d1275ff8ec12d50239dbc2ae4f6aad4127171fb", "author": {"user": {"login": "wangxianghu", "name": "wangxianghu"}}, "url": "https://github.com/apache/hudi/commit/2d1275ff8ec12d50239dbc2ae4f6aad4127171fb", "committedDate": "2020-12-05T06:04:46Z", "message": "add withEngineType to Builder"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3e273f8b88d877ca8b2b0701e851e631bcba8f80", "author": {"user": {"login": "wangxianghu", "name": "wangxianghu"}}, "url": "https://github.com/apache/hudi/commit/3e273f8b88d877ca8b2b0701e851e631bcba8f80", "committedDate": "2020-12-05T05:56:20Z", "message": "add withEngineType to Builder"}, "afterCommit": {"oid": "2d1275ff8ec12d50239dbc2ae4f6aad4127171fb", "author": {"user": {"login": "wangxianghu", "name": "wangxianghu"}}, "url": "https://github.com/apache/hudi/commit/2d1275ff8ec12d50239dbc2ae4f6aad4127171fb", "committedDate": "2020-12-05T06:04:46Z", "message": "add withEngineType to Builder"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NzAwNDEx", "url": "https://github.com/apache/hudi/pull/2278#pullrequestreview-545700411", "createdAt": "2020-12-06T12:26:45Z", "commit": {"oid": "2d1275ff8ec12d50239dbc2ae4f6aad4127171fb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1Nzc5MTAz", "url": "https://github.com/apache/hudi/pull/2278#pullrequestreview-545779103", "createdAt": "2020-12-07T01:29:29Z", "commit": {"oid": "2d1275ff8ec12d50239dbc2ae4f6aad4127171fb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4353, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}