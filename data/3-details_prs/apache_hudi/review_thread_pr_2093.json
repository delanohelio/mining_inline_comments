{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4MTY2MzE2", "number": 2093, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOVQwOTo0MjoyNFrOElOCsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOVQwOTo0MjoyNFrOElOCsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3NDYyODMyOnYy", "diffSide": "RIGHT", "path": "hudi-spark/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOVQwOTo0MjoyNFrOHUl3TQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQxODozMzo0OVrOHcJVzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTM1MzkzMw==", "bodyText": "Hey, Since there is a protected config field in KeyGenerator, which can be shared with all subclasses. Why do not we check that must be non-nullable?", "url": "https://github.com/apache/hudi/pull/2093#discussion_r491353933", "createdAt": "2020-09-19T09:42:24Z", "author": {"login": "yanghua"}, "path": "hudi-spark/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java", "diffHunk": "@@ -58,6 +59,7 @@\n \n   public CustomKeyGenerator(TypedProperties props) {\n     super(props);\n+    this.props = props;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7232efe9b197e07c0dbbbfdf73da7f87613be30"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk0MTMyMg==", "bodyText": "+1  there is no need to duplicate this again in the sub class right.", "url": "https://github.com/apache/hudi/pull/2093#discussion_r492941322", "createdAt": "2020-09-22T18:18:44Z", "author": {"login": "vinothchandar"}, "path": "hudi-spark/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java", "diffHunk": "@@ -58,6 +59,7 @@\n \n   public CustomKeyGenerator(TypedProperties props) {\n     super(props);\n+    this.props = props;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTM1MzkzMw=="}, "originalCommit": {"oid": "a7232efe9b197e07c0dbbbfdf73da7f87613be30"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk3MTg0OQ==", "bodyText": "@yanghua due to serialization and config field being transient, the issue is happening. In CustomKeyGenerator, we try to initialise new object of SimpleKeyGenerator and TimestampBasedKeyGenerator using config object, that is where NPE occurs. The only good way I can think of is to introduce a TimestampBasedKeyGenerator object in CustomKeyGenerator and call getPartitionPath method using this object. Let me do the changes here.", "url": "https://github.com/apache/hudi/pull/2093#discussion_r492971849", "createdAt": "2020-09-22T19:09:50Z", "author": {"login": "pratyakshsharma"}, "path": "hudi-spark/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java", "diffHunk": "@@ -58,6 +59,7 @@\n \n   public CustomKeyGenerator(TypedProperties props) {\n     super(props);\n+    this.props = props;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTM1MzkzMw=="}, "originalCommit": {"oid": "a7232efe9b197e07c0dbbbfdf73da7f87613be30"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODg1OTY0MQ==", "bodyText": "@pratyakshsharma : Why does config field need to be transient ?", "url": "https://github.com/apache/hudi/pull/2093#discussion_r498859641", "createdAt": "2020-10-02T14:32:57Z", "author": {"login": "bvaradar"}, "path": "hudi-spark/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java", "diffHunk": "@@ -58,6 +59,7 @@\n \n   public CustomKeyGenerator(TypedProperties props) {\n     super(props);\n+    this.props = props;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTM1MzkzMw=="}, "originalCommit": {"oid": "a7232efe9b197e07c0dbbbfdf73da7f87613be30"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3NTIxNA==", "bodyText": "@bvaradar It has been like this from the very beginning. I am not sure of the reason though. Making config field non-transient is the easiest fix possible here.", "url": "https://github.com/apache/hudi/pull/2093#discussion_r499275214", "createdAt": "2020-10-04T18:33:49Z", "author": {"login": "pratyakshsharma"}, "path": "hudi-spark/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java", "diffHunk": "@@ -58,6 +59,7 @@\n \n   public CustomKeyGenerator(TypedProperties props) {\n     super(props);\n+    this.props = props;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTM1MzkzMw=="}, "originalCommit": {"oid": "a7232efe9b197e07c0dbbbfdf73da7f87613be30"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4286, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}