{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0NDc0NTUz", "number": 2129, "title": "[HUDI-1302] Add support for timestamp field in HiveSync", "bodyText": "What is the purpose of the pull request\nAdd support for timestamp field in HiveSync\nBrief change log\n\nHudi HiveSyncTool converts int64 fields to 'bigint' hive type.\nThere are use cases where we want to convert this to 'timestamp' type when corresponding parquet original type is TIMESTAMP_MICROS (We can also consider doing this for TIMESTAMP_MILLIS?)\nThis has to be done in backward compatible way, so already synced tables will continue to get hive type as 'bigint'. We can enable 'timestamp' conversion by overriding sync config with a new flag.\n\nVerify this pull request\nThis change added tests. Also verified with steps in docker demo. Testing in staging in progress.\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-09-29T00:41:13Z", "url": "https://github.com/apache/hudi/pull/2129", "merged": true, "mergeCommit": {"oid": "7fa641ea9ad2318b185f8492964b30ebc90759b0"}, "closed": true, "closedAt": "2020-10-14T05:58:01Z", "author": {"login": "satishkotha"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNuZ6LgBqjM4MjE1OTYzNzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSWvqxgFqTUwODAxNjI2MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e6b74e87e1ded3cd1885364416184d5568e0c70e", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/e6b74e87e1ded3cd1885364416184d5568e0c70e", "committedDate": "2020-09-28T22:47:33Z", "message": "[HUDI-1302] Add support for timestamp field in HiveSync"}, "afterCommit": {"oid": "86965e6031a38cf85be3a056be3c58521cd38eba", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/86965e6031a38cf85be3a056be3c58521cd38eba", "committedDate": "2020-09-29T20:41:52Z", "message": "[HUDI-1302] Add support for timestamp field in HiveSync"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNzk3NTk1", "url": "https://github.com/apache/hudi/pull/2129#pullrequestreview-500797595", "createdAt": "2020-10-02T00:21:04Z", "commit": {"oid": "86965e6031a38cf85be3a056be3c58521cd38eba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMDoyMTowNVrOHbeZSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQwMDoyMTowNVrOHbeZSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODU3MTU5Mg==", "bodyText": "I think we need to add this option into DataSourceOptions, DataSourceUtils, and HoodieSparkSqlWriter\nsomething like?\n\"hoodie.datasource.hive_sync.support_timestamp\"", "url": "https://github.com/apache/hudi/pull/2129#discussion_r498571592", "createdAt": "2020-10-02T00:21:05Z", "author": {"login": "bschell"}, "path": "hudi-sync/hudi-dla-sync/src/main/java/org/apache/hudi/dla/DLASyncConfig.java", "diffHunk": "@@ -68,6 +68,9 @@\n   @Parameter(names = {\"--help\", \"-h\"}, help = true)\n   public Boolean help = false;\n \n+  @Parameter(names = {\"--support-timestamp\"}, description = \"If true, converts int64(timestamp_micros) to timestamp type\")\n+  public Boolean supportTimestamp = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86965e6031a38cf85be3a056be3c58521cd38eba"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0e1ae8757f0ba5968088d9b392f675173c61f44", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/e0e1ae8757f0ba5968088d9b392f675173c61f44", "committedDate": "2020-10-02T05:33:35Z", "message": "[HUDI-1302] Add support for timestamp field in HiveSync"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86965e6031a38cf85be3a056be3c58521cd38eba", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/86965e6031a38cf85be3a056be3c58521cd38eba", "committedDate": "2020-09-29T20:41:52Z", "message": "[HUDI-1302] Add support for timestamp field in HiveSync"}, "afterCommit": {"oid": "e0e1ae8757f0ba5968088d9b392f675173c61f44", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/e0e1ae8757f0ba5968088d9b392f675173c61f44", "committedDate": "2020-10-02T05:33:35Z", "message": "[HUDI-1302] Add support for timestamp field in HiveSync"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNzcxMzg4", "url": "https://github.com/apache/hudi/pull/2129#pullrequestreview-501771388", "createdAt": "2020-10-05T07:11:10Z", "commit": {"oid": "e0e1ae8757f0ba5968088d9b392f675173c61f44"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQwNzoxMToxMVrOHcP-RA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQwNzoxMToxMVrOHcP-RA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM4Mzg3Ng==", "bodyText": "Could you please explain what happens now if the originalType  == OriginalType.TIMESTAMP_MICROS ?", "url": "https://github.com/apache/hudi/pull/2129#discussion_r499383876", "createdAt": "2020-10-05T07:11:11Z", "author": {"login": "n3nash"}, "path": "hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java", "diffHunk": "@@ -167,7 +173,10 @@ private static String convertField(final Type parquetType) {\n             .append(decimalMetadata.getScale()).append(\")\").toString();\n       } else if (originalType == OriginalType.DATE) {\n         return field.append(\"DATE\").toString();\n+      } else if (supportTimestamp && originalType == OriginalType.TIMESTAMP_MICROS) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0e1ae8757f0ba5968088d9b392f675173c61f44"}, "originalPosition": 59}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNzcyOTYx", "url": "https://github.com/apache/hudi/pull/2129#pullrequestreview-501772961", "createdAt": "2020-10-05T07:13:51Z", "commit": {"oid": "e0e1ae8757f0ba5968088d9b392f675173c61f44"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MDE2MjYw", "url": "https://github.com/apache/hudi/pull/2129#pullrequestreview-508016260", "createdAt": "2020-10-14T05:57:51Z", "commit": {"oid": "e0e1ae8757f0ba5968088d9b392f675173c61f44"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4611, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}