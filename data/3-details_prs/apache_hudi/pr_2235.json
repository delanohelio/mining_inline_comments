{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2NjA3MDkx", "number": 2235, "title": "[HUDI-1377] remove duplicate code in HoodieSparkSqlWriter", "bodyText": "Tips\n\nThank you very much for contributing to Apache Hudi.\nPlease review https://hudi.apache.org/contributing.html before opening a pull request.\n\nWhat is the purpose of the pull request\nremove duplicate code in HoodieSparkSqlWriter\nBrief change log\nfound convertStructTypeToAvroSchema in HoodieSparkSqlWriter twice.It's not necessary\nVerify this pull request\nThis pull request is a trivial rework / code cleanup without any test coverage.\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-11-06T09:04:45Z", "url": "https://github.com/apache/hudi/pull/2235", "merged": true, "mergeCommit": {"oid": "430d4b428e7c5b325c7414a187f9cda158c2758a"}, "closed": true, "closedAt": "2020-11-10T18:08:09Z", "author": {"login": "Karl-WangSK"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZzEcKgH2gAyNTE2NjA3MDkxOmRjMTM2M2E3ZDc2NjdhMzlmOTlmZWQzMDI2ZDBlZTYwMmVhMTFiZjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZ3HVgAFqTUyNTE1NDkyNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dc1363a7d7667a39f99fed3026d0ee602ea11bf7", "author": {"user": {"login": "Karl-WangSK", "name": "Karl_Wang"}}, "url": "https://github.com/apache/hudi/commit/dc1363a7d7667a39f99fed3026d0ee602ea11bf7", "committedDate": "2020-11-06T08:55:21Z", "message": "remove duplicate code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71f365bf649423b1399a460ad7fe17bdca982d4d", "author": {"user": {"login": "Karl-WangSK", "name": "Karl_Wang"}}, "url": "https://github.com/apache/hudi/commit/71f365bf649423b1399a460ad7fe17bdca982d4d", "committedDate": "2020-11-06T09:06:53Z", "message": "Merge branch 'master' into HUDI-1377"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1MTU0OTI1", "url": "https://github.com/apache/hudi/pull/2235#pullrequestreview-525154925", "createdAt": "2020-11-06T13:37:59Z", "commit": {"oid": "71f365bf649423b1399a460ad7fe17bdca982d4d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMzozODowMFrOHuuU7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMzozODowMFrOHuuU7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODc1NTU2NQ==", "bodyText": "Good Catch", "url": "https://github.com/apache/hudi/pull/2235#discussion_r518755565", "createdAt": "2020-11-06T13:38:00Z", "author": {"login": "wangxianghu"}, "path": "hudi-spark/src/main/scala/org/apache/hudi/HoodieSparkSqlWriter.scala", "diffHunk": "@@ -140,7 +140,7 @@ private[hudi] object HoodieSparkSqlWriter {\n \n           // Convert to RDD[HoodieRecord]\n           val keyGenerator = DataSourceUtils.createKeyGenerator(toProperties(parameters))\n-          val genericRecords: RDD[GenericRecord] = AvroConversionUtils.createRdd(df, structName, nameSpace)\n+          val genericRecords: RDD[GenericRecord] = AvroConversionUtils.createRdd(df, schema, structName, nameSpace)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71f365bf649423b1399a460ad7fe17bdca982d4d"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4279, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}