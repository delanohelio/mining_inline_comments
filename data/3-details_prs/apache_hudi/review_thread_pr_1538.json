{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MTQ5Mzc5", "number": 1538, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwMzo0NTozNlrOD0ixnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwMDozNzoxNlrOD8SIeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2NDIyMzAwOnYy", "diffSide": "RIGHT", "path": "hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwMzo0NTozNlrOGJh-Dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxMjoxMzoyNFrOGJzFjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY0NjkyNw==", "bodyText": "this need not be public right.. just being package protected will allow you to access this in tests?", "url": "https://github.com/apache/hudi/pull/1538#discussion_r412646927", "createdAt": "2020-04-22T03:45:36Z", "author": {"login": "vinothchandar"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java", "diffHunk": "@@ -60,7 +61,7 @@\n   private static ThreadLocal<BinaryDecoder> reuseDecoder = ThreadLocal.withInitial(() -> null);\n \n   // All metadata fields are optional strings.\n-  private static final Schema METADATA_FIELD_SCHEMA =\n+  public static final Schema METADATA_FIELD_SCHEMA =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b13db4d9f6d17c0fa7e8dfcb6f15f4530385ba69"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkyNzM3NQ==", "bodyText": "Done.", "url": "https://github.com/apache/hudi/pull/1538#discussion_r412927375", "createdAt": "2020-04-22T12:13:24Z", "author": {"login": "pratyakshsharma"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java", "diffHunk": "@@ -60,7 +61,7 @@\n   private static ThreadLocal<BinaryDecoder> reuseDecoder = ThreadLocal.withInitial(() -> null);\n \n   // All metadata fields are optional strings.\n-  private static final Schema METADATA_FIELD_SCHEMA =\n+  public static final Schema METADATA_FIELD_SCHEMA =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY0NjkyNw=="}, "originalCommit": {"oid": "b13db4d9f6d17c0fa7e8dfcb6f15f4530385ba69"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2NDIyNTEyOnYy", "diffSide": "RIGHT", "path": "hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwMzo0NjoxOVrOGJh_HA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwNTo1MTo1OVrOGJkibg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY0NzE5Ng==", "bodyText": "@afilipchik to get your eyes on this as well ..", "url": "https://github.com/apache/hudi/pull/1538#discussion_r412647196", "createdAt": "2020-04-22T03:46:19Z", "author": {"login": "vinothchandar"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java", "diffHunk": "@@ -214,7 +215,11 @@ private static GenericRecord rewrite(GenericRecord record, LinkedHashSet<Field>\n     GenericRecord newRecord = new GenericData.Record(newSchema);\n     for (Schema.Field f : fieldsToWrite) {\n       if (record.get(f.name()) == null) {\n-        newRecord.put(f.name(), f.defaultVal());\n+        if (f.defaultVal() instanceof JsonProperties.Null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b13db4d9f6d17c0fa7e8dfcb6f15f4530385ba69"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY4OTAwNg==", "bodyText": "This code change is exactly what @afilipchik did in his PR :)\nI have just added some more test cases to be sure nothing breaks around default values.", "url": "https://github.com/apache/hudi/pull/1538#discussion_r412689006", "createdAt": "2020-04-22T05:51:59Z", "author": {"login": "pratyakshsharma"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java", "diffHunk": "@@ -214,7 +215,11 @@ private static GenericRecord rewrite(GenericRecord record, LinkedHashSet<Field>\n     GenericRecord newRecord = new GenericData.Record(newSchema);\n     for (Schema.Field f : fieldsToWrite) {\n       if (record.get(f.name()) == null) {\n-        newRecord.put(f.name(), f.defaultVal());\n+        if (f.defaultVal() instanceof JsonProperties.Null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjY0NzE5Ng=="}, "originalCommit": {"oid": "b13db4d9f6d17c0fa7e8dfcb6f15f4530385ba69"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY0NTM4MjMyOnYy", "diffSide": "RIGHT", "path": "hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwMDozNzoxNlrOGVIMcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwMDozNzoxNlrOGVIMcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgwNzUzOQ==", "bodyText": "just removing private should make this easy for testing... i.e package private as opposed to protected?", "url": "https://github.com/apache/hudi/pull/1538#discussion_r424807539", "createdAt": "2020-05-14T00:37:16Z", "author": {"login": "vinothchandar"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java", "diffHunk": "@@ -60,7 +61,7 @@\n   private static ThreadLocal<BinaryDecoder> reuseDecoder = ThreadLocal.withInitial(() -> null);\n \n   // All metadata fields are optional strings.\n-  private static final Schema METADATA_FIELD_SCHEMA =\n+  protected static final Schema METADATA_FIELD_SCHEMA =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f1925e8e08efa6ef017faf1d7a5327d65313b60"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4805, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}