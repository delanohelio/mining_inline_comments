{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzNDM1MTk4", "number": 1517, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNjoxMzowOVrODyJOsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNjoxMzowOVrODyJOsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzOTA2NjA5OnYy", "diffSide": "RIGHT", "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNjoxMzowOVrOGGBO7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwMDoxMzo1OVrOGGP-lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk2NDg0Ng==", "bodyText": "Let us make it flexible in HoodieMultiTableDeltaStreamer as well?", "url": "https://github.com/apache/hudi/pull/1517#discussion_r408964846", "createdAt": "2020-04-15T16:13:09Z", "author": {"login": "pratyakshsharma"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -391,7 +391,9 @@ public DeltaSyncService(Config cfg, JavaSparkContext jssc, FileSystem fs, HiveCo\n       ValidationUtils.checkArgument(!cfg.filterDupes || cfg.operation != Operation.UPSERT,\n           \"'--filter-dupes' needs to be disabled when '--op' is 'UPSERT' to ensure updates are not missed.\");\n \n-      this.props = properties != null ? properties : UtilHelpers.readConfig(fs, new Path(cfg.propsFilePath), cfg.configs).getConfig();\n+      this.props = properties != null ? properties : UtilHelpers.readConfig(\n+          FSUtils.getFs(cfg.propsFilePath, jssc.hadoopConfiguration()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "577f2872a316d91587b81be3a7b978df95ffc6b0"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTIwNTM5Mg==", "bodyText": "sure", "url": "https://github.com/apache/hudi/pull/1517#discussion_r409205392", "createdAt": "2020-04-16T00:10:33Z", "author": {"login": "afilipchik"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -391,7 +391,9 @@ public DeltaSyncService(Config cfg, JavaSparkContext jssc, FileSystem fs, HiveCo\n       ValidationUtils.checkArgument(!cfg.filterDupes || cfg.operation != Operation.UPSERT,\n           \"'--filter-dupes' needs to be disabled when '--op' is 'UPSERT' to ensure updates are not missed.\");\n \n-      this.props = properties != null ? properties : UtilHelpers.readConfig(fs, new Path(cfg.propsFilePath), cfg.configs).getConfig();\n+      this.props = properties != null ? properties : UtilHelpers.readConfig(\n+          FSUtils.getFs(cfg.propsFilePath, jssc.hadoopConfiguration()),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk2NDg0Ng=="}, "originalCommit": {"oid": "577f2872a316d91587b81be3a7b978df95ffc6b0"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTIwNjQyMg==", "bodyText": "I think it is already doing that:\n FileSystem fs = FSUtils.getFs(commonPropsFile, jssc.hadoopConfiguration());", "url": "https://github.com/apache/hudi/pull/1517#discussion_r409206422", "createdAt": "2020-04-16T00:13:59Z", "author": {"login": "afilipchik"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java", "diffHunk": "@@ -391,7 +391,9 @@ public DeltaSyncService(Config cfg, JavaSparkContext jssc, FileSystem fs, HiveCo\n       ValidationUtils.checkArgument(!cfg.filterDupes || cfg.operation != Operation.UPSERT,\n           \"'--filter-dupes' needs to be disabled when '--op' is 'UPSERT' to ensure updates are not missed.\");\n \n-      this.props = properties != null ? properties : UtilHelpers.readConfig(fs, new Path(cfg.propsFilePath), cfg.configs).getConfig();\n+      this.props = properties != null ? properties : UtilHelpers.readConfig(\n+          FSUtils.getFs(cfg.propsFilePath, jssc.hadoopConfiguration()),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk2NDg0Ng=="}, "originalCommit": {"oid": "577f2872a316d91587b81be3a7b978df95ffc6b0"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4777, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}