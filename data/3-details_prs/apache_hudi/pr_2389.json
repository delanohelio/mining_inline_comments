{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2MjkyMjYx", "number": 2389, "title": "[HUDI-1498] Read clustering plan from requested for inflight instant", "bodyText": "What is the purpose of the pull request\nInflight replacecommit has no content for clustering. Read corresponding ClusteringPlan from requested instant.\nBrief change log\nInflight replacecommit has no content for clustering. Read corresponding ClusteringPlan from requested instant.\nVerify this pull request\nThis change added tests\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-12-29T01:50:02Z", "url": "https://github.com/apache/hudi/pull/2389", "merged": true, "mergeCommit": {"oid": "698694a1571cdcc9848fc79aa34c8cbbf9662bc4"}, "closed": true, "closedAt": "2021-01-04T18:36:45Z", "author": {"login": "satishkotha"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdqxP-TgBqjQxNTM0NjM1NjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdsZxePABqjQxNjIxNjMzNzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a70b324d79f7429a2a4f9b2b530fbceb8b499275", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/a70b324d79f7429a2a4f9b2b530fbceb8b499275", "committedDate": "2020-12-29T01:44:35Z", "message": "[HUDI-1498] Read clustering plan from requested file for inflight instant"}, "afterCommit": {"oid": "6f24a4911757f510c3d3c3687dee13f7d6146711", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/6f24a4911757f510c3d3c3687dee13f7d6146711", "committedDate": "2020-12-29T02:24:09Z", "message": "[HUDI-1498] Read clustering plan from requested file for inflight instant"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5MzY4Njcx", "url": "https://github.com/apache/hudi/pull/2389#pullrequestreview-559368671", "createdAt": "2020-12-29T03:46:05Z", "commit": {"oid": "6f24a4911757f510c3d3c3687dee13f7d6146711"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMzo0NjowNVrOIMGVHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMzo0NjowNVrOIMGVHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NzUzNA==", "bodyText": "can we add some annotation such as \"do not have content in inflight instant\"", "url": "https://github.com/apache/hudi/pull/2389#discussion_r549557534", "createdAt": "2020-12-29T03:46:05Z", "author": {"login": "lw309637554"}, "path": "hudi-common/src/main/java/org/apache/hudi/common/util/ClusteringUtils.java", "diffHunk": "@@ -68,21 +69,27 @@\n         .filter(Option::isPresent).map(Option::get);\n   }\n \n-  public static Option<Pair<HoodieInstant, HoodieClusteringPlan>> getClusteringPlan(HoodieTableMetaClient metaClient, HoodieInstant requestedReplaceInstant) {\n+  public static Option<Pair<HoodieInstant, HoodieClusteringPlan>> getClusteringPlan(HoodieTableMetaClient metaClient, HoodieInstant pendingReplaceInstant) {\n     try {\n-      Option<byte[]> content = metaClient.getActiveTimeline().getInstantDetails(requestedReplaceInstant);\n+      final HoodieInstant requestedInstant;\n+      if (!pendingReplaceInstant.isRequested()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f24a4911757f510c3d3c3687dee13f7d6146711"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwMjEzMjg0", "url": "https://github.com/apache/hudi/pull/2389#pullrequestreview-560213284", "createdAt": "2020-12-30T22:00:58Z", "commit": {"oid": "6f24a4911757f510c3d3c3687dee13f7d6146711"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d237e988f083c9d6cfe2e2c093cd0d63ecd1aa5", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/2d237e988f083c9d6cfe2e2c093cd0d63ecd1aa5", "committedDate": "2021-01-03T04:10:15Z", "message": "[HUDI-1498] Read clustering plan from requested file for inflight instant"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f24a4911757f510c3d3c3687dee13f7d6146711", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/6f24a4911757f510c3d3c3687dee13f7d6146711", "committedDate": "2020-12-29T02:24:09Z", "message": "[HUDI-1498] Read clustering plan from requested file for inflight instant"}, "afterCommit": {"oid": "2d237e988f083c9d6cfe2e2c093cd0d63ecd1aa5", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/2d237e988f083c9d6cfe2e2c093cd0d63ecd1aa5", "committedDate": "2021-01-03T04:10:15Z", "message": "[HUDI-1498] Read clustering plan from requested file for inflight instant"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4130, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}