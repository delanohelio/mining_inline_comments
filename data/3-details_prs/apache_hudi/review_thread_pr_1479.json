{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3NzQzNzgw", "number": 1479, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQyMzoyNDowM1rODwM0dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQyMzoyNDowM1rODwM0dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxODY4Mjc4OnYy", "diffSide": "RIGHT", "path": "hudi-integ-test/src/test/java/org/apache/hudi/integ/ITTestHoodieDemo.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQyMzoyNDowM1rOGDEXxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQyMzoyNDowM1rOGDEXxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg3MDUzMw==", "bodyText": "minor nit: please consider renaming the variable to expectedOutput instead since its used across all types of tables.", "url": "https://github.com/apache/hudi/pull/1479#discussion_r405870533", "createdAt": "2020-04-08T23:24:03Z", "author": {"login": "bhasudha"}, "path": "hudi-integ-test/src/test/java/org/apache/hudi/integ/ITTestHoodieDemo.java", "diffHunk": "@@ -267,23 +270,37 @@ private void testSparkSQLAfterSecondBatch() throws Exception {\n     assertStdOutContains(stdOutErrPair, \"|GOOG  |2018-08-31 10:29:00|3391  |1230.1899|1230.085|\");\n   }\n \n-  private void testIncrementalHiveQuery() throws Exception {\n+  private void testIncrementalHiveQuery(String minCommitTimeScript, String incrementalCommandsFile,\n+                                        String expectedOutput, int expectedTimes) throws Exception {\n     String minCommitTime =\n-        executeCommandStringInDocker(ADHOC_2_CONTAINER, MIN_COMMIT_TIME_SCRIPT, true).getStdout().toString();\n+        executeCommandStringInDocker(ADHOC_2_CONTAINER, minCommitTimeScript, true).getStdout().toString();\n     Pair<String, String> stdOutErrPair =\n-        executeHiveCommandFile(HIVE_INCREMENTAL_COMMANDS, \"min.commit.time=\" + minCommitTime + \"`\");\n-    assertStdOutContains(stdOutErrPair, \"| GOOG    | 2018-08-31 10:59:00  | 9021    | 1227.1993  | 1227.215  |\");\n+        executeHiveCommandFile(incrementalCommandsFile, \"min.commit.time=\" + minCommitTime + \"`\");\n+    assertStdOutContains(stdOutErrPair, expectedOutput, expectedTimes);\n+  }\n+\n+  private void testIncrementalHiveQueryBeforeCompaction() throws Exception {\n+    String expectedOutputCOW = \"| GOOG    | 2018-08-31 10:59:00  | 9021    | 1227.1993  | 1227.215  |\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5655821022f04b01843bdca2f3951a46ef72ef"}, "originalPosition": 48}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4743, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}