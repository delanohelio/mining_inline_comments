{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3NzQzNzgw", "number": 1479, "title": "[HUDI-758] Modify Integration test to include incremental queries on MOR tables", "bodyText": "What is the purpose of the pull request\nExtend IntegrationTest to do incremental reads on MOR tables and validate responses\nBrief change log\nExtend IntegrationTest to do incremental reads on MOR tables and validate responses\nVerify this pull request\nITTestHoodieDemo only change.\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-04-02T18:23:31Z", "url": "https://github.com/apache/hudi/pull/1479", "merged": true, "mergeCommit": {"oid": "3c803421e0e138c223c9bec90f9b7c8a6751317d"}, "closed": true, "closedAt": "2020-04-09T04:57:00Z", "author": {"login": "satishkotha"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTwVfzAH2gAyMzk3NzQzNzgwOjFjNTY1NTgyMTAyMmYwNGIwMTg0M2JkY2EyZjM5NTFhNDZlZjcyZWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcV1L--gFqTM5MDQ5MDU0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1c5655821022f04b01843bdca2f3951a46ef72ef", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/1c5655821022f04b01843bdca2f3951a46ef72ef", "committedDate": "2020-04-02T18:09:34Z", "message": "[HUDI-758] Modify Integration test to include incremental queries for MOR tables"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMzk2Mzcw", "url": "https://github.com/apache/hudi/pull/1479#pullrequestreview-390396370", "createdAt": "2020-04-08T23:24:03Z", "commit": {"oid": "1c5655821022f04b01843bdca2f3951a46ef72ef"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQyMzoyNDowM1rOGDEXxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQyMzoyNDowM1rOGDEXxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg3MDUzMw==", "bodyText": "minor nit: please consider renaming the variable to expectedOutput instead since its used across all types of tables.", "url": "https://github.com/apache/hudi/pull/1479#discussion_r405870533", "createdAt": "2020-04-08T23:24:03Z", "author": {"login": "bhasudha"}, "path": "hudi-integ-test/src/test/java/org/apache/hudi/integ/ITTestHoodieDemo.java", "diffHunk": "@@ -267,23 +270,37 @@ private void testSparkSQLAfterSecondBatch() throws Exception {\n     assertStdOutContains(stdOutErrPair, \"|GOOG  |2018-08-31 10:29:00|3391  |1230.1899|1230.085|\");\n   }\n \n-  private void testIncrementalHiveQuery() throws Exception {\n+  private void testIncrementalHiveQuery(String minCommitTimeScript, String incrementalCommandsFile,\n+                                        String expectedOutput, int expectedTimes) throws Exception {\n     String minCommitTime =\n-        executeCommandStringInDocker(ADHOC_2_CONTAINER, MIN_COMMIT_TIME_SCRIPT, true).getStdout().toString();\n+        executeCommandStringInDocker(ADHOC_2_CONTAINER, minCommitTimeScript, true).getStdout().toString();\n     Pair<String, String> stdOutErrPair =\n-        executeHiveCommandFile(HIVE_INCREMENTAL_COMMANDS, \"min.commit.time=\" + minCommitTime + \"`\");\n-    assertStdOutContains(stdOutErrPair, \"| GOOG    | 2018-08-31 10:59:00  | 9021    | 1227.1993  | 1227.215  |\");\n+        executeHiveCommandFile(incrementalCommandsFile, \"min.commit.time=\" + minCommitTime + \"`\");\n+    assertStdOutContains(stdOutErrPair, expectedOutput, expectedTimes);\n+  }\n+\n+  private void testIncrementalHiveQueryBeforeCompaction() throws Exception {\n+    String expectedOutputCOW = \"| GOOG    | 2018-08-31 10:59:00  | 9021    | 1227.1993  | 1227.215  |\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c5655821022f04b01843bdca2f3951a46ef72ef"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0f6f42ce7bee8292ee3f6a40a0e4a1939d4d878", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/c0f6f42ce7bee8292ee3f6a40a0e4a1939d4d878", "committedDate": "2020-04-08T23:35:15Z", "message": "rename variable per review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNDkwNTQ4", "url": "https://github.com/apache/hudi/pull/1479#pullrequestreview-390490548", "createdAt": "2020-04-09T04:56:33Z", "commit": {"oid": "c0f6f42ce7bee8292ee3f6a40a0e4a1939d4d878"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3323, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}