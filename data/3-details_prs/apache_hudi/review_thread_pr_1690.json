{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NTUyNzU4", "number": 1690, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwODoyNDo1NlrOECdQmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQyMjozNjozM1rOEHUlIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMDExOTk0OnYy", "diffSide": "RIGHT", "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQwODoyNDo1NlrOGe7INQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwMDozNDo0MFrOGgGWuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTA3OTIyMQ==", "bodyText": "Is this guaranteed to be list for a fixed decimal value ? Shouldn't this be scalar ?", "url": "https://github.com/apache/hudi/pull/1690#discussion_r435079221", "createdAt": "2020-06-04T08:24:56Z", "author": {"login": "bvaradar"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "diffHunk": "@@ -245,10 +245,14 @@ private static JsonToAvroFieldProcessor generateFixedTypeHandler() {\n     return new JsonToAvroFieldProcessor() {\n       @Override\n       public Pair<Boolean, Object> convert(Object value, String name, Schema schema) {\n-        byte[] src = value.toString().getBytes();\n+        ArrayList<Integer> converval = (ArrayList<Integer>) value;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTY5MjUyOQ==", "bodyText": "Currently Fix.toString() will convert bytes to string,\n\npublic String toString() { return Arrays.toString(bytes); } \n\nthe result is like \"decimal_val\": [0, 0, 14, -63, -52],\n\nMercifulJsonConverter.convert will parse json string to jsonObjectMap,\n\npublic GenericRecord convert(String json, Schema schema) {\n    try {\n      Map<String, Object> jsonObjectMap = mapper.readValue(json, Map.class);\n      return convertJsonToAvro(jsonObjectMap, schema);\n    } catch (IOException e) {\n      throw new HoodieIOException(e.getMessage(), e);\n    }\n  }\n\nit will convert \"decimal_val\": [0, 0, 14, -63, -52], to ArrayList.\n\n\nthe generateFixedTypeHandler() will process it incorrect.", "url": "https://github.com/apache/hudi/pull/1690#discussion_r435692529", "createdAt": "2020-06-05T05:08:02Z", "author": {"login": "shenh062326"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "diffHunk": "@@ -245,10 +245,14 @@ private static JsonToAvroFieldProcessor generateFixedTypeHandler() {\n     return new JsonToAvroFieldProcessor() {\n       @Override\n       public Pair<Boolean, Object> convert(Object value, String name, Schema schema) {\n-        byte[] src = value.toString().getBytes();\n+        ArrayList<Integer> converval = (ArrayList<Integer>) value;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTA3OTIyMQ=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc0NDE3Mw==", "bodyText": "@bvaradar Is it a bug?", "url": "https://github.com/apache/hudi/pull/1690#discussion_r435744173", "createdAt": "2020-06-05T07:40:59Z", "author": {"login": "shenh062326"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "diffHunk": "@@ -245,10 +245,14 @@ private static JsonToAvroFieldProcessor generateFixedTypeHandler() {\n     return new JsonToAvroFieldProcessor() {\n       @Override\n       public Pair<Boolean, Object> convert(Object value, String name, Schema schema) {\n-        byte[] src = value.toString().getBytes();\n+        ArrayList<Integer> converval = (ArrayList<Integer>) value;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTA3OTIyMQ=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI1NzQ1Mw==", "bodyText": "Thanks for the explanation. Makes sense. ObjectMapper uses List to represent FixedType.  So, each entry in the list is within the range of [-128, 127]. right ?", "url": "https://github.com/apache/hudi/pull/1690#discussion_r436257453", "createdAt": "2020-06-06T10:27:28Z", "author": {"login": "bvaradar"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "diffHunk": "@@ -245,10 +245,14 @@ private static JsonToAvroFieldProcessor generateFixedTypeHandler() {\n     return new JsonToAvroFieldProcessor() {\n       @Override\n       public Pair<Boolean, Object> convert(Object value, String name, Schema schema) {\n-        byte[] src = value.toString().getBytes();\n+        ArrayList<Integer> converval = (ArrayList<Integer>) value;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTA3OTIyMQ=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMxMTczNg==", "bodyText": "Thanks for the explanation. Makes sense. ObjectMapper uses List to represent FixedType. So, each entry in the list is within the range of [-128, 127]. right ?\n\nYes.", "url": "https://github.com/apache/hudi/pull/1690#discussion_r436311736", "createdAt": "2020-06-07T00:34:40Z", "author": {"login": "shenh062326"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "diffHunk": "@@ -245,10 +245,14 @@ private static JsonToAvroFieldProcessor generateFixedTypeHandler() {\n     return new JsonToAvroFieldProcessor() {\n       @Override\n       public Pair<Boolean, Object> convert(Object value, String name, Schema schema) {\n-        byte[] src = value.toString().getBytes();\n+        ArrayList<Integer> converval = (ArrayList<Integer>) value;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTA3OTIyMQ=="}, "originalCommit": null, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxNzQ4MDM4OnYy", "diffSide": "RIGHT", "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNlQxMDoyOTowMVrOGgDC6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwMDo0MToxMlrOGgGcMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI1NzUxMw==", "bodyText": "Minor Comment: Can you use List instead of ArrayList", "url": "https://github.com/apache/hudi/pull/1690#discussion_r436257513", "createdAt": "2020-06-06T10:29:01Z", "author": {"login": "bvaradar"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "diffHunk": "@@ -245,10 +245,14 @@ private static JsonToAvroFieldProcessor generateFixedTypeHandler() {\n     return new JsonToAvroFieldProcessor() {\n       @Override\n       public Pair<Boolean, Object> convert(Object value, String name, Schema schema) {\n-        byte[] src = value.toString().getBytes();\n+        ArrayList<Integer> converval = (ArrayList<Integer>) value;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMxMzA4Nw==", "bodyText": "Sure", "url": "https://github.com/apache/hudi/pull/1690#discussion_r436313087", "createdAt": "2020-06-07T00:40:05Z", "author": {"login": "shenh062326"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "diffHunk": "@@ -245,10 +245,14 @@ private static JsonToAvroFieldProcessor generateFixedTypeHandler() {\n     return new JsonToAvroFieldProcessor() {\n       @Override\n       public Pair<Boolean, Object> convert(Object value, String name, Schema schema) {\n-        byte[] src = value.toString().getBytes();\n+        ArrayList<Integer> converval = (ArrayList<Integer>) value;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI1NzUxMw=="}, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMxMzEzNw==", "bodyText": "Minor Comment: Can you use List instead of ArrayList\n\nDone", "url": "https://github.com/apache/hudi/pull/1690#discussion_r436313137", "createdAt": "2020-06-07T00:41:12Z", "author": {"login": "shenh062326"}, "path": "hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java", "diffHunk": "@@ -245,10 +245,14 @@ private static JsonToAvroFieldProcessor generateFixedTypeHandler() {\n     return new JsonToAvroFieldProcessor() {\n       @Override\n       public Pair<Boolean, Object> convert(Object value, String name, Schema schema) {\n-        byte[] src = value.toString().getBytes();\n+        ArrayList<Integer> converval = (ArrayList<Integer>) value;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI1NzUxMw=="}, "originalCommit": null, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2MTEyNjc0OnYy", "diffSide": "RIGHT", "path": "hudi-utilities/src/test/resources/delta-streamer-config/source.avsc", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMFQyMjozNjozM1rOGmopDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMVQxMjo0MzowM1rOGmrwww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE2NDk0Mg==", "bodyText": "Minor: Instead of naming based on types, can we give relevant names like :distance_in_meters (int_type), seconds_since_epoch(long_val), payment_in_dollars,...", "url": "https://github.com/apache/hudi/pull/1690#discussion_r443164942", "createdAt": "2020-06-20T22:36:33Z", "author": {"login": "bvaradar"}, "path": "hudi-utilities/src/test/resources/delta-streamer-config/source.avsc", "diffHunk": "@@ -43,8 +43,41 @@\n   }, {\n     \"name\" : \"end_lon\",\n     \"type\" : \"double\"\n-  },\n-  {\n+  }, {\n+    \"name\" : \"int_val\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIxNjA2Nw==", "bodyText": "Done", "url": "https://github.com/apache/hudi/pull/1690#discussion_r443216067", "createdAt": "2020-06-21T12:43:03Z", "author": {"login": "shenh062326"}, "path": "hudi-utilities/src/test/resources/delta-streamer-config/source.avsc", "diffHunk": "@@ -43,8 +43,41 @@\n   }, {\n     \"name\" : \"end_lon\",\n     \"type\" : \"double\"\n-  },\n-  {\n+  }, {\n+    \"name\" : \"int_val\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE2NDk0Mg=="}, "originalCommit": null, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4456, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}