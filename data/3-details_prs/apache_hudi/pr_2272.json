{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI1MjkxMDk0", "number": 2272, "title": "[MINOR] Refactor code in HoodieMergeHandle", "bodyText": "Tips\n\nThank you very much for contributing to Apache Hudi.\nPlease review https://hudi.apache.org/contributing.html before opening a pull request.\n\nWhat is the purpose of the pull request\ncode refactor in hoodiemergehandle to avoid create string for every old record.\nBrief change log\n(for example:)\n\nModify AnnotationLocation checkstyle rule in checkstyle.xml\n\nVerify this pull request\n(Please pick either of the following options)\nThis pull request is a trivial rework / code cleanup without any test coverage.\n(or)\nThis pull request is already covered by existing tests, such as (please describe tests).\n(or)\nThis change added tests and can be verified as follows:\n(example:)\n\nAdded integration tests for end-to-end.\nAdded HoodieClientWriteTest to verify the change.\nManually verified the change by running a job locally.\n\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-11-22T14:21:22Z", "url": "https://github.com/apache/hudi/pull/2272", "merged": true, "mergeCommit": {"oid": "3d5e9fee7f42d45f737e170a1937bdf676df9c60"}, "closed": true, "closedAt": "2020-11-28T13:47:06Z", "author": {"login": "leesf"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdf6Eo_gFqTUzODI1NDE5Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdg8bBjAFqTU0MDM3NjUwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MjU0MTky", "url": "https://github.com/apache/hudi/pull/2272#pullrequestreview-538254192", "createdAt": "2020-11-25T08:28:27Z", "commit": {"oid": "6dd9337de129f45e7858389234eca55df854ccc2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5OTEwNjQy", "url": "https://github.com/apache/hudi/pull/2272#pullrequestreview-539910642", "createdAt": "2020-11-27T11:32:34Z", "commit": {"oid": "6dd9337de129f45e7858389234eca55df854ccc2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTozMjozNFrOH67FIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMTozMjozNFrOH67FIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTU0NzQyNA==", "bodyText": "Using String#format would be better?", "url": "https://github.com/apache/hudi/pull/2272#discussion_r531547424", "createdAt": "2020-11-27T11:32:34Z", "author": {"login": "yanghua"}, "path": "hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java", "diffHunk": "@@ -241,14 +241,11 @@ public void write(GenericRecord oldRecord) {\n \n     if (copyOldRecord) {\n       // this should work as it is, since this is an existing record\n-      String errMsg = \"Failed to merge old record into new file for key \" + key + \" from old file \" + getOldFilePath()\n-          + \" to new file \" + newFilePath + \" with writerSchema \" + writerSchemaWithMetafields.toString(true);\n       try {\n         fileWriter.writeAvro(key, oldRecord);\n-      } catch (ClassCastException e) {\n-        LOG.debug(\"Old record is \" + oldRecord);\n-        throw new HoodieUpsertException(errMsg, e);\n       } catch (IOException | RuntimeException e) {\n+        String errMsg = \"Failed to merge old record into new file for key \" + key + \" from old file \" + getOldFilePath()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6dd9337de129f45e7858389234eca55df854ccc2"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e6ebef820c6b01d4363b090e1676af31f5fa580", "author": {"user": {"login": "leesf", "name": "leesf"}}, "url": "https://github.com/apache/hudi/commit/2e6ebef820c6b01d4363b090e1676af31f5fa580", "committedDate": "2020-11-27T14:56:58Z", "message": "[MINOR] refactor code in HoodieMergeHandle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6dd9337de129f45e7858389234eca55df854ccc2", "author": {"user": {"login": "leesf", "name": "leesf"}}, "url": "https://github.com/apache/hudi/commit/6dd9337de129f45e7858389234eca55df854ccc2", "committedDate": "2020-11-22T14:04:09Z", "message": "[MINOR] refactor code in HoodieMergeHandle"}, "afterCommit": {"oid": "2e6ebef820c6b01d4363b090e1676af31f5fa580", "author": {"user": {"login": "leesf", "name": "leesf"}}, "url": "https://github.com/apache/hudi/commit/2e6ebef820c6b01d4363b090e1676af31f5fa580", "committedDate": "2020-11-27T14:56:58Z", "message": "[MINOR] refactor code in HoodieMergeHandle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMzc2NTA4", "url": "https://github.com/apache/hudi/pull/2272#pullrequestreview-540376508", "createdAt": "2020-11-28T13:46:38Z", "commit": {"oid": "2e6ebef820c6b01d4363b090e1676af31f5fa580"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4344, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}