{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI5NTk2OTA3", "number": 1710, "title": "[HUDI-1023] Add validation error messages in delta sync", "bodyText": "add more validation error message\nmake write config constants public\n\nThis change added tests and can be verified as follows:\n\n Test by running delta streamers with invalid configs and verify the error messages\n\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-06-07T01:33:55Z", "url": "https://github.com/apache/hudi/pull/1710", "merged": true, "mergeCommit": {"oid": "8a9fdd603e3e532ea5252b98205acfb8aa648795"}, "closed": true, "closedAt": "2020-06-19T19:12:36Z", "author": {"login": "xushiyan"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoxrdMAH2gAyNDI5NTk2OTA3OjIyNTMzYWZiMTc3Yjk0ZGM1NDI3M2Q3ZjcwZWFlMTk4ZmQ2MGRlMTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqR2h_gFqTQyOTE0Mzc2NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "22533afb177b94dc54273d7f70eae198fd60de16", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/22533afb177b94dc54273d7f70eae198fd60de16", "committedDate": "2020-06-07T01:35:52Z", "message": "[MINOR] Fix delta streamer write config\n\n- avoid overwrite index type\n- add more validation error message\n- make write config constants public"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "22533afb177b94dc54273d7f70eae198fd60de16", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/22533afb177b94dc54273d7f70eae198fd60de16", "committedDate": "2020-06-07T01:35:52Z", "message": "[MINOR] Fix delta streamer write config\n\n- avoid overwrite index type\n- add more validation error message\n- make write config constants public"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NzgwODIx", "url": "https://github.com/apache/hudi/pull/1710#pullrequestreview-425780821", "createdAt": "2020-06-07T01:47:58Z", "commit": {"oid": "22533afb177b94dc54273d7f70eae198fd60de16"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwMTo0Nzo1OFrOGgGoTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwMTo0Nzo1OFrOGgGoTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMxNjIzOQ==", "bodyText": "@vinothchandar I think this fixed index type to BLOOM. Not sure any historical reason behind it.", "url": "https://github.com/apache/hudi/pull/1710#discussion_r436316239", "createdAt": "2020-06-07T01:47:58Z", "author": {"login": "xushiyan"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java", "diffHunk": "@@ -497,25 +499,30 @@ private void setupWriteClient() {\n    * @param schemaProvider Schema Provider\n    */\n   private HoodieWriteConfig getHoodieClientConfig(SchemaProvider schemaProvider) {\n+    final boolean combineBeforeUpsert = true;\n+    final boolean autoCommit = false;\n     HoodieWriteConfig.Builder builder =\n-        HoodieWriteConfig.newBuilder().withPath(cfg.targetBasePath).combineInput(cfg.filterDupes, true)\n+        HoodieWriteConfig.newBuilder().withPath(cfg.targetBasePath).combineInput(cfg.filterDupes, combineBeforeUpsert)\n             .withCompactionConfig(HoodieCompactionConfig.newBuilder().withPayloadClass(cfg.payloadClassName)\n                 // Inline compaction is disabled for continuous mode. otherwise enabled for MOR\n                 .withInlineCompaction(cfg.isInlineCompactionEnabled()).build())\n             .forTable(cfg.targetTableName)\n-            .withIndexConfig(HoodieIndexConfig.newBuilder().withIndexType(HoodieIndex.IndexType.BLOOM).build())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22533afb177b94dc54273d7f70eae198fd60de16"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb52d965bbee7d94f0bb12d22e80cd2ea5345e87", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/cb52d965bbee7d94f0bb12d22e80cd2ea5345e87", "committedDate": "2020-06-07T02:13:06Z", "message": "Trigger"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f985401f9a7c8e074b2a49ddb431686f999d00a", "author": {"user": {"login": "xushiyan", "name": "Raymond Xu"}}, "url": "https://github.com/apache/hudi/commit/6f985401f9a7c8e074b2a49ddb431686f999d00a", "committedDate": "2020-06-07T18:08:51Z", "message": "Trigger"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MTE3MTYy", "url": "https://github.com/apache/hudi/pull/1710#pullrequestreview-426117162", "createdAt": "2020-06-08T10:53:35Z", "commit": {"oid": "6f985401f9a7c8e074b2a49ddb431686f999d00a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDo1MzozNlrOGgYqCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMDo1MzozNlrOGgYqCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjYxMTU5Mg==", "bodyText": "but this will override this.. the withProps(). no?", "url": "https://github.com/apache/hudi/pull/1710#discussion_r436611592", "createdAt": "2020-06-08T10:53:36Z", "author": {"login": "vinothchandar"}, "path": "hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java", "diffHunk": "@@ -497,25 +499,30 @@ private void setupWriteClient() {\n    * @param schemaProvider Schema Provider\n    */\n   private HoodieWriteConfig getHoodieClientConfig(SchemaProvider schemaProvider) {\n+    final boolean combineBeforeUpsert = true;\n+    final boolean autoCommit = false;\n     HoodieWriteConfig.Builder builder =\n-        HoodieWriteConfig.newBuilder().withPath(cfg.targetBasePath).combineInput(cfg.filterDupes, true)\n+        HoodieWriteConfig.newBuilder().withPath(cfg.targetBasePath).combineInput(cfg.filterDupes, combineBeforeUpsert)\n             .withCompactionConfig(HoodieCompactionConfig.newBuilder().withPayloadClass(cfg.payloadClassName)\n                 // Inline compaction is disabled for continuous mode. otherwise enabled for MOR\n                 .withInlineCompaction(cfg.isInlineCompactionEnabled()).build())\n             .forTable(cfg.targetTableName)\n-            .withIndexConfig(HoodieIndexConfig.newBuilder().withIndexType(HoodieIndex.IndexType.BLOOM).build())\n-            .withAutoCommit(false).withProps(props);\n+            .withAutoCommit(autoCommit).withProps(props);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f985401f9a7c8e074b2a49ddb431686f999d00a"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MTQzNzY1", "url": "https://github.com/apache/hudi/pull/1710#pullrequestreview-429143765", "createdAt": "2020-06-11T17:38:51Z", "commit": {"oid": "6f985401f9a7c8e074b2a49ddb431686f999d00a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4941, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}