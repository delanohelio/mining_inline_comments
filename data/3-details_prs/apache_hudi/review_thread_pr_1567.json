{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5MzA1NTA2", "number": 1567, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQyMTowODo1MlrOD3Yaxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQyMTowODo1MlrOD3Yaxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU5Mzk4MzQyOnYy", "diffSide": "RIGHT", "path": "hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQyMTowODo1MlrOGNnBCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwNjowNDozM1rOG19NHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkyMzkxNA==", "bodyText": "@hddong : Any possible reasons why blank file is created in the first place ?", "url": "https://github.com/apache/hudi/pull/1567#discussion_r416923914", "createdAt": "2020-04-28T21:08:52Z", "author": {"login": "bvaradar"}, "path": "hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java", "diffHunk": "@@ -210,6 +210,14 @@ public void close() throws IOException {\n     flush();\n     output.close();\n     output = null;\n+    Path path = logFile.getPath();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzA0NzI4MA==", "bodyText": "@hddong : Any possible reasons why blank file is created in the first place ?\n\nCreate blank file for appendBlock when new HoodieLogFormatWriter\nhttps://github.com/apache/incubator-hudi/blob/f1592be629c3f9762f62d4e1dbf3be54f213d92d/hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java#L105-L108\nBut there is a special case,  when roll over is true(block size is past the threshold), we will close the old writer and create a new writer . And if we close a new writer created by rolloverIfNeeded , there will left a blank file.", "url": "https://github.com/apache/hudi/pull/1567#discussion_r417047280", "createdAt": "2020-04-29T03:27:51Z", "author": {"login": "hddong"}, "path": "hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java", "diffHunk": "@@ -210,6 +210,14 @@ public void close() throws IOException {\n     flush();\n     output.close();\n     output = null;\n+    Path path = logFile.getPath();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkyMzkxNA=="}, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIzMDQ5NQ==", "bodyText": "fair enough. but this is effectively doing an extra RPC every close, just to handle this corner case. what is the actual  issue caused by the empty file? does the query/writing fail or get stuck?", "url": "https://github.com/apache/hudi/pull/1567#discussion_r459230495", "createdAt": "2020-07-23T06:04:33Z", "author": {"login": "vinothchandar"}, "path": "hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java", "diffHunk": "@@ -210,6 +210,14 @@ public void close() throws IOException {\n     flush();\n     output.close();\n     output = null;\n+    Path path = logFile.getPath();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjkyMzkxNA=="}, "originalCommit": null, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4595, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}