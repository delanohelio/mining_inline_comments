{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MTI5MDAy", "number": 2044, "title": "[HUDI-1228] Add utility method to query extra metadata", "bodyText": "What is the purpose of the pull request\nAdd utility method for querying extra metadata. This is useful for several DeltaStreamer like usecases. We cant use DeltaStreamer because source is different than kafka.\nBrief change log\n\nAdd utility method to query extra metadata from latest commit\nAdd utility method to query extra metadata from all active commits\n\nVerify this pull request\nThis change added tests\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-08-26T20:13:10Z", "url": "https://github.com/apache/hudi/pull/2044", "merged": true, "mergeCommit": {"oid": "4dbeabffa3b2b9f30c48f2deae3ea4f91570afdd"}, "closed": true, "closedAt": "2020-08-28T19:23:48Z", "author": {"login": "satishkotha"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdC0nQ3ABqjM2OTY5OTI4NzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDY8s_ABqjM3MDUxMDU3ODI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ad25140d5592d385ac81f44efe15063cc3db572a", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/ad25140d5592d385ac81f44efe15063cc3db572a", "committedDate": "2020-08-26T20:08:41Z", "message": "[HUDI-1228] Add utility method to query extra metadata"}, "afterCommit": {"oid": "a8550fde6d88f7a0789f962fc42815a6e6dfa0f9", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/a8550fde6d88f7a0789f962fc42815a6e6dfa0f9", "committedDate": "2020-08-26T23:42:45Z", "message": "[HUDI-1228] Add utility method to query extra metadata"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2OTc1NjEx", "url": "https://github.com/apache/hudi/pull/2044#pullrequestreview-476975611", "createdAt": "2020-08-27T18:25:23Z", "commit": {"oid": "a8550fde6d88f7a0789f962fc42815a6e6dfa0f9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxODoyNToyM1rOHIcNoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxODoyNToyM1rOHIcNoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODYxMjg5Nw==", "bodyText": "@satishkotha can you describe what this method is used for ? The naming is a little confusing..", "url": "https://github.com/apache/hudi/pull/2044#discussion_r478612897", "createdAt": "2020-08-27T18:25:23Z", "author": {"login": "n3nash"}, "path": "hudi-common/src/main/java/org/apache/hudi/common/table/timeline/TimelineUtils.java", "diffHunk": "@@ -98,4 +101,31 @@\n \n     }).distinct().filter(s -> !s.isEmpty()).collect(Collectors.toList());\n   }\n+\n+  /**\n+   * Get extra metadata for specified key from latest commit/deltacommit instant.\n+   */\n+  public static Option<String> getExtraMetadataFromLatest(HoodieTableMetaClient metaClient, String extraMetadataKey) {\n+    return metaClient.getCommitsTimeline().filterCompletedInstants().getReverseOrderedInstants().findFirst().map(instant ->\n+        getMetadataValue(metaClient, extraMetadataKey, instant)).orElse(Option.empty());\n+  }\n+\n+  /**\n+   * Get extra metadata for specified key from all active commit/deltacommit instants.\n+   */\n+  public static Map<String, Option<String>> getExtraMetadataTimeline(HoodieTableMetaClient metaClient, String extraMetadataKey) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8550fde6d88f7a0789f962fc42815a6e6dfa0f9"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad0efe04fd0ab21ec68e2ac54e13efb6a13e76d7", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/ad0efe04fd0ab21ec68e2ac54e13efb6a13e76d7", "committedDate": "2020-08-28T18:02:27Z", "message": "[HUDI-1228] Add utility method to query extra metadata"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a8550fde6d88f7a0789f962fc42815a6e6dfa0f9", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/a8550fde6d88f7a0789f962fc42815a6e6dfa0f9", "committedDate": "2020-08-26T23:42:45Z", "message": "[HUDI-1228] Add utility method to query extra metadata"}, "afterCommit": {"oid": "ad0efe04fd0ab21ec68e2ac54e13efb6a13e76d7", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/hudi/commit/ad0efe04fd0ab21ec68e2ac54e13efb6a13e76d7", "committedDate": "2020-08-28T18:02:27Z", "message": "[HUDI-1228] Add utility method to query extra metadata"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4459, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}