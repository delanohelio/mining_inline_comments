{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3NzU3NDI2", "number": 1286, "title": "[HUDI-564] Added new test cases for HoodieLogFormat and HoodieLogFormatVersion.", "bodyText": "What is the purpose of the pull request\nAdded new test cases for HoodieLogFormat and HoodieLogFormatVersion.\nVerify this pull request\nThis change added tests and can be verified as follows:\nThis change added tests and can be verified as follows:\nmvn test --also-make -DfailIfNoTests=false -Dtest=TestHoodieLogFormat,TestHoodieLogFormatVersion -pl hudi-common\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-01-27T23:35:13Z", "url": "https://github.com/apache/hudi/pull/1286", "merged": true, "mergeCommit": {"oid": "f27c7a16c6d437efaa83e50a7117b83e5201ac49"}, "closed": true, "closedAt": "2020-01-30T21:53:19Z", "author": {"login": "prashantwason"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-lcpugBqjI5ODM3OTAyMjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_hxkXAFqTM1MTE2ODEyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwMzQzNzMy", "url": "https://github.com/apache/hudi/pull/1286#pullrequestreview-350343732", "createdAt": "2020-01-29T18:51:54Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxODo1MTo1NFrOFjTq_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yOVQxODo1MTo1NFrOFjTq_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjU2Njc4MA==", "bodyText": "nit : s/scheme/schema/", "url": "https://github.com/apache/hudi/pull/1286#discussion_r372566780", "createdAt": "2020-01-29T18:51:54Z", "author": {"login": "n3nash"}, "path": "hudi-common/src/test/java/org/apache/hudi/common/table/log/TestHoodieLogFormat.java", "diffHunk": "@@ -1296,4 +1297,36 @@ public void testBasicAppendAndTraverseInReverse() throws IOException, URISyntaxE\n     assertFalse(reader.hasPrev());\n     reader.close();\n   }\n+\n+  @Test\n+  public void testV0Format() throws IOException, InterruptedException, URISyntaxException {\n+    // HoodieLogFormatVersion.DEFAULT_VERSION has been deprecated so we cannot\n+    // create a writer for it. So these tests are only for the HoodieAvroDataBlock\n+    // of older version.\n+    Schema schema = getSimpleSchema();\n+    List<IndexedRecord> records = SchemaTestUtil.generateTestRecords(0, 100);\n+    List<IndexedRecord> recordsCopy = new ArrayList<>(records);\n+    assertEquals(records.size(), 100);\n+    assertEquals(recordsCopy.size(), 100);\n+    HoodieAvroDataBlock dataBlock = new HoodieAvroDataBlock(records, schema);\n+    byte[] content = dataBlock.getBytes(schema);\n+    assertTrue(content.length > 0);\n+\n+    HoodieLogBlock logBlock = HoodieAvroDataBlock.getBlock(content, schema);\n+    assertEquals(logBlock.getBlockType(), HoodieLogBlockType.AVRO_DATA_BLOCK);\n+    List<IndexedRecord> readRecords = ((HoodieAvroDataBlock)logBlock).getRecords();\n+    assertEquals(readRecords.size(), recordsCopy.size());\n+    for (int i = 0; i < recordsCopy.size(); ++i) {\n+      assertEquals(recordsCopy.get(i), readRecords.get(i));\n+    }\n+\n+    // Reader scheme is optional if it is same as write schema", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 35}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUwMzQ0NjAz", "url": "https://github.com/apache/hudi/pull/1286#pullrequestreview-350344603", "createdAt": "2020-01-29T18:53:18Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f08e52b889e09867daa39e35a1ce4fa031a9afc3", "author": {"user": {"login": "prashantwason", "name": "Prashant Wason"}}, "url": "https://github.com/apache/hudi/commit/f08e52b889e09867daa39e35a1ce4fa031a9afc3", "committedDate": "2020-01-29T19:00:18Z", "message": "[HUDI-564] Added new test cases for HoodieLogFormat and HoodieLogFormatVersion."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "f08e52b889e09867daa39e35a1ce4fa031a9afc3", "author": {"user": {"login": "prashantwason", "name": "Prashant Wason"}}, "url": "https://github.com/apache/hudi/commit/f08e52b889e09867daa39e35a1ce4fa031a9afc3", "committedDate": "2020-01-29T19:00:18Z", "message": "[HUDI-564] Added new test cases for HoodieLogFormat and HoodieLogFormatVersion."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMTY4MTI0", "url": "https://github.com/apache/hudi/pull/1286#pullrequestreview-351168124", "createdAt": "2020-01-30T21:53:10Z", "commit": {"oid": "f08e52b889e09867daa39e35a1ce4fa031a9afc3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4155, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}