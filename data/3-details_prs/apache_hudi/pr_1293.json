{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5MTQyMzgy", "number": 1293, "title": "[HUDI-585] Optimize the steps of building with scala-2.12", "bodyText": "What is the purpose of the pull request\nAt the master branch, to build scala 2.12 version, will execute dev/change-scala-version.sh firstly.\nThis pr aims to optimize the steps.\nBrief change log\n\nRemove dev/change-scala-version.sh script\n\nVerify this pull request\nTest with scala-2.11\nmvn clean package -DskipTests -DskipITs\nmvn clean package -DskipTests -DskipITs -Pscala-2.11\n\nrm -rf /tmp/hudi_mor_table\nexport SPARK_HOME=/work/BigData/install/spark/spark-2.4.4-bin-hadoop2.7-2.11\n${SPARK_HOME}/bin/spark-shell \\\n    --packages org.apache.spark:spark-avro_2.11:2.4.4 \\\n    --jars `ls packaging/hudi-spark-bundle/target/hudi-spark-bundle_*.*-*.*.*-SNAPSHOT.jar` \\\n    --conf 'spark.serializer=org.apache.spark.serializer.KryoSerializer'\n\nval basePath = \"file:///tmp/hudi_mor_table\"\n\nvar datas = List(\"\"\"{ \"name\": \"kenken\", \"ts\": 1574297893836, \"age\": 12, \"location\": \"latitude\"}\"\"\")\nval df = spark.read.json(spark.sparkContext.parallelize(datas, 2))\ndf.write.format(\"org.apache.hudi\").\n    option(\"hoodie.insert.shuffle.parallelism\", \"10\").\n    option(\"hoodie.upsert.shuffle.parallelism\", \"10\").\n    option(\"hoodie.delete.shuffle.parallelism\", \"10\").\n    option(\"hoodie.bulkinsert.shuffle.parallelism\", \"10\").\n    option(\"hoodie.datasource.write.recordkey.field\", \"name\").\n    option(\"hoodie.datasource.write.partitionpath.field\", \"location\").\n    option(\"hoodie.datasource.write.precombine.field\", \"ts\").\n    option(\"hoodie.table.name\", \"tableName\").\n    mode(\"Overwrite\").\n    save(basePath)\n\nspark.read.format(\"org.apache.hudi\").load(basePath + \"/*/\").show()\n\n\nTest with scala-2.12\nmvn clean package -DskipTests -DskipITs -Pscala-2.12\n\nrm -rf /tmp/hudi_mor_table\nexport SPARK_HOME=/work/BigData/install/spark/spark-3.0.0-preview2-bin-hadoop2.7\n${SPARK_HOME}/bin/spark-shell \\\n    --packages org.apache.spark:spark-avro_2.12:3.0.0-preview2 \\\n    --jars `ls packaging/hudi-spark-bundle/target/hudi-spark-bundle_*.*-*.*.*-SNAPSHOT.jar` \\\n    --conf 'spark.serializer=org.apache.spark.serializer.KryoSerializer'\n\nval basePath = \"file:///tmp/hudi_mor_table\"\n\nvar datas = List(\"\"\"{ \"name\": \"kenken\", \"ts\": 1574297893836, \"age\": 12, \"location\": \"latitude\"}\"\"\")\nval df = spark.read.json(spark.sparkContext.parallelize(datas, 2))\ndf.write.format(\"org.apache.hudi\").\n    option(\"hoodie.insert.shuffle.parallelism\", \"10\").\n    option(\"hoodie.upsert.shuffle.parallelism\", \"10\").\n    option(\"hoodie.delete.shuffle.parallelism\", \"10\").\n    option(\"hoodie.bulkinsert.shuffle.parallelism\", \"10\").\n    option(\"hoodie.datasource.write.recordkey.field\", \"name\").\n    option(\"hoodie.datasource.write.partitionpath.field\", \"location\").\n    option(\"hoodie.datasource.write.precombine.field\", \"ts\").\n    option(\"hoodie.table.name\", \"tableName\").\n    mode(\"Overwrite\").\n    save(basePath)\n\nspark.read.format(\"org.apache.hudi\").load(basePath + \"/*/\").show()\n\n\nCommitter checklist\n\n\n Has a corresponding JIRA in PR title & commit\n\n\n Commit message is descriptive of the change\n\n\n CI is green\n\n\n Necessary doc changes done or have another open PR\n\n\n For large changes, please consider breaking it into sub-tasks under an umbrella JIRA.", "createdAt": "2020-01-30T15:38:38Z", "url": "https://github.com/apache/hudi/pull/1293", "merged": true, "mergeCommit": {"oid": "425e3e6c78b9be00fc3fecfc335c94e05a1c70e5"}, "closed": true, "closedAt": "2020-02-05T15:13:10Z", "author": {"login": "lamberken"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_cRdNAH2gAyMzY5MTQyMzgyOmU1MGI1YTY3ODFmZmE0MDk1MDc5ZGE5ODkzMGNjNTA4MmZhNjJkMDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBXpEigFqTM1Mzc5MzQ5Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e50b5a6781ffa4095079da98930cc5082fa62d08", "author": {"user": {"login": "lamberken", "name": "lamberken"}}, "url": "https://github.com/apache/hudi/commit/e50b5a6781ffa4095079da98930cc5082fa62d08", "committedDate": "2020-01-30T15:28:34Z", "message": "[HUDI-585] Optimize the steps of building with scala-2.12"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c9c8031b8f499ab6c1d469613f8b929abd0d702", "author": {"user": {"login": "lamberken", "name": "lamberken"}}, "url": "https://github.com/apache/hudi/commit/9c9c8031b8f499ab6c1d469613f8b929abd0d702", "committedDate": "2020-01-30T16:26:42Z", "message": "Remove change-scala-version.sh from LICENSE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1db4b3bc53b2d17c9112f1879e8b4f147c67a456", "author": {"user": {"login": "lamberken", "name": "lamberken"}}, "url": "https://github.com/apache/hudi/commit/1db4b3bc53b2d17c9112f1879e8b4f147c67a456", "committedDate": "2020-02-02T12:46:42Z", "message": "Fix build error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNzI3OTUw", "url": "https://github.com/apache/hudi/pull/1293#pullrequestreview-353727950", "createdAt": "2020-02-05T13:50:56Z", "commit": {"oid": "1db4b3bc53b2d17c9112f1879e8b4f147c67a456"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxMzo1MDo1N1rOFl4Xfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQxMzo1MDo1N1rOFl4Xfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTI2NTE1MA==", "bodyText": "So this line would be removed?", "url": "https://github.com/apache/hudi/pull/1293#discussion_r375265150", "createdAt": "2020-02-05T13:50:57Z", "author": {"login": "leesf"}, "path": "pom.xml", "diffHunk": "@@ -1052,6 +1052,10 @@\n     <!-- Exists for backwards compatibility; profile doesn't do anything -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1db4b3bc53b2d17c9112f1879e8b4f147c67a456"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3370f126a0389a7fe6df6406470f61cd21e6fff4", "author": {"user": {"login": "lamberken", "name": "lamberken"}}, "url": "https://github.com/apache/hudi/commit/3370f126a0389a7fe6df6406470f61cd21e6fff4", "committedDate": "2020-02-05T13:59:51Z", "message": "revert scala-2.11"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzNzkzNDk2", "url": "https://github.com/apache/hudi/pull/1293#pullrequestreview-353793496", "createdAt": "2020-02-05T15:12:41Z", "commit": {"oid": "3370f126a0389a7fe6df6406470f61cd21e6fff4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4177, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}