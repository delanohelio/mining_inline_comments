{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxMDEzMzgz", "number": 1842, "reviewThreads": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMjoyNjo1M1rOEPg7Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNToyMzo0OFrOERGLJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NzAzNTI3OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/callback/HoodieWriteCommitCallBack.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMjoyNjo1M1rOGzRA-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMzo0OTo1MFrOGzTxzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQwOTMzNw==", "bodyText": "HoodieWriteCommitCallback", "url": "https://github.com/apache/hudi/pull/1842#discussion_r456409337", "createdAt": "2020-07-17T12:26:53Z", "author": {"login": "leesf"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/HoodieWriteCommitCallBack.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback;\n+\n+/**\n+ * A callback interface help to call back when a write commit completes successfully.\n+ */\n+public interface HoodieWriteCommitCallBack {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQ1NDYwNg==", "bodyText": "HoodieWriteCommitCallback\n\ndone", "url": "https://github.com/apache/hudi/pull/1842#discussion_r456454606", "createdAt": "2020-07-17T13:49:50Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/HoodieWriteCommitCallBack.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback;\n+\n+/**\n+ * A callback interface help to call back when a write commit completes successfully.\n+ */\n+public interface HoodieWriteCommitCallBack {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQwOTMzNw=="}, "originalCommit": null, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NzAzOTExOnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/callback/impl/HoodieHttpWriteCommitCallBack.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMjoyODoxMFrOGzRDOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMzo1MTo1MlrOGzT26Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQwOTkxMw==", "bodyText": "would be warn", "url": "https://github.com/apache/hudi/pull/1842#discussion_r456409913", "createdAt": "2020-07-17T12:28:10Z", "author": {"login": "leesf"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/impl/HoodieHttpWriteCommitCallBack.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.impl;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallBack;\n+import org.apache.hudi.callback.client.http.HoodieWriteCallBackHttpClient;\n+import org.apache.hudi.callback.common.HoodieBaseCommitCallBackMessage;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+import org.apache.log4j.LogManager;\n+import org.apache.log4j.Logger;\n+import org.codehaus.jackson.map.ObjectMapper;\n+\n+import java.io.IOException;\n+\n+/**\n+ * A http implementation of {@link HoodieWriteCommitCallBack}.\n+ */\n+public class HoodieHttpWriteCommitCallBack implements HoodieWriteCommitCallBack {\n+\n+  private static final Logger LOG = LogManager.getLogger(HoodieHttpWriteCommitCallBack.class);\n+\n+  private final HoodieWriteCallBackHttpClient client;\n+  private final HoodieWriteConfig config;\n+\n+  public HoodieHttpWriteCommitCallBack(HoodieWriteConfig config) {\n+    this.config = config;\n+    this.client = new HoodieWriteCallBackHttpClient(config.getCallBackRestApiKey(),\n+        config.getCallBackRestUrl(),\n+        config.getCallBackRestTimeout());\n+  }\n+\n+  @Override\n+  public void call(String commitTime) {\n+    // create callback message\n+    HoodieBaseCommitCallBackMessage callBackMessage =\n+        new HoodieBaseCommitCallBackMessage(commitTime, config.getTableName());\n+    // convert to json\n+    ObjectMapper mapper = new ObjectMapper();\n+    String callbackMsg = null;\n+    try {\n+      callbackMsg = mapper.writeValueAsString(callBackMessage);\n+    } catch (IOException e) {\n+      LOG.error(\"CallBack service convert message to json failed\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQ1NTkxMw==", "bodyText": "would be warn\n\ndone", "url": "https://github.com/apache/hudi/pull/1842#discussion_r456455913", "createdAt": "2020-07-17T13:51:52Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/impl/HoodieHttpWriteCommitCallBack.java", "diffHunk": "@@ -0,0 +1,64 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.impl;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallBack;\n+import org.apache.hudi.callback.client.http.HoodieWriteCallBackHttpClient;\n+import org.apache.hudi.callback.common.HoodieBaseCommitCallBackMessage;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+import org.apache.log4j.LogManager;\n+import org.apache.log4j.Logger;\n+import org.codehaus.jackson.map.ObjectMapper;\n+\n+import java.io.IOException;\n+\n+/**\n+ * A http implementation of {@link HoodieWriteCommitCallBack}.\n+ */\n+public class HoodieHttpWriteCommitCallBack implements HoodieWriteCommitCallBack {\n+\n+  private static final Logger LOG = LogManager.getLogger(HoodieHttpWriteCommitCallBack.class);\n+\n+  private final HoodieWriteCallBackHttpClient client;\n+  private final HoodieWriteConfig config;\n+\n+  public HoodieHttpWriteCommitCallBack(HoodieWriteConfig config) {\n+    this.config = config;\n+    this.client = new HoodieWriteCallBackHttpClient(config.getCallBackRestApiKey(),\n+        config.getCallBackRestUrl(),\n+        config.getCallBackRestTimeout());\n+  }\n+\n+  @Override\n+  public void call(String commitTime) {\n+    // create callback message\n+    HoodieBaseCommitCallBackMessage callBackMessage =\n+        new HoodieBaseCommitCallBackMessage(commitTime, config.getTableName());\n+    // convert to json\n+    ObjectMapper mapper = new ObjectMapper();\n+    String callbackMsg = null;\n+    try {\n+      callbackMsg = mapper.writeValueAsString(callBackMessage);\n+    } catch (IOException e) {\n+      LOG.error(\"CallBack service convert message to json failed\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQwOTkxMw=="}, "originalCommit": null, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NzA0NTk5OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMjozMDoyMFrOGzRHag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMzo1MjowN1rOGzT3dA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxMDk4Ng==", "bodyText": "enableWriteCommitCallback?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r456410986", "createdAt": "2020-07-17T12:30:20Z", "author": {"login": "leesf"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "diffHunk": "@@ -632,6 +632,33 @@ public FileSystemViewStorageConfig getClientSpecifiedViewStorageConfig() {\n     return clientSpecifiedViewStorageConfig;\n   }\n \n+  /**\n+   * Commit call back configs.\n+   */\n+  public boolean isWriteCommitCallBackOn() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQ1NjA1Mg==", "bodyText": "enableWriteCommitCallback?\n\nyes, looks better", "url": "https://github.com/apache/hudi/pull/1842#discussion_r456456052", "createdAt": "2020-07-17T13:52:07Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "diffHunk": "@@ -632,6 +632,33 @@ public FileSystemViewStorageConfig getClientSpecifiedViewStorageConfig() {\n     return clientSpecifiedViewStorageConfig;\n   }\n \n+  /**\n+   * Commit call back configs.\n+   */\n+  public boolean isWriteCommitCallBackOn() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxMDk4Ng=="}, "originalCommit": null, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1MzQ5OTc2OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMTo0Njo0MVrOG0H8Gw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNTowMjo0NFrOG0RxAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzMwOTIxMQ==", "bodyText": "keep consistent with callback_on above,  so writeCommitCallbackOn?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457309211", "createdAt": "2020-07-20T11:46:41Z", "author": {"login": "leesf"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "diffHunk": "@@ -632,6 +632,33 @@ public FileSystemViewStorageConfig getClientSpecifiedViewStorageConfig() {\n     return clientSpecifiedViewStorageConfig;\n   }\n \n+  /**\n+   * Commit call back configs.\n+   */\n+  public boolean enableWriteCommitCallback() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0e24be2406f277c4b3aee3236638827a3290ce2"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzQ3MDIwOQ==", "bodyText": "keep consistent with callback_on above, so writeCommitCallbackOn?\n\ndone", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457470209", "createdAt": "2020-07-20T15:02:44Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "diffHunk": "@@ -632,6 +632,33 @@ public FileSystemViewStorageConfig getClientSpecifiedViewStorageConfig() {\n     return clientSpecifiedViewStorageConfig;\n   }\n \n+  /**\n+   * Commit call back configs.\n+   */\n+  public boolean enableWriteCommitCallback() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzMwOTIxMQ=="}, "originalCommit": {"oid": "e0e24be2406f277c4b3aee3236638827a3290ce2"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1MzUwMTE2OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMTo0NzowOFrOG0H9CQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNTowMjo1NlrOG0RxoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzMwOTQ0OQ==", "bodyText": "no need use String.valueOf here", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457309449", "createdAt": "2020-07-20T11:47:08Z", "author": {"login": "leesf"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.config;\n+\n+import org.apache.hudi.callback.common.HoodieCommitCallbackType;\n+import org.apache.hudi.common.config.DefaultHoodieConfig;\n+\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write callback related config.\n+ */\n+public class HoodieWriteCommitCallbackConfig extends DefaultHoodieConfig {\n+\n+  public static final String CALLBACK_ON = \"hoodie.write.commit.callback.on\";\n+  public static final boolean DEFAULT_CALLBACK_ON = false;\n+\n+  public static final String CALLBACK_TYPE_PROP = \"hoodie.write.commit.callback.type\";\n+  public static final String DEFAULT_CALLBACK_TYPE_PROP = HoodieCommitCallbackType.HTTP.name();\n+\n+  public static final String CALLBACK_CLASS_PROP = \"hoodie.write.commit.callback.class\";\n+  public static final String DEFAULT_CALLBACK_CLASS_PROP = \"\";\n+\n+  // ***** REST callback configs *****\n+  public static final String CALLBACK_HTTP_URL_PROP = \"hoodie.write.commit.callback.http.url\";\n+  public static final String CALLBACK_API_KEY = \"hoodie.write.commit.callback.http.api.key\";\n+  public static final String DEFAULT_CALLBACK_API_KEY = \"hudi_write_commit_callback\";\n+  public static final String CALLBACK_TIMEOUT_SECONDS = \"hoodie.write.commit.callback.rest.timeout.seconds\";\n+  public static final String DEFAULT_CALLBACK_TIMEOUT_SECONDS = \"3\";\n+\n+  private HoodieWriteCommitCallbackConfig(Properties props) {\n+    super(props);\n+  }\n+\n+  public static HoodieWriteCommitCallbackConfig.Builder newBuilder() {\n+    return new HoodieWriteCommitCallbackConfig.Builder();\n+  }\n+\n+  public static class Builder {\n+\n+    private final Properties props = new Properties();\n+\n+    public HoodieWriteCommitCallbackConfig.Builder fromFile(File propertiesFile) throws IOException {\n+      try (FileReader reader = new FileReader(propertiesFile)) {\n+        this.props.load(reader);\n+        return this;\n+      }\n+    }\n+\n+    public HoodieWriteCommitCallbackConfig.Builder fromProperties(Properties props) {\n+      this.props.putAll(props);\n+      return this;\n+    }\n+\n+    public HoodieWriteCommitCallbackConfig.Builder writeCommitCallbackOn(String callbackOn) {\n+      props.setProperty(CALLBACK_ON, String.valueOf(callbackOn));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0e24be2406f277c4b3aee3236638827a3290ce2"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzQ3MDM2OA==", "bodyText": "no need use String.valueOf here\n\ndone", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457470368", "createdAt": "2020-07-20T15:02:56Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.config;\n+\n+import org.apache.hudi.callback.common.HoodieCommitCallbackType;\n+import org.apache.hudi.common.config.DefaultHoodieConfig;\n+\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write callback related config.\n+ */\n+public class HoodieWriteCommitCallbackConfig extends DefaultHoodieConfig {\n+\n+  public static final String CALLBACK_ON = \"hoodie.write.commit.callback.on\";\n+  public static final boolean DEFAULT_CALLBACK_ON = false;\n+\n+  public static final String CALLBACK_TYPE_PROP = \"hoodie.write.commit.callback.type\";\n+  public static final String DEFAULT_CALLBACK_TYPE_PROP = HoodieCommitCallbackType.HTTP.name();\n+\n+  public static final String CALLBACK_CLASS_PROP = \"hoodie.write.commit.callback.class\";\n+  public static final String DEFAULT_CALLBACK_CLASS_PROP = \"\";\n+\n+  // ***** REST callback configs *****\n+  public static final String CALLBACK_HTTP_URL_PROP = \"hoodie.write.commit.callback.http.url\";\n+  public static final String CALLBACK_API_KEY = \"hoodie.write.commit.callback.http.api.key\";\n+  public static final String DEFAULT_CALLBACK_API_KEY = \"hudi_write_commit_callback\";\n+  public static final String CALLBACK_TIMEOUT_SECONDS = \"hoodie.write.commit.callback.rest.timeout.seconds\";\n+  public static final String DEFAULT_CALLBACK_TIMEOUT_SECONDS = \"3\";\n+\n+  private HoodieWriteCommitCallbackConfig(Properties props) {\n+    super(props);\n+  }\n+\n+  public static HoodieWriteCommitCallbackConfig.Builder newBuilder() {\n+    return new HoodieWriteCommitCallbackConfig.Builder();\n+  }\n+\n+  public static class Builder {\n+\n+    private final Properties props = new Properties();\n+\n+    public HoodieWriteCommitCallbackConfig.Builder fromFile(File propertiesFile) throws IOException {\n+      try (FileReader reader = new FileReader(propertiesFile)) {\n+        this.props.load(reader);\n+        return this;\n+      }\n+    }\n+\n+    public HoodieWriteCommitCallbackConfig.Builder fromProperties(Properties props) {\n+      this.props.putAll(props);\n+      return this;\n+    }\n+\n+    public HoodieWriteCommitCallbackConfig.Builder writeCommitCallbackOn(String callbackOn) {\n+      props.setProperty(CALLBACK_ON, String.valueOf(callbackOn));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzMwOTQ0OQ=="}, "originalCommit": {"oid": "e0e24be2406f277c4b3aee3236638827a3290ce2"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1MzUxODU0OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMTo1MDo1MFrOG0IG0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNTowMzowN1rOG0RySA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzMxMTk1NA==", "bodyText": "should we move these methods into HoodieHttpWriteCommitCallback.java, I am worry about the explode of other callback methods in HoodieWriteConfig", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457311954", "createdAt": "2020-07-20T11:50:50Z", "author": {"login": "leesf"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "diffHunk": "@@ -632,6 +632,33 @@ public FileSystemViewStorageConfig getClientSpecifiedViewStorageConfig() {\n     return clientSpecifiedViewStorageConfig;\n   }\n \n+  /**\n+   * Commit call back configs.\n+   */\n+  public boolean enableWriteCommitCallback() {\n+    return Boolean.parseBoolean(props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_ON));\n+  }\n+\n+  public String getCallbackType() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_TYPE_PROP);\n+  }\n+\n+  public String getCallbackClass() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_CLASS_PROP);\n+  }\n+\n+  public String getCallbackRestUrl() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_HTTP_URL_PROP);\n+  }\n+\n+  public int getCallbackRestTimeout() {\n+    return Integer.parseInt(props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_TIMEOUT_SECONDS));\n+  }\n+\n+  public String getCallbackRestApiKey() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_API_KEY);\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0e24be2406f277c4b3aee3236638827a3290ce2"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzQ3MDUzNg==", "bodyText": "should we move these methods into HoodieHttpWriteCommitCallback.java, I am worry about the explode of other callback methods in HoodieWriteConfig\n\ndone", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457470536", "createdAt": "2020-07-20T15:03:07Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "diffHunk": "@@ -632,6 +632,33 @@ public FileSystemViewStorageConfig getClientSpecifiedViewStorageConfig() {\n     return clientSpecifiedViewStorageConfig;\n   }\n \n+  /**\n+   * Commit call back configs.\n+   */\n+  public boolean enableWriteCommitCallback() {\n+    return Boolean.parseBoolean(props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_ON));\n+  }\n+\n+  public String getCallbackType() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_TYPE_PROP);\n+  }\n+\n+  public String getCallbackClass() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_CLASS_PROP);\n+  }\n+\n+  public String getCallbackRestUrl() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_HTTP_URL_PROP);\n+  }\n+\n+  public int getCallbackRestTimeout() {\n+    return Integer.parseInt(props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_TIMEOUT_SECONDS));\n+  }\n+\n+  public String getCallbackRestApiKey() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_API_KEY);\n+  }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzMxMTk1NA=="}, "originalCommit": {"oid": "e0e24be2406f277c4b3aee3236638827a3290ce2"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1MzUyMTE4OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/exception/HoodieCommitCallbackException.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMTo1MToyN1rOG0IIaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNTowMzoxOFrOG0Ry9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzMxMjM2MQ==", "bodyText": "extra line", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457312361", "createdAt": "2020-07-20T11:51:27Z", "author": {"login": "leesf"}, "path": "hudi-client/src/main/java/org/apache/hudi/exception/HoodieCommitCallbackException.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.exception;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallback;\n+\n+/**\n+ * Exception thrown for any higher level errors when {@link HoodieWriteCommitCallback} is executing a callback.\n+ */\n+public class HoodieCommitCallbackException extends HoodieException {\n+\n+  public HoodieCommitCallbackException(String msg, Throwable e) {\n+    super(msg, e);\n+  }\n+\n+  public HoodieCommitCallbackException(String msg) {\n+    super(msg);\n+  }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0e24be2406f277c4b3aee3236638827a3290ce2"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzQ3MDcxMA==", "bodyText": "extra line\n\ndone", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457470710", "createdAt": "2020-07-20T15:03:18Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/exception/HoodieCommitCallbackException.java", "diffHunk": "@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.exception;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallback;\n+\n+/**\n+ * Exception thrown for any higher level errors when {@link HoodieWriteCommitCallback} is executing a callback.\n+ */\n+public class HoodieCommitCallbackException extends HoodieException {\n+\n+  public HoodieCommitCallbackException(String msg, Throwable e) {\n+    super(msg, e);\n+  }\n+\n+  public HoodieCommitCallbackException(String msg) {\n+    super(msg);\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzMxMjM2MQ=="}, "originalCommit": {"oid": "e0e24be2406f277c4b3aee3236638827a3290ce2"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjUzNzMxOnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/callback/HoodieWriteCommitCallback.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDo0MjoxOVrOG0kBzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDo0MjoxOVrOG0kBzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc2OTQyMQ==", "bodyText": "Can we provide both commit instant and table name?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457769421", "createdAt": "2020-07-21T00:42:19Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/HoodieWriteCommitCallback.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback;\n+\n+/**\n+ * A callback interface help to call back when a write commit completes successfully.\n+ */\n+public interface HoodieWriteCommitCallback {\n+\n+  /**\n+   * A callback method the user can implement to provide asynchronous handling of successful write.\n+   * This method will be called when a write operation is committed successfully.\n+   *\n+   * @param commitTime commitTime which is successfully committed\n+   */\n+  void call(String commitTime);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db65a1ef99dd62f27862a6d7fa0989bab8c5e902"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjU0MDUzOnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/callback/common/HoodieBaseCommitCallbackMessage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDo0NDowNVrOG0kDzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwNzoxNzozOVrOG0rMgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc2OTkzNA==", "bodyText": "If we provide the  table name as a parameter in HoodieWriteCommitCallback#call(...), then this class is not necessary, IMO.", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457769934", "createdAt": "2020-07-21T00:44:05Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/common/HoodieBaseCommitCallbackMessage.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.common;\n+\n+import java.io.Serializable;\n+\n+/**\n+ * Base callback message, which contains commitTime and tableName only for now.\n+ */\n+public class HoodieBaseCommitCallbackMessage implements Serializable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db65a1ef99dd62f27862a6d7fa0989bab8c5e902"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzg4Njg1MQ==", "bodyText": "If we provide the table name as a parameter in HoodieWriteCommitCallback#call(...), then this class is not necessary, IMO.\n\nYes, that would be more concise, but it maybe a little inconvenient to expand as more params may be needed in the future, WDYT?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457886851", "createdAt": "2020-07-21T07:17:39Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/common/HoodieBaseCommitCallbackMessage.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.common;\n+\n+import java.io.Serializable;\n+\n+/**\n+ * Base callback message, which contains commitTime and tableName only for now.\n+ */\n+public class HoodieBaseCommitCallbackMessage implements Serializable {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc2OTkzNA=="}, "originalCommit": {"oid": "db65a1ef99dd62f27862a6d7fa0989bab8c5e902"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjU0OTQyOnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/callback/client/http/HoodieWriteCallbackHttpClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDo0OTowN1rOG0kJDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDo0OTowN1rOG0kJDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc3MTI3OQ==", "bodyText": "We may need to consider making these hard codes configurable.", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457771279", "createdAt": "2020-07-21T00:49:07Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/client/http/HoodieWriteCallbackHttpClient.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.client.http;\n+\n+import org.apache.http.HttpHeaders;\n+import org.apache.http.client.config.RequestConfig;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.entity.ContentType;\n+import org.apache.http.entity.StringEntity;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClientBuilder;\n+import org.apache.hudi.config.HoodieWriteCommitCallbackConfig;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+import org.apache.log4j.LogManager;\n+import org.apache.log4j.Logger;\n+\n+import java.io.Closeable;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write commit callback http client.\n+ */\n+public class HoodieWriteCallbackHttpClient implements Closeable {\n+\n+  private static final Logger LOG = LogManager.getLogger(HoodieWriteCallbackHttpClient.class);\n+\n+  public static final String HEADER_KEY_API_KEY = \"HUDI-CALLBACK-KEY\";\n+\n+  private final String apiKey;\n+  private final String url;\n+  private final CloseableHttpClient client;\n+  private Properties props;\n+\n+  public HoodieWriteCallbackHttpClient(HoodieWriteConfig config) {\n+    this.props = config.getProps();\n+    this.apiKey = getApiKey();\n+    this.url = getUrl();\n+    this.client = getClient();\n+  }\n+\n+  public HoodieWriteCallbackHttpClient(String apiKey, String url, CloseableHttpClient client) {\n+    this.apiKey = apiKey;\n+    this.url = url;\n+    this.client = client;\n+  }\n+\n+  public void send(String callbackMsg) {\n+    HttpPost request = new HttpPost(url);\n+    request.setHeader(HEADER_KEY_API_KEY, apiKey);\n+    request.setHeader(HttpHeaders.CONTENT_TYPE, ContentType.APPLICATION_JSON.toString());\n+    request.setEntity(new StringEntity(callbackMsg, ContentType.APPLICATION_JSON));\n+    try (CloseableHttpResponse response = client.execute(request)) {\n+      int statusCode = response.getStatusLine().getStatusCode();\n+      if (statusCode >= 300) {\n+        LOG.warn(String.format(\"Failed to send callback message. Response was %s\", response));\n+      } else {\n+        LOG.info(String.format(\"Sent Callback data %s to %s successfully !\", callbackMsg, url));\n+      }\n+    } catch (IOException e) {\n+      LOG.warn(\"Failed to send callback.\", e);\n+    }\n+  }\n+\n+  private String getApiKey() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_HTTP_API_KEY);\n+  }\n+\n+  private String getUrl() {\n+    return props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_HTTP_URL_PROP);\n+  }\n+\n+  private CloseableHttpClient getClient() {\n+    Integer timeoutSeconds = getHttpTimeoutSeconds();\n+    return HttpClientBuilder.create()\n+        .setDefaultRequestConfig(RequestConfig.custom()\n+            .setConnectTimeout(timeoutSeconds * 1000)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db65a1ef99dd62f27862a6d7fa0989bab8c5e902"}, "originalPosition": 94}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjU1MzYwOnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/callback/impl/HoodieHttpWriteCommitCallback.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDo1MToxM1rOG0kLbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMToxNjo1OVrOG0kmlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc3MTg4Nw==", "bodyText": "Is HoodieWriteCommitHttpCallback more reasonable?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457771887", "createdAt": "2020-07-21T00:51:13Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/impl/HoodieHttpWriteCommitCallback.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.impl;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallback;\n+import org.apache.hudi.callback.client.http.HoodieWriteCallbackHttpClient;\n+import org.apache.hudi.callback.common.HoodieBaseCommitCallbackMessage;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+import org.apache.hudi.exception.HoodieCommitCallbackException;\n+import org.apache.log4j.LogManager;\n+import org.apache.log4j.Logger;\n+import org.codehaus.jackson.map.ObjectMapper;\n+\n+import java.io.IOException;\n+\n+/**\n+ * A http implementation of {@link HoodieWriteCommitCallback}.\n+ */\n+public class HoodieHttpWriteCommitCallback implements HoodieWriteCommitCallback {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db65a1ef99dd62f27862a6d7fa0989bab8c5e902"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc3ODgzNg==", "bodyText": "Is HoodieWriteCommitHttpCallback more reasonable?\n\nYes, looks better", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457778836", "createdAt": "2020-07-21T01:16:59Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/impl/HoodieHttpWriteCommitCallback.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.impl;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallback;\n+import org.apache.hudi.callback.client.http.HoodieWriteCallbackHttpClient;\n+import org.apache.hudi.callback.common.HoodieBaseCommitCallbackMessage;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+import org.apache.hudi.exception.HoodieCommitCallbackException;\n+import org.apache.log4j.LogManager;\n+import org.apache.log4j.Logger;\n+import org.codehaus.jackson.map.ObjectMapper;\n+\n+import java.io.IOException;\n+\n+/**\n+ * A http implementation of {@link HoodieWriteCommitCallback}.\n+ */\n+public class HoodieHttpWriteCommitCallback implements HoodieWriteCommitCallback {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc3MTg4Nw=="}, "originalCommit": {"oid": "db65a1ef99dd62f27862a6d7fa0989bab8c5e902"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NjU2MTk1OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQwMDo1NjoxNVrOG0kQfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQxMjozMzozNVrOG01xyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc3MzE4Mw==", "bodyText": "IMO, this property is not necessary. We can only depend on getCallbackClass  to specify the detailed implementation. This is a simple SPI mode.  Otherwise, it causes two entry points in the factory you implemented. WDYT?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r457773183", "createdAt": "2020-07-21T00:56:15Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "diffHunk": "@@ -632,6 +632,21 @@ public FileSystemViewStorageConfig getClientSpecifiedViewStorageConfig() {\n     return clientSpecifiedViewStorageConfig;\n   }\n \n+  /**\n+   * Commit call back configs.\n+   */\n+  public boolean writeCommitCallbackOn() {\n+    return Boolean.parseBoolean(props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_ON));\n+  }\n+\n+  public String getCallbackType() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db65a1ef99dd62f27862a6d7fa0989bab8c5e902"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODA2MDIzNA==", "bodyText": "IMO, this property is not necessary. We can only depend on getCallbackClass  to specify the detailed implementation. This is a simple SPI mode. Otherwise, it causes two entry points in the factory you implemented. WDYT?\n\ndone", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458060234", "createdAt": "2020-07-21T12:33:35Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java", "diffHunk": "@@ -632,6 +632,21 @@ public FileSystemViewStorageConfig getClientSpecifiedViewStorageConfig() {\n     return clientSpecifiedViewStorageConfig;\n   }\n \n+  /**\n+   * Commit call back configs.\n+   */\n+  public boolean writeCommitCallbackOn() {\n+    return Boolean.parseBoolean(props.getProperty(HoodieWriteCommitCallbackConfig.CALLBACK_ON));\n+  }\n+\n+  public String getCallbackType() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc3MzE4Mw=="}, "originalCommit": {"oid": "db65a1ef99dd62f27862a6d7fa0989bab8c5e902"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MTEwMDkzOnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTozNTowOVrOG1Pimg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTozNTowOVrOG1Pimg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4MjMzMA==", "bodyText": "This naming is strange. IMHO, does CALLBACK_SWITCH or CALLBACK_FEATURE or CALLBACK_FUNCTION look better?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458482330", "createdAt": "2020-07-22T01:35:09Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.config;\n+\n+import org.apache.hudi.common.config.DefaultHoodieConfig;\n+\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write callback related config.\n+ */\n+public class HoodieWriteCommitCallbackConfig extends DefaultHoodieConfig {\n+\n+  public static final String CALLBACK_ON = \"hoodie.write.commit.callback.on\";\n+  public static final boolean DEFAULT_CALLBACK_ON = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MTEwMjUxOnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTozNTo1NFrOG1PjhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTozNTo1NFrOG1PjhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4MjU2NQ==", "bodyText": "CALLBACK_CLASS?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458482565", "createdAt": "2020-07-22T01:35:54Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.config;\n+\n+import org.apache.hudi.common.config.DefaultHoodieConfig;\n+\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write callback related config.\n+ */\n+public class HoodieWriteCommitCallbackConfig extends DefaultHoodieConfig {\n+\n+  public static final String CALLBACK_ON = \"hoodie.write.commit.callback.on\";\n+  public static final boolean DEFAULT_CALLBACK_ON = false;\n+\n+  public static final String CALLBACK_CLASS_PROP = \"hoodie.write.commit.callback.class\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MTEwMjgwOnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTozNjowN1rOG1PjrQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNToxOTowMlrOG1nYzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4MjYwNQ==", "bodyText": "DEFAULT_CALLBACK_CLASS?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458482605", "createdAt": "2020-07-22T01:36:07Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.config;\n+\n+import org.apache.hudi.common.config.DefaultHoodieConfig;\n+\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write callback related config.\n+ */\n+public class HoodieWriteCommitCallbackConfig extends DefaultHoodieConfig {\n+\n+  public static final String CALLBACK_ON = \"hoodie.write.commit.callback.on\";\n+  public static final boolean DEFAULT_CALLBACK_ON = false;\n+\n+  public static final String CALLBACK_CLASS_PROP = \"hoodie.write.commit.callback.class\";\n+  public static final String DEFAULT_CALLBACK_CLASS_PROP = \"org.apache.hudi.callback.impl.HoodieWriteCommitHttpCallback\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODU1MjQzNQ==", "bodyText": "DEFAULT_CALLBACK_CLASS?\n\nHi, @yanghua thanks for your detailed review.\nall these variables are named referring to existing variables, keeping the same naming style would be better :)", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458552435", "createdAt": "2020-07-22T05:58:38Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.config;\n+\n+import org.apache.hudi.common.config.DefaultHoodieConfig;\n+\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write callback related config.\n+ */\n+public class HoodieWriteCommitCallbackConfig extends DefaultHoodieConfig {\n+\n+  public static final String CALLBACK_ON = \"hoodie.write.commit.callback.on\";\n+  public static final boolean DEFAULT_CALLBACK_ON = false;\n+\n+  public static final String CALLBACK_CLASS_PROP = \"hoodie.write.commit.callback.class\";\n+  public static final String DEFAULT_CALLBACK_CLASS_PROP = \"org.apache.hudi.callback.impl.HoodieWriteCommitHttpCallback\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4MjYwNQ=="}, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODg3MzAzNw==", "bodyText": "Ok, sounds good.", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458873037", "createdAt": "2020-07-22T15:19:02Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.config;\n+\n+import org.apache.hudi.common.config.DefaultHoodieConfig;\n+\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write callback related config.\n+ */\n+public class HoodieWriteCommitCallbackConfig extends DefaultHoodieConfig {\n+\n+  public static final String CALLBACK_ON = \"hoodie.write.commit.callback.on\";\n+  public static final boolean DEFAULT_CALLBACK_ON = false;\n+\n+  public static final String CALLBACK_CLASS_PROP = \"hoodie.write.commit.callback.class\";\n+  public static final String DEFAULT_CALLBACK_CLASS_PROP = \"org.apache.hudi.callback.impl.HoodieWriteCommitHttpCallback\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4MjYwNQ=="}, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MTEwNzAyOnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTozODozN1rOG1PmIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwNTo1Mzo0OFrOG1TuBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4MzIzNQ==", "bodyText": "int?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458483235", "createdAt": "2020-07-22T01:38:37Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.config;\n+\n+import org.apache.hudi.common.config.DefaultHoodieConfig;\n+\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write callback related config.\n+ */\n+public class HoodieWriteCommitCallbackConfig extends DefaultHoodieConfig {\n+\n+  public static final String CALLBACK_ON = \"hoodie.write.commit.callback.on\";\n+  public static final boolean DEFAULT_CALLBACK_ON = false;\n+\n+  public static final String CALLBACK_CLASS_PROP = \"hoodie.write.commit.callback.class\";\n+  public static final String DEFAULT_CALLBACK_CLASS_PROP = \"org.apache.hudi.callback.impl.HoodieWriteCommitHttpCallback\";\n+\n+  // ***** REST callback configs *****\n+  public static final String CALLBACK_HTTP_URL_PROP = \"hoodie.write.commit.callback.http.url\";\n+  public static final String CALLBACK_HTTP_API_KEY = \"hoodie.write.commit.callback.http.api.key\";\n+  public static final String DEFAULT_CALLBACK_HTTP_API_KEY = \"hudi_write_commit_http_callback\";\n+  public static final String CALLBACK_HTTP_TIMEOUT_SECONDS = \"hoodie.write.commit.callback.http.timeout.seconds\";\n+  public static final String DEFAULT_CALLBACK_HTTP_TIMEOUT_SECONDS = \"3\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODU1MDc5MA==", "bodyText": "int?\n\nyes, better", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458550790", "createdAt": "2020-07-22T05:53:48Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/config/HoodieWriteCommitCallbackConfig.java", "diffHunk": "@@ -0,0 +1,106 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.config;\n+\n+import org.apache.hudi.common.config.DefaultHoodieConfig;\n+\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Properties;\n+\n+/**\n+ * Write callback related config.\n+ */\n+public class HoodieWriteCommitCallbackConfig extends DefaultHoodieConfig {\n+\n+  public static final String CALLBACK_ON = \"hoodie.write.commit.callback.on\";\n+  public static final boolean DEFAULT_CALLBACK_ON = false;\n+\n+  public static final String CALLBACK_CLASS_PROP = \"hoodie.write.commit.callback.class\";\n+  public static final String DEFAULT_CALLBACK_CLASS_PROP = \"org.apache.hudi.callback.impl.HoodieWriteCommitHttpCallback\";\n+\n+  // ***** REST callback configs *****\n+  public static final String CALLBACK_HTTP_URL_PROP = \"hoodie.write.commit.callback.http.url\";\n+  public static final String CALLBACK_HTTP_API_KEY = \"hoodie.write.commit.callback.http.api.key\";\n+  public static final String DEFAULT_CALLBACK_HTTP_API_KEY = \"hudi_write_commit_http_callback\";\n+  public static final String CALLBACK_HTTP_TIMEOUT_SECONDS = \"hoodie.write.commit.callback.http.timeout.seconds\";\n+  public static final String DEFAULT_CALLBACK_HTTP_TIMEOUT_SECONDS = \"3\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4MzIzNQ=="}, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MTEyODE3OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/test/java/org/apache/hudi/callback/http/TestHoodieWriteCommitHttpCallback.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTo1MDoxMlrOG1PyZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNjoyMjowM1rOG1qHLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4NjM3Mw==", "bodyText": "What's purpose of this class?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458486373", "createdAt": "2020-07-22T01:50:12Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/test/java/org/apache/hudi/callback/http/TestHoodieWriteCommitHttpCallback.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.http;\n+\n+import org.apache.hudi.callback.impl.HoodieWriteCommitHttpCallback;\n+import org.apache.hudi.testutils.HoodieWriteCommitTestHarness;\n+import org.junit.jupiter.api.AfterEach;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.IOException;\n+\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+\n+/**\n+ * Unit test for {@link HoodieWriteCommitHttpCallback}.\n+ */\n+public class TestHoodieWriteCommitHttpCallback extends HoodieWriteCommitTestHarness {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODU1NTgyNA==", "bodyText": "What's purpose of this class?\n\nits purpose is to test the Initialization process of HoodieWriteCommitHttpCallback when provided with proper params referring to this test 'org.apache.hudi.metrics.datadog.TestDatadogMetricsReporter#instantiationShouldSucceed'.\nthis test might be unnecessary\uff0cI'll remove it if you think it is unnecessary too", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458555824", "createdAt": "2020-07-22T06:08:49Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/test/java/org/apache/hudi/callback/http/TestHoodieWriteCommitHttpCallback.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.http;\n+\n+import org.apache.hudi.callback.impl.HoodieWriteCommitHttpCallback;\n+import org.apache.hudi.testutils.HoodieWriteCommitTestHarness;\n+import org.junit.jupiter.api.AfterEach;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.IOException;\n+\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+\n+/**\n+ * Unit test for {@link HoodieWriteCommitHttpCallback}.\n+ */\n+public class TestHoodieWriteCommitHttpCallback extends HoodieWriteCommitTestHarness {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4NjM3Mw=="}, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODg3MjYzMg==", "bodyText": "IMO, it's not necessary. We can remove it.", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458872632", "createdAt": "2020-07-22T15:18:28Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/test/java/org/apache/hudi/callback/http/TestHoodieWriteCommitHttpCallback.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.http;\n+\n+import org.apache.hudi.callback.impl.HoodieWriteCommitHttpCallback;\n+import org.apache.hudi.testutils.HoodieWriteCommitTestHarness;\n+import org.junit.jupiter.api.AfterEach;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.IOException;\n+\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+\n+/**\n+ * Unit test for {@link HoodieWriteCommitHttpCallback}.\n+ */\n+public class TestHoodieWriteCommitHttpCallback extends HoodieWriteCommitTestHarness {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4NjM3Mw=="}, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODkxNzY3Nw==", "bodyText": "done", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458917677", "createdAt": "2020-07-22T16:22:03Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/test/java/org/apache/hudi/callback/http/TestHoodieWriteCommitHttpCallback.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.http;\n+\n+import org.apache.hudi.callback.impl.HoodieWriteCommitHttpCallback;\n+import org.apache.hudi.testutils.HoodieWriteCommitTestHarness;\n+import org.junit.jupiter.api.AfterEach;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.IOException;\n+\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+\n+/**\n+ * Unit test for {@link HoodieWriteCommitHttpCallback}.\n+ */\n+public class TestHoodieWriteCommitHttpCallback extends HoodieWriteCommitTestHarness {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4NjM3Mw=="}, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MTEyOTc4OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/test/java/org/apache/hudi/testutils/HoodieWriteCommitTestHarness.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQwMTo1MDo1NVrOG1PzRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNjozMTo1MlrOG1qqfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4NjU5OA==", "bodyText": "ditto", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458486598", "createdAt": "2020-07-22T01:50:55Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/test/java/org/apache/hudi/testutils/HoodieWriteCommitTestHarness.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.testutils;\n+\n+import org.apache.hudi.common.testutils.HoodieCommonTestHarness;\n+import org.apache.hudi.config.HoodieWriteCommitCallbackConfig;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+\n+import java.io.IOException;\n+\n+/**\n+ * The test harness for resource initialization and cleanup.\n+ */\n+public class HoodieWriteCommitTestHarness extends HoodieCommonTestHarness {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODU1Njc1Mg==", "bodyText": "ditto\n\nThis class provides test functions for callback service, right now, it provides functions to init and teardown HoodieWriteCommitCallbackConfig and HoodieWriteConfig", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458556752", "createdAt": "2020-07-22T06:11:32Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/test/java/org/apache/hudi/testutils/HoodieWriteCommitTestHarness.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.testutils;\n+\n+import org.apache.hudi.common.testutils.HoodieCommonTestHarness;\n+import org.apache.hudi.config.HoodieWriteCommitCallbackConfig;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+\n+import java.io.IOException;\n+\n+/**\n+ * The test harness for resource initialization and cleanup.\n+ */\n+public class HoodieWriteCommitTestHarness extends HoodieCommonTestHarness {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4NjU5OA=="}, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODg3MjcyNQ==", "bodyText": "ditto", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458872725", "createdAt": "2020-07-22T15:18:35Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/test/java/org/apache/hudi/testutils/HoodieWriteCommitTestHarness.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.testutils;\n+\n+import org.apache.hudi.common.testutils.HoodieCommonTestHarness;\n+import org.apache.hudi.config.HoodieWriteCommitCallbackConfig;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+\n+import java.io.IOException;\n+\n+/**\n+ * The test harness for resource initialization and cleanup.\n+ */\n+public class HoodieWriteCommitTestHarness extends HoodieCommonTestHarness {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4NjU5OA=="}, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODkyNjcxOQ==", "bodyText": "done", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458926719", "createdAt": "2020-07-22T16:31:52Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/test/java/org/apache/hudi/testutils/HoodieWriteCommitTestHarness.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.testutils;\n+\n+import org.apache.hudi.common.testutils.HoodieCommonTestHarness;\n+import org.apache.hudi.config.HoodieWriteCommitCallbackConfig;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+\n+import java.io.IOException;\n+\n+/**\n+ * The test harness for resource initialization and cleanup.\n+ */\n+public class HoodieWriteCommitTestHarness extends HoodieCommonTestHarness {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQ4NjU5OA=="}, "originalCommit": {"oid": "0afe21ce82f51778627f3d955f6bbb5a233f6bcb"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MzYxNTQ5OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/callback/util/HoodieCommitCallbackFactory.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNToyMTo1NlrOG1ng2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNjoyNjo0NVrOG1qZdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODg3NTA5Ng==", "bodyText": "Can we reference CALLBACK_CLASS_PROP  not hoodie.write.commit.callback.class? What's more, it's not ** Parameter**, it's a config option. Let's say e.g. The value of the config option xxx can not be ....? Does it make sense?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458875096", "createdAt": "2020-07-22T15:21:56Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/util/HoodieCommitCallbackFactory.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.util;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallback;\n+import org.apache.hudi.common.util.ReflectionUtils;\n+import org.apache.hudi.common.util.StringUtils;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+import org.apache.hudi.exception.HoodieCommitCallbackException;\n+\n+/**\n+ * Factory help to create {@link HoodieWriteCommitCallback}.\n+ */\n+public class HoodieCommitCallbackFactory {\n+  public static HoodieWriteCommitCallback create(HoodieWriteConfig config) {\n+    String callbackClass = config.getCallbackClass();\n+    if (!StringUtils.isNullOrEmpty(callbackClass)) {\n+      Object instance = ReflectionUtils.loadClass(callbackClass, config);\n+      if (!(instance instanceof HoodieWriteCommitCallback)) {\n+        throw new HoodieCommitCallbackException(callbackClass + \" is not a subclass of HoodieWriteCommitCallback\");\n+      }\n+      return (HoodieWriteCommitCallback) instance;\n+    } else {\n+      throw new HoodieCommitCallbackException(\"Parameter 'hoodie.write.commit.callback.class' can not be null or empty\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e8f6e25c1615e722d4ceca8d9c1fb2a281da749"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODkyMjM1OA==", "bodyText": "done", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458922358", "createdAt": "2020-07-22T16:26:45Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/util/HoodieCommitCallbackFactory.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.util;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallback;\n+import org.apache.hudi.common.util.ReflectionUtils;\n+import org.apache.hudi.common.util.StringUtils;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+import org.apache.hudi.exception.HoodieCommitCallbackException;\n+\n+/**\n+ * Factory help to create {@link HoodieWriteCommitCallback}.\n+ */\n+public class HoodieCommitCallbackFactory {\n+  public static HoodieWriteCommitCallback create(HoodieWriteConfig config) {\n+    String callbackClass = config.getCallbackClass();\n+    if (!StringUtils.isNullOrEmpty(callbackClass)) {\n+      Object instance = ReflectionUtils.loadClass(callbackClass, config);\n+      if (!(instance instanceof HoodieWriteCommitCallback)) {\n+        throw new HoodieCommitCallbackException(callbackClass + \" is not a subclass of HoodieWriteCommitCallback\");\n+      }\n+      return (HoodieWriteCommitCallback) instance;\n+    } else {\n+      throw new HoodieCommitCallbackException(\"Parameter 'hoodie.write.commit.callback.class' can not be null or empty\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODg3NTA5Ng=="}, "originalCommit": {"oid": "9e8f6e25c1615e722d4ceca8d9c1fb2a281da749"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MzYyNDA3OnYy", "diffSide": "RIGHT", "path": "hudi-client/src/main/java/org/apache/hudi/callback/util/HoodieCommitCallbackFactory.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNToyMzo0OFrOG1nmYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQxNjoyMTowN1rOG1qDwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODg3NjUxNQ==", "bodyText": "Let's use HoodieWriteCommitHttpCallback.class.getSimpleName()  to replace the hard code HoodieWriteCommitCallback ?", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458876515", "createdAt": "2020-07-22T15:23:48Z", "author": {"login": "yanghua"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/util/HoodieCommitCallbackFactory.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.util;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallback;\n+import org.apache.hudi.common.util.ReflectionUtils;\n+import org.apache.hudi.common.util.StringUtils;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+import org.apache.hudi.exception.HoodieCommitCallbackException;\n+\n+/**\n+ * Factory help to create {@link HoodieWriteCommitCallback}.\n+ */\n+public class HoodieCommitCallbackFactory {\n+  public static HoodieWriteCommitCallback create(HoodieWriteConfig config) {\n+    String callbackClass = config.getCallbackClass();\n+    if (!StringUtils.isNullOrEmpty(callbackClass)) {\n+      Object instance = ReflectionUtils.loadClass(callbackClass, config);\n+      if (!(instance instanceof HoodieWriteCommitCallback)) {\n+        throw new HoodieCommitCallbackException(callbackClass + \" is not a subclass of HoodieWriteCommitCallback\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e8f6e25c1615e722d4ceca8d9c1fb2a281da749"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODkxNjgwMQ==", "bodyText": "Let's use HoodieWriteCommitHttpCallback.class.getSimpleName()  to replace the hard code HoodieWriteCommitCallback ?\n\ndone", "url": "https://github.com/apache/hudi/pull/1842#discussion_r458916801", "createdAt": "2020-07-22T16:21:07Z", "author": {"login": "wangxianghu"}, "path": "hudi-client/src/main/java/org/apache/hudi/callback/util/HoodieCommitCallbackFactory.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hudi.callback.util;\n+\n+import org.apache.hudi.callback.HoodieWriteCommitCallback;\n+import org.apache.hudi.common.util.ReflectionUtils;\n+import org.apache.hudi.common.util.StringUtils;\n+import org.apache.hudi.config.HoodieWriteConfig;\n+import org.apache.hudi.exception.HoodieCommitCallbackException;\n+\n+/**\n+ * Factory help to create {@link HoodieWriteCommitCallback}.\n+ */\n+public class HoodieCommitCallbackFactory {\n+  public static HoodieWriteCommitCallback create(HoodieWriteConfig config) {\n+    String callbackClass = config.getCallbackClass();\n+    if (!StringUtils.isNullOrEmpty(callbackClass)) {\n+      Object instance = ReflectionUtils.loadClass(callbackClass, config);\n+      if (!(instance instanceof HoodieWriteCommitCallback)) {\n+        throw new HoodieCommitCallbackException(callbackClass + \" is not a subclass of HoodieWriteCommitCallback\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODg3NjUxNQ=="}, "originalCommit": {"oid": "9e8f6e25c1615e722d4ceca8d9c1fb2a281da749"}, "originalPosition": 35}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4574, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}