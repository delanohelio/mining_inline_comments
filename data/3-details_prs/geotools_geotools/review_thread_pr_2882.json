{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0NTA2MTY2", "number": 2882, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTo1MjozMlrODzzD7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTo1NzowOVrODzzNVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NjQwNTU3OnYy", "diffSide": "RIGHT", "path": "modules/unsupported/mbtiles/src/main/java/org/geotools/mbtiles/MBTilesFeatureSource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTo1MjozMlrOGIba_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTo1MjozMlrOGIba_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ5MTA2OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (f != null && f.equals(Filter.INCLUDE)) {\n          \n          \n            \n                    if (f == null || f.equals(Filter.INCLUDE)) {", "url": "https://github.com/geotools/geotools/pull/2882#discussion_r411491069", "createdAt": "2020-04-20T15:52:32Z", "author": {"login": "aaime"}, "path": "modules/unsupported/mbtiles/src/main/java/org/geotools/mbtiles/MBTilesFeatureSource.java", "diffHunk": "@@ -69,11 +73,19 @@ protected void addHints(Set<Hints.Key> hints) {\n \n     @Override\n     protected ReferencedEnvelope getBoundsInternal(Query query) throws IOException {\n-        // all mbtiles likely have a root tile that covers the world, the real intended\n-        // bound is normally found at the max zoom level. However, the latest zoom level is the one\n-        // with the most tiles, this takes ages on large mbtiles,\n-        // so best to have it disabled... or maybe make it optional later\n-        return null;\n+        Filter f = query.getFilter();\n+        if (f != null && f.equals(Filter.INCLUDE)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4904b7db36844a88b5357092533ad375530b3012"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NjQyOTY0OnYy", "diffSide": "RIGHT", "path": "modules/unsupported/mbtiles/src/test/java/org/geotools/mbtiles/MBTilesFeatureSourceTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTo1NzowOVrOGIbpuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTo1NzowOVrOGIbpuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ5NDg0Mw==", "bodyText": "Was a bit surprised but indeed the bbox in the medatata is the whole world:\n\nSo looking good.", "url": "https://github.com/geotools/geotools/pull/2882#discussion_r411494843", "createdAt": "2020-04-20T15:57:09Z", "author": {"login": "aaime"}, "path": "modules/unsupported/mbtiles/src/test/java/org/geotools/mbtiles/MBTilesFeatureSourceTest.java", "diffHunk": "@@ -293,6 +294,35 @@ public void testReadOutsideWorld() throws Exception {\n         assertThat(rangesRead, Matchers.empty());\n     }\n \n+    @Test\n+    public void testGetBBOXQueryALL() throws Exception {\n+        File file =\n+                URLs.urlToFile(MBTilesFileVectorTileTest.class.getResource(\"madagascar.mbtiles\"));\n+        this.store = new MBTilesDataStore(new MBTilesFile(file));\n+        ReferencedEnvelope envelope = store.getFeatureSource(\"water\").getBounds();\n+        assertNotNull(envelope);\n+        assertEquals(\n+                new ReferencedEnvelope(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4904b7db36844a88b5357092533ad375530b3012"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3590, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}