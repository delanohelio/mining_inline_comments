{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMDQ3MTk4", "number": 3027, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo0Mzo1OVrOEKIbzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo0Mzo1OVrOEKIbzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5MDU5NDA0OnYy", "diffSide": "RIGHT", "path": "modules/plugin/shapefile/src/main/java/org/geotools/data/shapefile/ShapefileFeatureWriter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo0Mzo1OVrOGq_3Zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQxNDo0Njo1NFrOGrAAZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzczOTc1MQ==", "bodyText": "It could be argued that JTSUtilities is at fault here and should return null when fed an empty geometry of any type. But I'm not sure what the knock on effects would be.", "url": "https://github.com/geotools/geotools/pull/3027#discussion_r447739751", "createdAt": "2020-06-30T14:43:59Z", "author": {"login": "ianturton"}, "path": "modules/plugin/shapefile/src/main/java/org/geotools/data/shapefile/ShapefileFeatureWriter.java", "diffHunk": "@@ -376,7 +376,13 @@ public void write() throws IOException {\n         }\n \n         // convert geometry\n-        g = JTSUtilities.convertToCollection(g, shapeType);\n+        if (g != null) {\n+            if (g.isEmpty()) {\n+                g = null;\n+            } else {\n+                g = JTSUtilities.convertToCollection(g, shapeType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "381951a54dcf85a682f1900bdab5db5023db19e5"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzc0MjA1NA==", "bodyText": "Thought about it, but the method says \"convert to collection\", going from empty to null geometry seems something else to me.", "url": "https://github.com/geotools/geotools/pull/3027#discussion_r447742054", "createdAt": "2020-06-30T14:46:54Z", "author": {"login": "aaime"}, "path": "modules/plugin/shapefile/src/main/java/org/geotools/data/shapefile/ShapefileFeatureWriter.java", "diffHunk": "@@ -376,7 +376,13 @@ public void write() throws IOException {\n         }\n \n         // convert geometry\n-        g = JTSUtilities.convertToCollection(g, shapeType);\n+        if (g != null) {\n+            if (g.isEmpty()) {\n+                g = null;\n+            } else {\n+                g = JTSUtilities.convertToCollection(g, shapeType);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzczOTc1MQ=="}, "originalCommit": {"oid": "381951a54dcf85a682f1900bdab5db5023db19e5"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3566, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}