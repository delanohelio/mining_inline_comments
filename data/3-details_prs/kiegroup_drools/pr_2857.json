{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0MDk4MjA4", "number": 2857, "title": "[DROOLS-5237] Wrong property reactivity with non getter chain of non-\u2026", "bodyText": "\u2026direct statements\nhttps://issues.redhat.com/browse/DROOLS-5237", "createdAt": "2020-04-16T03:37:14Z", "url": "https://github.com/kiegroup/drools/pull/2857", "merged": true, "mergeCommit": {"oid": "1fd25c2d313b284947690e5bb8fd7f777d749ea3"}, "closed": true, "closedAt": "2020-04-17T09:14:20Z", "author": {"login": "tkobayas"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYFv-6AH2gAyNDA0MDk4MjA4OmE3YmFlY2RjZDBhYWJjMmM2NTU0ZmRlZTY1YTkzMjE2OTJjMTlmNjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcYMmjRAFqTM5NDYyNTA4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a7baecdcd0aabc2c6554fdee65a9321692c19f62", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/a7baecdcd0aabc2c6554fdee65a9321692c19f62", "committedDate": "2020-04-16T05:22:12Z", "message": "[DROOLS-5237] Wrong property reactivity with non getter chain of non-direct statements"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b858ab66e0db0090a591fa5e3bfcf6fd7fb6d8b6", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/b858ab66e0db0090a591fa5e3bfcf6fd7fb6d8b6", "committedDate": "2020-04-16T03:34:08Z", "message": "[DROOLS-5237] Wrong property reactivity with non getter chain of non-direct statements"}, "afterCommit": {"oid": "a7baecdcd0aabc2c6554fdee65a9321692c19f62", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/a7baecdcd0aabc2c6554fdee65a9321692c19f62", "committedDate": "2020-04-16T05:22:12Z", "message": "[DROOLS-5237] Wrong property reactivity with non getter chain of non-direct statements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MzQyNzkx", "url": "https://github.com/kiegroup/drools/pull/2857#pullrequestreview-394342791", "createdAt": "2020-04-16T06:51:29Z", "commit": {"oid": "a7baecdcd0aabc2c6554fdee65a9321692c19f62"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MzQyODQ4", "url": "https://github.com/kiegroup/drools/pull/2857#pullrequestreview-394342848", "createdAt": "2020-04-16T06:51:35Z", "commit": {"oid": "a7baecdcd0aabc2c6554fdee65a9321692c19f62"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1MTozNVrOGGW9ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNlQwNjo1MTozNVrOGGW9ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTMyMDg0Mg==", "bodyText": "Similar to standard-drl, we want to evaluate only direct statements.\nFor example, assuming you have\n{\n    System.out.println(\"name.length = \" + $p.getName().length());\n    modify($p) { setAge(41) };\n}\n\nin RHS. findModifiedProperties() takes various MethodCallExpr as methodCallExprs.\n\nSystem.out.println(\"name.length = \" + $p.getName().length())\n$p.getName().length()\n$p.getName()\n($p).setAge(41)\n\nHowever, what we want to parse are, only direct statements.\n\nSystem.out.println(\"name.length = \" + $p.getName().length())\n($p).setAge(41)\n\nThen, System.out.println(\"name.length = \" + $p.getName().length()) is not accepted because scope is not $p.\nThen, only \"age\" is parsed as modified property.", "url": "https://github.com/kiegroup/drools/pull/2857#discussion_r409320842", "createdAt": "2020-04-16T06:51:35Z", "author": {"login": "tkobayas"}, "path": "drools-model/drools-model-compiler/src/main/java/org/drools/modelcompiler/builder/generator/Consequence.java", "diffHunk": "@@ -425,6 +428,10 @@ private AssignExpr createBitMaskField(String updatedVar, MethodCallExpr bitMaskC\n         return modifiedProps;\n     }\n \n+    private boolean isDirectExpression(MethodCallExpr methodCall) {\n+        return methodCall.getParentNode().map(parent -> parent instanceof ExpressionStmt).orElse(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7baecdcd0aabc2c6554fdee65a9321692c19f62"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0NjAxNzY3", "url": "https://github.com/kiegroup/drools/pull/2857#pullrequestreview-394601767", "createdAt": "2020-04-16T12:54:07Z", "commit": {"oid": "a7baecdcd0aabc2c6554fdee65a9321692c19f62"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0NjI1MDgy", "url": "https://github.com/kiegroup/drools/pull/2857#pullrequestreview-394625082", "createdAt": "2020-04-16T13:21:14Z", "commit": {"oid": "a7baecdcd0aabc2c6554fdee65a9321692c19f62"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1489, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}