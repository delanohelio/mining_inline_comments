{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0MDc0MTc3", "number": 3298, "title": "[DROOLS-5875] phreak groupby node", "bodyText": "", "createdAt": "2020-12-22T11:53:34Z", "url": "https://github.com/kiegroup/drools/pull/3298", "merged": true, "mergeCommit": {"oid": "a8f73675fcf94874871c6b7505f207b41c7b7e93"}, "closed": true, "closedAt": "2021-01-05T13:18:27Z", "author": {"login": "mariofusco"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdpB9iXgH2gAyNTQ0MDc0MTc3OmQ5NDdmMmQ2ZTNlYjUzMWQ2YmVjOGU0NTA3NzhkZTdiZjdhZGM5M2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdtIvvmgH2gAyNTQ0MDc0MTc3OjU1YTdlZmZiYmQ4NTZhMTI1MGI4ZDNhMWRjZmM0ZTRmNjc4MDhlY2Y=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d947f2d6e3eb531d6bec8e450778de7bf7adc93a", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/d947f2d6e3eb531d6bec8e450778de7bf7adc93a", "committedDate": "2020-12-23T16:45:15Z", "message": "[DROOLS-5875] phreak groupby node"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb205d26425f1b14db72175332e358ee0a961124", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/eb205d26425f1b14db72175332e358ee0a961124", "committedDate": "2020-12-23T16:45:15Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8164a93406590e410478b7417026549641cd87a5", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/8164a93406590e410478b7417026549641cd87a5", "committedDate": "2020-12-23T16:45:15Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1eb47481847e388b683f84cb00dffd1883c4136e", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/1eb47481847e388b683f84cb00dffd1883c4136e", "committedDate": "2020-12-23T16:45:15Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe796b3e0209a4a946e715e0203791011ae44de6", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/fe796b3e0209a4a946e715e0203791011ae44de6", "committedDate": "2020-12-23T16:45:16Z", "message": "add support for multi function groupBy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad39eb61763fed2dc332835b5b17702d2e733161", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/ad39eb61763fed2dc332835b5b17702d2e733161", "committedDate": "2020-12-23T16:45:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ba1eaa74dba321fef1b99c0acc93e9e6ada83e3", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/9ba1eaa74dba321fef1b99c0acc93e9e6ada83e3", "committedDate": "2020-12-23T16:45:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7470aec6152e58a5ac7af21f0b316bea321a75ed", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/7470aec6152e58a5ac7af21f0b316bea321a75ed", "committedDate": "2020-12-23T16:45:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8880b63a7d244f500e6244b67ccdd3fde12ec0a", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/e8880b63a7d244f500e6244b67ccdd3fde12ec0a", "committedDate": "2020-12-23T16:45:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa41ef509536ad92b0c6ad638a06c150bd357aa7", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/aa41ef509536ad92b0c6ad638a06c150bd357aa7", "committedDate": "2020-12-23T16:45:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "353e8136509e1490cf367d863d89bb9b1dda3895", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/353e8136509e1490cf367d863d89bb9b1dda3895", "committedDate": "2020-12-23T16:45:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51e733a1201d078ddf91b734476f8d90fe9320d3", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/51e733a1201d078ddf91b734476f8d90fe9320d3", "committedDate": "2020-12-23T16:45:16Z", "message": "2 groupbys failing test case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58ac4f0b370c98b3a63605c3dcc7bff1895c744b", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/58ac4f0b370c98b3a63605c3dcc7bff1895c744b", "committedDate": "2020-12-23T16:45:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c372587e1c97062bda592fa2f1f156068cf4e1e4", "author": {"user": null}, "url": "https://github.com/kiegroup/drools/commit/c372587e1c97062bda592fa2f1f156068cf4e1e4", "committedDate": "2020-12-23T16:45:16Z", "message": "-Accumulate no longer needs a reverse map."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93713b9c50be48122a46a6603b72f5d9c483e6b3", "author": {"user": null}, "url": "https://github.com/kiegroup/drools/commit/93713b9c50be48122a46a6603b72f5d9c483e6b3", "committedDate": "2020-12-23T16:45:16Z", "message": "-GroupbyTest works except for for the test with two group bys"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bba1d55b20c6d1ff631d9012d9309410e2bfa5c3", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/bba1d55b20c6d1ff631d9012d9309410e2bfa5c3", "committedDate": "2020-12-23T16:45:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f7f49e9b990e682a122f25088a8af43cba97c9f", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/3f7f49e9b990e682a122f25088a8af43cba97c9f", "committedDate": "2020-12-23T16:45:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f5921653f93e7ce81dc8f777a65fdf8923bc41c", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/4f5921653f93e7ce81dc8f777a65fdf8923bc41c", "committedDate": "2020-12-23T16:58:27Z", "message": "wip"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d4d57c71fde71a7762efc2e04d8ae84de819b8d0", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/d4d57c71fde71a7762efc2e04d8ae84de819b8d0", "committedDate": "2020-12-22T11:52:11Z", "message": "wip"}, "afterCommit": {"oid": "4f5921653f93e7ce81dc8f777a65fdf8923bc41c", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/4f5921653f93e7ce81dc8f777a65fdf8923bc41c", "committedDate": "2020-12-23T16:58:27Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f3ebaba648c733c1d4825f68413d3ee89b98909", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/1f3ebaba648c733c1d4825f68413d3ee89b98909", "committedDate": "2020-12-24T10:26:23Z", "message": "fix nested groupby"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac95c7fee48fa9aa563bfcfa789addca97199406", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/ac95c7fee48fa9aa563bfcfa789addca97199406", "committedDate": "2020-12-29T09:25:14Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8a04f37cb5565124f7799837bab8862ee9726c8", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/a8a04f37cb5565124f7799837bab8862ee9726c8", "committedDate": "2020-12-29T16:01:57Z", "message": "remove 3-rules based implementation for GroupBy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NjMyNDEz", "url": "https://github.com/kiegroup/drools/pull/3298#pullrequestreview-559632413", "createdAt": "2020-12-29T17:33:05Z", "commit": {"oid": "a8a04f37cb5565124f7799837bab8862ee9726c8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxNzozMzowNVrOIMUbLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxNzozNTo1N1rOIMUegA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTc4ODQ2Mw==", "bodyText": "Want to leave this here?", "url": "https://github.com/kiegroup/drools/pull/3298#discussion_r549788463", "createdAt": "2020-12-29T17:33:05Z", "author": {"login": "triceo"}, "path": "drools-core/src/main/java/org/drools/core/common/LeftTupleIterator.java", "diffHunk": "@@ -76,7 +76,7 @@ public void setFirstLeftTupleForNode() {\n     public LeftTuple getFirstLeftTuple(LeftTupleSource source,\n                                        LeftTupleSink sink,\n                                        InternalWorkingMemory wm) {\n-        if ( source instanceof AccumulateNode ) {\n+        if ( source instanceof AccumulateNode ) { // TODO WHAT ABOUTGROUPBY ? (mdp)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8a04f37cb5565124f7799837bab8862ee9726c8"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTc4OTMxMg==", "bodyText": "Want to leave this here?", "url": "https://github.com/kiegroup/drools/pull/3298#discussion_r549789312", "createdAt": "2020-12-29T17:35:57Z", "author": {"login": "triceo"}, "path": "drools-core/src/main/java/org/drools/core/phreak/PhreakAccumulateNode.java", "diffHunk": "@@ -577,14 +576,14 @@ public void doRightDeletes(AccumulateNode accNode,\n                         LeftTuple nextLeft = match.getRightParentNext();\n \n                         LeftTuple leftTuple = match.getLeftParent();\n-                        final AccumulateContext accctx = (AccumulateContext) leftTuple.getContextObject();\n+                        final BaseAccumulation accctx = (BaseAccumulation) leftTuple.getContextObject();\n+                        // FIXME This will be really slow, if it re-accumulates on the same LeftTuple (MDP)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8a04f37cb5565124f7799837bab8862ee9726c8"}, "originalPosition": 345}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4007d604f95c2b7d2a782b47bda1a07017070b66", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/4007d604f95c2b7d2a782b47bda1a07017070b66", "committedDate": "2021-01-04T10:24:05Z", "message": "restore getObjectsDeep functionality"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNjM5MzU0", "url": "https://github.com/kiegroup/drools/pull/3298#pullrequestreview-561639354", "createdAt": "2021-01-05T09:35:56Z", "commit": {"oid": "4007d604f95c2b7d2a782b47bda1a07017070b66"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwOTozNTo1NlrOIOQOoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNVQwOTozNTo1NlrOIOQOoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTgxNjg2NQ==", "bodyText": "I'm not sure I understood this comment", "url": "https://github.com/kiegroup/drools/pull/3298#discussion_r551816865", "createdAt": "2021-01-05T09:35:56Z", "author": {"login": "lucamolteni"}, "path": "drools-model/drools-model-compiler/src/test/java/org/drools/modelcompiler/GroupByTest.java", "diffHunk": "@@ -171,16 +175,22 @@ public void testGroupPersonsInitial() throws Exception {\n \n         Variable<String> var_$key = D.declarationOf(String.class);\n         Variable<Person> var_$p = D.declarationOf(Person.class);\n+        Variable<List> var_$list = D.declarationOf(List.class);\n \n         Rule rule1 = D.rule(\"R1\").build(\n                 D.groupBy(\n                         // Patterns\n                         D.pattern(var_$p),\n                         // Grouping Function\n-                        var_$p, var_$key, person -> person.getName().substring(0, 1)),\n+                        var_$p, var_$key, person -> person.getName().substring(0, 1)//,\n+                        //D.accFunction(org.drools.core.base.accumulators.CollectListAccumulateFunction::new, var_$p).as(var_$list)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4007d604f95c2b7d2a782b47bda1a07017070b66"}, "originalPosition": 51}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55a7effbbd856a1250b8d3a1dcfc4e4f67808ecf", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/55a7effbbd856a1250b8d3a1dcfc4e4f67808ecf", "committedDate": "2021-01-05T10:55:13Z", "message": "remove misleading comment"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1705, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}