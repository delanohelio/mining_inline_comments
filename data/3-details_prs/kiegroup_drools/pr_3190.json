{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNDkyMzUy", "number": 3190, "title": "[DROOLS-5485] Move test cases from drools-mvel to drools-test-coverage", "bodyText": "First try: Copied 3 test classes\n\nThis is the very early stage of the work. I just wanted to share how I modify the test code when moving. I added you as reviewers but don't approve yet. Just feel free to share your thoughts if you have any.\nJIRA:\nhttps://issues.redhat.com/browse/DROOLS-5485\n\n\nHow to retest this PR or trigger a specific build:\n\n\n\na pull request please add comment: Jenkins retest this\n\n\na full downstream build please add comment: Jenkins run fdb\n\n\na compile downstream build please  add comment: Jenkins run cdb\n\n\na full production downstream build please add comment: Jenkins execute product fdb\n\n\nan upstream build please add comment: Jenkins run upstream", "createdAt": "2020-10-27T05:58:21Z", "url": "https://github.com/kiegroup/drools/pull/3190", "merged": true, "mergeCommit": {"oid": "102903905d8d0b8540c2bb61b3e96d9207ccea8b"}, "closed": true, "closedAt": "2020-11-16T08:55:09Z", "author": {"login": "tkobayas"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWiokNgFqTUxNzM3MDk5NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcF2IdAFqTUzMDAwMTc1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MzcwOTk1", "url": "https://github.com/kiegroup/drools/pull/3190#pullrequestreview-517370995", "createdAt": "2020-10-27T06:04:39Z", "commit": {"oid": "07265c3af57216870f8e206915c4d7faef1b61fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjowNDozOVrOHosliQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjowNDozOVrOHosliQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNTU5Mw==", "bodyText": "Basically, I will move test cases under org.drools.mvel.integrationtests which are usually DRL based tests. Once finished, I will likely check if there are any other good test cases to move.", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512435593", "createdAt": "2020-10-27T06:04:39Z", "author": {"login": "tkobayas"}, "path": "drools-test-coverage/test-compiler-integration/src/test/java/org/drools/mvel/integrationtests/AlphaNodeTest.java", "diffHunk": "@@ -0,0 +1,253 @@\n+/*\n+ * Copyright (c) 2020. Red Hat, Inc. and/or its affiliates.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.drools.mvel.integrationtests;\n+\n+import java.util.Collection;\n+\n+import org.drools.mvel.compiler.Person;\n+import org.drools.testcoverage.common.util.KieBaseTestConfiguration;\n+import org.drools.testcoverage.common.util.KieBaseUtil;\n+import org.drools.testcoverage.common.util.TestParametersUtil;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import org.kie.api.KieBase;\n+import org.kie.api.runtime.KieSession;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+@RunWith(Parameterized.class)\n+public class AlphaNodeTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07265c3af57216870f8e206915c4d7faef1b61fc"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MzcyMDA0", "url": "https://github.com/kiegroup/drools/pull/3190#pullrequestreview-517372004", "createdAt": "2020-10-27T06:07:27Z", "commit": {"oid": "07265c3af57216870f8e206915c4d7faef1b61fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjowNzoyN1rOHosomA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjowNzoyN1rOHosomA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNjM3Ng==", "bodyText": "Basically, I can replace CommonTestMethodBase.loadKnowledgeBaseFromString(drl) with KieBaseUtil methods. Now we can test with specified configurations (standard/flow/pattern).", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512436376", "createdAt": "2020-10-27T06:07:27Z", "author": {"login": "tkobayas"}, "path": "drools-test-coverage/test-compiler-integration/src/test/java/org/drools/mvel/integrationtests/AlphaNodeTest.java", "diffHunk": "@@ -0,0 +1,253 @@\n+/*\n+ * Copyright (c) 2020. Red Hat, Inc. and/or its affiliates.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.drools.mvel.integrationtests;\n+\n+import java.util.Collection;\n+\n+import org.drools.mvel.compiler.Person;\n+import org.drools.testcoverage.common.util.KieBaseTestConfiguration;\n+import org.drools.testcoverage.common.util.KieBaseUtil;\n+import org.drools.testcoverage.common.util.TestParametersUtil;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import org.kie.api.KieBase;\n+import org.kie.api.runtime.KieSession;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+@RunWith(Parameterized.class)\n+public class AlphaNodeTest {\n+\n+    private final KieBaseTestConfiguration kieBaseTestConfiguration;\n+\n+    public AlphaNodeTest(final KieBaseTestConfiguration kieBaseTestConfiguration) {\n+        this.kieBaseTestConfiguration = kieBaseTestConfiguration;\n+    }\n+\n+    @Parameterized.Parameters(name = \"KieBase type={0}\")\n+    public static Collection<Object[]> getParameters() {\n+        return TestParametersUtil.getKieBaseCloudConfigurations(true);\n+    }\n+\n+    @Test\n+    public void testAlpha() {\n+        String str =\n+                \"import \" + Person.class.getCanonicalName() + \"\\n\" +\n+                \"rule R1 when\\n\" +\n+                \"  $p : Person(name == \\\"Mario\\\")\\n\" +\n+                \"then\\n\" +\n+                \"end\\n\";\n+\n+        KieBase kbase = KieBaseUtil.getKieBaseFromKieModuleFromDrl(\"test\", kieBaseTestConfiguration, str);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07265c3af57216870f8e206915c4d7faef1b61fc"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MzcyNTM5", "url": "https://github.com/kiegroup/drools/pull/3190#pullrequestreview-517372539", "createdAt": "2020-10-27T06:08:56Z", "commit": {"oid": "07265c3af57216870f8e206915c4d7faef1b61fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjowODo1N1rOHosqAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjowODo1N1rOHosqAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNjczOQ==", "bodyText": "I will follow the typical approach of test-compiler-integration", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512436739", "createdAt": "2020-10-27T06:08:57Z", "author": {"login": "tkobayas"}, "path": "drools-test-coverage/test-compiler-integration/src/test/java/org/drools/mvel/integrationtests/AlphaNodeTest.java", "diffHunk": "@@ -0,0 +1,253 @@\n+/*\n+ * Copyright (c) 2020. Red Hat, Inc. and/or its affiliates.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.drools.mvel.integrationtests;\n+\n+import java.util.Collection;\n+\n+import org.drools.mvel.compiler.Person;\n+import org.drools.testcoverage.common.util.KieBaseTestConfiguration;\n+import org.drools.testcoverage.common.util.KieBaseUtil;\n+import org.drools.testcoverage.common.util.TestParametersUtil;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import org.kie.api.KieBase;\n+import org.kie.api.runtime.KieSession;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+@RunWith(Parameterized.class)\n+public class AlphaNodeTest {\n+\n+    private final KieBaseTestConfiguration kieBaseTestConfiguration;\n+\n+    public AlphaNodeTest(final KieBaseTestConfiguration kieBaseTestConfiguration) {\n+        this.kieBaseTestConfiguration = kieBaseTestConfiguration;\n+    }\n+\n+    @Parameterized.Parameters(name = \"KieBase type={0}\")\n+    public static Collection<Object[]> getParameters() {\n+        return TestParametersUtil.getKieBaseCloudConfigurations(true);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07265c3af57216870f8e206915c4d7faef1b61fc"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3Mzc0NDE3", "url": "https://github.com/kiegroup/drools/pull/3190#pullrequestreview-517374417", "createdAt": "2020-10-27T06:14:06Z", "commit": {"oid": "07265c3af57216870f8e206915c4d7faef1b61fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjoxNDowNlrOHosv8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjoxNDowNlrOHosv8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzODI1OQ==", "bodyText": "At the moment, I use the same package name org.drools.mvel.integrationtests but probably it's not suitable after finishing the move because these tests are no longer specific to mvel. org.drools.compiler.integrationtests is already used by existing test cases. If you have a good candidate name, let me know :)", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512438259", "createdAt": "2020-10-27T06:14:06Z", "author": {"login": "tkobayas"}, "path": "drools-test-coverage/test-compiler-integration/src/test/java/org/drools/mvel/integrationtests/AlphaNodeTest.java", "diffHunk": "@@ -0,0 +1,253 @@\n+/*\n+ * Copyright (c) 2020. Red Hat, Inc. and/or its affiliates.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.drools.mvel.integrationtests;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07265c3af57216870f8e206915c4d7faef1b61fc"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "07265c3af57216870f8e206915c4d7faef1b61fc", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/07265c3af57216870f8e206915c4d7faef1b61fc", "committedDate": "2020-10-27T05:51:13Z", "message": "[DROOLS-5485] Move test cases from drools-mvel to drools-test-coverage\n- First try: Copied 3 test classes"}, "afterCommit": {"oid": "0f559bb163ecfafec89f7fa19ef6b7d0e0221d06", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/0f559bb163ecfafec89f7fa19ef6b7d0e0221d06", "committedDate": "2020-11-02T07:07:09Z", "message": "- adding more test. WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0f559bb163ecfafec89f7fa19ef6b7d0e0221d06", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/0f559bb163ecfafec89f7fa19ef6b7d0e0221d06", "committedDate": "2020-11-02T07:07:09Z", "message": "- adding more test. WIP"}, "afterCommit": {"oid": "678b65fde022f8aae660735bf15ee3ccb6239d98", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/678b65fde022f8aae660735bf15ee3ccb6239d98", "committedDate": "2020-11-02T10:13:48Z", "message": "- adding more test. WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "678b65fde022f8aae660735bf15ee3ccb6239d98", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/678b65fde022f8aae660735bf15ee3ccb6239d98", "committedDate": "2020-11-02T10:13:48Z", "message": "- adding more test. WIP"}, "afterCommit": {"oid": "2dc0e3452c9983fb85d8dc935d814eedba960172", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/2dc0e3452c9983fb85d8dc935d814eedba960172", "committedDate": "2020-11-11T06:42:23Z", "message": "[DROOLS-5485] Move test cases from drools-mvel to drools-test-coverage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78d8850b3f3d45eea6132a5624c445da6d242ca6", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/78d8850b3f3d45eea6132a5624c445da6d242ca6", "committedDate": "2020-11-12T07:08:31Z", "message": "[DROOLS-5485] Move test cases from drools-mvel to drools-test-coverage"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3bae6f4e812e02cff539e41e3d54f026dc07f759", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/3bae6f4e812e02cff539e41e3d54f026dc07f759", "committedDate": "2020-11-12T06:08:27Z", "message": "- Fixed Code Smells"}, "afterCommit": {"oid": "78d8850b3f3d45eea6132a5624c445da6d242ca6", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/78d8850b3f3d45eea6132a5624c445da6d242ca6", "committedDate": "2020-11-12T07:08:31Z", "message": "[DROOLS-5485] Move test cases from drools-mvel to drools-test-coverage"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4OTQ5NDU3", "url": "https://github.com/kiegroup/drools/pull/3190#pullrequestreview-528949457", "createdAt": "2020-11-12T10:29:08Z", "commit": {"oid": "78d8850b3f3d45eea6132a5624c445da6d242ca6"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDoyOTowOFrOHx0Wmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMDoyOTowOFrOHx0Wmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjAwMDAyNg==", "bodyText": "Can we replace this will drools-engine and drools-engine-classic?", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r522000026", "createdAt": "2020-11-12T10:29:08Z", "author": {"login": "lucamolteni"}, "path": "drools-test-coverage/test-compiler-integration/pom.xml", "diffHunk": "@@ -52,6 +52,17 @@\n       <artifactId>drools-compiler</artifactId>\n       <scope>test</scope>\n     </dependency>\n+    <dependency>\n+      <groupId>org.drools</groupId>\n+      <artifactId>drools-compiler</artifactId>\n+      <type>test-jar</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.drools</groupId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78d8850b3f3d45eea6132a5624c445da6d242ca6"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1a09fbf6604dd7aa1643148cb68700a098b6468", "author": {"user": {"login": "tkobayas", "name": "Toshiya Kobayashi"}}, "url": "https://github.com/kiegroup/drools/commit/c1a09fbf6604dd7aa1643148cb68700a098b6468", "committedDate": "2020-11-13T05:50:19Z", "message": "- Consolidate dependendies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5OTk3NzQw", "url": "https://github.com/kiegroup/drools/pull/3190#pullrequestreview-529997740", "createdAt": "2020-11-13T11:48:47Z", "commit": {"oid": "c1a09fbf6604dd7aa1643148cb68700a098b6468"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwMDAxNzUx", "url": "https://github.com/kiegroup/drools/pull/3190#pullrequestreview-530001751", "createdAt": "2020-11-13T11:55:46Z", "commit": {"oid": "c1a09fbf6604dd7aa1643148cb68700a098b6468"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1716, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}