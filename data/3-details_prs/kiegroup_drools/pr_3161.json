{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxNzE4MzE1", "number": 3161, "title": "[DROOLS-5720] make PMML to work without mvel", "bodyText": "", "createdAt": "2020-10-12T17:46:29Z", "url": "https://github.com/kiegroup/drools/pull/3161", "merged": true, "mergeCommit": {"oid": "4774b3b5cea14543438088d03ef183de2c932f76"}, "closed": true, "closedAt": "2020-10-14T12:17:55Z", "author": {"login": "mariofusco"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdR3rAXAH2gAyNTAxNzE4MzE1OmE0ODYyM2Q0MjFmNDUxYTRlNjQ3ODhlYzkxMWFmM2M1MWU3ZGFmOWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSXch3gH2gAyNTAxNzE4MzE1OmM4YTlmY2Y2MzZkNWE2MzE3ZmFiOGUyYmZmY2ZhZjg5NmVlOTQ2Yzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a48623d421f451a4e64788ec911af3c51e7daf9c", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/a48623d421f451a4e64788ec911af3c51e7daf9c", "committedDate": "2020-10-12T17:45:42Z", "message": "[DROOLS-5720] make PMML to work without mvel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MDg2NzM3", "url": "https://github.com/kiegroup/drools/pull/3161#pullrequestreview-507086737", "createdAt": "2020-10-13T05:50:28Z", "commit": {"oid": "a48623d421f451a4e64788ec911af3c51e7daf9c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwNTo1MDoyOVrOHgWT3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwNTo1MDoyOVrOHgWT3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzY4MjAxNQ==", "bodyText": "@mariofusco\nWhat's the need for that ?", "url": "https://github.com/kiegroup/drools/pull/3161#discussion_r503682015", "createdAt": "2020-10-13T05:50:29Z", "author": {"login": "gitgabrio"}, "path": "kie-pmml-trusty/kie-pmml-evaluator/kie-pmml-evaluator-assembler/src/main/java/org/kie/pmml/evaluator/assembler/factories/PMMLRuntimeFactory.java", "diffHunk": "@@ -57,13 +60,27 @@ public static PMMLRuntime getPMMLRuntime(String kbaseName, File pmmlFile, Releas\n     private static PMMLRuntime getPMMLRuntime(String kbaseName, File pmmlFile, KnowledgeBuilderImpl kbuilderImpl) {\n         FileSystemResource fileSystemResource = new FileSystemResource(pmmlFile);\n         new PMMLAssemblerService().addResource(kbuilderImpl, fileSystemResource, ResourceType.PMML, null);\n-        InternalKnowledgeBase kieBase = KnowledgeBaseFactory.newKnowledgeBase(kbaseName, new RuleBaseConfiguration());\n-        kieBase.addPackages( kbuilderImpl.getKnowledgePackages() );\n+        KieBase kieBase = createKieBase( kbuilderImpl );\n         return getPMMLRuntime(kieBase);\n     }\n \n     private static PMMLRuntime getPMMLRuntime(KieBase kieBase) {\n         final KieRuntimeFactory kieRuntimeFactory = KieRuntimeFactory.of(kieBase);\n         return kieRuntimeFactory.get(PMMLRuntime.class);\n     }\n+\n+    private static KieBase createKieBase( KnowledgeBuilderImpl kbuilderImpl ) {\n+        KieHelper kieHelper = new KieHelper();\n+        kbuilderImpl.getPackageNames().stream().flatMap( name -> kbuilderImpl.getPackageDescrs( name ).stream() )\n+                .forEach( pDescr -> kieHelper.addResource( createDescrResource(pDescr) ) );\n+        KieBase kieBase = kieHelper.build(ExecutableModelProject.class);\n+        (( InternalKnowledgeBase ) kieBase).addPackages( kbuilderImpl.getKnowledgePackages() );\n+        return kieBase;\n+    }\n+\n+    private static DescrResource createDescrResource( PackageDescr pDescr ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a48623d421f451a4e64788ec911af3c51e7daf9c"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31bf55b4e1c36feeea67d8323d58716ab2a44b85", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/31bf55b4e1c36feeea67d8323d58716ab2a44b85", "committedDate": "2020-10-13T09:02:32Z", "message": "wip"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MzQ0MTU0", "url": "https://github.com/kiegroup/drools/pull/3161#pullrequestreview-507344154", "createdAt": "2020-10-13T11:42:56Z", "commit": {"oid": "31bf55b4e1c36feeea67d8323d58716ab2a44b85"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cd62767a0eee684a06b1ea7e0005ef99b733dc6", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/2cd62767a0eee684a06b1ea7e0005ef99b733dc6", "committedDate": "2020-10-13T17:17:36Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8a9fcf636d5a6317fab8e2bffcfaf896ee946c9", "author": {"user": {"login": "mariofusco", "name": "Mario Fusco"}}, "url": "https://github.com/kiegroup/drools/commit/c8a9fcf636d5a6317fab8e2bffcfaf896ee946c9", "committedDate": "2020-10-14T06:46:51Z", "message": "wip"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1823, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}