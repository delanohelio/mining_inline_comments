{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2OTU3MTQz", "number": 3286, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOVQwODozNzowMlrOFQSS4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMlQxMDowMTowOVrOFVmMkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUyNjIxMjgxOnYy", "diffSide": "RIGHT", "path": "drools-workbench-models/drools-workbench-models-commons/src/main/java/org/drools/workbench/models/commons/backend/rule/RuleModelDRLPersistenceImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOVQwODozNzowMlrOIWDiQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOVQwODozNzowMlrOIWDiQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTk5NzUwNg==", "bodyText": "We could simplify as:\nfinal StringBuilder drl = new StringBuilder();\nfor (final String setter : entry.getValue()) {\n  drl.append(setter).append(\"\\n\");\n}\n\nfinal FreeFormLine action = new FreeFormLine();\naction.setText(drl.toString());\nm.addRhsItem(action,\n             setStatementsPosition.get(entry.getKey()));", "url": "https://github.com/kiegroup/drools/pull/3286#discussion_r559997506", "createdAt": "2021-01-19T08:37:02Z", "author": {"login": "jomarko"}, "path": "drools-workbench-models/drools-workbench-models-commons/src/main/java/org/drools/workbench/models/commons/backend/rule/RuleModelDRLPersistenceImpl.java", "diffHunk": "@@ -3154,16 +3200,30 @@ private void parseRhs(final RuleModel m,\n                 m.addRhsItem(action,\n                              setStatementsPosition.get(entry.getKey()));\n             } else {\n-                StringBuilder sb = new StringBuilder();\n-                for (String setter : entry.getValue()) {\n-                    sb.append(setter).append(\"\\n\");\n+\n+                if (splitEvals) {\n+\n+                    for (final String drl : entry.getValue()) {\n+\n+                        final FreeFormLine action = new FreeFormLine();\n+                        action.setText(drl);\n+                        m.addRhsItem(action,\n+                                     setStatementsPosition.get(entry.getKey()));\n+                    }\n+                } else {\n+\n+                    final StringBuilder sb = new StringBuilder();\n+                    for (final String setter : entry.getValue()) {\n+                        sb.append(setter).append(\"\\n\");\n+                    }\n+                    final String drl = sb.toString();\n+\n+                    final FreeFormLine action = new FreeFormLine();\n+                    action.setText(drl);\n+                    m.addRhsItem(action,\n+                                 setStatementsPosition.get(entry.getKey()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b58bc9ec51783754ed18f102fbcd705515979287"}, "originalPosition": 187}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUyNjIzMTExOnYy", "diffSide": "RIGHT", "path": "drools-workbench-models/drools-workbench-models-commons/src/main/java/org/drools/workbench/models/commons/backend/rule/RuleModelPersistence.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOVQwODo0MTowN1rOIWDsxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOVQwODo0MTowN1rOIWDsxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDAwMDE5Ng==", "bodyText": "could we please javadoc splitEvals parameter?", "url": "https://github.com/kiegroup/drools/pull/3286#discussion_r560000196", "createdAt": "2021-01-19T08:41:07Z", "author": {"login": "jomarko"}, "path": "drools-workbench-models/drools-workbench-models-commons/src/main/java/org/drools/workbench/models/commons/backend/rule/RuleModelPersistence.java", "diffHunk": "@@ -30,6 +30,11 @@ RuleModel unmarshal(final String str,\n                         final List<String> globals,\n                         final PackageDataModelOracle dmo);\n \n+    RuleModel unmarshal(final String str,\n+                        final List<String> globals,\n+                        final PackageDataModelOracle dmo,\n+                        final boolean splitEvals);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b58bc9ec51783754ed18f102fbcd705515979287"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzUyNjIzNjA3OnYy", "diffSide": "RIGHT", "path": "drools-workbench-models/drools-workbench-models-guided-dtable/src/main/java/org/drools/workbench/models/guided/dtable/backend/util/GuidedDTBRDRLPersistence.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOVQwODo0MjozM1rOIWDvxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xOVQwODo0MjozM1rOIWDvxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDAwMDk2Nw==", "bodyText": "Do not understand this comment, could you please clarify?", "url": "https://github.com/kiegroup/drools/pull/3286#discussion_r560000967", "createdAt": "2021-01-19T08:42:33Z", "author": {"login": "jomarko"}, "path": "drools-workbench-models/drools-workbench-models-guided-dtable/src/main/java/org/drools/workbench/models/guided/dtable/backend/util/GuidedDTBRDRLPersistence.java", "diffHunk": "@@ -317,28 +319,67 @@ protected void generateModifyMethodSeparator(final RHSGeneratorContext gctx,\n             }\n         }\n \n+        @Override\n+        public void visitActionCallMethod(final ActionCallMethod action) {\n+\n+            // Clony clonies", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b58bc9ec51783754ed18f102fbcd705515979287"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzU4MTkwMjI3OnYy", "diffSide": "RIGHT", "path": "drools-workbench-models/drools-workbench-models-guided-dtable/src/main/java/org/drools/workbench/models/guided/dtable/backend/util/GuidedDTBRDRLPersistence.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMlQxMDowMTowOVrOIeIxog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wMlQxMDowMTowOVrOIeIxog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2ODQ3MTk3MA==", "bodyText": "Could we please use Object.equals to prevent possible NPE? Or is NPE demanded as templateKeyValue should be never null?", "url": "https://github.com/kiegroup/drools/pull/3286#discussion_r568471970", "createdAt": "2021-02-02T10:01:09Z", "author": {"login": "jomarko"}, "path": "drools-workbench-models/drools-workbench-models-guided-dtable/src/main/java/org/drools/workbench/models/guided/dtable/backend/util/GuidedDTBRDRLPersistence.java", "diffHunk": "@@ -317,28 +319,70 @@ protected void generateModifyMethodSeparator(final RHSGeneratorContext gctx,\n             }\n         }\n \n+        @Override\n+        public void visitActionCallMethod(final ActionCallMethod action) {\n+\n+            final ActionCallMethod clone = new ActionCallMethod();\n+            clone.setState(action.getState());\n+            clone.setVariable(action.getVariable());\n+            clone.setMethodName(action.getMethodName());\n+\n+            final ActionFieldValue[] actionFieldValuesClones = new ActionFieldValue[action.getFieldValues().length];\n+            clone.setFieldValues(actionFieldValuesClones);\n+            for (int i = 0; i < action.getFieldValues().length; i++) {\n+                final ActionFieldValue fieldValue = action.getFieldValue(i);\n+\n+                if (fieldValue instanceof ActionFieldFunction) {\n+                    final ActionFieldFunction afvClone = new ActionFieldFunction();\n+                    afvClone.setMethod(((ActionFieldFunction) fieldValue).getMethod());\n+                    afvClone.setField(fieldValue.getField());\n+                    afvClone.setNature(BaseSingleFieldConstraint.TYPE_LITERAL);\n+                    afvClone.setType(fieldValue.getType());\n+                    String value = fieldValue.getValue();\n+                    String templateKeyValue = rowDataProvider.getTemplateKeyValue(value);\n+                    if (\"\".equals(templateKeyValue)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb88996145528a2d28fcf5ac94fe3937acdcee68"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2221, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}