{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5NjU5MzA5", "number": 3288, "title": "[DROOLS-5860] Fixing PMML", "bodyText": "@danielezonca @mariofusco @jiripetrlik\nsee https://issues.redhat.com/browse/DROOLS-5860\nThis PR\n\ndefine/implement a couple of interfaces (HasClassLoader, HasKnowledgeBuilder) to better type parameter and propagate classloader over the code\ncreates a new module (kie-pmml-kie-dependencies) to keep unbounding between drools and not drools models\nadd \"HasClassLoader\" to  PMMLCompiler methods (and all implemented/involved methods on cascade)\nchange type of kie-pmml-dependencies from \"pom\" to \"jar\"\n\nLinked PRs:\n\nkiegroup/droolsjbpm-build-bootstrap#1560\n#3288", "createdAt": "2020-12-14T16:50:43Z", "url": "https://github.com/kiegroup/drools/pull/3288", "merged": true, "mergeCommit": {"oid": "2d111b6d366f093c2a3c5851e5c1330cdce8743e"}, "closed": true, "closedAt": "2020-12-16T11:42:19Z", "author": {"login": "gitgabrio"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmDNNXAH2gAyNTM5NjU5MzA5OjI0YTZjZjUwOGU5NjdmZjkxNzcyNzkwMjRkMzVkOGJhMzIxZjQ1ODM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmsaDLAFqTU1MzU1MTcwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "24a6cf508e967ff9177279024d35d8ba321f4583", "author": {"user": {"login": "gitgabrio", "name": "Gabriele Cardosi"}}, "url": "https://github.com/kiegroup/drools/commit/24a6cf508e967ff9177279024d35d8ba321f4583", "committedDate": "2020-12-14T10:30:30Z", "message": "[DROOLS-5860] Implementing interfaces to propagate classloader"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b973b0bdde633f4e8bb53f9f5856961fe4ecdbb4", "author": {"user": {"login": "gitgabrio", "name": "Gabriele Cardosi"}}, "url": "https://github.com/kiegroup/drools/commit/b973b0bdde633f4e8bb53f9f5856961fe4ecdbb4", "committedDate": "2020-12-14T10:32:08Z", "message": "Merge remote-tracking branch 'origin/master' into DROOLS-5860"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d00ba0b5b789e3dec6765fe661e61be5997b39f9", "author": {"user": {"login": "gitgabrio", "name": "Gabriele Cardosi"}}, "url": "https://github.com/kiegroup/drools/commit/d00ba0b5b789e3dec6765fe661e61be5997b39f9", "committedDate": "2020-12-14T13:48:59Z", "message": "[DROOLS-5860] Update kie-pmml-dependencies definition"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e4b51a18bb0c90ce1f07427130b00f92c3ba98bc", "author": {"user": {"login": "gitgabrio", "name": "Gabriele Cardosi"}}, "url": "https://github.com/kiegroup/drools/commit/e4b51a18bb0c90ce1f07427130b00f92c3ba98bc", "committedDate": "2020-12-14T16:35:03Z", "message": "[DROOLS-5860] Fixing AbstractPMMLInvocationEvaluator to use PMMLImplementationsUtil.toEnable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxNzU2NTM2", "url": "https://github.com/kiegroup/drools/pull/3288#pullrequestreview-551756536", "createdAt": "2020-12-14T18:12:23Z", "commit": {"oid": "e4b51a18bb0c90ce1f07427130b00f92c3ba98bc"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxODoxMjoyM1rOIFdoKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxODoyNzo1NlrOIFehGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU5OTIwOQ==", "bodyText": "Unused import?", "url": "https://github.com/kiegroup/drools/pull/3288#discussion_r542599209", "createdAt": "2020-12-14T18:12:23Z", "author": {"login": "danielezonca"}, "path": "kie-pmml-trusty/kie-pmml-models/kie-pmml-models-regression/kie-pmml-models-regression-compiler/src/test/java/org/kie/pmml/models/regression/compiler/executor/RegressionModelImplementationProviderTest.java", "diffHunk": "@@ -26,6 +26,7 @@\n import org.kie.memorycompiler.KieMemoryCompiler;\n import org.kie.pmml.api.exceptions.KiePMMLException;\n import org.kie.pmml.api.enums.PMML_MODEL;\n+import org.kie.pmml.commons.model.HasClassLoader;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4b51a18bb0c90ce1f07427130b00f92c3ba98bc"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjYwMTQ5Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            public interface HasClassLoader {\n          \n          \n            \n            @FunctionalInterface\n          \n          \n            \n            public interface HasClassLoader {", "url": "https://github.com/kiegroup/drools/pull/3288#discussion_r542601493", "createdAt": "2020-12-14T18:15:43Z", "author": {"login": "danielezonca"}, "path": "kie-pmml-trusty/kie-pmml-commons/src/main/java/org/kie/pmml/commons/model/HasClassLoader.java", "diffHunk": "@@ -0,0 +1,25 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.kie.pmml.commons.model;\n+\n+/**\n+ * Interface used to define if a given <code>Object</code> may provide a <b>context</b> <code>ClassLoader</code>\n+ */\n+public interface HasClassLoader {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4b51a18bb0c90ce1f07427130b00f92c3ba98bc"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjYwNzE4OQ==", "bodyText": "If you use KnowledgeBuilder instead of KnowledgeBuilderImpl you can remove the dependency to drools.compiler and move this HasKnowledgeBuilderImpl to kie-pmml-kie-dependencies directly (and get rid of all the *Mock impl you created). Wdty?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private final KnowledgeBuilderImpl knowledgeBuilder;\n          \n          \n            \n                private final KnowledgeBuilder knowledgeBuilder;", "url": "https://github.com/kiegroup/drools/pull/3288#discussion_r542607189", "createdAt": "2020-12-14T18:22:10Z", "author": {"login": "danielezonca"}, "path": "kie-pmml-trusty/kie-pmml-evaluator/kie-pmml-evaluator-assembler/src/main/java/org/kie/pmml/evaluator/assembler/implementations/HasKnowledgeBuilderImpl.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.kie.pmml.evaluator.assembler.implementations;\n+\n+import org.drools.compiler.builder.impl.KnowledgeBuilderImpl;\n+import org.kie.internal.builder.KnowledgeBuilder;\n+import org.kie.pmml.kie.dependencies.HasKnowledgeBuilder;\n+\n+public class HasKnowledgeBuilderImpl implements HasKnowledgeBuilder {\n+\n+    private final KnowledgeBuilderImpl knowledgeBuilder;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4b51a18bb0c90ce1f07427130b00f92c3ba98bc"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjYxMjkwMA==", "bodyText": "What about rename it\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              <artifactId>kie-pmml-kie-dependencies</artifactId>\n          \n          \n            \n              <artifactId>kie-pmml-kie-internal</artifactId>\n          \n      \n    \n    \n  \n\nI think kie-dependencies is misleading because for example kie-pmml-evaluator-api already depends on kie-api (same for kie-pmml-api) so this is not the only module with kie relations", "url": "https://github.com/kiegroup/drools/pull/3288#discussion_r542612900", "createdAt": "2020-12-14T18:27:13Z", "author": {"login": "danielezonca"}, "path": "kie-pmml-trusty/kie-pmml-kie-dependencies/pom.xml", "diffHunk": "@@ -0,0 +1,31 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+  <parent>\n+    <artifactId>kie-pmml-trusty</artifactId>\n+    <groupId>org.kie</groupId>\n+    <version>7.48.0-SNAPSHOT</version>\n+  </parent>\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <artifactId>kie-pmml-kie-dependencies</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4b51a18bb0c90ce1f07427130b00f92c3ba98bc"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjYxMzc4Ng==", "bodyText": "In kie-pmml-evaluator-api kie-api is under DROOLS block https://github.com/kiegroup/drools/blob/master/kie-pmml-trusty/kie-pmml-evaluator/kie-pmml-evaluator-api/pom.xml#L27\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <!-- EXTERNAL -->\n          \n          \n            \n                <!-- DROOLS -->", "url": "https://github.com/kiegroup/drools/pull/3288#discussion_r542613786", "createdAt": "2020-12-14T18:27:56Z", "author": {"login": "danielezonca"}, "path": "kie-pmml-trusty/kie-pmml-kie-dependencies/pom.xml", "diffHunk": "@@ -0,0 +1,31 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+  <parent>\n+    <artifactId>kie-pmml-trusty</artifactId>\n+    <groupId>org.kie</groupId>\n+    <version>7.48.0-SNAPSHOT</version>\n+  </parent>\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <artifactId>kie-pmml-kie-dependencies</artifactId>\n+\n+  <name>KIE :: PMML :: Kie :: Dependencies</name>\n+  <description>PMML Kie-dependant module</description>\n+\n+  <dependencies>\n+    <!-- PMML -->\n+    <dependency>\n+      <groupId>org.kie</groupId>\n+      <artifactId>kie-pmml-commons</artifactId>\n+    </dependency>\n+    <!-- EXTERNAL -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4b51a18bb0c90ce1f07427130b00f92c3ba98bc"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3af6f6b0720af1239e32653eb70bce241afc6447", "author": {"user": {"login": "gitgabrio", "name": "Gabriele Cardosi"}}, "url": "https://github.com/kiegroup/drools/commit/3af6f6b0720af1239e32653eb70bce241afc6447", "committedDate": "2020-12-15T13:39:34Z", "message": "[DROOLS-5860] Fixing as per PR request"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzNDYzNzUy", "url": "https://github.com/kiegroup/drools/pull/3288#pullrequestreview-553463752", "createdAt": "2020-12-16T08:42:59Z", "commit": {"oid": "3af6f6b0720af1239e32653eb70bce241afc6447"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzNTUxNzAy", "url": "https://github.com/kiegroup/drools/pull/3288#pullrequestreview-553551702", "createdAt": "2020-12-16T10:30:39Z", "commit": {"oid": "3af6f6b0720af1239e32653eb70bce241afc6447"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1695, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}