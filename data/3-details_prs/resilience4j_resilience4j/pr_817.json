{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2Njg3MjQw", "number": 817, "title": "Issue #803: Support for metrics-only state", "bodyText": "Adds the ability to record metrics and publish events while operating in a mode similar to DISABLED state, where all requests are allowed to pass through.\nRelated PR: #813", "createdAt": "2020-01-24T05:37:40Z", "url": "https://github.com/resilience4j/resilience4j/pull/817", "merged": true, "mergeCommit": {"oid": "be4e8edb2266ef4da123bbf7fba42f862385b10f"}, "closed": true, "closedAt": "2020-01-27T07:39:11Z", "author": {"login": "laksnv"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9YMRTAH2gAyMzY2Njg3MjQwOjgxMWFiYWM5MDcxNzU2MjFlOTU1ODUzMmU2ZTExMzc4OWRlOTc1MzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-XwfggFqTM0ODQ3NjgxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "811abac907175621e9558532e6e113789de97530", "author": {"user": null}, "url": "https://github.com/resilience4j/resilience4j/commit/811abac907175621e9558532e6e113789de97530", "committedDate": "2020-01-24T05:35:26Z", "message": "Issue #803: Support for metrics-only mode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3Nzc4MDEx", "url": "https://github.com/resilience4j/resilience4j/pull/817#pullrequestreview-347778011", "createdAt": "2020-01-24T07:07:14Z", "commit": {"oid": "811abac907175621e9558532e6e113789de97530"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwNzowNzoxNFrOFhVUog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQwNzowNzoxNFrOFhVUog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDQ5NjY3NA==", "bodyText": "Must be metrics.getSlowCallRate()", "url": "https://github.com/resilience4j/resilience4j/pull/817#discussion_r370496674", "createdAt": "2020-01-24T07:07:14Z", "author": {"login": "RobWin"}, "path": "resilience4j-circuitbreaker/src/main/java/io/github/resilience4j/circuitbreaker/internal/CircuitBreakerStateMachine.java", "diffHunk": "@@ -387,6 +390,27 @@ private void publishCircuitIgnoredErrorEvent(String name, long duration, TimeUni\n         publishEventIfPossible(event);\n     }\n \n+    private void publishCircuitFailureRateExceededEvent(String name, float failureRate) {\n+        final CircuitBreakerOnFailureRateExceededEvent event = new CircuitBreakerOnFailureRateExceededEvent(name,\n+            failureRate);\n+        publishEventIfPossible(event);\n+    }\n+\n+    private void publishCircuitSlowCallRateExceededEvent(String name, float slowCallRate) {\n+        final CircuitBreakerOnSlowCallRateExceededEvent event = new CircuitBreakerOnSlowCallRateExceededEvent(name,\n+            slowCallRate);\n+        publishEventIfPossible(event);\n+    }\n+\n+    private void publishCircuitThresholdsExceededEvent(Result result, CircuitBreakerMetrics metrics) {\n+        if (Result.hasFailureRateExceededThreshold(result)) {\n+            publishCircuitFailureRateExceededEvent(getName(), metrics.getFailureRate());\n+        }\n+        if (Result.hasSlowCallRateExceededThreshold(result)) {\n+            publishCircuitSlowCallRateExceededEvent(getName(), metrics.getFailureRate());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "811abac907175621e9558532e6e113789de97530"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "280e6377c3f74c8c79a1dd684d5049dc933bfba8", "author": {"user": null}, "url": "https://github.com/resilience4j/resilience4j/commit/280e6377c3f74c8c79a1dd684d5049dc933bfba8", "committedDate": "2020-01-24T12:41:47Z", "message": "Issue #803: Fix typo"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NDc2ODE2", "url": "https://github.com/resilience4j/resilience4j/pull/817#pullrequestreview-348476816", "createdAt": "2020-01-27T07:39:01Z", "commit": {"oid": "280e6377c3f74c8c79a1dd684d5049dc933bfba8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1824, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}