{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5MDA3ODE1", "number": 286, "title": "HH-121275 move test loggins into logback configurator + small build log cleanup", "bodyText": "https://jira.hh.ru/browse/HH-121275", "createdAt": "2020-12-13T19:37:51Z", "url": "https://github.com/hhru/nuts-and-bolts/pull/286", "merged": true, "mergeCommit": {"oid": "5248a2f872e4a222858c4545b8f1083cec09274e"}, "closed": true, "closedAt": "2020-12-16T15:46:09Z", "author": {"login": "SCREEN88"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdl2vcuAFqTU1MDk1MjUyNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmrE84gFqTU1MzQ3NTEyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwOTUyNTI0", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#pullrequestreview-550952524", "createdAt": "2020-12-13T19:39:41Z", "commit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "state": "COMMENTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QxOTozOTo0MVrOIE4efA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xM1QxOTo1ODo1MlrOIE4q-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MDUyNA==", "bodyText": "\u043b\u043e\u0433\u0438 \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u043e\u043d\u0430 \u0442\u0435\u0441\u0442\u043e\u0432 \u043f\u0438\u0448\u0443\u0442\u0441\u044f \u0432 \u044d\u0442\u0443 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e, \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u043d\u0438\u0436\u0435", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541990524", "createdAt": "2020-12-13T19:39:41Z", "author": {"login": "SCREEN88"}, "path": ".gitignore", "diffHunk": "@@ -12,3 +12,4 @@ nb-configuration.xml\n dependency-reduced-pom.xml\n *.properties.dev\n *.log\n+logs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MTMzNQ==", "bodyText": "\u044d\u0442\u0438 \u043e\u043f\u0446\u0438\u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u043d\u0435 \u0432\u044b\u0432\u043e\u0434\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0438\u0448\u0443\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u043e\u043d\u0430, \u043f\u0438\u0448\u0443\u0442\u0441\u044f \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u0443\u044e \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u0444\u0430\u0439\u043b \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u0438\u0437 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0431\u044b\u043b\u0438 \u043b\u043e\u0433\u0438, \u043d\u0435\u0442 \u043b\u043e\u0433\u043e\u0432 \u043d\u0435\u0442 \u0444\u0430\u0439\u043b\u0430. \u0412 xml \u0432 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u043c \u043f\u0438\u0441\u0430\u043b\u0438\u0441\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0435\u0441\u0442\u0430, \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435, \u0432\u043e\u043e\u0431\u0449\u0435\u043c \u043d\u0435 \u0443\u0432\u0438\u0434\u0435\u043b \u043d\u0438\u0447\u0435\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u043e\u0433\u043e, \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u043b.\n!!!!\u0421\u0442\u0435\u043a\u0442\u0440\u0435\u0439\u0441 \u0438 \u043f\u0440\u0438\u0447\u0438\u043d\u0430 \u043f\u0430\u0434\u0435\u043d\u0438\u044f \u0442\u0435\u0441\u0442\u0430 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u044e\u0442 \u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c \u0441 \u044d\u0442\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438!!!!", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541991335", "createdAt": "2020-12-13T19:44:32Z", "author": {"login": "SCREEN88"}, "path": "nab-example/pom.xml", "diffHunk": "@@ -92,6 +92,9 @@\n                 <groupId>org.apache.maven.plugins</groupId>\n                 <artifactId>maven-surefire-plugin</artifactId>\n                 <configuration>\n+                    <reportsDirectory>logs</reportsDirectory>\n+                    <redirectTestOutputToFile>true</redirectTestOutputToFile>\n+                    <disableXmlReport>true</disableXmlReport>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MTU5Mg==", "bodyText": "\u043c\u043d\u0435 \u043d\u0443\u0436\u043d\u043e \u0431\u044b\u043b\u043e \u0447\u0442\u043e\u0431\u044b \u0430\u043f\u043f\u0435\u043d\u0434\u0435\u0440 \u043c\u043e\u0433 \u043f\u0438\u0441\u0430\u0442\u044c \u0432 \u0444\u0430\u0439\u043b \u0434\u0430\u0436\u0435 \u0441 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u043c \u043f\u0440\u043e\u043f\u0435\u0440\u0442\u0438 LOG_TO_CONSOLE_PROPERTY_KEY, \u043d\u0438\u0447\u0435\u0433\u043e \u043b\u0443\u0447\u0448\u0435 \u043d\u0435 \u043f\u0440\u0438\u0434\u0443\u043c\u0430\u043b, \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u0440\u0438\u0448\u043b\u043e\u0441\u044c \u0432\u043e \u0432\u0441\u0435\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u0430\u0445 \u043f\u0440\u0430\u0432\u0438\u0442\u044c (", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541991592", "createdAt": "2020-12-13T19:46:08Z", "author": {"login": "SCREEN88"}, "path": "nab-logging/src/main/java/ru/hh/nab/logging/HhMultiAppender.java", "diffHunk": "@@ -11,31 +11,36 @@\n import ch.qos.logback.core.encoder.LayoutWrappingEncoder;\n import ch.qos.logback.core.spi.ContextAware;\n import ch.qos.logback.core.spi.LifeCycle;\n+import static java.util.Optional.ofNullable;\n import java.util.function.Supplier;\n-\n import org.apache.commons.lang3.StringUtils;\n import ru.hh.nab.logging.json.NabJsonEncoder;\n import ru.hh.nab.logging.json.NabJsonLayout;\n-import static java.util.Optional.ofNullable;\n \n public class HhMultiAppender extends UnsynchronizedAppenderBase<ILoggingEvent> {\n-\n-  public HhMultiAppender() {\n-  }\n-\n-  public HhMultiAppender(boolean json) {\n-    this.json = json;\n-  }\n-\n   public static final String LOG_TO_CONSOLE_PROPERTY_KEY = \"log.toConsole\";\n   public static final String LOG_PATTERN_PROPERTY_KEY = \"log.pattern\";\n+  private final boolean logToConsole;\n \n   protected Appender<ILoggingEvent> appender;\n   protected Supplier<Layout<ILoggingEvent>> layoutSupplier;\n   protected Supplier<Encoder<ILoggingEvent>> encoderSupplier;\n   protected String pattern;\n   protected boolean json;\n \n+  public HhMultiAppender() {\n+    this.logToConsole = true;\n+  }\n+\n+  public HhMultiAppender(boolean json, boolean logToConsole) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MTg2MA==", "bodyText": "\u0447\u0442\u043e\u0431\u044b \u043c\u043e\u0436\u043d\u043e \u0431\u044b\u043b\u043e \u043e\u0442\u043a\u043b\u044e\u0447\u0430\u0442\u044c StatusListener \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u043e\u0432, Properties \u043f\u0435\u0440\u0435\u0434\u0430\u044e \u0447\u0442\u043e\u0431\u044b \u043c\u043e\u0436\u043d\u043e \u0431\u044b\u043b\u043e \u044d\u0442\u043e \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541991860", "createdAt": "2020-12-13T19:47:33Z", "author": {"login": "SCREEN88"}, "path": "nab-logging/src/main/java/ru/hh/nab/logging/NabLoggingConfiguratorTemplate.java", "diffHunk": "@@ -44,6 +41,12 @@ public final void configure(LoggerContext context) {\n     appenders = null;\n   }\n \n+  protected void statusListener(LoggerContext context, Properties properties) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MTk4OA==", "bodyText": "\u0434\u043e\u0431\u0430\u0432\u0438\u043b ch.qos.logback.classic.Level \u043f\u043e\u0442\u043e\u043c\u0443-\u0447\u0442\u043e \u0432 spy \u043d\u0435\u0442 Level.OFF", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541991988", "createdAt": "2020-12-13T19:48:34Z", "author": {"login": "SCREEN88"}, "path": "nab-logging/src/main/java/ru/hh/nab/logging/NabLoggingConfiguratorTemplate.java", "diffHunk": "@@ -106,8 +109,13 @@ public LoggerWrapper createLogger(LoggingContextWrapper context, Class<?> aClass\n \n   public LoggerWrapper createLogger(LoggingContextWrapper context, String name, Level level, boolean additivity,\n       Collection<Appender> appenders) {\n+    return createLogger(context, name, ch.qos.logback.classic.Level.toLevel(level.toString()), additivity, appenders);\n+  }\n+\n+  public LoggerWrapper createLogger(LoggingContextWrapper context, String name, ch.qos.logback.classic.Level level, boolean additivity,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MjIwMQ==", "bodyText": "\u0438\u043d\u043e\u0433\u0434\u0430 \u0443\u0434\u043e\u0431\u043d\u043e \u0432\u044b\u0442\u0430\u0449\u0438\u0442\u044c \u043b\u043e\u0433\u0433\u0435\u0440, \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u043f\u043f\u0435\u043d\u0434\u0435\u0440 \u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0432\u043e\u0439, \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0442\u044c \u043b\u0438\u0448\u043d\u0438\u0439 \u0440\u0430\u0437", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541992201", "createdAt": "2020-12-13T19:49:45Z", "author": {"login": "SCREEN88"}, "path": "nab-logging/src/main/java/ru/hh/nab/logging/NabLoggingConfiguratorTemplate.java", "diffHunk": "@@ -155,6 +167,14 @@ public void setAdditivity(boolean additivity) {\n     public void addAppenders(Appender... appenders) {\n       Stream.of(appenders).forEach(logger::addAppender);\n     }\n+\n+    public void addAppenders(Collection<Appender> appenders) {\n+      appenders.forEach(logger::addAppender);\n+    }\n+\n+    public void detachAppenders(Appender... appenders) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MjQwNg==", "bodyText": "\u0443\u0434\u0430\u043b\u0438\u043b \u0442\u0443\u0442 logback.xml, \u0434\u043e\u0431\u0430\u0432\u0438\u043b \u043f\u0440\u0438\u043c\u0438\u0442\u0438\u0432\u043d\u044b\u0439 Configurator, \u0438\u0437 testCaseBase \u043f\u043e\u0434\u0442\u044f\u043d\u0443\u0442\u044c \u043d\u0435\u043b\u044c\u0437\u044f", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541992406", "createdAt": "2020-12-13T19:51:02Z", "author": {"login": "SCREEN88"}, "path": "nab-starter/src/test/java/ru/hh/nab/starter/NabStarterTestLogbackBaseConfigurator.java", "diffHunk": "@@ -0,0 +1,25 @@\n+package ru.hh.nab.starter;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.Properties;\n+import static ru.hh.nab.common.properties.PropertiesUtils.SETINGS_DIR_PROPERTY;\n+import ru.hh.nab.logging.NabLoggingConfiguratorTemplate;\n+\n+public class NabStarterTestLogbackBaseConfigurator extends NabLoggingConfiguratorTemplate {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5Mjg2Mw==", "bodyText": "\u043a\u0430\u0436\u0435\u0442\u0441\u044f \u0447\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0438\u043d\u043e\u0433\u0434\u0430 \u043f\u043e\u043b\u0435\u0437\u043d\u043e \u043f\u0438\u0441\u0430\u0442\u044c \u0432\u0435\u0441\u044c \u043b\u043e\u0433 \u0432 \u043e\u0434\u0438\u043d \u0444\u0430\u0439\u043b", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541992863", "createdAt": "2020-12-13T19:53:27Z", "author": {"login": "SCREEN88"}, "path": "nab-testbase/src/main/java/ru/hh/nab/testbase/TestLogbackBaseConfigurator.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package ru.hh.nab.testbase;\n+\n+import ch.qos.logback.classic.Level;\n+import ch.qos.logback.classic.LoggerContext;\n+import ch.qos.logback.core.Appender;\n+import ch.qos.logback.core.status.NopStatusListener;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.UncheckedIOException;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.Set;\n+import static ru.hh.nab.common.properties.PropertiesUtils.SETINGS_DIR_PROPERTY;\n+import ru.hh.nab.logging.HhMultiAppender;\n+import ru.hh.nab.logging.NabLoggingConfiguratorTemplate;\n+import static ru.hh.nab.testbase.NabTestConfig.TEST_PROPERTIES_FILE_NAME;\n+\n+@SuppressWarnings(\"rawtypes\")\n+public class TestLogbackBaseConfigurator extends NabLoggingConfiguratorTemplate {\n+\n+  @Override\n+  protected Properties createLoggingProperties() {\n+    System.setProperty(SETINGS_DIR_PROPERTY, \".\");\n+    Properties properties = createProperties();\n+    setPropertyIfNotSet(properties, \"log.pattern\", \"[%date{ISO8601}] %-5level %logger{36}:%line mdc={%mdc} - %msg%n\");\n+    setPropertyIfNotSet(properties, \"log.dir\", \"logs\");\n+    setPropertyIfNotSet(properties, \"log.immediate.flush\", Boolean.TRUE.toString());\n+    return properties;\n+  }\n+\n+  @Override\n+  protected void statusListener(LoggerContext context, Properties properties) {\n+    if (Boolean.parseBoolean(properties.getProperty(\"log.show.status\", \"false\"))) {\n+      super.statusListener(context, properties);\n+    } else {\n+      context.getStatusManager().add(new NopStatusListener());\n+    }\n+  }\n+\n+  @Override\n+  public final void configure(LoggingContextWrapper context) {\n+    var rootLogger = getRootLogger(context);\n+    Level rootLevel = context.getProperty(\"log.root.level\", Level.ERROR, level -> Level.valueOf(level.toUpperCase()));\n+    rootLogger.setLevel(rootLevel);\n+    Set<Appender> appenders = new HashSet<>();\n+    if (Boolean.parseBoolean(context.getProperty(\"log.toConsole\", \"true\"))) {\n+      appenders.add(createAppender(context, \"console\", () -> new HhMultiAppender(false)));\n+    }\n+    if (Boolean.parseBoolean(context.getProperty(\"log.write.into.file\", \"false\"))\n+        || Boolean.parseBoolean(context.getProperty(\"log.toFile\", \"false\"))) {\n+      String logFileName = context.getProperty(\"log.filename\", \"tests\");\n+      appenders.add(createAppender(context, logFileName, () -> new HhMultiAppender(false, false)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MzAwNA==", "bodyText": "\u0432\u0437\u044f\u043b \u043a\u0430\u043a\u0438\u0435-\u0442\u043e \u0431\u0430\u0437\u043e\u0432\u044b\u0435 \u0432\u0435\u0449\u0438, \u043e\u0431\u0441\u0443\u0436\u0434\u0430\u0435\u043c\u043e", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541993004", "createdAt": "2020-12-13T19:54:30Z", "author": {"login": "SCREEN88"}, "path": "nab-testbase/src/main/java/ru/hh/nab/testbase/TestLogbackBaseConfigurator.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package ru.hh.nab.testbase;\n+\n+import ch.qos.logback.classic.Level;\n+import ch.qos.logback.classic.LoggerContext;\n+import ch.qos.logback.core.Appender;\n+import ch.qos.logback.core.status.NopStatusListener;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.UncheckedIOException;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.Set;\n+import static ru.hh.nab.common.properties.PropertiesUtils.SETINGS_DIR_PROPERTY;\n+import ru.hh.nab.logging.HhMultiAppender;\n+import ru.hh.nab.logging.NabLoggingConfiguratorTemplate;\n+import static ru.hh.nab.testbase.NabTestConfig.TEST_PROPERTIES_FILE_NAME;\n+\n+@SuppressWarnings(\"rawtypes\")\n+public class TestLogbackBaseConfigurator extends NabLoggingConfiguratorTemplate {\n+\n+  @Override\n+  protected Properties createLoggingProperties() {\n+    System.setProperty(SETINGS_DIR_PROPERTY, \".\");\n+    Properties properties = createProperties();\n+    setPropertyIfNotSet(properties, \"log.pattern\", \"[%date{ISO8601}] %-5level %logger{36}:%line mdc={%mdc} - %msg%n\");\n+    setPropertyIfNotSet(properties, \"log.dir\", \"logs\");\n+    setPropertyIfNotSet(properties, \"log.immediate.flush\", Boolean.TRUE.toString());\n+    return properties;\n+  }\n+\n+  @Override\n+  protected void statusListener(LoggerContext context, Properties properties) {\n+    if (Boolean.parseBoolean(properties.getProperty(\"log.show.status\", \"false\"))) {\n+      super.statusListener(context, properties);\n+    } else {\n+      context.getStatusManager().add(new NopStatusListener());\n+    }\n+  }\n+\n+  @Override\n+  public final void configure(LoggingContextWrapper context) {\n+    var rootLogger = getRootLogger(context);\n+    Level rootLevel = context.getProperty(\"log.root.level\", Level.ERROR, level -> Level.valueOf(level.toUpperCase()));\n+    rootLogger.setLevel(rootLevel);\n+    Set<Appender> appenders = new HashSet<>();\n+    if (Boolean.parseBoolean(context.getProperty(\"log.toConsole\", \"true\"))) {\n+      appenders.add(createAppender(context, \"console\", () -> new HhMultiAppender(false)));\n+    }\n+    if (Boolean.parseBoolean(context.getProperty(\"log.write.into.file\", \"false\"))\n+        || Boolean.parseBoolean(context.getProperty(\"log.toFile\", \"false\"))) {\n+      String logFileName = context.getProperty(\"log.filename\", \"tests\");\n+      appenders.add(createAppender(context, logFileName, () -> new HhMultiAppender(false, false)));\n+    }\n+    loggers().forEach((name, level) -> createLogger(context, name, rootLevel, false, appenders));\n+    rootLogger.addAppenders(appenders);\n+  }\n+\n+  protected Map<String, Level> loggers() {\n+    return new HashMap<>() {{\n+      put(\"org.hibernate.tool.hbm2ddl\", Level.INFO);\n+      put(\"org.hibernate.orm.deprecation\", Level.OFF);\n+      put(\"com.opentable.db.postgres.embedded\", Level.INFO);\n+      put(\"org.testcontainers\", Level.INFO);\n+      put(\"org.testcontainers.utility.ResourceReaper\", Level.OFF);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MzI2Ng==", "bodyText": "\u043f\u0440\u0438 \u043f\u043e\u043f\u044b\u0442\u043a\u0435 \u0441\u043e\u0431\u0440\u0430\u0442\u044c jar \u0438\u0437 nab-test \u043f\u0438\u0441\u0430\u043b\u0441\u044f \u0432\u0430\u0440\u043d\u0438\u043d\u0433 \u0447\u0442\u043e \u0444\u0430\u0439\u043b\u043e\u0432 \u0442\u043e \u043d\u0435\u0442, \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0438\u0441\u043a\u043b\u044e\u0447\u0430\u044e \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541993266", "createdAt": "2020-12-13T19:55:57Z", "author": {"login": "SCREEN88"}, "path": "nab-tests/pom.xml", "diffHunk": "@@ -114,6 +114,19 @@\n \n     <build>\n         <plugins>\n+            <plugin>\n+                <artifactId>maven-jar-plugin</artifactId>\n+                <executions>\n+                    <execution>\n+                        <id>default-jar</id>\n+                        <phase>none</phase>\n+                        <configuration>\n+                            <finalName>unwanted</finalName>\n+                            <classifier>unwanted</classifier>\n+                        </configuration>\n+                    </execution>\n+                </executions>\n+            </plugin>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MzcyMw==", "bodyText": "\u0434\u043e\u0431\u0430\u0432\u0438\u043b \u0441\u044e\u0434\u0430 \u043f\u043e\u043a\u0430, \u043a\u0430\u043a \u043c\u043e\u0436\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u043d\u044f\u0442\u044c public-pom \u043c\u043e\u0436\u043d\u043e \u0443\u0431\u0440\u0430\u0442\u044c", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r541993723", "createdAt": "2020-12-13T19:58:52Z", "author": {"login": "SCREEN88"}, "path": "pom.xml", "diffHunk": "@@ -145,11 +145,20 @@\n                 <artifactId>jackson-module-jaxb-annotations</artifactId>\n                 <version>${jackson.version}</version>\n             </dependency>\n-\n         </dependencies>\n     </dependencyManagement>\n \n     <build>\n+        <pluginManagement>\n+            <plugins>\n+                <plugin>\n+                    <groupId>ru.hh.checkstyle</groupId>\n+                    <artifactId>hh-maven-checkstyle-plugin</artifactId>\n+                    <version>1.14-SNAPSHOT</version>\n+                </plugin>\n+            </plugins>\n+        </pluginManagement>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e", "author": {"user": {"login": "SCREEN88", "name": "Yuriy Marinov"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e", "committedDate": "2020-12-13T19:35:51Z", "message": "HH-121275 move test loggins into logback configurator + small build log cleanup"}, "afterCommit": {"oid": "ce6789f6f064cff42e21bc2509ad874a831c2aaa", "author": {"user": {"login": "SCREEN88", "name": "Yuriy Marinov"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/ce6789f6f064cff42e21bc2509ad874a831c2aaa", "committedDate": "2020-12-13T22:57:27Z", "message": "HH-121275 move test loggins into logback configurator + small build log cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "232b9e151a2226acbfb1b2b4afed4618d3099b88", "author": {"user": {"login": "SCREEN88", "name": "Yuriy Marinov"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/232b9e151a2226acbfb1b2b4afed4618d3099b88", "committedDate": "2020-12-13T22:58:43Z", "message": "HH-121275 move test loggins into logback configurator + small build log cleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce6789f6f064cff42e21bc2509ad874a831c2aaa", "author": {"user": {"login": "SCREEN88", "name": "Yuriy Marinov"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/ce6789f6f064cff42e21bc2509ad874a831c2aaa", "committedDate": "2020-12-13T22:57:27Z", "message": "HH-121275 move test loggins into logback configurator + small build log cleanup"}, "afterCommit": {"oid": "232b9e151a2226acbfb1b2b4afed4618d3099b88", "author": {"user": {"login": "SCREEN88", "name": "Yuriy Marinov"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/232b9e151a2226acbfb1b2b4afed4618d3099b88", "committedDate": "2020-12-13T22:58:43Z", "message": "HH-121275 move test loggins into logback configurator + small build log cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMjg5NDc2", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#pullrequestreview-552289476", "createdAt": "2020-12-15T10:05:21Z", "commit": {"oid": "232b9e151a2226acbfb1b2b4afed4618d3099b88"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMzAzMDEx", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#pullrequestreview-552303011", "createdAt": "2020-12-15T10:20:53Z", "commit": {"oid": "232b9e151a2226acbfb1b2b4afed4618d3099b88"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMzM4NDgx", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#pullrequestreview-552338481", "createdAt": "2020-12-15T11:04:49Z", "commit": {"oid": "232b9e151a2226acbfb1b2b4afed4618d3099b88"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMzUwMTg1", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#pullrequestreview-552350185", "createdAt": "2020-12-15T11:20:50Z", "commit": {"oid": "232b9e151a2226acbfb1b2b4afed4618d3099b88"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMToyMDo1MFrOIGF8VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMToyMDo1MFrOIGF8VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzI1OTczMw==", "bodyText": "\u0434\u0430\u0432\u0430\u0439 \u043b\u0443\u0447\u0448\u0435 \u043f\u043e\u0434\u043d\u0438\u043c\u0435\u043c \u0432 \u043a\u043e\u043c\u043e\u043d \u043f\u043e\u043c\u0435, \u0430 \u0442\u0443\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0448\u0435\u043c \u0432\u0435\u0440\u0441\u0438\u044e \u0436\u0430\u0431\u044b", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r543259733", "createdAt": "2020-12-15T11:20:50Z", "author": {"login": "heruv1m"}, "path": "pom.xml", "diffHunk": "@@ -145,11 +145,20 @@\n                 <artifactId>jackson-module-jaxb-annotations</artifactId>\n                 <version>${jackson.version}</version>\n             </dependency>\n-\n         </dependencies>\n     </dependencyManagement>\n \n     <build>\n+        <pluginManagement>\n+            <plugins>\n+                <plugin>\n+                    <groupId>ru.hh.checkstyle</groupId>\n+                    <artifactId>hh-maven-checkstyle-plugin</artifactId>\n+                    <version>1.14-SNAPSHOT</version>\n+                </plugin>\n+            </plugins>\n+        </pluginManagement>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MzcyMw=="}, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMzk2MTI3", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#pullrequestreview-552396127", "createdAt": "2020-12-15T12:23:46Z", "commit": {"oid": "232b9e151a2226acbfb1b2b4afed4618d3099b88"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMjoyMzo0N1rOIGIRew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMjozMTo0NVrOIGIkHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzI5NzkxNQ==", "bodyText": "\u0430 \u043f\u043e\u0447\u0435\u043c\u0443 \u043d\u0435 \u0432 /target/logs", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r543297915", "createdAt": "2020-12-15T12:23:47Z", "author": {"login": "dzharikhin"}, "path": "nab-example/pom.xml", "diffHunk": "@@ -92,6 +92,9 @@\n                 <groupId>org.apache.maven.plugins</groupId>\n                 <artifactId>maven-surefire-plugin</artifactId>\n                 <configuration>\n+                    <reportsDirectory>logs</reportsDirectory>\n+                    <redirectTestOutputToFile>true</redirectTestOutputToFile>\n+                    <disableXmlReport>true</disableXmlReport>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MTMzNQ=="}, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzI5Nzk2NA==", "bodyText": "\u0440\u0430\u0441\u0441\u043a\u0430\u0436\u0438 \u0447\u0443\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435. \u0438\u0437 \u043a\u043e\u0434\u0430 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043d\u0435 \u043c\u043e\u0433\u0443", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r543297964", "createdAt": "2020-12-15T12:23:52Z", "author": {"login": "dzharikhin"}, "path": "nab-logging/src/main/java/ru/hh/nab/logging/HhMultiAppender.java", "diffHunk": "@@ -11,31 +11,36 @@\n import ch.qos.logback.core.encoder.LayoutWrappingEncoder;\n import ch.qos.logback.core.spi.ContextAware;\n import ch.qos.logback.core.spi.LifeCycle;\n+import static java.util.Optional.ofNullable;\n import java.util.function.Supplier;\n-\n import org.apache.commons.lang3.StringUtils;\n import ru.hh.nab.logging.json.NabJsonEncoder;\n import ru.hh.nab.logging.json.NabJsonLayout;\n-import static java.util.Optional.ofNullable;\n \n public class HhMultiAppender extends UnsynchronizedAppenderBase<ILoggingEvent> {\n-\n-  public HhMultiAppender() {\n-  }\n-\n-  public HhMultiAppender(boolean json) {\n-    this.json = json;\n-  }\n-\n   public static final String LOG_TO_CONSOLE_PROPERTY_KEY = \"log.toConsole\";\n   public static final String LOG_PATTERN_PROPERTY_KEY = \"log.pattern\";\n+  private final boolean logToConsole;\n \n   protected Appender<ILoggingEvent> appender;\n   protected Supplier<Layout<ILoggingEvent>> layoutSupplier;\n   protected Supplier<Encoder<ILoggingEvent>> encoderSupplier;\n   protected String pattern;\n   protected boolean json;\n \n+  public HhMultiAppender() {\n+    this.logToConsole = true;\n+  }\n+\n+  public HhMultiAppender(boolean json, boolean logToConsole) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MTU5Mg=="}, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzMwMjE5Mg==", "bodyText": "\u0437\u0430\u0447\u0435\u043c \u0432\u0430\u0440\u0430\u0440\u0433? \u043d\u0443 \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u044e \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0439", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r543302192", "createdAt": "2020-12-15T12:30:58Z", "author": {"login": "dzharikhin"}, "path": "nab-logging/src/main/java/ru/hh/nab/logging/NabLoggingConfiguratorTemplate.java", "diffHunk": "@@ -155,6 +167,14 @@ public void setAdditivity(boolean additivity) {\n     public void addAppenders(Appender... appenders) {\n       Stream.of(appenders).forEach(logger::addAppender);\n     }\n+\n+    public void addAppenders(Collection<Appender> appenders) {\n+      appenders.forEach(logger::addAppender);\n+    }\n+\n+    public void detachAppenders(Appender... appenders) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MjIwMQ=="}, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzMwMjY4Ng==", "bodyText": "\u043c\u044b \u043d\u0435 \u0442\u043e\u0440\u0447\u0438\u043c \u0438\u043c \u043d\u0430\u0440\u0443\u0436\u0443 - \u044d\u0442\u043e \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f. \u043c\u043e\u0436\u0435\u043c \u0442\u043e\u0440\u0447\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e api", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r543302686", "createdAt": "2020-12-15T12:31:45Z", "author": {"login": "dzharikhin"}, "path": "nab-logging/src/main/java/ru/hh/nab/logging/NabLoggingConfiguratorTemplate.java", "diffHunk": "@@ -106,8 +109,13 @@ public LoggerWrapper createLogger(LoggingContextWrapper context, Class<?> aClass\n \n   public LoggerWrapper createLogger(LoggingContextWrapper context, String name, Level level, boolean additivity,\n       Collection<Appender> appenders) {\n+    return createLogger(context, name, ch.qos.logback.classic.Level.toLevel(level.toString()), additivity, appenders);\n+  }\n+\n+  public LoggerWrapper createLogger(LoggingContextWrapper context, String name, ch.qos.logback.classic.Level level, boolean additivity,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MTk4OA=="}, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNDA0NTI1", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#pullrequestreview-552404525", "createdAt": "2020-12-15T12:35:04Z", "commit": {"oid": "232b9e151a2226acbfb1b2b4afed4618d3099b88"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMjozNTowNVrOIGIr2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMjozNTowNVrOIGIr2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzMwNDY2NA==", "bodyText": "\u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u0430\u044f \u0435\u043b\u043e\u0447\u043d\u043e\u0441\u0442\u044c. \u043c\u043e\u0436\u0435\u0442 \u043a\u0430\u043a-\u0442\u043e \u0432\u0441\u0435 \u0432 \u043e\u0434\u0438\u043d try \u0441 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0438 new Properties() \u0435\u0441\u043b\u0438 \u0447\u0442\u043e-\u0442\u043e \u0438\u0434\u0435\u0442 \u043d\u0435 \u0442\u0430\u043a?", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r543304664", "createdAt": "2020-12-15T12:35:05Z", "author": {"login": "dzharikhin"}, "path": "nab-testbase/src/main/java/ru/hh/nab/testbase/TestLogbackBaseConfigurator.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package ru.hh.nab.testbase;\n+\n+import ch.qos.logback.classic.Level;\n+import ch.qos.logback.classic.LoggerContext;\n+import ch.qos.logback.core.Appender;\n+import ch.qos.logback.core.status.NopStatusListener;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.UncheckedIOException;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.Set;\n+import static ru.hh.nab.common.properties.PropertiesUtils.SETINGS_DIR_PROPERTY;\n+import ru.hh.nab.logging.HhMultiAppender;\n+import ru.hh.nab.logging.NabLoggingConfiguratorTemplate;\n+import static ru.hh.nab.testbase.NabTestConfig.TEST_PROPERTIES_FILE_NAME;\n+\n+@SuppressWarnings(\"rawtypes\")\n+public class TestLogbackBaseConfigurator extends NabLoggingConfiguratorTemplate {\n+\n+  @Override\n+  protected Properties createLoggingProperties() {\n+    System.setProperty(SETINGS_DIR_PROPERTY, \".\");\n+    Properties properties = createProperties();\n+    setPropertyIfNotSet(properties, \"log.pattern\", \"[%date{ISO8601}] %-5level %logger{36}:%line mdc={%mdc} - %msg%n\");\n+    setPropertyIfNotSet(properties, \"log.dir\", \"logs\");\n+    setPropertyIfNotSet(properties, \"log.immediate.flush\", Boolean.TRUE.toString());\n+    return properties;\n+  }\n+\n+  @Override\n+  protected void statusListener(LoggerContext context, Properties properties) {\n+    if (Boolean.parseBoolean(properties.getProperty(\"log.show.status\", \"false\"))) {\n+      super.statusListener(context, properties);\n+    } else {\n+      context.getStatusManager().add(new NopStatusListener());\n+    }\n+  }\n+\n+  @Override\n+  public final void configure(LoggingContextWrapper context) {\n+    var rootLogger = getRootLogger(context);\n+    Level rootLevel = context.getProperty(\"log.root.level\", Level.ERROR, level -> Level.valueOf(level.toUpperCase()));\n+    rootLogger.setLevel(rootLevel);\n+    Set<Appender> appenders = new HashSet<>();\n+    if (Boolean.parseBoolean(context.getProperty(\"log.toConsole\", \"true\"))) {\n+      appenders.add(createAppender(context, \"console\", () -> new HhMultiAppender(false)));\n+    }\n+    if (Boolean.parseBoolean(context.getProperty(\"log.write.into.file\", \"false\"))\n+        || Boolean.parseBoolean(context.getProperty(\"log.toFile\", \"false\"))) {\n+      String logFileName = context.getProperty(\"log.filename\", \"tests\");\n+      appenders.add(createAppender(context, logFileName, () -> new HhMultiAppender(false, false)));\n+    }\n+    loggers().forEach((name, level) -> createLogger(context, name, rootLevel, false, appenders));\n+    rootLogger.addAppenders(appenders);\n+  }\n+\n+  protected Map<String, Level> loggers() {\n+    return new HashMap<>() {{\n+      put(\"org.hibernate.tool.hbm2ddl\", Level.INFO);\n+      put(\"org.hibernate.orm.deprecation\", Level.OFF);\n+      put(\"com.opentable.db.postgres.embedded\", Level.INFO);\n+      put(\"org.testcontainers\", Level.INFO);\n+      put(\"org.testcontainers.utility.ResourceReaper\", Level.OFF);\n+    }};\n+  }\n+\n+  protected Properties createProperties() {\n+    InputStream inputStream = this.getClass().getResourceAsStream(TEST_PROPERTIES_FILE_NAME);\n+    if (inputStream == null) {\n+      return new Properties();\n+    }\n+    try {\n+      Properties properties = new Properties();\n+      properties.load(inputStream);\n+      return properties;\n+    } catch (IOException e) {\n+      throw new UncheckedIOException(e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "232b9e151a2226acbfb1b2b4afed4618d3099b88"}, "originalPosition": 80}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e6783826d5558eac8799fa3955ca553b8913cec", "author": {"user": {"login": "SCREEN88", "name": "Yuriy Marinov"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/9e6783826d5558eac8799fa3955ca553b8913cec", "committedDate": "2020-12-15T15:33:16Z", "message": "HH-121275 fixes after review - 1"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "81ff810f7cdb0fbb3c7feceab07319e833cd5fb9", "author": {"user": {"login": "SCREEN88", "name": "Yuriy Marinov"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/81ff810f7cdb0fbb3c7feceab07319e833cd5fb9", "committedDate": "2020-12-15T15:27:30Z", "message": "HH-121275 fixes after review - 1"}, "afterCommit": {"oid": "9e6783826d5558eac8799fa3955ca553b8913cec", "author": {"user": {"login": "SCREEN88", "name": "Yuriy Marinov"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/9e6783826d5558eac8799fa3955ca553b8913cec", "committedDate": "2020-12-15T15:33:16Z", "message": "HH-121275 fixes after review - 1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNTk1OTEx", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#pullrequestreview-552595911", "createdAt": "2020-12-15T15:45:18Z", "commit": {"oid": "9e6783826d5558eac8799fa3955ca553b8913cec"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNTo0NToxOFrOIGSF_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxNTo0NTo1NlrOIGSHyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ1ODgxMw==", "bodyText": "\u043d\u0435 \u043d\u0443\u0436\u043d\u043e \u0431\u043e\u043b\u044c\u0448\u0435", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r543458813", "createdAt": "2020-12-15T15:45:18Z", "author": {"login": "dzharikhin"}, "path": ".gitignore", "diffHunk": "@@ -12,3 +12,4 @@ nb-configuration.xml\n dependency-reduced-pom.xml\n *.properties.dev\n *.log\n+logs", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTk5MDUyNA=="}, "originalCommit": {"oid": "8a4fcb828d1e2fe03e4cab11b4d36a6e1e9c1e5e"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzQ1OTI3NA==", "bodyText": "\u0442\u0443\u0442 \u043a\u0430\u0436\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0442\u0441\u0442\u0443\u043f\u044b \u043f\u0435\u0440\u0435\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u043d\u0438\u044f", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#discussion_r543459274", "createdAt": "2020-12-15T15:45:56Z", "author": {"login": "dzharikhin"}, "path": "nab-logging/src/main/java/ru/hh/nab/logging/HhMultiAppender.java", "diffHunk": "@@ -36,6 +27,13 @@ public HhMultiAppender(boolean json) {\n   protected String pattern;\n   protected boolean json;\n \n+  public HhMultiAppender() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e6783826d5558eac8799fa3955ca553b8913cec"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzNDc1MTIx", "url": "https://github.com/hhru/nuts-and-bolts/pull/286#pullrequestreview-553475121", "createdAt": "2020-12-16T08:57:41Z", "commit": {"oid": "9e6783826d5558eac8799fa3955ca553b8913cec"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3378, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}