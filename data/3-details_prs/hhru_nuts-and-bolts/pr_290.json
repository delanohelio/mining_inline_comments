{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2Mzc2MjY0", "number": 290, "title": "HH-122108 improve configuration validation", "bodyText": "", "createdAt": "2020-12-29T08:00:12Z", "url": "https://github.com/hhru/nuts-and-bolts/pull/290", "merged": true, "mergeCommit": {"oid": "984a78ff4177a7781090f967902eb652b0fde11a"}, "closed": true, "closedAt": "2021-01-18T15:02:21Z", "author": {"login": "dzharikhin"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdq3C1qAFqTU1OTQyMDM1Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdwbX9-gH2gAyNTQ2Mzc2MjY0OjQxYjRkYmVjYThmY2I5ZTVlNWM2YmNjZmM4NzNmMDNlNGE1OWE0Mjk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NDIwMzU3", "url": "https://github.com/hhru/nuts-and-bolts/pull/290#pullrequestreview-559420357", "createdAt": "2020-12-29T08:09:49Z", "commit": {"oid": "f04f420f1bd040ab7e56170f1d1ea4df522012a2"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwODowOTo0OVrOIMJg3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwOTowOTozNFrOIMKmHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYwOTY5NA==", "bodyText": "getNotEmptyFromConfig \u0438\u043b\u0438 \u0434\u0430\u0436\u0435 getNotEmpty?", "url": "https://github.com/hhru/nuts-and-bolts/pull/290#discussion_r549609694", "createdAt": "2020-12-29T08:09:49Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/ConsulService.java", "diffHunk": "@@ -118,6 +123,25 @@ public ConsulService(AgentClient agentClient, KeyValueClient kvClient,\n     }\n   }\n \n+  private int validateAndGetCacheWaitSeconds(FileSettings fileSettings, OkHttpClient httpClient) {\n+    int cacheWaitSeconds = fileSettings.getInteger(CONSUL_WEIGHT_CACHE_WATCH_INTERVAL_PROPERTY, 10);\n+    if (httpClient.readTimeoutMillis() <= TimeUnit.SECONDS.toMillis(cacheWaitSeconds)) {\n+      throw new IllegalStateException(CONSUL_WEIGHT_CACHE_WATCH_INTERVAL_PROPERTY\n+        + \" must be less than consul http read timeout=\" + httpClient.readTimeoutMillis() + \"ms. To adjust timeout use configuration key: \"\n+        + CONSUL_CLIENT_READ_TIMEOUT_PROPERTY + \")\"\n+      );\n+    }\n+    return cacheWaitSeconds;\n+  }\n+\n+  private String validateAndGetFromConfig(FileSettings fileSettings, String propertyKey) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f04f420f1bd040ab7e56170f1d1ea4df522012a2"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYyNzQyMg==", "bodyText": "\u0416\u0435\u0441\u0442\u044c \u043a\u043e\u043d\u0435\u0447\u043d\u043e, \u043d\u043e \u043f\u043e \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043d\u0435 \u0437\u043d\u0430\u044e \u043a\u0430\u043a \u0441\u0434\u0435\u043b\u0430\u0442\u044c, \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 \u043d\u0430\u0448 \u0444\u043e\u0440\u043a \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0442\u044c.", "url": "https://github.com/hhru/nuts-and-bolts/pull/290#discussion_r549627422", "createdAt": "2020-12-29T09:09:34Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/NabProdConfig.java", "diffHunk": "@@ -80,14 +83,25 @@ KeyValueClient keyValueClient(Consul consul) {\n     return consul.keyValueClient();\n   }\n \n+  @Bean\n+  OkHttpClient okHttpClient(Consul consul) {\n+    return Optional.ofNullable(ReflectionUtils.findField(Consul.class, \"okHttpClient\", OkHttpClient.class))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f04f420f1bd040ab7e56170f1d1ea4df522012a2"}, "originalPosition": 55}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "db9f4020db978257a1c5b007755a77828c5531a5", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/db9f4020db978257a1c5b007755a77828c5531a5", "committedDate": "2020-12-29T19:48:50Z", "message": "HH-122108 use newer version of consul client"}, "afterCommit": {"oid": "2f5059972c510c823b6489954a632b6a14305944", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/2f5059972c510c823b6489954a632b6a14305944", "committedDate": "2020-12-30T09:03:18Z", "message": "HH-122108 use newer and SHADED version of consul client"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1MjQ1Mjcz", "url": "https://github.com/hhru/nuts-and-bolts/pull/290#pullrequestreview-565245273", "createdAt": "2021-01-11T10:55:18Z", "commit": {"oid": "2f5059972c510c823b6489954a632b6a14305944"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31ca81db4f35176fae596f873ce189a2f4b1d40d", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/31ca81db4f35176fae596f873ce189a2f4b1d40d", "committedDate": "2021-01-12T08:52:05Z", "message": "HH-122108 prod version"}, "afterCommit": {"oid": "75ac6aefc12c5e0e2e40c6f7dda4f5e200a89bcc", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/75ac6aefc12c5e0e2e40c6f7dda4f5e200a89bcc", "committedDate": "2021-01-12T08:52:28Z", "message": "HH-122108 prod version"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a1d592dd9f4cb7d74dca6f810a10dd76f5a1ad86", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/a1d592dd9f4cb7d74dca6f810a10dd76f5a1ad86", "committedDate": "2021-01-13T12:50:19Z", "message": "HH-122108 improved dependency management"}, "afterCommit": {"oid": "c404db93a154771cc6dd6dbb8121962b7a98d5f9", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/c404db93a154771cc6dd6dbb8121962b7a98d5f9", "committedDate": "2021-01-13T13:13:57Z", "message": "HH-122108 improved dependency management"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d82b327f67d96d1dc14ff5e1f768e9edbde9e348", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/d82b327f67d96d1dc14ff5e1f768e9edbde9e348", "committedDate": "2021-01-13T18:37:07Z", "message": "HH-122108 improve configuration validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ca5c7aa4ecc23f29721de90d576cf6d03a29ade", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/5ca5c7aa4ecc23f29721de90d576cf6d03a29ade", "committedDate": "2021-01-13T18:37:07Z", "message": "HH-122108 shorter method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4799580e57f888b39aeb53e548e42a6fd1d33e72", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/4799580e57f888b39aeb53e548e42a6fd1d33e72", "committedDate": "2021-01-13T18:37:07Z", "message": "HH-122108 use newer and SHADED version of consul client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59b4175f14a7c77116c5dbd726e903e13e2eacdc", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/59b4175f14a7c77116c5dbd726e903e13e2eacdc", "committedDate": "2021-01-13T18:37:07Z", "message": "HH-122108 prod version"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c404db93a154771cc6dd6dbb8121962b7a98d5f9", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/c404db93a154771cc6dd6dbb8121962b7a98d5f9", "committedDate": "2021-01-13T13:13:57Z", "message": "HH-122108 improved dependency management"}, "afterCommit": {"oid": "8af267f67c0fd4cad17014b507cf923c28e485e1", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/8af267f67c0fd4cad17014b507cf923c28e485e1", "committedDate": "2021-01-13T18:37:07Z", "message": "HH-122108 improved dependency management"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8af267f67c0fd4cad17014b507cf923c28e485e1", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/8af267f67c0fd4cad17014b507cf923c28e485e1", "committedDate": "2021-01-13T18:37:07Z", "message": "HH-122108 improved dependency management"}, "afterCommit": {"oid": "e426110bbf5b3588eaa17c16429790b4d31dd66b", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/e426110bbf5b3588eaa17c16429790b4d31dd66b", "committedDate": "2021-01-13T18:53:09Z", "message": "HH-122108 improved dependency management"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e426110bbf5b3588eaa17c16429790b4d31dd66b", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/e426110bbf5b3588eaa17c16429790b4d31dd66b", "committedDate": "2021-01-13T18:53:09Z", "message": "HH-122108 improved dependency management"}, "afterCommit": {"oid": "46f71b0efdee0f4df9bfd558aa27f13c461e71e7", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/46f71b0efdee0f4df9bfd558aa27f13c461e71e7", "committedDate": "2021-01-13T19:00:28Z", "message": "HH-122108 improved dependency management"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY3OTcwNjg3", "url": "https://github.com/hhru/nuts-and-bolts/pull/290#pullrequestreview-567970687", "createdAt": "2021-01-14T07:40:06Z", "commit": {"oid": "8ccfbe31ad7739cbb511998a3ff1fa263d074a40"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8ccfbe31ad7739cbb511998a3ff1fa263d074a40", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/8ccfbe31ad7739cbb511998a3ff1fa263d074a40", "committedDate": "2021-01-13T21:31:37Z", "message": "HH-122108 up consul client version"}, "afterCommit": {"oid": "f35d375d6de653bba8e596cf3174a0e1d8d5b3eb", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/f35d375d6de653bba8e596cf3174a0e1d8d5b3eb", "committedDate": "2021-01-14T12:43:21Z", "message": "HH-122108 up consul client version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2366262caa74715e3ea3f25fd3f3a6efea592ebd", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/2366262caa74715e3ea3f25fd3f3a6efea592ebd", "committedDate": "2021-01-14T21:13:32Z", "message": "HH-122108 improved dependency management"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d46bd96bd2ad6efc57c788e27be9514370b571f", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/8d46bd96bd2ad6efc57c788e27be9514370b571f", "committedDate": "2021-01-14T21:13:32Z", "message": "HH-122108 up consul client version"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f35d375d6de653bba8e596cf3174a0e1d8d5b3eb", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/f35d375d6de653bba8e596cf3174a0e1d8d5b3eb", "committedDate": "2021-01-14T12:43:21Z", "message": "HH-122108 up consul client version"}, "afterCommit": {"oid": "c0b85522ea62a7a047d1e46c16dc2fcb3bbce4a3", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/c0b85522ea62a7a047d1e46c16dc2fcb3bbce4a3", "committedDate": "2021-01-14T21:14:00Z", "message": "HH-122108 readme up"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY4OTMzMDk5", "url": "https://github.com/hhru/nuts-and-bolts/pull/290#pullrequestreview-568933099", "createdAt": "2021-01-15T07:12:32Z", "commit": {"oid": "c0b85522ea62a7a047d1e46c16dc2fcb3bbce4a3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY5MTI2NDY0", "url": "https://github.com/hhru/nuts-and-bolts/pull/290#pullrequestreview-569126464", "createdAt": "2021-01-15T10:10:27Z", "commit": {"oid": "c0b85522ea62a7a047d1e46c16dc2fcb3bbce4a3"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNVQxMDoxMDoyN1rOIUU8Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xNVQxMDoxMDoyN1rOIUU8Tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1ODE4NTU1MA==", "bodyText": "\u041c\u043e\u0436\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 fileSettings?", "url": "https://github.com/hhru/nuts-and-bolts/pull/290#discussion_r558185550", "createdAt": "2021-01-15T10:10:27Z", "author": {"login": "heruv1m"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/ConsulService.java", "diffHunk": "@@ -118,6 +120,14 @@ public ConsulService(AgentClient agentClient, KeyValueClient kvClient,\n     }\n   }\n \n+  private String getNotEmpty(FileSettings fileSettings, String propertyKey) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0b85522ea62a7a047d1e46c16dc2fcb3bbce4a3"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY5MTQ2NTM0", "url": "https://github.com/hhru/nuts-and-bolts/pull/290#pullrequestreview-569146534", "createdAt": "2021-01-15T10:38:14Z", "commit": {"oid": "511a2f857e176caa7ed36b591f7aa29e47e56eb7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2ee2807b34bb609943a333979a465e6be6ab1ed", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/c2ee2807b34bb609943a333979a465e6be6ab1ed", "committedDate": "2021-01-15T10:39:57Z", "message": "HH-122108 readme up"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "511a2f857e176caa7ed36b591f7aa29e47e56eb7", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/511a2f857e176caa7ed36b591f7aa29e47e56eb7", "committedDate": "2021-01-15T10:35:10Z", "message": "HH-122108 use bom for main framework dependencies to guagantee consistency"}, "afterCommit": {"oid": "0122605633d3198849714a23c204808482e80a41", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/0122605633d3198849714a23c204808482e80a41", "committedDate": "2021-01-15T10:39:57Z", "message": "HH-122108 use bom for main framework dependencies to guagantee consistency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "876c0691469f240bf59512d78d8043c5bf5579b2", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/876c0691469f240bf59512d78d8043c5bf5579b2", "committedDate": "2021-01-15T11:38:52Z", "message": "HH-122108 use bom for main framework dependencies to guagantee consistency"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0122605633d3198849714a23c204808482e80a41", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/0122605633d3198849714a23c204808482e80a41", "committedDate": "2021-01-15T10:39:57Z", "message": "HH-122108 use bom for main framework dependencies to guagantee consistency"}, "afterCommit": {"oid": "876c0691469f240bf59512d78d8043c5bf5579b2", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/876c0691469f240bf59512d78d8043c5bf5579b2", "committedDate": "2021-01-15T11:38:52Z", "message": "HH-122108 use bom for main framework dependencies to guagantee consistency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41b4dbeca8fcb9e5e5c6bccfc873f03e4a59a429", "author": {"user": {"login": "dzharikhin", "name": "Dmitriy Zharikhin"}}, "url": "https://github.com/hhru/nuts-and-bolts/commit/41b4dbeca8fcb9e5e5c6bccfc873f03e4a59a429", "committedDate": "2021-01-15T16:19:13Z", "message": "HH-122108 move not empty validation to util class"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3385, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}