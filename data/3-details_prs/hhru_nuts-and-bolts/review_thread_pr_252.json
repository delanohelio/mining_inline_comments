{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2OTg2MjQy", "number": 252, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODowODoyMlrOESR6uA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjoyNTo0MFrOESdnYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjAzMzg0OnYy", "diffSide": "RIGHT", "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODowODoyMlrOG3X6cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDozMDo1OVrOG3lJpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxNjY1Nw==", "bodyText": "\u041d\u0430\u0433\u043b\u043e \u0443\u043a\u0440\u0430\u043b \u0443 JClient'\u0430", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460716657", "createdAt": "2020-07-27T08:08:22Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {\n+      Thread thread = new Thread(r, LogLevelOverrideApplier.class.getSimpleName());\n+      thread.setDaemon(true);\n+      return thread;\n+    });\n+    executor.scheduleWithFixedDelay(() -> {\n+      try {\n+        applyOverrides(getOrThrow(extension.loadLogLevelOverrides()));\n+      } catch (RuntimeException e) {\n+        LOGGER.error(\"Could not apply log level overrides\", e);\n+      }\n+    }, extension.updateInterval(), extension.updateInterval(), TimeUnit.MINUTES);\n+  }\n+\n+  private void applyOverrides(Map<String, String> overrides) {\n+    Set<String> obsoleteOverrides = new HashSet<>(previousOverrides.keySet());\n+    overrides.forEach((logger, logLevel) -> {\n+      obsoleteOverrides.remove(logger);\n+      if (!logLevel.equals(previousOverrides.get(logger))) {\n+        previousOverrides.put(logger, logLevel);\n+        var initialLogLevel = initialLogLevels.get(logger);\n+        var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(logger);\n+        if (initialLogLevel == null) {\n+          initialLogLevels.put(logger, logbackLogger.getLevel().levelStr);\n+        }\n+        logbackLogger.setLevel(Level.toLevel(logLevel));\n+      }\n+    });\n+    obsoleteOverrides.forEach(obsoleteOverrideLogger -> {\n+      previousOverrides.remove(obsoleteOverrideLogger);\n+      var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(obsoleteOverrideLogger);\n+      logbackLogger.setLevel(Level.toLevel(initialLogLevels.get(obsoleteOverrideLogger)));\n+      initialLogLevels.remove(obsoleteOverrideLogger);\n+    });\n+  }\n+\n+  private <T> T getOrThrow(CompletableFuture<T> future) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkyMDkwNQ==", "bodyText": "\u0443 \u043e\u043d\u0438 \u0448\u0430\u0440\u044f\u0442 \u043a\u0430\u043a\u043e\u0439 \u0442\u043e \u043a\u043e\u0434?\n\u0422\u043e\u0433\u0434\u0430 \u043c\u043e\u0436\u0435\u0442 \u0432 utils?", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460920905", "createdAt": "2020-07-27T14:14:26Z", "author": {"login": "heruv1m"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {\n+      Thread thread = new Thread(r, LogLevelOverrideApplier.class.getSimpleName());\n+      thread.setDaemon(true);\n+      return thread;\n+    });\n+    executor.scheduleWithFixedDelay(() -> {\n+      try {\n+        applyOverrides(getOrThrow(extension.loadLogLevelOverrides()));\n+      } catch (RuntimeException e) {\n+        LOGGER.error(\"Could not apply log level overrides\", e);\n+      }\n+    }, extension.updateInterval(), extension.updateInterval(), TimeUnit.MINUTES);\n+  }\n+\n+  private void applyOverrides(Map<String, String> overrides) {\n+    Set<String> obsoleteOverrides = new HashSet<>(previousOverrides.keySet());\n+    overrides.forEach((logger, logLevel) -> {\n+      obsoleteOverrides.remove(logger);\n+      if (!logLevel.equals(previousOverrides.get(logger))) {\n+        previousOverrides.put(logger, logLevel);\n+        var initialLogLevel = initialLogLevels.get(logger);\n+        var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(logger);\n+        if (initialLogLevel == null) {\n+          initialLogLevels.put(logger, logbackLogger.getLevel().levelStr);\n+        }\n+        logbackLogger.setLevel(Level.toLevel(logLevel));\n+      }\n+    });\n+    obsoleteOverrides.forEach(obsoleteOverrideLogger -> {\n+      previousOverrides.remove(obsoleteOverrideLogger);\n+      var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(obsoleteOverrideLogger);\n+      logbackLogger.setLevel(Level.toLevel(initialLogLevels.get(obsoleteOverrideLogger)));\n+      initialLogLevels.remove(obsoleteOverrideLogger);\n+    });\n+  }\n+\n+  private <T> T getOrThrow(CompletableFuture<T> future) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxNjY1Nw=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkyOTE0OA==", "bodyText": "\u0434\u0430 \u043d\u0443 \u043a\u0443\u0434\u0430. \u0442\u0443\u0442 \u043a\u043e\u0434\u0430-\u0442\u043e", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460929148", "createdAt": "2020-07-27T14:25:16Z", "author": {"login": "dzharikhin"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {\n+      Thread thread = new Thread(r, LogLevelOverrideApplier.class.getSimpleName());\n+      thread.setDaemon(true);\n+      return thread;\n+    });\n+    executor.scheduleWithFixedDelay(() -> {\n+      try {\n+        applyOverrides(getOrThrow(extension.loadLogLevelOverrides()));\n+      } catch (RuntimeException e) {\n+        LOGGER.error(\"Could not apply log level overrides\", e);\n+      }\n+    }, extension.updateInterval(), extension.updateInterval(), TimeUnit.MINUTES);\n+  }\n+\n+  private void applyOverrides(Map<String, String> overrides) {\n+    Set<String> obsoleteOverrides = new HashSet<>(previousOverrides.keySet());\n+    overrides.forEach((logger, logLevel) -> {\n+      obsoleteOverrides.remove(logger);\n+      if (!logLevel.equals(previousOverrides.get(logger))) {\n+        previousOverrides.put(logger, logLevel);\n+        var initialLogLevel = initialLogLevels.get(logger);\n+        var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(logger);\n+        if (initialLogLevel == null) {\n+          initialLogLevels.put(logger, logbackLogger.getLevel().levelStr);\n+        }\n+        logbackLogger.setLevel(Level.toLevel(logLevel));\n+      }\n+    });\n+    obsoleteOverrides.forEach(obsoleteOverrideLogger -> {\n+      previousOverrides.remove(obsoleteOverrideLogger);\n+      var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(obsoleteOverrideLogger);\n+      logbackLogger.setLevel(Level.toLevel(initialLogLevels.get(obsoleteOverrideLogger)));\n+      initialLogLevels.remove(obsoleteOverrideLogger);\n+    });\n+  }\n+\n+  private <T> T getOrThrow(CompletableFuture<T> future) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxNjY1Nw=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMzU0Mg==", "bodyText": "\u041d\u0435 \u0448\u0430\u0440\u044f\u0442. \u0414\u0443\u043c\u0430\u043b \u043f\u0440\u043e utils \u043d\u043e \u0442\u043e\u0433\u0434\u0430 \u043f\u0440\u0438\u0434\u0451\u0442\u0441\u044f public \u0434\u0435\u043b\u0430\u0442\u044c \u0438 \u0443 \u043a\u043e\u0433\u043e-\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0432\u043e\u0437\u043d\u0438\u043a\u043d\u0443\u0442\u044c \u0441\u043e\u0431\u043b\u0430\u0437\u043d \u0437\u0430\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c.", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460933542", "createdAt": "2020-07-27T14:30:59Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {\n+      Thread thread = new Thread(r, LogLevelOverrideApplier.class.getSimpleName());\n+      thread.setDaemon(true);\n+      return thread;\n+    });\n+    executor.scheduleWithFixedDelay(() -> {\n+      try {\n+        applyOverrides(getOrThrow(extension.loadLogLevelOverrides()));\n+      } catch (RuntimeException e) {\n+        LOGGER.error(\"Could not apply log level overrides\", e);\n+      }\n+    }, extension.updateInterval(), extension.updateInterval(), TimeUnit.MINUTES);\n+  }\n+\n+  private void applyOverrides(Map<String, String> overrides) {\n+    Set<String> obsoleteOverrides = new HashSet<>(previousOverrides.keySet());\n+    overrides.forEach((logger, logLevel) -> {\n+      obsoleteOverrides.remove(logger);\n+      if (!logLevel.equals(previousOverrides.get(logger))) {\n+        previousOverrides.put(logger, logLevel);\n+        var initialLogLevel = initialLogLevels.get(logger);\n+        var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(logger);\n+        if (initialLogLevel == null) {\n+          initialLogLevels.put(logger, logbackLogger.getLevel().levelStr);\n+        }\n+        logbackLogger.setLevel(Level.toLevel(logLevel));\n+      }\n+    });\n+    obsoleteOverrides.forEach(obsoleteOverrideLogger -> {\n+      previousOverrides.remove(obsoleteOverrideLogger);\n+      var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(obsoleteOverrideLogger);\n+      logbackLogger.setLevel(Level.toLevel(initialLogLevels.get(obsoleteOverrideLogger)));\n+      initialLogLevels.remove(obsoleteOverrideLogger);\n+    });\n+  }\n+\n+  private <T> T getOrThrow(CompletableFuture<T> future) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxNjY1Nw=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjAzNzM0OnYy", "diffSide": "RIGHT", "path": "nab-starter/src/main/java/ru/hh/nab/starter/NabApplication.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODowOToyOFrOG3X8cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODowOToyOFrOG3X8cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxNzE3MA==", "bodyText": "\u0421\u0434\u0435\u043b\u0430\u043b private, \u043e\u043d \u0432\u0441\u0451 \u0440\u0430\u0432\u043d\u043e \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432 run", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460717170", "createdAt": "2020-07-27T08:09:28Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/NabApplication.java", "diffHunk": "@@ -112,16 +115,27 @@ public static NabApplicationBuilder builder() {\n     return new NabApplicationBuilder();\n   }\n \n-  public static void configureLogger() {\n-    SLF4JBridgeHandler.removeHandlersForRootLogger();\n-    SLF4JBridgeHandler.install();\n-  }\n-\n   public static void configureSentry(ApplicationContext context) {\n     FileSettings settings = context.getBean(FileSettings.class);\n     Sentry.init(settings.getString(\"sentry.dsn\"));\n   }\n \n+  private static void configureLogger(ApplicationContext context) {\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NjA0MzI2OnYy", "diffSide": "RIGHT", "path": "nab-testbase-old/src/main/java/ru/hh/nab/testbase/old/NabTestBase.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwODoxMTowN1rOG3X_8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjowMDoxMFrOG3pCzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxODA2Nw==", "bodyText": "\u041e\u0441\u0442\u0430\u0432\u0438\u043b \u043d\u0430 \u0432\u0441\u044f\u043a\u0438\u0439 \u0441\u043b\u0443\u0447\u0430\u0439 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u0438, \u043d\u043e \u043d\u0435 \u0443\u0432\u0435\u0440\u0435\u043d \u0447\u0442\u043e \u043d\u0430\u043c \u0432\u043e\u043e\u0431\u0449\u0435 \u043d\u0443\u0436\u043d\u044b \u0442\u0430\u043d\u0446\u044b \u0441 jul-bridg'\u0435\u043c \u0432 \u0442\u0435\u0441\u0442\u0430\u0445.", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460718067", "createdAt": "2020-07-27T08:11:07Z", "author": {"login": "pvorlov"}, "path": "nab-testbase-old/src/main/java/ru/hh/nab/testbase/old/NabTestBase.java", "diffHunk": "@@ -31,7 +32,9 @@\n \n   @Before\n   public void setUpNabTestBase() {\n-    NabApplication.configureLogger();\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg4NzY1OQ==", "bodyText": "\u0430 \u0437\u0430\u0447\u0435\u043c \u0442\u0443\u0442 \u0432\u043e\u043e\u0431\u0449\u0435 \u0447\u0442\u043e-\u0442\u043e \u0442\u0440\u043e\u0433\u0430\u0442\u044c?", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460887659", "createdAt": "2020-07-27T13:26:07Z", "author": {"login": "dzharikhin"}, "path": "nab-testbase-old/src/main/java/ru/hh/nab/testbase/old/NabTestBase.java", "diffHunk": "@@ -31,7 +32,9 @@\n \n   @Before\n   public void setUpNabTestBase() {\n-    NabApplication.configureLogger();\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxODA2Nw=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkxNDkxNA==", "bodyText": "\u0421\u0438\u0433\u043d\u0430\u0442\u0443\u0440\u0430 \u043f\u043e\u043c\u0435\u043d\u044f\u043b\u0430\u0441\u044c, \u0442\u0435\u043f\u0435\u0440\u044c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u043d\u0430\u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460914914", "createdAt": "2020-07-27T14:05:47Z", "author": {"login": "pvorlov"}, "path": "nab-testbase-old/src/main/java/ru/hh/nab/testbase/old/NabTestBase.java", "diffHunk": "@@ -31,7 +32,9 @@\n \n   @Before\n   public void setUpNabTestBase() {\n-    NabApplication.configureLogger();\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxODA2Nw=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzMDU2MA==", "bodyText": "\u0442\u0430\u043a \u043d\u0443 \u0430 \u0447\u0435 - \u043d\u0443 \u0441\u0434\u0435\u043b\u0430\u0439 \u043c\u0435\u0442\u043e\u0434 \u0431\u0435\u0437 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 - \u043f\u0440\u043e\u0441\u0442\u043e \u0449\u0430\u0441 \u0442\u044b \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442\u0441\u044f \u043a\u0438\u0448\u043a\u0438 \u0432\u044b\u0432\u0430\u043b\u0438\u043b \u0432 \u0442\u0435\u0441\u0442\u044b", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460930560", "createdAt": "2020-07-27T14:27:06Z", "author": {"login": "dzharikhin"}, "path": "nab-testbase-old/src/main/java/ru/hh/nab/testbase/old/NabTestBase.java", "diffHunk": "@@ -31,7 +32,9 @@\n \n   @Before\n   public void setUpNabTestBase() {\n-    NabApplication.configureLogger();\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxODA2Nw=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk3ODYxMg==", "bodyText": "\u041f\u043e\u0447\u0435\u043c\u0443 \u043c\u043d\u0435 \u044d\u0442\u043e \u043d\u0435 \u043d\u0440\u0430\u0432\u0438\u0442\u0441\u044f:\n\n\u042d\u0442\u043e \u043f\u043e \u0441\u0435\u043c\u0430\u043d\u0442\u0438\u043a\u0435 \u0443\u0436\u0435 \u0431\u0443\u0434\u0435\u0442 \u043d\u0435 configureLogger \u0430 \u043b\u0438\u0448\u044c \u0447\u0430\u0441\u0442\u044c \u0435\u0433\u043e \u0431\u043e\u043b\u044c\u0448\u043e\u0433\u043e \u0431\u0440\u0430\u0442\u0430. \u0427\u0442\u043e\u0431\u044b \u043c\u0435\u0442\u043e\u0434 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0442\u0440\u0430\u0436\u0430\u043b \u0447\u0442\u043e \u043e\u043d \u0434\u0435\u043b\u0430\u0435\u0442 \u043d\u0430\u0434\u043e \u043d\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0435\u0433\u043e configureJULBridge \u0430 \u044d\u0442\u043e \u0443\u0436\u0435 \u043d\u0435 \u0442\u0430\u043a \u0434\u0430\u043b\u0435\u043a\u043e \u043e\u0442 2 \u0441\u0442\u0440\u043e\u0447\u0435\u043a, \u0447\u0442\u043e \u044f \u0437\u0430\u0438\u043d\u043b\u0430\u0439\u043d\u0438\u043b\n\u0421\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e \u0437\u0430\u043c\u0435\u043d\u0438\u043b public \u043d\u0430 private \u0447\u0442\u043e \u0431 \u043b\u0438\u0448\u043d\u0438\u0435 \u043a\u0438\u0448\u043a\u0438 \u043d\u0435 \u0442\u043e\u0440\u0447\u0430\u043b\u0438 \u0430 \u0442\u0443\u0442 \u043f\u0440\u0438\u0434\u0451\u0442\u0441\u044f public \u0434\u0435\u043b\u0430\u0442\u044c\n\u042d\u0442\u043e \u0434\u0435\u043b\u043e \u043b\u0435\u0436\u0438\u0442 \u0432 testbase-old, \u0432 \u043d\u043e\u0432\u044b\u0439 testbase \u043e\u043d \u043c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u043d\u0435 \u043f\u043e\u043f\u0430\u043b", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460978612", "createdAt": "2020-07-27T15:32:28Z", "author": {"login": "pvorlov"}, "path": "nab-testbase-old/src/main/java/ru/hh/nab/testbase/old/NabTestBase.java", "diffHunk": "@@ -31,7 +32,9 @@\n \n   @Before\n   public void setUpNabTestBase() {\n-    NabApplication.configureLogger();\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxODA2Nw=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk5NzMyNg==", "bodyText": "\u043d\u0443\u0443\u0443\u0443 \u043e\u043a", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460997326", "createdAt": "2020-07-27T16:00:10Z", "author": {"login": "dzharikhin"}, "path": "nab-testbase-old/src/main/java/ru/hh/nab/testbase/old/NabTestBase.java", "diffHunk": "@@ -31,7 +32,9 @@\n \n   @Before\n   public void setUpNabTestBase() {\n-    NabApplication.configureLogger();\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDcxODA2Nw=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzEyODAzOnYy", "diffSide": "RIGHT", "path": "nab-starter/src/main/java/ru/hh/nab/starter/NabApplication.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMzoyMTo1NFrOG3iLaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNToyNTowMFrOG3nkrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg4NDg0MA==", "bodyText": "\u0430 \u0447\u0435 \u043d\u0435 \u0432 \u0442\u0440\u0430\u0439 \u0431\u043b\u043e\u043a\u0435?", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460884840", "createdAt": "2020-07-27T13:21:54Z", "author": {"login": "dzharikhin"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/NabApplication.java", "diffHunk": "@@ -112,16 +115,27 @@ public static NabApplicationBuilder builder() {\n     return new NabApplicationBuilder();\n   }\n \n-  public static void configureLogger() {\n-    SLF4JBridgeHandler.removeHandlersForRootLogger();\n-    SLF4JBridgeHandler.install();\n-  }\n-\n   public static void configureSentry(ApplicationContext context) {\n     FileSettings settings = context.getBean(FileSettings.class);\n     Sentry.init(settings.getString(\"sentry.dsn\"));\n   }\n \n+  private static void configureLogger(ApplicationContext context) {\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();\n+    SLF4JBridgeHandler.install();\n+\n+    LogLevelOverrideExtension extension;\n+    try {\n+      extension = context.getBean(LogLevelOverrideExtension.class);\n+      LOGGER.info(\"{} activated\", LogLevelOverrideExtension.class.getSimpleName());\n+    } catch (NoSuchBeanDefinitionException e) {\n+      // Extension not activated, normal behaviour\n+      return;\n+    }\n+\n+    new LogLevelOverrideApplier().run(extension);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkxNjcyNg==", "bodyText": "\u0427\u0442\u043e \u0431 \u043d\u0435 \u0437\u0430\u0433\u0440\u043e\u043c\u043e\u0436\u0434\u0430\u0442\u044c, \u0432\u0441\u0435 try \u043c\u043e\u0436\u043d\u043e \u0443\u043d\u0435\u0441\u0442\u0438 \u0432\u043d\u0443\u0442\u0440\u044c. \u041d\u043e \u0442\u0430\u043c \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u043c \u043f\u043e\u0442\u043e\u043a\u0435 \u0436\u0435 \u0432\u0441\u0451 \u043a\u0440\u0443\u0442\u0438\u0442\u0441\u044f \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442, \u0441\u043b\u043e\u043c\u0430\u0442\u044c\u0441\u044f \u0443\u0436\u0435 \u0432\u043d\u0443\u0442\u0440\u0438 \u043d\u0435\u0433\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e \u0438\u0434\u0435\u0435.", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460916726", "createdAt": "2020-07-27T14:08:27Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/NabApplication.java", "diffHunk": "@@ -112,16 +115,27 @@ public static NabApplicationBuilder builder() {\n     return new NabApplicationBuilder();\n   }\n \n-  public static void configureLogger() {\n-    SLF4JBridgeHandler.removeHandlersForRootLogger();\n-    SLF4JBridgeHandler.install();\n-  }\n-\n   public static void configureSentry(ApplicationContext context) {\n     FileSettings settings = context.getBean(FileSettings.class);\n     Sentry.init(settings.getString(\"sentry.dsn\"));\n   }\n \n+  private static void configureLogger(ApplicationContext context) {\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();\n+    SLF4JBridgeHandler.install();\n+\n+    LogLevelOverrideExtension extension;\n+    try {\n+      extension = context.getBean(LogLevelOverrideExtension.class);\n+      LOGGER.info(\"{} activated\", LogLevelOverrideExtension.class.getSimpleName());\n+    } catch (NoSuchBeanDefinitionException e) {\n+      // Extension not activated, normal behaviour\n+      return;\n+    }\n+\n+    new LogLevelOverrideApplier().run(extension);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg4NDg0MA=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkzNTY5MA==", "bodyText": "\u043c\u043e\u0436 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0431\u0438\u043d\u0430 \u0432 \u043c\u0435\u0442\u043e\u0434 Optional?\n\u0430 LogLevelOverrideApplier \u0432\u043e\u043e\u0431\u0449\u0435 \u043d\u0430 \u0441\u0442\u0430\u0442\u0438\u043a\u0443 \u043f\u0435\u0440\u0435\u0434\u0435\u043b\u0430\u0442\u044c - \u0443 \u043d\u0435\u0433\u043e \u0432\u0440\u043e\u0434\u0435 \u043b\u043e\u0433\u0438\u043a\u0438 \u0438\u043d\u0441\u0442\u0430\u043d\u0441\u043d\u043e\u0439-\u0442\u043e \u043d\u0435\u0442\u0443\n\u0447\u0435 \u0442 \u0441\u0442\u0440\u0430\u0448\u043d\u0435\u043d\u044c\u043a\u0438\u043c \u043a\u0430\u0436\u0435\u0442\u0441\u044f \u0432\u043e\u0442 \u044d\u0442\u043e\u0442 return \u0438\u0437 catch \u0438 \u043f\u043e\u0442\u043e\u043c \u043f\u043e\u0441\u043b\u0435 catch \u0435\u0449\u0435 \u0438 new \u0437\u0430 \u043d\u0438\u043c", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460935690", "createdAt": "2020-07-27T14:33:49Z", "author": {"login": "dzharikhin"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/NabApplication.java", "diffHunk": "@@ -112,16 +115,27 @@ public static NabApplicationBuilder builder() {\n     return new NabApplicationBuilder();\n   }\n \n-  public static void configureLogger() {\n-    SLF4JBridgeHandler.removeHandlersForRootLogger();\n-    SLF4JBridgeHandler.install();\n-  }\n-\n   public static void configureSentry(ApplicationContext context) {\n     FileSettings settings = context.getBean(FileSettings.class);\n     Sentry.init(settings.getString(\"sentry.dsn\"));\n   }\n \n+  private static void configureLogger(ApplicationContext context) {\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();\n+    SLF4JBridgeHandler.install();\n+\n+    LogLevelOverrideExtension extension;\n+    try {\n+      extension = context.getBean(LogLevelOverrideExtension.class);\n+      LOGGER.info(\"{} activated\", LogLevelOverrideExtension.class.getSimpleName());\n+    } catch (NoSuchBeanDefinitionException e) {\n+      // Extension not activated, normal behaviour\n+      return;\n+    }\n+\n+    new LogLevelOverrideApplier().run(extension);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg4NDg0MA=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk2NjQ0NA==", "bodyText": "optional - \u043e\u043a\n\u0441\u0442\u0430\u0442\u0438\u043a\u0430 - \u043d\u0435 \u043e\u043a, \u043f\u043e\u043b\u044f \u0436 \u0438\u043d\u0441\u0442\u0430\u043d\u0441\u043d\u044b\u0435. \u0414\u0430 \u0438 \u0432\u043e\u043e\u0431\u0449\u0435 \u0431\u0435\u0437 \u0441\u0442\u0430\u0442\u0438\u043a\u0438 \u0436\u0438\u0437\u043d\u044c \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u043d\u0430\u043c\u043d\u043e\u0433\u043e \u043f\u0440\u0438\u044f\u0442\u043d\u0435\u0435, \u043a\u043e\u0433\u0434\u0430 \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442 \u043f\u043e\u044f\u0432\u043b\u044f\u0442\u044c\u0441\u044f \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0438\u043b\u0438 \u0442\u0435\u0441\u0442\u044b", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460966444", "createdAt": "2020-07-27T15:15:38Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/NabApplication.java", "diffHunk": "@@ -112,16 +115,27 @@ public static NabApplicationBuilder builder() {\n     return new NabApplicationBuilder();\n   }\n \n-  public static void configureLogger() {\n-    SLF4JBridgeHandler.removeHandlersForRootLogger();\n-    SLF4JBridgeHandler.install();\n-  }\n-\n   public static void configureSentry(ApplicationContext context) {\n     FileSettings settings = context.getBean(FileSettings.class);\n     Sentry.init(settings.getString(\"sentry.dsn\"));\n   }\n \n+  private static void configureLogger(ApplicationContext context) {\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();\n+    SLF4JBridgeHandler.install();\n+\n+    LogLevelOverrideExtension extension;\n+    try {\n+      extension = context.getBean(LogLevelOverrideExtension.class);\n+      LOGGER.info(\"{} activated\", LogLevelOverrideExtension.class.getSimpleName());\n+    } catch (NoSuchBeanDefinitionException e) {\n+      // Extension not activated, normal behaviour\n+      return;\n+    }\n+\n+    new LogLevelOverrideApplier().run(extension);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg4NDg0MA=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk3MzIzMQ==", "bodyText": "\u0417\u0430\u043f\u0443\u0448\u0438\u043b Optional", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460973231", "createdAt": "2020-07-27T15:25:00Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/NabApplication.java", "diffHunk": "@@ -112,16 +115,27 @@ public static NabApplicationBuilder builder() {\n     return new NabApplicationBuilder();\n   }\n \n-  public static void configureLogger() {\n-    SLF4JBridgeHandler.removeHandlersForRootLogger();\n-    SLF4JBridgeHandler.install();\n-  }\n-\n   public static void configureSentry(ApplicationContext context) {\n     FileSettings settings = context.getBean(FileSettings.class);\n     Sentry.init(settings.getString(\"sentry.dsn\"));\n   }\n \n+  private static void configureLogger(ApplicationContext context) {\n+    SLF4JBridgeHandler.removeHandlersForRootLogger();\n+    SLF4JBridgeHandler.install();\n+\n+    LogLevelOverrideExtension extension;\n+    try {\n+      extension = context.getBean(LogLevelOverrideExtension.class);\n+      LOGGER.info(\"{} activated\", LogLevelOverrideExtension.class.getSimpleName());\n+    } catch (NoSuchBeanDefinitionException e) {\n+      // Extension not activated, normal behaviour\n+      return;\n+    }\n+\n+    new LogLevelOverrideApplier().run(extension);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg4NDg0MA=="}, "originalCommit": {"oid": "4f18ae78768c5c95f4b3607a4355888360734829"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzE0MzA2OnYy", "diffSide": "RIGHT", "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMzoyNToyMFrOG3iUUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDowOTozNVrOG3kLLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg4NzEyMQ==", "bodyText": "\u043f\u0435\u0440\u0432\u0430\u044f \u0436\u0435 initialDelay - \u0442\u0430\u043c \u0436\u0435 \u043c\u043e\u0436\u043d\u043e 0 \u043d\u0430\u0432\u0435\u0440\u043d\u043e\u0435?", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460887121", "createdAt": "2020-07-27T13:25:20Z", "author": {"login": "dzharikhin"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {\n+      Thread thread = new Thread(r, LogLevelOverrideApplier.class.getSimpleName());\n+      thread.setDaemon(true);\n+      return thread;\n+    });\n+    executor.scheduleWithFixedDelay(() -> {\n+      try {\n+        applyOverrides(getOrThrow(extension.loadLogLevelOverrides()));\n+      } catch (RuntimeException e) {\n+        LOGGER.error(\"Could not apply log level overrides\", e);\n+      }\n+    }, extension.updateInterval(), extension.updateInterval(), TimeUnit.MINUTES);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkxNzU0OQ==", "bodyText": "\u0421\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e \u043d\u0435 \u0441\u0442\u0430\u043b, \u0434\u0443\u043c\u0430\u044e \u0443 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 \u0438 \u0442\u0430\u043a \u043d\u0430 \u0441\u0442\u0430\u0440\u0442\u0435 \u043f\u0440\u043e\u0433\u0440\u0435\u0432\u0430 \u0445\u0432\u0430\u0442\u0430\u0435\u0442", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460917549", "createdAt": "2020-07-27T14:09:35Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {\n+      Thread thread = new Thread(r, LogLevelOverrideApplier.class.getSimpleName());\n+      thread.setDaemon(true);\n+      return thread;\n+    });\n+    executor.scheduleWithFixedDelay(() -> {\n+      try {\n+        applyOverrides(getOrThrow(extension.loadLogLevelOverrides()));\n+      } catch (RuntimeException e) {\n+        LOGGER.error(\"Could not apply log level overrides\", e);\n+      }\n+    }, extension.updateInterval(), extension.updateInterval(), TimeUnit.MINUTES);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg4NzEyMQ=="}, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzI2ODIxOnYy", "diffSide": "RIGHT", "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMzo1NDo1MVrOG3jiKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoyNDo1NFrOG3k3Jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkwNzA1MA==", "bodyText": "\u043a\u0430\u043a-\u0442\u043e \u043c\u043d\u0435 \u0441\u0442\u0440\u0435\u043c\u043d\u043e, \u043a\u043e\u0433\u0434\u0430 executor \u043d\u0435 \u0432 \u043f\u043e\u043b\u0435, \u043a\u043e\u043d\u0435\u0447\u043d\u043e)\n\u043d\u0438\u043a\u0430\u043a\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u0443\u0441\u043a\u0430", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460907050", "createdAt": "2020-07-27T13:54:51Z", "author": {"login": "dzharikhin"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkxODMxOA==", "bodyText": "\u0410 \u043a\u0430\u043a\u043e\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u0442\u044b \u0445\u043e\u0447\u0435\u0448\u044c?", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460918318", "createdAt": "2020-07-27T14:10:40Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkwNzA1MA=="}, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkyODgwNg==", "bodyText": "\u043d\u0443 \u043e\u0431\u044b\u0447\u043d\u043e \u043a\u0430\u043a\u0443\u044e-\u0442\u043e \u0432\u044b\u043a\u043b\u044e\u0447\u0430\u043b\u043a\u0443. \u0434\u0430 \u0432\u0440\u043e\u0434\u0435 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0443\u0436\u043d\u043e \u0442\u0430\u043a\u043e\u0433\u043e", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460928806", "createdAt": "2020-07-27T14:24:54Z", "author": {"login": "dzharikhin"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkwNzA1MA=="}, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzI3MTkyOnYy", "diffSide": "RIGHT", "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideExtension.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxMzo1NTozNFrOG3jkYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoxNDoyOFrOG3kYag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkwNzYxOA==", "bodyText": "\u043b\u0443\u0447\u0448\u0435 \u0432 \u0438\u043c\u0435\u043d\u0438 \u043c\u0435\u0442\u043e\u0434\u0430 \u044e\u043d\u0438\u0442\u044b \u0438 \u0443\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c. \u0436\u0430\u0432\u0430\u0434\u043e\u043a\u0438 - \u043d\u0435 \u0442\u0430\u043a \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460907618", "createdAt": "2020-07-27T13:55:34Z", "author": {"login": "dzharikhin"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideExtension.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package ru.hh.nab.starter.logging;\n+\n+import java.util.Map;\n+import java.util.concurrent.CompletableFuture;\n+\n+/**\n+ * Extension which provides ability to override static Loggers levels with dynamic ones.\n+ * To activate extension simply implement it as a Spring bean.\n+ */\n+public interface LogLevelOverrideExtension {\n+\n+  /**\n+   * How often override should be loaded and applied in minutes\n+   */\n+  int updateInterval();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkxOTUyOA==", "bodyText": "\u041e\u043a, \u0442\u043e\u0436\u0435 \u0434\u0443\u043c\u0430\u043b \u0432 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u0430 \u0441\u043d\u0430\u0447\u0430\u043b\u0430. \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043b\u043e, \u0447\u0442\u043e \u044d\u0442\u043e\u0442 \u043a\u0443\u0441\u043e\u043a \u043f\u0440\u0438\u0434\u0451\u0442\u0441\u044f \u0432\u0441\u0435\u043c \u043a\u043e\u043f\u0438\u043f\u0430\u0441\u0442\u0438\u0442\u044c, \u0445\u043e\u0442\u0435\u043b \u0435\u0433\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043d\u0435\u0433\u0440\u043e\u043c\u043e\u0437\u0434\u043a\u0438\u043c.", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460919528", "createdAt": "2020-07-27T14:12:26Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideExtension.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package ru.hh.nab.starter.logging;\n+\n+import java.util.Map;\n+import java.util.concurrent.CompletableFuture;\n+\n+/**\n+ * Extension which provides ability to override static Loggers levels with dynamic ones.\n+ * To activate extension simply implement it as a Spring bean.\n+ */\n+public interface LogLevelOverrideExtension {\n+\n+  /**\n+   * How often override should be loaded and applied in minutes\n+   */\n+  int updateInterval();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkwNzYxOA=="}, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkyMDkzOA==", "bodyText": "\u0413\u043e\u0442\u043e\u0432\u043e", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460920938", "createdAt": "2020-07-27T14:14:28Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideExtension.java", "diffHunk": "@@ -0,0 +1,22 @@\n+package ru.hh.nab.starter.logging;\n+\n+import java.util.Map;\n+import java.util.concurrent.CompletableFuture;\n+\n+/**\n+ * Extension which provides ability to override static Loggers levels with dynamic ones.\n+ * To activate extension simply implement it as a Spring bean.\n+ */\n+public interface LogLevelOverrideExtension {\n+\n+  /**\n+   * How often override should be loaded and applied in minutes\n+   */\n+  int updateInterval();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkwNzYxOA=="}, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NzM1NTg2OnYy", "diffSide": "RIGHT", "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNDoxMzo1OVrOG3kXKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTowNjoxNFrOG3mwHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkyMDYxOQ==", "bodyText": "\u0430 \u0435\u0441\u043b\u0438 \u043d\u0430 \u0434\u0432\u0430 \u043c\u0435\u0442\u043e\u0434\u0430?\n\u043e\u0434\u0438\u043d \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u0442, \u0430 \u0432\u0442\u043e\u0440\u043e\u0439 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442?", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460920619", "createdAt": "2020-07-27T14:13:59Z", "author": {"login": "heruv1m"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {\n+      Thread thread = new Thread(r, LogLevelOverrideApplier.class.getSimpleName());\n+      thread.setDaemon(true);\n+      return thread;\n+    });\n+    executor.scheduleWithFixedDelay(() -> {\n+      try {\n+        applyOverrides(getOrThrow(extension.loadLogLevelOverrides()));\n+      } catch (RuntimeException e) {\n+        LOGGER.error(\"Could not apply log level overrides\", e);\n+      }\n+    }, extension.updateInterval(), extension.updateInterval(), TimeUnit.MINUTES);\n+  }\n+\n+  private void applyOverrides(Map<String, String> overrides) {\n+    Set<String> obsoleteOverrides = new HashSet<>(previousOverrides.keySet());\n+    overrides.forEach((logger, logLevel) -> {\n+      obsoleteOverrides.remove(logger);\n+      if (!logLevel.equals(previousOverrides.get(logger))) {\n+        previousOverrides.put(logger, logLevel);\n+        var initialLogLevel = initialLogLevels.get(logger);\n+        var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(logger);\n+        if (initialLogLevel == null) {\n+          initialLogLevels.put(logger, logbackLogger.getEffectiveLevel().levelStr);\n+        }\n+        logbackLogger.setLevel(Level.toLevel(logLevel));\n+      }\n+    });\n+    obsoleteOverrides.forEach(obsoleteOverrideLogger -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk1OTc3Mw==", "bodyText": "\u0420\u0430\u0437\u0431\u0438\u043b (\u0434\u0430\u0436\u0435 \u043d\u0430 \u0442\u0440\u0438, \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u0440\u0435\u0432\u0448\u0438\u0445 \u043e\u0432\u0435\u0440\u0440\u0430\u0439\u0434\u043e\u0432 \u0442\u043e\u0436\u0435 \u0432\u044b\u043d\u0435\u0441)", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r460959773", "createdAt": "2020-07-27T15:06:14Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,73 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static final Logger LOGGER = LoggerFactory.getLogger(LogLevelOverrideApplier.class);\n+\n+  private final Map<String, String> initialLogLevels = new HashMap<>();\n+  private final Map<String, String> previousOverrides = new HashMap<>();\n+\n+  public void run(LogLevelOverrideExtension extension) {\n+    var executor = newSingleThreadScheduledExecutor((Runnable r) -> {\n+      Thread thread = new Thread(r, LogLevelOverrideApplier.class.getSimpleName());\n+      thread.setDaemon(true);\n+      return thread;\n+    });\n+    executor.scheduleWithFixedDelay(() -> {\n+      try {\n+        applyOverrides(getOrThrow(extension.loadLogLevelOverrides()));\n+      } catch (RuntimeException e) {\n+        LOGGER.error(\"Could not apply log level overrides\", e);\n+      }\n+    }, extension.updateInterval(), extension.updateInterval(), TimeUnit.MINUTES);\n+  }\n+\n+  private void applyOverrides(Map<String, String> overrides) {\n+    Set<String> obsoleteOverrides = new HashSet<>(previousOverrides.keySet());\n+    overrides.forEach((logger, logLevel) -> {\n+      obsoleteOverrides.remove(logger);\n+      if (!logLevel.equals(previousOverrides.get(logger))) {\n+        previousOverrides.put(logger, logLevel);\n+        var initialLogLevel = initialLogLevels.get(logger);\n+        var logbackLogger = (ch.qos.logback.classic.Logger) LoggerFactory.getLogger(logger);\n+        if (initialLogLevel == null) {\n+          initialLogLevels.put(logger, logbackLogger.getEffectiveLevel().levelStr);\n+        }\n+        logbackLogger.setLevel(Level.toLevel(logLevel));\n+      }\n+    });\n+    obsoleteOverrides.forEach(obsoleteOverrideLogger -> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkyMDYxOQ=="}, "originalCommit": {"oid": "8cf9f6cf58964f61cdd150d0c31791c5908e6630"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Nzk1MDQxOnYy", "diffSide": "RIGHT", "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjoyNTo0MFrOG3qB-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNjo0MDoxNVrOG3qlNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAxMzQ5OA==", "bodyText": "withLogLevel", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r461013498", "createdAt": "2020-07-27T16:25:40Z", "author": {"login": "dzharikhin"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,103 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import static java.util.stream.Collectors.toMap;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static class LogInfo {\n+    private String logLevel;\n+\n+    public Optional<String> getLogLevelOptional() {\n+      return Optional.ofNullable(logLevel);\n+    }\n+\n+    public LogInfo setLogLevel(String logLevel) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4af0728b95891fff01d130bd83f490c4a8109b01"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAyMjUxNw==", "bodyText": "\u042d\u0442\u043e \u0436 \u043d\u0435 \u0431\u0438\u043b\u0434\u0435\u0440", "url": "https://github.com/hhru/nuts-and-bolts/pull/252#discussion_r461022517", "createdAt": "2020-07-27T16:40:15Z", "author": {"login": "pvorlov"}, "path": "nab-starter/src/main/java/ru/hh/nab/starter/logging/LogLevelOverrideApplier.java", "diffHunk": "@@ -0,0 +1,103 @@\n+package ru.hh.nab.starter.logging;\n+\n+import ch.qos.logback.classic.Level;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.ExecutionException;\n+import static java.util.concurrent.Executors.newSingleThreadScheduledExecutor;\n+import java.util.concurrent.TimeUnit;\n+import static java.util.stream.Collectors.toMap;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class LogLevelOverrideApplier {\n+\n+  private static class LogInfo {\n+    private String logLevel;\n+\n+    public Optional<String> getLogLevelOptional() {\n+      return Optional.ofNullable(logLevel);\n+    }\n+\n+    public LogInfo setLogLevel(String logLevel) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTAxMzQ5OA=="}, "originalCommit": {"oid": "4af0728b95891fff01d130bd83f490c4a8109b01"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4255, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}