{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyNzcxOTgx", "number": 221, "title": "Add gRPC backoff resetter", "bodyText": "This change adds an action that would reset exponential backoff regularly. (Default is every 10 seconds)\nOpt-out is possible by setting null value in the WorkflowServiceStubsOptions.connectionBackoffResetFrequency", "createdAt": "2020-09-25T00:52:44Z", "url": "https://github.com/temporalio/sdk-java/pull/221", "merged": true, "mergeCommit": {"oid": "fdae84c387deb7ee40581ed58cb9faa4d4013ff4"}, "closed": true, "closedAt": "2020-09-25T04:32:04Z", "author": {"login": "vitarb"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdMJ5gWgH2gAyNDkyNzcxOTgxOmEyYWM0YjRjMGM3YmQ2NDAwOTg5Njc0ZWI0OTBiOTJlNzkwMjE3MDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMNUpvgH2gAyNDkyNzcxOTgxOjAxODUzMjEzNjUwMjJjNjQ5OGQ4ODY4YjBmNTRhYWUzOTI1YjcwNWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a2ac4b4c0c7bd6400989674eb490b92e79021704", "author": {"user": {"login": "vitarb", "name": "Vitaly"}}, "url": "https://github.com/temporalio/sdk-java/commit/a2ac4b4c0c7bd6400989674eb490b92e79021704", "committedDate": "2020-09-24T23:36:17Z", "message": "Add gRPC backoff resetter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MDQ4MjYz", "url": "https://github.com/temporalio/sdk-java/pull/221#pullrequestreview-496048263", "createdAt": "2020-09-25T01:12:59Z", "commit": {"oid": "a2ac4b4c0c7bd6400989674eb490b92e79021704"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwMToxMzowMFrOHXxplw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwMToxNzowOFrOHXxtgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY5Mjc1OQ==", "bodyText": "Add that it can return null if reset is off", "url": "https://github.com/temporalio/sdk-java/pull/221#discussion_r494692759", "createdAt": "2020-09-25T01:13:00Z", "author": {"login": "mfateev"}, "path": "temporal-serviceclient/src/main/java/io/temporal/serviceclient/WorkflowServiceStubsOptions.java", "diffHunk": "@@ -174,6 +181,11 @@ public Duration getRpcQueryTimeout() {\n     return rpcQueryTimeout;\n   }\n \n+  /** @return frequency at which connection backoff should be reset. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2ac4b4c0c7bd6400989674eb490b92e79021704"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY5MzEzOQ==", "bodyText": "forgot setter for this property", "url": "https://github.com/temporalio/sdk-java/pull/221#discussion_r494693139", "createdAt": "2020-09-25T01:14:39Z", "author": {"login": "mfateev"}, "path": "temporal-serviceclient/src/main/java/io/temporal/serviceclient/WorkflowServiceStubsOptions.java", "diffHunk": "@@ -211,6 +223,7 @@ public Scope getMetricsScope() {\n     private Duration rpcTimeout = DEFAULT_RPC_TIMEOUT;\n     private Duration rpcLongPollTimeout = DEFAULT_POLL_RPC_TIMEOUT;\n     private Duration rpcQueryTimeout = DEFAULT_QUERY_RPC_TIMEOUT;\n+    private Duration connectionBackoffResetFrequency = DEFAULT_CONNECTION_BACKOFF_RESET_FREQUENCY;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2ac4b4c0c7bd6400989674eb490b92e79021704"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY5Mzc2MA==", "bodyText": "Change parameter type to Duration and use milliseconds when initializing executor.", "url": "https://github.com/temporalio/sdk-java/pull/221#discussion_r494693760", "createdAt": "2020-09-25T01:17:08Z", "author": {"login": "mfateev"}, "path": "temporal-serviceclient/src/main/java/io/temporal/serviceclient/WorkflowServiceStubsImpl.java", "diffHunk": "@@ -151,6 +164,23 @@ public WorkflowServiceStubsImpl(\n     log.info(String.format(\"Created GRPC client for channel: %s\", channel));\n   }\n \n+  private ScheduledExecutorService startConnectionBackoffResetter(long backoffResetFrequency) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2ac4b4c0c7bd6400989674eb490b92e79021704"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "734a6210cf1620e81a1d511dda94cff839339b4c", "author": {"user": {"login": "vitarb", "name": "Vitaly"}}, "url": "https://github.com/temporalio/sdk-java/commit/734a6210cf1620e81a1d511dda94cff839339b4c", "committedDate": "2020-09-25T02:46:31Z", "message": "CR updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05b7944f29a5153e529cbee370ad771a3dc7803a", "author": {"user": {"login": "vitarb", "name": "Vitaly"}}, "url": "https://github.com/temporalio/sdk-java/commit/05b7944f29a5153e529cbee370ad771a3dc7803a", "committedDate": "2020-09-25T02:47:21Z", "message": "formatting"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MDc1Nzk3", "url": "https://github.com/temporalio/sdk-java/pull/221#pullrequestreview-496075797", "createdAt": "2020-09-25T02:49:25Z", "commit": {"oid": "05b7944f29a5153e529cbee370ad771a3dc7803a"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwMjo0OToyNlrOHXzIXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQwMzowMTowOVrOHXzUlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDcxNzAyMw==", "bodyText": "Document default and explain that setting it to null disables the reset.", "url": "https://github.com/temporalio/sdk-java/pull/221#discussion_r494717023", "createdAt": "2020-09-25T02:49:26Z", "author": {"login": "mfateev"}, "path": "temporal-serviceclient/src/main/java/io/temporal/serviceclient/WorkflowServiceStubsOptions.java", "diffHunk": "@@ -290,6 +307,16 @@ public Builder setRpcLongPollTimeout(Duration timeout) {\n       return this;\n     }\n \n+    /**\n+     * Sets frequency at which gRPC connection backoff should be reset practically defining an upper\n+     * limit for the maximum backoff duration.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05b7944f29a5153e529cbee370ad771a3dc7803a"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDcxOTg3Ng==", "bodyText": "nit:\nreturn Executors.new....", "url": "https://github.com/temporalio/sdk-java/pull/221#discussion_r494719876", "createdAt": "2020-09-25T03:00:18Z", "author": {"login": "mfateev"}, "path": "temporal-serviceclient/src/main/java/io/temporal/serviceclient/WorkflowServiceStubsImpl.java", "diffHunk": "@@ -151,6 +164,23 @@ public WorkflowServiceStubsImpl(\n     log.info(String.format(\"Created GRPC client for channel: %s\", channel));\n   }\n \n+  private ScheduledExecutorService startConnectionBackoffResetter(Duration backoffResetFrequency) {\n+    ScheduledExecutorService executor = Executors.newSingleThreadScheduledExecutor();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05b7944f29a5153e529cbee370ad771a3dc7803a"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDcyMDE0OA==", "bodyText": "private final", "url": "https://github.com/temporalio/sdk-java/pull/221#discussion_r494720148", "createdAt": "2020-09-25T03:01:09Z", "author": {"login": "mfateev"}, "path": "temporal-serviceclient/src/main/java/io/temporal/serviceclient/WorkflowServiceStubsImpl.java", "diffHunk": "@@ -65,6 +68,7 @@\n   private final WorkflowServiceGrpc.WorkflowServiceBlockingStub blockingStub;\n   private final WorkflowServiceGrpc.WorkflowServiceFutureStub futureStub;\n   private final Server inProcessServer;\n+  private ScheduledExecutorService scheduledBackoffResetter;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05b7944f29a5153e529cbee370ad771a3dc7803a"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f92e0ffb8cfe85c559290cca7fe1ab36bc36cbda", "author": {"user": {"login": "vitarb", "name": "Vitaly"}}, "url": "https://github.com/temporalio/sdk-java/commit/f92e0ffb8cfe85c559290cca7fe1ab36bc36cbda", "committedDate": "2020-09-25T03:16:25Z", "message": "addressingCR feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2MDg0NDcw", "url": "https://github.com/temporalio/sdk-java/pull/221#pullrequestreview-496084470", "createdAt": "2020-09-25T03:18:19Z", "commit": {"oid": "f92e0ffb8cfe85c559290cca7fe1ab36bc36cbda"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0922ad997d8473a5c1f68b6bdcec30613dbcc667", "author": {"user": {"login": "vitarb", "name": "Vitaly"}}, "url": "https://github.com/temporalio/sdk-java/commit/0922ad997d8473a5c1f68b6bdcec30613dbcc667", "committedDate": "2020-09-25T03:18:29Z", "message": "formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0185321365022c6498d8868b0f54aae3925b705c", "author": {"user": {"login": "vitarb", "name": "Vitaly"}}, "url": "https://github.com/temporalio/sdk-java/commit/0185321365022c6498d8868b0f54aae3925b705c", "committedDate": "2020-09-25T03:35:39Z", "message": "return builder"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3513, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}