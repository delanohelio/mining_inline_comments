{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM0OTMyMDMy", "number": 270, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDoyNDo1NFrOFC83_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDoyNzo0NlrOFC894w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjM4ODQ1OnYy", "diffSide": "RIGHT", "path": "temporal-sdk/src/main/java/io/temporal/client/WorkflowClientOptions.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDoyNDo1NFrOICXN_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNTozMzo0M1rOIC2Rkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM0ODQ3OQ==", "bodyText": "Why not an empty string as it is now?", "url": "https://github.com/temporalio/sdk-java/pull/270#discussion_r539348479", "createdAt": "2020-12-09T14:24:54Z", "author": {"login": "mfateev"}, "path": "temporal-sdk/src/main/java/io/temporal/client/WorkflowClientOptions.java", "diffHunk": "@@ -33,6 +33,7 @@\n \n   private static final WorkflowClientOptions DEFAULT_INSTANCE;\n   private static final String DEFAULT_NAMESPACE = \"default\";\n+  private static final String DEFAULT_BINARY_CHECKSUM = \"none\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfc8104db01fed416b2162f2013ed7163eabdc0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4MzM3Mg==", "bodyText": "Having some value could potentially be useful in case when someone just added their own binary checksum and wants to roll back.\nI'm okay changing it to empty string if you prefer it.", "url": "https://github.com/temporalio/sdk-java/pull/270#discussion_r539583372", "createdAt": "2020-12-09T19:25:39Z", "author": {"login": "vitarb"}, "path": "temporal-sdk/src/main/java/io/temporal/client/WorkflowClientOptions.java", "diffHunk": "@@ -33,6 +33,7 @@\n \n   private static final WorkflowClientOptions DEFAULT_INSTANCE;\n   private static final String DEFAULT_NAMESPACE = \"default\";\n+  private static final String DEFAULT_BINARY_CHECKSUM = \"none\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM0ODQ3OQ=="}, "originalCommit": {"oid": "ddfc8104db01fed416b2162f2013ed7163eabdc0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg1NzI5OA==", "bodyText": "Done", "url": "https://github.com/temporalio/sdk-java/pull/270#discussion_r539857298", "createdAt": "2020-12-10T05:33:43Z", "author": {"login": "vitarb"}, "path": "temporal-sdk/src/main/java/io/temporal/client/WorkflowClientOptions.java", "diffHunk": "@@ -33,6 +33,7 @@\n \n   private static final WorkflowClientOptions DEFAULT_INSTANCE;\n   private static final String DEFAULT_NAMESPACE = \"default\";\n+  private static final String DEFAULT_BINARY_CHECKSUM = \"none\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM0ODQ3OQ=="}, "originalCommit": {"oid": "ddfc8104db01fed416b2162f2013ed7163eabdc0"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjM5MzkzOnYy", "diffSide": "RIGHT", "path": "temporal-sdk/src/main/java/io/temporal/internal/replay/ReplayWorkflowTaskHandler.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDoyNjowMFrOICXRZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNTozMzozMFrOIC2RRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM0OTM1MQ==", "bodyText": "I would make the default null and not call this method if it is not set.", "url": "https://github.com/temporalio/sdk-java/pull/270#discussion_r539349351", "createdAt": "2020-12-09T14:26:00Z", "author": {"login": "mfateev"}, "path": "temporal-sdk/src/main/java/io/temporal/internal/replay/ReplayWorkflowTaskHandler.java", "diffHunk": "@@ -127,6 +128,7 @@ private Result failureToResult(PollWorkflowTaskQueueResponse workflowTask, Throw\n           RespondWorkflowTaskCompletedRequest.newBuilder()\n               .setTaskToken(workflowTask.getTaskToken())\n               .setIdentity(options.getIdentity())\n+              .setBinaryChecksum(options.getBinaryChecksum())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfc8104db01fed416b2162f2013ed7163eabdc0"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTU4MjQ0NQ==", "bodyText": "I did that initially, but didn't like the extra if statement and decided to add a default.\nShould we have an empty string default instead as you've suggested above?", "url": "https://github.com/temporalio/sdk-java/pull/270#discussion_r539582445", "createdAt": "2020-12-09T19:24:16Z", "author": {"login": "vitarb"}, "path": "temporal-sdk/src/main/java/io/temporal/internal/replay/ReplayWorkflowTaskHandler.java", "diffHunk": "@@ -127,6 +128,7 @@ private Result failureToResult(PollWorkflowTaskQueueResponse workflowTask, Throw\n           RespondWorkflowTaskCompletedRequest.newBuilder()\n               .setTaskToken(workflowTask.getTaskToken())\n               .setIdentity(options.getIdentity())\n+              .setBinaryChecksum(options.getBinaryChecksum())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM0OTM1MQ=="}, "originalCommit": {"oid": "ddfc8104db01fed416b2162f2013ed7163eabdc0"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg1NzIyMA==", "bodyText": "I've changed it to empty string by default, let me know if you think that's sufficient.", "url": "https://github.com/temporalio/sdk-java/pull/270#discussion_r539857220", "createdAt": "2020-12-10T05:33:30Z", "author": {"login": "vitarb"}, "path": "temporal-sdk/src/main/java/io/temporal/internal/replay/ReplayWorkflowTaskHandler.java", "diffHunk": "@@ -127,6 +128,7 @@ private Result failureToResult(PollWorkflowTaskQueueResponse workflowTask, Throw\n           RespondWorkflowTaskCompletedRequest.newBuilder()\n               .setTaskToken(workflowTask.getTaskToken())\n               .setIdentity(options.getIdentity())\n+              .setBinaryChecksum(options.getBinaryChecksum())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM0OTM1MQ=="}, "originalCommit": {"oid": "ddfc8104db01fed416b2162f2013ed7163eabdc0"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NjQwMzU1OnYy", "diffSide": "RIGHT", "path": "temporal-sdk/src/test/java/io/temporal/worker/StickyWorkerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQxNDoyNzo0NlrOICXXHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwNTozMjo0NlrOIC2QjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM1MDgxMg==", "bodyText": "Does test verify that it was indeed added to the history?", "url": "https://github.com/temporalio/sdk-java/pull/270#discussion_r539350812", "createdAt": "2020-12-09T14:27:46Z", "author": {"login": "mfateev"}, "path": "temporal-sdk/src/test/java/io/temporal/worker/StickyWorkerTest.java", "diffHunk": "@@ -489,13 +490,18 @@ public void workflowsCanBeQueriedAfterEviction() throws Exception {\n     private TestWorkflowEnvironment testEnv;\n     private WorkerFactory factory;\n     private final String identity = UUID.randomUUID().toString();\n+    private final String binaryChecksum = UUID.randomUUID().toString();\n \n     public TestEnvironmentWrapper(WorkerFactoryOptions options) {\n       if (options == null) {\n         options = WorkerFactoryOptions.newBuilder().build();\n       }\n       WorkflowClientOptions clientOptions =\n-          WorkflowClientOptions.newBuilder().setNamespace(NAMESPACE).setIdentity(identity).build();\n+          WorkflowClientOptions.newBuilder()\n+              .setNamespace(NAMESPACE)\n+              .setIdentity(identity)\n+              .setBinaryChecksum(binaryChecksum)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ddfc8104db01fed416b2162f2013ed7163eabdc0"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg1NzAzNw==", "bodyText": "I've added a separate test for it in the WorkflowTest, this one just adds it because identity was there already.", "url": "https://github.com/temporalio/sdk-java/pull/270#discussion_r539857037", "createdAt": "2020-12-10T05:32:46Z", "author": {"login": "vitarb"}, "path": "temporal-sdk/src/test/java/io/temporal/worker/StickyWorkerTest.java", "diffHunk": "@@ -489,13 +490,18 @@ public void workflowsCanBeQueriedAfterEviction() throws Exception {\n     private TestWorkflowEnvironment testEnv;\n     private WorkerFactory factory;\n     private final String identity = UUID.randomUUID().toString();\n+    private final String binaryChecksum = UUID.randomUUID().toString();\n \n     public TestEnvironmentWrapper(WorkerFactoryOptions options) {\n       if (options == null) {\n         options = WorkerFactoryOptions.newBuilder().build();\n       }\n       WorkflowClientOptions clientOptions =\n-          WorkflowClientOptions.newBuilder().setNamespace(NAMESPACE).setIdentity(identity).build();\n+          WorkflowClientOptions.newBuilder()\n+              .setNamespace(NAMESPACE)\n+              .setIdentity(identity)\n+              .setBinaryChecksum(binaryChecksum)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM1MDgxMg=="}, "originalCommit": {"oid": "ddfc8104db01fed416b2162f2013ed7163eabdc0"}, "originalPosition": 65}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1681, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}