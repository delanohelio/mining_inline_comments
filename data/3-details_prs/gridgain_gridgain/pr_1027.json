{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MDAzODUy", "number": 1027, "title": "GG-28205 Implement of sending a snapshot informations from the grid through agent", "bodyText": "", "createdAt": "2020-04-03T07:21:56Z", "url": "https://github.com/gridgain/gridgain/pull/1027", "merged": true, "mergeCommit": {"oid": "05aa99b73b941e07968d0e824275cfde8cee0c0f"}, "closed": true, "closedAt": "2020-04-30T02:45:21Z", "author": {"login": "nva"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcT6b56gH2gAyMzk4MDAzODUyOjA0ZTA0NDgwZDRhOTRiYjIwMTRkN2ExZjBmOTI5NWZlMTQ0MjE1YzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccj3oOAH2gAyMzk4MDAzODUyOmEyMjA4MTE1M2RlZDNiYjdhNGI3MzJiYzNkN2IwNGY3YzU2ZTlkN2I=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "04e04480d4a94bb2014d7a1f0f9295fe144215c5", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/04e04480d4a94bb2014d7a1f0f9295fe144215c5", "committedDate": "2020-04-03T05:55:37Z", "message": "GG-28205 Collect and send snapshots."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MTg5MjE1", "url": "https://github.com/gridgain/gridgain/pull/1027#pullrequestreview-387189215", "createdAt": "2020-04-03T11:56:18Z", "commit": {"oid": "04e04480d4a94bb2014d7a1f0f9295fe144215c5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6625bcf9f52609b7695980e02071a822b88e5b1e", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/6625bcf9f52609b7695980e02071a822b88e5b1e", "committedDate": "2020-04-03T12:53:32Z", "message": "GG-28205 Apply suggestions from review notes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84d041c4788f9b65cd3d83c568fbb250976d4cc9", "author": {"user": null}, "url": "https://github.com/gridgain/gridgain/commit/84d041c4788f9b65cd3d83c568fbb250976d4cc9", "committedDate": "2020-04-06T14:39:11Z", "message": "GG-28205: Fix typo."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MzQwNjMy", "url": "https://github.com/gridgain/gridgain/pull/1027#pullrequestreview-389340632", "createdAt": "2020-04-07T17:33:33Z", "commit": {"oid": "84d041c4788f9b65cd3d83c568fbb250976d4cc9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNzozMzozM1rOGCOmKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNzo1MTo1MVrOGCPS1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk4OTQ4MQ==", "bodyText": "Why do we need this method? Can we replace its only usage with a constructor invocation?", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r404989481", "createdAt": "2020-04-07T17:33:33Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/agent/processor/ClusterInfoProcessor.java", "diffHunk": "@@ -129,25 +129,23 @@ void sendClusterInfo(Event evt) {\n         if (log.isDebugEnabled())\n             log.debug(\"Sending cluster info to Control Center\");\n \n-        ClusterInfo clusterInfo = createClusterInfo();\n-\n-        populateClusterInfo(clusterInfo);\n-\n-        mgr.send(buildClusterDest(cluster.id()), clusterInfo);\n+        mgr.send(buildClusterDest(cluster.id()), buildClusterInfo());\n     }\n \n     /**\n      * @return Create cluster info.\n      */\n     protected ClusterInfo createClusterInfo() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84d041c4788f9b65cd3d83c568fbb250976d4cc9"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk5MzM5Mg==", "bodyText": "Unchecked cast warning. Add @SuppressWarnings(\"unchecked\") if you are sure about this.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r404993392", "createdAt": "2020-04-07T17:39:47Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/agent/utils/AgentUtils.java", "diffHunk": "@@ -226,6 +226,45 @@ public static void quiteStop(GridProcessor proc) {\n         }\n     }\n \n+    /**\n+     * Creates agent processor.\n+     *\n+     * @param clsName Processor class name.\n+     * @param paramTypes The parameter array.\n+     * @param args array of objects to be passed as arguments to the constructor call.\n+     * @return Agent processor.\n+     */\n+    public static <T extends GridProcessor> T createProcessor(String clsName, Class<?>[] paramTypes, Object... args) {\n+        ClassLoader ldr = U.gridClassLoader();\n+\n+        try {\n+            Class<?> mgrCls = ldr.loadClass(clsName);\n+\n+            return (T)mgrCls.getConstructor(paramTypes).newInstance(args);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84d041c4788f9b65cd3d83c568fbb250976d4cc9"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk5NjY1NA==", "bodyText": "Such exception handling is evil. With such approach you will miss a failure to instantiate a component. Failures to execute commands will follow, but you won't notice the root cause. You should at least log an error message here.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r404996654", "createdAt": "2020-04-07T17:44:58Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/agent/utils/AgentUtils.java", "diffHunk": "@@ -226,6 +226,45 @@ public static void quiteStop(GridProcessor proc) {\n         }\n     }\n \n+    /**\n+     * Creates agent processor.\n+     *\n+     * @param clsName Processor class name.\n+     * @param paramTypes The parameter array.\n+     * @param args array of objects to be passed as arguments to the constructor call.\n+     * @return Agent processor.\n+     */\n+    public static <T extends GridProcessor> T createProcessor(String clsName, Class<?>[] paramTypes, Object... args) {\n+        ClassLoader ldr = U.gridClassLoader();\n+\n+        try {\n+            Class<?> mgrCls = ldr.loadClass(clsName);\n+\n+            return (T)mgrCls.getConstructor(paramTypes).newInstance(args);\n+        }\n+        catch (Exception ignored) {\n+            // No-op.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84d041c4788f9b65cd3d83c568fbb250976d4cc9"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk5NzY3Ng==", "bodyText": "I don't think we should ever start quietly. Issues during processor's initialization are quite important to register.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r404997676", "createdAt": "2020-04-07T17:46:41Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/agent/utils/AgentUtils.java", "diffHunk": "@@ -226,6 +226,45 @@ public static void quiteStop(GridProcessor proc) {\n         }\n     }\n \n+    /**\n+     * Creates agent processor.\n+     *\n+     * @param clsName Processor class name.\n+     * @param paramTypes The parameter array.\n+     * @param args array of objects to be passed as arguments to the constructor call.\n+     * @return Agent processor.\n+     */\n+    public static <T extends GridProcessor> T createProcessor(String clsName, Class<?>[] paramTypes, Object... args) {\n+        ClassLoader ldr = U.gridClassLoader();\n+\n+        try {\n+            Class<?> mgrCls = ldr.loadClass(clsName);\n+\n+            return (T)mgrCls.getConstructor(paramTypes).newInstance(args);\n+        }\n+        catch (Exception ignored) {\n+            // No-op.\n+        }\n+\n+        return null;\n+    }\n+\n+    /**\n+     * Quietly start given processor ignoring possible checked exception.\n+     *\n+     * @param proc Processor.\n+     */\n+    public static void quietStart(GridProcessor proc) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84d041c4788f9b65cd3d83c568fbb250976d4cc9"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAwMDkxNg==", "bodyText": "What is the logic behind this rearrangement?", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r405000916", "createdAt": "2020-04-07T17:51:51Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/agent/ManagementConsoleAgent.java", "diffHunk": "@@ -87,17 +87,20 @@\n     /** Discovery event on restart agent. */\n     private static final int[] EVTS_DISCOVERY = new int[] {EVT_NODE_FAILED, EVT_NODE_LEFT, EVT_NODE_SEGMENTED};\n \n-    /** Management configuration instance. */\n-    private ManagementConfiguration cfg = new ManagementConfiguration();\n-\n     /** Websocket manager. */\n     protected WebSocketManager mgr;\n \n     /** Cluster processor. */\n-    private ClusterInfoProcessor clusterProc;\n+    protected ClusterInfoProcessor clusterProc;\n \n-    /** Span exporter. */\n-    private SpanExporter spanExporter;\n+    /** Actions dispatcher. */\n+    private ActionDispatcher actDispatcher;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84d041c4788f9b65cd3d83c568fbb250976d4cc9"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36466197cfe98fe71466017d4e4f514daba6cf23", "author": {"user": null}, "url": "https://github.com/gridgain/gridgain/commit/36466197cfe98fe71466017d4e4f514daba6cf23", "committedDate": "2020-04-08T12:42:52Z", "message": "GG-28205: Fix tests and licence."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36d7d137c7dec7f50977680d2af81e023d437bd0", "author": {"user": null}, "url": "https://github.com/gridgain/gridgain/commit/36d7d137c7dec7f50977680d2af81e023d437bd0", "committedDate": "2020-04-08T14:02:19Z", "message": "GG-28205: Review fixes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d76d167d1adfba30f1d421abbbca53c9358de8f3", "author": {"user": null}, "url": "https://github.com/gridgain/gridgain/commit/d76d167d1adfba30f1d421abbbca53c9358de8f3", "committedDate": "2020-04-08T14:04:23Z", "message": "GG-28205: Review fixes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6747784310216d514f4b7d91a8706e8891848689", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/6747784310216d514f4b7d91a8706e8891848689", "committedDate": "2020-04-20T04:02:55Z", "message": "Merge branches '8.7-master' and 'gg-28205' of https://github.com/gridgain/gridgain into gg-28205\n\n\u0001 Conflicts:\n\u0001\tmodules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/ManagementConsoleAgent.java\n\u0001\tmodules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/processor/ManagementConsoleMessagesProcessor.java\n\u0001\tmodules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/utils/AgentUtils.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f3290fd791bb8ecc1ac9df02828a8b415fb4fa3", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/2f3290fd791bb8ecc1ac9df02828a8b415fb4fa3", "committedDate": "2020-04-20T06:36:18Z", "message": "GG-28205 Revert unneeded changes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/d84a7c05fd577ed3ac9736b345ac02f04605c313", "committedDate": "2020-04-20T06:55:06Z", "message": "GG-28205 Improve log message."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MzIxNDI2", "url": "https://github.com/gridgain/gridgain/pull/1027#pullrequestreview-396321426", "createdAt": "2020-04-20T10:14:54Z", "commit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDoxNDo1NFrOGINUeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDoyMToxN1rOGINjzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI2MDAyNQ==", "bodyText": "It doesn't do it quietly.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r411260025", "createdAt": "2020-04-20T10:14:54Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/utils/AgentUtils.java", "diffHunk": "@@ -214,14 +215,56 @@ public static void authorizeIfNeeded(IgniteSecurity security, String name, Secur\n      * Quietly closes given processor ignoring possible checked exception.\n      *\n      * @param proc Process.\n+     * @param log Logger.\n      */\n-    public static void quiteStop(GridProcessor proc) {\n+    public static void stopProcessor(GridProcessor proc, IgniteLogger log) {\n         if (proc != null) {\n             try {\n                 proc.stop(true);\n             }\n-            catch (Exception ignored) {\n-                // No-op.\n+            catch (Exception ex) {\n+                U.warn(log, ex.getMessage(), ex);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Creates agent processor.\n+     *\n+     * @param log Logger.\n+     * @param clsName Processor class name.\n+     * @param paramTypes The parameter array.\n+     * @param args array of objects to be passed as arguments to the constructor call.\n+     * @return Agent processor.\n+     */\n+    public static <T extends GridProcessor> T createProcessor(IgniteLogger log, String clsName, Class<?>[] paramTypes, Object... args) {\n+        ClassLoader ldr = U.gridClassLoader();\n+\n+        try {\n+            Class<?> mgrCls = ldr.loadClass(clsName);\n+\n+            return (T)mgrCls.getConstructor(paramTypes).newInstance(args);\n+        }\n+        catch (Exception ex) {\n+            U.warn(log, \"Failed to initialize GridGain Control Center agent processor: \" + clsName, ex);\n+        }\n+\n+        return null;\n+    }\n+\n+    /**\n+     * Quietly start given processor ignoring possible checked exception.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI2MDI3MA==", "bodyText": "Impossibility to start a processor sounds more like an ERROR to me.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r411260270", "createdAt": "2020-04-20T10:15:21Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/utils/AgentUtils.java", "diffHunk": "@@ -214,14 +215,56 @@ public static void authorizeIfNeeded(IgniteSecurity security, String name, Secur\n      * Quietly closes given processor ignoring possible checked exception.\n      *\n      * @param proc Process.\n+     * @param log Logger.\n      */\n-    public static void quiteStop(GridProcessor proc) {\n+    public static void stopProcessor(GridProcessor proc, IgniteLogger log) {\n         if (proc != null) {\n             try {\n                 proc.stop(true);\n             }\n-            catch (Exception ignored) {\n-                // No-op.\n+            catch (Exception ex) {\n+                U.warn(log, ex.getMessage(), ex);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Creates agent processor.\n+     *\n+     * @param log Logger.\n+     * @param clsName Processor class name.\n+     * @param paramTypes The parameter array.\n+     * @param args array of objects to be passed as arguments to the constructor call.\n+     * @return Agent processor.\n+     */\n+    public static <T extends GridProcessor> T createProcessor(IgniteLogger log, String clsName, Class<?>[] paramTypes, Object... args) {\n+        ClassLoader ldr = U.gridClassLoader();\n+\n+        try {\n+            Class<?> mgrCls = ldr.loadClass(clsName);\n+\n+            return (T)mgrCls.getConstructor(paramTypes).newInstance(args);\n+        }\n+        catch (Exception ex) {\n+            U.warn(log, \"Failed to initialize GridGain Control Center agent processor: \" + clsName, ex);\n+        }\n+\n+        return null;\n+    }\n+\n+    /**\n+     * Quietly start given processor ignoring possible checked exception.\n+     *\n+     * @param proc Processor.\n+     * @param log Logger.\n+     */\n+    public static void startProcessor(GridProcessor proc, IgniteLogger log) {\n+        if (proc != null) {\n+            try {\n+                proc.start();\n+            }\n+            catch (Exception ex) {\n+                U.warn(log, ex.getMessage(), ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI2MDQyMQ==", "bodyText": "Also some message would be nice.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r411260421", "createdAt": "2020-04-20T10:15:36Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/utils/AgentUtils.java", "diffHunk": "@@ -214,14 +215,56 @@ public static void authorizeIfNeeded(IgniteSecurity security, String name, Secur\n      * Quietly closes given processor ignoring possible checked exception.\n      *\n      * @param proc Process.\n+     * @param log Logger.\n      */\n-    public static void quiteStop(GridProcessor proc) {\n+    public static void stopProcessor(GridProcessor proc, IgniteLogger log) {\n         if (proc != null) {\n             try {\n                 proc.stop(true);\n             }\n-            catch (Exception ignored) {\n-                // No-op.\n+            catch (Exception ex) {\n+                U.warn(log, ex.getMessage(), ex);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Creates agent processor.\n+     *\n+     * @param log Logger.\n+     * @param clsName Processor class name.\n+     * @param paramTypes The parameter array.\n+     * @param args array of objects to be passed as arguments to the constructor call.\n+     * @return Agent processor.\n+     */\n+    public static <T extends GridProcessor> T createProcessor(IgniteLogger log, String clsName, Class<?>[] paramTypes, Object... args) {\n+        ClassLoader ldr = U.gridClassLoader();\n+\n+        try {\n+            Class<?> mgrCls = ldr.loadClass(clsName);\n+\n+            return (T)mgrCls.getConstructor(paramTypes).newInstance(args);\n+        }\n+        catch (Exception ex) {\n+            U.warn(log, \"Failed to initialize GridGain Control Center agent processor: \" + clsName, ex);\n+        }\n+\n+        return null;\n+    }\n+\n+    /**\n+     * Quietly start given processor ignoring possible checked exception.\n+     *\n+     * @param proc Processor.\n+     * @param log Logger.\n+     */\n+    public static void startProcessor(GridProcessor proc, IgniteLogger log) {\n+        if (proc != null) {\n+            try {\n+                proc.start();\n+            }\n+            catch (Exception ex) {\n+                U.warn(log, ex.getMessage(), ex);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI2MDI3MA=="}, "originalCommit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI2MDYwNg==", "bodyText": "Looks more like an ERROR.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r411260606", "createdAt": "2020-04-20T10:15:57Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/utils/AgentUtils.java", "diffHunk": "@@ -214,14 +215,56 @@ public static void authorizeIfNeeded(IgniteSecurity security, String name, Secur\n      * Quietly closes given processor ignoring possible checked exception.\n      *\n      * @param proc Process.\n+     * @param log Logger.\n      */\n-    public static void quiteStop(GridProcessor proc) {\n+    public static void stopProcessor(GridProcessor proc, IgniteLogger log) {\n         if (proc != null) {\n             try {\n                 proc.stop(true);\n             }\n-            catch (Exception ignored) {\n-                // No-op.\n+            catch (Exception ex) {\n+                U.warn(log, ex.getMessage(), ex);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Creates agent processor.\n+     *\n+     * @param log Logger.\n+     * @param clsName Processor class name.\n+     * @param paramTypes The parameter array.\n+     * @param args array of objects to be passed as arguments to the constructor call.\n+     * @return Agent processor.\n+     */\n+    public static <T extends GridProcessor> T createProcessor(IgniteLogger log, String clsName, Class<?>[] paramTypes, Object... args) {\n+        ClassLoader ldr = U.gridClassLoader();\n+\n+        try {\n+            Class<?> mgrCls = ldr.loadClass(clsName);\n+\n+            return (T)mgrCls.getConstructor(paramTypes).newInstance(args);\n+        }\n+        catch (Exception ex) {\n+            U.warn(log, \"Failed to initialize GridGain Control Center agent processor: \" + clsName, ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI2MTYwNQ==", "bodyText": "I would say, that errors reported during stopping are not that critical. I would change the logging level to DEBUG. What do you think?", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r411261605", "createdAt": "2020-04-20T10:17:31Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/utils/AgentUtils.java", "diffHunk": "@@ -214,14 +215,56 @@ public static void authorizeIfNeeded(IgniteSecurity security, String name, Secur\n      * Quietly closes given processor ignoring possible checked exception.\n      *\n      * @param proc Process.\n+     * @param log Logger.\n      */\n-    public static void quiteStop(GridProcessor proc) {\n+    public static void stopProcessor(GridProcessor proc, IgniteLogger log) {\n         if (proc != null) {\n             try {\n                 proc.stop(true);\n             }\n-            catch (Exception ignored) {\n-                // No-op.\n+            catch (Exception ex) {\n+                U.warn(log, ex.getMessage(), ex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI2Mzk0OQ==", "bodyText": "Could you clarify in the javadoc, what this interface is for. Where is it supposed to be used?", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r411263949", "createdAt": "2020-04-20T10:21:17Z", "author": {"login": "dmekhanikov"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/management/ManagementConsoleSender.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Copyright 2019 GridGain Systems, Inc. and Contributors.\n+ *\n+ * Licensed under the GridGain Community Edition License (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     https://www.gridgain.com/products/software/community-edition/gridgain-community-edition-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.ignite.internal.processors.management;\n+\n+/**\n+ * Control Center sender.\n+ */\n+public interface ManagementConsoleSender {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2MzMxODY5", "url": "https://github.com/gridgain/gridgain/pull/1027#pullrequestreview-396331869", "createdAt": "2020-04-20T10:30:54Z", "commit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDozMDo1NFrOGIN6GA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxMDozMDo1NFrOGIN6GA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTI2OTY1Ng==", "bodyText": "It doesn't do it quietly.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r411269656", "createdAt": "2020-04-20T10:30:54Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/utils/AgentUtils.java", "diffHunk": "@@ -214,14 +215,56 @@ public static void authorizeIfNeeded(IgniteSecurity security, String name, Secur\n      * Quietly closes given processor ignoring possible checked exception.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d84a7c05fd577ed3ac9736b345ac02f04605c313"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6db3c09535b0d09e1f52dc12474ade525e002a3", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/b6db3c09535b0d09e1f52dc12474ade525e002a3", "committedDate": "2020-04-21T03:09:29Z", "message": "GG-28205 Revert changes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e076b3d308551e33738afe3c92704c11eb335628", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/e076b3d308551e33738afe3c92704c11eb335628", "committedDate": "2020-04-21T04:22:33Z", "message": "GG-28205 Apply suggestions from review notes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e5b39b4686b27e9af3468a15e138b0da7b1b6f7", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/6e5b39b4686b27e9af3468a15e138b0da7b1b6f7", "committedDate": "2020-04-21T04:55:11Z", "message": "GG-28205 Use interface instead of implementation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6d601ec515b0624c3e3f63ee54b94609f436c91", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/b6d601ec515b0624c3e3f63ee54b94609f436c91", "committedDate": "2020-04-21T05:04:49Z", "message": "Merge branches '8.7-master' and 'gg-28205' of https://github.com/gridgain/gridgain into gg-28205"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NDkxMTIy", "url": "https://github.com/gridgain/gridgain/pull/1027#pullrequestreview-397491122", "createdAt": "2020-04-21T16:52:34Z", "commit": {"oid": "b6d601ec515b0624c3e3f63ee54b94609f436c91"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNjo1MjozNFrOGJOQ2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNzowMzoyMFrOGJOxtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMyNDA1OA==", "bodyText": "As I remember there was a message from Goncharuk, that we start using 2020 instead of 2019 in Copyrights, please investigate and fix if needed.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r412324058", "createdAt": "2020-04-21T16:52:34Z", "author": {"login": "akuznetsov-gridgain"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/management/ControlCenterSender.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Copyright 2019 GridGain Systems, Inc. and Contributors.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6d601ec515b0624c3e3f63ee54b94609f436c91"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMzMjQ3MQ==", "bodyText": "Lets use static import for StandardCharsets.UTF_8 ?", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r412332471", "createdAt": "2020-04-21T17:03:20Z", "author": {"login": "akuznetsov-gridgain"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/ws/WebSocketManager.java", "diffHunk": "@@ -336,7 +331,7 @@ private void addAuthentication(ClientManager mgr) {\n             Map<String, String> proxyHeaders = new HashMap<>();\n \n             proxyHeaders.put(\"Proxy-Authorization\", \"Basic \" +\n-                encodeToString((user + ':' + pwd).getBytes(Charset.forName(\"UTF-8\"))));\n+                encodeToString((user + ':' + pwd).getBytes(StandardCharsets.UTF_8)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6d601ec515b0624c3e3f63ee54b94609f436c91"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1941657c366680d1839d62339cc4ed9e0a8f2c44", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/1941657c366680d1839d62339cc4ed9e0a8f2c44", "committedDate": "2020-04-22T02:52:08Z", "message": "Merge branches '8.7-master' and 'gg-28205' of https://github.com/gridgain/gridgain into gg-28205"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bce203325e07ed94b7ff7fc2795461b7788be1e", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/1bce203325e07ed94b7ff7fc2795461b7788be1e", "committedDate": "2020-04-22T02:58:10Z", "message": "GG-28205 Apply suggestions from review notes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3ODMxNDYw", "url": "https://github.com/gridgain/gridgain/pull/1027#pullrequestreview-397831460", "createdAt": "2020-04-22T04:15:58Z", "commit": {"oid": "1bce203325e07ed94b7ff7fc2795461b7788be1e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4MDE1Mzcw", "url": "https://github.com/gridgain/gridgain/pull/1027#pullrequestreview-398015370", "createdAt": "2020-04-22T09:36:36Z", "commit": {"oid": "b6d601ec515b0624c3e3f63ee54b94609f436c91"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwOTo0MDoyMlrOGJtOKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwOTo0MzowN1rOGJtVfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjgzMTI3NQ==", "bodyText": "Please clarify, that this sender is responsible for communication with the backend.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r412831275", "createdAt": "2020-04-22T09:40:22Z", "author": {"login": "dmekhanikov"}, "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/management/ManagementConsoleProcessor.java", "diffHunk": "@@ -35,4 +35,9 @@\n      * @return Management configuration instance.\n      */\n     public ManagementConfiguration configuration();\n+\n+    /**\n+     * @return Control Center sender.\n+     */\n+    public ControlCenterSender sender();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1bce203325e07ed94b7ff7fc2795461b7788be1e"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjgzMzE0OQ==", "bodyText": "The javadoc is wrong.", "url": "https://github.com/gridgain/gridgain/pull/1027#discussion_r412833149", "createdAt": "2020-04-22T09:43:07Z", "author": {"login": "dmekhanikov"}, "path": "modules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/processor/ClusterInfoProcessor.java", "diffHunk": "@@ -65,18 +65,18 @@\n     protected IgniteClusterEx cluster;\n \n     /** Manager. */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1bce203325e07ed94b7ff7fc2795461b7788be1e"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e38c279af9c1e99a2fb5a0651068650b3b9dbe1", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/3e38c279af9c1e99a2fb5a0651068650b3b9dbe1", "committedDate": "2020-04-22T11:34:24Z", "message": "GG-28205 Apply suggestions from review notes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18cee515dc3461481d3fe0075c1196510600ebe5", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/18cee515dc3461481d3fe0075c1196510600ebe5", "committedDate": "2020-04-23T03:38:54Z", "message": "Merge branches '8.7-master' and 'gg-28205' of https://github.com/gridgain/gridgain into gg-28205"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4561239eefa8c496cb5252d4d1c02e89712e4a0", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/f4561239eefa8c496cb5252d4d1c02e89712e4a0", "committedDate": "2020-04-23T08:59:02Z", "message": "Merge branches '8.7-master' and 'gg-28205' of https://github.com/gridgain/gridgain into gg-28205"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f4da68f310454b6a8a1745c283a918b59f7aa37", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/5f4da68f310454b6a8a1745c283a918b59f7aa37", "committedDate": "2020-04-24T03:14:15Z", "message": "Merge branches '8.7-master' and 'gg-28205' of https://github.com/gridgain/gridgain into gg-28205"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f05386cab8c3bc4d63ca241d8260f623d601c260", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/f05386cab8c3bc4d63ca241d8260f623d601c260", "committedDate": "2020-04-27T02:20:48Z", "message": "Merge branches '8.7-master' and 'gg-28205' of https://github.com/gridgain/gridgain into gg-28205"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "412632e81c62380c277fb828e2a5f9d608ed8b01", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/412632e81c62380c277fb828e2a5f9d608ed8b01", "committedDate": "2020-04-28T02:23:48Z", "message": "Merge branches '8.7-master' and 'gg-28205' of https://github.com/gridgain/gridgain into gg-28205\n\n\u0001 Conflicts:\n\u0001\tmodules/management-console-agent/src/main/java/org/apache/ignite/internal/agent/processor/ClusterInfoProcessor.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a22081153ded3bb7a4b732bc3d7b04f7c56e9d7b", "author": {"user": {"login": "nva", "name": "Andrey Novikov"}}, "url": "https://github.com/gridgain/gridgain/commit/a22081153ded3bb7a4b732bc3d7b04f7c56e9d7b", "committedDate": "2020-04-30T02:43:24Z", "message": "Merge branch '8.7-master' of https://github.com/gridgain/gridgain into gg-28205"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4252, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}