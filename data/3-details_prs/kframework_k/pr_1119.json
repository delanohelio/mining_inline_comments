{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5Njk5NzY2", "number": 1119, "title": "fix bug in AddEmptyLists where lub sort cannot be determined", "bodyText": "Previously we were getting an error in certain sort graphs saying that the least upper bound sort could not be determined, even though only one lub sort could actually appear in that location based on its expected sort. Here we correctly filter the lub by the expected sort, which we were not previously doing.", "createdAt": "2020-02-25T17:03:55Z", "url": "https://github.com/kframework/k/pull/1119", "merged": true, "mergeCommit": {"oid": "01ac98bdca31940f0e7d5c4c53a09b6e65383cf8"}, "closed": true, "closedAt": "2020-02-26T20:50:40Z", "author": {"login": "dwightguth"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcH0lcjgH2gAyMzc5Njk5NzY2OmNmNmQyMjNlNDVjNDg0ODc4MjdhNjQ0MDExMWE3MmE4NzJjZTI5ZDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIMRLZAH2gAyMzc5Njk5NzY2OjA5NTgxNjBmNzAxNjRkODkyZGYyM2IxNjgxN2IwOTM4ZmE3YzE0MDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cf6d223e45c48487827a6440111a72a872ce29d1", "author": {"user": {"login": "dwightguth", "name": "Dwight Guth"}}, "url": "https://github.com/kframework/k/commit/cf6d223e45c48487827a6440111a72a872ce29d1", "committedDate": "2020-02-25T16:19:31Z", "message": "add test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dee1ebfe39910137ce806cb2df109e90967d9690", "author": {"user": {"login": "dwightguth", "name": "Dwight Guth"}}, "url": "https://github.com/kframework/k/commit/dee1ebfe39910137ce806cb2df109e90967d9690", "committedDate": "2020-02-25T17:02:08Z", "message": "fix bug in AddEmptyLists where lub sort cannot be determined"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f597c9150c776d64821709f553daefee53c7b47e", "author": {"user": {"login": "dwightguth", "name": "Dwight Guth"}}, "url": "https://github.com/kframework/k/commit/f597c9150c776d64821709f553daefee53c7b47e", "committedDate": "2020-02-25T17:48:26Z", "message": "expected sort of KSequence is K on rhs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83d7d997561bfa5e710dd526ab2acb7eee511a85", "author": {"user": {"login": "dwightguth", "name": "Dwight Guth"}}, "url": "https://github.com/kframework/k/commit/83d7d997561bfa5e710dd526ab2acb7eee511a85", "committedDate": "2020-02-25T17:52:44Z", "message": "add another test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fbab1bb4ea41a9c625b98acad8330e294383d53", "author": {"user": {"login": "dwightguth", "name": "Dwight Guth"}}, "url": "https://github.com/kframework/k/commit/7fbab1bb4ea41a9c625b98acad8330e294383d53", "committedDate": "2020-02-25T17:52:51Z", "message": "fix case when parametric production appears on rhs under KSequence\n\nAnother issue with sort inference that was discovered when we started\nfiltering by the expected sort when computing the LUB sort was that we\nwere not setting the correct expected sort for children of KSequence\non the RHS. On the lhs, KSequence children have an expected sort of\nKItem because they have to match on a cons list, however, because of the\ncons list append operation, children on the rhs can be of sort K. This\nwas causing an error where we filtered out all possible sorts and were\nunable to assign a sort to parametric productions that appeared under a\nKSequence on the RHS. Now we correctly assign sort K in these cases."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0Mzg3NDQz", "url": "https://github.com/kframework/k/pull/1119#pullrequestreview-364387443", "createdAt": "2020-02-25T19:28:21Z", "commit": {"oid": "7fbab1bb4ea41a9c625b98acad8330e294383d53"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "635af3afa527fee289ca302ca9949f880376c288", "author": {"user": {"login": "rv-jenkins", "name": null}}, "url": "https://github.com/kframework/k/commit/635af3afa527fee289ca302ca9949f880376c288", "committedDate": "2020-02-25T20:50:54Z", "message": "Merge branch 'master' into lub"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NDM2ODk3", "url": "https://github.com/kframework/k/pull/1119#pullrequestreview-364436897", "createdAt": "2020-02-25T20:48:41Z", "commit": {"oid": "7fbab1bb4ea41a9c625b98acad8330e294383d53"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMDo0ODo0MVrOFuUq-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMDo1Mjo0NlrOFuUyJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDExNzQ5Nw==", "bodyText": "I guess the rewrite sort here is IntPtr?", "url": "https://github.com/kframework/k/pull/1119#discussion_r384117497", "createdAt": "2020-02-25T20:48:41Z", "author": {"login": "radumereuta"}, "path": "k-distribution/tests/regression-new/lub/test.k", "diffHunk": "@@ -0,0 +1,15 @@\n+module TEST\n+  imports DOMAINS\n+\n+  syntax IntPtr ::= PtrValue\n+  syntax PtrValue ::= SymLoc\n+  syntax SymLoc\n+  syntax IntPtr ::= EncodedPtr\n+  syntax BitValue ::= EncodedPtr\n+  syntax Encodable ::= PtrValue\n+  syntax BitValueOrEncodable ::= BitValue | Encodable\n+\n+  syntax EncodedPtr ::= encodedPtr(PtrValue)\n+  syntax Bool ::= sameBase(IntPtr, IntPtr) [function]\n+  rule sameBase(_, (encodedPtr(S:SymLoc) => S))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7fbab1bb4ea41a9c625b98acad8330e294383d53"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDExOTMzMw==", "bodyText": "The name of this function looks funny to me. Could you at least add some documentation?", "url": "https://github.com/kframework/k/pull/1119#discussion_r384119333", "createdAt": "2020-02-25T20:52:46Z", "author": {"login": "radumereuta"}, "path": "kernel/src/main/java/org/kframework/parser/concrete2kore/disambiguation/AddEmptyLists.java", "diffHunk": "@@ -63,6 +63,24 @@ public AddEmptyLists(Module m, Sort expectedSort) {\n         this.expectedSort = expectedSort;\n     }\n \n+    private Tuple2<Either<Set<KEMException>, Term>, Set<KEMException>> superApply(TermCons tc) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "635af3afa527fee289ca302ca9949f880376c288"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "630faffc9731e92f414087fcd7ef935c6f4ed9ba", "author": {"user": {"login": "dwightguth", "name": "Dwight Guth"}}, "url": "https://github.com/kframework/k/commit/630faffc9731e92f414087fcd7ef935c6f4ed9ba", "committedDate": "2020-02-26T19:00:44Z", "message": "add comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0958160f70164d892df23b16817b0938fa7c1409", "author": {"user": {"login": "radumereuta", "name": "Radu Mereuta"}}, "url": "https://github.com/kframework/k/commit/0958160f70164d892df23b16817b0938fa7c1409", "committedDate": "2020-02-26T19:55:06Z", "message": "Merge branch 'master' into lub"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2434, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}