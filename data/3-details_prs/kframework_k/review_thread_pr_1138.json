{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyOTMwODE5", "number": 1138, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNzoxMjo1MVrODkve8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNzoyMTozMVrODkvrWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5ODUzMjk3OnYy", "diffSide": "RIGHT", "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNzoxMjo1MVrOFxO7pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNzoxMjo1MVrOFxO7pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE2OTE5MA==", "bodyText": "KompileOptions should be taken from original CompiledDefinition.", "url": "https://github.com/kframework/k/pull/1138#discussion_r387169190", "createdAt": "2020-03-03T17:12:51Z", "author": {"login": "denis-bogdanas"}, "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "diffHunk": "@@ -55,6 +62,19 @@ public int run() {\n \n         Tuple2<Definition, Module> compiled = proofDefinitionBuilder\n                 .build(kproveOptions.specFile(files), kproveOptions.defModule, kproveOptions.specModule);\n+\n+        // Saving compiled definition to disk to be usable by other tools (e.g., kast)\n+        CompiledDefinition compiledDefinition = new CompiledDefinition(\n+                new KompileOptions(), compiled._1(), compiled._1(), files, kem, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe5e902818bc2749aa184ba60edeb16d98341c1"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5ODU0NzY1OnYy", "diffSide": "RIGHT", "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNzoxNjozN1rOFxPEuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNzoxNjozN1rOFxPEuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE3MTUxNQ==", "bodyText": "this code should be separated to a method.", "url": "https://github.com/kframework/k/pull/1138#discussion_r387171515", "createdAt": "2020-03-03T17:16:37Z", "author": {"login": "denis-bogdanas"}, "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "diffHunk": "@@ -55,6 +62,19 @@ public int run() {\n \n         Tuple2<Definition, Module> compiled = proofDefinitionBuilder\n                 .build(kproveOptions.specFile(files), kproveOptions.defModule, kproveOptions.specModule);\n+\n+        // Saving compiled definition to disk to be usable by other tools (e.g., kast)\n+        CompiledDefinition compiledDefinition = new CompiledDefinition(\n+                new KompileOptions(), compiled._1(), compiled._1(), files, kem, null);\n+        Path proveKompiledDir = files.resolveTemp(\"prove-spec-kompiled\").toPath();\n+        try {\n+            Files.createDirectory(proveKompiledDir);\n+            loader.saveOrDie(proveKompiledDir.resolve(\"compiled.bin\").toFile(), compiledDefinition);\n+        } catch (IOException e) {\n+            kem.registerCriticalWarning(\n+                    \"Could not create prove-spec-kompiled directory. Definition will not be saved.\", e);\n+        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe5e902818bc2749aa184ba60edeb16d98341c1"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5ODU2NDc0OnYy", "diffSide": "RIGHT", "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNzoyMTozMVrOFxPPgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNzoyODoyNVrOFxPe9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE3NDI3NA==", "bodyText": "It will be useful to log the directory, because I expect there will be multiple dirs there with similar names.", "url": "https://github.com/kframework/k/pull/1138#discussion_r387174274", "createdAt": "2020-03-03T17:21:31Z", "author": {"login": "denis-bogdanas"}, "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "diffHunk": "@@ -55,6 +62,19 @@ public int run() {\n \n         Tuple2<Definition, Module> compiled = proofDefinitionBuilder\n                 .build(kproveOptions.specFile(files), kproveOptions.defModule, kproveOptions.specModule);\n+\n+        // Saving compiled definition to disk to be usable by other tools (e.g., kast)\n+        CompiledDefinition compiledDefinition = new CompiledDefinition(\n+                new KompileOptions(), compiled._1(), compiled._1(), files, kem, null);\n+        Path proveKompiledDir = files.resolveTemp(\"prove-spec-kompiled\").toPath();\n+        try {\n+            Files.createDirectory(proveKompiledDir);\n+            loader.saveOrDie(proveKompiledDir.resolve(\"compiled.bin\").toFile(), compiledDefinition);\n+        } catch (IOException e) {\n+            kem.registerCriticalWarning(\n+                    \"Could not create prove-spec-kompiled directory. Definition will not be saved.\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abe5e902818bc2749aa184ba60edeb16d98341c1"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE3ODIyOA==", "bodyText": "if this directory is not writeable it's probably better to raise an error instead of a warning.", "url": "https://github.com/kframework/k/pull/1138#discussion_r387178228", "createdAt": "2020-03-03T17:28:25Z", "author": {"login": "dwightguth"}, "path": "kernel/src/main/java/org/kframework/kprove/KProve.java", "diffHunk": "@@ -55,6 +62,19 @@ public int run() {\n \n         Tuple2<Definition, Module> compiled = proofDefinitionBuilder\n                 .build(kproveOptions.specFile(files), kproveOptions.defModule, kproveOptions.specModule);\n+\n+        // Saving compiled definition to disk to be usable by other tools (e.g., kast)\n+        CompiledDefinition compiledDefinition = new CompiledDefinition(\n+                new KompileOptions(), compiled._1(), compiled._1(), files, kem, null);\n+        Path proveKompiledDir = files.resolveTemp(\"prove-spec-kompiled\").toPath();\n+        try {\n+            Files.createDirectory(proveKompiledDir);\n+            loader.saveOrDie(proveKompiledDir.resolve(\"compiled.bin\").toFile(), compiledDefinition);\n+        } catch (IOException e) {\n+            kem.registerCriticalWarning(\n+                    \"Could not create prove-spec-kompiled directory. Definition will not be saved.\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE3NDI3NA=="}, "originalCommit": {"oid": "abe5e902818bc2749aa184ba60edeb16d98341c1"}, "originalPosition": 57}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3101, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}