{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5NTYwNDcw", "number": 1411, "title": "Added nullness annotations to 'ScriptExtensionProvider'", "bodyText": "Added nullness annotations to ScriptExtensionProvider\n\nMy pending review for #1264 ... and more.\nSigned-off-by: Christoph Weitkamp github@christophweitkamp.de", "createdAt": "2020-04-06T10:58:46Z", "url": "https://github.com/openhab/openhab-core/pull/1411", "merged": true, "mergeCommit": {"oid": "8955ef9a161cea5d2ca6cdf268ec4cab149ed5b9"}, "closed": true, "closedAt": "2020-04-07T06:35:18Z", "author": {"login": "cweitkamp"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcU8VV7gH2gAyMzk5NTYwNDcwOjM1YmNmOGFjMmZlYTA4ZTJhN2FmNDU4MGRiZjBiNjdjNzg3NDBiOGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVNZfZAFqTM4ODgyMDI0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "35bcf8ac2fea08e2a7af4580dbf0b67c78740b8f", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/35bcf8ac2fea08e2a7af4580dbf0b67c78740b8f", "committedDate": "2020-04-06T10:42:11Z", "message": "Added nullness annotations to ScriptExtensionProvider\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b", "committedDate": "2020-04-06T10:58:12Z", "message": "Added nullness annotations to ScriptExtensionProvider\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4MTQxNTc0", "url": "https://github.com/openhab/openhab-core/pull/1411#pullrequestreview-388141574", "createdAt": "2020-04-06T11:00:03Z", "commit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMTowMDowM1rOGBSd4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMTowMDowM1rOGBSd4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDAwNDMyMQ==", "bodyText": "I am not sure if this is a valid change but as all existing implementations do not take care about throwing IAEs I changed it ...", "url": "https://github.com/openhab/openhab-core/pull/1411#discussion_r404004321", "createdAt": "2020-04-06T11:00:03Z", "author": {"login": "cweitkamp"}, "path": "bundles/org.openhab.core.automation.module.script/src/main/java/org/openhab/core/automation/module/script/ScriptExtensionProvider.java", "diffHunk": "@@ -15,46 +15,51 @@\n import java.util.Collection;\n import java.util.Map;\n \n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n /**\n  * A {@link ScriptExtensionProvider} can provide variable and types on ScriptEngine instance basis.\n  *\n  * @author Simon Merschjohann - Initial contribution\n  */\n+@NonNullByDefault\n public interface ScriptExtensionProvider {\n \n     /**\n      * These presets will always get injected into the ScriptEngine on instance creation.\n      *\n      * @return collection of presets\n      */\n-    public Collection<String> getDefaultPresets();\n+    Collection<String> getDefaultPresets();\n \n     /**\n      * Returns the provided Presets which are supported by this ScriptExtensionProvider.\n      * Presets define imports which will be injected into the ScriptEngine if called by \"importPreset\".\n      *\n      * @return provided presets\n      */\n-    public Collection<String> getPresets();\n+    Collection<String> getPresets();\n \n     /**\n      * Returns the supported types which can be received by the given ScriptExtensionProvider\n      *\n      * @return provided types\n      */\n-    public Collection<String> getTypes();\n+    Collection<String> getTypes();\n \n     /**\n      * This method should return an Object of the given type. Note: get can be called multiple times in the scripts use\n      * caching where appropriate.\n      *\n      * @param scriptIdentifier the identifier of the script that requests the given type\n      * @param type the type that is requested (must be part of the collection returned by the {@code #getTypes()} method\n-     * @return the requested type (non-null)\n+     * @return the requested type or null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NTQ0NzM5", "url": "https://github.com/openhab/openhab-core/pull/1411#pullrequestreview-388544739", "createdAt": "2020-04-06T19:17:00Z", "commit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOToxNzowMFrOGBmRWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOToyMjowNFrOGBmcNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMyODc5Mg==", "bodyText": "They seem to be mandatory so I think constructor injection would make sense.", "url": "https://github.com/openhab/openhab-core/pull/1411#discussion_r404328792", "createdAt": "2020-04-06T19:17:00Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.core.automation.module.script.rulesupport/src/main/java/org/openhab/core/automation/module/script/rulesupport/internal/RuleSupportScriptExtension.java", "diffHunk": "@@ -57,58 +59,61 @@\n  * @author Simon Merschjohann - Initial contribution\n  */\n @Component(immediate = true)\n+@NonNullByDefault\n public class RuleSupportScriptExtension implements ScriptExtensionProvider {\n+\n     private static final String RULE_SUPPORT = \"RuleSupport\";\n     private static final String RULE_REGISTRY = \"ruleRegistry\";\n     private static final String AUTOMATION_MANAGER = \"automationManager\";\n \n-    private static Map<String, Collection<String>> presets = new HashMap<>();\n-    private static Map<String, Object> staticTypes = new HashMap<>();\n-    private static Set<String> types = new HashSet<>();\n+    private static final Map<String, Collection<String>> PRESETS = new HashMap<>();\n+    private static final Map<String, Object> STATIC_TYPES = new HashMap<>();\n+    private static final Set<String> TYPES = new HashSet<>();\n+\n     private final Map<String, Map<String, Object>> objectCache = new ConcurrentHashMap<>();\n \n-    private RuleRegistry ruleRegistry;\n-    private ScriptedRuleProvider ruleProvider;\n-    private ScriptedCustomModuleHandlerFactory scriptedCustomModuleHandlerFactory;\n-    private ScriptedCustomModuleTypeProvider scriptedCustomModuleTypeProvider;\n-    private ScriptedPrivateModuleHandlerFactory scriptedPrivateModuleHandlerFactory;\n+    private @NonNullByDefault({}) RuleRegistry ruleRegistry;\n+    private @NonNullByDefault({}) ScriptedRuleProvider ruleProvider;\n+    private @NonNullByDefault({}) ScriptedCustomModuleHandlerFactory scriptedCustomModuleHandlerFactory;\n+    private @NonNullByDefault({}) ScriptedCustomModuleTypeProvider scriptedCustomModuleTypeProvider;\n+    private @NonNullByDefault({}) ScriptedPrivateModuleHandlerFactory scriptedPrivateModuleHandlerFactory;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMzMTU3Mw==", "bodyText": "The changes makes sense to me.", "url": "https://github.com/openhab/openhab-core/pull/1411#discussion_r404331573", "createdAt": "2020-04-06T19:22:04Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.core.automation.module.script/src/main/java/org/openhab/core/automation/module/script/ScriptExtensionProvider.java", "diffHunk": "@@ -15,46 +15,51 @@\n import java.util.Collection;\n import java.util.Map;\n \n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n /**\n  * A {@link ScriptExtensionProvider} can provide variable and types on ScriptEngine instance basis.\n  *\n  * @author Simon Merschjohann - Initial contribution\n  */\n+@NonNullByDefault\n public interface ScriptExtensionProvider {\n \n     /**\n      * These presets will always get injected into the ScriptEngine on instance creation.\n      *\n      * @return collection of presets\n      */\n-    public Collection<String> getDefaultPresets();\n+    Collection<String> getDefaultPresets();\n \n     /**\n      * Returns the provided Presets which are supported by this ScriptExtensionProvider.\n      * Presets define imports which will be injected into the ScriptEngine if called by \"importPreset\".\n      *\n      * @return provided presets\n      */\n-    public Collection<String> getPresets();\n+    Collection<String> getPresets();\n \n     /**\n      * Returns the supported types which can be received by the given ScriptExtensionProvider\n      *\n      * @return provided types\n      */\n-    public Collection<String> getTypes();\n+    Collection<String> getTypes();\n \n     /**\n      * This method should return an Object of the given type. Note: get can be called multiple times in the scripts use\n      * caching where appropriate.\n      *\n      * @param scriptIdentifier the identifier of the script that requests the given type\n      * @param type the type that is requested (must be part of the collection returned by the {@code #getTypes()} method\n-     * @return the requested type (non-null)\n+     * @return the requested type or null", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDAwNDMyMQ=="}, "originalCommit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2eadf235deb5abba4758105908a266544ea85a9f", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/2eadf235deb5abba4758105908a266544ea85a9f", "committedDate": "2020-04-07T05:19:19Z", "message": "Incorporated comments from review\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4ODIwMjQy", "url": "https://github.com/openhab/openhab-core/pull/1411#pullrequestreview-388820242", "createdAt": "2020-04-07T06:35:06Z", "commit": {"oid": "2eadf235deb5abba4758105908a266544ea85a9f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4579, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}