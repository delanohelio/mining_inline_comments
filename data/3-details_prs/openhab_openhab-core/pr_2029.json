{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2NTQxMTEw", "number": 2029, "title": "Added unit tests for check if persistence extension returns QuantityType if persistence service returns QuantityType", "bodyText": "Added unit tests for check if persistence extension returns QuantityType if persistence service returns QuantityType\n\nThis PR adds support for unit tests returning QuantityType values and splits test for historicState(), previousState(), maximumSince() and minimumSince() to validate to already work like expected.\nRelated to #1954\nSigned-off-by: Christoph Weitkamp github@christophweitkamp.de", "createdAt": "2020-12-29T15:57:09Z", "url": "https://github.com/openhab/openhab-core/pull/2029", "merged": true, "mergeCommit": {"oid": "90a460dd0325bbe00759b076595b7f5c8ff9b0e0"}, "closed": true, "closedAt": "2021-01-08T21:53:36Z", "author": {"login": "cweitkamp"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdriVcBABqjQxNTk1MTI0Mzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABduO2DoAFqTU2NDU2NTIyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "253fe797c50ae08caf087de1ca83d569cfbb4ef8", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/253fe797c50ae08caf087de1ca83d569cfbb4ef8", "committedDate": "2020-12-29T15:52:51Z", "message": "Added unit tests for check if persistence extension returns QuantityType id persistnce service returns QuantityType\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}, "afterCommit": {"oid": "521dcdaa796dae131a5bd121cd84bae847669c76", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/521dcdaa796dae131a5bd121cd84bae847669c76", "committedDate": "2020-12-31T10:36:43Z", "message": "Further test improvements\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY0NDY2MzM1", "url": "https://github.com/openhab/openhab-core/pull/2029#pullrequestreview-564466335", "createdAt": "2021-01-08T17:57:00Z", "commit": {"oid": "521dcdaa796dae131a5bd121cd84bae847669c76"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOFQxNzo1NzowMVrOIQbt7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wOFQxNzo1NzowMVrOIQbt7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDEwMjI1NA==", "bodyText": "When the class is annotated with @ExtendWith(MockitoExtension.class), the mockCloseable and afterEach method can be removed.", "url": "https://github.com/openhab/openhab-core/pull/2029#discussion_r554102254", "createdAt": "2021-01-08T17:57:01Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.core.persistence/src/test/java/org/openhab/core/persistence/extensions/PersistenceExtensionsTest.java", "diffHunk": "@@ -42,53 +52,72 @@\n  */\n public class PersistenceExtensionsTest {\n \n-    public static final String TEST_NUMBER = \"Test Number\";\n-    public static final String TEST_SWITCH = \"Test Switch\";\n-\n-    @NonNullByDefault\n-    private final PersistenceServiceRegistry registry = new PersistenceServiceRegistry() {\n-\n-        private final PersistenceService testPersistenceService = new TestPersistenceService();\n-\n-        @Override\n-        public @Nullable String getDefaultId() {\n-            // not available\n-            return null;\n-        }\n-\n-        @Override\n-        public @Nullable PersistenceService getDefault() {\n-            // not available\n-            return null;\n-        }\n+    public static final String TEST_NUMBER = \"testNumber\";\n+    public static final String TEST_QUANTITY_NUMBER = \"testQuantityNumber\";\n+    public static final String TEST_SWITCH = \"testSwitch\";\n \n-        @Override\n-        public Set<PersistenceService> getAll() {\n-            return Set.of(testPersistenceService);\n-        }\n+    private @Mock UnitProvider unitProvider;\n+    private @Mock ItemRegistry mockedItemRegistry;\n \n-        @Override\n-        public @Nullable PersistenceService get(@Nullable String serviceId) {\n-            return TestPersistenceService.ID.equals(serviceId) ? testPersistenceService : null;\n-        }\n-    };\n+    private AutoCloseable mocksCloseable;\n \n-    private CoreItemFactory itemFactory;\n-    private GenericItem numberItem, switchItem;\n+    private GenericItem numberItem, quantityItem, switchItem;\n \n     @BeforeEach\n     public void setUp() {\n-        new PersistenceExtensions(registry);\n-        itemFactory = new CoreItemFactory();\n+        mocksCloseable = openMocks(this);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "521dcdaa796dae131a5bd121cd84bae847669c76"}, "originalPosition": 80}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0b88b15b05053e9a415ddbea5053b1087bb86ab", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/c0b88b15b05053e9a415ddbea5053b1087bb86ab", "committedDate": "2021-01-08T18:44:24Z", "message": "Added unit tests for check if persistence extension returns QuantityType id persistnce service returns QuantityType\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16836dbc9d8b5d2da6701081ee6404b70aa41c3a", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/16836dbc9d8b5d2da6701081ee6404b70aa41c3a", "committedDate": "2021-01-08T18:44:25Z", "message": "Further test improvements\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a812a7b4113514f5d1660f17e2eb6896afeec51e", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/a812a7b4113514f5d1660f17e2eb6896afeec51e", "committedDate": "2021-01-08T18:50:47Z", "message": "Incorporated comment from review\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "521dcdaa796dae131a5bd121cd84bae847669c76", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/521dcdaa796dae131a5bd121cd84bae847669c76", "committedDate": "2020-12-31T10:36:43Z", "message": "Further test improvements\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}, "afterCommit": {"oid": "a812a7b4113514f5d1660f17e2eb6896afeec51e", "author": {"user": {"login": "cweitkamp", "name": "Christoph Weitkamp"}}, "url": "https://github.com/openhab/openhab-core/commit/a812a7b4113514f5d1660f17e2eb6896afeec51e", "committedDate": "2021-01-08T18:50:47Z", "message": "Incorporated comment from review\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY0NTY1MjI0", "url": "https://github.com/openhab/openhab-core/pull/2029#pullrequestreview-564565224", "createdAt": "2021-01-08T20:35:28Z", "commit": {"oid": "a812a7b4113514f5d1660f17e2eb6896afeec51e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4623, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}