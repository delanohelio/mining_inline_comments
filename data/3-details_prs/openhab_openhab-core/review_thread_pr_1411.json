{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5NTYwNDcw", "number": 1411, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMTowMDowM1rODvE0YQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOToxNzowMFrODvRPoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwNjg4NjA5OnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.core.automation.module.script/src/main/java/org/openhab/core/automation/module/script/ScriptExtensionProvider.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMTowMDowM1rOGBSd4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOToyMjowNFrOGBmcNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDAwNDMyMQ==", "bodyText": "I am not sure if this is a valid change but as all existing implementations do not take care about throwing IAEs I changed it ...", "url": "https://github.com/openhab/openhab-core/pull/1411#discussion_r404004321", "createdAt": "2020-04-06T11:00:03Z", "author": {"login": "cweitkamp"}, "path": "bundles/org.openhab.core.automation.module.script/src/main/java/org/openhab/core/automation/module/script/ScriptExtensionProvider.java", "diffHunk": "@@ -15,46 +15,51 @@\n import java.util.Collection;\n import java.util.Map;\n \n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n /**\n  * A {@link ScriptExtensionProvider} can provide variable and types on ScriptEngine instance basis.\n  *\n  * @author Simon Merschjohann - Initial contribution\n  */\n+@NonNullByDefault\n public interface ScriptExtensionProvider {\n \n     /**\n      * These presets will always get injected into the ScriptEngine on instance creation.\n      *\n      * @return collection of presets\n      */\n-    public Collection<String> getDefaultPresets();\n+    Collection<String> getDefaultPresets();\n \n     /**\n      * Returns the provided Presets which are supported by this ScriptExtensionProvider.\n      * Presets define imports which will be injected into the ScriptEngine if called by \"importPreset\".\n      *\n      * @return provided presets\n      */\n-    public Collection<String> getPresets();\n+    Collection<String> getPresets();\n \n     /**\n      * Returns the supported types which can be received by the given ScriptExtensionProvider\n      *\n      * @return provided types\n      */\n-    public Collection<String> getTypes();\n+    Collection<String> getTypes();\n \n     /**\n      * This method should return an Object of the given type. Note: get can be called multiple times in the scripts use\n      * caching where appropriate.\n      *\n      * @param scriptIdentifier the identifier of the script that requests the given type\n      * @param type the type that is requested (must be part of the collection returned by the {@code #getTypes()} method\n-     * @return the requested type (non-null)\n+     * @return the requested type or null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMzMTU3Mw==", "bodyText": "The changes makes sense to me.", "url": "https://github.com/openhab/openhab-core/pull/1411#discussion_r404331573", "createdAt": "2020-04-06T19:22:04Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.core.automation.module.script/src/main/java/org/openhab/core/automation/module/script/ScriptExtensionProvider.java", "diffHunk": "@@ -15,46 +15,51 @@\n import java.util.Collection;\n import java.util.Map;\n \n+import org.eclipse.jdt.annotation.NonNullByDefault;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n /**\n  * A {@link ScriptExtensionProvider} can provide variable and types on ScriptEngine instance basis.\n  *\n  * @author Simon Merschjohann - Initial contribution\n  */\n+@NonNullByDefault\n public interface ScriptExtensionProvider {\n \n     /**\n      * These presets will always get injected into the ScriptEngine on instance creation.\n      *\n      * @return collection of presets\n      */\n-    public Collection<String> getDefaultPresets();\n+    Collection<String> getDefaultPresets();\n \n     /**\n      * Returns the provided Presets which are supported by this ScriptExtensionProvider.\n      * Presets define imports which will be injected into the ScriptEngine if called by \"importPreset\".\n      *\n      * @return provided presets\n      */\n-    public Collection<String> getPresets();\n+    Collection<String> getPresets();\n \n     /**\n      * Returns the supported types which can be received by the given ScriptExtensionProvider\n      *\n      * @return provided types\n      */\n-    public Collection<String> getTypes();\n+    Collection<String> getTypes();\n \n     /**\n      * This method should return an Object of the given type. Note: get can be called multiple times in the scripts use\n      * caching where appropriate.\n      *\n      * @param scriptIdentifier the identifier of the script that requests the given type\n      * @param type the type that is requested (must be part of the collection returned by the {@code #getTypes()} method\n-     * @return the requested type (non-null)\n+     * @return the requested type or null", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDAwNDMyMQ=="}, "originalCommit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODkyMTkyOnYy", "diffSide": "RIGHT", "path": "bundles/org.openhab.core.automation.module.script.rulesupport/src/main/java/org/openhab/core/automation/module/script/rulesupport/internal/RuleSupportScriptExtension.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOToxNzowMFrOGBmRWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwNTo0Njo0N1rOGBzvNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMyODc5Mg==", "bodyText": "They seem to be mandatory so I think constructor injection would make sense.", "url": "https://github.com/openhab/openhab-core/pull/1411#discussion_r404328792", "createdAt": "2020-04-06T19:17:00Z", "author": {"login": "wborn"}, "path": "bundles/org.openhab.core.automation.module.script.rulesupport/src/main/java/org/openhab/core/automation/module/script/rulesupport/internal/RuleSupportScriptExtension.java", "diffHunk": "@@ -57,58 +59,61 @@\n  * @author Simon Merschjohann - Initial contribution\n  */\n @Component(immediate = true)\n+@NonNullByDefault\n public class RuleSupportScriptExtension implements ScriptExtensionProvider {\n+\n     private static final String RULE_SUPPORT = \"RuleSupport\";\n     private static final String RULE_REGISTRY = \"ruleRegistry\";\n     private static final String AUTOMATION_MANAGER = \"automationManager\";\n \n-    private static Map<String, Collection<String>> presets = new HashMap<>();\n-    private static Map<String, Object> staticTypes = new HashMap<>();\n-    private static Set<String> types = new HashSet<>();\n+    private static final Map<String, Collection<String>> PRESETS = new HashMap<>();\n+    private static final Map<String, Object> STATIC_TYPES = new HashMap<>();\n+    private static final Set<String> TYPES = new HashSet<>();\n+\n     private final Map<String, Map<String, Object>> objectCache = new ConcurrentHashMap<>();\n \n-    private RuleRegistry ruleRegistry;\n-    private ScriptedRuleProvider ruleProvider;\n-    private ScriptedCustomModuleHandlerFactory scriptedCustomModuleHandlerFactory;\n-    private ScriptedCustomModuleTypeProvider scriptedCustomModuleTypeProvider;\n-    private ScriptedPrivateModuleHandlerFactory scriptedPrivateModuleHandlerFactory;\n+    private @NonNullByDefault({}) RuleRegistry ruleRegistry;\n+    private @NonNullByDefault({}) ScriptedRuleProvider ruleProvider;\n+    private @NonNullByDefault({}) ScriptedCustomModuleHandlerFactory scriptedCustomModuleHandlerFactory;\n+    private @NonNullByDefault({}) ScriptedCustomModuleTypeProvider scriptedCustomModuleTypeProvider;\n+    private @NonNullByDefault({}) ScriptedPrivateModuleHandlerFactory scriptedPrivateModuleHandlerFactory;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU0OTQyOA==", "bodyText": "Done.", "url": "https://github.com/openhab/openhab-core/pull/1411#discussion_r404549428", "createdAt": "2020-04-07T05:46:47Z", "author": {"login": "cweitkamp"}, "path": "bundles/org.openhab.core.automation.module.script.rulesupport/src/main/java/org/openhab/core/automation/module/script/rulesupport/internal/RuleSupportScriptExtension.java", "diffHunk": "@@ -57,58 +59,61 @@\n  * @author Simon Merschjohann - Initial contribution\n  */\n @Component(immediate = true)\n+@NonNullByDefault\n public class RuleSupportScriptExtension implements ScriptExtensionProvider {\n+\n     private static final String RULE_SUPPORT = \"RuleSupport\";\n     private static final String RULE_REGISTRY = \"ruleRegistry\";\n     private static final String AUTOMATION_MANAGER = \"automationManager\";\n \n-    private static Map<String, Collection<String>> presets = new HashMap<>();\n-    private static Map<String, Object> staticTypes = new HashMap<>();\n-    private static Set<String> types = new HashSet<>();\n+    private static final Map<String, Collection<String>> PRESETS = new HashMap<>();\n+    private static final Map<String, Object> STATIC_TYPES = new HashMap<>();\n+    private static final Set<String> TYPES = new HashSet<>();\n+\n     private final Map<String, Map<String, Object>> objectCache = new ConcurrentHashMap<>();\n \n-    private RuleRegistry ruleRegistry;\n-    private ScriptedRuleProvider ruleProvider;\n-    private ScriptedCustomModuleHandlerFactory scriptedCustomModuleHandlerFactory;\n-    private ScriptedCustomModuleTypeProvider scriptedCustomModuleTypeProvider;\n-    private ScriptedPrivateModuleHandlerFactory scriptedPrivateModuleHandlerFactory;\n+    private @NonNullByDefault({}) RuleRegistry ruleRegistry;\n+    private @NonNullByDefault({}) ScriptedRuleProvider ruleProvider;\n+    private @NonNullByDefault({}) ScriptedCustomModuleHandlerFactory scriptedCustomModuleHandlerFactory;\n+    private @NonNullByDefault({}) ScriptedCustomModuleTypeProvider scriptedCustomModuleTypeProvider;\n+    private @NonNullByDefault({}) ScriptedPrivateModuleHandlerFactory scriptedPrivateModuleHandlerFactory;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMyODc5Mg=="}, "originalCommit": {"oid": "e31d8b2ddf25fd3b06cbe0e72150dcb2f87f730b"}, "originalPosition": 38}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3189, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}