{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NjQ1MjAz", "number": 1371, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo0NDoxMFrOEBMjlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo1NToxM1rOEBMmYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njg5NzQ4OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/QuranAdvancedPreferenceActivity.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo0NDoxMFrOGc6S-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo0NDoxMFrOGc6S-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2ODQ0Mg==", "bodyText": "It's not possible for us to change the colors without getting a reference to the Toast itself because:\n\nthe attribute it uses for the background is private\nit doesn't use attributes for the text color - it's hardcoded", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432968442", "createdAt": "2020-05-31T17:44:10Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/QuranAdvancedPreferenceActivity.java", "diffHunk": "@@ -82,7 +83,7 @@ public void requestWriteExternalSdcardPermission(String newLocation) {\n           REQUEST_WRITE_TO_SDCARD_PERMISSION);\n     } else {\n       // in the future, we should make this a direct link - perhaps using a Snackbar.\n-      Toast.makeText(this, R.string.please_grant_permissions, Toast.LENGTH_SHORT).show();\n+      ToastCompat.makeText(this, R.string.please_grant_permissions, Toast.LENGTH_SHORT).show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32b78007c3bd52da1819c42e529f3dac05f3a422"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njg5Nzk2OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo0NDo0OFrOGc6TOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo0NDo0OFrOGc6TOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2ODUwNQ==", "bodyText": "There's no built-in constant for this (potentially because the target/compile SDK of this app is 28).", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432968505", "createdAt": "2020-05-31T17:44:48Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32b78007c3bd52da1819c42e529f3dac05f3a422"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NjkwMjY1OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo1MjowM1rOGc6ViA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxODo0OTozM1rOGc6msA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTA5Ng==", "bodyText": "Toast.getView() and Toast.setView() are deprecated in Android R. I read (somewhere) that getView() will return null, and I don't know what the behaviour of setView() will be, though I wouldn't be surprised if it's a no-op on Android R (if targetSdkVersion >= 30).\nI wasn't able to test on R, so I left this with a guard. This means that on R and above, unless this logic is amended, toasts will do whatever they do by default, which means that the toast will be light colored.", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432969096", "createdAt": "2020-05-31T17:52:03Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk3MTkxOQ==", "bodyText": "if Toast.getView() is not deprecated until R and we're only supporting this R and below, could we not just let the normal Toast ui inflate itself, get its view, and if it's not null, apply a background instead?", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432971919", "createdAt": "2020-05-31T18:28:56Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTA5Ng=="}, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk3MjY3OQ==", "bodyText": "Yep we can, but as you mentioned, different device manufacturers could do odd things so we'd have to set the background and text color in any case.", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432972679", "createdAt": "2020-05-31T18:38:06Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTA5Ng=="}, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk3MzQ4OA==", "bodyText": "*we can but I don't recommend. If the device manufacturer inflates its own layout for example, we wouldn't know the ID for the textview.", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432973488", "createdAt": "2020-05-31T18:49:33Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTA5Ng=="}, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NjkwMzM5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo1MzowM1rOGc6V5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo1MzowM1rOGc6V5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTE5MQ==", "bodyText": "\u26a0\ufe0f  I have not tested this on anything apart from API 29.", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432969191", "createdAt": "2020-05-31T17:53:03Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));\n+    }\n+    return toast;\n+  }\n+\n+  private static View createToastView(Context context, CharSequence message) {\n+    View toastView = LayoutInflater.from(context).inflate(R.layout.toast, null, false);\n+\n+    QuranSettings settings = QuranSettings.getInstance(context);\n+    Drawable tintedBackground = createTintedBackground(context, settings.isNightMode());\n+    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n+      toastView.setBackground(tintedBackground);\n+    } else {\n+      toastView.setBackgroundDrawable(tintedBackground);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NjkwMzY4OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo1MzozMFrOGc6WDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxODo0Njo1MFrOGc6mAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTIzMQ==", "bodyText": "I continued to use the same IDs that the default Toast layout used.", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432969231", "createdAt": "2020-05-31T17:53:30Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));\n+    }\n+    return toast;\n+  }\n+\n+  private static View createToastView(Context context, CharSequence message) {\n+    View toastView = LayoutInflater.from(context).inflate(R.layout.toast, null, false);\n+\n+    QuranSettings settings = QuranSettings.getInstance(context);\n+    Drawable tintedBackground = createTintedBackground(context, settings.isNightMode());\n+    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n+      toastView.setBackground(tintedBackground);\n+    } else {\n+      toastView.setBackgroundDrawable(tintedBackground);\n+    }\n+\n+    TextView textView = toastView.findViewById(android.R.id.message);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk3MTkxNw==", "bodyText": "let's play it safe here and do nothing if it's null just in case Samsung devices do something odd", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432971917", "createdAt": "2020-05-31T18:28:51Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));\n+    }\n+    return toast;\n+  }\n+\n+  private static View createToastView(Context context, CharSequence message) {\n+    View toastView = LayoutInflater.from(context).inflate(R.layout.toast, null, false);\n+\n+    QuranSettings settings = QuranSettings.getInstance(context);\n+    Drawable tintedBackground = createTintedBackground(context, settings.isNightMode());\n+    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n+      toastView.setBackground(tintedBackground);\n+    } else {\n+      toastView.setBackgroundDrawable(tintedBackground);\n+    }\n+\n+    TextView textView = toastView.findViewById(android.R.id.message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTIzMQ=="}, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk3MjczOA==", "bodyText": "This will never be null as we inflate a layout R.layout.toast which uses this ID. I can rename the ID?\nI wasn't sure if the system would rely on this ID being something particular, but it shouldn't.", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432972738", "createdAt": "2020-05-31T18:39:07Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));\n+    }\n+    return toast;\n+  }\n+\n+  private static View createToastView(Context context, CharSequence message) {\n+    View toastView = LayoutInflater.from(context).inflate(R.layout.toast, null, false);\n+\n+    QuranSettings settings = QuranSettings.getInstance(context);\n+    Drawable tintedBackground = createTintedBackground(context, settings.isNightMode());\n+    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n+      toastView.setBackground(tintedBackground);\n+    } else {\n+      toastView.setBackgroundDrawable(tintedBackground);\n+    }\n+\n+    TextView textView = toastView.findViewById(android.R.id.message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTIzMQ=="}, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk3MzMxMw==", "bodyText": "ah right you're inflating your own layout - never mind then, this is fine", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432973313", "createdAt": "2020-05-31T18:46:50Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));\n+    }\n+    return toast;\n+  }\n+\n+  private static View createToastView(Context context, CharSequence message) {\n+    View toastView = LayoutInflater.from(context).inflate(R.layout.toast, null, false);\n+\n+    QuranSettings settings = QuranSettings.getInstance(context);\n+    Drawable tintedBackground = createTintedBackground(context, settings.isNightMode());\n+    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n+      toastView.setBackground(tintedBackground);\n+    } else {\n+      toastView.setBackgroundDrawable(tintedBackground);\n+    }\n+\n+    TextView textView = toastView.findViewById(android.R.id.message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTIzMQ=="}, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NjkwNDA4OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo1NDoyNVrOGc6WSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxODo0NzozOVrOGc6mPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTI4OA==", "bodyText": "I've seen getNightModeTextBrightness() used elsewhere, but with 255 hardcoded. Is that preferred?", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432969288", "createdAt": "2020-05-31T17:54:25Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));\n+    }\n+    return toast;\n+  }\n+\n+  private static View createToastView(Context context, CharSequence message) {\n+    View toastView = LayoutInflater.from(context).inflate(R.layout.toast, null, false);\n+\n+    QuranSettings settings = QuranSettings.getInstance(context);\n+    Drawable tintedBackground = createTintedBackground(context, settings.isNightMode());\n+    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n+      toastView.setBackground(tintedBackground);\n+    } else {\n+      toastView.setBackgroundDrawable(tintedBackground);\n+    }\n+\n+    TextView textView = toastView.findViewById(android.R.id.message);\n+    textView.setTextColor(getTextColor(context, settings));\n+    textView.setText(message);\n+    return toastView;\n+  }\n+\n+  private static Drawable createTintedBackground(Context context, boolean nightMode) {\n+    Drawable toastFrame = DrawableCompat.wrap(AppCompatResources.getDrawable(context, R.drawable.toast_frame));\n+    DrawableCompat.setTint(toastFrame, getBackgroundColor(context, nightMode));\n+    return toastFrame;\n+  }\n+\n+  private static int getTextColor(Context context, QuranSettings settings) {\n+    if (settings.isNightMode()) {\n+      int textColorNight = ContextCompat.getColor(context, R.color.toast_text_color_night);\n+      return Color.argb(\n+          settings.getNightModeTextBrightness(),\n+          Color.red(textColorNight),\n+          Color.green(textColorNight),\n+          Color.blue(textColorNight)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk3MjEwNA==", "bodyText": "i think for the alpha, it's fine to hardcode to 255 here since we don't want the background to be very transparent and perhaps not very readable? as a matter of fact i am ok with adding a toast_text_color_night (until we support day/night) and just using a nice value for that instead of making it customizable", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432972104", "createdAt": "2020-05-31T18:31:01Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));\n+    }\n+    return toast;\n+  }\n+\n+  private static View createToastView(Context context, CharSequence message) {\n+    View toastView = LayoutInflater.from(context).inflate(R.layout.toast, null, false);\n+\n+    QuranSettings settings = QuranSettings.getInstance(context);\n+    Drawable tintedBackground = createTintedBackground(context, settings.isNightMode());\n+    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n+      toastView.setBackground(tintedBackground);\n+    } else {\n+      toastView.setBackgroundDrawable(tintedBackground);\n+    }\n+\n+    TextView textView = toastView.findViewById(android.R.id.message);\n+    textView.setTextColor(getTextColor(context, settings));\n+    textView.setText(message);\n+    return toastView;\n+  }\n+\n+  private static Drawable createTintedBackground(Context context, boolean nightMode) {\n+    Drawable toastFrame = DrawableCompat.wrap(AppCompatResources.getDrawable(context, R.drawable.toast_frame));\n+    DrawableCompat.setTint(toastFrame, getBackgroundColor(context, nightMode));\n+    return toastFrame;\n+  }\n+\n+  private static int getTextColor(Context context, QuranSettings settings) {\n+    if (settings.isNightMode()) {\n+      int textColorNight = ContextCompat.getColor(context, R.color.toast_text_color_night);\n+      return Color.argb(\n+          settings.getNightModeTextBrightness(),\n+          Color.red(textColorNight),\n+          Color.green(textColorNight),\n+          Color.blue(textColorNight)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTI4OA=="}, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk3MzIwNA==", "bodyText": "This function is for the text color so it will only affect the contrast ratio of the text against the background by modifying the text alpha: the background of the toast will not change transparency.\nI'm not sure what the requested action is on this one - are we saying to get rid of the getNightModeTextBrightness like this:\nprivate static int getTextColor(Context context) {\n  if (settings.isNightMode()) {\n    return ContextCompat.getColor(context, R.color.toast_text_color_night);\n  } else {\n    return ContextCompat.getColor(context, R.color.toast_text_color);\n  }\n}\nor something else?", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432973204", "createdAt": "2020-05-31T18:45:14Z", "author": {"login": "ataulm"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));\n+    }\n+    return toast;\n+  }\n+\n+  private static View createToastView(Context context, CharSequence message) {\n+    View toastView = LayoutInflater.from(context).inflate(R.layout.toast, null, false);\n+\n+    QuranSettings settings = QuranSettings.getInstance(context);\n+    Drawable tintedBackground = createTintedBackground(context, settings.isNightMode());\n+    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n+      toastView.setBackground(tintedBackground);\n+    } else {\n+      toastView.setBackgroundDrawable(tintedBackground);\n+    }\n+\n+    TextView textView = toastView.findViewById(android.R.id.message);\n+    textView.setTextColor(getTextColor(context, settings));\n+    textView.setText(message);\n+    return toastView;\n+  }\n+\n+  private static Drawable createTintedBackground(Context context, boolean nightMode) {\n+    Drawable toastFrame = DrawableCompat.wrap(AppCompatResources.getDrawable(context, R.drawable.toast_frame));\n+    DrawableCompat.setTint(toastFrame, getBackgroundColor(context, nightMode));\n+    return toastFrame;\n+  }\n+\n+  private static int getTextColor(Context context, QuranSettings settings) {\n+    if (settings.isNightMode()) {\n+      int textColorNight = ContextCompat.getColor(context, R.color.toast_text_color_night);\n+      return Color.argb(\n+          settings.getNightModeTextBrightness(),\n+          Color.red(textColorNight),\n+          Color.green(textColorNight),\n+          Color.blue(textColorNight)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTI4OA=="}, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk3MzM3Mg==", "bodyText": "yes exactly - handle the same way you're handling day mode where we just provide a specific background color and text color", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432973372", "createdAt": "2020-05-31T18:47:39Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/util/ToastCompat.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package com.quran.labs.androidquran.ui.util;\n+\n+import android.annotation.SuppressLint;\n+import android.content.Context;\n+import android.graphics.Color;\n+import android.graphics.drawable.Drawable;\n+import android.os.Build;\n+import android.view.LayoutInflater;\n+import android.view.View;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+\n+import androidx.annotation.NonNull;\n+import androidx.annotation.StringRes;\n+import androidx.appcompat.content.res.AppCompatResources;\n+import androidx.core.content.ContextCompat;\n+import androidx.core.graphics.drawable.DrawableCompat;\n+\n+import com.quran.labs.androidquran.R;\n+import com.quran.labs.androidquran.util.QuranSettings;\n+\n+public class ToastCompat {\n+\n+  private static final int ANDROID_R = 30;\n+\n+  public static Toast makeText(@NonNull Context context, @StringRes int messageRes, int duration) {\n+    return makeText(context, context.getString(messageRes), duration);\n+  }\n+\n+  public static Toast makeText(@NonNull Context context, CharSequence message, int duration) {\n+    @SuppressLint(\"ShowToast\") Toast toast = Toast.makeText(context, message, duration);\n+    if (Build.VERSION.SDK_INT < ANDROID_R) {\n+      // It's unclear what behavior `Toast.setView()` has on R and above, hence the guard.\n+      toast.setView(createToastView(context, message));\n+    }\n+    return toast;\n+  }\n+\n+  private static View createToastView(Context context, CharSequence message) {\n+    View toastView = LayoutInflater.from(context).inflate(R.layout.toast, null, false);\n+\n+    QuranSettings settings = QuranSettings.getInstance(context);\n+    Drawable tintedBackground = createTintedBackground(context, settings.isNightMode());\n+    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {\n+      toastView.setBackground(tintedBackground);\n+    } else {\n+      toastView.setBackgroundDrawable(tintedBackground);\n+    }\n+\n+    TextView textView = toastView.findViewById(android.R.id.message);\n+    textView.setTextColor(getTextColor(context, settings));\n+    textView.setText(message);\n+    return toastView;\n+  }\n+\n+  private static Drawable createTintedBackground(Context context, boolean nightMode) {\n+    Drawable toastFrame = DrawableCompat.wrap(AppCompatResources.getDrawable(context, R.drawable.toast_frame));\n+    DrawableCompat.setTint(toastFrame, getBackgroundColor(context, nightMode));\n+    return toastFrame;\n+  }\n+\n+  private static int getTextColor(Context context, QuranSettings settings) {\n+    if (settings.isNightMode()) {\n+      int textColorNight = ContextCompat.getColor(context, R.color.toast_text_color_night);\n+      return Color.argb(\n+          settings.getNightModeTextBrightness(),\n+          Color.red(textColorNight),\n+          Color.green(textColorNight),\n+          Color.blue(textColorNight)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTI4OA=="}, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 69}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NjkwNDY3OnYy", "diffSide": "RIGHT", "path": "app/src/main/res/drawable/toast_frame.xml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo1NToxM1rOGc6WpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNzo1NToxM1rOGc6WpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2OTM4MA==", "bodyText": "This should always be tinted - if the toast looks red, something is not correct \ud83d\ude05", "url": "https://github.com/quran/quran_android/pull/1371#discussion_r432969380", "createdAt": "2020-05-31T17:55:13Z", "author": {"login": "ataulm"}, "path": "app/src/main/res/drawable/toast_frame.xml", "diffHunk": "@@ -0,0 +1,7 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:shape=\"rectangle\">\n+  <!-- background is tinted programmatically -->\n+  <solid android:color=\"@android:color/holo_red_light\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f887ce8f6dc8544f77f08fda33a930f09fb6465d"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2020, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}