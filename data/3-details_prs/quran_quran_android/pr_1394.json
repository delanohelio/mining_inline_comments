{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0NDA2NzQ2", "number": 1394, "title": "Support split screen age and translation on tablet", "bodyText": "This PR Fixes #759.\nIt allows a second translation mode with the Quran and translation placed side-by-side on the same page.\nThis mode can be enabled in the settings. Also, the placement of the Quran/translation can be configured in settings.\nBefore merging this PR, approval and translations will be needed for the strings shown in the settings page.", "createdAt": "2020-07-05T13:19:04Z", "url": "https://github.com/quran/quran_android/pull/1394", "merged": true, "mergeCommit": {"oid": "890f1b70dc4b0d28f683605c6e491bf0810a9148"}, "closed": true, "closedAt": "2020-09-29T02:28:21Z", "author": {"login": "Korogba"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcx77N1gH2gAyNDQ0NDA2NzQ2OjNiNTE1NzE2ZDhkNGFjNDhlZGI1M2ExYjUwNGVjN2NkNDhmZWQxYzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDp7duAH2gAyNDQ0NDA2NzQ2Ojg5MGYxYjcwZGM0YjBkMjhmNjgzNjA1YzZlNDkxYmYwODEwYTkxNDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3b515716d8d4ac48edb53a1b504ec7cd48fed1c7", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/3b515716d8d4ac48edb53a1b504ec7cd48fed1c7", "committedDate": "2020-07-05T12:37:27Z", "message": "add preferences to enable/disable quran-translation split screen view"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "106f1a1c7d52fd9350eec3715028cfef93026046", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/106f1a1c7d52fd9350eec3715028cfef93026046", "committedDate": "2020-07-05T12:37:27Z", "message": "add split mode support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dcb7b1f90edd6636f9ce3e09f31a63c9037aa43", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/6dcb7b1f90edd6636f9ce3e09f31a63c9037aa43", "committedDate": "2020-07-05T12:37:27Z", "message": "fix crash because of null controller in split mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d972386142eb554b42d8dfff2c53f3b9ea263660", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/d972386142eb554b42d8dfff2c53f3b9ea263660", "committedDate": "2020-07-05T12:37:27Z", "message": "fix Quran page count when split mode and translation/Quran mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6af11428bbb0a3681267df8131613c0b22b0a922", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/6af11428bbb0a3681267df8131613c0b22b0a922", "committedDate": "2020-07-05T12:37:27Z", "message": "fix switch between Quran and translation in split mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe285f5dabb769052879a4fb011e3757e1c30670", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/fe285f5dabb769052879a4fb011e3757e1c30670", "committedDate": "2020-07-05T12:40:06Z", "message": "fix Quran playback when in split mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a06e38e29eeff83736c6ec6800c6c61e07ed377", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/1a06e38e29eeff83736c6ec6800c6c61e07ed377", "committedDate": "2020-07-05T12:44:16Z", "message": "fix unit tests after rebase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/e87d9237477442db1a2fec81110a71bbca0a27b0", "committedDate": "2020-07-05T12:48:18Z", "message": "remove unused import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyODc4MzM5", "url": "https://github.com/quran/quran_android/pull/1394#pullrequestreview-452878339", "createdAt": "2020-07-21T22:38:53Z", "commit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjozODo1M1rOG1MUTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjo0MTozNFrOG1MYXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQyOTUxNw==", "bodyText": "this isn't right for cases where we are tablet in translation mode without the split setting - in that case, we should still treat it as 2 pages whereas this code will treat it as 1.", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r458429517", "createdAt": "2020-07-21T22:38:53Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/util/AudioUtils.kt", "diffHunk": "@@ -107,17 +107,25 @@ constructor(private val quranInfo: QuranInfo, private val quranFileUtils: QuranF\n     return quranFileUtils.gaplessDatabaseRootUrl + \"/\" + dbName\n   }\n \n-  fun getLastAyahToPlay(startAyah: SuraAyah,\n-                        currentPage: Int,\n-                        mode: Int,\n-                        isDualPages: Boolean): SuraAyah? {\n-    val page = if (isDualPages && mode == LookAheadAmount.PAGE && currentPage % 2 == 1) {\n-      // if we download page by page and we are currently in tablet mode\n-      // and playing from the right page, get the left page as well.\n-      currentPage + 1\n-    } else {\n-      currentPage\n-    }\n+  fun getLastAyahToPlay(\n+    startAyah: SuraAyah,\n+    currentPage: Int,\n+    mode: Int,\n+    isDualPages: Boolean,\n+    isNotSplitOrShowingTranslation: Boolean\n+  ): SuraAyah? {\n+    val page =\n+      if (isDualPages &&\n+        isNotSplitOrShowingTranslation &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQyOTY1Nw==", "bodyText": "same comment as above", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r458429657", "createdAt": "2020-07-21T22:39:13Z", "author": {"login": "ahmedre"}, "path": "common/data/src/main/java/com/quran/data/core/QuranInfo.kt", "diffHunk": "@@ -160,16 +160,26 @@ class QuranInfo @Inject constructor(quranDataSource: QuranDataSource) {\n     return if (sura < 1 || sura > NUMBER_OF_SURAS) -1 else suraNumAyahs[sura - 1]\n   }\n \n-  fun getPageFromPosition(position: Int, dual: Boolean): Int {\n-    return if (dual) {\n+  fun getPageFromPosition(\n+    position: Int,\n+    dual: Boolean,\n+    isSplitScreen: Boolean,\n+    isShowingTranslation: Boolean", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQyOTc2Mg==", "bodyText": "here also", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r458429762", "createdAt": "2020-07-21T22:39:31Z", "author": {"login": "ahmedre"}, "path": "common/data/src/main/java/com/quran/data/core/QuranInfo.kt", "diffHunk": "@@ -160,16 +160,26 @@ class QuranInfo @Inject constructor(quranDataSource: QuranDataSource) {\n     return if (sura < 1 || sura > NUMBER_OF_SURAS) -1 else suraNumAyahs[sura - 1]\n   }\n \n-  fun getPageFromPosition(position: Int, dual: Boolean): Int {\n-    return if (dual) {\n+  fun getPageFromPosition(\n+    position: Int,\n+    dual: Boolean,\n+    isSplitScreen: Boolean,\n+    isShowingTranslation: Boolean\n+  ): Int {\n+    return if (dual && (!isSplitScreen || !isShowingTranslation)) {\n       (numberOfPagesDual - position) * 2\n     } else {\n       numberOfPages - position\n     }\n   }\n \n-  fun getPositionFromPage(page: Int, dual: Boolean): Int {\n-    return if (dual) {\n+  fun getPositionFromPage(\n+    page: Int,\n+    dual: Boolean,\n+    isSplitScreen: Boolean,\n+    isShowingTranslation: Boolean", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQzMDU1OQ==", "bodyText": "can we unify some code by making this an int - numberOfActualPagesVisible for example that's set to 1 for single page (or dual page with split turned on) and is 2 for dual mode (irrespective of translation on or off?)", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r458430559", "createdAt": "2020-07-21T22:41:34Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/PagerActivity.java", "diffHunk": "@@ -203,6 +202,7 @@\n   private int numberOfPages;\n   private int numberOfPagesDual;\n   private int defaultNavigationBarColor;\n+  private boolean isSplitScreen = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70544ae4d691e9e341872170fa5dca4878c9d2c7", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/70544ae4d691e9e341872170fa5dca4878c9d2c7", "committedDate": "2020-07-28T07:58:40Z", "message": "simplify logic and rename isNotSplitOrShowingTranslation to isNotSplitAndShowingTranslation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "702469884a9d289c237c974edda1aa66bceaf896", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/702469884a9d289c237c974edda1aa66bceaf896", "committedDate": "2020-08-29T13:04:27Z", "message": "simplify logic to determine if dual pages is shown"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9552d020cd4d7ca117149e3fd208406022cf23fc", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/9552d020cd4d7ca117149e3fd208406022cf23fc", "committedDate": "2020-08-29T13:20:47Z", "message": "merge dual page settings into a separate category"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "890f1b70dc4b0d28f683605c6e491bf0810a9148", "author": {"user": {"login": "Korogba", "name": "Yusuf Kaba"}}, "url": "https://github.com/quran/quran_android/commit/890f1b70dc4b0d28f683605c6e491bf0810a9148", "committedDate": "2020-08-29T13:50:04Z", "message": "Merge remote-tracking branch 'upstream/master' into 759-support-split-screen-page-and-translation-on-tablet\n\nConflicts:\n\tapp/src/main/java/com/quran/labs/androidquran/ui/PagerActivity.java\n\tapp/src/main/res/xml/quran_preferences.xml"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3018, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}