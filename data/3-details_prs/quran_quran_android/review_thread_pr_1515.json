{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1ODA3ODY5", "number": 1515, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMToxODozMlrOFJaeDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMToyMToxMVrOFJaeuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDE1MTgxOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/service/QuranDownloadService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMToxODozMlrOILvopA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxNjoxODozMlrOIMS7rA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE4NTcwMA==", "bodyText": "You could directly use replace without if block/check, because with contains and replace you are doing double look-up anyway.", "url": "https://github.com/quran/quran_android/pull/1515#discussion_r549185700", "createdAt": "2020-12-28T01:18:32Z", "author": {"login": "ozbek"}, "path": "app/src/main/java/com/quran/labs/androidquran/service/QuranDownloadService.java", "diffHunk": "@@ -464,10 +466,11 @@ private boolean downloadFileWrapper(String urlString, String destination,\n       }\n \n       String url = urlString;\n-      if (i > 0) {\n-        // let's try http instead of https?\n-        if (urlString.contains(\"quran.com\") || urlString.contains(\"quranicaudio.com\")) {\n-          url = urlString.replace(\"https://\", \"http://\");\n+      if (fallbackByDefault || i > 0) {\n+        if (urlString.contains(\"android.quran.com\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cff2450970199f94d17426d4c23d3e4b144524d7"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTc2NDAxMg==", "bodyText": "jazakAllah khairan - done", "url": "https://github.com/quran/quran_android/pull/1515#discussion_r549764012", "createdAt": "2020-12-29T16:18:32Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/service/QuranDownloadService.java", "diffHunk": "@@ -464,10 +466,11 @@ private boolean downloadFileWrapper(String urlString, String destination,\n       }\n \n       String url = urlString;\n-      if (i > 0) {\n-        // let's try http instead of https?\n-        if (urlString.contains(\"quran.com\") || urlString.contains(\"quranicaudio.com\")) {\n-          url = urlString.replace(\"https://\", \"http://\");\n+      if (fallbackByDefault || i > 0) {\n+        if (urlString.contains(\"android.quran.com\")) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE4NTcwMA=="}, "originalCommit": {"oid": "cff2450970199f94d17426d4c23d3e4b144524d7"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NDE1MzUyOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/pageselect/PageSelectPresenter.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMToyMToxMVrOILvpiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQxNjoxODozNlrOIMS7xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE4NTkzMQ==", "bodyText": "Elsewhere you are replaceing on error, here a separate variable. Maybe use a common convention?\nActually, I personally would prefer to have a single utility class/method for all replacements :)", "url": "https://github.com/quran/quran_android/pull/1515#discussion_r549185931", "createdAt": "2020-12-28T01:21:11Z", "author": {"login": "ozbek"}, "path": "app/src/main/java/com/quran/labs/androidquran/pageselect/PageSelectPresenter.kt", "diffHunk": "@@ -42,8 +43,10 @@ class PageSelectPresenter @Inject\n         } else if (!downloadingSet.contains(it.key)){\n           downloadingSet.add(it.key)\n           val url = \"$baseUrl/${it.key}.png\"\n+          val backupUrl = \"$backupBaseUrl/${it.key}.png\"\n           compositeDisposable.add(\n               imageUtil.downloadImage(url, previewImage)\n+                  .onErrorResumeNext(imageUtil.downloadImage(backupUrl, previewImage))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cff2450970199f94d17426d4c23d3e4b144524d7"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTc2NDAzOQ==", "bodyText": "jazakAllah khairan - done", "url": "https://github.com/quran/quran_android/pull/1515#discussion_r549764039", "createdAt": "2020-12-29T16:18:36Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/pageselect/PageSelectPresenter.kt", "diffHunk": "@@ -42,8 +43,10 @@ class PageSelectPresenter @Inject\n         } else if (!downloadingSet.contains(it.key)){\n           downloadingSet.add(it.key)\n           val url = \"$baseUrl/${it.key}.png\"\n+          val backupUrl = \"$backupBaseUrl/${it.key}.png\"\n           compositeDisposable.add(\n               imageUtil.downloadImage(url, previewImage)\n+                  .onErrorResumeNext(imageUtil.downloadImage(backupUrl, previewImage))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE4NTkzMQ=="}, "originalCommit": {"oid": "cff2450970199f94d17426d4c23d3e4b144524d7"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2062, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}