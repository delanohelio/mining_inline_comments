{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1ODA3ODY5", "number": 1515, "title": "Add a fallback url for when main urls don't work", "bodyText": "", "createdAt": "2020-12-27T13:28:36Z", "url": "https://github.com/quran/quran_android/pull/1515", "merged": true, "mergeCommit": {"oid": "8fa1f00cf3fffa97d320209affeb37e38a158313"}, "closed": true, "closedAt": "2020-12-29T17:48:47Z", "author": {"login": "ahmedre"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdqbs5kAFqTU1ODk3MDE3OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdq9tF7gBqjQxNTUxOTQwMzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4OTcwMTc4", "url": "https://github.com/quran/quran_android/pull/1515#pullrequestreview-558970178", "createdAt": "2020-12-28T01:18:32Z", "commit": {"oid": "cff2450970199f94d17426d4c23d3e4b144524d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMToxODozMlrOILvopA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMToxODozMlrOILvopA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE4NTcwMA==", "bodyText": "You could directly use replace without if block/check, because with contains and replace you are doing double look-up anyway.", "url": "https://github.com/quran/quran_android/pull/1515#discussion_r549185700", "createdAt": "2020-12-28T01:18:32Z", "author": {"login": "ozbek"}, "path": "app/src/main/java/com/quran/labs/androidquran/service/QuranDownloadService.java", "diffHunk": "@@ -464,10 +466,11 @@ private boolean downloadFileWrapper(String urlString, String destination,\n       }\n \n       String url = urlString;\n-      if (i > 0) {\n-        // let's try http instead of https?\n-        if (urlString.contains(\"quran.com\") || urlString.contains(\"quranicaudio.com\")) {\n-          url = urlString.replace(\"https://\", \"http://\");\n+      if (fallbackByDefault || i > 0) {\n+        if (urlString.contains(\"android.quran.com\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cff2450970199f94d17426d4c23d3e4b144524d7"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4OTcwMzg1", "url": "https://github.com/quran/quran_android/pull/1515#pullrequestreview-558970385", "createdAt": "2020-12-28T01:21:10Z", "commit": {"oid": "cff2450970199f94d17426d4c23d3e4b144524d7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMToyMToxMVrOILvpiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQwMToyMToxMVrOILvpiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTE4NTkzMQ==", "bodyText": "Elsewhere you are replaceing on error, here a separate variable. Maybe use a common convention?\nActually, I personally would prefer to have a single utility class/method for all replacements :)", "url": "https://github.com/quran/quran_android/pull/1515#discussion_r549185931", "createdAt": "2020-12-28T01:21:11Z", "author": {"login": "ozbek"}, "path": "app/src/main/java/com/quran/labs/androidquran/pageselect/PageSelectPresenter.kt", "diffHunk": "@@ -42,8 +43,10 @@ class PageSelectPresenter @Inject\n         } else if (!downloadingSet.contains(it.key)){\n           downloadingSet.add(it.key)\n           val url = \"$baseUrl/${it.key}.png\"\n+          val backupUrl = \"$backupBaseUrl/${it.key}.png\"\n           compositeDisposable.add(\n               imageUtil.downloadImage(url, previewImage)\n+                  .onErrorResumeNext(imageUtil.downloadImage(backupUrl, previewImage))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cff2450970199f94d17426d4c23d3e4b144524d7"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cff2450970199f94d17426d4c23d3e4b144524d7", "author": {"user": {"login": "ahmedre", "name": "Ahmed El-Helw"}}, "url": "https://github.com/quran/quran_android/commit/cff2450970199f94d17426d4c23d3e4b144524d7", "committedDate": "2020-12-27T13:16:06Z", "message": "Add a fallback url for when main urls don't work"}, "afterCommit": {"oid": "77afd0986811ab5c91e5616a6d83e26f2f3be393", "author": {"user": {"login": "ahmedre", "name": "Ahmed El-Helw"}}, "url": "https://github.com/quran/quran_android/commit/77afd0986811ab5c91e5616a6d83e26f2f3be393", "committedDate": "2020-12-29T16:14:13Z", "message": "Add a fallback url for when main urls don't work"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef8005a46d036c86ef0ec112e5bc9d7051b0d529", "author": {"user": {"login": "ahmedre", "name": "Ahmed El-Helw"}}, "url": "https://github.com/quran/quran_android/commit/ef8005a46d036c86ef0ec112e5bc9d7051b0d529", "committedDate": "2020-12-29T16:55:22Z", "message": "Add a fallback url for when main urls don't work"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "77afd0986811ab5c91e5616a6d83e26f2f3be393", "author": {"user": {"login": "ahmedre", "name": "Ahmed El-Helw"}}, "url": "https://github.com/quran/quran_android/commit/77afd0986811ab5c91e5616a6d83e26f2f3be393", "committedDate": "2020-12-29T16:14:13Z", "message": "Add a fallback url for when main urls don't work"}, "afterCommit": {"oid": "ef8005a46d036c86ef0ec112e5bc9d7051b0d529", "author": {"user": {"login": "ahmedre", "name": "Ahmed El-Helw"}}, "url": "https://github.com/quran/quran_android/commit/ef8005a46d036c86ef0ec112e5bc9d7051b0d529", "committedDate": "2020-12-29T16:55:22Z", "message": "Add a fallback url for when main urls don't work"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3045, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}