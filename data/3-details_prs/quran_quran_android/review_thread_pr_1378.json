{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzOTA5Nzg3", "number": 1378, "reviewThreads": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjozNjo0NFrOEFNJpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwNjoyMzoxNFrOEn8B1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODkzNzk4OnYy", "diffSide": "RIGHT", "path": "app/src/main/res/layout/search_widget.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjozNjo0NFrOGjTOiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQxMzoxMToxNFrOG6lBOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY2ODM2MA==", "bodyText": "It had to work out that after working on the widgets, I decided to take a read through all the comments on #458 and realised that I haven't added a button to this search widget (or the bookmarks widget either) for jumping to a Surah/Ayah.\nI can add one if you want me to (or can be addressed in a later issue/PR). To get it to work, off the top of my head, I think I'd need to modify QuranActivity slightly to get it to take an intent and open the jump dialog.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439668360", "createdAt": "2020-06-12T22:36:44Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/layout/search_widget.xml", "diffHunk": "@@ -0,0 +1,34 @@\n+<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA3NzExNQ==", "bodyText": "I've implemented this in the end, but in a different way, see ca9efb1. I got the idea from Orgzly app, though they aren't dealing with a DialogFragment, so can do things slightly simpler in a way.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r464077115", "createdAt": "2020-08-02T13:11:14Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/layout/search_widget.xml", "diffHunk": "@@ -0,0 +1,34 @@\n+<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY2ODM2MA=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk0NzY2OnYy", "diffSide": "RIGHT", "path": "app/src/main/AndroidManifest.xml", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0Mjo0OVrOGjTUGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQxMzoxMjo1NlrOG6lBzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY2OTc4NQ==", "bodyText": "In terms of testing, I've done manual testing, I haven't written any automated tests. Especially around the widgets, I wasn't immediately sure how to do this (was thinking Robolectric but it isn't used elsewhere in this repo, plus I don't know how easy it would be to use to test a widget).", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439669785", "createdAt": "2020-06-12T22:42:49Z", "author": {"login": "ismail-s"}, "path": "app/src/main/AndroidManifest.xml", "diffHunk": "@@ -163,11 +163,35 @@\n         <action android:name=\"android.intent.action.MEDIA_BUTTON\"/>\n       </intent-filter>\n     </service>\n+    <service\n+        android:name=\".widgets.WidgetService\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MDczNA==", "bodyText": "yeah - we can add Robolectric, but i am not sure how much you can test widgets with it - ideally i'd say let's just test any new \"business logic\" with just vanilla unit tests - since hopefully anything left is just the minimum required code for data / layout to the widget.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450490734", "createdAt": "2020-07-06T21:31:39Z", "author": {"login": "ahmedre"}, "path": "app/src/main/AndroidManifest.xml", "diffHunk": "@@ -163,11 +163,35 @@\n         <action android:name=\"android.intent.action.MEDIA_BUTTON\"/>\n       </intent-filter>\n     </service>\n+    <service\n+        android:name=\".widgets.WidgetService\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY2OTc4NQ=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA3NzI2MA==", "bodyText": "I've updated/added tests in BookmarkModelTest.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r464077260", "createdAt": "2020-08-02T13:12:56Z", "author": {"login": "ismail-s"}, "path": "app/src/main/AndroidManifest.xml", "diffHunk": "@@ -163,11 +163,35 @@\n         <action android:name=\"android.intent.action.MEDIA_BUTTON\"/>\n       </intent-filter>\n     </service>\n+    <service\n+        android:name=\".widgets.WidgetService\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY2OTc4NQ=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk0OTU4OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/BookmarksWidget.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0NDowMVrOGjTVNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0NDowMVrOGjTVNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MDA3MQ==", "bodyText": "I still need to add Javadocs (ok, KDoc comments).", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439670071", "createdAt": "2020-06-12T22:44:01Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/BookmarksWidget.kt", "diffHunk": "@@ -0,0 +1,65 @@\n+package com.quran.labs.androidquran\n+\n+import android.app.PendingIntent\n+import android.appwidget.AppWidgetManager\n+import android.appwidget.AppWidgetProvider\n+import android.content.ComponentName\n+import android.content.Context\n+import android.content.Intent\n+import android.net.Uri\n+import android.widget.RemoteViews\n+import com.quran.labs.androidquran.ui.PagerActivity\n+import com.quran.labs.androidquran.ui.QuranActivity\n+import com.quran.labs.androidquran.widgets.WidgetService\n+\n+class BookmarksWidget : AppWidgetProvider() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk1MTk5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/BookmarksWidget.kt", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0NTo0M1rOGjTWlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQxMzoxMzo0N1rOG6lCDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MDQyMw==", "bodyText": "I still need to change this, but am not sure exactly how to, may need to investigate/test. What I am sure of though is that updateWidget shouldn't be being called every time this method is called.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439670423", "createdAt": "2020-06-12T22:45:43Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/BookmarksWidget.kt", "diffHunk": "@@ -0,0 +1,65 @@\n+package com.quran.labs.androidquran\n+\n+import android.app.PendingIntent\n+import android.appwidget.AppWidgetManager\n+import android.appwidget.AppWidgetProvider\n+import android.content.ComponentName\n+import android.content.Context\n+import android.content.Intent\n+import android.net.Uri\n+import android.widget.RemoteViews\n+import com.quran.labs.androidquran.ui.PagerActivity\n+import com.quran.labs.androidquran.ui.QuranActivity\n+import com.quran.labs.androidquran.widgets.WidgetService\n+\n+class BookmarksWidget : AppWidgetProvider() {\n+\n+  override fun onUpdate(context: Context, appWidgetManager: AppWidgetManager, appWidgetIds: IntArray) {\n+    for (appWidgetId in appWidgetIds) {\n+      val serviceIntent = Intent(context, WidgetService::class.java).apply {\n+        putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)\n+        data = Uri.parse(toUri(Intent.URI_INTENT_SCHEME))\n+      }\n+\n+      val widget = RemoteViews(context.packageName, R.layout.bookmarks_widget)\n+\n+      var intent = Intent(context, QuranDataActivity::class.java)\n+      var pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)\n+      widget.setOnClickPendingIntent(R.id.widget_icon_button, pendingIntent)\n+\n+      intent = Intent(context, SearchActivity::class.java)\n+      pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)\n+      widget.setOnClickPendingIntent(R.id.widget_btn_search, pendingIntent)\n+\n+      intent = Intent(context, QuranActivity::class.java)\n+      intent.action = ShortcutsActivity.ACTION_JUMP_TO_LATEST\n+      pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)\n+      widget.setOnClickPendingIntent(R.id.widget_btn_go_to_quran, pendingIntent)\n+\n+      widget.setRemoteAdapter(R.id.list_view_widget, serviceIntent)\n+      val clickIntent = Intent(context, PagerActivity::class.java)\n+      val clickPendingIntent = PendingIntent\n+          .getActivity(context, 0,\n+              clickIntent,\n+              PendingIntent.FLAG_UPDATE_CURRENT)\n+      widget.setPendingIntentTemplate(R.id.list_view_widget, clickPendingIntent)\n+      widget.setEmptyView(R.id.list_view_widget, R.id.empty_view)\n+\n+      appWidgetManager.updateAppWidget(appWidgetId, widget)\n+    }\n+    super.onUpdate(context, appWidgetManager, appWidgetIds)\n+  }\n+\n+  override fun onReceive(context: Context, intent: Intent) {\n+    super.onReceive(context, intent)\n+    updateWidget(context)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MjEzOA==", "bodyText": "according to the docs:\n\nThis is called for every broadcast and before each of the above callback methods. You normally don't need to implement this method because the default AppWidgetProvider implementation filters all App Widget broadcasts and calls the above methods as appropriate.\n\nfrom here", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450492138", "createdAt": "2020-07-06T21:35:07Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/BookmarksWidget.kt", "diffHunk": "@@ -0,0 +1,65 @@\n+package com.quran.labs.androidquran\n+\n+import android.app.PendingIntent\n+import android.appwidget.AppWidgetManager\n+import android.appwidget.AppWidgetProvider\n+import android.content.ComponentName\n+import android.content.Context\n+import android.content.Intent\n+import android.net.Uri\n+import android.widget.RemoteViews\n+import com.quran.labs.androidquran.ui.PagerActivity\n+import com.quran.labs.androidquran.ui.QuranActivity\n+import com.quran.labs.androidquran.widgets.WidgetService\n+\n+class BookmarksWidget : AppWidgetProvider() {\n+\n+  override fun onUpdate(context: Context, appWidgetManager: AppWidgetManager, appWidgetIds: IntArray) {\n+    for (appWidgetId in appWidgetIds) {\n+      val serviceIntent = Intent(context, WidgetService::class.java).apply {\n+        putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)\n+        data = Uri.parse(toUri(Intent.URI_INTENT_SCHEME))\n+      }\n+\n+      val widget = RemoteViews(context.packageName, R.layout.bookmarks_widget)\n+\n+      var intent = Intent(context, QuranDataActivity::class.java)\n+      var pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)\n+      widget.setOnClickPendingIntent(R.id.widget_icon_button, pendingIntent)\n+\n+      intent = Intent(context, SearchActivity::class.java)\n+      pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)\n+      widget.setOnClickPendingIntent(R.id.widget_btn_search, pendingIntent)\n+\n+      intent = Intent(context, QuranActivity::class.java)\n+      intent.action = ShortcutsActivity.ACTION_JUMP_TO_LATEST\n+      pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)\n+      widget.setOnClickPendingIntent(R.id.widget_btn_go_to_quran, pendingIntent)\n+\n+      widget.setRemoteAdapter(R.id.list_view_widget, serviceIntent)\n+      val clickIntent = Intent(context, PagerActivity::class.java)\n+      val clickPendingIntent = PendingIntent\n+          .getActivity(context, 0,\n+              clickIntent,\n+              PendingIntent.FLAG_UPDATE_CURRENT)\n+      widget.setPendingIntentTemplate(R.id.list_view_widget, clickPendingIntent)\n+      widget.setEmptyView(R.id.list_view_widget, R.id.empty_view)\n+\n+      appWidgetManager.updateAppWidget(appWidgetId, widget)\n+    }\n+    super.onUpdate(context, appWidgetManager, appWidgetIds)\n+  }\n+\n+  override fun onReceive(context: Context, intent: Intent) {\n+    super.onReceive(context, intent)\n+    updateWidget(context)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MDQyMw=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA3NzMyNQ==", "bodyText": "I've removed this and it still seems to work fine.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r464077325", "createdAt": "2020-08-02T13:13:47Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/BookmarksWidget.kt", "diffHunk": "@@ -0,0 +1,65 @@\n+package com.quran.labs.androidquran\n+\n+import android.app.PendingIntent\n+import android.appwidget.AppWidgetManager\n+import android.appwidget.AppWidgetProvider\n+import android.content.ComponentName\n+import android.content.Context\n+import android.content.Intent\n+import android.net.Uri\n+import android.widget.RemoteViews\n+import com.quran.labs.androidquran.ui.PagerActivity\n+import com.quran.labs.androidquran.ui.QuranActivity\n+import com.quran.labs.androidquran.widgets.WidgetService\n+\n+class BookmarksWidget : AppWidgetProvider() {\n+\n+  override fun onUpdate(context: Context, appWidgetManager: AppWidgetManager, appWidgetIds: IntArray) {\n+    for (appWidgetId in appWidgetIds) {\n+      val serviceIntent = Intent(context, WidgetService::class.java).apply {\n+        putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)\n+        data = Uri.parse(toUri(Intent.URI_INTENT_SCHEME))\n+      }\n+\n+      val widget = RemoteViews(context.packageName, R.layout.bookmarks_widget)\n+\n+      var intent = Intent(context, QuranDataActivity::class.java)\n+      var pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)\n+      widget.setOnClickPendingIntent(R.id.widget_icon_button, pendingIntent)\n+\n+      intent = Intent(context, SearchActivity::class.java)\n+      pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)\n+      widget.setOnClickPendingIntent(R.id.widget_btn_search, pendingIntent)\n+\n+      intent = Intent(context, QuranActivity::class.java)\n+      intent.action = ShortcutsActivity.ACTION_JUMP_TO_LATEST\n+      pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)\n+      widget.setOnClickPendingIntent(R.id.widget_btn_go_to_quran, pendingIntent)\n+\n+      widget.setRemoteAdapter(R.id.list_view_widget, serviceIntent)\n+      val clickIntent = Intent(context, PagerActivity::class.java)\n+      val clickPendingIntent = PendingIntent\n+          .getActivity(context, 0,\n+              clickIntent,\n+              PendingIntent.FLAG_UPDATE_CURRENT)\n+      widget.setPendingIntentTemplate(R.id.list_view_widget, clickPendingIntent)\n+      widget.setEmptyView(R.id.list_view_widget, R.id.empty_view)\n+\n+      appWidgetManager.updateAppWidget(appWidgetId, widget)\n+    }\n+    super.onUpdate(context, appWidgetManager, appWidgetIds)\n+  }\n+\n+  override fun onReceive(context: Context, intent: Intent) {\n+    super.onReceive(context, intent)\n+    updateWidget(context)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MDQyMw=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk1MzcwOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/BookmarksWidget.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo0Njo1OVrOGjTXnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMTozMjo1MlrOGtnzVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MDY4NQ==", "bodyText": "I was half-tempted to change the original code to not reuse these variables, but it seemed neat, so I left it (happy to change though if people want).", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439670685", "createdAt": "2020-06-12T22:46:59Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/BookmarksWidget.kt", "diffHunk": "@@ -0,0 +1,65 @@\n+package com.quran.labs.androidquran\n+\n+import android.app.PendingIntent\n+import android.appwidget.AppWidgetManager\n+import android.appwidget.AppWidgetProvider\n+import android.content.ComponentName\n+import android.content.Context\n+import android.content.Intent\n+import android.net.Uri\n+import android.widget.RemoteViews\n+import com.quran.labs.androidquran.ui.PagerActivity\n+import com.quran.labs.androidquran.ui.QuranActivity\n+import com.quran.labs.androidquran.widgets.WidgetService\n+\n+class BookmarksWidget : AppWidgetProvider() {\n+\n+  override fun onUpdate(context: Context, appWidgetManager: AppWidgetManager, appWidgetIds: IntArray) {\n+    for (appWidgetId in appWidgetIds) {\n+      val serviceIntent = Intent(context, WidgetService::class.java).apply {\n+        putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)\n+        data = Uri.parse(toUri(Intent.URI_INTENT_SCHEME))\n+      }\n+\n+      val widget = RemoteViews(context.packageName, R.layout.bookmarks_widget)\n+\n+      var intent = Intent(context, QuranDataActivity::class.java)\n+      var pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MTIyMQ==", "bodyText": "i'd vote for val over var whenever possible since it makes things cleaner generally - though as you said, in this particular case, it's not bad - but if you want to, i wouldn't mind :)", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450491221", "createdAt": "2020-07-06T21:32:52Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/BookmarksWidget.kt", "diffHunk": "@@ -0,0 +1,65 @@\n+package com.quran.labs.androidquran\n+\n+import android.app.PendingIntent\n+import android.appwidget.AppWidgetManager\n+import android.appwidget.AppWidgetProvider\n+import android.content.ComponentName\n+import android.content.Context\n+import android.content.Intent\n+import android.net.Uri\n+import android.widget.RemoteViews\n+import com.quran.labs.androidquran.ui.PagerActivity\n+import com.quran.labs.androidquran.ui.QuranActivity\n+import com.quran.labs.androidquran.widgets.WidgetService\n+\n+class BookmarksWidget : AppWidgetProvider() {\n+\n+  override fun onUpdate(context: Context, appWidgetManager: AppWidgetManager, appWidgetIds: IntArray) {\n+    for (appWidgetId in appWidgetIds) {\n+      val serviceIntent = Intent(context, WidgetService::class.java).apply {\n+        putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId)\n+        data = Uri.parse(toUri(Intent.URI_INTENT_SCHEME))\n+      }\n+\n+      val widget = RemoteViews(context.packageName, R.layout.bookmarks_widget)\n+\n+      var intent = Intent(context, QuranDataActivity::class.java)\n+      var pendingIntent = PendingIntent.getActivity(context, 0, intent, 0)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MDY4NQ=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk2MTE4OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/SearchActivity.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo1MjoxMVrOGjTb_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMTozOToyNlrOGtn94g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MTgwNw==", "bodyText": "This took me a bunch of debugging and going through Android docs to figure out to add this code. Without it, if you do a search with results and then a search without results, the second search causes the app to crash (wasn't an issue before as there wasn't a search box in this activity then).", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439671807", "createdAt": "2020-06-12T22:52:11Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/SearchActivity.java", "diffHunk": "@@ -169,6 +174,9 @@ public void onLoadFinished(@NonNull Loader<Cursor> loader, Cursor cursor) {\n         buttonGetTranslations.setText(R.string.get_translations);\n         buttonGetTranslations.setVisibility(View.VISIBLE);\n       }\n+      if (adapter != null) {\n+        adapter.swapCursor(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MzkyMg==", "bodyText": "wow, great catch!\nto be honest we should stop using CursorAdapter here completely :( this whole class should be rewritten at some point :(", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450493922", "createdAt": "2020-07-06T21:39:26Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/SearchActivity.java", "diffHunk": "@@ -169,6 +174,9 @@ public void onLoadFinished(@NonNull Loader<Cursor> loader, Cursor cursor) {\n         buttonGetTranslations.setText(R.string.get_translations);\n         buttonGetTranslations.setVisibility(View.VISIBLE);\n       }\n+      if (adapter != null) {\n+        adapter.swapCursor(null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MTgwNw=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk2NjIxOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/database/BookmarksDBAdapter.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo1NjowOFrOGjTfCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwMDowNjozM1rOG6o4yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MjU4Nw==", "bodyText": "I don't like this class being coupled to BookmarksWidget. It feels to me like there should be something in between, maybe something where this adapter fires out some stream of events and BookmarksWidget subscribes to that stream.\n@ahmedre do you have some ideas on the best way to do this (that also fits with how things are done in the rest of the app)?", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439672587", "createdAt": "2020-06-12T22:56:08Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/database/BookmarksDBAdapter.java", "diffHunk": "@@ -144,6 +147,7 @@ public void replaceRecentRangeWithPage(int deleteRangeStart, int deleteRangeEnd,\n   }\n \n   public void addRecentPage(int page) {\n+    BookmarksWidget.updateWidget(context);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5NTQyOQ==", "bodyText": "take a look at BookmarkPresenter i think - there's an rx observable there. we can just subscribe to it and refresh then - not sure what the right place to subscribe is, but in worst case, some object that subscribes whenever there is at least one active widget", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450495429", "createdAt": "2020-07-06T21:43:20Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/database/BookmarksDBAdapter.java", "diffHunk": "@@ -144,6 +147,7 @@ public void replaceRecentRangeWithPage(int deleteRangeStart, int deleteRangeEnd,\n   }\n \n   public void addRecentPage(int page) {\n+    BookmarksWidget.updateWidget(context);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MjU4Nw=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA3Nzg3NQ==", "bodyText": "Did some thinking around this and tried one or two different things, ended up doing this.\nWidgets don't seem to keep their apps running in the background (I think you essentially give a list of instructions to the launchers and they create the views that make up the widgets for you), so on app startup, at some point I think the app needs to subscribe BookmarksWidget up to any updates to bookmarks (if such widgets are being used). I've tried to do this in the simplest/minimal way possible.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r464077875", "createdAt": "2020-08-02T13:19:30Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/database/BookmarksDBAdapter.java", "diffHunk": "@@ -144,6 +147,7 @@ public void replaceRecentRangeWithPage(int deleteRangeStart, int deleteRangeEnd,\n   }\n \n   public void addRecentPage(int page) {\n+    BookmarksWidget.updateWidget(context);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MjU4Nw=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE0MDQ5MA==", "bodyText": "i think this is good but not sure this should live in BookmarksModel - seems like bookmarks model should only deal with bookmarks, and the widget updater is something that should (and does) subscribe to it so should not live in this class (but should live in its own class). though this way, you'd have to \"start up\" that class whenever the app starts if widgets are enabled as you mentioned.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r464140490", "createdAt": "2020-08-03T00:06:33Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/database/BookmarksDBAdapter.java", "diffHunk": "@@ -144,6 +147,7 @@ public void replaceRecentRangeWithPage(int deleteRangeStart, int deleteRangeEnd,\n   }\n \n   public void addRecentPage(int page) {\n+    BookmarksWidget.updateWidget(context);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MjU4Nw=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk3MTYwOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjo1OTo1MlrOGjTiPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQxMzoyMjoyMVrOG6lFVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MzQwNw==", "bodyText": "The original code included both Ayah and page bookmarks in the bookmarks widget, but treated all of them as page bookmarks in terms of display and handling clicks. I've changed this to just show page bookmarks. A possible enhancement is to display Ayah bookmarks as well (this could be done multiple ways, or a config activity could even be added to the bookmarks widget to allow specifying what bookmark types/tags to display bookmarks for), but that feels to me like future enhancement.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439673407", "createdAt": "2020-06-12T22:59:52Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Context\n+import android.content.Intent\n+import android.os.Bundle\n+import android.widget.RemoteViews\n+import android.widget.RemoteViewsService.RemoteViewsFactory\n+import com.quran.data.core.QuranInfo\n+import com.quran.labs.androidquran.QuranApplication\n+import com.quran.labs.androidquran.R\n+import com.quran.labs.androidquran.data.QuranDisplayData\n+import com.quran.labs.androidquran.database.BookmarksDBAdapter\n+import javax.inject.Inject\n+\n+class WidgetListProvider(private val context: Context) : RemoteViewsFactory {\n+\n+  private var suraPageItemList: List<SuraPageItem> = listOf()\n+\n+  @Inject\n+  lateinit var quranInfo: QuranInfo\n+\n+  @Inject\n+  lateinit var quranDisplayData: QuranDisplayData\n+\n+  init {\n+    (context.applicationContext as QuranApplication).applicationComponent.inject(this)\n+    populateListItem()\n+  }\n+\n+  private fun populateListItem() {\n+    val appContext = context.applicationContext\n+    val mBookmarksDBAdapter = BookmarksDBAdapter(appContext, quranInfo.numberOfPages)\n+    val bookmarksList = mBookmarksDBAdapter.getBookmarks(BookmarksDBAdapter.SORT_DATE_ADDED)\n+    suraPageItemList = bookmarksList.filter { it.isPageBookmark() }.map {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5NTgyOQ==", "bodyText": "what makes it tricky in this case to handle both (even if we say ui handling is identical for the time being with the exception that one shows an ayah number and one doesn't?)", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450495829", "createdAt": "2020-07-06T21:44:26Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Context\n+import android.content.Intent\n+import android.os.Bundle\n+import android.widget.RemoteViews\n+import android.widget.RemoteViewsService.RemoteViewsFactory\n+import com.quran.data.core.QuranInfo\n+import com.quran.labs.androidquran.QuranApplication\n+import com.quran.labs.androidquran.R\n+import com.quran.labs.androidquran.data.QuranDisplayData\n+import com.quran.labs.androidquran.database.BookmarksDBAdapter\n+import javax.inject.Inject\n+\n+class WidgetListProvider(private val context: Context) : RemoteViewsFactory {\n+\n+  private var suraPageItemList: List<SuraPageItem> = listOf()\n+\n+  @Inject\n+  lateinit var quranInfo: QuranInfo\n+\n+  @Inject\n+  lateinit var quranDisplayData: QuranDisplayData\n+\n+  init {\n+    (context.applicationContext as QuranApplication).applicationComponent.inject(this)\n+    populateListItem()\n+  }\n+\n+  private fun populateListItem() {\n+    val appContext = context.applicationContext\n+    val mBookmarksDBAdapter = BookmarksDBAdapter(appContext, quranInfo.numberOfPages)\n+    val bookmarksList = mBookmarksDBAdapter.getBookmarks(BookmarksDBAdapter.SORT_DATE_ADDED)\n+    suraPageItemList = bookmarksList.filter { it.isPageBookmark() }.map {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MzQwNw=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA3ODE2Nw==", "bodyText": "You're right, it can be done, and I've done this in 8976ec0 and 3b7df4e (the behaviour around the green highlighting took a while to understand, it was very odd, it might have been specific to my launcher (I think stock Google launcher), but the fix is pretty simple/general).", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r464078167", "createdAt": "2020-08-02T13:22:21Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Context\n+import android.content.Intent\n+import android.os.Bundle\n+import android.widget.RemoteViews\n+import android.widget.RemoteViewsService.RemoteViewsFactory\n+import com.quran.data.core.QuranInfo\n+import com.quran.labs.androidquran.QuranApplication\n+import com.quran.labs.androidquran.R\n+import com.quran.labs.androidquran.data.QuranDisplayData\n+import com.quran.labs.androidquran.database.BookmarksDBAdapter\n+import javax.inject.Inject\n+\n+class WidgetListProvider(private val context: Context) : RemoteViewsFactory {\n+\n+  private var suraPageItemList: List<SuraPageItem> = listOf()\n+\n+  @Inject\n+  lateinit var quranInfo: QuranInfo\n+\n+  @Inject\n+  lateinit var quranDisplayData: QuranDisplayData\n+\n+  init {\n+    (context.applicationContext as QuranApplication).applicationComponent.inject(this)\n+    populateListItem()\n+  }\n+\n+  private fun populateListItem() {\n+    val appContext = context.applicationContext\n+    val mBookmarksDBAdapter = BookmarksDBAdapter(appContext, quranInfo.numberOfPages)\n+    val bookmarksList = mBookmarksDBAdapter.getBookmarks(BookmarksDBAdapter.SORT_DATE_ADDED)\n+    suraPageItemList = bookmarksList.filter { it.isPageBookmark() }.map {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3MzQwNw=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk3Mzk5OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzowMTozOFrOGjTjwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQxMzoyMzo1N1rOG6lFwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3Mzc5NA==", "bodyText": "I could change this to sort by location if people want, that may seem more sensible.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439673794", "createdAt": "2020-06-12T23:01:38Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Context\n+import android.content.Intent\n+import android.os.Bundle\n+import android.widget.RemoteViews\n+import android.widget.RemoteViewsService.RemoteViewsFactory\n+import com.quran.data.core.QuranInfo\n+import com.quran.labs.androidquran.QuranApplication\n+import com.quran.labs.androidquran.R\n+import com.quran.labs.androidquran.data.QuranDisplayData\n+import com.quran.labs.androidquran.database.BookmarksDBAdapter\n+import javax.inject.Inject\n+\n+class WidgetListProvider(private val context: Context) : RemoteViewsFactory {\n+\n+  private var suraPageItemList: List<SuraPageItem> = listOf()\n+\n+  @Inject\n+  lateinit var quranInfo: QuranInfo\n+\n+  @Inject\n+  lateinit var quranDisplayData: QuranDisplayData\n+\n+  init {\n+    (context.applicationContext as QuranApplication).applicationComponent.inject(this)\n+    populateListItem()\n+  }\n+\n+  private fun populateListItem() {\n+    val appContext = context.applicationContext\n+    val mBookmarksDBAdapter = BookmarksDBAdapter(appContext, quranInfo.numberOfPages)\n+    val bookmarksList = mBookmarksDBAdapter.getBookmarks(BookmarksDBAdapter.SORT_DATE_ADDED)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA3ODI3NA==", "bodyText": "I made this change.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r464078274", "createdAt": "2020-08-02T13:23:57Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Context\n+import android.content.Intent\n+import android.os.Bundle\n+import android.widget.RemoteViews\n+import android.widget.RemoteViewsService.RemoteViewsFactory\n+import com.quran.data.core.QuranInfo\n+import com.quran.labs.androidquran.QuranApplication\n+import com.quran.labs.androidquran.R\n+import com.quran.labs.androidquran.data.QuranDisplayData\n+import com.quran.labs.androidquran.database.BookmarksDBAdapter\n+import javax.inject.Inject\n+\n+class WidgetListProvider(private val context: Context) : RemoteViewsFactory {\n+\n+  private var suraPageItemList: List<SuraPageItem> = listOf()\n+\n+  @Inject\n+  lateinit var quranInfo: QuranInfo\n+\n+  @Inject\n+  lateinit var quranDisplayData: QuranDisplayData\n+\n+  init {\n+    (context.applicationContext as QuranApplication).applicationComponent.inject(this)\n+    populateListItem()\n+  }\n+\n+  private fun populateListItem() {\n+    val appContext = context.applicationContext\n+    val mBookmarksDBAdapter = BookmarksDBAdapter(appContext, quranInfo.numberOfPages)\n+    val bookmarksList = mBookmarksDBAdapter.getBookmarks(BookmarksDBAdapter.SORT_DATE_ADDED)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3Mzc5NA=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk3NTE2OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetService.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzowMjoyM1rOGjTkcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzowMjoyM1rOGjTkcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3Mzk2OA==", "bodyText": "Reminder to self to tidy this up.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439673968", "createdAt": "2020-06-12T23:02:23Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetService.kt", "diffHunk": "@@ -0,0 +1,14 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Intent\n+import android.widget.RemoteViewsService\n+\n+class WidgetService : RemoteViewsService() {\n+  /*\n+* So pretty simple just defining the Adapter of the listview\n+* here Adapter is ListProvider\n+* */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk3NzA2OnYy", "diffSide": "RIGHT", "path": "app/src/main/res/xml/bookmarks_widget_info.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzowMzo0N1rOGjTlkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzowMzo0N1rOGjTlkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3NDI1Nw==", "bodyText": "Reminder to self to look into updating these preview images.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439674257", "createdAt": "2020-06-12T23:03:47Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/xml/bookmarks_widget_info.xml", "diffHunk": "@@ -0,0 +1,10 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<appwidget-provider xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:initialKeyguardLayout=\"@layout/bookmarks_widget\"\n+    android:initialLayout=\"@layout/bookmarks_widget\"\n+    android:minHeight=\"110dp\"\n+    android:minWidth=\"180dp\"\n+    android:previewImage=\"@drawable/bookmarks_appwidget_preview\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk4MDk2OnYy", "diffSide": "RIGHT", "path": "app/src/main/res/layout/bookmarks_widget_list_row.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzowNjo0NlrOGjToDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzowNjo0NlrOGjToDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3NDg5Mg==", "bodyText": "Reminder to self to check if there's a better margin constant to use. And to more generally go over this file as a whole.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439674892", "createdAt": "2020-06-12T23:06:46Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/layout/bookmarks_widget_list_row.xml", "diffHunk": "@@ -0,0 +1,44 @@\n+<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+    xmlns:tools=\"http://schemas.android.com/tools\"\n+    android:id=\"@+id/widget_item\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"wrap_content\"\n+    android:layout_gravity=\"center_vertical\"\n+    android:layout_marginBottom=\"8dp\"\n+    android:layout_marginTop=\"8dp\"\n+    android:orientation=\"horizontal\">\n+\n+  <ImageView\n+      android:id=\"@+id/widget_favorite_icon\"\n+      android:layout_width=\"wrap_content\"\n+      android:layout_height=\"wrap_content\"\n+      android:layout_gravity=\"center_vertical\"\n+      android:layout_marginLeft=\"@dimen/audiobar_separator_padding\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk4MjgxOnYy", "diffSide": "RIGHT", "path": "app/src/main/res/layout/search.xml", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzowODoxN1rOGjTpLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNlQxNDo0NDoyN1rOHYgrzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3NTE4Mg==", "bodyText": "#845 had an EditText here, I changed it to a SearchView.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439675182", "createdAt": "2020-06-12T23:08:17Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/layout/search.xml", "diffHunk": "@@ -9,18 +9,28 @@\n               android:textSize=\"17sp\"\n               android:visibility=\"gone\"\n               android:textColor=\"?android:textColorPrimary\" />\n-    <Button android:id=\"@+id/btnGetTranslations\" android:text=\"@string/menu_get_translations\" \n+    <Button android:id=\"@+id/btnGetTranslations\" android:text=\"@string/menu_get_translations\"\n     \tandroid:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:visibility=\"gone\"/>\n-    <TextView android:id=\"@+id/search_area\"\n-            android:textColor=\"?android:textColorPrimary\"\n-            android:textSize=\"17sp\"\n-            android:text=\"@string/search_key\"\n-            android:background=\"@android:drawable/title_bar\"\n-            android:layout_width=\"fill_parent\"\n-            android:layout_height=\"wrap_content\" />\n+\n+  <androidx.appcompat.widget.SearchView", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk1NTAyMw==", "bodyText": "Not directly related, but IMHO this should actually go to toolbar menu.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r491955023", "createdAt": "2020-09-21T11:00:34Z", "author": {"login": "ozbek"}, "path": "app/src/main/res/layout/search.xml", "diffHunk": "@@ -9,18 +9,28 @@\n               android:textSize=\"17sp\"\n               android:visibility=\"gone\"\n               android:textColor=\"?android:textColorPrimary\" />\n-    <Button android:id=\"@+id/btnGetTranslations\" android:text=\"@string/menu_get_translations\" \n+    <Button android:id=\"@+id/btnGetTranslations\" android:text=\"@string/menu_get_translations\"\n     \tandroid:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:visibility=\"gone\"/>\n-    <TextView android:id=\"@+id/search_area\"\n-            android:textColor=\"?android:textColorPrimary\"\n-            android:textSize=\"17sp\"\n-            android:text=\"@string/search_key\"\n-            android:background=\"@android:drawable/title_bar\"\n-            android:layout_width=\"fill_parent\"\n-            android:layout_height=\"wrap_content\" />\n+\n+  <androidx.appcompat.widget.SearchView", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3NTE4Mg=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTMwMTI0OQ==", "bodyText": "I agree (if only I'd thought of this before), I'm taking a look into this, I've got something mostly working, not the prettiest code at the moment though. I want to test more around it and see if I can improve the code first.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r495301249", "createdAt": "2020-09-25T22:59:52Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/layout/search.xml", "diffHunk": "@@ -9,18 +9,28 @@\n               android:textSize=\"17sp\"\n               android:visibility=\"gone\"\n               android:textColor=\"?android:textColorPrimary\" />\n-    <Button android:id=\"@+id/btnGetTranslations\" android:text=\"@string/menu_get_translations\" \n+    <Button android:id=\"@+id/btnGetTranslations\" android:text=\"@string/menu_get_translations\"\n     \tandroid:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:visibility=\"gone\"/>\n-    <TextView android:id=\"@+id/search_area\"\n-            android:textColor=\"?android:textColorPrimary\"\n-            android:textSize=\"17sp\"\n-            android:text=\"@string/search_key\"\n-            android:background=\"@android:drawable/title_bar\"\n-            android:layout_width=\"fill_parent\"\n-            android:layout_height=\"wrap_content\" />\n+\n+  <androidx.appcompat.widget.SearchView", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3NTE4Mg=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQ2MzM3Mw==", "bodyText": "@ozbek I've pushed f72bc5b and f82d461.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r495463373", "createdAt": "2020-09-26T14:44:27Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/layout/search.xml", "diffHunk": "@@ -9,18 +9,28 @@\n               android:textSize=\"17sp\"\n               android:visibility=\"gone\"\n               android:textColor=\"?android:textColorPrimary\" />\n-    <Button android:id=\"@+id/btnGetTranslations\" android:text=\"@string/menu_get_translations\" \n+    <Button android:id=\"@+id/btnGetTranslations\" android:text=\"@string/menu_get_translations\"\n     \tandroid:layout_width=\"match_parent\" android:layout_height=\"wrap_content\" android:visibility=\"gone\"/>\n-    <TextView android:id=\"@+id/search_area\"\n-            android:textColor=\"?android:textColorPrimary\"\n-            android:textSize=\"17sp\"\n-            android:text=\"@string/search_key\"\n-            android:background=\"@android:drawable/title_bar\"\n-            android:layout_width=\"fill_parent\"\n-            android:layout_height=\"wrap_content\" />\n+\n+  <androidx.appcompat.widget.SearchView", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3NTE4Mg=="}, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk4NzMzOnYy", "diffSide": "RIGHT", "path": "app/src/main/res/layout/search_widget.xml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzoxMjoxMVrOGjTsLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzoxMjoxMVrOGjTsLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3NTk0OQ==", "bodyText": "I spent a bit of time trying to make the widget have round corners, and ended up setting this custom background. It's not really a good way of doing this though, I was tempted to switch it back to as it was in #845, but thought I'd put it in this PR instead and see what people think. I haven't rounded the corners of the bookmarks widget, with this approach it felt like it'd probably be more complicated (and I think that widget looks ok as-is).", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439675949", "createdAt": "2020-06-12T23:12:11Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/layout/search_widget.xml", "diffHunk": "@@ -0,0 +1,34 @@\n+<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"wrap_content\"\n+    android:background=\"@drawable/search_widget_background\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk4ODY1OnYy", "diffSide": "RIGHT", "path": "app/src/main/res/values/colors.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzoxMzoxOVrOGjTs_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzoxMzoxOVrOGjTs_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3NjE1OA==", "bodyText": "Reminder to self to check why these changes were made to this file and revert if necessary.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439676158", "createdAt": "2020-06-12T23:13:19Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/values/colors.xml", "diffHunk": "@@ -11,12 +11,12 @@\n   <color name=\"title_color\">#ffffffff</color>\n   <color name=\"sura_number_color\">#7fffffff</color>\n   <color name=\"sura_details_color\">#b2ffffff</color>\n-  <color name=\"transparent_actionbar_color\">#AA000000</color>\n+  <color name=\"transparent_actionbar_color\">#aa000000</color>\n   <color name=\"panel_background_color\">#ff424242</color>\n   <color name=\"translation_hdr_color\">#ff777777</color>\n   <color name=\"translation_sura_header\">#fff1ecd8</color>\n   <color name=\"translation_sura_header_night\">#ff424242</color>\n-  <color name=\"translation_verse_text_color\">#ff858383</color>\n+  <color name=\"translation_verse_text_color\">#858383</color>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczODk4OTcwOnYy", "diffSide": "RIGHT", "path": "app/src/main/res/values/strings.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzoxNDozNVrOGjTttg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMzoxNDozNVrOGjTttg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY3NjM0Mg==", "bodyText": "Reminder to self to remove these strings if they're not being used.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r439676342", "createdAt": "2020-06-12T23:14:35Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/values/strings.xml", "diffHunk": "@@ -407,6 +407,9 @@\n \n   <!-- format strings -->\n   <string name=\"sura_ayah\" translatable=\"false\">%1$d:%2$d</string>\n+  <string name=\"bookmarks_appwidget_text\">Quran Bookmarks</string>\n+  <string name=\"add_widget\">Add widget</string>\n+  <string name=\"search_appwidget_text\">Quran Search </string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ce3a7912baa16e08fda881093e2599fccb528744"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwODY0MzM3OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMTo0NDozM1rOGtoFfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMjoyOTo1MlrOGtpGag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5NTg3MA==", "bodyText": "remove", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450495870", "createdAt": "2020-07-06T21:44:33Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Context\n+import android.content.Intent\n+import android.os.Bundle\n+import android.widget.RemoteViews\n+import android.widget.RemoteViewsService.RemoteViewsFactory\n+import com.quran.data.core.QuranInfo\n+import com.quran.labs.androidquran.QuranApplication\n+import com.quran.labs.androidquran.R\n+import com.quran.labs.androidquran.data.QuranDisplayData\n+import com.quran.labs.androidquran.database.BookmarksDBAdapter\n+import javax.inject.Inject\n+\n+class WidgetListProvider(private val context: Context) : RemoteViewsFactory {\n+\n+  private var suraPageItemList: List<SuraPageItem> = listOf()\n+\n+  @Inject\n+  lateinit var quranInfo: QuranInfo\n+\n+  @Inject\n+  lateinit var quranDisplayData: QuranDisplayData\n+\n+  init {\n+    (context.applicationContext as QuranApplication).applicationComponent.inject(this)\n+    populateListItem()\n+  }\n+\n+  private fun populateListItem() {\n+    val appContext = context.applicationContext\n+    val mBookmarksDBAdapter = BookmarksDBAdapter(appContext, quranInfo.numberOfPages)\n+    val bookmarksList = mBookmarksDBAdapter.getBookmarks(BookmarksDBAdapter.SORT_DATE_ADDED)\n+    suraPageItemList = bookmarksList.filter { it.isPageBookmark() }.map {\n+      SuraPageItem(sura = quranDisplayData.getSuraNameString(appContext, it.page), page = it.page)\n+    }\n+  }\n+\n+  override fun onCreate() = Unit\n+  override fun onDestroy() = Unit", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7400723d3f57a75d0524113cafd626d8c2d9370"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDUxMjQ5MA==", "bodyText": "I don't think I can, it's part of the interface.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450512490", "createdAt": "2020-07-06T22:29:52Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Context\n+import android.content.Intent\n+import android.os.Bundle\n+import android.widget.RemoteViews\n+import android.widget.RemoteViewsService.RemoteViewsFactory\n+import com.quran.data.core.QuranInfo\n+import com.quran.labs.androidquran.QuranApplication\n+import com.quran.labs.androidquran.R\n+import com.quran.labs.androidquran.data.QuranDisplayData\n+import com.quran.labs.androidquran.database.BookmarksDBAdapter\n+import javax.inject.Inject\n+\n+class WidgetListProvider(private val context: Context) : RemoteViewsFactory {\n+\n+  private var suraPageItemList: List<SuraPageItem> = listOf()\n+\n+  @Inject\n+  lateinit var quranInfo: QuranInfo\n+\n+  @Inject\n+  lateinit var quranDisplayData: QuranDisplayData\n+\n+  init {\n+    (context.applicationContext as QuranApplication).applicationComponent.inject(this)\n+    populateListItem()\n+  }\n+\n+  private fun populateListItem() {\n+    val appContext = context.applicationContext\n+    val mBookmarksDBAdapter = BookmarksDBAdapter(appContext, quranInfo.numberOfPages)\n+    val bookmarksList = mBookmarksDBAdapter.getBookmarks(BookmarksDBAdapter.SORT_DATE_ADDED)\n+    suraPageItemList = bookmarksList.filter { it.isPageBookmark() }.map {\n+      SuraPageItem(sura = quranDisplayData.getSuraNameString(appContext, it.page), page = it.page)\n+    }\n+  }\n+\n+  override fun onCreate() = Unit\n+  override fun onDestroy() = Unit", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5NTg3MA=="}, "originalCommit": {"oid": "c7400723d3f57a75d0524113cafd626d8c2d9370"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwODY0OTA1OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMTo0Njo0NVrOGtoIyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMjozMzowMFrOGtpKbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5NjcxMw==", "bodyText": "is there no recycling that we can get with this?", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450496713", "createdAt": "2020-07-06T21:46:45Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Context\n+import android.content.Intent\n+import android.os.Bundle\n+import android.widget.RemoteViews\n+import android.widget.RemoteViewsService.RemoteViewsFactory\n+import com.quran.data.core.QuranInfo\n+import com.quran.labs.androidquran.QuranApplication\n+import com.quran.labs.androidquran.R\n+import com.quran.labs.androidquran.data.QuranDisplayData\n+import com.quran.labs.androidquran.database.BookmarksDBAdapter\n+import javax.inject.Inject\n+\n+class WidgetListProvider(private val context: Context) : RemoteViewsFactory {\n+\n+  private var suraPageItemList: List<SuraPageItem> = listOf()\n+\n+  @Inject\n+  lateinit var quranInfo: QuranInfo\n+\n+  @Inject\n+  lateinit var quranDisplayData: QuranDisplayData\n+\n+  init {\n+    (context.applicationContext as QuranApplication).applicationComponent.inject(this)\n+    populateListItem()\n+  }\n+\n+  private fun populateListItem() {\n+    val appContext = context.applicationContext\n+    val mBookmarksDBAdapter = BookmarksDBAdapter(appContext, quranInfo.numberOfPages)\n+    val bookmarksList = mBookmarksDBAdapter.getBookmarks(BookmarksDBAdapter.SORT_DATE_ADDED)\n+    suraPageItemList = bookmarksList.filter { it.isPageBookmark() }.map {\n+      SuraPageItem(sura = quranDisplayData.getSuraNameString(appContext, it.page), page = it.page)\n+    }\n+  }\n+\n+  override fun onCreate() = Unit\n+  override fun onDestroy() = Unit\n+\n+  override fun onDataSetChanged() {\n+    populateListItem()\n+  }\n+\n+  override fun getCount() = suraPageItemList.size\n+\n+  override fun getItemId(position: Int) = position.toLong()\n+\n+  override fun hasStableIds() = false\n+\n+  /*\n+  *Similar to getView of Adapter where instead of View\n+  *we return RemoteViews\n+  *\n+  */\n+  override fun getViewAt(position: Int): RemoteViews {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7400723d3f57a75d0524113cafd626d8c2d9370"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDUxMzUxNw==", "bodyText": "I don't think so, looking at the interface methods. It doesn't seem like the Adapter#getView method.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r450513517", "createdAt": "2020-07-06T22:33:00Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/widgets/WidgetListProvider.kt", "diffHunk": "@@ -0,0 +1,77 @@\n+package com.quran.labs.androidquran.widgets\n+\n+import android.content.Context\n+import android.content.Intent\n+import android.os.Bundle\n+import android.widget.RemoteViews\n+import android.widget.RemoteViewsService.RemoteViewsFactory\n+import com.quran.data.core.QuranInfo\n+import com.quran.labs.androidquran.QuranApplication\n+import com.quran.labs.androidquran.R\n+import com.quran.labs.androidquran.data.QuranDisplayData\n+import com.quran.labs.androidquran.database.BookmarksDBAdapter\n+import javax.inject.Inject\n+\n+class WidgetListProvider(private val context: Context) : RemoteViewsFactory {\n+\n+  private var suraPageItemList: List<SuraPageItem> = listOf()\n+\n+  @Inject\n+  lateinit var quranInfo: QuranInfo\n+\n+  @Inject\n+  lateinit var quranDisplayData: QuranDisplayData\n+\n+  init {\n+    (context.applicationContext as QuranApplication).applicationComponent.inject(this)\n+    populateListItem()\n+  }\n+\n+  private fun populateListItem() {\n+    val appContext = context.applicationContext\n+    val mBookmarksDBAdapter = BookmarksDBAdapter(appContext, quranInfo.numberOfPages)\n+    val bookmarksList = mBookmarksDBAdapter.getBookmarks(BookmarksDBAdapter.SORT_DATE_ADDED)\n+    suraPageItemList = bookmarksList.filter { it.isPageBookmark() }.map {\n+      SuraPageItem(sura = quranDisplayData.getSuraNameString(appContext, it.page), page = it.page)\n+    }\n+  }\n+\n+  override fun onCreate() = Unit\n+  override fun onDestroy() = Unit\n+\n+  override fun onDataSetChanged() {\n+    populateListItem()\n+  }\n+\n+  override fun getCount() = suraPageItemList.size\n+\n+  override fun getItemId(position: Int) = position.toLong()\n+\n+  override fun hasStableIds() = false\n+\n+  /*\n+  *Similar to getView of Adapter where instead of View\n+  *we return RemoteViews\n+  *\n+  */\n+  override fun getViewAt(position: Int): RemoteViews {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5NjcxMw=="}, "originalCommit": {"oid": "c7400723d3f57a75d0524113cafd626d8c2d9370"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5ODEwODMyOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/widget/BookmarksWidgetUpdater.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQxMzo1NzowMlrOG6lRvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwMDowNDozNVrOG6o37Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA4MTM0Mg==", "bodyText": "These files I moved into a widget subpackage. There's already a subpackage called widgets, maybe that subpackage should be renamed to views instead?", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r464081342", "createdAt": "2020-08-02T13:57:02Z", "author": {"login": "ismail-s"}, "path": "app/src/main/java/com/quran/labs/androidquran/widget/BookmarksWidgetUpdater.kt", "diffHunk": "@@ -0,0 +1,26 @@\n+package com.quran.labs.androidquran.widget", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "426380bebc6f7f8029176fa22b2dd2a0bc048a76"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDE0MDI2OQ==", "bodyText": "view singular, yes - but that can be done later outside of this PR", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r464140269", "createdAt": "2020-08-03T00:04:35Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/widget/BookmarksWidgetUpdater.kt", "diffHunk": "@@ -0,0 +1,26 @@\n+package com.quran.labs.androidquran.widget", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDA4MTM0Mg=="}, "originalCommit": {"oid": "426380bebc6f7f8029176fa22b2dd2a0bc048a76"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEwMzEzNDMwOnYy", "diffSide": "RIGHT", "path": "app/src/main/res/values/strings.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQwNjoyMzoxNFrOHYv3lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQyMDozNjoxMVrOHZOrZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTcxMjE1MQ==", "bodyText": "Can you please merge this with bookmarks_list_empty string? Perhaps, simply by rename that one. If you want, you  may rephrase it also. E.g.:\n<string name=\"no_bookmarks\">No bookmarks yet</string>", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r495712151", "createdAt": "2020-09-28T06:23:14Z", "author": {"login": "ozbek"}, "path": "app/src/main/res/values/strings.xml", "diffHunk": "@@ -410,4 +410,7 @@\n   <!-- notification channel names [CHAR LIMIT=40] -->\n   <string name=\"notification_channel_download\">Quran Downloads</string>\n   <string name=\"notification_channel_audio\">Quran Recitation</string>\n+\n+  <!-- Widgets -->\n+  <string name=\"no_bookmarks\">No bookmarks currently set</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "230e3b082a08fcadf2297dba5e1451838d42c3ac"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjIxNjkzNA==", "bodyText": "If it's fine with you, I've deleted no_bookmarks and am just using bookmarks_list_empty as-is. Wording seems good enough to me, and not changing the wording means no updating translations.\nAlso, I couldn't find any other code using bookmarks_list_empty, so it's good you've spotted this.", "url": "https://github.com/quran/quran_android/pull/1378#discussion_r496216934", "createdAt": "2020-09-28T20:36:11Z", "author": {"login": "ismail-s"}, "path": "app/src/main/res/values/strings.xml", "diffHunk": "@@ -410,4 +410,7 @@\n   <!-- notification channel names [CHAR LIMIT=40] -->\n   <string name=\"notification_channel_download\">Quran Downloads</string>\n   <string name=\"notification_channel_audio\">Quran Recitation</string>\n+\n+  <!-- Widgets -->\n+  <string name=\"no_bookmarks\">No bookmarks currently set</string>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTcxMjE1MQ=="}, "originalCommit": {"oid": "230e3b082a08fcadf2297dba5e1451838d42c3ac"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2024, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}