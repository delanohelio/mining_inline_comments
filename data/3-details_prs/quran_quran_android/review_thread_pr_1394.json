{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0NDA2NzQ2", "number": 1394, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjozODo1M1rOEQ0mfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjo0MTozNFrOEQ0pLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MDc0NDk1OnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/util/AudioUtils.kt", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjozODo1M1rOG1MUTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOVQxMzoyNTozMlrOHJbfmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQyOTUxNw==", "bodyText": "this isn't right for cases where we are tablet in translation mode without the split setting - in that case, we should still treat it as 2 pages whereas this code will treat it as 1.", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r458429517", "createdAt": "2020-07-21T22:38:53Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/util/AudioUtils.kt", "diffHunk": "@@ -107,17 +107,25 @@ constructor(private val quranInfo: QuranInfo, private val quranFileUtils: QuranF\n     return quranFileUtils.gaplessDatabaseRootUrl + \"/\" + dbName\n   }\n \n-  fun getLastAyahToPlay(startAyah: SuraAyah,\n-                        currentPage: Int,\n-                        mode: Int,\n-                        isDualPages: Boolean): SuraAyah? {\n-    val page = if (isDualPages && mode == LookAheadAmount.PAGE && currentPage % 2 == 1) {\n-      // if we download page by page and we are currently in tablet mode\n-      // and playing from the right page, get the left page as well.\n-      currentPage + 1\n-    } else {\n-      currentPage\n-    }\n+  fun getLastAyahToPlay(\n+    startAyah: SuraAyah,\n+    currentPage: Int,\n+    mode: Int,\n+    isDualPages: Boolean,\n+    isNotSplitOrShowingTranslation: Boolean\n+  ): SuraAyah? {\n+    val page =\n+      if (isDualPages &&\n+        isNotSplitOrShowingTranslation &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDExNjM2MQ==", "bodyText": "Will have a look this weekend Insha Allah. Same for all the other comments.", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r460116361", "createdAt": "2020-07-24T15:13:28Z", "author": {"login": "Korogba"}, "path": "app/src/main/java/com/quran/labs/androidquran/util/AudioUtils.kt", "diffHunk": "@@ -107,17 +107,25 @@ constructor(private val quranInfo: QuranInfo, private val quranFileUtils: QuranF\n     return quranFileUtils.gaplessDatabaseRootUrl + \"/\" + dbName\n   }\n \n-  fun getLastAyahToPlay(startAyah: SuraAyah,\n-                        currentPage: Int,\n-                        mode: Int,\n-                        isDualPages: Boolean): SuraAyah? {\n-    val page = if (isDualPages && mode == LookAheadAmount.PAGE && currentPage % 2 == 1) {\n-      // if we download page by page and we are currently in tablet mode\n-      // and playing from the right page, get the left page as well.\n-      currentPage + 1\n-    } else {\n-      currentPage\n-    }\n+  fun getLastAyahToPlay(\n+    startAyah: SuraAyah,\n+    currentPage: Int,\n+    mode: Int,\n+    isDualPages: Boolean,\n+    isNotSplitOrShowingTranslation: Boolean\n+  ): SuraAyah? {\n+    val page =\n+      if (isDualPages &&\n+        isNotSplitOrShowingTranslation &&", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQyOTUxNw=="}, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY0OTY5MQ==", "bodyText": "Salaam walaikum, I finally got around to this \ud83d\ude05.\nI changed this function along with others with a similar signature to depend on a single boolean that determines if two/one page(s) are/is displayed - 7024698.", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r479649691", "createdAt": "2020-08-29T13:25:32Z", "author": {"login": "Korogba"}, "path": "app/src/main/java/com/quran/labs/androidquran/util/AudioUtils.kt", "diffHunk": "@@ -107,17 +107,25 @@ constructor(private val quranInfo: QuranInfo, private val quranFileUtils: QuranF\n     return quranFileUtils.gaplessDatabaseRootUrl + \"/\" + dbName\n   }\n \n-  fun getLastAyahToPlay(startAyah: SuraAyah,\n-                        currentPage: Int,\n-                        mode: Int,\n-                        isDualPages: Boolean): SuraAyah? {\n-    val page = if (isDualPages && mode == LookAheadAmount.PAGE && currentPage % 2 == 1) {\n-      // if we download page by page and we are currently in tablet mode\n-      // and playing from the right page, get the left page as well.\n-      currentPage + 1\n-    } else {\n-      currentPage\n-    }\n+  fun getLastAyahToPlay(\n+    startAyah: SuraAyah,\n+    currentPage: Int,\n+    mode: Int,\n+    isDualPages: Boolean,\n+    isNotSplitOrShowingTranslation: Boolean\n+  ): SuraAyah? {\n+    val page =\n+      if (isDualPages &&\n+        isNotSplitOrShowingTranslation &&", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQyOTUxNw=="}, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MDc0NTc5OnYy", "diffSide": "RIGHT", "path": "common/data/src/main/java/com/quran/data/core/QuranInfo.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjozOToxM1rOG1MU2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjozOToxM1rOG1MU2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQyOTY1Nw==", "bodyText": "same comment as above", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r458429657", "createdAt": "2020-07-21T22:39:13Z", "author": {"login": "ahmedre"}, "path": "common/data/src/main/java/com/quran/data/core/QuranInfo.kt", "diffHunk": "@@ -160,16 +160,26 @@ class QuranInfo @Inject constructor(quranDataSource: QuranDataSource) {\n     return if (sura < 1 || sura > NUMBER_OF_SURAS) -1 else suraNumAyahs[sura - 1]\n   }\n \n-  fun getPageFromPosition(position: Int, dual: Boolean): Int {\n-    return if (dual) {\n+  fun getPageFromPosition(\n+    position: Int,\n+    dual: Boolean,\n+    isSplitScreen: Boolean,\n+    isShowingTranslation: Boolean", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MDc0NjUxOnYy", "diffSide": "RIGHT", "path": "common/data/src/main/java/com/quran/data/core/QuranInfo.kt", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjozOTozMVrOG1MVQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjozOTozMVrOG1MVQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQyOTc2Mg==", "bodyText": "here also", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r458429762", "createdAt": "2020-07-21T22:39:31Z", "author": {"login": "ahmedre"}, "path": "common/data/src/main/java/com/quran/data/core/QuranInfo.kt", "diffHunk": "@@ -160,16 +160,26 @@ class QuranInfo @Inject constructor(quranDataSource: QuranDataSource) {\n     return if (sura < 1 || sura > NUMBER_OF_SURAS) -1 else suraNumAyahs[sura - 1]\n   }\n \n-  fun getPageFromPosition(position: Int, dual: Boolean): Int {\n-    return if (dual) {\n+  fun getPageFromPosition(\n+    position: Int,\n+    dual: Boolean,\n+    isSplitScreen: Boolean,\n+    isShowingTranslation: Boolean\n+  ): Int {\n+    return if (dual && (!isSplitScreen || !isShowingTranslation)) {\n       (numberOfPagesDual - position) * 2\n     } else {\n       numberOfPages - position\n     }\n   }\n \n-  fun getPositionFromPage(page: Int, dual: Boolean): Int {\n-    return if (dual) {\n+  fun getPositionFromPage(\n+    page: Int,\n+    dual: Boolean,\n+    isSplitScreen: Boolean,\n+    isShowingTranslation: Boolean", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2MDc1MTgyOnYy", "diffSide": "RIGHT", "path": "app/src/main/java/com/quran/labs/androidquran/ui/PagerActivity.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMVQyMjo0MTozNFrOG1MYXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOVQxMzozMDoxNVrOHJbhDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQzMDU1OQ==", "bodyText": "can we unify some code by making this an int - numberOfActualPagesVisible for example that's set to 1 for single page (or dual page with split turned on) and is 2 for dual mode (irrespective of translation on or off?)", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r458430559", "createdAt": "2020-07-21T22:41:34Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/PagerActivity.java", "diffHunk": "@@ -203,6 +202,7 @@\n   private int numberOfPages;\n   private int numberOfPagesDual;\n   private int defaultNavigationBarColor;\n+  private boolean isSplitScreen = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTY1MDA2MQ==", "bodyText": "I left this boolean because it is useful to save the preferences value once but the usage is modified so we now have a function that determines if dual page or not. Since this value changes each time the user turns translation on/off, most of the use for this boolean is replaced by a function - isDualPageVisible(). See 7024698 and 70544ae.", "url": "https://github.com/quran/quran_android/pull/1394#discussion_r479650061", "createdAt": "2020-08-29T13:30:15Z", "author": {"login": "Korogba"}, "path": "app/src/main/java/com/quran/labs/androidquran/ui/PagerActivity.java", "diffHunk": "@@ -203,6 +202,7 @@\n   private int numberOfPages;\n   private int numberOfPagesDual;\n   private int defaultNavigationBarColor;\n+  private boolean isSplitScreen = false;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODQzMDU1OQ=="}, "originalCommit": {"oid": "e87d9237477442db1a2fec81110a71bbca0a27b0"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2034, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}