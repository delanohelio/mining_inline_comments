{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ3MDg5Mzg4", "number": 1520, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNToyNFrOFKLHJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNjowMVrOFKLHvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2MjEyMTMyOnYy", "diffSide": "LEFT", "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNToyNFrOIM1bOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNToyNFrOIM1bOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDMyOTE0Nw==", "bodyText": "this was from 2016.", "url": "https://github.com/quran/quran_android/pull/1520#discussion_r550329147", "createdAt": "2020-12-30T21:15:24Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "diffHunk": "@@ -185,63 +185,6 @@ public void upgradePreferences() {\n         version = prefs.getInt(Constants.PREF_VERSION, 0);\n       }\n \n-      if (version != 0) {\n-        if (version < 2672) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98ee447828cfde4e6576550c685a42e9054e602a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2MjEyMTk2OnYy", "diffSide": "LEFT", "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNTozMVrOIM1bgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNTozMVrOIM1bgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDMyOTIxOA==", "bodyText": "so was this.", "url": "https://github.com/quran/quran_android/pull/1520#discussion_r550329218", "createdAt": "2020-12-30T21:15:31Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "diffHunk": "@@ -185,63 +185,6 @@ public void upgradePreferences() {\n         version = prefs.getInt(Constants.PREF_VERSION, 0);\n       }\n \n-      if (version != 0) {\n-        if (version < 2672) {\n-          // migrate preferences\n-          setAppCustomLocation(prefs.getString(Constants.PREF_APP_LOCATION, null));\n-\n-          if (prefs.contains(Constants.PREF_SHOULD_FETCH_PAGES)) {\n-            setShouldFetchPages(prefs.getBoolean(Constants.PREF_SHOULD_FETCH_PAGES, false));\n-          }\n-\n-          if (prefs.contains(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR)) {\n-            setLastDownloadError(\n-                prefs.getString(QuranDownloadService.PREF_LAST_DOWNLOAD_ITEM, null),\n-                prefs.getInt(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR, 0));\n-          }\n-\n-          prefs.edit()\n-              .remove(Constants.PREF_VERSION)\n-              .remove(Constants.PREF_APP_LOCATION)\n-              .remove(Constants.PREF_SHOULD_FETCH_PAGES)\n-              .remove(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR)\n-              .remove(QuranDownloadService.PREF_LAST_DOWNLOAD_ITEM)\n-              .remove(Constants.PREF_ACTIVE_TRANSLATION)\n-              // these aren't migrated since they can be derived pretty easily\n-              .remove(\"didPresentPermissionsRationale\") // was renamed, removing old one\n-              .remove(Constants.PREF_DEFAULT_IMAGES_DIR)\n-              .remove(Constants.PREF_HAVE_UPDATED_TRANSLATIONS)\n-              .remove(Constants.PREF_LAST_UPDATED_TRANSLATIONS)\n-              .apply();\n-        } else if (version < 2674) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98ee447828cfde4e6576550c685a42e9054e602a"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2MjEyMjA3OnYy", "diffSide": "LEFT", "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNTozOFrOIM1bmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNTozOFrOIM1bmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDMyOTI0MA==", "bodyText": "2017", "url": "https://github.com/quran/quran_android/pull/1520#discussion_r550329240", "createdAt": "2020-12-30T21:15:38Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "diffHunk": "@@ -185,63 +185,6 @@ public void upgradePreferences() {\n         version = prefs.getInt(Constants.PREF_VERSION, 0);\n       }\n \n-      if (version != 0) {\n-        if (version < 2672) {\n-          // migrate preferences\n-          setAppCustomLocation(prefs.getString(Constants.PREF_APP_LOCATION, null));\n-\n-          if (prefs.contains(Constants.PREF_SHOULD_FETCH_PAGES)) {\n-            setShouldFetchPages(prefs.getBoolean(Constants.PREF_SHOULD_FETCH_PAGES, false));\n-          }\n-\n-          if (prefs.contains(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR)) {\n-            setLastDownloadError(\n-                prefs.getString(QuranDownloadService.PREF_LAST_DOWNLOAD_ITEM, null),\n-                prefs.getInt(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR, 0));\n-          }\n-\n-          prefs.edit()\n-              .remove(Constants.PREF_VERSION)\n-              .remove(Constants.PREF_APP_LOCATION)\n-              .remove(Constants.PREF_SHOULD_FETCH_PAGES)\n-              .remove(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR)\n-              .remove(QuranDownloadService.PREF_LAST_DOWNLOAD_ITEM)\n-              .remove(Constants.PREF_ACTIVE_TRANSLATION)\n-              // these aren't migrated since they can be derived pretty easily\n-              .remove(\"didPresentPermissionsRationale\") // was renamed, removing old one\n-              .remove(Constants.PREF_DEFAULT_IMAGES_DIR)\n-              .remove(Constants.PREF_HAVE_UPDATED_TRANSLATIONS)\n-              .remove(Constants.PREF_LAST_UPDATED_TRANSLATIONS)\n-              .apply();\n-        } else if (version < 2674) {\n-          // explicitly an else - if we migrated via the above, we're okay. otherwise, we are in\n-          // a bad state due to not crashing in 2.6.7-p2 (thus getting its incorrect behavior),\n-          // and thus crashing on 2.6.7-p3 and above (where the bug was fixed). this works around\n-          // this issue.\n-          try {\n-            getLastDownloadItemWithError();\n-            getLastDownloadErrorCode();\n-          } catch (Exception e) {\n-            clearLastDownloadError();\n-          }\n-        } else if (version == 2800) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98ee447828cfde4e6576550c685a42e9054e602a"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2MjEyMjIzOnYy", "diffSide": "LEFT", "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNTo0OFrOIM1btQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNTo0OFrOIM1btQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDMyOTI2OQ==", "bodyText": "just cleanup, ok if we don't do it.", "url": "https://github.com/quran/quran_android/pull/1520#discussion_r550329269", "createdAt": "2020-12-30T21:15:48Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "diffHunk": "@@ -185,63 +185,6 @@ public void upgradePreferences() {\n         version = prefs.getInt(Constants.PREF_VERSION, 0);\n       }\n \n-      if (version != 0) {\n-        if (version < 2672) {\n-          // migrate preferences\n-          setAppCustomLocation(prefs.getString(Constants.PREF_APP_LOCATION, null));\n-\n-          if (prefs.contains(Constants.PREF_SHOULD_FETCH_PAGES)) {\n-            setShouldFetchPages(prefs.getBoolean(Constants.PREF_SHOULD_FETCH_PAGES, false));\n-          }\n-\n-          if (prefs.contains(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR)) {\n-            setLastDownloadError(\n-                prefs.getString(QuranDownloadService.PREF_LAST_DOWNLOAD_ITEM, null),\n-                prefs.getInt(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR, 0));\n-          }\n-\n-          prefs.edit()\n-              .remove(Constants.PREF_VERSION)\n-              .remove(Constants.PREF_APP_LOCATION)\n-              .remove(Constants.PREF_SHOULD_FETCH_PAGES)\n-              .remove(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR)\n-              .remove(QuranDownloadService.PREF_LAST_DOWNLOAD_ITEM)\n-              .remove(Constants.PREF_ACTIVE_TRANSLATION)\n-              // these aren't migrated since they can be derived pretty easily\n-              .remove(\"didPresentPermissionsRationale\") // was renamed, removing old one\n-              .remove(Constants.PREF_DEFAULT_IMAGES_DIR)\n-              .remove(Constants.PREF_HAVE_UPDATED_TRANSLATIONS)\n-              .remove(Constants.PREF_LAST_UPDATED_TRANSLATIONS)\n-              .apply();\n-        } else if (version < 2674) {\n-          // explicitly an else - if we migrated via the above, we're okay. otherwise, we are in\n-          // a bad state due to not crashing in 2.6.7-p2 (thus getting its incorrect behavior),\n-          // and thus crashing on 2.6.7-p3 and above (where the bug was fixed). this works around\n-          // this issue.\n-          try {\n-            getLastDownloadItemWithError();\n-            getLastDownloadErrorCode();\n-          } catch (Exception e) {\n-            clearLastDownloadError();\n-          }\n-        } else if (version == 2800) {\n-          // upgrading from 2800, need to remove notification channels\n-          if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {\n-            deleteOldNotificationChannels();\n-          }\n-        }\n-\n-        if (version < 2943) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98ee447828cfde4e6576550c685a42e9054e602a"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2MjEyMjg3OnYy", "diffSide": "LEFT", "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNjowMVrOIM1cBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMFQyMToxNjowMVrOIM1cBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDMyOTM0OA==", "bodyText": "more recent but ok if we don't do it anymore since al7amdulillah most people stopped complaining about partial pages now.", "url": "https://github.com/quran/quran_android/pull/1520#discussion_r550329348", "createdAt": "2020-12-30T21:16:01Z", "author": {"login": "ahmedre"}, "path": "app/src/main/java/com/quran/labs/androidquran/util/QuranSettings.java", "diffHunk": "@@ -185,63 +185,6 @@ public void upgradePreferences() {\n         version = prefs.getInt(Constants.PREF_VERSION, 0);\n       }\n \n-      if (version != 0) {\n-        if (version < 2672) {\n-          // migrate preferences\n-          setAppCustomLocation(prefs.getString(Constants.PREF_APP_LOCATION, null));\n-\n-          if (prefs.contains(Constants.PREF_SHOULD_FETCH_PAGES)) {\n-            setShouldFetchPages(prefs.getBoolean(Constants.PREF_SHOULD_FETCH_PAGES, false));\n-          }\n-\n-          if (prefs.contains(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR)) {\n-            setLastDownloadError(\n-                prefs.getString(QuranDownloadService.PREF_LAST_DOWNLOAD_ITEM, null),\n-                prefs.getInt(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR, 0));\n-          }\n-\n-          prefs.edit()\n-              .remove(Constants.PREF_VERSION)\n-              .remove(Constants.PREF_APP_LOCATION)\n-              .remove(Constants.PREF_SHOULD_FETCH_PAGES)\n-              .remove(QuranDownloadService.PREF_LAST_DOWNLOAD_ERROR)\n-              .remove(QuranDownloadService.PREF_LAST_DOWNLOAD_ITEM)\n-              .remove(Constants.PREF_ACTIVE_TRANSLATION)\n-              // these aren't migrated since they can be derived pretty easily\n-              .remove(\"didPresentPermissionsRationale\") // was renamed, removing old one\n-              .remove(Constants.PREF_DEFAULT_IMAGES_DIR)\n-              .remove(Constants.PREF_HAVE_UPDATED_TRANSLATIONS)\n-              .remove(Constants.PREF_LAST_UPDATED_TRANSLATIONS)\n-              .apply();\n-        } else if (version < 2674) {\n-          // explicitly an else - if we migrated via the above, we're okay. otherwise, we are in\n-          // a bad state due to not crashing in 2.6.7-p2 (thus getting its incorrect behavior),\n-          // and thus crashing on 2.6.7-p3 and above (where the bug was fixed). this works around\n-          // this issue.\n-          try {\n-            getLastDownloadItemWithError();\n-            getLastDownloadErrorCode();\n-          } catch (Exception e) {\n-            clearLastDownloadError();\n-          }\n-        } else if (version == 2800) {\n-          // upgrading from 2800, need to remove notification channels\n-          if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {\n-            deleteOldNotificationChannels();\n-          }\n-        }\n-\n-        if (version < 2943) {\n-          prefs.edit().remove(\"didDownloadPages\").apply();\n-        }\n-\n-        if (version < 2961) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "98ee447828cfde4e6576550c685a42e9054e602a"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2068, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}