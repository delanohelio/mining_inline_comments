{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NTE3MjE2", "number": 11203, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxODowNDoyMVrODmaA-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQyMDo1NDo0NlrODnP5qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxNTk4NzE0OnYy", "diffSide": "RIGHT", "path": "dev/com.ibm.ws.install/src/com/ibm/ws/install/internal/ResolveDirector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxODowNDoyMVrOFzznRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxOTowNjowOVrOFz1qHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg2NzMzNQ==", "bodyText": "You should skip the 2nd call to resolve the auto features if returnedFeatureList is empty.", "url": "https://github.com/OpenLiberty/open-liberty/pull/11203#discussion_r389867335", "createdAt": "2020-03-09T18:04:21Z", "author": {"login": "alvinso"}, "path": "dev/com.ibm.ws.install/src/com/ibm/ws/install/internal/ResolveDirector.java", "diffHunk": "@@ -641,8 +641,24 @@ void resolveAutoFeatures(Collection<ESAAsset> autoFeatures, ArrayList<InstallAss\n                 Set<String> allServerFeatures = new HashSet<>(InstallUtils.getAllServerFeatures());\n                 allServerFeatures.addAll(assetsToInstall);\n \n-                log(Level.FINE, \"Using resolveAsSet to resolve features\");\n+                // FIRST CALL to resolveAsSet --> this throws an error for singleton features\n+                log(Level.FINE, \"Calling resolveAsSet api\");\n                 installResources = resolver.resolveAsSet(allServerFeatures); // use new api\n+\n+\n+                Set<String> returnedFeatureList = new HashSet<>();\n+                for(List<RepositoryResource>  resList  : installResources){\n+                    for(RepositoryResource res : resList) {\n+                        if (res.getType().equals(ResourceType.FEATURE)) {\n+                            EsaResource esa = (EsaResource) res;\n+                            returnedFeatureList.add(esa.getProvideFeature());\n+                        }\n+                    }\n+                }\n+                InstallUtils.setResolveAsSetFeatures(returnedFeatureList);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f07e7eb8b62df20ce9c207663163f69e97a98d34"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTkwMDgyOA==", "bodyText": "fixed in commit 5458842", "url": "https://github.com/OpenLiberty/open-liberty/pull/11203#discussion_r389900828", "createdAt": "2020-03-09T19:06:09Z", "author": {"login": "TayyabDev"}, "path": "dev/com.ibm.ws.install/src/com/ibm/ws/install/internal/ResolveDirector.java", "diffHunk": "@@ -641,8 +641,24 @@ void resolveAutoFeatures(Collection<ESAAsset> autoFeatures, ArrayList<InstallAss\n                 Set<String> allServerFeatures = new HashSet<>(InstallUtils.getAllServerFeatures());\n                 allServerFeatures.addAll(assetsToInstall);\n \n-                log(Level.FINE, \"Using resolveAsSet to resolve features\");\n+                // FIRST CALL to resolveAsSet --> this throws an error for singleton features\n+                log(Level.FINE, \"Calling resolveAsSet api\");\n                 installResources = resolver.resolveAsSet(allServerFeatures); // use new api\n+\n+\n+                Set<String> returnedFeatureList = new HashSet<>();\n+                for(List<RepositoryResource>  resList  : installResources){\n+                    for(RepositoryResource res : resList) {\n+                        if (res.getType().equals(ResourceType.FEATURE)) {\n+                            EsaResource esa = (EsaResource) res;\n+                            returnedFeatureList.add(esa.getProvideFeature());\n+                        }\n+                    }\n+                }\n+                InstallUtils.setResolveAsSetFeatures(returnedFeatureList);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg2NzMzNQ=="}, "originalCommit": {"oid": "f07e7eb8b62df20ce9c207663163f69e97a98d34"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNDgxNTc5OnYy", "diffSide": "LEFT", "path": "dev/com.ibm.ws.install/src/com/ibm/ws/install/internal/InstallKernelMap.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQyMDo1NDo0NlrOF1IwQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQyMDo1NDo0NlrOF1IwQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTI2MjI3NQ==", "bodyText": "can we call ResolveDirector.resolveAutoFeatures right after the resolveAsSet call?", "url": "https://github.com/OpenLiberty/open-liberty/pull/11203#discussion_r391262275", "createdAt": "2020-03-11T20:54:46Z", "author": {"login": "alvinso"}, "path": "dev/com.ibm.ws.install/src/com/ibm/ws/install/internal/InstallKernelMap.java", "diffHunk": "@@ -738,7 +738,6 @@ private static boolean containsIgnoreCase(Collection<String> featureToInstall, S\n \n             resolver = new RepositoryResolver(productDefinitions, installedFeatures, Collections.<IFixInfo> emptySet(), repoList);\n             resolveResult = resolver.resolveAsSet((Collection<String>) data.get(FEATURES_TO_RESOLVE));\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e4f0302a34511e8433071449cbfc574949d38f30"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2046, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}