{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2OTA0ODA5", "number": 13462, "title": "Update Fault Tolerance 3.0 to work with MP Metrics 3.0", "bodyText": "Fixes #13348\nUnfortunately, the TCK is not yet compatible with MP Metrics 3.0 (see  eclipse/microprofile-fault-tolerance#570) so the metrics tests in the TCK have been disabled until the issue is fixed and we can consume the next RC release.", "createdAt": "2020-08-12T17:19:59Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/13462", "merged": true, "mergeCommit": {"oid": "ec2fc5ae98a60d527be1ecbe61939a8b16b4eb5b"}, "closed": true, "closedAt": "2020-08-18T09:47:14Z", "author": {"login": "Azquelt"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-dGQYAFqTQ2NjYxOTg2Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc_zAsxABqjM2NjIwNDc4NzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NjE5ODYy", "url": "https://github.com/OpenLiberty/open-liberty/pull/13462#pullrequestreview-466619862", "createdAt": "2020-08-13T10:02:45Z", "commit": {"oid": "7dcba77bd09ef367c84c195829a661263301adfb"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMDowMjo0NVrOHAEzTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMDowMzowN1rOHAE0Dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg0MDcxNw==", "bodyText": "I know it's explained in the PR, but do you think it's worth having a comment here about why these tests are commented out?", "url": "https://github.com/OpenLiberty/open-liberty/pull/13462#discussion_r469840717", "createdAt": "2020-08-13T10:02:45Z", "author": {"login": "Joseph-Cass"}, "path": "dev/io.openliberty.microprofile.faulttolerance.3.0.internal_fat_tck/publish/tckRunner/tck/tck-suite-lite.xml", "diffHunk": "@@ -115,23 +115,23 @@\n             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.config.FallbackConfigTest\"></class>\n             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.config.FallbackSkipOnConfigTest\"></class>\n             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.interceptor.FaultToleranceInterceptorTest\"></class>\n-            <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.AllMetricsTest\"></class>\n-            <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.BulkheadMetricTest\">\n-                <methods>\n-                    <include name=\"bulkheadMetricTest\"/>\n-                    <include name=\"bulkheadMetricRejectionTest\"/>\n-                </methods>\n-            </class>\n-            <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.CircuitBreakerMetricTest\"></class>\n-            <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.ClassLevelMetricTest\"></class>\n-            <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.FallbackMetricTest\"></class>\n-            <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.MetricsDisabledTest\"></class>\n-            <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.RetryMetricTest\"></class>\n-            <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.TimeoutMetricTest\">\n-                <methods>\n-                    <include name=\"testTimeoutMetric\"/>\n-                </methods>\n-            </class>\n+<!--             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.AllMetricsTest\"></class> -->\n+<!--             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.BulkheadMetricTest\"> -->\n+<!--                 <methods> -->\n+<!--                     <include name=\"bulkheadMetricTest\"/> -->\n+<!--                     <include name=\"bulkheadMetricRejectionTest\"/> -->\n+<!--                 </methods> -->\n+<!--             </class> -->\n+<!--             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.CircuitBreakerMetricTest\"></class> -->\n+<!--             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.ClassLevelMetricTest\"></class> -->\n+<!--             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.FallbackMetricTest\"></class> -->\n+<!--             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.MetricsDisabledTest\"></class> -->\n+<!--             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.RetryMetricTest\"></class> -->\n+<!--             <class name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics.TimeoutMetricTest\"> -->\n+<!--                 <methods> -->\n+<!--                     <include name=\"testTimeoutMetric\"/> -->\n+<!--                 </methods> -->\n+<!--             </class> -->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7dcba77bd09ef367c84c195829a661263301adfb"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg0MDkxMQ==", "bodyText": "Same here", "url": "https://github.com/OpenLiberty/open-liberty/pull/13462#discussion_r469840911", "createdAt": "2020-08-13T10:03:07Z", "author": {"login": "Joseph-Cass"}, "path": "dev/io.openliberty.microprofile.faulttolerance.3.0.internal_fat_tck/publish/tckRunner/tck/tck-suite.xml", "diffHunk": "@@ -12,7 +12,9 @@\n \n     <test name=\"microprofile-faulttolerance 3.0 TCK\">\n         <packages>\n-            <package name=\"org.eclipse.microprofile.fault.tolerance.tck.*\"/>\n+            <package name=\"org.eclipse.microprofile.fault.tolerance.tck.*\">\n+                <exclude name=\"org.eclipse.microprofile.fault.tolerance.tck.metrics\"></exclude>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7dcba77bd09ef367c84c195829a661263301adfb"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NjIzNjYy", "url": "https://github.com/OpenLiberty/open-liberty/pull/13462#pullrequestreview-466623662", "createdAt": "2020-08-13T10:08:22Z", "commit": {"oid": "7dcba77bd09ef367c84c195829a661263301adfb"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMDowODoyMlrOHAE_ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QxMDowODoyMlrOHAE_ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTg0MzgxMg==", "bodyText": "The copyright header on this file needs updating", "url": "https://github.com/OpenLiberty/open-liberty/pull/13462#discussion_r469843812", "createdAt": "2020-08-13T10:08:22Z", "author": {"login": "Joseph-Cass"}, "path": "dev/io.openliberty.microprofile.faulttolerance.3.0.internal_fat_tck/publish/servers/FaultTolerance30TCKServer/server.xml", "diffHunk": "@@ -15,7 +15,7 @@\n         <feature>cdi-2.0</feature>\n         <feature>servlet-4.0</feature>\n         <feature>mpConfig-1.4</feature>\n-        <feature>mpMetrics-2.3</feature>\n+        <feature>mpMetrics-3.0</feature>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7dcba77bd09ef367c84c195829a661263301adfb"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7dcba77bd09ef367c84c195829a661263301adfb", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/7dcba77bd09ef367c84c195829a661263301adfb", "committedDate": "2020-08-12T17:17:42Z", "message": "Temporarily disable FT 3.0 TCK metrics tests\n\nTemporarily disable the metrics tests until the TCK is updated to\nsupport MP Metrics 3.0"}, "afterCommit": {"oid": "2a9a0e3e3e6b9744152300b3c9f6a44709538f65", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/2a9a0e3e3e6b9744152300b3c9f6a44709538f65", "committedDate": "2020-08-13T11:01:01Z", "message": "Temporarily disable FT 3.0 TCK metrics tests\n\nTemporarily disable the metrics tests until the TCK is updated to\nsupport MP Metrics 3.0"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a9a0e3e3e6b9744152300b3c9f6a44709538f65", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/2a9a0e3e3e6b9744152300b3c9f6a44709538f65", "committedDate": "2020-08-13T11:01:01Z", "message": "Temporarily disable FT 3.0 TCK metrics tests\n\nTemporarily disable the metrics tests until the TCK is updated to\nsupport MP Metrics 3.0"}, "afterCommit": {"oid": "ab153ea6466cd881a8a64abc64ce0fd149f8d5d5", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/ab153ea6466cd881a8a64abc64ce0fd149f8d5d5", "committedDate": "2020-08-14T16:32:22Z", "message": "Temporarily disable FT 3.0 TCK metrics tests\n\nTemporarily disable the metrics tests until the TCK is updated to\nsupport MP Metrics 3.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eee94b3fd3533b3b7abb495fe050d056387d23bf", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/eee94b3fd3533b3b7abb495fe050d056387d23bf", "committedDate": "2020-08-17T14:08:48Z", "message": "Make FT 3.0 use Metrics 3.0 instead of 2.3\n\nMP Fault Tolerance 3.0 will release alongside MP Metrics 3.0, so we need\nthem to work together.\n\nThis PR changes the metrics integration to use 3.0 instead of 2.3.\nBreaking changes in Metrics 3.0 mean that the same jar cannot support\nboth versions of MP Metrics. (The source code will actually compile and\nrun against either, but the built binary will only be compatible with\nthe version it was compiled against.)\n\nAn additional autofeature and bundle could be added later to support\nMetrics 2.3 as well if required."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6197a9db1c41f1b6cbe2ad9f18847415627bb515", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/6197a9db1c41f1b6cbe2ad9f18847415627bb515", "committedDate": "2020-08-17T14:08:48Z", "message": "Update tests to use MP FT 3.0 and MP Metrics 3.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c9cd5f28d2252426fbed37f810e0d03b9ceb445", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/2c9cd5f28d2252426fbed37f810e0d03b9ceb445", "committedDate": "2020-08-17T14:08:48Z", "message": "Update MetricRemovalTest for MP Metrics 3.0\n\nUpdate this Fault Tolerance test so that it's compatible with MP Metrics\n3.0.\n\nPreviously this test used a custom servlet to print out metrics to avoid\nthe differences in output format between different versions of MP\nMetrics. With the breaking changes in MP Metrics 3.0, it's easier to\nwork around the output differences and just use the /metrics endpoint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c55bae360cecec6eb364db2feba898d91f25da6", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/7c55bae360cecec6eb364db2feba898d91f25da6", "committedDate": "2020-08-17T14:08:48Z", "message": "Temporarily disable FT 3.0 TCK metrics tests\n\nTemporarily disable the metrics tests until the TCK is updated to\nsupport MP Metrics 3.0"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab153ea6466cd881a8a64abc64ce0fd149f8d5d5", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/ab153ea6466cd881a8a64abc64ce0fd149f8d5d5", "committedDate": "2020-08-14T16:32:22Z", "message": "Temporarily disable FT 3.0 TCK metrics tests\n\nTemporarily disable the metrics tests until the TCK is updated to\nsupport MP Metrics 3.0"}, "afterCommit": {"oid": "7c55bae360cecec6eb364db2feba898d91f25da6", "author": {"user": {"login": "Azquelt", "name": "Andrew Rouse"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/7c55bae360cecec6eb364db2feba898d91f25da6", "committedDate": "2020-08-17T14:08:48Z", "message": "Temporarily disable FT 3.0 TCK metrics tests\n\nTemporarily disable the metrics tests until the TCK is updated to\nsupport MP Metrics 3.0"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1996, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}