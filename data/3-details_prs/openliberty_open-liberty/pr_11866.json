{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2NDA1Mzgy", "number": 11866, "title": "Fix single metric query for Prometheus format", "bodyText": "Fix #11364\n#build\nThis was introduced from : #11592", "createdAt": "2020-04-21T02:46:00Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/11866", "merged": true, "mergeCommit": {"oid": "7e1933e419f2a912d0a3c3ac85090b02c5cf3f37"}, "closed": true, "closedAt": "2020-04-24T01:37:08Z", "author": {"login": "Channyboy"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZqfT0AH2gAyNDA2NDA1MzgyOjljN2U5YTVlYzczOTRkY2U1ZTRiMWExMGZlNmExNzhjOGZjNjIzZWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcanQ9UAFqTM5OTU4MzU4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9c7e9a5ec7394dce5e4b1a10fe6a178c8fc623ed", "author": {"user": {"login": "Channyboy", "name": "David Chan"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/9c7e9a5ec7394dce5e4b1a10fe6a178c8fc623ed", "committedDate": "2020-04-21T02:44:24Z", "message": "Fix single metric query for Prometheus format"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NjU5NTM3", "url": "https://github.com/OpenLiberty/open-liberty/pull/11866#pullrequestreview-397659537", "createdAt": "2020-04-21T20:41:40Z", "commit": {"oid": "9c7e9a5ec7394dce5e4b1a10fe6a178c8fc623ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDo0MTo0MFrOGJXmDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDo0MTo0MFrOGJXmDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjQ3Njk0MA==", "bodyText": "Should the empty check on crrentMetricMap move to line 114.  If it is empty, you don't need to compute description, unit, conversionFactory etc.", "url": "https://github.com/OpenLiberty/open-liberty/pull/11866#discussion_r412476940", "createdAt": "2020-04-21T20:41:40Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.microprofile.metrics.2.0/src/com/ibm/ws/microprofile/metrics/writer/PrometheusMetricWriter.java", "diffHunk": "@@ -123,7 +123,10 @@ protected void writeMetricMapAsPrometheus(StringBuilder builder, String registry\n             double conversionFactor = conversionAppendEntry.getValue();\n             String appendUnit = conversionAppendEntry.getKey();\n \n-            if (metricMetadata.getTypeRaw().equals(MetricType.COUNTER)) {\n+            //If current metadata that we are parsing does not have a matching metric... skip\n+            if (currentMetricMap.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c7e9a5ec7394dce5e4b1a10fe6a178c8fc623ed"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NjYwMjI3", "url": "https://github.com/OpenLiberty/open-liberty/pull/11866#pullrequestreview-397660227", "createdAt": "2020-04-21T20:42:41Z", "commit": {"oid": "9c7e9a5ec7394dce5e4b1a10fe6a178c8fc623ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDo0Mjo0MVrOGJXoQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDo0Mjo0MVrOGJXoQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjQ3NzUwNg==", "bodyText": "Should the empty check on crrentMetricMap move to line 56. If it is empty, you don't need to compute description, unit, conversionFactory etc.", "url": "https://github.com/OpenLiberty/open-liberty/pull/11866#discussion_r412477506", "createdAt": "2020-04-21T20:42:41Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.microprofile.metrics.2.3/src/com/ibm/ws/microprofile/metrics23/writer/PrometheusMetricWriter23.java", "diffHunk": "@@ -66,7 +66,10 @@ protected void writeMetricMapAsPrometheus(StringBuilder builder, String registry\n             double conversionFactor = conversionAppendEntry.getValue();\n             String appendUnit = conversionAppendEntry.getKey();\n \n-            if (metricMetadata.getTypeRaw().equals(MetricType.COUNTER)) {\n+            //If current metadata that we are parsing does not have a matching metric... skip\n+            if (currentMetricMap.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9c7e9a5ec7394dce5e4b1a10fe6a178c8fc623ed"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MzExNjk0", "url": "https://github.com/OpenLiberty/open-liberty/pull/11866#pullrequestreview-399311694", "createdAt": "2020-04-23T17:16:46Z", "commit": {"oid": "cbf94acccfcc21467ff0ea34d767f0881ece43f8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNzoxNjo0N1rOGKzP2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNzoxNjo0N1rOGKzP2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk3ODU4NQ==", "bodyText": "Uncomment the if statement", "url": "https://github.com/OpenLiberty/open-liberty/pull/11866#discussion_r413978585", "createdAt": "2020-04-23T17:16:47Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.microprofile.metrics.2.3/src/com/ibm/ws/microprofile/metrics23/writer/PrometheusMetricWriter23.java", "diffHunk": "@@ -66,10 +70,7 @@ protected void writeMetricMapAsPrometheus(StringBuilder builder, String registry\n             double conversionFactor = conversionAppendEntry.getValue();\n             String appendUnit = conversionAppendEntry.getKey();\n \n-            //If current metadata that we are parsing does not have a matching metric... skip\n-            if (currentMetricMap.isEmpty()) {\n-                continue;\n-            } else if (metricMetadata.getTypeRaw().equals(MetricType.COUNTER)) {\n+            //if (metricMetadata.getTypeRaw().equals(MetricType.COUNTER)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbf94acccfcc21467ff0ea34d767f0881ece43f8"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c12fde8ffee07f8e5cbacf4c75a312d50abed7b5", "author": {"user": {"login": "Channyboy", "name": "David Chan"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/c12fde8ffee07f8e5cbacf4c75a312d50abed7b5", "committedDate": "2020-04-23T17:36:23Z", "message": "refactor to move if check further up"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cbf94acccfcc21467ff0ea34d767f0881ece43f8", "author": {"user": {"login": "Channyboy", "name": "David Chan"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/cbf94acccfcc21467ff0ea34d767f0881ece43f8", "committedDate": "2020-04-23T03:21:11Z", "message": "refactor to move if check further up"}, "afterCommit": {"oid": "c12fde8ffee07f8e5cbacf4c75a312d50abed7b5", "author": {"user": {"login": "Channyboy", "name": "David Chan"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/c12fde8ffee07f8e5cbacf4c75a312d50abed7b5", "committedDate": "2020-04-23T17:36:23Z", "message": "refactor to move if check further up"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5NTgzNTg5", "url": "https://github.com/OpenLiberty/open-liberty/pull/11866#pullrequestreview-399583589", "createdAt": "2020-04-24T01:32:56Z", "commit": {"oid": "c12fde8ffee07f8e5cbacf4c75a312d50abed7b5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2829, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}