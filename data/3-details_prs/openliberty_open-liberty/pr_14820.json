{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1NDI0Njg2", "number": 14820, "title": "Create ServerLRAFilter as a CDI bean.", "bodyText": "It should have been like this from the start", "createdAt": "2020-11-04T14:33:32Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820", "merged": true, "mergeCommit": {"oid": "422464869b2b0e13c4deb3915e8b7f36a1e407bb"}, "closed": true, "closedAt": "2020-11-12T09:35:02Z", "author": {"login": "idlewis"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZloVSgBqjM5NjM1MTE4MDU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbeJpogBqjM5ODM4ODYxODY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ec1c1bc50b187b405c949b64c61c52e14e5edc44", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/ec1c1bc50b187b405c949b64c61c52e14e5edc44", "committedDate": "2020-11-05T13:09:49Z", "message": "Add some dummy classes for debug"}, "afterCommit": {"oid": "3b7784057f8774393cd10ca5b8f699cef594bc47", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/3b7784057f8774393cd10ca5b8f699cef594bc47", "committedDate": "2020-11-05T17:15:27Z", "message": "Add some dummy classes for debug"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3b7784057f8774393cd10ca5b8f699cef594bc47", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/3b7784057f8774393cd10ca5b8f699cef594bc47", "committedDate": "2020-11-05T17:15:27Z", "message": "Add some dummy classes for debug"}, "afterCommit": {"oid": "8b3a6f5306bcb0689c7648b5ceb54c610c68ab1d", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/8b3a6f5306bcb0689c7648b5ceb54c610c68ab1d", "committedDate": "2020-11-06T09:48:36Z", "message": "Add some dummy classes for debug"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8b3a6f5306bcb0689c7648b5ceb54c610c68ab1d", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/8b3a6f5306bcb0689c7648b5ceb54c610c68ab1d", "committedDate": "2020-11-06T09:48:36Z", "message": "Add some dummy classes for debug"}, "afterCommit": {"oid": "4c56f5c9f8ffa84e5d8f45fc73a9d204f0b06d59", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/4c56f5c9f8ffa84e5d8f45fc73a9d204f0b06d59", "committedDate": "2020-11-03T15:01:14Z", "message": "Create ServerLRAFilter as a CDI bean.\n\nIt should have been like this from the start"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c56f5c9f8ffa84e5d8f45fc73a9d204f0b06d59", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/4c56f5c9f8ffa84e5d8f45fc73a9d204f0b06d59", "committedDate": "2020-11-03T15:01:14Z", "message": "Create ServerLRAFilter as a CDI bean.\n\nIt should have been like this from the start"}, "afterCommit": {"oid": "244b5de26e885f4363bba2b9c87e56f3dd72cd25", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/244b5de26e885f4363bba2b9c87e56f3dd72cd25", "committedDate": "2020-11-10T12:25:59Z", "message": "Create ServerLRAFilter as a CDI bean.\n\nIt should have been like this from the start"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjA0MzU3", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820#pullrequestreview-527204357", "createdAt": "2020-11-10T13:34:16Z", "commit": {"oid": "244b5de26e885f4363bba2b9c87e56f3dd72cd25"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozNDoxN1rOHwcuwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozNDoxN1rOHwcuwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2NDQxNg==", "bodyText": "delete if not needed", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820#discussion_r520564416", "createdAt": "2020-11-10T13:34:17Z", "author": {"login": "tevans78"}, "path": "dev/io.openliberty.microprofile.lra.1.0.internal/bnd.bnd", "diffHunk": "@@ -45,6 +45,9 @@ Include-Resource: \\\n \tcom.ibm.ws.org.osgi.annotation.versioning;version=latest, \\\n \tcom.ibm.wsspi.org.osgi.service.component.annotations;version=latest, \\\n \tcom.ibm.websphere.javaee.jaxrs.2.1;version=latest, \\\n-\tcom.ibm.ws.jaxrs.2.1.common;version=latest\n+\tcom.ibm.ws.jaxrs.2.1.common;version=latest, \\\n+\tcom.ibm.websphere.javaee.cdi.2.0\n+\t#com.ibm.ws.cdi.interfaces;version=latest, \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "244b5de26e885f4363bba2b9c87e56f3dd72cd25"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjA1ODYw", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820#pullrequestreview-527205860", "createdAt": "2020-11-10T13:36:09Z", "commit": {"oid": "244b5de26e885f4363bba2b9c87e56f3dd72cd25"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozNjowOVrOHwcz2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozNjowOVrOHwcz2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2NTcyMw==", "bodyText": "Don't you still need some error handling if the bean can not be found?", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820#discussion_r520565723", "createdAt": "2020-11-10T13:36:09Z", "author": {"login": "tevans78"}, "path": "dev/io.openliberty.microprofile.lra.1.0.internal/src/io/openliberty/microprofile/lra/internal/LraFilterComponent.java", "diffHunk": "@@ -99,14 +101,8 @@ public void installProvider(boolean clientSide, List<Object> providers, Set<Stri\n             if (TraceComponent.isAnyTracingEnabled() && tc.isEventEnabled()) {\n                 Tr.event(tc, \"Registering serverside side filters\");\n             }\n-            try {\n-                // Rather unhelpfully, the ServerLRAFilter constructor throws 'Exception'. There isn't much we can do with\n-                // that. Re-throwing should prevent the servlet being initialized, which is probably better than swallowing\n-                // the exception\n-                providers.add(new ServerLRAFilter());\n-            } catch (Exception e) {\n-                throw new LraRuntimeException(Tr.formatMessage(tc, \"LRA_CANT_REGISTER_FILTERS.CWMRX5001E\", e), e);\n-            }\n+            ServerLRAFilter beanInstance = CDI.current().select(ServerLRAFilter.class).get();\n+            providers.add(beanInstance);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "244b5de26e885f4363bba2b9c87e56f3dd72cd25"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjA3NDk4", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820#pullrequestreview-527207498", "createdAt": "2020-11-10T13:38:01Z", "commit": {"oid": "244b5de26e885f4363bba2b9c87e56f3dd72cd25"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozODowMVrOHwc4ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzozODowMVrOHwc4ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2Njk3MA==", "bodyText": "better to put the copyright above the package statement", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820#discussion_r520566970", "createdAt": "2020-11-10T13:38:01Z", "author": {"login": "tevans78"}, "path": "dev/io.openliberty.org.jboss.narayana.rts/src/io/openliberty/microprofile/lra/internal/CdiExtensionComponent.java", "diffHunk": "@@ -0,0 +1,46 @@\n+package io.openliberty.microprofile.lra.internal;\n+/*******************************************************************************", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "244b5de26e885f4363bba2b9c87e56f3dd72cd25"}, "originalPosition": 2}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3MjE0NTQz", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820#pullrequestreview-527214543", "createdAt": "2020-11-10T13:45:33Z", "commit": {"oid": "244b5de26e885f4363bba2b9c87e56f3dd72cd25"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzo0NTozM1rOHwdNlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxMzo0NTozM1rOHwdNlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU3MjMwOA==", "bodyText": "I can't see any bundles which import these packages?? Are these exports actually needed, should the packages be private instead?", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820#discussion_r520572308", "createdAt": "2020-11-10T13:45:33Z", "author": {"login": "tevans78"}, "path": "dev/io.openliberty.org.jboss.narayana.rts/bnd.bnd", "diffHunk": "@@ -22,8 +22,21 @@ Export-Package: \\\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "244b5de26e885f4363bba2b9c87e56f3dd72cd25"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MTE0NTk5", "url": "https://github.com/OpenLiberty/open-liberty/pull/14820#pullrequestreview-528114599", "createdAt": "2020-11-11T12:08:32Z", "commit": {"oid": "79265487b57ec5612f827f216d409af7050ed231"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3195afae7fa1b0b6da3d06aef7d0fc8237a7ba84", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/3195afae7fa1b0b6da3d06aef7d0fc8237a7ba84", "committedDate": "2020-11-11T13:39:56Z", "message": "Create ServerLRAFilter as a CDI bean.\n\nIt should have been like this from the start"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "79265487b57ec5612f827f216d409af7050ed231", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/79265487b57ec5612f827f216d409af7050ed231", "committedDate": "2020-11-11T11:54:36Z", "message": "Review comments"}, "afterCommit": {"oid": "3195afae7fa1b0b6da3d06aef7d0fc8237a7ba84", "author": {"user": {"login": "idlewis", "name": "Ian Lewis"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/3195afae7fa1b0b6da3d06aef7d0fc8237a7ba84", "committedDate": "2020-11-11T13:39:56Z", "message": "Create ServerLRAFilter as a CDI bean.\n\nIt should have been like this from the start"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2918, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}