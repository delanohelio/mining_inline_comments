{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2ODgyNDI3", "number": 13935, "title": "Add do-priv blocks for the restful web services 3.0 implementation", "bodyText": "@tevans78 can you review dev/com.ibm.ws.microprofile.config.1.1.cdi/src/com/ibm/ws/microprofile/config/cdi/ConfigCDIExtension.java please?", "createdAt": "2020-09-14T21:05:17Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/13935", "merged": true, "mergeCommit": {"oid": "8dcb0c99c8cbc50cc88262b17ff7ee263781f534"}, "closed": true, "closedAt": "2020-09-16T16:34:03Z", "author": {"login": "WhiteCat22"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdI5plDAH2gAyNDg2ODgyNDI3OjhjNjE5MjQ3MmQ3YzMzZDNlZTY5ODdiYTlkYWQ4NWRjNmEyOTI4OTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJe9B7AFqTQ4OTc5NzQ5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8c6192472d7c33d3ee6987ba9dad85dc6a292894", "author": {"user": {"login": "WhiteCat22", "name": "Adam Anderson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/8c6192472d7c33d3ee6987ba9dad85dc6a292894", "committedDate": "2020-09-14T20:58:38Z", "message": "add a do-priv block when getting the classloader in ConfigCDIExtension.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3621540fb59adc6fa68f0f45e75d80c0e9e24147", "author": {"user": {"login": "WhiteCat22", "name": "Adam Anderson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/3621540fb59adc6fa68f0f45e75d80c0e9e24147", "committedDate": "2020-09-14T21:02:20Z", "message": "add a do-priv block when getting the property for MAX_MT_CACHE_SIZE in MediaTypeHeaderDelegate.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf31cc20588e019c88d066df07648a216a20c042", "author": {"user": {"login": "WhiteCat22", "name": "Adam Anderson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/bf31cc20588e019c88d066df07648a216a20c042", "committedDate": "2020-09-14T21:03:08Z", "message": "dependabot update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4MTU5NDQ1", "url": "https://github.com/OpenLiberty/open-liberty/pull/13935#pullrequestreview-488159445", "createdAt": "2020-09-14T21:38:13Z", "commit": {"oid": "bf31cc20588e019c88d066df07648a216a20c042"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMTozODoxM1rOHRnexw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMTozOToxOFrOHRngrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODIzNDY5NQ==", "bodyText": "this has been fixed in RESTEasy, but not yet GA - should be in 4.5.7 when it comes out. maybe mention that in the comment so we know that we can delete this overlay once we pull in 4.5.7 or newer?", "url": "https://github.com/OpenLiberty/open-liberty/pull/13935#discussion_r488234695", "createdAt": "2020-09-14T21:38:13Z", "author": {"login": "andymc12"}, "path": "dev/io.openliberty.org.jboss.resteasy.common/src/org/jboss/resteasy/plugins/delegates/MediaTypeHeaderDelegate.java", "diffHunk": "@@ -0,0 +1,190 @@\n+package org.jboss.resteasy.plugins.delegates;\n+\n+import org.jboss.resteasy.resteasy_jaxrs.i18n.Messages;\n+import org.jboss.resteasy.util.HeaderParameterParser;\n+\n+import javax.ws.rs.core.MediaType;\n+import javax.ws.rs.ext.RuntimeDelegate;\n+\n+import java.security.AccessController;\n+import java.security.PrivilegedAction;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.concurrent.ConcurrentHashMap;\n+\n+/**\n+ * @author <a href=\"mailto:bill@burkecentral.com\">Bill Burke</a>\n+ * @version $Revision: 1 $\n+ */\n+public class MediaTypeHeaderDelegate implements RuntimeDelegate.HeaderDelegate\n+{\n+   public static final MediaTypeHeaderDelegate INSTANCE = new MediaTypeHeaderDelegate();\n+\n+   private static Map<String, MediaType> map = new ConcurrentHashMap<String, MediaType>();\n+   private static Map<MediaType, String> reverseMap = new ConcurrentHashMap<MediaType, String>();\n+   private static final int MAX_MT_CACHE_SIZE =\n+                   // Liberty Change", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf31cc20588e019c88d066df07648a216a20c042"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODIzNTE4MA==", "bodyText": "I think I saw this same call to get classloader in other versions of MP Config (besides just 1.1).  It might be good to update them all - when I looked, I saw it in 1.4, but it's a good guess that it needs to be updated in 1.2 and 1.3 too.", "url": "https://github.com/OpenLiberty/open-liberty/pull/13935#discussion_r488235180", "createdAt": "2020-09-14T21:39:18Z", "author": {"login": "andymc12"}, "path": "dev/com.ibm.ws.microprofile.config.1.1.cdi/src/com/ibm/ws/microprofile/config/cdi/ConfigCDIExtension.java", "diffHunk": "@@ -60,7 +62,13 @@ protected void addBadInjectionType(Type type) {\n \n     void processInjectionTarget(@Observes ProcessInjectionTarget<?> pit) {\n         Class<?> targetClass = pit.getAnnotatedType().getJavaClass();\n-        ClassLoader classLoader = targetClass.getClassLoader();\n+\n+        ClassLoader classLoader = AccessController.doPrivileged(new PrivilegedAction<ClassLoader>() {\n+            @Override\n+            public ClassLoader run() {\n+                return targetClass.getClassLoader();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf31cc20588e019c88d066df07648a216a20c042"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5d299850644d85ea41da934c770c53758534cf2", "author": {"user": {"login": "WhiteCat22", "name": "Adam Anderson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/d5d299850644d85ea41da934c770c53758534cf2", "committedDate": "2020-09-15T15:19:56Z", "message": "add a do-priv block when getting the classloader in Config14CDIExtension.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d64844b335faefc8f0325c03af549d7d6f2fad7a", "author": {"user": {"login": "WhiteCat22", "name": "Adam Anderson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/d64844b335faefc8f0325c03af549d7d6f2fad7a", "committedDate": "2020-09-15T15:24:26Z", "message": "update MediaTypeHeaderDelegate comment to indicate that the fix is in a newer version of the upstream"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5Nzk3NDk1", "url": "https://github.com/OpenLiberty/open-liberty/pull/13935#pullrequestreview-489797495", "createdAt": "2020-09-16T16:26:22Z", "commit": {"oid": "d64844b335faefc8f0325c03af549d7d6f2fad7a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3366, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}