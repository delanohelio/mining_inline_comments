{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNjI2NjUw", "number": 12799, "title": "Add waitForStringInLog for SRVE0242I (/metrics initialization)", "bodyText": "#build\nAdding a wait for the /metrics endpoint to be initialized before attempting to reach it.\nFixes #12589", "createdAt": "2020-06-26T14:45:21Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799", "merged": true, "mergeCommit": {"oid": "a4cfea236c5a69da167c634fa4de853cba56211c"}, "closed": true, "closedAt": "2020-07-02T13:52:55Z", "author": {"login": "jennifer-c"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwGXC9gFqTQzOTQ0MzgyNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwcqiVgFqTQ0MDQwNDg4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDQzODI0", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-439443824", "createdAt": "2020-06-29T19:39:02Z", "commit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTozOTowMlrOGqfY6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTozOTowMlrOGqfY6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIwNzY1Ng==", "bodyText": "Use  \"SRVE0242I./metrics.\" to be more specific for metrics endpoint.", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#discussion_r447207656", "createdAt": "2020-06-29T19:39:02Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.logging_fat/fat/src/com/ibm/ws/logging/fat/CustomAccessLogFieldsTest.java", "diffHunk": "@@ -169,6 +169,12 @@ public void cleanUp() throws Exception {\n     public void testAccessLogFieldNamesEnv() throws Exception {\n         setUp(envServer);\n         waitForSecurityPrerequisites(envServer, WAIT_TIMEOUT);\n+        // Ensure defaultHttpEndpoint-ssl TCP Channel is started\n+        assertNotNull(\"TCP Channel defaultHttpEndpoint-ssl has not started (CWWKO0219I not found)\",\n+                      envServer.waitForStringInLog(\"CWWKO0219I.*defaultHttpEndpoint-ssl\", 60000));\n+        // Wait for /metrics to be initialized\n+        assertNotNull(\"/metrics was not initialized (SRVE0242I not found)\",\n+                      envServer.waitForStringInLog(\"SRVE0242I\", WAIT_TIMEOUT));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDQ0MDUz", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-439444053", "createdAt": "2020-06-29T19:39:25Z", "commit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTozOToyNVrOGqfZqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTozOToyNVrOGqfZqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIwNzg0OA==", "bodyText": "Use  \"SRVE0242I./metrics.\" to be more specific for metrics endpoint.", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#discussion_r447207848", "createdAt": "2020-06-29T19:39:25Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.logging_fat/fat/src/com/ibm/ws/logging/fat/CustomAccessLogFieldsTest.java", "diffHunk": "@@ -184,6 +190,12 @@ public void testAccessLogFieldNamesEnv() throws Exception {\n     public void testAccessLogFieldNamesBootstrap() throws Exception {\n         setUp(bootstrapServer);\n         waitForSecurityPrerequisites(bootstrapServer, WAIT_TIMEOUT);\n+        // Ensure defaultHttpEndpoint-ssl TCP Channel is started\n+        assertNotNull(\"TCP Channel defaultHttpEndpoint-ssl has not started (CWWKO0219I not found)\",\n+                      bootstrapServer.waitForStringInLog(\"CWWKO0219I.*defaultHttpEndpoint-ssl\", 60000));\n+        // Wait for /metrics to be initialized\n+        assertNotNull(\"/metrics was not initialized (SRVE0242I not found)\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDQ0NDE4", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-439444418", "createdAt": "2020-06-29T19:39:57Z", "commit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTozOTo1N1rOGqfa2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTozOTo1N1rOGqfa2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIwODE1NA==", "bodyText": "Use  \"SRVE0242I./metrics.\" to be more specific for metrics endpoint.", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#discussion_r447208154", "createdAt": "2020-06-29T19:39:57Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.logging_fat/fat/src/com/ibm/ws/logging/fat/CustomAccessLogFieldsTest.java", "diffHunk": "@@ -200,10 +212,14 @@ public void testAccessLogFieldNamesXml() throws Exception {\n         setUp(xmlServer);\n         if (isFirstTimeUsingXmlServer) {\n             waitForSecurityPrerequisites(xmlServer, WAIT_TIMEOUT);\n-        } else {\n-            assertNotNull(\"TCP Channel defaultHttpEndpoint-ssl has not started (CWWKO0219I not found)\",\n-                          xmlServer.waitForStringInLog(\"CWWKO0219I.*defaultHttpEndpoint-ssl\", 60000));\n         }\n+        // Ensure defaultHttpEndpoint-ssl TCP Channel is started\n+        assertNotNull(\"TCP Channel defaultHttpEndpoint-ssl has not started (CWWKO0219I not found)\",\n+                      xmlServer.waitForStringInLog(\"CWWKO0219I.*defaultHttpEndpoint-ssl\", 60000));\n+        // Wait for /metrics to be initialized\n+        assertNotNull(\"/metrics was not initialized (SRVE0242I not found)\",\n+                      xmlServer.waitForStringInLog(\"SRVE0242I\", WAIT_TIMEOUT));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDQ0NDk1", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-439444495", "createdAt": "2020-06-29T19:40:04Z", "commit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0MDowNVrOGqfbJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0MDowNVrOGqfbJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIwODIzMA==", "bodyText": "Use  \"SRVE0242I./metrics.\" to be more specific for metrics endpoint.", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#discussion_r447208230", "createdAt": "2020-06-29T19:40:05Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.logging_fat/fat/src/com/ibm/ws/logging/fat/CustomAccessLogFieldsTest.java", "diffHunk": "@@ -274,10 +290,14 @@ public void testAllFieldsArePrinted() throws Exception {\n         waitForConfigUpdate(xmlServer);\n         if (isFirstTimeUsingXmlServer) {\n             waitForSecurityPrerequisites(xmlServer, WAIT_TIMEOUT);\n-        } else {\n-            assertNotNull(\"TCP Channel defaultHttpEndpoint-ssl has not started (CWWKO0219I not found)\",\n-                          xmlServer.waitForStringInLog(\"CWWKO0219I.*defaultHttpEndpoint-ssl\", 60000));\n         }\n+        // Ensure defaultHttpEndpoint-ssl TCP Channel is started\n+        assertNotNull(\"TCP Channel defaultHttpEndpoint-ssl has not started (CWWKO0219I not found)\",\n+                      xmlServer.waitForStringInLog(\"CWWKO0219I.*defaultHttpEndpoint-ssl\", 60000));\n+        // Wait for /metrics to be initialized\n+        assertNotNull(\"/metrics was not initialized (SRVE0242I not found)\",\n+                      xmlServer.waitForStringInLog(\"SRVE0242I\", WAIT_TIMEOUT));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDQ0NTc5", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-439444579", "createdAt": "2020-06-29T19:40:12Z", "commit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0MDoxMlrOGqfbew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0MDoxMlrOGqfbew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIwODMxNQ==", "bodyText": "Use  \"SRVE0242I./metrics.\" to be more specific for metrics endpoint.", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#discussion_r447208315", "createdAt": "2020-06-29T19:40:12Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.logging_fat/fat/src/com/ibm/ws/logging/fat/CustomAccessLogFieldsTest.java", "diffHunk": "@@ -330,10 +350,14 @@ public void testFieldsInAccessLogAreSameInJSON() throws Exception {\n         setUp(xmlServer);\n         if (isFirstTimeUsingXmlServer) {\n             waitForSecurityPrerequisites(xmlServer, WAIT_TIMEOUT);\n-        } else {\n-            assertNotNull(\"TCP Channel defaultHttpEndpoint-ssl has not started (CWWKO0219I not found)\",\n-                          xmlServer.waitForStringInLog(\"CWWKO0219I.*defaultHttpEndpoint-ssl\", 60000));\n         }\n+        // Ensure defaultHttpEndpoint-ssl TCP Channel is started\n+        assertNotNull(\"TCP Channel defaultHttpEndpoint-ssl has not started (CWWKO0219I not found)\",\n+                      xmlServer.waitForStringInLog(\"CWWKO0219I.*defaultHttpEndpoint-ssl\", 60000));\n+        // Wait for /metrics to be initialized\n+        assertNotNull(\"/metrics was not initialized (SRVE0242I not found)\",\n+                      xmlServer.waitForStringInLog(\"SRVE0242I\", WAIT_TIMEOUT));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "originalPosition": 75}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDQ0NjU0", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-439444654", "createdAt": "2020-06-29T19:40:20Z", "commit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0MDoyMVrOGqfbwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0MDoyMVrOGqfbwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIwODM4NQ==", "bodyText": "Use  \"SRVE0242I./metrics.\" to be more specific for metrics endpoint.", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#discussion_r447208385", "createdAt": "2020-06-29T19:40:21Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.logging_fat/fat/src/com/ibm/ws/logging/fat/CustomAccessLogFieldsTest.java", "diffHunk": "@@ -376,6 +400,12 @@ public void testFieldsInAccessLogAreSameInJSON() throws Exception {\n     public void testChangeJsonAccessLogFieldsConfigValue() throws Exception {\n         setUp(changeConfigServer);\n         waitForSecurityPrerequisites(changeConfigServer, WAIT_TIMEOUT);\n+        // Ensure defaultHttpEndpoint-ssl TCP Channel is started\n+        assertNotNull(\"TCP Channel defaultHttpEndpoint-ssl has not started (CWWKO0219I not found)\",\n+                      changeConfigServer.waitForStringInLog(\"CWWKO0219I.*defaultHttpEndpoint-ssl\", 60000));\n+        // Wait for /metrics to be initialized\n+        assertNotNull(\"/metrics was not initialized (SRVE0242I not found)\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "originalPosition": 88}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDQ2MDcw", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-439446070", "createdAt": "2020-06-29T19:42:33Z", "commit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0MjozM1rOGqfgtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0MjozM1rOGqfgtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIwOTY1NQ==", "bodyText": "Do you expect the test to fail when you catch an IOException?", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#discussion_r447209655", "createdAt": "2020-06-29T19:42:33Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.logging_fat/fat/src/com/ibm/ws/logging/fat/CustomAccessLogFieldsTest.java", "diffHunk": "@@ -583,7 +612,7 @@ private static void hitHttpEndpoint(String stringUrl, LibertyServer server) {\n             assertTrue(\"Nothing was returned from the servlet - there was a problem connecting.\", lines.length() > 0);\n             con.disconnect();\n         } catch (IOException e) {\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "originalPosition": 105}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDQ2MTUz", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-439446153", "createdAt": "2020-06-29T19:42:40Z", "commit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0Mjo0MFrOGqfhBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxOTo0Mjo0MFrOGqfhBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIwOTczNA==", "bodyText": "Do you expect the test to fail when you catch an IOException?", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#discussion_r447209734", "createdAt": "2020-06-29T19:42:40Z", "author": {"login": "fmhwong"}, "path": "dev/com.ibm.ws.logging_fat/fat/src/com/ibm/ws/logging/fat/CustomAccessLogFieldsTest.java", "diffHunk": "@@ -623,12 +651,11 @@ public boolean verify(String arg0, SSLSession arg1) {\n             } finally {\n                 br.close();\n             }\n-\n             Log.info(c, \"hitHttpsEndpointSecure\", url + \" reached successfully.\");\n             assertTrue(\"Nothing was returned from the servlet - there was a problem connecting.\", lines.length() > 0);\n             con.disconnect();\n         } catch (IOException e) {\n-\n+            e.printStackTrace();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "originalPosition": 128}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDQ2MzEx", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-439446311", "createdAt": "2020-06-29T19:42:53Z", "commit": {"oid": "b682bebc64598e3a989ab8c59c6b5519c8ba1720"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e47ab972049c727115623d8e83297e27ad9e2362", "author": {"user": null}, "url": "https://github.com/OpenLiberty/open-liberty/commit/e47ab972049c727115623d8e83297e27ad9e2362", "committedDate": "2020-06-30T13:22:55Z", "message": "Add waitForStringInLog for SRVE0242I (/metrics initialization)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47c1c8088fdb417c1f8e48fc7392c3960b8fae65", "author": {"user": null}, "url": "https://github.com/OpenLiberty/open-liberty/commit/47c1c8088fdb417c1f8e48fc7392c3960b8fae65", "committedDate": "2020-06-30T13:22:55Z", "message": "Add fail on exception, move repeated code into method"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2c5d1eb36f6f7c11b5544cbf43c624f2e2706a61", "author": {"user": null}, "url": "https://github.com/OpenLiberty/open-liberty/commit/2c5d1eb36f6f7c11b5544cbf43c624f2e2706a61", "committedDate": "2020-06-29T23:44:50Z", "message": "Add fail on exception, move repeated code into method"}, "afterCommit": {"oid": "47c1c8088fdb417c1f8e48fc7392c3960b8fae65", "author": {"user": null}, "url": "https://github.com/OpenLiberty/open-liberty/commit/47c1c8088fdb417c1f8e48fc7392c3960b8fae65", "committedDate": "2020-06-30T13:22:55Z", "message": "Add fail on exception, move repeated code into method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNDA0ODg5", "url": "https://github.com/OpenLiberty/open-liberty/pull/12799#pullrequestreview-440404889", "createdAt": "2020-06-30T21:38:16Z", "commit": {"oid": "47c1c8088fdb417c1f8e48fc7392c3960b8fae65"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2332, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}