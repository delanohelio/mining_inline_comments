{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExMDg3NDQy", "number": 14722, "title": "[14698] Improve perf and log message when using RequestScoped interface", "bodyText": "Fixes #14698 - it makes a minor performance improvement and alerts users that using RequestScoped rest client interfaces is not advisable for security.\nThis fix adds on to an existing test to verify that the message is printed when using RequestScoped.\nThis fix adds a new NLS message that will need to be reviewed.", "createdAt": "2020-10-27T21:29:47Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/14722", "merged": true, "mergeCommit": {"oid": "c10c8144f69963e47d9ca6160b1e2c98ed76f040"}, "closed": true, "closedAt": "2020-11-02T14:56:00Z", "author": {"login": "andymc12"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWwcQ2gFqTUxODE4OTA0Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXnDnAABqjM5NDEzMDc4ODg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4MTg5MDQy", "url": "https://github.com/OpenLiberty/open-liberty/pull/14722#pullrequestreview-518189042", "createdAt": "2020-10-27T22:09:53Z", "commit": {"oid": "9fece0b2ae3a9426bf5d9dd92296534cfd47576a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QyMjowOTo1M1rOHpS4Hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QyMjowOTo1M1rOHpS4Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA2Mjk0Mg==", "bodyText": "I'd guess there will be some translation problems with this (maybe not).  Maybe \"If possible, use the @applicationScoped annotation on the interface to avoid redundant initialization.\"", "url": "https://github.com/OpenLiberty/open-liberty/pull/14722#discussion_r513062942", "createdAt": "2020-10-27T22:09:53Z", "author": {"login": "jim-krueger"}, "path": "dev/com.ibm.ws.microprofile.rest.client.cdi/resources/com/ibm/ws/microprofile/rest/client/cdi/nls/MPRestClientMessages.nlsprops", "diffHunk": "@@ -0,0 +1,26 @@\n+###############################################################################\n+# Copyright (c) 2020 IBM Corporation and others.\n+# All rights reserved. This program and the accompanying materials\n+# are made available under the terms of the Eclipse Public License v1.0\n+# which accompanies this distribution, and is available at\n+# http://www.eclipse.org/legal/epl-v10.html\n+#\n+# Contributors:\n+#     IBM Corporation - initial API and implementation\n+###############################################################################\n+\n+# NLS_MESSAGEFORMAT_ALL\n+#\n+#CMVCPATHNAME com.ibm.ws.jaxrs20.client/resources/com/ibm/ws/jaxrs20/client/internal/resources/JAXRSClientMessages.nlsprops\n+#ISMESSAGEFILE TRUE\n+#COMPONENTPREFIX CWWKW\n+#COMPONENTNAMEFOR CWWKW WebSphere JAXRS20 Client Code\n+#RANGE 0750 - 0799\n+#\n+#NLS_MESSAGEFORMAT_VAR\n+#NLS_ENCODING=UNICODE\n+\n+# {0} is a space separated list of interface class names\n+rest.client.interface.using.request.scope=CWWKW0750I: The following interfaces are configured as RequestScoped which will result in slower performance: {0} \n+rest.client.interface.using.request.scope.explanation=MicroProfile Rest Client interfaces that are request scoped are initialized on each request which often involves redundant computations. Application scoped interface will only perform the initialization process once per application instance. \n+rest.client.interface.using.request.scope.useraction=Unless there is a valid reason not to, consider using the @ApplicationScoped annotation on the interface to avoid redundant initialization.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9fece0b2ae3a9426bf5d9dd92296534cfd47576a"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4MTkwODQy", "url": "https://github.com/OpenLiberty/open-liberty/pull/14722#pullrequestreview-518190842", "createdAt": "2020-10-27T22:13:25Z", "commit": {"oid": "9fece0b2ae3a9426bf5d9dd92296534cfd47576a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QyMjoxMzoyNVrOHpS92A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QyMjoxMzoyNVrOHpS92A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzA2NDQwOA==", "bodyText": "Any need for null checks for processBean or bean?", "url": "https://github.com/OpenLiberty/open-liberty/pull/14722#discussion_r513064408", "createdAt": "2020-10-27T22:13:25Z", "author": {"login": "jim-krueger"}, "path": "dev/com.ibm.ws.microprofile.rest.client.cdi/src/com/ibm/ws/microprofile/rest/client/cdi/LibertyRestClientExtension.java", "diffHunk": "@@ -91,5 +96,24 @@ public void registerClientBeans(@Observes AfterBeanDiscovery afterBeanDiscovery,\n \n     public void registerErrors(@Observes AfterDeploymentValidation afterDeploymentValidation) {\n         errors.forEach(afterDeploymentValidation::addDeploymentProblem);\n+        if (!requestScopedInterfaces.isEmpty()) {\n+            \n+            Tr.info(tc, \"rest.client.interface.using.request.scope\", \n+                    requestScopedInterfaces.stream().map(c -> c.getName()).collect(Collectors.joining(\" \")));\n+        }\n+        \n+    }\n+\n+    public void logRequestScopedClientInterfaces(@Observes ProcessBean<?> processBean) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9fece0b2ae3a9426bf5d9dd92296534cfd47576a"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4MTkxNDgy", "url": "https://github.com/OpenLiberty/open-liberty/pull/14722#pullrequestreview-518191482", "createdAt": "2020-10-27T22:14:40Z", "commit": {"oid": "9fece0b2ae3a9426bf5d9dd92296534cfd47576a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4MTkyNDUy", "url": "https://github.com/OpenLiberty/open-liberty/pull/14722#pullrequestreview-518192452", "createdAt": "2020-10-27T22:16:35Z", "commit": {"oid": "9fece0b2ae3a9426bf5d9dd92296534cfd47576a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8319118f05e30a921cc463295ecb0953c4dba8be", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/8319118f05e30a921cc463295ecb0953c4dba8be", "committedDate": "2020-10-29T16:31:49Z", "message": "[14698] Improve perf and log message when using RequestScoped interface"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9fece0b2ae3a9426bf5d9dd92296534cfd47576a", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/9fece0b2ae3a9426bf5d9dd92296534cfd47576a", "committedDate": "2020-10-27T21:24:24Z", "message": "[14698] Improve perf and log message when using RequestScoped interface"}, "afterCommit": {"oid": "f72414df2d8e71623bb59fbbada91dd5f7f148a2", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/f72414df2d8e71623bb59fbbada91dd5f7f148a2", "committedDate": "2020-10-29T16:31:50Z", "message": "[14698] Upgrade CXF 3.4.1 snapshot for MP bundle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cadc969499a02e5fd1d794ebaab85183ccb366ea", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/cadc969499a02e5fd1d794ebaab85183ccb366ea", "committedDate": "2020-10-30T13:47:14Z", "message": "[14698] Log `@Dependent` client intf injected into `@RequestScoped` bean\n\nThis anti-pattern results in the same net performance loss as if the\nrest client interface were explicitly annotated with `@RequestScoped`."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08912940dd86de359a238522ccc947ab5bfad786", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/08912940dd86de359a238522ccc947ab5bfad786", "committedDate": "2020-10-30T13:47:34Z", "message": "[14698] Upgrade CXF 3.4.1 snapshot for MP bundle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f72414df2d8e71623bb59fbbada91dd5f7f148a2", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/f72414df2d8e71623bb59fbbada91dd5f7f148a2", "committedDate": "2020-10-29T16:31:50Z", "message": "[14698] Upgrade CXF 3.4.1 snapshot for MP bundle"}, "afterCommit": {"oid": "08912940dd86de359a238522ccc947ab5bfad786", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/08912940dd86de359a238522ccc947ab5bfad786", "committedDate": "2020-10-30T13:47:34Z", "message": "[14698] Upgrade CXF 3.4.1 snapshot for MP bundle"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3015, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}