{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwNjIzMTQz", "number": 10338, "title": "Adding programmatic timer", "bodyText": "Enable application to create a programmatic timer.  This timer is being created by an automatic timer that runs once an hour.  The programmatic timer that is created runs every 5 minutes for a half an hour.\nThis is to simulate the customer case where their app responds to some user action (button click, or http request) which starts a timer action.", "createdAt": "2020-01-08T19:42:50Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/10338", "merged": true, "mergeCommit": {"oid": "eea2bfb9f8adb43a3a3b9f18abd7b35b0992e639"}, "closed": true, "closedAt": "2020-01-09T14:19:35Z", "author": {"login": "KyleAure"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4bh6bABqjI5MzI2NDk1Nzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4cYOAgFqTM0MDE2MTU3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fc2c9a7cedc6fa7d410bb63586d4e50b542eaf06", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/fc2c9a7cedc6fa7d410bb63586d4e50b542eaf06", "committedDate": "2020-01-08T19:38:45Z", "message": "Adding programmatic timer"}, "afterCommit": {"oid": "2a146b789000937be3f09dbc3cc675859b256fd1", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/2a146b789000937be3f09dbc3cc675859b256fd1", "committedDate": "2020-01-08T20:38:43Z", "message": "Adding programmatic timer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4b3e180167af8938717ecf9042ec1b1d34781b6", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/c4b3e180167af8938717ecf9042ec1b1d34781b6", "committedDate": "2020-01-08T20:41:57Z", "message": "Adding programmatic timer"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a146b789000937be3f09dbc3cc675859b256fd1", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/2a146b789000937be3f09dbc3cc675859b256fd1", "committedDate": "2020-01-08T20:38:43Z", "message": "Adding programmatic timer"}, "afterCommit": {"oid": "c4b3e180167af8938717ecf9042ec1b1d34781b6", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/c4b3e180167af8938717ecf9042ec1b1d34781b6", "committedDate": "2020-01-08T20:41:57Z", "message": "Adding programmatic timer"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMTM2NjE4", "url": "https://github.com/OpenLiberty/open-liberty/pull/10338#pullrequestreview-340136618", "createdAt": "2020-01-08T20:50:57Z", "commit": {"oid": "c4b3e180167af8938717ecf9042ec1b1d34781b6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMDo1MDo1N1rOFbjeZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQyMTowNDoyNVrOFbjynw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQzNzA5Mw==", "bodyText": "The 3 second value will not be permitted (too small) on latest level of code (meaning tests will fail when you try a personal build).  There is a way for tests to override that, but the performance test is intended to be more like real world scenarios.  The minimum allowed value is currently 100s.", "url": "https://github.com/OpenLiberty/open-liberty/pull/10338#discussion_r364437093", "createdAt": "2020-01-08T20:50:57Z", "author": {"login": "njr-11"}, "path": "dev/com.ibm.ws.concurrent.persistent_fat_demo_timers/publish/servers/com.ibm.ws.concurrent.persistent.fat.demo.timers/server.xml", "diffHunk": "@@ -16,8 +16,11 @@\n   </featureManager>\n \n   <include location=\"../fatTestPorts.xml\"/>\n-\n-  <dataSource id=\"DefaultDataSource\" fat.modify=\"true\">\n+  \n+  <!-- Edit persistentExecutor defaults with attribute missedTaskThreshold to enable failover -->\n+  <persistentExecutor id=\"defaultEJBPersistentTimerExecutor\" missedTaskThreshold=\"3s\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4b3e180167af8938717ecf9042ec1b1d34781b6"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ0MjI3MQ==", "bodyText": "The fact that it is possible to run the test with a one-phase only data source tells me that we need to add/update a scenario to cover multiple transactional resources.  It's fine to deliver this for now, be we need a follow-on work item to cover that.  It should be an easy update, just tweak the @Resource for the DataSource in AutomaticDatabase timer.  But then the create table code will need to be moved so that XADataSource can be used.", "url": "https://github.com/OpenLiberty/open-liberty/pull/10338#discussion_r364442271", "createdAt": "2020-01-08T21:04:25Z", "author": {"login": "njr-11"}, "path": "dev/com.ibm.ws.concurrent.persistent_fat_demo_timers/fat/src/com/ibm/ws/concurrent/persistent/fat/demo/timers/DemoTimerTest.java", "diffHunk": "@@ -56,6 +56,15 @@ public static void setUp() throws Exception {\n         //Get driver name\n         server.addEnvVar(\"DB_DRIVER\", DatabaseContainerType.valueOf(testContainer).getDriverName());\n \n+        if (DatabaseContainerType.valueOf(testContainer) == DatabaseContainerType.Oracle) {\n+            //Type=javax.sql.ConnectionPoolDataSource to avoid\n+            //  ORA-02089: COMMIT is not allowed in a subordinate session\n+            //  when application tries to create a new table using oracle.\n+            server.addEnvVar(\"DS_TYPE\", \"javax.sql.ConnectionPoolDataSource\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4b3e180167af8938717ecf9042ec1b1d34781b6"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79ef95f347c1e6cba4b598de134dfe37a90ae1d8", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/79ef95f347c1e6cba4b598de134dfe37a90ae1d8", "committedDate": "2020-01-08T21:20:35Z", "message": "feedback changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMTYxNTc5", "url": "https://github.com/OpenLiberty/open-liberty/pull/10338#pullrequestreview-340161579", "createdAt": "2020-01-08T21:38:29Z", "commit": {"oid": "79ef95f347c1e6cba4b598de134dfe37a90ae1d8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3454, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}