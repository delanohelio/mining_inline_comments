{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NjA0ODkz", "number": 13401, "title": "Issue 13400: Adjust message for other JDKs Acme config test", "bodyText": "Fixes #13400\nIf the test is running on OpenJDK, sometimes the messages don't include the SocketTimeoutException. For example,\ncom.ibm.ws.security.acme.internal.AcmeConfigService          E CWPKI2016E: The ACME service request for an existing account from the ACME certificate authority at the https://localhost:32785/dir URI failed. The error is 'sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target'.\ncom.ibm.ws.security.acme.internal.AcmeConfigService          E CWPKI2016E: The ACME service request for an existing account from the ACME certificate authority at the https://localhost:32785/dir URI failed. The error is 'java.net.SocketTimeoutException: Read timed out'.\n\nI thought this just happened on OpenJDK, but it seems more widespread. I'm going to make this more generic.", "createdAt": "2020-08-10T16:27:22Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/13401", "merged": true, "mergeCommit": {"oid": "9bea46161355d0af64d8804f051dc6081514a934"}, "closed": true, "closedAt": "2020-08-13T11:45:31Z", "author": {"login": "kristip17"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc96Uq4AFqTQ2NTI4MTgzNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-SYT_ABqjM2NDk1Mzc3NzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MjgxODM1", "url": "https://github.com/OpenLiberty/open-liberty/pull/13401#pullrequestreview-465281835", "createdAt": "2020-08-11T17:31:43Z", "commit": {"oid": "276f419bb12821082f76a0e0e0d10bf068ebde7c"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNzozMTo0M1rOG_CG_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNzozMjowMFrOG_CHlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODc0ODAyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\t\tassertTrue(\"Expected CWPKI2016E containg SocketTimeoutException in logs.\",\n          \n          \n            \n            \t\t\t\t\tassertTrue(\"Expected CWPKI2016E containing SocketTimeoutException in logs.\",", "url": "https://github.com/OpenLiberty/open-liberty/pull/13401#discussion_r468748029", "createdAt": "2020-08-11T17:31:43Z", "author": {"login": "jvanhill"}, "path": "dev/com.ibm.ws.security.acme_fat/fat/src/com/ibm/ws/security/acme/fat/AcmeConfigVariationsTest.java", "diffHunk": "@@ -685,8 +686,20 @@ public void httpReadConnectTimeouts() throws Exception {\n \t\t\tconfiguration.getAcmeCA().setAcmeTransportConfig(acmeTransportConfig);\n \t\t\tAcmeFatUtils.configureAcmeCA(server, caContainer, configuration);\n \t\t\tAcmeFatUtils.renewCertificate(server);\n-\t\t\tassertNotNull(\"Expected CWPKI2016E in logs.\",\n-\t\t\t\t\tserver.waitForStringInLog(\"CWPKI2016E.*SocketTimeoutException\"));\n+\t\t\tString returnString = server.waitForStringInLog(\"CWPKI2016E\");\n+\t\t\tassertNotNull(\"Expected CWPKI2016E in logs.\", returnString);\n+\t\t\tif (!returnString.contains(\"SocketTimeoutException\")) {\n+\t\t\t\tif (!AcmeFatUtils.isOpenJDK(testName.getMethodName())) {\n+\t\t\t\t\t/*\n+\t\t\t\t\t * On some OpenJDKs, the cause by error message isn't as consistent. For\n+\t\t\t\t\t * example, Caused by:\n+\t\t\t\t\t * sun.security.provider.certpath.SunCertPathBuilderException: unable to find\n+\t\t\t\t\t * valid certification path to requested target\n+\t\t\t\t\t */\n+\t\t\t\t\tassertTrue(\"Expected CWPKI2016E containg SocketTimeoutException in logs.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "276f419bb12821082f76a0e0e0d10bf068ebde7c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODc0ODE4MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\t\tassertTrue(\"Expected CWPKI2016E containg SocketTimeoutException in logs.\", returnString.contains(\"SocketTimeoutException\"));\n          \n          \n            \n            \t\t\t\t\tassertTrue(\"Expected CWPKI2016E containing SocketTimeoutException in logs.\", returnString.contains(\"SocketTimeoutException\"));", "url": "https://github.com/OpenLiberty/open-liberty/pull/13401#discussion_r468748180", "createdAt": "2020-08-11T17:32:00Z", "author": {"login": "jvanhill"}, "path": "dev/com.ibm.ws.security.acme_fat/fat/src/com/ibm/ws/security/acme/fat/AcmeConfigVariationsTest.java", "diffHunk": "@@ -700,8 +713,14 @@ public void httpReadConnectTimeouts() throws Exception {\n \t\t\tacmeTransportConfig.setHttpReadTimeout(\"1ms\");\n \t\t\tAcmeFatUtils.configureAcmeCA(server, caContainer, configuration);\n \t\t\tAcmeFatUtils.renewCertificate(server);\n-\t\t\tassertNotNull(\"Expected CWPKI2016E in logs.\",\n-\t\t\t\t\tserver.waitForStringInLog(\"CWPKI2016E.*SocketTimeoutException\"));\n+\t\t\t\n+\t\t\treturnString = server.waitForStringInLog(\"CWPKI2016E\");\n+\t\t\tassertNotNull(\"Expected CWPKI2016E in logs.\", returnString);\n+\t\t\tif (!returnString.contains(\"SocketTimeoutException\")) {\n+\t\t\t\tif (!AcmeFatUtils.isOpenJDK(testName.getMethodName())) {\n+\t\t\t\t\tassertTrue(\"Expected CWPKI2016E containg SocketTimeoutException in logs.\", returnString.contains(\"SocketTimeoutException\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "276f419bb12821082f76a0e0e0d10bf068ebde7c"}, "originalPosition": 42}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "276f419bb12821082f76a0e0e0d10bf068ebde7c", "author": {"user": {"login": "kristip17", "name": "Kristi Peterson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/276f419bb12821082f76a0e0e0d10bf068ebde7c", "committedDate": "2020-08-10T16:24:58Z", "message": "Issue 13400: Adjust message for other JDKs Acme config test"}, "afterCommit": {"oid": "9b1ea30c48a1af2939ad6e8c54482d80e717fe04", "author": {"user": {"login": "kristip17", "name": "Kristi Peterson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/9b1ea30c48a1af2939ad6e8c54482d80e717fe04", "committedDate": "2020-08-11T17:40:11Z", "message": "Issue 13400: Adjust message for other JDKs Acme config test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b1ea30c48a1af2939ad6e8c54482d80e717fe04", "author": {"user": {"login": "kristip17", "name": "Kristi Peterson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/9b1ea30c48a1af2939ad6e8c54482d80e717fe04", "committedDate": "2020-08-11T17:40:11Z", "message": "Issue 13400: Adjust message for other JDKs Acme config test"}, "afterCommit": {"oid": "0deb6e63c5a737a3fa196d935a42d9ca37d588b3", "author": {"user": {"login": "kristip17", "name": "Kristi Peterson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/0deb6e63c5a737a3fa196d935a42d9ca37d588b3", "committedDate": "2020-08-12T02:08:10Z", "message": "Issue 13400: Adjust message for other JDKs Acme config test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2da7eccf1cbaf660fbd0855b1e419038957a2846", "author": {"user": {"login": "kristip17", "name": "Kristi Peterson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/2da7eccf1cbaf660fbd0855b1e419038957a2846", "committedDate": "2020-08-12T21:33:56Z", "message": "Issue 13400: Adjust message for other JDKs Acme config test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0deb6e63c5a737a3fa196d935a42d9ca37d588b3", "author": {"user": {"login": "kristip17", "name": "Kristi Peterson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/0deb6e63c5a737a3fa196d935a42d9ca37d588b3", "committedDate": "2020-08-12T02:08:10Z", "message": "Issue 13400: Adjust message for other JDKs Acme config test"}, "afterCommit": {"oid": "2da7eccf1cbaf660fbd0855b1e419038957a2846", "author": {"user": {"login": "kristip17", "name": "Kristi Peterson"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/2da7eccf1cbaf660fbd0855b1e419038957a2846", "committedDate": "2020-08-12T21:33:56Z", "message": "Issue 13400: Adjust message for other JDKs Acme config test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1983, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}