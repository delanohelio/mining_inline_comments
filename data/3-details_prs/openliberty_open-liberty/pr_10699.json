{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNDAyMjA3", "number": 10699, "title": "Fixing XA Recovery issue with Postgres and optimized creating table", "bodyText": "It was found that during XA recovery Postgres (even when using isolation level Serializable) will return results for any connections that were commited, while not returning results for those that are in-doubt (that is in recovery).  And that Postgres takes a little bit longer than other databases to perform recovery\nTherefore, that test has been changed to poll that database once a second for 5 seconds.  This should give postgres enough time to perform XA recovery.\nAlso suppressed logs of server config changes at the end of tests as this was bloating the output.txt file and not displaying anything useful.\nFinally, decided to create the database table during the init phase of the servlet so that we can guarantee the table will be available for the app.", "createdAt": "2020-02-03T16:17:22Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/10699", "merged": true, "mergeCommit": {"oid": "89966d512488b2d6724c61d938a8c2a7faa20ae3"}, "closed": true, "closedAt": "2020-02-06T17:09:45Z", "author": {"login": "KyleAure"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBFbMVABqjMwMDcxMjI5MTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBZJSvgFqTM1Mzg4MTIwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "efd3c89d1a1b52fda5b6622e5f712d756ee6c88f", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/efd3c89d1a1b52fda5b6622e5f712d756ee6c88f", "committedDate": "2020-02-03T16:12:35Z", "message": "Fixing postgres issue during XA recovery"}, "afterCommit": {"oid": "022c28873c33987cb10384fea4c938d6f10e5e08", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/022c28873c33987cb10384fea4c938d6f10e5e08", "committedDate": "2020-02-04T17:58:54Z", "message": "Fixing postgres issue during XA recovery"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMzE0MDUw", "url": "https://github.com/OpenLiberty/open-liberty/pull/10699#pullrequestreview-353314050", "createdAt": "2020-02-04T21:28:38Z", "commit": {"oid": "022c28873c33987cb10384fea4c938d6f10e5e08"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMToyODozOFrOFlkF1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMToyODozOFrOFlkF1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDkzMjk1MQ==", "bodyText": "What was behind moving derbyAuth1 from the datasource in server.xml to the resource reference in ibm-web-bnd.xml?  Is that part of the move to creating the table during init?", "url": "https://github.com/OpenLiberty/open-liberty/pull/10699#discussion_r374932951", "createdAt": "2020-02-04T21:28:38Z", "author": {"login": "gjwatts"}, "path": "dev/com.ibm.ws.jdbc_fat/test-applications/basicfat/resources/WEB-INF/ibm-web-bnd.xml", "diffHunk": "@@ -5,6 +5,10 @@\n   <resource-ref name=\"jdbc/dsfat3\" binding-name=\"jdbc/dsfat3\">\n     <authentication-alias name=\"auth1\"/>\n   </resource-ref>\n+  \n+  <resource-ref name=\"jdbc/dsfat5ref1\" binding-name=\"jdbc/dsfat5\">\n+    <authentication-alias name=\"derbyAuth1\"/>\n+  </resource-ref>\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "022c28873c33987cb10384fea4c938d6f10e5e08"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMzI3NTgx", "url": "https://github.com/OpenLiberty/open-liberty/pull/10699#pullrequestreview-353327581", "createdAt": "2020-02-04T21:51:32Z", "commit": {"oid": "022c28873c33987cb10384fea4c938d6f10e5e08"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMTo1MTozMlrOFlkuYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQyMTo1MTozMlrOFlkuYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDk0MzMyOQ==", "bodyText": "typo: default", "url": "https://github.com/OpenLiberty/open-liberty/pull/10699#discussion_r374943329", "createdAt": "2020-02-04T21:51:32Z", "author": {"login": "gjwatts"}, "path": "dev/com.ibm.ws.jdbc_fat/test-applications/basicfat/src/basicfat/DataSourceTestServlet.java", "diffHunk": "@@ -155,6 +160,9 @@\n     @Resource(lookup = \"jdbc/dsfat5\", shareable = false)\n     DataSource ds5u; // one-phase, default isolation, unsharable, Derby only\n \n+    @Resource(name = \"jdbc/dsfat5ref1\", lookup = \"jdbc/dsfat5\")\n+    DataSource ds5_1; //one-phase, defualt isolation, Derby Only, derbyAuth1 set as authentication alias", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "022c28873c33987cb10384fea4c938d6f10e5e08"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzMzM0NTIy", "url": "https://github.com/OpenLiberty/open-liberty/pull/10699#pullrequestreview-353334522", "createdAt": "2020-02-04T22:03:35Z", "commit": {"oid": "022c28873c33987cb10384fea4c938d6f10e5e08"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "022c28873c33987cb10384fea4c938d6f10e5e08", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/022c28873c33987cb10384fea4c938d6f10e5e08", "committedDate": "2020-02-04T17:58:54Z", "message": "Fixing postgres issue during XA recovery"}, "afterCommit": {"oid": "7bd2c6a5b5c75033e986727238836733c3d777fa", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/7bd2c6a5b5c75033e986727238836733c3d777fa", "committedDate": "2020-02-05T14:50:55Z", "message": "Fixing postgres issue during XA recovery"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a10e9c9c7886370ad3df258cc319d6685a7a0cbe", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/a10e9c9c7886370ad3df258cc319d6685a7a0cbe", "committedDate": "2020-02-05T14:54:42Z", "message": "Fixing postgres issue during XA recovery"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7bd2c6a5b5c75033e986727238836733c3d777fa", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/7bd2c6a5b5c75033e986727238836733c3d777fa", "committedDate": "2020-02-05T14:50:55Z", "message": "Fixing postgres issue during XA recovery"}, "afterCommit": {"oid": "a10e9c9c7886370ad3df258cc319d6685a7a0cbe", "author": {"user": {"login": "KyleAure", "name": "Kyle Aure"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/a10e9c9c7886370ad3df258cc319d6685a7a0cbe", "committedDate": "2020-02-05T14:54:42Z", "message": "Fixing postgres issue during XA recovery"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUzODgxMjAz", "url": "https://github.com/OpenLiberty/open-liberty/pull/10699#pullrequestreview-353881203", "createdAt": "2020-02-05T16:57:47Z", "commit": {"oid": "a10e9c9c7886370ad3df258cc319d6685a7a0cbe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3322, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}