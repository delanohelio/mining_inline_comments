{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNjY1MDM2", "number": 11378, "title": "Resolve issue where JAX-RS Client SSL feature overrides user-specific security info", "bodyText": "Fixes #11108\nUsing the test case in this PR, I believe I was able to recreate the problem in issue #11108.  It seems that the JAX-RS-SSL auto-feature is overriding the user-specified SSL config (from the MP Rest Client APIs).\nThis fix will check to see if user-specified config is already on the conduit - if so, it uses that config; if not, it uses the Liberty-supplied config.  It is possible to reverse this behavior by specifying com.ibm.ws.jaxrs.client.security.overrideUserTLSConfig=true.", "createdAt": "2020-03-18T21:08:12Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/11378", "merged": true, "mergeCommit": {"oid": "d59b7a0119c37b76be651cbc76df87cb7648fd99"}, "closed": true, "closedAt": "2020-03-26T14:07:54Z", "author": {"login": "andymc12"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcO-LiIAFqTM3NzI0Mzk3OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPP-mhABqjMxNDY3MTQ4Nzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MjQzOTc5", "url": "https://github.com/OpenLiberty/open-liberty/pull/11378#pullrequestreview-377243979", "createdAt": "2020-03-18T21:20:52Z", "commit": {"oid": "b5f1256b2fe7d87933ebfa6f3fac9f2535851caa"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMToyMDo1MlrOF4XUXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQyMToyMDo1MlrOF4XUXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDY0NjYyMA==", "bodyText": "just a comment on the style, I don't normally see null != var it's usually var != null\nnot that it matters", "url": "https://github.com/OpenLiberty/open-liberty/pull/11378#discussion_r394646620", "createdAt": "2020-03-18T21:20:52Z", "author": {"login": "WhiteCat22"}, "path": "dev/com.ibm.ws.jaxrs.2.0.client/src/com/ibm/ws/jaxrs20/client/security/LibertyJaxRsClientSSLOutInterceptor.java", "diffHunk": "@@ -71,36 +80,37 @@ public void handleMessage(Message message) throws Fault {\n         // getSocketFactory will return null if either the ssl feature is not enabled\n         // or if it is enabled but there is no SSL configuration defined.  A null here\n         // means to use the JDK's SSL implementation.\n-        if (getSocketFactory(sslRef) != null) {\n+        SSLSocketFactory socketFactory = getSocketFactory(sslRef);\n+        if (socketFactory != null) {\n             Object disableCNCheckObj = message.get(JAXRSClientConstants.DISABLE_CN_CHECK);\n             Conduit cd = message.getExchange().getConduit(message);\n-            configClientSSL(cd, sslRef, PropertyUtils.isTrue(disableCNCheckObj));\n+            configClientSSL(cd, sslRef, PropertyUtils.isTrue(disableCNCheckObj), socketFactory);\n         }\n     }\n \n-    private void configClientSSL(Conduit conduit, String sslRef, boolean disableCNCheck) {\n+    private void configClientSSL(Conduit conduit, String sslRef, boolean disableCNCheck, SSLSocketFactory socketFactory) {\n \n         //for HTTPS protocol\n         if (conduit instanceof HTTPConduit) {\n             HTTPConduit httpConduit = (HTTPConduit) conduit;\n \n-            TLSClientParameters tlsClientParams = retriveHTTPTLSClientParametersUsingSSLRef(httpConduit, sslRef, disableCNCheck);\n-            if (null != tlsClientParams) {\n-                httpConduit.setTlsClientParameters(tlsClientParams);\n+            if (null == httpConduit.getTlsClientParameters() || overrideUserTLS) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b5f1256b2fe7d87933ebfa6f3fac9f2535851caa"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c88aa42683fe86ee9ba8e14cdf321a3d1fe7d810", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/c88aa42683fe86ee9ba8e14cdf321a3d1fe7d810", "committedDate": "2020-03-19T18:11:45Z", "message": "[11108] Test case for MP Rest Client using hostnameVerifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e3c3a9ea00352506253effaabff3ba48a3d4285", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/4e3c3a9ea00352506253effaabff3ba48a3d4285", "committedDate": "2020-03-19T18:11:45Z", "message": "[11108] Avoid overwriting TLSClientParameters specified by user code"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b5f1256b2fe7d87933ebfa6f3fac9f2535851caa", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/b5f1256b2fe7d87933ebfa6f3fac9f2535851caa", "committedDate": "2020-03-18T21:01:59Z", "message": "[11108] Avoid overwriting TLSClientParameters specified by user code"}, "afterCommit": {"oid": "4e3c3a9ea00352506253effaabff3ba48a3d4285", "author": {"user": {"login": "andymc12", "name": "Andy McCright"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/4e3c3a9ea00352506253effaabff3ba48a3d4285", "committedDate": "2020-03-19T18:11:45Z", "message": "[11108] Avoid overwriting TLSClientParameters specified by user code"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2969, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}