{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzMDcwNzI4", "number": 12575, "title": "Add servlet version check & javax, jakarta check in WebApp Handle Types Method", "bodyText": "fixes #12574\nIt will be the customer's responsibility to transform their application before deploying it on a Jakarta enabled server.\nThis is approach for this first release with the new namespace.  Allow customers to use the Transformer on their applications, or use their IDE to modify the source.  The dynamic aspect of modifying applications has been left as a future feature idea.\nThis PR may need to be revisited depending on what classes are within the customer's app.", "createdAt": "2020-06-11T13:19:30Z", "url": "https://github.com/OpenLiberty/open-liberty/pull/12575", "merged": true, "mergeCommit": {"oid": "495222f5246c914f3c1c0a5ba025556a9d337b7e"}, "closed": true, "closedAt": "2020-07-02T17:12:09Z", "author": {"login": "volosied"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqOrMUgBqjM0MzQyNzA4NTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxBuoygFqTQ0MTg2NTkzMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5cd244778234e5c11ddb0e4c0a5c079c2894a5fb", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/5cd244778234e5c11ddb0e4c0a5c079c2894a5fb", "committedDate": "2020-06-11T13:18:45Z", "message": "12574: Add servlet version check & javax, jakarta check"}, "afterCommit": {"oid": "002bf469ff2c81630bc6efe2ca3ddf3b2e15981a", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/002bf469ff2c81630bc6efe2ca3ddf3b2e15981a", "committedDate": "2020-06-11T13:56:37Z", "message": "12574: Add servlet version check & javax, jakarta check"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "002bf469ff2c81630bc6efe2ca3ddf3b2e15981a", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/002bf469ff2c81630bc6efe2ca3ddf3b2e15981a", "committedDate": "2020-06-11T13:56:37Z", "message": "12574: Add servlet version check & javax, jakarta check"}, "afterCommit": {"oid": "56acfb50caaa8c4fa82dea9f59950fdf8df2cc02", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/56acfb50caaa8c4fa82dea9f59950fdf8df2cc02", "committedDate": "2020-06-30T20:39:47Z", "message": "12574: Add servlet version check & javax, jakarta check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc3dab46b0c0417d76912c9522a6940e0fc71751", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/fc3dab46b0c0417d76912c9522a6940e0fc71751", "committedDate": "2020-06-30T20:43:52Z", "message": "12574: Add servlet version check & javax, jakarta check"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "56acfb50caaa8c4fa82dea9f59950fdf8df2cc02", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/56acfb50caaa8c4fa82dea9f59950fdf8df2cc02", "committedDate": "2020-06-30T20:39:47Z", "message": "12574: Add servlet version check & javax, jakarta check"}, "afterCommit": {"oid": "fc3dab46b0c0417d76912c9522a6940e0fc71751", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/fc3dab46b0c0417d76912c9522a6940e0fc71751", "committedDate": "2020-06-30T20:43:52Z", "message": "12574: Add servlet version check & javax, jakarta check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxODE5MzIz", "url": "https://github.com/OpenLiberty/open-liberty/pull/12575#pullrequestreview-441819323", "createdAt": "2020-07-02T15:49:29Z", "commit": {"oid": "1405f75d8870f987ce6a4212845871b5f3c755a6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo0OTozMFrOGsTifA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo0OTozMFrOGsTifA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTExMDY1Mg==", "bodyText": "Can you use the constant instead: com.ibm.ws.webcontainer.osgi.WebContainer.SPEC_LEVEL_40", "url": "https://github.com/OpenLiberty/open-liberty/pull/12575#discussion_r449110652", "createdAt": "2020-07-02T15:49:30Z", "author": {"login": "pnicolucci"}, "path": "dev/com.ibm.ws.webcontainer/src/com/ibm/ws/webcontainer/osgi/webapp/WebApp.java", "diffHunk": "@@ -1052,18 +1052,29 @@ protected void addClassToHandlesTypesStartupSet(String targetClassName, Set<Clas\n       \n       boolean enableTrace = ( com.ibm.ejs.ras.TraceComponent.isAnyTracingEnabled() && logger.isLoggable (Level.FINE) );\n \n+      int servletSpecLevel = com.ibm.ws.webcontainer.osgi.WebContainer.getServletContainerSpecLevel();\n       //check if excluded because the subclasses includes this... and could be more than we want\n       //might need to exclude something else like javax.* or java*\n-      if (targetClassName.startsWith(\"java\")) {\n-          if ((targetClassName.charAt(4) == '.') || (targetClassName.startsWith(\"javax.\"))) {\n-              if ( enableTrace ) { \n-                  logger.logp(Level.FINE, CLASS_NAME, methodName,\n-                              \"Internal class, {0}, is not added to the ServletContainerInitializers in the application: {1}\",\n-                              new Object[] { targetClassName, this.config.getDisplayName() });\n-              }\n-              return;\n+      if(servletSpecLevel <= 40){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1405f75d8870f987ce6a4212845871b5f3c755a6"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fe3ad52f858b78f885e90a08542c556eceb49fe", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/3fe3ad52f858b78f885e90a08542c556eceb49fe", "committedDate": "2020-07-02T16:08:14Z", "message": "mend"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1405f75d8870f987ce6a4212845871b5f3c755a6", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/1405f75d8870f987ce6a4212845871b5f3c755a6", "committedDate": "2020-07-01T02:41:33Z", "message": "mend"}, "afterCommit": {"oid": "3fe3ad52f858b78f885e90a08542c556eceb49fe", "author": {"user": {"login": "volosied", "name": "Volodymyr Siedlecki"}}, "url": "https://github.com/OpenLiberty/open-liberty/commit/3fe3ad52f858b78f885e90a08542c556eceb49fe", "committedDate": "2020-07-02T16:08:14Z", "message": "mend"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxODY1OTMz", "url": "https://github.com/OpenLiberty/open-liberty/pull/12575#pullrequestreview-441865933", "createdAt": "2020-07-02T16:49:13Z", "commit": {"oid": "3fe3ad52f858b78f885e90a08542c556eceb49fe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2427, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}