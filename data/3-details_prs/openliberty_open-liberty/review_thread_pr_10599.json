{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3NjYxNDg0", "number": 10599, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMjozODoxMFrODeocVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxOTo0NDo0MFrODe7_qA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzNDQ2NDg2OnYy", "diffSide": "RIGHT", "path": "dev/com.ibm.ws.logging/src/com/ibm/ws/logging/internal/impl/BaseTraceFormatter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMjozODoxMFrOFn4Mbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMzo0NTozMFrOFn5rWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM1OTQ3MA==", "bodyText": "This String does not make sense.  It does not give you the class of the object that is being proxied, so it would make more sense to me for it to just do the default toString() behavior:\nclassName + \"@\" + Integer.toHexString(System.identityHashCode(objs))", "url": "https://github.com/OpenLiberty/open-liberty/pull/10599#discussion_r377359470", "createdAt": "2020-02-10T22:38:10Z", "author": {"login": "jhanders34"}, "path": "dev/com.ibm.ws.logging/src/com/ibm/ws/logging/internal/impl/BaseTraceFormatter.java", "diffHunk": "@@ -1001,6 +996,53 @@ public String formatObj(Object objs) {\n         return ans;\n     }\n \n+    private String formatObject(Object objs, int depth) {\n+        if (objs == null) {\n+            return null;\n+        }\n+        if (depth >= COLLECTION_DEPTH_LIMIT) {\n+            return \"Collection depth limit exceeded\";\n+        }\n+        if (objs instanceof Collection) {\n+            try {\n+                Iterator<?> iter = ((Collection<?>) objs).iterator();\n+                StringBuilder sb = new StringBuilder(\"[\");\n+                if (iter.hasNext()) {\n+                    sb.append(formatObject(iter.next(), depth + 1));\n+                }\n+                while (iter.hasNext()) {\n+                    sb.append(\", \").append(formatObject(iter.next(), depth + 1));\n+                }\n+                sb.append(\"]\");\n+                return sb.toString();\n+            } catch (Throwable t) {\n+                return \"[Caught \" + t.toString() + \" while logging collection type \" + objs.getClass().getName() + \"]\";\n+            }\n+        }\n+        if (objs instanceof Untraceable) {\n+            return objs.getClass().getName(); // Use only the class name of the object\n+        } else if (objs instanceof Traceable) {\n+            return formatTraceable((Traceable) objs);\n+        } else if (objs instanceof TruncatableThrowable) {\n+            return DataFormatHelper.throwableToString((TruncatableThrowable) objs);\n+        } else if (objs instanceof Throwable) {\n+            return DataFormatHelper.throwableToString(new TruncatableThrowable((Throwable) objs));\n+        }\n+        try { // Protect ourselves from badly behaved toString methods\n+            Class<?> cls = objs.getClass();\n+            String className = cls.getName();\n+            if (Proxy.isProxyClass(cls) || className.contains(\"$Proxy$_$$_Weld\")) {\n+                return \"Proxy for \" + className;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa01f8b242cb0f874dca7fa9088edfb09e2f9569"}, "originalPosition": 153}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM4Mzc3MQ==", "bodyText": "done", "url": "https://github.com/OpenLiberty/open-liberty/pull/10599#discussion_r377383771", "createdAt": "2020-02-10T23:45:30Z", "author": {"login": "andymc12"}, "path": "dev/com.ibm.ws.logging/src/com/ibm/ws/logging/internal/impl/BaseTraceFormatter.java", "diffHunk": "@@ -1001,6 +996,53 @@ public String formatObj(Object objs) {\n         return ans;\n     }\n \n+    private String formatObject(Object objs, int depth) {\n+        if (objs == null) {\n+            return null;\n+        }\n+        if (depth >= COLLECTION_DEPTH_LIMIT) {\n+            return \"Collection depth limit exceeded\";\n+        }\n+        if (objs instanceof Collection) {\n+            try {\n+                Iterator<?> iter = ((Collection<?>) objs).iterator();\n+                StringBuilder sb = new StringBuilder(\"[\");\n+                if (iter.hasNext()) {\n+                    sb.append(formatObject(iter.next(), depth + 1));\n+                }\n+                while (iter.hasNext()) {\n+                    sb.append(\", \").append(formatObject(iter.next(), depth + 1));\n+                }\n+                sb.append(\"]\");\n+                return sb.toString();\n+            } catch (Throwable t) {\n+                return \"[Caught \" + t.toString() + \" while logging collection type \" + objs.getClass().getName() + \"]\";\n+            }\n+        }\n+        if (objs instanceof Untraceable) {\n+            return objs.getClass().getName(); // Use only the class name of the object\n+        } else if (objs instanceof Traceable) {\n+            return formatTraceable((Traceable) objs);\n+        } else if (objs instanceof TruncatableThrowable) {\n+            return DataFormatHelper.throwableToString((TruncatableThrowable) objs);\n+        } else if (objs instanceof Throwable) {\n+            return DataFormatHelper.throwableToString(new TruncatableThrowable((Throwable) objs));\n+        }\n+        try { // Protect ourselves from badly behaved toString methods\n+            Class<?> cls = objs.getClass();\n+            String className = cls.getName();\n+            if (Proxy.isProxyClass(cls) || className.contains(\"$Proxy$_$$_Weld\")) {\n+                return \"Proxy for \" + className;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM1OTQ3MA=="}, "originalCommit": {"oid": "fa01f8b242cb0f874dca7fa9088edfb09e2f9569"}, "originalPosition": 153}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzNDQ3MDY0OnYy", "diffSide": "RIGHT", "path": "dev/com.ibm.ws.logging/src/com/ibm/ws/logging/internal/impl/BaseTraceFormatter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMjo0MDoxN1rOFn4P7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMzo0NTozNlrOFn5rhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM2MDM2Ng==", "bodyText": "This should return nullParamString not null", "url": "https://github.com/OpenLiberty/open-liberty/pull/10599#discussion_r377360366", "createdAt": "2020-02-10T22:40:17Z", "author": {"login": "jhanders34"}, "path": "dev/com.ibm.ws.logging/src/com/ibm/ws/logging/internal/impl/BaseTraceFormatter.java", "diffHunk": "@@ -1001,6 +996,53 @@ public String formatObj(Object objs) {\n         return ans;\n     }\n \n+    private String formatObject(Object objs, int depth) {\n+        if (objs == null) {\n+            return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa01f8b242cb0f874dca7fa9088edfb09e2f9569"}, "originalPosition": 119}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM4MzgxMw==", "bodyText": "done", "url": "https://github.com/OpenLiberty/open-liberty/pull/10599#discussion_r377383813", "createdAt": "2020-02-10T23:45:36Z", "author": {"login": "andymc12"}, "path": "dev/com.ibm.ws.logging/src/com/ibm/ws/logging/internal/impl/BaseTraceFormatter.java", "diffHunk": "@@ -1001,6 +996,53 @@ public String formatObj(Object objs) {\n         return ans;\n     }\n \n+    private String formatObject(Object objs, int depth) {\n+        if (objs == null) {\n+            return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM2MDM2Ng=="}, "originalCommit": {"oid": "fa01f8b242cb0f874dca7fa9088edfb09e2f9569"}, "originalPosition": 119}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzNDQ4OTU0OnYy", "diffSide": "RIGHT", "path": "dev/com.ibm.ws.logging/src/com/ibm/ws/logging/internal/impl/BaseTraceFormatter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMjo0NzozMFrOFn4bhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMFQyMzo0NjowMFrOFn5sAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM2MzMzNA==", "bodyText": "Should this be changed to do something more like this?\nif (objs instanceof Collection) {\n    Object[] objArray = null;\n    while (objArray == null) {\n        try {\n            objArray = objs.toArray();\n        } catch (ConcurrentModificationException cme) {\n            // this exception is possible.  Need to retry until it doesn't happen any longer.\n        } catch (NoSuchElementException nsee) {\n            // this exception is possible.  Need to retry until it doesn't happen any longer.\n        } catch (Throwable t) {\n            return \"[Caught \" + t.toString() + \" while logging collection type \" + objs.getClass().getName() + \"]\";\n        }\n    }\n    StringBuilder sb = new StringBuilder(\"[\");\n    if (objArray.length != 0) {\n        sb.append(formatObject(objArray[0], depth + 1));\n    }\n    for (int i = 1; i < objArrays.length; ++i) {\n        sb.append(', ').append(formatObject(objArray[i], depth + 1));\n    }\n    sb.append(\"]\");\n    return sb.toString();\n}", "url": "https://github.com/OpenLiberty/open-liberty/pull/10599#discussion_r377363334", "createdAt": "2020-02-10T22:47:30Z", "author": {"login": "jhanders34"}, "path": "dev/com.ibm.ws.logging/src/com/ibm/ws/logging/internal/impl/BaseTraceFormatter.java", "diffHunk": "@@ -1001,6 +996,53 @@ public String formatObj(Object objs) {\n         return ans;\n     }\n \n+    private String formatObject(Object objs, int depth) {\n+        if (objs == null) {\n+            return null;\n+        }\n+        if (depth >= COLLECTION_DEPTH_LIMIT) {\n+            return \"Collection depth limit exceeded\";\n+        }\n+        if (objs instanceof Collection) {\n+            try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa01f8b242cb0f874dca7fa9088edfb09e2f9569"}, "originalPosition": 125}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM4MzkzNg==", "bodyText": "done - also added an \"out\" if >= 100 retryable exceptions occur on the same collection", "url": "https://github.com/OpenLiberty/open-liberty/pull/10599#discussion_r377383936", "createdAt": "2020-02-10T23:46:00Z", "author": {"login": "andymc12"}, "path": "dev/com.ibm.ws.logging/src/com/ibm/ws/logging/internal/impl/BaseTraceFormatter.java", "diffHunk": "@@ -1001,6 +996,53 @@ public String formatObj(Object objs) {\n         return ans;\n     }\n \n+    private String formatObject(Object objs, int depth) {\n+        if (objs == null) {\n+            return null;\n+        }\n+        if (depth >= COLLECTION_DEPTH_LIMIT) {\n+            return \"Collection depth limit exceeded\";\n+        }\n+        if (objs instanceof Collection) {\n+            try {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM2MzMzNA=="}, "originalCommit": {"oid": "fa01f8b242cb0f874dca7fa9088edfb09e2f9569"}, "originalPosition": 125}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzNzY2ODI0OnYy", "diffSide": "RIGHT", "path": "dev/com.ibm.ws.messaging.common/src/com/ibm/ws/sib/mfp/impl/SchemaSet.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxOTo0NDo0MFrOFoWqOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxOTo1OTozNVrOFoXIWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1ODYxOA==", "bodyText": "This is a behavior change to call toVerboseString instead of toString.  Any reason?", "url": "https://github.com/OpenLiberty/open-liberty/pull/10599#discussion_r377858618", "createdAt": "2020-02-11T19:44:40Z", "author": {"login": "jhanders34"}, "path": "dev/com.ibm.ws.messaging.common/src/com/ibm/ws/sib/mfp/impl/SchemaSet.java", "diffHunk": "@@ -362,6 +363,10 @@ public String toVerboseString() {\n     return buf.toString();\n   }\n \n+  @Override\n+  public String toTraceString() {\n+      return toVerboseString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea1c8147400fa4960dc89683ab9e971b6f5a419f"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg2NjMyOQ==", "bodyText": "My thought was that it was more serviceable, but I have changed it to return toString instead to continue the previous behavior.", "url": "https://github.com/OpenLiberty/open-liberty/pull/10599#discussion_r377866329", "createdAt": "2020-02-11T19:59:35Z", "author": {"login": "andymc12"}, "path": "dev/com.ibm.ws.messaging.common/src/com/ibm/ws/sib/mfp/impl/SchemaSet.java", "diffHunk": "@@ -362,6 +363,10 @@ public String toVerboseString() {\n     return buf.toString();\n   }\n \n+  @Override\n+  public String toTraceString() {\n+      return toVerboseString();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Nzg1ODYxOA=="}, "originalCommit": {"oid": "ea1c8147400fa4960dc89683ab9e971b6f5a419f"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2174, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}