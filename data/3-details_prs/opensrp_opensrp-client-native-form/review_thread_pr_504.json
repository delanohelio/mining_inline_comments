{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3Mzg0NDAx", "number": 504, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNDo0OToxMlrOEx7-bQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNTowMDowNFrOEx8UwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwNzk4MzE3OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNDo0OToxMlrOHoTKiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjozMzowMlrOHotIKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAxOTA4MA==", "bodyText": "Not sure why this is +=. In the case that the value in the reference edit text changes, shouldn't the new value be the new number of repeating groups generated?\nThe logic atm looks at the difference and either generates extra groups for a +ve diff or deletes excess groups for a -ve diff.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512019080", "createdAt": "2020-10-26T14:49:12Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "diffHunk": "@@ -82,14 +82,35 @@ protected void onPreExecute() {\n         diff = numRepeatingGroups - currNumRepeatingGroups;\n         for (int i = 0; i < diff; i++) {\n             try {\n+\n                 repeatingGroups.add(buildRepeatingGroupLayout(parent));\n+\n             } catch (Exception e) {\n                 Timber.e(e);\n             }\n         }\n+\n+        updateRepeatingGrpCountObject();\n+\n         return repeatingGroups;\n     }\n \n+    private void updateRepeatingGrpCountObject() {\n+        try {\n+            JSONObject countFieldObject = Utils.getRepeatingGroupCountObj(widgetArgs);\n+            if (countFieldObject != null) {\n+                int currentCount = numRepeatingGroups;\n+                String strNumOfRepeatedGroups = countFieldObject.optString(VALUE);\n+                if (StringUtils.isNotBlank(strNumOfRepeatedGroups)) {\n+                    currentCount += Integer.parseInt(strNumOfRepeatedGroups);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ0NDQ1Nw==", "bodyText": "Ideally the new value should be the summation of all the groups generated otherwise the count object will have incorrect value.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512444457", "createdAt": "2020-10-27T06:33:02Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "diffHunk": "@@ -82,14 +82,35 @@ protected void onPreExecute() {\n         diff = numRepeatingGroups - currNumRepeatingGroups;\n         for (int i = 0; i < diff; i++) {\n             try {\n+\n                 repeatingGroups.add(buildRepeatingGroupLayout(parent));\n+\n             } catch (Exception e) {\n                 Timber.e(e);\n             }\n         }\n+\n+        updateRepeatingGrpCountObject();\n+\n         return repeatingGroups;\n     }\n \n+    private void updateRepeatingGrpCountObject() {\n+        try {\n+            JSONObject countFieldObject = Utils.getRepeatingGroupCountObj(widgetArgs);\n+            if (countFieldObject != null) {\n+                int currentCount = numRepeatingGroups;\n+                String strNumOfRepeatedGroups = countFieldObject.optString(VALUE);\n+                if (StringUtils.isNotBlank(strNumOfRepeatedGroups)) {\n+                    currentCount += Integer.parseInt(strNumOfRepeatedGroups);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAxOTA4MA=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwNzk5NjY2OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/Utils.java", "isResolved": false, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNDo1MTozNVrOHoTScQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNzozNjo0MVrOHpdKrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMTEwNQ==", "bodyText": "Do we need the else block? Is there ever an instance when stepJsonObject is null?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512021105", "createdAt": "2020-10-26T14:51:35Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/Utils.java", "diffHunk": "@@ -874,6 +882,38 @@ public static int getResourceId(Context context, String name, ResourceType resou\n     public static boolean isEmptyJsonArray(JSONArray jsonArray) {\n         return jsonArray == null || jsonArray.length() == 0;\n     }\n+\n+    /**\n+     * Returns the object that holds the repeating group count\n+     *\n+     * @return\n+     * @throws JSONException\n+     */\n+    @Nullable\n+    public static JSONObject getRepeatingGroupCountObj(@NotNull WidgetArgs widgetArgs) throws JSONException {\n+        String repeatingGroupCountObjKey = widgetArgs.getJsonObject().get(KEY) + \"_count\";\n+        JSONObject stepJsonObject = widgetArgs.getFormFragment().getStep(widgetArgs.getStepName());\n+        if (stepJsonObject != null) {\n+            JSONArray stepFields = stepJsonObject.optJSONArray(JsonFormConstants.FIELDS);\n+            JSONObject repeatingGroupCountObj = FormUtils.getFieldJSONObject(stepFields, repeatingGroupCountObjKey);\n+            // prevents re-adding the count object during form traversals\n+            if (repeatingGroupCountObj != null) {\n+                return repeatingGroupCountObj;\n+            }\n+\n+            repeatingGroupCountObj = new JSONObject();\n+            repeatingGroupCountObj.put(KEY, repeatingGroupCountObjKey);\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_PARENT, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_ID, \"\");\n+            repeatingGroupCountObj.put(TYPE, \"\");\n+            repeatingGroupCountObj.put(TEXT, widgetArgs.getJsonObject().get(REFERENCE_EDIT_TEXT_HINT));\n+            stepFields.put(repeatingGroupCountObj);\n+            return repeatingGroupCountObj;\n+        } else {\n+            return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ0Mzg2NA==", "bodyText": "yeah for malformed json form", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512443864", "createdAt": "2020-10-27T06:31:05Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/Utils.java", "diffHunk": "@@ -874,6 +882,38 @@ public static int getResourceId(Context context, String name, ResourceType resou\n     public static boolean isEmptyJsonArray(JSONArray jsonArray) {\n         return jsonArray == null || jsonArray.length() == 0;\n     }\n+\n+    /**\n+     * Returns the object that holds the repeating group count\n+     *\n+     * @return\n+     * @throws JSONException\n+     */\n+    @Nullable\n+    public static JSONObject getRepeatingGroupCountObj(@NotNull WidgetArgs widgetArgs) throws JSONException {\n+        String repeatingGroupCountObjKey = widgetArgs.getJsonObject().get(KEY) + \"_count\";\n+        JSONObject stepJsonObject = widgetArgs.getFormFragment().getStep(widgetArgs.getStepName());\n+        if (stepJsonObject != null) {\n+            JSONArray stepFields = stepJsonObject.optJSONArray(JsonFormConstants.FIELDS);\n+            JSONObject repeatingGroupCountObj = FormUtils.getFieldJSONObject(stepFields, repeatingGroupCountObjKey);\n+            // prevents re-adding the count object during form traversals\n+            if (repeatingGroupCountObj != null) {\n+                return repeatingGroupCountObj;\n+            }\n+\n+            repeatingGroupCountObj = new JSONObject();\n+            repeatingGroupCountObj.put(KEY, repeatingGroupCountObjKey);\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_PARENT, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_ID, \"\");\n+            repeatingGroupCountObj.put(TYPE, \"\");\n+            repeatingGroupCountObj.put(TEXT, widgetArgs.getJsonObject().get(REFERENCE_EDIT_TEXT_HINT));\n+            stepFields.put(repeatingGroupCountObj);\n+            return repeatingGroupCountObj;\n+        } else {\n+            return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMTEwNQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIwMjA5NA==", "bodyText": "The method throws JSONException, so I'm thinking malformed JSON will be covered here? The calling method can then figure out how to handle the exception, no?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513202094", "createdAt": "2020-10-28T06:13:47Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/Utils.java", "diffHunk": "@@ -874,6 +882,38 @@ public static int getResourceId(Context context, String name, ResourceType resou\n     public static boolean isEmptyJsonArray(JSONArray jsonArray) {\n         return jsonArray == null || jsonArray.length() == 0;\n     }\n+\n+    /**\n+     * Returns the object that holds the repeating group count\n+     *\n+     * @return\n+     * @throws JSONException\n+     */\n+    @Nullable\n+    public static JSONObject getRepeatingGroupCountObj(@NotNull WidgetArgs widgetArgs) throws JSONException {\n+        String repeatingGroupCountObjKey = widgetArgs.getJsonObject().get(KEY) + \"_count\";\n+        JSONObject stepJsonObject = widgetArgs.getFormFragment().getStep(widgetArgs.getStepName());\n+        if (stepJsonObject != null) {\n+            JSONArray stepFields = stepJsonObject.optJSONArray(JsonFormConstants.FIELDS);\n+            JSONObject repeatingGroupCountObj = FormUtils.getFieldJSONObject(stepFields, repeatingGroupCountObjKey);\n+            // prevents re-adding the count object during form traversals\n+            if (repeatingGroupCountObj != null) {\n+                return repeatingGroupCountObj;\n+            }\n+\n+            repeatingGroupCountObj = new JSONObject();\n+            repeatingGroupCountObj.put(KEY, repeatingGroupCountObjKey);\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_PARENT, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_ID, \"\");\n+            repeatingGroupCountObj.put(TYPE, \"\");\n+            repeatingGroupCountObj.put(TEXT, widgetArgs.getJsonObject().get(REFERENCE_EDIT_TEXT_HINT));\n+            stepFields.put(repeatingGroupCountObj);\n+            return repeatingGroupCountObj;\n+        } else {\n+            return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMTEwNQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIwNDM1OQ==", "bodyText": "That is a NPE check.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513204359", "createdAt": "2020-10-28T06:20:56Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/Utils.java", "diffHunk": "@@ -874,6 +882,38 @@ public static int getResourceId(Context context, String name, ResourceType resou\n     public static boolean isEmptyJsonArray(JSONArray jsonArray) {\n         return jsonArray == null || jsonArray.length() == 0;\n     }\n+\n+    /**\n+     * Returns the object that holds the repeating group count\n+     *\n+     * @return\n+     * @throws JSONException\n+     */\n+    @Nullable\n+    public static JSONObject getRepeatingGroupCountObj(@NotNull WidgetArgs widgetArgs) throws JSONException {\n+        String repeatingGroupCountObjKey = widgetArgs.getJsonObject().get(KEY) + \"_count\";\n+        JSONObject stepJsonObject = widgetArgs.getFormFragment().getStep(widgetArgs.getStepName());\n+        if (stepJsonObject != null) {\n+            JSONArray stepFields = stepJsonObject.optJSONArray(JsonFormConstants.FIELDS);\n+            JSONObject repeatingGroupCountObj = FormUtils.getFieldJSONObject(stepFields, repeatingGroupCountObjKey);\n+            // prevents re-adding the count object during form traversals\n+            if (repeatingGroupCountObj != null) {\n+                return repeatingGroupCountObj;\n+            }\n+\n+            repeatingGroupCountObj = new JSONObject();\n+            repeatingGroupCountObj.put(KEY, repeatingGroupCountObjKey);\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_PARENT, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_ID, \"\");\n+            repeatingGroupCountObj.put(TYPE, \"\");\n+            repeatingGroupCountObj.put(TEXT, widgetArgs.getJsonObject().get(REFERENCE_EDIT_TEXT_HINT));\n+            stepFields.put(repeatingGroupCountObj);\n+            return repeatingGroupCountObj;\n+        } else {\n+            return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMTEwNQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIxMzE1Ng==", "bodyText": "Ok, but when is the stepJsonObject null?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513213156", "createdAt": "2020-10-28T06:48:51Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/Utils.java", "diffHunk": "@@ -874,6 +882,38 @@ public static int getResourceId(Context context, String name, ResourceType resou\n     public static boolean isEmptyJsonArray(JSONArray jsonArray) {\n         return jsonArray == null || jsonArray.length() == 0;\n     }\n+\n+    /**\n+     * Returns the object that holds the repeating group count\n+     *\n+     * @return\n+     * @throws JSONException\n+     */\n+    @Nullable\n+    public static JSONObject getRepeatingGroupCountObj(@NotNull WidgetArgs widgetArgs) throws JSONException {\n+        String repeatingGroupCountObjKey = widgetArgs.getJsonObject().get(KEY) + \"_count\";\n+        JSONObject stepJsonObject = widgetArgs.getFormFragment().getStep(widgetArgs.getStepName());\n+        if (stepJsonObject != null) {\n+            JSONArray stepFields = stepJsonObject.optJSONArray(JsonFormConstants.FIELDS);\n+            JSONObject repeatingGroupCountObj = FormUtils.getFieldJSONObject(stepFields, repeatingGroupCountObjKey);\n+            // prevents re-adding the count object during form traversals\n+            if (repeatingGroupCountObj != null) {\n+                return repeatingGroupCountObj;\n+            }\n+\n+            repeatingGroupCountObj = new JSONObject();\n+            repeatingGroupCountObj.put(KEY, repeatingGroupCountObjKey);\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_PARENT, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_ID, \"\");\n+            repeatingGroupCountObj.put(TYPE, \"\");\n+            repeatingGroupCountObj.put(TEXT, widgetArgs.getJsonObject().get(REFERENCE_EDIT_TEXT_HINT));\n+            stepFields.put(repeatingGroupCountObj);\n+            return repeatingGroupCountObj;\n+        } else {\n+            return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMTEwNQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIxMzczMQ==", "bodyText": "either way, you can simply return null without the else block, right?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513213731", "createdAt": "2020-10-28T06:50:24Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/Utils.java", "diffHunk": "@@ -874,6 +882,38 @@ public static int getResourceId(Context context, String name, ResourceType resou\n     public static boolean isEmptyJsonArray(JSONArray jsonArray) {\n         return jsonArray == null || jsonArray.length() == 0;\n     }\n+\n+    /**\n+     * Returns the object that holds the repeating group count\n+     *\n+     * @return\n+     * @throws JSONException\n+     */\n+    @Nullable\n+    public static JSONObject getRepeatingGroupCountObj(@NotNull WidgetArgs widgetArgs) throws JSONException {\n+        String repeatingGroupCountObjKey = widgetArgs.getJsonObject().get(KEY) + \"_count\";\n+        JSONObject stepJsonObject = widgetArgs.getFormFragment().getStep(widgetArgs.getStepName());\n+        if (stepJsonObject != null) {\n+            JSONArray stepFields = stepJsonObject.optJSONArray(JsonFormConstants.FIELDS);\n+            JSONObject repeatingGroupCountObj = FormUtils.getFieldJSONObject(stepFields, repeatingGroupCountObjKey);\n+            // prevents re-adding the count object during form traversals\n+            if (repeatingGroupCountObj != null) {\n+                return repeatingGroupCountObj;\n+            }\n+\n+            repeatingGroupCountObj = new JSONObject();\n+            repeatingGroupCountObj.put(KEY, repeatingGroupCountObjKey);\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_PARENT, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_ID, \"\");\n+            repeatingGroupCountObj.put(TYPE, \"\");\n+            repeatingGroupCountObj.put(TEXT, widgetArgs.getJsonObject().get(REFERENCE_EDIT_TEXT_HINT));\n+            stepFields.put(repeatingGroupCountObj);\n+            return repeatingGroupCountObj;\n+        } else {\n+            return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMTEwNQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIyNjEzOQ==", "bodyText": "Ok, but when is the stepJsonObject null?\nWhen the step does not exist ... for malformed json forms\neither way, you can simply return null without the else block, right?\nI will still need an if block", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513226139", "createdAt": "2020-10-28T07:23:54Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/Utils.java", "diffHunk": "@@ -874,6 +882,38 @@ public static int getResourceId(Context context, String name, ResourceType resou\n     public static boolean isEmptyJsonArray(JSONArray jsonArray) {\n         return jsonArray == null || jsonArray.length() == 0;\n     }\n+\n+    /**\n+     * Returns the object that holds the repeating group count\n+     *\n+     * @return\n+     * @throws JSONException\n+     */\n+    @Nullable\n+    public static JSONObject getRepeatingGroupCountObj(@NotNull WidgetArgs widgetArgs) throws JSONException {\n+        String repeatingGroupCountObjKey = widgetArgs.getJsonObject().get(KEY) + \"_count\";\n+        JSONObject stepJsonObject = widgetArgs.getFormFragment().getStep(widgetArgs.getStepName());\n+        if (stepJsonObject != null) {\n+            JSONArray stepFields = stepJsonObject.optJSONArray(JsonFormConstants.FIELDS);\n+            JSONObject repeatingGroupCountObj = FormUtils.getFieldJSONObject(stepFields, repeatingGroupCountObjKey);\n+            // prevents re-adding the count object during form traversals\n+            if (repeatingGroupCountObj != null) {\n+                return repeatingGroupCountObj;\n+            }\n+\n+            repeatingGroupCountObj = new JSONObject();\n+            repeatingGroupCountObj.put(KEY, repeatingGroupCountObjKey);\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_PARENT, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_ID, \"\");\n+            repeatingGroupCountObj.put(TYPE, \"\");\n+            repeatingGroupCountObj.put(TEXT, widgetArgs.getJsonObject().get(REFERENCE_EDIT_TEXT_HINT));\n+            stepFields.put(repeatingGroupCountObj);\n+            return repeatingGroupCountObj;\n+        } else {\n+            return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMTEwNQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIzMTUzMg==", "bodyText": "yea, we can remove the else block though.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513231532", "createdAt": "2020-10-28T07:36:41Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/Utils.java", "diffHunk": "@@ -874,6 +882,38 @@ public static int getResourceId(Context context, String name, ResourceType resou\n     public static boolean isEmptyJsonArray(JSONArray jsonArray) {\n         return jsonArray == null || jsonArray.length() == 0;\n     }\n+\n+    /**\n+     * Returns the object that holds the repeating group count\n+     *\n+     * @return\n+     * @throws JSONException\n+     */\n+    @Nullable\n+    public static JSONObject getRepeatingGroupCountObj(@NotNull WidgetArgs widgetArgs) throws JSONException {\n+        String repeatingGroupCountObjKey = widgetArgs.getJsonObject().get(KEY) + \"_count\";\n+        JSONObject stepJsonObject = widgetArgs.getFormFragment().getStep(widgetArgs.getStepName());\n+        if (stepJsonObject != null) {\n+            JSONArray stepFields = stepJsonObject.optJSONArray(JsonFormConstants.FIELDS);\n+            JSONObject repeatingGroupCountObj = FormUtils.getFieldJSONObject(stepFields, repeatingGroupCountObjKey);\n+            // prevents re-adding the count object during form traversals\n+            if (repeatingGroupCountObj != null) {\n+                return repeatingGroupCountObj;\n+            }\n+\n+            repeatingGroupCountObj = new JSONObject();\n+            repeatingGroupCountObj.put(KEY, repeatingGroupCountObjKey);\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_PARENT, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY, \"\");\n+            repeatingGroupCountObj.put(OPENMRS_ENTITY_ID, \"\");\n+            repeatingGroupCountObj.put(TYPE, \"\");\n+            repeatingGroupCountObj.put(TEXT, widgetArgs.getJsonObject().get(REFERENCE_EDIT_TEXT_HINT));\n+            stepFields.put(repeatingGroupCountObj);\n+            return repeatingGroupCountObj;\n+        } else {\n+            return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMTEwNQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwODAxMzg3OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNDo1NTowNlrOHoTdRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQwNjo1MToxNlrOHpcGJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMzg3OA==", "bodyText": "Based on https://github.com/OpenSRP/opensrp-client-native-form/pull/504/files#r512021105. Should countFieldObject ever be null?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512023878", "createdAt": "2020-10-26T14:55:06Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -106,30 +99,33 @@\n \n         setRepeatingGroupNumLimits(widgetArgs);\n \n+        JSONObject countFieldObject = Utils.getRepeatingGroupCountObj(widgetArgs);\n+\n         //get the generated number of groups\n-        final String generatedGroupsCount = jsonObject.optString(REPEATING_GROUPS_GENERATED_COUNT);\n+        final String generatedGroupsCount = countFieldObject != null ? countFieldObject.optString(VALUE) : \"\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ0MzkxMQ==", "bodyText": "yeah for malformed json form", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512443911", "createdAt": "2020-10-27T06:31:13Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -106,30 +99,33 @@\n \n         setRepeatingGroupNumLimits(widgetArgs);\n \n+        JSONObject countFieldObject = Utils.getRepeatingGroupCountObj(widgetArgs);\n+\n         //get the generated number of groups\n-        final String generatedGroupsCount = jsonObject.optString(REPEATING_GROUPS_GENERATED_COUNT);\n+        final String generatedGroupsCount = countFieldObject != null ? countFieldObject.optString(VALUE) : \"\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMzg3OA=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIxMzk5MQ==", "bodyText": "#504 (comment)", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513213991", "createdAt": "2020-10-28T06:51:16Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -106,30 +99,33 @@\n \n         setRepeatingGroupNumLimits(widgetArgs);\n \n+        JSONObject countFieldObject = Utils.getRepeatingGroupCountObj(widgetArgs);\n+\n         //get the generated number of groups\n-        final String generatedGroupsCount = jsonObject.optString(REPEATING_GROUPS_GENERATED_COUNT);\n+        final String generatedGroupsCount = countFieldObject != null ? countFieldObject.optString(VALUE) : \"\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyMzg3OA=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwODAyODk5OnYy", "diffSide": "LEFT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "isResolved": false, "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNDo1ODowNVrOHoTmnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxMzo0MDoyNlrOHpqh8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ==", "bodyText": "Any reason to remove this? This was recommended as a better user experience by Roger onaio/rdt-standard#319 (comment).", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512026269", "createdAt": "2020-10-26T14:58:05Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ0MTA1Mg==", "bodyText": "Yeah, this feature breaks the normal behaviour of repeating group, it adds a bug ... it creates twice the number of groups needed.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512441052", "createdAt": "2020-10-27T06:22:51Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIwMjMwNg==", "bodyText": "Ok, were you able to figure out why that happens?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513202306", "createdAt": "2020-10-28T06:14:28Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIwNjA1NQ==", "bodyText": "referenceEditText gains focus when cursor is on it, a number is entered ...  then after referenceEditText loses focus when the done button is clicked it fires the addOnDoneAction from focusChange listener at the same time the done button clickListener does the same ... so it generates twice the number of groups.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513206055", "createdAt": "2020-10-28T06:26:40Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIxOTYxOQ==", "bodyText": "Cool. Would removing the addOnDoneAction from the done button work then?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513219619", "createdAt": "2020-10-28T07:06:39Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIyNjc0Nw==", "bodyText": "yeah ... thats why i proposed that to use the feature one has to hide the done button.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513226747", "createdAt": "2020-10-28T07:25:14Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIzMTU4Ng==", "bodyText": "I meant that since onFocusChanged is triggered when the button is clicked (after entering text) we can simply use onFocusChanged and remove the onclicklistener from the done button.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513231586", "createdAt": "2020-10-28T07:36:47Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzIzNjQ5Ng==", "bodyText": "I dont think thats a good idea, looks like a hack ... i think one has to be disabled.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513236496", "createdAt": "2020-10-28T07:47:38Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM0ODgzNg==", "bodyText": "It really isn't. The point of the feature (from Roger's comment) is to generate the repeating group when one navigates away from the reference edit text. Clicking on other views (including the done button) counts as navigating away.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513348836", "createdAt": "2020-10-28T10:52:17Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM2MTU2MQ==", "bodyText": "Why would you need the unclickable done button if you have a onFocusChangeListener on a referenceEditText? I dont get it but anyways ... This needs to be configurable since not all implementation expect that behaviour.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513361561", "createdAt": "2020-10-28T11:14:48Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzQ1MDQ4Mw==", "bodyText": "tbh, it's only for backward compatibility, we don't need a button any more. The button being \"truly\" clickable or not doesn't really change the end-user experience so that's not a problem.\nYou can make it configurable, but any time someone wants both the button and focus change to be supported, the bug will show up again.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r513450483", "createdAt": "2020-10-28T13:40:26Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -327,15 +295,6 @@ public boolean onEditorAction(TextView focusTextView, int actionId, KeyEvent eve\n                     return false;\n                 }\n             });\n-            // generate repeating groups on focus change\n-            referenceEditText.setOnFocusChangeListener(new View.OnFocusChangeListener() {\n-                @Override\n-                public void onFocusChange(View view, boolean hasFocus) {\n-                    if (!hasFocus) {\n-                        addOnDoneAction((TextView) view, doneButton, widgetArgs);\n-                    }\n-                }\n-            });", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyNjI2OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 123}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwODA0MDMyOnYy", "diffSide": "LEFT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yNlQxNTowMDowNFrOHoTtkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QwNjoyNDo1NFrOHos9kQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyODA0OQ==", "bodyText": "I see the logic to write into the count object was moved but is the validation still being done? i.e. is JsonFormFragmentPresenter .validate(widgetArgs.getFormFragment(), referenceEditText, false); still called?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512028049", "createdAt": "2020-10-26T15:00:04Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -377,23 +336,10 @@ public void onTextChanged(CharSequence s, int start, int before, int count) {\n             @Override\n             public void afterTextChanged(Editable s) {\n                 doneButton.setImageResource(R.drawable.ic_done_grey);\n-                ValidationStatus validationStatus = JsonFormFragmentPresenter\n-                        .validate(widgetArgs.getFormFragment(), referenceEditText, false);\n-                if (validationStatus.isValid()) {\n-                    writeJsonObjectValue(repeatingGroupCount, s.toString());\n-                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 135}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyODU0NQ==", "bodyText": "It's useful where the reference edit text has validators added.", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512028545", "createdAt": "2020-10-26T15:00:39Z", "author": {"login": "vincent-karuri"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -377,23 +336,10 @@ public void onTextChanged(CharSequence s, int start, int before, int count) {\n             @Override\n             public void afterTextChanged(Editable s) {\n                 doneButton.setImageResource(R.drawable.ic_done_grey);\n-                ValidationStatus validationStatus = JsonFormFragmentPresenter\n-                        .validate(widgetArgs.getFormFragment(), referenceEditText, false);\n-                if (validationStatus.isValid()) {\n-                    writeJsonObjectValue(repeatingGroupCount, s.toString());\n-                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyODA0OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 135}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ0MTc0NQ==", "bodyText": "good catch", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/504#discussion_r512441745", "createdAt": "2020-10-27T06:24:54Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -377,23 +336,10 @@ public void onTextChanged(CharSequence s, int start, int before, int count) {\n             @Override\n             public void afterTextChanged(Editable s) {\n                 doneButton.setImageResource(R.drawable.ic_done_grey);\n-                ValidationStatus validationStatus = JsonFormFragmentPresenter\n-                        .validate(widgetArgs.getFormFragment(), referenceEditText, false);\n-                if (validationStatus.isValid()) {\n-                    writeJsonObjectValue(repeatingGroupCount, s.toString());\n-                }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjAyODA0OQ=="}, "originalCommit": {"oid": "054bd64b23902cc49a7f31dc08a98b7a8fdf8bf8"}, "originalPosition": 135}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2003, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}