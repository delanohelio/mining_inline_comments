{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwNDUzODA5", "number": 454, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNTozOTozMlrOEPlUZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNzo1OTozMFrOEQBwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0Nzc1NTI1OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/domain/DBResourceBundleControl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNTozOTozMlrOGzX1ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNjo0Njo0NlrOGzZ_vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjUyMTA2MQ==", "bodyText": "Add the override annotation. I know it doesn't change the execution but it's easier for readability", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/454#discussion_r456521061", "createdAt": "2020-07-17T15:39:32Z", "author": {"login": "ekigamba"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/domain/DBResourceBundleControl.java", "diffHunk": "@@ -15,7 +19,28 @@ public DBResourceBundleControl(String identifier) {\n     public ResourceBundle newBundle(String baseName, Locale locale, String format, ClassLoader loader, boolean reload)\n             throws IllegalAccessException,\n             InstantiationException {\n-        return new DBResourceBundle(identifier);\n+        return new DBResourceBundle(getPropertiesFromRepository(identifier));\n+    }\n+\n+    // Don't cache since the DBResourceBundle handles properties for different Locales\n+    public long getTimeToLive(String arg0, Locale arg1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de02abbdadb8a51946759eafcd573122285e7a4f"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjU1NjQ3Ng==", "bodyText": "Yeah. Will do \ud83d\udc4d", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/454#discussion_r456556476", "createdAt": "2020-07-17T16:46:46Z", "author": {"login": "allan-on"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/domain/DBResourceBundleControl.java", "diffHunk": "@@ -15,7 +19,28 @@ public DBResourceBundleControl(String identifier) {\n     public ResourceBundle newBundle(String baseName, Locale locale, String format, ClassLoader loader, boolean reload)\n             throws IllegalAccessException,\n             InstantiationException {\n-        return new DBResourceBundle(identifier);\n+        return new DBResourceBundle(getPropertiesFromRepository(identifier));\n+    }\n+\n+    // Don't cache since the DBResourceBundle handles properties for different Locales\n+    public long getTimeToLive(String arg0, Locale arg1) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjUyMTA2MQ=="}, "originalCommit": {"oid": "de02abbdadb8a51946759eafcd573122285e7a4f"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1MjQxMzk5OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/utils/NativeFormLangUtilsTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNzo1OTozMFrOGz-SOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNzo1OTozMFrOGz-SOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzE1MTAzNQ==", "bodyText": "Nice test \ud83d\udc4d", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/454#discussion_r457151035", "createdAt": "2020-07-20T07:59:30Z", "author": {"login": "ekigamba"}, "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/utils/NativeFormLangUtilsTest.java", "diffHunk": "@@ -84,16 +87,35 @@ public void testYamlFileTranslationShouldReturnUntranslatedYamlFile() {\n     }\n \n     @Test\n-    public void canGetResourceBundleWithPropertiesFromRepository() {\n+    public void testCanGetResourceBundleWithPropertiesFromRepository() {\n         ClientFormContract.Dao clientFormRepository = Mockito.mock(ClientFormContract.Dao.class);\n         NativeFormLibrary.getInstance().setClientFormDao(clientFormRepository);\n-        String properties = \"step1.title = New client record\\nstep1.previous_label = SAVE AND EXIT\";\n+        Context context = RuntimeEnvironment.application;\n+        String enProperties = \"step1.title = New client record\\nstep1.previous_label = SAVE AND EXIT\";\n         String interpolatedJsonForm = testUtils.getResourceFileContentsAsString(\"test_form_translation_interpolated\");\n \n         ClientFormContract.Model clientForm = new TestClientForm();\n-        clientForm.setJson(properties);\n-        Mockito.doReturn(clientForm).when(clientFormRepository).getActiveClientFormByIdentifier(Mockito.eq(\"form_strings\"));\n \n-        assertEquals(\"New client record\", NativeFormLangUtils.getResourceBundleFromRepository(interpolatedJsonForm).getString(\"step1.title\"));\n+        clientForm.setJson(enProperties);\n+        Mockito.doReturn(clientForm).when(clientFormRepository).getActiveClientFormByIdentifier(Mockito.eq(\"form_strings.properties\"));\n+        assertEquals(\"SAVE AND EXIT\",  NativeFormLangUtils.getResourceBundleFromRepository(RuntimeEnvironment.application, interpolatedJsonForm).getString(\"step1.previous_label\"));\n+\n+        String swProperties = \"step1.title = Rekodi mpya\\nstep1.previous_label = WEKA ALAFU ONDOKA\";\n+        clientForm.setJson(swProperties);\n+        NativeFormLangUtils.setAppLocale(context, \"sw\");\n+        Mockito.doReturn(clientForm).when(clientFormRepository).getActiveClientFormByIdentifier(Mockito.eq(\"form_strings_sw.properties\"));\n+        assertEquals(\"Rekodi mpya\",  NativeFormLangUtils.getResourceBundleFromRepository(RuntimeEnvironment.application, interpolatedJsonForm).getString(\"step1.title\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3988b032208084ed4f1ee781f5940a48be20c312"}, "originalPosition": 45}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2063, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}