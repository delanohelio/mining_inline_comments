{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NzA1Njc2", "number": 412, "reviewThreads": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyMToyNlrOD46VYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwOToxODo0NFrOEDONvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMDAyNTkzOnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/presenters/JsonFormFragmentPresenter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyMToyNlrOGP4nOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyMToyNlrOGP4nOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMwOTM2OQ==", "bodyText": "The assumption here is that only the current step will need to be validated at any given time.\nI think when clicking save/submit maybe the whole form may need validation in some forms validation is skipped when jumping steps", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r419309369", "createdAt": "2020-05-04T09:21:26Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/presenters/JsonFormFragmentPresenter.java", "diffHunk": "@@ -228,67 +232,70 @@ public void validateAndWriteValues() {\n         for (View childView : formFragment.getJsonApi().getFormDataViews()) {\n             ValidationStatus validationStatus = validateView(childView);\n             String key = (String) childView.getTag(R.id.key);\n-            String openMrsEntityParent = (String) childView.getTag(R.id.openmrs_entity_parent);\n-            String openMrsEntity = (String) childView.getTag(R.id.openmrs_entity);\n-            String openMrsEntityId = (String) childView.getTag(R.id.openmrs_entity_id);\n-            Boolean popup = (Boolean) childView.getTag(R.id.extraPopup);\n-            String fieldKey = mStepName + \"#\" + getStepTitle() + \":\" + key;\n-\n-            if (childView instanceof MaterialEditText) {\n-                MaterialEditText editText = (MaterialEditText) childView;\n-\n-                String rawValue = (String) editText.getTag(R.id.raw_value);\n-                if (rawValue == null) {\n-                    rawValue = editText.getText().toString();\n-                }\n+            String address = (String) childView.getTag(R.id.address);\n+            if (mStepName.equals(address.split(\":\")[0])) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e69c17dffdfd8abee1fdb20fb49a58125bb2ebb4"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMDAyODc5OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyMjoyM1rOGP4pAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNjo0NjozM1rOGXSDRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMwOTgyNw==", "bodyText": "Why is this set to true?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r419309827", "createdAt": "2020-05-04T09:22:23Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -149,14 +158,15 @@ private Form getForm() {\n     @Override\n     public void onResume() {\n         super.onResume();\n+        processSkipSteps();\n         setJsonFormFragment(this);\n-\n     }\n \n     public void processSkipSteps() {\n         if (!getJsonApi().isPreviousPressed()) {\n-            skipStepsOnNextPressed();\n+            //skipStepsOnNextPressed();//will be handled by previous step\n         } else {\n+            setShouldSkipStep(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e69c17dffdfd8abee1fdb20fb49a58125bb2ebb4"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA2NjE4Mg==", "bodyText": "removed it", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r427066182", "createdAt": "2020-05-19T06:46:33Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -149,14 +158,15 @@ private Form getForm() {\n     @Override\n     public void onResume() {\n         super.onResume();\n+        processSkipSteps();\n         setJsonFormFragment(this);\n-\n     }\n \n     public void processSkipSteps() {\n         if (!getJsonApi().isPreviousPressed()) {\n-            skipStepsOnNextPressed();\n+            //skipStepsOnNextPressed();//will be handled by previous step\n         } else {\n+            setShouldSkipStep(true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMwOTgyNw=="}, "originalCommit": {"oid": "e69c17dffdfd8abee1fdb20fb49a58125bb2ebb4"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMDAzMzYyOnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyMzo1M1rOGP4r6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyMzo1M1rOGP4r6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMxMDU3MA==", "bodyText": "Then this should be refactored if this is not being used", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r419310570", "createdAt": "2020-05-04T09:23:53Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -149,14 +158,15 @@ private Form getForm() {\n     @Override\n     public void onResume() {\n         super.onResume();\n+        processSkipSteps();\n         setJsonFormFragment(this);\n-\n     }\n \n     public void processSkipSteps() {\n         if (!getJsonApi().isPreviousPressed()) {\n-            skipStepsOnNextPressed();\n+            //skipStepsOnNextPressed();//will be handled by previous step", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e69c17dffdfd8abee1fdb20fb49a58125bb2ebb4"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MDk4MzI4OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/activities/JsonFormActivity.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzo0MTowNFrOGaexkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzo0MTowNFrOGaexkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQyMDM3MA==", "bodyText": "Combine this if condition with the upper if", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r430420370", "createdAt": "2020-05-26T13:41:04Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/activities/JsonFormActivity.java", "diffHunk": "@@ -1079,7 +1093,17 @@ protected void addRelevance(View view, boolean popup) {\n                     }\n \n                 }\n-                toggleViewVisibility(view, comparison, isPopup);\n+                //update ui\n+                if (isForNextStep) {\n+                    if (((address.length == 2 && address[0].equals(nextStep())) || (address.length == 3 && address[2].contains(nextStep())))) {\n+                        if (comparison) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24d0d36f6270ea96670071476e30317ea81c4e00"}, "originalPosition": 161}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MTAxMDA3OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/interactors/JsonFormInteractor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzo0NzowNFrOGafCWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxMzo0NzowNFrOGafCWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQyNDY2Ng==", "bodyText": "Run the specific code that needs to be run in the UI thread in the factories and not here. This is a pattern that should be adopted", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r430424666", "createdAt": "2020-05-26T13:47:04Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/interactors/JsonFormInteractor.java", "diffHunk": "@@ -180,15 +180,35 @@ public void fetchFields(List<View> viewsFromJson, String stepName, JsonFormFragm\n         }\n     }\n \n-    private void fetchViews(List<View> viewsFromJson, String stepName, JsonFormFragment formFragment,\n-                            String type, JSONObject jsonObject, CommonListener listener, Boolean popup) {\n+    private void fetchViews(final List<View> viewsFromJson, final String stepName, final JsonFormFragment formFragment,\n+                            final String type, final JSONObject jsonObject, final CommonListener listener, final Boolean popup) {\n \n         try {\n-            List<View> views = map\n-                    .get(type)\n-                    .getViewsFromJson(stepName, formFragment.getActivity(), formFragment, jsonObject, listener, popup);\n-            if (views.size() > 0) {\n-                viewsFromJson.addAll(views);\n+            if (type.equals(\"tree\") || type.equals(\"edit_text\")) { ///some fields need to be loaded on the main thread TO-DO re-write", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24d0d36f6270ea96670071476e30317ea81c4e00"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODExMTc4OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/FormUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODoyOTozOVrOGgIBDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwNzowMDowNlrOGgRVfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMzODk1OQ==", "bodyText": "Method not being used", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436338959", "createdAt": "2020-06-07T08:29:39Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/FormUtils.java", "diffHunk": "@@ -289,21 +290,31 @@ public static void updateEndProperties(PropertyManager propertyManager, JSONObje\n         }\n     }\n \n+    public static <T> T deepCopy(T object, Class<T> type) {\n+        try {\n+            Gson gson = new Gson();\n+            return gson.fromJson(gson.toJson(object, type), type);\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+            return null;\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ5MTY0NA==", "bodyText": "removed", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436491644", "createdAt": "2020-06-08T07:00:06Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/utils/FormUtils.java", "diffHunk": "@@ -289,21 +290,31 @@ public static void updateEndProperties(PropertyManager propertyManager, JSONObje\n         }\n     }\n \n+    public static <T> T deepCopy(T object, Class<T> type) {\n+        try {\n+            Gson gson = new Gson();\n+            return gson.fromJson(gson.toJson(object, type), type);\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+            return null;\n+        }\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMzODk1OQ=="}, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODEyMDU3OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/activities/JsonFormActivity.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo0NToyOVrOGgIFvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo0NToyOVrOGgIFvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MDE1OQ==", "bodyText": "why not use else for readability", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436340159", "createdAt": "2020-06-07T08:45:29Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/activities/JsonFormActivity.java", "diffHunk": "@@ -1211,59 +1236,67 @@ private void checkViewConstraints(View curView, boolean popup) {\n                         if (errorMessage != null) break;\n                     }\n                 }\n+                if (isForNextStep) {\n+                    preComputedConstraintMap.put(curView, popup + \":\" + errorMessage);\n+                    return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 206}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODEyMTM4OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/activities/JsonFormActivity.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo0NjozOVrOGgIGHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo0NjozOVrOGgIGHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MDI1NQ==", "bodyText": "should this be added to an else block", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436340255", "createdAt": "2020-06-07T08:46:39Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/activities/JsonFormActivity.java", "diffHunk": "@@ -1428,6 +1461,10 @@ protected void refreshMediaLogic(String key, String value, String stepName) {\n                 JSONArray medias = questionGroup.getJSONArray(\"media\");\n                 for (int j = 0; j < medias.length(); j++) {\n                     JSONObject media = medias.getJSONObject(j);\n+                    if (isForNextStep) {\n+                        preComputedMediaLogicMap.put(media, value);\n+                        continue;\n+                    }\n                     mediaDialog(media, value);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 331}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODEyNTIwOnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo1MzozNFrOGgIIBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo1MzozNFrOGgIIBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MDc0Mw==", "bodyText": "Why is this still being used, if it has been deprecated", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436340743", "createdAt": "2020-06-07T08:53:34Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -268,6 +265,7 @@ public void updateVisibilityOfNextAndSave(boolean next, boolean save) {\n     }\n \n     /**\n+     * @deprecated use {@link #skipStepsOnNextPressed(String)}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODEyNTU3OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo1NDoyOFrOGgIIOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo1NDoyOFrOGgIIOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MDc5NQ==", "bodyText": "Rename this to Process Previous step since the method functionality has been changed", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436340795", "createdAt": "2020-06-07T08:54:28Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -149,14 +148,12 @@ private Form getForm() {\n     @Override\n     public void onResume() {\n         super.onResume();\n+        processSkipSteps();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODEyNjAxOnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo1NToxM1rOGgIIbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo1NToxM1rOGgIIbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MDg0Nw==", "bodyText": "Private methods should not be deprecated since they cannot be used outside the class. Remove method if deprecated", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436340847", "createdAt": "2020-06-07T08:55:13Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -306,9 +337,9 @@ public void skipStepOnPreviousPressed() {\n     }\n \n     /**\n-     * Checks if a given step is blank due to relevance hidding all the widgets\n-     *\n      * @param formStep {@link JSONObject}\n+     * @deprecated use a combination of #isNextStepRelevant and {@link #nextStepHasNoSkipLogic()}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 102}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODEyNzg2OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo1ODowNlrOGgIJUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwODo1ODowNlrOGgIJUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MTA3NQ==", "bodyText": "The implementation of this method should be calling stepHasNoSkipLogic(@Nullable String step) with getJsonApi().nextStep() as the argument", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436341075", "createdAt": "2020-06-07T08:58:06Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -401,12 +442,32 @@ public void onClick(View view) {\n                     assert getFragmentManager() != null;\n                     presenter.checkAndStopCountdownAlarm();\n                     getJsonApi().setPreviousPressed(true);\n-                    getFragmentManager().popBackStack();\n+                    getJsonApi().getStack().pop();\n+                    getFragmentManager().popBackStack(getJsonApi().getStack().pop(), 0);\n                 }\n             }\n         }\n     }\n \n+    private boolean nextStepHasNoSkipLogic() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 152}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODEyOTk0OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwOTowMDo1NFrOGgIKSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwNzoxNTo1NVrOGgRt4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MTMyMQ==", "bodyText": "what is the reason of changing the default from true", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436341321", "createdAt": "2020-06-07T09:00:54Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -317,7 +348,7 @@ private void checkIfStepIsBlank(JSONObject formStep) {\n                 for (int i = 0; i < fields.length(); i++) {\n                     JSONObject field = fields.getJSONObject(i);\n                     if (field.has(JsonFormConstants.TYPE) && !JsonFormConstants.HIDDEN.equals(field.getString(JsonFormConstants.TYPE))) {\n-                        boolean isVisible = field.optBoolean(JsonFormConstants.IS_VISIBLE, true);\n+                        boolean isVisible = field.optBoolean(JsonFormConstants.IS_VISIBLE, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 112}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ5Nzg5MQ==", "bodyText": "my mistake, let me revert it", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436497891", "createdAt": "2020-06-08T07:15:55Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -317,7 +348,7 @@ private void checkIfStepIsBlank(JSONObject formStep) {\n                 for (int i = 0; i < fields.length(); i++) {\n                     JSONObject field = fields.getJSONObject(i);\n                     if (field.has(JsonFormConstants.TYPE) && !JsonFormConstants.HIDDEN.equals(field.getString(JsonFormConstants.TYPE))) {\n-                        boolean isVisible = field.optBoolean(JsonFormConstants.IS_VISIBLE, true);\n+                        boolean isVisible = field.optBoolean(JsonFormConstants.IS_VISIBLE, false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MTMyMQ=="}, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 112}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODEzNzk4OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwOToxNDowMlrOGgIOgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwNjo0MjoxOVrOGgQ6bQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MjQwMQ==", "bodyText": "why is this check added !stepHasNoSkipLogic(JsonFormConstants.STEP + i)", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436342401", "createdAt": "2020-06-07T09:14:02Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -295,8 +326,8 @@ public void skipStepOnPreviousPressed() {\n                 JSONObject formStep = getJsonApi().getmJSONObject().optJSONObject(JsonFormConstants.STEP + i);\n                 if (formStep != null) {\n                     checkIfStepIsBlank(formStep);\n-                    if (shouldSkipStep()) {\n-                        getFragmentManager().popBackStack();\n+                    if (shouldSkipStep() && !stepHasNoSkipLogic(JsonFormConstants.STEP + i)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjQ4NDcxNw==", "bodyText": "The method checks if the previous step has fields with no skip logic, if it has then that step will not be skipped and vice versa", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436484717", "createdAt": "2020-06-08T06:42:19Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -295,8 +326,8 @@ public void skipStepOnPreviousPressed() {\n                 JSONObject formStep = getJsonApi().getmJSONObject().optJSONObject(JsonFormConstants.STEP + i);\n                 if (formStep != null) {\n                     checkIfStepIsBlank(formStep);\n-                    if (shouldSkipStep()) {\n-                        getFragmentManager().popBackStack();\n+                    if (shouldSkipStep() && !stepHasNoSkipLogic(JsonFormConstants.STEP + i)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0MjQwMQ=="}, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 90}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxODE0MDc3OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwOToxODo0NFrOGgIQCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wN1QwOToxODo0NFrOGgIQCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0Mjc5NA==", "bodyText": "change to getJsonApi().getStack().size() =< 1 for readability", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/412#discussion_r436342794", "createdAt": "2020-06-07T09:18:44Z", "author": {"login": "githengi"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/fragments/JsonWizardFormFragment.java", "diffHunk": "@@ -241,7 +238,7 @@ public void updateVisibilityOfNextAndSave(boolean next, boolean save) {\n         }\n \n         if (getFragmentManager() != null) {\n-            if (getFragmentManager().getBackStackEntryCount() == 0) {\n+            if (getFragmentManager().getBackStackEntryCount() == 0 || getJsonApi().getStack().size() < 2) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca418c65263a84ac2b2c8727f67e633faa631eb5"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2047, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}