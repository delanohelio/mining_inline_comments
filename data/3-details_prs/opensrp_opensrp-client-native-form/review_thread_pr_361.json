{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1Njg0MDU3", "number": 361, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOTowODoxNFrODgUEzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOToxNToyOVrODgUNdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1MjA5OTMzOnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOTowODoxNFrOFqc28g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOTo0MToxNFrOFqd5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDA1NzMzMA==", "bodyText": "What is this arrayList for?", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/361#discussion_r380057330", "createdAt": "2020-02-17T09:08:14Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "diffHunk": "@@ -72,6 +74,7 @@ public AttachRepeatingGroupTask(final ViewParent parent, int numRepeatingGroups,\n     @Override\n     protected void onPreExecute() {\n         showProgressDialog(R.string.please_wait_title, R.string.creating_repeating_group_message, widgetArgs.getFormFragment().getContext());\n+        repeatingGroups = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6233b90e6eec5addf17ee446a9713eb6f1c492ea"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDA3NDI4OQ==", "bodyText": "Thanks for catching that, I have removed", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/361#discussion_r380074289", "createdAt": "2020-02-17T09:41:14Z", "author": {"login": "manutarus"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "diffHunk": "@@ -72,6 +74,7 @@ public AttachRepeatingGroupTask(final ViewParent parent, int numRepeatingGroups,\n     @Override\n     protected void onPreExecute() {\n         showProgressDialog(R.string.please_wait_title, R.string.creating_repeating_group_message, widgetArgs.getFormFragment().getContext());\n+        repeatingGroups = new ArrayList<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDA1NzMzMA=="}, "originalCommit": {"oid": "6233b90e6eec5addf17ee446a9713eb6f1c492ea"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1MjEwMDE1OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOTowODozMlrOFqc3cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOTowODozMlrOFqc3cQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDA1NzQ1Nw==", "bodyText": "I think the comment here can be updated", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/361#discussion_r380057457", "createdAt": "2020-02-17T09:08:32Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "diffHunk": "@@ -100,14 +104,27 @@ protected void onPostExecute(List<View> result) {\n                     keysToRemove.add(repeatingGroupKey);\n                     rootLayout.removeViewAt(i);\n                 }\n-                // remove deleted fields from form json\n+//                remove deleted fields from form json\n+                ArrayList<String> removeThisFields = new ArrayList<>();\n                 int len = fields.length();\n                 for (int i = len - 1; i >= 0; i--) {\n                     String[] key = ((String) fields.getJSONObject(i).get(KEY)).split(\"_\");\n                     if (keysToRemove.contains(key[key.length - 1])) {\n+                        removeThisFields.add((String) fields.getJSONObject(i).get(KEY));\n                         fields.remove(i);\n                     }\n                 }\n+//                remove deleted views from form json", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6233b90e6eec5addf17ee446a9713eb6f1c492ea"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1MjExNjg0OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOToxMzo1NVrOFqdBkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOToxMzo1NVrOFqdBkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDA2MDA1MA==", "bodyText": "This method seems reusable you can add it in utils", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/361#discussion_r380060050", "createdAt": "2020-02-17T09:13:55Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "diffHunk": "@@ -100,14 +104,27 @@ protected void onPostExecute(List<View> result) {\n                     keysToRemove.add(repeatingGroupKey);\n                     rootLayout.removeViewAt(i);\n                 }\n-                // remove deleted fields from form json\n+//                remove deleted fields from form json\n+                ArrayList<String> removeThisFields = new ArrayList<>();\n                 int len = fields.length();\n                 for (int i = len - 1; i >= 0; i--) {\n                     String[] key = ((String) fields.getJSONObject(i).get(KEY)).split(\"_\");\n                     if (keysToRemove.contains(key[key.length - 1])) {\n+                        removeThisFields.add((String) fields.getJSONObject(i).get(KEY));\n                         fields.remove(i);\n                     }\n                 }\n+//                remove deleted views from form json\n+                Collection<View> viewCollection =  widgetArgs.getFormFragment().getJsonApi().getFormDataViews();\n+                Iterator<View> viewIterator = viewCollection.iterator();\n+                while (viewIterator.hasNext()){\n+                    View view = viewIterator.next();\n+                    String key = (String) view.getTag(R.id.key);\n+                    if(removeThisFields.contains(key)){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6233b90e6eec5addf17ee446a9713eb6f1c492ea"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1MjEyMTQ4OnYy", "diffSide": "RIGHT", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOToxNToyOVrOFqdEjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QwOToxNToyOVrOFqdEjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDA2MDgxNA==", "bodyText": "I think you should check for null in this chained method calls widgetArgs.getFormFragment().getJsonApi().getFormDataViews()", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/361#discussion_r380060814", "createdAt": "2020-02-17T09:15:29Z", "author": {"login": "bennsimon"}, "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/task/AttachRepeatingGroupTask.java", "diffHunk": "@@ -100,14 +104,27 @@ protected void onPostExecute(List<View> result) {\n                     keysToRemove.add(repeatingGroupKey);\n                     rootLayout.removeViewAt(i);\n                 }\n-                // remove deleted fields from form json\n+//                remove deleted fields from form json\n+                ArrayList<String> removeThisFields = new ArrayList<>();\n                 int len = fields.length();\n                 for (int i = len - 1; i >= 0; i--) {\n                     String[] key = ((String) fields.getJSONObject(i).get(KEY)).split(\"_\");\n                     if (keysToRemove.contains(key[key.length - 1])) {\n+                        removeThisFields.add((String) fields.getJSONObject(i).get(KEY));\n                         fields.remove(i);\n                     }\n                 }\n+//                remove deleted views from form json\n+                Collection<View> viewCollection =  widgetArgs.getFormFragment().getJsonApi().getFormDataViews();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6233b90e6eec5addf17ee446a9713eb6f1c492ea"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2078, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}