{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0Nzk2OTEw", "number": 6975, "title": "support for non-AS called data", "bodyText": "", "createdAt": "2020-11-20T15:58:37Z", "url": "https://github.com/broadinstitute/gatk/pull/6975", "merged": true, "mergeCommit": {"oid": "5f40379fac619d0c4a6178f4704669fc3f8695f3"}, "closed": true, "closedAt": "2020-11-21T20:11:39Z", "author": {"login": "kcibul"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeZaosgH2gAyNTI0Nzk2OTEwOjg5MDlhOTgzZGFiNTVhNmNlY2I3ZGRiNjI4MzkwNzM4ZTkzZDI3M2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdexsKegH2gAyNTI0Nzk2OTEwOjQ0NTU4YzBjOTRhYTMwMWJjYjBmZGNhM2E0YTNkMTBjN2ZmZDc2NDU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8909a983dab55a6cecb7ddb628390738e93d273a", "author": {"user": {"login": "kcibul", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/8909a983dab55a6cecb7ddb628390738e93d273a", "committedDate": "2020-11-20T15:51:41Z", "message": "support for non-AS called data"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NTYwNDQw", "url": "https://github.com/broadinstitute/gatk/pull/6975#pullrequestreview-535560440", "createdAt": "2020-11-20T16:06:08Z", "commit": {"oid": "8909a983dab55a6cecb7ddb628390738e93d273a"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxNjowNjowOFrOH3V8tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQxNjowNzozOVrOH3WAfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzc5MzMzMw==", "bodyText": "I think this is close enough. I tended to distribute when I did this for other metrics, but I don't think it matters and we don't want half of a read in the output anyway :)", "url": "https://github.com/broadinstitute/gatk/pull/6975#discussion_r527793333", "createdAt": "2020-11-20T16:06:08Z", "author": {"login": "meganshand"}, "path": "src/main/java/org/broadinstitute/hellbender/tools/variantdb/nextgen/VetFieldEnum.java", "diffHunk": "@@ -121,7 +121,26 @@ public String getColumnValue(final VariantContext variant) {\n \n     AS_RAW_MQRankSum { // TODO -- maybe rely on 1/1 for call_GT, also get rid of the | at the beginning\n         public String getColumnValue(final VariantContext variant) {\n+            // e.g. AS_RAW_MQRankSum=|1.4,1|NaN;\n             String out =  getAttribute(variant, GATKVCFConstants.AS_RAW_MAP_QUAL_RANK_SUM_KEY, null);\n+\n+            if (out == null) {\n+                // Try to use non-AS version\n+                // TODO: it looks like the AS_RAW version also trims to a single decimal point??\n+                // e.g. MQRankSum=1.465 and turn it into |-0.511,1|\n+                String outNotAlleleSpecific = getAttribute(variant, GATKVCFConstants.READ_POS_RANK_SUM_KEY, null);\n+\n+                if (variant.getAlleles().size() == 3) { // GT 0/1 1/1\n+                    out = \"|\" + outNotAlleleSpecific + \",1|\";\n+\n+                } else if (variant.getAlleles().size() == 4) { // GT 1/2\n+                    // TODO: just replicate rather than distribute, is this right?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8909a983dab55a6cecb7ddb628390738e93d273a"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzc5NDMwMQ==", "bodyText": "I'm confused here, how did 1.465 become -0.511?", "url": "https://github.com/broadinstitute/gatk/pull/6975#discussion_r527794301", "createdAt": "2020-11-20T16:07:39Z", "author": {"login": "meganshand"}, "path": "src/main/java/org/broadinstitute/hellbender/tools/variantdb/nextgen/VetFieldEnum.java", "diffHunk": "@@ -121,7 +121,26 @@ public String getColumnValue(final VariantContext variant) {\n \n     AS_RAW_MQRankSum { // TODO -- maybe rely on 1/1 for call_GT, also get rid of the | at the beginning\n         public String getColumnValue(final VariantContext variant) {\n+            // e.g. AS_RAW_MQRankSum=|1.4,1|NaN;\n             String out =  getAttribute(variant, GATKVCFConstants.AS_RAW_MAP_QUAL_RANK_SUM_KEY, null);\n+\n+            if (out == null) {\n+                // Try to use non-AS version\n+                // TODO: it looks like the AS_RAW version also trims to a single decimal point??\n+                // e.g. MQRankSum=1.465 and turn it into |-0.511,1|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8909a983dab55a6cecb7ddb628390738e93d273a"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44558c0c94aa301bcb0fdca3a4a3d10c7ffd7645", "author": {"user": {"login": "kcibul", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/44558c0c94aa301bcb0fdca3a4a3d10c7ffd7645", "committedDate": "2020-11-21T20:08:33Z", "message": "fixed null case"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2557, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}