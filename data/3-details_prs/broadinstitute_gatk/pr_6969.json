{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIzOTg1NTAy", "number": 6969, "title": "support for multiple PET/VETs", "bodyText": "", "createdAt": "2020-11-19T14:16:46Z", "url": "https://github.com/broadinstitute/gatk/pull/6969", "merged": true, "mergeCommit": {"oid": "7399f7dd48be0f58878d249b9474e3aaae97e09c"}, "closed": true, "closedAt": "2020-11-19T20:39:21Z", "author": {"login": "kcibul"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeDZ4igH2gAyNTIzOTg1NTAyOmQ0ZTUzZmI3ZGE0Mjc1MzEwODQxODg3ODNmZmJlYTc4YzY2NWQ4MzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeI6c_gH2gAyNTIzOTg1NTAyOjg2OGM2NTIxMTg4YTUxYjJhNDk2ODRiYjhlNzlhMDM4YWMyYzE4NDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d4e53fb7da427531084188783ffbea78c665d836", "author": {"user": {"login": "kcibul", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/d4e53fb7da427531084188783ffbea78c665d836", "committedDate": "2020-11-19T14:12:57Z", "message": "support for multiple PET/VETs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NDk1MTM2", "url": "https://github.com/broadinstitute/gatk/pull/6969#pullrequestreview-534495136", "createdAt": "2020-11-19T14:23:41Z", "commit": {"oid": "d4e53fb7da427531084188783ffbea78c665d836"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNDoyMzo0MVrOH2g-RQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNDoyOTozNFrOH2hPvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkyNTM4MQ==", "bodyText": "Does Cromwell wait until the full scatter of CreateImportTsvs is complete? Or will this run as soon as the first shard is done?", "url": "https://github.com/broadinstitute/gatk/pull/6969#discussion_r526925381", "createdAt": "2020-11-19T14:23:41Z", "author": {"login": "meganshand"}, "path": "scripts/variantstore/wdl/ImportGenomes.wdl", "diffHunk": "@@ -43,50 +46,76 @@ workflow ImportGenomes {\n     }\n   }\n \n-  call LoadData as LoadMetadataTsvs{\n-    input:\n-      done = CreateImportTsvs.done[0],\n-      project_id = project_id,\n-      dataset_name = dataset_name,\n-      storage_location = output_directory,\n-      datatype = \"metadata\",\n-      numbered = \"false\",\n-      partitioned = \"false\",\n-      table_id = table_id,\n-      schema = metadata_schema,\n-      preemptible_tries = preemptible_tries,\n-      docker = docker_final\n-  }\n+  scatter (i in range(GetMaxTableId.max_table_id)) {\n+    call LoadData as LoadMetadataTsvs{\n+      input:\n+        done = CreateImportTsvs.done[0],\n+        project_id = project_id,\n+        dataset_name = dataset_name,\n+        storage_location = output_directory,\n+        datatype = \"metadata\",\n+        numbered = \"false\",\n+        partitioned = \"false\",\n+        table_id = i + 1,\n+        schema = metadata_schema,\n+        preemptible_tries = preemptible_tries,\n+        docker = docker_final\n+    }\n \n     call LoadData as LoadPetTsvs{\n-    input:\n-      done = CreateImportTsvs.done[0],\n-      project_id = project_id,\n-      dataset_name = dataset_name,\n-      storage_location = output_directory,\n-      datatype = \"pet\",\n-      table_id = table_id,\n-      schema = pet_schema,\n-      preemptible_tries = preemptible_tries,\n-      docker = docker_final\n+      input:\n+        done = CreateImportTsvs.done[0],", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4e53fb7da427531084188783ffbea78c665d836"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkyNjcyMg==", "bodyText": "Does this still fail with a nice error message if there's no dataset? (Nice enough that I'll realize I forgot to make one)", "url": "https://github.com/broadinstitute/gatk/pull/6969#discussion_r526926722", "createdAt": "2020-11-19T14:25:25Z", "author": {"login": "meganshand"}, "path": "scripts/variantstore/wdl/ImportGenomes.wdl", "diffHunk": "@@ -178,10 +207,6 @@ task LoadData {\n \n   command <<<\n     set -x\n-    set +e\n-    # make sure dataset exists\n-    bq ls --project_id ~{project_id} ~{dataset_name} > /dev/null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4e53fb7da427531084188783ffbea78c665d836"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjkyOTg1NQ==", "bodyText": "Why does loading the data need so much disk? Isn't it just importing what's in a separate google bucket?", "url": "https://github.com/broadinstitute/gatk/pull/6969#discussion_r526929855", "createdAt": "2020-11-19T14:29:34Z", "author": {"login": "meganshand"}, "path": "scripts/variantstore/wdl/ImportGenomes.wdl", "diffHunk": "@@ -230,8 +264,8 @@ task LoadData {\n   >>>\n   runtime {\n     docker: docker\n-    memory: \"4 GB\"\n-    disks: \"local-disk 10 HDD\"\n+    memory: \"10 GB\"\n+    disks: \"local-disk 1000 HDD\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4e53fb7da427531084188783ffbea78c665d836"}, "originalPosition": 190}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b93ec6b84be36b1cc3c7295449a58274e718de4", "author": {"user": {"login": "kcibul", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/6b93ec6b84be36b1cc3c7295449a58274e718de4", "committedDate": "2020-11-19T14:39:39Z", "message": "PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e0f4e004c210b4d712b80018604f45bf4ac2547", "author": {"user": {"login": "kcibul", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/4e0f4e004c210b4d712b80018604f45bf4ac2547", "committedDate": "2020-11-19T20:34:22Z", "message": "fixed to use latest GATK JAR, eliminate odd java NoSuchMethod error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "868c6521188a51b2a49684bb8e79a038ac2c1846", "author": {"user": {"login": "kcibul", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/868c6521188a51b2a49684bb8e79a038ac2c1846", "committedDate": "2020-11-19T20:38:03Z", "message": "PR feedback"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2546, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}