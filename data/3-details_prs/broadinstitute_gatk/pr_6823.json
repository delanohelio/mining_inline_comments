{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3NTEzMjU2", "number": 6823, "title": "dont-use-soft-clips actually works in Mutect2", "bodyText": "Closes #6686\n@fleharty This option did nothing because a copy of the original reads was modified.  By deleting the unnecessary mapping quality filtering (this is totally redundant with the M2 read filter), we finalize (and thereby discard soft clips if requested) an assembly region made from the original reads, not a copy.", "createdAt": "2020-09-15T19:28:28Z", "url": "https://github.com/broadinstitute/gatk/pull/6823", "merged": true, "mergeCommit": {"oid": "3354d3d41ac57e185982639cd48bc60012a90d12"}, "closed": true, "closedAt": "2020-10-25T15:40:45Z", "author": {"login": "davidbenjamin"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQY34dgH2gAyNDg3NTEzMjU2OjIxNzc2NjdkN2M1YmU0NjAwY2E5YWE2ZjJiMGFhZTkwMTY5NzUxNzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVcwSoAFqTUxNTk5NjcyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2177667d7c5be4600ca9aa6f2b0aae9016975179", "author": {"user": {"login": "davidbenjamin", "name": "David Benjamin"}}, "url": "https://github.com/broadinstitute/gatk/commit/2177667d7c5be4600ca9aa6f2b0aae9016975179", "committedDate": "2020-10-08T03:18:47Z", "message": "fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "871bff3f648179790c112c9226545609690ed6dc", "author": {"user": {"login": "davidbenjamin", "name": "David Benjamin"}}, "url": "https://github.com/broadinstitute/gatk/commit/871bff3f648179790c112c9226545609690ed6dc", "committedDate": "2020-10-08T03:18:47Z", "message": "patched some tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c83170e6558340b5383f178df7af8e120f37f4c", "author": {"user": {"login": "davidbenjamin", "name": "David Benjamin"}}, "url": "https://github.com/broadinstitute/gatk/commit/0c83170e6558340b5383f178df7af8e120f37f4c", "committedDate": "2020-10-08T03:18:47Z", "message": "integration test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0380af54d75c9f88f513c6e131f779db96be69b5", "author": {"user": {"login": "davidbenjamin", "name": "David Benjamin"}}, "url": "https://github.com/broadinstitute/gatk/commit/0380af54d75c9f88f513c6e131f779db96be69b5", "committedDate": "2020-09-15T19:21:59Z", "message": "integration test"}, "afterCommit": {"oid": "0c83170e6558340b5383f178df7af8e120f37f4c", "author": {"user": {"login": "davidbenjamin", "name": "David Benjamin"}}, "url": "https://github.com/broadinstitute/gatk/commit/0c83170e6558340b5383f178df7af8e120f37f4c", "committedDate": "2020-10-08T03:18:47Z", "message": "integration test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MDY2NjUx", "url": "https://github.com/broadinstitute/gatk/pull/6823#pullrequestreview-505066651", "createdAt": "2020-10-08T18:43:11Z", "commit": {"oid": "0c83170e6558340b5383f178df7af8e120f37f4c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODo0MzoxMVrOHeryvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODo0MzoxMVrOHeryvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkzNjgzMQ==", "bodyText": "Can we be more specific about which variants are called/not called when the option is set/unset?\nI'd hate for this to pass by chance, which is almost has a 50/50 chance of, even if it's not doing what we expect.", "url": "https://github.com/broadinstitute/gatk/pull/6823#discussion_r501936831", "createdAt": "2020-10-08T18:43:11Z", "author": {"login": "fleharty"}, "path": "src/test/java/org/broadinstitute/hellbender/tools/walkers/mutect/Mutect2IntegrationTest.java", "diffHunk": "@@ -373,6 +375,28 @@ public void testForceCalling() {\n         }\n     }\n \n+    // test that the dont-use-soft-clips option actually does something\n+    @Test\n+    public void testDontUseSoftClips() {\n+        Utils.resetRandomGenerator();\n+        final File tumor = new File(NA12878_20_21_WGS_bam);\n+        final int start = 10050000;\n+\n+        final SimpleInterval interval = new SimpleInterval(\"20\", start, start + 25000);\n+\n+        final File calls1 = createTempFile(\"unfiltered\", \".vcf\");\n+        runMutect2(tumor, calls1, interval.toString(), b37Reference, Optional.of(GNOMAD));\n+\n+        final File calls2 = createTempFile(\"unfiltered\", \".vcf\");\n+        runMutect2(tumor, calls2, interval.toString(), b37Reference, Optional.of(GNOMAD),\n+                args -> args.addFlag(AssemblyBasedCallerArgumentCollection.DONT_USE_SOFT_CLIPPED_BASES_LONG_NAME));\n+\n+        final List<VariantContext> indelsWithSoftClips = VariantContextTestUtils.streamVcf(calls1).filter(VariantContext::isIndel).collect(Collectors.toList());\n+        final List<VariantContext> indelsWithoutSoftClips = VariantContextTestUtils.streamVcf(calls2).filter(VariantContext::isIndel).collect(Collectors.toList());\n+\n+        Assert.assertTrue(indelsWithoutSoftClips.size() < indelsWithSoftClips.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c83170e6558340b5383f178df7af8e120f37f4c"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d230a50d35ee6b35ee11d89945a93dbad24f38c7", "author": {"user": {"login": "davidbenjamin", "name": "David Benjamin"}}, "url": "https://github.com/broadinstitute/gatk/commit/d230a50d35ee6b35ee11d89945a93dbad24f38c7", "committedDate": "2020-10-23T14:50:50Z", "message": "made test more specific"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1OTk2NzIx", "url": "https://github.com/broadinstitute/gatk/pull/6823#pullrequestreview-515996721", "createdAt": "2020-10-23T20:39:44Z", "commit": {"oid": "d230a50d35ee6b35ee11d89945a93dbad24f38c7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2478, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}