{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMTM2MTg3", "number": 6482, "title": "Exposed maximum copy ratio and point size for CNV plotting tools.", "bodyText": "Closes #6391.\nCloses #5748.\nNote that the *.denoisedLimit4.png output has been removed from the PlotDenoisedCopyRatios tool and the corresponding WDL task.  The default behavior has changed slightly, in that the remaining *.denoised.png output is now delimited to maximum copy ratio = 4.0 (instead of covering the entire range in the data).  @fleharty @droazen we may want to mention this in the release notes.", "createdAt": "2020-03-03T19:36:54Z", "url": "https://github.com/broadinstitute/gatk/pull/6482", "merged": true, "mergeCommit": {"oid": "78a9ecd3123fdb77acf3dd7a73b0c12bf4602a1c"}, "closed": true, "closedAt": "2020-04-23T14:38:39Z", "author": {"login": "samuelklee"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKHoq6gBqjMwOTM1OTc2NTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcadvIBAFqTM5OTE1MTQ3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab21e1018663ba62e396ae67e850ed4284cb0712", "author": {"user": {"login": "samuelklee", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/ab21e1018663ba62e396ae67e850ed4284cb0712", "committedDate": "2020-03-03T19:35:32Z", "message": "Exposed maximum copy ratio and point size for CNV plotting tools."}, "afterCommit": {"oid": "fd648115b2670c3834e43d2a4d762adb280e8de8", "author": {"user": {"login": "samuelklee", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/fd648115b2670c3834e43d2a4d762adb280e8de8", "committedDate": "2020-03-03T19:38:58Z", "message": "Exposed maximum copy ratio and point size for CNV plotting tools."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd648115b2670c3834e43d2a4d762adb280e8de8", "author": {"user": {"login": "samuelklee", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/fd648115b2670c3834e43d2a4d762adb280e8de8", "committedDate": "2020-03-03T19:38:58Z", "message": "Exposed maximum copy ratio and point size for CNV plotting tools."}, "afterCommit": {"oid": "387e0a7292f78489b7d8e25de13563a858202cf9", "author": {"user": {"login": "samuelklee", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/387e0a7292f78489b7d8e25de13563a858202cf9", "committedDate": "2020-03-03T20:00:51Z", "message": "Exposed maximum copy ratio and point size for CNV plotting tools."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "author": {"user": {"login": "samuelklee", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "committedDate": "2020-03-31T17:24:15Z", "message": "Exposed maximum copy ratio and point size for CNV plotting tools."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "387e0a7292f78489b7d8e25de13563a858202cf9", "author": {"user": {"login": "samuelklee", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/387e0a7292f78489b7d8e25de13563a858202cf9", "committedDate": "2020-03-03T20:00:51Z", "message": "Exposed maximum copy ratio and point size for CNV plotting tools."}, "afterCommit": {"oid": "8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "author": {"user": {"login": "samuelklee", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/8cd4b4aa2e3334ccf1783d08a5278b3de551eca7", "committedDate": "2020-03-31T17:24:15Z", "message": "Exposed maximum copy ratio and point size for CNV plotting tools."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MTUxNDc5", "url": "https://github.com/broadinstitute/gatk/pull/6482#pullrequestreview-399151479", "createdAt": "2020-04-23T14:25:12Z", "commit": {"oid": "8cd4b4aa2e3334ccf1783d08a5278b3de551eca7"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNDoyNToxM1rOGKq3nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNDoyNTo0OVrOGKq5wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg0MTMwOQ==", "bodyText": "Why does this StandardArgumentDefinitions us \"--\" but the next one for OUTPUT_SHORT_NAME uses only \"-\".", "url": "https://github.com/broadinstitute/gatk/pull/6482#discussion_r413841309", "createdAt": "2020-04-23T14:25:13Z", "author": {"login": "fleharty"}, "path": "src/test/java/org/broadinstitute/hellbender/tools/copynumber/plotting/PlotDenoisedCopyRatiosIntegrationTest.java", "diffHunk": "@@ -62,13 +49,44 @@ public void testPlotting() {\n         Assert.assertEquals(scaledDeltaMAD, (standardizedMAD - denoisedMAD) / standardizedMAD);\n     }\n \n+    //checks that output files with reasonable file sizes are generated, but correctness of output is not checked\n+    @Test(groups = \"R\")\n+    public void testPlotting() {\n+        final File outputDir = createTempDir(\"testDir\");\n+        final String[] arguments = {\n+                \"--\" + CopyNumberStandardArgument.STANDARDIZED_COPY_RATIOS_FILE_LONG_NAME, STANDARDIZED_COPY_RATIOS_FILE.getAbsolutePath(),\n+                \"--\" + CopyNumberStandardArgument.DENOISED_COPY_RATIOS_FILE_LONG_NAME, DENOISED_COPY_RATIOS_FILE.getAbsolutePath(),\n+                \"--\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_FILE.getAbsolutePath(),\n+                \"-\" + StandardArgumentDefinitions.OUTPUT_SHORT_NAME, outputDir.getAbsolutePath(),\n+                \"--\" + CopyNumberStandardArgument.OUTPUT_PREFIX_LONG_NAME, OUTPUT_PREFIX\n+        };\n+        runCommandLine(arguments);\n+        assertFilesCreated(outputDir);\n+    }\n+\n+    //checks that output files with reasonable file sizes are generated, but correctness of output is not checked\n+    @Test(groups = \"R\")\n+    public void testPlottingInfiniteMaximumCopyRatio() {\n+        final File outputDir = createTempDir(\"testDir\");\n+        final String[] arguments = {\n+                \"--\" + CopyNumberStandardArgument.STANDARDIZED_COPY_RATIOS_FILE_LONG_NAME, STANDARDIZED_COPY_RATIOS_FILE.getAbsolutePath(),\n+                \"--\" + CopyNumberStandardArgument.DENOISED_COPY_RATIOS_FILE_LONG_NAME, DENOISED_COPY_RATIOS_FILE.getAbsolutePath(),\n+                \"--\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_FILE.getAbsolutePath(),\n+                \"--\" + PlottingUtils.MAXIMUM_COPY_RATIO_LONG_NAME, \"Infinity\",\n+                \"-\" + StandardArgumentDefinitions.OUTPUT_SHORT_NAME, outputDir.getAbsolutePath(),\n+                \"--\" + CopyNumberStandardArgument.OUTPUT_PREFIX_LONG_NAME, OUTPUT_PREFIX\n+        };\n+        runCommandLine(arguments);\n+        assertFilesCreated(outputDir);\n+    }\n+\n     @Test(expectedExceptions = IllegalArgumentException.class)\n     public void testMinimumContigLength() {\n         final File outputDir = createTempDir(\"testDir\");\n         final String[] arguments = {\n                 \"--\" + CopyNumberStandardArgument.STANDARDIZED_COPY_RATIOS_FILE_LONG_NAME, STANDARDIZED_COPY_RATIOS_FILE.getAbsolutePath(),\n                 \"--\" + CopyNumberStandardArgument.DENOISED_COPY_RATIOS_FILE_LONG_NAME, DENOISED_COPY_RATIOS_FILE.getAbsolutePath(),\n-                \"-\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_WITH_NO_CONTIGS_ABOVE_MINIMUM_LENGTH_FILE.getAbsolutePath(),\n+                \"--\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_WITH_NO_CONTIGS_ABOVE_MINIMUM_LENGTH_FILE.getAbsolutePath(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cd4b4aa2e3334ccf1783d08a5278b3de551eca7"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzg0MTg1Ng==", "bodyText": "Do StandardArgumentDefinitions use \"-\" or \"--\"?", "url": "https://github.com/broadinstitute/gatk/pull/6482#discussion_r413841856", "createdAt": "2020-04-23T14:25:49Z", "author": {"login": "fleharty"}, "path": "src/test/java/org/broadinstitute/hellbender/tools/copynumber/plotting/PlotDenoisedCopyRatiosIntegrationTest.java", "diffHunk": "@@ -81,7 +99,7 @@ public void testNonExistentStandardizedFile() {\n         final String[] arguments = {\n                 \"--\" + CopyNumberStandardArgument.STANDARDIZED_COPY_RATIOS_FILE_LONG_NAME, \"Non-existent-file\",\n                 \"--\" + CopyNumberStandardArgument.DENOISED_COPY_RATIOS_FILE_LONG_NAME, DENOISED_COPY_RATIOS_FILE.getAbsolutePath(),\n-                \"-\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_FILE.getAbsolutePath(),\n+                \"--\" + StandardArgumentDefinitions.SEQUENCE_DICTIONARY_NAME, SEQUENCE_DICTIONARY_FILE.getAbsolutePath(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cd4b4aa2e3334ccf1783d08a5278b3de551eca7"}, "originalPosition": 73}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2790, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}