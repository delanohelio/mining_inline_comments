{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzMDEzNDUz", "number": 6740, "title": "Optimized DepthOfCoverage", "bodyText": "Running with default arguments locally the runtime (for a WGS full chr15) drops from ~8.9 minutes to ~4.7 minutes after this patch. If I had to peg something else to optimize it would be replacing CSVWriter which seems to be somewhat slow but I can be contented that this tool is reasonably fast when nothing pathological is being triggered.", "createdAt": "2020-08-04T21:16:26Z", "url": "https://github.com/broadinstitute/gatk/pull/6740", "merged": true, "mergeCommit": {"oid": "e05f53aaa13da28f8244b3f62def241ce7844725"}, "closed": true, "closedAt": "2020-08-05T20:17:14Z", "author": {"login": "jamesemery"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7VdlWAH2gAyNDYzMDEzNDUzOjM1YzA4YjU2MDAyZTgyNzI0Zjk3NGQ3NGVlYWQwYjkwYTNmODBmM2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7_yuHAFqTQ2MTkzMTczNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "35c08b56002e82724f974d74eead0b90a3f80f3b", "author": {"user": {"login": "jamesemery", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/35c08b56002e82724f974d74eead0b90a3f80f3b", "committedDate": "2020-08-03T17:27:56Z", "message": "removing an errant toString()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca7c668e974e0e072ea5de2cd4628aacf815722a", "author": {"user": {"login": "jamesemery", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/ca7c668e974e0e072ea5de2cd4628aacf815722a", "committedDate": "2020-08-04T21:09:19Z", "message": "some minor looks at optimizing that didn't bear a lot of fruit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxOTA5OTU3", "url": "https://github.com/broadinstitute/gatk/pull/6740#pullrequestreview-461909957", "createdAt": "2020-08-05T18:15:42Z", "commit": {"oid": "ca7c668e974e0e072ea5de2cd4628aacf815722a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxODoxNTo0MlrOG8VJ6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxODoxODozOFrOG8VPuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkxNDM0Nw==", "bodyText": "This will shock/ horrify you, but the formatters are not thread safe.  Make them fields instead of statics.", "url": "https://github.com/broadinstitute/gatk/pull/6740#discussion_r465914347", "createdAt": "2020-08-05T18:15:42Z", "author": {"login": "lbergelson"}, "path": "src/main/java/org/broadinstitute/hellbender/tools/walkers/coverage/CoverageOutputWriter.java", "diffHunk": "@@ -61,7 +62,8 @@\n     private DEPTH_OF_COVERAGE_OUTPUT_FORMAT outputFormat;\n     private boolean omitDepthOutput;\n     private List<Integer> coverageThresholds;\n-    final static DecimalFormat DOUBLE_FORMAT = new DecimalFormat(\"0.00\");\n+    private final static DecimalFormat DOUBLE_FORMAT_2PLACES = new DecimalFormat(\"0.00\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7c668e974e0e072ea5de2cd4628aacf815722a"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkxNTgzMg==", "bodyText": "This one is the most funny.", "url": "https://github.com/broadinstitute/gatk/pull/6740#discussion_r465915832", "createdAt": "2020-08-05T18:18:38Z", "author": {"login": "lbergelson"}, "path": "src/main/java/org/broadinstitute/hellbender/tools/walkers/coverage/CoverageUtils.java", "diffHunk": "@@ -149,7 +149,7 @@ private static void addCounts(int[] updateMe, int[] leaveMeAlone ) {\n \n         for (PileupElement e : countPileup) {\n             SAMReadGroupRecord readGroup = ReadUtils.getSAMReadGroupRecord(e.getRead(), header);\n-            Utils.nonNull(readGroup, String.format(\"Read %s was missing read group information\", e.getRead()));\n+            Utils.nonNull(readGroup, () -> String.format(\"Read %s was missing read group information\", e.getRead()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7c668e974e0e072ea5de2cd4628aacf815722a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6dd70aa8c9c128f8b0df35f59ba521354901f88", "author": {"user": {"login": "jamesemery", "name": null}}, "url": "https://github.com/broadinstitute/gatk/commit/e6dd70aa8c9c128f8b0df35f59ba521354901f88", "committedDate": "2020-08-05T18:31:35Z", "message": "responding to review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxOTMxNTU1", "url": "https://github.com/broadinstitute/gatk/pull/6740#pullrequestreview-461931555", "createdAt": "2020-08-05T18:46:46Z", "commit": {"oid": "e6dd70aa8c9c128f8b0df35f59ba521354901f88"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxODo0Njo0NlrOG8WMLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxODo0Njo0NlrOG8WMLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkzMTMwOA==", "bodyText": "these should technically probably be lowercase, but eh", "url": "https://github.com/broadinstitute/gatk/pull/6740#discussion_r465931308", "createdAt": "2020-08-05T18:46:46Z", "author": {"login": "lbergelson"}, "path": "src/main/java/org/broadinstitute/hellbender/tools/walkers/coverage/CoverageOutputWriter.java", "diffHunk": "@@ -61,7 +62,8 @@\n     private DEPTH_OF_COVERAGE_OUTPUT_FORMAT outputFormat;\n     private boolean omitDepthOutput;\n     private List<Integer> coverageThresholds;\n-    final static DecimalFormat DOUBLE_FORMAT = new DecimalFormat(\"0.00\");\n+    private final DecimalFormat DOUBLE_FORMAT_2PLACES = new DecimalFormat(\"0.00\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6dd70aa8c9c128f8b0df35f59ba521354901f88"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxOTMxNzM0", "url": "https://github.com/broadinstitute/gatk/pull/6740#pullrequestreview-461931734", "createdAt": "2020-08-05T18:47:02Z", "commit": {"oid": "e6dd70aa8c9c128f8b0df35f59ba521354901f88"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2692, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}