{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3NTAyNjI0", "number": 313, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQyMjozMjoyM1rOEqILPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMTowNjowOFrOFD7zzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyNjA5NTk3OnYy", "diffSide": "RIGHT", "path": "src/main/java/net/fabricmc/loader/EntrypointStorage.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQyMjozMjoyM1rOHcKmcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQwMToxNToyMVrOHcLfcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI5NTg1Nw==", "bodyText": "A behavior change where existing entrypoints will not create the instance until you ask for it via getEntrypoint() is what I'd prefer probably. You can't really do much via relying on the ctor of the entrypoint in order to instantiate everything.\nIn the case of patchwork, you'd obviously get what you want with a behavior change. If you are relying on the instance being created when you resolve the list then I feel that is a horrible hack.", "url": "https://github.com/FabricMC/fabric-loader/pull/313#discussion_r499295857", "createdAt": "2020-10-04T22:32:23Z", "author": {"login": "i509VCB"}, "path": "src/main/java/net/fabricmc/loader/EntrypointStorage.java", "diffHunk": "@@ -203,4 +205,23 @@ boolean hasEntrypoints(String key) {\n \n \t\treturn results;\n \t}\n+\n+\tprotected <T> List<LazyEntrypointContainer<T>> getLazyEntrypointContainers(String key, Class<T> type) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70de32cb688878164bf3507683e98838a4ab60a1"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTMxMDQ1MQ==", "bodyText": "I agree, the time of construction is an impl detail. I can make this change tomorrow.", "url": "https://github.com/FabricMC/fabric-loader/pull/313#discussion_r499310451", "createdAt": "2020-10-05T01:15:21Z", "author": {"login": "TheGlitch76"}, "path": "src/main/java/net/fabricmc/loader/EntrypointStorage.java", "diffHunk": "@@ -203,4 +205,23 @@ boolean hasEntrypoints(String key) {\n \n \t\treturn results;\n \t}\n+\n+\tprotected <T> List<LazyEntrypointContainer<T>> getLazyEntrypointContainers(String key, Class<T> type) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI5NTg1Nw=="}, "originalCommit": {"oid": "70de32cb688878164bf3507683e98838a4ab60a1"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5NjY5OTY3OnYy", "diffSide": "RIGHT", "path": "src/main/java/net/fabricmc/loader/entrypoint/EntrypointContainerImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMTowNjowOFrOID0AuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxMTowNjowOFrOID0AuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDg2ODc5Mg==", "bodyText": "This should be made thread safe, the easiest solution is making the entire method synchronized.", "url": "https://github.com/FabricMC/fabric-loader/pull/313#discussion_r540868792", "createdAt": "2020-12-11T11:06:08Z", "author": {"login": "sfPlayer1"}, "path": "src/main/java/net/fabricmc/loader/entrypoint/EntrypointContainerImpl.java", "diffHunk": "@@ -16,21 +16,28 @@\n \n package net.fabricmc.loader.entrypoint;\n \n-import net.fabricmc.loader.ModContainer;\n+import net.fabricmc.loader.api.ModContainer;\n import net.fabricmc.loader.api.entrypoint.EntrypointContainer;\n \n+import java.util.function.Supplier;\n+\n public class EntrypointContainerImpl<T> implements EntrypointContainer<T> {\n \tprivate final ModContainer container;\n-\tprivate final T entrypoint;\n+\tprivate final Supplier<T> entrypointSupplier;\n+\tprivate T instance;\n \n-\tpublic EntrypointContainerImpl(ModContainer container, T entrypoint) {\n+\tpublic EntrypointContainerImpl(ModContainer container, Supplier<T> entrypointSupplier) {\n \t\tthis.container = container;\n-\t\tthis.entrypoint = entrypoint;\n+\t\tthis.entrypointSupplier = entrypointSupplier;\n \t}\n \n \t@Override\n \tpublic T getEntrypoint() {\n-\t\treturn entrypoint;\n+\t\tif (instance == null) {\n+\t\t\tthis.instance = entrypointSupplier.get();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1717fe6e898c8ce329e9681593b9d5c413afc2"}, "originalPosition": 27}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3259, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}