{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0NzE4NDg0", "number": 204, "title": "Clean up mod resolution error messages", "bodyText": "Currently, there are more than a few cryptic error messages in Loader which make it hard for end users to understand what's wrong. There are three main categories:\n\nZip END header not found\n\nThis is caused, to my knowledge, when a mod jar has an issue while downloading and is corrupted. The zipfs methods for loading zip file systems don't have signatures that note they can throw a ZipError, even though they do throw a ZipError if the jar is corrupt. I've added a catch for this and instead throw a RuntimeException which notes which jar is corrupt. This will fix #185\n\n\nCall the solve method first!!!\n\nLoader uses sat4j for solving mod resolution problems, and makes assumptions about solvedness when it shouldn't. This leads to issues like #201 when a JiJ'd mod has unmet dependencies, since it doesn't log them properly. I've added in a ModResolutionException that chalks it up to an \"unknown error\" for now, but I would like to improve this to have a more explanatory error message before this PR is merged\n\n\n requires <JiJ'd mod>\n\nAnother possible crash when a JiJ'd mod is missing a dependency, Loader sometimes just fails silently and doesn't load the JiJ'd mod, causing the parent mod to freak out and throw a ModResolutionException because it can't find its JiJ'd dependency, like in #203. I haven't been able to write a good fix for this yet, but hopefully better error handling for JiJ'd mods in general would solve this on its own.\n\n\n\nI'd definitely appreciate help with better solutions for the second and third errors, since I can't really figure out how the JiJ stuff works well enough to fix them on my own.", "createdAt": "2020-02-13T07:46:34Z", "url": "https://github.com/FabricMC/fabric-loader/pull/204", "merged": true, "mergeCommit": {"oid": "134386bd5c2fc56e1c397bfd216077a67721cf99"}, "closed": true, "closedAt": "2020-10-26T20:11:35Z", "author": {"login": "LemmaEOF"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcD15x2AH2gAyMzc0NzE4NDg0OjY2ZTBmNDM2ZTM1MGU4ODA2ZDgzZmY1NDFhNjAwMTEwOWFiODMzNmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWZ56TgFqTUxNzEyNTg4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "66e0f436e350e8806d83ff541a6001109ab8336c", "author": {"user": {"login": "LemmaEOF", "name": "Meredith Espinosa"}}, "url": "https://github.com/FabricMC/fabric-loader/commit/66e0f436e350e8806d83ff541a6001109ab8336c", "committedDate": "2020-02-13T07:35:56Z", "message": "start whacking at the confusing error messages in loader"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4MDA5MjA5", "url": "https://github.com/FabricMC/fabric-loader/pull/204#pullrequestreview-358009209", "createdAt": "2020-02-13T07:48:21Z", "commit": {"oid": "66e0f436e350e8806d83ff541a6001109ab8336c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwNzo0ODoyMVrOFpJzTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwNzo0OToxMVrOFpJ0Wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY5NjUyNw==", "bodyText": "How about printing the problem?", "url": "https://github.com/FabricMC/fabric-loader/pull/204#discussion_r378696527", "createdAt": "2020-02-13T07:48:21Z", "author": {"login": "liach"}, "path": "src/main/java/net/fabricmc/loader/discovery/ModResolver.java", "diffHunk": "@@ -220,7 +222,10 @@ private static IVecInt toVecInt(IntStream stream) {\n \t\t\t\t\t}\n \t\t\t\t}\n \n-\t\t\t\t// assume satisfied\n+\t\t\t\t// TODO: better error message, have a way to figure out precisely which mods are causing this\n+\t\t\t\tif (!problem.isSatisfiable(assumptions)) {\n+\t\t\t\t\tthrow new ModResolutionException(\"Could not resolve mod collection due to an unknown error\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66e0f436e350e8806d83ff541a6001109ab8336c"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY5Njc5NA==", "bodyText": "any example of crash of zip error before?", "url": "https://github.com/FabricMC/fabric-loader/pull/204#discussion_r378696794", "createdAt": "2020-02-13T07:49:11Z", "author": {"login": "liach"}, "path": "src/main/java/net/fabricmc/loader/discovery/ModResolver.java", "diffHunk": "@@ -455,6 +460,8 @@ protected void compute() {\n \t\t\t\t\trootDir = jarFs.get().getRootDirectories().iterator().next();\n \t\t\t\t} catch (IOException e) {\n \t\t\t\t\tthrow new RuntimeException(\"Failed to open mod JAR at \" + path + \"!\");\n+\t\t\t\t} catch (ZipError e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66e0f436e350e8806d83ff541a6001109ab8336c"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwODEwNTcz", "url": "https://github.com/FabricMC/fabric-loader/pull/204#pullrequestreview-360810573", "createdAt": "2020-02-19T02:45:34Z", "commit": {"oid": "66e0f436e350e8806d83ff541a6001109ab8336c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1MzM4Nzgz", "url": "https://github.com/FabricMC/fabric-loader/pull/204#pullrequestreview-405338783", "createdAt": "2020-05-04T20:53:37Z", "commit": {"oid": "66e0f436e350e8806d83ff541a6001109ab8336c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3ODM3MTkz", "url": "https://github.com/FabricMC/fabric-loader/pull/204#pullrequestreview-417837193", "createdAt": "2020-05-25T18:24:56Z", "commit": {"oid": "66e0f436e350e8806d83ff541a6001109ab8336c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MDQ5ODk4", "url": "https://github.com/FabricMC/fabric-loader/pull/204#pullrequestreview-499049898", "createdAt": "2020-09-30T02:49:33Z", "commit": {"oid": "66e0f436e350e8806d83ff541a6001109ab8336c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MTI1ODg5", "url": "https://github.com/FabricMC/fabric-loader/pull/204#pullrequestreview-517125889", "createdAt": "2020-10-26T19:54:27Z", "commit": {"oid": "66e0f436e350e8806d83ff541a6001109ab8336c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3415, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}