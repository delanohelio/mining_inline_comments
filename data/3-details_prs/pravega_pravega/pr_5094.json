{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyMzAxNTQ0", "number": 5094, "title": "Issue 5093: validate internal and external names", "bodyText": "Change log description\nIssue 5080 put restriction on the length of the name. This adds different restrictions to internal and external names.\nPurpose of the change\nFixes #5093\nWhat the code does\ntakes prefix or suffix into consideration when internal names are created.\nHow to verify it\nadded unit-tests", "createdAt": "2020-08-24T06:47:35Z", "url": "https://github.com/pravega/pravega/pull/5094", "merged": true, "mergeCommit": {"oid": "d49df49e84d6a3e2e56738a7ce0ad62f42d790cc"}, "closed": true, "closedAt": "2020-08-24T20:52:03Z", "author": {"login": "ravibeta"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdB80-0AH2gAyNDcyMzAxNTQ0OjFjZGIzNTA4NDQwYzAzMmJhZTg5Yzg5NjdhZTE3Njg0YTZlMzZiOTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCI9TYgFqTQ3Mzg0NjkwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1cdb3508440c032bae89c8967ae17684a6e36b99", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/1cdb3508440c032bae89c8967ae17684a6e36b99", "committedDate": "2020-08-24T06:43:20Z", "message": "validate name\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a3f9f87e68471acfd29ec91ee66322f3250ba61", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/0a3f9f87e68471acfd29ec91ee66322f3250ba61", "committedDate": "2020-08-24T09:22:08Z", "message": "checkstylemain\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTYzNTYz", "url": "https://github.com/pravega/pravega/pull/5094#pullrequestreview-473563563", "createdAt": "2020-08-24T14:44:32Z", "commit": {"oid": "0a3f9f87e68471acfd29ec91ee66322f3250ba61"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDo0NDozMlrOHFoRAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDo0NDo0NFrOHFoRjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY2NDY0Mg==", "bodyText": "Use <= to avoid having to do arithmetic every time this executes.\nDo not use String.format. If you check the syntax of Preconditions.checkArgument, you'll see that it already takes a formatted string as arg.", "url": "https://github.com/pravega/pravega/pull/5094#discussion_r475664642", "createdAt": "2020-08-24T14:44:32Z", "author": {"login": "andreipaduroiu"}, "path": "shared/protocol/src/main/java/io/pravega/shared/NameUtils.java", "diffHunk": "@@ -624,7 +638,7 @@ public static String getStreamForReaderGroup(String groupNameName) {\n      */\n     public static String validateUserStreamName(String name) {\n         Preconditions.checkNotNull(name);\n-        Preconditions.checkArgument(name.length() < 256, \"Name must have less than 256 characters\");\n+        Preconditions.checkArgument(name.length() < MAX_GIVEN_NAME_SIZE + 1, String.format(\"Name cannot exceed %d characters\", MAX_GIVEN_NAME_SIZE));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a3f9f87e68471acfd29ec91ee66322f3250ba61"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY2NDc4MA==", "bodyText": "same here", "url": "https://github.com/pravega/pravega/pull/5094#discussion_r475664780", "createdAt": "2020-08-24T14:44:44Z", "author": {"login": "andreipaduroiu"}, "path": "shared/protocol/src/main/java/io/pravega/shared/NameUtils.java", "diffHunk": "@@ -649,7 +663,7 @@ public static String validateStreamName(String name) {\n \n         // In addition to user stream names, pravega internally created stream have a special prefix.\n         final String matcher = \"[\" + INTERNAL_NAME_PREFIX + \"]?[\\\\p{Alnum}\\\\.\\\\-]+\";\n-        Preconditions.checkArgument(name.length() < 256, \"Name must have less than 256 characters\");\n+        Preconditions.checkArgument(name.length() < MAX_NAME_SIZE + 1, String.format(\"Name cannot exceed %d characters\", MAX_NAME_SIZE));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0a3f9f87e68471acfd29ec91ee66322f3250ba61"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2ad93cf91d79cd51c025fb6119654e057e5d2b5", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/d2ad93cf91d79cd51c025fb6119654e057e5d2b5", "committedDate": "2020-08-24T16:31:32Z", "message": "allow scope name to be longer than stream name\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczODQ2OTA1", "url": "https://github.com/pravega/pravega/pull/5094#pullrequestreview-473846905", "createdAt": "2020-08-24T20:51:17Z", "commit": {"oid": "d2ad93cf91d79cd51c025fb6119654e057e5d2b5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3825, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}