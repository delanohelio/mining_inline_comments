{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4MDQwMzgx", "number": 4566, "title": "Issue 4561: Using S3 Rest Style Config URI for Extended S3 client construction", "bodyText": "Signed-off-by: kevinhan88 kevinhan88@gmail.com\nChange log description\nStarted using s3 rest style configUri for majority of extendeds3 storage client config.\nPurpose of the change\nCloses #4561\nWhat the code does\n(Detailed description of the code changes)\nconfig.properties now contains configUri, bucket and prefix for extendedS3 storage.\nExtendedS3StorageConfig takes configUri and construct s3Config from it.\nExtendedS3StorageFactory handles configUri now.\nExtendedS3StorageConfigTest is added.\nExtendedS3StorageTest is updated to work with the new configUri\nExtendedS3IntegrationTest is updated to work with the new configUri\nHow to verify it\n(Optional: steps to verify that the changes are effective)\nNo functional changes. All tests (unit, integration, system and longevity) should pass.\nThe new configUri should start taking effect.", "createdAt": "2020-02-21T00:09:07Z", "url": "https://github.com/pravega/pravega/pull/4566", "merged": true, "mergeCommit": {"oid": "310f0c30c717d8ca4b758985f6b366cbf66f907f"}, "closed": true, "closedAt": "2020-03-02T21:45:34Z", "author": {"login": "kevinhan88"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGTUNhAH2gAyMzc4MDQwMzgxOjQyNzRjNmQyYWNkNDAxM2VkYWEwMDcxMDdiYjgzMjE4NzQ0ZmQ1OTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJNb0SgH2gAyMzc4MDQwMzgxOjUzMzIxMTA1MDE4NDdlMTE0Nzk5OGZkNWYwNDYxYmZkZmViNGYzZTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4274c6d2acd4013edaa007107bb83218744fd592", "author": {"user": {"login": "kevinhan88", "name": "Kevin Han"}}, "url": "https://github.com/pravega/pravega/commit/4274c6d2acd4013edaa007107bb83218744fd592", "committedDate": "2020-02-20T22:59:54Z", "message": "Issue 4561: started using s3 rest style config uri for extended s3 client construction.\n\nSigned-off-by: kevinhan88 <kevinhan88@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NDY2NzU5", "url": "https://github.com/pravega/pravega/pull/4566#pullrequestreview-364466759", "createdAt": "2020-02-25T21:37:39Z", "commit": {"oid": "4274c6d2acd4013edaa007107bb83218744fd592"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMTozNzo0MFrOFuWG7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMTozNzo0MFrOFuWG7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE0MTAzOA==", "bodyText": "\"Refer to\"", "url": "https://github.com/pravega/pravega/pull/4566#discussion_r384141038", "createdAt": "2020-02-25T21:37:40Z", "author": {"login": "andreipaduroiu"}, "path": "config/config.properties", "diffHunk": "@@ -427,24 +427,25 @@ hdfs.hdfsUrl=localhost:9000\n \n ##region Extended S3 settings\n \n-# URL where the extended S3 cluster is accessible at.\n+# URI to specify the complete extended S3 client configurations (excludes bucket and prefix), in the format of\n+# <protocol>://<host>[:<port>][/path][?<param-key>=<param-value>][&<param-key>=<param-value>][...]\n+# Refer https://github.com/EMCECS/ecs-object-client-java/wiki/Config-URI-format for more details.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4274c6d2acd4013edaa007107bb83218744fd592"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NjMwOTk0", "url": "https://github.com/pravega/pravega/pull/4566#pullrequestreview-364630994", "createdAt": "2020-02-26T05:29:24Z", "commit": {"oid": "4274c6d2acd4013edaa007107bb83218744fd592"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwNToyOToyNFrOFuernQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQwNToyOToyNFrOFuernQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDI4MTUwMQ==", "bodyText": "Need to update the comment as it's a bit incorrect. A prefix in this case is a prefix that will be added to every object created by this instance of segment store in a configured S3 bucket. Using prefix allows sharing the same bucket between different Pravega clusters and also differentiate objects within a bucket created by Pravega from other objects.\nAlso please mention that the prefix is optional and can be left empty.", "url": "https://github.com/pravega/pravega/pull/4566#discussion_r384281501", "createdAt": "2020-02-26T05:29:24Z", "author": {"login": "medvedevigorek"}, "path": "config/config.properties", "diffHunk": "@@ -427,24 +427,25 @@ hdfs.hdfsUrl=localhost:9000\n \n ##region Extended S3 settings\n \n-# URL where the extended S3 cluster is accessible at.\n+# URI to specify the complete extended S3 client configurations (excludes bucket and prefix), in the format of\n+# <protocol>://<host>[:<port>][/path][?<param-key>=<param-value>][&<param-key>=<param-value>][...]\n+# Refer https://github.com/EMCECS/ecs-object-client-java/wiki/Config-URI-format for more details.\n # This value must be the same for all Pravega SegmentStore instances in this cluster.\n-extendeds3.url=localhost:9020\n-\n-# Prefix in extended S3 cluster where all Pravega-related data for this cluster is following.\n-# This value must be the same for all Pravega SegmentStore instances in this cluster.\n-# extendeds3.prefix=\n-\n-# ACCESS_KEY_ID to access the extended S3 cluster\n-# extendeds3.accessKey=\n-\n-# SECRET_KEY to access the extended S3 cluster\n-# extendeds3.secretKey=\n+#\n+# Supported parameters include but are not limited to:\n+#   url: where the extended S3 cluster is accessible at, e.g. http://localhost:9020\n+#   identity: the access key to access the extended S3 cluster, e.g. identity=user\n+#   secretKey: the secret key to access the extended S3 cluster, e.g. secretKey=password\n+extendeds3.configUri=http://localhost:9020?identity=user&secretKey=password\n \n # Shared extended S3 bucket where the data is stored.\n # This value must be the same for all Pravega SegmentStore instances in this cluster.\n # extendeds3.bucket=\n \n+# Prefix in extended S3 cluster where all Pravega-related data for this cluster is following.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4274c6d2acd4013edaa007107bb83218744fd592"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MDM3MzQx", "url": "https://github.com/pravega/pravega/pull/4566#pullrequestreview-365037341", "createdAt": "2020-02-26T16:14:31Z", "commit": {"oid": "4274c6d2acd4013edaa007107bb83218744fd592"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f14739e2b9775eb6be978002786fa79dc0b384b", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/5f14739e2b9775eb6be978002786fa79dc0b384b", "committedDate": "2020-02-28T17:20:41Z", "message": "Merge branch 'master' into issue-4561"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5766e2bbaf41ca9872c86cef5725723749a12e50", "author": {"user": {"login": "kevinhan88", "name": "Kevin Han"}}, "url": "https://github.com/pravega/pravega/commit/5766e2bbaf41ca9872c86cef5725723749a12e50", "committedDate": "2020-02-28T20:40:07Z", "message": "Merge branch 'master' into issue-4561"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5332110501847e1147998fd5f0461bfdfeb4f3e2", "author": {"user": {"login": "kevinhan88", "name": "Kevin Han"}}, "url": "https://github.com/pravega/pravega/commit/5332110501847e1147998fd5f0461bfdfeb4f3e2", "committedDate": "2020-02-29T23:50:33Z", "message": "Issue 4561: constructs ecs configUri inside init_tier2.sh with ecs credentials\n\nSigned-off-by: kevinhan88 <kevinhan88@gmail.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3592, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}