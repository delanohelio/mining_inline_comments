{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5NjA5MjA0", "number": 5004, "title": "Issue 4186: CacheManager Metric.", "bodyText": "Change log description\n\nAdds a new metric (Timer) that tracks the time taken complete one cycle of the CacheManager's cache policy.\n\nPurpose of the change\nCloses #4186\nWhat the code does\n\nAdds a new OpStatsLogger to track the time taken.\nMakes SegmentStoreMetrics.CacheManager implement AutoClosable. This makes sure (if required) we can properly clean up the metrics manager by SegmentStoreMetrics.CacheManager.\n\nHow to verify it\nRun unit tests.", "createdAt": "2020-07-30T21:19:50Z", "url": "https://github.com/pravega/pravega/pull/5004", "merged": true, "mergeCommit": {"oid": "3a9e14f868ea40b65951a0b17d062ba9c6d1f2d7"}, "closed": true, "closedAt": "2020-08-07T16:45:43Z", "author": {"login": "co-jo"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGUXgKAH2gAyNDU5NjA5MjA0OjA4NjAxYWZkMTE0NjNiZjcwMGE2ZDBhZjNmMzNkY2I1M2Y5MzVlMDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8nOCTAFqTQ2MzQ1NDgzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "08601afd11463bf700a6d0af3f33dcb53f935e09", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/08601afd11463bf700a6d0af3f33dcb53f935e09", "committedDate": "2020-02-21T00:13:24Z", "message": "Update K8 client APIs to use their 5.0.0 counterparts.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25a165d0293c34ee8703fff764e55cf8fda413dd", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/25a165d0293c34ee8703fff764e55cf8fda413dd", "committedDate": "2020-02-21T18:42:03Z", "message": "Merge pull request #1 from co-jo/issue-4464-update-kubernetes-client-version\n\nIssue 4464 update kubernetes client version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cc2dd2be26feed2953258ff055c1657aeb57019", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/8cc2dd2be26feed2953258ff055c1657aeb57019", "committedDate": "2020-02-23T04:43:09Z", "message": "Run system tests using alternative flag value.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3fcbd2e627f9fc0a0f6bad7e42667db4439e092", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/c3fcbd2e627f9fc0a0f6bad7e42667db4439e092", "committedDate": "2020-03-10T22:21:32Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5f808cc42831892aeb8e7824c22d499a1f9fa03", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/f5f808cc42831892aeb8e7824c22d499a1f9fa03", "committedDate": "2020-03-18T18:44:10Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7901435dc1127bed1c46845bbaf8024477e2078f", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/7901435dc1127bed1c46845bbaf8024477e2078f", "committedDate": "2020-04-02T18:49:59Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d59b3e33f6d5bd90264753caadcea7ed7bbfe06c", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/d59b3e33f6d5bd90264753caadcea7ed7bbfe06c", "committedDate": "2020-04-16T20:22:05Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa090cad1d88812f2a88e9debacdb04df585adbf", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/aa090cad1d88812f2a88e9debacdb04df585adbf", "committedDate": "2020-04-18T20:15:50Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e328bcb38239fdc32f866980ee1103c93dff522d", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/e328bcb38239fdc32f866980ee1103c93dff522d", "committedDate": "2020-05-11T22:25:21Z", "message": "Merge branch 'master' of https://github.com/co-jo/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd02180986f49a42002c7fd2ef28885d1f701af9", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/cd02180986f49a42002c7fd2ef28885d1f701af9", "committedDate": "2020-05-11T22:25:27Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1408d7527ec73f1645418df04aea4aa1120b39e7", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/1408d7527ec73f1645418df04aea4aa1120b39e7", "committedDate": "2020-05-18T20:48:16Z", "message": "Merge branch 'master' of https://github.com/co-jo/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2719517850f39bce3e5f2c92f04c8c24122a520", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/e2719517850f39bce3e5f2c92f04c8c24122a520", "committedDate": "2020-05-20T18:59:36Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1d3648dd2c28a161dab520a48bf4bf657f9d14d", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/b1d3648dd2c28a161dab520a48bf4bf657f9d14d", "committedDate": "2020-06-15T18:43:02Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78ff6324b40431e17d655d738a4174b2b634ecba", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/78ff6324b40431e17d655d738a4174b2b634ecba", "committedDate": "2020-06-17T18:04:56Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bc4cc9666bed4641f4c8125f7e701b2fb7067f8", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/3bc4cc9666bed4641f4c8125f7e701b2fb7067f8", "committedDate": "2020-06-25T20:15:11Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be4e9d267fd35b06e26dcf8b9f010fd162b46ad4", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/be4e9d267fd35b06e26dcf8b9f010fd162b46ad4", "committedDate": "2020-06-30T19:26:42Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9095ec974640c75cd3147248d4cfb87aa417f52", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/c9095ec974640c75cd3147248d4cfb87aa417f52", "committedDate": "2020-07-06T17:26:31Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80c883876e41cd019e6cba4a5ce650a86d9b1ef7", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/80c883876e41cd019e6cba4a5ce650a86d9b1ef7", "committedDate": "2020-07-29T20:29:36Z", "message": "Merge branch 'master' of https://github.com/pravega/pravega"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "987bac9acf967c8200a132db21b1decff1a32045", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/987bac9acf967c8200a132db21b1decff1a32045", "committedDate": "2020-07-29T23:02:37Z", "message": "* Add metric to track the time taken to apply the cache policy.\n* Make the CacheManager autocloseable.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "503e438a2927e7ea3adf3fe9bc9646b1bcbecb12", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/503e438a2927e7ea3adf3fe9bc9646b1bcbecb12", "committedDate": "2020-07-30T21:07:01Z", "message": "* Change metric type to prevent stale values being reported during periods of dormancy.c\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "039235c8ae24caa1557fd310202777bec76990a3", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/039235c8ae24caa1557fd310202777bec76990a3", "committedDate": "2020-07-31T20:30:20Z", "message": "* Use proper metric type.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d681822f62d194464a50822a06e85c3a34f856e0", "author": {"user": {"login": "andreipaduroiu", "name": "Andrei Paduroiu"}}, "url": "https://github.com/pravega/pravega/commit/d681822f62d194464a50822a06e85c3a34f856e0", "committedDate": "2020-08-03T20:33:47Z", "message": "Merge branch 'master' into issue-4186-cachemanager-metric"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzIzOTYw", "url": "https://github.com/pravega/pravega/pull/5004#pullrequestreview-460323960", "createdAt": "2020-08-03T20:37:08Z", "commit": {"oid": "d681822f62d194464a50822a06e85c3a34f856e0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDozNzowOVrOG7H6Ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QyMDozNzowOVrOG7H6Ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDY0ODczOA==", "bodyText": "Let's name this segment store.cache.manager_iteration_duration_ms - it's more indicative of what it does. Hopefully not too long of a name.", "url": "https://github.com/pravega/pravega/pull/5004#discussion_r464648738", "createdAt": "2020-08-03T20:37:09Z", "author": {"login": "andreipaduroiu"}, "path": "shared/metrics/src/main/java/io/pravega/shared/MetricsNames.java", "diffHunk": "@@ -122,6 +121,7 @@\n     public static final String CACHE_USED_SIZE_BYTES = PREFIX + \"segmentstore.cache.used_size_bytes\";       // Gauge\n     public static final String CACHE_ALLOC_SIZE_BYTES = PREFIX + \"segmentstore.cache.allocated_size_bytes\"; // Gauge\n     public static final String CACHE_GENERATION_SPREAD = PREFIX + \"segmentstore.cache.gen\";                 // Histogram\n+    public static final String CACHE_POLICY_DURATION = PREFIX + \"segmentstore.cache.policy_duration_ms\";    // Timer", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d681822f62d194464a50822a06e85c3a34f856e0"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d19b871d1c7af34d2773a11e11acecb2d4e2fdc9", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/d19b871d1c7af34d2773a11e11acecb2d4e2fdc9", "committedDate": "2020-08-03T22:05:28Z", "message": "* Rename metric and associated variables to something more appropriate.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "692c39ba9e0a1ec8a116a48ceff5aaa64cda265b", "author": {"user": {"login": "andreipaduroiu", "name": "Andrei Paduroiu"}}, "url": "https://github.com/pravega/pravega/commit/692c39ba9e0a1ec8a116a48ceff5aaa64cda265b", "committedDate": "2020-08-04T04:03:46Z", "message": "Merge branch 'master' into issue-4186-cachemanager-metric"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28b91bb67fac44e5e66083d6975a4a53f700b972", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/28b91bb67fac44e5e66083d6975a4a53f700b972", "committedDate": "2020-08-04T17:46:23Z", "message": "Merge branch 'master' into issue-4186-cachemanager-metric"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af2384df2e9a531e329063bc0f6899903d1e5489", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/af2384df2e9a531e329063bc0f6899903d1e5489", "committedDate": "2020-08-06T17:12:34Z", "message": "Merge remote-tracking branch 'origin/issue-4186-cachemanager-metric' into issue-4186-cachemanager-metric"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "673c68d356664520afca111c8d627ed413fc6d4a", "author": {"user": {"login": "co-jo", "name": "Colin Hryniowski"}}, "url": "https://github.com/pravega/pravega/commit/673c68d356664520afca111c8d627ed413fc6d4a", "committedDate": "2020-08-06T17:13:03Z", "message": "Merge branch 'master' into issue-4186-cachemanager-metric"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNDU0ODM4", "url": "https://github.com/pravega/pravega/pull/5004#pullrequestreview-463454838", "createdAt": "2020-08-07T16:43:10Z", "commit": {"oid": "673c68d356664520afca111c8d627ed413fc6d4a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4007, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}