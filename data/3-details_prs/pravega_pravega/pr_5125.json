{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1OTgzNTg1", "number": 5125, "title": "Issue 5124: publish :segmentstore:storage:testJar artifact", "bodyText": "Change log description\nThis generates a test jar so that it can be published along with the other artifacts.\nPurpose of the change\nFixes #5124\nWhat the code does\nThis leverages the maven plugin syntax to specify test jars for publishing. We do it the same way as system test jar:\nhttps://repo1.maven.org/maven2/io/pravega/pravega-test-system/0.7.1/\nHow to verify it\nThese steps can be verified by running the gradle command to publish:\n./gradlew  publish\npublishing  artifact io.pravega:pravega-segmentstore-storage-tests:jar:0.9.0-2635.d0d098a-2631.017f4b1-20200831.001154-1\nto ... /io/pravega/pravega-segmentstore-storage-tests/0.9.0-2635.d0d098a-2631.017f4b1-SNAPSHOT/pravega-segmentstore-storage-tests\n-0.9.0-2635.d0d098a-2631.017f4b1-20200831.001154-1.jar\nReference: https://docs.gradle.org/current/userguide/maven_plugin.html\nio/pravega/pravega-segmentstore-storage/0.9.0-2635.d0d098a-SNAPSHOT/pravega-segmentstore-storage-0.9.0-2635.d0d098a-SNAPSHOT-javadoc.jar\nio/pravega/pravega-segmentstore-storage/0.9.0-2635.d0d098a-SNAPSHOT/pravega-segmentstore-storage-0.9.0-2635.d0d098a-SNAPSHOT-sources.jar\nio/pravega/pravega-segmentstore-storage/0.9.0-2635.d0d098a-SNAPSHOT/pravega-segmentstore-storage-0.9.0-2635.d0d098a-SNAPSHOT-tests.jar\n # ls -alt io/pravega/pravega-segmentstore-storage/0.9.0-2635.d0d098a-SNAPSHOT/pravega-segmentstore-storage-0.9.0-2635.d0d098a-SNAPSHOT-tests.jar\n-rw-r--r-- 1 root root 212997 Aug 30 15:48 io/pravega/pravega-segmentstore-storage/0.9.0-2635.d0d098a-SNAPSHOT/pravega-segmentstore-storage-0.9.0-2635.d0d098a-SNAPSHOT-tests.jar", "createdAt": "2020-08-31T00:10:13Z", "url": "https://github.com/pravega/pravega/pull/5125", "merged": true, "mergeCommit": {"oid": "0c98b91cd1be4ffd0d0fdc45da9a3e0c1da626ee"}, "closed": true, "closedAt": "2020-09-09T22:19:40Z", "author": {"login": "ravibeta"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEHFwGgH2gAyNDc1OTgzNTg1OjAxN2Y0YjE1YzEzZThlYTI5OTI2YTEyMzAzM2ViMDQ1NjkwNzExMDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHTziwAFqTQ4NTQ0MjI0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "017f4b15c13e8ea29926a123033eb04569071104", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/017f4b15c13e8ea29926a123033eb04569071104", "committedDate": "2020-08-30T23:48:33Z", "message": "publish :segmentstore:storage:testJar artifact\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00aabf8a0e0f46f64d2173917577e794e7a2f9d2", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/00aabf8a0e0f46f64d2173917577e794e7a2f9d2", "committedDate": "2020-08-31T03:10:24Z", "message": "test both ways - source as well as test to ensure the publishing filter condition works properly\njar -> continues to publish as before\ntest -> publishes after this change\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "945ea7c8664c43bea3431b8ba32feb9ae8f7bcf3", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/945ea7c8664c43bea3431b8ba32feb9ae8f7bcf3", "committedDate": "2020-08-31T03:49:30Z", "message": "add tests as filter criteria\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2db1b79ff60b47787589271f389c559af8b58631", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/2db1b79ff60b47787589271f389c559af8b58631", "committedDate": "2020-08-31T08:20:49Z", "message": "include testJar in artifacts\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4NzQyNDgz", "url": "https://github.com/pravega/pravega/pull/5125#pullrequestreview-478742483", "createdAt": "2020-08-31T16:00:39Z", "commit": {"oid": "2db1b79ff60b47787589271f389c559af8b58631"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjowMDozOVrOHJ-2WQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNjowMDozOVrOHJ-2WQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIyODk1Mw==", "bodyText": "This is not required but it is intentional in this listing.", "url": "https://github.com/pravega/pravega/pull/5125#discussion_r480228953", "createdAt": "2020-08-31T16:00:39Z", "author": {"login": "ravibeta"}, "path": "build.gradle", "diffHunk": "@@ -1008,6 +1008,7 @@ task publishAllJars() {\n     dependsOn ':shared:security'\n     dependsOn ':shared:protocol:publish'\n     dependsOn ':segmentstore:contracts:publish'\n+    dependsOn ':segmentstore:storage:testJar'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2db1b79ff60b47787589271f389c559af8b58631"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46051610779198dfa1a6a817bfac3f2fcfaf9972", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/46051610779198dfa1a6a817bfac3f2fcfaf9972", "committedDate": "2020-08-31T18:29:58Z", "message": "simple fix\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f40c690d1a213ef33df52a1f4b7c2ba38cc5add", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/4f40c690d1a213ef33df52a1f4b7c2ba38cc5add", "committedDate": "2020-08-31T19:10:56Z", "message": "This reverts commit 46051610779198dfa1a6a817bfac3f2fcfaf9972.\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea37ccadcdca0fbcfa4e43b927c5265d4c260794", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/ea37ccadcdca0fbcfa4e43b927c5265d4c260794", "committedDate": "2020-09-02T17:06:35Z", "message": "Merge branch 'master' into issue-5124-use-maven-plugin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMTI0NDcy", "url": "https://github.com/pravega/pravega/pull/5125#pullrequestreview-482124472", "createdAt": "2020-09-03T19:04:32Z", "commit": {"oid": "ea37ccadcdca0fbcfa4e43b927c5265d4c260794"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6ff7a5c6df19470eb782dc487678f53c91df952", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/c6ff7a5c6df19470eb782dc487678f53c91df952", "committedDate": "2020-09-07T17:55:46Z", "message": "add pom\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d7c527202e6b65f7ade6ad4300323246d9859e7", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/8d7c527202e6b65f7ade6ad4300323246d9859e7", "committedDate": "2020-09-07T18:38:15Z", "message": "Merge branch 'master' into issue-5124-use-maven-plugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8f47d989c693cc86b6a1f1b50164deb9aabec9b", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/b8f47d989c693cc86b6a1f1b50164deb9aabec9b", "committedDate": "2020-09-07T18:00:01Z", "message": "fix indentation\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0Mjc0NDEw", "url": "https://github.com/pravega/pravega/pull/5125#pullrequestreview-484274410", "createdAt": "2020-09-08T15:47:54Z", "commit": {"oid": "b8f47d989c693cc86b6a1f1b50164deb9aabec9b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNTo0Nzo1NFrOHOjd7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNTo0Nzo1NFrOHOjd7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTAyMzIxNQ==", "bodyText": "Isn't this going to publish ALL test JARs, instead of just the one we want?", "url": "https://github.com/pravega/pravega/pull/5125#discussion_r485023215", "createdAt": "2020-09-08T15:47:54Z", "author": {"login": "andreipaduroiu"}, "path": "gradle/maven.gradle", "diffHunk": "@@ -9,6 +9,15 @@\n  *\n  */\n plugins.withId('maven') {\n+    task sourcesJar(type: Jar, dependsOn: classes) {\n+         classifier = 'sources'\n+         from sourceSets.main.allSource\n+    }\n+    artifacts{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b8f47d989c693cc86b6a1f1b50164deb9aabec9b"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78d270a4edefef700b009d024c2cf0f439d9712b", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/78d270a4edefef700b009d024c2cf0f439d9712b", "committedDate": "2020-09-08T16:50:44Z", "message": "publish only segmentstore:storage:testJar and not other test jars\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47dbe0ac8fbd21da167696f05485d7dbe7e76ed4", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/47dbe0ac8fbd21da167696f05485d7dbe7e76ed4", "committedDate": "2020-09-08T17:28:28Z", "message": "Merge branch 'master' into issue-5124-use-maven-plugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fff19db95bfb0b08c90e3c95f239782c9d13d959", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/fff19db95bfb0b08c90e3c95f239782c9d13d959", "committedDate": "2020-09-09T15:15:57Z", "message": "Merge branch 'master' into issue-5124-use-maven-plugin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1NDQyMjQ5", "url": "https://github.com/pravega/pravega/pull/5125#pullrequestreview-485442249", "createdAt": "2020-09-09T22:19:12Z", "commit": {"oid": "fff19db95bfb0b08c90e3c95f239782c9d13d959"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3839, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}