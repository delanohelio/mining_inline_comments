{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzNjg4OTcw", "number": 5034, "title": "Issue 5033: (SLTS) - Read ChunkedSegmentStorageConfig from properties.", "bodyText": "Ability to initialize ChunkedSegmentStorageConfig values from config file or properties.\nSigned-off-by: Sachin Joshi sachin.joshi@emc.com\nChange log description\nAbility to initialize ChunkedSegmentStorageConfig values from config file or properties.\nPurpose of the change\nFixes #5033  SLTS - Ability to initialize ChunkedSegmentStorageConfig values from config file or properties.\nWhat the code does\nRead values from config file or properties and use them during initialization.\nHow to verify it\nClean build. Manual testing.", "createdAt": "2020-08-05T23:04:54Z", "url": "https://github.com/pravega/pravega/pull/5034", "merged": true, "mergeCommit": {"oid": "56c1434c6b827a8c03b8080250b5a9a34343dfaa"}, "closed": true, "closedAt": "2020-08-12T22:27:24Z", "author": {"login": "sachin-j-joshi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8Iq_QAFqTQ2MjE5MDQ2MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-PK7dAH2gAyNDYzNjg4OTcwOmRmOWRlNDliMmY0NTAyMTViMmU3MzUxMDEyZjM0MmJmY2ViOTY4YTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyMTkwNDYx", "url": "https://github.com/pravega/pravega/pull/5034#pullrequestreview-462190461", "createdAt": "2020-08-06T05:07:16Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwNTowNzoxN1rOG8jdzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwNTowNzoxN1rOG8jdzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE0ODgxNA==", "bodyText": "Is this right?\nWhat about 'storage' ?", "url": "https://github.com/pravega/pravega/pull/5034#discussion_r466148814", "createdAt": "2020-08-06T05:07:17Z", "author": {"login": "eolivelli"}, "path": "segmentstore/storage/src/main/java/io/pravega/segmentstore/storage/chunklayer/ChunkedSegmentStorageConfig.java", "diffHunk": "@@ -35,6 +48,8 @@\n             .appendsDisabled(false)\n             .build();\n \n+    static final String COMPONENT_CODE = \"pravegaservice\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b50bf14d0fc64330f04b394761775e50f62dcd7", "author": {"user": {"login": "sachin-j-joshi", "name": "Sachin Jayant Joshi"}}, "url": "https://github.com/pravega/pravega/commit/1b50bf14d0fc64330f04b394761775e50f62dcd7", "committedDate": "2020-08-06T23:25:16Z", "message": "Issue 5033: (SLTS) - Read ChunkedSegmentStorageConfig from properties.\n\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "1b50bf14d0fc64330f04b394761775e50f62dcd7", "author": {"user": {"login": "sachin-j-joshi", "name": "Sachin Jayant Joshi"}}, "url": "https://github.com/pravega/pravega/commit/1b50bf14d0fc64330f04b394761775e50f62dcd7", "committedDate": "2020-08-06T23:25:16Z", "message": "Issue 5033: (SLTS) - Read ChunkedSegmentStorageConfig from properties.\n\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NTMxMTE2", "url": "https://github.com/pravega/pravega/pull/5034#pullrequestreview-464531116", "createdAt": "2020-08-10T19:50:44Z", "commit": {"oid": "1b50bf14d0fc64330f04b394761775e50f62dcd7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxOTo1MDo0NFrOG-dNlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxOTo1NTo0MVrOG-dXoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0MzUwOQ==", "bodyText": "revert this", "url": "https://github.com/pravega/pravega/pull/5034#discussion_r468143509", "createdAt": "2020-08-10T19:50:44Z", "author": {"login": "andreipaduroiu"}, "path": "bindings/src/main/java/io/pravega/storage/filesystem/FileSystemSimpleStorageFactory.java", "diffHunk": "@@ -13,16 +13,19 @@\n import io.pravega.segmentstore.storage.StorageFactory;\n import io.pravega.segmentstore.storage.chunklayer.ChunkedSegmentStorage;\n import io.pravega.segmentstore.storage.chunklayer.ChunkedSegmentStorageConfig;\n+import lombok.AllArgsConstructor;\n import lombok.NonNull;\n-import lombok.RequiredArgsConstructor;\n \n import java.util.concurrent.ExecutorService;\n \n /**\n- * Factory for FileSystem {@link Storage} implemented using {@link ChunkedSegmentStorage} and {@link FileSystemChunkStorage}.\n+ * Factory for ExtendedS3 {@link Storage} implemented using {@link ChunkedSegmentStorage} and {@link FileSystemChunkStorage}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b50bf14d0fc64330f04b394761775e50f62dcd7"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0MzU5Mw==", "bodyText": "And this.", "url": "https://github.com/pravega/pravega/pull/5034#discussion_r468143593", "createdAt": "2020-08-10T19:50:55Z", "author": {"login": "andreipaduroiu"}, "path": "bindings/src/main/java/io/pravega/storage/filesystem/FileSystemSimpleStorageFactory.java", "diffHunk": "@@ -13,16 +13,19 @@\n import io.pravega.segmentstore.storage.StorageFactory;\n import io.pravega.segmentstore.storage.chunklayer.ChunkedSegmentStorage;\n import io.pravega.segmentstore.storage.chunklayer.ChunkedSegmentStorageConfig;\n+import lombok.AllArgsConstructor;\n import lombok.NonNull;\n-import lombok.RequiredArgsConstructor;\n \n import java.util.concurrent.ExecutorService;\n \n /**\n- * Factory for FileSystem {@link Storage} implemented using {@link ChunkedSegmentStorage} and {@link FileSystemChunkStorage}.\n+ * Factory for ExtendedS3 {@link Storage} implemented using {@link ChunkedSegmentStorage} and {@link FileSystemChunkStorage}.\n  */\n-@RequiredArgsConstructor\n+@AllArgsConstructor", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b50bf14d0fc64330f04b394761775e50f62dcd7"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0MzgzNg==", "bodyText": "I don't see why this is needed. RequiredArgsConstructor will generate the constructor for all final members.", "url": "https://github.com/pravega/pravega/pull/5034#discussion_r468143836", "createdAt": "2020-08-10T19:51:25Z", "author": {"login": "andreipaduroiu"}, "path": "bindings/src/main/java/io/pravega/storage/hdfs/HDFSSimpleStorageFactory.java", "diffHunk": "@@ -13,18 +13,23 @@\n import io.pravega.segmentstore.storage.StorageFactory;\n import io.pravega.segmentstore.storage.chunklayer.ChunkedSegmentStorage;\n import io.pravega.segmentstore.storage.chunklayer.ChunkedSegmentStorageConfig;\n+import lombok.AllArgsConstructor;\n import lombok.NonNull;\n-import lombok.RequiredArgsConstructor;\n \n import java.util.concurrent.Executor;\n \n /**\n  * Factory for HDFS {@link Storage} implemented using {@link ChunkedSegmentStorage} and {@link HDFSChunkStorage}.\n  */\n-@RequiredArgsConstructor\n+@AllArgsConstructor", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b50bf14d0fc64330f04b394761775e50f62dcd7"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0NDQ2MQ==", "bodyText": "Please rephrase this to be refer to the max argument.", "url": "https://github.com/pravega/pravega/pull/5034#discussion_r468144461", "createdAt": "2020-08-10T19:52:39Z", "author": {"login": "andreipaduroiu"}, "path": "config/config.properties", "diffHunk": "@@ -106,6 +106,47 @@ pravegaservice.dataLog.impl.name=BOOKKEEPER\n # pravegaservice.storage.layout=ROLLING_STORAGE\n # NOTE: ChunkedSegmentStorage is an experimental feature. Its behavior and/or API should be expected to be in flux until fully released.\n \n+# Size of chunk in bytes above which it is no longer considered a small object.\n+# For small source objects, concat is not used.\n+# Valid values: non-negative long\n+# Default value: 0\n+# storage.concat.size.bytes.min=0\n+\n+# Size of chunk in bytes above which it is no longer considered for concat.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b50bf14d0fc64330f04b394761775e50f62dcd7"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0NTY0NQ==", "bodyText": "Please be explicit about the bounds. A long can be a signed long or unsigned long. In this case, if I remember, the upper bound is 2^62, isn't it?\nPlease fix this for the other config descriptions too.", "url": "https://github.com/pravega/pravega/pull/5034#discussion_r468145645", "createdAt": "2020-08-10T19:54:53Z", "author": {"login": "andreipaduroiu"}, "path": "config/config.properties", "diffHunk": "@@ -106,6 +106,47 @@ pravegaservice.dataLog.impl.name=BOOKKEEPER\n # pravegaservice.storage.layout=ROLLING_STORAGE\n # NOTE: ChunkedSegmentStorage is an experimental feature. Its behavior and/or API should be expected to be in flux until fully released.\n \n+# Size of chunk in bytes above which it is no longer considered a small object.\n+# For small source objects, concat is not used.\n+# Valid values: non-negative long\n+# Default value: 0\n+# storage.concat.size.bytes.min=0\n+\n+# Size of chunk in bytes above which it is no longer considered for concat.\n+# Valid values: non-negative long\n+# Default value: 9223372036854775807\n+# storage.concat.size.bytes.max=9223372036854775807\n+\n+# Maximum size for the buffer used while copying of data from one chunk to other.\n+# Valid values: non-negative integer\n+# Default value: 1048576 (1 MB)\n+# storage.appends.buffer.size.bytes.max=1048576\n+\n+# Max number of indexed segments to keep in read cache.\n+# Valid values: non-negative integer\n+# Default value: 1024 (1 K)\n+# storage.readindex.segments.max=1024\n+\n+# Max number of indexed chunks to keep per segment in read cache.\n+# Valid values: non-negative integer\n+# Default value: 1024 (1 K)\n+# storage.readindex.chunksPerSegment.max=1024\n+\n+# Max number of indexed chunks to keep in cache.\n+# Valid values: non-negative integer\n+# Default value: 16384 (16 K)\n+# storage.readindex.chunks.max=16384\n+\n+# The maximum size of a single Segment Chunk in Storage for metadata segments.\n+# Valid values: non-negative long", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b50bf14d0fc64330f04b394761775e50f62dcd7"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0NjA4MA==", "bodyText": "For someone who is not really familiar with this, it makes more sense to name this enabled rather than disabled.", "url": "https://github.com/pravega/pravega/pull/5034#discussion_r468146080", "createdAt": "2020-08-10T19:55:41Z", "author": {"login": "andreipaduroiu"}, "path": "config/config.properties", "diffHunk": "@@ -106,6 +106,47 @@ pravegaservice.dataLog.impl.name=BOOKKEEPER\n # pravegaservice.storage.layout=ROLLING_STORAGE\n # NOTE: ChunkedSegmentStorage is an experimental feature. Its behavior and/or API should be expected to be in flux until fully released.\n \n+# Size of chunk in bytes above which it is no longer considered a small object.\n+# For small source objects, concat is not used.\n+# Valid values: non-negative long\n+# Default value: 0\n+# storage.concat.size.bytes.min=0\n+\n+# Size of chunk in bytes above which it is no longer considered for concat.\n+# Valid values: non-negative long\n+# Default value: 9223372036854775807\n+# storage.concat.size.bytes.max=9223372036854775807\n+\n+# Maximum size for the buffer used while copying of data from one chunk to other.\n+# Valid values: non-negative integer\n+# Default value: 1048576 (1 MB)\n+# storage.appends.buffer.size.bytes.max=1048576\n+\n+# Max number of indexed segments to keep in read cache.\n+# Valid values: non-negative integer\n+# Default value: 1024 (1 K)\n+# storage.readindex.segments.max=1024\n+\n+# Max number of indexed chunks to keep per segment in read cache.\n+# Valid values: non-negative integer\n+# Default value: 1024 (1 K)\n+# storage.readindex.chunksPerSegment.max=1024\n+\n+# Max number of indexed chunks to keep in cache.\n+# Valid values: non-negative integer\n+# Default value: 16384 (16 K)\n+# storage.readindex.chunks.max=16384\n+\n+# The maximum size of a single Segment Chunk in Storage for metadata segments.\n+# Valid values: non-negative long\n+# Default value: 4611686018427387903\n+# storage.metadata.rollover.size.bytes.max=4611686018427387903\n+\n+# Whether the append functionality is disabled.\n+# Valid values: true, false\n+# Default value: false\n+# storage.appends.disable=false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b50bf14d0fc64330f04b394761775e50f62dcd7"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7372a02dabf08bdb89ac3296fbff33248ae8e9e9", "author": {"user": {"login": "sachin-j-joshi", "name": "Sachin Jayant Joshi"}}, "url": "https://github.com/pravega/pravega/commit/7372a02dabf08bdb89ac3296fbff33248ae8e9e9", "committedDate": "2020-08-12T00:09:33Z", "message": "Issue 5033: (SLTS) - Use appends.enabled instead of appends.disabled. Address review comments.\n\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1OTkzMjk0", "url": "https://github.com/pravega/pravega/pull/5034#pullrequestreview-465993294", "createdAt": "2020-08-12T14:50:14Z", "commit": {"oid": "7372a02dabf08bdb89ac3296fbff33248ae8e9e9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4622b7bc713f00addd803a72c782f309f8bd7e77", "author": {"user": {"login": "andreipaduroiu", "name": "Andrei Paduroiu"}}, "url": "https://github.com/pravega/pravega/commit/4622b7bc713f00addd803a72c782f309f8bd7e77", "committedDate": "2020-08-12T14:50:20Z", "message": "Merge branch 'master' into issue-5033-init-ChunkedSegmentStorageConfig-from-file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df9de49b2f450215b2e7351012f342bfceb968a4", "author": {"user": {"login": "andreipaduroiu", "name": "Andrei Paduroiu"}}, "url": "https://github.com/pravega/pravega/commit/df9de49b2f450215b2e7351012f342bfceb968a4", "committedDate": "2020-08-12T17:49:54Z", "message": "Merge branch 'master' into issue-5033-init-ChunkedSegmentStorageConfig-from-file"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4017, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}