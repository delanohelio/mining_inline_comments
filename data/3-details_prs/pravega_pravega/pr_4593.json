{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMjU2Nzk4", "number": 4593, "title": "Issue 4591: Fixed ExtendedS3 exists()", "bodyText": "Change log description\nThis change uses getObjectMetadata instead of listObjects to implement exists.\nThis fixes the current problem where listObject based check behaves incorrectly when prefix instead of full path is provided as parameter.\nPurpose of the change\nFixes #4591\nWhat the code does\nThis change uses getObjectMetadata instead of listObjects to implement exists.\nHow to verify it\nUnit tests, System Tests and longevity tests should pass and should not show the incorrect behavior anymore.", "createdAt": "2020-03-03T23:56:50Z", "url": "https://github.com/pravega/pravega/pull/4593", "merged": true, "mergeCommit": {"oid": "61a4b380a2efbac5296e8daafb98ec7ffcba7dad"}, "closed": true, "closedAt": "2020-03-05T03:45:46Z", "author": {"login": "sachin-j-joshi"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKLkUYgFqTM2ODQxODE2OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKjMQDgFqTM2OTI3ODk3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NDE4MTY4", "url": "https://github.com/pravega/pravega/pull/4593#pullrequestreview-368418168", "createdAt": "2020-03-04T00:13:57Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NDkwMTk0", "url": "https://github.com/pravega/pravega/pull/4593#pullrequestreview-368490194", "createdAt": "2020-03-04T03:55:49Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwMzo1NTo0OVrOFxfRlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwMzo1NTo0OVrOFxfRlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQzNjk0OA==", "bodyText": "streamSegmentName is actually a stream segment name but do we actually create objects with such names? I thought   for each segment there will be objects like streamSegmentName$header or streamSegmentName$attributes. So if we simple check for presence of an object with streamSegmentName we always get object not found. Am i missing something here?", "url": "https://github.com/pravega/pravega/pull/4593#discussion_r387436948", "createdAt": "2020-03-04T03:55:49Z", "author": {"login": "medvedevigorek"}, "path": "bindings/src/main/java/io/pravega/storage/extendeds3/ExtendedS3Storage.java", "diffHunk": "@@ -263,18 +262,10 @@ private StreamSegmentInformation doGetStreamSegmentInfo(String streamSegmentName\n \n     private boolean doExists(String streamSegmentName) {\n         try {\n-            ListObjectsResult result = client.listObjects(config.getBucket(), config.getPrefix() + streamSegmentName);\n-            return !result.getObjects().isEmpty();\n+            S3ObjectMetadata result = client.getObjectMetadata(config.getBucket(),\n+                    config.getPrefix() + streamSegmentName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e92c2b52930c2dc9c0063bf4f9ce17682494f8b", "author": {"user": {"login": "sachin-j-joshi", "name": "Sachin Jayant Joshi"}}, "url": "https://github.com/pravega/pravega/commit/9e92c2b52930c2dc9c0063bf4f9ce17682494f8b", "committedDate": "2020-03-04T22:27:05Z", "message": "Issue 4591: Fix incorrect implementation of exists in ExtendedS3Storage.\n\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5b67c54f66372df28ac9409e2e8dd4b5fe6dc30", "author": {"user": {"login": "sachin-j-joshi", "name": "Sachin Jayant Joshi"}}, "url": "https://github.com/pravega/pravega/commit/f5b67c54f66372df28ac9409e2e8dd4b5fe6dc30", "committedDate": "2020-03-04T22:27:05Z", "message": "Issue 4591: Unit tests.\n\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "f5b67c54f66372df28ac9409e2e8dd4b5fe6dc30", "author": {"user": {"login": "sachin-j-joshi", "name": "Sachin Jayant Joshi"}}, "url": "https://github.com/pravega/pravega/commit/f5b67c54f66372df28ac9409e2e8dd4b5fe6dc30", "committedDate": "2020-03-04T22:27:05Z", "message": "Issue 4591: Unit tests.\n\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5Mjc4OTc2", "url": "https://github.com/pravega/pravega/pull/4593#pullrequestreview-369278976", "createdAt": "2020-03-05T03:45:23Z", "commit": {"oid": "f5b67c54f66372df28ac9409e2e8dd4b5fe6dc30"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3613, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}