{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY4OTY4NTcx", "number": 5079, "title": "Issue 5080: Adding character length checks for scope and stream name.", "bodyText": "Signed-off-by: Atharva Joshi Atharva.Joshi@dell.com\nChange log description\nCharacter length limit check is added for scope and stream name.\nPurpose of the change\nFixes #5080\nWhat the code does\nAdds a precondition check to the validateStreamName & validateUserStreamName methods in NameUtils.java class to ensure that stream and scope name do not exceed 255 characters.\nHow to verify it\nAttempt to add a scope or stream with a name having more than 255 characters.", "createdAt": "2020-08-17T17:27:55Z", "url": "https://github.com/pravega/pravega/pull/5079", "merged": true, "mergeCommit": {"oid": "3ef9564a05e7623ffffca489c6b63fed380e2e16"}, "closed": true, "closedAt": "2020-08-19T15:31:12Z", "author": {"login": "ldr7"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_4Ug0AFqTQ2ODgwMzkwNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAdYGEAFqTQ3MDU3NjczOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4ODAzOTA0", "url": "https://github.com/pravega/pravega/pull/5079#pullrequestreview-468803904", "createdAt": "2020-08-17T20:18:34Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMDoxODozNFrOHB5eBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMDoxODozNFrOHB5eBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc1MjE5OQ==", "bodyText": "How does this work with multi-byte unicode character strings?\nString#length() counts code units, not code points.\nWe may want to use String#codePointCount(int, int). This will allow languages in higher unicode planes to also use 255 characters (which can consume up to 4 bytes per character in UTF8 [or two code units in UTF16]).\nI believe the limiting factor in a scope name or stream name is the 1MB ZooKeeper ZNode size limit.\nWill 255 characters ever be too limiting? 255 characters is like 7 UUIDs.", "url": "https://github.com/pravega/pravega/pull/5079#discussion_r471752199", "createdAt": "2020-08-17T20:18:34Z", "author": {"login": "derekm"}, "path": "shared/protocol/src/main/java/io/pravega/shared/NameUtils.java", "diffHunk": "@@ -624,6 +624,7 @@ public static String getStreamForReaderGroup(String groupNameName) {\n      */\n     public static String validateUserStreamName(String name) {\n         Preconditions.checkNotNull(name);\n+        Preconditions.checkArgument(name.length()<256, \"Name must have less than 256 characters\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4ODQ2ODQ3", "url": "https://github.com/pravega/pravega/pull/5079#pullrequestreview-468846847", "createdAt": "2020-08-17T21:31:35Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTU1ODY5", "url": "https://github.com/pravega/pravega/pull/5079#pullrequestreview-469555869", "createdAt": "2020-08-18T15:13:00Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNToxMzowMFrOHCZSFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNToxMzowMFrOHCZSFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI3MzQzMA==", "bodyText": "seed with 0", "url": "https://github.com/pravega/pravega/pull/5079#discussion_r472273430", "createdAt": "2020-08-18T15:13:00Z", "author": {"login": "andreipaduroiu"}, "path": "shared/protocol/src/test/java/io/pravega/shared/NameUtilsTest.java", "diffHunk": "@@ -73,6 +74,23 @@ public void testStreamNameVerifier() {\n         NameUtils.validateStreamName(\"1.2.3\");\n     }\n \n+    @Test\n+    public void testStreamNameLimit() {\n+        int leftLimit = 48; // numeral '0'\n+        int rightLimit = 122; // letter 'z'\n+        int targetStringLength = 256;\n+        Random random = new Random();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTY2MDM2", "url": "https://github.com/pravega/pravega/pull/5079#pullrequestreview-469566036", "createdAt": "2020-08-18T15:23:48Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7508acf157c65cc79118b46478c64cbd7062b2a3", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/7508acf157c65cc79118b46478c64cbd7062b2a3", "committedDate": "2020-08-19T06:14:37Z", "message": "Pravega--1174\n\nSigned-off-by: Atharva Joshi <Atharva.Joshi@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86b5e29c836a433da7d2cf05bec5ccf902e7945f", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/86b5e29c836a433da7d2cf05bec5ccf902e7945f", "committedDate": "2020-08-19T06:14:37Z", "message": "Unit Test\n\nSigned-off-by: Atharva Joshi <Atharva.Joshi@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3722b4586b4044f6fcde0e3e42dd20fa817b357", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/a3722b4586b4044f6fcde0e3e42dd20fa817b357", "committedDate": "2020-08-19T06:14:37Z", "message": "formatting\n\nSigned-off-by: Atharva Joshi <Atharva.Joshi@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9993a44233e311a058a4490034921f1aa2c8ca77", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/9993a44233e311a058a4490034921f1aa2c8ca77", "committedDate": "2020-08-19T06:14:37Z", "message": "adding seed\n\nSigned-off-by: Atharva Joshi <Atharva.Joshi@dell.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "9993a44233e311a058a4490034921f1aa2c8ca77", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/9993a44233e311a058a4490034921f1aa2c8ca77", "committedDate": "2020-08-19T06:14:37Z", "message": "adding seed\n\nSigned-off-by: Atharva Joshi <Atharva.Joshi@dell.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNTc2NzM4", "url": "https://github.com/pravega/pravega/pull/5079#pullrequestreview-470576738", "createdAt": "2020-08-19T15:30:48Z", "commit": {"oid": "9993a44233e311a058a4490034921f1aa2c8ca77"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3818, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}