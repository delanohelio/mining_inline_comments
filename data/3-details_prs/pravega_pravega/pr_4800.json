{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwMTcyMzc3", "number": 4800, "title": "Issue 4783: Timebound check for completion of workflow to avoid log flooding", "bodyText": "Change log description\nAdd timeout to workflow completion check and throw timeout exception if the workflow is not finished within that time.\nPurpose of the change\nFixes #4783\nWhat the code does\nStreamMetadataTasks.java checkDone method was checked for in a loop indefinitely. Added timeout which will throw the timeout exception to the caller.\nControllerServiceImpl.java will throw DEADLINE_EXCEEDED response to the client upon receiving timeout exception.\nRetryHelper.java adds a new helper method that terminates the loop if timeout elapses.\nHow to verify it\nUnit tests added", "createdAt": "2020-05-19T14:52:22Z", "url": "https://github.com/pravega/pravega/pull/4800", "merged": true, "mergeCommit": {"oid": "53bb15dbee9cb6b08938cb21e68781001aed12ca"}, "closed": true, "closedAt": "2020-05-27T14:57:48Z", "author": {"login": "shiveshr"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcg1BryAH2gAyNDIwMTcyMzc3OjQ1YTQwYmQ1OWQyYjYwYmNkOTQ3ZDk5YmQyMjQwYjAyMDA3ZGQ5NWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclTccugH2gAyNDIwMTcyMzc3OmI0MDM1OGYyMzJkZTI4YjRjZTJmYTc0MmQ5Y2MyMTJjY2JkOTg2ZGU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "45a40bd59d2b60bcd947d99bd2240b02007dd95e", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/45a40bd59d2b60bcd947d99bd2240b02007dd95e", "committedDate": "2020-05-13T08:58:28Z", "message": "add timeout to workflow completion check\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bde4ac9926ddeafcb6ce5ef72a030c55f1812b56", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/bde4ac9926ddeafcb6ce5ef72a030c55f1812b56", "committedDate": "2020-05-14T06:01:35Z", "message": "issue 4783\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bf890698db300870f16fe6a1b0bf4006e8a5a25", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/5bf890698db300870f16fe6a1b0bf4006e8a5a25", "committedDate": "2020-05-19T14:48:41Z", "message": "unit tests\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "549adff26dcba722a52687f9ac22a02c9df8eaa0", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/549adff26dcba722a52687f9ac22a02c9df8eaa0", "committedDate": "2020-05-19T14:52:31Z", "message": "Merge branch 'master' into issue4783"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c52cc4315850d6f12f0c70ee026c64a8211774ba", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/c52cc4315850d6f12f0c70ee026c64a8211774ba", "committedDate": "2020-05-20T07:18:01Z", "message": "unit test for controller service impl\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6787795d4cc9ad213df5436e0d703e8d83607f2", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/e6787795d4cc9ad213df5436e0d703e8d83607f2", "committedDate": "2020-05-20T07:18:22Z", "message": "Merge branch 'issue4783' of https://github.com/shiveshr/pravega-1 into issue4783"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8485285f18819f6f6f4c23f0e1d3416245c6df23", "author": {"user": {"login": "shrids", "name": "Sandeep"}}, "url": "https://github.com/pravega/pravega/commit/8485285f18819f6f6f4c23f0e1d3416245c6df23", "committedDate": "2020-05-20T07:20:05Z", "message": "Merge branch 'master' into issue4783"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MjQzMTkw", "url": "https://github.com/pravega/pravega/pull/4800#pullrequestreview-415243190", "createdAt": "2020-05-20T11:35:12Z", "commit": {"oid": "8485285f18819f6f6f4c23f0e1d3416245c6df23"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMTozNToxM1rOGYHWHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMTozNToxM1rOGYHWHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkzOTM1Nw==", "bodyText": "Should this be configurable?", "url": "https://github.com/pravega/pravega/pull/4800#discussion_r427939357", "createdAt": "2020-05-20T11:35:13Z", "author": {"login": "shrids"}, "path": "controller/src/main/java/io/pravega/controller/task/Stream/StreamMetadataTasks.java", "diffHunk": "@@ -104,6 +106,7 @@\n \n     private static final TagLogger log = new TagLogger(LoggerFactory.getLogger(StreamMetadataTasks.class));\n     private static final long RETENTION_FREQUENCY_IN_MINUTES = Duration.ofMinutes(Config.MINIMUM_RETENTION_FREQUENCY_IN_MINUTES).toMillis();\n+    private static final long COMPLETION_TIMEOUT_MILLIS = Duration.ofMinutes(2).toMillis();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8485285f18819f6f6f4c23f0e1d3416245c6df23"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1Mjk0NDM1", "url": "https://github.com/pravega/pravega/pull/4800#pullrequestreview-415294435", "createdAt": "2020-05-20T12:46:18Z", "commit": {"oid": "8485285f18819f6f6f4c23f0e1d3416245c6df23"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1Mjk0OTI1", "url": "https://github.com/pravega/pravega/pull/4800#pullrequestreview-415294925", "createdAt": "2020-05-20T12:46:57Z", "commit": {"oid": "8485285f18819f6f6f4c23f0e1d3416245c6df23"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1NDg1MTMz", "url": "https://github.com/pravega/pravega/pull/4800#pullrequestreview-415485133", "createdAt": "2020-05-20T15:59:03Z", "commit": {"oid": "8485285f18819f6f6f4c23f0e1d3416245c6df23"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b51132b5839923074873ec59d774823a92ef8b13", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/b51132b5839923074873ec59d774823a92ef8b13", "committedDate": "2020-05-21T04:30:31Z", "message": "Merge branch 'master' into issue4783"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b936c3c84e11cc479a851e474a04771315b3b91a", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/b936c3c84e11cc479a851e474a04771315b3b91a", "committedDate": "2020-05-24T02:37:23Z", "message": "Merge branch 'master' into issue4783"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37614da10725e0172ff0d3b8bc2e9ea81795258a", "author": {"user": {"login": "ravisharda", "name": "Ravi Sharda"}}, "url": "https://github.com/pravega/pravega/commit/37614da10725e0172ff0d3b8bc2e9ea81795258a", "committedDate": "2020-05-27T06:16:33Z", "message": "Issue 4811: Replace JWT object-JSON mapping library (#4812)\n\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02dfc9c1b10fcda87423b1d5c716650cbe8f6fe3", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/02dfc9c1b10fcda87423b1d5c716650cbe8f6fe3", "committedDate": "2020-05-27T06:39:29Z", "message": "add timeout to workflow completion check\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6b246c3888b9cb1b072ef363799c91681016f7c", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/f6b246c3888b9cb1b072ef363799c91681016f7c", "committedDate": "2020-05-27T06:39:29Z", "message": "issue 4783\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "252d7107649f481bb32476e7f0846acc6fbfb346", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/252d7107649f481bb32476e7f0846acc6fbfb346", "committedDate": "2020-05-27T06:39:29Z", "message": "unit tests\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cef08a533654d6152b52b19bd62f5b6299a01c3", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/2cef08a533654d6152b52b19bd62f5b6299a01c3", "committedDate": "2020-05-27T06:39:29Z", "message": "unit test for controller service impl\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b40358f232de28b4ce2fa742d9cc212ccbd986de", "author": {"user": {"login": "shiveshr", "name": "shivesh ranjan"}}, "url": "https://github.com/pravega/pravega/commit/b40358f232de28b4ce2fa742d9cc212ccbd986de", "committedDate": "2020-05-27T06:40:33Z", "message": "Merge branch 'issue4783' of https://github.com/shiveshr/pravega-1 into issue4783"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3493, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}