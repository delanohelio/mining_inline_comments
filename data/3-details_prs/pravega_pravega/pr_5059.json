{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2NTQ0NzYw", "number": 5059, "title": "Issue 4162: add TLS mode system tests", "bodyText": "Change log description\n\nAdds option to the framework to run system tests with TLS enabled.\n\nPurpose of the change\nFixes #4162\nWhat the code does\nSystem tests use the Pravega deployment in distributed mode which provides the controller URI as tcp://controller-service-ip:9090 for gRPC. This change enables the system test to support a deployment with TLS mode on so that the controller URI can be changed to tls://controller-service-ip:9090. Later, more specific TLS test can be added and this change only adds support in the library.  All tests can take advantage of this mode by pointing to one of the two controller URI and specifying the boolean parameter when creating the service.\nBoth insecure and secure form of Pravega are deployed on K8s by the K8s pravega-operator, which is invoked by the system test framework. TLS mode is added via a configuration option that is passed to the operator as an environment variable in the configuration option.\nHow to verify it\nThis change is run through the build and test routine.\nUpdate:\nsuccessful_run.zip\nTLS_Success.txt\n\n2020-08-25 13:18:27,319 1035 [ControllerServiceStarter STARTING] INFO  i.p.c.s.ControllerServiceStarter - Controller serviceConfig = ControllerServiceConfigImpl(threadPoolSize=80, storeClientConfig=StoreClientConfigImpl(storeType=PravegaTable, zkClientConfig=Optional[ZKClientConfigImpl(connectionString: 172.26.31.4:2181, namespace: pravega/pravega, initialSleepInterval: 5000, maxRetries: 5, sessionTimeoutMs: 10000, secureConnectionToZooKeeper: false, trustStorePath is unspecified, trustStorePasswordPath is specified)]), hostMonitorConfig=io.pravega.controller.store.host.impl.HostMonitorConfigImpl@2a8d1aae, controllerClusterListenerEnabled=true, timeoutServiceConfig=TimeoutServiceConfig(maxLeaseValue=120000), tlsEnabledForSegmentStore=, eventProcessorConfig=Optional[ControllerEventProcessorConfigImpl(scopeName=_system, commitStreamName=_commitStream, commitStreamScalingPolicy=ScalingPolicy(scaleType=FIXED_NUM_SEGMENTS, targetRate=0, scaleFactor=0, minNumSegments=2), abortStreamName=_abortStream, abortStreamScalingPolicy=ScalingPolicy(scaleType=FIXED_NUM_SEGMENTS, targetRate=0, scaleFactor=0, minNumSegments=2), scaleStreamName=_requeststream, scaleStreamScalingPolicy=ScalingPolicy(scaleType=FIXED_NUM_SEGMENTS, targetRate=0, scaleFactor=0, minNumSegments=2), kvtStreamName=_kvTableStream, kvtStreamScalingPolicy=ScalingPolicy(scaleType=FIXED_NUM_SEGMENTS, targetRate=0, scaleFactor=0, minNumSegments=5), commitReaderGroupName=commitStreamReaders, commitReaderGroupSize=1, abortReaderGroupName=abortStreamReaders, abortReaderGroupSize=1, scaleReaderGroupName=scaleGroup, scaleReaderGroupSize=1, kvtReaderGroupName=kvtStreamReaders, kvtReaderGroupSize=1, commitCheckpointConfig=CheckpointConfig(type=Periodic, checkpointPeriod=CheckpointConfig.CheckpointPeriod(numEvents=10, numSeconds=10)), abortCheckpointConfig=CheckpointConfig(type=Periodic, checkpointPeriod=CheckpointConfig.CheckpointPeriod(numEvents=10, numSeconds=10)), scaleCheckpointConfig=CheckpointConfig(type=None, checkpointPeriod=null), rebalanceIntervalMillis=120000)], gRPCServerConfig=Optional[GRPCServerConfigImpl(port: 9090, publishedRPCHost: null, publishedRPCPort: 9090, authorizationEnabled: true, userPasswordFile is specified, tokenSigningKey is specified, accessTokenTTLInSeconds: 600, tlsEnabled: true, tlsCertFile is specified, tlsKeyFile is specified, tlsTrustStore is specified, replyWithStackTraceOnError: false, requestTracingEnabled: true)], restServerConfig=Optional[RESTServerConfigImpl(host: 0.0.0.0, port: 10080, tlsEnabled: true, keyFilePath is specified, keyFilePasswordPath is specified)], retentionFrequency=PT2M)\n2020-08-25 13:18:27,321 1037 [ControllerServiceStarter STARTING] INFO  i.p.c.s.ControllerServiceStarter -      REST server enabled = true\n2020-08-25 13:10:09,122 336  [main] INFO  i.p.s.server.host.ServiceStarter - Segment store configuration:\n2020-08-25 13:10:09,190 404  [main] INFO  i.p.s.server.host.ServiceStarter - controller.security.tls.server.certificate.location = /etc/secret-volume/tls.crt", "createdAt": "2020-08-12T06:19:38Z", "url": "https://github.com/pravega/pravega/pull/5059", "merged": true, "mergeCommit": {"oid": "d6b72492d3f50a1f02abc5dbd1953ef7d10636f4"}, "closed": true, "closedAt": "2020-09-08T12:50:21Z", "author": {"login": "ravibeta"}, "timelineItems": {"totalCount": 35, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-FKt0gH2gAyNDY2NTQ0NzYwOjZiMmRlZWFiZGUwZDM0NjhkN2JhMzRlZjg2MWZlNWM1YjBmMDEzNmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdGz02eAH2gAyNDY2NTQ0NzYwOjY0OTk3ZTU0MzEzNTVlOWRiM2NhYjg0MjQ1NWRhZmIxZmEyMjY4ZDc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6b2deeabde0d3468d7ba34ef861fe5c5b0f0136a", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/6b2deeabde0d3468d7ba34ef861fe5c5b0f0136a", "committedDate": "2020-08-12T06:10:37Z", "message": "add TLS mode system tests\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23398ce97bf5a57afeac108e70bf6c59cd8009d0", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/23398ce97bf5a57afeac108e70bf6c59cd8009d0", "committedDate": "2020-08-12T17:29:43Z", "message": "add alternate cert location\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b80f4b6f0e340a1ada1f180a0d616fbb3ccddb31", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/b80f4b6f0e340a1ada1f180a0d616fbb3ccddb31", "committedDate": "2020-08-17T03:06:28Z", "message": "Squashed commit of the following:\n\ncommit 23bae0372e9a5302837df71b7eeb676ae09cd710\nAuthor: Ravi Rajamani <ravi.rajamani@emc.com>\nDate:   Sun Aug 16 19:37:00 2020 -0700\n\n    add tls secret\n\n    Signed-off-by: Ravi Rajamani <ravi.rajamani@emc.com>\n\ncommit 35a92ef5e652fdcde6da4d2b694ca341d7482ae9\nAuthor: Ravi Rajamani <ravi.rajamani@emc.com>\nDate:   Sun Aug 16 04:24:16 2020 -0700\n\n    add cert\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "494533acdb2c7022c2847b6ae138c54b2d3d2fc2", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/494533acdb2c7022c2847b6ae138c54b2d3d2fc2", "committedDate": "2020-08-17T03:07:55Z", "message": "Merge branch 'master' into issue-4162-tls-mode-system-tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MTUxMjg3", "url": "https://github.com/pravega/pravega/pull/5059#pullrequestreview-468151287", "createdAt": "2020-08-17T03:58:48Z", "commit": {"oid": "494533acdb2c7022c2847b6ae138c54b2d3d2fc2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cb0d11d3cff70df872167232bebb681c8fa46bc", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/9cb0d11d3cff70df872167232bebb681c8fa46bc", "committedDate": "2020-08-17T05:31:45Z", "message": "add header\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9585c2be21eb4ca00c3445e0cacbb3f649ccfdca", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/9585c2be21eb4ca00c3445e0cacbb3f649ccfdca", "committedDate": "2020-08-19T13:57:06Z", "message": "add checkstylemain\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e89efccdf00999b665377b05b629cdba867c3b9e", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/e89efccdf00999b665377b05b629cdba867c3b9e", "committedDate": "2020-08-20T14:28:57Z", "message": "add env var for operator\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c1c91a5c23af201848685ea52f528da14a4583e", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/9c1c91a5c23af201848685ea52f528da14a4583e", "committedDate": "2020-08-20T14:30:55Z", "message": "Merge branch 'master' into issue-4162-tls-mode-system-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "346e7cc2fc7f6dcb465657d5c70ac4b558350887", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/346e7cc2fc7f6dcb465657d5c70ac4b558350887", "committedDate": "2020-08-20T17:52:30Z", "message": "pass tlsStaticSpec to pravega-operator\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ff8cdd2d524dc19eff00cf3b25de5a67a5b430c", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/9ff8cdd2d524dc19eff00cf3b25de5a67a5b430c", "committedDate": "2020-08-21T00:52:42Z", "message": "pass tlsSpec\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849", "author": {"user": {"login": "shrids", "name": "Sandeep"}}, "url": "https://github.com/pravega/pravega/commit/852739281fbab4ed0c1321a368ac8bf3f11fc849", "committedDate": "2020-08-21T04:15:29Z", "message": "Merge branch 'master' into issue-4162-tls-mode-system-tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMTIyMjIw", "url": "https://github.com/pravega/pravega/pull/5059#pullrequestreview-473122220", "createdAt": "2020-08-24T05:05:58Z", "commit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQwNTowNTo1OFrOHFUvtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQwNjo1ODo0NlrOHFW5bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM0NDgyMw==", "bodyText": "This flag is used for enabling both TLS and AUTH in this PR. I suppose it should be called something like TLS_AND_AUTH_ENABLED.", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475344823", "createdAt": "2020-08-24T05:05:58Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/Utils.java", "diffHunk": "@@ -48,9 +48,15 @@\n     public static final int ALTERNATIVE_REST_PORT = 9094;\n     public static final TestExecutorFactory.TestExecutorType EXECUTOR_TYPE = TestExecutorFactory.getTestExecutionType();\n     public static final boolean AUTH_ENABLED = isAuthEnabled();\n+    public static final boolean TLS_ENABLED = isTLSEnabled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM0NjMzMA==", "bodyText": "Using both of these flags - a static flag and a an input argument - looks redundant and somewhat confusing too. Why don't you use just one of these?", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475346330", "createdAt": "2020-08-24T05:12:04Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/Utils.java", "diffHunk": "@@ -149,18 +162,32 @@ public static Service createPravegaSegmentStoreService(final URI zkUri, final UR\n     }\n \n     public static ClientConfig buildClientConfig(URI controllerUri) {\n-        if (!AUTH_ENABLED) {\n-            log.debug(\"Generating config with auth disabled.\");\n-            return ClientConfig.builder().controllerURI(controllerUri).build();\n-        } else {\n+           return buildClientConfig(controllerUri, false);\n+    }\n+\n+    public static ClientConfig buildClientConfig(URI controllerUri, boolean enableTls) {\n+        if (TLS_ENABLED || enableTls) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM0NzAwMA==", "bodyText": "The name of this variable doesn't reflect the intent well. Could you please rename it? What does it represent?", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475347000", "createdAt": "2020-08-24T05:14:35Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -79,6 +89,8 @@\n     static final String CUSTOM_RESOURCE_KIND_PRAVEGA = \"PravegaCluster\";\n     static final String PRAVEGA_CONTROLLER_LABEL = \"pravega-controller\";\n     static final String PRAVEGA_SEGMENTSTORE_LABEL = \"pravega-segmentstore\";\n+    static final String PRAVEGA_CONTROLLER_CONFIG_MAP = \"pravega-pravega-controller\";\n+    static final String SELFSIGNED_CERT_TLS = \"selfsigned-cert-tls\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM0NzM0NQ==", "bodyText": "Should it be called WEBHOOK_CERT_GENERATE to reflect the intent better?", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475347345", "createdAt": "2020-08-24T05:15:39Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -91,6 +103,7 @@\n     private static final String TIER2_NFS = \"nfs\";\n     private static final String TIER2_TYPE = System.getProperty(\"tier2Type\", TIER2_NFS);\n     private static final boolean IS_OPERATOR_VERSION_ABOVE_040 = isOperatorVersionAbove040();\n+    private static final String WEBHOOK_GENERATE = \"webhookCert.generate\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM0NzUyNA==", "bodyText": "Please use a single flag only. Since this a class member, ideally it shouldn't depend on a static member.", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475347524", "createdAt": "2020-08-24T05:16:29Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -106,13 +119,19 @@ public String getID() {\n     }\n \n     CompletableFuture<Object> deployPravegaUsingOperator(final URI zkUri, int controllerCount, int segmentStoreCount, int bookieCount, ImmutableMap<String, String> props) {\n-    return k8sClient.createCRD(getPravegaCRD())\n+        return deployPravegaUsingOperator(zkUri, controllerCount, segmentStoreCount, bookieCount, props, false);\n+    }\n+\n+    CompletableFuture<Object> deployPravegaUsingOperator(final URI zkUri, int controllerCount, int segmentStoreCount, int bookieCount, ImmutableMap<String, String> props, boolean enableTls) {\n+\n+    return registerTLSSecret()\n+                        .thenCompose(v -> k8sClient.createCRD(getPravegaCRD()))\n                         .thenCompose(v -> k8sClient.createRole(NAMESPACE, getPravegaOperatorRole()))\n                         .thenCompose(v -> k8sClient.createClusterRole(getPravegaOperatorClusterRole()))\n                         .thenCompose(v -> k8sClient.createRoleBinding(NAMESPACE, getPravegaOperatorRoleBinding()))\n                         .thenCompose(v -> k8sClient.createClusterRoleBinding(getPravegaOperatorClusterRoleBinding()))\n                         //deploy pravega operator.\n-                        .thenCompose(v -> k8sClient.createDeployment(NAMESPACE, getPravegaOperatorDeployment()))\n+                        .thenCompose(v -> k8sClient.createDeployment(NAMESPACE, getPravegaOperatorDeployment(enableTls || Utils.TLS_ENABLED)))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM0Nzk2OA==", "bodyText": "A better name for the SELFSIGNED_CERT_TLS variable be CONTROLLER_SECRET and  or a SEGMENTSTORE_SECRET in my view. If you want to use the same, just a slightly more abstract SERVER_SECRET'd do.", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475347968", "createdAt": "2020-08-24T05:18:18Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -166,11 +185,20 @@ public String getID() {\n                 .put(\"tier2\", tier2Spec())\n                 .build();\n \n+        final Map<String, Object> staticTlsSpec = ImmutableMap.<String, Object>builder()\n+                .put(\"controllerSecret\", SELFSIGNED_CERT_TLS)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 100}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3NjI2MQ==", "bodyText": "The debug message is misleading, as both Auth and TLS are disabled.", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475376261", "createdAt": "2020-08-24T06:49:26Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/Utils.java", "diffHunk": "@@ -149,18 +162,32 @@ public static Service createPravegaSegmentStoreService(final URI zkUri, final UR\n     }\n \n     public static ClientConfig buildClientConfig(URI controllerUri) {\n-        if (!AUTH_ENABLED) {\n-            log.debug(\"Generating config with auth disabled.\");\n-            return ClientConfig.builder().controllerURI(controllerUri).build();\n-        } else {\n+           return buildClientConfig(controllerUri, false);\n+    }\n+\n+    public static ClientConfig buildClientConfig(URI controllerUri, boolean enableTls) {\n+        if (TLS_ENABLED || enableTls) {\n+            String certPath = enableTls ? \"/opt/pravega/conf/server-cert.crt\" : DEFAULT_TRUSTSTORE_PATH;\n+            log.debug(\"Generating config with tls enabled.\");\n+            return ClientConfig.builder()\n+                               // TLS-related client-side configuration\n+                               .trustStore(certPath)\n+                               .validateHostName(VALIDATE_HOSTNAME)\n+                               // auth\n+                               .credentials(new DefaultCredentials(\"1111_aaaa\", \"admin\"))\n+                               .controllerURI(controllerUri)\n+                               .build();\n+        } else if (AUTH_ENABLED) {\n             log.debug(\"Generating config with auth enabled.\");\n             return ClientConfig.builder()\n                                // auth\n                                .credentials(new DefaultCredentials(\"1111_aaaa\", \"admin\"))\n                                .controllerURI(controllerUri)\n                                .build();\n+        } else {\n+            log.debug(\"Generating config with auth disabled.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3NzA5NA==", "bodyText": "The exception itself is eaten up here. This should be throwing an exception or handle it so that the flow below doesn't execute.", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475377094", "createdAt": "2020-08-24T06:51:25Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -317,6 +345,36 @@ private V1beta1CustomResourceDefinition getPravegaCRD() {\n \n     }\n \n+    private static V1Secret getTLSSecret() {\n+        String data = \"\";\n+        String yamlInputPath = \"secret.yaml\";\n+        try (InputStream inputStream = Utils.class.getClassLoader().getResourceAsStream(yamlInputPath)) {\n+            data = IOUtils.toString(inputStream, StandardCharsets.UTF_8);\n+        } catch (IOException e) {\n+            log.error(\"Could not read from: {}, data:{}\", yamlInputPath, data);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 161}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3ODI2Nw==", "bodyText": "If the server cert is signed by a CA, using the CA's certificate as the truststore is better as that'd reflect real-world scenarios better.", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475378267", "createdAt": "2020-08-24T06:54:27Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -428,6 +496,24 @@ private V1Deployment getPravegaOperatorDeployment() {\n                                         .build();\n     }\n \n+    public CompletableFuture<V1ConfigMap> setupTLS() {\n+            V1ConfigMap configMap = Futures.getThrowingException(k8sClient.getConfigMap(PRAVEGA_CONTROLLER_CONFIG_MAP, NAMESPACE));\n+            return k8sClient.deleteConfigMap(PRAVEGA_CONTROLLER_CONFIG_MAP, NAMESPACE)\n+                        .thenCompose(v -> k8sClient.createConfigMap(NAMESPACE, addDefaultTlsConfiguration(configMap)));\n+    }\n+\n+    private V1ConfigMap addDefaultTlsConfiguration(V1ConfigMap configMap) {\n+            return configMap\n+                        .putDataItem(\"TLS_ENABLED\", \"true\")\n+                        .putDataItem(\"TLS_KEY_FILE\", \"/opt/pravega/conf/server-key.key\")\n+                        .putDataItem(\"TLS_CERT_FILE\", \"/opt/pravega/conf/server-cert.crt\")\n+                        .putDataItem(\"TLS_TRUST_STORE\", \"/opt/pravega/conf/server-cert.crt\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 231}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3OTMwNQ==", "bodyText": "This is old property. Use controller.security.tls.server.keyStore.location instead.", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475379305", "createdAt": "2020-08-24T06:56:53Z", "author": {"login": "ravisharda"}, "path": "test/system/src/test/resources/pravega_withTLS.properties", "diffHunk": "@@ -0,0 +1,41 @@\n+# Copyright (c) Dell Inc., or its subsidiaries. All Rights Reserved.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#    http://www.apache.org/licenses/LICENSE-2.0\n+autoScale.mute.time.seconds=120\n+autoScale.cooldown.time.seconds=120\n+autoScale.cache.expiry.seconds=120\n+autoScale.cache.cleanUp.interval.seconds=120\n+curator-default-session-timeout=10000\n+bookkeeper.ack.quorum.size=3\n+controller.transaction.lease.count.max=120000\n+controller.retention.frequency.minutes=2\n+log.level=DEBUG\n+hdfs.replaceDataNodesOnFailure.enable=false\n+controller.security.auth.enable=true\n+controller.security.pwdAuthHandler.accountsDb.location=/opt/pravega/conf/passwd\n+controller.security.auth.delegationToken.signingKey.basis=secret\n+autoscale.controller.connect.security.auth.enable=true\n+autoscale.security.auth.token.signingKey.basis=secret\n+#4GB of cache.\n+pravegaservice.cache.size.max=4294967296\n+#4GB of cache + a buffer for whatever else Netty might need it for.\n+io.netty.maxDirectMemory=5368709120\n+pravega.client.auth.token=YWRtaW46MTExMV9hYWFh\n+pravega.client.auth.method=Basic\n+# tls.crt \n+controller.security.tls.enable=true\n+controller.security.tls.trustStore.location=/etc/secret-volume/tls.crt\n+controller.security.tls.server.certificate.location=/etc/secret-volume/tls.crt\n+controller.security.tls.server.privateKey.location=/etc/secret-volume/tls.key\n+controller.security.tls.server.keyStore.location=/opt/pravega/conf/server.keystore.jks\n+controller.security.tls.server.keyStore.pwd.location=/opt/pravega/conf/server.keystore.jks.passwd\n+controller.rest.tlsKeyStoreFile=/opt/pravega/conf/server.keystore.jks", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM3OTUyNQ==", "bodyText": "This too is an old property. Use controller.security.tls.server.keyStore.pwd.location instead.", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475379525", "createdAt": "2020-08-24T06:57:27Z", "author": {"login": "ravisharda"}, "path": "test/system/src/test/resources/pravega_withTLS.properties", "diffHunk": "@@ -0,0 +1,41 @@\n+# Copyright (c) Dell Inc., or its subsidiaries. All Rights Reserved.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#    http://www.apache.org/licenses/LICENSE-2.0\n+autoScale.mute.time.seconds=120\n+autoScale.cooldown.time.seconds=120\n+autoScale.cache.expiry.seconds=120\n+autoScale.cache.cleanUp.interval.seconds=120\n+curator-default-session-timeout=10000\n+bookkeeper.ack.quorum.size=3\n+controller.transaction.lease.count.max=120000\n+controller.retention.frequency.minutes=2\n+log.level=DEBUG\n+hdfs.replaceDataNodesOnFailure.enable=false\n+controller.security.auth.enable=true\n+controller.security.pwdAuthHandler.accountsDb.location=/opt/pravega/conf/passwd\n+controller.security.auth.delegationToken.signingKey.basis=secret\n+autoscale.controller.connect.security.auth.enable=true\n+autoscale.security.auth.token.signingKey.basis=secret\n+#4GB of cache.\n+pravegaservice.cache.size.max=4294967296\n+#4GB of cache + a buffer for whatever else Netty might need it for.\n+io.netty.maxDirectMemory=5368709120\n+pravega.client.auth.token=YWRtaW46MTExMV9hYWFh\n+pravega.client.auth.method=Basic\n+# tls.crt \n+controller.security.tls.enable=true\n+controller.security.tls.trustStore.location=/etc/secret-volume/tls.crt\n+controller.security.tls.server.certificate.location=/etc/secret-volume/tls.crt\n+controller.security.tls.server.privateKey.location=/etc/secret-volume/tls.key\n+controller.security.tls.server.keyStore.location=/opt/pravega/conf/server.keystore.jks\n+controller.security.tls.server.keyStore.pwd.location=/opt/pravega/conf/server.keystore.jks.passwd\n+controller.rest.tlsKeyStoreFile=/opt/pravega/conf/server.keystore.jks\n+controller.rest.tlsKeyStorePasswordFile=/opt/pravega/conf/server.keystore.jks.passwd", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM4MDA3OA==", "bodyText": "Properties from lime 38 to 41 are also old properties. Replace them with the new properties. The mapping between old and new properties can be found here: https://github.com/pravega/pravega/wiki/Configuration-Name-Changes.", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r475380078", "createdAt": "2020-08-24T06:58:46Z", "author": {"login": "ravisharda"}, "path": "test/system/src/test/resources/pravega_withTLS.properties", "diffHunk": "@@ -0,0 +1,41 @@\n+# Copyright (c) Dell Inc., or its subsidiaries. All Rights Reserved.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#    http://www.apache.org/licenses/LICENSE-2.0\n+autoScale.mute.time.seconds=120\n+autoScale.cooldown.time.seconds=120\n+autoScale.cache.expiry.seconds=120\n+autoScale.cache.cleanUp.interval.seconds=120\n+curator-default-session-timeout=10000\n+bookkeeper.ack.quorum.size=3\n+controller.transaction.lease.count.max=120000\n+controller.retention.frequency.minutes=2\n+log.level=DEBUG\n+hdfs.replaceDataNodesOnFailure.enable=false\n+controller.security.auth.enable=true\n+controller.security.pwdAuthHandler.accountsDb.location=/opt/pravega/conf/passwd\n+controller.security.auth.delegationToken.signingKey.basis=secret\n+autoscale.controller.connect.security.auth.enable=true\n+autoscale.security.auth.token.signingKey.basis=secret\n+#4GB of cache.\n+pravegaservice.cache.size.max=4294967296\n+#4GB of cache + a buffer for whatever else Netty might need it for.\n+io.netty.maxDirectMemory=5368709120\n+pravega.client.auth.token=YWRtaW46MTExMV9hYWFh\n+pravega.client.auth.method=Basic\n+# tls.crt \n+controller.security.tls.enable=true\n+controller.security.tls.trustStore.location=/etc/secret-volume/tls.crt\n+controller.security.tls.server.certificate.location=/etc/secret-volume/tls.crt\n+controller.security.tls.server.privateKey.location=/etc/secret-volume/tls.key\n+controller.security.tls.server.keyStore.location=/opt/pravega/conf/server.keystore.jks\n+controller.security.tls.server.keyStore.pwd.location=/opt/pravega/conf/server.keystore.jks.passwd\n+controller.rest.tlsKeyStoreFile=/opt/pravega/conf/server.keystore.jks\n+controller.rest.tlsKeyStorePasswordFile=/opt/pravega/conf/server.keystore.jks.passwd\n+pravegaservice.certFile=/etc/secret-volume/tls.crt", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b1a4221ca0e44c8b91a236bdb9bb5a31b428398", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/6b1a4221ca0e44c8b91a236bdb9bb5a31b428398", "committedDate": "2020-08-24T07:35:28Z", "message": "code review comments\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "039846447ab199c27d94fbafd378ade03a947c85", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/039846447ab199c27d94fbafd378ade03a947c85", "committedDate": "2020-08-24T07:42:58Z", "message": "remove unused code\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdcec78a38fa97bda75e05be40bd4c4851e28ca8", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/bdcec78a38fa97bda75e05be40bd4c4851e28ca8", "committedDate": "2020-08-24T08:10:23Z", "message": "checkstylemain\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MTE1Nzk4", "url": "https://github.com/pravega/pravega/pull/5059#pullrequestreview-475115798", "createdAt": "2020-08-26T02:55:46Z", "commit": {"oid": "bdcec78a38fa97bda75e05be40bd4c4851e28ca8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwMjo1NTo0NlrOHG563A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQwMjo1NTo0NlrOHG563A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzAwMjQ2MA==", "bodyText": "Please modify this log message too to say both TLS and auth are enabled", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r477002460", "createdAt": "2020-08-26T02:55:46Z", "author": {"login": "ravisharda"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/Utils.java", "diffHunk": "@@ -149,18 +157,27 @@ public static Service createPravegaSegmentStoreService(final URI zkUri, final UR\n     }\n \n     public static ClientConfig buildClientConfig(URI controllerUri) {\n-        if (!AUTH_ENABLED) {\n-            log.debug(\"Generating config with auth disabled.\");\n-            return ClientConfig.builder().controllerURI(controllerUri).build();\n-        } else {\n+        if (TLS_AND_AUTH_ENABLED) {\n+            log.debug(\"Generating config with tls enabled.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bdcec78a38fa97bda75e05be40bd4c4851e28ca8"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a3cad6cdfdd5528a60aeba4ad9439b251298429", "author": {"user": {"login": "ravisharda", "name": "Ravi Sharda"}}, "url": "https://github.com/pravega/pravega/commit/1a3cad6cdfdd5528a60aeba4ad9439b251298429", "committedDate": "2020-08-26T03:02:40Z", "message": "Merge branch 'master' into issue-4162-tls-mode-system-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "472d3449b3a698bb3d7b77d8c2227c811ec9152a", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/472d3449b3a698bb3d7b77d8c2227c811ec9152a", "committedDate": "2020-08-26T02:57:07Z", "message": "exclude boringssl in favor of openssl\nadd logging\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MTIyODk1", "url": "https://github.com/pravega/pravega/pull/5059#pullrequestreview-475122895", "createdAt": "2020-08-26T03:19:48Z", "commit": {"oid": "1a3cad6cdfdd5528a60aeba4ad9439b251298429"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99ccda1624532b9769052287ec10100501e9a111", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/99ccda1624532b9769052287ec10100501e9a111", "committedDate": "2020-08-26T03:50:04Z", "message": "keep build as earlier to reduce surface area\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddc4fa4b84ab7cfeac154ab91f4ac7390a2c858d", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/ddc4fa4b84ab7cfeac154ab91f4ac7390a2c858d", "committedDate": "2020-08-26T13:59:13Z", "message": "set tls default off\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81fced48dcf531d631dd52efd8058af9ccf82562", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/81fced48dcf531d631dd52efd8058af9ccf82562", "committedDate": "2020-08-30T11:54:32Z", "message": "Merge branch 'master' into issue-4162-tls-mode-system-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a736fa861cf3e1ce6aee37eddefe87d4e883e77", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/4a736fa861cf3e1ce6aee37eddefe87d4e883e77", "committedDate": "2020-09-02T02:20:37Z", "message": "keep earlier properties\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e587416e462e0dd808949278da9599184d89f06", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/3e587416e462e0dd808949278da9599184d89f06", "committedDate": "2020-09-02T02:23:49Z", "message": "Merge branch 'master' into issue-4162-tls-mode-system-tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgwNDcwNTk3", "url": "https://github.com/pravega/pravega/pull/5059#pullrequestreview-480470597", "createdAt": "2020-09-02T04:14:24Z", "commit": {"oid": "3e587416e462e0dd808949278da9599184d89f06"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNDoxNDoyNFrOHLVlNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwNDoxNDoyNFrOHLVlNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTY0OTk3NQ==", "bodyText": "@ravisharda, is it possible to have only TLS enabled why AUTH is disabled? It looks a bit odd that both must be enabled or at least TLS cannot be enabled alone. I was told that there is something in the current design that forces so, could you please clarify a bit? Thanks", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r481649975", "createdAt": "2020-09-02T04:14:24Z", "author": {"login": "medvedevigorek"}, "path": "test/system/src/main/java/io/pravega/test/system/framework/Utils.java", "diffHunk": "@@ -149,18 +157,27 @@ public static Service createPravegaSegmentStoreService(final URI zkUri, final UR\n     }\n \n     public static ClientConfig buildClientConfig(URI controllerUri) {\n-        if (!AUTH_ENABLED) {\n-            log.debug(\"Generating config with auth disabled.\");\n-            return ClientConfig.builder().controllerURI(controllerUri).build();\n-        } else {\n+        if (TLS_AND_AUTH_ENABLED) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e587416e462e0dd808949278da9599184d89f06"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5269188f7f35e2d781214f97d9a0aba47d386e31", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/5269188f7f35e2d781214f97d9a0aba47d386e31", "committedDate": "2020-09-08T03:11:27Z", "message": "overcome No-subject-alternative-DNS-name-matching CertificateException\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd0a2e84419ea1b92ece0078f20d0298cd8e5b1c", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/fd0a2e84419ea1b92ece0078f20d0298cd8e5b1c", "committedDate": "2020-09-08T04:00:28Z", "message": "Merge branch 'master' into issue-4162-tls-mode-system-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dbe824cd6561ca13562408bc3ddda51adf01157", "author": {"user": {"login": "ravisharda", "name": "Ravi Sharda"}}, "url": "https://github.com/pravega/pravega/commit/6dbe824cd6561ca13562408bc3ddda51adf01157", "committedDate": "2020-09-08T04:38:54Z", "message": "Merge branch 'master' into issue-4162-tls-mode-system-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1087888555bcd426ee47ea8816e73773132f1034", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/1087888555bcd426ee47ea8816e73773132f1034", "committedDate": "2020-09-08T08:14:32Z", "message": "use newer properties\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c3f08bad09b3c5bfd8bd76124c67c45d5d39a54f", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/c3f08bad09b3c5bfd8bd76124c67c45d5d39a54f", "committedDate": "2020-09-08T08:18:19Z", "message": "use mixedCase for newer properties\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzOTIxNjQ3", "url": "https://github.com/pravega/pravega/pull/5059#pullrequestreview-483921647", "createdAt": "2020-09-08T08:44:07Z", "commit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwODo0NDowN1rOHOS9hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQwODo0NDowN1rOHOS9hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDc1Mjc3NA==", "bodyText": "@ravibeta config lines from lies 36 to 39 still use old names, but the comment is marked resolved. Can you please fix them?\n\n  \n    \n      pravega/test/system/src/test/resources/pravega_withTLS.properties\n    \n    \n        Lines 38 to 41\n      in\n      8527392\n    \n    \n    \n    \n\n        \n          \n           pravegaservice.certFile=/etc/secret-volume/tls.crt \n        \n\n        \n          \n           pravegaservice.enableTls=false \n        \n\n        \n          \n           pravegaservice.keyFile=/etc/secret-volume/tls.key \n        \n\n        \n          \n           pravegaservice.secureZK=false", "url": "https://github.com/pravega/pravega/pull/5059#discussion_r484752774", "createdAt": "2020-09-08T08:44:07Z", "author": {"login": "ravisharda"}, "path": "test/system/src/test/resources/pravega_withTLS.properties", "diffHunk": "@@ -0,0 +1,41 @@\n+# Copyright (c) Dell Inc., or its subsidiaries. All Rights Reserved.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#    http://www.apache.org/licenses/LICENSE-2.0\n+autoScale.mute.time.seconds=120\n+autoScale.cooldown.time.seconds=120\n+autoScale.cache.expiry.seconds=120\n+autoScale.cache.cleanUp.interval.seconds=120\n+curator-default-session-timeout=10000\n+bookkeeper.ack.quorum.size=3\n+controller.transaction.lease.count.max=120000\n+controller.retention.frequency.minutes=2\n+log.level=DEBUG\n+hdfs.replaceDataNodesOnFailure.enable=false\n+controller.security.auth.enable=true\n+controller.security.pwdAuthHandler.accountsDb.location=/opt/pravega/conf/passwd\n+controller.security.auth.delegationToken.signingKey.basis=secret\n+autoscale.controller.connect.security.auth.enable=true\n+autoscale.security.auth.token.signingKey.basis=secret\n+#4GB of cache.\n+pravegaservice.cache.size.max=4294967296\n+#4GB of cache + a buffer for whatever else Netty might need it for.\n+io.netty.maxDirectMemory=5368709120\n+pravega.client.auth.token=YWRtaW46MTExMV9hYWFh\n+pravega.client.auth.method=Basic\n+# tls.crt \n+controller.security.tls.enable=true\n+controller.security.tls.trustStore.location=/etc/secret-volume/tls.crt\n+controller.security.tls.server.certificate.location=/etc/secret-volume/tls.crt\n+controller.security.tls.server.privateKey.location=/etc/secret-volume/tls.key\n+controller.security.tls.server.keyStore.location=/opt/pravega/conf/server.keystore.jks\n+controller.security.tls.server.keyStore.pwd.location=/opt/pravega/conf/server.keystore.jks.passwd\n+controller.rest.tlsKeyStoreFile=/opt/pravega/conf/server.keystore.jks\n+controller.rest.tlsKeyStorePasswordFile=/opt/pravega/conf/server.keystore.jks.passwd\n+pravegaservice.certFile=/etc/secret-volume/tls.crt", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTM4MDA3OA=="}, "originalCommit": {"oid": "852739281fbab4ed0c1321a368ac8bf3f11fc849"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgzOTM3MTQ1", "url": "https://github.com/pravega/pravega/pull/5059#pullrequestreview-483937145", "createdAt": "2020-09-08T09:03:21Z", "commit": {"oid": "c3f08bad09b3c5bfd8bd76124c67c45d5d39a54f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46a6b71fa41e14cf23f9b0a1df8cac7c4c965c44", "author": {"user": {"login": "ravisharda", "name": "Ravi Sharda"}}, "url": "https://github.com/pravega/pravega/commit/46a6b71fa41e14cf23f9b0a1df8cac7c4c965c44", "committedDate": "2020-09-08T09:03:40Z", "message": "Merge branch 'master' into issue-4162-tls-mode-system-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64997e5431355e9db3cab842455dafb1fa2268d7", "author": {"user": {"login": "ravibeta", "name": "Ravi Rajamani"}}, "url": "https://github.com/pravega/pravega/commit/64997e5431355e9db3cab842455dafb1fa2268d7", "committedDate": "2020-09-08T08:53:29Z", "message": "add grpc properties\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4029, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}