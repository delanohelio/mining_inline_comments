{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNDI4MDEy", "number": 4906, "title": "Issue 4893: Add Scopes Metrics", "bodyText": "Change log description\nAdds metrics for created and deleted scopes.\nPurpose of the change\nFixes #4893.\nWhat the code does\nThis PR extends StreamMetrics class to also take care of reporting a couple of new metrics related to scopes creation and deletion.\nHow to verify it\nNew test checking that the new metrics (and some former ones) are reported.", "createdAt": "2020-06-26T07:29:48Z", "url": "https://github.com/pravega/pravega/pull/4906", "merged": true, "mergeCommit": {"oid": "993a948a0847785d2a69cfc6d0e2743d42cabeca"}, "closed": true, "closedAt": "2020-07-01T13:15:30Z", "author": {"login": "RaulGracia"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuy36BgH2gAyNDQwNDI4MDEyOmMyNmQwNjFmMWM5Mjk5MTc4N2E3NDZmOWIwMTczNDMzMTI5ODA4Mzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwqEJDgFqTQ0MDg1NzQyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c26d061f1c92991787a746f9b017343312980838", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/c26d061f1c92991787a746f9b017343312980838", "committedDate": "2020-06-25T18:22:55Z", "message": "Initial commit.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39c6427de296f69b9fcb3963a0a5a73983820e68", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/39c6427de296f69b9fcb3963a0a5a73983820e68", "committedDate": "2020-06-25T18:41:36Z", "message": "Fixed methods to report scope metrics.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a14464590b2dda294551bfe0b7f2f7b0b8fb438b", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/a14464590b2dda294551bfe0b7f2f7b0b8fb438b", "committedDate": "2020-06-26T07:10:33Z", "message": "Added test for stream and scope metrics.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48f8091d5b5ad98d2af7576a42610e1fb6f6bb70", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/48f8091d5b5ad98d2af7576a42610e1fb6f6bb70", "committedDate": "2020-06-26T07:23:12Z", "message": "Close scope latency metrics.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48e940f66f6fe4919e907123546ded80bc6b91fc", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/48e940f66f6fe4919e907123546ded80bc6b91fc", "committedDate": "2020-06-26T13:37:45Z", "message": "Fixed test.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e41b57db47d1da8950d9dbb96fbaf36ac7b9aff", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/6e41b57db47d1da8950d9dbb96fbaf36ac7b9aff", "committedDate": "2020-06-29T10:36:34Z", "message": "Added metrics tests for failed operations.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca6727b64339ebc76b9b9a1cd74d8c9e03d82cf5", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/ca6727b64339ebc76b9b9a1cd74d8c9e03d82cf5", "committedDate": "2020-06-29T13:34:53Z", "message": "Added metrics tests for failed operations.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDE1NzQ5", "url": "https://github.com/pravega/pravega/pull/4906#pullrequestreview-439415749", "createdAt": "2020-06-29T18:55:48Z", "commit": {"oid": "ca6727b64339ebc76b9b9a1cd74d8c9e03d82cf5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6461fced5f72e91aef2918b6c35abeeff4c366c", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/b6461fced5f72e91aef2918b6c35abeeff4c366c", "committedDate": "2020-06-29T19:11:20Z", "message": "Merge branch 'master' into issue-4893-scopes-metrics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5673dc8a9796d408999e98c7c5b506e014c7c641", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/5673dc8a9796d408999e98c7c5b506e014c7c641", "committedDate": "2020-06-30T08:05:30Z", "message": "Add update stream metric test.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4e32d5f1342a7afe803633d37fa2a64c737b1bc", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/c4e32d5f1342a7afe803633d37fa2a64c737b1bc", "committedDate": "2020-06-30T09:39:05Z", "message": "Add update stream metric test.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbc4b6e5483a35217e79e5193a5b94e01185f128", "author": {"user": {"login": "RaulGracia", "name": "Ra\u00fal Gracia"}}, "url": "https://github.com/pravega/pravega/commit/bbc4b6e5483a35217e79e5193a5b94e01185f128", "committedDate": "2020-06-30T15:59:11Z", "message": "Added more coverage.\n\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMjI2MDY1", "url": "https://github.com/pravega/pravega/pull/4906#pullrequestreview-440226065", "createdAt": "2020-06-30T17:14:33Z", "commit": {"oid": "bbc4b6e5483a35217e79e5193a5b94e01185f128"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNjE1Mjg1", "url": "https://github.com/pravega/pravega/pull/4906#pullrequestreview-440615285", "createdAt": "2020-07-01T07:32:09Z", "commit": {"oid": "bbc4b6e5483a35217e79e5193a5b94e01185f128"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNzozMjowOVrOGraN6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQwNzozMjowOVrOGraN6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODE3MTQ5OA==", "bodyText": "this is counting how many scopes this controller instance has created so far.. right?\nif the intention for this metrics is to be per controller instance, then this seems fine, but if it reports a value, then two different controller instances could report different values.", "url": "https://github.com/pravega/pravega/pull/4906#discussion_r448171498", "createdAt": "2020-07-01T07:32:09Z", "author": {"login": "shiveshr"}, "path": "controller/src/main/java/io/pravega/controller/metrics/StreamMetrics.java", "diffHunk": "@@ -93,6 +104,16 @@ public void createStream(String scope, String streamName, int minNumSegments, Du\n         createStreamLatency.reportSuccessValue(latency.toMillis());\n     }\n \n+    /**\n+     * This method increments the global counter of Scope creations and reports the latency of the operation.\n+     *\n+     * @param latency           Latency of the createStream operation.\n+     */\n+    public void createScope(Duration latency) {\n+        DYNAMIC_LOGGER.incCounterValue(CREATE_SCOPE, 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbc4b6e5483a35217e79e5193a5b94e01185f128"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwODU3NDIz", "url": "https://github.com/pravega/pravega/pull/4906#pullrequestreview-440857423", "createdAt": "2020-07-01T13:14:59Z", "commit": {"oid": "bbc4b6e5483a35217e79e5193a5b94e01185f128"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3940, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}