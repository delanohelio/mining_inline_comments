{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3MzI0Mzg4", "number": 5133, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwMzoyNDoyMVrOEfLrXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwMzo0MjoyNlrOEvHVsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxMTMyNjM3OnYy", "diffSide": "RIGHT", "path": "standalone/src/main/java/io/pravega/local/InProcPravegaCluster.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQwMzoyNDoyMVrOHLSoTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNjowNToyMlrOHMXI-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTYwMTYxNA==", "bodyText": "Curious, shouldn't this be PUBLISHED_IP_ADDRESS instead?\nI understand that you are trying to change this from IP address 127.0.1.1 that the Segment store listens on, to localhost, so that hostname verification can be turned on for client/controller-to-segment store communication. Is that correct?", "url": "https://github.com/pravega/pravega/pull/5133#discussion_r481601614", "createdAt": "2020-09-02T03:24:21Z", "author": {"login": "ravisharda"}, "path": "standalone/src/main/java/io/pravega/local/InProcPravegaCluster.java", "diffHunk": "@@ -278,6 +278,7 @@ private void startLocalSegmentStore(int segmentStoreId) throws Exception {\n                         .with(ServiceConfig.KEY_FILE, this.keyFile)\n                         .with(ServiceConfig.CERT_FILE, this.certFile)\n                         .with(ServiceConfig.ENABLE_TLS_RELOAD, this.enableTlsReload)\n+                        .with(ServiceConfig.LISTENING_IP_ADDRESS, this.enableTls ? \"localhost\" : \"\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ed30108b77584b4529e25e59214f5e3f3f88b76"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYwNDUzMQ==", "bodyText": "Thanks Ravi, yes, your understanding is correct, this is for hostname verification for segmentstore.\nActually I want to ask what's the difference between Published and Listening address? The reason I use Listening address is from this comment, looks like if we don't specify published address, it will default to listening address.", "url": "https://github.com/pravega/pravega/pull/5133#discussion_r482604531", "createdAt": "2020-09-02T23:50:01Z", "author": {"login": "Tristan1900"}, "path": "standalone/src/main/java/io/pravega/local/InProcPravegaCluster.java", "diffHunk": "@@ -278,6 +278,7 @@ private void startLocalSegmentStore(int segmentStoreId) throws Exception {\n                         .with(ServiceConfig.KEY_FILE, this.keyFile)\n                         .with(ServiceConfig.CERT_FILE, this.certFile)\n                         .with(ServiceConfig.ENABLE_TLS_RELOAD, this.enableTlsReload)\n+                        .with(ServiceConfig.LISTENING_IP_ADDRESS, this.enableTls ? \"localhost\" : \"\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTYwMTYxNA=="}, "originalCommit": {"oid": "4ed30108b77584b4529e25e59214f5e3f3f88b76"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjcyNDA5MA==", "bodyText": "Yes, if published IP and port are not registered with the Controller for the Segment Store service, the Controller returns the service's listening IP and port to the clients afaik. cc @andreipaduroiu", "url": "https://github.com/pravega/pravega/pull/5133#discussion_r482724090", "createdAt": "2020-09-03T06:05:22Z", "author": {"login": "ravisharda"}, "path": "standalone/src/main/java/io/pravega/local/InProcPravegaCluster.java", "diffHunk": "@@ -278,6 +278,7 @@ private void startLocalSegmentStore(int segmentStoreId) throws Exception {\n                         .with(ServiceConfig.KEY_FILE, this.keyFile)\n                         .with(ServiceConfig.CERT_FILE, this.certFile)\n                         .with(ServiceConfig.ENABLE_TLS_RELOAD, this.enableTlsReload)\n+                        .with(ServiceConfig.LISTENING_IP_ADDRESS, this.enableTls ? \"localhost\" : \"\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTYwMTYxNA=="}, "originalCommit": {"oid": "4ed30108b77584b4529e25e59214f5e3f3f88b76"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE3ODM4NzY5OnYy", "diffSide": "RIGHT", "path": "standalone/src/main/java/io/pravega/local/InProcPravegaCluster.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwMzo0MjoyNlrOHj6UZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQwNDo1NzoyMFrOHj8zcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzQxNzcwMA==", "bodyText": "@Tristan1900 one more ask: could you please extract the localhost string into a constant and use that here and above, so that it can be easily changed in one place (to say loopback address 127.0.0.1 or another interface during testing).", "url": "https://github.com/pravega/pravega/pull/5133#discussion_r507417700", "createdAt": "2020-10-19T03:42:26Z", "author": {"login": "ravisharda"}, "path": "standalone/src/main/java/io/pravega/local/InProcPravegaCluster.java", "diffHunk": "@@ -278,6 +278,8 @@ private void startLocalSegmentStore(int segmentStoreId) throws Exception {\n                         .with(ServiceConfig.KEY_FILE, this.keyFile)\n                         .with(ServiceConfig.CERT_FILE, this.certFile)\n                         .with(ServiceConfig.ENABLE_TLS_RELOAD, this.enableTlsReload)\n+                        .with(ServiceConfig.LISTENING_IP_ADDRESS, this.enableTls ? \"localhost\" : \"\")\n+                        .with(ServiceConfig.PUBLISHED_IP_ADDRESS, this.enableTls ? \"localhost\" : \"\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2a739bc5b14e06b1061d76622d72f48a48d01c3a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzQxODg0NA==", "bodyText": "Also, curious isn't the condition used here wrong? It sets LISTENING_IP_ADDRESS and PUBLISHED_IP_ADDRESS to empty string, if TLS is not enabled. Am I missing something?", "url": "https://github.com/pravega/pravega/pull/5133#discussion_r507418844", "createdAt": "2020-10-19T03:45:01Z", "author": {"login": "ravisharda"}, "path": "standalone/src/main/java/io/pravega/local/InProcPravegaCluster.java", "diffHunk": "@@ -278,6 +278,8 @@ private void startLocalSegmentStore(int segmentStoreId) throws Exception {\n                         .with(ServiceConfig.KEY_FILE, this.keyFile)\n                         .with(ServiceConfig.CERT_FILE, this.certFile)\n                         .with(ServiceConfig.ENABLE_TLS_RELOAD, this.enableTlsReload)\n+                        .with(ServiceConfig.LISTENING_IP_ADDRESS, this.enableTls ? \"localhost\" : \"\")\n+                        .with(ServiceConfig.PUBLISHED_IP_ADDRESS, this.enableTls ? \"localhost\" : \"\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzQxNzcwMA=="}, "originalCommit": {"oid": "2a739bc5b14e06b1061d76622d72f48a48d01c3a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzQ1ODQxNw==", "bodyText": "Sure, added. Thanks for pointing out.\nEmpty string is the default value for those two parameters. The constructor will replace the empty string with the right ip address in here", "url": "https://github.com/pravega/pravega/pull/5133#discussion_r507458417", "createdAt": "2020-10-19T04:57:20Z", "author": {"login": "Tristan1900"}, "path": "standalone/src/main/java/io/pravega/local/InProcPravegaCluster.java", "diffHunk": "@@ -278,6 +278,8 @@ private void startLocalSegmentStore(int segmentStoreId) throws Exception {\n                         .with(ServiceConfig.KEY_FILE, this.keyFile)\n                         .with(ServiceConfig.CERT_FILE, this.certFile)\n                         .with(ServiceConfig.ENABLE_TLS_RELOAD, this.enableTlsReload)\n+                        .with(ServiceConfig.LISTENING_IP_ADDRESS, this.enableTls ? \"localhost\" : \"\")\n+                        .with(ServiceConfig.PUBLISHED_IP_ADDRESS, this.enableTls ? \"localhost\" : \"\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzQxNzcwMA=="}, "originalCommit": {"oid": "2a739bc5b14e06b1061d76622d72f48a48d01c3a"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4667, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}