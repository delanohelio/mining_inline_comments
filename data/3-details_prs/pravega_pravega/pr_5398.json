{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxNjAwMzE3", "number": 5398, "title": "Issue 5382: Adding Java cacerts to openjdk:11.0.8-jre-slim Base Image", "bodyText": "Change log description\nAdding ca-certificate to system truststore with openjdk:11.0.8-jre-slim images\nPurpose of the change\nFixes #5382\nWhat the code does\nFollowing code changes add the ca certs on top of the openjdk:11.0.8-jre-slim image which we are using as Base Image.\nHow to verify it\nTo verify the changes exec into the ss pod and check the following\nroot@nautilus-pravega-segment-store-0:/opt/pravega# ls /etc/ssl/certs/java/cacerts\n/etc/ssl/certs/java/cacerts\n\nI have also deployed pravega image with these changes and have verified that reads and writes are working by running the benchmark with this pravega deployment.", "createdAt": "2020-12-03T08:28:35Z", "url": "https://github.com/pravega/pravega/pull/5398", "merged": true, "mergeCommit": {"oid": "c9b7be1146b20389f73c4b08a7c61ae22a7e45c7"}, "closed": true, "closedAt": "2020-12-04T08:50:45Z", "author": {"login": "Prabhaker24"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiRd8OgH2gAyNTMxNjAwMzE3OjYzOGQ3MjBlYjRjYWZlYzdmNDMwNWI4NjM4ZGZhZDcxNTliM2YyZTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABditFnFgH2gAyNTMxNjAwMzE3OmQzNjVhMTU1NGFmYjYzYjllMTg0ZWRjMzhiODVhOWQ3MDk4ZjNjMDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "638d720eb4cafec7f4305b8638dfad7159b3f2e7", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/638d720eb4cafec7f4305b8638dfad7159b3f2e7", "committedDate": "2020-12-02T16:51:45Z", "message": "adding ca-certificate on top of jre\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7645bb013a833ea6da74e7404d5e9f0813615aeb", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/7645bb013a833ea6da74e7404d5e9f0813615aeb", "committedDate": "2020-12-03T06:49:11Z", "message": "Merge remote-tracking branch 'upstream/master'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88e9d3d8348bac64730541504c4eef78e450500a", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/88e9d3d8348bac64730541504c4eef78e450500a", "committedDate": "2020-12-03T08:19:01Z", "message": "added certs on top of the jre image\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzNzEzMzQz", "url": "https://github.com/pravega/pravega/pull/5398#pullrequestreview-543713343", "createdAt": "2020-12-03T08:35:58Z", "commit": {"oid": "88e9d3d8348bac64730541504c4eef78e450500a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QwODozNTo1OFrOH-JImg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QwODozNTo1OFrOH-JImg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDkyMzQxOA==", "bodyText": "Please bring mkdir -p /usr/share/man/man1 to a line before rest of the CA certificates change so that the commands are collocated by functionality.\nAlso, it is not intuitive why this change is needed. Could you please add a comment that explains it?", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r534923418", "createdAt": "2020-12-03T08:35:58Z", "author": {"login": "ravisharda"}, "path": "docker/pravega/Dockerfile", "diffHunk": "@@ -9,14 +9,16 @@\n #\n FROM openjdk:11.0.8-jre-slim\n \n-RUN apt-get update && apt-get install -y -q \\\n+RUN mkdir -p /usr/share/man/man1 && apt-get update && apt-get install -y -q \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88e9d3d8348bac64730541504c4eef78e450500a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8334f5a88ecdb0d67c005f828b7f1e75c90f58bd", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/8334f5a88ecdb0d67c005f828b7f1e75c90f58bd", "committedDate": "2020-12-03T10:16:02Z", "message": "changed the structure and added comments\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzODA2MDIy", "url": "https://github.com/pravega/pravega/pull/5398#pullrequestreview-543806022", "createdAt": "2020-12-03T10:21:33Z", "commit": {"oid": "8334f5a88ecdb0d67c005f828b7f1e75c90f58bd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMDoyMTozM1rOH-Rhfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMDoyMTozM1rOH-Rhfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTA2MDg2Mw==", "bodyText": "Nit:\n\nAddidng -> Adding.\nA more useful comment'd be one that explains why you are adding it. Such as \"Adding Java system truststore 'cacerts', as it is missing from the Java distribution installed by the base image, and one of the bindings (ECS) expects it to be there when TLS is enabled. \".\nAlso, explain why mkdir -p /usr/share/man/man1 is needed, as it's need is not intuitive.", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r535060863", "createdAt": "2020-12-03T10:21:33Z", "author": {"login": "ravisharda"}, "path": "docker/pravega/Dockerfile", "diffHunk": "@@ -16,7 +16,11 @@ RUN apt-get update && apt-get install -y -q \\\n     jq \\\n     curl \\\n     net-tools \\\n-    iproute2  \\\n+    iproute2\n+\n+# Addidng ca-certificates to the base image", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8334f5a88ecdb0d67c005f828b7f1e75c90f58bd"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzODE3ODA5", "url": "https://github.com/pravega/pravega/pull/5398#pullrequestreview-543817809", "createdAt": "2020-12-03T10:35:06Z", "commit": {"oid": "8334f5a88ecdb0d67c005f828b7f1e75c90f58bd"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0208d869d68b10bb9cb8389b9a20bf4ad448f4d", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/a0208d869d68b10bb9cb8389b9a20bf4ad448f4d", "committedDate": "2020-12-03T11:17:43Z", "message": "aded comments\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzODU0MTM5", "url": "https://github.com/pravega/pravega/pull/5398#pullrequestreview-543854139", "createdAt": "2020-12-03T11:21:35Z", "commit": {"oid": "a0208d869d68b10bb9cb8389b9a20bf4ad448f4d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzODU1NDk4", "url": "https://github.com/pravega/pravega/pull/5398#pullrequestreview-543855498", "createdAt": "2020-12-03T11:23:21Z", "commit": {"oid": "a0208d869d68b10bb9cb8389b9a20bf4ad448f4d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMToyMzoyMVrOH-VnHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxMToyMzoyMVrOH-VnHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTEyNzgzNg==", "bodyText": "I'm not sure that referring to SO is the best approach here. Could we just summarize the reason in 1 or 2 lines?", "url": "https://github.com/pravega/pravega/pull/5398#discussion_r535127836", "createdAt": "2020-12-03T11:23:21Z", "author": {"login": "RaulGracia"}, "path": "docker/pravega/Dockerfile", "diffHunk": "@@ -16,7 +16,16 @@ RUN apt-get update && apt-get install -y -q \\\n     jq \\\n     curl \\\n     net-tools \\\n-    iproute2  \\\n+    iproute2\n+\n+# Adding Java system truststore 'cacerts', as it is missing from the Java\n+# distribution installed by the base image and one of the storage bindings(ECS)\n+# depends on its presence.\n+#\n+# Without `mkdir -p /usr/share/man/man1` we hit the issue mentioned in:\n+# https://stackoverflow.com/questions/58160597/docker-fails-with-sub-process-usr-bin-dpkg-returned-an-error-code-1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0208d869d68b10bb9cb8389b9a20bf4ad448f4d"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7cc09495335102bc6aa061c1217c15eecb358e2", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/b7cc09495335102bc6aa061c1217c15eecb358e2", "committedDate": "2020-12-03T11:49:52Z", "message": "changed comment\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzOTg5NzAy", "url": "https://github.com/pravega/pravega/pull/5398#pullrequestreview-543989702", "createdAt": "2020-12-03T14:10:56Z", "commit": {"oid": "b7cc09495335102bc6aa061c1217c15eecb358e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e6b46e3c04aa4feae1973ae61ef5a1f9fa97009", "author": {"user": null}, "url": "https://github.com/pravega/pravega/commit/1e6b46e3c04aa4feae1973ae61ef5a1f9fa97009", "committedDate": "2020-12-03T15:05:53Z", "message": "changed location of certs in common.sh file\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d365a1554afb63b9e184edc38b85a9d7098f3c09", "author": {"user": {"login": "ravisharda", "name": "Ravi Sharda"}}, "url": "https://github.com/pravega/pravega/commit/d365a1554afb63b9e184edc38b85a9d7098f3c09", "committedDate": "2020-12-04T01:02:31Z", "message": "Merge branch 'master' into Issue-5382-Adding-certs-to-jdk11"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3776, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}