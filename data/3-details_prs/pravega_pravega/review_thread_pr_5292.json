{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0NDQxNzY2", "number": 5292, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNDo1NzowNVrOE2Hltg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNTowMDoxMVrOE2Hq2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTgyOTAyOnYy", "diffSide": "RIGHT", "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNDo1NzowNVrOHuxS3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNTo1Njo0NlrOHydSjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNDE4OQ==", "bodyText": "Are you sure that 10 events is sufficient for an integration test? I would feel more comfortable knowing that we test a \"larger\" number of events.\nIs this really a driving factor for the time it takes to do this test? Pravega should have no issue, even in a unit/integration test, to handle 300 events.", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r518804189", "createdAt": "2020-11-06T14:57:05Z", "author": {"login": "andreipaduroiu"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -123,9 +124,9 @@\n     private static final Duration TRANSACTION_TIMEOUT = Duration.ofMillis(10000);\n \n     /**\n-     * Write 300 events to different segments.\n+     * Write 10 events to verify recovery.\n      */\n-    private static final int TOTAL_NUM_EVENTS = 300;\n+    private static final int TOTAL_NUM_EVENTS = 10;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3MDczMw==", "bodyText": "Made it to 300.", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r522670733", "createdAt": "2020-11-13T05:56:46Z", "author": {"login": "ManishKumarKeshri"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -123,9 +124,9 @@\n     private static final Duration TRANSACTION_TIMEOUT = Duration.ofMillis(10000);\n \n     /**\n-     * Write 300 events to different segments.\n+     * Write 10 events to verify recovery.\n      */\n-    private static final int TOTAL_NUM_EVENTS = 300;\n+    private static final int TOTAL_NUM_EVENTS = 10;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNDE4OQ=="}, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTgzMjQ4OnYy", "diffSide": "RIGHT", "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNDo1Nzo1OVrOHuxVJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNTo1Njo1OFrOHydSug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNDc3Mw==", "bodyText": "To avoid having this comment becoming disconnected from the actual value (if it changes), consider replacing the number with {@link #TOTAL_NUM_EVENTS}.", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r518804773", "createdAt": "2020-11-06T14:57:59Z", "author": {"login": "andreipaduroiu"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3MDc3OA==", "bodyText": "Done.", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r522670778", "createdAt": "2020-11-13T05:56:58Z", "author": {"login": "ManishKumarKeshri"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNDc3Mw=="}, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTgzNDE4OnYy", "diffSide": "RIGHT", "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNDo1ODoyM1rOHuxWKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNTo1NzoxMlrOHydS9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNTAzNQ==", "bodyText": "There is no such thing as \"Tier1\" in the code. It's called DurableLog or DurableDataLog", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r518805035", "createdAt": "2020-11-06T14:58:23Z", "author": {"login": "andreipaduroiu"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.\n+     *  3. Waits for Tier1 to be entirely flushed to the long term storage.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNTc3MQ==", "bodyText": "at line 385 too", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r518805771", "createdAt": "2020-11-06T14:59:29Z", "author": {"login": "andreipaduroiu"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.\n+     *  3. Waits for Tier1 to be entirely flushed to the long term storage.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNTAzNQ=="}, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgxMzU1MA==", "bodyText": "and in the other tests javadoc as well.", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r518813550", "createdAt": "2020-11-06T15:11:17Z", "author": {"login": "andreipaduroiu"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.\n+     *  3. Waits for Tier1 to be entirely flushed to the long term storage.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNTAzNQ=="}, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3MDgzNw==", "bodyText": "Done.", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r522670837", "createdAt": "2020-11-13T05:57:12Z", "author": {"login": "ManishKumarKeshri"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.\n+     *  3. Waits for Tier1 to be entirely flushed to the long term storage.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNTAzNQ=="}, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTgzNzI2OnYy", "diffSide": "RIGHT", "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNDo1OTowNlrOHuxYBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNjowNjoyNlrOHydbrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNTUwOA==", "bodyText": "Similarly, there is no LTS in the code either (LTS == Long Term Storage). The term in the code is Storage.", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r518805508", "createdAt": "2020-11-06T14:59:06Z", "author": {"login": "andreipaduroiu"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.\n+     *  3. Waits for Tier1 to be entirely flushed to the long term storage.\n      *  4. Shuts down the controller, segment store and bookeeper/zookeeper.\n-     *  5. Deletes container metadata segment and its attribute segment from the old LTS.\n-     *  5. Starts just one debug segment container using a new bookeeper/zookeeper and the old LTS.\n-     *  6. Re-creates the container metadata segment in Tier1 and let's it flushed to the LTS.\n-     *  7. Starts segment store and controller.\n-     *  8. Reads all 600 events again.\n+     *  5. Creates back up of container metadata segment and its attribute segment from the old LTS before deleting them.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY3MzA2OQ==", "bodyText": "Fixed.", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r522673069", "createdAt": "2020-11-13T06:06:26Z", "author": {"login": "ManishKumarKeshri"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.\n+     *  3. Waits for Tier1 to be entirely flushed to the long term storage.\n      *  4. Shuts down the controller, segment store and bookeeper/zookeeper.\n-     *  5. Deletes container metadata segment and its attribute segment from the old LTS.\n-     *  5. Starts just one debug segment container using a new bookeeper/zookeeper and the old LTS.\n-     *  6. Re-creates the container metadata segment in Tier1 and let's it flushed to the LTS.\n-     *  7. Starts segment store and controller.\n-     *  8. Reads all 600 events again.\n+     *  5. Creates back up of container metadata segment and its attribute segment from the old LTS before deleting them.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNTUwOA=="}, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTgzOTgxOnYy", "diffSide": "RIGHT", "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNDo1OTo0MVrOHuxZhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNDo1OTo0MVrOHuxZhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNTg5NA==", "bodyText": "spacing", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r518805894", "createdAt": "2020-11-06T14:59:41Z", "author": {"login": "andreipaduroiu"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.\n+     *  3. Waits for Tier1 to be entirely flushed to the long term storage.\n      *  4. Shuts down the controller, segment store and bookeeper/zookeeper.\n-     *  5. Deletes container metadata segment and its attribute segment from the old LTS.\n-     *  5. Starts just one debug segment container using a new bookeeper/zookeeper and the old LTS.\n-     *  6. Re-creates the container metadata segment in Tier1 and let's it flushed to the LTS.\n-     *  7. Starts segment store and controller.\n-     *  8. Reads all 600 events again.\n+     *  5. Creates back up of container metadata segment and its attribute segment from the old LTS before deleting them.\n+     *  6. Starts just one debug segment container using a new bookeeper/zookeeper and the old LTS.\n+     *  7. Re-creates the container metadata segment in Tier1 and let's it flushed to the LTS.\n+     *  8. Updates core attributes of segments in the new container metadata segment by using details from the back up of old container metadata segment.\n+     *  9. Starts segment store and controller.\n+     *  10.Reads all events.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTg0MjE5OnYy", "diffSide": "RIGHT", "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNTowMDoxMlrOHuxa4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxNTowMDoxMlrOHuxa4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODgwNjI0MA==", "bodyText": "\"Just don't say just\". :)", "url": "https://github.com/pravega/pravega/pull/5292#discussion_r518806240", "createdAt": "2020-11-06T15:00:12Z", "author": {"login": "andreipaduroiu"}, "path": "test/integration/src/test/java/io/pravega/test/integration/RestoreBackUpDataRecoveryTest.java", "diffHunk": "@@ -375,17 +377,18 @@ public void close() throws Exception {\n      * debug segment container.\n      *  What test does, step by step:\n      *  1. Starts Pravega locally with just one segment container.\n-     *  2. Writes 300 events to two different segments.\n-     *  3. Waits for all segments created to be flushed to the long term storage.\n+     *  2. Writes 10 events.\n+     *  3. Waits for Tier1 to be entirely flushed to the long term storage.\n      *  4. Shuts down the controller, segment store and bookeeper/zookeeper.\n-     *  5. Deletes container metadata segment and its attribute segment from the old LTS.\n-     *  5. Starts just one debug segment container using a new bookeeper/zookeeper and the old LTS.\n-     *  6. Re-creates the container metadata segment in Tier1 and let's it flushed to the LTS.\n-     *  7. Starts segment store and controller.\n-     *  8. Reads all 600 events again.\n+     *  5. Creates back up of container metadata segment and its attribute segment from the old LTS before deleting them.\n+     *  6. Starts just one debug segment container using a new bookeeper/zookeeper and the old LTS.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84a7785e9e295386f9e61bb2fa9ce5d99c17a8e3"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4502, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}