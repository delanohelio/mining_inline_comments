{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3MjEwNjgx", "number": 5373, "title": "Issue 5372: Maintain compatibility for older Credentials interface", "bodyText": "Change log description\nSupport io.pravega.client.stream.impl.Credentials interface along with the relocated io.pravega.shared.security.auth.Credentials interface, for compatibility.\nPurpose of the change\nFixes #5372.\nWhat the code does\n\nBrings back the older io.pravega.client.stream.impl.Credentials interface. It now implements io.pravega.shared.security.auth.Credentials\n\nHow to verify it\nAll unit and integration tests must pass.", "createdAt": "2020-11-25T06:40:26Z", "url": "https://github.com/pravega/pravega/pull/5373", "merged": true, "mergeCommit": {"oid": "c466c8358207ea32bcf4c02b6516d50a672658d4"}, "closed": true, "closedAt": "2020-11-29T06:53:20Z", "author": {"login": "ravisharda"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdf4IU8AH2gAyNTI3MjEwNjgxOjdiYmM3ZDlhYmFjNDJkNmQxMjViOTYxNDA2Y2QzZjI3NjdiMDcwOWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgoLiagFqTU0MDAwNzc1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7bbc7d9abac42d6d125b961406cd3f2767b0709a", "author": {"user": {"login": "ravisharda", "name": "Ravi Sharda"}}, "url": "https://github.com/pravega/pravega/commit/7bbc7d9abac42d6d125b961406cd3f2767b0709a", "committedDate": "2020-11-25T06:12:40Z", "message": "Add legacy interface\n\nSigned-off-by: rsharda <ravi.sharda@emc.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4OTk0NzQy", "url": "https://github.com/pravega/pravega/pull/5373#pullrequestreview-538994742", "createdAt": "2020-11-26T04:59:24Z", "commit": {"oid": "7bbc7d9abac42d6d125b961406cd3f2767b0709a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwNDo1OToyNFrOH6L5nA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwNDo1OToyNFrOH6L5nA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc3NDQyOA==", "bodyText": "Isn't this test similar to test testLoadsLegacyCredentialsUsingNewInterfacePackage? I think it is similar because\n\nboth LegacyCredentials1 and LegacyCredentials2 implement io.pravega.client.stream.impl.Credentials.  (older interface)\nThe test uses the latest io.pravega.client.stream.impl.Credentials interface (which extends io.pravega.shared.security.auth.Credentials)\nServiceLoader.load(io.pravega.shared.security.auth.Credentials) lists the impls of the older interface too.\n\nIf the above point is true then we need not check the implementations of the older interface in method ClientConfig.credentialFromMap()", "url": "https://github.com/pravega/pravega/pull/5373#discussion_r530774428", "createdAt": "2020-11-26T04:59:24Z", "author": {"login": "shrids"}, "path": "client/src/test/java/io/pravega/client/CredentialsExtractorTest.java", "diffHunk": "@@ -190,6 +190,43 @@ public void testLoadsCredentialsObjOfARegisteredTypeFromEnvVariablesIfLoadDynami\n                 credentials.getAuthenticationType());\n     }\n \n+    @Test\n+    public void testLoadsLegacyCredentialsUsingNewInterfacePackage() {\n+        // This method depends on service definition in\n+        // resources/META-INF/services/io.pravega.shared.security.auth.Credentials file.\n+        Map<String, String> authEnvVariables = new HashMap<>();\n+        authEnvVariables.put(\"pravega_client_auth_loadDynamic\", \"true\");\n+        authEnvVariables.put(\"pravega_client_auth_method\", LegacyCredentials1.AUTHENTICATION_METHOD);\n+\n+        ClientConfig clientConfig = ClientConfig.builder()\n+                .extractCredentials(null, authEnvVariables)\n+                .build();\n+        Credentials credentials = clientConfig.getCredentials();\n+\n+        assertNotNull(\"Credentials is null\", credentials);\n+        assertNotNull(LegacyCredentials1.class.getName(), credentials.getClass());\n+        assertEquals(\"Expected a different authentication type\", LegacyCredentials1.AUTHENTICATION_METHOD,\n+                credentials.getAuthenticationType());\n+    }\n+\n+    @Test\n+    public void testLoadsLegacyCredentialsUsingOldInterfacePackage() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bbc7d9abac42d6d125b961406cd3f2767b0709a"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MTQ2MTc5", "url": "https://github.com/pravega/pravega/pull/5373#pullrequestreview-539146179", "createdAt": "2020-11-26T09:40:55Z", "commit": {"oid": "7bbc7d9abac42d6d125b961406cd3f2767b0709a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5574067dd4b5731fbbd2bbeadb32116593b5035", "author": {"user": {"login": "ravisharda", "name": "Ravi Sharda"}}, "url": "https://github.com/pravega/pravega/commit/c5574067dd4b5731fbbd2bbeadb32116593b5035", "committedDate": "2020-11-26T09:45:47Z", "message": "Merge branch 'master' into deprecated_credentials"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a65aa04deb4a449e00cf601b5fd0656401901c71", "author": {"user": {"login": "ravisharda", "name": "Ravi Sharda"}}, "url": "https://github.com/pravega/pravega/commit/a65aa04deb4a449e00cf601b5fd0656401901c71", "committedDate": "2020-11-26T10:07:23Z", "message": "Add comments to make the test logic more explicit\n\nSigned-off-by: rsharda <ravi.sharda@emc.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a7e00e1469c0c2e5e05164dd84cdb2b7bc52e55", "author": {"user": {"login": "ravisharda", "name": "Ravi Sharda"}}, "url": "https://github.com/pravega/pravega/commit/9a7e00e1469c0c2e5e05164dd84cdb2b7bc52e55", "committedDate": "2020-11-26T10:07:34Z", "message": "Merge remote-tracking branch 'origin/deprecated_credentials' into deprecated_credentials"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMDA3NzU1", "url": "https://github.com/pravega/pravega/pull/5373#pullrequestreview-540007755", "createdAt": "2020-11-27T14:11:37Z", "commit": {"oid": "9a7e00e1469c0c2e5e05164dd84cdb2b7bc52e55"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3764, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}