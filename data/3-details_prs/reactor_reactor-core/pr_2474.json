{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0NjY0ODU3", "number": 2474, "title": "fix #2470 Make refguide BOM snippets use version from gradle.properties", "bodyText": "Additional tasks once approved:\n\n merge with squash, editing the original commit message to reflect new properties-based approach (and Reviewed-in: #2474)\n \u26a0\ufe0f merge the commit from 3.3.x into master with an edit:\n\n git merge --no-commit 3.3.x\n change the bomVersion attribute in gradle.properties to 2020.0.0\n(actually done in ac3a846 as a polish commit)\n git commit\n push to master", "createdAt": "2020-11-03T11:20:31Z", "url": "https://github.com/reactor/reactor-core/pull/2474", "merged": true, "mergeCommit": {"oid": "12649c1340dc5f4e9b4951fd14f1e9a38223e9a5"}, "closed": true, "closedAt": "2020-11-05T13:25:37Z", "author": {"login": "simonbasle"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdY3VYYgH2gAyNTE0NjY0ODU3OjIwOWM0NDI2ZmM4YzdkZDlhYWNlMGY1YjYxNTQ1YjQzYWJjNDJiYjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZg2GqAFqTUyNDE3Nzc4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "209c4426fc8c7dd9aace0f5b61545b43abc42bb5", "author": {"user": {"login": "simonbasle", "name": "Simon Basl\u00e9"}}, "url": "https://github.com/reactor/reactor-core/commit/209c4426fc8c7dd9aace0f5b61545b43abc42bb5", "committedDate": "2020-11-03T11:19:33Z", "message": "fix #2470 Make refguide BOM snippets attribute-based, bump via gradle\n\nThis commit adds a document attribute to the gettingStarted.adoc file\nto store the BOM version displayed in Maven/Gradle snippets.\n\nAdditionally, the `bumpVersionsInReadme` Gradle task now copies that\nfile and perform variable substitution, replacing the previous version\nwith whichever BOM version is passed to the command line using\n `-PbomVersion=SOMETHING` (only affecting the attribute declaration).\n\nIf the attribute is not defined, no substitution should occur."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5dafb0f983da4f963e0543cb4d9e48ec3ba8000", "author": {"user": {"login": "simonbasle", "name": "Simon Basl\u00e9"}}, "url": "https://github.com/reactor/reactor-core/commit/a5dafb0f983da4f963e0543cb4d9e48ec3ba8000", "committedDate": "2020-11-03T11:23:08Z", "message": "Polish #2470 to reflect the current 3.3.x latest BOM"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNTEwNTcx", "url": "https://github.com/reactor/reactor-core/pull/2474#pullrequestreview-522510571", "createdAt": "2020-11-03T13:48:55Z", "commit": {"oid": "a5dafb0f983da4f963e0543cb4d9e48ec3ba8000"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMzo0ODo1NlrOHsvh0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMzo0ODo1NlrOHsvh0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjY3ODA5OA==", "bodyText": "I suggest passing the attribute directly via the asciidoc plugin, ie \n  \n    \n      reactor-core/gradle/asciidoc.gradle\n    \n    \n         Line 44\n      in\n      4bdfbd3\n    \n    \n    \n    \n\n        \n          \n           attributes 'allow-uri-read': '',", "url": "https://github.com/reactor/reactor-core/pull/2474#discussion_r516678098", "createdAt": "2020-11-03T13:48:56Z", "author": {"login": "ericbottard"}, "path": "gradle/releaser.gradle", "diffHunk": "@@ -55,25 +55,40 @@ task copyReadme(type: Copy, group: \"releaser helpers\", description: \"copies the\n \tinto rootProject.buildDir\n }\n \n+task copyGettingStarted(type: Copy, group: \"releaser helpers\", description: \"copies the gettingStarted.adoc in preparation for search and replace\") {\n+\tfrom(rootProject.rootDir) {\n+\t\tinclude \"docs/asciidoc/gettingStarted.adoc\"\n+\t}\n+\tinto rootProject.buildDir\n+}\n+\n task bumpVersionsInReadme(type: Copy, group: \"releaser helpers\", description: \"replaces versions in README\") {\n+\tdef bomVersion = rootProject.findProperty(\"bomVersion\")\n \tdef oldVersion = rootProject.findProperty(\"oldVersion\")\n \tdef currentVersion = rootProject.findProperty(\"currentVersion\")\n \tdef nextVersion = rootProject.findProperty(\"nextVersion\")\n \tdef oldSnapshot = currentVersion?.replace(\"RELEASE\", \"BUILD-SNAPSHOT\")\n \n \tonlyIf { oldVersion != null && currentVersion != null && nextVersion != null }\n \tdependsOn copyReadme\n+\tdependsOn copyGettingStarted\n \n \tdoLast {\n \t\tprintln \"Will replace $oldVersion with $currentVersion and $oldSnapshot with $nextVersion\"\n+\t\tif (bomVersion == null) println \"No `bomVersion` set, will not change bom version in gettingStarted.adoc\"\n+\t\telse println \"Will change bomVersion in gettingStarted.adoc to $bomVersion\"\n \t}\n \tfrom(rootProject.buildDir) {\n \t\tinclude 'README.md'\n+\t\tinclude \"docs/asciidoc/gettingStarted.adoc\"\n \t}\n \tinto rootProject.rootDir\n-\tfilter { line -> line\n-\t\t.replace(oldVersion, currentVersion)\n-\t\t.replace(oldSnapshot, nextVersion)\n+\tfilter { line -> (bomVersion == null) ?\n+\t\tline.replace(oldVersion, currentVersion)\n+\t\t\t.replace(oldSnapshot, nextVersion) :\n+\t\tline.replace(oldVersion, currentVersion)\n+\t\t\t.replace(oldSnapshot, nextVersion)\n+\t\t\t.replaceAll(\"\\\\:reactorReleaseTrain\\\\: .*\", \":reactorReleaseTrain: \" + bomVersion)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5dafb0f983da4f963e0543cb4d9e48ec3ba8000"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d8bea4da4cc0ac02cd6ca49e4a707a3e7b94fce", "author": {"user": {"login": "simonbasle", "name": "Simon Basl\u00e9"}}, "url": "https://github.com/reactor/reactor-core/commit/5d8bea4da4cc0ac02cd6ca49e4a707a3e7b94fce", "committedDate": "2020-11-03T14:56:12Z", "message": "switch to using gradle.properties and passing the attribute via gradle plugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39ad59e219ca2648f79d4d5251193d8b559acffc", "author": {"user": {"login": "simonbasle", "name": "Simon Basl\u00e9"}}, "url": "https://github.com/reactor/reactor-core/commit/39ad59e219ca2648f79d4d5251193d8b559acffc", "committedDate": "2020-11-03T14:57:20Z", "message": "remove leftover of previous task"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNjI0Nzgz", "url": "https://github.com/reactor/reactor-core/pull/2474#pullrequestreview-522624783", "createdAt": "2020-11-03T15:40:48Z", "commit": {"oid": "39ad59e219ca2648f79d4d5251193d8b559acffc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNjc0MDMy", "url": "https://github.com/reactor/reactor-core/pull/2474#pullrequestreview-522674032", "createdAt": "2020-11-03T16:31:07Z", "commit": {"oid": "39ad59e219ca2648f79d4d5251193d8b559acffc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNjozMTowN1rOHs25zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNjozMTowN1rOHs25zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc5ODkyNw==", "bodyText": "wouldn't it be better to link to https://projectreactor.io/docs that contains both the release train + core's version?", "url": "https://github.com/reactor/reactor-core/pull/2474#discussion_r516798927", "createdAt": "2020-11-03T16:31:07Z", "author": {"login": "bsideup"}, "path": "docs/asciidoc/gettingStarted.adoc", "diffHunk": "@@ -83,20 +83,25 @@ However, if you want to force the use of a specific artifact's version, you can\n it when adding your dependency, as you usually would. You can also forgo the BOM entirely\n and specify dependencies by their artifact versions.\n \n+WARNING: As of this version (reactor-core {project-version}), the latest stable BOM in the associated\n+release train line is `{reactorReleaseTrain}`, which is what is used in snippets below.\n+There might be newer versions since then (including snapshots, milestones and new release train lines),\n+see https://github.com/reactor/reactor/releases/.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39ad59e219ca2648f79d4d5251193d8b559acffc"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04659d7f94f73fa8c7e8eff76365452b2365d407", "author": {"user": {"login": "simonbasle", "name": "Simon Basl\u00e9"}}, "url": "https://github.com/reactor/reactor-core/commit/04659d7f94f73fa8c7e8eff76365452b2365d407", "committedDate": "2020-11-05T11:37:44Z", "message": "replace link to github releases with project site docs section"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MTc2OTA3", "url": "https://github.com/reactor/reactor-core/pull/2474#pullrequestreview-524176907", "createdAt": "2020-11-05T11:40:15Z", "commit": {"oid": "04659d7f94f73fa8c7e8eff76365452b2365d407"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0MTc3Nzgx", "url": "https://github.com/reactor/reactor-core/pull/2474#pullrequestreview-524177781", "createdAt": "2020-11-05T11:41:24Z", "commit": {"oid": "04659d7f94f73fa8c7e8eff76365452b2365d407"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2682, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}