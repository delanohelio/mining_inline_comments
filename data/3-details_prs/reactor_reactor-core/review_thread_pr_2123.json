{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MTEzMjE4", "number": 2123, "reviewThreads": {"totalCount": 38, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTozODoyOFrODzyoNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMDoxMjozMlrOEJFGSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NjMzNDYzOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/Scannable.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNTozODoyOFrOGIavvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNjozMToyMVrOGIdPhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3OTk5OQ==", "bodyText": "@simonbasle I wonder if \"asynchronous\" (or the inverse - \"synchronous\") would be a better term?", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r411479999", "createdAt": "2020-04-20T15:38:28Z", "author": {"login": "bsideup"}, "path": "reactor-core/src/main/java/reactor/core/Scannable.java", "diffHunk": "@@ -210,6 +210,8 @@\n \t\t */\n \t\tpublic static final Attr<Stream<Tuple2<String, String>>> TAGS = new Attr<>(null);\n \n+\t\tpublic static final Attr<Boolean> THREAD_MODIFIER = new Attr<>(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "445cd2db94419f041fdc6eacd27053e4eed7ec6c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUwOTMzOQ==", "bodyText": "yeah, @aneveu I think the logic should be reversed actually :/\nthe most important information for now is whether or not the operator is guaranteed to be synchronous. so the attribute would be SYNCHRONOUS and it would default to false. Make a note in the javadoc that it returns false if the operator can switch threads or if we don't know for sure if it stays on the same thread.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r411509339", "createdAt": "2020-04-20T16:15:41Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/Scannable.java", "diffHunk": "@@ -210,6 +210,8 @@\n \t\t */\n \t\tpublic static final Attr<Stream<Tuple2<String, String>>> TAGS = new Attr<>(null);\n \n+\t\tpublic static final Attr<Boolean> THREAD_MODIFIER = new Attr<>(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3OTk5OQ=="}, "originalCommit": {"oid": "445cd2db94419f041fdc6eacd27053e4eed7ec6c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUxODAyNw==", "bodyText": "@bsideup as seen with @simonbasle, I'm going to revert the logic so that by default all operators which are not modifying their executing thread will return true for Attr.SYNCHRONOUS, in order for asynchronous operators only to be decorated.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r411518027", "createdAt": "2020-04-20T16:27:37Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/Scannable.java", "diffHunk": "@@ -210,6 +210,8 @@\n \t\t */\n \t\tpublic static final Attr<Stream<Tuple2<String, String>>> TAGS = new Attr<>(null);\n \n+\t\tpublic static final Attr<Boolean> THREAD_MODIFIER = new Attr<>(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3OTk5OQ=="}, "originalCommit": {"oid": "445cd2db94419f041fdc6eacd27053e4eed7ec6c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUyMDkwMQ==", "bodyText": "yeah, sorry this is a lot of additional work but at least if one forgets to explicitly define this attribute, in the case of eg. Sleuth it wouldn't mistakenly be skipped.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r411520901", "createdAt": "2020-04-20T16:31:21Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/Scannable.java", "diffHunk": "@@ -210,6 +210,8 @@\n \t\t */\n \t\tpublic static final Attr<Stream<Tuple2<String, String>>> TAGS = new Attr<>(null);\n \n+\t\tpublic static final Attr<Boolean> THREAD_MODIFIER = new Attr<>(false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTQ3OTk5OQ=="}, "originalCommit": {"oid": "445cd2db94419f041fdc6eacd27053e4eed7ec6c"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2NDk5NjE4OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSourceMono.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMDoyNjo1M1rOGYFMnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoyMzoxMVrOGaTtYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwNDE1Nw==", "bodyText": "Isn't it UNKNOWN here? Or source. scanUnsafe(key)?", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r427904157", "createdAt": "2020-05-20T10:26:53Z", "author": {"login": "bsideup"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSourceMono.java", "diffHunk": "@@ -55,4 +55,9 @@ public void subscribe(CoreSubscriber<? super I> actual) {\n \t\tsource.subscribe(actual);\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb8eec5243f90bfe19b7117e78b16169be4edc28"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg3NDA2OQ==", "bodyText": "FluxSourceMono is a final class, which is the reason why I decided to mark it as SYNC but you're right, source.scanUnsafe(key) might be better as the Mono source could possibly be ASYNC", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r429874069", "createdAt": "2020-05-25T11:01:08Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSourceMono.java", "diffHunk": "@@ -55,4 +55,9 @@ public void subscribe(CoreSubscriber<? super I> actual) {\n \t\tsource.subscribe(actual);\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwNDE1Nw=="}, "originalCommit": {"oid": "bb8eec5243f90bfe19b7117e78b16169be4edc28"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzOTA3Mg==", "bodyText": "yeah it would actually make sense to use Scannable.from(source).scanUnsafe(key), since this is a final wrapper of Mono. Note we expect most Mono to be Scannable, but it is not guaranteed. However Scannable.from(foo) will return a default object instance that only answers with default values if the foo is not actually explicitly scannable.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r430239072", "createdAt": "2020-05-26T08:23:11Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSourceMono.java", "diffHunk": "@@ -55,4 +55,9 @@ public void subscribe(CoreSubscriber<? super I> actual) {\n \t\tsource.subscribe(actual);\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwNDE1Nw=="}, "originalCommit": {"oid": "bb8eec5243f90bfe19b7117e78b16169be4edc28"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2NTAwMjAzOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxElapsed.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMDoyODo0MVrOGYFQ-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMDo1ODoxN1rOGZ9XcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwNTI3NA==", "bodyText": "ElapsedSubscriber is synchronous and does not change the thread. The scheduler is used, but only for timestamping", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r427905274", "createdAt": "2020-05-20T10:28:41Z", "author": {"login": "bsideup"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxElapsed.java", "diffHunk": "@@ -46,7 +46,7 @@ public void subscribe(CoreSubscriber<? super Tuple2<Long, T>> actual) {\n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.RUN_ON) return scheduler;\n-\n+\t\tif (key == Attr.THREAD_MODIFIER) return true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb8eec5243f90bfe19b7117e78b16169be4edc28"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg3MzAwOQ==", "bodyText": "I haven't go through the Flux classes at the moment, only those which are linked to Mono du to conversion needs. So this will be removed anyway, but thanks for noticing the wrong value \ud83d\ude09", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r429873009", "createdAt": "2020-05-25T10:58:17Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxElapsed.java", "diffHunk": "@@ -46,7 +46,7 @@ public void subscribe(CoreSubscriber<? super Tuple2<Long, T>> actual) {\n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.RUN_ON) return scheduler;\n-\n+\t\tif (key == Attr.THREAD_MODIFIER) return true;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwNTI3NA=="}, "originalCommit": {"oid": "bb8eec5243f90bfe19b7117e78b16169be4edc28"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2NTAzMTAzOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSourceMonoFuseable.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMDozNzo0OVrOGYFjuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMDozNzo0OVrOGYFjuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkxMDA3NQ==", "bodyText": "see https://github.com/reactor/reactor-core/pull/2123/files#r427904157", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r427910075", "createdAt": "2020-05-20T10:37:49Z", "author": {"login": "bsideup"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSourceMonoFuseable.java", "diffHunk": "@@ -47,4 +47,11 @@ public String stepName() {\n \t\t}\n \t\treturn \"FluxFromMono(\" + source.toString() + \")\";\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb8eec5243f90bfe19b7117e78b16169be4edc28"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4MTQwODMxOnYy", "diffSide": "LEFT", "path": "reactor-core/src/test/java/reactor/core/publisher/MonoUsingWhenTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxNToxMjo1NVrOGai-tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxNToxMjo1NVrOGai-tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQ4OTI3MQ==", "bodyText": "replaced this entire bloc of assertions with the unique following one in order to be coherent with the rest of those tests", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r430489271", "createdAt": "2020-05-26T15:12:55Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/test/java/reactor/core/publisher/MonoUsingWhenTest.java", "diffHunk": "@@ -357,28 +356,13 @@ public void resourceSupplierCanAccessContext() {\n \t\t    .verifyComplete();\n \t}\n \n-\t// == scanUnsafe tests ==\n+\t// == scan tests ==\n \n \t@Test\n \tpublic void scanOperator() {\n \t\tMonoUsingWhen<Object, Object> op = new MonoUsingWhen<>(Mono.empty(), Mono::just, Mono::just, Mono::just, Mono::just);\n \n-\t\tassertThat(op.scanUnsafe(Attr.ACTUAL))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.ACTUAL_METADATA))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.BUFFERED))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.CAPACITY))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.CANCELLED))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.DELAY_ERROR))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.ERROR))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.LARGE_BUFFERED))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.NAME))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.PARENT))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.RUN_ON))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.PREFETCH))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.REQUESTED_FROM_DOWNSTREAM))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.TERMINATED))\n-\t\t\t\t.isSameAs(op.scanUnsafe(Attr.TAGS))\n-\t\t\t\t.isNull();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c4032385816a05c7bfce3440ad675f1a8f8eb0f"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NjkzMDgyOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxCreate.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMTozODoyNFrOGmBGKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNjoyNzo1N1rOGnxLhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUxNzAzMw==", "bodyText": "isn't it potentially ASYNC source?", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r442517033", "createdAt": "2020-06-18T21:38:24Z", "author": {"login": "robotmrv"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxCreate.java", "diffHunk": "@@ -103,7 +103,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDM1MzQxMw==", "bodyText": "Fixed in commit abd4003", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r444353413", "createdAt": "2020-06-23T16:27:57Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxCreate.java", "diffHunk": "@@ -103,7 +103,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUxNzAzMw=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1Njk0MzMwOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxElapsed.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMTo0MzoyOFrOGmBOOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNjoyNTozOFrOGnIJug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUxOTA5Ng==", "bodyText": "as far as I see it is SYNC", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r442519096", "createdAt": "2020-06-18T21:43:28Z", "author": {"login": "robotmrv"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxElapsed.java", "diffHunk": "@@ -46,6 +46,7 @@\n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.RUN_ON) return scheduler;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.ASYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY4MTIxMA==", "bodyText": "Fixed in commit a69fc2a", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r443681210", "createdAt": "2020-06-22T16:25:38Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxElapsed.java", "diffHunk": "@@ -46,6 +46,7 @@\n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.RUN_ON) return scheduler;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.ASYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUxOTA5Ng=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1Njk5NTkyOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxReplay.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMjowNDo0NlrOGmBvGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNjoyNzoyOVrOGnxKWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUyNzUxNQ==", "bodyText": "is it really ASYNC? I see it uses Scheduler for getting time", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r442527515", "createdAt": "2020-06-18T22:04:46Z", "author": {"login": "robotmrv"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxReplay.java", "diffHunk": "@@ -1146,6 +1146,7 @@ public Object scanUnsafe(Scannable.Attr key) {\n \t\tif (key == Attr.PREFETCH) return getPrefetch();\n \t\tif (key == Attr.PARENT) return source;\n \t\tif (key == Attr.RUN_ON) return scheduler;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.ASYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDM1MzExMw==", "bodyText": "Fixed in commit abd4003", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r444353113", "createdAt": "2020-06-23T16:27:29Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxReplay.java", "diffHunk": "@@ -1146,6 +1146,7 @@ public Object scanUnsafe(Scannable.Attr key) {\n \t\tif (key == Attr.PREFETCH) return getPrefetch();\n \t\tif (key == Attr.PARENT) return source;\n \t\tif (key == Attr.RUN_ON) return scheduler;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.ASYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUyNzUxNQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NzAzOTA1OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/MonoElapsed.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMjoyNToyNFrOGmCK5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNjoyNToyN1rOGnIJQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUzNDYyOQ==", "bodyText": "looks like it is SYNC", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r442534629", "createdAt": "2020-06-18T22:25:24Z", "author": {"login": "robotmrv"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoElapsed.java", "diffHunk": "@@ -41,6 +41,7 @@\n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.RUN_ON) return scheduler;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.ASYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY4MTA5MQ==", "bodyText": "Fixed in commit a69fc2a", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r443681091", "createdAt": "2020-06-22T16:25:27Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoElapsed.java", "diffHunk": "@@ -41,6 +41,7 @@\n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.RUN_ON) return scheduler;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.ASYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUzNDYyOQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NzA3NzA4OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/MonoLift.java", "isResolved": true, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMjo0NDo1MVrOGmCi_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNjoyNzowNlrOGnxJUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MDc5OQ==", "bodyText": "I do not see other Lift operators\nare they still in progress?\nDoesn't it ignores scanUnsafe() from its super class?\nDoes it mean that CoreSubscriber<? super I> input considered to be SYNC?", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r442540799", "createdAt": "2020-06-18T22:44:51Z", "author": {"login": "robotmrv"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoLift.java", "diffHunk": "@@ -53,4 +53,9 @@ public String stepName() {\n \t\t}\n \t\treturn super.stepName();\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\treturn Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjcwNTU4NQ==", "bodyText": "The LIFT operators are still to be done, indeed.\nI'm sorry, I kept the PR opened after we decided to reverse the logic and extend the declaration of the attribute to all operators but I now realize that it's confusing, even with the WIP prefix in the title \ud83d\ude1e\nBut thank you very much for your review, this kind of repetitive task is prone to error \ud83d\ude05  I'll look at other comments once I'm done to make a final \"corrective\" commit.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r442705585", "createdAt": "2020-06-19T08:25:44Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoLift.java", "diffHunk": "@@ -53,4 +53,9 @@ public String stepName() {\n \t\t}\n \t\treturn super.stepName();\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\treturn Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MDc5OQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY4MjcxOQ==", "bodyText": "Fixed in commit 3c4ebed", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r443682719", "createdAt": "2020-06-22T16:28:07Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoLift.java", "diffHunk": "@@ -53,4 +53,9 @@ public String stepName() {\n \t\t}\n \t\treturn super.stepName();\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\treturn Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MDc5OQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc0ODY3MA==", "bodyText": "I see that all Lift Publishers marked as SYNC and It means that lift functions must return SYNC Subscribers.\nIf it is so - it is better to mention this in Operators.lift() etc.\nThis behavior makes easier to add more than one Hooks.onEachOperator(Function) or  Hooks.onLastOperator(Function) as we can assume that XXXLift publishers should not be decorated (because of their probably ASYNC nature)\nbut their sources should be checked and it is hard to understand whether current SYNC Publisher is Lift Publisher or not to skip it and traverse to its source or just assume that it safe to not decorate it.\nSo If we assume that lifters produce only synchronous CoreSubscribers it is better to get Attr.RUN_STYLE from its source. So we would not need additional Attr or flag interface on Lift Publishers", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r443748670", "createdAt": "2020-06-22T18:28:37Z", "author": {"login": "robotmrv"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoLift.java", "diffHunk": "@@ -53,4 +53,9 @@ public String stepName() {\n \t\t}\n \t\treturn super.stepName();\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\treturn Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MDc5OQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDAyNTE0OA==", "bodyText": "@robotmrv the lift functions and associated operators are the primary mean through which one can set up a onEachOperator hook without running into an infinite loop, aka they don't and shouldn't apply assembly hooks. Perhaps this should be made clearer in the javadoc. But you shouldn't run into the situation of eg. sleuth decorating a LiftPublisher (or a subscriber produced by the user-provided lift function).", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r444025148", "createdAt": "2020-06-23T07:42:28Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoLift.java", "diffHunk": "@@ -53,4 +53,9 @@ public String stepName() {\n \t\t}\n \t\treturn super.stepName();\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\treturn Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MDc5OQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA3MTg5NQ==", "bodyText": "@simonbasle  I think my description of the problem was confusing, so let me explain by example.\nThere are two libraries which apply hooks (e.g. onEachOperator)\nMono.just(0)\n    .delayElement(Duration.ofMillis(100))//some `ASYNC` operator\n//calls onAssembly()\n//    apply first LiftFunction -> `MonoLift` (1) decorates as source is `ASYNC` \n//    apply second LiftFunction -> (2) source is `SYNC` so just skips decoration, that is wrong  \n    .map(it -> ...)// (3) lib 2 context is lost because it was not propagated \n...\nat (1) we have ASYNC source for the first Lift function so it decorates source Publisher\nthen at (2) source is SYNC so it \"thinks\" that it is ok to skip decoration\nat (3) context of the second Lift function is lost", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r444071895", "createdAt": "2020-06-23T08:59:51Z", "author": {"login": "robotmrv"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoLift.java", "diffHunk": "@@ -53,4 +53,9 @@ public String stepName() {\n \t\t}\n \t\treturn super.stepName();\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\treturn Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MDc5OQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDA3MzM0Mg==", "bodyText": "got it, so it should have the \"special\" behavior of delegating the SYNC/ASYNC to the original subscriber. and if said subscriber is not Core, answer UNKNOWN", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r444073342", "createdAt": "2020-06-23T09:02:00Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoLift.java", "diffHunk": "@@ -53,4 +53,9 @@ public String stepName() {\n \t\t}\n \t\treturn super.stepName();\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\treturn Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MDc5OQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDM1Mjg1MA==", "bodyText": "Fixed in commit abd4003", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r444352850", "createdAt": "2020-06-23T16:27:06Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoLift.java", "diffHunk": "@@ -53,4 +53,9 @@ public String stepName() {\n \t\t}\n \t\treturn super.stepName();\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\treturn Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MDc5OQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NzA5NTExOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/MonoSource.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMjo1NDozOFrOGmCuaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNjoyNTo1MFrOGnIKKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MzcyMw==", "bodyText": "isn't the same as #2123 (comment) ?", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r442543723", "createdAt": "2020-06-18T22:54:38Z", "author": {"login": "robotmrv"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoSource.java", "diffHunk": "@@ -86,6 +89,9 @@ public Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.PARENT) {\n \t\t\t\treturn source;\n \t\t}\n+\t\tif (key == RUN_STYLE) {\n+\t\t    return SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY4MTMyMw==", "bodyText": "Fixed in commit a69fc2a", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r443681323", "createdAt": "2020-06-22T16:25:50Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoSource.java", "diffHunk": "@@ -86,6 +89,9 @@ public Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.PARENT) {\n \t\t\t\treturn source;\n \t\t}\n+\t\tif (key == RUN_STYLE) {\n+\t\t    return SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0MzcyMw=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc1NzEwMDU3OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/MonoSourceFuseable.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMjo1NzozNlrOGmCx0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxNjoyNTo1NlrOGnIKcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0NDU5NQ==", "bodyText": "isn't the same as #2123 (comment) ?", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r442544595", "createdAt": "2020-06-18T22:57:36Z", "author": {"login": "robotmrv"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoSourceFuseable.java", "diffHunk": "@@ -79,6 +79,9 @@ public Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.PARENT) {\n \t\t\treturn source;\n \t\t}\n+\t\tif (key == Attr.RUN_STYLE) {\n+\t\t    return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzY4MTM5Mg==", "bodyText": "Fixed in commit a69fc2a", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r443681392", "createdAt": "2020-06-22T16:25:56Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoSourceFuseable.java", "diffHunk": "@@ -79,6 +79,9 @@ public Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.PARENT) {\n \t\t\treturn source;\n \t\t}\n+\t\tif (key == Attr.RUN_STYLE) {\n+\t\t    return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU0NDU5NQ=="}, "originalCommit": {"oid": "0f5b25c9db162ac698aad3ea4b53d8d7f737b81c"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjIyMDAxOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/Scannable.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzozMDowNlrOGo6wbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzozMDowNlrOGo6wbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU1ODg5NQ==", "bodyText": "please document this, refer to the enum for strongness of guarantees", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445558895", "createdAt": "2020-06-25T13:30:06Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/Scannable.java", "diffHunk": "@@ -210,6 +210,12 @@\n \t\t */\n \t\tpublic static final Attr<Stream<Tuple2<String, String>>> TAGS = new Attr<>(null);\n \n+\t\tpublic static final Attr<RunStyle> RUN_STYLE = new Attr<>(RunStyle.UNKNOWN);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjIyNjIwOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/Scannable.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzozMTozOVrOGo60Xw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzozMTozOVrOGo60Xw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU1OTkwMw==", "bodyText": "I would revert SYNC and ASYNC, document each enum independently and document that sorting by ordinal is effectively sorting from weakest confidence (0, UNKNOWN) to strongest confidence (2, SYNC)", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445559903", "createdAt": "2020-06-25T13:31:39Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/Scannable.java", "diffHunk": "@@ -210,6 +210,12 @@\n \t\t */\n \t\tpublic static final Attr<Stream<Tuple2<String, String>>> TAGS = new Attr<>(null);\n \n+\t\tpublic static final Attr<RunStyle> RUN_STYLE = new Attr<>(RunStyle.UNKNOWN);\n+\n+\t\tpublic enum RunStyle {\n+\t\t\tUNKNOWN, SYNC, ASYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjIzOTk5OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/ConnectableFluxHide.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzozNTowNFrOGo69dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzozNTowNFrOGo69dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU2MjIzMQ==", "bodyText": "at first I wondered if it should delegate to the source, but contrary to LiftSubscriber this one can be asserted by the onEachOperatorHook, so it makes sense to set it as SYNC (eg. so that only the parent would be decorated by Sleuth if ASYNC) \ud83d\udc4d", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445562231", "createdAt": "2020-06-25T13:35:04Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/ConnectableFluxHide.java", "diffHunk": "@@ -42,9 +42,10 @@ public int getPrefetch() {\n \n \t@Override\n \t@Nullable\n-\tpublic Object scanUnsafe(Scannable.Attr key) {\n-\t\tif (key == Scannable.Attr.PARENT) return source;\n-\t\tif (key == Scannable.Attr.PREFETCH) return getPrefetch();\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\tif (key == Attr.PARENT) return source;\n+\t\tif (key == Attr.PREFETCH) return getPrefetch();\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjMyMDY1OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxErrorOnRequest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzo1Mjo0OVrOGo7v-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0MTozN1rOGpnkLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU3NTE2MA==", "bodyText": "the ErrorSubscription should also answer to RUN_STYLE", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445575160", "createdAt": "2020-06-25T13:52:49Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxErrorOnRequest.java", "diffHunk": "@@ -45,7 +45,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5MzAzOQ==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446293039", "createdAt": "2020-06-26T16:41:37Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxErrorOnRequest.java", "diffHunk": "@@ -45,7 +45,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU3NTE2MA=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjMzMzI4OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxGenerate.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzo1NTozMlrOGo738A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0MTo0NVrOGpnkXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU3NzIwMA==", "bodyText": "should probably also cover GenerateSubscription", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445577200", "createdAt": "2020-06-25T13:55:32Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxGenerate.java", "diffHunk": "@@ -85,7 +85,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5MzA4Nw==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446293087", "createdAt": "2020-06-26T16:41:45Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxGenerate.java", "diffHunk": "@@ -85,7 +85,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU3NzIwMA=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjM0MTM3OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxHide.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzo1NzoxM1rOGo79Ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxMzo1OToyOVrOGo8D3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU3ODU1MA==", "bodyText": "as discussed above in ConnectableFluxHide, I think it makes better sense to reply SYNC for xxxHide operators.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445578550", "createdAt": "2020-06-25T13:57:13Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxHide.java", "diffHunk": "@@ -39,6 +40,12 @@\n \t\treturn new HideSubscriber<>(actual);\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t    if (key == Attr.RUN_STYLE) return Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU4MDI1Mg==", "bodyText": "the HideSubscriber and SuppressFuseableSubscriber should also be covered (same, replying SYNC)", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445580252", "createdAt": "2020-06-25T13:59:29Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxHide.java", "diffHunk": "@@ -39,6 +40,12 @@\n \t\treturn new HideSubscriber<>(actual);\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t    if (key == Attr.RUN_STYLE) return Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU3ODU1MA=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjM2MDg4OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxInterval.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDowMTozM1rOGo8JzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDowMTozM1rOGo8JzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU4MTc3Mw==", "bodyText": "the IntervalRunnable should also be covered", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445581773", "createdAt": "2020-06-25T14:01:33Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxInterval.java", "diffHunk": "@@ -79,6 +78,7 @@ public void subscribe(CoreSubscriber<? super Long> actual) {\n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.RUN_ON) return timedScheduler;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.ASYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjM2NzU3OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxIterable.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDowMzoyMVrOGo8Ofw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDowMzoyMVrOGo8Ofw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU4Mjk3NQ==", "bodyText": "IterableSubscription and its conditional counterpart should also be covered", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445582975", "createdAt": "2020-06-25T14:03:21Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxIterable.java", "diffHunk": "@@ -92,6 +95,9 @@ public Object scanUnsafe(Attr key) {\n \t\t\tif (iterable instanceof Collection) return ((Collection) iterable).size();\n \t\t\tif (iterable instanceof Tuple2) return ((Tuple2) iterable).size();\n \t\t}\n+\t\tif (key == RUN_STYLE) {\n+\t\t    return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjM5MTMyOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxMetricsFuseable.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDowOTowOFrOGo8d4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDowOTowOFrOGo8d4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU4NjkxMw==", "bodyText": "move up, close to subscribeOrReturn. I was first confused that this was covering the inner (which is already covered by virtue of extending the non=fused version)", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445586913", "createdAt": "2020-06-25T14:09:08Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxMetricsFuseable.java", "diffHunk": "@@ -185,4 +183,10 @@ public int size() {\n \t\t\treturn qs == null ? 0 : qs.size();\n \t\t}\n \t}\n+\n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjQ0ODA4OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxJust.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDoyMToyNVrOGo9Beg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDoyMToyNVrOGo9Beg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU5NjAyNg==", "bodyText": "the inner WeakScalarSubscription should also be covered. Also, neightbour class FluxJoin isn't covered at all.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445596026", "createdAt": "2020-06-25T14:21:25Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxJust.java", "diffHunk": "@@ -73,6 +73,7 @@ public void subscribe(final CoreSubscriber<? super T> actual) {\n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.BUFFERED) return 1;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjQ1ODE2OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxLiftFuseable.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDoyMzozM1rOGo9H7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDoyMzozM1rOGo9H7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTU5NzY3OQ==", "bodyText": "neighbour class FluxLimitRequest isn't covered at all", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445597679", "createdAt": "2020-06-25T14:23:33Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxLiftFuseable.java", "diffHunk": "@@ -62,6 +62,12 @@ public String stepName() {\n \t\treturn super.stepName();\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\tif (key == Attr.RUN_STYLE) return Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjQ3NDQwOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxMergeOrdered.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDoyNzowOFrOGo9SBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDoyNzowOFrOGo9SBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYwMDI2MA==", "bodyText": "the other subscriber, MergeOrderedMainProducer should also be covered", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445600260", "createdAt": "2020-06-25T14:27:08Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxMergeOrdered.java", "diffHunk": "@@ -421,6 +422,7 @@ public Object scanUnsafe(Attr key){\n \t\t\tif (key == Attr.PREFETCH) return prefetch;\n \t\t\tif (key == Attr.TERMINATED) return done;\n \t\t\tif (key == Attr.BUFFERED) return queue.size();\n+\t\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjQ5Nzc2OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxOnBackpressureBufferStrategy.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDozMjoxOFrOGo9hMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0MTo1MVrOGpnkmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYwNDE0NA==", "bodyText": "FluxOnBackpressureBuffer isn't covered at all", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445604144", "createdAt": "2020-06-25T14:32:18Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxOnBackpressureBufferStrategy.java", "diffHunk": "@@ -66,6 +66,12 @@ public int getPrefetch() {\n \t\treturn Integer.MAX_VALUE;\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5MzE0NQ==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446293145", "createdAt": "2020-06-26T16:41:51Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxOnBackpressureBufferStrategy.java", "diffHunk": "@@ -66,6 +66,12 @@ public int getPrefetch() {\n \t\treturn Integer.MAX_VALUE;\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYwNDE0NA=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjUyMzQxOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxPublish.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDozNzozNVrOGo9xDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0MjowMFrOGpnk4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYwODIwNQ==", "bodyText": "the two other inners should probably be covered too", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445608205", "createdAt": "2020-06-25T14:37:35Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxPublish.java", "diffHunk": "@@ -552,6 +553,7 @@ public Object scanUnsafe(Attr key) {\n \t\t\tif (key == Attr.BUFFERED) return queue != null ? queue.size() : 0;\n \t\t\tif (key == Attr.TERMINATED) return isTerminated();\n \t\t\tif (key == Attr.CANCELLED) return s == Operators.cancelledSubscription();\n+\t\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5MzIxNg==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446293216", "createdAt": "2020-06-26T16:42:00Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxPublish.java", "diffHunk": "@@ -552,6 +553,7 @@ public Object scanUnsafe(Attr key) {\n \t\t\tif (key == Attr.BUFFERED) return queue != null ? queue.size() : 0;\n \t\t\tif (key == Attr.TERMINATED) return isTerminated();\n \t\t\tif (key == Attr.CANCELLED) return s == Operators.cancelledSubscription();\n+\t\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYwODIwNQ=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjUzMDU0OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxPublishMulticast.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDozOTowM1rOGo91Zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0MjoxMVrOGpnlNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYwOTMxOA==", "bodyText": "PublishMulticastInner should be also covered", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445609318", "createdAt": "2020-06-25T14:39:03Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxPublishMulticast.java", "diffHunk": "@@ -169,6 +178,9 @@ public Object scanUnsafe(Attr key) {\n \t\t\tif (key == Attr.BUFFERED) {\n \t\t\t\treturn queue != null ? queue.size() : 0;\n \t\t\t}\n+\t\t\tif (key == RUN_STYLE) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5MzMwMw==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446293303", "createdAt": "2020-06-26T16:42:11Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxPublishMulticast.java", "diffHunk": "@@ -169,6 +178,9 @@ public Object scanUnsafe(Attr key) {\n \t\t\tif (key == Attr.BUFFERED) {\n \t\t\t\treturn queue != null ? queue.size() : 0;\n \t\t\t}\n+\t\t\tif (key == RUN_STYLE) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYwOTMxOA=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjUzODczOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxRange.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDo0MDo0N1rOGo96TQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0MjoyMFrOGpnlhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYxMDU3Mw==", "bodyText": "RangeSubscription should also be covered", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445610573", "createdAt": "2020-06-25T14:40:47Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxRange.java", "diffHunk": "@@ -70,7 +70,8 @@ public void subscribe(CoreSubscriber<? super Integer> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5MzM4Mg==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446293382", "createdAt": "2020-06-26T16:42:20Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxRange.java", "diffHunk": "@@ -70,7 +70,8 @@ public void subscribe(CoreSubscriber<? super Integer> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYxMDU3Mw=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3NjU3NTY3OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxRefCountGrace.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQxNDo0ODo1MVrOGo-RtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0MjozMlrOGpnl7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYxNjU2NA==", "bodyText": "actually, after looking carefully at the operator I think this one is SYNC: the timeout only is for delaying cancellation from source. The RefCountInner isn't scheduled on a separate thread. By the way said inner should be covered>", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r445616564", "createdAt": "2020-06-25T14:48:51Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxRefCountGrace.java", "diffHunk": "@@ -63,6 +63,7 @@ public int getPrefetch() {\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.PREFETCH) return getPrefetch();\n \t\tif (key == Attr.PARENT) return source;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.ASYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5MzQ4Nw==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446293487", "createdAt": "2020-06-26T16:42:32Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxRefCountGrace.java", "diffHunk": "@@ -63,6 +63,7 @@ public int getPrefetch() {\n \tpublic Object scanUnsafe(Attr key) {\n \t\tif (key == Attr.PREFETCH) return getPrefetch();\n \t\tif (key == Attr.PARENT) return source;\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.ASYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTYxNjU2NA=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTMxMzg0OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSampleTimeout.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwODo1MTo1MlrOGpZDYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0Mjo1NVrOGpnmnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA1NTI2Ng==", "bodyText": "missing coverage of SampleTimeoutMain and SampleTimeoutOther inners", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446055266", "createdAt": "2020-06-26T08:51:52Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSampleTimeout.java", "diffHunk": "@@ -74,6 +74,12 @@ public int getPrefetch() {\n \t\treturn main;\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5MzY2Mw==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446293663", "createdAt": "2020-06-26T16:42:55Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSampleTimeout.java", "diffHunk": "@@ -74,6 +74,12 @@ public int getPrefetch() {\n \t\treturn main;\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA1NTI2Ng=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTM1NDExOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSubscribeOn.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwOTowNDoyOVrOGpZcVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0MzozMVrOGpnn7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA2MTY1NQ==", "bodyText": "This one and the inner should probably also report RUN_ON.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446061655", "createdAt": "2020-06-26T09:04:29Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSubscribeOn.java", "diffHunk": "@@ -69,6 +69,12 @@\n \t\treturn null;\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5Mzk5OA==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446293998", "createdAt": "2020-06-26T16:43:31Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxSubscribeOn.java", "diffHunk": "@@ -69,6 +69,12 @@\n \t\treturn null;\n \t}\n \n+\t@Override\n+\tpublic Object scanUnsafe(Attr key) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA2MTY1NQ=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTM5NDAxOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxTimeout.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwOToxNzoyOFrOGpZ1qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo0Mzo0OVrOGpnojA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA2ODEzOQ==", "bodyText": "I think it would make sense to cover TimeoutTimeoutSubscriber and TimeoutOtherSubscriber. They currently don't implement Scannable-via-InnerConsumer<T> though, so it would mean having them implement InnerConsumer<T> (which I think is acceptable)", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446068139", "createdAt": "2020-06-26T09:17:28Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxTimeout.java", "diffHunk": "@@ -295,6 +301,12 @@ void handleTimeout() {\n \t\t\t\tother.subscribe(new TimeoutOtherSubscriber<>(actual, this));\n \t\t\t}\n \t\t}\n+\n+\t\t@Override\n+\t\tpublic Object scanUnsafe(Attr key) {\n+\t\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;\n+\t\t\treturn super.scanUnsafe(key);\n+\t\t}\n \t}\n \n \tstatic final class TimeoutOtherSubscriber<T> implements CoreSubscriber<T> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5NDE1Ng==", "bodyText": "Fixed in commit 26552f6 - Could you please confirm main.currentContext is the proper one to be used?", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446294156", "createdAt": "2020-06-26T16:43:49Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxTimeout.java", "diffHunk": "@@ -295,6 +301,12 @@ void handleTimeout() {\n \t\t\t\tother.subscribe(new TimeoutOtherSubscriber<>(actual, this));\n \t\t\t}\n \t\t}\n+\n+\t\t@Override\n+\t\tpublic Object scanUnsafe(Attr key) {\n+\t\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;\n+\t\t\treturn super.scanUnsafe(key);\n+\t\t}\n \t}\n \n \tstatic final class TimeoutOtherSubscriber<T> implements CoreSubscriber<T> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA2ODEzOQ=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTQyMDg1OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/FluxZip.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwOToyNToyMFrOGpaGDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo1NDo1MlrOGpoAGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA3MjMzMg==", "bodyText": "missing coverage of ZipCoordinator", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446072332", "createdAt": "2020-06-26T09:25:20Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxZip.java", "diffHunk": "@@ -488,6 +490,7 @@ public Object scanUnsafe(Attr key) {\n \t\t\tif (key == Attr.ACTUAL) return parent;\n \t\t\tif (key == Attr.CANCELLED) return s == Operators.cancelledSubscription();\n \t\t\tif (key == Attr.BUFFERED) return parent.scalars[index] == null ? 0 : 1;\n+\t\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjMwMDE4Ng==", "bodyText": "Fixed in commit 0542a81", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446300186", "createdAt": "2020-06-26T16:54:52Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/FluxZip.java", "diffHunk": "@@ -488,6 +490,7 @@ public Object scanUnsafe(Attr key) {\n \t\t\tif (key == Attr.ACTUAL) return parent;\n \t\t\tif (key == Attr.CANCELLED) return s == Operators.cancelledSubscription();\n \t\t\tif (key == Attr.BUFFERED) return parent.scalars[index] == null ? 0 : 1;\n+\t\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA3MjMzMg=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTQ1MDc2OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/MonoCompletionStage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwOTozNTowNFrOGpaY4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo1NDo0NVrOGpn_4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA3NzE1Mg==", "bodyText": "This one is ASYNC, as the Thread that complete the CompletionStage might be different than the one that performs the conversion from CompletionStage to Mono.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446077152", "createdAt": "2020-06-26T09:35:04Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoCompletionStage.java", "diffHunk": "@@ -98,6 +94,7 @@ else if (v != null) {\n \n     @Override\n     public Object scanUnsafe(Attr key) {\n-        return null; //no particular key to be represented, still useful in hooks\n+        if (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjMwMDEyOA==", "bodyText": "Fixed in commit 0542a81", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446300128", "createdAt": "2020-06-26T16:54:45Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoCompletionStage.java", "diffHunk": "@@ -98,6 +94,7 @@ else if (v != null) {\n \n     @Override\n     public Object scanUnsafe(Attr key) {\n-        return null; //no particular key to be represented, still useful in hooks\n+        if (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA3NzE1Mg=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTQ1OTE0OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/MonoCreate.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwOTozNzo1MVrOGpaeKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo1NDozNlrOGpn_jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA3ODUwNg==", "bodyText": "Like FluxCreate, MonoCreate is ASYNC> It is debatable for the sink itself, since it is unlikely to be wrapped by hooks, but to be on the safe side let's mark it as ASYNC too.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446078506", "createdAt": "2020-06-26T09:37:51Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoCreate.java", "diffHunk": "@@ -115,6 +116,9 @@ public Object scanUnsafe(Attr key) {\n \t\t\tif (key == Attr.CANCELLED) {\n \t\t\t\treturn disposable == CANCELLED;\n \t\t\t}\n+\t\t\tif (key == Attr.RUN_STYLE) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjMwMDA0Ng==", "bodyText": "Fixed in commit 0542a81", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446300046", "createdAt": "2020-06-26T16:54:36Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoCreate.java", "diffHunk": "@@ -115,6 +116,9 @@ public Object scanUnsafe(Attr key) {\n \t\t\tif (key == Attr.CANCELLED) {\n \t\t\t\treturn disposable == CANCELLED;\n \t\t\t}\n+\t\t\tif (key == Attr.RUN_STYLE) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA3ODUwNg=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTQ1OTIxOnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/MonoCreate.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwOTozNzo1NFrOGpaeNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo1NDozMVrOGpn_Ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA3ODUxOA==", "bodyText": "Like FluxCreate, MonoCreate is ASYNC", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446078518", "createdAt": "2020-06-26T09:37:54Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoCreate.java", "diffHunk": "@@ -63,7 +63,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5OTk5NQ==", "bodyText": "Fixed in commit 0542a81", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446299995", "createdAt": "2020-06-26T16:54:31Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoCreate.java", "diffHunk": "@@ -63,7 +63,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA3ODUxOA=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTUxOTQ2OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/MonoHide.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwOTo1NzoxOVrOGpbECw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo1MTozM1rOGpn5VA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA4ODIwMw==", "bodyText": "as discussed in ConnectableFluxHide and FluxHide, I think it makes better sense to reply SYNC for xxxHide operators.", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446088203", "createdAt": "2020-06-26T09:57:19Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoHide.java", "diffHunk": "@@ -37,4 +38,10 @@\n     public CoreSubscriber<? super T> subscribeOrReturn(CoreSubscriber<? super T> actual) {\n         return new FluxHide.HideSubscriber<>(actual);\n     }\n+\n+    @Override\n+    public Object scanUnsafe(Attr key) {\n+        if (key == Attr.RUN_STYLE) return Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5ODQ1Mg==", "bodyText": "Fixed in commit 26552f6", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446298452", "createdAt": "2020-06-26T16:51:33Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoHide.java", "diffHunk": "@@ -37,4 +38,10 @@\n     public CoreSubscriber<? super T> subscribeOrReturn(CoreSubscriber<? super T> actual) {\n         return new FluxHide.HideSubscriber<>(actual);\n     }\n+\n+    @Override\n+    public Object scanUnsafe(Attr key) {\n+        if (key == Attr.RUN_STYLE) return Scannable.from(source).scanUnsafe(key);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA4ODIwMw=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc3OTU2MTY5OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/MonoUsing.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxMDoxMjozMlrOGpbfwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNjo1NDoyNFrOGpn_Gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA5NTI5Nw==", "bodyText": "should also cover MonoUsingSubscriber", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446095297", "createdAt": "2020-06-26T10:12:32Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoUsing.java", "diffHunk": "@@ -116,7 +116,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjI5OTkzMA==", "bodyText": "Fixed in commit 0542a81", "url": "https://github.com/reactor/reactor-core/pull/2123#discussion_r446299930", "createdAt": "2020-06-26T16:54:24Z", "author": {"login": "aneveu"}, "path": "reactor-core/src/main/java/reactor/core/publisher/MonoUsing.java", "diffHunk": "@@ -116,7 +116,8 @@ public void subscribe(CoreSubscriber<? super T> actual) {\n \n \t@Override\n \tpublic Object scanUnsafe(Attr key) {\n-\t\treturn null; //no particular key to be represented, still useful in hooks\n+\t\tif (key == Attr.RUN_STYLE) return Attr.RunStyle.SYNC;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjA5NTI5Nw=="}, "originalCommit": {"oid": "a1387b68205b077036a7f0b8fb5c97fa74ffb597"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1030, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}