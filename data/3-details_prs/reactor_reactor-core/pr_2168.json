{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwODIxNzY5", "number": 2168, "title": "fix #2160 Accommodate ASYNC fusion in Mono.metrics()", "bodyText": "Closes #2160", "createdAt": "2020-05-20T15:19:17Z", "url": "https://github.com/reactor/reactor-core/pull/2168", "merged": true, "mergeCommit": {"oid": "7c401de75e046ad4e03c32ea5fc23943f004e69b"}, "closed": true, "closedAt": "2020-05-27T16:17:29Z", "author": {"login": "alex-dukhno"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjKtSggBqjMzNTcwMDE5Nzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclWO4pgFqTQxOTAzNzExMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ee4c60ba6ce6291e58bdf72782dfaa32a8052dd0", "author": {"user": {"login": "alex-dukhno", "name": "Alex Dukhno"}}, "url": "https://github.com/reactor/reactor-core/commit/ee4c60ba6ce6291e58bdf72782dfaa32a8052dd0", "committedDate": "2020-05-20T15:17:49Z", "message": "fix hanging case"}, "afterCommit": {"oid": "d23a7b2d0e4bce0a4f2c353ecdbd79873b39a3be", "author": {"user": {"login": "alex-dukhno", "name": "Alex Dukhno"}}, "url": "https://github.com/reactor/reactor-core/commit/d23a7b2d0e4bce0a4f2c353ecdbd79873b39a3be", "committedDate": "2020-05-20T15:21:47Z", "message": "fix hanging case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3NjMwNDcy", "url": "https://github.com/reactor/reactor-core/pull/2168#pullrequestreview-417630472", "createdAt": "2020-05-25T10:53:30Z", "commit": {"oid": "d23a7b2d0e4bce0a4f2c353ecdbd79873b39a3be"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MDY4MjI1", "url": "https://github.com/reactor/reactor-core/pull/2168#pullrequestreview-418068225", "createdAt": "2020-05-26T08:14:43Z", "commit": {"oid": "70a66530371b1a269a579d3963babc9f3f4f3713"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoxNDo0NFrOGaTawQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwODoxNDo0NFrOGaTawQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDIzNDMwNQ==", "bodyText": "the Duration in the verify method is an upper bound after which the test times out. 1ms is a bit short, as it could hiccup (eg. on CI machines). I suggest you raise it to Duration.ofSeconds(1) everywhere just to be on the safe side", "url": "https://github.com/reactor/reactor-core/pull/2168#discussion_r430234305", "createdAt": "2020-05-26T08:14:44Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/test/java/reactor/core/publisher/FluxMetricsTest.java", "diffHunk": "@@ -456,4 +459,29 @@ public void flowDurationTagsConsistency() {\n \n \t\tassertThat(uniqueTagKeySets).hasSize(1);\n \t}\n+\n+\t@Test\n+\tpublic void ensureFuseablePropagateOnComplete_inCaseOfAsyncFusion() {\n+\t\tFlux.fromIterable(Arrays.asList(1, 2, 3))\n+\t\t    .metrics()\n+\t\t    .flatMapIterable(Arrays::asList)\n+\t\t    .as(StepVerifier::create)\n+\t\t    .expectNext(1, 2, 3)\n+\t\t    .expectComplete()\n+\t\t    .verify(Duration.ofMillis(1));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70a66530371b1a269a579d3963babc9f3f4f3713"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "718fc24f5888b4860c6fee524f8133d5bc86e949", "author": {"user": {"login": "alex-dukhno", "name": "Alex Dukhno"}}, "url": "https://github.com/reactor/reactor-core/commit/718fc24f5888b4860c6fee524f8133d5bc86e949", "committedDate": "2020-05-27T09:50:18Z", "message": "override onNext in MonoMetricsFuseable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "769ba5d586b14b505e2c676cb116f5ea84e16c00", "author": {"user": {"login": "alex-dukhno", "name": "Alex Dukhno"}}, "url": "https://github.com/reactor/reactor-core/commit/769ba5d586b14b505e2c676cb116f5ea84e16c00", "committedDate": "2020-05-27T09:50:19Z", "message": "fix hanging case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a34e947d091b3645e7f6ed52e0101dc7362f139f", "author": {"user": {"login": "alex-dukhno", "name": "Alex Dukhno"}}, "url": "https://github.com/reactor/reactor-core/commit/a34e947d091b3645e7f6ed52e0101dc7362f139f", "committedDate": "2020-05-27T09:50:19Z", "message": "added tests for Flux"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "70a66530371b1a269a579d3963babc9f3f4f3713", "author": {"user": {"login": "alex-dukhno", "name": "Alex Dukhno"}}, "url": "https://github.com/reactor/reactor-core/commit/70a66530371b1a269a579d3963babc9f3f4f3713", "committedDate": "2020-05-25T15:02:05Z", "message": "added tests for Flux"}, "afterCommit": {"oid": "a34e947d091b3645e7f6ed52e0101dc7362f139f", "author": {"user": {"login": "alex-dukhno", "name": "Alex Dukhno"}}, "url": "https://github.com/reactor/reactor-core/commit/a34e947d091b3645e7f6ed52e0101dc7362f139f", "committedDate": "2020-05-27T09:50:19Z", "message": "added tests for Flux"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3e781e05c1ee91528f669385fbdcc68549aa814", "author": {"user": {"login": "simonbasle", "name": "Simon Basl\u00e9"}}, "url": "https://github.com/reactor/reactor-core/commit/b3e781e05c1ee91528f669385fbdcc68549aa814", "committedDate": "2020-05-27T09:54:59Z", "message": "fixup max duration of verify in tests, 1ms is too short"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MDM3MTEy", "url": "https://github.com/reactor/reactor-core/pull/2168#pullrequestreview-419037112", "createdAt": "2020-05-27T09:55:27Z", "commit": {"oid": "b3e781e05c1ee91528f669385fbdcc68549aa814"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2983, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}