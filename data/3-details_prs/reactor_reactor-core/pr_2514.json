{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4MjgyNDA0", "number": 2514, "title": "fix #2513 ReplayProcessor now correctly pass nanos to buffer, not ms", "bodyText": "Fixes ReplayProcessor factory method by passing nanos instead of millis to SizeAndTimeBoundReplayBuffer constructor. This results in proper behavior of Sinks.many().replay(Duration) which now respects the retention time properly", "createdAt": "2020-11-26T22:15:14Z", "url": "https://github.com/reactor/reactor-core/pull/2514", "merged": true, "mergeCommit": {"oid": "33c9d0e627c10c8f186c87459f8b2e74d31a0a93"}, "closed": true, "closedAt": "2020-11-27T17:19:29Z", "author": {"login": "dowgiallom"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgk9lwAFqTUzOTg2NDk3Nw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgq1BGAFqTU0MDExMDI3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5ODY0OTc3", "url": "https://github.com/reactor/reactor-core/pull/2514#pullrequestreview-539864977", "createdAt": "2020-11-27T10:22:21Z", "commit": {"oid": "f9dc7e6f02590ce81f774a1bb1c8836de66e2b14"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMDoyMjoyMlrOH64zYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMDoyNjowNlrOH647Jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUxMDExNQ==", "bodyText": "please at least setup the replaySink in a @BeforeEach so that each test get their own", "url": "https://github.com/reactor/reactor-core/pull/2514#discussion_r531510115", "createdAt": "2020-11-27T10:22:22Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/test/java/reactor/core/publisher/SinksTest.java", "diffHunk": "@@ -165,6 +165,39 @@ void noReplayBeforeFirstSubscriberIfEarlyError() {\n \t\t}\n \t}\n \n+\t@Nested\n+\tclass MulticastReplayDuration {\n+\n+\t\tfinal Duration            duration = Duration.ofMillis(1000);\n+\t\tfinal Sinks.Many<Integer> replaySink = Sinks.many().replay().limit(duration);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f9dc7e6f02590ce81f774a1bb1c8836de66e2b14"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUxMjEwMw==", "bodyText": "nitpick: I'd add a comment referencing the issue to avoid somebody later changing the retention duration or the minusMillis(1) instruction for example", "url": "https://github.com/reactor/reactor-core/pull/2514#discussion_r531512103", "createdAt": "2020-11-27T10:26:06Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/test/java/reactor/core/publisher/SinksTest.java", "diffHunk": "@@ -165,6 +165,39 @@ void noReplayBeforeFirstSubscriberIfEarlyError() {\n \t\t}\n \t}\n \n+\t@Nested\n+\tclass MulticastReplayDuration {\n+\n+\t\tfinal Duration            duration = Duration.ofMillis(1000);\n+\t\tfinal Sinks.Many<Integer> replaySink = Sinks.many().replay().limit(duration);\n+\t\tfinal Flux<Integer>       flux = replaySink.asFlux();\n+\t\tfinal int \t\t\t\t  event = 12;\n+\n+\t\t@Test\n+\t\tvoid lateSubscriberReceivesEventInRetentionTime() {\n+\t\t\treplaySink.emitNext(event, FAIL_FAST);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f9dc7e6f02590ce81f774a1bb1c8836de66e2b14"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bac63849d49ebe0b8c11ab32dc84ccaf7e8a51b7", "author": {"user": null}, "url": "https://github.com/reactor/reactor-core/commit/bac63849d49ebe0b8c11ab32dc84ccaf7e8a51b7", "committedDate": "2020-11-27T16:37:24Z", "message": "fix #2513 ReplayProcessor passing millis instead of nanos to buffer\n\nFixes ReplayProcessor factory method by passing nanos instead of millis to SizeAndTimeBoundReplayBuffer constructor. This results in proper behavior of Sinks.many().replay(Duration) which now respects the retention time properly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb4c875ba635e7108665698e9f026277d2f6300e", "author": {"user": {"login": "dowgiallom", "name": null}}, "url": "https://github.com/reactor/reactor-core/commit/bb4c875ba635e7108665698e9f026277d2f6300e", "committedDate": "2020-11-27T16:37:24Z", "message": "2513 Review remarks improvements"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d980de8a432071fd618443203cd33e2a3448dc1b", "author": {"user": {"login": "dowgiallom", "name": null}}, "url": "https://github.com/reactor/reactor-core/commit/d980de8a432071fd618443203cd33e2a3448dc1b", "committedDate": "2020-11-27T11:39:59Z", "message": "2513 Review remarks improvements"}, "afterCommit": {"oid": "bb4c875ba635e7108665698e9f026277d2f6300e", "author": {"user": {"login": "dowgiallom", "name": null}}, "url": "https://github.com/reactor/reactor-core/commit/bb4c875ba635e7108665698e9f026277d2f6300e", "committedDate": "2020-11-27T16:37:24Z", "message": "2513 Review remarks improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMTEwMjcw", "url": "https://github.com/reactor/reactor-core/pull/2514#pullrequestreview-540110270", "createdAt": "2020-11-27T17:16:44Z", "commit": {"oid": "bb4c875ba635e7108665698e9f026277d2f6300e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2716, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}