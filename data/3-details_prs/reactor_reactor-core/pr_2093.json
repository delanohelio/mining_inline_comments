{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2MzgzMDA2", "number": 2093, "title": "[test] Remove testStaticInit task, verify in main test task", "bodyText": "The special task is there to test static initialization of a single\nsystem property, which can be made more testable by extracting an\ninitializing method. This limits the risk that different tests that\nreset the hooks would impact that staticInit test.\nWe fix that early on, but we already saw a manifestation of potential\nissue on 3.3 (master):\n\nJUnit 5 is used with both Jupiter engine and Vintage engine\na TestExecutionListener is added that resets all hooks after test\nmethods but also classes and test engines\nGradle 6 seems to induce an empty execution of the Jupiter engine\nbefore the Vintage engine, which resets the hook (including the\nstatically initialized GLOBAL_TRACE)", "createdAt": "2020-03-31T14:41:26Z", "url": "https://github.com/reactor/reactor-core/pull/2093", "merged": true, "mergeCommit": {"oid": "eb8753bc1b1701aca428c5762ae257f3f3fe53e3"}, "closed": true, "closedAt": "2020-03-31T14:58:47Z", "author": {"login": "simonbasle"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTEEt8gH2gAyMzk2MzgzMDA2OjgwNzdiZDNmNGYzNjcxY2U1ZmZmMzQzZTllYzY2YWFjMjFkOGNlNTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTEmzlgFqTM4NDgzNDY3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8077bd3f4f3671ce5fff343e9ec66aac21d8ce50", "author": {"user": {"login": "simonbasle", "name": "Simon Basl\u00e9"}}, "url": "https://github.com/reactor/reactor-core/commit/8077bd3f4f3671ce5fff343e9ec66aac21d8ce50", "committedDate": "2020-03-31T14:35:25Z", "message": "[test] Remove testStaticInit task, verify in main test task\n\nThe special task is there to test static initialization of a single\nsystem property, which can be made more testable by extracting an\ninitializing method. This limits the risk that different tests that\nreset the hooks would impact that staticInit test.\n\nWe fix that early on, but we already saw a manifestation of potential\nissue on 3.3 (`master`):\n - JUnit 5 is used with both Jupiter engine and Vintage engine\n - a TestExecutionListener is added that resets all hooks after test\n methods but also classes and test engines\n - Gradle 6 seems to induce an empty execution of the Jupiter engine\n before the Vintage engine, which resets the hook (including the\n statically initialized GLOBAL_TRACE)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0ODIwMzk5", "url": "https://github.com/reactor/reactor-core/pull/2093#pullrequestreview-384820399", "createdAt": "2020-03-31T14:58:06Z", "commit": {"oid": "8077bd3f4f3671ce5fff343e9ec66aac21d8ce50"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0ODM0Njc2", "url": "https://github.com/reactor/reactor-core/pull/2093#pullrequestreview-384834676", "createdAt": "2020-03-31T15:12:38Z", "commit": {"oid": "8077bd3f4f3671ce5fff343e9ec66aac21d8ce50"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNToxMjozOVrOF-atMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxNToxMjozOVrOF-atMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk5MzU4Nw==", "bodyText": "@simonbasle these tests were triggered by a chain (check -> testStaticInit -must-run-after-> loops) but now they are not executed at all.\nConsider adding dependsOn(loops) to check's config", "url": "https://github.com/reactor/reactor-core/pull/2093#discussion_r400993587", "createdAt": "2020-03-31T15:12:39Z", "author": {"login": "bsideup"}, "path": "reactor-core/build.gradle", "diffHunk": "@@ -212,29 +212,15 @@ task kdocZip(type: Zip, dependsOn: dokka) {\n   from(\"${project.buildDir}/docs/kdoc\")\n }\n \n-task testStaticInit(type: Test, group: 'verification') {\n-  systemProperty 'reactor.trace.operatorStacktrace', 'true'\n-  include '**/*TestStaticInit.*'\n-  doFirst {\n-\tprintln \"Additional tests from `testStaticInit` ($includes)\"\n-  }\n-  afterSuite { TestDescriptor descriptor, TestResult result ->\n-\tif (result.testCount > 0 && (result.skippedTestCount + result.failedTestCount + result.successfulTestCount == 0)) {\n-\t  throw new GradleException(\"No static initialization tests were executed\")\n-\t}\n-  }\n-}\n \n task loops(type: Test, group: 'verification') {\n-  mustRunAfter testStaticInit", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8077bd3f4f3671ce5fff343e9ec66aac21d8ce50"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2934, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}