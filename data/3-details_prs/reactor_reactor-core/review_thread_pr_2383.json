{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3ODU5MTkx", "number": 2383, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTo0MjozNlrOEj-bUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwODo1MzoyOFrOEk4MlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTU4NDE3OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTo0MjozNlrOHSo36g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwNzo1NjoyN1rOHUCLAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwNjA5MA==", "bodyText": "WDYT about using isSubscribed(), to avoid singular vs plural confusion?", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r489306090", "createdAt": "2020-09-16T09:42:36Z", "author": {"login": "bsideup"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "diffHunk": "@@ -600,6 +600,17 @@ public Emission getReason() {\n \t\t@Deprecated\n \t\tvoid emitError(Throwable error);\n \n+\t\t/**\n+\t\t * Determines if the sink currently has at least one subscriber.\n+\t\t * <p>\n+\t\t * This is a best effort peek at the sink state, and a subsequent attempt at emitting\n+\t\t * to the sink might still return {@link Emission#FAIL_ZERO_SUBSCRIBER} where relevant\n+\t\t * (generally in {@link #tryEmitNext(Object)}).\n+\t\t *\n+\t\t * @return {@code true} if the sink has at least one subscriber at the time of invocation, {@code false} otherwise\n+\t\t */\n+\t\tboolean hasSubscriber();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2273cb5bc868d73dfb58baa343a9ddcd0e7873fa"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMxMTUzNg==", "bodyText": "I think it could introduce even more cognitive dissonance since it can either be read as \"the sink is subscribed to something\" or \"the sink is subscribed to by something\" \ud83e\udd14", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r489311536", "createdAt": "2020-09-16T09:51:17Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "diffHunk": "@@ -600,6 +600,17 @@ public Emission getReason() {\n \t\t@Deprecated\n \t\tvoid emitError(Throwable error);\n \n+\t\t/**\n+\t\t * Determines if the sink currently has at least one subscriber.\n+\t\t * <p>\n+\t\t * This is a best effort peek at the sink state, and a subsequent attempt at emitting\n+\t\t * to the sink might still return {@link Emission#FAIL_ZERO_SUBSCRIBER} where relevant\n+\t\t * (generally in {@link #tryEmitNext(Object)}).\n+\t\t *\n+\t\t * @return {@code true} if the sink has at least one subscriber at the time of invocation, {@code false} otherwise\n+\t\t */\n+\t\tboolean hasSubscriber();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwNjA5MA=="}, "originalCommit": {"oid": "2273cb5bc868d73dfb58baa343a9ddcd0e7873fa"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMxNTA1Mw==", "bodyText": "On a side note I elected to use singular rather than plural form because I find plural form to be more easily interpreted as \"strictly greater than one\" semantic, while singular can be better accepted as meaning \"at least one\". Plus plural form would feel weird on unicast variants.", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r489315053", "createdAt": "2020-09-16T09:57:14Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "diffHunk": "@@ -600,6 +600,17 @@ public Emission getReason() {\n \t\t@Deprecated\n \t\tvoid emitError(Throwable error);\n \n+\t\t/**\n+\t\t * Determines if the sink currently has at least one subscriber.\n+\t\t * <p>\n+\t\t * This is a best effort peek at the sink state, and a subsequent attempt at emitting\n+\t\t * to the sink might still return {@link Emission#FAIL_ZERO_SUBSCRIBER} where relevant\n+\t\t * (generally in {@link #tryEmitNext(Object)}).\n+\t\t *\n+\t\t * @return {@code true} if the sink has at least one subscriber at the time of invocation, {@code false} otherwise\n+\t\t */\n+\t\tboolean hasSubscriber();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwNjA5MA=="}, "originalCommit": {"oid": "2273cb5bc868d73dfb58baa343a9ddcd0e7873fa"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMxODQyNw==", "bodyText": "if we follow this path, the same applies to \"the sink has a subscriber that it created\" vs \"there is a subscriber and this sink has it\" :D in fact, the latter is even more confusing IMO :)", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r489318427", "createdAt": "2020-09-16T10:02:35Z", "author": {"login": "bsideup"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "diffHunk": "@@ -600,6 +600,17 @@ public Emission getReason() {\n \t\t@Deprecated\n \t\tvoid emitError(Throwable error);\n \n+\t\t/**\n+\t\t * Determines if the sink currently has at least one subscriber.\n+\t\t * <p>\n+\t\t * This is a best effort peek at the sink state, and a subsequent attempt at emitting\n+\t\t * to the sink might still return {@link Emission#FAIL_ZERO_SUBSCRIBER} where relevant\n+\t\t * (generally in {@link #tryEmitNext(Object)}).\n+\t\t *\n+\t\t * @return {@code true} if the sink has at least one subscriber at the time of invocation, {@code false} otherwise\n+\t\t */\n+\t\tboolean hasSubscriber();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwNjA5MA=="}, "originalCommit": {"oid": "2273cb5bc868d73dfb58baa343a9ddcd0e7873fa"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUwNTQ0MA==", "bodyText": "Some further thoughts. The method could return the number of current subscribers, if that extra information has potential to be useful? Also it would be nice for the the name to include something like \"current\" or \"active\" to indicate the transient nature.", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r489505440", "createdAt": "2020-09-16T14:58:24Z", "author": {"login": "rstoyanchev"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "diffHunk": "@@ -600,6 +600,17 @@ public Emission getReason() {\n \t\t@Deprecated\n \t\tvoid emitError(Throwable error);\n \n+\t\t/**\n+\t\t * Determines if the sink currently has at least one subscriber.\n+\t\t * <p>\n+\t\t * This is a best effort peek at the sink state, and a subsequent attempt at emitting\n+\t\t * to the sink might still return {@link Emission#FAIL_ZERO_SUBSCRIBER} where relevant\n+\t\t * (generally in {@link #tryEmitNext(Object)}).\n+\t\t *\n+\t\t * @return {@code true} if the sink has at least one subscriber at the time of invocation, {@code false} otherwise\n+\t\t */\n+\t\tboolean hasSubscriber();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwNjA5MA=="}, "originalCommit": {"oid": "2273cb5bc868d73dfb58baa343a9ddcd0e7873fa"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc2OTE1NA==", "bodyText": "done, with activeSubscriberCount()", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r490769154", "createdAt": "2020-09-18T07:56:27Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "diffHunk": "@@ -600,6 +600,17 @@ public Emission getReason() {\n \t\t@Deprecated\n \t\tvoid emitError(Throwable error);\n \n+\t\t/**\n+\t\t * Determines if the sink currently has at least one subscriber.\n+\t\t * <p>\n+\t\t * This is a best effort peek at the sink state, and a subsequent attempt at emitting\n+\t\t * to the sink might still return {@link Emission#FAIL_ZERO_SUBSCRIBER} where relevant\n+\t\t * (generally in {@link #tryEmitNext(Object)}).\n+\t\t *\n+\t\t * @return {@code true} if the sink has at least one subscriber at the time of invocation, {@code false} otherwise\n+\t\t */\n+\t\tboolean hasSubscriber();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwNjA5MA=="}, "originalCommit": {"oid": "2273cb5bc868d73dfb58baa343a9ddcd0e7873fa"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTU5MDE5OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/test/java/reactor/core/publisher/DirectProcessorTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTo0NDowOFrOHSo7jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTo0NDowOFrOHSo7jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwNzAyMw==", "bodyText": "note for reviewers: DirectProcessorTest should ideally be re-formatted to use tabs consistently. in order not to pollute this PR's commit, I've only let the IDE reintroduce tabs on modified lines.", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r489307023", "createdAt": "2020-09-16T09:44:08Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/test/java/reactor/core/publisher/DirectProcessorTest.java", "diffHunk": "@@ -133,10 +133,10 @@ public void error() {\n \n         tp.subscribe(ts);\n \n-        Assert.assertTrue(\"No subscribers?\", Scannable.from(tp).inners().count() != 0);\n-        Assert.assertFalse(\"Completed?\", tp.hasCompleted());\n-        Assert.assertNull(\"Has error?\", tp.getError());\n-        Assert.assertFalse(\"Has error?\", tp.hasError());\n+\t    assertThat(tp.hasSubscriber()).as(\"hasSubscriber\").isTrue();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2273cb5bc868d73dfb58baa343a9ddcd0e7873fa"}, "originalPosition": 68}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTU5ODUwOnYy", "diffSide": "LEFT", "path": "reactor-core/src/test/java/reactor/core/publisher/FluxSampleFirstTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTo0NjowMlrOHSpAXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTo0NjowMlrOHSpAXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwODI1Mg==", "bodyText": "there was a bug in the tests messages here", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r489308252", "createdAt": "2020-09-16T09:46:02Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/test/java/reactor/core/publisher/FluxSampleFirstTest.java", "diffHunk": "@@ -72,9 +74,9 @@ public void normal() {\n \t\t  .assertNoError()\n \t\t  .assertComplete();\n \n-\t\tAssert.assertFalse(\"sp1 has subscribers?\", Scannable.from(sp1).inners().findAny().isPresent());\n-\t\tAssert.assertFalse(\"sp1 has subscribers?\", Scannable.from(sp2).inners().findAny().isPresent());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2273cb5bc868d73dfb58baa343a9ddcd0e7873fa"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA2MTYwMjE4OnYy", "diffSide": "LEFT", "path": "reactor-core/src/test/java/reactor/core/publisher/FluxWindowBoundaryTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTo0NzowNFrOHSpClA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQwOTo0NzowNFrOHSpClA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMwODgyMA==", "bodyText": "there was a bug in the assertion here, asserting the wrong value!", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r489308820", "createdAt": "2020-09-16T09:47:04Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/test/java/reactor/core/publisher/FluxWindowBoundaryTest.java", "diffHunk": "@@ -82,8 +82,8 @@ public void normal() {\n \t\tts.assertNoError()\n \t\t  .assertComplete();\n \n-\t\tAssert.assertFalse(\"sp1 has subscribers\", Scannable.from(sp1).inners().findAny().isPresent());\n-\t\tAssert.assertFalse(\"sp2 has subscribers\", Scannable.from(sp1).inners().findAny().isPresent());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2273cb5bc868d73dfb58baa343a9ddcd0e7873fa"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3MTA0OTE2OnYy", "diffSide": "RIGHT", "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQwODo1MzoyOFrOHUEHMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQxMDowNzo0NlrOHUGrwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDgwMDk0Nw==", "bodyText": "should we maybe define \"active\" here? Otherwise, someone may think that \"active\" == \"ready to consume / requested\", which isn't the case", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r490800947", "createdAt": "2020-09-18T08:53:28Z", "author": {"login": "bsideup"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "diffHunk": "@@ -600,6 +600,17 @@ public Emission getReason() {\n \t\t@Deprecated\n \t\tvoid emitError(Throwable error);\n \n+\t\t/**\n+\t\t * Determines how many active {@link Subscriber Subscribers} the sink currently has.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f75d31451167e898f1d4b84f738b56749d8074c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg0MzA3Mg==", "bodyText": "current sounds less ambiguous, I'll change to that and explain a bit more in the javadoc", "url": "https://github.com/reactor/reactor-core/pull/2383#discussion_r490843072", "createdAt": "2020-09-18T10:07:46Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Sinks.java", "diffHunk": "@@ -600,6 +600,17 @@ public Emission getReason() {\n \t\t@Deprecated\n \t\tvoid emitError(Throwable error);\n \n+\t\t/**\n+\t\t * Determines how many active {@link Subscriber Subscribers} the sink currently has.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDgwMDk0Nw=="}, "originalCommit": {"oid": "3f75d31451167e898f1d4b84f738b56749d8074c"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 966, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}