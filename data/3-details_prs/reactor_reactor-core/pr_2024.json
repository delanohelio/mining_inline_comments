{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3NDc2MTU0", "number": 2024, "title": "Fix #2023 by handling \"empty `Callable`\" case in `Flux#collectList`", "bodyText": "It seems that we were handling Callable (but not Fuseable.ScalarCallable) incorrectly\nand, instead of producing an empty list, were returning an empty Mono instead.\nThe change also simplifies handling of Fuseable.ScalarCallable", "createdAt": "2020-01-27T12:57:00Z", "url": "https://github.com/reactor/reactor-core/pull/2024", "merged": true, "mergeCommit": {"oid": "e93cd9dc1cf3f88e4dc3fc4cbbc767a8db3166e8"}, "closed": true, "closedAt": "2020-01-27T15:03:12Z", "author": {"login": "bsideup"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-cQ0ogH2gAyMzY3NDc2MTU0Ojg5YzhjOTZmYWFmY2JkNWEzNjMyNWVkNGJmYjIwYjc0MWU5MjA4ZDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb-dBh0gFqTM0ODY3MTY1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "89c8c96faafcbd5a36325ed4bfb20b741e9208d8", "author": {"user": {"login": "bsideup", "name": "Sergei Egorov"}}, "url": "https://github.com/reactor/reactor-core/commit/89c8c96faafcbd5a36325ed4bfb20b741e9208d8", "committedDate": "2020-01-27T12:53:57Z", "message": "Fix #2023 by handling \"empty `Callable`\" case in `Flux#collectList`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97e6c585de34f2e38dd2356283df0b02b57370bf", "author": {"user": {"login": "bsideup", "name": "Sergei Egorov"}}, "url": "https://github.com/reactor/reactor-core/commit/97e6c585de34f2e38dd2356283df0b02b57370bf", "committedDate": "2020-01-27T13:16:05Z", "message": "always return a new list from `Fuseable.ScalarCallable` branch"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NjU0NDc0", "url": "https://github.com/reactor/reactor-core/pull/2024#pullrequestreview-348654474", "createdAt": "2020-01-27T13:19:51Z", "commit": {"oid": "97e6c585de34f2e38dd2356283df0b02b57370bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMzoxOTo1MVrOFiCWTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMzoxOTo1MVrOFiCWTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTIzNDM4Mg==", "bodyText": "@simonbasle I believe a single fromCallable is better than just + map and easier to follow. WDYT?", "url": "https://github.com/reactor/reactor-core/pull/2024#discussion_r371234382", "createdAt": "2020-01-27T13:19:51Z", "author": {"login": "bsideup"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Flux.java", "diffHunk": "@@ -3184,23 +3184,25 @@ public final T blockLast(Duration timeout) {\n \t\t\t\tcatch (Exception e) {\n \t\t\t\t\treturn Mono.error(e);\n \t\t\t\t}\n-\t\t\t\tif (v == null) {\n-\t\t\t\t\treturn Mono.onAssembly(new MonoSupplier<>(listSupplier()));\n-\t\t\t\t}\n-\t\t\t\treturn Mono.just(v).map(u -> {\n+\t\t\t\treturn Mono.fromCallable(() -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97e6c585de34f2e38dd2356283df0b02b57370bf"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NjU2Mjk4", "url": "https://github.com/reactor/reactor-core/pull/2024#pullrequestreview-348656298", "createdAt": "2020-01-27T13:22:52Z", "commit": {"oid": "97e6c585de34f2e38dd2356283df0b02b57370bf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMzoyMjo1MlrOFiCcAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxMzoyMjo1MlrOFiCcAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTIzNTg0Mw==", "bodyText": "I would suggest to use the form onAssembly(new MonoCallable<>(...)) here and below, so that there is no additional step in the backtrace that corresponds to the fromCallable call.", "url": "https://github.com/reactor/reactor-core/pull/2024#discussion_r371235843", "createdAt": "2020-01-27T13:22:52Z", "author": {"login": "simonbasle"}, "path": "reactor-core/src/main/java/reactor/core/publisher/Flux.java", "diffHunk": "@@ -3184,23 +3184,25 @@ public final T blockLast(Duration timeout) {\n \t\t\t\tcatch (Exception e) {\n \t\t\t\t\treturn Mono.error(e);\n \t\t\t\t}\n-\t\t\t\tif (v == null) {\n-\t\t\t\t\treturn Mono.onAssembly(new MonoSupplier<>(listSupplier()));\n-\t\t\t\t}\n-\t\t\t\treturn Mono.just(v).map(u -> {\n+\t\t\t\treturn Mono.fromCallable(() -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97e6c585de34f2e38dd2356283df0b02b57370bf"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a44b7f8207616792076c312926ae510281e9466", "author": {"user": {"login": "bsideup", "name": "Sergei Egorov"}}, "url": "https://github.com/reactor/reactor-core/commit/2a44b7f8207616792076c312926ae510281e9466", "committedDate": "2020-01-27T13:26:40Z", "message": "Use `Mono.onAssembly` + `MonoCallable`"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4NjcxNjU3", "url": "https://github.com/reactor/reactor-core/pull/2024#pullrequestreview-348671657", "createdAt": "2020-01-27T13:47:09Z", "commit": {"oid": "2a44b7f8207616792076c312926ae510281e9466"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2895, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}