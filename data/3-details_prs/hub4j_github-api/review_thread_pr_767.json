{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2ODc5NzU1", "number": 767, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMDozNzowMVrODteZLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo1MDo1NVrODu1Xew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MDEwNDc5OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMDozNzowMVrOF-6wlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QwNjoxOTowNVrOGAGcIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTUxODc0Mg==", "bodyText": "Construct a new object to represent the repository since the payload only contains a small part of GHRepository; it would to safer to use. But not so sure where we should put it.", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r401518742", "createdAt": "2020-04-01T10:37:01Z", "author": {"login": "XiongKezhi"}, "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "diffHunk": "@@ -207,6 +208,164 @@ void wrapUp(GitHub root) {\n         }\n     }\n \n+    /**\n+     * Represents a repository object specifically for {@link Installation} and {@link InstallationRepositories}.\n+     */\n+    @SuppressFBWarnings(value = { \"UWF_UNWRITTEN_FIELD\" }, justification = \"JSON API\")\n+    public static class InstallationRepository {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32ff315b6bb60aa4dd7b4f7d653622fe796a7e7a"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc1Njk1Mw==", "bodyText": "@XiongKezhi\nThe pattern has been to reuse existing classes.  Then there are two options:\n\neagerly populate()/refresh() all the items during wrapup()/lateBind() - this results in a multiple api requests up front but returns stable fully populated objects\nonly populate()/refresh() each item when user requests data that is missing from partial - can save a ton of requests but adds complexity to target class (missing fields need to be guarded with checks for partial state.\n\nIn this case, the partial is so thin you should probably go with option 1.", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r401756953", "createdAt": "2020-04-01T16:42:33Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "diffHunk": "@@ -207,6 +208,164 @@ void wrapUp(GitHub root) {\n         }\n     }\n \n+    /**\n+     * Represents a repository object specifically for {@link Installation} and {@link InstallationRepositories}.\n+     */\n+    @SuppressFBWarnings(value = { \"UWF_UNWRITTEN_FIELD\" }, justification = \"JSON API\")\n+    public static class InstallationRepository {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTUxODc0Mg=="}, "originalCommit": {"oid": "32ff315b6bb60aa4dd7b4f7d653622fe796a7e7a"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg4MjUwNA==", "bodyText": "@XiongKezhi\nHm, but is it possible to get an event for a Repository what the repository is private and can't be populated using the current credentials?", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r401882504", "createdAt": "2020-04-01T20:15:26Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "diffHunk": "@@ -207,6 +208,164 @@ void wrapUp(GitHub root) {\n         }\n     }\n \n+    /**\n+     * Represents a repository object specifically for {@link Installation} and {@link InstallationRepositories}.\n+     */\n+    @SuppressFBWarnings(value = { \"UWF_UNWRITTEN_FIELD\" }, justification = \"JSON API\")\n+    public static class InstallationRepository {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTUxODc0Mg=="}, "originalCommit": {"oid": "32ff315b6bb60aa4dd7b4f7d653622fe796a7e7a"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjc1ODY5MA==", "bodyText": "@XiongKezhi\nHm, but is it possible to get an event for a Repository what the repository is private and can't be populated using the current credentials?\n\nThe repository installation events will be sent to the APP with at least metadata read-only permission to that repository, so shouldn't it be the users' responsibility if they use a client without the proper credentials instead of a client with the APP's JWT token?", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r402758690", "createdAt": "2020-04-03T06:19:05Z", "author": {"login": "XiongKezhi"}, "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "diffHunk": "@@ -207,6 +208,164 @@ void wrapUp(GitHub root) {\n         }\n     }\n \n+    /**\n+     * Represents a repository object specifically for {@link Installation} and {@link InstallationRepositories}.\n+     */\n+    @SuppressFBWarnings(value = { \"UWF_UNWRITTEN_FIELD\" }, justification = \"JSON API\")\n+    public static class InstallationRepository {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTUxODc0Mg=="}, "originalCommit": {"oid": "32ff315b6bb60aa4dd7b4f7d653622fe796a7e7a"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MjM2MTIzOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMDoxNjoyNlrOF_Q_iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMDoxNjoyNlrOF_Q_iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg4MzAxOQ==", "bodyText": "@XiongKezhi  You'll want to add an override for wrapUp(root) to bind GHAppInstallation", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r401883019", "createdAt": "2020-04-01T20:16:26Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "diffHunk": "@@ -207,6 +208,164 @@ void wrapUp(GitHub root) {\n         }\n     }\n \n+    /**\n+     * Represents a repository object specifically for {@link Installation} and {@link InstallationRepositories}.\n+     */\n+    @SuppressFBWarnings(value = { \"UWF_UNWRITTEN_FIELD\" }, justification = \"JSON API\")\n+    public static class InstallationRepository {\n+        private long id;\n+        private String nodeId;\n+        private String name;\n+        private String fullName;\n+        @JsonProperty(\"private\")\n+        private boolean _private;\n+\n+        /**\n+         * Gets id\n+         *\n+         * @return the id\n+         */\n+        public long getId() {\n+            return id;\n+        }\n+\n+        /**\n+         * Gets node id\n+         *\n+         * @return the node id\n+         */\n+        public String getNodeId() {\n+            return nodeId;\n+        }\n+\n+        /**\n+         * Gets name\n+         *\n+         * @return the name\n+         */\n+        public String getName() {\n+            return name;\n+        }\n+\n+        /**\n+         * Gets full name\n+         *\n+         * @return the full name\n+         */\n+        public String getFullName() {\n+            return fullName;\n+        }\n+\n+        /**\n+         * Is private boolean.\n+         *\n+         * @return the boolean\n+         */\n+        public boolean isPrivate() {\n+            return _private;\n+        }\n+    }\n+\n+    /**\n+     * An installation has been installed, uninstalled, or its permissions have been changed.\n+     *\n+     * @see <a href=\"https://developer.github.com/v3/activity/events/types/#installationevent\">authoritative source</a>\n+     */\n+    @SuppressFBWarnings(value = { \"UWF_UNWRITTEN_FIELD\" }, justification = \"JSON API\")\n+    public static class Installation extends GHEventPayload {\n+        private String action;\n+        private GHAppInstallation installation;\n+        private List<InstallationRepository> repositories;\n+\n+        /**\n+         * Gets action\n+         *\n+         * @return the action\n+         */\n+        public String getAction() {\n+            return action;\n+        }\n+\n+        /**\n+         * Gets installation\n+         *\n+         * @return the installation\n+         */\n+        public GHAppInstallation getInstallation() {\n+            return installation;\n+        }\n+\n+        /**\n+         * Gets repositories\n+         *\n+         * @return the repositories\n+         */\n+        public List<InstallationRepository> getRepositories() {\n+            return repositories;\n+        };\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7fc68f29695ce793c92109025432c67793a4e83c"}, "originalPosition": 106}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwNDM1Mzc4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/kohsuke/github/GHRepository.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo0OTo1MlrOGA8htg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo0OTo1MlrOGA8htg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0NDg1NA==", "bodyText": "For now let's make this package private and call it populate:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void refresh() throws IOException {\n          \n          \n            \n                void populate() throws IOException {", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r403644854", "createdAt": "2020-04-05T03:49:52Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHRepository.java", "diffHunk": "@@ -2792,4 +2792,17 @@ public GHTagObject createTag(String tag, String message, String object, String t\n                 .fetch(GHTagObject.class)\n                 .wrap(this);\n     }\n+\n+    /**\n+     * Repopulates this object.\n+     *\n+     * @throws java.io.IOException\n+     *             The IO exception\n+     */\n+    public void refresh() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwNDM1NDI2OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo1MDoyM1rOGA8h8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo1MDoyM1rOGA8h8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0NDkxMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    singleRepo.refresh();\n          \n          \n            \n                                    singleRepo.populate();", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r403644912", "createdAt": "2020-04-05T03:50:23Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "diffHunk": "@@ -300,9 +302,30 @@ public GHAppInstallation getInstallation() {\n          *\n          * @return the repositories\n          */\n-        public List<InstallationRepository> getRepositories() {\n+        public List<GHRepository> getRepositories() {\n             return repositories;\n         };\n+\n+        @Override\n+        void wrapUp(GitHub root) {\n+            super.wrapUp(root);\n+            if (installation == null)\n+                throw new IllegalStateException(\n+                        \"Expected check_suite payload, but got something else. Maybe we've got another type of event?\");\n+            else\n+                installation.wrapUp(root);\n+\n+            if (repositories != null && !repositories.isEmpty()) {\n+                try {\n+                    for (GHRepository singleRepo : repositories) { // warp each of the repository\n+                        singleRepo.wrap(root);\n+                        singleRepo.refresh();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwNDM1NDUxOnYy", "diffSide": "LEFT", "path": "src/test/java/org/kohsuke/github/GHEventPayloadTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo1MDo1NVrOGA8iDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQxMToxNDoxN1rOGA_Exw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0NDk0MA==", "bodyText": "Why remove these?", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r403644940", "createdAt": "2020-04-05T03:50:55Z", "author": {"login": "bitwiseman"}, "path": "src/test/java/org/kohsuke/github/GHEventPayloadTest.java", "diffHunk": "@@ -405,7 +405,6 @@ public void InstallationRepositoriesEvent() throws Exception {\n         assertThat(event.getRepositorySelection(), is(\"selected\"));\n \n         assertThat(event.getRepositoriesAdded().get(0).getId(), is(186853007L));\n-        assertThat(event.getRepositoriesAdded().get(0).getNodeId(), is(\"MDEwOlJlcG9zaXRvcnkxODY4NTMwMDc=\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY4NjU5OQ==", "bodyText": "The previous GHRepository didn't have node_id property. Now I added it.", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r403686599", "createdAt": "2020-04-05T11:14:17Z", "author": {"login": "XiongKezhi"}, "path": "src/test/java/org/kohsuke/github/GHEventPayloadTest.java", "diffHunk": "@@ -405,7 +405,6 @@ public void InstallationRepositoriesEvent() throws Exception {\n         assertThat(event.getRepositorySelection(), is(\"selected\"));\n \n         assertThat(event.getRepositoriesAdded().get(0).getId(), is(186853007L));\n-        assertThat(event.getRepositoriesAdded().get(0).getNodeId(), is(\"MDEwOlJlcG9zaXRvcnkxODY4NTMwMDc=\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0NDk0MA=="}, "originalCommit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1901, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}