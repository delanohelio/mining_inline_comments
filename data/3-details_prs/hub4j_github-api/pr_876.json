{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzNjIxMzYz", "number": 876, "title": "Add minimal symlink support via GHContent.getTarget()", "bodyText": "Description\nthis adds rudimentary symlink support (just enough to get a symlink).\nstill todo, howto handle GHRepository.getFileContent where the path\ncontains a symlink within the repository\nRelated to #875\nBefore submitting a PR:\nWe love getting PRs, but we hate asking people for the same basic changes every time.\n\n Push your changes to a branch other than master. Create your PR from that branch.\n Add JavaDocs and other comments\n Write tests that run and pass in CI. See CONTRIBUTING.md for details on how to capture snapshot data.\n Run mvn clean compile locally. This may reformat your code, commit those changes.\n Run mvn -D enable-ci clean install site locally. If this command doesn't succeed, your change will not pass CI.\n\nWhen creating a PR:\n\n Fill in the \"Description\" above.\n Enable \"Allow edits from maintainers\".", "createdAt": "2020-07-02T16:20:17Z", "url": "https://github.com/hub4j/github-api/pull/876", "merged": true, "mergeCommit": {"oid": "70969400a3603dac427a06ff972924dc14a131dd"}, "closed": true, "closedAt": "2020-07-07T19:21:40Z", "author": {"login": "jtnord"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcxBSXOAH2gAyNDQzNjIxMzYzOjQ0YjcyZWQ2NDdhMWRiZDhmZmJiN2I2MWU2ZTA5MWZiMDIxMmQzMDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyqSPfAH2gAyNDQzNjIxMzYzOjE0N2U4ZDVkMTIwNGU1MTQ0NjdlMTEyNGViMzBkMTE2MzBjYjRkOTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "44b72ed647a1dbd8ffbb7b61e6e091fb0212d308", "author": {"user": {"login": "jtnord", "name": "James Nord"}}, "url": "https://github.com/hub4j/github-api/commit/44b72ed647a1dbd8ffbb7b61e6e091fb0212d308", "committedDate": "2020-07-02T16:18:20Z", "message": "Add initial symlink support.\n\nthis adds rudimentary symlink support (just enough to get a symlink).\n\nstill todo, howto handle GHRepository.getFileContent where the path\ncontains a symlink within the repository"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyMDI5ODg3", "url": "https://github.com/hub4j/github-api/pull/876#pullrequestreview-442029887", "createdAt": "2020-07-02T21:29:42Z", "commit": {"oid": "44b72ed647a1dbd8ffbb7b61e6e091fb0212d308"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMToyOTo0MlrOGsdixw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMToyOTo0MlrOGsdixw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI3NDU2Nw==", "bodyText": "There are ways to do this but they are inefficient/costly.", "url": "https://github.com/hub4j/github-api/pull/876#discussion_r449274567", "createdAt": "2020-07-02T21:29:42Z", "author": {"login": "bitwiseman"}, "path": "src/test/java/org/kohsuke/github/GHContentIntegrationTest.java", "diffHunk": "@@ -170,4 +171,25 @@ public void testGetFileContentWithNonAsciiPath() throws Exception {\n         final GHContent fileContent2 = repo.getFileContent(fileContent.getPath());\n         assertThat(IOUtils.readLines(fileContent2.read(), StandardCharsets.UTF_8), hasItems(\"test\"));\n     }\n+\n+    @Test\n+    public void testGetFileContentWithSymlink() throws Exception {\n+        final GHRepository repo = gitHub.getRepository(\"hub4j-test-org/GHContentIntegrationTest\");\n+\n+        final GHContent fileContent = repo.getFileContent(\"ghcontent-ro/a-symlink-to-a-file\");\n+        // for whatever reason GH says this is a file :-o\n+        assertThat(IOUtils.toString(fileContent.read(), StandardCharsets.UTF_8), is(\"thanks for reading me\\n\"));\n+\n+        final GHContent dirContent = repo.getFileContent(\"ghcontent-ro/a-symlink-to-a-dir\");\n+        // but symlinks to directories are symlinks!\n+        assertThat(dirContent, allOf(hasProperty(\"target\", is(\"a-dir-with-3-entries\")),\n+                                     hasProperty(\"type\", is(\"symlink\"))));\n+        \n+        // TODO somehow\n+        /*\n+        final GHContent fileContent2 = repo.getFileContent(\"ghcontent-ro/a-symlink-to-a-dir/entry-one\");\n+        // this needs special handling and will 404 from GitHub\n+        assertThat(IOUtils.toString(fileContent.read(), StandardCharsets.UTF_8), is(\"\"));\n+        */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44b72ed647a1dbd8ffbb7b61e6e091fb0212d308"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d3ba9d7f0f9119b61ab2b1dd6888f3f67f1bb5f", "author": {"user": {"login": "jtnord", "name": "James Nord"}}, "url": "https://github.com/hub4j/github-api/commit/0d3ba9d7f0f9119b61ab2b1dd6888f3f67f1bb5f", "committedDate": "2020-07-07T12:29:33Z", "message": "formatting fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a284eca147d584169135c2080e0283cf15eb7900", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/a284eca147d584169135c2080e0283cf15eb7900", "committedDate": "2020-07-07T16:48:31Z", "message": "Shorten file paths for windows"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cacc3e6edd895e15400042366e6f19bc0ac17eee", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/cacc3e6edd895e15400042366e6f19bc0ac17eee", "committedDate": "2020-07-07T17:15:00Z", "message": "Update formatter cache directory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "147e8d5d1204e514467e1124eb30d11630cb4d97", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/147e8d5d1204e514467e1124eb30d11630cb4d97", "committedDate": "2020-07-07T18:38:14Z", "message": "Merge branch 'master' into symlink-support"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1620, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}