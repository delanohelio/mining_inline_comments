{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2ODc5NzU1", "number": 767, "title": "Installation repository event", "bodyText": "Description\nInstallationEvent  and InstallationRepositoriesEvent.\nBefore submitting a PR:\nWe love getting PRs, but we hate asking people for the same basic changes every time.\n\n Push your changes to a branch other than master. Create your PR from that branch.\n Add JavaDocs and other comments\n Write tests that run and pass in CI. See CONTRIBUTING.md for details on how to capture snapshot data.\n Run mvn clean compile locally. This may reformat your code, commit those changes.\n Run mvn -D enable-ci clean install site locally. If this command doesn't succeed, your change will not pass CI.", "createdAt": "2020-04-01T09:40:10Z", "url": "https://github.com/hub4j/github-api/pull/767", "merged": true, "mergeCommit": {"oid": "4adf88da19731e1d4c281d3b48e6698167672c62"}, "closed": true, "closedAt": "2020-04-05T19:45:57Z", "author": {"login": "XiongKezhi"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTTItQgH2gAyMzk2ODc5NzU1OmY5MTkzNDZmOGZhNzNhMDc0ZTU5YjhmMmE0NGQ4OGQ5MDM0MDc2MzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcUvgqfgFqTM4Nzg1Mzg0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f919346f8fa73a074e59b8f2a44d88d903407631", "author": {"user": {"login": "XiongKezhi", "name": "Kezhi Xiong"}}, "url": "https://github.com/hub4j/github-api/commit/f919346f8fa73a074e59b8f2a44d88d903407631", "committedDate": "2020-04-01T08:08:21Z", "message": "Add installation and installtion repositories event"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32ff315b6bb60aa4dd7b4f7d653622fe796a7e7a", "author": {"user": {"login": "XiongKezhi", "name": "Kezhi Xiong"}}, "url": "https://github.com/hub4j/github-api/commit/32ff315b6bb60aa4dd7b4f7d653622fe796a7e7a", "committedDate": "2020-04-01T08:58:02Z", "message": "Resolve spotbugs and format code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NDYzMTEx", "url": "https://github.com/hub4j/github-api/pull/767#pullrequestreview-385463111", "createdAt": "2020-04-01T10:37:01Z", "commit": {"oid": "32ff315b6bb60aa4dd7b4f7d653622fe796a7e7a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMDozNzowMVrOF-6wlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMDozNzowMVrOF-6wlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTUxODc0Mg==", "bodyText": "Construct a new object to represent the repository since the payload only contains a small part of GHRepository; it would to safer to use. But not so sure where we should put it.", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r401518742", "createdAt": "2020-04-01T10:37:01Z", "author": {"login": "XiongKezhi"}, "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "diffHunk": "@@ -207,6 +208,164 @@ void wrapUp(GitHub root) {\n         }\n     }\n \n+    /**\n+     * Represents a repository object specifically for {@link Installation} and {@link InstallationRepositories}.\n+     */\n+    @SuppressFBWarnings(value = { \"UWF_UNWRITTEN_FIELD\" }, justification = \"JSON API\")\n+    public static class InstallationRepository {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32ff315b6bb60aa4dd7b4f7d653622fe796a7e7a"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fc68f29695ce793c92109025432c67793a4e83c", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/7fc68f29695ce793c92109025432c67793a4e83c", "committedDate": "2020-04-01T19:29:13Z", "message": "Merge branch 'master' into installation-repository-event"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1OTE3MTA3", "url": "https://github.com/hub4j/github-api/pull/767#pullrequestreview-385917107", "createdAt": "2020-04-01T20:16:26Z", "commit": {"oid": "7fc68f29695ce793c92109025432c67793a4e83c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMDoxNjoyNlrOF_Q_iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQyMDoxNjoyNlrOF_Q_iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg4MzAxOQ==", "bodyText": "@XiongKezhi  You'll want to add an override for wrapUp(root) to bind GHAppInstallation", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r401883019", "createdAt": "2020-04-01T20:16:26Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "diffHunk": "@@ -207,6 +208,164 @@ void wrapUp(GitHub root) {\n         }\n     }\n \n+    /**\n+     * Represents a repository object specifically for {@link Installation} and {@link InstallationRepositories}.\n+     */\n+    @SuppressFBWarnings(value = { \"UWF_UNWRITTEN_FIELD\" }, justification = \"JSON API\")\n+    public static class InstallationRepository {\n+        private long id;\n+        private String nodeId;\n+        private String name;\n+        private String fullName;\n+        @JsonProperty(\"private\")\n+        private boolean _private;\n+\n+        /**\n+         * Gets id\n+         *\n+         * @return the id\n+         */\n+        public long getId() {\n+            return id;\n+        }\n+\n+        /**\n+         * Gets node id\n+         *\n+         * @return the node id\n+         */\n+        public String getNodeId() {\n+            return nodeId;\n+        }\n+\n+        /**\n+         * Gets name\n+         *\n+         * @return the name\n+         */\n+        public String getName() {\n+            return name;\n+        }\n+\n+        /**\n+         * Gets full name\n+         *\n+         * @return the full name\n+         */\n+        public String getFullName() {\n+            return fullName;\n+        }\n+\n+        /**\n+         * Is private boolean.\n+         *\n+         * @return the boolean\n+         */\n+        public boolean isPrivate() {\n+            return _private;\n+        }\n+    }\n+\n+    /**\n+     * An installation has been installed, uninstalled, or its permissions have been changed.\n+     *\n+     * @see <a href=\"https://developer.github.com/v3/activity/events/types/#installationevent\">authoritative source</a>\n+     */\n+    @SuppressFBWarnings(value = { \"UWF_UNWRITTEN_FIELD\" }, justification = \"JSON API\")\n+    public static class Installation extends GHEventPayload {\n+        private String action;\n+        private GHAppInstallation installation;\n+        private List<InstallationRepository> repositories;\n+\n+        /**\n+         * Gets action\n+         *\n+         * @return the action\n+         */\n+        public String getAction() {\n+            return action;\n+        }\n+\n+        /**\n+         * Gets installation\n+         *\n+         * @return the installation\n+         */\n+        public GHAppInstallation getInstallation() {\n+            return installation;\n+        }\n+\n+        /**\n+         * Gets repositories\n+         *\n+         * @return the repositories\n+         */\n+        public List<InstallationRepository> getRepositories() {\n+            return repositories;\n+        };\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7fc68f29695ce793c92109025432c67793a4e83c"}, "originalPosition": 106}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NDI3ODc4", "url": "https://github.com/hub4j/github-api/pull/767#pullrequestreview-387427878", "createdAt": "2020-04-03T16:59:08Z", "commit": {"oid": "7fc68f29695ce793c92109025432c67793a4e83c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d", "author": {"user": {"login": "XiongKezhi", "name": "Kezhi Xiong"}}, "url": "https://github.com/hub4j/github-api/commit/4ff0870df865b3cfed4764c0da57461bebd95e3d", "committedDate": "2020-04-04T14:30:05Z", "message": "Refresh repositories while warp up installation event"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed85d06d697a59b7053eb86d7d808e5f04ca7078", "author": {"user": {"login": "XiongKezhi", "name": "Kezhi Xiong"}}, "url": "https://github.com/hub4j/github-api/commit/ed85d06d697a59b7053eb86d7d808e5f04ca7078", "committedDate": "2020-04-04T14:33:18Z", "message": "Merge branch 'master' into installation-repository-event"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "263de140c5503388dbd33c5c0ac5026adb8fb2be", "author": {"user": {"login": "XiongKezhi", "name": "Kezhi Xiong"}}, "url": "https://github.com/hub4j/github-api/commit/263de140c5503388dbd33c5c0ac5026adb8fb2be", "committedDate": "2020-04-04T14:49:52Z", "message": "Removed InstallationRepository"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Nzc4ODc3", "url": "https://github.com/hub4j/github-api/pull/767#pullrequestreview-387778877", "createdAt": "2020-04-05T03:49:52Z", "commit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo0OTo1MlrOGA8htg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo0OTo1MlrOGA8htg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0NDg1NA==", "bodyText": "For now let's make this package private and call it populate:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void refresh() throws IOException {\n          \n          \n            \n                void populate() throws IOException {", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r403644854", "createdAt": "2020-04-05T03:49:52Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHRepository.java", "diffHunk": "@@ -2792,4 +2792,17 @@ public GHTagObject createTag(String tag, String message, String object, String t\n                 .fetch(GHTagObject.class)\n                 .wrap(this);\n     }\n+\n+    /**\n+     * Repopulates this object.\n+     *\n+     * @throws java.io.IOException\n+     *             The IO exception\n+     */\n+    public void refresh() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Nzc4OTE4", "url": "https://github.com/hub4j/github-api/pull/767#pullrequestreview-387778918", "createdAt": "2020-04-05T03:50:23Z", "commit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo1MDoyM1rOGA8h8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo1MDoyM1rOGA8h8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0NDkxMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    singleRepo.refresh();\n          \n          \n            \n                                    singleRepo.populate();", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r403644912", "createdAt": "2020-04-05T03:50:23Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHEventPayload.java", "diffHunk": "@@ -300,9 +302,30 @@ public GHAppInstallation getInstallation() {\n          *\n          * @return the repositories\n          */\n-        public List<InstallationRepository> getRepositories() {\n+        public List<GHRepository> getRepositories() {\n             return repositories;\n         };\n+\n+        @Override\n+        void wrapUp(GitHub root) {\n+            super.wrapUp(root);\n+            if (installation == null)\n+                throw new IllegalStateException(\n+                        \"Expected check_suite payload, but got something else. Maybe we've got another type of event?\");\n+            else\n+                installation.wrapUp(root);\n+\n+            if (repositories != null && !repositories.isEmpty()) {\n+                try {\n+                    for (GHRepository singleRepo : repositories) { // warp each of the repository\n+                        singleRepo.wrap(root);\n+                        singleRepo.refresh();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Nzc4OTQ5", "url": "https://github.com/hub4j/github-api/pull/767#pullrequestreview-387778949", "createdAt": "2020-04-05T03:50:55Z", "commit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo1MDo1NVrOGA8iDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNVQwMzo1MDo1NVrOGA8iDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY0NDk0MA==", "bodyText": "Why remove these?", "url": "https://github.com/hub4j/github-api/pull/767#discussion_r403644940", "createdAt": "2020-04-05T03:50:55Z", "author": {"login": "bitwiseman"}, "path": "src/test/java/org/kohsuke/github/GHEventPayloadTest.java", "diffHunk": "@@ -405,7 +405,6 @@ public void InstallationRepositoriesEvent() throws Exception {\n         assertThat(event.getRepositorySelection(), is(\"selected\"));\n \n         assertThat(event.getRepositoriesAdded().get(0).getId(), is(186853007L));\n-        assertThat(event.getRepositoriesAdded().get(0).getNodeId(), is(\"MDEwOlJlcG9zaXRvcnkxODY4NTMwMDc=\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ff0870df865b3cfed4764c0da57461bebd95e3d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "955690b124bcb0b05594200049a96f27b96ee63d", "author": {"user": {"login": "XiongKezhi", "name": "Kezhi Xiong"}}, "url": "https://github.com/hub4j/github-api/commit/955690b124bcb0b05594200049a96f27b96ee63d", "committedDate": "2020-04-05T11:09:02Z", "message": "Rename refreash to populate and add node_id for GHRepository"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3ODUzODQx", "url": "https://github.com/hub4j/github-api/pull/767#pullrequestreview-387853841", "createdAt": "2020-04-05T19:45:47Z", "commit": {"oid": "955690b124bcb0b05594200049a96f27b96ee63d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1718, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}