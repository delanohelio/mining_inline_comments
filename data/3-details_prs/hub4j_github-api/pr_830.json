{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MTQyMjEw", "number": 830, "title": "Handle header and endpoint rate limit responses consistently", "bodyText": "Description\nThis change removes the separation between header rate limit information and the /rate_limit endpoint. All rate limit information is merged into a single GHRateLimit instance that is updated/replaced as needed.  If responses are processed out of order, records are updated to use the latest information.\nThe response header rate limit information may not be present for some versions/configurations of GitHub Enterprise. When present for successful queries, the header rate limit information will also be present for requests that return a 404.  The response header rate limit information (when present) applies only to the target endpoint of the current request - the response to a request to the /search endpoint will have header information for the search record but not for any other endpoints.  Information from individual responses are used to update the appropriate record of the cached GHRateLimit.\nThe /rate_limit endpoint returns either 404 or information for all four areas. When /rate_limit returns a 404, it may still have header information in the response which will apply to the core rate limit record (from #817).\n\ngetRateLimit() still always requests new information.  This change retains #817 and makes that behavior apply to other endpoints such as /search as well.\nlastRateLimit() never returns null, instead defaulting to a GHRateLimit with all expired records.\nAdded an internal GitHubClient.ratelimit(GitHubRateLimitSpecifier) method, that requests new data only when the specified limit record has expired.\nAs regular records expire they are replaced by UnknownRateLimitRecords.\nRequests that apply to rate limits other than Core must specify their rate limit record manually via GitHubRequest.Builder.ratelimit(GitHubRateLimitSpecifier).\nThis library does not currently use GraphQL or IntegrationManifest but when it does this change will work there as well.\n\nFixes #605\nBefore submitting a PR:\nWe love getting PRs, but we hate asking people for the same basic changes every time.\n\n Push your changes to a branch other than master. Create your PR from that branch.\n Add JavaDocs and other comments\n Write tests that run and pass in CI. See CONTRIBUTING.md for details on how to capture snapshot data.\n Run mvn clean compile locally. This may reformat your code, commit those changes.\n Run mvn -D enable-ci clean install site locally. If this command doesn't succeed, your change will not pass CI.", "createdAt": "2020-05-27T22:18:27Z", "url": "https://github.com/hub4j/github-api/pull/830", "merged": true, "mergeCommit": {"oid": "0ca792ecfd349ac2a9975e3c88bc8b8d7e491f09"}, "closed": true, "closedAt": "2020-07-15T19:42:12Z", "author": {"login": "bitwiseman"}, "timelineItems": {"totalCount": 26, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclg5gJgFqTQxOTY1MDA4OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1PlMOAH2gAyNDI0MTQyMjEwOjk4N2MzNGM2OWU5NzIwMjQ1MWFmNmI3N2Q0YTU5ZGMxZGZmZDc4N2Q=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjUwMDg5", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-419650089", "createdAt": "2020-05-27T22:21:03Z", "commit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMTowM1rOGbfMQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMTowM1rOGbfMQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3NTc3OQ==", "bodyText": "This is a notable change.", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r431475779", "createdAt": "2020-05-27T22:21:03Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHRateLimit.java", "diffHunk": "@@ -220,45 +247,107 @@ public int hashCode() {\n         return Objects.hash(getCore(), getSearch(), getGraphQL(), getIntegrationManifest());\n     }\n \n+    /**\n+     * Merge a {@link GHRateLimit} with another one to create a new {@link GHRateLimit} keeping the latest\n+     * {@link Record}s from each.\n+     * \n+     * @param newLimit\n+     *            {@link GHRateLimit} with potentially updated information. If null, the current instance is returned.\n+     * @return a merged {@link GHRateLimit} with the latest {@link Record}s. If the merged instance is equivalent to\n+     *         either of the two existing limits, the matching instance is returned.\n+     */\n+    GHRateLimit getMergedRateLimit(@Nonnull GHRateLimit newLimit) {\n+\n+        GHRateLimit merged = new GHRateLimit(getCore().currentOrUpdated(newLimit.getCore()),\n+                getSearch().currentOrUpdated(newLimit.getSearch()),\n+                getGraphQL().currentOrUpdated(newLimit.getGraphQL()),\n+                getIntegrationManifest().currentOrUpdated(newLimit.getIntegrationManifest()));\n+\n+        if (merged.equals(this)) {\n+            merged = this;\n+        }\n+\n+        return merged;\n+    }\n+\n     /**\n      * Gets the appropriate {@link Record} for a particular url path.\n      *\n-     * @param urlPath\n-     *            the url path of the request\n+     * @param endpoint\n+     *            the rate limit endpoint specifier\n      * @return the {@link Record} for a url path.\n      */\n     @Nonnull\n-    Record getRecordForUrlPath(@Nonnull String urlPath) {\n-        if (urlPath.equals(\"/rate_limit\")) {\n-            return new UnknownLimitRecord();\n-        } else if (urlPath.startsWith(\"/search\")) {\n+    Record getRecordForUrlPath(@Nonnull GitHubRateLimitSpecifier endpoint) {\n+        if (endpoint == GitHubRateLimitSpecifier.CORE) {\n+            return getCore();\n+        } else if (endpoint == GitHubRateLimitSpecifier.SEARCH) {\n             return getSearch();\n-        } else if (urlPath.startsWith(\"/graphql\")) {\n+        } else if (endpoint == GitHubRateLimitSpecifier.GRAPHQL) {\n             return getGraphQL();\n-        } else if (urlPath.startsWith(\"/app-manifests\")) {\n+        } else if (endpoint == GitHubRateLimitSpecifier.INTEGRATION_MANIFEST) {\n             return getIntegrationManifest();\n+        } else if (endpoint == GitHubRateLimitSpecifier.NONE) {\n+            return UnknownLimitRecord.DEFAULT;\n         } else {\n-            return getCore();\n+            throw new IllegalArgumentException(\"Unknown rate limit specifier: \" + endpoint.toString());\n         }\n     }\n \n     /**\n      * A limit record used as a placeholder when the the actual limit is not known.\n-     * <p>\n-     * Has a large limit and long duration so that it will doesn't expire too often.\n      *\n      * @since 1.100\n      */\n     public static class UnknownLimitRecord extends Record {\n \n-        // One hour\n-        private static final long unknownLimitResetSeconds = 60L * 60L;\n+        /**\n+         * This is set to a somewhat small duration, rather than a long one.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "originalPosition": 226}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjUwNDQ3", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-419650447", "createdAt": "2020-05-27T22:21:48Z", "commit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMTo0OVrOGbfNbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMTo0OVrOGbfNbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3NjA3OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                     * called TODO\n          \n          \n            \n                     * called the rate limit will refresh.", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r431476079", "createdAt": "2020-05-27T22:21:49Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHRateLimit.java", "diffHunk": "@@ -220,45 +247,107 @@ public int hashCode() {\n         return Objects.hash(getCore(), getSearch(), getGraphQL(), getIntegrationManifest());\n     }\n \n+    /**\n+     * Merge a {@link GHRateLimit} with another one to create a new {@link GHRateLimit} keeping the latest\n+     * {@link Record}s from each.\n+     * \n+     * @param newLimit\n+     *            {@link GHRateLimit} with potentially updated information. If null, the current instance is returned.\n+     * @return a merged {@link GHRateLimit} with the latest {@link Record}s. If the merged instance is equivalent to\n+     *         either of the two existing limits, the matching instance is returned.\n+     */\n+    GHRateLimit getMergedRateLimit(@Nonnull GHRateLimit newLimit) {\n+\n+        GHRateLimit merged = new GHRateLimit(getCore().currentOrUpdated(newLimit.getCore()),\n+                getSearch().currentOrUpdated(newLimit.getSearch()),\n+                getGraphQL().currentOrUpdated(newLimit.getGraphQL()),\n+                getIntegrationManifest().currentOrUpdated(newLimit.getIntegrationManifest()));\n+\n+        if (merged.equals(this)) {\n+            merged = this;\n+        }\n+\n+        return merged;\n+    }\n+\n     /**\n      * Gets the appropriate {@link Record} for a particular url path.\n      *\n-     * @param urlPath\n-     *            the url path of the request\n+     * @param endpoint\n+     *            the rate limit endpoint specifier\n      * @return the {@link Record} for a url path.\n      */\n     @Nonnull\n-    Record getRecordForUrlPath(@Nonnull String urlPath) {\n-        if (urlPath.equals(\"/rate_limit\")) {\n-            return new UnknownLimitRecord();\n-        } else if (urlPath.startsWith(\"/search\")) {\n+    Record getRecordForUrlPath(@Nonnull GitHubRateLimitSpecifier endpoint) {\n+        if (endpoint == GitHubRateLimitSpecifier.CORE) {\n+            return getCore();\n+        } else if (endpoint == GitHubRateLimitSpecifier.SEARCH) {\n             return getSearch();\n-        } else if (urlPath.startsWith(\"/graphql\")) {\n+        } else if (endpoint == GitHubRateLimitSpecifier.GRAPHQL) {\n             return getGraphQL();\n-        } else if (urlPath.startsWith(\"/app-manifests\")) {\n+        } else if (endpoint == GitHubRateLimitSpecifier.INTEGRATION_MANIFEST) {\n             return getIntegrationManifest();\n+        } else if (endpoint == GitHubRateLimitSpecifier.NONE) {\n+            return UnknownLimitRecord.DEFAULT;\n         } else {\n-            return getCore();\n+            throw new IllegalArgumentException(\"Unknown rate limit specifier: \" + endpoint.toString());\n         }\n     }\n \n     /**\n      * A limit record used as a placeholder when the the actual limit is not known.\n-     * <p>\n-     * Has a large limit and long duration so that it will doesn't expire too often.\n      *\n      * @since 1.100\n      */\n     public static class UnknownLimitRecord extends Record {\n \n-        // One hour\n-        private static final long unknownLimitResetSeconds = 60L * 60L;\n+        /**\n+         * This is set to a somewhat small duration, rather than a long one.\n+         *\n+         * {@link GitHubClient#rateLimit(String)} will not query for a new rate limit until the current Record expires.\n+         * When {@link GitHubClient} is initialized it includes a default {@link GHRateLimit#Default()} which has\n+         * expired rate limit records. This guarantees that the first time {@link GitHubClient#rateLimit(String)} is\n+         * called TODO", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "originalPosition": 231}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjUwOTMz", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-419650933", "createdAt": "2020-05-27T22:22:46Z", "commit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMjo0N1rOGbfO9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMjo0N1rOGbfO9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3NjQ3MQ==", "bodyText": "TODO javadoc", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r431476471", "createdAt": "2020-05-27T22:22:47Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHRateLimit.java", "diffHunk": "@@ -220,45 +247,107 @@ public int hashCode() {\n         return Objects.hash(getCore(), getSearch(), getGraphQL(), getIntegrationManifest());\n     }\n \n+    /**\n+     * Merge a {@link GHRateLimit} with another one to create a new {@link GHRateLimit} keeping the latest\n+     * {@link Record}s from each.\n+     * \n+     * @param newLimit\n+     *            {@link GHRateLimit} with potentially updated information. If null, the current instance is returned.\n+     * @return a merged {@link GHRateLimit} with the latest {@link Record}s. If the merged instance is equivalent to\n+     *         either of the two existing limits, the matching instance is returned.\n+     */\n+    GHRateLimit getMergedRateLimit(@Nonnull GHRateLimit newLimit) {\n+\n+        GHRateLimit merged = new GHRateLimit(getCore().currentOrUpdated(newLimit.getCore()),\n+                getSearch().currentOrUpdated(newLimit.getSearch()),\n+                getGraphQL().currentOrUpdated(newLimit.getGraphQL()),\n+                getIntegrationManifest().currentOrUpdated(newLimit.getIntegrationManifest()));\n+\n+        if (merged.equals(this)) {\n+            merged = this;\n+        }\n+\n+        return merged;\n+    }\n+\n     /**\n      * Gets the appropriate {@link Record} for a particular url path.\n      *\n-     * @param urlPath\n-     *            the url path of the request\n+     * @param endpoint\n+     *            the rate limit endpoint specifier\n      * @return the {@link Record} for a url path.\n      */\n     @Nonnull\n-    Record getRecordForUrlPath(@Nonnull String urlPath) {\n-        if (urlPath.equals(\"/rate_limit\")) {\n-            return new UnknownLimitRecord();\n-        } else if (urlPath.startsWith(\"/search\")) {\n+    Record getRecordForUrlPath(@Nonnull GitHubRateLimitSpecifier endpoint) {\n+        if (endpoint == GitHubRateLimitSpecifier.CORE) {\n+            return getCore();\n+        } else if (endpoint == GitHubRateLimitSpecifier.SEARCH) {\n             return getSearch();\n-        } else if (urlPath.startsWith(\"/graphql\")) {\n+        } else if (endpoint == GitHubRateLimitSpecifier.GRAPHQL) {\n             return getGraphQL();\n-        } else if (urlPath.startsWith(\"/app-manifests\")) {\n+        } else if (endpoint == GitHubRateLimitSpecifier.INTEGRATION_MANIFEST) {\n             return getIntegrationManifest();\n+        } else if (endpoint == GitHubRateLimitSpecifier.NONE) {\n+            return UnknownLimitRecord.DEFAULT;\n         } else {\n-            return getCore();\n+            throw new IllegalArgumentException(\"Unknown rate limit specifier: \" + endpoint.toString());\n         }\n     }\n \n     /**\n      * A limit record used as a placeholder when the the actual limit is not known.\n-     * <p>\n-     * Has a large limit and long duration so that it will doesn't expire too often.\n      *\n      * @since 1.100\n      */\n     public static class UnknownLimitRecord extends Record {\n \n-        // One hour\n-        private static final long unknownLimitResetSeconds = 60L * 60L;\n+        /**\n+         * This is set to a somewhat small duration, rather than a long one.\n+         *\n+         * {@link GitHubClient#rateLimit(String)} will not query for a new rate limit until the current Record expires.\n+         * When {@link GitHubClient} is initialized it includes a default {@link GHRateLimit#Default()} which has\n+         * expired rate limit records. This guarantees that the first time {@link GitHubClient#rateLimit(String)} is\n+         * called TODO\n+         *\n+         * The\n+         */\n+        static long unknownLimitResetSeconds = Duration.ofSeconds(30).toMillis() * 1000;\n \n         static final int unknownLimit = 1000000;\n         static final int unknownRemaining = 999999;\n \n-        private UnknownLimitRecord() {\n-            super(unknownLimit, unknownRemaining, System.currentTimeMillis() / 1000L + unknownLimitResetSeconds);\n+        // The default UnknownLimitRecord is an expired record.\n+        private static final UnknownLimitRecord DEFAULT = new UnknownLimitRecord(Long.MIN_VALUE);\n+\n+        // The starting current UnknownLimitRecord is an expired record.\n+        private static UnknownLimitRecord current = DEFAULT;\n+\n+        /**\n+         * Internal For testing only.\n+         */\n+        UnknownLimitRecord() {\n+            this(System.currentTimeMillis() / 1000L + unknownLimitResetSeconds);\n+        }\n+\n+        /**\n+         * Not for use outside this class\n+         *\n+         * @param resetEpochSeconds\n+         *            the epoch second time when this record will expire.\n+         */\n+        private UnknownLimitRecord(long resetEpochSeconds) {\n+            super(unknownLimit, unknownRemaining, resetEpochSeconds);\n+        }\n+\n+        static synchronized Record current() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "originalPosition": 265}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjUxMjEz", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-419651213", "createdAt": "2020-05-27T22:23:19Z", "commit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMzoxOVrOGbfP6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMzoxOVrOGbfP6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3NjcxMw==", "bodyText": "TODO javadoc", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r431476713", "createdAt": "2020-05-27T22:23:19Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHRateLimit.java", "diffHunk": "@@ -66,16 +66,43 @@\n     private final Record integrationManifest;\n \n     @Nonnull\n-    static GHRateLimit Unknown() {\n-        return new GHRateLimit(new UnknownLimitRecord(),\n-                new UnknownLimitRecord(),\n-                new UnknownLimitRecord(),\n-                new UnknownLimitRecord());\n+    static GHRateLimit Default() {\n+        return new GHRateLimit(UnknownLimitRecord.DEFAULT,\n+                UnknownLimitRecord.DEFAULT,\n+                UnknownLimitRecord.DEFAULT,\n+                UnknownLimitRecord.DEFAULT);\n+    }\n+\n+    @Nonnull\n+    static GHRateLimit Unknown(@Nonnull GitHubRateLimitSpecifier endpoint) {\n+        return fromHeaderRecord(UnknownLimitRecord.current(), endpoint);\n     }\n \n     @Nonnull\n-    static GHRateLimit fromHeaderRecord(Record header) {\n-        return new GHRateLimit(header, new UnknownLimitRecord(), new UnknownLimitRecord(), new UnknownLimitRecord());\n+    static GHRateLimit fromHeaderRecord(@Nonnull Record header, @Nonnull GitHubRateLimitSpecifier rateLimitSpecifier) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjUxMjUy", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-419651252", "createdAt": "2020-05-27T22:23:22Z", "commit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMzoyMlrOGbfQBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyMzoyMlrOGbfQBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3Njc0MQ==", "bodyText": "TODO javadoc", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r431476741", "createdAt": "2020-05-27T22:23:22Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GHRateLimit.java", "diffHunk": "@@ -66,16 +66,43 @@\n     private final Record integrationManifest;\n \n     @Nonnull\n-    static GHRateLimit Unknown() {\n-        return new GHRateLimit(new UnknownLimitRecord(),\n-                new UnknownLimitRecord(),\n-                new UnknownLimitRecord(),\n-                new UnknownLimitRecord());\n+    static GHRateLimit Default() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjUxOTU2", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-419651956", "createdAt": "2020-05-27T22:24:57Z", "commit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyNDo1N1rOGbfSNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyNDo1N1rOGbfSNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3NzMwMA==", "bodyText": "TODO javadoc\nMention header information", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r431477300", "createdAt": "2020-05-27T22:24:57Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GitHub.java", "diffHunk": "@@ -373,12 +373,19 @@ public String getApiUrl() {\n     }\n \n     /**\n-     * Gets the current rate limit.\n+     * Gets the current rate limit from the server.\n+     *\n+     * For some versions of GitHub Enterprise, the {@code /rate_limit} endpoint returns a {@code 404 Not Found}. In that\n+     * case, if the most recent {@link GHRateLimit} will be returned.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjUzNjE2", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-419653616", "createdAt": "2020-05-27T22:28:19Z", "commit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyODoxOVrOGbfXUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMjoyODoxOVrOGbfXUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQ3ODYxMQ==", "bodyText": "TODO, consider making fetch() take a builder instead of a urlPath?", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r431478611", "createdAt": "2020-05-27T22:28:19Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GitHubClient.java", "diffHunk": "@@ -210,69 +211,106 @@ public boolean isAnonymous() {\n     /**\n      * Gets the current rate limit from the server.\n      *\n-     * For some versions of GitHub Enterprise, the {@code /rate_limit} endpoint returns a {@code 404 Not Found}. In\n-     * that, if {@link #lastRateLimit()} is not {@code null} and is not expired, it will be returned. Otherwise, a\n-     * placeholder {@link GHRateLimit} instance with {@link GHRateLimit.UnknownLimitRecord}s will be returned.\n+     * For some versions of GitHub Enterprise, the {@code /rate_limit} endpoint returns a {@code 404 Not Found}. In that\n+     * case, if the most recent {@link GHRateLimit} will be returned.\n+     *\n+     * For most use cases it would be better to implement a {@link RateLimitChecker} and add it via\n+     * {@link GitHubBuilder#withRateLimitChecker(RateLimitChecker)}.\n      *\n      * @return the rate limit\n      * @throws IOException\n      *             the io exception\n      */\n     @Nonnull\n     public GHRateLimit getRateLimit() throws IOException {\n+        return getRateLimit(GitHubRateLimitSpecifier.NONE);\n+    }\n+\n+    @Nonnull\n+    GHRateLimit getRateLimit(@Nonnull GitHubRateLimitSpecifier rateLimitSpecifier) throws IOException {\n         GHRateLimit result;\n         try {\n-            result = fetch(JsonRateLimit.class, \"/rate_limit\").resources;\n+            GitHubRequest request = GitHubRequest.newBuilder()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d"}, "originalPosition": 66}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "363385ee96b89a09c0c68f6d078bb2f8aa3e491d", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/363385ee96b89a09c0c68f6d078bb2f8aa3e491d", "committedDate": "2020-05-27T22:06:25Z", "message": "Simplified rate limit record selection\n\nHere we have another example of trying to do something clever when simplicity is the better choice.\nRather than trying to guess the rate limit record for a request based on the url path,\nI added an enumeration which can be set on the request to say which rate limit record to applies.\n\nThis is simpler, safer, and faster than trying to guess the rate limit from the url path."}, "afterCommit": {"oid": "96a4a20b7ee55ddbd736c981675ec5892b428a3e", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/96a4a20b7ee55ddbd736c981675ec5892b428a3e", "committedDate": "2020-05-28T14:37:00Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "96a4a20b7ee55ddbd736c981675ec5892b428a3e", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/96a4a20b7ee55ddbd736c981675ec5892b428a3e", "committedDate": "2020-05-28T14:37:00Z", "message": "WIP"}, "afterCommit": {"oid": "aa4f841fabef7b11764673ba52670d42dc9d9b4a", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/aa4f841fabef7b11764673ba52670d42dc9d9b4a", "committedDate": "2020-05-29T23:56:20Z", "message": "WIP"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aa4f841fabef7b11764673ba52670d42dc9d9b4a", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/aa4f841fabef7b11764673ba52670d42dc9d9b4a", "committedDate": "2020-05-29T23:56:20Z", "message": "WIP"}, "afterCommit": {"oid": "5d8414de9847df35956942b5925375868f39eb51", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/5d8414de9847df35956942b5925375868f39eb51", "committedDate": "2020-05-29T23:59:39Z", "message": "Clean up and reorganize changes\n\nChanged GitHubRateLimitSpecifier to RateLimitTarget\nMade RateLimitTarget public so it can be passed to GitHubBuilder"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c3e0099e81d593054f781fbeda4c6630bbe379e0", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/c3e0099e81d593054f781fbeda4c6630bbe379e0", "committedDate": "2020-05-31T20:31:36Z", "message": "Add more tests for rate limit record selection"}, "afterCommit": {"oid": "2c25ac2589e84f49c0757225be3b0c7ca3f18ca4", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/2c25ac2589e84f49c0757225be3b0c7ca3f18ca4", "committedDate": "2020-05-31T21:03:35Z", "message": "Add more tests for rate limit record selection"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f6139a8da253181d05324f6f67aef7845fc1030e", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/f6139a8da253181d05324f6f67aef7845fc1030e", "committedDate": "2020-06-08T19:34:44Z", "message": "Merge branch 'master' into task/rate-limit/full"}, "afterCommit": {"oid": "e0c9344b5810c2e87e7f4834c6149d7f4f512a06", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/e0c9344b5810c2e87e7f4834c6149d7f4f512a06", "committedDate": "2020-06-08T21:14:53Z", "message": "Clean up comments and javadoc"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e0c9344b5810c2e87e7f4834c6149d7f4f512a06", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/e0c9344b5810c2e87e7f4834c6149d7f4f512a06", "committedDate": "2020-06-08T21:14:53Z", "message": "Clean up comments and javadoc"}, "afterCommit": {"oid": "a0043fa4f730ef90f2ea3753a29dd514896317e4", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/a0043fa4f730ef90f2ea3753a29dd514896317e4", "committedDate": "2020-06-08T21:32:36Z", "message": "Clean up comments and javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NjAzODQx", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-444603841", "createdAt": "2020-07-08T10:12:18Z", "commit": {"oid": "d97218ffd5d2f4706c69b8520869f6489e959b4c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NjA2MjY4", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-444606268", "createdAt": "2020-07-08T10:15:50Z", "commit": {"oid": "d97218ffd5d2f4706c69b8520869f6489e959b4c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMDoxNTo1MVrOGuhcTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMDoxNTo1MVrOGuhcTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQzNTU5Nw==", "bodyText": "this seems a bit strange?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    private static final long defaultUnknownLimitResetSeconds = Duration.ofSeconds(30).toMillis() / 1000;\n          \n          \n            \n                    private static final long defaultUnknownLimitResetSeconds = Duration.ofSeconds(30).getSeconds();", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r451435597", "createdAt": "2020-07-08T10:15:51Z", "author": {"login": "timja"}, "path": "src/main/java/org/kohsuke/github/GHRateLimit.java", "diffHunk": "@@ -221,44 +264,112 @@ public int hashCode() {\n     }\n \n     /**\n-     * Gets the appropriate {@link Record} for a particular url path.\n+     * Merge a {@link GHRateLimit} with another one to create a new {@link GHRateLimit} keeping the latest\n+     * {@link Record}s from each.\n+     * \n+     * @param newLimit\n+     *            {@link GHRateLimit} with potentially updated {@link Record}s.\n+     * @return a merged {@link GHRateLimit} with the latest {@link Record}s from these two instances. If the merged\n+     *         instance is equal to the current instance, the current instance is returned. If the merged instance is\n+     *         equal to the current instance, the current instance is returned.\n+     */\n+    @Nonnull\n+    GHRateLimit getMergedRateLimit(@Nonnull GHRateLimit newLimit) {\n+\n+        GHRateLimit merged = new GHRateLimit(getCore().currentOrUpdated(newLimit.getCore()),\n+                getSearch().currentOrUpdated(newLimit.getSearch()),\n+                getGraphQL().currentOrUpdated(newLimit.getGraphQL()),\n+                getIntegrationManifest().currentOrUpdated(newLimit.getIntegrationManifest()));\n+\n+        if (merged.equals(this)) {\n+            merged = this;\n+        }\n+\n+        return merged;\n+    }\n+\n+    /**\n+     * Gets the specified {@link Record}.\n+     *\n+     * {@link RateLimitTarget#NONE} will return {@link UnknownLimitRecord#DEFAULT} to prevent any clients from\n+     * accidentally waiting on that record to reset before continuing.\n      *\n-     * @param urlPath\n-     *            the url path of the request\n-     * @return the {@link Record} for a url path.\n+     * @param rateLimitTarget\n+     *            the target rate limit record\n+     * @return the target {@link Record} from this instance.\n      */\n     @Nonnull\n-    Record getRecordForUrlPath(@Nonnull String urlPath) {\n-        if (urlPath.equals(\"/rate_limit\")) {\n-            return new UnknownLimitRecord();\n-        } else if (urlPath.startsWith(\"/search\")) {\n+    Record getRecord(@Nonnull RateLimitTarget rateLimitTarget) {\n+        if (rateLimitTarget == RateLimitTarget.CORE) {\n+            return getCore();\n+        } else if (rateLimitTarget == RateLimitTarget.SEARCH) {\n             return getSearch();\n-        } else if (urlPath.startsWith(\"/graphql\")) {\n+        } else if (rateLimitTarget == RateLimitTarget.GRAPHQL) {\n             return getGraphQL();\n-        } else if (urlPath.startsWith(\"/app-manifests\")) {\n+        } else if (rateLimitTarget == RateLimitTarget.INTEGRATION_MANIFEST) {\n             return getIntegrationManifest();\n+        } else if (rateLimitTarget == RateLimitTarget.NONE) {\n+            return UnknownLimitRecord.DEFAULT;\n         } else {\n-            return getCore();\n+            throw new IllegalArgumentException(\"Unknown rate limit target: \" + rateLimitTarget.toString());\n         }\n     }\n \n     /**\n      * A limit record used as a placeholder when the the actual limit is not known.\n-     * <p>\n-     * Has a large limit and long duration so that it will doesn't expire too often.\n      *\n      * @since 1.100\n      */\n     public static class UnknownLimitRecord extends Record {\n \n-        // One hour\n-        private static final long unknownLimitResetSeconds = 60L * 60L;\n+        private static final long defaultUnknownLimitResetSeconds = Duration.ofSeconds(30).toMillis() / 1000;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d97218ffd5d2f4706c69b8520869f6489e959b4c"}, "originalPosition": 229}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NjA2NzYx", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-444606761", "createdAt": "2020-07-08T10:16:35Z", "commit": {"oid": "d97218ffd5d2f4706c69b8520869f6489e959b4c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MjgwMjQx", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-445280241", "createdAt": "2020-07-09T04:23:32Z", "commit": {"oid": "81d4240bc5d5ff76b1c4ded1f934849321a4b077"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NTE2MDg1", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-446516085", "createdAt": "2020-07-10T15:57:38Z", "commit": {"oid": "aa4a8341f000b4df87b6fa7dd5fe0e9f05002ce3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNTo1NzozOFrOGv8v2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQxNTo1NzozOFrOGv8v2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjkzMTU0Nw==", "bodyText": "Instead of trying to guess corresponding rate limit checker from the url path, depend on the requester to provide that information.  Much simpler.", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r452931547", "createdAt": "2020-07-10T15:57:38Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GitHubRateLimitChecker.java", "diffHunk": "@@ -122,24 +136,26 @@ void checkRateLimit(GitHubClient client, GitHubRequest request) throws IOExcepti\n \n     /**\n      * Gets the appropriate {@link RateLimitChecker} for a particular url path. Similar to\n-     * {@link GHRateLimit#getRecordForUrlPath(String)}.\n+     * {@link GHRateLimit#getRecord(RateLimitTarget)}.\n      *\n-     * @param urlPath\n-     *            the url path of the request\n-     * @return the {@link RateLimitChecker} for a url path.\n+     * @param rateLimitTarget\n+     *            the rate limit to check\n+     * @return the {@link RateLimitChecker} for a particular target\n      */\n     @Nonnull\n-    private RateLimitChecker selectChecker(@Nonnull String urlPath) {\n-        if (urlPath.equals(\"/rate_limit\")) {\n+    private RateLimitChecker selectChecker(@Nonnull RateLimitTarget rateLimitTarget) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa4a8341f000b4df87b6fa7dd5fe0e9f05002ce3"}, "originalPosition": 100}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ef0d0084629ed5da7ae6e51473e10adf7560bf7", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/4ef0d0084629ed5da7ae6e51473e10adf7560bf7", "committedDate": "2020-07-10T16:01:29Z", "message": "Integrate full rate limit checking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52472e90ec3ba02e5b1b20b24a4da43526b62abf", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/52472e90ec3ba02e5b1b20b24a4da43526b62abf", "committedDate": "2020-07-10T16:01:29Z", "message": "Simplified rate limit record selection\n\nHere we have another example of trying to do something clever when simplicity is the better choice.\nRather than trying to guess the rate limit record for a request based on the url path,\nI added an enumeration which can be set on the request to say which rate limit record to applies.\n\nThis is simpler, safer, and faster than trying to guess the rate limit from the url path."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46e3b2272edf4e18db52a978a97e9d19af439a3f", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/46e3b2272edf4e18db52a978a97e9d19af439a3f", "committedDate": "2020-07-10T16:01:29Z", "message": "Clean up and reorganize changes\n\nChanged GitHubRateLimitSpecifier to RateLimitTarget\nMade RateLimitTarget public so it can be passed to GitHubBuilder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afa170ba7cabd5b515b1a2fcd42ffc3a84f7e2e5", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/afa170ba7cabd5b515b1a2fcd42ffc3a84f7e2e5", "committedDate": "2020-07-10T16:01:29Z", "message": "Add more tests for rate limit record selection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b3f81ee348e256a4d23af4cab15903619098d04", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/4b3f81ee348e256a4d23af4cab15903619098d04", "committedDate": "2020-07-10T17:51:20Z", "message": "Clean up comments and javadoc"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aa4a8341f000b4df87b6fa7dd5fe0e9f05002ce3", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/aa4a8341f000b4df87b6fa7dd5fe0e9f05002ce3", "committedDate": "2020-07-10T15:51:52Z", "message": "Merge branch 'master' into task/rate-limit/full"}, "afterCommit": {"oid": "4b3f81ee348e256a4d23af4cab15903619098d04", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/4b3f81ee348e256a4d23af4cab15903619098d04", "committedDate": "2020-07-10T17:51:20Z", "message": "Clean up comments and javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4Mzk2MTgz", "url": "https://github.com/hub4j/github-api/pull/830#pullrequestreview-448396183", "createdAt": "2020-07-14T19:21:19Z", "commit": {"oid": "4b3f81ee348e256a4d23af4cab15903619098d04"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxOToyMToyMFrOGxh4Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxOToyMToyMFrOGxh4Gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU4ODQ0Mg==", "bodyText": "Merge and equality logic moved into GHRateLimit.", "url": "https://github.com/hub4j/github-api/pull/830#discussion_r454588442", "createdAt": "2020-07-14T19:21:20Z", "author": {"login": "bitwiseman"}, "path": "src/main/java/org/kohsuke/github/GitHubClient.java", "diffHunk": "@@ -654,37 +641,6 @@ private boolean isPrivateModeEnabled() {\n         }\n     }\n \n-    /**\n-     * Determine if one {@link GHRateLimit.Record} should replace another. Header date is only accurate to the second,\n-     * so we look at the information in the record itself.\n-     *\n-     * {@link GHRateLimit.UnknownLimitRecord}s are always replaced by regular {@link GHRateLimit.Record}s. Regular\n-     * {@link GHRateLimit.Record}s are never replaced by {@link GHRateLimit.UnknownLimitRecord}s. Candidates with\n-     * resetEpochSeconds later than current record are more recent. Candidates with the same reset and a lower remaining\n-     * count are more recent. Candidates with an earlier reset are older.\n-     *\n-     * @param candidate\n-     *            {@link GHRateLimit.Record} constructed from the response header information\n-     * @param current\n-     *            the current {@link GHRateLimit.Record} record\n-     */\n-    static boolean shouldReplace(@Nonnull GHRateLimit.Record candidate, @Nonnull GHRateLimit.Record current) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b3f81ee348e256a4d23af4cab15903619098d04"}, "originalPosition": 301}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "987c34c69e97202451af6b77d4a59dc1dffd787d", "author": {"user": {"login": "bitwiseman", "name": "Liam Newman"}}, "url": "https://github.com/hub4j/github-api/commit/987c34c69e97202451af6b77d4a59dc1dffd787d", "committedDate": "2020-07-15T19:13:16Z", "message": "Merge branch 'master' into task/rate-limit/full"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1611, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}