{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5NDQ4ODc2", "number": 4130, "title": "RW-5701 fixing domain_info counts", "bodyText": "fixing domain_info counts", "createdAt": "2020-10-07T18:48:18Z", "url": "https://github.com/all-of-us/workbench/pull/4130", "merged": true, "mergeCommit": {"oid": "7b93616005de2f61a9ec09e40d411cd390026cbd"}, "closed": true, "closedAt": "2020-10-07T19:41:50Z", "author": {"login": "freemabd"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQRjvhgH2gAyNDk5NDQ4ODc2OjAzNmIxZGNhNzhmNTI0MmQ4YWM4MGUyMDJhZDRiNGVlOGFhMDQ3ZmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQR3JtgFqTUwNDE4NjQxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "036b1dca78f5242d8ac80e202ad4b4ee8aa047fa", "author": {"user": {"login": "freemabd", "name": "Brian Freeman"}}, "url": "https://github.com/all-of-us/workbench/commit/036b1dca78f5242d8ac80e202ad4b4ee8aa047fa", "committedDate": "2020-10-07T18:47:27Z", "message": "RW-5701 fixing domain_info counts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MTcyMDg5", "url": "https://github.com/all-of-us/workbench/pull/4130#pullrequestreview-504172089", "createdAt": "2020-10-07T18:48:46Z", "commit": {"oid": "036b1dca78f5242d8ac80e202ad4b4ee8aa047fa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxODo0ODo0NlrOHeBCGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxODo0ODo0NlrOHeBCGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTIzNjI1MQ==", "bodyText": "Switched counts back to old code.", "url": "https://github.com/all-of-us/workbench/pull/4130#discussion_r501236251", "createdAt": "2020-10-07T18:48:46Z", "author": {"login": "freemabd"}, "path": "api/db-cdr/generate-cdr/make-bq-data.sh", "diffHunk": "@@ -455,20 +455,20 @@ set d.standard_concept_count = c.standard_concept_count\n from (select c.domain_id as domain_id, COUNT(DISTINCT c.concept_id) as standard_concept_count\n from \\`$OUTPUT_PROJECT.$OUTPUT_DATASET.cb_criteria\\` c\n join \\`$OUTPUT_PROJECT.$OUTPUT_DATASET.domain_info\\` d2\n-on d2.domain_enum = c.domain_id and c.is_standard = 1 and c.is_selectable = 1\n+on d2.domain_enum = c.domain_id and c.is_standard = 1 and c.is_selectable = 1  and d2.domain_enum != 'PHYSICAL_MEASUREMENT'\n group by c.domain_id) c\n where d.domain_enum = c.domain_id\"\n \n # Set all_concept_count on domain_info for Physical Measurements\n bq --quiet --project=$BQ_PROJECT query --nouse_legacy_sql \\\n \"update \\`$OUTPUT_PROJECT.$OUTPUT_DATASET.domain_info\\` d\n-set d.all_concept_count = c.all_concept_count\n-from (SELECT count(distinct concept_id) as all_concept_count\n-FROM \\`$BQ_PROJECT.$BQ_DATASET.cb_criteria\\`\n-WHERE type = 'PPI'\n-AND domain_id = 'PHYSICAL_MEASUREMENT'\n-AND is_selectable = 1) c\n-where d.domain = 10\"\n+set d.all_concept_count = c.all_concept_count from", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "036b1dca78f5242d8ac80e202ad4b4ee8aa047fa"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MTg2NDEw", "url": "https://github.com/all-of-us/workbench/pull/4130#pullrequestreview-504186410", "createdAt": "2020-10-07T19:08:39Z", "commit": {"oid": "036b1dca78f5242d8ac80e202ad4b4ee8aa047fa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3920, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}