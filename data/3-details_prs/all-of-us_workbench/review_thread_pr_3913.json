{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczMjc0MTM2", "number": 3913, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxNToxOToxMlrOEcHp4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNToyMzo0MlrOEcoI2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3OTIwOTkzOnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/admin/admin-user.tsx", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxNToxOToxMlrOHGdL_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNTozMToyM1rOHHRu4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUzMTcwOA==", "bodyText": "can't hardcode the options list because we also need to include the current override value, if one exists and is not one of these", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476531708", "createdAt": "2020-08-25T15:19:12Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -56,19 +57,7 @@ const styles = reactStyles({\n   }\n });\n \n-const freeCreditLimitOptions = [\n-  {label: '$300', value: 300},\n-  {label: '$350', value: 350},\n-  {label: '$400', value: 400},\n-  {label: '$450', value: 450},\n-  {label: '$500', value: 500},\n-  {label: '$550', value: 550},\n-  {label: '$600', value: 600},\n-  {label: '$650', value: 650},\n-  {label: '$700', value: 700},\n-  {label: '$750', value: 750},\n-  {label: '$800', value: 800}\n-];\n+const freeCreditLimitDefaultOptions = new Set([300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "524cc00d269b45ac81b428957c45507657dfee98"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyMzE0NQ==", "bodyText": "nit: consider fp.range.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476723145", "createdAt": "2020-08-25T20:39:02Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -56,19 +57,7 @@ const styles = reactStyles({\n   }\n });\n \n-const freeCreditLimitOptions = [\n-  {label: '$300', value: 300},\n-  {label: '$350', value: 350},\n-  {label: '$400', value: 400},\n-  {label: '$450', value: 450},\n-  {label: '$500', value: 500},\n-  {label: '$550', value: 550},\n-  {label: '$600', value: 600},\n-  {label: '$650', value: 650},\n-  {label: '$700', value: 700},\n-  {label: '$750', value: 750},\n-  {label: '$800', value: 800}\n-];\n+const freeCreditLimitDefaultOptions = new Set([300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800]);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUzMTcwOA=="}, "originalCommit": {"oid": "524cc00d269b45ac81b428957c45507657dfee98"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzMyNDU1Mw==", "bodyText": "I considered this, but was surprisingly unsuccessful: https://github.com/all-of-us/workbench/commits/joel/RW-4956-range", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477324553", "createdAt": "2020-08-26T14:00:50Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -56,19 +57,7 @@ const styles = reactStyles({\n   }\n });\n \n-const freeCreditLimitOptions = [\n-  {label: '$300', value: 300},\n-  {label: '$350', value: 350},\n-  {label: '$400', value: 400},\n-  {label: '$450', value: 450},\n-  {label: '$500', value: 500},\n-  {label: '$550', value: 550},\n-  {label: '$600', value: 600},\n-  {label: '$650', value: 650},\n-  {label: '$700', value: 700},\n-  {label: '$750', value: 750},\n-  {label: '$800', value: 800}\n-];\n+const freeCreditLimitDefaultOptions = new Set([300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800]);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUzMTcwOA=="}, "originalCommit": {"oid": "524cc00d269b45ac81b428957c45507657dfee98"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM5MjYxMA==", "bodyText": "Fixed, after Greg's surprising suggestion to randomly rearrange the params until it works.  Apparently this is a \"fun quirk\" of fp-lodash.  Added comment to explain.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477392610", "createdAt": "2020-08-26T15:31:23Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -56,19 +57,7 @@ const styles = reactStyles({\n   }\n });\n \n-const freeCreditLimitOptions = [\n-  {label: '$300', value: 300},\n-  {label: '$350', value: 350},\n-  {label: '$400', value: 400},\n-  {label: '$450', value: 450},\n-  {label: '$500', value: 500},\n-  {label: '$550', value: 550},\n-  {label: '$600', value: 600},\n-  {label: '$650', value: 650},\n-  {label: '$700', value: 700},\n-  {label: '$750', value: 750},\n-  {label: '$800', value: 800}\n-];\n+const freeCreditLimitDefaultOptions = new Set([300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800]);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUzMTcwOA=="}, "originalCommit": {"oid": "524cc00d269b45ac81b428957c45507657dfee98"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3OTIyOTU2OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/admin/admin-user.tsx", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxNToyMzo0NFrOHGdYXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxMzo1MToxNFrOHHNGeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUzNDg3OA==", "bodyText": "tested with quota:\n\nundefined\nequal to a predefined value: does not duplicate\ndefined, with various values in and around the predefined range: orders correctly", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476534878", "createdAt": "2020-08-25T15:23:44Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -225,6 +214,12 @@ const AdminUser = withUrlParams()(class extends React.Component<Props, State> {\n     }\n   }\n \n+  getFreeCreditLimitOptions() {\n+    const {oldProfile: {freeTierDollarQuota}} = this.state;\n+    const defaultsPlusMaybeOverride = Array.from(freeCreditLimitDefaultOptions.add(freeTierDollarQuota));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "524cc00d269b45ac81b428957c45507657dfee98"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyNDYzOQ==", "bodyText": "I'm not sure if we want to tolerate undefined values or just assume we'll set whatever isn't there to null. IOW I never understood how undefined is a feature of JavaScript.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476724639", "createdAt": "2020-08-25T20:41:54Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -225,6 +214,12 @@ const AdminUser = withUrlParams()(class extends React.Component<Props, State> {\n     }\n   }\n \n+  getFreeCreditLimitOptions() {\n+    const {oldProfile: {freeTierDollarQuota}} = this.state;\n+    const defaultsPlusMaybeOverride = Array.from(freeCreditLimitDefaultOptions.add(freeTierDollarQuota));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUzNDg3OA=="}, "originalCommit": {"oid": "524cc00d269b45ac81b428957c45507657dfee98"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzMxNjcyOQ==", "bodyText": "Here I was imprecise: I do not mean JS undefined.  Rather, the DB user has free_tier_credits_limit_dollars_override set to NULL, which is the state for almost all users.\nThis results in freeTierDollarQuota here being equal to the config-file default value, which may or may not be one of the predefined dropdown options (300 to 800) but in current practice is 300.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477316729", "createdAt": "2020-08-26T13:51:14Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -225,6 +214,12 @@ const AdminUser = withUrlParams()(class extends React.Component<Props, State> {\n     }\n   }\n \n+  getFreeCreditLimitOptions() {\n+    const {oldProfile: {freeTierDollarQuota}} = this.state;\n+    const defaultsPlusMaybeOverride = Array.from(freeCreditLimitDefaultOptions.add(freeTierDollarQuota));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUzNDg3OA=="}, "originalCommit": {"oid": "524cc00d269b45ac81b428957c45507657dfee98"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3OTI0MzM5OnYy", "diffSide": "LEFT", "path": "ui/src/app/pages/profile/profile-page.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxNToyNjozMlrOHGdhCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxNToyNjozMlrOHGdhCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjUzNzA5Nw==", "bodyText": "renderUSD() is strictly a string processing function now.  The formatting is desired only here, so it was moved here.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476537097", "createdAt": "2020-08-25T15:26:32Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/profile/profile-page.tsx", "diffHunk": "@@ -577,8 +577,8 @@ export const ProfilePage = withUserProfile()(class extends React.Component<\n                     <div>Remaining <i>All of Us</i> free credits:</div>\n                 </FlexColumn>\n                 <FlexColumn style={{alignItems: 'flex-end', marginLeft: '1.0rem'}}>\n-                    <div style={{marginTop: '0.4rem'}}>{renderUSD(profile.freeTierUsage)}</div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6a00b2678c5ba0c61b59776de8374afd2c297f4"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDQxOTM3OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/admin/admin-user.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDozOTo1M1rOHGo5bg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDozOTo1M1rOHGo5bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyMzU2Ng==", "bodyText": "nit: maybe indicate in the help text or hover  text that  this applies to  all workspaces owned by this user.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476723566", "createdAt": "2020-08-25T20:39:53Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -124,6 +112,31 @@ const EmailValidationErrorMessage = ({emailValidationResponse, updatedProfile, v\n   return null;\n };\n \n+const FreeCreditsUsage = ({aboveLimit, usage}) => {\n+  const inputStyle = aboveLimit ?\n+  {...styles.textInput,\n+    backgroundColor: colorWithWhiteness(colors.danger, .95),\n+    borderColor: colors.danger,\n+    color: colors.danger,\n+  } :\n+  {...styles.textInput,\n+    ...styles.backgroundColorDark,\n+    color: colors.disabled,\n+  };\n+\n+  return <React.Fragment>\n+    <TextInputWithLabel\n+      labelText={'Free credits used'}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db3b059377ff6910dd7102df0b5f00dabc53df15"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDQyMTg0OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/admin/admin-user.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDo0MDozNFrOHGo65w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNDowMjo1NVrOHHNq6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyMzk0Mw==", "bodyText": "nit: type these? I don't know what rule we settled on for when we explicitly type stuff.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476723943", "createdAt": "2020-08-25T20:40:34Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -124,6 +112,31 @@ const EmailValidationErrorMessage = ({emailValidationResponse, updatedProfile, v\n   return null;\n };\n \n+const FreeCreditsUsage = ({aboveLimit, usage}) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db3b059377ff6910dd7102df0b5f00dabc53df15"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjczODM3Mg==", "bodyText": "I attempted to, unsuccessfully.  My assumption was that it was not possible.  But now Googling tells me otherwise, so I will make an attempt.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476738372", "createdAt": "2020-08-25T21:08:51Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -124,6 +112,31 @@ const EmailValidationErrorMessage = ({emailValidationResponse, updatedProfile, v\n   return null;\n };\n \n+const FreeCreditsUsage = ({aboveLimit, usage}) => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyMzk0Mw=="}, "originalCommit": {"oid": "db3b059377ff6910dd7102df0b5f00dabc53df15"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzMyNjA1OA==", "bodyText": "typed now, with a FreeCreditsProps", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477326058", "createdAt": "2020-08-26T14:02:55Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -124,6 +112,31 @@ const EmailValidationErrorMessage = ({emailValidationResponse, updatedProfile, v\n   return null;\n };\n \n+const FreeCreditsUsage = ({aboveLimit, usage}) => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyMzk0Mw=="}, "originalCommit": {"oid": "db3b059377ff6910dd7102df0b5f00dabc53df15"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDQzMjY0OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/admin/admin-user.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDo0NDowM1rOHGpBmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDo0NDowM1rOHGpBmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyNTY1OQ==", "bodyText": "nit: I'd name this isAboveLimit. Generally booleans starting with forms of \"be\" are more recognizable IMO.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476725659", "createdAt": "2020-08-25T20:44:03Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -500,23 +535,18 @@ const AdminUser = withUrlParams()(class extends React.Component<Props, State> {\n                 containerStyle={styles.textInputContainer}\n                 onChange={email => this.setContactEmail(email)}\n             />\n-            <TextInputWithLabel\n-                labelText={'Free credits used'}\n-                placeholder={updatedProfile.freeTierUsage}\n-                inputId={'freeTierUsage'}\n-                disabled={true}\n-                inputStyle={{width: '6.5rem', ...styles.backgroundColorDark}}\n-                containerStyle={styles.textInputContainer}\n+            <FreeCreditsUsage\n+              aboveLimit={this.usageIsAboveLimit()}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db3b059377ff6910dd7102df0b5f00dabc53df15"}, "originalPosition": 126}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDQzNjg3OnYy", "diffSide": "RIGHT", "path": "ui/src/app/utils/index.tsx", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDo0NToxN1rOHGpEGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNDoxMToyNVrOHHODcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyNjI5Nw==", "bodyText": "render implies a side effect. I'd call this formatCreditUsage. (The negative to zero conversion indicates to me that maybe we shouldn't put it in a public utils file, as that's not standard, and would be an easy way to generate bugs.)\nIs there a specific requirement to drop the cents when it's zero? Why not when it's $1? Or can we just round to the nearest dollar?", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476726297", "createdAt": "2020-08-25T20:45:17Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/utils/index.tsx", "diffHunk": "@@ -531,12 +531,12 @@ export function highlightSearchTerm(searchTerm: string, stringToHighlight: strin\n \n // render a float value as US currency, rounded to cents: 255.372793 -> $255.37\n // negative values are rendered as $0\n-export function renderUSD(value: number) {\n+export function renderUSD(value: number): string {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db3b059377ff6910dd7102df0b5f00dabc53df15"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzMzMjMzNg==", "bodyText": "Renamed away from \"render\" and with a name to indicate that this is specifically for free credit values (usage, balance, quota/override).\nThe requirement is to use the string \"$0\" for negative values.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477332336", "createdAt": "2020-08-26T14:11:25Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/utils/index.tsx", "diffHunk": "@@ -531,12 +531,12 @@ export function highlightSearchTerm(searchTerm: string, stringToHighlight: strin\n \n // render a float value as US currency, rounded to cents: 255.372793 -> $255.37\n // negative values are rendered as $0\n-export function renderUSD(value: number) {\n+export function renderUSD(value: number): string {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyNjI5Nw=="}, "originalCommit": {"oid": "db3b059377ff6910dd7102df0b5f00dabc53df15"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4MDQ0MjA1OnYy", "diffSide": "RIGHT", "path": "ui/src/app/utils/institutions.tsx", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMDo0Njo1OFrOHGpHXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNjo1NDoxMlrOHHVF5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyNzEzMw==", "bodyText": "direct comparison to undefined makes me nervous. Is everything getting initialized correctly?", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r476727133", "createdAt": "2020-08-25T20:46:58Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/utils/institutions.tsx", "diffHunk": "@@ -44,6 +44,10 @@ export const getRoleOptions = (institutions: Array<PublicInstitutionDetails>, in\n     const {shortName} = institution;\n     return shortName === institutionShortName;\n   }, institutions);\n+  if (matchedInstitution === null || matchedInstitution === undefined) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db3b059377ff6910dd7102df0b5f00dabc53df15"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ0NzY1NA==", "bodyText": "This is a check of a call to fp.find() which returns undefined if it is not found.  I removed the null check since it's not relevant.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477447654", "createdAt": "2020-08-26T16:54:12Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/utils/institutions.tsx", "diffHunk": "@@ -44,6 +44,10 @@ export const getRoleOptions = (institutions: Array<PublicInstitutionDetails>, in\n     const {shortName} = institution;\n     return shortName === institutionShortName;\n   }, institutions);\n+  if (matchedInstitution === null || matchedInstitution === undefined) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjcyNzEzMw=="}, "originalCommit": {"oid": "db3b059377ff6910dd7102df0b5f00dabc53df15"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NDUyMzkxOnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/admin/admin-user.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNToyMTo1MlrOHHRTUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNTo1NzowNFrOHHS2Rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM4NTU1NA==", "bodyText": "nit: don't think you need the curly braces for a string literal with no interpolation.", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477385554", "createdAt": "2020-08-26T15:21:52Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -124,6 +112,36 @@ const EmailValidationErrorMessage = ({emailValidationResponse, updatedProfile, v\n   return null;\n };\n \n+interface FreeCreditsProps {\n+  isAboveLimit: boolean;\n+  usage: string;\n+}\n+\n+const FreeCreditsUsage = ({isAboveLimit, usage}: FreeCreditsProps) => {\n+  const inputStyle = isAboveLimit ?\n+  {...styles.textInput,\n+    backgroundColor: colorWithWhiteness(colors.danger, .95),\n+    borderColor: colors.danger,\n+    color: colors.danger,\n+  } :\n+  {...styles.textInput,\n+    ...styles.backgroundColorDark,\n+    color: colors.disabled,\n+  };\n+\n+  return <React.Fragment>\n+    <TextInputWithLabel\n+      labelText={'Free credits used'}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4ce9bcd709009f37c38848b99a3c50e9f74981d"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQxMDg4Ng==", "bodyText": "yep", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477410886", "createdAt": "2020-08-26T15:57:04Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/admin/admin-user.tsx", "diffHunk": "@@ -124,6 +112,36 @@ const EmailValidationErrorMessage = ({emailValidationResponse, updatedProfile, v\n   return null;\n };\n \n+interface FreeCreditsProps {\n+  isAboveLimit: boolean;\n+  usage: string;\n+}\n+\n+const FreeCreditsUsage = ({isAboveLimit, usage}: FreeCreditsProps) => {\n+  const inputStyle = isAboveLimit ?\n+  {...styles.textInput,\n+    backgroundColor: colorWithWhiteness(colors.danger, .95),\n+    borderColor: colors.danger,\n+    color: colors.danger,\n+  } :\n+  {...styles.textInput,\n+    ...styles.backgroundColorDark,\n+    color: colors.disabled,\n+  };\n+\n+  return <React.Fragment>\n+    <TextInputWithLabel\n+      labelText={'Free credits used'}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM4NTU1NA=="}, "originalCommit": {"oid": "b4ce9bcd709009f37c38848b99a3c50e9f74981d"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NDUzMjEwOnYy", "diffSide": "RIGHT", "path": "ui/src/app/utils/index.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNToyMzo0MlrOHHRYeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNTo1NzoyOVrOHHS3XQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM4Njg3Mg==", "bodyText": "nit: if the value is exactly 0, it will print as $0.00 but if negative it's $0?", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477386872", "createdAt": "2020-08-26T15:23:42Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/utils/index.tsx", "diffHunk": "@@ -531,12 +531,12 @@ export function highlightSearchTerm(searchTerm: string, stringToHighlight: strin\n \n // render a float value as US currency, rounded to cents: 255.372793 -> $255.37\n // negative values are rendered as $0\n-export function renderUSD(value: number) {\n+export function formatFreeCreditsUSD(value: number): string {\n   value = value || 0.0;\n   if (value < 0.0) {\n-    return <div style={{fontWeight: 600}}>$0</div>;\n+    return '$0';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4ce9bcd709009f37c38848b99a3c50e9f74981d"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQxMTE2NQ==", "bodyText": "switching to <= makes sense", "url": "https://github.com/all-of-us/workbench/pull/3913#discussion_r477411165", "createdAt": "2020-08-26T15:57:29Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/utils/index.tsx", "diffHunk": "@@ -531,12 +531,12 @@ export function highlightSearchTerm(searchTerm: string, stringToHighlight: strin\n \n // render a float value as US currency, rounded to cents: 255.372793 -> $255.37\n // negative values are rendered as $0\n-export function renderUSD(value: number) {\n+export function formatFreeCreditsUSD(value: number): string {\n   value = value || 0.0;\n   if (value < 0.0) {\n-    return <div style={{fontWeight: 600}}>$0</div>;\n+    return '$0';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzM4Njg3Mg=="}, "originalCommit": {"oid": "b4ce9bcd709009f37c38848b99a3c50e9f74981d"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2325, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}