{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNzc0MTM3", "number": 3717, "title": "[risk=no][RW-4911] A few fixes for latest input file", "bodyText": "Description:\nUpdates for all-of-us/workbench-devops#46\n\n\nPR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n I have run the E2E tests on ths change against my local UI + API server with yarn test-local\n If this includes a UI change, I have taken screen recordings or screenshots of the new behavior and notified the PO and UX designer\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-06-26T20:30:37Z", "url": "https://github.com/all-of-us/workbench/pull/3717", "merged": true, "mergeCommit": {"oid": "9e152de18a365da371665663d2b21e7c7c5de8f7"}, "closed": true, "closedAt": "2020-06-28T14:24:25Z", "author": {"login": "jmthibault79"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcvJQ66gH2gAyNDQwNzc0MTM3OmMxYTY2NmNlNTk0ODEwNDIyNzdiYmM0OTNmODkxNWU1YmYxZDM5N2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcvcQgxAFqTQzODcxNjQ2OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c1a666ce59481042277bbc493f8915e5bf1d397f", "author": {"user": {"login": "jmthibault79", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/c1a666ce59481042277bbc493f8915e5bf1d397f", "committedDate": "2020-06-26T20:28:09Z", "message": "A few fixes for latest input file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NTc5NjM1", "url": "https://github.com/all-of-us/workbench/pull/3717#pullrequestreview-438579635", "createdAt": "2020-06-26T20:35:53Z", "commit": {"oid": "c1a666ce59481042277bbc493f8915e5bf1d397f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQyMDozNTo1M1rOGpt99w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQyMDozNTo1M1rOGpt99w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjM5Nzk0Mw==", "bodyText": "\"Multispecialty Group Practice\" was already an approved \"Other\" ... checking up on \"Non-tenure track researcher\" as well", "url": "https://github.com/all-of-us/workbench/pull/3717#discussion_r446397943", "createdAt": "2020-06-26T20:35:53Z", "author": {"login": "jmthibault79"}, "path": "api/tools/src/main/java/org/pmiops/workbench/tools/institutions/Researcher.java", "diffHunk": "@@ -60,15 +60,22 @@\n           .build();\n \n   private Researcher(final String[] userLine) {\n-    this.firstName = userLine[0].trim();\n-    this.lastName = userLine[1].trim();\n-    this.contactEmail = userLine[2].trim();\n-    this.userName = userLine[3].trim();\n-    this.institutionalRole = parseInstitutionalRole(userLine[4].trim());\n-    this.institutionalRoleOther = parseInstitutionalRoleOther(userLine[4].trim());\n-    this.institutionDisplayName = parseInstitutionDisplayName(userLine[5].trim());\n-    this.duaSigned = userLine[6].trim();\n-    this.redCapComplete = userLine[7].trim();\n+    this.firstName = clean(userLine[0]);\n+    this.lastName = clean(userLine[1]);\n+    this.contactEmail = clean(userLine[2]);\n+    this.userName = clean(userLine[3]);\n+    this.institutionalRole = parseInstitutionalRole(clean(userLine[4]));\n+    this.institutionalRoleOther = parseInstitutionalRoleOther(clean(userLine[4]));\n+    this.institutionDisplayName = parseInstitutionDisplayName(clean(userLine[5]));\n+    this.duaSigned = clean(userLine[6]);\n+    this.redCapComplete = clean(userLine[7]);\n+  }\n+\n+  // special case a few Other roles\n+\n+  private boolean isPreApprovedOtherRole(String rawRole) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1a666ce59481042277bbc493f8915e5bf1d397f"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NTgwMDc0", "url": "https://github.com/all-of-us/workbench/pull/3717#pullrequestreview-438580074", "createdAt": "2020-06-26T20:36:46Z", "commit": {"oid": "c1a666ce59481042277bbc493f8915e5bf1d397f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQyMDozNjo0NlrOGpt_Ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQyMDozNjo0NlrOGpt_Ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjM5ODI5MA==", "bodyText": "the description for this (see line 47, or original CAPS doc) includes Data Analyst", "url": "https://github.com/all-of-us/workbench/pull/3717#discussion_r446398290", "createdAt": "2020-06-26T20:36:46Z", "author": {"login": "jmthibault79"}, "path": "api/tools/src/main/java/org/pmiops/workbench/tools/institutions/Researcher.java", "diffHunk": "@@ -104,9 +115,12 @@ private InstitutionalRole parseInstitutionalRole(final String rawRole) {\n       return InstitutionalRole.TRAINEE;\n     }\n \n-    // special case one particular user\n-    // hopefully we will not need to add many such cases like this\n-    if (rawRole.equals(\"Multispecialty Group Practice\")) {\n+    if (rawRole.startsWith(\"Data Analyst\")) {\n+      return InstitutionalRole.PROJECT_PERSONNEL;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1a666ce59481042277bbc493f8915e5bf1d397f"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NTgwNDIw", "url": "https://github.com/all-of-us/workbench/pull/3717#pullrequestreview-438580420", "createdAt": "2020-06-26T20:37:29Z", "commit": {"oid": "c1a666ce59481042277bbc493f8915e5bf1d397f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQyMDozNzoyOVrOGpuAdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQyMDozNzoyOVrOGpuAdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjM5ODU4Mw==", "bodyText": "not sure why this started with this particular input", "url": "https://github.com/all-of-us/workbench/pull/3717#discussion_r446398583", "createdAt": "2020-06-26T20:37:29Z", "author": {"login": "jmthibault79"}, "path": "api/tools/src/main/java/org/pmiops/workbench/tools/institutions/UserToAffiliate.java", "diffHunk": "@@ -22,6 +22,11 @@\n   String contactEmail;\n   String userName;\n \n+  // sometimes the CSVReader retains double quotes so we remove them manually", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1a666ce59481042277bbc493f8915e5bf1d397f"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NzE2NDY4", "url": "https://github.com/all-of-us/workbench/pull/3717#pullrequestreview-438716468", "createdAt": "2020-06-27T18:35:54Z", "commit": {"oid": "c1a666ce59481042277bbc493f8915e5bf1d397f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4631, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}