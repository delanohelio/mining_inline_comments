{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkxMjIyMDM4", "number": 4048, "title": "[no ticket][risk=no] Puppeteer flaky cohort UI fix", "bodyText": "cohort tests sometimes fails due to loading spinner interfering with click action.\nhttps://app.circleci.com/pipelines/github/all-of-us/workbench/4099/workflows/d3cd9468-1e7e-45cf-b98f-8b40832a28a2/jobs/100459/artifacts", "createdAt": "2020-09-22T22:13:00Z", "url": "https://github.com/all-of-us/workbench/pull/4048", "merged": true, "mergeCommit": {"oid": "017f5e12be18a945d8f3041ed39984647f901b7b"}, "closed": true, "closedAt": "2020-09-24T12:01:28Z", "author": {"login": "aweng98"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLfiz-gFqTQ5Mzg4Mzc0MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdL5Wf_AFqTQ5NTIwODE4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzODgzNzQw", "url": "https://github.com/all-of-us/workbench/pull/4048#pullrequestreview-493883740", "createdAt": "2020-09-22T22:14:59Z", "commit": {"oid": "5956bb9b63be3a0358411a69541b75cf0b54e93f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQyMjoxNDo1OVrOHWOOpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMlQyMjoxNDo1OVrOHWOOpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA2Mzg0NA==", "bodyText": "I expect this will address the flaky behavior in Cohort tests. Not removing 1 second sleep for now to see if flaky still happens.", "url": "https://github.com/all-of-us/workbench/pull/4048#discussion_r493063844", "createdAt": "2020-09-22T22:14:59Z", "author": {"login": "aweng98"}, "path": "e2e/app/page/cohort-search-page.ts", "diffHunk": "@@ -107,6 +107,7 @@ export default class CohortSearchPage extends AuthenticatedPage {\n \n     const link = await this.waitForPhysicalMeasurementCriteriaLink(criteriaName);\n     await link.click();\n+    await waitWhileLoading(this.page);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5956bb9b63be3a0358411a69541b75cf0b54e93f"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "136232e8ac7c657f84062d000357439e336e0565", "author": {"user": {"login": "aweng98", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/136232e8ac7c657f84062d000357439e336e0565", "committedDate": "2020-09-24T00:55:48Z", "message": "fix"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce1f0881299aba484a4975ecb0265127eee6629a", "author": {"user": {"login": "aweng98", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/ce1f0881299aba484a4975ecb0265127eee6629a", "committedDate": "2020-09-24T00:53:06Z", "message": "more changes"}, "afterCommit": {"oid": "136232e8ac7c657f84062d000357439e336e0565", "author": {"user": {"login": "aweng98", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/136232e8ac7c657f84062d000357439e336e0565", "committedDate": "2020-09-24T00:55:48Z", "message": "fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MDU0NjAx", "url": "https://github.com/all-of-us/workbench/pull/4048#pullrequestreview-495054601", "createdAt": "2020-09-23T21:15:43Z", "commit": {"oid": "0b51b35763df1b5e397d4483459f4353b59f108e"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMToxNTo0M1rOHXBRQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwMTowNjo1NVrOHXGPgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkwMDA5OA==", "bodyText": "Ah, yes, you're right.\nI did see spinner spinning while watching test playback so I think waitWhileLoading is still needed.", "url": "https://github.com/all-of-us/workbench/pull/4048#discussion_r493900098", "createdAt": "2020-09-23T21:15:43Z", "author": {"login": "aweng98"}, "path": "e2e/app/page/cohort-search-page.ts", "diffHunk": "@@ -107,6 +107,7 @@ export default class CohortSearchPage extends AuthenticatedPage {\n \n     const link = await this.waitForPhysicalMeasurementCriteriaLink(criteriaName);\n     await link.click();\n+    await waitWhileLoading(this.page);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA2Mzg0NA=="}, "originalCommit": {"oid": "5956bb9b63be3a0358411a69541b75cf0b54e93f"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzk4MDIzMQ==", "bodyText": "Fix a bug in selector when only nodeLevel was specified.\ne.g. const selectMenu = await SelectMenu.findByName(this.page, {ancestorLevel: 0}, this);", "url": "https://github.com/all-of-us/workbench/pull/4048#discussion_r493980231", "createdAt": "2020-09-24T01:01:14Z", "author": {"login": "aweng98"}, "path": "e2e/app/xpath-builders.ts", "diffHunk": "@@ -62,7 +62,7 @@ export function buildXPath(xOpts: XPathOptions, container?: Container): string {\n     selector = `${textExpr}//${type}`;\n     break;\n   case ElementType.Dropdown:\n-    selector = `${textExpr}//*[contains(concat(\" \", normalize-space(@class)),\" p-dropdown\")]`;\n+    selector = `${textExpr}${nodeLevel}//*[contains(concat(\" \", normalize-space(@class), \" \"), \" p-dropdown \")]`;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "136232e8ac7c657f84062d000357439e336e0565"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzk4MTU3MA==", "bodyText": "Update because I changed Dropdown in xpath-builders.ts.", "url": "https://github.com/all-of-us/workbench/pull/4048#discussion_r493981570", "createdAt": "2020-09-24T01:06:55Z", "author": {"login": "aweng98"}, "path": "e2e/app/page/create-account-page.ts", "diffHunk": "@@ -66,12 +66,12 @@ export const FieldSelector = {\n   },\n   InstitutionSelect: {\n     textOption: {\n-      type:ElementType.Dropdown, name:'Select your institution', ancestorLevel:2\n+      type:ElementType.Dropdown, name:'Select your institution', ancestorLevel:1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "136232e8ac7c657f84062d000357439e336e0565"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MjA4MTgy", "url": "https://github.com/all-of-us/workbench/pull/4048#pullrequestreview-495208182", "createdAt": "2020-09-24T04:19:24Z", "commit": {"oid": "136232e8ac7c657f84062d000357439e336e0565"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwNDoxOToyNFrOHXJJEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwNDoxOToyNFrOHXJJEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDAyOTA3Mw==", "bodyText": "Sounds good, thanks.", "url": "https://github.com/all-of-us/workbench/pull/4048#discussion_r494029073", "createdAt": "2020-09-24T04:19:24Z", "author": {"login": "dolbeew"}, "path": "e2e/app/page/cohort-search-page.ts", "diffHunk": "@@ -107,6 +107,7 @@ export default class CohortSearchPage extends AuthenticatedPage {\n \n     const link = await this.waitForPhysicalMeasurementCriteriaLink(criteriaName);\n     await link.click();\n+    await waitWhileLoading(this.page);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA2Mzg0NA=="}, "originalCommit": {"oid": "5956bb9b63be3a0358411a69541b75cf0b54e93f"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4086, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}