{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5MDUzOTQz", "number": 3967, "title": "[RW-5426][risk=low] Teardown now-unused Workbench cluster endpoints", "bodyText": "(part 7 of 8)\nBlocked on: next production release containing #3932 , #3931\nRemove deprecated endpoints and fix some lingering \"cluster\" references in code.", "createdAt": "2020-09-03T22:37:04Z", "url": "https://github.com/all-of-us/workbench/pull/3967", "merged": true, "mergeCommit": {"oid": "841e9b60938730c4417c35e5177364c6e6c35138"}, "closed": true, "closedAt": "2020-09-11T22:08:52Z", "author": {"login": "calbach"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFY2AXABqjM3MjcxMjA4NTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdH5_qlABqjM3NTc1NzczMjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "805f7695660968d40ccfe240c43025b696c06a5e", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/805f7695660968d40ccfe240c43025b696c06a5e", "committedDate": "2020-09-03T22:59:15Z", "message": "actually rename.."}, "afterCommit": {"oid": "59ff469b30b8d7592694693e4d78b826b2c123e7", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/59ff469b30b8d7592694693e4d78b826b2c123e7", "committedDate": "2020-09-03T23:03:27Z", "message": "actually rename.."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "59ff469b30b8d7592694693e4d78b826b2c123e7", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/59ff469b30b8d7592694693e4d78b826b2c123e7", "committedDate": "2020-09-03T23:03:27Z", "message": "actually rename.."}, "afterCommit": {"oid": "2f0efea56af8551cf7ac6b43f22788a7c60e1cd4", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/2f0efea56af8551cf7ac6b43f22788a7c60e1cd4", "committedDate": "2020-09-10T18:58:07Z", "message": "actually rename.."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2ODA5MzQ5", "url": "https://github.com/all-of-us/workbench/pull/3967#pullrequestreview-486809349", "createdAt": "2020-09-11T13:32:51Z", "commit": {"oid": "3658f5e171177339074972f6ddee3a5026bdc4b2"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMzozMjo1MVrOHQfAzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxMzo0NjoxOVrOHQfhsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA0NzM3NA==", "bodyText": "No action today, but a reminder for this part", "url": "https://github.com/all-of-us/workbench/pull/3967#discussion_r487047374", "createdAt": "2020-09-11T13:32:51Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/actionaudit/auditors/EgressEventAuditorImpl.kt", "diffHunk": "@@ -32,15 +32,15 @@ constructor(\n ) : EgressEventAuditor {\n \n     /**\n-     * Converts the AoU-chosen cluster name into the actual VM name as reported by Google Cloud's\n+     * Converts the AoU-chosen runtime name into the actual VM name as reported by Google Cloud's\n      * flow logs. Empirically, an \"-m\" suffix is added to the VM name, due to Leo team's use\n      * of Dataproc (see https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/metadata).\n      *\n      * Note: this pattern may change if the Leo team switches to using raw VMs instead of Dataproc", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3658f5e171177339074972f6ddee3a5026bdc4b2"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA0ODgwMg==", "bodyText": "a few missed cluster -> runtime", "url": "https://github.com/all-of-us/workbench/pull/3967#discussion_r487048802", "createdAt": "2020-09-11T13:35:23Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/db/model/DbUser.java", "diffHunk": "@@ -34,10 +34,12 @@\n @Table(name = \"user\")\n public class DbUser {\n \n-  private static final String CLUSTER_NAME_PREFIX = \"all-of-us-\";\n+  private static final String RUNTIME_NAME_PREFIX = \"all-of-us-\";\n \n   /**\n-   * This is a Gson compatible class for encoding a JSON blob which is stored in MySQL. This\n+   * TODO(RW-5406): Remove cluster config overrides.\n+   *\n+   * <p>This is a Gson compatible class for encoding a JSON blob which is stored in MySQL. This\n    * represents cluster configuration overrides we support on a per-user basis for their notebook", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3658f5e171177339074972f6ddee3a5026bdc4b2"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzA1NTc5Mg==", "bodyText": "What is the context for removing this one?", "url": "https://github.com/all-of-us/workbench/pull/3967#discussion_r487055792", "createdAt": "2020-09-11T13:46:19Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/utils/mappers/LeonardoMapper.java", "diffHunk": "@@ -2,62 +2,26 @@\n \n import org.mapstruct.Mapper;\n import org.mapstruct.Mapping;\n-import org.pmiops.workbench.leonardo.model.LeonardoCluster;\n import org.pmiops.workbench.leonardo.model.LeonardoGetRuntimeResponse;\n-import org.pmiops.workbench.leonardo.model.LeonardoListClusterResponse;\n import org.pmiops.workbench.leonardo.model.LeonardoListRuntimeResponse;\n import org.pmiops.workbench.leonardo.model.LeonardoRuntimeStatus;\n-import org.pmiops.workbench.model.Cluster;\n-import org.pmiops.workbench.model.ClusterLocalizeRequest;\n-import org.pmiops.workbench.model.ClusterLocalizeResponse;\n-import org.pmiops.workbench.model.ClusterStatus;\n-import org.pmiops.workbench.model.ListClusterResponse;\n import org.pmiops.workbench.model.ListRuntimeResponse;\n import org.pmiops.workbench.model.Runtime;\n-import org.pmiops.workbench.model.RuntimeLocalizeRequest;\n-import org.pmiops.workbench.model.RuntimeLocalizeResponse;\n import org.pmiops.workbench.model.RuntimeStatus;\n \n @Mapper(config = MapStructConfig.class)\n public interface LeonardoMapper {\n-  @Mapping(target = \"internalId\", source = \"id\")\n-  @Mapping(target = \"jupyterUserScriptUri\", ignore = true)\n-  LeonardoListClusterResponse toListClusterResponse(LeonardoCluster cluster);\n-\n   @Mapping(target = \"patchInProgress\", ignore = true)\n   LeonardoListRuntimeResponse toListRuntimeResponse(LeonardoGetRuntimeResponse runtime);\n \n-  @Mapping(target = \"clusterName\", source = \"runtimeName\")\n-  @Mapping(target = \"createdDate\", source = \"auditInfo.createdDate\")\n-  @Mapping(target = \"dateAccessed\", source = \"auditInfo.dateAccessed\")\n-  ListClusterResponse toApiListClusterResponse(\n-      LeonardoListRuntimeResponse leonardoListRuntimeResponse);\n-\n   @Mapping(target = \"createdDate\", source = \"auditInfo.createdDate\")\n   @Mapping(target = \"dateAccessed\", source = \"auditInfo.dateAccessed\")\n   ListRuntimeResponse toApiListRuntimeResponse(\n       LeonardoListRuntimeResponse leonardoListRuntimeResponse);\n \n-  @Mapping(target = \"clusterName\", source = \"runtimeName\")\n-  @Mapping(target = \"clusterNamespace\", source = \"googleProject\")\n-  @Mapping(target = \"createdDate\", source = \"auditInfo.createdDate\")\n-  Cluster toApiCluster(LeonardoGetRuntimeResponse runtime);\n-\n   @Mapping(target = \"createdDate\", source = \"auditInfo.createdDate\")\n   Runtime toApiRuntime(LeonardoGetRuntimeResponse runtime);\n \n-  RuntimeLocalizeRequest clusterToRuntimeLocalizeRequest(ClusterLocalizeRequest req);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3658f5e171177339074972f6ddee3a5026bdc4b2"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc9800b9c23f77ecdc12c0c975a7268aba407080", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/cc9800b9c23f77ecdc12c0c975a7268aba407080", "committedDate": "2020-09-11T18:48:41Z", "message": "drop code, update docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9205304538748f5ae807ce3d1544c45c2459b68d", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/9205304538748f5ae807ce3d1544c45c2459b68d", "committedDate": "2020-09-11T18:48:41Z", "message": "lingering references"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f549aa0b8208e9c138c1c95b19ad35a4787b63d", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/7f549aa0b8208e9c138c1c95b19ad35a4787b63d", "committedDate": "2020-09-11T18:48:41Z", "message": "actually rename.."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f346309062551c30f603e258eb17c9ca6545bdc3", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/f346309062551c30f603e258eb17c9ca6545bdc3", "committedDate": "2020-09-11T18:48:41Z", "message": "spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79b00c48b5e6a4cffc2957fa3f73eb5b3741bdaa", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/79b00c48b5e6a4cffc2957fa3f73eb5b3741bdaa", "committedDate": "2020-09-11T18:48:41Z", "message": "delete unused stub"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b501e3388ae26956e8a5cf53616bdd087c84100", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/8b501e3388ae26956e8a5cf53616bdd087c84100", "committedDate": "2020-09-11T18:48:42Z", "message": "Comment update"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3658f5e171177339074972f6ddee3a5026bdc4b2", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/3658f5e171177339074972f6ddee3a5026bdc4b2", "committedDate": "2020-09-10T22:56:36Z", "message": "delete unused stub"}, "afterCommit": {"oid": "8b501e3388ae26956e8a5cf53616bdd087c84100", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/8b501e3388ae26956e8a5cf53616bdd087c84100", "committedDate": "2020-09-11T18:48:42Z", "message": "Comment update"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4426, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}