{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcwNDkzMDA4", "number": 3078, "title": "[risk=no] Reduce api-local-test memory limit", "bodyText": "I'm not sure if we're just using more virtual memory now, or if our machine size was somehow reduced with the CircleCI plan change.\nSee inline comment for explanation. Also https://circleci.com/docs/2.0/java-oom/", "createdAt": "2020-02-03T19:53:03Z", "url": "https://github.com/all-of-us/workbench/pull/3078", "merged": true, "mergeCommit": {"oid": "9f9c3710ff14851c7faf243302297dfaf65e30a7"}, "closed": true, "closedAt": "2020-02-03T20:09:24Z", "author": {"login": "calbach"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcAyVQOgH2gAyMzcwNDkzMDA4OjY2NzBjZDM0ODA3ZjU2MmJjNGM0YWQyNTUyYmZlM2I5MzVlYmE4Y2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcAyo6CgFqTM1MjUyNzIwMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6670cd34807f562bc4c4ad2552bfe3b935eba8cf", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/6670cd34807f562bc4c4ad2552bfe3b935eba8cf", "committedDate": "2020-02-03T19:44:33Z", "message": "reduce api-local-test memory limit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53b0d348f5765c90c883315c9e2ad75b83f18815", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/53b0d348f5765c90c883315c9e2ad75b83f18815", "committedDate": "2020-02-03T19:52:14Z", "message": "doc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNTI0ODc5", "url": "https://github.com/all-of-us/workbench/pull/3078#pullrequestreview-352524879", "createdAt": "2020-02-03T20:02:14Z", "commit": {"oid": "53b0d348f5765c90c883315c9e2ad75b83f18815"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNTI2NjQ2", "url": "https://github.com/all-of-us/workbench/pull/3078#pullrequestreview-352526646", "createdAt": "2020-02-03T20:05:03Z", "commit": {"oid": "53b0d348f5765c90c883315c9e2ad75b83f18815"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMDowNTowNFrOFk-PtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wM1QyMDowNTowNFrOFk-PtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDMxMjg4NQ==", "bodyText": "SGTM. I wonder if we could write a test suite that allocates more and more memory so we can figure out what the practical limit is.\nIf it's sounding like we need to move to a higher plan, another data point indicating that is queuing for a build after several folks have merged a PR.", "url": "https://github.com/all-of-us/workbench/pull/3078#discussion_r374312885", "createdAt": "2020-02-03T20:05:04Z", "author": {"login": "jaycarlton"}, "path": ".circleci/config.yml", "diffHunk": "@@ -68,7 +68,14 @@ jobs:\n           - MYSQL_PASSWORD=ubuntu\n     working_directory: ~/workbench\n     environment:\n-      JAVA_TOOL_OPTIONS: -Xmx2g\n+      # Drop to ~1.5G; the local API server starts two Java processes (the API\n+      # server and the cron emulator). The default machine has 4GB, so we want\n+      # the Java memory limit to be below half of that: other things on the\n+      # machine need memory as well. Using 2G here manifested in 137 errors.\n+      # If this limit proves to be too low, an alternative would be to use a\n+      # larger resource class:\n+      #   https://circleci.com/docs/2.0/configuration-reference/#resource_class\n+      JAVA_TOOL_OPTIONS: -Xmx1536m", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53b0d348f5765c90c883315c9e2ad75b83f18815"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUyNTI3MjAz", "url": "https://github.com/all-of-us/workbench/pull/3078#pullrequestreview-352527203", "createdAt": "2020-02-03T20:06:01Z", "commit": {"oid": "53b0d348f5765c90c883315c9e2ad75b83f18815"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3800, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}