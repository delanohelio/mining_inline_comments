{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MjY0NDIy", "number": 3867, "title": "[RW-4594][risk=low] UI: add modifiers slideout (phase 1)", "bodyText": "PR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n I have run the E2E tests on ths change against my local UI + API server with yarn test:local\n If this includes a UI change, I have taken screen recordings or screenshots of the new behavior and notified the PO and UX designer\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-08-10T04:19:59Z", "url": "https://github.com/all-of-us/workbench/pull/3867", "merged": true, "mergeCommit": {"oid": "f6e1711b3c705b752b9ff13155d7d41549ab9d16"}, "closed": true, "closedAt": "2020-08-13T04:00:13Z", "author": {"login": "NehaBroad"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9aVVlAH2gAyNDY1MjY0NDIyOjJhYmE3NzhmMWY5YjA2NjBkOGQzM2Y2NDdhYmNjYTNkNzRjYTUxNGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-XQuIAFqTQ2NjQxNjQ3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2aba778f1f9b0660d8d33f647abcca3d74ca514f", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/2aba778f1f9b0660d8d33f647abcca3d74ca514f", "committedDate": "2020-08-10T04:16:18Z", "message": "Apply Modifier Page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f84e37750c1d18688200528e92f2ffbb70a43f4d", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/f84e37750c1d18688200528e92f2ffbb70a43f4d", "committedDate": "2020-08-10T04:19:00Z", "message": "Revert Cohort Flag"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTUwNzM0", "url": "https://github.com/all-of-us/workbench/pull/3867#pullrequestreview-463950734", "createdAt": "2020-08-10T04:21:20Z", "commit": {"oid": "f84e37750c1d18688200528e92f2ffbb70a43f4d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNDoyMToyMFrOG-BBQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNDoyMToyMFrOG-BBQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY4MTYwMg==", "bodyText": "I just rename the old modifier-page to modifier-page-modal.component.tsx", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r467681602", "createdAt": "2020-08-10T04:21:20Z", "author": {"login": "NehaBroad"}, "path": "ui/src/app/cohort-search/modifier-page/modifier-page-modal.component.tsx", "diffHunk": "@@ -0,0 +1,568 @@\n+import * as fp from 'lodash/fp';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f84e37750c1d18688200528e92f2ffbb70a43f4d"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ab6389ce53579718f8ce0196a1e0e575973159e", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/3ab6389ce53579718f8ce0196a1e0e575973159e", "committedDate": "2020-08-10T04:24:54Z", "message": "Correct Indent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11700cc0303cce9e45d6bde897d23f2251fcab69", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/11700cc0303cce9e45d6bde897d23f2251fcab69", "committedDate": "2020-08-10T04:27:04Z", "message": "Correct Indent"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDA3MDYx", "url": "https://github.com/all-of-us/workbench/pull/3867#pullrequestreview-464407061", "createdAt": "2020-08-10T16:54:20Z", "commit": {"oid": "11700cc0303cce9e45d6bde897d23f2251fcab69"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxNjo1NDoyMFrOG-XLqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMTozMzoxNVrOG-gkUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA0NDcxNA==", "bodyText": "We'll need a condition on this button since Physical Measurements and Demographics don't get modifiers.\nAlso, the mocks show this at the bottom of the list container. Maybe use something like position: absolute; bottom: 0; on the button, may also need to set position: relative on the parent div to work.\nI know the mocks don't really show hover styles, but the current hover style looks too dark:\n\nMaybe a slight change in text and/or border color on hover like we do with the Calculate button for modifiers and attributes.", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468044714", "createdAt": "2020-08-10T16:54:20Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/selection-list/selection-list.component.tsx", "diffHunk": "@@ -335,22 +356,42 @@ export const SelectionList = withCurrentCohortCriteria()(class extends React.Com\n     </React.Fragment> ;\n   }\n \n+  applyModifier(modifiers) {\n+    if (modifiers) {\n+      const modifierButtonText = '(' + modifiers.length + ')  MODIFIERS APPLIED';\n+      this.setState({showModifiersSlide: false, modifierButtonText: modifierButtonText});\n+    } else {\n+      this.setState({showModifiersSlide: false, modifierButtonText: 'APPLY MODIFIERS'});\n+    }\n+\n+  }\n+\n   render() {\n     const {back, criteria} = this.props;\n+    const {modifierButtonText, showModifiersSlide} = this.state;\n     return <div>\n-      <div style={{paddingTop: '0.5rem'}}>\n-        {criteria && <div style={styles.selectionContainer}>\n+        {!showModifiersSlide && criteria &&  <React.Fragment>\n+          <h3 style={{...styles.sectionTitle, marginTop: 0}}>Add selected criteria to cohort</h3>\n+        <div style={{paddingTop: '0.5rem'}}>\n+          <div style={styles.selectionContainer}>\n           {this.renderCriteria()}\n-        </div>}\n-      </div>\n-      <FlexRowWrap style={{flexDirection: 'row-reverse', marginTop: '2rem'}}>\n+          <div style = {{padding: '1rem 0 1.2rem 1.2rem'}}>\n+        <Button style={{backgroundColor: colors.white, border: '0.1rem solid' + colors.accent, color: colors.accent}}\n+                onClick = {() => this.setState({showModifiersSlide: true})}>\n+        {modifierButtonText}\n+        </Button>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11700cc0303cce9e45d6bde897d23f2251fcab69"}, "originalPosition": 106}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0NDg2NA==", "bodyText": "My first instinct was to say we need to move ModifierPage to HelpSidebar like we have the attributes component, but I think it might be better if we move attributes here instead. That would make all the flipping back and forth between views simpler and also clean up the sidebar template a little.\nI can include moving the attributes in RW-5114 after this merges, or we can just do a separate ticket if needed.", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468144864", "createdAt": "2020-08-10T19:53:28Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/selection-list/selection-list.component.tsx", "diffHunk": "@@ -335,22 +356,42 @@ export const SelectionList = withCurrentCohortCriteria()(class extends React.Com\n     </React.Fragment> ;\n   }\n \n+  applyModifier(modifiers) {\n+    if (modifiers) {\n+      const modifierButtonText = '(' + modifiers.length + ')  MODIFIERS APPLIED';\n+      this.setState({showModifiersSlide: false, modifierButtonText: modifierButtonText});\n+    } else {\n+      this.setState({showModifiersSlide: false, modifierButtonText: 'APPLY MODIFIERS'});\n+    }\n+\n+  }\n+\n   render() {\n     const {back, criteria} = this.props;\n+    const {modifierButtonText, showModifiersSlide} = this.state;\n     return <div>\n-      <div style={{paddingTop: '0.5rem'}}>\n-        {criteria && <div style={styles.selectionContainer}>\n+        {!showModifiersSlide && criteria &&  <React.Fragment>\n+          <h3 style={{...styles.sectionTitle, marginTop: 0}}>Add selected criteria to cohort</h3>\n+        <div style={{paddingTop: '0.5rem'}}>\n+          <div style={styles.selectionContainer}>\n           {this.renderCriteria()}\n-        </div>}\n-      </div>\n-      <FlexRowWrap style={{flexDirection: 'row-reverse', marginTop: '2rem'}}>\n+          <div style = {{padding: '1rem 0 1.2rem 1.2rem'}}>\n+        <Button style={{backgroundColor: colors.white, border: '0.1rem solid' + colors.accent, color: colors.accent}}\n+                onClick = {() => this.setState({showModifiersSlide: true})}>\n+        {modifierButtonText}\n+        </Button>\n+        </div>\n+        </div></div>\n+        </React.Fragment>}\n+        {showModifiersSlide && <ModifierPage selections={criteria} applyModifiers={(modifier) => this.applyModifier(modifier)}/>}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11700cc0303cce9e45d6bde897d23f2251fcab69"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE0ODM2MA==", "bodyText": "Remove if no longer needed", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468148360", "createdAt": "2020-08-10T20:00:14Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/modifier-page/modifier-page.component.tsx", "diffHunk": "@@ -309,20 +287,21 @@ export const ModifierPage = withCurrentWorkspace()(\n       }\n       this.setState({formState});\n       this.getExisting();\n+        // this.setState({searchContext: this.props.cohortContext});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11700cc0303cce9e45d6bde897d23f2251fcab69"}, "originalPosition": 112}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5ODQ4MQ==", "bodyText": "Nice reusable component", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468198481", "createdAt": "2020-08-10T21:33:15Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/attributes-page-v2/attributes-page-v2.component.tsx", "diffHunk": "@@ -126,6 +126,24 @@ const styles = reactStyles({\n   },\n });\n \n+export const CalculateFooter = (props) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11700cc0303cce9e45d6bde897d23f2251fcab69"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MTcyNTY5", "url": "https://github.com/all-of-us/workbench/pull/3867#pullrequestreview-465172569", "createdAt": "2020-08-11T15:18:48Z", "commit": {"oid": "11700cc0303cce9e45d6bde897d23f2251fcab69"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNToxODo0OVrOG-842w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNToxODo0OVrOG-842w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY2MjQ5MQ==", "bodyText": "I think we can simplify the conditions here, something like:\n{!showModifiersSlide\n  ? criteria && <React.Fragment>\n      // selection list template\n    </React.Fragment>\n    <FlexRowWrap>\n      // save & back buttons\n    </FlexRowWrap>\n  : <ModifierPage />\n}", "url": "https://github.com/all-of-us/workbench/pull/3867#discussion_r468662491", "createdAt": "2020-08-11T15:18:49Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/selection-list/selection-list.component.tsx", "diffHunk": "@@ -335,22 +356,42 @@ export const SelectionList = withCurrentCohortCriteria()(class extends React.Com\n     </React.Fragment> ;\n   }\n \n+  applyModifier(modifiers) {\n+    if (modifiers) {\n+      const modifierButtonText = '(' + modifiers.length + ')  MODIFIERS APPLIED';\n+      this.setState({showModifiersSlide: false, modifierButtonText: modifierButtonText});\n+    } else {\n+      this.setState({showModifiersSlide: false, modifierButtonText: 'APPLY MODIFIERS'});\n+    }\n+\n+  }\n+\n   render() {\n     const {back, criteria} = this.props;\n+    const {modifierButtonText, showModifiersSlide} = this.state;\n     return <div>\n-      <div style={{paddingTop: '0.5rem'}}>\n-        {criteria && <div style={styles.selectionContainer}>\n+        {!showModifiersSlide && criteria &&  <React.Fragment>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11700cc0303cce9e45d6bde897d23f2251fcab69"}, "originalPosition": 94}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "073b265ebbef5922c4c3ff19915c725038232cef", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/073b265ebbef5922c4c3ff19915c725038232cef", "committedDate": "2020-08-12T13:26:50Z", "message": "PR Comments: Button layout and highlight"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MTg5ODk1", "url": "https://github.com/all-of-us/workbench/pull/3867#pullrequestreview-466189895", "createdAt": "2020-08-12T18:58:30Z", "commit": {"oid": "073b265ebbef5922c4c3ff19915c725038232cef"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bbe447ba1b2e347f880e9d8e2a189bd4f4fe130", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/1bbe447ba1b2e347f880e9d8e2a189bd4f4fe130", "committedDate": "2020-08-13T02:39:05Z", "message": "Will s Awesome suggestion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NDE2NDc2", "url": "https://github.com/all-of-us/workbench/pull/3867#pullrequestreview-466416476", "createdAt": "2020-08-13T03:15:28Z", "commit": {"oid": "1bbe447ba1b2e347f880e9d8e2a189bd4f4fe130"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4552, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}