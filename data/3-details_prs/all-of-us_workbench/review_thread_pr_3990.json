{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg0NjI1ODk3", "number": 3990, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo0MDo0N1rOEjLBuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo0OToxMlrOEjLR5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzE2MjgxOnYy", "diffSide": "RIGHT", "path": "e2e/app/page/cohort-search-page.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo0MDo0N1rOHRYSlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNTozOTo1NFrOHRbKJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4NTgxNA==", "bodyText": "nit: remove await", "url": "https://github.com/all-of-us/workbench/pull/3990#discussion_r487985814", "createdAt": "2020-09-14T14:40:47Z", "author": {"login": "aweng98"}, "path": "e2e/app/page/cohort-search-page.ts", "diffHunk": "@@ -124,22 +120,32 @@ export default class CohortCriteriaModal extends Modal {\n    * Click FINISH button.\n    */\n   async clickFinishButton(): Promise<void> {\n-    return this.clickButton(LinkText.Finish, {waitForClose: true});\n+    return Button.findByName(this.page, {normalizeSpace: LinkText.FinishAndReview}).then(button => button.click());\n+  }\n+\n+  async viewAndSaveCriteria(): Promise<void> {\n+    const finishAndReviewButton = await Button.findByName(this.page, {name: LinkText.FinishAndReview});\n+    await finishAndReviewButton.waitUntilEnabled();\n+    await finishAndReviewButton.click();\n+\n+    // Click Save Criteria button in sidebar\n+    const helpSidebar = await new HelpSidebar(this.page);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd193d9068ba5a924b667668c7ddb70c197f94ce"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMjgwNw==", "bodyText": "Done.", "url": "https://github.com/all-of-us/workbench/pull/3990#discussion_r488032807", "createdAt": "2020-09-14T15:39:54Z", "author": {"login": "dolbeew"}, "path": "e2e/app/page/cohort-search-page.ts", "diffHunk": "@@ -124,22 +120,32 @@ export default class CohortCriteriaModal extends Modal {\n    * Click FINISH button.\n    */\n   async clickFinishButton(): Promise<void> {\n-    return this.clickButton(LinkText.Finish, {waitForClose: true});\n+    return Button.findByName(this.page, {normalizeSpace: LinkText.FinishAndReview}).then(button => button.click());\n+  }\n+\n+  async viewAndSaveCriteria(): Promise<void> {\n+    const finishAndReviewButton = await Button.findByName(this.page, {name: LinkText.FinishAndReview});\n+    await finishAndReviewButton.waitUntilEnabled();\n+    await finishAndReviewButton.click();\n+\n+    // Click Save Criteria button in sidebar\n+    const helpSidebar = await new HelpSidebar(this.page);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4NTgxNA=="}, "originalCommit": {"oid": "bd193d9068ba5a924b667668c7ddb70c197f94ce"}, "originalPosition": 110}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzE4NjcwOnYy", "diffSide": "RIGHT", "path": "e2e/app/page/cohort-search-page.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo0NTozMVrOHRYgyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNTozOToxNlrOHRbIXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4OTQ0OQ==", "bodyText": "nit: remove await in class constructor call.", "url": "https://github.com/all-of-us/workbench/pull/3990#discussion_r487989449", "createdAt": "2020-09-14T14:45:31Z", "author": {"login": "aweng98"}, "path": "e2e/app/page/cohort-search-page.ts", "diffHunk": "@@ -94,28 +108,10 @@ export default class CohortCriteriaModal extends Modal {\n     const link = await this.waitForPhysicalMeasurementCriteriaLink(criteriaName);\n     await link.click();\n \n-    const selectMenu = await SelectMenu.findByName(this.page, {ancestorLevel: 2}, this);\n-    await selectMenu.clickMenuItem(filterSign);\n-\n-    const numberField = await this.page.waitForXPath(`${this.xpath}//input[@type=\"number\"]`, {visible: true});\n-    await numberField.type(String(filterValue));\n-\n-    await this.clickButton(LinkText.Calculate);\n-    const participantResult = await this.waitForParticipantResult();\n+    const helpSidebar = await new HelpSidebar(this.page);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd193d9068ba5a924b667668c7ddb70c197f94ce"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAzMjM0OA==", "bodyText": "Done.", "url": "https://github.com/all-of-us/workbench/pull/3990#discussion_r488032348", "createdAt": "2020-09-14T15:39:16Z", "author": {"login": "dolbeew"}, "path": "e2e/app/page/cohort-search-page.ts", "diffHunk": "@@ -94,28 +108,10 @@ export default class CohortCriteriaModal extends Modal {\n     const link = await this.waitForPhysicalMeasurementCriteriaLink(criteriaName);\n     await link.click();\n \n-    const selectMenu = await SelectMenu.findByName(this.page, {ancestorLevel: 2}, this);\n-    await selectMenu.clickMenuItem(filterSign);\n-\n-    const numberField = await this.page.waitForXPath(`${this.xpath}//input[@type=\"number\"]`, {visible: true});\n-    await numberField.type(String(filterValue));\n-\n-    await this.clickButton(LinkText.Calculate);\n-    const participantResult = await this.waitForParticipantResult();\n+    const helpSidebar = await new HelpSidebar(this.page);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4OTQ0OQ=="}, "originalCommit": {"oid": "bd193d9068ba5a924b667668c7ddb70c197f94ce"}, "originalPosition": 77}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzE5ODUyOnYy", "diffSide": "RIGHT", "path": "e2e/app/component/help-sidebar.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo0ODowMVrOHRYn8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNTozMzo0OVrOHRa5GA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk5MTI4MQ==", "bodyText": "nit: remove ../.. before utils", "url": "https://github.com/all-of-us/workbench/pull/3990#discussion_r487991281", "createdAt": "2020-09-14T14:48:01Z", "author": {"login": "aweng98"}, "path": "e2e/app/component/help-sidebar.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import {ElementHandle, Page} from 'puppeteer';\n+\n+import SelectMenu from 'app/component/select-menu';\n+import Container from 'app/container';\n+import Button from 'app/element/button';\n+import {FilterSign} from 'app/page/cohort-search-page';\n+import {LinkText} from 'app/text-labels';\n+import {buildXPath} from 'app/xpath-builders';\n+import {ElementType} from 'app/xpath-options';\n+import {waitForNumericalString} from 'utils/waits-utils';\n+import {waitWhileLoading} from '../../utils/test-utils';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd193d9068ba5a924b667668c7ddb70c197f94ce"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAyODQ0MA==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3990#discussion_r488028440", "createdAt": "2020-09-14T15:33:49Z", "author": {"login": "dolbeew"}, "path": "e2e/app/component/help-sidebar.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import {ElementHandle, Page} from 'puppeteer';\n+\n+import SelectMenu from 'app/component/select-menu';\n+import Container from 'app/container';\n+import Button from 'app/element/button';\n+import {FilterSign} from 'app/page/cohort-search-page';\n+import {LinkText} from 'app/text-labels';\n+import {buildXPath} from 'app/xpath-builders';\n+import {ElementType} from 'app/xpath-options';\n+import {waitForNumericalString} from 'utils/waits-utils';\n+import {waitWhileLoading} from '../../utils/test-utils';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk5MTI4MQ=="}, "originalCommit": {"oid": "bd193d9068ba5a924b667668c7ddb70c197f94ce"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1MzIwNDIzOnYy", "diffSide": "RIGHT", "path": "e2e/app/component/help-sidebar.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNDo0OToxMlrOHRYrfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQxNTozNToxMVrOHRa9EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk5MjE4OA==", "bodyText": "old comment. no more modal window, right?", "url": "https://github.com/all-of-us/workbench/pull/3990#discussion_r487992188", "createdAt": "2020-09-14T14:49:12Z", "author": {"login": "aweng98"}, "path": "e2e/app/component/help-sidebar.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import {ElementHandle, Page} from 'puppeteer';\n+\n+import SelectMenu from 'app/component/select-menu';\n+import Container from 'app/container';\n+import Button from 'app/element/button';\n+import {FilterSign} from 'app/page/cohort-search-page';\n+import {LinkText} from 'app/text-labels';\n+import {buildXPath} from 'app/xpath-builders';\n+import {ElementType} from 'app/xpath-options';\n+import {waitForNumericalString} from 'utils/waits-utils';\n+import {waitWhileLoading} from '../../utils/test-utils';\n+\n+const defaultXpath = '//*[@id=\"help-sidebar\"]';\n+enum SectionSelectors {\n+  AttributesForm = '//*[@id=\"attributes-form\"]',\n+  ModifiersForm = '//*[@id=\"modifiers-form\"]',\n+  SelectionList = '//*[@id=\"selection-list\"]',\n+}\n+\n+export default class HelpSidebar extends Container {\n+\n+  constructor(page: Page, xpath: string = defaultXpath) {\n+    super(page, xpath);\n+  }\n+\n+  async getPhysicalMeasurementParticipantResult(filterSign: FilterSign, filterValue: number): Promise<string> {\n+    await this.waitUntilSectionVisible(SectionSelectors.AttributesForm);\n+\n+    const selectMenu = await SelectMenu.findByName(this.page, {ancestorLevel: 2}, this);\n+    await selectMenu.clickMenuItem(filterSign);\n+\n+    const numberField = await this.page.waitForXPath(`${this.xpath}//input[@type=\"number\"]`, {visible: true});\n+    await numberField.type(String(filterValue));\n+\n+    await this.clickSidebarButton(LinkText.Calculate);\n+    const participantResult = await this.waitForParticipantResult();\n+\n+    // Find criteria in Selected Criteria Content Box.\n+    const removeSelectedCriteriaIconSelector = buildXPath({type: ElementType.Icon, iconShape: 'times-circle'}, this);\n+    // Before add criteria, first check for nothing in Selected Criteria Content Box.\n+    await this.page.waitForXPath(removeSelectedCriteriaIconSelector,{hidden: true});\n+\n+    await this.clickSidebarButton(LinkText.AddThis);\n+    // After add criteria, should flip to selection list section\n+    await this.waitUntilSectionVisible(SectionSelectors.SelectionList);\n+    // Look for X (remove) icon for indication that add succeeded.\n+    await this.page.waitForXPath(removeSelectedCriteriaIconSelector,{visible: true});\n+\n+    // dialog close after click FINISH button.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bd193d9068ba5a924b667668c7ddb70c197f94ce"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAyOTQ1Ng==", "bodyText": "Nice catch. Fixed.", "url": "https://github.com/all-of-us/workbench/pull/3990#discussion_r488029456", "createdAt": "2020-09-14T15:35:11Z", "author": {"login": "dolbeew"}, "path": "e2e/app/component/help-sidebar.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import {ElementHandle, Page} from 'puppeteer';\n+\n+import SelectMenu from 'app/component/select-menu';\n+import Container from 'app/container';\n+import Button from 'app/element/button';\n+import {FilterSign} from 'app/page/cohort-search-page';\n+import {LinkText} from 'app/text-labels';\n+import {buildXPath} from 'app/xpath-builders';\n+import {ElementType} from 'app/xpath-options';\n+import {waitForNumericalString} from 'utils/waits-utils';\n+import {waitWhileLoading} from '../../utils/test-utils';\n+\n+const defaultXpath = '//*[@id=\"help-sidebar\"]';\n+enum SectionSelectors {\n+  AttributesForm = '//*[@id=\"attributes-form\"]',\n+  ModifiersForm = '//*[@id=\"modifiers-form\"]',\n+  SelectionList = '//*[@id=\"selection-list\"]',\n+}\n+\n+export default class HelpSidebar extends Container {\n+\n+  constructor(page: Page, xpath: string = defaultXpath) {\n+    super(page, xpath);\n+  }\n+\n+  async getPhysicalMeasurementParticipantResult(filterSign: FilterSign, filterValue: number): Promise<string> {\n+    await this.waitUntilSectionVisible(SectionSelectors.AttributesForm);\n+\n+    const selectMenu = await SelectMenu.findByName(this.page, {ancestorLevel: 2}, this);\n+    await selectMenu.clickMenuItem(filterSign);\n+\n+    const numberField = await this.page.waitForXPath(`${this.xpath}//input[@type=\"number\"]`, {visible: true});\n+    await numberField.type(String(filterValue));\n+\n+    await this.clickSidebarButton(LinkText.Calculate);\n+    const participantResult = await this.waitForParticipantResult();\n+\n+    // Find criteria in Selected Criteria Content Box.\n+    const removeSelectedCriteriaIconSelector = buildXPath({type: ElementType.Icon, iconShape: 'times-circle'}, this);\n+    // Before add criteria, first check for nothing in Selected Criteria Content Box.\n+    await this.page.waitForXPath(removeSelectedCriteriaIconSelector,{hidden: true});\n+\n+    await this.clickSidebarButton(LinkText.AddThis);\n+    // After add criteria, should flip to selection list section\n+    await this.waitUntilSectionVisible(SectionSelectors.SelectionList);\n+    // Look for X (remove) icon for indication that add succeeded.\n+    await this.page.waitForXPath(removeSelectedCriteriaIconSelector,{visible: true});\n+\n+    // dialog close after click FINISH button.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk5MjE4OA=="}, "originalCommit": {"oid": "bd193d9068ba5a924b667668c7ddb70c197f94ce"}, "originalPosition": 49}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4055, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}