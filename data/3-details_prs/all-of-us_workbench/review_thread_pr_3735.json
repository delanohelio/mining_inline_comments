{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyNzQ2MzU3", "number": 3735, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNToxMToxOVrOEKjT3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo1MDoxMFrOEK9coQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5NDk5NzQxOnYy", "diffSide": "RIGHT", "path": "ui/src/app/app-routing.module.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNToxMToxOVrOGrqJLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNToxMToxOVrOGrqJLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQzMjQzMA==", "bodyText": "things will be collapsible, dangit", "url": "https://github.com/all-of-us/workbench/pull/3735#discussion_r448432430", "createdAt": "2020-07-01T15:11:19Z", "author": {"login": "als364"}, "path": "ui/src/app/app-routing.module.ts", "diffHunk": "@@ -55,19 +52,8 @@ const routes: Routes = [\n     path: 'login',\n     component: SignInComponent,\n     data: {title: 'Sign In'}\n-  }, {\n-    path: 'session-expired',\n-    component: SessionExpiredComponent,\n-    data: {title: 'You have been signed out'}\n-  }, {\n-    path: 'sign-in-again',\n-    component: SignInAgainComponent,\n-    data: {title: 'You have been signed out'}\n-  }, {\n-    path: 'user-disabled',\n-    component: UserDisabledComponent,\n-    data: {title: 'Disabled'}\n-  }, {\n+  },\n+  {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4cf62c38b9fa09adc64bcd8f336725f3f457d98e"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5NTAwMjIzOnYy", "diffSide": "RIGHT", "path": "ui/src/app/app-routing.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNToxMjozM1rOGrqMag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNToxMjozM1rOGrqMag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQzMzI1OA==", "bodyText": "This was originally consumed in the Angular wrappers for SignInAgain and SessionExpired. Pushing it down here so that 1) it's in one place instead of several and 2) so that I don't have to figure out how to deprecate it before we get rid of the Angular router.", "url": "https://github.com/all-of-us/workbench/pull/3735#discussion_r448433258", "createdAt": "2020-07-01T15:12:33Z", "author": {"login": "als364"}, "path": "ui/src/app/app-routing.tsx", "diffHunk": "@@ -1,20 +1,32 @@\n import {Component as AComponent} from '@angular/core';\n import {AppRoute, AppRouter} from 'app/components/app-router';\n+import {CookiePolicy} from 'app/pages/cookie-policy';\n+import {SessionExpired} from 'app/pages/session-expired';\n+import {SignInAgain} from 'app/pages/sign-in-again';\n+import {UserDisabled} from 'app/pages/user-disabled';\n+import {SignInService} from 'app/services/sign-in.service';\n import { ReactWrapperBase } from 'app/utils';\n import * as React from 'react';\n-import {CookiePolicyComponent} from './pages/cookie-policy';\n \n-export const AppRoutingComponent: React.FunctionComponent = () => {\n+export const AppRoutingComponent: React.FunctionComponent<{signIn: Function}> = ({signIn}) => {\n   return <AppRouter>\n-    <AppRoute path='/cookie-policy' component={CookiePolicyComponent}/>\n+    <AppRoute path='/cookie-policy' component={CookiePolicy}/>\n+    <AppRoute path='/session-expired' data={{signIn: signIn}} component={SessionExpired}/>\n+    <AppRoute path='/sign-in-again' data={{signIn: signIn}} component={SignInAgain}/>\n+    <AppRoute path='/user-disabled' component={UserDisabled}/>\n   </AppRouter>;\n };\n \n @AComponent({\n   template: '<div #root></div>'\n })\n export class AppRouting extends ReactWrapperBase {\n-  constructor() {\n-    super(AppRoutingComponent, []);\n+  constructor(private signInService: SignInService) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4cf62c38b9fa09adc64bcd8f336725f3f457d98e"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5NTAzNzM3OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/user-disabled.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNToyMToyMFrOGrqi4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQxNToyMToyMFrOGrqi4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQzOTAxMA==", "bodyText": "the basic idea is that we could do like a thin wrapper around React.Component kind of like:\nexport class ComponentWithPageTitle extends React.Component<{pageTitle, ...props}> {\n    constructor(pageTitle, ...props) {\n        super(props);\n        document.title = buildPageTitleForEnvironment(pageTitle);\n    }\n}\n\nexport class UserDisabled extends ComponentWithPageTitle<{pageTitle}> {\n    constructor(pageTitle) {\n        super(pageTitle);\n    }\n\n    render() {\n        [...]\n    }\n}", "url": "https://github.com/all-of-us/workbench/pull/3735#discussion_r448439010", "createdAt": "2020-07-01T15:21:20Z", "author": {"login": "als364"}, "path": "ui/src/app/pages/user-disabled.tsx", "diffHunk": "@@ -1,31 +1,27 @@\n-import {Component} from '@angular/core';\n import * as React from 'react';\n \n import {StyledAnchorTag} from 'app/components/buttons';\n import {BoldHeader} from 'app/components/headers';\n import {PublicLayout} from 'app/components/public-layout';\n import colors from 'app/styles/colors';\n-import {\n-  ReactWrapperBase\n-} from 'app/utils';\n+import {buildPageTitleForEnvironment} from 'app/utils/title';\n \n const supportUrl = 'support@researchallofus.org';\n \n-export const UserDisabled: React.FunctionComponent<{}> = () => {\n-  return <PublicLayout>\n-    <BoldHeader>Your account has been disabled</BoldHeader>\n-    <section style={{color: colors.primary, fontSize: '18px', marginTop: '.5rem'}}>\n-      Contact <StyledAnchorTag href={'mailto:' + supportUrl}>{supportUrl}</StyledAnchorTag> for\n-      more information.\n-    </section>\n-  </PublicLayout>;\n-};\n+export class UserDisabled extends React.Component {\n+  // TODO: esteemed reviewer, please yell at me if I don't write a paper about a global wrapper that", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4cf62c38b9fa09adc64bcd8f336725f3f457d98e"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5NTk3ODQwOnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/cookie-policy.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQyMDowNzo1OFrOGrzv7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMVQyMDowNzo1OFrOGrzv7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODU4OTgwNg==", "bodyText": "Please take a look at this document about how I could do this better (but not in this PR)", "url": "https://github.com/all-of-us/workbench/pull/3735#discussion_r448589806", "createdAt": "2020-07-01T20:07:58Z", "author": {"login": "als364"}, "path": "ui/src/app/pages/cookie-policy.tsx", "diffHunk": "@@ -46,7 +47,11 @@ const COOKIE_DELETION_LINK = 'https://www.aboutcookies.org/how-to-delete-cookies\n const GOOGLE_PRIVACY_LINK = 'https://policies.google.com/privacy';\n const ZENDESK_PRIVACY_LINK = 'https://www.zendesk.com/company/customers-partners/privacy-policy/';\n \n-export class CookiePolicyComponent extends React.Component<{}, {}> {\n+export class CookiePolicy extends React.Component<{}, {}> {\n+  componentDidMount() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4cf62c38b9fa09adc64bcd8f336725f3f457d98e"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTIyNTM4OnYy", "diffSide": "RIGHT", "path": "ui/src/app/utils/title.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo0MjozNFrOGsTA8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo0MjozNFrOGsTA8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTEwMjA2Ng==", "bodyText": "nit: avoid concatenating with interpolation:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                title = `[${environment.displayTag}] ` + title;\n          \n          \n            \n                title = `[${environment.displayTag}] title` ;", "url": "https://github.com/all-of-us/workbench/pull/3735#discussion_r449102066", "createdAt": "2020-07-02T15:42:34Z", "author": {"login": "petesantos"}, "path": "ui/src/app/utils/title.ts", "diffHunk": "@@ -0,0 +1,14 @@\n+import {environment} from 'environments/environment';\n+\n+import {BASE_TITLE} from 'app/utils/strings';\n+\n+export function buildPageTitleForEnvironment(pageTitle?: string) {\n+  let title = BASE_TITLE;\n+  if (environment.shouldShowDisplayTag) {\n+    title = `[${environment.displayTag}] ` + title;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e00648ffc31cc091fc6a075548c4b0f13a3c5038"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTIzNzMxOnYy", "diffSide": "RIGHT", "path": "ui/src/app/utils/title.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo0NDoyMFrOGsTJNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo0NDoyMFrOGsTJNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTEwNDE4Mw==", "bodyText": "same nit as above", "url": "https://github.com/all-of-us/workbench/pull/3735#discussion_r449104183", "createdAt": "2020-07-02T15:44:20Z", "author": {"login": "petesantos"}, "path": "ui/src/app/utils/title.ts", "diffHunk": "@@ -0,0 +1,14 @@\n+import {environment} from 'environments/environment';\n+\n+import {BASE_TITLE} from 'app/utils/strings';\n+\n+export function buildPageTitleForEnvironment(pageTitle?: string) {\n+  let title = BASE_TITLE;\n+  if (environment.shouldShowDisplayTag) {\n+    title = `[${environment.displayTag}] ` + title;\n+    if (pageTitle) {\n+      title = `${pageTitle} | ` + title;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e00648ffc31cc091fc6a075548c4b0f13a3c5038"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc5OTI3OTY5OnYy", "diffSide": "RIGHT", "path": "ui/src/app/utils/title.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo1MDoxMFrOGsTlqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNjo1MDowNlrOGsVx4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTExMTQ2NA==", "bodyText": "One possiblity to avoid the let:\n    const title = environment.shouldShowDisplayTag && pageTitle ? `${pageTitle} | ` : ''\n    return environment.shouldShowDisplayTag ? `${title}[${environment.displayTag}] ${BASE_TITLE}` : BASE_TITLE\n\nBut I don't know if that is cleaner to read", "url": "https://github.com/all-of-us/workbench/pull/3735#discussion_r449111464", "createdAt": "2020-07-02T15:50:10Z", "author": {"login": "petesantos"}, "path": "ui/src/app/utils/title.ts", "diffHunk": "@@ -0,0 +1,14 @@\n+import {environment} from 'environments/environment';\n+\n+import {BASE_TITLE} from 'app/utils/strings';\n+\n+export function buildPageTitleForEnvironment(pageTitle?: string) {\n+  let title = BASE_TITLE;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e00648ffc31cc091fc6a075548c4b0f13a3c5038"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTE0NzM2Mg==", "bodyText": "That's exactly why I did it as a let. I don't think mutables are so evil as to make it better to do something this much harder to parse", "url": "https://github.com/all-of-us/workbench/pull/3735#discussion_r449147362", "createdAt": "2020-07-02T16:50:06Z", "author": {"login": "als364"}, "path": "ui/src/app/utils/title.ts", "diffHunk": "@@ -0,0 +1,14 @@\n+import {environment} from 'environments/environment';\n+\n+import {BASE_TITLE} from 'app/utils/strings';\n+\n+export function buildPageTitleForEnvironment(pageTitle?: string) {\n+  let title = BASE_TITLE;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTExMTQ2NA=="}, "originalCommit": {"oid": "e00648ffc31cc091fc6a075548c4b0f13a3c5038"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2608, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}