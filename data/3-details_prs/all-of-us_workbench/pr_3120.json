{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0NDg1NTg1", "number": 3120, "title": "[RW-4437][risk=no] Track sidebar state in local storage", "bodyText": "Creates a local storage item to indicate whether the sidebar is open or closed. This way, the sidebar is open automatically only the first time a user logs in and enters a workspace. If the user re-enters a workspace or refreshes the page, it will get the sidebar state from local storage.\nAlso added a box-shadow in the sidebar so it's clearer that there is content being covered up.\n\nPR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n I have run and tested this change locally", "createdAt": "2020-02-12T19:24:38Z", "url": "https://github.com/all-of-us/workbench/pull/3120", "merged": true, "mergeCommit": {"oid": "a28db9064c4fd1df984906f9095393225a9e3313"}, "closed": true, "closedAt": "2020-02-13T15:29:20Z", "author": {"login": "dolbeew"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDp7yaAH2gAyMzc0NDg1NTg1OjVjM2ZkMmRlZjZkZGZjMmI1YWM2Mzg2YzBmM2VlNTZmZmU4NDZjZTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcD8aFZgFqTM1ODI5MjQzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5c3fd2def6ddfc2b5ac6386c0f3ee56ffe846ce2", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/5c3fd2def6ddfc2b5ac6386c0f3ee56ffe846ce2", "committedDate": "2020-02-12T17:39:16Z", "message": "RW-4437 track sidebar state in local storage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d6accce76ba2fa870d7e2fef12d8de32afe4957", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/2d6accce76ba2fa870d7e2fef12d8de32afe4957", "committedDate": "2020-02-12T18:39:34Z", "message": "RW-4437 add box shadow on left of sidebar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39b20b24a9633926269026b45b074690c1be7858", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/39b20b24a9633926269026b45b074690c1be7858", "committedDate": "2020-02-12T19:12:03Z", "message": "RW-4437 move click event from icon to parent element"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3OTcxMjc4", "url": "https://github.com/all-of-us/workbench/pull/3120#pullrequestreview-357971278", "createdAt": "2020-02-13T06:01:07Z", "commit": {"oid": "39b20b24a9633926269026b45b074690c1be7858"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwNjowMTowOFrOFpH5VA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QwNjowOToyN1rOFpIBEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY2NTMwMA==", "bodyText": "nit: pull out the sidebarState value into a constant. I think we're (loosely) following the convention of using capital letters for local storage keys.\nAlso, prefixing the key value with WORKSPACE may be helpful as we're planning to add the side bar component to the notebooks page.", "url": "https://github.com/all-of-us/workbench/pull/3120#discussion_r378665300", "createdAt": "2020-02-13T06:01:08Z", "author": {"login": "ericsong"}, "path": "ui/src/app/pages/workspace/workspace-wrapper/component.ts", "diffHunk": "@@ -58,6 +58,12 @@ export class WorkspaceWrapperComponent implements OnInit, OnDestroy {\n   }\n \n   ngOnInit(): void {\n+    if (!!localStorage.getItem('sidebarState')) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39b20b24a9633926269026b45b074690c1be7858"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY2NjUyMg==", "bodyText": "can we use setSidebarState here?", "url": "https://github.com/all-of-us/workbench/pull/3120#discussion_r378666522", "createdAt": "2020-02-13T06:06:14Z", "author": {"login": "ericsong"}, "path": "ui/src/app/pages/workspace/workspace-wrapper/component.ts", "diffHunk": "@@ -58,6 +58,12 @@ export class WorkspaceWrapperComponent implements OnInit, OnDestroy {\n   }\n \n   ngOnInit(): void {\n+    if (!!localStorage.getItem('sidebarState')) {\n+      this.sidebarOpen = localStorage.getItem('sidebarState') === 'open';\n+    } else {\n+      this.sidebarOpen = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39b20b24a9633926269026b45b074690c1be7858"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY2NzI4MQ==", "bodyText": "also here.\nnit - IMO, it's easier to maintain the syncing to localStorage if its done in a one place (the setter) and the rest of the file just uses the setter and doesn't have to worry about localStorage.", "url": "https://github.com/all-of-us/workbench/pull/3120#discussion_r378667281", "createdAt": "2020-02-13T06:09:27Z", "author": {"login": "ericsong"}, "path": "ui/src/app/pages/workspace/workspace-wrapper/component.ts", "diffHunk": "@@ -67,6 +73,7 @@ export class WorkspaceWrapperComponent implements OnInit, OnDestroy {\n           this.setHelpContent();\n           if (this.helpContent !== 'reviewParticipantDetail') {\n             this.sidebarOpen = false;\n+            localStorage.setItem('sidebarState', 'closed');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39b20b24a9633926269026b45b074690c1be7858"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69f63a02965e63edf121faecc3080d911c30c68f", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/69f63a02965e63edf121faecc3080d911c30c68f", "committedDate": "2020-02-13T14:43:42Z", "message": "RW-4437 pr feedback"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4MjkyNDMx", "url": "https://github.com/all-of-us/workbench/pull/3120#pullrequestreview-358292431", "createdAt": "2020-02-13T15:08:15Z", "commit": {"oid": "39b20b24a9633926269026b45b074690c1be7858"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNTowODoxNVrOFpXZYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxNTowOTo1NFrOFpXdDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODkxOTI2Ng==", "bodyText": "Okay, now I see this convention used in the signed-in component also. Fixed.", "url": "https://github.com/all-of-us/workbench/pull/3120#discussion_r378919266", "createdAt": "2020-02-13T15:08:15Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/pages/workspace/workspace-wrapper/component.ts", "diffHunk": "@@ -58,6 +58,12 @@ export class WorkspaceWrapperComponent implements OnInit, OnDestroy {\n   }\n \n   ngOnInit(): void {\n+    if (!!localStorage.getItem('sidebarState')) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY2NTMwMA=="}, "originalCommit": {"oid": "39b20b24a9633926269026b45b074690c1be7858"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODkxOTc1MA==", "bodyText": "Done.", "url": "https://github.com/all-of-us/workbench/pull/3120#discussion_r378919750", "createdAt": "2020-02-13T15:09:02Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/pages/workspace/workspace-wrapper/component.ts", "diffHunk": "@@ -58,6 +58,12 @@ export class WorkspaceWrapperComponent implements OnInit, OnDestroy {\n   }\n \n   ngOnInit(): void {\n+    if (!!localStorage.getItem('sidebarState')) {\n+      this.sidebarOpen = localStorage.getItem('sidebarState') === 'open';\n+    } else {\n+      this.sidebarOpen = true;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY2NjUyMg=="}, "originalCommit": {"oid": "39b20b24a9633926269026b45b074690c1be7858"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODkyMDIwNQ==", "bodyText": "Agreed, much cleaner this way.", "url": "https://github.com/all-of-us/workbench/pull/3120#discussion_r378920205", "createdAt": "2020-02-13T15:09:54Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/pages/workspace/workspace-wrapper/component.ts", "diffHunk": "@@ -67,6 +73,7 @@ export class WorkspaceWrapperComponent implements OnInit, OnDestroy {\n           this.setHelpContent();\n           if (this.helpContent !== 'reviewParticipantDetail') {\n             this.sidebarOpen = false;\n+            localStorage.setItem('sidebarState', 'closed');", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODY2NzI4MQ=="}, "originalCommit": {"oid": "39b20b24a9633926269026b45b074690c1be7858"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3564, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}