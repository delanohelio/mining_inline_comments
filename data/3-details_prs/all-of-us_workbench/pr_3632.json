{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2MTc0NzI1", "number": 3632, "title": "[risk=no][RW=5014]Initial react router implementation", "bodyText": "Description:\nCreate initial implementation of routing component and convert one route (cookie-policy) to use the new router\nChange can be tested here:\nhttps://psantos-dot-all-of-us-workbench-test.appspot.com/cookie-policy\n\nPR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n I have run the E2E tests on ths change against my local UI + API server with yarn test-local\n If this includes a UI change, I have taken screen recordings or screenshots of the new behavior and notified the PO and UX designer\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-06-01T19:37:43Z", "url": "https://github.com/all-of-us/workbench/pull/3632", "merged": true, "mergeCommit": {"oid": "b49b6b64d8e5ff0edcd328f1244d72c18b7c9156"}, "closed": true, "closedAt": "2020-06-02T16:52:10Z", "author": {"login": "petesantos"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccJ4pjgH2gAyNDI2MTc0NzI1OjU2ZDRlNGYwMzQ1NTg3MjQxMDJhNzIzZjYyNjg3NmJhYTgzODAxN2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnXwCggFqTQyMjg3MDcxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "56d4e4f034558724102a723f626876baa838017e", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/56d4e4f034558724102a723f626876baa838017e", "committedDate": "2020-04-28T20:26:59Z", "message": "working example"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b028bb02df1dce7ff0f43c3f752d396c2321d698", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/b028bb02df1dce7ff0f43c3f752d396c2321d698", "committedDate": "2020-04-29T17:29:23Z", "message": "Clean up router abstraction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd512a54d40fb7654f8797c9a0effe669abceecb", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/cd512a54d40fb7654f8797c9a0effe669abceecb", "committedDate": "2020-05-06T16:06:54Z", "message": "Update example and router"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d43ff437167069767d72cf32bb2780edd308277e", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/d43ff437167069767d72cf32bb2780edd308277e", "committedDate": "2020-05-07T17:17:09Z", "message": "Merge branch 'master' into psantos/router-initial-implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "040c06992f8d806357666ed3064cfab331cf3204", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/040c06992f8d806357666ed3064cfab331cf3204", "committedDate": "2020-05-28T16:59:46Z", "message": "Router conceptual impl"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25275ad5a6b54aa7fd14440fe960359ef8cef545", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/25275ad5a6b54aa7fd14440fe960359ef8cef545", "committedDate": "2020-06-01T15:09:46Z", "message": "Add types to router"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01e73da53cb9dcf999df88eb9205b136c02c6cf9", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/01e73da53cb9dcf999df88eb9205b136c02c6cf9", "committedDate": "2020-06-01T17:08:29Z", "message": "Move cookie router to react-router"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e6fd64007442113b59df962c56f812f9ee57abf", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/0e6fd64007442113b59df962c56f812f9ee57abf", "committedDate": "2020-06-01T17:16:43Z", "message": "Merge remote-tracking branch 'origin/master' into psantos/router-initial-implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6c6b77857cd5448de53c3e857266c2e1cb32016", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/b6c6b77857cd5448de53c3e857266c2e1cb32016", "committedDate": "2020-06-01T17:27:48Z", "message": "Correct merge issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c79e41cfd0fbc1b0f5efbccdd2695e1f95fdf53", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/8c79e41cfd0fbc1b0f5efbccdd2695e1f95fdf53", "committedDate": "2020-06-01T17:34:28Z", "message": "merge..."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4f910aaa44f4ce78f883753fe28b4ef5e8b4dcf", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/a4f910aaa44f4ce78f883753fe28b4ef5e8b4dcf", "committedDate": "2020-06-01T17:36:12Z", "message": "more merge..."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7dd4ff98b046879a9d0f47a776d0980b7798292d", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/7dd4ff98b046879a9d0f47a776d0980b7798292d", "committedDate": "2020-06-01T19:34:00Z", "message": "Add type to guards"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNzQ3OTc4", "url": "https://github.com/all-of-us/workbench/pull/3632#pullrequestreview-422747978", "createdAt": "2020-06-02T14:40:22Z", "commit": {"oid": "7dd4ff98b046879a9d0f47a776d0980b7798292d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDo0MDoyM1rOGd08MA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxNDo0OToyNlrOGd1WWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzkyOTI2NA==", "bodyText": "why \"Sign In\" ?", "url": "https://github.com/all-of-us/workbench/pull/3632#discussion_r433929264", "createdAt": "2020-06-02T14:40:23Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/app-routing.module.ts", "diffHunk": "@@ -346,6 +341,10 @@ const routes: Routes = [\n         data: {title: 'Create Workspace', mode: WorkspaceEditMode.Create}\n       }\n     ]\n+  }, {\n+    path: '**',\n+    component: AppRouting,\n+    data: {title: 'Sign In'}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7dd4ff98b046879a9d0f47a776d0980b7798292d"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzkzNTk2MQ==", "bodyText": "can children be more strongly typed here?  Fragment[] perhaps?", "url": "https://github.com/all-of-us/workbench/pull/3632#discussion_r433935961", "createdAt": "2020-06-02T14:49:26Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/components/app-router.tsx", "diffHunk": "@@ -0,0 +1,46 @@\n+import * as fp from 'lodash/fp';\n+import * as React from 'react';\n+import { BrowserRouter, Link, Redirect, Route, Switch, useHistory, useLocation, useParams, useRouteMatch} from 'react-router-dom';\n+\n+const {Fragment} = React;\n+\n+interface Guards {\n+  [index: number]: {\n+    checkGuard: () => boolean;\n+    redirectPath: string;\n+  };\n+}\n+\n+export const usePath = () => {\n+  const {path} = useRouteMatch();\n+  return path;\n+};\n+\n+export const SubRoute = ({children}): React.ReactElement => <Switch>{children}</Switch>;\n+export const AppRouter = ({children}): React.ReactElement => <BrowserRouter><SubRoute>{children}</SubRoute></BrowserRouter>;\n+\n+export const RouteLink = ({path, style = {}, children}): React.ReactElement => <Link style={{...style}} to={path}>{children}</Link>;\n+\n+export const AppRoute = ({path, data = {}, component: Component}): React.ReactElement => {\n+  const routeParams = useParams();\n+  const routeHistory = useHistory();\n+\n+  return <Route path={path} >\n+    <Component urlParams={routeParams} routeHistory={routeHistory} routeConfig={data}/>\n+  </Route>;\n+};\n+\n+export const ProtectedRoutes = (\n+  {path, guards, children}: {path: string, guards: Guards, children: any[] }): React.ReactElement => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7dd4ff98b046879a9d0f47a776d0980b7798292d"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e7fa2c995677f2371dbcb5a8ce67206606f0a3a", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/6e7fa2c995677f2371dbcb5a8ce67206606f0a3a", "committedDate": "2020-06-02T14:56:33Z", "message": "Correct minor issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be0cd42a5a191baa64d5f9f23d427b2454b88609", "author": {"user": {"login": "petesantos", "name": "Pete Santos"}}, "url": "https://github.com/all-of-us/workbench/commit/be0cd42a5a191baa64d5f9f23d427b2454b88609", "committedDate": "2020-06-02T14:59:35Z", "message": "Correct type for react children"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyODcwNzE0", "url": "https://github.com/all-of-us/workbench/pull/3632#pullrequestreview-422870714", "createdAt": "2020-06-02T16:49:25Z", "commit": {"oid": "be0cd42a5a191baa64d5f9f23d427b2454b88609"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4819, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}