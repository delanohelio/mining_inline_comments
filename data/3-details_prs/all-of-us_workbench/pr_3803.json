{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxNDc0NDQ1", "number": 3803, "title": "[RW-5089][risk=no] Centralize Zendesk urlset and correct sandbox URLs", "bodyText": "ZD sandbox (used in lower environments), has different article IDs than in prod\nI decided to build the URLs statically to allow for static references in code\n\nNotes about Zendesk URLs\n\nthe locale infix \"/en-us/\" is not necessary (except for the community forum URL). Better to leave this unset.\nthe article ID is the only necessary part of the URL suffix, though when you click the URL via Zendesk it will include a sluggified title. My preference is to omit this, as those titles may change over time\n\nAlternative considered\nJust linking the URLs directly into the environment.ts, but this felt like it might be overly complicated, for example:\ncat environment.prod.ts\n{\n  ...,\n  zendeskUrls: zendesk.prodUrls,\n  ...\n\ncat environment.stable.ts\n{\n  ...,\n  zendeskUrls: zendesk.sandboxUrls,\n  ...\n\nwhere zendesk would need to be a hermetic package which environment.ts depends on. Could be convinced to explore this more.", "createdAt": "2020-07-17T21:30:34Z", "url": "https://github.com/all-of-us/workbench/pull/3803", "merged": true, "mergeCommit": {"oid": "cc87b6770eb90fe4157ef5c20c5eaeef026b2d77"}, "closed": true, "closedAt": "2020-07-21T23:45:00Z", "author": {"login": "calbach"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc16deAgH2gAyNDUxNDc0NDQ1OjkxNmQ1NGQzOTdiOGQ0N2M1ZjQ2NDk0NDExM2MyMWJhNDFmNDk1MWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3K54DgFqTQ1Mjc0MTA4OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "916d54d397b8d47c5f464944113c21ba41f4951d", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/916d54d397b8d47c5f464944113c21ba41f4951d", "committedDate": "2020-07-17T21:10:45Z", "message": "Switch to Zendesk urlset"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxNjE0OTMx", "url": "https://github.com/all-of-us/workbench/pull/3803#pullrequestreview-451614931", "createdAt": "2020-07-20T13:40:12Z", "commit": {"oid": "916d54d397b8d47c5f464944113c21ba41f4951d"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMzo0MDoxMlrOG0NFHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxMzo0NTozM1rOG0NYCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM5MzQzOA==", "bodyText": "nit: What is the benefit of wrapping everything in an IIFE here? The only export is a ZendeskUrls object. Not actually a big difference, but it might be clearer to do:\nconst baseUrl = environment.zendeskHelpCenterUrl;\n\n... most of function body ...\n\nlet supportUrls: ZendeskUrls = urls[prodHost];\nif (urls[host]) {\n  supportUrls = urls[host];\n}\nexport supportUrls;", "url": "https://github.com/all-of-us/workbench/pull/3803#discussion_r457393438", "createdAt": "2020-07-20T13:40:12Z", "author": {"login": "gjuggler"}, "path": "ui/src/app/utils/zendesk.ts", "diffHunk": "@@ -1,4 +1,69 @@\n import {ElementRef} from '@angular/core';\n+import {environment} from 'environments/environment';\n+\n+interface ZendeskUrls {\n+  billing: string,\n+  communityForum: string,\n+  createBillingAccount: string,\n+  dataDictionary: string,\n+  faq: string,\n+  gettingStarted: string,\n+  tableOfContents: string,\n+  researchPurpose: string,\n+}\n+\n+/**\n+ * A set of support URLs for the current environment. These need to be\n+ * parameterized per environment since the Zendesk support content IDs are not\n+ * stable across the prod and sandbox Zendesk instances.\n+ */\n+export const supportUrls: ZendeskUrls = ((baseUrl) => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "916d54d397b8d47c5f464944113c21ba41f4951d"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM5NTYyNw==", "bodyText": "Rather than trying to parse this URL and implicitly identify the Zendesk environment we're binding to, it may be simpler (and more true to the intent) to have 'prod' and 'sandbox' as the allowable env variables here, and use that to key the urls map above.", "url": "https://github.com/all-of-us/workbench/pull/3803#discussion_r457395627", "createdAt": "2020-07-20T13:42:36Z", "author": {"login": "gjuggler"}, "path": "ui/src/environments/environment-type.ts", "diffHunk": "@@ -43,7 +43,6 @@ export interface Environment {\n   // The base URL for the Zendesk help center / user forum.\n   // Example value: https://aousupporthelp.zendesk.com/hc/\n   zendeskHelpCenterUrl: string;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "916d54d397b8d47c5f464944113c21ba41f4951d"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzM5ODI4MQ==", "bodyText": "This change feels in the opposite direction from changes in all the other files (where we remove an environment dependency and add a zendesk dependency). See my comment on environment.ts below... it may be cleanest to make the env variable a simple prod vs. sandbox signal, and have all access to Zendesk URLs go through the zendesk module. Which would turn this reference into:\nhref={supportUrls.helpCenterUrl}", "url": "https://github.com/all-of-us/workbench/pull/3803#discussion_r457398281", "createdAt": "2020-07-20T13:45:33Z", "author": {"login": "gjuggler"}, "path": "ui/src/app/pages/homepage/homepage.tsx", "diffHunk": "@@ -22,6 +22,7 @@ import colors, {addOpacity} from 'app/styles/colors';\n import {hasRegisteredAccessFetch, reactStyles, ReactWrapperBase, withUserProfile} from 'app/utils';\n import {AnalyticsTracker} from 'app/utils/analytics';\n import {fetchWithGlobalErrorHandler} from 'app/utils/retry';\n+import {environment} from 'environments/environment';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "916d54d397b8d47c5f464944113c21ba41f4951d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce598626c93d0d8c357c77a90de10ccb42be6dff", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/ce598626c93d0d8c357c77a90de10ccb42be6dff", "committedDate": "2020-07-20T18:21:22Z", "message": "PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1a71e68bdf619a385eb126d80e8b8a0c424fd66", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/a1a71e68bdf619a385eb126d80e8b8a0c424fd66", "committedDate": "2020-07-20T18:42:03Z", "message": "lint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNzQxMDg4", "url": "https://github.com/all-of-us/workbench/pull/3803#pullrequestreview-452741088", "createdAt": "2020-07-21T18:54:11Z", "commit": {"oid": "a1a71e68bdf619a385eb126d80e8b8a0c424fd66"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4470, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}