{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgyNTAzNTcz", "number": 3977, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNjozMDo1MFrOEhwg2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxNzowODo0MFrOEin5WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzODMzMzA3OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/pmiops/workbench/dataset/DataSetServiceImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNjozMDo1MFrOHPQCBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNDo0OTozNlrOHP32mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc1MzM1MQ==", "bodyText": "Should we put a dataSetId on the dataSetRequest? This way if the dataSetId is null we use the DataSetRequest object otherwise read the dbDataSet from the db with the dataSetId.", "url": "https://github.com/all-of-us/workbench/pull/3977#discussion_r485753351", "createdAt": "2020-09-09T16:30:50Z", "author": {"login": "freemabd"}, "path": "api/src/main/java/org/pmiops/workbench/dataset/DataSetServiceImpl.java", "diffHunk": "@@ -333,17 +334,36 @@ public QueryJobConfiguration previewBigQueryJobConfig(DataSetPreviewRequest requ\n \n   @Override\n   public Map<String, QueryJobConfiguration> domainToBigQueryConfig(DataSetRequest dataSetRequest) {\n+    DbDataset dbDataset;\n+    if (CollectionUtils.isEmpty(dataSetRequest.getDomainValuePairs())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c4e8a13c0d097ece7f1628351059236c8e45240"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwNTc4Nw==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3977#discussion_r486405787", "createdAt": "2020-09-10T14:49:36Z", "author": {"login": "NehaBroad"}, "path": "api/src/main/java/org/pmiops/workbench/dataset/DataSetServiceImpl.java", "diffHunk": "@@ -333,17 +334,36 @@ public QueryJobConfiguration previewBigQueryJobConfig(DataSetPreviewRequest requ\n \n   @Override\n   public Map<String, QueryJobConfiguration> domainToBigQueryConfig(DataSetRequest dataSetRequest) {\n+    DbDataset dbDataset;\n+    if (CollectionUtils.isEmpty(dataSetRequest.getDomainValuePairs())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc1MzM1MQ=="}, "originalCommit": {"oid": "2c4e8a13c0d097ece7f1628351059236c8e45240"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzODM0MzYzOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/pmiops/workbench/dataset/DataSetServiceImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNjozMjo0OFrOHPQIjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNDo0OTozMFrOHP32SA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc1NTAyMg==", "bodyText": "We should probably use primary key to do lookups. Ex: dataSetDao.findOne(dataSetId)", "url": "https://github.com/all-of-us/workbench/pull/3977#discussion_r485755022", "createdAt": "2020-09-09T16:32:48Z", "author": {"login": "freemabd"}, "path": "api/src/main/java/org/pmiops/workbench/dataset/DataSetServiceImpl.java", "diffHunk": "@@ -333,17 +334,36 @@ public QueryJobConfiguration previewBigQueryJobConfig(DataSetPreviewRequest requ\n \n   @Override\n   public Map<String, QueryJobConfiguration> domainToBigQueryConfig(DataSetRequest dataSetRequest) {\n+    DbDataset dbDataset;\n+    if (CollectionUtils.isEmpty(dataSetRequest.getDomainValuePairs())) {\n+      dbDataset =\n+          dataSetDao\n+              .findDbDatasetByNameAndWorkspaceId(\n+                  dataSetRequest.getName(), dataSetRequest.getWorkspaceId())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c4e8a13c0d097ece7f1628351059236c8e45240"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwNTcwNA==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3977#discussion_r486405704", "createdAt": "2020-09-10T14:49:30Z", "author": {"login": "NehaBroad"}, "path": "api/src/main/java/org/pmiops/workbench/dataset/DataSetServiceImpl.java", "diffHunk": "@@ -333,17 +334,36 @@ public QueryJobConfiguration previewBigQueryJobConfig(DataSetPreviewRequest requ\n \n   @Override\n   public Map<String, QueryJobConfiguration> domainToBigQueryConfig(DataSetRequest dataSetRequest) {\n+    DbDataset dbDataset;\n+    if (CollectionUtils.isEmpty(dataSetRequest.getDomainValuePairs())) {\n+      dbDataset =\n+          dataSetDao\n+              .findDbDatasetByNameAndWorkspaceId(\n+                  dataSetRequest.getName(), dataSetRequest.getWorkspaceId())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc1NTAyMg=="}, "originalCommit": {"oid": "2c4e8a13c0d097ece7f1628351059236c8e45240"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzODM0NzMxOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/pmiops/workbench/db/dao/DataSetDao.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNjozMzozMFrOHPQK8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNDo0OToyM1rOHP319g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc1NTYzMg==", "bodyText": "Should remove this in favor of findOne(id)", "url": "https://github.com/all-of-us/workbench/pull/3977#discussion_r485755632", "createdAt": "2020-09-09T16:33:30Z", "author": {"login": "freemabd"}, "path": "api/src/main/java/org/pmiops/workbench/db/dao/DataSetDao.java", "diffHunk": "@@ -16,6 +17,8 @@\n \n   List<DbDataset> findByWorkspaceId(long workspaceId);\n \n+  Optional<DbDataset> findDbDatasetByNameAndWorkspaceId(String name, long workspaceId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c4e8a13c0d097ece7f1628351059236c8e45240"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwNTYyMg==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3977#discussion_r486405622", "createdAt": "2020-09-10T14:49:23Z", "author": {"login": "NehaBroad"}, "path": "api/src/main/java/org/pmiops/workbench/db/dao/DataSetDao.java", "diffHunk": "@@ -16,6 +17,8 @@\n \n   List<DbDataset> findByWorkspaceId(long workspaceId);\n \n+  Optional<DbDataset> findDbDatasetByNameAndWorkspaceId(String name, long workspaceId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTc1NTYzMg=="}, "originalCommit": {"oid": "2c4e8a13c0d097ece7f1628351059236c8e45240"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NzQwNjk2OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/data/data-set/export-data-set-modal.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxNzowODo0MFrOHQm8uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxNzowODo0MFrOHQm8uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzE3NzQwMw==", "bodyText": "Why did these change to []?", "url": "https://github.com/all-of-us/workbench/pull/3977#discussion_r487177403", "createdAt": "2020-09-11T17:08:40Z", "author": {"login": "freemabd"}, "path": "ui/src/app/pages/data/data-set/export-data-set-modal.tsx", "diffHunk": "@@ -86,11 +86,12 @@ class ExportDataSetModal extends React.Component<\n   get datasetRequest() {\n     const {dataSet} = this.props;\n     return {\n+      dataSetId: dataSet.id,\n       name: dataSet.name,\n       includesAllParticipants: dataSet.includesAllParticipants,\n       description: dataSet.description,\n-      conceptSetIds: dataSet.conceptSets.map(cs => cs.id),\n-      cohortIds: dataSet.cohorts.map(c => c.id),\n+      conceptSetIds: [],", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3655f7739aefb23fc321b87d87cc01d43b87620"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4043, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}