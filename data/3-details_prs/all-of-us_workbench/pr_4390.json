{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1OTkyNjI3", "number": 4390, "title": "[no ticket][risk=no] Puppeteer Rework Button waitForEnabled function", "bodyText": "Simplifying code.", "createdAt": "2020-12-10T14:51:54Z", "url": "https://github.com/all-of-us/workbench/pull/4390", "merged": true, "mergeCommit": {"oid": "c400fc1249996bbcd62fa9f40d3f77a667bbf8af"}, "closed": true, "closedAt": "2020-12-10T17:06:12Z", "author": {"login": "aweng98"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdk0iOGgH2gAyNTM1OTkyNjI3OjVlOTU3NDA3MWQxYmUxOTAwZDMyZjAxZmFiODEyOTRkZjMwOWYyN2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdk2DljAFqTU0OTM4ODQ0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5e9574071d1be1900d32f01fab81294df309f27c", "author": {"user": {"login": "aweng98", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/5e9574071d1be1900d32f01fab81294df309f27c", "committedDate": "2020-12-10T14:50:57Z", "message": "simplify waitForEnabled function"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b2fbade9aff984d89d860eb032e9fccd2d3c5b8", "author": {"user": {"login": "aweng98", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/7b2fbade9aff984d89d860eb032e9fccd2d3c5b8", "committedDate": "2020-12-10T15:40:57Z", "message": "timed out waiting for notebook start"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MzI5NTk3", "url": "https://github.com/all-of-us/workbench/pull/4390#pullrequestreview-549329597", "createdAt": "2020-12-10T15:43:12Z", "commit": {"oid": "7b2fbade9aff984d89d860eb032e9fccd2d3c5b8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNTo0MzoxMlrOIDPsfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNTo0NToyMVrOIDPzUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI3Mzc5MA==", "bodyText": "Unrelated to PR, this is the fix to prevent tests from failing randomly again in future.\nIssue: waiting for notebook start timed out after 15 min.\nhttps://app.circleci.com/pipelines/github/all-of-us/workbench/6390/workflows/0b93062a-ac0e-4ec1-a0cc-e360d93b0fb9/jobs/113590\nhttps://app.circleci.com/pipelines/github/all-of-us/workbench/6391/workflows/b7769b54-d944-4235-a924-ad72fc6bc4e4/jobs/113615/parallel-runs/2", "url": "https://github.com/all-of-us/workbench/pull/4390#discussion_r540273790", "createdAt": "2020-12-10T15:43:12Z", "author": {"login": "aweng98"}, "path": "e2e/app/page/workspace-analysis-page.ts", "diffHunk": "@@ -70,8 +70,8 @@ export default class WorkspaceAnalysisPage extends WorkspaceBase {\n       this.page.waitForXPath(redirectingTextsXpath, {visible: true}),\n     ]);\n \n-    // Waiting up to 15 minutes\n-    await waitWhileLoading(this.page, (15 * 60 * 1000));\n+    // Waiting up to 20 minutes\n+    await waitWhileLoading(this.page, (20 * 60 * 1000));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b2fbade9aff984d89d860eb032e9fccd2d3c5b8"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI3NTUzOQ==", "bodyText": "This was part of button waitUntilEnabled. Instead of removing code, I'm saving code in a new function.", "url": "https://github.com/all-of-us/workbench/pull/4390#discussion_r540275539", "createdAt": "2020-12-10T15:45:21Z", "author": {"login": "aweng98"}, "path": "e2e/utils/waits-utils.ts", "diffHunk": "@@ -274,5 +274,15 @@ export async function waitWhileLoading(page: Page, timeOut: number = 90000): Pro\n   await page.waitForFunction((css) => {\n     const elements = document.querySelectorAll(css);\n     return elements && elements.length === 0;\n-  }, {polling: 'mutation', timeout: timeOut}, spinElementsSelector);\n+  }, {polling: 'mutation', timeout}, spinElementsSelector);\n+}\n+\n+export async function waitUntilEnabled(page: Page, cssSelector: string): Promise<boolean> {\n+  const jsHandle = await page.waitForFunction(xpathSelector => {\n+    const elemt = document.evaluate(xpathSelector, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n+    const style = window.getComputedStyle(elemt as Element);\n+    const propValue = style.getPropertyValue('cursor');\n+    return propValue === 'pointer';\n+  }, {}, cssSelector);\n+  return (await jsHandle.jsonValue()) as boolean;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b2fbade9aff984d89d860eb032e9fccd2d3c5b8"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5Mzg4NDQw", "url": "https://github.com/all-of-us/workbench/pull/4390#pullrequestreview-549388440", "createdAt": "2020-12-10T16:37:18Z", "commit": {"oid": "7b2fbade9aff984d89d860eb032e9fccd2d3c5b8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3750, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}