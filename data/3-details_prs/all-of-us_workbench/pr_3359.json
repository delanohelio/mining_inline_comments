{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMDEwNDA3", "number": 3359, "title": "[RW-3955][risk=moderate] Add preprod env configuration", "bodyText": "", "createdAt": "2020-04-07T03:07:50Z", "url": "https://github.com/all-of-us/workbench/pull/3359", "merged": true, "mergeCommit": {"oid": "c8984234831f28b7fe746ee44e13aba2c52d8426"}, "closed": true, "closedAt": "2020-05-05T21:21:16Z", "author": {"login": "calbach"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXj6VWAFqTM5Mjk1MTA2Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABceXrihgH2gAyNDAwMDEwNDA3OjAxZjBlMjNjNzcyNzhkODAyMzQyN2NjYTEwYWVkNDY1NWVjY2FjMDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyOTUxMDY2", "url": "https://github.com/all-of-us/workbench/pull/3359#pullrequestreview-392951066", "createdAt": "2020-04-14T13:55:42Z", "commit": {"oid": "063633bd03295939044cea0015bb604a04996e61"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxMzo1NTo0MlrOGFP11Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxMzo1NTo0MlrOGFP11Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE1NTYwNQ==", "bodyText": "Nice catch.", "url": "https://github.com/all-of-us/workbench/pull/3359#discussion_r408155605", "createdAt": "2020-04-14T13:55:42Z", "author": {"login": "s-rubenstein"}, "path": "api/libproject/devstart.rb", "diffHunk": "@@ -1090,10 +1099,11 @@ def create_auth_domain(cmd_name, args)\n   token = token.chomp\n   header = \"Authorization: Bearer #{token}\"\n   content_type = \"Content-type: application/json\"\n+  api_base_url = get_server_config(op.opts.project)[\"apiBaseUrl\"]\n \n   domain_name = get_auth_domain(op.opts.project)\n   common.run_inline %W{curl -X POST -H #{header} -H #{content_type} -d {}\n-     https://api-dot-#{op.opts.project}.appspot.com/v1/auth-domain/#{domain_name}}\n+     #{api_base_url}/v1/auth-domain/#{domain_name}}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "063633bd03295939044cea0015bb604a04996e61"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMDMyODg4", "url": "https://github.com/all-of-us/workbench/pull/3359#pullrequestreview-393032888", "createdAt": "2020-04-14T15:17:57Z", "commit": {"oid": "063633bd03295939044cea0015bb604a04996e61"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToxNzo1OFrOGFTzqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNToxOTowMFrOGFT20Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyMDU4NQ==", "bodyText": "Just thinking out loud, but it seems odd to me that Angular should know anything about which environment it's in.", "url": "https://github.com/all-of-us/workbench/pull/3359#discussion_r408220585", "createdAt": "2020-04-14T15:17:58Z", "author": {"login": "jaycarlton"}, "path": "ui/angular.json", "diffHunk": "@@ -149,6 +165,9 @@\n             \"stable\": {\n               \"browserTarget\": \"aou-workbench-ui:build:stable\"\n             },\n+            \"preprod\": {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "063633bd03295939044cea0015bb604a04996e61"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODIyMTM5Mw==", "bodyText": "Can we not just have a .stackdriverKeys/* or something for this? I realize they're public, but it still feels funny having these checked in.", "url": "https://github.com/all-of-us/workbench/pull/3359#discussion_r408221393", "createdAt": "2020-04-14T15:19:00Z", "author": {"login": "jaycarlton"}, "path": ".gitallowed", "diffHunk": "@@ -7,11 +7,13 @@\n 657299777109-kvb5qafr70bl01i6bnpgsiq5nt6v1o8u.apps.googleusercontent.com\n 56507752110-ovdus1lkreopsfhlovejvfgmsosveda6.apps.googleusercontent.com\n 684273740878-d7i68in5d9hqr6n9mfvrdh53snekp79f.apps.googleusercontent.com\n+589109405884-bmoj9ra8849rqeepuamk8jpu102iq363.apps.googleusercontent.com\n 63939010390-aj0r8hro7r8lkt7a45gissu3m73ietl2.apps.googleusercontent.com\n \n # Public API keys for Stackdriver. These also must be sent client-side.\n AIzaSyBSPcQ0FcR99GLXaqX4Ujpoj3JUDSP689g\n AIzaSyA4gOEvyJRkhIbW0x0Y7PkIowOSIK_Tous\n AIzaSyB44pugxPbfevF_fb7GichIv9D9ee5-nNk\n AIzaSyAkMIMIzUwv02RBK-A7cE1PbPpDJ2MTNtk\n+AIzaSyA5Q0xqZdyaHUIUjZFqpim26wQFO0JqIRw", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "063633bd03295939044cea0015bb604a04996e61"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODEwMDg0", "url": "https://github.com/all-of-us/workbench/pull/3359#pullrequestreview-396810084", "createdAt": "2020-04-20T21:02:13Z", "commit": {"oid": "2ac549708133f33a1d1f6fc860f2927dd4462710"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMTowMjoxM1rOGInjfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMTowMjoxM1rOGInjfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTY4OTg1Mg==", "bodyText": "@calbach I hope I'm not breaking etiquette by adding this commit.\nDo you think it would be possible for me to push this config and attempt to test out https://precisionmedicineinitiative.atlassian.net/browse/RW-4757 on preprod? It's not critical, but will be nice to confirm it's working.", "url": "https://github.com/all-of-us/workbench/pull/3359#discussion_r411689852", "createdAt": "2020-04-20T21:02:13Z", "author": {"login": "gjuggler"}, "path": "api/config/config_preprod.json", "diffHunk": "@@ -97,7 +97,7 @@\n     \"enableSumoLogicEventHandling\": true,\n     \"useKeylessDelegatedCredentials\": false,\n     \"sendFreeTierAlertEmails\": true,\n-    \"enableMoodleV2Api\": false,\n+    \"enableMoodleV2Api\": true,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ac549708133f33a1d1f6fc860f2927dd4462710"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c801cc70c61fca9098d4fd5d3cdec9b3bdc8413e", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/c801cc70c61fca9098d4fd5d3cdec9b3bdc8413e", "committedDate": "2020-05-04T18:22:27Z", "message": "Preprod configuration squashed"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ac549708133f33a1d1f6fc860f2927dd4462710", "author": {"user": {"login": "gjuggler", "name": "Greg Jordan"}}, "url": "https://github.com/all-of-us/workbench/commit/2ac549708133f33a1d1f6fc860f2927dd4462710", "committedDate": "2020-04-20T20:59:20Z", "message": "Update preprod to use V2 Moodle API (see RW-4757)."}, "afterCommit": {"oid": "31aef6ada47bdde084be3ac5df89b32eb1e810c7", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/31aef6ada47bdde084be3ac5df89b32eb1e810c7", "committedDate": "2020-05-04T18:47:04Z", "message": "Flag updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eaf77329425310d172d6b0069dca4c737904e147", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/eaf77329425310d172d6b0069dca4c737904e147", "committedDate": "2020-05-05T00:10:52Z", "message": "Rebased flag updates"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "31aef6ada47bdde084be3ac5df89b32eb1e810c7", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/31aef6ada47bdde084be3ac5df89b32eb1e810c7", "committedDate": "2020-05-04T18:47:04Z", "message": "Flag updates"}, "afterCommit": {"oid": "eaf77329425310d172d6b0069dca4c737904e147", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/eaf77329425310d172d6b0069dca4c737904e147", "committedDate": "2020-05-05T00:10:52Z", "message": "Rebased flag updates"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NDI4Nzg5", "url": "https://github.com/all-of-us/workbench/pull/3359#pullrequestreview-405428789", "createdAt": "2020-05-05T00:11:56Z", "commit": {"oid": "eaf77329425310d172d6b0069dca4c737904e147"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01f0e23c77278d8023427cca10aed4655eccac04", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/01f0e23c77278d8023427cca10aed4655eccac04", "committedDate": "2020-05-05T17:39:11Z", "message": "sync preprod UI env"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3360, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}