{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5NjUyMzg2", "number": 4280, "title": "[RW-5902][risk=moderate] Create Fitbit flag part of CDR version metadata", "bodyText": "Add attribute has_fitbit  to cdr_version database table with default value 0 (false).\nFor all the cdr version which will have fitbit data, set has_fitbit = 1,\nfor all other cdr versions, its not required to add the property or set has_fitbit to 0\n\nPR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n I have run the E2E tests on ths change against my local UI + API server with yarn test-local\n If this includes a UI change, I have taken screen recordings or screenshots of the new behavior and notified the PO and UX designer\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-11-12T06:25:39Z", "url": "https://github.com/all-of-us/workbench/pull/4280", "merged": true, "mergeCommit": {"oid": "e3e1a01367cea48f6df4ffb9333d3200dd062463"}, "closed": true, "closedAt": "2020-11-15T04:17:39Z", "author": {"login": "NehaBroad"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbsdtkAH2gAyNTE5NjUyMzg2OmQ0Mzg2YjM2YjY4OTIwY2EwMWRhMWY4YTBhMmEwNTA4NTc1OTE0Njc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcHRPggFqTUzMDA2NDg4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d4386b36b68920ca01da1f8a0a2a050857591467", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/d4386b36b68920ca01da1f8a0a2a050857591467", "committedDate": "2020-11-12T06:21:28Z", "message": "Add Fitbit flag to CDR Metadata"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MTk5NDc0", "url": "https://github.com/all-of-us/workbench/pull/4280#pullrequestreview-529199474", "createdAt": "2020-11-12T15:25:23Z", "commit": {"oid": "d4386b36b68920ca01da1f8a0a2a050857591467"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNToyNToyM1rOHx_-9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNTozMjowMlrOHyAT-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjE5MDU4MA==", "bodyText": "Not sure we need an enum.. you can just make the type: boolean", "url": "https://github.com/all-of-us/workbench/pull/4280#discussion_r522190580", "createdAt": "2020-11-12T15:25:23Z", "author": {"login": "freemabd"}, "path": "api/src/main/resources/workbench-api.yaml", "diffHunk": "@@ -3641,6 +3641,12 @@ definitions:\n     - unregistered\n     - registered\n     - protected\n+  CdrFitBitData:\n+    type: string\n+    description: Whether CDR has FITBIT data\n+    enum:\n+    - true\n+    - false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4386b36b68920ca01da1f8a0a2a050857591467"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjE5MDYyOA==", "bodyText": "Shouldn't this just be type: boolean like hasMicroarrayData above", "url": "https://github.com/all-of-us/workbench/pull/4280#discussion_r522190628", "createdAt": "2020-11-12T15:25:27Z", "author": {"login": "freemabd"}, "path": "api/src/main/resources/workbench-api.yaml", "diffHunk": "@@ -3784,6 +3790,8 @@ definitions:\n         \"$ref\": \"#/definitions/ArchivalStatus\"\n       hasMicroarrayData:\n         type: boolean\n+      hasFitbitData:\n+        \"$ref\": \"#/definitions/CdrFitBitData\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4386b36b68920ca01da1f8a0a2a050857591467"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjE5NTMwMw==", "bodyText": "This can be type: boolean", "url": "https://github.com/all-of-us/workbench/pull/4280#discussion_r522195303", "createdAt": "2020-11-12T15:31:11Z", "author": {"login": "freemabd"}, "path": "api/src/main/java/org/pmiops/workbench/db/model/DbCdrVersion.java", "diffHunk": "@@ -30,6 +31,7 @@\n   private String cdrDbName;\n   private String elasticIndexBaseName;\n   private String microarrayBigqueryDataset;\n+  private Short hasFitbitData;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4386b36b68920ca01da1f8a0a2a050857591467"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjE5NTk2Mw==", "bodyText": "If we use type boolean, there is not need for these mthods.", "url": "https://github.com/all-of-us/workbench/pull/4280#discussion_r522195963", "createdAt": "2020-11-12T15:32:02Z", "author": {"login": "freemabd"}, "path": "api/src/main/java/org/pmiops/workbench/db/model/DbStorageEnums.java", "diffHunk": "@@ -207,6 +208,21 @@ public static Short dataAccessLevelToStorage(DataAccessLevel level) {\n     return CLIENT_TO_STORAGE_DATA_ACCESS_LEVEL.get(level);\n   }\n \n+  // Cdr has Fitbit\n+  private static final BiMap<CdrFitBitData, Short> CLIENT_TO_STORAGE_FITBIT =\n+      ImmutableBiMap.<CdrFitBitData, Short>builder()\n+          .put(CdrFitBitData.FALSE, (short) 0)\n+          .put(CdrFitBitData.TRUE, (short) 1)\n+          .build();\n+\n+  public static CdrFitBitData cdrFitBitDataFromStorage(Short level) {\n+    return CLIENT_TO_STORAGE_FITBIT.inverse().get(level);\n+  }\n+\n+  public static Short cdrFitBitDataToStorage(CdrFitBitData level) {\n+    return CLIENT_TO_STORAGE_FITBIT.get(level);\n+  }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4386b36b68920ca01da1f8a0a2a050857591467"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a81d26de18f6ac9de64cdd75c8b6028359099ff", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/9a81d26de18f6ac9de64cdd75c8b6028359099ff", "committedDate": "2020-11-13T00:14:46Z", "message": "Change hasFitbit from enum to boolean"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05320f8329ed07df152710c0db3df29d03e72d10", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/05320f8329ed07df152710c0db3df29d03e72d10", "committedDate": "2020-11-13T00:32:53Z", "message": "Test for CDR version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc4bfe95e541ab26bddfb63b9dcb2f55d47c297d", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/dc4bfe95e541ab26bddfb63b9dcb2f55d47c297d", "committedDate": "2020-11-13T00:39:25Z", "message": "Removing code using enum"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwMDY0ODgx", "url": "https://github.com/all-of-us/workbench/pull/4280#pullrequestreview-530064881", "createdAt": "2020-11-13T13:35:17Z", "commit": {"oid": "dc4bfe95e541ab26bddfb63b9dcb2f55d47c297d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3857, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}