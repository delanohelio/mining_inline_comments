{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxOTE5NDY0", "number": 4348, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjozOTo1NlrOFAWQPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMDo1NVrOFAZXOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTA4OTI1OnYy", "diffSide": "LEFT", "path": "e2e/tests/workspace/cdr-version-display.spec.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjozOTo1N1rOH-l5Iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjozOTo1N1rOH-l5Iw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5NDU5NQ==", "bodyText": "checking cdr version on Data page is moved to workspace-create.spec test (one less new workspace).", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535394595", "createdAt": "2020-12-03T16:39:57Z", "author": {"login": "aweng98"}, "path": "e2e/tests/workspace/cdr-version-display.spec.ts", "diffHunk": "@@ -10,17 +10,6 @@ describe('Workspace CDR Version display', () => {\n         await signIn(page);\n     });\n \n-    test('The CDR version displays in the workspace navigation bar', async () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73e0a6adca30d140bcbc8ba1040f621d7603eb52"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTA5OTQ4OnYy", "diffSide": "LEFT", "path": "e2e/tests/workspace/workspace-edit.spec.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjo0MTozMlrOH-l_Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjo0MTozMlrOH-l_Aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5NjA5OQ==", "bodyText": "not useful, cluttering code.", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535396099", "createdAt": "2020-12-03T16:41:32Z", "author": {"login": "aweng98"}, "path": "e2e/tests/workspace/workspace-edit.spec.ts", "diffHunk": "@@ -85,8 +85,7 @@ describe('Editing workspace via workspace card snowman menu', () => {\n \n   test('User as OWNER can edit workspace via workspace action menu', async () => {\n     const workspaceCard = await findOrCreateWorkspace(page);\n-    const workspaceName = await workspaceCard.getWorkspaceName();\n-    console.log(workspaceName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73e0a6adca30d140bcbc8ba1040f621d7603eb52"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTExNjQ4OnYy", "diffSide": "RIGHT", "path": "e2e/jest-circus.setup.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjo0NDozM1rOH-mJLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjo0NDozM1rOH-mJLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5ODcwMw==", "bodyText": "disable global retry failed tests in an indiscriminate fashion. Retry uses up billing projects and may hides application issues.", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535398703", "createdAt": "2020-12-03T16:44:33Z", "author": {"login": "aweng98"}, "path": "e2e/jest-circus.setup.ts", "diffHunk": "@@ -2,4 +2,4 @@ require('expect-puppeteer');\n \n // Runs failed tests n-times until they pass or until the max number of retries is exhausted. This only works with jest-circus.\n // This file loaded in jest.config.js ==> setupFilesAfterEnv\n-jest.retryTimes(process.env.DEBUG === 'true' ? 0 : 1);\n+// jest.retryTimes(process.env.DEBUG === 'true' ? 0 : 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73e0a6adca30d140bcbc8ba1040f621d7603eb52"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTEyMTI4OnYy", "diffSide": "RIGHT", "path": "e2e/package.json", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxNjo0NToyM1rOH-mMMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QyMTowODo1MlrOH-zutg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5OTQ3NQ==", "bodyText": "--maxWorkers=3 will cause test to fail when only one test is selected to run.", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535399475", "createdAt": "2020-12-03T16:45:23Z", "author": {"login": "aweng98"}, "path": "e2e/package.json", "diffHunk": "@@ -9,10 +9,10 @@\n     \"test\": \"cross-env jest --maxWorkers=5\",\n     \"test:debugTest\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true node --inspect-brk node_modules/.bin/jest\",\n     \"test:debug\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true jest --detectOpenHandles\",\n-    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --maxWorkers=3\",\n-    \"test-local:debug\": \"cross-env WORKBENCH_ENV=local PUPPETEER_HEADLESS=false DEBUG=true jest --maxWorkers=3\",\n+    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --detectOpenHandles\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73e0a6adca30d140bcbc8ba1040f621d7603eb52"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ0NjY4Mg==", "bodyText": "This is surprising.  Where have you seen this?\nAlso: why change some of these but not others, and what does adding detectOpenHandles do?", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535446682", "createdAt": "2020-12-03T17:42:51Z", "author": {"login": "jmthibault79"}, "path": "e2e/package.json", "diffHunk": "@@ -9,10 +9,10 @@\n     \"test\": \"cross-env jest --maxWorkers=5\",\n     \"test:debugTest\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true node --inspect-brk node_modules/.bin/jest\",\n     \"test:debug\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true jest --detectOpenHandles\",\n-    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --maxWorkers=3\",\n-    \"test-local:debug\": \"cross-env WORKBENCH_ENV=local PUPPETEER_HEADLESS=false DEBUG=true jest --maxWorkers=3\",\n+    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --detectOpenHandles\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5OTQ3NQ=="}, "originalCommit": {"oid": "73e0a6adca30d140bcbc8ba1040f621d7603eb52"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ2ODgzNw==", "bodyText": "The error is Protocol error (DOM.describeNode): Target closed. when running only one test on localhost like yarn test-local tests/home/home-page.spec.ts.\n--detectOpenHandles detects one code issue: when asyn/promise code didn't use await.", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535468837", "createdAt": "2020-12-03T18:14:28Z", "author": {"login": "aweng98"}, "path": "e2e/package.json", "diffHunk": "@@ -9,10 +9,10 @@\n     \"test\": \"cross-env jest --maxWorkers=5\",\n     \"test:debugTest\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true node --inspect-brk node_modules/.bin/jest\",\n     \"test:debug\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true jest --detectOpenHandles\",\n-    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --maxWorkers=3\",\n-    \"test-local:debug\": \"cross-env WORKBENCH_ENV=local PUPPETEER_HEADLESS=false DEBUG=true jest --maxWorkers=3\",\n+    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --detectOpenHandles\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5OTQ3NQ=="}, "originalCommit": {"oid": "73e0a6adca30d140bcbc8ba1040f621d7603eb52"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTYxMjM2OA==", "bodyText": "I tried this out, and I was able to run a single test with maxWorkers=3.  Let's keep that flag.\nthibault@wm98d-e39 ~/src/aou/e2e (joel/create-auth-domain) $ yarn test-local tests/home/home-page.spec.ts                                                                                                                                           yarn run v1.21.1                                                                                                                                                                                                                                    $ cross-env WORKBENCH_ENV=local DEBUG=true jest --maxWorkers=3 tests/home/home-page.spec.ts                                                                                                                                                          PASS  tests/home/home-page.spec.ts (35.393 s)                                                                                                                                                                                                        Home page ui tests                                                                                                                                                                                                                                    \u2713 Check visibility of Workspace cards (16831 ms)                                                                                                                                                                                                    \u2713 Check Create New Workspace link on Home page (15654 ms)                                                                                                                                                                                                                                                                                                                                                                                                                                           Test Suites: 1 passed, 1 total                                                                                                                                                                                                                      Tests:       2 passed, 2 total                                                                                                                                                                                                                      Snapshots:   0 total                                                                                                                                                                                                                                Time:        36.542 s                                                                                                                                                                                                                               Ran all test suites matching /tests\\/home\\/home-page.spec.ts/i.                                                                                                                                                                                     \u2728  Done in 39.23s.", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535612368", "createdAt": "2020-12-03T21:02:11Z", "author": {"login": "jmthibault79"}, "path": "e2e/package.json", "diffHunk": "@@ -9,10 +9,10 @@\n     \"test\": \"cross-env jest --maxWorkers=5\",\n     \"test:debugTest\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true node --inspect-brk node_modules/.bin/jest\",\n     \"test:debug\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true jest --detectOpenHandles\",\n-    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --maxWorkers=3\",\n-    \"test-local:debug\": \"cross-env WORKBENCH_ENV=local PUPPETEER_HEADLESS=false DEBUG=true jest --maxWorkers=3\",\n+    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --detectOpenHandles\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5OTQ3NQ=="}, "originalCommit": {"oid": "73e0a6adca30d140bcbc8ba1040f621d7603eb52"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTYxMjk5Mw==", "bodyText": "detectOpenHandles looks useful.  Thanks \ud83d\udc4d", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535612993", "createdAt": "2020-12-03T21:02:35Z", "author": {"login": "jmthibault79"}, "path": "e2e/package.json", "diffHunk": "@@ -9,10 +9,10 @@\n     \"test\": \"cross-env jest --maxWorkers=5\",\n     \"test:debugTest\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true node --inspect-brk node_modules/.bin/jest\",\n     \"test:debug\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true jest --detectOpenHandles\",\n-    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --maxWorkers=3\",\n-    \"test-local:debug\": \"cross-env WORKBENCH_ENV=local PUPPETEER_HEADLESS=false DEBUG=true jest --maxWorkers=3\",\n+    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --detectOpenHandles\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5OTQ3NQ=="}, "originalCommit": {"oid": "73e0a6adca30d140bcbc8ba1040f621d7603eb52"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTYyMTMwMg==", "bodyText": "Reverted package.json back to original, saving detectOpenHandles change for another day.", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535621302", "createdAt": "2020-12-03T21:08:52Z", "author": {"login": "aweng98"}, "path": "e2e/package.json", "diffHunk": "@@ -9,10 +9,10 @@\n     \"test\": \"cross-env jest --maxWorkers=5\",\n     \"test:debugTest\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true node --inspect-brk node_modules/.bin/jest\",\n     \"test:debug\": \"cross-env PUPPETEER_HEADLESS=false DEBUG=true jest --detectOpenHandles\",\n-    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --maxWorkers=3\",\n-    \"test-local:debug\": \"cross-env WORKBENCH_ENV=local PUPPETEER_HEADLESS=false DEBUG=true jest --maxWorkers=3\",\n+    \"test-local\": \"cross-env WORKBENCH_ENV=local DEBUG=true jest --detectOpenHandles\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTM5OTQ3NQ=="}, "originalCommit": {"oid": "73e0a6adca30d140bcbc8ba1040f621d7603eb52"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM1OTU5ODY1OnYy", "diffSide": "RIGHT", "path": "e2e/tests/datasets/dataset-create.spec.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMDo1NVrOH-qxTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxODoyMDo1NVrOH-qxTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ3NDUwOQ==", "bodyText": "RW-5751 is done but no one re-enabled test.", "url": "https://github.com/all-of-us/workbench/pull/4348#discussion_r535474509", "createdAt": "2020-12-03T18:20:55Z", "author": {"login": "aweng98"}, "path": "e2e/tests/datasets/dataset-create.spec.ts", "diffHunk": "@@ -21,8 +21,7 @@ describe('Dataset test', () => {\n    * - Edit dataset. Save dataset without Export to Notebook.\n    * - Delete Dataset.\n    */\n-  // RW-5751 Search for condition is failing in CI.\n-  xtest('Can create Dataset with user-defined Cohorts', async () => {\n+  test('Can create Dataset with user-defined Cohorts', async () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9bc8f6c0a475e09f7a74ea02a25381386c71bfe"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3608, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}