{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0MzI3NzYz", "number": 3303, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxOTozMjo1OFrODrzYGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxOTozMzo0OVrODrzZNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3MjU3MTEyOnYy", "diffSide": "RIGHT", "path": "e2e/app/authenticated-page.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxOTozMjo1OFrOF8XOCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxOTozNTozN1rOF8XTjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgzOTMwNg==", "bodyText": "nit: change len to selectorLength", "url": "https://github.com/all-of-us/workbench/pull/3303#discussion_r398839306", "createdAt": "2020-03-26T19:32:58Z", "author": {"login": "NehaBroad"}, "path": "e2e/app/authenticated-page.ts", "diffHunk": "@@ -161,12 +161,28 @@ export default abstract class AuthenticatedPage extends BasePage {\n     }, {timeout: 1000}, selectr1);\n     const jValue = await spinner.jsonValue();\n \n-    // wait maximum 60 seconds for spinner disappear if spinner existed\n+    // wait maximum 90 seconds for spinner disappear if spinner existed\n     const selectr2 = 'svg[style*=\"spin\"], .spinner:empty';\n-    if (jValue) {\n-      await this.page.waitFor((selector) => {\n-        return document.querySelectorAll(selector).length === 0\n-      }, {timeout: 60000}, selectr2);\n+    const startTime = performance.now();\n+    try {\n+      if (jValue) {\n+        await this.page.waitFor((selector) => {\n+          const len = document.querySelectorAll(selector).length;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7753eac0b6bae03e1d50d03ce6cfee2003bf168b"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg0MDcxOA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/all-of-us/workbench/pull/3303#discussion_r398840718", "createdAt": "2020-03-26T19:35:37Z", "author": {"login": "aweng98"}, "path": "e2e/app/authenticated-page.ts", "diffHunk": "@@ -161,12 +161,28 @@ export default abstract class AuthenticatedPage extends BasePage {\n     }, {timeout: 1000}, selectr1);\n     const jValue = await spinner.jsonValue();\n \n-    // wait maximum 60 seconds for spinner disappear if spinner existed\n+    // wait maximum 90 seconds for spinner disappear if spinner existed\n     const selectr2 = 'svg[style*=\"spin\"], .spinner:empty';\n-    if (jValue) {\n-      await this.page.waitFor((selector) => {\n-        return document.querySelectorAll(selector).length === 0\n-      }, {timeout: 60000}, selectr2);\n+    const startTime = performance.now();\n+    try {\n+      if (jValue) {\n+        await this.page.waitFor((selector) => {\n+          const len = document.querySelectorAll(selector).length;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgzOTMwNg=="}, "originalCommit": {"oid": "7753eac0b6bae03e1d50d03ce6cfee2003bf168b"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3MjU3Mzk3OnYy", "diffSide": "RIGHT", "path": "e2e/app/authenticated-page.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxOTozMzo0OVrOF8XP1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxOTozNTowMlrOF8XSZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgzOTc2NA==", "bodyText": "should this be 60 or 90?", "url": "https://github.com/all-of-us/workbench/pull/3303#discussion_r398839764", "createdAt": "2020-03-26T19:33:49Z", "author": {"login": "NehaBroad"}, "path": "e2e/app/authenticated-page.ts", "diffHunk": "@@ -161,12 +161,28 @@ export default abstract class AuthenticatedPage extends BasePage {\n     }, {timeout: 1000}, selectr1);\n     const jValue = await spinner.jsonValue();\n \n-    // wait maximum 60 seconds for spinner disappear if spinner existed\n+    // wait maximum 90 seconds for spinner disappear if spinner existed\n     const selectr2 = 'svg[style*=\"spin\"], .spinner:empty';\n-    if (jValue) {\n-      await this.page.waitFor((selector) => {\n-        return document.querySelectorAll(selector).length === 0\n-      }, {timeout: 60000}, selectr2);\n+    const startTime = performance.now();\n+    try {\n+      if (jValue) {\n+        await this.page.waitFor((selector) => {\n+          const len = document.querySelectorAll(selector).length;\n+          return len === 0\n+        }, {timeout: 90000}, selectr2);\n+      }\n+    } catch (err) {\n+      await this.takeScreenshot('TimedOutWaitForSpinnerStop');\n+      throw err;\n+    } finally {\n+      const finishTime = performance.now();\n+      const diff = Math.floor(((finishTime - startTime) / 1000) % 60);\n+      if (diff > 60) {\n+        // if timeout exceeds 60 seconds without error thrown, it shows page loading is slow", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7753eac0b6bae03e1d50d03ce6cfee2003bf168b"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODg0MDQyMw==", "bodyText": "it's correct.", "url": "https://github.com/all-of-us/workbench/pull/3303#discussion_r398840423", "createdAt": "2020-03-26T19:35:02Z", "author": {"login": "aweng98"}, "path": "e2e/app/authenticated-page.ts", "diffHunk": "@@ -161,12 +161,28 @@ export default abstract class AuthenticatedPage extends BasePage {\n     }, {timeout: 1000}, selectr1);\n     const jValue = await spinner.jsonValue();\n \n-    // wait maximum 60 seconds for spinner disappear if spinner existed\n+    // wait maximum 90 seconds for spinner disappear if spinner existed\n     const selectr2 = 'svg[style*=\"spin\"], .spinner:empty';\n-    if (jValue) {\n-      await this.page.waitFor((selector) => {\n-        return document.querySelectorAll(selector).length === 0\n-      }, {timeout: 60000}, selectr2);\n+    const startTime = performance.now();\n+    try {\n+      if (jValue) {\n+        await this.page.waitFor((selector) => {\n+          const len = document.querySelectorAll(selector).length;\n+          return len === 0\n+        }, {timeout: 90000}, selectr2);\n+      }\n+    } catch (err) {\n+      await this.takeScreenshot('TimedOutWaitForSpinnerStop');\n+      throw err;\n+    } finally {\n+      const finishTime = performance.now();\n+      const diff = Math.floor(((finishTime - startTime) / 1000) % 60);\n+      if (diff > 60) {\n+        // if timeout exceeds 60 seconds without error thrown, it shows page loading is slow", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgzOTc2NA=="}, "originalCommit": {"oid": "7753eac0b6bae03e1d50d03ce6cfee2003bf168b"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3070, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}