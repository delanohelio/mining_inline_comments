{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0MTE5NTI5", "number": 3924, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzo0NjozMVrOEcz_jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzo1MTowOVrOEc0PjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NjQ3NDM3OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/pmiops/workbench/actionaudit/targetproperties/ProfileTargetProperty.kt", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzo0NjozMVrOHHkalw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjo1Mzo1N1rOHIZEIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzY5ODcxMQ==", "bodyText": "@jaycarlton just to confirm: we're free to alter these, right?  nothing depends on these names?", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r477698711", "createdAt": "2020-08-26T23:46:31Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/actionaudit/targetproperties/ProfileTargetProperty.kt", "diffHunk": "@@ -17,8 +17,7 @@ constructor(override val propertyName: String, override val extractor: (Profile)\n     DISABLED(\"disabled\", { it.disabled?.toString() }),\n     ABOUT_YOU(\"about_you\", Profile::getAboutYou),\n     AREA_OF_RESEARCH(\"area_of_research\", Profile::getAreaOfResearch),\n-    INSTITUTIONAL_AFFILIATIONS(\"institutional_affiliations\",\n-            { it.institutionalAffiliations?.joinToString(\", \") }),\n+    AFFILIATION(\"affiliation\", { it.verifiedInstitutionalAffiliation?.toString() }),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQwMDg2Ng==", "bodyText": "Technically you can change the enum constant name, but NOT the first argument. That's what goes in the property name column in the log, so it's part of the contract.\nThat said, if it's truly a new field, and you don't want to mix the new values with the old ones in a query, we should add a new one and I guess have the old one always return null so it's never changed. I haven't really had to deprecate a property before, so it's worth taking a minute to discuss. Wastes a tiny bit of log space, but it won't knock over BQ.\nMy preference here is to leave the names as-is and in post-processing, take the first one in the list.", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478400866", "createdAt": "2020-08-27T13:01:25Z", "author": {"login": "jaycarlton"}, "path": "api/src/main/java/org/pmiops/workbench/actionaudit/targetproperties/ProfileTargetProperty.kt", "diffHunk": "@@ -17,8 +17,7 @@ constructor(override val propertyName: String, override val extractor: (Profile)\n     DISABLED(\"disabled\", { it.disabled?.toString() }),\n     ABOUT_YOU(\"about_you\", Profile::getAboutYou),\n     AREA_OF_RESEARCH(\"area_of_research\", Profile::getAreaOfResearch),\n-    INSTITUTIONAL_AFFILIATIONS(\"institutional_affiliations\",\n-            { it.institutionalAffiliations?.joinToString(\", \") }),\n+    AFFILIATION(\"affiliation\", { it.verifiedInstitutionalAffiliation?.toString() }),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzY5ODcxMQ=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQ3NzM3MQ==", "bodyText": "ok, thanks.\nadding a new field makes sense here since the format of the affiliations have changed - it would be confusing to mix them.", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478477371", "createdAt": "2020-08-27T14:48:56Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/actionaudit/targetproperties/ProfileTargetProperty.kt", "diffHunk": "@@ -17,8 +17,7 @@ constructor(override val propertyName: String, override val extractor: (Profile)\n     DISABLED(\"disabled\", { it.disabled?.toString() }),\n     ABOUT_YOU(\"about_you\", Profile::getAboutYou),\n     AREA_OF_RESEARCH(\"area_of_research\", Profile::getAreaOfResearch),\n-    INSTITUTIONAL_AFFILIATIONS(\"institutional_affiliations\",\n-            { it.institutionalAffiliations?.joinToString(\", \") }),\n+    AFFILIATION(\"affiliation\", { it.verifiedInstitutionalAffiliation?.toString() }),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzY5ODcxMQ=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU2MTMxNA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478561314", "createdAt": "2020-08-27T16:53:57Z", "author": {"login": "jaycarlton"}, "path": "api/src/main/java/org/pmiops/workbench/actionaudit/targetproperties/ProfileTargetProperty.kt", "diffHunk": "@@ -17,8 +17,7 @@ constructor(override val propertyName: String, override val extractor: (Profile)\n     DISABLED(\"disabled\", { it.disabled?.toString() }),\n     ABOUT_YOU(\"about_you\", Profile::getAboutYou),\n     AREA_OF_RESEARCH(\"area_of_research\", Profile::getAreaOfResearch),\n-    INSTITUTIONAL_AFFILIATIONS(\"institutional_affiliations\",\n-            { it.institutionalAffiliations?.joinToString(\", \") }),\n+    AFFILIATION(\"affiliation\", { it.verifiedInstitutionalAffiliation?.toString() }),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzY5ODcxMQ=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NjQ3OTY2OnYy", "diffSide": "LEFT", "path": "api/src/main/java/org/pmiops/workbench/db/model/DbInstitutionalAffiliation.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzo0NzowN1rOHHkeWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzo0NzowN1rOHHkeWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzY5OTY3Mg==", "bodyText": "Waiting at least one release cycle before deleting this table", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r477699672", "createdAt": "2020-08-26T23:47:07Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/db/model/DbInstitutionalAffiliation.java", "diffHunk": "@@ -1,103 +0,0 @@\n-package org.pmiops.workbench.db.model;\n-\n-import javax.persistence.Column;\n-import javax.persistence.Entity;\n-import javax.persistence.GeneratedValue;\n-import javax.persistence.GenerationType;\n-import javax.persistence.Id;\n-import javax.persistence.JoinColumn;\n-import javax.persistence.ManyToOne;\n-import javax.persistence.Table;\n-import javax.persistence.Transient;\n-import org.pmiops.workbench.model.NonAcademicAffiliation;\n-\n-// Deprecated because it refers to old-style Institutional Affiliations, to be deleted in RW-4362\n-// The new-style equivalent is DbVerifiedInstitutionalAffiliation\n-@Deprecated\n-@Entity\n-@Table(name = \"institutional_affiliation\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NjQ5MTg5OnYy", "diffSide": "LEFT", "path": "api/src/main/java/org/pmiops/workbench/db/model/DemographicSurveyEnum.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzo0ODozM1rOHHkmrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzo0ODozM1rOHHkmrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwMTgwNw==", "bodyText": "Surprised to see this here - I thought we collected all of these in DbStorageEnums", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r477701807", "createdAt": "2020-08-26T23:48:33Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/db/model/DemographicSurveyEnum.java", "diffHunk": "@@ -77,35 +74,6 @@\n           .put(Disability.FALSE, (short) 2)\n           .build();\n \n-  private static final BiMap<IndustryRole, Short> CLIENT_TO_STORAGE_INDUSTRY_ROLE =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NjUwNTk0OnYy", "diffSide": "LEFT", "path": "api/src/test/java/org/pmiops/workbench/api/ProfileControllerTest.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzo1MDowOFrOHHkwGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNDo0NToyN1rOHITxoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwNDIxNw==", "bodyText": "none of these are applicable to the Verified version", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r477704217", "createdAt": "2020-08-26T23:50:08Z", "author": {"login": "jmthibault79"}, "path": "api/src/test/java/org/pmiops/workbench/api/ProfileControllerTest.java", "diffHunk": "@@ -582,104 +579,6 @@ public void testMe_userBeforeNotLoggedInSuccess() {\n         false);\n   }\n \n-  @Deprecated // to be removed in RW-4362", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQwNDc3NA==", "bodyText": "Do we have equivalent or better coverage of the new stuff?", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478404774", "createdAt": "2020-08-27T13:07:25Z", "author": {"login": "jaycarlton"}, "path": "api/src/test/java/org/pmiops/workbench/api/ProfileControllerTest.java", "diffHunk": "@@ -582,104 +579,6 @@ public void testMe_userBeforeNotLoggedInSuccess() {\n         false);\n   }\n \n-  @Deprecated // to be removed in RW-4362", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwNDIxNw=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQwNjE0Nw==", "bodyText": "Do we have equivalent coverage of the new stuff?", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478406147", "createdAt": "2020-08-27T13:09:36Z", "author": {"login": "jaycarlton"}, "path": "api/src/test/java/org/pmiops/workbench/api/ProfileControllerTest.java", "diffHunk": "@@ -582,104 +579,6 @@ public void testMe_userBeforeNotLoggedInSuccess() {\n         false);\n   }\n \n-  @Deprecated // to be removed in RW-4362", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwNDIxNw=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQ3NDY1Ng==", "bodyText": "These are about lists of affiliations - no equivalent concept exists.\nEquivalent feature coverage for the general concept of affiliation already exists", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478474656", "createdAt": "2020-08-27T14:45:27Z", "author": {"login": "jmthibault79"}, "path": "api/src/test/java/org/pmiops/workbench/api/ProfileControllerTest.java", "diffHunk": "@@ -582,104 +579,6 @@ public void testMe_userBeforeNotLoggedInSuccess() {\n         false);\n   }\n \n-  @Deprecated // to be removed in RW-4362", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwNDIxNw=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk4NjUxNTMzOnYy", "diffSide": "LEFT", "path": "ui/src/app/pages/login/account-creation/account-creation-options.tsx", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQyMzo1MTowOVrOHHk2ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjo0NDo1NFrOHIYvDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwNTg2Ng==", "bodyText": "components referencing these were removed on a previous sweep", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r477705866", "createdAt": "2020-08-26T23:51:09Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/login/account-creation/account-creation-options.tsx", "diffHunk": "@@ -28,43 +24,6 @@ export const AccountCreationOptions = {\n     {label: 'B.S.', value: Degree.BS},\n     {label: 'B.S.N.', value: Degree.BSN},\n   ],\n-  // BEGIN roles and affiliations for old (pre-verification) institutional affiliation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQwNTMyNw==", "bodyText": "I'd say check Rainforest scripts, but that's already retired, right?", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478405327", "createdAt": "2020-08-27T13:08:21Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/pages/login/account-creation/account-creation-options.tsx", "diffHunk": "@@ -28,43 +24,6 @@ export const AccountCreationOptions = {\n     {label: 'B.S.', value: Degree.BS},\n     {label: 'B.S.N.', value: Degree.BSN},\n   ],\n-  // BEGIN roles and affiliations for old (pre-verification) institutional affiliation", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwNTg2Ng=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODQ3NTU4Nw==", "bodyText": "This can be demonstrated simply by compilation", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478475587", "createdAt": "2020-08-27T14:46:40Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/login/account-creation/account-creation-options.tsx", "diffHunk": "@@ -28,43 +24,6 @@ export const AccountCreationOptions = {\n     {label: 'B.S.', value: Degree.BS},\n     {label: 'B.S.N.', value: Degree.BSN},\n   ],\n-  // BEGIN roles and affiliations for old (pre-verification) institutional affiliation", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwNTg2Ng=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODUwMTk4NQ==", "bodyText": "Right, but if we did have references to these labels in Rainforest scripts or help text, that wouldn't be caught by the compiler. Just double-checking.", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478501985", "createdAt": "2020-08-27T15:22:38Z", "author": {"login": "jaycarlton"}, "path": "ui/src/app/pages/login/account-creation/account-creation-options.tsx", "diffHunk": "@@ -28,43 +24,6 @@ export const AccountCreationOptions = {\n     {label: 'B.S.', value: Degree.BS},\n     {label: 'B.S.N.', value: Degree.BSN},\n   ],\n-  // BEGIN roles and affiliations for old (pre-verification) institutional affiliation", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwNTg2Ng=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU1NTkxNw==", "bodyText": "Nothing visible to Rainforest (about these consts) is changing in this PR", "url": "https://github.com/all-of-us/workbench/pull/3924#discussion_r478555917", "createdAt": "2020-08-27T16:44:54Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/login/account-creation/account-creation-options.tsx", "diffHunk": "@@ -28,43 +24,6 @@ export const AccountCreationOptions = {\n     {label: 'B.S.', value: Degree.BS},\n     {label: 'B.S.N.', value: Degree.BSN},\n   ],\n-  // BEGIN roles and affiliations for old (pre-verification) institutional affiliation", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzcwNTg2Ng=="}, "originalCommit": {"oid": "035730e7bc9c78826c8212f2c6603d187c46fc55"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2348, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}