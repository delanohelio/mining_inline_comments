{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2Mjk3ODYy", "number": 3239, "title": "[RW-4475][Risk=no] Working disabled UI", "bodyText": "Description:\nThe UI isn't quite like the mocks, because we haven't updated the logged out headers yet.\n\nI manually tested by disabling my user in test, and then hitting the UI.\nPR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-03-10T18:31:32Z", "url": "https://github.com/all-of-us/workbench/pull/3239", "merged": true, "mergeCommit": {"oid": "a19a8475f394ceba612db6180a8c6f1bd163ca89"}, "closed": true, "closedAt": "2020-03-11T13:47:00Z", "author": {"login": "s-rubenstein"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMW6ByAFqTM3MjIxOTkzNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMnEhygBqjMxMTg3NzkxNjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMjE5OTM0", "url": "https://github.com/all-of-us/workbench/pull/3239#pullrequestreview-372219934", "createdAt": "2020-03-10T18:34:11Z", "commit": {"oid": "b73dbdc8d098330acf46adecd4c2d2606bd36a46"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxODozNDoxMlrOF0b7SQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxODozNDoxMlrOF0b7SQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUyNzgxNw==", "bodyText": "I wasn't sure where to put this page. It is designed to look like the logged out pages, but I don't really like importing from different modules like this. Any ideas? (I also ended up copying some other code, that could probably be abstracted some more?)", "url": "https://github.com/all-of-us/workbench/pull/3239#discussion_r390527817", "createdAt": "2020-03-10T18:34:12Z", "author": {"login": "s-rubenstein"}, "path": "ui/src/app/pages/user-disabled.tsx", "diffHunk": "@@ -0,0 +1,57 @@\n+import {Component} from '@angular/core';\n+import * as React from 'react';\n+\n+import {StyledAnchorTag} from 'app/components/buttons';\n+import {FlexColumn} from 'app/components/flex';\n+import {Header} from 'app/components/headers';\n+import {backgroundStyleTemplate, SIGNED_OUT_HEADER_IMAGE, SignInStep, StepToImageConfig} from 'app/pages/login/sign-in';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b73dbdc8d098330acf46adecd4c2d2606bd36a46"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMjQ5MDI1", "url": "https://github.com/all-of-us/workbench/pull/3239#pullrequestreview-372249025", "createdAt": "2020-03-10T19:15:26Z", "commit": {"oid": "b73dbdc8d098330acf46adecd4c2d2606bd36a46"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxOToxNToyN1rOF0daHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxOToxOToyNVrOF0dinw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDU1MjA5NQ==", "bodyText": "nit: I don't think you're using any async syntax, so you can drop the 'async' here and below.\nI personally think the async syntax is nicer than nested, but I don't think we have a style requirement to use that (yet...)", "url": "https://github.com/all-of-us/workbench/pull/3239#discussion_r390552095", "createdAt": "2020-03-10T19:15:27Z", "author": {"login": "gjuggler"}, "path": "ui/src/app/guards/disabled-guard.service.ts", "diffHunk": "@@ -0,0 +1,29 @@\n+import {Injectable} from '@angular/core';\n+import {ActivatedRouteSnapshot, CanActivate, CanActivateChild, Router, RouterStateSnapshot} from '@angular/router';\n+\n+import {SignInService} from 'app/services/sign-in.service';\n+import {profileApi} from 'app/services/swagger-fetch-clients';\n+import {convertAPIError} from 'app/utils/errors';\n+import {ErrorCode} from 'generated/fetch';\n+\n+@Injectable()\n+export class DisabledGuard implements CanActivate, CanActivateChild {\n+  constructor(private signInService: SignInService, private router: Router) {}\n+\n+  async canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Promise<boolean> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b73dbdc8d098330acf46adecd4c2d2606bd36a46"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDU1NDI3MQ==", "bodyText": "It could be abstracted some more, but it's not too bad as-is. The most fragile part looks like the backgroundStyleTemplate method call... I don't think including the bg image is critical to the disabled page, so I might be inclined to leave that out in the name of maintainability, but keep the header image (which could more easily be pulled out into a separate constants file, but also isn't a critical to-do IMO).", "url": "https://github.com/all-of-us/workbench/pull/3239#discussion_r390554271", "createdAt": "2020-03-10T19:19:25Z", "author": {"login": "gjuggler"}, "path": "ui/src/app/pages/user-disabled.tsx", "diffHunk": "@@ -0,0 +1,57 @@\n+import {Component} from '@angular/core';\n+import * as React from 'react';\n+\n+import {StyledAnchorTag} from 'app/components/buttons';\n+import {FlexColumn} from 'app/components/flex';\n+import {Header} from 'app/components/headers';\n+import {backgroundStyleTemplate, SIGNED_OUT_HEADER_IMAGE, SignInStep, StepToImageConfig} from 'app/pages/login/sign-in';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUyNzgxNw=="}, "originalCommit": {"oid": "b73dbdc8d098330acf46adecd4c2d2606bd36a46"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac803b2d91701c3fac0b5d1f02d1ef529d99e655", "author": {"user": {"login": "s-rubenstein", "name": "Sky Rubenstein"}}, "url": "https://github.com/all-of-us/workbench/commit/ac803b2d91701c3fac0b5d1f02d1ef529d99e655", "committedDate": "2020-03-11T13:24:17Z", "message": "[RW-4475][Risk=no] Working disabled UI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cacfd836c675d9cd8c4702e33b0d97b0b4dd0186", "author": {"user": {"login": "s-rubenstein", "name": "Sky Rubenstein"}}, "url": "https://github.com/all-of-us/workbench/commit/cacfd836c675d9cd8c4702e33b0d97b0b4dd0186", "committedDate": "2020-03-11T13:24:17Z", "message": "Fix linting"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b73dbdc8d098330acf46adecd4c2d2606bd36a46", "author": {"user": {"login": "s-rubenstein", "name": "Sky Rubenstein"}}, "url": "https://github.com/all-of-us/workbench/commit/b73dbdc8d098330acf46adecd4c2d2606bd36a46", "committedDate": "2020-03-10T18:30:16Z", "message": "[RW-4475][Risk=no] Working disabled UI"}, "afterCommit": {"oid": "cacfd836c675d9cd8c4702e33b0d97b0b4dd0186", "author": {"user": {"login": "s-rubenstein", "name": "Sky Rubenstein"}}, "url": "https://github.com/all-of-us/workbench/commit/cacfd836c675d9cd8c4702e33b0d97b0b4dd0186", "committedDate": "2020-03-11T13:24:17Z", "message": "Fix linting"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3449, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}