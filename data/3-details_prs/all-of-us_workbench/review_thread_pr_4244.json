{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0OTAzNzIx", "number": 4244, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDozNzo1N1rOE0-OFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDo0NzozMVrOE0-Z5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzOTgwODIwOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/pmiops/workbench/notebooks/LeonardoNotebooksClientImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDozNzo1N1rOHs_mkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDozNzo1N1rOHs_mkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0MTQ1Ng==", "bodyText": "opt: generally I think it's more readable to put the primary param first, followed by any optional / nullable / less-important params", "url": "https://github.com/all-of-us/workbench/pull/4244#discussion_r516941456", "createdAt": "2020-11-03T20:37:57Z", "author": {"login": "calbach"}, "path": "api/src/main/java/org/pmiops/workbench/notebooks/LeonardoNotebooksClientImpl.java", "diffHunk": "@@ -131,26 +133,34 @@ private LeonardoCreateRuntimeRequest buildCreateRuntimeRequest(\n             .welderRegistry(WelderRegistryEnum.DOCKERHUB)\n             .customEnvironmentVariables(customEnvironmentVariables);\n \n+    request.setRuntimeConfig(buildRuntimeConfig(clusterOverride, runtime));\n+\n+    return request;\n+  }\n+\n+  private Object buildRuntimeConfig(@Nullable ClusterConfig clusterOverride, Runtime runtime) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c9b9dcd9d621ae765bda4e782d1a506f91bf5eb"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzOTgxMjM4OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/pmiops/workbench/notebooks/LeonardoNotebooksClientImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDozOToxNlrOHs_pCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDozOToxNlrOHs_pCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0MjA4OQ==", "bodyText": "nit: Do you need the request here? Should the param just be the Runtime object?", "url": "https://github.com/all-of-us/workbench/pull/4244#discussion_r516942089", "createdAt": "2020-11-03T20:39:16Z", "author": {"login": "calbach"}, "path": "api/src/main/java/org/pmiops/workbench/notebooks/LeonardoNotebooksClientImpl.java", "diffHunk": "@@ -184,6 +194,24 @@ public void createRuntime(Runtime runtime, String workspaceFirecloudName) {\n         });\n   }\n \n+  @Override\n+  public void updateRuntime(String workspaceNamespace, UpdateRuntimeRequest updateRuntimeRequest) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c9b9dcd9d621ae765bda4e782d1a506f91bf5eb"}, "originalPosition": 57}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzOTgxNTcxOnYy", "diffSide": "RIGHT", "path": "api/src/main/resources/workbench-api.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDo0MDoxNFrOHs_q8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDo0MDoxNFrOHs_q8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0MjU3Nw==", "bodyText": "nit: I don't know if these schema descriptions are accurate in the error case", "url": "https://github.com/all-of-us/workbench/pull/4244#discussion_r516942577", "createdAt": "2020-11-03T20:40:14Z", "author": {"login": "calbach"}, "path": "api/src/main/resources/workbench-api.yaml", "diffHunk": "@@ -646,6 +646,31 @@ paths:\n           description: A runtime for this user and workspace already exists.\n           schema:\n             \"$ref\": \"#/definitions/EmptyResponse\"\n+    patch:\n+      summary: Updates the configuration of a runtime\n+      description: In order to update the configuration of a runtime, it must first be running or paused\n+      operationId: updateRuntime\n+      tags:\n+      - runtime\n+      parameters:\n+        - \"$ref\": \"#/parameters/workspaceNamespace\"\n+        - in: body\n+          name: runtime\n+          schema:\n+            \"$ref\": \"#/definitions/UpdateRuntimeRequest\"\n+      responses:\n+        202:\n+          description: Runtime update request accepted\n+          schema:\n+            \"$ref\": \"#/definitions/EmptyResponse\"\n+        400:\n+          description: Bad Request\n+          schema:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c9b9dcd9d621ae765bda4e782d1a506f91bf5eb"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzOTgzMTI2OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/pmiops/workbench/api/RuntimeController.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDo0NToxMlrOHs_0QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxNjoxNDowMFrOHtfTyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0NDk2MA==", "bodyText": "opt: could combine these into a singular xor statement", "url": "https://github.com/all-of-us/workbench/pull/4244#discussion_r516944960", "createdAt": "2020-11-03T20:45:12Z", "author": {"login": "calbach"}, "path": "api/src/main/java/org/pmiops/workbench/api/RuntimeController.java", "diffHunk": "@@ -272,6 +273,36 @@ private Runtime getOverrideFromListRuntimes(String workspaceNamespace) {\n     return ResponseEntity.ok(new EmptyResponse());\n   }\n \n+  @Override\n+  public ResponseEntity<EmptyResponse> updateRuntime(\n+      String workspaceNamespace, UpdateRuntimeRequest runtimeRequest) {\n+    if (runtimeRequest == null || runtimeRequest.getRuntime() == null) {\n+      throw new BadRequestException(\"Runtime cannot be empty for an update request\");\n+    }\n+\n+    if (runtimeRequest.getRuntime().getGceConfig() == null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c9b9dcd9d621ae765bda4e782d1a506f91bf5eb"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQ2MDkzOA==", "bodyText": "Going to leave them separate because I have different messages for some of the cases.", "url": "https://github.com/all-of-us/workbench/pull/4244#discussion_r517460938", "createdAt": "2020-11-04T16:14:00Z", "author": {"login": "ericsong"}, "path": "api/src/main/java/org/pmiops/workbench/api/RuntimeController.java", "diffHunk": "@@ -272,6 +273,36 @@ private Runtime getOverrideFromListRuntimes(String workspaceNamespace) {\n     return ResponseEntity.ok(new EmptyResponse());\n   }\n \n+  @Override\n+  public ResponseEntity<EmptyResponse> updateRuntime(\n+      String workspaceNamespace, UpdateRuntimeRequest runtimeRequest) {\n+    if (runtimeRequest == null || runtimeRequest.getRuntime() == null) {\n+      throw new BadRequestException(\"Runtime cannot be empty for an update request\");\n+    }\n+\n+    if (runtimeRequest.getRuntime().getGceConfig() == null", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0NDk2MA=="}, "originalCommit": {"oid": "0c9b9dcd9d621ae765bda4e782d1a506f91bf5eb"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzOTgzODQ0OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/org/pmiops/workbench/notebooks/LeonardoNotebooksClientImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDo0NzozMVrOHs_4dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDo0NzozMVrOHs_4dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk0NjAzOQ==", "bodyText": "Please add a TODO somewhere around here and/or file ticket as a follow-up for updating labels, Leo ticket is https://broadworkbench.atlassian.net/browse/IA-2149", "url": "https://github.com/all-of-us/workbench/pull/4244#discussion_r516946039", "createdAt": "2020-11-03T20:47:31Z", "author": {"login": "calbach"}, "path": "api/src/main/java/org/pmiops/workbench/notebooks/LeonardoNotebooksClientImpl.java", "diffHunk": "@@ -184,6 +194,24 @@ public void createRuntime(Runtime runtime, String workspaceFirecloudName) {\n         });\n   }\n \n+  @Override\n+  public void updateRuntime(String workspaceNamespace, UpdateRuntimeRequest updateRuntimeRequest) {\n+    leonardoRetryHandler.run(\n+        (context) -> {\n+          runtimesApiProvider\n+              .get()\n+              .updateRuntime(\n+                  updateRuntimeRequest.getRuntime().getGoogleProject(),\n+                  updateRuntimeRequest.getRuntime().getRuntimeName(),\n+                  new LeonardoUpdateRuntimeRequest()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c9b9dcd9d621ae765bda4e782d1a506f91bf5eb"}, "originalPosition": 65}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3704, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}