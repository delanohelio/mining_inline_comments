{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0ODM0NzI1", "number": 3622, "title": "[RW-4313][risk=no] Teardown cluster resources bucket", "bodyText": "This is cleanup since we've switched to instead serving static files. This simplifies our deployment process, and as a side-effect, bypasses a problem in preprod (preprod buckets are configured differently than other environments).", "createdAt": "2020-05-29T01:27:29Z", "url": "https://github.com/all-of-us/workbench/pull/3622", "merged": true, "mergeCommit": {"oid": "13ebf7ea9ad3e5c6dea68a03be341ab4898810d0"}, "closed": true, "closedAt": "2020-05-29T21:57:10Z", "author": {"login": "calbach"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcl4D6LAH2gAyNDI0ODM0NzI1OjJkOWRhNDg2MTg3MWZjZjgzYmEwNTU4NGQ3NTIzZmU5YzIwNWNjZmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcmHah3gFqTQyMTIxODI0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2d9da4861871fcf83ba05584d7523fe9c205ccfa", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/2d9da4861871fcf83ba05584d7523fe9c205ccfa", "committedDate": "2020-05-29T01:20:14Z", "message": "kill cluster-resources bucket, mv static files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/5f01e8808aba3191f29fb2ff3f03da2723ba1842", "committedDate": "2020-05-29T01:26:23Z", "message": "rename dir"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMDY1NTI1", "url": "https://github.com/all-of-us/workbench/pull/3622#pullrequestreview-421065525", "createdAt": "2020-05-29T15:36:27Z", "commit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNTozNjoyN1rOGch3zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNTo1MjowOVrOGcic1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU2ODI2OA==", "bodyText": "This doesn't look right", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432568268", "createdAt": "2020-05-29T15:36:27Z", "author": {"login": "jmthibault79"}, "path": "api/snippets-menu/build.rb", "diffHunk": "@@ -2,6 +2,7 @@\n \n require 'fileutils'\n require_relative \"../../aou-utils/workbench\"\n+require_relative \"../../../aou-utils/utils/common\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MTg1MA==", "bodyText": "update path", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432571850", "createdAt": "2020-05-29T15:42:19Z", "author": {"login": "jmthibault79"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly\n+manual and can be improved going forwards (see RW-2665):\n+\n+Prerequisite: Must have `jq` installed (for pretty printing).\n+\n+1. In a separate directory, clone the snippets repo and build the menu config:\n+    https://github.com/all-of-us/workbench-snippets/blob/master/CONTRIBUTING.md#auto-generation-of-jupyter-snippets-menu-configuration\n+1. Run the following from the `workbench/api/cluster-resources` directory to pull in the updated JSON", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MzI3Ng==", "bodyText": "should we add app/static here?", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432573276", "createdAt": "2020-05-29T15:44:43Z", "author": {"login": "jmthibault79"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MzUyNw==", "bodyText": "might as well fix this typo", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432573527", "createdAt": "2020-05-29T15:45:04Z", "author": {"login": "jmthibault79"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3Njg0Nw==", "bodyText": "This script needs to be updated to copy to the correct destination.  output:\nCopied pretty printed ../../../aou-snippets/build/r_dataset_snippets_menu_config.json into /Users/thibault/src/aou/api/cluster-resources/r-dataset-snippets-menu.json", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432576847", "createdAt": "2020-05-29T15:50:42Z", "author": {"login": "jmthibault79"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly\n+manual and can be improved going forwards (see RW-2665):\n+\n+Prerequisite: Must have `jq` installed (for pretty printing).\n+\n+1. In a separate directory, clone the snippets repo and build the menu config:\n+    https://github.com/all-of-us/workbench-snippets/blob/master/CONTRIBUTING.md#auto-generation-of-jupyter-snippets-menu-configuration\n+1. Run the following from the `workbench/api/cluster-resources` directory to pull in the updated JSON\n+\n+    ```\n+    ./import_json_from_snippets_repo.sh <path to workbench-snippets repo>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3Nzc1MA==", "bodyText": "no longer above - add link", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432577750", "createdAt": "2020-05-29T15:52:09Z", "author": {"login": "jmthibault79"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly\n+manual and can be improved going forwards (see RW-2665):\n+\n+Prerequisite: Must have `jq` installed (for pretty printing).\n+\n+1. In a separate directory, clone the snippets repo and build the menu config:\n+    https://github.com/all-of-us/workbench-snippets/blob/master/CONTRIBUTING.md#auto-generation-of-jupyter-snippets-menu-configuration\n+1. Run the following from the `workbench/api/cluster-resources` directory to pull in the updated JSON\n+\n+    ```\n+    ./import_json_from_snippets_repo.sh <path to workbench-snippets repo>\n+    ```\n+1. Commit changes and go through normal pull request process.\n+1. Wait for a release; note that changes are only visible for clusters started\n+    after the release.\n+\n+## Snippets Extension Implementation\n+\n+The snippets menu extension Javascript is generated dynamically at deploy time\n+by `./build.rb` into the GAE static resources folder. This process takes as\n+inputs the templated extension `snippets-menu.js.template` and the per-language\n+collocated menu JSON files.\n+\n+## Local testing\n+\n+See instructions for local extension testing above.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6c644ed6398850bd24a19e469f5a854d59bfe33", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/a6c644ed6398850bd24a19e469f5a854d59bfe33", "committedDate": "2020-05-29T17:22:38Z", "message": "PR / doc fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMTMxNzc2", "url": "https://github.com/all-of-us/workbench/pull/3622#pullrequestreview-421131776", "createdAt": "2020-05-29T17:03:55Z", "commit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNzowMzo1NVrOGck_tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNzowODozMlrOGclMLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYxOTQ0NQ==", "bodyText": "Yes, thanks - updated.", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432619445", "createdAt": "2020-05-29T17:03:55Z", "author": {"login": "calbach"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MzI3Ng=="}, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYxOTgzMA==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432619830", "createdAt": "2020-05-29T17:04:41Z", "author": {"login": "calbach"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MzUyNw=="}, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYxOTg3Ng==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432619876", "createdAt": "2020-05-29T17:04:47Z", "author": {"login": "calbach"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly\n+manual and can be improved going forwards (see RW-2665):\n+\n+Prerequisite: Must have `jq` installed (for pretty printing).\n+\n+1. In a separate directory, clone the snippets repo and build the menu config:\n+    https://github.com/all-of-us/workbench-snippets/blob/master/CONTRIBUTING.md#auto-generation-of-jupyter-snippets-menu-configuration\n+1. Run the following from the `workbench/api/cluster-resources` directory to pull in the updated JSON", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3MTg1MA=="}, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYyMTIwNw==", "bodyText": "Oops, thanks. I've now run this myself to validate.", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432621207", "createdAt": "2020-05-29T17:06:48Z", "author": {"login": "calbach"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly\n+manual and can be improved going forwards (see RW-2665):\n+\n+Prerequisite: Must have `jq` installed (for pretty printing).\n+\n+1. In a separate directory, clone the snippets repo and build the menu config:\n+    https://github.com/all-of-us/workbench-snippets/blob/master/CONTRIBUTING.md#auto-generation-of-jupyter-snippets-menu-configuration\n+1. Run the following from the `workbench/api/cluster-resources` directory to pull in the updated JSON\n+\n+    ```\n+    ./import_json_from_snippets_repo.sh <path to workbench-snippets repo>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3Njg0Nw=="}, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYyMjIzMg==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432622232", "createdAt": "2020-05-29T17:07:59Z", "author": {"login": "calbach"}, "path": "api/snippets-menu/README.md", "diffHunk": "@@ -0,0 +1,52 @@\n+# Snippets Menu\n+\n+AoU Clusters enable the [Snippets Menu extension](https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/snippets_menu/readme.html)\n+with custom AoU-specific code snippets. The snippets live in\n+https://github.com/all-of-us/workbench-snippets. AoU configures Leo clusters as\n+follows to enable this:\n+\n+1. Enable the snippets_menu/main extension in ./initialize_notebook_cluster.sh\n+1. Deploy a Jupyter UI extension to configure the menu with AoU-specific snippets\n+\n+## Updating Snippets\n+\n+As code snippets are updated in the source repository, we will want to\n+periocially update the menus in the Workbench. For now, this process is fairly\n+manual and can be improved going forwards (see RW-2665):\n+\n+Prerequisite: Must have `jq` installed (for pretty printing).\n+\n+1. In a separate directory, clone the snippets repo and build the menu config:\n+    https://github.com/all-of-us/workbench-snippets/blob/master/CONTRIBUTING.md#auto-generation-of-jupyter-snippets-menu-configuration\n+1. Run the following from the `workbench/api/cluster-resources` directory to pull in the updated JSON\n+\n+    ```\n+    ./import_json_from_snippets_repo.sh <path to workbench-snippets repo>\n+    ```\n+1. Commit changes and go through normal pull request process.\n+1. Wait for a release; note that changes are only visible for clusters started\n+    after the release.\n+\n+## Snippets Extension Implementation\n+\n+The snippets menu extension Javascript is generated dynamically at deploy time\n+by `./build.rb` into the GAE static resources folder. This process takes as\n+inputs the templated extension `snippets-menu.js.template` and the per-language\n+collocated menu JSON files.\n+\n+## Local testing\n+\n+See instructions for local extension testing above.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU3Nzc1MA=="}, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYyMjYzNg==", "bodyText": "Oops, fixed - ran a demo server deploy as well to verify", "url": "https://github.com/all-of-us/workbench/pull/3622#discussion_r432622636", "createdAt": "2020-05-29T17:08:32Z", "author": {"login": "calbach"}, "path": "api/snippets-menu/build.rb", "diffHunk": "@@ -2,6 +2,7 @@\n \n require 'fileutils'\n require_relative \"../../aou-utils/workbench\"\n+require_relative \"../../../aou-utils/utils/common\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjU2ODI2OA=="}, "originalCommit": {"oid": "5f01e8808aba3191f29fb2ff3f03da2723ba1842"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMjE4MjQ2", "url": "https://github.com/all-of-us/workbench/pull/3622#pullrequestreview-421218246", "createdAt": "2020-05-29T19:13:31Z", "commit": {"oid": "a6c644ed6398850bd24a19e469f5a854d59bfe33"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4798, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}