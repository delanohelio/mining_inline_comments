{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNTQyNDIz", "number": 3918, "title": "[RW-4897][risk=no] Puppeteer user registration test", "bodyText": "Re-enabled end to end user registration workflow test registration.spec.ts. This test is scheduled to run nightly (once a day) so only one new user will be registered/created per env.", "createdAt": "2020-08-25T22:37:48Z", "url": "https://github.com/all-of-us/workbench/pull/3918", "merged": true, "mergeCommit": {"oid": "16becc0f5711d2dd150bebba9aa2578d9fa4b9bc"}, "closed": true, "closedAt": "2020-08-26T15:56:36Z", "author": {"login": "aweng98"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCfC8CgH2gAyNDczNTQyNDIzOjBiYjcyZDU2YzJmNTdiMDQ0NGUwNzQ3NWRiM2JmZDQwMTAzZTkwMjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCt5dDAFqTQ3NTYyOTIzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0bb72d56c2f57b0444e07475db3bfd40103e9027", "author": {"user": {"login": "aweng98", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/0bb72d56c2f57b0444e07475db3bfd40103e9027", "committedDate": "2020-08-25T22:35:21Z", "message": "user registration test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d33b3369c42c0be1125e6607bddf74745ad47de1", "author": {"user": {"login": "aweng98", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/d33b3369c42c0be1125e6607bddf74745ad47de1", "committedDate": "2020-08-25T22:40:13Z", "message": "enable registration test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MDE1NTc1", "url": "https://github.com/all-of-us/workbench/pull/3918#pullrequestreview-475015575", "createdAt": "2020-08-25T22:42:44Z", "commit": {"oid": "d33b3369c42c0be1125e6607bddf74745ad47de1"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMjo0Mjo0NFrOHGuOpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMjo0Mzo1OFrOHGuSGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjgxMDkxOQ==", "bodyText": "Not really gain anything by having two tests. Combine two into one in order to run it quicker.", "url": "https://github.com/all-of-us/workbench/pull/3918#discussion_r476810919", "createdAt": "2020-08-25T22:42:44Z", "author": {"login": "aweng98"}, "path": "e2e/tests/user/registration-ui.spec.ts", "diffHunk": "@@ -50,19 +50,6 @@ describe('User registration tests:', () => {\n     // uncheck a checkbox then check NEXT button is again disabled\n     await (await createAccountPage.getTermsOfUseCheckbox()).unCheck();\n     expect(await nextButton.isCursorNotAllowed()).toEqual(true);\n-  });\n-\n-\n-  test('Loading User information page', async () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d33b3369c42c0be1125e6607bddf74745ad47de1"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjgxMTgwMg==", "bodyText": "Move NODE_ENV and CI env variables to CircleCI config.yml.", "url": "https://github.com/all-of-us/workbench/pull/3918#discussion_r476811802", "createdAt": "2020-08-25T22:43:58Z", "author": {"login": "aweng98"}, "path": "e2e/package.json", "diffHunk": "@@ -13,8 +13,8 @@\n     \"test-local:debug\": \"cross-env WORKBENCH_ENV=local PUPPETEER_HEADLESS=false DEBUG=true jest --maxWorkers=2\",\n     \"test-staging\": \"cross-env WORKBENCH_ENV=staging jest --maxWorkers=3\",\n     \"test-staging:debug\": \"cross-env WORKBENCH_ENV=staging PUPPETEER_HEADLESS=false DEBUG=true jest --maxWorkers=1\",\n-    \"test:ci\": \"cross-env NODE_ENV=development CI=true jest --ci --maxWorkers=2\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d33b3369c42c0be1125e6607bddf74745ad47de1"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd72a8e2e948d54882f0a7e580a7d469b6681beb", "author": {"user": {"login": "aweng98", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/dd72a8e2e948d54882f0a7e580a7d469b6681beb", "committedDate": "2020-08-25T22:45:08Z", "message": "config.yml error fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MDQ3MzEz", "url": "https://github.com/all-of-us/workbench/pull/3918#pullrequestreview-475047313", "createdAt": "2020-08-25T23:14:25Z", "commit": {"oid": "dd72a8e2e948d54882f0a7e580a7d469b6681beb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMzoxNDoyNlrOHGwFDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMzoxNDoyNlrOHGwFDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njg0MTIzMQ==", "bodyText": "jest.config.js: const { defaults } = require('jest-config'); throws tslib error without this change.", "url": "https://github.com/all-of-us/workbench/pull/3918#discussion_r476841231", "createdAt": "2020-08-25T23:14:26Z", "author": {"login": "aweng98"}, "path": "e2e/tsconfig.json", "diffHunk": "@@ -4,7 +4,7 @@\n     \"allowUnreachableCode\": false,\n     \"suppressExcessPropertyErrors\": false,\n     \"moduleResolution\": \"node\",\n-    \"module\": \"commonjs\",\n+    \"module\": \"ES2015\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dd72a8e2e948d54882f0a7e580a7d469b6681beb"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc20ba2d8e4efe36a84d27a0318a5ce8a0f48f5f", "author": {"user": {"login": "aweng98", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/bc20ba2d8e4efe36a84d27a0318a5ce8a0f48f5f", "committedDate": "2020-08-25T23:43:34Z", "message": "jest.config.js fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MDU3OTY5", "url": "https://github.com/all-of-us/workbench/pull/3918#pullrequestreview-475057969", "createdAt": "2020-08-25T23:44:52Z", "commit": {"oid": "bc20ba2d8e4efe36a84d27a0318a5ce8a0f48f5f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMzo0NDo1MlrOHGyDSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQyMzo0NDo1MlrOHGyDSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njg3MzU0NQ==", "bodyText": "moduleFileExtensions  default array is: [\"js\", \"json\", \"jsx\", \"ts\", \"tsx\", \"node\"]", "url": "https://github.com/all-of-us/workbench/pull/3918#discussion_r476873545", "createdAt": "2020-08-25T23:44:52Z", "author": {"login": "aweng98"}, "path": "e2e/jest.config.js", "diffHunk": "@@ -28,21 +31,11 @@ module.exports = {\n     \"/node_modules/\",\n     \"/tsc-out/\"\n   ],\n-  \"testMatch\": [\n-    \"<rootDir>/tests/**/*.spec.ts\"\n-  ],\n+  testMatch: TEST_MODE === \"nightly-integration\" ? [ \"<rootDir>/tests/nightly/**/*.spec.ts\", ] : [ \"<rootDir>/tests(?!\\/nightly)/**/*.spec.ts\", ],\n   \"transformIgnorePatterns\": [\n     \"<rootDir>/node_modules/(?!tests)\"\n   ],\n-  \"moduleFileExtensions\": [\n-    \"ts\",\n-    \"spec.ts\",\n-    \"tsx\",\n-    \"js\",\n-    \"jsx\",\n-    \"json\",\n-    \"node\"\n-  ],\n+  \"moduleFileExtensions\": [ ...defaults.moduleFileExtensions ],", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc20ba2d8e4efe36a84d27a0318a5ce8a0f48f5f"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1MDY2NzY4", "url": "https://github.com/all-of-us/workbench/pull/3918#pullrequestreview-475066768", "createdAt": "2020-08-26T00:11:42Z", "commit": {"oid": "bc20ba2d8e4efe36a84d27a0318a5ce8a0f48f5f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1NTUxMzc1", "url": "https://github.com/all-of-us/workbench/pull/3918#pullrequestreview-475551375", "createdAt": "2020-08-26T14:32:48Z", "commit": {"oid": "bc20ba2d8e4efe36a84d27a0318a5ce8a0f48f5f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1NjI5MjM4", "url": "https://github.com/all-of-us/workbench/pull/3918#pullrequestreview-475629238", "createdAt": "2020-08-26T15:53:34Z", "commit": {"oid": "bc20ba2d8e4efe36a84d27a0318a5ce8a0f48f5f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNTo1MzozNFrOHHSs0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNTo1MzozNFrOHHSs0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQwODQ2Nw==", "bodyText": "Here ^.\nSubmit button click and verification were commented out due to captcha verification during initial implementation phase. Sometimes later, Neha added captchaSiteKey  so captcha verification always pass.\nhttps://developers.google.com/recaptcha/docs/faq#id-like-to-run-automated-tests-with-recaptcha.-what-should-i-do", "url": "https://github.com/all-of-us/workbench/pull/3918#discussion_r477408467", "createdAt": "2020-08-26T15:53:34Z", "author": {"login": "aweng98"}, "path": "e2e/tests/nightly/registration.spec.ts", "diffHunk": "@@ -28,24 +29,39 @@ describe('User registration tests:', () => {\n     await nextButton.clickWithEval();\n \n     // Step 3: Enter user information\n-    await createAccountPage.fillOutUserInformation();\n+    const userId = await createAccountPage.fillOutUserInformation();\n     nextButton = await createAccountPage.getNextButton();\n     await nextButton.waitUntilEnabled();\n     await nextButton.click();\n \n     // Step 4: Enter demographic survey (All Survey Fields are optional)\n     await createAccountPage.fillOutDemographicSurvey();\n \n-    // TODO uncomment after disable recaptcha", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc20ba2d8e4efe36a84d27a0318a5ce8a0f48f5f"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4346, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}