{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0OTE5MjQ4", "number": 3866, "title": "[RW-5369][risk=low] Up-gradle to 5.6.3", "bodyText": "Upgrade gradle to 5.6.3. I ran some migration tools to detect issues, and ran the dev server locally without issues. Surprisingly I only needed one change, which was to add a settings.gradle file.\nThis is a pre-requisite to using the openapi generator, which is a prerequisite to using the new Open API 3 Leo APIs. https://precisionmedicineinitiative.atlassian.net/browse/RW-4847", "createdAt": "2020-08-08T01:14:36Z", "url": "https://github.com/all-of-us/workbench/pull/3866", "merged": true, "mergeCommit": {"oid": "6db2f29c39f6fabbf2af8b212861c07070d53212"}, "closed": true, "closedAt": "2020-08-19T16:49:16Z", "author": {"login": "calbach"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9irCzgFqTQ2NDI1MTczNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdARBsIABqjM2Njg2NTM4NDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0MjUxNzM3", "url": "https://github.com/all-of-us/workbench/pull/3866#pullrequestreview-464251737", "createdAt": "2020-08-10T13:57:24Z", "commit": {"oid": "4e852ab0521cdb8beb24cc3cc9d1e1c478a463da"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzo1NzoyNFrOG-PsTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxMzo1Nzo0N1rOG-PtUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkyMTk5OA==", "bodyText": "If we don't support windows or cygwin, do we still need this file and the cygwin section above?", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r467921998", "createdAt": "2020-08-10T13:57:24Z", "author": {"login": "jaycarlton"}, "path": "api/gradlew.bat", "diffHunk": "@@ -1,3 +1,19 @@\n+@rem\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e852ab0521cdb8beb24cc3cc9d1e1c478a463da"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkyMjI1Ng==", "bodyText": "Interesting. Not where I would've expected these to go.", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r467922256", "createdAt": "2020-08-10T13:57:47Z", "author": {"login": "jaycarlton"}, "path": "api/gradlew.bat", "diffHunk": "@@ -14,7 +30,7 @@ set APP_BASE_NAME=%~n0\n set APP_HOME=%DIRNAME%\r\n \r\n @rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.\r\n-set DEFAULT_JVM_OPTS=\r\n+set DEFAULT_JVM_OPTS=\"-Xmx64m\" \"-Xms64m\"\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e852ab0521cdb8beb24cc3cc9d1e1c478a463da"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NjIxOTEw", "url": "https://github.com/all-of-us/workbench/pull/3866#pullrequestreview-464621910", "createdAt": "2020-08-10T22:09:08Z", "commit": {"oid": "4e852ab0521cdb8beb24cc3cc9d1e1c478a463da"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMjowOTowOFrOG-hf0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMjoxMjozOFrOG-hlMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODIxMzcxNA==", "bodyText": "This was autogenerated when I ran gradlew wrapper --version=5.6.3", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r468213714", "createdAt": "2020-08-10T22:09:08Z", "author": {"login": "calbach"}, "path": "api/gradlew.bat", "diffHunk": "@@ -14,7 +30,7 @@ set APP_BASE_NAME=%~n0\n set APP_HOME=%DIRNAME%\r\n \r\n @rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.\r\n-set DEFAULT_JVM_OPTS=\r\n+set DEFAULT_JVM_OPTS=\"-Xmx64m\" \"-Xms64m\"\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkyMjI1Ng=="}, "originalCommit": {"oid": "4e852ab0521cdb8beb24cc3cc9d1e1c478a463da"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODIxNTA5MQ==", "bodyText": "Hmm, I could see an argument to remove them - I don't feel strongly. These are all default files which get generated when you initialize the gradle wrapper. They'll probably get generated again when we upgrade to Gradle 6 as well, so the approach would probably be to .gitignore these.\nI'm not aware of anyone actively using Windows for this project, though I'd think it would be possible with some effort.\nLet me know if you prefer these gone, otherwise I'll probably keep the status quo for now.\nThere's a separate argument to avoid checking in the gradlew.jar at all, which I probably won't tackle here.", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r468215091", "createdAt": "2020-08-10T22:12:38Z", "author": {"login": "calbach"}, "path": "api/gradlew.bat", "diffHunk": "@@ -1,3 +1,19 @@\n+@rem\r", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkyMTk5OA=="}, "originalCommit": {"oid": "4e852ab0521cdb8beb24cc3cc9d1e1c478a463da"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0Njc3MjIy", "url": "https://github.com/all-of-us/workbench/pull/3866#pullrequestreview-464677222", "createdAt": "2020-08-11T00:45:23Z", "commit": {"oid": "8a6179b0ddbbf3ee68a9fa2eb5bf8603ff93413e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMDo0NToyM1rOG-kgIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwMDo0NToyM1rOG-kgIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI2Mjk0Nw==", "bodyText": "Please review this. It should resolve the errors I was seeing on Circle.", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r468262947", "createdAt": "2020-08-11T00:45:23Z", "author": {"login": "calbach"}, "path": "api/build.gradle", "diffHunk": "@@ -881,3 +881,25 @@ compileTestKotlin {\n     jvmTarget = \"1.8\"\n   }\n }\n+\n+// This is a hack to populate the (empty) output directory for the Kotlin", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a6179b0ddbbf3ee68a9fa2eb5bf8603ff93413e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MDIzODc5", "url": "https://github.com/all-of-us/workbench/pull/3866#pullrequestreview-465023879", "createdAt": "2020-08-11T12:40:00Z", "commit": {"oid": "8a6179b0ddbbf3ee68a9fa2eb5bf8603ff93413e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxMjo0MDowMFrOG-16Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxMjo0MDowMFrOG-16Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODU0ODEzOQ==", "bodyText": "Looks good. Will this fail if the directory is already there somehow? Does it need to be removed on  gradle clean?", "url": "https://github.com/all-of-us/workbench/pull/3866#discussion_r468548139", "createdAt": "2020-08-11T12:40:00Z", "author": {"login": "jaycarlton"}, "path": "api/build.gradle", "diffHunk": "@@ -881,3 +881,25 @@ compileTestKotlin {\n     jvmTarget = \"1.8\"\n   }\n }\n+\n+// This is a hack to populate the (empty) output directory for the Kotlin\n+// compileGenerated source set. This source set is devoid of Kotlin code - but\n+// there appears to be no way to opt out of the Kotlin plugin for a specific Java\n+// source set. Normally this task would create the output directory along with\n+// the output files, but in this case the task :compileGenerateKotlin is skipped\n+// due to a lack of input files, and the output directory is skipped as well as\n+// it seems the Kotlin plugin does not properly declare its outputs:\n+// https://youtrack.jetbrains.com/issue/KT-23807 .\n+//\n+// Without this workaround, compilation fails with:\n+// \"\"\"\n+// A problem was found with the configuration of task ':compileGeneratedJava'.\n+// > Directory '/usr/local/google/home/calbach/aou/workbench/api/build/classes/kotlin/generated'\n+//   specified for property 'compileGeneratedKotlinOutputClasses' does not exist.\n+// \"\"\"\n+task prepareKotlinGeneratedDir() {\n+  doLast {\n+    mkdir \"$projectDir/build/classes/kotlin/generated\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8a6179b0ddbbf3ee68a9fa2eb5bf8603ff93413e"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MDIzOTQ5", "url": "https://github.com/all-of-us/workbench/pull/3866#pullrequestreview-465023949", "createdAt": "2020-08-11T12:40:05Z", "commit": {"oid": "8a6179b0ddbbf3ee68a9fa2eb5bf8603ff93413e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "56ed9e0aebb5131694faca21f4ccd0ff3248e98b", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/56ed9e0aebb5131694faca21f4ccd0ff3248e98b", "committedDate": "2020-08-11T18:56:20Z", "message": "local var [skip ci]"}, "afterCommit": {"oid": "ccb0c3de20872072b52140e465b1b59d7dc59eb9", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/ccb0c3de20872072b52140e465b1b59d7dc59eb9", "committedDate": "2020-08-11T19:01:44Z", "message": "Declare the output directory gradle config step picks it up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf1145f92bd06dac8a0e144643f2e2a209ea71a1", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/bf1145f92bd06dac8a0e144643f2e2a209ea71a1", "committedDate": "2020-08-19T00:25:07Z", "message": "5.0 ... working?"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bccad3b2ce41fad82ce49f3d83b2ea412816e4e2", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/bccad3b2ce41fad82ce49f3d83b2ea412816e4e2", "committedDate": "2020-08-19T00:25:07Z", "message": "Bump to 5.6.3, retag"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1b9fb9ee580a08fd60cc501ba36f39fceea767a", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/b1b9fb9ee580a08fd60cc501ba36f39fceea767a", "committedDate": "2020-08-19T00:25:07Z", "message": "Fix generated Kotlin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "037317d3926b9a8d6002eb1fc4d7669566c57260", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/037317d3926b9a8d6002eb1fc4d7669566c57260", "committedDate": "2020-08-19T00:25:08Z", "message": "Kill gradlew.bat"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f38481683640744fc4515ffb9467cd49300e0732", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/f38481683640744fc4515ffb9467cd49300e0732", "committedDate": "2020-08-19T00:25:08Z", "message": "Try invalidating the gradle cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca538f00b9fb48051c7475fa65133be75a447489", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/ca538f00b9fb48051c7475fa65133be75a447489", "committedDate": "2020-08-19T00:25:08Z", "message": "Declare the output directory gradle config step picks it up"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c7988f70b7dbfa6aaadbdb87d5f311b37567000", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/8c7988f70b7dbfa6aaadbdb87d5f311b37567000", "committedDate": "2020-08-19T00:25:08Z", "message": "drop mem settings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c8079f409d75fd2a870cadadaa0f60acb19385c", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/0c8079f409d75fd2a870cadadaa0f60acb19385c", "committedDate": "2020-08-19T01:07:20Z", "message": "bump test heap size"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9fb59f38efa4a07f9e9795b049c294865a9b85e0", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/9fb59f38efa4a07f9e9795b049c294865a9b85e0", "committedDate": "2020-08-12T00:31:48Z", "message": "drop mem settings"}, "afterCommit": {"oid": "0c8079f409d75fd2a870cadadaa0f60acb19385c", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/0c8079f409d75fd2a870cadadaa0f60acb19385c", "committedDate": "2020-08-19T01:07:20Z", "message": "bump test heap size"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4549, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}