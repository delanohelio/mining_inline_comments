{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwMDQ2NTk1", "number": 2977, "title": "[RW-4163][Risk=low] Add new fields to demographics survey", "bodyText": "Description:\nThis adds a few new fields to the account creation forms, leaving the styling mostly untouched. It also changes a few variable names to be more in line with camelCase, and alphabetizes a few things\n\nPR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-01-07T15:39:11Z", "url": "https://github.com/all-of-us/workbench/pull/2977", "merged": true, "mergeCommit": {"oid": "5431054c60826da38e7190c26e5d03ee6513be21"}, "closed": true, "closedAt": "2020-01-09T16:59:34Z", "author": {"login": "s-rubenstein"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4ChyOAH2gAyMzYwMDQ2NTk1OmZjZjhkNjZiNTBlZmViYWRlZjkzZjdjMWFiOWU3NDdlYTU4YTAxYjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4sTQwgH2gAyMzYwMDQ2NTk1OmVhNjU5YzU3NTliODU2M2YwNjYwZGYwZDc0NGMyODI4MzNjY2EzZjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fcf8d66b50efebadef93f7c1ab9e747ea58a01b5", "author": {"user": {"login": "s-rubenstein", "name": "Sky Rubenstein"}}, "url": "https://github.com/all-of-us/workbench/commit/fcf8d66b50efebadef93f7c1ab9e747ea58a01b5", "committedDate": "2020-01-07T15:31:24Z", "message": "Add new fields to demographics survey"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de2f463e66d4041595e38972ea962a90a7e1e5f7", "author": {"user": {"login": "s-rubenstein", "name": "Sky Rubenstein"}}, "url": "https://github.com/all-of-us/workbench/commit/de2f463e66d4041595e38972ea962a90a7e1e5f7", "committedDate": "2020-01-07T15:36:02Z", "message": "Fix some stylistic things"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abeee3097a91fd7bf626f921e058c2396a6921b6", "author": {"user": {"login": "s-rubenstein", "name": "Sky Rubenstein"}}, "url": "https://github.com/all-of-us/workbench/commit/abeee3097a91fd7bf626f921e058c2396a6921b6", "committedDate": "2020-01-07T15:41:53Z", "message": "Fix test compilation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMDE5MDk3", "url": "https://github.com/all-of-us/workbench/pull/2977#pullrequestreview-340019097", "createdAt": "2020-01-08T17:19:46Z", "commit": {"oid": "abeee3097a91fd7bf626f921e058c2396a6921b6"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxNzo0NDoyNlrOFbesNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOFQxODoxNjowOVrOFbfgmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM1ODcxMQ==", "bodyText": "why reorder these?  I would expect the order to match the accessors below", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364358711", "createdAt": "2020-01-08T17:44:26Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/db/model/DbDemographicSurvey.java", "diffHunk": "@@ -19,18 +19,22 @@\n import org.pmiops.workbench.model.Ethnicity;\n import org.pmiops.workbench.model.Gender;\n import org.pmiops.workbench.model.Race;\n+import org.pmiops.workbench.model.SexAtBirth;\n+import org.pmiops.workbench.model.SexualOrientation;\n \n @Entity\n @Table(name = \"demographic_survey\")\n public class DbDemographicSurvey {\n-  private long id;\n-  private List<Short> race;\n+  private Short disability;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abeee3097a91fd7bf626f921e058c2396a6921b6"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM1OTExMg==", "bodyText": "Can replace with .map(DemographicSurveyEnum::sexualOrientationFromStorage)", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364359112", "createdAt": "2020-01-08T17:45:23Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/db/model/DbDemographicSurvey.java", "diffHunk": "@@ -94,6 +98,74 @@ public void setRaceEnum(List<Race> raceList) {\n             .collect(Collectors.toList());\n   }\n \n+  @ElementCollection(fetch = FetchType.LAZY)\n+  @CollectionTable(\n+      name = \"demographic_survey_sexual_orientation\",\n+      joinColumns = @JoinColumn(name = \"demographic_survey_id\"))\n+  @Column(name = \"sexual_orientation\")\n+  public List<Short> getSexualOrientation() {\n+    return sexualOrientation;\n+  }\n+\n+  public void setSexualOrientation(List<Short> sexualOrientation) {\n+    this.sexualOrientation = sexualOrientation;\n+  }\n+\n+  @Transient\n+  public List<SexualOrientation> getSexualOrientationEnum() {\n+    if (sexualOrientation == null) return null;\n+    return this.sexualOrientation.stream()\n+        .map(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abeee3097a91fd7bf626f921e058c2396a6921b6"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM1OTI2Mg==", "bodyText": "Can replace with .map(DemographicSurveyEnum::sexualOrientationToStorage)", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364359262", "createdAt": "2020-01-08T17:45:41Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/db/model/DbDemographicSurvey.java", "diffHunk": "@@ -94,6 +98,74 @@ public void setRaceEnum(List<Race> raceList) {\n             .collect(Collectors.toList());\n   }\n \n+  @ElementCollection(fetch = FetchType.LAZY)\n+  @CollectionTable(\n+      name = \"demographic_survey_sexual_orientation\",\n+      joinColumns = @JoinColumn(name = \"demographic_survey_id\"))\n+  @Column(name = \"sexual_orientation\")\n+  public List<Short> getSexualOrientation() {\n+    return sexualOrientation;\n+  }\n+\n+  public void setSexualOrientation(List<Short> sexualOrientation) {\n+    this.sexualOrientation = sexualOrientation;\n+  }\n+\n+  @Transient\n+  public List<SexualOrientation> getSexualOrientationEnum() {\n+    if (sexualOrientation == null) return null;\n+    return this.sexualOrientation.stream()\n+        .map(\n+            (sexualOrientationObject) -> {\n+              return DemographicSurveyEnum.sexualOrientationFromStorage(sexualOrientationObject);\n+            })\n+        .collect(Collectors.toList());\n+  }\n+\n+  public void setSexualOrientationEnum(List<SexualOrientation> sexualOrientationList) {\n+    this.sexualOrientation =\n+        sexualOrientationList.stream()\n+            .map(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abeee3097a91fd7bf626f921e058c2396a6921b6"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM2MjEwNg==", "bodyText": "same comments for sexAtBirth", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364362106", "createdAt": "2020-01-08T17:52:16Z", "author": {"login": "jmthibault79"}, "path": "api/src/main/java/org/pmiops/workbench/db/model/DbDemographicSurvey.java", "diffHunk": "@@ -94,6 +98,74 @@ public void setRaceEnum(List<Race> raceList) {\n             .collect(Collectors.toList());\n   }\n \n+  @ElementCollection(fetch = FetchType.LAZY)\n+  @CollectionTable(\n+      name = \"demographic_survey_sexual_orientation\",\n+      joinColumns = @JoinColumn(name = \"demographic_survey_id\"))\n+  @Column(name = \"sexual_orientation\")\n+  public List<Short> getSexualOrientation() {\n+    return sexualOrientation;\n+  }\n+\n+  public void setSexualOrientation(List<Short> sexualOrientation) {\n+    this.sexualOrientation = sexualOrientation;\n+  }\n+\n+  @Transient\n+  public List<SexualOrientation> getSexualOrientationEnum() {\n+    if (sexualOrientation == null) return null;\n+    return this.sexualOrientation.stream()\n+        .map(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM1OTExMg=="}, "originalCommit": {"oid": "abeee3097a91fd7bf626f921e058c2396a6921b6"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDM3MjEyMw==", "bodyText": "Do we want to update this to Gender Identity ?", "url": "https://github.com/all-of-us/workbench/pull/2977#discussion_r364372123", "createdAt": "2020-01-08T18:16:09Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/login/account-creation/account-creation-survey.tsx", "diffHunk": "@@ -143,37 +147,59 @@ export class AccountCreationSurvey extends React.Component<AccountCreationSurvey\n       </Section>\n \n       {/*Ethnicity section*/}\n-      <DropDownSection header='2. Ethnicity' options={AccountCreationOptions.Ethnicity}\n+      <DropDownSection header='2. Ethnicity' options={AccountCreationOptions.ethnicity}\n                        value={demographicSurvey.ethnicity}\n                        onChange={(e) => this.updateDemographicAttribute('ethnicity', e)}/>\n \n       {/*Gender section*/}\n       <Section header='3. Gender'>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "abeee3097a91fd7bf626f921e058c2396a6921b6"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc2c78ee790899523a643c277cb1c9aa7e1e3f19", "author": {"user": {"login": "s-rubenstein", "name": "Sky Rubenstein"}}, "url": "https://github.com/all-of-us/workbench/commit/cc2c78ee790899523a643c277cb1c9aa7e1e3f19", "committedDate": "2020-01-08T22:33:53Z", "message": "PR feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea659c5759b8563f0660df0d744c282833cca3f2", "author": {"user": {"login": "s-rubenstein", "name": "Sky Rubenstein"}}, "url": "https://github.com/all-of-us/workbench/commit/ea659c5759b8563f0660df0d744c282833cca3f2", "committedDate": "2020-01-09T16:11:33Z", "message": "Fix linting"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3824, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}