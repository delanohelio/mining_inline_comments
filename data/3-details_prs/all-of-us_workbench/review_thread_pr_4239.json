{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0MjE5ODY3", "number": 4239, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDo0NTowOVrOE0izrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMzo1Nzo0NlrOE1cOCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNTMxNjkyOnYy", "diffSide": "RIGHT", "path": "e2e/tests/cohorts/cohorts-create.spec.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDo0NTowOVrOHsVA4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDo1NTo1OVrOHsVVSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MzY4MA==", "bodyText": "skipped most tests for testing quicker. Changes will be reverted back before merge.", "url": "https://github.com/all-of-us/workbench/pull/4239#discussion_r516243680", "createdAt": "2020-11-02T20:45:09Z", "author": {"login": "aweng98"}, "path": "e2e/tests/cohorts/cohorts-create.spec.ts", "diffHunk": "@@ -11,7 +11,7 @@ import {findOrCreateWorkspace, signIn} from 'utils/test-utils';\n import {waitForText, waitWhileLoading} from 'utils/waits-utils';\n \n \n-describe('User can create new Cohorts', () => {\n+describe.skip('User can create new Cohorts', () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70a52fd9feb0a5b3e0427e747af6a0058367b26f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0ODkwNA==", "bodyText": "FYI: ftest or fdescribe I believe should work here, i.e. \"focus\" this test and skip the others - probably a lot easier than skipping all", "url": "https://github.com/all-of-us/workbench/pull/4239#discussion_r516248904", "createdAt": "2020-11-02T20:55:59Z", "author": {"login": "calbach"}, "path": "e2e/tests/cohorts/cohorts-create.spec.ts", "diffHunk": "@@ -11,7 +11,7 @@ import {findOrCreateWorkspace, signIn} from 'utils/test-utils';\n import {waitForText, waitWhileLoading} from 'utils/waits-utils';\n \n \n-describe('User can create new Cohorts', () => {\n+describe.skip('User can create new Cohorts', () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0MzY4MA=="}, "originalCommit": {"oid": "70a52fd9feb0a5b3e0427e747af6a0058367b26f"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNTM1MzI3OnYy", "diffSide": "RIGHT", "path": ".circleci/config.yml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMDo1Njo0MFrOHsVWuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNToxMToxOFrOHszStA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0OTI3Mg==", "bodyText": "nit: please line wrap", "url": "https://github.com/all-of-us/workbench/pull/4239#discussion_r516249272", "createdAt": "2020-11-02T20:56:40Z", "author": {"login": "calbach"}, "path": ".circleci/config.yml", "diffHunk": "@@ -301,6 +301,16 @@ commands:\n             circleci tests glob \"tests/**/*.spec.ts\" | circleci tests split --split-by=timings > /tmp/tests-to-run\n             yarn test:ci $(cat /tmp/tests-to-run)\n           no_output_timeout: 15m\n+      - run:\n+          name: Create circleci_parameters.json\n+          working_directory: ~/workbench/e2e\n+          command: |\n+            echo \"{ \\\"circleBranch\\\": \\\"${CIRCLE_BRANCH}\\\", \\\"circleJob\\\": \\\"${CIRCLE_JOB}\\\", \\\"circleBuild\\\": \\\"${CIRCLE_BUILD_NUM}\\\", \\\"circleBuildUrl\\\": \\\"${CIRCLE_BUILD_URL}\\\", \\\"circleNodeIndex\\\": \\\"${CIRCLE_NODE_INDEX}\\\" }\" \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3310868e53c2aa7ef527e0f159dc990eb7a2214c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjczOTc2NA==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/4239#discussion_r516739764", "createdAt": "2020-11-03T15:11:18Z", "author": {"login": "aweng98"}, "path": ".circleci/config.yml", "diffHunk": "@@ -301,6 +301,16 @@ commands:\n             circleci tests glob \"tests/**/*.spec.ts\" | circleci tests split --split-by=timings > /tmp/tests-to-run\n             yarn test:ci $(cat /tmp/tests-to-run)\n           no_output_timeout: 15m\n+      - run:\n+          name: Create circleci_parameters.json\n+          working_directory: ~/workbench/e2e\n+          command: |\n+            echo \"{ \\\"circleBranch\\\": \\\"${CIRCLE_BRANCH}\\\", \\\"circleJob\\\": \\\"${CIRCLE_JOB}\\\", \\\"circleBuild\\\": \\\"${CIRCLE_BUILD_NUM}\\\", \\\"circleBuildUrl\\\": \\\"${CIRCLE_BUILD_URL}\\\", \\\"circleNodeIndex\\\": \\\"${CIRCLE_NODE_INDEX}\\\" }\" \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI0OTI3Mg=="}, "originalCommit": {"oid": "3310868e53c2aa7ef527e0f159dc990eb7a2214c"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNTQ4MzQ5OnYy", "diffSide": "RIGHT", "path": ".circleci/config.yml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMTozOTowMlrOHsWlnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxNToxMjoxOFrOHszVig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI2OTQ3MQ==", "bodyText": "nit: I would not re-encode the file names here in the description, e.g. \"Add CircleCI job data to Junit test results\".", "url": "https://github.com/all-of-us/workbench/pull/4239#discussion_r516269471", "createdAt": "2020-11-02T21:39:02Z", "author": {"login": "calbach"}, "path": ".circleci/config.yml", "diffHunk": "@@ -301,6 +301,16 @@ commands:\n             circleci tests glob \"tests/**/*.spec.ts\" | circleci tests split --split-by=timings > /tmp/tests-to-run\n             yarn test:ci $(cat /tmp/tests-to-run)\n           no_output_timeout: 15m\n+      - run:\n+          name: Create circleci_parameters.json\n+          working_directory: ~/workbench/e2e\n+          command: |\n+            echo \"{ \\\"circleBranch\\\": \\\"${CIRCLE_BRANCH}\\\", \\\"circleJob\\\": \\\"${CIRCLE_JOB}\\\", \\\"circleBuild\\\": \\\"${CIRCLE_BUILD_NUM}\\\", \\\"circleBuildUrl\\\": \\\"${CIRCLE_BUILD_URL}\\\", \\\"circleNodeIndex\\\": \\\"${CIRCLE_NODE_INDEX}\\\" }\" \\\n+              > ./logs/circleci_parameters.json\n+      - run:\n+          name: Combine circleci_parameters.json and test-results.json", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3310868e53c2aa7ef527e0f159dc990eb7a2214c"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjc0MDQ5MA==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/4239#discussion_r516740490", "createdAt": "2020-11-03T15:12:18Z", "author": {"login": "aweng98"}, "path": ".circleci/config.yml", "diffHunk": "@@ -301,6 +301,16 @@ commands:\n             circleci tests glob \"tests/**/*.spec.ts\" | circleci tests split --split-by=timings > /tmp/tests-to-run\n             yarn test:ci $(cat /tmp/tests-to-run)\n           no_output_timeout: 15m\n+      - run:\n+          name: Create circleci_parameters.json\n+          working_directory: ~/workbench/e2e\n+          command: |\n+            echo \"{ \\\"circleBranch\\\": \\\"${CIRCLE_BRANCH}\\\", \\\"circleJob\\\": \\\"${CIRCLE_JOB}\\\", \\\"circleBuild\\\": \\\"${CIRCLE_BUILD_NUM}\\\", \\\"circleBuildUrl\\\": \\\"${CIRCLE_BUILD_URL}\\\", \\\"circleNodeIndex\\\": \\\"${CIRCLE_NODE_INDEX}\\\" }\" \\\n+              > ./logs/circleci_parameters.json\n+      - run:\n+          name: Combine circleci_parameters.json and test-results.json", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI2OTQ3MQ=="}, "originalCommit": {"oid": "3310868e53c2aa7ef527e0f159dc990eb7a2214c"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NDcyMDIzOnYy", "diffSide": "RIGHT", "path": ".circleci/config.yml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMzo1NjoxMlrOHtt9JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMzo1NjoxMlrOHtt9JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzcwMDkwMA==", "bodyText": "Why? If you really need to do this, can you just pass the \"-c\" flag to fq instead?", "url": "https://github.com/all-of-us/workbench/pull/4239#discussion_r517700900", "createdAt": "2020-11-04T23:56:12Z", "author": {"login": "calbach"}, "path": ".circleci/config.yml", "diffHunk": "@@ -300,6 +301,33 @@ commands:\n             circleci tests glob \"tests/**/*.spec.ts\" | circleci tests split --split-by=timings > /tmp/tests-to-run\n             yarn test:ci $(cat /tmp/tests-to-run)\n           no_output_timeout: 15m\n+      - run:\n+          name: Create circleci_parameters.json\n+          working_directory: ~/workbench/e2e\n+          command: |\n+            echo \"{ \\\n+              \\\"circleBranch\\\": \\\"${CIRCLE_BRANCH}\\\", \\\n+              \\\"circleJob\\\": \\\"${CIRCLE_JOB}\\\", \\\n+              \\\"circleBuild\\\": \\\"${CIRCLE_BUILD_NUM}\\\", \\\n+              \\\"circleBuildUrl\\\": \\\"${CIRCLE_BUILD_URL}\\\", \\\n+              \\\"circleNodeIndex\\\": \\\"${CIRCLE_NODE_INDEX}\\\" \\\n+              }\" \\\n+              > ./logs/circleci_parameters.json\n+          when: always\n+      - run:\n+          name: Add CircleCI job data to test results json before upload json to storage bucket\n+          working_directory: ~/workbench/e2e/logs\n+          command: |\n+            NEW_JSON=circleci-build-${CIRCLE_BUILD_NUM}-${CIRCLE_NODE_INDEX}-test-results.json\n+            jq -s '.[0] * .[1]' test-results.json circleci_parameters.json > ${NEW_JSON}\n+            # Remove all whitespaces", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d33c6c323b10d2ab6f998fca2856abc60b1ffb0"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NDcyMzI4OnYy", "diffSide": "RIGHT", "path": ".circleci/config.yml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMzo1Nzo0NlrOHtt_Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxODoyODozOVrOHuQyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzcwMTM5NQ==", "bodyText": "This has implicit side-effects on other gcloud commands, in general I recommend avoiding setting this in most cases. This line also should not be necessary at all for running the following gsutil command. I would remove it and the project name.\nIf you still have problems after this, please let me know, but you can instead pass an explicit project ID flag to gsutil.", "url": "https://github.com/all-of-us/workbench/pull/4239#discussion_r517701395", "createdAt": "2020-11-04T23:57:46Z", "author": {"login": "calbach"}, "path": ".circleci/config.yml", "diffHunk": "@@ -300,6 +301,33 @@ commands:\n             circleci tests glob \"tests/**/*.spec.ts\" | circleci tests split --split-by=timings > /tmp/tests-to-run\n             yarn test:ci $(cat /tmp/tests-to-run)\n           no_output_timeout: 15m\n+      - run:\n+          name: Create circleci_parameters.json\n+          working_directory: ~/workbench/e2e\n+          command: |\n+            echo \"{ \\\n+              \\\"circleBranch\\\": \\\"${CIRCLE_BRANCH}\\\", \\\n+              \\\"circleJob\\\": \\\"${CIRCLE_JOB}\\\", \\\n+              \\\"circleBuild\\\": \\\"${CIRCLE_BUILD_NUM}\\\", \\\n+              \\\"circleBuildUrl\\\": \\\"${CIRCLE_BUILD_URL}\\\", \\\n+              \\\"circleNodeIndex\\\": \\\"${CIRCLE_NODE_INDEX}\\\" \\\n+              }\" \\\n+              > ./logs/circleci_parameters.json\n+          when: always\n+      - run:\n+          name: Add CircleCI job data to test results json before upload json to storage bucket\n+          working_directory: ~/workbench/e2e/logs\n+          command: |\n+            NEW_JSON=circleci-build-${CIRCLE_BUILD_NUM}-${CIRCLE_NODE_INDEX}-test-results.json\n+            jq -s '.[0] * .[1]' test-results.json circleci_parameters.json > ${NEW_JSON}\n+            # Remove all whitespaces\n+            cat ${NEW_JSON} | tr '\\n' ' ' > tmp.json && mv tmp.json ${NEW_JSON}\n+            # Upload json to storage bucket\n+            PROJECT_NAME=all-of-us-workbench-test\n+            STORAGE_BUCKET=gs://circleci-puppeteer-test-results\n+            gcloud config set project ${PROJECT_NAME}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d33c6c323b10d2ab6f998fca2856abc60b1ffb0"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI3MTU0NQ==", "bodyText": "\ud83d\udc4d\nAddressing latest feedback: Use jq -c, and gsuite cp works after removing set project. Thank you CH.", "url": "https://github.com/all-of-us/workbench/pull/4239#discussion_r518271545", "createdAt": "2020-11-05T18:28:39Z", "author": {"login": "aweng98"}, "path": ".circleci/config.yml", "diffHunk": "@@ -300,6 +301,33 @@ commands:\n             circleci tests glob \"tests/**/*.spec.ts\" | circleci tests split --split-by=timings > /tmp/tests-to-run\n             yarn test:ci $(cat /tmp/tests-to-run)\n           no_output_timeout: 15m\n+      - run:\n+          name: Create circleci_parameters.json\n+          working_directory: ~/workbench/e2e\n+          command: |\n+            echo \"{ \\\n+              \\\"circleBranch\\\": \\\"${CIRCLE_BRANCH}\\\", \\\n+              \\\"circleJob\\\": \\\"${CIRCLE_JOB}\\\", \\\n+              \\\"circleBuild\\\": \\\"${CIRCLE_BUILD_NUM}\\\", \\\n+              \\\"circleBuildUrl\\\": \\\"${CIRCLE_BUILD_URL}\\\", \\\n+              \\\"circleNodeIndex\\\": \\\"${CIRCLE_NODE_INDEX}\\\" \\\n+              }\" \\\n+              > ./logs/circleci_parameters.json\n+          when: always\n+      - run:\n+          name: Add CircleCI job data to test results json before upload json to storage bucket\n+          working_directory: ~/workbench/e2e/logs\n+          command: |\n+            NEW_JSON=circleci-build-${CIRCLE_BUILD_NUM}-${CIRCLE_NODE_INDEX}-test-results.json\n+            jq -s '.[0] * .[1]' test-results.json circleci_parameters.json > ${NEW_JSON}\n+            # Remove all whitespaces\n+            cat ${NEW_JSON} | tr '\\n' ' ' > tmp.json && mv tmp.json ${NEW_JSON}\n+            # Upload json to storage bucket\n+            PROJECT_NAME=all-of-us-workbench-test\n+            STORAGE_BUCKET=gs://circleci-puppeteer-test-results\n+            gcloud config set project ${PROJECT_NAME}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzcwMTM5NQ=="}, "originalCommit": {"oid": "9d33c6c323b10d2ab6f998fca2856abc60b1ffb0"}, "originalPosition": 36}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3694, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}