{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwNTU2NzUy", "number": 4341, "title": "[RW-5922][risk=no] GetRuntime: remember which preset was chosen for deleted runtimes", "bodyText": "Description:\nChanges\n\nReturn most recent runtime if it has any valid all-of-us-config label\nIn the above case, ignore values from getRuntime and use preset values in...\n\ncreate workflow\ncustomize workflow\n\n\n\nThe presets for Hail were modified to the values shown for the purposes of this demo\n\n\nPR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n I have run the E2E tests on ths change against my local UI + API server with yarn test-local\n If this includes a UI change, I have taken screen recordings or screenshots of the new behavior and notified the PO and UX designer\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-12-01T20:29:48Z", "url": "https://github.com/all-of-us/workbench/pull/4341", "merged": true, "mergeCommit": {"oid": "1aca1b4cff554b88d2f9b03680cf048d2f1bf9f6"}, "closed": true, "closedAt": "2020-12-02T16:10:26Z", "author": {"login": "ericsong"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdhpqKnAH2gAyNTMwNTU2NzUyOmQ5MDEyZTU2MWU5NTFlMWIwMzExNDFjNTY4MDgyMTdhMWJiYjZjNTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiQkDJgH2gAyNTMwNTU2NzUyOmYzMzgyZTY1OGFiMDRmZjVjOTA2ZTljNzgxZTU3MzQ0MmM4ZTcwNzg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d9012e561e951e1b031141c56808217a1bbb6c54", "author": {"user": {"login": "ericsong", "name": "Eric Song"}}, "url": "https://github.com/all-of-us/workbench/commit/d9012e561e951e1b031141c56808217a1bbb6c54", "committedDate": "2020-11-30T18:28:54Z", "message": "add test and impl for returning presets in getRuntime"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "755f192e012dbd5337e2692baf646c7d341bcb47", "author": {"user": {"login": "ericsong", "name": "Eric Song"}}, "url": "https://github.com/all-of-us/workbench/commit/755f192e012dbd5337e2692baf646c7d341bcb47", "committedDate": "2020-12-01T18:22:02Z", "message": "add tests and impl for overriding getRuntime values with presets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e1cd381575e876223111be006f1fda8aec190d1", "author": {"user": {"login": "ericsong", "name": "Eric Song"}}, "url": "https://github.com/all-of-us/workbench/commit/6e1cd381575e876223111be006f1fda8aec190d1", "committedDate": "2020-12-01T20:12:20Z", "message": "refactor. remove usage of preset object in create panel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49", "author": {"user": {"login": "ericsong", "name": "Eric Song"}}, "url": "https://github.com/all-of-us/workbench/commit/fae55a3920ac164a6ff8d697101e0199e6f45f49", "committedDate": "2020-12-01T20:22:41Z", "message": "additional tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df1874b3ad8172b7ef63102b6591d474c6cfe075", "author": {"user": {"login": "ericsong", "name": "Eric Song"}}, "url": "https://github.com/all-of-us/workbench/commit/df1874b3ad8172b7ef63102b6591d474c6cfe075", "committedDate": "2020-12-01T20:32:28Z", "message": "lint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3f8ba682b5658502b59a3bb543acdf6380236f1", "author": {"user": {"login": "ericsong", "name": "Eric Song"}}, "url": "https://github.com/all-of-us/workbench/commit/b3f8ba682b5658502b59a3bb543acdf6380236f1", "committedDate": "2020-12-01T20:50:11Z", "message": "accidentally changed test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMjc3MzU4", "url": "https://github.com/all-of-us/workbench/pull/4341#pullrequestreview-542277358", "createdAt": "2020-12-01T20:39:29Z", "commit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "state": "COMMENTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMDozOToyOVrOH8-31Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMDo1NTozNVrOH8_aZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwNjcwOQ==", "bodyText": "nit: can write this as just gceConfig,", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533706709", "createdAt": "2020-12-01T20:39:29Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.spec.tsx", "diffHunk": "@@ -159,6 +159,55 @@ describe('RuntimePanel', () => {\n     expect(runtimeApiStub.runtime.gceConfig.machineType).toEqual('n1-standard-4');\n   });\n \n+  it('should create runtime with preset values instead of getRuntime values if configurationType is GeneralAnalysis', async() => {\n+    const gceConfig = defaultGceConfig();\n+    gceConfig.machineType = 'n1-standard-16';\n+    gceConfig.diskSize = 1000;\n+    const runtime = {...runtimeApiStub.runtime,\n+      status: RuntimeStatus.Deleted,\n+      configurationType: RuntimeConfigurationType.GeneralAnalysis,\n+      gceConfig: gceConfig,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwNzQxNQ==", "bodyText": "opt: imo maybe slightly more readable as:\n{\n  ...defaultGceConfig(),\n  machineType: ...,\n  diskSize: ...\n\nAlso, if you take this suggestion, you may not need the gceConfig variable either, can inline the whole thing below", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533707415", "createdAt": "2020-12-01T20:40:46Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.spec.tsx", "diffHunk": "@@ -159,6 +159,55 @@ describe('RuntimePanel', () => {\n     expect(runtimeApiStub.runtime.gceConfig.machineType).toEqual('n1-standard-4');\n   });\n \n+  it('should create runtime with preset values instead of getRuntime values if configurationType is GeneralAnalysis', async() => {\n+    const gceConfig = defaultGceConfig();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwODM2OQ==", "bodyText": "nit: determined we didn't act here and dropped from other cases, probably remove here too for consistency.\nSpecifically, it's only needed after we render a React component.", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533708369", "createdAt": "2020-12-01T20:42:30Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.spec.tsx", "diffHunk": "@@ -159,6 +159,55 @@ describe('RuntimePanel', () => {\n     expect(runtimeApiStub.runtime.gceConfig.machineType).toEqual('n1-standard-4');\n   });\n \n+  it('should create runtime with preset values instead of getRuntime values if configurationType is GeneralAnalysis', async() => {\n+    const gceConfig = defaultGceConfig();\n+    gceConfig.machineType = 'n1-standard-16';\n+    gceConfig.diskSize = 1000;\n+    const runtime = {...runtimeApiStub.runtime,\n+      status: RuntimeStatus.Deleted,\n+      configurationType: RuntimeConfigurationType.GeneralAnalysis,\n+      gceConfig: gceConfig,\n+      dataprocConfig: null\n+    };\n+    runtimeApiStub.runtime = runtime;\n+    act(() => { runtimeStore.set({runtime: runtime, workspaceNamespace: workspaceStubs[0].namespace}); });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcwODQ4NA==", "bodyText": "opt: same comment as above", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533708484", "createdAt": "2020-12-01T20:42:45Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.spec.tsx", "diffHunk": "@@ -159,6 +159,55 @@ describe('RuntimePanel', () => {\n     expect(runtimeApiStub.runtime.gceConfig.machineType).toEqual('n1-standard-4');\n   });\n \n+  it('should create runtime with preset values instead of getRuntime values if configurationType is GeneralAnalysis', async() => {\n+    const gceConfig = defaultGceConfig();\n+    gceConfig.machineType = 'n1-standard-16';\n+    gceConfig.diskSize = 1000;\n+    const runtime = {...runtimeApiStub.runtime,\n+      status: RuntimeStatus.Deleted,\n+      configurationType: RuntimeConfigurationType.GeneralAnalysis,\n+      gceConfig: gceConfig,\n+      dataprocConfig: null\n+    };\n+    runtimeApiStub.runtime = runtime;\n+    act(() => { runtimeStore.set({runtime: runtime, workspaceNamespace: workspaceStubs[0].namespace}); });\n+\n+    const wrapper = await component();\n+\n+    await mustClickButton(wrapper, 'Create');\n+\n+    expect(runtimeApiStub.runtime.status).toEqual('Creating');\n+    expect(runtimeApiStub.runtime.gceConfig.machineType).toEqual(runtimePresets.generalAnalysis.runtimeTemplate.gceConfig.machineType);\n+    expect(runtimeApiStub.runtime.gceConfig.diskSize).toEqual(runtimePresets.generalAnalysis.runtimeTemplate.gceConfig.diskSize);\n+  });\n+\n+  it('should create runtime with preset values instead of getRuntime values if configurationType is HailGenomicsAnalysis', async() => {\n+    const dataprocConfig = defaultDataprocConfig();\n+    dataprocConfig.masterMachineType = 'n1-standard-16';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcxMDczMQ==", "bodyText": "opt: this is a bit verbose, consider using an approach like this to do a partial comparison: \n  \n    \n      workbench/ui/src/app/pages/analysis/runtime-panel.tsx\n    \n    \n        Lines 150 to 154\n      in\n      a6e7985\n    \n    \n    \n    \n\n        \n          \n           const strip = fp.flow( \n        \n\n        \n          \n             // In the future, things like toolDockerImage and autopause may be considerations. \n        \n\n        \n          \n             fp.pick(['gceConfig', 'dataprocConfig']), \n        \n\n        \n          \n             // numberOfWorkerLocalSSDs is currently part of the API spec, but is not used by the panel. \n        \n\n        \n          \n             fp.omit(['dataprocConfig.numberOfWorkerLocalSSDs'])); \n        \n    \n  \n\n\nThere may be a better way, but I haven't seen any dedicated test utils for doing so.", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533710731", "createdAt": "2020-12-01T20:46:45Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.spec.tsx", "diffHunk": "@@ -159,6 +159,55 @@ describe('RuntimePanel', () => {\n     expect(runtimeApiStub.runtime.gceConfig.machineType).toEqual('n1-standard-4');\n   });\n \n+  it('should create runtime with preset values instead of getRuntime values if configurationType is GeneralAnalysis', async() => {\n+    const gceConfig = defaultGceConfig();\n+    gceConfig.machineType = 'n1-standard-16';\n+    gceConfig.diskSize = 1000;\n+    const runtime = {...runtimeApiStub.runtime,\n+      status: RuntimeStatus.Deleted,\n+      configurationType: RuntimeConfigurationType.GeneralAnalysis,\n+      gceConfig: gceConfig,\n+      dataprocConfig: null\n+    };\n+    runtimeApiStub.runtime = runtime;\n+    act(() => { runtimeStore.set({runtime: runtime, workspaceNamespace: workspaceStubs[0].namespace}); });\n+\n+    const wrapper = await component();\n+\n+    await mustClickButton(wrapper, 'Create');\n+\n+    expect(runtimeApiStub.runtime.status).toEqual('Creating');\n+    expect(runtimeApiStub.runtime.gceConfig.machineType).toEqual(runtimePresets.generalAnalysis.runtimeTemplate.gceConfig.machineType);\n+    expect(runtimeApiStub.runtime.gceConfig.diskSize).toEqual(runtimePresets.generalAnalysis.runtimeTemplate.gceConfig.diskSize);\n+  });\n+\n+  it('should create runtime with preset values instead of getRuntime values if configurationType is HailGenomicsAnalysis', async() => {\n+    const dataprocConfig = defaultDataprocConfig();\n+    dataprocConfig.masterMachineType = 'n1-standard-16';\n+    dataprocConfig.masterDiskSize = 999;\n+    dataprocConfig.workerDiskSize = 444;\n+    dataprocConfig.numberOfWorkers = 5;\n+\n+    const runtime = {...runtimeApiStub.runtime,\n+      status: RuntimeStatus.Deleted,\n+      configurationType: RuntimeConfigurationType.HailGenomicAnalysis,\n+      gceConfig: null,\n+      dataprocConfig: dataprocConfig\n+    };\n+    runtimeApiStub.runtime = runtime;\n+    act(() => { runtimeStore.set({runtime: runtime, workspaceNamespace: workspaceStubs[0].namespace}); });\n+\n+    const wrapper = await component();\n+\n+    await mustClickButton(wrapper, 'Create');\n+\n+    expect(runtimeApiStub.runtime.status).toEqual('Creating');\n+    expect(runtimeApiStub.runtime.dataprocConfig.masterMachineType).toEqual(runtimePresets.hailAnalysis.runtimeTemplate.dataprocConfig.masterMachineType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "originalPosition": 65}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcxMTYyNQ==", "bodyText": "This test case is great. I would put a comment in here somewhere to explain more specifically the scenario this is covering.", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533711625", "createdAt": "2020-12-01T20:48:26Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.spec.tsx", "diffHunk": "@@ -159,6 +159,55 @@ describe('RuntimePanel', () => {\n     expect(runtimeApiStub.runtime.gceConfig.machineType).toEqual('n1-standard-4');\n   });\n \n+  it('should create runtime with preset values instead of getRuntime values if configurationType is GeneralAnalysis', async() => {\n+    const gceConfig = defaultGceConfig();\n+    gceConfig.machineType = 'n1-standard-16';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcxMzEyMA==", "bodyText": "nit: don't need !! in a predicate context (where it is already going to be coerced to a boolean)", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533713120", "createdAt": "2020-12-01T20:51:09Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -652,6 +643,17 @@ export const RuntimePanel = fp.flow(\n   const {hasMicroarrayData} = fp.find({cdrVersionId}, cdrVersionListResponse.items) || {hasMicroarrayData: false};\n   const [{currentRuntime, pendingRuntime}, setRequestedRuntime] = useCustomRuntime(namespace);\n \n+  // if runtime configuration type is a default, override its config with preset values\n+  if (!!currentRuntime && currentRuntime.status === RuntimeStatus.Deleted) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcxNDA2NQ==", "bodyText": "nit: probably slightly more extensible/readable: [RuntimeConfigurationType.GeneralAnalysis, ...].includes(r.configurationType)", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533714065", "createdAt": "2020-12-01T20:52:49Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -667,12 +669,13 @@ export const RuntimePanel = fp.flow(\n     // currentRuntime being undefined means the first `getRuntime` has still not completed.\n     [([r, ]) => r === undefined, () => PanelContent.Customize],\n     [([r, s]) => r === null || s === RuntimeStatus.Unknown, () => PanelContent.Create],\n+    [([r, ]) => r.status === RuntimeStatus.Deleted &&\n+      (r.configurationType === RuntimeConfigurationType.GeneralAnalysis || r.configurationType === RuntimeConfigurationType.HailGenomicAnalysis),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzcxNTU1Ng==", "bodyText": "nit: this could probably be written slightly more generically, e.g. if we had a mapping of configurationType -> preset, or a helper function to do this lookup.", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533715556", "createdAt": "2020-12-01T20:55:35Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -652,6 +643,17 @@ export const RuntimePanel = fp.flow(\n   const {hasMicroarrayData} = fp.find({cdrVersionId}, cdrVersionListResponse.items) || {hasMicroarrayData: false};\n   const [{currentRuntime, pendingRuntime}, setRequestedRuntime] = useCustomRuntime(namespace);\n \n+  // if runtime configuration type is a default, override its config with preset values\n+  if (!!currentRuntime && currentRuntime.status === RuntimeStatus.Deleted) {\n+    if (currentRuntime.configurationType === RuntimeConfigurationType.GeneralAnalysis) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fae55a3920ac164a6ff8d697101e0199e6f45f49"}, "originalPosition": 60}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20131a4d2f1b9c1e7636e8a27d4d66e833f7a64a", "author": {"user": {"login": "ericsong", "name": "Eric Song"}}, "url": "https://github.com/all-of-us/workbench/commit/20131a4d2f1b9c1e7636e8a27d4d66e833f7a64a", "committedDate": "2020-12-01T22:44:31Z", "message": "code review feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2a12716a39f2259b34671dd3f3ab966f9646a4e", "author": {"user": {"login": "ericsong", "name": "Eric Song"}}, "url": "https://github.com/all-of-us/workbench/commit/b2a12716a39f2259b34671dd3f3ab966f9646a4e", "committedDate": "2020-12-01T23:04:07Z", "message": "spotless"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMzg3NzAz", "url": "https://github.com/all-of-us/workbench/pull/4341#pullrequestreview-542387703", "createdAt": "2020-12-01T23:40:34Z", "commit": {"oid": "b2a12716a39f2259b34671dd3f3ab966f9646a4e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMzo0MDozNFrOH9EU6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMzo0MDozNFrOH9EU6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc5NjA3Mw==", "bodyText": "nit: It would be better to use expect().toEqual() so that you get a useful error message when this fails. Maybe change the signature to expectEqualForFields() or expectPartiallyEqual and just do the expect in here", "url": "https://github.com/all-of-us/workbench/pull/4341#discussion_r533796073", "createdAt": "2020-12-01T23:40:34Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.spec.tsx", "diffHunk": "@@ -159,6 +160,71 @@ describe('RuntimePanel', () => {\n     expect(runtimeApiStub.runtime.gceConfig.machineType).toEqual('n1-standard-4');\n   });\n \n+  it('should create runtime with preset values instead of getRuntime values if configurationType is GeneralAnalysis', async() => {\n+    // In the case where the user's latest runtime is a preset (GeneralAnalysis in this case)\n+    // we should ignore the other runtime config values that were delivered with the getRuntime response\n+    // and instead, defer to the preset values defined in runtime-presets.ts when creating a new runtime\n+\n+    const runtime = {...runtimeApiStub.runtime,\n+      status: RuntimeStatus.Deleted,\n+      configurationType: RuntimeConfigurationType.GeneralAnalysis,\n+      gceConfig: {\n+        ...defaultGceConfig(),\n+        machineType: 'n1-standard-16',\n+        diskSize: 1000\n+      },\n+      dataprocConfig: null\n+    };\n+    runtimeApiStub.runtime = runtime;\n+    runtimeStore.set({runtime: runtime, workspaceNamespace: workspaceStubs[0].namespace});\n+\n+    const wrapper = await component();\n+    await mustClickButton(wrapper, 'Create');\n+\n+    expect(runtimeApiStub.runtime.status).toEqual('Creating');\n+    expect(compareFields(\n+      runtimeApiStub.runtime.gceConfig,\n+      runtimePresets.generalAnalysis.runtimeTemplate.gceConfig,\n+      ['machineType', 'diskSize']\n+    )).toBeTruthy();\n+  });\n+\n+  it('should create runtime with preset values instead of getRuntime values if configurationType is HailGenomicsAnalysis', async() => {\n+    // In the case where the user's latest runtime is a preset (HailGenomicsAnalysis in this case)\n+    // we should ignore the other runtime config values that were delivered with the getRuntime response\n+    // and instead, defer to the preset values defined in runtime-presets.ts when creating a new runtime\n+\n+    const runtime = {...runtimeApiStub.runtime,\n+      status: RuntimeStatus.Deleted,\n+      configurationType: RuntimeConfigurationType.HailGenomicAnalysis,\n+      gceConfig: null,\n+      dataprocConfig: {\n+        ...defaultDataprocConfig(),\n+        masterMachineType: 'n1-standard-16',\n+        masterDiskSize: 999,\n+        workerDiskSize: 444,\n+        numberOfWorkers: 5\n+      }\n+    };\n+    runtimeApiStub.runtime = runtime;\n+    runtimeStore.set({runtime: runtime, workspaceNamespace: workspaceStubs[0].namespace});\n+\n+    const wrapper = await component();\n+    await mustClickButton(wrapper, 'Create');\n+\n+    expect(runtimeApiStub.runtime.status).toEqual('Creating');\n+    expect(compareFields(\n+      runtimeApiStub.runtime.dataprocConfig,\n+      runtimePresets.hailAnalysis.runtimeTemplate.dataprocConfig,\n+      ['masterMachineType', 'masterDiskSize', 'workerDiskSize', 'numberOfWorkers']\n+    )).toBeTruthy();\n+  });\n+\n+  const compareFields = (a, b, fieldNames) => {\n+    const pick = fp.flow(fp.pick(fieldNames));\n+    return fp.isEqual(pick(a) , pick(b));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2a12716a39f2259b34671dd3f3ab966f9646a4e"}, "originalPosition": 91}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3382e658ab04ff5c906e9c781e573442c8e7078", "author": {"user": {"login": "ericsong", "name": "Eric Song"}}, "url": "https://github.com/all-of-us/workbench/commit/f3382e658ab04ff5c906e9c781e573442c8e7078", "committedDate": "2020-12-02T15:48:31Z", "message": "refactor type mapping. test syntax"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3697, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}