{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE2NDA2NDYw", "number": 3568, "title": "[RW-3942][risk=low] Add a new standalone command to create/update the DB (1.5/2)", "bodyText": "On further review, create_db.sql isn't run during deployments. Add a standalone command to apply this per environment as needed. This would only be needed when user creation, grants, or passwords need updating.\n./project.rb create-or-update-workbench-db --project ...", "createdAt": "2020-05-11T23:47:11Z", "url": "https://github.com/all-of-us/workbench/pull/3568", "merged": true, "mergeCommit": {"oid": "386f2c4ec68d6ac5cf57cd318bf168a4497b1e47"}, "closed": true, "closedAt": "2020-05-18T16:39:12Z", "author": {"login": "calbach"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcgYY_ygH2gAyNDE2NDA2NDYwOjA0NmQ0NGRhMDg4NjlkODQ0MjNmZjllZTNmOGNkNjQyNWUxYzc0ZGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchBleKgH2gAyNDE2NDA2NDYwOjFiYTM0NmIwZjFmMjk5YjBmZDgyY2E2NGM0YTQxYTI4MmE3YmQ0NGY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "046d44da08869d84423ff9ee3f8cd6425e1c74dc", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/046d44da08869d84423ff9ee3f8cd6425e1c74dc", "committedDate": "2020-05-11T23:36:41Z", "message": "update/create cmd"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6e94abffc90c35f3d5e5d993cddc1303ca556ed", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/e6e94abffc90c35f3d5e5d993cddc1303ca556ed", "committedDate": "2020-05-11T23:43:34Z", "message": "doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b17cb64ca2a6f9a328685881481be9aa57c66d6", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/7b17cb64ca2a6f9a328685881481be9aa57c66d6", "committedDate": "2020-05-13T00:49:44Z", "message": "Add verbose mysql logging for batch mode for confirmation of what ran"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c77dcd6754b6f2fe435c7dcbb44eb5336b07f490", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/c77dcd6754b6f2fe435c7dcbb44eb5336b07f490", "committedDate": "2020-05-13T21:57:59Z", "message": "Revert \"Add verbose mysql logging for batch mode for confirmation of what ran\"\n\nThis reverts commit 7b17cb64ca2a6f9a328685881481be9aa57c66d6."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMzY2NTcz", "url": "https://github.com/all-of-us/workbench/pull/3568#pullrequestreview-411366573", "createdAt": "2020-05-13T23:26:35Z", "commit": {"oid": "c77dcd6754b6f2fe435c7dcbb44eb5336b07f490"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMzoyNjozNVrOGVG8ag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QyMzoyNjozNVrOGVG8ag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDc4NzA1MA==", "bodyText": "So this is just another entry point to what we aleready have, which makes sense.\nOne confusing thing is that this always runs a had-coded create_db.sql script. Which makes it feel like a wart in some ways. It's also scary to run something called create_workbench_db when you're just doing an update.", "url": "https://github.com/all-of-us/workbench/pull/3568#discussion_r424787050", "createdAt": "2020-05-13T23:26:35Z", "author": {"login": "jaycarlton"}, "path": "api/libproject/devstart.rb", "diffHunk": "@@ -2221,6 +2221,25 @@ def create_workbench_db()\n   )\n end\n \n+def create_or_update_workbench_db(cmd_name, args)\n+  ensure_docker cmd_name, args\n+  with_cloud_proxy_and_db_env(cmd_name, args) do |ctx|\n+    create_workbench_db", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c77dcd6754b6f2fe435c7dcbb44eb5336b07f490"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8244b508d3a82adfc14aeec34c6a36c166525de", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/c8244b508d3a82adfc14aeec34c6a36c166525de", "committedDate": "2020-05-13T23:32:04Z", "message": "PR changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ba346b0f1f299b0fd82ca64c4a41a282a7bd44f", "author": {"user": {"login": "calbach", "name": "CH Albach"}}, "url": "https://github.com/all-of-us/workbench/commit/1ba346b0f1f299b0fd82ca64c4a41a282a7bd44f", "committedDate": "2020-05-13T23:36:25Z", "message": "env var comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4995, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}