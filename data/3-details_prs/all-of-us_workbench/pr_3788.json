{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5NzM1MDAx", "number": 3788, "title": "[RW-5113][risk=no] UI - Sidebar to right of page with functionality to add criteria to groups (phase 1)", "bodyText": "As part of this PR:\n\n\nCriteria icon will replace the workspace icon in sidebar only if the user is on the cohort criteria search page\n\n\nBy Default the the count on the icon will be 0.\n\n\nSelecting the plus icon will update the count and show a message 'Criteria Added' for few seconds\n\n\n\n\nClicking the icon will open the add modifier page (the look and feel for this will be taken care by another Story/PR)\n\n\n\nPR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n I have run the E2E tests on ths change against my local UI + API server with yarn test-local\n If this includes a UI change, I have taken screen recordings or screenshots of the new behavior and notified the PO and UX designer\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-07-15T21:03:07Z", "url": "https://github.com/all-of-us/workbench/pull/3788", "merged": true, "mergeCommit": {"oid": "66a334576b43a9c255d48926445ae6a2cc644ecb"}, "closed": true, "closedAt": "2020-07-20T21:10:24Z", "author": {"login": "NehaBroad"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1REXCgH2gAyNDQ5NzM1MDAxOjdlYTRjMGE3ZjgxYzY0MjYwN2RmZWU5MDExOTQ3MjEzZTc5Y2MzZWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc22j0BgFqTQ1MTg4NTQ1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7ea4c0a7f81c642607dfee9011947213e79cc3eb", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/7ea4c0a7f81c642607dfee9011947213e79cc3eb", "committedDate": "2020-07-15T20:57:13Z", "message": "Sidebar Icon for Cohort Criteria page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfd4e02767d1144b102586f27510494fe0ad7de9", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/cfd4e02767d1144b102586f27510494fe0ad7de9", "committedDate": "2020-07-15T21:09:00Z", "message": "Remove extra lines etc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "174d4f296c7a120801fdbda36ccac252e4cfb5cc", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/174d4f296c7a120801fdbda36ccac252e4cfb5cc", "committedDate": "2020-07-15T21:12:54Z", "message": "Fix UI test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5OTMyODM1", "url": "https://github.com/all-of-us/workbench/pull/3788#pullrequestreview-449932835", "createdAt": "2020-07-16T14:57:21Z", "commit": {"oid": "174d4f296c7a120801fdbda36ccac252e4cfb5cc"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNDo1NzoyMlrOGyu-vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNTozNToxMFrOGywqxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg1MTcxMQ==", "bodyText": "Was this an intentional change? It doesn't seem to do anything currently", "url": "https://github.com/all-of-us/workbench/pull/3788#discussion_r455851711", "createdAt": "2020-07-16T14:57:22Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/pages/data/cohort-review/cohort-review.tsx", "diffHunk": "@@ -26,7 +26,7 @@ interface State {\n   readonly: boolean;\n }\n \n-export class CohortReview extends React.Component<{}, State> {\n+export const CohortReview = withCurrentCohortCriteria()(class extends React.Component<{}, State> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "174d4f296c7a120801fdbda36ccac252e4cfb5cc"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg1OTMyMA==", "bodyText": "I think the selections are meant to slide out, like how the help tips slide out when the info icon is clicked. We may want to verify before changing, but I believe that's what was discussed.", "url": "https://github.com/all-of-us/workbench/pull/3788#discussion_r455859320", "createdAt": "2020-07-16T15:07:36Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -363,6 +381,18 @@ export const HelpSidebar = fp.flow(withCurrentWorkspace(), withUserProfile())(\n       }\n     }\n \n+    renderCriteria() {\n+      const {criteria} = this.props;\n+      return <PopupTrigger", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "174d4f296c7a120801fdbda36ccac252e4cfb5cc"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg2NzQ0MQ==", "bodyText": "The changes in this component will break the non feature flagged version of cohort builder. We either need to put the changes behind the feature flag or duplicate the component so we can change it however we want. Duplicating is probably simpler.", "url": "https://github.com/all-of-us/workbench/pull/3788#discussion_r455867441", "createdAt": "2020-07-16T15:18:46Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/selection-list/selection-list.component.tsx", "diffHunk": "@@ -144,9 +145,10 @@ interface Props {\n   selections: Array<Selection>;\n   setView: Function;\n   view: string;\n+  criteria?: Array<Selection>;\n }\n \n-export class SelectionList extends React.Component<Props> {\n+export const SelectionList = withCurrentCohortCriteria()(class extends React.Component<Props> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "174d4f296c7a120801fdbda36ccac252e4cfb5cc"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg3MDkyMg==", "bodyText": "Just curious, did you also look at Primereact's Growl component? At a glance, it looks more similar to what the mocks call for, not sure if it's actually a better fit for what we need.", "url": "https://github.com/all-of-us/workbench/pull/3788#discussion_r455870922", "createdAt": "2020-07-16T15:23:36Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/cohort-search/cohort-search.component.tsx", "diffHunk": "@@ -5,16 +5,19 @@ import {AttributesPage} from 'app/cohort-search/attributes-page/attributes-page.\n import {Demographics} from 'app/cohort-search/demographics/demographics.component';\n import {ListSearchV2} from 'app/cohort-search/list-search-v2/list-search-v2.component';\n import {searchRequestStore} from 'app/cohort-search/search-state.service';\n+import {Selection} from 'app/cohort-search/selection-list/selection-list.component';\n import {CriteriaTree} from 'app/cohort-search/tree/tree.component';\n import {domainToTitle, generateId, typeToTitle} from 'app/cohort-search/utils';\n import {Button, Clickable} from 'app/components/buttons';\n import {FlexRowWrap} from 'app/components/flex';\n import {ClrIcon} from 'app/components/icons';\n import {SpinnerOverlay} from 'app/components/spinners';\n-import colors, {addOpacity} from 'app/styles/colors';\n+import colors, {addOpacity, colorWithWhiteness} from 'app/styles/colors';\n import {reactStyles, ReactWrapperBase} from 'app/utils';\n import {triggerEvent} from 'app/utils/analytics';\n+import {currentCohortCriteriaStore} from 'app/utils/navigation';\n import {Criteria, CriteriaType, DomainType, TemporalMention, TemporalTime} from 'generated/fetch';\n+import {Messages} from 'primereact/messages';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "174d4f296c7a120801fdbda36ccac252e4cfb5cc"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg3OTM2NQ==", "bodyText": "This style is only applied to the info icon", "url": "https://github.com/all-of-us/workbench/pull/3788#discussion_r455879365", "createdAt": "2020-07-16T15:35:10Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -177,7 +194,7 @@ const icons = (helpContentKey: string) => {\n     faIcon: helpContentKey === NOTEBOOK_HELP_CONTENT ? faFolderOpen : faInfoCircle,\n     label: helpContentKey === NOTEBOOK_HELP_CONTENT ? 'Storage Icon' : 'Help Icon',\n     page: null,\n-    style: {fontSize: '21px'},\n+    style: {fontSize: '1.1rem'},", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "174d4f296c7a120801fdbda36ccac252e4cfb5cc"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9fcb66d82c010cbf5a16b1d156b77af3ef3582cd", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/9fcb66d82c010cbf5a16b1d156b77af3ef3582cd", "committedDate": "2020-07-20T15:06:45Z", "message": "PR Comments: Remove criteriaStore from criteriaReview and add config to selectionList"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71a8d0d31c19072ca499604401001c06bab7d601", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/71a8d0d31c19072ca499604401001c06bab7d601", "committedDate": "2020-07-20T16:56:53Z", "message": "Use Growl instead of Message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d2956d71e4038701b888ffed1883c2eca75bc42", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/1d2956d71e4038701b888ffed1883c2eca75bc42", "committedDate": "2020-07-20T18:17:26Z", "message": "Rebase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxODQ1OTU5", "url": "https://github.com/all-of-us/workbench/pull/3788#pullrequestreview-451845959", "createdAt": "2020-07-20T18:14:19Z", "commit": {"oid": "71a8d0d31c19072ca499604401001c06bab7d601"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxODoxNDoxOVrOG0ZwVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxODo1MToyMVrOG0a_Vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzYwMTExMA==", "bodyText": "Need to revert this change also, the Finish button stays disabled after selections are made in the non feature-flagged UI", "url": "https://github.com/all-of-us/workbench/pull/3788#discussion_r457601110", "createdAt": "2020-07-20T18:14:19Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/selection-list/selection-list.component.tsx", "diffHunk": "@@ -164,26 +167,34 @@ export class SelectionList extends React.Component<Props> {\n   }\n \n   render() {\n-    const {back, close, disableFinish, finish, removeSelection, selections, setView} = this.props;\n+    const {back, close, disableFinish, finish, removeSelection, criteria, selections, setView} = this.props;\n     return <div style={styles.selectionPanel}>\n       <h5 style={styles.selectionTitle}>Selected Criteria</h5>\n-      <div style={styles.selectionContainer}>\n-        {selections.map((selection, s) =>\n+      {serverConfigStore.getValue().enableCohortBuilderV2 && criteria && <div style={styles.selectionContainer}>\n+        {criteria.map((selection, s) =>\n           <SelectionInfo key={s}\n             index={s}\n             selection={selection}\n             removeSelection={() => removeSelection(selection)}/>\n         )}\n-      </div>\n-      <div style={styles.buttonContainer}>\n+      </div>}\n+      {!serverConfigStore.getValue().enableCohortBuilderV2 && <div style={styles.selectionContainer}>\n+        {selections.map((selection, s) =>\n+            <SelectionInfo key={s}\n+                           index={s}\n+                           selection={selection}\n+                           removeSelection={() => removeSelection(selection)}/>\n+        )}\n+      </div>}\n+      {!serverConfigStore.getValue().enableCohortBuilderV2 && <div style={styles.buttonContainer}>\n         <Button type='link'\n           style={{...styles.button, color: colors.dark, fontSize: '14px'}}\n           onClick={() => close()}>\n           Cancel\n         </Button>\n         {this.showNext && <Button type='primary' onClick={() => setView('modifiers')}\n           style={styles.button}\n-          disabled={selections.length === 0}>\n+          disabled={!criteria || criteria.length === 0}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71a8d0d31c19072ca499604401001c06bab7d601"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzYwMTI4OA==", "bodyText": "Same as above, need to revert this", "url": "https://github.com/all-of-us/workbench/pull/3788#discussion_r457601288", "createdAt": "2020-07-20T18:14:37Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/selection-list/selection-list.component.tsx", "diffHunk": "@@ -193,10 +204,10 @@ export class SelectionList extends React.Component<Props> {\n         </Button>}\n         <Button type='primary' onClick={() => finish()}\n           style={styles.button}\n-          disabled={selections.length === 0 || disableFinish}>\n+          disabled={!criteria || criteria.length === 0 || disableFinish}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71a8d0d31c19072ca499604401001c06bab7d601"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzYxNDI5NQ==", "bodyText": "If you use inspect mode on the Invision screens, looks like both should be ~21px font size", "url": "https://github.com/all-of-us/workbench/pull/3788#discussion_r457614295", "createdAt": "2020-07-20T18:38:28Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -177,7 +194,7 @@ const icons = (helpContentKey: string) => {\n     faIcon: helpContentKey === NOTEBOOK_HELP_CONTENT ? faFolderOpen : faInfoCircle,\n     label: helpContentKey === NOTEBOOK_HELP_CONTENT ? 'Storage Icon' : 'Help Icon',\n     page: null,\n-    style: {fontSize: '21px'},\n+    style: {fontSize: '1.1rem'},", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg3OTM2NQ=="}, "originalCommit": {"oid": "174d4f296c7a120801fdbda36ccac252e4cfb5cc"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzYyMTMzNA==", "bodyText": "May need to tweak/add some styles here to match the mock, can do in the follow-up PR if you prefer. Looks like mainly the check icon is too big and increases the the total height of the growl", "url": "https://github.com/all-of-us/workbench/pull/3788#discussion_r457621334", "createdAt": "2020-07-20T18:51:21Z", "author": {"login": "dolbeew"}, "path": "ui/src/app/cohort-search/cohort-search/cohort-search.component.tsx", "diffHunk": "@@ -104,7 +104,51 @@ interface State {\n   treeSearchTerms: string;\n }\n \n+const css = `", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d2956d71e4038701b888ffed1883c2eca75bc42"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd147e82381c7d365907f56ddb2438c804b6fe5a", "author": {"user": {"login": "NehaBroad", "name": null}}, "url": "https://github.com/all-of-us/workbench/commit/dd147e82381c7d365907f56ddb2438c804b6fe5a", "committedDate": "2020-07-20T19:06:44Z", "message": "Revert style and use selections"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxODg1NDU5", "url": "https://github.com/all-of-us/workbench/pull/3788#pullrequestreview-451885459", "createdAt": "2020-07-20T19:11:59Z", "commit": {"oid": "dd147e82381c7d365907f56ddb2438c804b6fe5a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4465, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}