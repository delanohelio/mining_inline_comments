{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4MDI3Mjk1", "number": 4266, "title": "[RW-5591][risk=no] Create runtime panel", "bodyText": "PR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev - [ ] This PR includes appropriate unit tests\n I have run and tested this change locally\n I have run the E2E tests on ths change against my local UI + API server with yarn test-local\n If this includes a UI change, I have taken screen recordings or screenshots of the new behavior and notified the PO and UX designer\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-11-09T20:41:17Z", "url": "https://github.com/all-of-us/workbench/pull/4266", "merged": true, "mergeCommit": {"oid": "c7d7541a0519a8102df86b847f7502b45f0a4bdd"}, "closed": true, "closedAt": "2020-11-16T19:10:53Z", "author": {"login": "als364"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABda7AadgH2gAyNTE4MDI3Mjk1OmNhMDExYmMzOTA2M2ZhNDNmMGE0MmI5MDA0Yzk0N2QxNTNkZjhjOWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddJX6NAH2gAyNTE4MDI3Mjk1OjRlYTNkN2MxMTdhYjA0MzBjZmM2NzNkYzZjNDIyNjc3MzEwYmVhNDU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ca011bc39063fa43f0a42b9004c947d153df8c9c", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/ca011bc39063fa43f0a42b9004c947d153df8c9c", "committedDate": "2020-11-09T20:44:07Z", "message": "create panel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e91619b4c3459f084559be183cdd6ce25c856568", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/e91619b4c3459f084559be183cdd6ce25c856568", "committedDate": "2020-11-09T20:44:07Z", "message": "lint"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbc2407181bd264343a52b4664281a108f0b5c88", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/cbc2407181bd264343a52b4664281a108f0b5c88", "committedDate": "2020-11-09T20:44:07Z", "message": "pretty"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5994e70309c81f02bb67594ee1d080529e8b4f77", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/5994e70309c81f02bb67594ee1d080529e8b4f77", "committedDate": "2020-11-09T20:30:47Z", "message": "pretty"}, "afterCommit": {"oid": "cbc2407181bd264343a52b4664281a108f0b5c88", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/cbc2407181bd264343a52b4664281a108f0b5c88", "committedDate": "2020-11-09T20:44:07Z", "message": "pretty"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36bbd16bfeb661f5cdf3dde8ac025022fc546888", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/36bbd16bfeb661f5cdf3dde8ac025022fc546888", "committedDate": "2020-11-10T14:59:25Z", "message": "secondarySmall button style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3NTAyNzE0", "url": "https://github.com/all-of-us/workbench/pull/4266#pullrequestreview-527502714", "createdAt": "2020-11-10T18:41:19Z", "commit": {"oid": "36bbd16bfeb661f5cdf3dde8ac025022fc546888"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxODo0MToyMFrOHwqOug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxOToxMDo1N1rOHwru4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc4NTU5NA==", "bodyText": "nit: && here and below?", "url": "https://github.com/all-of-us/workbench/pull/4266#discussion_r520785594", "createdAt": "2020-11-10T18:41:20Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -480,6 +483,113 @@ const CostEstimator = ({\n   </FlexRow>;\n };\n \n+const CreatePanel = ({creatorFreeCreditsRemaining, preset, profile, setPanelContent, workspace}) => {\n+  const {\n+    displayName,\n+    runtimeTemplate: {gceConfig = null, dataprocConfig = null}\n+  } = preset;\n+  const computeType = dataprocConfig ? ComputeType.Dataproc : ComputeType.Standard;\n+  const masterMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.masterMachineType : gceConfig.machineType;\n+  const masterMachine = findMachineByName(masterMachineType);\n+  const masterDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.masterDiskSize : gceConfig.diskSize;\n+  const workerMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.workerMachineType : null;\n+  const workerMachine = workerMachineType ? findMachineByName(workerMachineType) : null;\n+  const workerDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.workerDiskSize : null;\n+\n+  return <div style={styles.controlSection}>\n+    <CostEstimator\n+        freeCreditsRemaining={creatorFreeCreditsRemaining}\n+        profile={profile}\n+        runtimeParameters={{\n+          computeType: computeType,\n+          diskSize: gceConfig ? gceConfig.diskSize : null,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36bbd16bfeb661f5cdf3dde8ac025022fc546888"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc4ODYwNQ==", "bodyText": "nit: this line should be equivalent to just dataprocConfig", "url": "https://github.com/all-of-us/workbench/pull/4266#discussion_r520788605", "createdAt": "2020-11-10T18:44:57Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -480,6 +483,113 @@ const CostEstimator = ({\n   </FlexRow>;\n };\n \n+const CreatePanel = ({creatorFreeCreditsRemaining, preset, profile, setPanelContent, workspace}) => {\n+  const {\n+    displayName,\n+    runtimeTemplate: {gceConfig = null, dataprocConfig = null}\n+  } = preset;\n+  const computeType = dataprocConfig ? ComputeType.Dataproc : ComputeType.Standard;\n+  const masterMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.masterMachineType : gceConfig.machineType;\n+  const masterMachine = findMachineByName(masterMachineType);\n+  const masterDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.masterDiskSize : gceConfig.diskSize;\n+  const workerMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.workerMachineType : null;\n+  const workerMachine = workerMachineType ? findMachineByName(workerMachineType) : null;\n+  const workerDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.workerDiskSize : null;\n+\n+  return <div style={styles.controlSection}>\n+    <CostEstimator\n+        freeCreditsRemaining={creatorFreeCreditsRemaining}\n+        profile={profile}\n+        runtimeParameters={{\n+          computeType: computeType,\n+          diskSize: gceConfig ? gceConfig.diskSize : null,\n+          machineType: gceConfig ? gceConfig.machineType : null,\n+          dataprocConfig: dataprocConfig ? dataprocConfig : null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36bbd16bfeb661f5cdf3dde8ac025022fc546888"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc4ODk0Nw==", "bodyText": "nit: computeType: computeType, --> computeType,", "url": "https://github.com/all-of-us/workbench/pull/4266#discussion_r520788947", "createdAt": "2020-11-10T18:45:19Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -480,6 +483,113 @@ const CostEstimator = ({\n   </FlexRow>;\n };\n \n+const CreatePanel = ({creatorFreeCreditsRemaining, preset, profile, setPanelContent, workspace}) => {\n+  const {\n+    displayName,\n+    runtimeTemplate: {gceConfig = null, dataprocConfig = null}\n+  } = preset;\n+  const computeType = dataprocConfig ? ComputeType.Dataproc : ComputeType.Standard;\n+  const masterMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.masterMachineType : gceConfig.machineType;\n+  const masterMachine = findMachineByName(masterMachineType);\n+  const masterDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.masterDiskSize : gceConfig.diskSize;\n+  const workerMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.workerMachineType : null;\n+  const workerMachine = workerMachineType ? findMachineByName(workerMachineType) : null;\n+  const workerDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.workerDiskSize : null;\n+\n+  return <div style={styles.controlSection}>\n+    <CostEstimator\n+        freeCreditsRemaining={creatorFreeCreditsRemaining}\n+        profile={profile}\n+        runtimeParameters={{\n+          computeType: computeType,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36bbd16bfeb661f5cdf3dde8ac025022fc546888"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc5MzE0Mw==", "bodyText": "This whole section is bolded?", "url": "https://github.com/all-of-us/workbench/pull/4266#discussion_r520793143", "createdAt": "2020-11-10T18:49:38Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -480,6 +483,113 @@ const CostEstimator = ({\n   </FlexRow>;\n };\n \n+const CreatePanel = ({creatorFreeCreditsRemaining, preset, profile, setPanelContent, workspace}) => {\n+  const {\n+    displayName,\n+    runtimeTemplate: {gceConfig = null, dataprocConfig = null}\n+  } = preset;\n+  const computeType = dataprocConfig ? ComputeType.Dataproc : ComputeType.Standard;\n+  const masterMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.masterMachineType : gceConfig.machineType;\n+  const masterMachine = findMachineByName(masterMachineType);\n+  const masterDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.masterDiskSize : gceConfig.diskSize;\n+  const workerMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.workerMachineType : null;\n+  const workerMachine = workerMachineType ? findMachineByName(workerMachineType) : null;\n+  const workerDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.workerDiskSize : null;\n+\n+  return <div style={styles.controlSection}>\n+    <CostEstimator\n+        freeCreditsRemaining={creatorFreeCreditsRemaining}\n+        profile={profile}\n+        runtimeParameters={{\n+          computeType: computeType,\n+          diskSize: gceConfig ? gceConfig.diskSize : null,\n+          machineType: gceConfig ? gceConfig.machineType : null,\n+          dataprocConfig: dataprocConfig ? dataprocConfig : null\n+        }}\n+        runtimeChanged={false}\n+        workspace={workspace}\n+    />\n+    <FlexRow style={{justifyContent: 'space-between', alignItems: 'center'}}>\n+      <h3 style={{...styles.sectionHeader, ...styles.bold}}>Recommended Environment for {displayName}</h3>\n+      <Button\n+          type='secondarySmall'\n+          onClick={() => setPanelContent(PanelContent.Customize)}\n+      >\n+        Customize\n+      </Button>\n+    </FlexRow>\n+    <label htmlFor='compute-resources' style={{...styles.bold, marginTop: '1rem'}}>Compute Resources</label>\n+    <div id='compute-resources'>- Default: compute size of\n+      <b> {masterMachine.cpu} CPUs</b>,\n+      <b> {masterMachine.memory} GB memory</b>, and a\n+      <b> {masterDiskSize} GB disk</b>\n+    </div>\n+    {computeType === ComputeType.Dataproc && <Fragment>\n+      <label htmlFor='worker-configuration' style={{...styles.bold, marginTop: '1rem'}}>Worker Configuration</label>\n+      <div id='worker-configuration'>- Default:\n+        <b> {dataprocConfig.numberOfWorkers} worker(s)</b>\n+        {!dataprocConfig.numberOfPreemptibleWorkers && <Fragment>, </Fragment>}\n+        <b>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36bbd16bfeb661f5cdf3dde8ac025022fc546888"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc5NDQ4MA==", "bodyText": "I don't think we should need a comma before \"each with a compute size\" - would drop this", "url": "https://github.com/all-of-us/workbench/pull/4266#discussion_r520794480", "createdAt": "2020-11-10T18:51:07Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -480,6 +483,113 @@ const CostEstimator = ({\n   </FlexRow>;\n };\n \n+const CreatePanel = ({creatorFreeCreditsRemaining, preset, profile, setPanelContent, workspace}) => {\n+  const {\n+    displayName,\n+    runtimeTemplate: {gceConfig = null, dataprocConfig = null}\n+  } = preset;\n+  const computeType = dataprocConfig ? ComputeType.Dataproc : ComputeType.Standard;\n+  const masterMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.masterMachineType : gceConfig.machineType;\n+  const masterMachine = findMachineByName(masterMachineType);\n+  const masterDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.masterDiskSize : gceConfig.diskSize;\n+  const workerMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.workerMachineType : null;\n+  const workerMachine = workerMachineType ? findMachineByName(workerMachineType) : null;\n+  const workerDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.workerDiskSize : null;\n+\n+  return <div style={styles.controlSection}>\n+    <CostEstimator\n+        freeCreditsRemaining={creatorFreeCreditsRemaining}\n+        profile={profile}\n+        runtimeParameters={{\n+          computeType: computeType,\n+          diskSize: gceConfig ? gceConfig.diskSize : null,\n+          machineType: gceConfig ? gceConfig.machineType : null,\n+          dataprocConfig: dataprocConfig ? dataprocConfig : null\n+        }}\n+        runtimeChanged={false}\n+        workspace={workspace}\n+    />\n+    <FlexRow style={{justifyContent: 'space-between', alignItems: 'center'}}>\n+      <h3 style={{...styles.sectionHeader, ...styles.bold}}>Recommended Environment for {displayName}</h3>\n+      <Button\n+          type='secondarySmall'\n+          onClick={() => setPanelContent(PanelContent.Customize)}\n+      >\n+        Customize\n+      </Button>\n+    </FlexRow>\n+    <label htmlFor='compute-resources' style={{...styles.bold, marginTop: '1rem'}}>Compute Resources</label>\n+    <div id='compute-resources'>- Default: compute size of\n+      <b> {masterMachine.cpu} CPUs</b>,\n+      <b> {masterMachine.memory} GB memory</b>, and a\n+      <b> {masterDiskSize} GB disk</b>\n+    </div>\n+    {computeType === ComputeType.Dataproc && <Fragment>\n+      <label htmlFor='worker-configuration' style={{...styles.bold, marginTop: '1rem'}}>Worker Configuration</label>\n+      <div id='worker-configuration'>- Default:\n+        <b> {dataprocConfig.numberOfWorkers} worker(s)</b>\n+        {!dataprocConfig.numberOfPreemptibleWorkers && <Fragment>, </Fragment>}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36bbd16bfeb661f5cdf3dde8ac025022fc546888"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc5OTQwNA==", "bodyText": "I don't think this is ever the correct thing to show initially, would just remove this from the switch. If you need a default, Customize is probably most appropriate", "url": "https://github.com/all-of-us/workbench/pull/4266#discussion_r520799404", "createdAt": "2020-11-10T18:56:21Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -499,7 +609,12 @@ export const RuntimePanel = fp.flow(\n   const initialMasterMachine = findMachineByName(machineName) || defaultMachineType;\n   const initialCompute = dataprocConfig ? ComputeType.Dataproc : ComputeType.Standard;\n   // TODO(RW-5591): Initialize PanelContent according to the runtime status.\n-  const [panelContent, setPanelContent] = useState<PanelContent>(PanelContent.Customize);\n+  const initialPanelContent = fp.cond([\n+    [(s) => s === RuntimeStatus.Running || s === RuntimeStatus.Stopped, () => PanelContent.Customize],\n+    [(s) => s === null || s === RuntimeStatus.Unknown, () => PanelContent.Create],\n+    [() => true, () => PanelContent.Delete]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36bbd16bfeb661f5cdf3dde8ac025022fc546888"}, "originalPosition": 157}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDgxMDIwOA==", "bodyText": "So initially I thought this might work, but I'm less sure as I understand more about hooks. My updated understanding is that this only works if the runtime store has already been populated by the time the user renders the panel contents. In most cases, this will be true, but I don't think it's guaranteed.", "url": "https://github.com/all-of-us/workbench/pull/4266#discussion_r520810208", "createdAt": "2020-11-10T19:10:57Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -499,7 +609,12 @@ export const RuntimePanel = fp.flow(\n   const initialMasterMachine = findMachineByName(machineName) || defaultMachineType;\n   const initialCompute = dataprocConfig ? ComputeType.Dataproc : ComputeType.Standard;\n   // TODO(RW-5591): Initialize PanelContent according to the runtime status.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36bbd16bfeb661f5cdf3dde8ac025022fc546888"}, "originalPosition": 152}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e313ade69906e49e75cb5159562b0323441cb010", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/e313ade69906e49e75cb5159562b0323441cb010", "committedDate": "2020-11-12T21:43:31Z", "message": "most review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13e733c87341f154ff1d4efc35b761039cd0fb89", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/13e733c87341f154ff1d4efc35b761039cd0fb89", "committedDate": "2020-11-13T18:29:31Z", "message": "close after create"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "727ad0e2d484d77a8cdcb74c03ac1eaf933cb14a", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/727ad0e2d484d77a8cdcb74c03ac1eaf933cb14a", "committedDate": "2020-11-13T18:41:49Z", "message": "unbreak tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7005893b50a800b18aad74df81e0738b6673abf", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/c7005893b50a800b18aad74df81e0738b6673abf", "committedDate": "2020-11-13T19:23:39Z", "message": "handle undefined"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18153ee73a0812082c4429f86ae49508c84998e1", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/18153ee73a0812082c4429f86ae49508c84998e1", "committedDate": "2020-11-13T19:54:15Z", "message": "oy gevalt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "33798997b68c76d4cbae0754cfaa72e658bd9548", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/33798997b68c76d4cbae0754cfaa72e658bd9548", "committedDate": "2020-11-13T20:14:50Z", "message": "and a test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMxNTYxODcw", "url": "https://github.com/all-of-us/workbench/pull/4266#pullrequestreview-531561870", "createdAt": "2020-11-16T17:48:00Z", "commit": {"oid": "33798997b68c76d4cbae0754cfaa72e658bd9548"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNzo0ODowMVrOH0KaUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxODowMTozOFrOH0K8VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDQ1ODU3Ng==", "bodyText": "Is there a test that actually clicks the create button on the create panel? This would be good to have", "url": "https://github.com/all-of-us/workbench/pull/4266#discussion_r524458576", "createdAt": "2020-11-16T17:48:01Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.spec.tsx", "diffHunk": "@@ -115,6 +124,19 @@ describe('RuntimePanel', () => {\n     expect(!wrapper.exists(Spinner));\n   });\n \n+  it('should show Create panel when no runtime', async() => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33798997b68c76d4cbae0754cfaa72e658bd9548"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDQ2NzI4NQ==", "bodyText": "nit: I feel it might be a cleaner separation to replace these constituent properties with disabled and label (disabled could default to false). This way you don't leave any opportunity for bugs where the button is potentially grayed out on the creation panel (create panel would just be a simple hardcoded 'Create'), and it pushed most of the hairy business logic into the customize panel where it belongs.", "url": "https://github.com/all-of-us/workbench/pull/4266#discussion_r524467285", "createdAt": "2020-11-16T18:01:38Z", "author": {"login": "calbach"}, "path": "ui/src/app/pages/analysis/runtime-panel.tsx", "diffHunk": "@@ -480,11 +484,116 @@ const CostEstimator = ({\n   </FlexRow>;\n };\n \n+const CreatePanel = ({creatorFreeCreditsRemaining, preset, profile, setPanelContent, workspace}) => {\n+  const {\n+    displayName,\n+    runtimeTemplate: {gceConfig = null, dataprocConfig = null}\n+  } = preset;\n+  const computeType = dataprocConfig ? ComputeType.Dataproc : ComputeType.Standard;\n+  const masterMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.masterMachineType : gceConfig.machineType;\n+  const masterMachine = findMachineByName(masterMachineType);\n+  const masterDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.masterDiskSize : gceConfig.diskSize;\n+  const workerMachineType = computeType === ComputeType.Dataproc ? dataprocConfig.workerMachineType : null;\n+  const workerMachine = workerMachineType ? findMachineByName(workerMachineType) : null;\n+  const workerDiskSize = computeType === ComputeType.Dataproc ? dataprocConfig.workerDiskSize : null;\n+\n+  return <div style={styles.controlSection}>\n+    <CostEstimator\n+        freeCreditsRemaining={creatorFreeCreditsRemaining}\n+        profile={profile}\n+        runtimeParameters={{\n+          computeType,\n+          diskSize: gceConfig && gceConfig.diskSize,\n+          machineType: gceConfig && gceConfig.machineType,\n+          dataprocConfig: dataprocConfig\n+        }}\n+        runtimeChanged={false}\n+        workspace={workspace}\n+    />\n+    <FlexRow style={{justifyContent: 'space-between', alignItems: 'center'}}>\n+      <h3 style={{...styles.sectionHeader, ...styles.bold}}>Recommended Environment for {displayName}</h3>\n+      <Button\n+          type='secondarySmall'\n+          onClick={() => setPanelContent(PanelContent.Customize)}\n+          aria-label='Customize'\n+      >\n+        Customize\n+      </Button>\n+    </FlexRow>\n+    <label htmlFor='compute-resources' style={{...styles.bold, marginTop: '1rem'}}>Compute Resources</label>\n+    <div id='compute-resources'>- Default: compute size of\n+      <b> {masterMachine.cpu} CPUs</b>,\n+      <b> {masterMachine.memory} GB memory</b>, and a\n+      <b> {masterDiskSize} GB disk</b>\n+    </div>\n+    {computeType === ComputeType.Dataproc && <Fragment>\n+      <label htmlFor='worker-configuration' style={{...styles.bold, marginTop: '1rem'}}>Worker Configuration</label>\n+      <div id='worker-configuration'>- Default:\n+        <b> {dataprocConfig.numberOfWorkers} worker(s) </b>\n+        {\n+          dataprocConfig.numberOfPreemptibleWorkers > 0 &&\n+          <b>and {dataprocConfig.numberOfPreemptibleWorkers}  preemptible worker(s) </b>\n+        }\n+        each with compute size of <b>{workerMachine.cpu} CPUs</b>,\n+        <b> {workerMachine.memory} GB memory</b>, and a\n+        <b> {workerDiskSize} GB disk</b>\n+      </div>\n+    </Fragment>}\n+  </div>;\n+};\n+\n+const UpdateRuntimeButton = ({\n+   closePanel,\n+   runtimeExists,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33798997b68c76d4cbae0754cfaa72e658bd9548"}, "originalPosition": 107}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae5fd2233bad254b851bc80a80b1170b26e8dab4", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/ae5fd2233bad254b851bc80a80b1170b26e8dab4", "committedDate": "2020-11-16T18:21:29Z", "message": "last comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ea3d7c117ab0430cfc673dc6c422677310bea45", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/4ea3d7c117ab0430cfc673dc6c422677310bea45", "committedDate": "2020-11-16T18:36:18Z", "message": "gevalt"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3842, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}