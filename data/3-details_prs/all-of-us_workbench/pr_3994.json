{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg1MzMzNTkw", "number": 3994, "title": "[RW-5398][risk=no] Show sidebar icon for runtime", "bodyText": "PR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n I have run the E2E tests on ths change against my local UI + API server with yarn test:local\n If this includes a UI change, I have taken screen recordings or screenshots of the new behavior and notified the PO and UX designer\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-09-11T18:18:57Z", "url": "https://github.com/all-of-us/workbench/pull/3994", "merged": true, "mergeCommit": {"oid": "14a46b1b9c1a289b1dbe171f7a049eaa5d650aff"}, "closed": true, "closedAt": "2020-09-11T21:18:05Z", "author": {"login": "als364"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdH2P18gH2gAyNDg1MzMzNTkwOjczNjFkM2VkMWZiYjhlNGE1ODc1OGNiZmEyZWRiYmVlMTJmZDcxMWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdH7b81AH2gAyNDg1MzMzNTkwOjJiYjY2MTkyNjU0ZDgxM2IyMzIwNjI4YTc5ODc4YzUzMGQ1NzgxZjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7361d3ed1fbb8e4a58758cbfa2edbbee12fd711a", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/7361d3ed1fbb8e4a58758cbfa2edbbee12fd711a", "committedDate": "2020-09-11T14:26:53Z", "message": "I'm siiiiinging in the rain"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/78560b8b42e050da4141da640b6be71fedb597ca", "committedDate": "2020-09-11T18:22:01Z", "message": "show only when OWNER, WRITER"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MDM3MTU1", "url": "https://github.com/all-of-us/workbench/pull/3994#pullrequestreview-487037155", "createdAt": "2020-09-11T18:38:30Z", "commit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxODozODozMFrOHQpr6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxODozOToyMFrOHQptkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyMjI0OA==", "bodyText": "It looks sort of grayed out - is the opacity the issue?", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487222248", "createdAt": "2020-09-11T18:38:30Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +248,25 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (\n+    enableCustomRuntimes\n+    && (\n+      workspaceAccessLevel === WorkspaceAccessLevel.OWNER\n+      || workspaceAccessLevel === WorkspaceAccessLevel.WRITER\n+    )\n+  ) {\n+    return [...iconsList, {\n+      id: 'thunderstorm',\n+      disabled: true,\n+      faIcon: null,\n+      label: 'Cloud Icon',\n+      page: null,\n+      style: {height: '22px', width: '22px', marginTop: '0.25rem', opacity: 0.5},", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyMjY3Mg==", "bodyText": "nit: can use this canWrite util: \n  \n    \n      workbench/ui/src/app/utils/workspace-permissions.ts\n    \n    \n         Line 4\n      in\n      28f2caa\n    \n    \n    \n    \n\n        \n          \n           export function canWrite(accessLevel: WorkspaceAccessLevel) {", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487222672", "createdAt": "2020-09-11T18:39:20Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +248,25 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (\n+    enableCustomRuntimes\n+    && (\n+      workspaceAccessLevel === WorkspaceAccessLevel.OWNER", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca"}, "originalPosition": 91}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6a8399c9766f2413bb1d0e385147308a589dfc1", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/e6a8399c9766f2413bb1d0e385147308a589dfc1", "committedDate": "2020-09-11T19:05:44Z", "message": "reverse greyed out icon"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "216ca2955a2211ec81fcede464df9b447fd44c26", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/216ca2955a2211ec81fcede464df9b447fd44c26", "committedDate": "2020-09-11T19:22:00Z", "message": "disabled=false"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b01565f92d3b09a7b85abeb105a95d088eed7fc", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/4b01565f92d3b09a7b85abeb105a95d088eed7fc", "committedDate": "2020-09-11T19:53:15Z", "message": "lint"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MDg0MjY0", "url": "https://github.com/all-of-us/workbench/pull/3994#pullrequestreview-487084264", "createdAt": "2020-09-11T19:53:35Z", "commit": {"oid": "216ca2955a2211ec81fcede464df9b447fd44c26"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxOTo1MzozNVrOHQr7sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxOTo1OToxM1rOHQsGmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI1OTA1OA==", "bodyText": "Was this a bug?\nalso nit: !icon.disabled seems more natural", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487259058", "createdAt": "2020-09-11T19:53:35Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -515,12 +541,12 @@ export const HelpSidebar = fp.flow(withCurrentWorkspace(), withUserProfile(), wi\n       return <React.Fragment>\n         <div style={notebookStyles ? {...styles.iconContainer, ...styles.notebookOverrides} : {...styles.iconContainer}}>\n           {!criteria && this.renderWorkspaceMenu()}\n-          {icons(helpContentKey).map((icon, i) =>\n+          {icons(helpContentKey, serverConfigStore.getValue().enableCustomRuntimes, workspace.accessLevel).map((icon, i) =>\n           this.showIcon(icon) && <div key={i} style={{display: 'table'}}>\n                 <TooltipTrigger content={<div>{tooltipId === i && icon.tooltip}</div>} side='left'>\n                   <div style={activeIcon === icon.id ? iconStyles.active : icon.disabled ? iconStyles.disabled : styles.icon}\n                        onClick={() => {\n-                         if (icon.id !== 'dataDictionary') {\n+                         if (icon.id !== 'dataDictionary' && icon.disabled === false) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "216ca2955a2211ec81fcede464df9b447fd44c26"}, "originalPosition": 131}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI2MTg1MA==", "bodyText": "Adding a test case which demonstrates that this is only shown for writable workspaces would be nice, to exercise this branch", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487261850", "createdAt": "2020-09-11T19:59:13Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +250,19 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (enableCustomRuntimes && canWrite(workspaceAccessLevel)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b01565f92d3b09a7b85abeb105a95d088eed7fc"}, "originalPosition": 95}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5610a31a7d1e672be6e6b5e29f71c22ba7697e18", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/5610a31a7d1e672be6e6b5e29f71c22ba7697e18", "committedDate": "2020-09-11T20:25:29Z", "message": "test case, some test dewonkifying"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5b2c4a69742fa654deef9c89a71d9f1e7ebdf44", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/c5b2c4a69742fa654deef9c89a71d9f1e7ebdf44", "committedDate": "2020-09-11T20:29:08Z", "message": "other more better test case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bb66192654d813b2320628a79878c530d5781f7", "author": {"user": null}, "url": "https://github.com/all-of-us/workbench/commit/2bb66192654d813b2320628a79878c530d5781f7", "committedDate": "2020-09-11T20:29:38Z", "message": "boolean land"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4210, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}