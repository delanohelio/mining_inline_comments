{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4MTIwNjY1", "number": 4267, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDozNzoxN1rOE6C8Cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNTo1Mjo1NVrOE7HttQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MzAxMDAzOnYy", "diffSide": "RIGHT", "path": "e2e/app/page/workspaces-page.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDozNzoxN1rOH032OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDozNzoxN1rOH032OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIwMzAwMQ==", "bodyText": "New method below: minimal work required to create a new workspace", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r525203001", "createdAt": "2020-11-17T14:37:17Z", "author": {"login": "jmthibault79"}, "path": "e2e/app/page/workspaces-page.ts", "diffHunk": "@@ -78,16 +78,33 @@ export default class WorkspacesPage extends WorkspaceEditPage {\n      billingAccount: string = UseFreeCredits,\n      reviewRequest: boolean = false): Promise<string[]> {\n \n+    const editPage = await this.fillOutRequiredCreationFields(workspaceName, billingAccount, reviewRequest);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "576ffc31a61081251ec3180f99e547bba525e1ae"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MzAyODQ3OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/cdr-version-upgrade-modal.tsx", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0MTowOVrOH04BqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNTo1NjowNVrOH2ldqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIwNTkyOQ==", "bodyText": "or onClose?", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r525205929", "createdAt": "2020-11-17T14:41:09Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/cdr-version-upgrade-modal.tsx", "diffHunk": "@@ -0,0 +1,38 @@\n+import * as React from 'react';\n+\n+import {Button, Clickable} from 'app/components/buttons';\n+import {FlexRow} from 'app/components/flex';\n+import {ClrIcon} from 'app/components/icons';\n+import {Modal, ModalBody, ModalFooter, ModalTitle} from 'app/components/modals';\n+import colors from 'app/styles/colors';\n+import {AnalyticsTracker} from 'app/utils/analytics';\n+\n+interface Props {\n+  defaultCdrVersionName: string;\n+  onDismiss: () => void;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "576ffc31a61081251ec3180f99e547bba525e1ae"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk5ODk1NA==", "bodyText": "Searching the code I am not seeing any instances of onDismiss, but lots of onClose. Perhaps in this case we should go with the de-facto standard onClose", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r526998954", "createdAt": "2020-11-19T15:56:05Z", "author": {"login": "petesantos"}, "path": "ui/src/app/pages/workspace/cdr-version-upgrade-modal.tsx", "diffHunk": "@@ -0,0 +1,38 @@\n+import * as React from 'react';\n+\n+import {Button, Clickable} from 'app/components/buttons';\n+import {FlexRow} from 'app/components/flex';\n+import {ClrIcon} from 'app/components/icons';\n+import {Modal, ModalBody, ModalFooter, ModalTitle} from 'app/components/modals';\n+import colors from 'app/styles/colors';\n+import {AnalyticsTracker} from 'app/utils/analytics';\n+\n+interface Props {\n+  defaultCdrVersionName: string;\n+  onDismiss: () => void;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIwNTkyOQ=="}, "originalCommit": {"oid": "576ffc31a61081251ec3180f99e547bba525e1ae"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MzAzODQ5OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0MzoxNFrOH04H3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0MzoxNFrOH04H3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIwNzUxOA==", "bodyText": "This is the only new field - the rest is just alphabetized", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r525207518", "createdAt": "2020-11-17T14:43:14Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "diffHunk": "@@ -236,47 +237,49 @@ export interface WorkspaceEditProps {\n }\n \n export interface WorkspaceEditState {\n+  billingAccounts: Array<BillingAccount>;\n   cdrVersionItems: Array<CdrVersion>;\n+  cloneUserRole: boolean;\n+  loading: boolean;\n+  populationChecked: boolean;\n   selectResearchPurpose: boolean;\n+  showCdrVersionModal: boolean;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "576ffc31a61081251ec3180f99e547bba525e1ae"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MzA0MjgyOnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0NDoxMFrOH04Ksw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0NDoxMFrOH04Ksw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIwODI0Mw==", "bodyText": "the only new line; the rest is just alphabetized", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r525208243", "createdAt": "2020-11-17T14:44:10Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "diffHunk": "@@ -236,47 +237,49 @@ export interface WorkspaceEditProps {\n }\n \n export interface WorkspaceEditState {\n+  billingAccounts: Array<BillingAccount>;\n   cdrVersionItems: Array<CdrVersion>;\n+  cloneUserRole: boolean;\n+  loading: boolean;\n+  populationChecked: boolean;\n   selectResearchPurpose: boolean;\n+  showCdrVersionModal: boolean;\n+  showConfirmationModal: boolean;\n+  showCreateBillingAccountModal: boolean;\n+  showResearchPurpose: boolean;\n+  showStigmatizationDetails: boolean;\n+  showUnderservedPopulationDetails: boolean;\n   workspace: Workspace;\n   workspaceCreationConflictError: boolean;\n   workspaceCreationError: boolean;\n   workspaceCreationErrorMessage: string;\n   workspaceNewAclDelayed: boolean;\n   workspaceNewAclDelayedContinueFn: Function;\n-  cloneUserRole: boolean;\n-  loading: boolean;\n-  showUnderservedPopulationDetails: boolean;\n-  showStigmatizationDetails: boolean;\n-  showResearchPurpose: boolean;\n-  billingAccounts: Array<BillingAccount>;\n-  showCreateBillingAccountModal: boolean;\n-  showConfirmationModal: boolean;\n-  populationChecked: boolean;\n }\n \n export const WorkspaceEdit = fp.flow(withRouteConfigData(), withCurrentWorkspace(), withCdrVersions(), withUserProfile())(\n   class WorkspaceEditCmp extends React.Component<WorkspaceEditProps, WorkspaceEditState> {\n     constructor(props: WorkspaceEditProps) {\n       super(props);\n       this.state = {\n+        billingAccounts: [],\n         cdrVersionItems: this.createInitialCdrVersionsList(),\n-        workspace: this.createInitialWorkspaceState(),\n+        cloneUserRole: false,\n+        loading: false,\n+        populationChecked: props.workspace ? props.workspace.researchPurpose.populationDetails.length > 0 : undefined,\n         selectResearchPurpose: this.updateSelectedResearch(),\n+        showCdrVersionModal: false,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "576ffc31a61081251ec3180f99e547bba525e1ae"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MzA1MDc3OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0NTozNFrOH04Pag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0NTozNFrOH04Pag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIwOTQ1MA==", "bodyText": "Modal cancel: force the use of the default CDR\nModal continue (requires checkboxes): allows use of chosen older CDR", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r525209450", "createdAt": "2020-11-17T14:45:34Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-edit.tsx", "diffHunk": "@@ -1004,10 +1008,18 @@ export const WorkspaceEdit = fp.flow(withRouteConfigData(), withCurrentWorkspace\n       return <FadeBox  style={{margin: 'auto', marginTop: '1rem', width: '95.7%'}}>\n         <div style={{width: '1120px'}}>\n           {loading && <SpinnerOverlay overrideStylesOverlay={styles.spinner}/>}\n+          {!hasDefaultCdrVersion(this.state.workspace, cdrVersionListResponse) && showCdrVersionModal &&\n+            <OldCdrVersionModal\n+                onCancel={() => {\n+                  this.setState(fp.set(['workspace', 'cdrVersionId'], cdrVersionListResponse.defaultCdrVersionId));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "576ffc31a61081251ec3180f99e547bba525e1ae"}, "originalPosition": 100}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MzA2NzczOnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0ODo0N1rOH04ZyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0ODo0N1rOH04ZyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIxMjEwNA==", "bodyText": "For the circle around the flag.  The flag is a ClrIcon.", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r525212104", "createdAt": "2020-11-17T14:48:47Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -56,9 +61,65 @@ const styles = reactStyles({\n   },\n   disabled: {\n     color: colors.disabled\n-  }\n+  },\n });\n \n+const stylesFunction = {\n+  cdrVersionFlagCircle: (alert: boolean): React.CSSProperties => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "576ffc31a61081251ec3180f99e547bba525e1ae"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MzA3MjYyOnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0OTozOFrOH04crw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNDo0OTozOFrOH04crw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTIxMjg0Nw==", "bodyText": "Better location for this const?", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r525212847", "createdAt": "2020-11-17T14:49:38Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -56,9 +61,65 @@ const styles = reactStyles({\n   },\n   disabled: {\n     color: colors.disabled\n-  }\n+  },\n });\n \n+const stylesFunction = {\n+  cdrVersionFlagCircle: (alert: boolean): React.CSSProperties => {\n+    return {\n+      border: 'solid 1px',\n+      borderRadius: '50%',\n+      height: '50px',\n+      width: '50px',\n+      marginLeft: '12px',\n+      padding: '4px',\n+      backgroundColor: alert ? colors.danger : colors.secondary,\n+    };\n+  }\n+};\n+\n+const USER_DISMISSED_ALERT_VALUE = 'DISMISSED';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "576ffc31a61081251ec3180f99e547bba525e1ae"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5MzU5MzY2OnYy", "diffSide": "RIGHT", "path": "e2e/tests/workspace/workspace-create.spec.ts", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNjoyMzowMVrOH09hZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxNjoyMzowMVrOH09hZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTI5NTk3NQ==", "bodyText": "I'd create a new file for cdr tests like workspace-cdr.spec.ts to include this new test and the test below to take advantage of running tests in parallel threads.", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r525295975", "createdAt": "2020-11-17T16:23:01Z", "author": {"login": "aweng98"}, "path": "e2e/tests/workspace/workspace-create.spec.ts", "diffHunk": "@@ -72,6 +73,26 @@ describe('Creating new workspaces', () => {\n     await verifyWorkspaceLinkOnDataPage(newWorkspaceName);\n   });\n \n+  test('User cannot create a workspace with an old CDR Version without consenting to the restrictions', async () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f3fee0a93aab8b096304cf74a7abf95bc063423"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI5NDM1OTgyOnYy", "diffSide": "RIGHT", "path": "e2e/app/page/old-cdr-version-modal.ts", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxOTowOTozM1rOH1E4Uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxOTowOTozM1rOH1E4Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQxNjUzMQ==", "bodyText": "nit: finding any object in a modal should use the modal parent: Checkbox.findByName(this.page, FIELD.willUseCheckbox.textOption, this);", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r525416531", "createdAt": "2020-11-17T19:09:33Z", "author": {"login": "aweng98"}, "path": "e2e/app/page/old-cdr-version-modal.ts", "diffHunk": "@@ -0,0 +1,76 @@\n+import {Page} from 'puppeteer';\n+\n+import Button from 'app/element/button';\n+import Modal from 'app/component/modal';\n+import {waitWhileLoading} from 'utils/waits-utils';\n+import {ElementType} from '../xpath-options';\n+import {LinkText} from '../text-labels';\n+import Checkbox from '../element/checkbox';\n+\n+const LabelAlias = {\n+    WILL_USE_OLD_CDR_VERSION: 'I will use this workspace to complete an existing study or replicate a previous study.',\n+    WILL_IDENTIFY_OLD_CDR_VERSION: 'In the workspace description below, I will identify which study I am continuing or replicating.',\n+}\n+\n+const FIELD = {\n+    willUseCheckbox: {\n+        textOption: {name: LabelAlias.WILL_USE_OLD_CDR_VERSION, type: ElementType.Checkbox}\n+    },\n+    willIdentifyCheckbox: {\n+        textOption: {name: LabelAlias.WILL_IDENTIFY_OLD_CDR_VERSION, type: ElementType.Checkbox}\n+    },\n+    continueButton: {\n+        textOption: {name: LinkText.Continue}\n+    },\n+}\n+\n+export default class OldCdrVersionModal extends Modal {\n+\n+    constructor(page: Page, xpath?: string) {\n+        super(page, xpath);\n+    }\n+\n+    async isLoaded(): Promise<boolean> {\n+        const xpath = '//*[@data-test-id=\"old-cdr-version-modal\"]';\n+        await Promise.all([\n+            this.page.waitForXPath(xpath),\n+            waitWhileLoading(this.page),\n+        ]);\n+        return true;\n+    }\n+\n+    async getWillUseCheckbox(): Promise<Checkbox> {\n+        return Checkbox.findByName(this.page, FIELD.willUseCheckbox.textOption);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f582caaf4613dc48cfe5512b989abf49be98689"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwNDI3MzQ4OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNTo1MTo1N1rOH2lQRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNzozNDo1NlrOH2p9Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk5NTUyNw==", "bodyText": "Does this need to be a string, could it be a boolean in localStorage?", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r526995527", "createdAt": "2020-11-19T15:51:57Z", "author": {"login": "petesantos"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -56,9 +61,63 @@ const styles = reactStyles({\n   },\n   disabled: {\n     color: colors.disabled\n-  }\n+  },\n });\n \n+const stylesFunction = {\n+  cdrVersionFlagCircle: (alert: boolean): React.CSSProperties => {\n+    return {\n+      border: 'solid 1px',\n+      borderRadius: '50%',\n+      height: '50px',\n+      width: '50px',\n+      marginLeft: '12px',\n+      padding: '4px',\n+      backgroundColor: alert ? colors.danger : colors.secondary,\n+    };\n+  }\n+};\n+\n+const USER_DISMISSED_ALERT_VALUE = 'DISMISSED';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4cb217d56271a6d64f58639d9fd80485b4aed"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzAzMDAzNQ==", "bodyText": "Yes, the spec is strings-only.  https://www.w3.org/Bugs/Public/show_bug.cgi?id=12111", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r527030035", "createdAt": "2020-11-19T16:37:05Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -56,9 +61,63 @@ const styles = reactStyles({\n   },\n   disabled: {\n     color: colors.disabled\n-  }\n+  },\n });\n \n+const stylesFunction = {\n+  cdrVersionFlagCircle: (alert: boolean): React.CSSProperties => {\n+    return {\n+      border: 'solid 1px',\n+      borderRadius: '50%',\n+      height: '50px',\n+      width: '50px',\n+      marginLeft: '12px',\n+      padding: '4px',\n+      backgroundColor: alert ? colors.danger : colors.secondary,\n+    };\n+  }\n+};\n+\n+const USER_DISMISSED_ALERT_VALUE = 'DISMISSED';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk5NTUyNw=="}, "originalCommit": {"oid": "92a4cb217d56271a6d64f58639d9fd80485b4aed"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA3MjU5NQ==", "bodyText": "Ah - I did not know that - thanks!", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r527072595", "createdAt": "2020-11-19T17:34:56Z", "author": {"login": "petesantos"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -56,9 +61,63 @@ const styles = reactStyles({\n   },\n   disabled: {\n     color: colors.disabled\n-  }\n+  },\n });\n \n+const stylesFunction = {\n+  cdrVersionFlagCircle: (alert: boolean): React.CSSProperties => {\n+    return {\n+      border: 'solid 1px',\n+      borderRadius: '50%',\n+      height: '50px',\n+      width: '50px',\n+      marginLeft: '12px',\n+      padding: '4px',\n+      backgroundColor: alert ? colors.danger : colors.secondary,\n+    };\n+  }\n+};\n+\n+const USER_DISMISSED_ALERT_VALUE = 'DISMISSED';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk5NTUyNw=="}, "originalCommit": {"oid": "92a4cb217d56271a6d64f58639d9fd80485b4aed"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwNDI3ODI5OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNTo1Mjo1NVrOH2lTSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxNzo1MToxNVrOH2qnSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk5NjI5Ng==", "bodyText": "Could we initialize the state with:\nlocalStorage.getItem(localStorageKey) === USER_DISMISSED_ALERT_VALUE\nor just the value if the localStorage value is a boolean?", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r526996296", "createdAt": "2020-11-19T15:52:55Z", "author": {"login": "petesantos"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -56,9 +61,63 @@ const styles = reactStyles({\n   },\n   disabled: {\n     color: colors.disabled\n-  }\n+  },\n });\n \n+const stylesFunction = {\n+  cdrVersionFlagCircle: (alert: boolean): React.CSSProperties => {\n+    return {\n+      border: 'solid 1px',\n+      borderRadius: '50%',\n+      height: '50px',\n+      width: '50px',\n+      marginLeft: '12px',\n+      padding: '4px',\n+      backgroundColor: alert ? colors.danger : colors.secondary,\n+    };\n+  }\n+};\n+\n+const USER_DISMISSED_ALERT_VALUE = 'DISMISSED';\n+\n+const CdrVersion = (props: {workspace: Workspace, cdrVersionListResponse: CdrVersionListResponse}) => {\n+  const [showModal, setShowModal] = useState(false);\n+  const [userHasDismissedAlert, setUserHasDismissedAlert] = useState(false);\n+\n+  const {workspace, cdrVersionListResponse} = props;\n+  const {namespace, id} = workspace;\n+\n+  const localStorageKey = `${namespace}-${id}-user-dismissed-cdr-version-update-alert`;\n+\n+  // check whether the user has previously dismissed the alert in localStorage, to determine icon color\n+  useEffect(() =>\n+      setUserHasDismissedAlert(localStorage.getItem(localStorageKey) === USER_DISMISSED_ALERT_VALUE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92a4cb217d56271a6d64f58639d9fd80485b4aed"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzA4MzMzNg==", "bodyText": "looks like yes", "url": "https://github.com/all-of-us/workbench/pull/4267#discussion_r527083336", "createdAt": "2020-11-19T17:51:15Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -56,9 +61,63 @@ const styles = reactStyles({\n   },\n   disabled: {\n     color: colors.disabled\n-  }\n+  },\n });\n \n+const stylesFunction = {\n+  cdrVersionFlagCircle: (alert: boolean): React.CSSProperties => {\n+    return {\n+      border: 'solid 1px',\n+      borderRadius: '50%',\n+      height: '50px',\n+      width: '50px',\n+      marginLeft: '12px',\n+      padding: '4px',\n+      backgroundColor: alert ? colors.danger : colors.secondary,\n+    };\n+  }\n+};\n+\n+const USER_DISMISSED_ALERT_VALUE = 'DISMISSED';\n+\n+const CdrVersion = (props: {workspace: Workspace, cdrVersionListResponse: CdrVersionListResponse}) => {\n+  const [showModal, setShowModal] = useState(false);\n+  const [userHasDismissedAlert, setUserHasDismissedAlert] = useState(false);\n+\n+  const {workspace, cdrVersionListResponse} = props;\n+  const {namespace, id} = workspace;\n+\n+  const localStorageKey = `${namespace}-${id}-user-dismissed-cdr-version-update-alert`;\n+\n+  // check whether the user has previously dismissed the alert in localStorage, to determine icon color\n+  useEffect(() =>\n+      setUserHasDismissedAlert(localStorage.getItem(localStorageKey) === USER_DISMISSED_ALERT_VALUE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjk5NjI5Ng=="}, "originalCommit": {"oid": "92a4cb217d56271a6d64f58639d9fd80485b4aed"}, "originalPosition": 60}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3721, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}