{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNDMwNjgx", "number": 3193, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxODo0MTozN1rODjMZhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxODo0NTo1MlrODjMfCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MjI5ODkzOnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/research-purpose.tsx", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxODo0MTozN1rOFu3fLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxOTowODo0MVrOFu4YsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY4NzkxNg==", "bodyText": "nit: we can move this\nconst categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem\nMulti-line suggestions are here!\nYou can now suggest code changes to multiple lines. Learn more.\nwe can move this to the workspace-edit-text.tsx\n  const categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem\n\n.subCategory.filter(item => researchPurpose.populationDetails.includes(item.shortName)).length > 0);\ncategories.forEach(category => category.subCategory = category.subCategory\n.filter(subCategoryItem => researchPurpose.populationDetails.includes(subCategoryItem.shortName)));\nto the workspace-edit-text.tsx ?", "url": "https://github.com/all-of-us/workbench/pull/3193#discussion_r384687916", "createdAt": "2020-02-26T18:41:37Z", "author": {"login": "NehaBroad"}, "path": "ui/src/app/pages/workspace/research-purpose.tsx", "diffHunk": "@@ -41,51 +56,83 @@ export const ResearchPurpose = withCurrentWorkspace()(\n       };\n     }\n \n-    getSelectedPopulationsSlice(left: boolean) {\n-      const populations = getSelectedPopulations(this.props.workspace.researchPurpose);\n-      const populationsHalfLen = sliceByHalfLength(populations);\n-      if (left) {\n-        return populations.slice(0, populationsHalfLen);\n-      } else {\n-        return populations.slice(populationsHalfLen);\n-      }\n+    // TODO: Move this to an abstract function and also change the admin workspace to use it\n+    getSelectedPopulationsOfInterest() {\n+      const researchPurpose = this.props.workspace.researchPurpose;\n+      const categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4b6f793dc4aa139c0c967bc71201f518c85a4a9"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDcwMjY0MQ==", "bodyText": "Talked offline. This ideally would go in app/utils/research-purpose.tsx but I want to be able to verify that it works in workspace admin first. (That's what the todo is for.)", "url": "https://github.com/all-of-us/workbench/pull/3193#discussion_r384702641", "createdAt": "2020-02-26T19:08:41Z", "author": {"login": "s-rubenstein"}, "path": "ui/src/app/pages/workspace/research-purpose.tsx", "diffHunk": "@@ -41,51 +56,83 @@ export const ResearchPurpose = withCurrentWorkspace()(\n       };\n     }\n \n-    getSelectedPopulationsSlice(left: boolean) {\n-      const populations = getSelectedPopulations(this.props.workspace.researchPurpose);\n-      const populationsHalfLen = sliceByHalfLength(populations);\n-      if (left) {\n-        return populations.slice(0, populationsHalfLen);\n-      } else {\n-        return populations.slice(populationsHalfLen);\n-      }\n+    // TODO: Move this to an abstract function and also change the admin workspace to use it\n+    getSelectedPopulationsOfInterest() {\n+      const researchPurpose = this.props.workspace.researchPurpose;\n+      const categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY4NzkxNg=="}, "originalCommit": {"oid": "f4b6f793dc4aa139c0c967bc71201f518c85a4a9"}, "originalPosition": 69}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MjMwMDczOnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/research-purpose.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxODo0MjoxMFrOFu3gPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxODo0MjoxMFrOFu3gPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY4ODE4OQ==", "bodyText": "extract this to its own style", "url": "https://github.com/all-of-us/workbench/pull/3193#discussion_r384688189", "createdAt": "2020-02-26T18:42:10Z", "author": {"login": "NehaBroad"}, "path": "ui/src/app/pages/workspace/research-purpose.tsx", "diffHunk": "@@ -41,51 +56,83 @@ export const ResearchPurpose = withCurrentWorkspace()(\n       };\n     }\n \n-    getSelectedPopulationsSlice(left: boolean) {\n-      const populations = getSelectedPopulations(this.props.workspace.researchPurpose);\n-      const populationsHalfLen = sliceByHalfLength(populations);\n-      if (left) {\n-        return populations.slice(0, populationsHalfLen);\n-      } else {\n-        return populations.slice(populationsHalfLen);\n-      }\n+    // TODO: Move this to an abstract function and also change the admin workspace to use it\n+    getSelectedPopulationsOfInterest() {\n+      const researchPurpose = this.props.workspace.researchPurpose;\n+      const categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem\n+        .subCategory.filter(item => researchPurpose.populationDetails.includes(item.shortName)).length > 0);\n+      categories.forEach(category => category.subCategory = category.subCategory\n+        .filter(subCategoryItem => researchPurpose.populationDetails.includes(subCategoryItem.shortName)));\n+      return categories;\n     }\n \n     render() {\n       const {workspace} = this.props;\n       const {workspacePermissions} = this.state;\n       const selectedResearchPurposeItems = getSelectedResearchPurposeItems(this.props.workspace.researchPurpose);\n-      const rpItemsHalfLen = sliceByHalfLength(selectedResearchPurposeItems);\n+      const selectedPopulationsOfInterest = this.getSelectedPopulationsOfInterest();\n       return <FadeBox>\n-        <div style={styles.mainHeader}>Research Purpose\n+        <div style={styles.mainHeader}>Primary purpose of project\n           <Clickable disabled={!workspacePermissions.canWrite}\n+                     style={{display: 'flex', alignItems: 'center'}}\n                      data-test-id='edit-workspace'\n                      onClick={() => navigate(\n                        ['workspaces',  workspace.namespace, workspace.id, 'edit'])}>\n             <EditComponentReact enableHoverEffect={true}\n                                 disabled={!workspacePermissions.canWrite}\n-                                style={{marginTop: '0.1rem'}}/>\n+                                style={{marginTop: '0.1rem', height: 22,\n+                                  width: 22,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4b6f793dc4aa139c0c967bc71201f518c85a4a9"}, "originalPosition": 94}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MjMxMzA0OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/research-purpose.tsx", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxODo0NTo1MlrOFu3n-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMDo1ODoxNFrOFu79kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY5MDE2OQ==", "bodyText": "nit: It will be good to have comments to identify what section the divs are displaying(intended study or anticipated finding) --- Ignore i thought each section  of research purpose have more than 1 div.", "url": "https://github.com/all-of-us/workbench/pull/3193#discussion_r384690169", "createdAt": "2020-02-26T18:45:52Z", "author": {"login": "NehaBroad"}, "path": "ui/src/app/pages/workspace/research-purpose.tsx", "diffHunk": "@@ -41,51 +56,83 @@ export const ResearchPurpose = withCurrentWorkspace()(\n       };\n     }\n \n-    getSelectedPopulationsSlice(left: boolean) {\n-      const populations = getSelectedPopulations(this.props.workspace.researchPurpose);\n-      const populationsHalfLen = sliceByHalfLength(populations);\n-      if (left) {\n-        return populations.slice(0, populationsHalfLen);\n-      } else {\n-        return populations.slice(populationsHalfLen);\n-      }\n+    // TODO: Move this to an abstract function and also change the admin workspace to use it\n+    getSelectedPopulationsOfInterest() {\n+      const researchPurpose = this.props.workspace.researchPurpose;\n+      const categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem\n+        .subCategory.filter(item => researchPurpose.populationDetails.includes(item.shortName)).length > 0);\n+      categories.forEach(category => category.subCategory = category.subCategory\n+        .filter(subCategoryItem => researchPurpose.populationDetails.includes(subCategoryItem.shortName)));\n+      return categories;\n     }\n \n     render() {\n       const {workspace} = this.props;\n       const {workspacePermissions} = this.state;\n       const selectedResearchPurposeItems = getSelectedResearchPurposeItems(this.props.workspace.researchPurpose);\n-      const rpItemsHalfLen = sliceByHalfLength(selectedResearchPurposeItems);\n+      const selectedPopulationsOfInterest = this.getSelectedPopulationsOfInterest();\n       return <FadeBox>\n-        <div style={styles.mainHeader}>Research Purpose\n+        <div style={styles.mainHeader}>Primary purpose of project\n           <Clickable disabled={!workspacePermissions.canWrite}\n+                     style={{display: 'flex', alignItems: 'center'}}\n                      data-test-id='edit-workspace'\n                      onClick={() => navigate(\n                        ['workspaces',  workspace.namespace, workspace.id, 'edit'])}>\n             <EditComponentReact enableHoverEffect={true}\n                                 disabled={!workspacePermissions.canWrite}\n-                                style={{marginTop: '0.1rem'}}/>\n+                                style={{marginTop: '0.1rem', height: 22,\n+                                  width: 22,\n+                                  fill: colors.light,\n+                                  backgroundColor: colors.accent,\n+                                  cursor: 'pointer',\n+                                  padding: '5px',\n+                                  borderRadius: '23px'}}/>\n           </Clickable>\n         </div>\n-        <div style={styles.sectionText}>{ResearchPurposeDescription}</div>\n-        <div style={styles.sectionHeader}>Primary purpose of the project</div>\n-        <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                           contentLeft={selectedResearchPurposeItems.slice(0, rpItemsHalfLen)}\n-                           contentRight={selectedResearchPurposeItems.slice(rpItemsHalfLen)}/>\n-        <div style={styles.sectionHeader}>\n-          Reason for choosing <i>All of Us</i> data for your investigation</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.reasonForAllOfUs}</div>\n-        <div style={styles.sectionHeader}>Area of intended study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.intendedStudy}</div>\n-        <div style={styles.sectionHeader}>Anticipated findings from this study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.anticipatedFindings}</div>\n-        {workspace.researchPurpose.population && <div style={{marginBottom: '1rem'}}>\n-          <div style={styles.sectionHeader}>Population area(s) of focus</div>\n-          <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                             contentLeft={this.getSelectedPopulationsSlice(true)}\n-                             contentRight={this.getSelectedPopulationsSlice(false)}/>\n+        <div style={styles.sectionContentContainer}>\n+          {selectedResearchPurposeItems.map((selectedResearchPurposeItem, i) => <div key={i}>\n+            <div style={{marginTop: '1rem'}}>{selectedResearchPurposeItem}</div>\n+          </div>)}\n+        </div>\n+        <div style={styles.sectionHeader}>Summary of research purpose</div>\n+        <div style={styles.sectionContentContainer}>\n+          <div style={styles.sectionSubHeader}>{researchPurposeQuestions[2].header}</div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f4b6f793dc4aa139c0c967bc71201f518c85a4a9"}, "originalPosition": 126}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY5MzU0Ng==", "bodyText": "However it did take me 2-3 times to read the whole thing to understand where the section starts and end, can we have just some space distinguishing each section (header and text field) to make it readable", "url": "https://github.com/all-of-us/workbench/pull/3193#discussion_r384693546", "createdAt": "2020-02-26T18:52:03Z", "author": {"login": "NehaBroad"}, "path": "ui/src/app/pages/workspace/research-purpose.tsx", "diffHunk": "@@ -41,51 +56,83 @@ export const ResearchPurpose = withCurrentWorkspace()(\n       };\n     }\n \n-    getSelectedPopulationsSlice(left: boolean) {\n-      const populations = getSelectedPopulations(this.props.workspace.researchPurpose);\n-      const populationsHalfLen = sliceByHalfLength(populations);\n-      if (left) {\n-        return populations.slice(0, populationsHalfLen);\n-      } else {\n-        return populations.slice(populationsHalfLen);\n-      }\n+    // TODO: Move this to an abstract function and also change the admin workspace to use it\n+    getSelectedPopulationsOfInterest() {\n+      const researchPurpose = this.props.workspace.researchPurpose;\n+      const categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem\n+        .subCategory.filter(item => researchPurpose.populationDetails.includes(item.shortName)).length > 0);\n+      categories.forEach(category => category.subCategory = category.subCategory\n+        .filter(subCategoryItem => researchPurpose.populationDetails.includes(subCategoryItem.shortName)));\n+      return categories;\n     }\n \n     render() {\n       const {workspace} = this.props;\n       const {workspacePermissions} = this.state;\n       const selectedResearchPurposeItems = getSelectedResearchPurposeItems(this.props.workspace.researchPurpose);\n-      const rpItemsHalfLen = sliceByHalfLength(selectedResearchPurposeItems);\n+      const selectedPopulationsOfInterest = this.getSelectedPopulationsOfInterest();\n       return <FadeBox>\n-        <div style={styles.mainHeader}>Research Purpose\n+        <div style={styles.mainHeader}>Primary purpose of project\n           <Clickable disabled={!workspacePermissions.canWrite}\n+                     style={{display: 'flex', alignItems: 'center'}}\n                      data-test-id='edit-workspace'\n                      onClick={() => navigate(\n                        ['workspaces',  workspace.namespace, workspace.id, 'edit'])}>\n             <EditComponentReact enableHoverEffect={true}\n                                 disabled={!workspacePermissions.canWrite}\n-                                style={{marginTop: '0.1rem'}}/>\n+                                style={{marginTop: '0.1rem', height: 22,\n+                                  width: 22,\n+                                  fill: colors.light,\n+                                  backgroundColor: colors.accent,\n+                                  cursor: 'pointer',\n+                                  padding: '5px',\n+                                  borderRadius: '23px'}}/>\n           </Clickable>\n         </div>\n-        <div style={styles.sectionText}>{ResearchPurposeDescription}</div>\n-        <div style={styles.sectionHeader}>Primary purpose of the project</div>\n-        <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                           contentLeft={selectedResearchPurposeItems.slice(0, rpItemsHalfLen)}\n-                           contentRight={selectedResearchPurposeItems.slice(rpItemsHalfLen)}/>\n-        <div style={styles.sectionHeader}>\n-          Reason for choosing <i>All of Us</i> data for your investigation</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.reasonForAllOfUs}</div>\n-        <div style={styles.sectionHeader}>Area of intended study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.intendedStudy}</div>\n-        <div style={styles.sectionHeader}>Anticipated findings from this study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.anticipatedFindings}</div>\n-        {workspace.researchPurpose.population && <div style={{marginBottom: '1rem'}}>\n-          <div style={styles.sectionHeader}>Population area(s) of focus</div>\n-          <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                             contentLeft={this.getSelectedPopulationsSlice(true)}\n-                             contentRight={this.getSelectedPopulationsSlice(false)}/>\n+        <div style={styles.sectionContentContainer}>\n+          {selectedResearchPurposeItems.map((selectedResearchPurposeItem, i) => <div key={i}>\n+            <div style={{marginTop: '1rem'}}>{selectedResearchPurposeItem}</div>\n+          </div>)}\n+        </div>\n+        <div style={styles.sectionHeader}>Summary of research purpose</div>\n+        <div style={styles.sectionContentContainer}>\n+          <div style={styles.sectionSubHeader}>{researchPurposeQuestions[2].header}</div>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY5MDE2OQ=="}, "originalCommit": {"oid": "f4b6f793dc4aa139c0c967bc71201f518c85a4a9"}, "originalPosition": 126}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDcwMjEyNg==", "bodyText": "Is this good to ignore? Just checking? (If it is, do you mind resolving the comment?)", "url": "https://github.com/all-of-us/workbench/pull/3193#discussion_r384702126", "createdAt": "2020-02-26T19:07:47Z", "author": {"login": "s-rubenstein"}, "path": "ui/src/app/pages/workspace/research-purpose.tsx", "diffHunk": "@@ -41,51 +56,83 @@ export const ResearchPurpose = withCurrentWorkspace()(\n       };\n     }\n \n-    getSelectedPopulationsSlice(left: boolean) {\n-      const populations = getSelectedPopulations(this.props.workspace.researchPurpose);\n-      const populationsHalfLen = sliceByHalfLength(populations);\n-      if (left) {\n-        return populations.slice(0, populationsHalfLen);\n-      } else {\n-        return populations.slice(populationsHalfLen);\n-      }\n+    // TODO: Move this to an abstract function and also change the admin workspace to use it\n+    getSelectedPopulationsOfInterest() {\n+      const researchPurpose = this.props.workspace.researchPurpose;\n+      const categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem\n+        .subCategory.filter(item => researchPurpose.populationDetails.includes(item.shortName)).length > 0);\n+      categories.forEach(category => category.subCategory = category.subCategory\n+        .filter(subCategoryItem => researchPurpose.populationDetails.includes(subCategoryItem.shortName)));\n+      return categories;\n     }\n \n     render() {\n       const {workspace} = this.props;\n       const {workspacePermissions} = this.state;\n       const selectedResearchPurposeItems = getSelectedResearchPurposeItems(this.props.workspace.researchPurpose);\n-      const rpItemsHalfLen = sliceByHalfLength(selectedResearchPurposeItems);\n+      const selectedPopulationsOfInterest = this.getSelectedPopulationsOfInterest();\n       return <FadeBox>\n-        <div style={styles.mainHeader}>Research Purpose\n+        <div style={styles.mainHeader}>Primary purpose of project\n           <Clickable disabled={!workspacePermissions.canWrite}\n+                     style={{display: 'flex', alignItems: 'center'}}\n                      data-test-id='edit-workspace'\n                      onClick={() => navigate(\n                        ['workspaces',  workspace.namespace, workspace.id, 'edit'])}>\n             <EditComponentReact enableHoverEffect={true}\n                                 disabled={!workspacePermissions.canWrite}\n-                                style={{marginTop: '0.1rem'}}/>\n+                                style={{marginTop: '0.1rem', height: 22,\n+                                  width: 22,\n+                                  fill: colors.light,\n+                                  backgroundColor: colors.accent,\n+                                  cursor: 'pointer',\n+                                  padding: '5px',\n+                                  borderRadius: '23px'}}/>\n           </Clickable>\n         </div>\n-        <div style={styles.sectionText}>{ResearchPurposeDescription}</div>\n-        <div style={styles.sectionHeader}>Primary purpose of the project</div>\n-        <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                           contentLeft={selectedResearchPurposeItems.slice(0, rpItemsHalfLen)}\n-                           contentRight={selectedResearchPurposeItems.slice(rpItemsHalfLen)}/>\n-        <div style={styles.sectionHeader}>\n-          Reason for choosing <i>All of Us</i> data for your investigation</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.reasonForAllOfUs}</div>\n-        <div style={styles.sectionHeader}>Area of intended study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.intendedStudy}</div>\n-        <div style={styles.sectionHeader}>Anticipated findings from this study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.anticipatedFindings}</div>\n-        {workspace.researchPurpose.population && <div style={{marginBottom: '1rem'}}>\n-          <div style={styles.sectionHeader}>Population area(s) of focus</div>\n-          <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                             contentLeft={this.getSelectedPopulationsSlice(true)}\n-                             contentRight={this.getSelectedPopulationsSlice(false)}/>\n+        <div style={styles.sectionContentContainer}>\n+          {selectedResearchPurposeItems.map((selectedResearchPurposeItem, i) => <div key={i}>\n+            <div style={{marginTop: '1rem'}}>{selectedResearchPurposeItem}</div>\n+          </div>)}\n+        </div>\n+        <div style={styles.sectionHeader}>Summary of research purpose</div>\n+        <div style={styles.sectionContentContainer}>\n+          <div style={styles.sectionSubHeader}>{researchPurposeQuestions[2].header}</div>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY5MDE2OQ=="}, "originalCommit": {"oid": "f4b6f793dc4aa139c0c967bc71201f518c85a4a9"}, "originalPosition": 126}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1OTE1NA==", "bodyText": "Ignore adding comment for each section just add space so its easier to read", "url": "https://github.com/all-of-us/workbench/pull/3193#discussion_r384759154", "createdAt": "2020-02-26T20:54:01Z", "author": {"login": "NehaBroad"}, "path": "ui/src/app/pages/workspace/research-purpose.tsx", "diffHunk": "@@ -41,51 +56,83 @@ export const ResearchPurpose = withCurrentWorkspace()(\n       };\n     }\n \n-    getSelectedPopulationsSlice(left: boolean) {\n-      const populations = getSelectedPopulations(this.props.workspace.researchPurpose);\n-      const populationsHalfLen = sliceByHalfLength(populations);\n-      if (left) {\n-        return populations.slice(0, populationsHalfLen);\n-      } else {\n-        return populations.slice(populationsHalfLen);\n-      }\n+    // TODO: Move this to an abstract function and also change the admin workspace to use it\n+    getSelectedPopulationsOfInterest() {\n+      const researchPurpose = this.props.workspace.researchPurpose;\n+      const categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem\n+        .subCategory.filter(item => researchPurpose.populationDetails.includes(item.shortName)).length > 0);\n+      categories.forEach(category => category.subCategory = category.subCategory\n+        .filter(subCategoryItem => researchPurpose.populationDetails.includes(subCategoryItem.shortName)));\n+      return categories;\n     }\n \n     render() {\n       const {workspace} = this.props;\n       const {workspacePermissions} = this.state;\n       const selectedResearchPurposeItems = getSelectedResearchPurposeItems(this.props.workspace.researchPurpose);\n-      const rpItemsHalfLen = sliceByHalfLength(selectedResearchPurposeItems);\n+      const selectedPopulationsOfInterest = this.getSelectedPopulationsOfInterest();\n       return <FadeBox>\n-        <div style={styles.mainHeader}>Research Purpose\n+        <div style={styles.mainHeader}>Primary purpose of project\n           <Clickable disabled={!workspacePermissions.canWrite}\n+                     style={{display: 'flex', alignItems: 'center'}}\n                      data-test-id='edit-workspace'\n                      onClick={() => navigate(\n                        ['workspaces',  workspace.namespace, workspace.id, 'edit'])}>\n             <EditComponentReact enableHoverEffect={true}\n                                 disabled={!workspacePermissions.canWrite}\n-                                style={{marginTop: '0.1rem'}}/>\n+                                style={{marginTop: '0.1rem', height: 22,\n+                                  width: 22,\n+                                  fill: colors.light,\n+                                  backgroundColor: colors.accent,\n+                                  cursor: 'pointer',\n+                                  padding: '5px',\n+                                  borderRadius: '23px'}}/>\n           </Clickable>\n         </div>\n-        <div style={styles.sectionText}>{ResearchPurposeDescription}</div>\n-        <div style={styles.sectionHeader}>Primary purpose of the project</div>\n-        <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                           contentLeft={selectedResearchPurposeItems.slice(0, rpItemsHalfLen)}\n-                           contentRight={selectedResearchPurposeItems.slice(rpItemsHalfLen)}/>\n-        <div style={styles.sectionHeader}>\n-          Reason for choosing <i>All of Us</i> data for your investigation</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.reasonForAllOfUs}</div>\n-        <div style={styles.sectionHeader}>Area of intended study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.intendedStudy}</div>\n-        <div style={styles.sectionHeader}>Anticipated findings from this study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.anticipatedFindings}</div>\n-        {workspace.researchPurpose.population && <div style={{marginBottom: '1rem'}}>\n-          <div style={styles.sectionHeader}>Population area(s) of focus</div>\n-          <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                             contentLeft={this.getSelectedPopulationsSlice(true)}\n-                             contentRight={this.getSelectedPopulationsSlice(false)}/>\n+        <div style={styles.sectionContentContainer}>\n+          {selectedResearchPurposeItems.map((selectedResearchPurposeItem, i) => <div key={i}>\n+            <div style={{marginTop: '1rem'}}>{selectedResearchPurposeItem}</div>\n+          </div>)}\n+        </div>\n+        <div style={styles.sectionHeader}>Summary of research purpose</div>\n+        <div style={styles.sectionContentContainer}>\n+          <div style={styles.sectionSubHeader}>{researchPurposeQuestions[2].header}</div>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY5MDE2OQ=="}, "originalCommit": {"oid": "f4b6f793dc4aa139c0c967bc71201f518c85a4a9"}, "originalPosition": 126}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc2MTIzNQ==", "bodyText": "Done, have separated!", "url": "https://github.com/all-of-us/workbench/pull/3193#discussion_r384761235", "createdAt": "2020-02-26T20:58:14Z", "author": {"login": "s-rubenstein"}, "path": "ui/src/app/pages/workspace/research-purpose.tsx", "diffHunk": "@@ -41,51 +56,83 @@ export const ResearchPurpose = withCurrentWorkspace()(\n       };\n     }\n \n-    getSelectedPopulationsSlice(left: boolean) {\n-      const populations = getSelectedPopulations(this.props.workspace.researchPurpose);\n-      const populationsHalfLen = sliceByHalfLength(populations);\n-      if (left) {\n-        return populations.slice(0, populationsHalfLen);\n-      } else {\n-        return populations.slice(populationsHalfLen);\n-      }\n+    // TODO: Move this to an abstract function and also change the admin workspace to use it\n+    getSelectedPopulationsOfInterest() {\n+      const researchPurpose = this.props.workspace.researchPurpose;\n+      const categories = SpecificPopulationItems.filter(specificPopulationItem => specificPopulationItem\n+        .subCategory.filter(item => researchPurpose.populationDetails.includes(item.shortName)).length > 0);\n+      categories.forEach(category => category.subCategory = category.subCategory\n+        .filter(subCategoryItem => researchPurpose.populationDetails.includes(subCategoryItem.shortName)));\n+      return categories;\n     }\n \n     render() {\n       const {workspace} = this.props;\n       const {workspacePermissions} = this.state;\n       const selectedResearchPurposeItems = getSelectedResearchPurposeItems(this.props.workspace.researchPurpose);\n-      const rpItemsHalfLen = sliceByHalfLength(selectedResearchPurposeItems);\n+      const selectedPopulationsOfInterest = this.getSelectedPopulationsOfInterest();\n       return <FadeBox>\n-        <div style={styles.mainHeader}>Research Purpose\n+        <div style={styles.mainHeader}>Primary purpose of project\n           <Clickable disabled={!workspacePermissions.canWrite}\n+                     style={{display: 'flex', alignItems: 'center'}}\n                      data-test-id='edit-workspace'\n                      onClick={() => navigate(\n                        ['workspaces',  workspace.namespace, workspace.id, 'edit'])}>\n             <EditComponentReact enableHoverEffect={true}\n                                 disabled={!workspacePermissions.canWrite}\n-                                style={{marginTop: '0.1rem'}}/>\n+                                style={{marginTop: '0.1rem', height: 22,\n+                                  width: 22,\n+                                  fill: colors.light,\n+                                  backgroundColor: colors.accent,\n+                                  cursor: 'pointer',\n+                                  padding: '5px',\n+                                  borderRadius: '23px'}}/>\n           </Clickable>\n         </div>\n-        <div style={styles.sectionText}>{ResearchPurposeDescription}</div>\n-        <div style={styles.sectionHeader}>Primary purpose of the project</div>\n-        <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                           contentLeft={selectedResearchPurposeItems.slice(0, rpItemsHalfLen)}\n-                           contentRight={selectedResearchPurposeItems.slice(rpItemsHalfLen)}/>\n-        <div style={styles.sectionHeader}>\n-          Reason for choosing <i>All of Us</i> data for your investigation</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.reasonForAllOfUs}</div>\n-        <div style={styles.sectionHeader}>Area of intended study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.intendedStudy}</div>\n-        <div style={styles.sectionHeader}>Anticipated findings from this study</div>\n-        <div style={styles.sectionText}>{workspace.researchPurpose.anticipatedFindings}</div>\n-        {workspace.researchPurpose.population && <div style={{marginBottom: '1rem'}}>\n-          <div style={styles.sectionHeader}>Population area(s) of focus</div>\n-          <TwoColPaddedTable header={false} style={{marginTop: '0.3rem'}}\n-                             contentLeft={this.getSelectedPopulationsSlice(true)}\n-                             contentRight={this.getSelectedPopulationsSlice(false)}/>\n+        <div style={styles.sectionContentContainer}>\n+          {selectedResearchPurposeItems.map((selectedResearchPurposeItem, i) => <div key={i}>\n+            <div style={{marginTop: '1rem'}}>{selectedResearchPurposeItem}</div>\n+          </div>)}\n+        </div>\n+        <div style={styles.sectionHeader}>Summary of research purpose</div>\n+        <div style={styles.sectionContentContainer}>\n+          <div style={styles.sectionSubHeader}>{researchPurposeQuestions[2].header}</div>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDY5MDE2OQ=="}, "originalCommit": {"oid": "f4b6f793dc4aa139c0c967bc71201f518c85a4a9"}, "originalPosition": 126}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3155, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}