{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg1MzMzNTkw", "number": 3994, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxODozODozMFrOEipnWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxOTo1OToxM1rOEirJEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NzY4ODU2OnYy", "diffSide": "RIGHT", "path": "ui/src/app/components/help-sidebar.tsx", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxODozODozMFrOHQpr6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxOToyMDo0N1rOHQrBLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyMjI0OA==", "bodyText": "It looks sort of grayed out - is the opacity the issue?", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487222248", "createdAt": "2020-09-11T18:38:30Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +248,25 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (\n+    enableCustomRuntimes\n+    && (\n+      workspaceAccessLevel === WorkspaceAccessLevel.OWNER\n+      || workspaceAccessLevel === WorkspaceAccessLevel.WRITER\n+    )\n+  ) {\n+    return [...iconsList, {\n+      id: 'thunderstorm',\n+      disabled: true,\n+      faIcon: null,\n+      label: 'Cloud Icon',\n+      page: null,\n+      style: {height: '22px', width: '22px', marginTop: '0.25rem', opacity: 0.5},", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyNzM4Ng==", "bodyText": "Ah, yes, it is. I initially assumed it had to do with the disabled attribute. I can make it actually condition on that or I can just not since it's behind a feature flag and we're about to implement the panel content anyways", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487227386", "createdAt": "2020-09-11T18:49:29Z", "author": {"login": "als364"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +248,25 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (\n+    enableCustomRuntimes\n+    && (\n+      workspaceAccessLevel === WorkspaceAccessLevel.OWNER\n+      || workspaceAccessLevel === WorkspaceAccessLevel.WRITER\n+    )\n+  ) {\n+    return [...iconsList, {\n+      id: 'thunderstorm',\n+      disabled: true,\n+      faIcon: null,\n+      label: 'Cloud Icon',\n+      page: null,\n+      style: {height: '22px', width: '22px', marginTop: '0.25rem', opacity: 0.5},", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyMjI0OA=="}, "originalCommit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzMTA5MQ==", "bodyText": "Yeah - I think just drop it and make this undisabled, looks like some other styling gets added if the icon is disabled, though I don't totally follow the code.\nI also think there's an argument to make the disabled status contingent on writer access, rather than hiding the icon. This isn't clearly spec'd out in the PRD or mocks, but I think most of our existing UI patterns disable the control if you lack permissions.", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487231091", "createdAt": "2020-09-11T18:57:24Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +248,25 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (\n+    enableCustomRuntimes\n+    && (\n+      workspaceAccessLevel === WorkspaceAccessLevel.OWNER\n+      || workspaceAccessLevel === WorkspaceAccessLevel.WRITER\n+    )\n+  ) {\n+    return [...iconsList, {\n+      id: 'thunderstorm',\n+      disabled: true,\n+      faIcon: null,\n+      label: 'Cloud Icon',\n+      page: null,\n+      style: {height: '22px', width: '22px', marginTop: '0.25rem', opacity: 0.5},", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyMjI0OA=="}, "originalCommit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNjY1OA==", "bodyText": "The styling is just changing the cursor to a circle with a slash through it.\nI agree that there's an argument for conditioning the disabled status on writer access rather than hiding the icon, but I did run this by both Shimon and Lou and they both prefer to have the icon hidden if the user isn't at least a writer.", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487236658", "createdAt": "2020-09-11T19:09:11Z", "author": {"login": "als364"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +248,25 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (\n+    enableCustomRuntimes\n+    && (\n+      workspaceAccessLevel === WorkspaceAccessLevel.OWNER\n+      || workspaceAccessLevel === WorkspaceAccessLevel.WRITER\n+    )\n+  ) {\n+    return [...iconsList, {\n+      id: 'thunderstorm',\n+      disabled: true,\n+      faIcon: null,\n+      label: 'Cloud Icon',\n+      page: null,\n+      style: {height: '22px', width: '22px', marginTop: '0.25rem', opacity: 0.5},", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyMjI0OA=="}, "originalCommit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca"}, "originalPosition": 101}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI0NDA3Ng==", "bodyText": "OK, cool, didn't realize you had already covered this with Lou and Shimon. Sounds good - then I'd just hardcode it to disabled: false for now and drop the opacity styling.", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487244076", "createdAt": "2020-09-11T19:20:47Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +248,25 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (\n+    enableCustomRuntimes\n+    && (\n+      workspaceAccessLevel === WorkspaceAccessLevel.OWNER\n+      || workspaceAccessLevel === WorkspaceAccessLevel.WRITER\n+    )\n+  ) {\n+    return [...iconsList, {\n+      id: 'thunderstorm',\n+      disabled: true,\n+      faIcon: null,\n+      label: 'Cloud Icon',\n+      page: null,\n+      style: {height: '22px', width: '22px', marginTop: '0.25rem', opacity: 0.5},", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyMjI0OA=="}, "originalCommit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca"}, "originalPosition": 101}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NzY5MTE4OnYy", "diffSide": "RIGHT", "path": "ui/src/app/components/help-sidebar.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxODozOToyMFrOHQptkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxODozOToyMFrOHQptkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIyMjY3Mg==", "bodyText": "nit: can use this canWrite util: \n  \n    \n      workbench/ui/src/app/utils/workspace-permissions.ts\n    \n    \n         Line 4\n      in\n      28f2caa\n    \n    \n    \n    \n\n        \n          \n           export function canWrite(accessLevel: WorkspaceAccessLevel) {", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487222672", "createdAt": "2020-09-11T18:39:20Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +248,25 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (\n+    enableCustomRuntimes\n+    && (\n+      workspaceAccessLevel === WorkspaceAccessLevel.OWNER", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78560b8b42e050da4141da640b6be71fedb597ca"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NzkxOTg1OnYy", "diffSide": "RIGHT", "path": "ui/src/app/components/help-sidebar.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxOTo1MzozNVrOHQr7sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQyMDowMDoyMlrOHQsI9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI1OTA1OA==", "bodyText": "Was this a bug?\nalso nit: !icon.disabled seems more natural", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487259058", "createdAt": "2020-09-11T19:53:35Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -515,12 +541,12 @@ export const HelpSidebar = fp.flow(withCurrentWorkspace(), withUserProfile(), wi\n       return <React.Fragment>\n         <div style={notebookStyles ? {...styles.iconContainer, ...styles.notebookOverrides} : {...styles.iconContainer}}>\n           {!criteria && this.renderWorkspaceMenu()}\n-          {icons(helpContentKey).map((icon, i) =>\n+          {icons(helpContentKey, serverConfigStore.getValue().enableCustomRuntimes, workspace.accessLevel).map((icon, i) =>\n           this.showIcon(icon) && <div key={i} style={{display: 'table'}}>\n                 <TooltipTrigger content={<div>{tooltipId === i && icon.tooltip}</div>} side='left'>\n                   <div style={activeIcon === icon.id ? iconStyles.active : icon.disabled ? iconStyles.disabled : styles.icon}\n                        onClick={() => {\n-                         if (icon.id !== 'dataDictionary') {\n+                         if (icon.id !== 'dataDictionary' && icon.disabled === false) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "216ca2955a2211ec81fcede464df9b447fd44c26"}, "originalPosition": 131}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI2MjQ1Mw==", "bodyText": "Yeah - it was opening on click even when disabled", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487262453", "createdAt": "2020-09-11T20:00:22Z", "author": {"login": "als364"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -515,12 +541,12 @@ export const HelpSidebar = fp.flow(withCurrentWorkspace(), withUserProfile(), wi\n       return <React.Fragment>\n         <div style={notebookStyles ? {...styles.iconContainer, ...styles.notebookOverrides} : {...styles.iconContainer}}>\n           {!criteria && this.renderWorkspaceMenu()}\n-          {icons(helpContentKey).map((icon, i) =>\n+          {icons(helpContentKey, serverConfigStore.getValue().enableCustomRuntimes, workspace.accessLevel).map((icon, i) =>\n           this.showIcon(icon) && <div key={i} style={{display: 'table'}}>\n                 <TooltipTrigger content={<div>{tooltipId === i && icon.tooltip}</div>} side='left'>\n                   <div style={activeIcon === icon.id ? iconStyles.active : icon.disabled ? iconStyles.disabled : styles.icon}\n                        onClick={() => {\n-                         if (icon.id !== 'dataDictionary') {\n+                         if (icon.id !== 'dataDictionary' && icon.disabled === false) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI1OTA1OA=="}, "originalCommit": {"oid": "216ca2955a2211ec81fcede464df9b447fd44c26"}, "originalPosition": 131}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0NzkzODc1OnYy", "diffSide": "RIGHT", "path": "ui/src/app/components/help-sidebar.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxOTo1OToxM1rOHQsGmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMVQxOTo1OToxM1rOHQsGmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzI2MTg1MA==", "bodyText": "Adding a test case which demonstrates that this is only shown for writable workspaces would be nice, to exercise this branch", "url": "https://github.com/all-of-us/workbench/pull/3994#discussion_r487261850", "createdAt": "2020-09-11T19:59:13Z", "author": {"login": "calbach"}, "path": "ui/src/app/components/help-sidebar.tsx", "diffHunk": "@@ -237,6 +250,19 @@ const icons = (helpContentKey: string) => {\n       style: {fontSize: '20px', marginLeft: '3px'},\n       tooltip: 'Annotations',\n     }];\n+  if (enableCustomRuntimes && canWrite(workspaceAccessLevel)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b01565f92d3b09a7b85abeb105a95d088eed7fc"}, "originalPosition": 95}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4060, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}