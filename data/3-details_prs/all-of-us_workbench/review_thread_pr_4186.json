{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2MTE2NjE0", "number": 4186, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNjozOTo0NVrOEvZ5Hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxODozNjoxOFrOEvc_gg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MTQyNzUxOnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNjozOTo0NVrOHkXjPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxNjozOTo0NVrOHkXjPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzg5NjYzOA==", "bodyText": "no changes to any of these - just formatting", "url": "https://github.com/all-of-us/workbench/pull/4186#discussion_r507896638", "createdAt": "2020-10-19T16:39:45Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -2,35 +2,58 @@ import {Component, Input} from '@angular/core';\n \n import {Clickable} from 'app/components/buttons';\n import colors from 'app/styles/colors';\n-import {reactStyles, ReactWrapperBase, withCurrentWorkspace, withUrlParams} from 'app/utils';\n+import {\n+  cdrVersion,\n+  reactStyles,\n+  ReactWrapperBase,\n+  withCdrVersions,\n+  withCurrentWorkspace,\n+  withUrlParams\n+} from 'app/utils';\n import {NavStore} from 'app/utils/navigation';\n \n import {serverConfigStore} from 'app/utils/navigation';\n import * as fp from 'lodash/fp';\n import * as React from 'react';\n \n-\n const styles = reactStyles({\n   container: {\n-    display: 'flex', alignItems: 'center', backgroundColor: colors.secondary,\n-    fontWeight: 500, color: 'white', textTransform: 'uppercase',\n-    height: 60, paddingRight: 16,\n+    display: 'flex',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fce4e05b40a4dbf2ac33851dfa8fa4adc41a5e2f"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MTkyNjM3OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-about.tsx", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxODozMzo1N1rOHkcdzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzoxNDowOFrOHlIqNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3NzE2NQ==", "bodyText": "is checking for the workspace sufficient here? What if cdrVersionListResponse is still loading?", "url": "https://github.com/all-of-us/workbench/pull/4186#discussion_r507977165", "createdAt": "2020-10-19T18:33:57Z", "author": {"login": "ericsong"}, "path": "ui/src/app/pages/workspace/workspace-about.tsx", "diffHunk": "@@ -244,7 +239,7 @@ export const WorkspaceAbout = fp.flow(withUserProfile(), withUrlParams(), withCd\n           </h3>\n           <div style={styles.infoBox} data-test-id='cdrVersion'>\n             <div style={styles.infoBoxHeader}>Dataset</div>\n-            <div style={{fontSize: '0.5rem'}}>{cdrVersion ? cdrVersion.name : 'Loading...'}</div>\n+            <div style={{fontSize: '0.5rem'}}>{workspace ? cdrVersion(workspace, cdrVersionListResponse).name : 'Loading...'}</div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb6901368577f8e42cc2c2a04fb1e67adb232308"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAwODIxMQ==", "bodyText": "There's a comment on the withCdrVersions() HOC: \"Rendering of the connected component is blocked on initial load of the CDR versions.\"", "url": "https://github.com/all-of-us/workbench/pull/4186#discussion_r508008211", "createdAt": "2020-10-19T19:26:51Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-about.tsx", "diffHunk": "@@ -244,7 +239,7 @@ export const WorkspaceAbout = fp.flow(withUserProfile(), withUrlParams(), withCd\n           </h3>\n           <div style={styles.infoBox} data-test-id='cdrVersion'>\n             <div style={styles.infoBoxHeader}>Dataset</div>\n-            <div style={{fontSize: '0.5rem'}}>{cdrVersion ? cdrVersion.name : 'Loading...'}</div>\n+            <div style={{fontSize: '0.5rem'}}>{workspace ? cdrVersion(workspace, cdrVersionListResponse).name : 'Loading...'}</div>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3NzE2NQ=="}, "originalCommit": {"oid": "eb6901368577f8e42cc2c2a04fb1e67adb232308"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODcwMTIzOA==", "bodyText": "Oops.  Looks like you were right: #4191\nThe comment above is correct.  the HOC withCdrVersions() blocks rendering until it's present because it's a ReplaySubject.  withCurrentWorkspace() is a BehaviorSubject, which doesn't have this feature unless a flag is explicitly set for it.", "url": "https://github.com/all-of-us/workbench/pull/4186#discussion_r508701238", "createdAt": "2020-10-20T17:14:08Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-about.tsx", "diffHunk": "@@ -244,7 +239,7 @@ export const WorkspaceAbout = fp.flow(withUserProfile(), withUrlParams(), withCd\n           </h3>\n           <div style={styles.infoBox} data-test-id='cdrVersion'>\n             <div style={styles.infoBoxHeader}>Dataset</div>\n-            <div style={{fontSize: '0.5rem'}}>{cdrVersion ? cdrVersion.name : 'Loading...'}</div>\n+            <div style={{fontSize: '0.5rem'}}>{workspace ? cdrVersion(workspace, cdrVersionListResponse).name : 'Loading...'}</div>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3NzE2NQ=="}, "originalCommit": {"oid": "eb6901368577f8e42cc2c2a04fb1e67adb232308"}, "originalPosition": 55}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MTkzMjE5OnYy", "diffSide": "RIGHT", "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxODozNToyN1rOHkchWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzoyODo0N1rOHlJOrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3ODA3Mg==", "bodyText": "do we need this check for a workspace if we're already doing that in the parent component before rendering this?", "url": "https://github.com/all-of-us/workbench/pull/4186#discussion_r507978072", "createdAt": "2020-10-19T18:35:27Z", "author": {"login": "ericsong"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -81,6 +104,9 @@ export const WorkspaceNavBarReact = fp.flow(\n     {activeTabIndex > 0 && navSeparator}\n     {fp.map(tab => navTab(tab, restrictTab(props.workspace, tab)), tabs)}\n     <div style={{flexGrow: 1}}/>\n+    {workspace && <div data-test-id='cdr-version' style={{textTransform: 'none'}}>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb6901368577f8e42cc2c2a04fb1e67adb232308"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAwNjQyNw==", "bodyText": "That was also my assumption, but workspace is initially undefined here.  I don't know why.", "url": "https://github.com/all-of-us/workbench/pull/4186#discussion_r508006427", "createdAt": "2020-10-19T19:23:37Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -81,6 +104,9 @@ export const WorkspaceNavBarReact = fp.flow(\n     {activeTabIndex > 0 && navSeparator}\n     {fp.map(tab => navTab(tab, restrictTab(props.workspace, tab)), tabs)}\n     <div style={{flexGrow: 1}}/>\n+    {workspace && <div data-test-id='cdr-version' style={{textTransform: 'none'}}>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3ODA3Mg=="}, "originalCommit": {"oid": "eb6901368577f8e42cc2c2a04fb1e67adb232308"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODcxMDU3Mw==", "bodyText": "This line got dropped somehow.  Re-added in #4191", "url": "https://github.com/all-of-us/workbench/pull/4186#discussion_r508710573", "createdAt": "2020-10-20T17:28:47Z", "author": {"login": "jmthibault79"}, "path": "ui/src/app/pages/workspace/workspace-nav-bar.tsx", "diffHunk": "@@ -81,6 +104,9 @@ export const WorkspaceNavBarReact = fp.flow(\n     {activeTabIndex > 0 && navSeparator}\n     {fp.map(tab => navTab(tab, restrictTab(props.workspace, tab)), tabs)}\n     <div style={{flexGrow: 1}}/>\n+    {workspace && <div data-test-id='cdr-version' style={{textTransform: 'none'}}>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3ODA3Mg=="}, "originalCommit": {"oid": "eb6901368577f8e42cc2c2a04fb1e67adb232308"}, "originalPosition": 88}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE4MTkzNTM4OnYy", "diffSide": "RIGHT", "path": "ui/src/app/utils/index.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxODozNjoxOFrOHkcjNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxODozNjoxOFrOHkcjNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzk3ODU1MA==", "bodyText": "can you add a verb to the function? I wasn't really sure what it did until I found the definition.", "url": "https://github.com/all-of-us/workbench/pull/4186#discussion_r507978550", "createdAt": "2020-10-19T18:36:18Z", "author": {"login": "ericsong"}, "path": "ui/src/app/utils/index.tsx", "diffHunk": "@@ -627,3 +630,7 @@ export function validateInputForMySQL(searchString: string): Array<string> {\n   }\n   return Array.from(inputErrors);\n }\n+\n+export function cdrVersion(workspace: Workspace, cdrs: CdrVersionListResponse): CdrVersion {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb6901368577f8e42cc2c2a04fb1e67adb232308"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3856, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}