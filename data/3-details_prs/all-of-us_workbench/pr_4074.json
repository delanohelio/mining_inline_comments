{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0MTM3OTMx", "number": 4074, "title": "[RW-5642][risk=no] work around Swagger inconsistency for Typescript Date types", "bodyText": "Somehow Swagger is serializing date-time objects in an incompatible way with the constructor of the declared type in the generated Typescript code. See PR for more details & breadcrumbs.\nFix is simply to take the fields from this wire object and  build a Date from them using the piecewise constructor.\n\n\nPR checklist\n\n This PR meets the Acceptance Criteria in the JIRA story\n The JIRA story has been moved to Dev Review\n This PR includes appropriate unit tests\n I have run and tested this change locally\n I have run the E2E tests on ths change against my local UI + API server with yarn test-local\n If this includes a UI change, I have taken screen recordings or screenshots of the new behavior and notified the PO and UX designer\n If this includes an API change, I have updated the appropriate Swagger definitions and notified API consumers\n If this includes a new feature flag, I have created and linked new JIRA tickets to (a) turn on the feature flag and (b) remove it later", "createdAt": "2020-09-28T13:20:24Z", "url": "https://github.com/all-of-us/workbench/pull/4074", "merged": true, "mergeCommit": {"oid": "3f407937e02ffcc470cfa44b502d1dd043b17d43"}, "closed": true, "closedAt": "2020-10-01T15:17:40Z", "author": {"login": "jaycarlton"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNTeJ3gH2gAyNDk0MTM3OTMxOjkyMzNkYTM4NzQ0YWY2Y2E5OGZiZWRlNTg4MjBkZTg4YjUwYzExZjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOSu-3gH2gAyNDk0MTM3OTMxOjEzZTJhMzgzNWIzZTliNjU4NDQzYTJkNTllMzc2MWUyODhjMmZiZGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9233da38744af6ca98fbede58820de88b50c11f6", "author": {"user": {"login": "jaycarlton", "name": "Jay Carlton"}}, "url": "https://github.com/all-of-us/workbench/commit/9233da38744af6ca98fbede58820de88b50c11f6", "committedDate": "2020-09-28T13:19:23Z", "message": "attempt 1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ae92aa19d5c4c66a30fa3b91a7aaee85cd3e97e", "author": {"user": {"login": "jaycarlton", "name": "Jay Carlton"}}, "url": "https://github.com/all-of-us/workbench/commit/7ae92aa19d5c4c66a30fa3b91a7aaee85cd3e97e", "committedDate": "2020-09-28T15:30:36Z", "message": "fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43e55dfc0a19497fae94c11b4a6404b0886674ec", "author": {"user": {"login": "jaycarlton", "name": "Jay Carlton"}}, "url": "https://github.com/all-of-us/workbench/commit/43e55dfc0a19497fae94c11b4a6404b0886674ec", "committedDate": "2020-09-28T15:31:24Z", "message": "restore file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NzQ5NjQz", "url": "https://github.com/all-of-us/workbench/pull/4074#pullrequestreview-497749643", "createdAt": "2020-09-28T17:30:00Z", "commit": {"oid": "43e55dfc0a19497fae94c11b4a6404b0886674ec"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNzozMDowMVrOHZIpdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNzozMDowMVrOHZIpdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjExODEzNA==", "bodyText": "If this is actually what we're getting on the wire, then surely it's a bug with the JSON serialization on the server; I can't imagine this verbose payload is the expect wire format for Swagger. This seems like a serialization of some internal Java object representation, i.e. the JSON serialization (presumably for java8 dateLibrary) with date-time does not work.\nIf it's a serialization issue, then patching over it on the client side seems incorrect to me.\nFor now, it may be easier for consistency to follow the unix millis pattern used in the rest of the API (though I would prefer we eventually switch to a string representation instead per https://precisionmedicineinitiative.atlassian.net/browse/RW-4682):\n      creationTime:\n        type: integer\n        format: int64\n        description: Milliseconds since the UNIX epoch.", "url": "https://github.com/all-of-us/workbench/pull/4074#discussion_r496118134", "createdAt": "2020-09-28T17:30:01Z", "author": {"login": "calbach"}, "path": "ui/src/app/utils/swagger-date.ts", "diffHunk": "@@ -0,0 +1,33 @@\n+\n+// Inferred structure of JSON object coming down the wire for a date-time in Swagger. It's apparently\n+// not a Date as advertised.\n+export interface DateObjectProps {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43e55dfc0a19497fae94c11b4a6404b0886674ec"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ddc4b467b8439f7550a559fd7865a514d8d1408", "author": {"user": {"login": "jaycarlton", "name": "Jay Carlton"}}, "url": "https://github.com/all-of-us/workbench/commit/3ddc4b467b8439f7550a559fd7865a514d8d1408", "committedDate": "2020-09-29T11:33:09Z", "message": "Merge branch 'master' into jaycarlton/RW-5642"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70b709ce60cfedda4c6ce9fd9d5695748bed0d18", "author": {"user": {"login": "jaycarlton", "name": "Jay Carlton"}}, "url": "https://github.com/all-of-us/workbench/commit/70b709ce60cfedda4c6ce9fd9d5695748bed0d18", "committedDate": "2020-09-30T14:20:24Z", "message": "Merge branch 'master' into jaycarlton/RW-5642"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "754226380e97525d085babb3d5edffae674e8d22", "author": {"user": {"login": "jaycarlton", "name": "Jay Carlton"}}, "url": "https://github.com/all-of-us/workbench/commit/754226380e97525d085babb3d5edffae674e8d22", "committedDate": "2020-09-30T14:39:14Z", "message": "use epoch millis in response type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7c084e78b82a1b099c5469ea863af7ed8370d16", "author": {"user": {"login": "jaycarlton", "name": "Jay Carlton"}}, "url": "https://github.com/all-of-us/workbench/commit/e7c084e78b82a1b099c5469ea863af7ed8370d16", "committedDate": "2020-09-30T15:22:48Z", "message": "use millis instead of trying to serialize actual date-time object"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NjA4OTY1", "url": "https://github.com/all-of-us/workbench/pull/4074#pullrequestreview-499608965", "createdAt": "2020-09-30T16:26:31Z", "commit": {"oid": "e7c084e78b82a1b099c5469ea863af7ed8370d16"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5ODI4NTE4", "url": "https://github.com/all-of-us/workbench/pull/4074#pullrequestreview-499828518", "createdAt": "2020-09-30T21:33:52Z", "commit": {"oid": "e7c084e78b82a1b099c5469ea863af7ed8370d16"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1a74fbf76f0b54425a833664e3f36761a1c2b4d", "author": {"user": {"login": "jaycarlton", "name": "Jay Carlton"}}, "url": "https://github.com/all-of-us/workbench/commit/e1a74fbf76f0b54425a833664e3f36761a1c2b4d", "committedDate": "2020-10-01T14:51:21Z", "message": "Merge branch 'master' into jaycarlton/RW-5642"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13e2a3835b3e9b658443a2d59e3761e288c2fbdd", "author": {"user": {"login": "jaycarlton", "name": "Jay Carlton"}}, "url": "https://github.com/all-of-us/workbench/commit/13e2a3835b3e9b658443a2d59e3761e288c2fbdd", "committedDate": "2020-10-01T15:01:47Z", "message": "unit test updates"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4118, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}