{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NDQ2NTAw", "number": 3013, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxODoxNjowMVrODZAgIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxODoxNzoxNFrODZAgVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3NTQ5MjE5OnYy", "diffSide": "RIGHT", "path": "api/db/changelog/db.changelog-115-addColumn-user-create-modified.xml", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxODoxNjowMVrOFfLnww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxODo0MToyOFrOFfLtHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MDU3OQ==", "bodyText": "No, we can't have this. The entire point of Liquibase is that it's idempotent, and if it's at a state, it got there by playing everything before it successfully.\nCan we just restore the database from a backup and run a migration from there?", "url": "https://github.com/all-of-us/workbench/pull/3013#discussion_r368240579", "createdAt": "2020-01-18T18:16:01Z", "author": {"login": "jaycarlton"}, "path": "api/db/changelog/db.changelog-115-addColumn-user-create-modified.xml", "diffHunk": "@@ -5,12 +5,17 @@\n     xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog/1.9\n                     http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd\">\n   <changeSet author=\"nsaxena\" id=\"db.changelog-115-addColumn-user-create-modified-with-null-constraint-and-default\">\n+    <preConditions onFail=\"MARK_RAN\" > ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8683901997becd8523f89aa1aec0315a4b901cc"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MDc2Ng==", "bodyText": "This was not the ideal solution we wanted to do however I had to do this just because i cannot run ALTER commands on test DB and we deleted the entry in databasechangelog for changeset", "url": "https://github.com/all-of-us/workbench/pull/3013#discussion_r368240766", "createdAt": "2020-01-18T18:19:28Z", "author": {"login": "NehaBroad"}, "path": "api/db/changelog/db.changelog-115-addColumn-user-create-modified.xml", "diffHunk": "@@ -5,12 +5,17 @@\n     xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog/1.9\n                     http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd\">\n   <changeSet author=\"nsaxena\" id=\"db.changelog-115-addColumn-user-create-modified-with-null-constraint-and-default\">\n+    <preConditions onFail=\"MARK_RAN\" > ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MDU3OQ=="}, "originalCommit": {"oid": "c8683901997becd8523f89aa1aec0315a4b901cc"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MTg0NQ==", "bodyText": "That's kinda what I figured.", "url": "https://github.com/all-of-us/workbench/pull/3013#discussion_r368241845", "createdAt": "2020-01-18T18:39:37Z", "author": {"login": "jaycarlton"}, "path": "api/db/changelog/db.changelog-115-addColumn-user-create-modified.xml", "diffHunk": "@@ -5,12 +5,17 @@\n     xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog/1.9\n                     http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd\">\n   <changeSet author=\"nsaxena\" id=\"db.changelog-115-addColumn-user-create-modified-with-null-constraint-and-default\">\n+    <preConditions onFail=\"MARK_RAN\" > ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MDU3OQ=="}, "originalCommit": {"oid": "c8683901997becd8523f89aa1aec0315a4b901cc"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MTk1MA==", "bodyText": "We will definitely need a way to obtain such access for the oncall engineer when needed.", "url": "https://github.com/all-of-us/workbench/pull/3013#discussion_r368241950", "createdAt": "2020-01-18T18:41:28Z", "author": {"login": "jaycarlton"}, "path": "api/db/changelog/db.changelog-115-addColumn-user-create-modified.xml", "diffHunk": "@@ -5,12 +5,17 @@\n     xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog/1.9\n                     http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd\">\n   <changeSet author=\"nsaxena\" id=\"db.changelog-115-addColumn-user-create-modified-with-null-constraint-and-default\">\n+    <preConditions onFail=\"MARK_RAN\" > ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MDU3OQ=="}, "originalCommit": {"oid": "c8683901997becd8523f89aa1aec0315a4b901cc"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI3NTQ5MjcwOnYy", "diffSide": "RIGHT", "path": "api/db/changelog/db.changelog-115-addColumn-user-create-modified.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxODoxNzoxNFrOFfLoBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxODoyNDoxM1rOFfLpbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MDY0NA==", "bodyText": "We should just delete this changeset and start at 120 if it failed. I think that's more correct. 115 should never be in the history for two different databases with different semantics.", "url": "https://github.com/all-of-us/workbench/pull/3013#discussion_r368240644", "createdAt": "2020-01-18T18:17:14Z", "author": {"login": "jaycarlton"}, "path": "api/db/changelog/db.changelog-115-addColumn-user-create-modified.xml", "diffHunk": "@@ -5,12 +5,17 @@\n     xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog/1.9\n                     http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd\">\n   <changeSet author=\"nsaxena\" id=\"db.changelog-115-addColumn-user-create-modified-with-null-constraint-and-default\">\n+    <preConditions onFail=\"MARK_RAN\" > \n+      <not>         \n+        <columnExists tableName=\"user\" columnName=\"creation_time\" />\n+      </not>\n+    </preConditions>\n     <addColumn tableName=\"user\">\n-      <column name=\"creation_time\" type=\"datetime\" defaultValueDate=\"1970-01-01 00:00:00\">\n-        <constraints nullable=\"false\" />\n+      <column name=\"creation_time\" type=\"datetime\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8683901997becd8523f89aa1aec0315a4b901cc"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MTAwNg==", "bodyText": "what do you mean by 120?", "url": "https://github.com/all-of-us/workbench/pull/3013#discussion_r368241006", "createdAt": "2020-01-18T18:24:13Z", "author": {"login": "NehaBroad"}, "path": "api/db/changelog/db.changelog-115-addColumn-user-create-modified.xml", "diffHunk": "@@ -5,12 +5,17 @@\n     xsi:schemaLocation=\"http://www.liquibase.org/xml/ns/dbchangelog/1.9\n                     http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd\">\n   <changeSet author=\"nsaxena\" id=\"db.changelog-115-addColumn-user-create-modified-with-null-constraint-and-default\">\n+    <preConditions onFail=\"MARK_RAN\" > \n+      <not>         \n+        <columnExists tableName=\"user\" columnName=\"creation_time\" />\n+      </not>\n+    </preConditions>\n     <addColumn tableName=\"user\">\n-      <column name=\"creation_time\" type=\"datetime\" defaultValueDate=\"1970-01-01 00:00:00\">\n-        <constraints nullable=\"false\" />\n+      <column name=\"creation_time\" type=\"datetime\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0MDY0NA=="}, "originalCommit": {"oid": "c8683901997becd8523f89aa1aec0315a4b901cc"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3450, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}