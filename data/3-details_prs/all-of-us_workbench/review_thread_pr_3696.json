{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NDk0NDU2", "number": 3696, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNDoyNDozNFrOEH_kfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNDozODo1NVrOEIABNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2ODE3MDIyOnYy", "diffSide": "RIGHT", "path": "e2e/app/component/share-modal.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNDoyNDozNFrOGnrxZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMDoyODoxMFrOGpQD1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI2NDgwNA==", "bodyText": "Can you change to ShareModal extends Dialog so common methods are not duplicated?", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r444264804", "createdAt": "2020-06-23T14:24:34Z", "author": {"login": "aweng98"}, "path": "e2e/app/component/share-modal.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import Container from 'app/container';\n+import {ElementHandle, Page} from 'puppeteer';\n+import {WorkspaceAccessLevel} from 'app/page-identifiers';\n+import {ElementType} from 'app/xpath-options';\n+import Button from 'app/element/button';\n+import Textbox from 'app/element/textbox';\n+import ClrIcon from 'app/element/clr-icon-link';\n+\n+\n+export enum ButtonLabel {\n+  Cancel = 'Cancel',\n+  Save = 'Save'\n+}\n+\n+const Selector = {\n+  defaultDialog: '//*[@role=\"dialog\"]',\n+}\n+\n+export default class ShareModal extends Container {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNzkyNg==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r445907926", "createdAt": "2020-06-26T00:28:10Z", "author": {"login": "calbach"}, "path": "e2e/app/component/share-modal.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import Container from 'app/container';\n+import {ElementHandle, Page} from 'puppeteer';\n+import {WorkspaceAccessLevel} from 'app/page-identifiers';\n+import {ElementType} from 'app/xpath-options';\n+import Button from 'app/element/button';\n+import Textbox from 'app/element/textbox';\n+import ClrIcon from 'app/element/clr-icon-link';\n+\n+\n+export enum ButtonLabel {\n+  Cancel = 'Cancel',\n+  Save = 'Save'\n+}\n+\n+const Selector = {\n+  defaultDialog: '//*[@role=\"dialog\"]',\n+}\n+\n+export default class ShareModal extends Container {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI2NDgwNA=="}, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2ODE4MzIyOnYy", "diffSide": "RIGHT", "path": "e2e/app/component/share-modal.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNDoyNzoxNVrOGnr5ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMDoyNToyOVrOGpQBRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI2Njg3NQ==", "bodyText": "nit: Line #84 is unnecessary here because the click() takes care the finding element too.\nasync click(options?: ClickOptions): Promise<void> {\n    return (await this.asElementHandle()).click(options);\n  }", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r444266875", "createdAt": "2020-06-23T14:27:15Z", "author": {"login": "aweng98"}, "path": "e2e/app/component/share-modal.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import Container from 'app/container';\n+import {ElementHandle, Page} from 'puppeteer';\n+import {WorkspaceAccessLevel} from 'app/page-identifiers';\n+import {ElementType} from 'app/xpath-options';\n+import Button from 'app/element/button';\n+import Textbox from 'app/element/textbox';\n+import ClrIcon from 'app/element/clr-icon-link';\n+\n+\n+export enum ButtonLabel {\n+  Cancel = 'Cancel',\n+  Save = 'Save'\n+}\n+\n+const Selector = {\n+  defaultDialog: '//*[@role=\"dialog\"]',\n+}\n+\n+export default class ShareModal extends Container {\n+\n+  constructor(page: Page, xpath: string = Selector.defaultDialog) {\n+    super(page, xpath);\n+  }\n+\n+  async shareWithUser(username: string, level: WorkspaceAccessLevel): Promise<void> {\n+    const searchBox = await this.waitForSearchBox();\n+    await searchBox.type(username);\n+\n+    const addCollab = await this.waitForAddCollaboratorIcon();\n+    await addCollab.click();\n+\n+    const roleInput = await this.waitForRoleSelectorForUser(username);\n+    await roleInput.click();\n+\n+    const ownerOpt = await this.waitForRoleOption(level);\n+    await ownerOpt.click();\n+\n+    await this.clickButton(ButtonLabel.Save);\n+    await this.waitUntilDialogIsClosed();\n+  }\n+\n+  async removeUser(username: string): Promise<void> {\n+    const rmCollab = await this.page.waitForXPath(\n+      `${this.collabRowXPath(username)}//clr-icon[@shape=\"minus-circle\"]`);\n+    await rmCollab.click();\n+\n+    await this.clickButton(ButtonLabel.Save);\n+    await this.waitUntilDialogIsClosed();\n+    return;\n+  }\n+\n+  /**\n+   * Creates an xpath to a share \"row\" for a given user within the modal. This\n+   * can be combined with a child selector to pull out a control for a user.\n+   */\n+  private collabRowXPath(username: string): string {\n+    // We dip into child contents to find the collab user row element parent.\n+    // .//div filters by a relative path to the parent row.\n+    return `//*[@data-test-id=\"collab-user-row\" and .//div[` +\n+        `@data-test-id=\"collab-user-email\" and contains(text(),\"${username}\")]]`;\n+  }\n+\n+  async clickButton(buttonLabel: ButtonLabel): Promise<void> {\n+    const button = await this.waitForButton(buttonLabel);\n+    await button.waitUntilEnabled();\n+    return button.click();\n+  }\n+\n+  async waitForButton(buttonLabel: ButtonLabel): Promise<Button> {\n+    return Button.findByName(this.page, {containsText: buttonLabel, type: ElementType.Button}, this);\n+  }\n+\n+  async waitForSearchBox(): Promise<Textbox> {\n+    return Textbox.findByName(this.page, {name: 'Find Collaborators'}, this);\n+  }\n+\n+  async waitForAddCollaboratorIcon(): Promise<ClrIcon> {\n+    return ClrIcon.findByName(this.page, {iconShape: 'plus-circle'}, this);\n+  }\n+\n+  async waitForRoleSelectorForUser(username: string): Promise<Textbox> {\n+    const box = new Textbox(\n+      this.page, `${this.collabRowXPath(username)}//input[@type=\"text\"]`);\n+    await box.waitForXPath({visible: true});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNzI2OA==", "bodyText": "Hmm.. is that obvious? I'm not sure I would have expected that calling click() indirectly also waits for the element to become visible.", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r445907268", "createdAt": "2020-06-26T00:25:29Z", "author": {"login": "calbach"}, "path": "e2e/app/component/share-modal.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import Container from 'app/container';\n+import {ElementHandle, Page} from 'puppeteer';\n+import {WorkspaceAccessLevel} from 'app/page-identifiers';\n+import {ElementType} from 'app/xpath-options';\n+import Button from 'app/element/button';\n+import Textbox from 'app/element/textbox';\n+import ClrIcon from 'app/element/clr-icon-link';\n+\n+\n+export enum ButtonLabel {\n+  Cancel = 'Cancel',\n+  Save = 'Save'\n+}\n+\n+const Selector = {\n+  defaultDialog: '//*[@role=\"dialog\"]',\n+}\n+\n+export default class ShareModal extends Container {\n+\n+  constructor(page: Page, xpath: string = Selector.defaultDialog) {\n+    super(page, xpath);\n+  }\n+\n+  async shareWithUser(username: string, level: WorkspaceAccessLevel): Promise<void> {\n+    const searchBox = await this.waitForSearchBox();\n+    await searchBox.type(username);\n+\n+    const addCollab = await this.waitForAddCollaboratorIcon();\n+    await addCollab.click();\n+\n+    const roleInput = await this.waitForRoleSelectorForUser(username);\n+    await roleInput.click();\n+\n+    const ownerOpt = await this.waitForRoleOption(level);\n+    await ownerOpt.click();\n+\n+    await this.clickButton(ButtonLabel.Save);\n+    await this.waitUntilDialogIsClosed();\n+  }\n+\n+  async removeUser(username: string): Promise<void> {\n+    const rmCollab = await this.page.waitForXPath(\n+      `${this.collabRowXPath(username)}//clr-icon[@shape=\"minus-circle\"]`);\n+    await rmCollab.click();\n+\n+    await this.clickButton(ButtonLabel.Save);\n+    await this.waitUntilDialogIsClosed();\n+    return;\n+  }\n+\n+  /**\n+   * Creates an xpath to a share \"row\" for a given user within the modal. This\n+   * can be combined with a child selector to pull out a control for a user.\n+   */\n+  private collabRowXPath(username: string): string {\n+    // We dip into child contents to find the collab user row element parent.\n+    // .//div filters by a relative path to the parent row.\n+    return `//*[@data-test-id=\"collab-user-row\" and .//div[` +\n+        `@data-test-id=\"collab-user-email\" and contains(text(),\"${username}\")]]`;\n+  }\n+\n+  async clickButton(buttonLabel: ButtonLabel): Promise<void> {\n+    const button = await this.waitForButton(buttonLabel);\n+    await button.waitUntilEnabled();\n+    return button.click();\n+  }\n+\n+  async waitForButton(buttonLabel: ButtonLabel): Promise<Button> {\n+    return Button.findByName(this.page, {containsText: buttonLabel, type: ElementType.Button}, this);\n+  }\n+\n+  async waitForSearchBox(): Promise<Textbox> {\n+    return Textbox.findByName(this.page, {name: 'Find Collaborators'}, this);\n+  }\n+\n+  async waitForAddCollaboratorIcon(): Promise<ClrIcon> {\n+    return ClrIcon.findByName(this.page, {iconShape: 'plus-circle'}, this);\n+  }\n+\n+  async waitForRoleSelectorForUser(username: string): Promise<Textbox> {\n+    const box = new Textbox(\n+      this.page, `${this.collabRowXPath(username)}//input[@type=\"text\"]`);\n+    await box.waitForXPath({visible: true});", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI2Njg3NQ=="}, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 84}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2ODIwNjU1OnYy", "diffSide": "RIGHT", "path": "e2e/app/component/share-modal.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNDozMTo1MlrOGnsIKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMDoyOTowM1rOGpQEqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI3MDYzMg==", "bodyText": "nit: If this class extends Dialog, you can also adds ${this.getXpath()} at the beginning of xpath to ensure element is located in dialog.", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r444270632", "createdAt": "2020-06-23T14:31:52Z", "author": {"login": "aweng98"}, "path": "e2e/app/component/share-modal.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import Container from 'app/container';\n+import {ElementHandle, Page} from 'puppeteer';\n+import {WorkspaceAccessLevel} from 'app/page-identifiers';\n+import {ElementType} from 'app/xpath-options';\n+import Button from 'app/element/button';\n+import Textbox from 'app/element/textbox';\n+import ClrIcon from 'app/element/clr-icon-link';\n+\n+\n+export enum ButtonLabel {\n+  Cancel = 'Cancel',\n+  Save = 'Save'\n+}\n+\n+const Selector = {\n+  defaultDialog: '//*[@role=\"dialog\"]',\n+}\n+\n+export default class ShareModal extends Container {\n+\n+  constructor(page: Page, xpath: string = Selector.defaultDialog) {\n+    super(page, xpath);\n+  }\n+\n+  async shareWithUser(username: string, level: WorkspaceAccessLevel): Promise<void> {\n+    const searchBox = await this.waitForSearchBox();\n+    await searchBox.type(username);\n+\n+    const addCollab = await this.waitForAddCollaboratorIcon();\n+    await addCollab.click();\n+\n+    const roleInput = await this.waitForRoleSelectorForUser(username);\n+    await roleInput.click();\n+\n+    const ownerOpt = await this.waitForRoleOption(level);\n+    await ownerOpt.click();\n+\n+    await this.clickButton(ButtonLabel.Save);\n+    await this.waitUntilDialogIsClosed();\n+  }\n+\n+  async removeUser(username: string): Promise<void> {\n+    const rmCollab = await this.page.waitForXPath(\n+      `${this.collabRowXPath(username)}//clr-icon[@shape=\"minus-circle\"]`);\n+    await rmCollab.click();\n+\n+    await this.clickButton(ButtonLabel.Save);\n+    await this.waitUntilDialogIsClosed();\n+    return;\n+  }\n+\n+  /**\n+   * Creates an xpath to a share \"row\" for a given user within the modal. This\n+   * can be combined with a child selector to pull out a control for a user.\n+   */\n+  private collabRowXPath(username: string): string {\n+    // We dip into child contents to find the collab user row element parent.\n+    // .//div filters by a relative path to the parent row.\n+    return `//*[@data-test-id=\"collab-user-row\" and .//div[` +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwODEzNg==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r445908136", "createdAt": "2020-06-26T00:29:03Z", "author": {"login": "calbach"}, "path": "e2e/app/component/share-modal.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import Container from 'app/container';\n+import {ElementHandle, Page} from 'puppeteer';\n+import {WorkspaceAccessLevel} from 'app/page-identifiers';\n+import {ElementType} from 'app/xpath-options';\n+import Button from 'app/element/button';\n+import Textbox from 'app/element/textbox';\n+import ClrIcon from 'app/element/clr-icon-link';\n+\n+\n+export enum ButtonLabel {\n+  Cancel = 'Cancel',\n+  Save = 'Save'\n+}\n+\n+const Selector = {\n+  defaultDialog: '//*[@role=\"dialog\"]',\n+}\n+\n+export default class ShareModal extends Container {\n+\n+  constructor(page: Page, xpath: string = Selector.defaultDialog) {\n+    super(page, xpath);\n+  }\n+\n+  async shareWithUser(username: string, level: WorkspaceAccessLevel): Promise<void> {\n+    const searchBox = await this.waitForSearchBox();\n+    await searchBox.type(username);\n+\n+    const addCollab = await this.waitForAddCollaboratorIcon();\n+    await addCollab.click();\n+\n+    const roleInput = await this.waitForRoleSelectorForUser(username);\n+    await roleInput.click();\n+\n+    const ownerOpt = await this.waitForRoleOption(level);\n+    await ownerOpt.click();\n+\n+    await this.clickButton(ButtonLabel.Save);\n+    await this.waitUntilDialogIsClosed();\n+  }\n+\n+  async removeUser(username: string): Promise<void> {\n+    const rmCollab = await this.page.waitForXPath(\n+      `${this.collabRowXPath(username)}//clr-icon[@shape=\"minus-circle\"]`);\n+    await rmCollab.click();\n+\n+    await this.clickButton(ButtonLabel.Save);\n+    await this.waitUntilDialogIsClosed();\n+    return;\n+  }\n+\n+  /**\n+   * Creates an xpath to a share \"row\" for a given user within the modal. This\n+   * can be combined with a child selector to pull out a control for a user.\n+   */\n+  private collabRowXPath(username: string): string {\n+    // We dip into child contents to find the collab user row element parent.\n+    // .//div filters by a relative path to the parent row.\n+    return `//*[@data-test-id=\"collab-user-row\" and .//div[` +", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI3MDYzMg=="}, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2ODIxMzczOnYy", "diffSide": "RIGHT", "path": "e2e/app/page/workspace-about-page.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNDozMzoyM1rOGnsMzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMDoyNzoxN1rOGpQC9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI3MTgyMQ==", "bodyText": "waitForXPath() needs {visible: true} option here to ensure element is visible.", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r444271821", "createdAt": "2020-06-23T14:33:23Z", "author": {"login": "aweng98"}, "path": "e2e/app/page/workspace-about-page.ts", "diffHunk": "@@ -33,4 +36,37 @@ export default class WorkspaceAboutPage extends AuthenticatedPage{\n     return waitForAttributeEquality(page, {xpath: selector}, 'aria-selected', 'true');\n   }\n \n+  async findUserInCollaboratorList(username: string): Promise<WorkspaceAccessLevel> {\n+    // At least one collab should eventually render, i.e. the current user.\n+    const collabXPath = `//*[starts-with(@data-test-id,\"workspaceUser-\")]`;\n+    await this.page.waitForXPath(collabXPath);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNzcwMA==", "bodyText": "Done", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r445907700", "createdAt": "2020-06-26T00:27:17Z", "author": {"login": "calbach"}, "path": "e2e/app/page/workspace-about-page.ts", "diffHunk": "@@ -33,4 +36,37 @@ export default class WorkspaceAboutPage extends AuthenticatedPage{\n     return waitForAttributeEquality(page, {xpath: selector}, 'aria-selected', 'true');\n   }\n \n+  async findUserInCollaboratorList(username: string): Promise<WorkspaceAccessLevel> {\n+    // At least one collab should eventually render, i.e. the current user.\n+    const collabXPath = `//*[starts-with(@data-test-id,\"workspaceUser-\")]`;\n+    await this.page.waitForXPath(collabXPath);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI3MTgyMQ=="}, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc2ODI0MzcyOnYy", "diffSide": "RIGHT", "path": "e2e/tests/workspace/workspace-share.spec.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNDozODo1NVrOGnsegA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMDoyNzo1OFrOGpQDng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI3NjM1Mg==", "bodyText": "waitWhileLoading needs await.", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r444276352", "createdAt": "2020-06-23T14:38:55Z", "author": {"login": "aweng98"}, "path": "e2e/tests/workspace/workspace-share.spec.ts", "diffHunk": "@@ -0,0 +1,50 @@\n+import Link from 'app/element/link';\n+import {findWorkspace, signIn, waitWhileLoading} from 'utils/test-utils';\n+import {WorkspaceAccessLevel} from 'app/page-identifiers';\n+import WorkspaceAboutPage from 'app/page/workspace-about-page';\n+import {config} from 'resources/workbench-config';\n+\n+describe('Share workspace', () => {\n+\n+  beforeEach(async () => {\n+    await signIn(page);\n+  });\n+\n+  // Assume there is at least one workspace preexist\n+  describe('From the workspace about page', () => {\n+    test('As OWNER, user can share a workspace', async () => {\n+      const workspaceCard = await findWorkspace(page);\n+      await workspaceCard.clickWorkspaceName();\n+\n+      const notebooksLink = await Link.findByName(page, {name: 'About'});\n+      await notebooksLink.clickAndWait();\n+\n+      const aboutPage = new WorkspaceAboutPage(page);\n+      await aboutPage.waitForLoad();\n+\n+      // This test is not hermetic - if the collaborator is already on this\n+      // workspace, just remove them before continuing.\n+      let accessLevel = await aboutPage.findUserInCollaboratorList(config.collaboratorUsername);\n+      if (accessLevel !== null) {\n+        await (await aboutPage.openShareModal()).removeUser(config.collaboratorUsername);\n+        waitWhileLoading(page);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNzg3MA==", "bodyText": "oops, thanks", "url": "https://github.com/all-of-us/workbench/pull/3696#discussion_r445907870", "createdAt": "2020-06-26T00:27:58Z", "author": {"login": "calbach"}, "path": "e2e/tests/workspace/workspace-share.spec.ts", "diffHunk": "@@ -0,0 +1,50 @@\n+import Link from 'app/element/link';\n+import {findWorkspace, signIn, waitWhileLoading} from 'utils/test-utils';\n+import {WorkspaceAccessLevel} from 'app/page-identifiers';\n+import WorkspaceAboutPage from 'app/page/workspace-about-page';\n+import {config} from 'resources/workbench-config';\n+\n+describe('Share workspace', () => {\n+\n+  beforeEach(async () => {\n+    await signIn(page);\n+  });\n+\n+  // Assume there is at least one workspace preexist\n+  describe('From the workspace about page', () => {\n+    test('As OWNER, user can share a workspace', async () => {\n+      const workspaceCard = await findWorkspace(page);\n+      await workspaceCard.clickWorkspaceName();\n+\n+      const notebooksLink = await Link.findByName(page, {name: 'About'});\n+      await notebooksLink.clickAndWait();\n+\n+      const aboutPage = new WorkspaceAboutPage(page);\n+      await aboutPage.waitForLoad();\n+\n+      // This test is not hermetic - if the collaborator is already on this\n+      // workspace, just remove them before continuing.\n+      let accessLevel = await aboutPage.findUserInCollaboratorList(config.collaboratorUsername);\n+      if (accessLevel !== null) {\n+        await (await aboutPage.openShareModal()).removeUser(config.collaboratorUsername);\n+        waitWhileLoading(page);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDI3NjM1Mg=="}, "originalCommit": {"oid": "ab20ec04daecd8bb0c23caedbb24ee0343afb604"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2550, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}