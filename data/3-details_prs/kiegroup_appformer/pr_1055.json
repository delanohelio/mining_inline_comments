{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwNTY5NDIz", "number": 1055, "title": "AF-2638: Index page is not updated when changing models", "bodyText": "AF-2638\nSyncBeanManager does not override registered beans, hence we need to replace the page content instead register it again and again", "createdAt": "2020-09-21T21:27:04Z", "url": "https://github.com/kiegroup/appformer/pull/1055", "merged": true, "mergeCommit": {"oid": "473ce1b0a2484861105e192f418d32d96d17a5c9"}, "closed": true, "closedAt": "2020-10-09T16:05:05Z", "author": {"login": "jesuino"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOo_d3AFqTUwMTI5NDc4OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQM98ygFqTUwMzg3NjE2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxMjk0Nzg4", "url": "https://github.com/kiegroup/appformer/pull/1055#pullrequestreview-501294788", "createdAt": "2020-10-02T16:51:35Z", "commit": {"oid": "ea45475968ab52800f64bfe8494b39e261333230"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNjo1MTozNVrOHb0q3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMlQxNjo1Njo0N1rOHb004g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODkzNjU0MA==", "bodyText": "Suggested change", "url": "https://github.com/kiegroup/appformer/pull/1055#discussion_r498936540", "createdAt": "2020-10-02T16:51:35Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-runtime/src/main/java/org/dashbuilder/client/perspective/generator/RuntimePerspectiveGenerator.java", "diffHunk": "@@ -50,10 +52,17 @@\n     private LayoutGenerator layoutGenerator;\n \n     public PerspectiveEditorActivity generatePerspective(LayoutTemplate layoutTemplate) {\n-        PerspectiveEditorScreenActivity screen = createNewScreen(layoutTemplate);\n-        return createNewPerspective(layoutTemplate, screen);\n+        if (isANewPerspective(layoutTemplate)) {\n+            PerspectiveEditorScreenActivity screen = createNewScreen(layoutTemplate);\n+            return createNewPerspective(layoutTemplate,\n+                                 screen);\n+        } else {\n+            PerspectiveEditorScreenActivity screen = updateScreen(layoutTemplate);\n+            return updatePerspective(layoutTemplate,\n+                              screen);\n+        }\n     }\n-\n+    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea45475968ab52800f64bfe8494b39e261333230"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODkzODUzMA==", "bodyText": "Please indent this piece of code.", "url": "https://github.com/kiegroup/appformer/pull/1055#discussion_r498938530", "createdAt": "2020-10-02T16:55:39Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-runtime/src/main/java/org/dashbuilder/client/perspective/generator/RuntimePerspectiveGenerator.java", "diffHunk": "@@ -95,5 +104,28 @@ private PerspectiveEditorActivity createNewPerspective(LayoutTemplate perspectiv\n         activityBeansCache.addNewPerspectiveActivity(beanManager.lookupBeans(perspectiveName).iterator().next());\n         return activity;\n     }\n+    \n+    private PerspectiveEditorScreenActivity updateScreen(LayoutTemplate layoutTemplate) {\n+        final String perspectiveScreenId = PerspectiveEditorScreenActivity.buildScreenId(layoutTemplate.getName());\n+        final SyncBeanDef<Activity> activity = activityBeansCache.getActivity(perspectiveScreenId);\n+        final PerspectiveEditorScreenActivity screenActivity = (PerspectiveEditorScreenActivity) activity.getInstance();\n+        screenActivity.setLayoutTemplate(layoutTemplate);\n+        return screenActivity;\n+    }\n+    \n+    private PerspectiveEditorActivity updatePerspective(LayoutTemplate layoutTemplate,\n+                                                        PerspectiveEditorScreenActivity screen) {\n+                             final SyncBeanDef<Activity> activity = activityBeansCache.getActivity(layoutTemplate.getName());\n+                             final PerspectiveEditorActivity perspectiveEditorActivity = (PerspectiveEditorActivity) activity.getInstance();\n+                             perspectiveEditorActivity.update(layoutTemplate,\n+                                                              screen);\n+                             return perspectiveEditorActivity;\n+                         }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea45475968ab52800f64bfe8494b39e261333230"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODkzOTEwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    final IOCBeanDef<Activity> activity = activityBeansCache.getActivity(layoutTemplate.getName());\n          \n          \n            \n                    return activity == null;\n          \n          \n            \n                    return activityBeansCache.getActivity(layoutTemplate.getName()) == null;", "url": "https://github.com/kiegroup/appformer/pull/1055#discussion_r498939106", "createdAt": "2020-10-02T16:56:47Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-runtime/src/main/java/org/dashbuilder/client/perspective/generator/RuntimePerspectiveGenerator.java", "diffHunk": "@@ -95,5 +104,28 @@ private PerspectiveEditorActivity createNewPerspective(LayoutTemplate perspectiv\n         activityBeansCache.addNewPerspectiveActivity(beanManager.lookupBeans(perspectiveName).iterator().next());\n         return activity;\n     }\n+    \n+    private PerspectiveEditorScreenActivity updateScreen(LayoutTemplate layoutTemplate) {\n+        final String perspectiveScreenId = PerspectiveEditorScreenActivity.buildScreenId(layoutTemplate.getName());\n+        final SyncBeanDef<Activity> activity = activityBeansCache.getActivity(perspectiveScreenId);\n+        final PerspectiveEditorScreenActivity screenActivity = (PerspectiveEditorScreenActivity) activity.getInstance();\n+        screenActivity.setLayoutTemplate(layoutTemplate);\n+        return screenActivity;\n+    }\n+    \n+    private PerspectiveEditorActivity updatePerspective(LayoutTemplate layoutTemplate,\n+                                                        PerspectiveEditorScreenActivity screen) {\n+                             final SyncBeanDef<Activity> activity = activityBeansCache.getActivity(layoutTemplate.getName());\n+                             final PerspectiveEditorActivity perspectiveEditorActivity = (PerspectiveEditorActivity) activity.getInstance();\n+                             perspectiveEditorActivity.update(layoutTemplate,\n+                                                              screen);\n+                             return perspectiveEditorActivity;\n+                         }\n+    \n+    \n+    private boolean isANewPerspective(LayoutTemplate layoutTemplate) {\n+        final IOCBeanDef<Activity> activity = activityBeansCache.getActivity(layoutTemplate.getName());\n+        return activity == null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea45475968ab52800f64bfe8494b39e261333230"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35129d34cbfb0894ee2f19503976881dd6cefe1d", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/35129d34cbfb0894ee2f19503976881dd6cefe1d", "committedDate": "2020-10-05T16:13:43Z", "message": "AF-2638: Index page is not updated when changing models"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b3cb98a5d69f99abe0f90d743beeada3c86694d", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/4b3cb98a5d69f99abe0f90d743beeada3c86694d", "committedDate": "2020-10-05T16:16:15Z", "message": "Improvements"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea45475968ab52800f64bfe8494b39e261333230", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/ea45475968ab52800f64bfe8494b39e261333230", "committedDate": "2020-09-21T21:25:39Z", "message": "AF-2638: Index page is not updated when changing models"}, "afterCommit": {"oid": "4b3cb98a5d69f99abe0f90d743beeada3c86694d", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/4b3cb98a5d69f99abe0f90d743beeada3c86694d", "committedDate": "2020-10-05T16:16:15Z", "message": "Improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjI2NTgy", "url": "https://github.com/kiegroup/appformer/pull/1055#pullrequestreview-502226582", "createdAt": "2020-10-05T16:29:32Z", "commit": {"oid": "4b3cb98a5d69f99abe0f90d743beeada3c86694d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNzUwOTIx", "url": "https://github.com/kiegroup/appformer/pull/1055#pullrequestreview-503750921", "createdAt": "2020-10-07T10:45:20Z", "commit": {"oid": "4b3cb98a5d69f99abe0f90d743beeada3c86694d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzODc2MTY5", "url": "https://github.com/kiegroup/appformer/pull/1055#pullrequestreview-503876169", "createdAt": "2020-10-07T13:26:33Z", "commit": {"oid": "4b3cb98a5d69f99abe0f90d743beeada3c86694d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1987, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}