{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwMDc5MjMz", "number": 938, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODo0Mzo1MFrODvdbUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyODo0OVrODvpJYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDkxNzk0OnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODo0Mzo1MFrOGB5PFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDo1MTozOFrOGCHZkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYzOTUxMQ==", "bodyText": "We could simplify as:\n    @Override\n    public void setPublicURI(Map<String, String> fullHostNames) {\n        if (fullHostNames != null && !fullHostNames.isEmpty()) {\n            toStringContent = fullHostNames.entrySet()\n                    .stream()\n                    .map(e -> e.getKey() + \"://\" + e.getValue() + \"/\" + name)\n                    .collect(Collectors.joining(\"\\n\"));\n        } else {\n            toStringContent = \"git://\" + name;\n        }\n    }", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404639511", "createdAt": "2020-04-07T08:43:50Z", "author": {"login": "jomarko"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemImpl.java", "diffHunk": "@@ -559,4 +546,22 @@ public void filterBranchAccess(final UploadPack uploadPack,\n             JGitFSHooks.executeFSHooks(hook, FileSystemHooks.BranchAccessFilter, ctx);\n         }\n     }\n+\n+    @Override\n+    public void setPublicURI(Map<String, String> fullHostNames) {\n+        if (fullHostNames != null && !fullHostNames.isEmpty()) {\n+            final StringBuilder sb = new StringBuilder();\n+            final Iterator<Map.Entry<String, String>> iterator = fullHostNames.entrySet().iterator();\n+            while (iterator.hasNext()) {\n+                final Map.Entry<String, String> entry = iterator.next();\n+                sb.append(entry.getKey()).append(\"://\").append(entry.getValue()).append(\"/\").append(name);\n+                if (iterator.hasNext()) {\n+                    sb.append(\"\\n\");\n+                }\n+            }\n+            toStringContent = sb.toString();\n+        } else {\n+            toStringContent = \"git://\" + name;\n+        }\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72cdfa5173299a95c22821715bf0d6d079dc277a"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg3MTU2OQ==", "bodyText": "looks neat. Thanks", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404871569", "createdAt": "2020-04-07T14:51:38Z", "author": {"login": "RishiRajAnand"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemImpl.java", "diffHunk": "@@ -559,4 +546,22 @@ public void filterBranchAccess(final UploadPack uploadPack,\n             JGitFSHooks.executeFSHooks(hook, FileSystemHooks.BranchAccessFilter, ctx);\n         }\n     }\n+\n+    @Override\n+    public void setPublicURI(Map<String, String> fullHostNames) {\n+        if (fullHostNames != null && !fullHostNames.isEmpty()) {\n+            final StringBuilder sb = new StringBuilder();\n+            final Iterator<Map.Entry<String, String>> iterator = fullHostNames.entrySet().iterator();\n+            while (iterator.hasNext()) {\n+                final Map.Entry<String, String> entry = iterator.next();\n+                sb.append(entry.getKey()).append(\"://\").append(entry.getValue()).append(\"/\").append(name);\n+                if (iterator.hasNext()) {\n+                    sb.append(\"\\n\");\n+                }\n+            }\n+            toStringContent = sb.toString();\n+        } else {\n+            toStringContent = \"git://\" + name;\n+        }\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYzOTUxMQ=="}, "originalCommit": {"oid": "72cdfa5173299a95c22821715bf0d6d079dc277a"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDkyOTA5OnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/manager/JGitFileSystemsManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODo0NjozMVrOGB5VzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODo0NjozMVrOGB5VzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY0MTIyOQ==", "bodyText": "formatting if (...", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404641229", "createdAt": "2020-04-07T08:46:31Z", "author": {"login": "jomarko"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/manager/JGitFileSystemsManager.java", "diffHunk": "@@ -78,6 +78,13 @@ public void newFileSystem(Supplier<Map<String, String>> fullHostNames,\n         fileSystemsRoot.addAll(parseFSRoots(fsName.get()));\n     }\n \n+    public void replaceFSCacheEntry(String fsKey, JGitFileSystem jGitFileSystem) {\n+       if(getFsCache().containsKey(fsKey)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72cdfa5173299a95c22821715bf0d6d079dc277a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDk0Mzc5OnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/AbstractTestInfra.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODo1MDoxNVrOGB5fHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDo1MzoxMFrOGCHeiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY0MzYxMw==", "bodyText": "Could we please replace uri.equals(protocolName) with Objects.equals(uri, protocolName)? The later one doesn't throw an exception in case uri or protocolName is null.", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404643613", "createdAt": "2020-04-07T08:50:15Z", "author": {"login": "jomarko"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/AbstractTestInfra.java", "diffHunk": "@@ -355,4 +356,10 @@ protected static String multiline(String prefix, String... lines) {\n                 .reduce((s1, s2) -> s1 + \"\\n\" + s2)\n                 .orElse(\"\");\n     }\n+    protected static boolean checkProtocolPresent(String hostNames, String protocolName) {\n+        final String[] uris = hostNames.toString().split(\"\\\\r?\\\\n\");\n+        return Arrays.stream(uris)\n+                .map(uri -> uri.substring(0, uri.indexOf(PROTOCOL_SEPARATOR)))\n+                .anyMatch(uri -> uri.equals(protocolName));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72cdfa5173299a95c22821715bf0d6d079dc277a"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg3Mjg0Mw==", "bodyText": "Nice catch, thanks", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404872843", "createdAt": "2020-04-07T14:53:10Z", "author": {"login": "RishiRajAnand"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/AbstractTestInfra.java", "diffHunk": "@@ -355,4 +356,10 @@ protected static String multiline(String prefix, String... lines) {\n                 .reduce((s1, s2) -> s1 + \"\\n\" + s2)\n                 .orElse(\"\");\n     }\n+    protected static boolean checkProtocolPresent(String hostNames, String protocolName) {\n+        final String[] uris = hostNames.toString().split(\"\\\\r?\\\\n\");\n+        return Arrays.stream(uris)\n+                .map(uri -> uri.substring(0, uri.indexOf(PROTOCOL_SEPARATOR)))\n+                .anyMatch(uri -> uri.equals(protocolName));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY0MzYxMw=="}, "originalCommit": {"oid": "72cdfa5173299a95c22821715bf0d6d079dc277a"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMDk3MTAzOnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemImplTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwODo1Njo1MVrOGB5wOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNDo1NDo0OVrOGCHkLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY0Nzk5NQ==", "bodyText": "In past, sonarcloud reported anonymous static initialization as possible risk. @hasys implemented different kind of builders due to this.\nCould we please replace all HashMap constructions in this way?\nnew Maps.Builder<String, String>()\n   .put(\"ssh\", \"localhost:8080/git\")\n   .build()", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404647995", "createdAt": "2020-04-07T08:56:51Z", "author": {"login": "jomarko"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemImplTest.java", "diffHunk": "@@ -516,4 +517,35 @@ public void lockTest() throws IOException, GitAPIException {\n         verify(lockSpy,\n                times(1)).physicalUnLockOnFS();\n     }\n+\n+    @Test\n+    public void testSetPublicURI() throws IOException, GitAPIException {\n+\n+        final JGitFileSystemProvider fsProvider = mock(JGitFileSystemProvider.class);\n+\n+        final Git git = setupGit();\n+\n+        final JGitFileSystemImpl fileSystem = new JGitFileSystemImpl(fsProvider,\n+                                                                     new HashMap<String, String>() {{\n+                                                                         put(\"ssh\", \"localhost:8080/git\");\n+                                                                     }},", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72cdfa5173299a95c22821715bf0d6d079dc277a"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDg3NDI4Ng==", "bodyText": "updated", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404874286", "createdAt": "2020-04-07T14:54:49Z", "author": {"login": "RishiRajAnand"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemImplTest.java", "diffHunk": "@@ -516,4 +517,35 @@ public void lockTest() throws IOException, GitAPIException {\n         verify(lockSpy,\n                times(1)).physicalUnLockOnFS();\n     }\n+\n+    @Test\n+    public void testSetPublicURI() throws IOException, GitAPIException {\n+\n+        final JGitFileSystemProvider fsProvider = mock(JGitFileSystemProvider.class);\n+\n+        final Git git = setupGit();\n+\n+        final JGitFileSystemImpl fileSystem = new JGitFileSystemImpl(fsProvider,\n+                                                                     new HashMap<String, String>() {{\n+                                                                         put(\"ssh\", \"localhost:8080/git\");\n+                                                                     }},", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY0Nzk5NQ=="}, "originalCommit": {"oid": "72cdfa5173299a95c22821715bf0d6d079dc277a"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjc5ODk4OnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemProvider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyMDoyNlrOGCLl2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwNjoyNDo1MVrOGCgopQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0MDI1MA==", "bodyText": "Just a suggestion.\nYou could replace the collect() by a forEach with the content of the for loop below.\nThis way you don't need to create a List<JGitFileSystem>.", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404940250", "createdAt": "2020-04-07T16:20:26Z", "author": {"login": "caponetto"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemProvider.java", "diffHunk": "@@ -439,6 +440,18 @@ public void addHostName(final String protocol, String s) {\n         fullHostNames.put(protocol, s);\n     }\n \n+    public void updateCacheWithHostNames() {\n+        JGitFileSystemsCache fc = fsManager.getFsCache();\n+        List<JGitFileSystem> jGitFileSystems = fc.getFileSystems().stream()\n+                .map(fsName -> ((JGitFileSystemProxy) fsManager.get(fsName)).getRealJGitFileSystem()).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cde199330b7cf3c24e0de8a7a6ec3e900d87a60"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI4NTAyOQ==", "bodyText": "done,Nice catch. Thanks @caponetto", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r405285029", "createdAt": "2020-04-08T06:24:51Z", "author": {"login": "RishiRajAnand"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemProvider.java", "diffHunk": "@@ -439,6 +440,18 @@ public void addHostName(final String protocol, String s) {\n         fullHostNames.put(protocol, s);\n     }\n \n+    public void updateCacheWithHostNames() {\n+        JGitFileSystemsCache fc = fsManager.getFsCache();\n+        List<JGitFileSystem> jGitFileSystems = fc.getFileSystems().stream()\n+                .map(fsName -> ((JGitFileSystemProxy) fsManager.get(fsName)).getRealJGitFileSystem()).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0MDI1MA=="}, "originalCommit": {"oid": "1cde199330b7cf3c24e0de8a7a6ec3e900d87a60"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjgxMDEwOnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/manager/JGitFileSystemsManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyMjo1M1rOGCLsmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwNjoyNToxNVrOGCgpSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0MTk3OA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void replaceFSCacheEntry(String fsKey, JGitFileSystem jGitFileSystem) {\n          \n          \n            \n                public void updateFSCacheEntry(String fsKey, JGitFileSystem jGitFileSystem) {\n          \n      \n    \n    \n  \n\nJust a suggestion.", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404941978", "createdAt": "2020-04-07T16:22:53Z", "author": {"login": "caponetto"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/manager/JGitFileSystemsManager.java", "diffHunk": "@@ -78,6 +77,14 @@ public void newFileSystem(Supplier<Map<String, String>> fullHostNames,\n         fileSystemsRoot.addAll(parseFSRoots(fsName.get()));\n     }\n \n+    public void replaceFSCacheEntry(String fsKey, JGitFileSystem jGitFileSystem) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cde199330b7cf3c24e0de8a7a6ec3e900d87a60"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI4NTE5NQ==", "bodyText": "Makes sense", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r405285195", "createdAt": "2020-04-08T06:25:15Z", "author": {"login": "RishiRajAnand"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/main/java/org/uberfire/java/nio/fs/jgit/manager/JGitFileSystemsManager.java", "diffHunk": "@@ -78,6 +77,14 @@ public void newFileSystem(Supplier<Map<String, String>> fullHostNames,\n         fileSystemsRoot.addAll(parseFSRoots(fsName.get()));\n     }\n \n+    public void replaceFSCacheEntry(String fsKey, JGitFileSystem jGitFileSystem) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0MTk3OA=="}, "originalCommit": {"oid": "1cde199330b7cf3c24e0de8a7a6ec3e900d87a60"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjgyMDgzOnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemImplTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyNToxM1rOGCLzTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyNToxM1rOGCLzTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0MzY5Mw==", "bodyText": "You could use assertTrue() here instead of assertThat().isEqualTo(true).", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404943693", "createdAt": "2020-04-07T16:25:13Z", "author": {"login": "caponetto"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitFileSystemImplTest.java", "diffHunk": "@@ -516,4 +517,35 @@ public void lockTest() throws IOException, GitAPIException {\n         verify(lockSpy,\n                times(1)).physicalUnLockOnFS();\n     }\n+\n+    @Test\n+    public void testSetPublicURI() throws IOException, GitAPIException {\n+\n+        final JGitFileSystemProvider fsProvider = mock(JGitFileSystemProvider.class);\n+\n+        final Git git = setupGit();\n+\n+        final JGitFileSystemImpl fileSystem = new JGitFileSystemImpl(fsProvider,\n+                                                                     new Maps.Builder<String, String>()\n+                                                                             .put(\"ssh\", \"localhost:8080/git\")\n+                                                                             .build(),\n+                                                                     git,\n+                                                                     createFSLock(git),\n+                                                                     \"my-repo\",\n+                                                                     CredentialsProvider.getDefault(),\n+                                                                     null,\n+                                                                     null);\n+\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"ssh\")).isEqualTo(true);\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"http\")).isEqualTo(false);\n+\n+        fileSystem.setPublicURI(new Maps.Builder<String, String>()\n+                                        .put(\"http\", \"localhost:8080/git\")\n+                                        .put(\"ssh\", \"localhost:8080/git\")\n+                                        .build());\n+\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"ssh\")).isEqualTo(true);\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"http\")).isEqualTo(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cde199330b7cf3c24e0de8a7a6ec3e900d87a60"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjgyMTc0OnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitUpdateFSCacheWithHostnameTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyNToyMlrOGCLzzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyNToyMlrOGCLzzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0MzgyMQ==", "bodyText": "You could use assertTrue() here instead of assertThat().isEqualTo(true).", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404943821", "createdAt": "2020-04-07T16:25:22Z", "author": {"login": "caponetto"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitUpdateFSCacheWithHostnameTest.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.uberfire.java.nio.fs.jgit;\n+\n+import java.net.URI;\n+import java.util.Arrays;\n+import java.util.Map;\n+\n+import org.junit.Test;\n+import org.uberfire.java.nio.file.FileSystem;\n+import org.uberfire.java.nio.fs.jgit.manager.JGitFileSystemsCache;\n+import org.uberfire.java.nio.fs.jgit.manager.JGitFileSystemsManager;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+public class JGitUpdateFSCacheWithHostnameTest extends AbstractTestInfra {\n+\n+    @Override\n+    public Map<String, String> getGitPreferences() {\n+        Map<String, String> gitPrefs = super.getGitPreferences();\n+        gitPrefs.put(JGitFileSystemProviderConfiguration.GIT_HTTP_ENABLED, \"true\");\n+        return gitPrefs;\n+    }\n+\n+    @Test\n+    public void testFSCacheUpdateWithHostName() {\n+        final URI newRepo = URI.create(\"git://repo-name\");\n+        provider.addHostName(\"ssh\", \"localhost:8080/git\");\n+        final FileSystem fs = provider.newFileSystem(newRepo,\n+                                                     EMPTY_ENV);\n+        JGitFileSystemsCache fileSystemsCache = provider.getFsManager().getFsCache();\n+        final FileSystem fileSystem = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"ssh\")).isEqualTo(true);\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"http\")).isEqualTo(false);\n+\n+        provider.addHostName(\"http\", \"localhost:8080/git\");\n+\n+        final FileSystem fileSystem1 = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem1).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem1.toString(), \"http\")).isEqualTo(false);\n+        assertThat(fileSystemsCache.getFileSystems().size()).isEqualTo(1);\n+        provider.updateCacheWithHostNames();\n+\n+        final FileSystem fileSystem2 = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem2).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem2.toString(), \"http\")).isEqualTo(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cde199330b7cf3c24e0de8a7a6ec3e900d87a60"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjgzNTU2OnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitUpdateFSCacheWithHostnameTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyODoxMlrOGCL8Ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyODoxMlrOGCL8Ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0NjAwMg==", "bodyText": "You could use isOne() here instead of isEqualTo(1).", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404946002", "createdAt": "2020-04-07T16:28:12Z", "author": {"login": "caponetto"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitUpdateFSCacheWithHostnameTest.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.uberfire.java.nio.fs.jgit;\n+\n+import java.net.URI;\n+import java.util.Arrays;\n+import java.util.Map;\n+\n+import org.junit.Test;\n+import org.uberfire.java.nio.file.FileSystem;\n+import org.uberfire.java.nio.fs.jgit.manager.JGitFileSystemsCache;\n+import org.uberfire.java.nio.fs.jgit.manager.JGitFileSystemsManager;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+public class JGitUpdateFSCacheWithHostnameTest extends AbstractTestInfra {\n+\n+    @Override\n+    public Map<String, String> getGitPreferences() {\n+        Map<String, String> gitPrefs = super.getGitPreferences();\n+        gitPrefs.put(JGitFileSystemProviderConfiguration.GIT_HTTP_ENABLED, \"true\");\n+        return gitPrefs;\n+    }\n+\n+    @Test\n+    public void testFSCacheUpdateWithHostName() {\n+        final URI newRepo = URI.create(\"git://repo-name\");\n+        provider.addHostName(\"ssh\", \"localhost:8080/git\");\n+        final FileSystem fs = provider.newFileSystem(newRepo,\n+                                                     EMPTY_ENV);\n+        JGitFileSystemsCache fileSystemsCache = provider.getFsManager().getFsCache();\n+        final FileSystem fileSystem = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"ssh\")).isEqualTo(true);\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"http\")).isEqualTo(false);\n+\n+        provider.addHostName(\"http\", \"localhost:8080/git\");\n+\n+        final FileSystem fileSystem1 = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem1).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem1.toString(), \"http\")).isEqualTo(false);\n+        assertThat(fileSystemsCache.getFileSystems().size()).isEqualTo(1);\n+        provider.updateCacheWithHostNames();\n+\n+        final FileSystem fileSystem2 = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem2).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem2.toString(), \"http\")).isEqualTo(true);\n+        assertThat(fileSystemsCache.getFileSystems().size()).isEqualTo(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cde199330b7cf3c24e0de8a7a6ec3e900d87a60"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjgzNzEyOnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitUpdateFSCacheWithHostnameTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyODozNFrOGCL9WQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyODozNFrOGCL9WQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0NjI2NQ==", "bodyText": "You could use assertFalse() here instead of assertThat().isEqualTo(false).", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404946265", "createdAt": "2020-04-07T16:28:34Z", "author": {"login": "caponetto"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitUpdateFSCacheWithHostnameTest.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.uberfire.java.nio.fs.jgit;\n+\n+import java.net.URI;\n+import java.util.Arrays;\n+import java.util.Map;\n+\n+import org.junit.Test;\n+import org.uberfire.java.nio.file.FileSystem;\n+import org.uberfire.java.nio.fs.jgit.manager.JGitFileSystemsCache;\n+import org.uberfire.java.nio.fs.jgit.manager.JGitFileSystemsManager;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+public class JGitUpdateFSCacheWithHostnameTest extends AbstractTestInfra {\n+\n+    @Override\n+    public Map<String, String> getGitPreferences() {\n+        Map<String, String> gitPrefs = super.getGitPreferences();\n+        gitPrefs.put(JGitFileSystemProviderConfiguration.GIT_HTTP_ENABLED, \"true\");\n+        return gitPrefs;\n+    }\n+\n+    @Test\n+    public void testFSCacheUpdateWithHostName() {\n+        final URI newRepo = URI.create(\"git://repo-name\");\n+        provider.addHostName(\"ssh\", \"localhost:8080/git\");\n+        final FileSystem fs = provider.newFileSystem(newRepo,\n+                                                     EMPTY_ENV);\n+        JGitFileSystemsCache fileSystemsCache = provider.getFsManager().getFsCache();\n+        final FileSystem fileSystem = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"ssh\")).isEqualTo(true);\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"http\")).isEqualTo(false);\n+\n+        provider.addHostName(\"http\", \"localhost:8080/git\");\n+\n+        final FileSystem fileSystem1 = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem1).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem1.toString(), \"http\")).isEqualTo(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cde199330b7cf3c24e0de8a7a6ec3e900d87a60"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMjgzODEwOnYy", "diffSide": "RIGHT", "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitUpdateFSCacheWithHostnameTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyODo0OVrOGCL-BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNjoyODo0OVrOGCL-BQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk0NjQzNw==", "bodyText": "You could use isOne() here instead of isEqualTo(1).", "url": "https://github.com/kiegroup/appformer/pull/938#discussion_r404946437", "createdAt": "2020-04-07T16:28:49Z", "author": {"login": "caponetto"}, "path": "uberfire-nio2-backport/uberfire-nio2-impls/uberfire-nio2-jgit/src/test/java/org/uberfire/java/nio/fs/jgit/JGitUpdateFSCacheWithHostnameTest.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.uberfire.java.nio.fs.jgit;\n+\n+import java.net.URI;\n+import java.util.Arrays;\n+import java.util.Map;\n+\n+import org.junit.Test;\n+import org.uberfire.java.nio.file.FileSystem;\n+import org.uberfire.java.nio.fs.jgit.manager.JGitFileSystemsCache;\n+import org.uberfire.java.nio.fs.jgit.manager.JGitFileSystemsManager;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+public class JGitUpdateFSCacheWithHostnameTest extends AbstractTestInfra {\n+\n+    @Override\n+    public Map<String, String> getGitPreferences() {\n+        Map<String, String> gitPrefs = super.getGitPreferences();\n+        gitPrefs.put(JGitFileSystemProviderConfiguration.GIT_HTTP_ENABLED, \"true\");\n+        return gitPrefs;\n+    }\n+\n+    @Test\n+    public void testFSCacheUpdateWithHostName() {\n+        final URI newRepo = URI.create(\"git://repo-name\");\n+        provider.addHostName(\"ssh\", \"localhost:8080/git\");\n+        final FileSystem fs = provider.newFileSystem(newRepo,\n+                                                     EMPTY_ENV);\n+        JGitFileSystemsCache fileSystemsCache = provider.getFsManager().getFsCache();\n+        final FileSystem fileSystem = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"ssh\")).isEqualTo(true);\n+        assertThat(checkProtocolPresent(fileSystem.toString(), \"http\")).isEqualTo(false);\n+\n+        provider.addHostName(\"http\", \"localhost:8080/git\");\n+\n+        final FileSystem fileSystem1 = fileSystemsCache.get(\"repo-name\");\n+        assertThat(fileSystem1).isNotNull();\n+        assertThat(checkProtocolPresent(fileSystem1.toString(), \"http\")).isEqualTo(false);\n+        assertThat(fileSystemsCache.getFileSystems().size()).isEqualTo(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cde199330b7cf3c24e0de8a7a6ec3e900d87a60"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2777, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}