{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNzA5MjM4", "number": 933, "title": "AF-2456: Support Gradual Export in Data Transfer API", "bodyText": "This is an extension of Data Transfer functionality to include gradual export.\nNow, when clicking on export, a modal will allow users to select what they want to export:\n\nWhen loading files a progress status will be displayed\n\nBy default all assets will be selected. What will be displayed is:\n\nDatasets: list of datasets that can be exported;\n\n\n\nPages: List of pages that can be exported;\n\n\nWhen ok is clicked user is prompted to download export.zip. The export should contains the assets that were selected.\nLater, the same asset could be imported and it will override existing content (if conflicting). If the imported content does not exist, it will be created, for example:\n\nCreate two datasets (ds1, ds2);\nExport dataset ds2 only (when exporting,uselect ds1,  unselect pages and set off the navigation);\nDelete ds2;\nImport the exported ZIP;\nds2 should be back..\n\nThe same is also true  for pages and navigation can be restored if it was exported before.", "createdAt": "2020-03-25T16:59:12Z", "url": "https://github.com/kiegroup/appformer/pull/933", "merged": true, "mergeCommit": {"oid": "55d10482bbff0f492ba2a49f86308ca0899de14f"}, "closed": true, "closedAt": "2020-05-15T13:36:00Z", "author": {"login": "jesuino"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRjCxbABqjMxNzAxNjQyMDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgThABAH2gAyMzkzNzA5MjM4OjM1ZWViMjlmNTZlYjY2MGNlNzFkNjcxNjI3OTg2MGI2ZWE1YzEyNzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7222a73683cc36bd3ad3184a3ace1d9b22610d38", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/7222a73683cc36bd3ad3184a3ace1d9b22610d38", "committedDate": "2020-03-26T21:31:30Z", "message": "Validation: Initial implementation"}, "afterCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/a74b4a7f646b14ef763d402579c8e86d10cbb7a9", "committedDate": "2020-03-25T16:59:57Z", "message": "Export navigation adjustments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MTM5ODg0", "url": "https://github.com/kiegroup/appformer/pull/933#pullrequestreview-387139884", "createdAt": "2020-04-03T10:32:29Z", "commit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "state": "COMMENTED", "comments": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxMDozMjoyOVrOGAP0xA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxMjowNjo0NFrOGASmjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkxMjQ1Mg==", "bodyText": "Suggested change", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402912452", "createdAt": "2020-04-03T10:32:29Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferExportPopUp.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer;\n+\n+import javax.annotation.PostConstruct;\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import org.dashbuilder.transfer.DataTransferAssets;\n+import org.dashbuilder.transfer.DataTransferExportModel;\n+import org.dashbuilder.transfer.DataTransferServices;\n+import org.jboss.errai.common.client.api.Caller;\n+import org.uberfire.client.mvp.UberElemental;\n+import org.uberfire.mvp.ParameterizedCommand;\n+\n+@ApplicationScoped\n+public class DataTransferExportPopUp {\n+\n+    private View view;\n+\n+    private Caller<DataTransferServices> dataTransferServices;\n+\n+    private ParameterizedCommand<DataTransferExportModel> dataTransferExportModelCallback;\n+\n+    public interface View extends UberElemental<DataTransferExportPopUp> {\n+\n+        void show();\n+\n+        void setAssetsToExport(DataTransferAssets assetsToExport);\n+\n+        void showError(Throwable error);\n+\n+    }\n+\n+    @Inject\n+    public DataTransferExportPopUp(View view,\n+                                   Caller<DataTransferServices> dataTransferServices) {\n+        this.view = view;\n+        this.dataTransferServices = dataTransferServices;\n+    }\n+\n+    @PostConstruct\n+    public void init() {\n+        view.init(this);\n+    }\n+\n+    public void setCallback(ParameterizedCommand<DataTransferExportModel> dataTransferExportModelCallback) {\n+        this.dataTransferExportModelCallback = dataTransferExportModelCallback;\n+\n+    }\n+\n+    public void load() {\n+        view.show();\n+        dataTransferServices.call((DataTransferAssets v) -> view.setAssetsToExport(v),\n+                                  (message, error) -> {\n+                                      view.showError(error);\n+                                      return false;\n+                                  })\n+                            .assetsToExport();\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 74}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkxMjUwNg==", "bodyText": "Suggested change", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402912506", "createdAt": "2020-04-03T10:32:36Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferExportPopUp.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer;\n+\n+import javax.annotation.PostConstruct;\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import org.dashbuilder.transfer.DataTransferAssets;\n+import org.dashbuilder.transfer.DataTransferExportModel;\n+import org.dashbuilder.transfer.DataTransferServices;\n+import org.jboss.errai.common.client.api.Caller;\n+import org.uberfire.client.mvp.UberElemental;\n+import org.uberfire.mvp.ParameterizedCommand;\n+\n+@ApplicationScoped\n+public class DataTransferExportPopUp {\n+\n+    private View view;\n+\n+    private Caller<DataTransferServices> dataTransferServices;\n+\n+    private ParameterizedCommand<DataTransferExportModel> dataTransferExportModelCallback;\n+\n+    public interface View extends UberElemental<DataTransferExportPopUp> {\n+\n+        void show();\n+\n+        void setAssetsToExport(DataTransferAssets assetsToExport);\n+\n+        void showError(Throwable error);\n+\n+    }\n+\n+    @Inject\n+    public DataTransferExportPopUp(View view,\n+                                   Caller<DataTransferServices> dataTransferServices) {\n+        this.view = view;\n+        this.dataTransferServices = dataTransferServices;\n+    }\n+\n+    @PostConstruct\n+    public void init() {\n+        view.init(this);\n+    }\n+\n+    public void setCallback(ParameterizedCommand<DataTransferExportModel> dataTransferExportModelCallback) {\n+        this.dataTransferExportModelCallback = dataTransferExportModelCallback;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkxMjU3Mg==", "bodyText": "Suggested change", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402912572", "createdAt": "2020-04-03T10:32:43Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferExportPopUp.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer;\n+\n+import javax.annotation.PostConstruct;\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import org.dashbuilder.transfer.DataTransferAssets;\n+import org.dashbuilder.transfer.DataTransferExportModel;\n+import org.dashbuilder.transfer.DataTransferServices;\n+import org.jboss.errai.common.client.api.Caller;\n+import org.uberfire.client.mvp.UberElemental;\n+import org.uberfire.mvp.ParameterizedCommand;\n+\n+@ApplicationScoped\n+public class DataTransferExportPopUp {\n+\n+    private View view;\n+\n+    private Caller<DataTransferServices> dataTransferServices;\n+\n+    private ParameterizedCommand<DataTransferExportModel> dataTransferExportModelCallback;\n+\n+    public interface View extends UberElemental<DataTransferExportPopUp> {\n+\n+        void show();\n+\n+        void setAssetsToExport(DataTransferAssets assetsToExport);\n+\n+        void showError(Throwable error);\n+\n+    }\n+\n+    @Inject\n+    public DataTransferExportPopUp(View view,\n+                                   Caller<DataTransferServices> dataTransferServices) {\n+        this.view = view;\n+        this.dataTransferServices = dataTransferServices;\n+    }\n+\n+    @PostConstruct\n+    public void init() {\n+        view.init(this);\n+    }\n+\n+    public void setCallback(ParameterizedCommand<DataTransferExportModel> dataTransferExportModelCallback) {\n+        this.dataTransferExportModelCallback = dataTransferExportModelCallback;\n+\n+    }\n+\n+    public void load() {\n+        view.show();\n+        dataTransferServices.call((DataTransferAssets v) -> view.setAssetsToExport(v),\n+                                  (message, error) -> {\n+                                      view.showError(error);\n+                                      return false;\n+                                  })\n+                            .assetsToExport();\n+\n+    }\n+\n+    public void receiveSelectedAssets(DataTransferExportModel dataTransferExportModel) {\n+        dataTransferExportModelCallback.execute(dataTransferExportModel);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkxNDYyNA==", "bodyText": "Consider formatting this file with spaces instead of tabs.\nPlease add the copyright header to this file.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402914624", "createdAt": "2020-04-03T10:36:48Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferExportPopUpView.html", "diffHunk": "@@ -0,0 +1,101 @@\n+<div id=\"dataTransferExportModalBody\" class=\"container-fluid\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkxNTU0NA==", "bodyText": "Please add the copyright header to this file.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402915544", "createdAt": "2020-04-03T10:38:40Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferExportPopUpView.css", "diffHunk": "@@ -0,0 +1,4 @@\n+.assets-panel-body {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkyNDYzNg==", "bodyText": "I see that this toggle is quite large compared with other places that we have this component.\nCan we make it smaller? Like the ones we have on Service Tasks Administration page, for example.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402924636", "createdAt": "2020-04-03T10:56:46Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferExportPopUpView.html", "diffHunk": "@@ -0,0 +1,101 @@\n+<div id=\"dataTransferExportModalBody\" class=\"container-fluid\">\n+\t<div class=\"row\">\n+\t\t<div class=\"col-md-12\">\n+\t\t\t<div id=\"progressIndicator\">\n+\t\t\t\t<p>\n+\t\t\t\t\t<span class=\"spinner spinner-lg spinner-inline\"></span> Loading\n+\t\t\t\t\tassets...\n+\t\t\t\t</p>\n+\t\t\t</div>\n+\t\t\t<div class=\"panel-group\" id=\"dataSelectionAccordion\">\n+\t\t\t\t<div class=\"panel panel-default\">\n+\t\t\t\t\t<div class=\"panel-heading\">\n+\t\t\t\t\t\t<h4 class=\"panel-title\">\n+\t\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#dataSelectionAccordion\"\n+\t\t\t\t\t\t\t\thref=\"#collapseOne\">DataSets</a>\n+\t\t\t\t\t\t</h4>\n+\t\t\t\t\t</div>\n+\t\t\t\t\t<div id=\"collapseOne\" class=\"panel-collapse collapse in\">\n+\t\t\t\t\t\t<div class=\"panel-body assets-panel-body\">\n+\t\t\t\t\t\t\t<form role=\"form\" class=\"search-pf has-button\">\n+\t\t\t\t\t\t\t\t<div class=\"form-group has-clear\">\n+\t\t\t\t\t\t\t\t\t<div class=\"search-pf-input-group\">\n+\t\t\t\t\t\t\t\t\t\t<label for=\"searchDatasets\" class=\"sr-only\">Filter</label> <input\n+\t\t\t\t\t\t\t\t\t\t\tid=\"searchDatasets\" type=\"search\" class=\"form-control\"\n+\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Filter\">\n+\n+\t\t\t\t\t\t\t\t\t</div>\n+\t\t\t\t\t\t\t\t</div>\n+\t\t\t\t\t\t\t</form>\n+\t\t\t\t\t\t\t<!-- DataSets Table -->\n+\t\t\t\t\t\t\t<table class=\"table table-striped table-bordered table-hover\"\n+\t\t\t\t\t\t\t\tid=\"datasetsTable\">\n+\t\t\t\t\t\t\t\t<thead>\n+\t\t\t\t\t\t\t\t\t<tr>\n+\t\t\t\t\t\t\t\t\t\t<th><input type=\"checkbox\" id=\"selectAllDatasets\" /></th>\n+\t\t\t\t\t\t\t\t\t\t<th>UUID</th>\n+\t\t\t\t\t\t\t\t\t\t<th>Name</th>\n+\t\t\t\t\t\t\t\t\t\t<th>Type</th>\n+\t\t\t\t\t\t\t\t\t</tr>\n+\t\t\t\t\t\t\t\t</thead>\n+\t\t\t\t\t\t\t\t<tbody id=\"\">\n+\t\t\t\t\t\t\t\t</tbody>\n+\t\t\t\t\t\t\t</table>\n+\t\t\t\t\t\t</div>\n+\t\t\t\t\t</div>\n+\t\t\t\t</div>\n+\t\t\t\t<div class=\"panel panel-default\">\n+\t\t\t\t\t<div class=\"panel-heading\">\n+\t\t\t\t\t\t<h4 class=\"panel-title\">\n+\t\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#dataSelectionAccordion\"\n+\t\t\t\t\t\t\t\thref=\"#collapseTwo\" class=\"collapsed\">Pages</a>\n+\t\t\t\t\t\t</h4>\n+\t\t\t\t\t</div>\n+\t\t\t\t\t<div id=\"collapseTwo\" class=\"panel-collapse collapse\">\n+\t\t\t\t\t\t<div class=\"panel-body assets-panel-body\">\n+\t\t\t\t\t\t\t<form role=\"form\" class=\"search-pf has-button\">\n+\t\t\t\t\t\t\t\t<div class=\"form-group has-clear\">\n+\t\t\t\t\t\t\t\t\t<div class=\"search-pf-input-group\">\n+\t\t\t\t\t\t\t\t\t\t<label for=\"searchPages\" class=\"sr-only\">Filter</label> <input\n+\t\t\t\t\t\t\t\t\t\t\tid=\"searchPages\" type=\"search\" class=\"form-control\"\n+\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Filter\">\n+\n+\t\t\t\t\t\t\t\t\t</div>\n+\t\t\t\t\t\t\t\t</div>\n+\t\t\t\t\t\t\t</form>\n+\t\t\t\t\t\t\t<!-- Pages Table -->\n+\t\t\t\t\t\t\t<table class=\"table table-striped table-bordered table-hover\"\n+\t\t\t\t\t\t\t\tid=\"pagesTable\">\n+\t\t\t\t\t\t\t\t<thead>\n+\t\t\t\t\t\t\t\t\t<tr>\n+\t\t\t\t\t\t\t\t\t\t<th><input type=\"checkbox\" id=\"selectAllPages\" /></th>\n+\t\t\t\t\t\t\t\t\t\t<th>Name</th>\n+\t\t\t\t\t\t\t\t\t</tr>\n+\t\t\t\t\t\t\t\t</thead>\n+\t\t\t\t\t\t\t\t<tbody></tbody>\n+\t\t\t\t\t\t\t</table>\n+\t\t\t\t\t\t</div>\n+\t\t\t\t\t</div>\n+\t\t\t\t</div>\n+\t\t\t\t<div class=\"panel panel-default\">\n+\t\t\t\t\t<div class=\"panel-heading\">\n+\t\t\t\t\t\t<h4 class=\"panel-title\">\n+\t\t\t\t\t\t\t<a data-toggle=\"collapse\" data-parent=\"#dataSelectionAccordion\"\n+\t\t\t\t\t\t\t\thref=\"#collapseThree\" class=\"collapsed\">Navigation</a>\n+\t\t\t\t\t\t</h4>\n+\t\t\t\t\t</div>\n+\t\t\t\t\t<div id=\"collapseThree\" class=\"panel-collapse collapse\">\n+\t\t\t\t\t\t<div class=\"panel-body assets-panel-body\">\n+\t\t\t\t\t\t\t<div class=\"input-group\">\n+\t\t\t\t\t\t\t\t<div id=\"toggleSwitchContainer\" class=\"form-control\"\n+\t\t\t\t\t\t\t\t\taria-describedby=\"navigationExportAddOn\" style=\"height: auto\"></div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjkyODg3Nw==", "bodyText": "I don't recall any place that we have a loading spinner inside a modal that we can refer to.\nSo wouldn't it be better to show a BusyIndicatorView while building the modal?\nThen show the modal when everything is ready.\nJust a suggestion. :)", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402928877", "createdAt": "2020-04-03T11:04:26Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferExportPopUpView.html", "diffHunk": "@@ -0,0 +1,101 @@\n+<div id=\"dataTransferExportModalBody\" class=\"container-fluid\">\n+\t<div class=\"row\">\n+\t\t<div class=\"col-md-12\">\n+\t\t\t<div id=\"progressIndicator\">\n+\t\t\t\t<p>\n+\t\t\t\t\t<span class=\"spinner spinner-lg spinner-inline\"></span> Loading\n+\t\t\t\t\tassets...", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk0NTA1Ng==", "bodyText": "Please add the copyright header to this file.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402945056", "createdAt": "2020-04-03T11:39:25Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-shared/dashbuilder-services-api/src/main/java/org/dashbuilder/transfer/DataTransferExportModel.java", "diffHunk": "@@ -0,0 +1,70 @@\n+package org.dashbuilder.transfer;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk0NjEzNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        DataTransferExportPopUp dataTransferExportPopUp) {\n          \n          \n            \n                        final DataTransferExportPopUp dataTransferExportPopUp) {", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402946134", "createdAt": "2020-04-03T11:41:43Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferScreen.java", "diffHunk": "@@ -50,11 +55,13 @@ public DataTransferScreen() {\n     public DataTransferScreen(\n             final View view,\n             final DataTransferPopUp popUp,\n-            final Caller<DataTransferServices> dataTransferServices) {\n+            final Caller<DataTransferServices> dataTransferServices,\n+            DataTransferExportPopUp dataTransferExportPopUp) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk1MDI2MA==", "bodyText": "I'd suggest to extract each table on its own class following a common contract.\nThus, DataTransferExportPopUpView could add and treat each part of the Accordion in a generic way.\nAlso, it would allow to add any other kind of exporting item more easily.\nJust a thought :)", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402950260", "createdAt": "2020-04-03T11:51:03Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferExportPopUpView.java", "diffHunk": "@@ -0,0 +1,298 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer;\n+\n+import java.util.List;\n+import java.util.stream.Collectors;\n+import java.util.stream.IntStream;\n+import java.util.stream.Stream;\n+\n+import javax.enterprise.context.Dependent;\n+import javax.enterprise.event.Event;\n+import javax.inject.Inject;\n+\n+import elemental2.dom.Element;\n+import elemental2.dom.Element.OnclickCallbackFn;\n+import elemental2.dom.HTMLCollection;\n+import elemental2.dom.HTMLDivElement;\n+import elemental2.dom.HTMLElement;\n+import elemental2.dom.HTMLInputElement;\n+import elemental2.dom.HTMLTableCellElement;\n+import elemental2.dom.HTMLTableElement;\n+import elemental2.dom.HTMLTableRowElement;\n+import elemental2.dom.NodeList;\n+import org.dashbuilder.client.cms.resources.i18n.ContentManagerConstants;\n+import org.dashbuilder.client.cms.screen.util.DomFactory;\n+import org.dashbuilder.dataset.def.DataSetDef;\n+import org.dashbuilder.transfer.DataTransferAssets;\n+import org.dashbuilder.transfer.DataTransferExportModel;\n+import org.gwtbootstrap3.client.ui.ModalFooter;\n+import org.gwtbootstrap3.extras.toggleswitch.client.ui.ToggleSwitch;\n+import org.jboss.errai.common.client.dom.elemental2.Elemental2DomUtil;\n+import org.jboss.errai.ui.shared.api.annotations.DataField;\n+import org.jboss.errai.ui.shared.api.annotations.Templated;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.uberfire.ext.editor.commons.client.file.popups.CommonModalBuilder;\n+import org.uberfire.ext.widgets.common.client.common.popups.BaseModal;\n+import org.uberfire.ext.widgets.common.client.common.popups.footers.ModalFooterOKCancelButtons;\n+import org.uberfire.workbench.events.NotificationEvent;\n+\n+@Templated\n+@Dependent\n+public class DataTransferExportPopUpView implements DataTransferExportPopUp.View {\n+\n+    private static final Logger LOGGER = LoggerFactory.getLogger(DataTransferExportPopUpView.class);\n+\n+    private ContentManagerConstants i18n = ContentManagerConstants.INSTANCE;\n+    private DataTransferExportPopUp presenter;\n+    private BaseModal modal;\n+    \n+    @Inject\n+    ToggleSwitch toggleSwitch;\n+    \n+    @Inject\n+    Elemental2DomUtil elem2Dom;\n+    \n+    @Inject\n+    @DataField \n+    HTMLDivElement toggleSwitchContainer;\n+\n+    @Inject\n+    @DataField\n+    HTMLTableElement datasetsTable;\n+\n+    @Inject\n+    @DataField\n+    HTMLTableElement pagesTable;\n+\n+    @Inject\n+    @DataField\n+    private HTMLDivElement dataTransferExportModalBody;\n+\n+    @Inject\n+    @DataField\n+    HTMLInputElement searchDatasets;\n+\n+    @Inject\n+    @DataField\n+    HTMLInputElement searchPages;\n+\n+    @Inject\n+    @DataField\n+    HTMLInputElement selectAllDatasets;\n+\n+    @Inject\n+    @DataField\n+    HTMLInputElement selectAllPages;\n+\n+    @Inject\n+    @DataField\n+    HTMLDivElement progressIndicator;\n+\n+    @Inject\n+    @DataField\n+    HTMLDivElement dataSelectionAccordion;\n+\n+    @Inject\n+    private Event<NotificationEvent> workbenchNotification;\n+\n+    @Inject\n+    DomFactory domFactory;\n+\n+    private DataTransferAssets assetsToExport;\n+\n+    @Override\n+    public HTMLElement getElement() {\n+        return dataTransferExportModalBody;\n+    }\n+\n+    @Override\n+    public void init(DataTransferExportPopUp presenter) {\n+        this.presenter = presenter;\n+        ModalFooter modalFooter = new ModalFooterOKCancelButtons(this::getSelectedAssets,\n+                                                                 () -> modal.hide());\n+        modal = new CommonModalBuilder().addHeader(i18n.dataTransferExportPopUpViewTitle())\n+                                        .addBody(dataTransferExportModalBody)\n+                                        .addFooter(modalFooter)\n+                                        .build();\n+\n+        selectAllPages.onclick = e -> {\n+            allInputsForTable(pagesTable).forEach(chk -> chk.checked = selectAllPages.checked);\n+            return null;\n+        };\n+\n+        selectAllDatasets.onclick = e -> {\n+            allInputsForTable(datasetsTable).forEach(chk -> chk.checked = selectAllDatasets.checked);\n+            return null;\n+        };\n+\n+        searchPages.onkeyup = e -> {\n+            filterTable(searchPages, pagesTable);\n+            return null;\n+        };\n+\n+        searchDatasets.onkeyup = e -> {\n+            filterTable(searchDatasets, datasetsTable);\n+            return null;\n+        };\n+        \n+        elem2Dom.appendWidgetToElement(toggleSwitchContainer, toggleSwitch);\n+        toggleSwitch.setValue(true);\n+\n+    }\n+\n+    @Override\n+    public void show() {\n+        modal.show();\n+        loading();\n+    }\n+\n+    @Override\n+    public void setAssetsToExport(DataTransferAssets assetsToExport) {\n+        this.assetsToExport = assetsToExport;\n+        finishedLoading();\n+    }\n+\n+    private void fillPagesTable() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 171}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk1Mjk2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // TODO Auto-generated method stub", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402952961", "createdAt": "2020-04-03T11:57:04Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-backend/dashbuilder-services/src/main/java/org/dashbuilder/transfer/DataTransferServicesImpl.java", "diffHunk": "@@ -181,19 +198,39 @@ public FileVisitResult visitFile(Path path, BasicFileAttributes attrs) {\n             }\n         });\n \n-        ioService.deleteIfExists(\n-                root.resolve(expectedPath));\n+        ioService.deleteIfExists(root.resolve(expectedPath));\n \n         return imported;\n     }\n \n-    private List<String> importFiles(Path path) throws Exception  {\n-        String tempPath = new StringBuilder()\n-            .append(System.getProperty(\"java.io.tmpdir\"))\n-            .append(File.separator)\n-            .append(FILE_PATH)\n-            .append(File.separator)\n-            .toString();\n+    @Override\n+    public DataTransferAssets assetsToExport() {\n+        List<String> pages = listPaths(perspectivesFS,\n+                                       p -> p.endsWith(FILE_EXT)).stream()\n+                                                                 .map(p -> p.getName(p.getNameCount() - 2))\n+                                                                 .map(Object::toString)\n+                                                                 .collect(Collectors.toList());\n+\n+        List<DataSetDef> datasetsDefs = listPaths(datasetsFS,\n+                                                  p -> p.endsWith(DATASET_EXT)).stream()\n+                                                                               .map(this::getFileContent)\n+                                                                               .map(this::parseDataSetDefinition)\n+                                                                               .collect(Collectors.toList());\n+        return new DataTransferAssets(datasetsDefs, pages);\n+    }\n+\n+    @Override\n+    public Map<String, String> validateExport(DataTransferExportModel exportsModel) {\n+        // TODO Auto-generated method stub", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 237}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk1MzQ4Nw==", "bodyText": "Double-checking: is it ok to return null here?", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402953487", "createdAt": "2020-04-03T11:58:16Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-backend/dashbuilder-services/src/main/java/org/dashbuilder/transfer/DataTransferServicesImpl.java", "diffHunk": "@@ -181,19 +198,39 @@ public FileVisitResult visitFile(Path path, BasicFileAttributes attrs) {\n             }\n         });\n \n-        ioService.deleteIfExists(\n-                root.resolve(expectedPath));\n+        ioService.deleteIfExists(root.resolve(expectedPath));\n \n         return imported;\n     }\n \n-    private List<String> importFiles(Path path) throws Exception  {\n-        String tempPath = new StringBuilder()\n-            .append(System.getProperty(\"java.io.tmpdir\"))\n-            .append(File.separator)\n-            .append(FILE_PATH)\n-            .append(File.separator)\n-            .toString();\n+    @Override\n+    public DataTransferAssets assetsToExport() {\n+        List<String> pages = listPaths(perspectivesFS,\n+                                       p -> p.endsWith(FILE_EXT)).stream()\n+                                                                 .map(p -> p.getName(p.getNameCount() - 2))\n+                                                                 .map(Object::toString)\n+                                                                 .collect(Collectors.toList());\n+\n+        List<DataSetDef> datasetsDefs = listPaths(datasetsFS,\n+                                                  p -> p.endsWith(DATASET_EXT)).stream()\n+                                                                               .map(this::getFileContent)\n+                                                                               .map(this::parseDataSetDefinition)\n+                                                                               .collect(Collectors.toList());\n+        return new DataTransferAssets(datasetsDefs, pages);\n+    }\n+\n+    @Override\n+    public Map<String, String> validateExport(DataTransferExportModel exportsModel) {\n+        // TODO Auto-generated method stub\n+        return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 238}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk1NTcyNA==", "bodyText": "Consider extracting System.getProperty(\"java.io.tmpdir\") to a constant.\nI see it being used more than once on this class.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402955724", "createdAt": "2020-04-03T12:02:44Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-backend/dashbuilder-services/src/main/java/org/dashbuilder/transfer/DataTransferServicesImpl.java", "diffHunk": "@@ -108,22 +114,37 @@ public DataTransferServicesImpl(\n     }\n \n     @Override\n-    public String doExport() throws java.io.IOException {\n-        String zipLocation = new StringBuilder()\n-            .append(System.getProperty(\"java.io.tmpdir\"))\n-            .append(File.separator)\n-            .append(FILE_PATH)\n-            .append(File.separator)\n-            .append(EXPORT_FILE_NAME)\n-            .toString();\n+    public String doExport(DataTransferExportModel exportModel) throws java.io.IOException {\n+        String zipLocation = new StringBuilder().append(System.getProperty(\"java.io.tmpdir\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 106}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjk1Nzk2Ng==", "bodyText": "Consider using DirectoryStream here.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r402957966", "createdAt": "2020-04-03T12:06:44Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-backend/dashbuilder-services/src/main/java/org/dashbuilder/transfer/DataTransferServicesImpl.java", "diffHunk": "@@ -384,4 +415,70 @@ private File createVersionFile() throws java.io.IOException {\n \n         return version;\n     }\n+\n+    private List<Path> listPaths(FileSystem fs, Predicate<String> pathTester) {\n+        List<Path> files = new ArrayList<>();\n+        Path root = fs.getRootDirectories().iterator().next();\n+        Files.walkFileTree(root, new SimpleFileVisitor<Path>() {\n+\n+            @Override\n+            public FileVisitResult visitFile(Path path, BasicFileAttributes attrs) {\n+                try {\n+                    if (pathTester.test(path.toString())) {\n+                        files.add(path);\n+                    }\n+                    return FileVisitResult.CONTINUE;\n+\n+                } catch (Exception e) {\n+                    LOGGER.error(e.getMessage(), e);\n+                    return FileVisitResult.TERMINATE;\n+                }\n+            }\n+        });", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9"}, "originalPosition": 441}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a74b4a7f646b14ef763d402579c8e86d10cbb7a9", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/a74b4a7f646b14ef763d402579c8e86d10cbb7a9", "committedDate": "2020-03-25T16:59:57Z", "message": "Export navigation adjustments"}, "afterCommit": {"oid": "10be9a94d516455fa2a51da0cff46e83a164d80f", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/10be9a94d516455fa2a51da0cff46e83a164d80f", "committedDate": "2020-04-20T20:25:17Z", "message": "Changing from PopUp to Wizard"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "10be9a94d516455fa2a51da0cff46e83a164d80f", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/10be9a94d516455fa2a51da0cff46e83a164d80f", "committedDate": "2020-04-20T20:25:17Z", "message": "Changing from PopUp to Wizard"}, "afterCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/d69d8664df26eb75dd81da41958168b149dde09d", "committedDate": "2020-04-20T20:45:19Z", "message": "Changing from PopUp to Wizard"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MDA0OTM4", "url": "https://github.com/kiegroup/appformer/pull/933#pullrequestreview-399004938", "createdAt": "2020-04-23T11:25:48Z", "commit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "state": "COMMENTED", "comments": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMToyNTo0OVrOGKkXUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMjoyNTo1M1rOGKmlxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzczNDczOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            DataTransferView.gradual_export=Export Wizard\n          \n          \n            \n            DataTransferView.gradualExport=Export Wizard", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413734739", "createdAt": "2020-04-23T11:25:49Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/resources/org/dashbuilder/client/cms/resources/i18n/ContentManagerConstants.properties", "diffHunk": "@@ -52,6 +52,7 @@ newPerspectivePopUpViewErrorDuplicatedName=Page name already exists\n workbenchPartTitle=Dashbuilder Data Transfer\n DataTransferView.import=Import\n DataTransferView.export=Export\n+DataTransferView.gradual_export=Export Wizard", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzczNTA1Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                            data-i18n-key=\"gradual_export\"></button>\n          \n          \n            \n                                            data-i18n-key=\"gradualExport\"></button>", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413735052", "createdAt": "2020-04-23T11:26:18Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferView.html", "diffHunk": "@@ -7,7 +7,12 @@\n                         <h1 data-i18n-key=\"export\"></h1>\n                         <p data-i18n-key=\"exportText\"></p>\n                         <div class=\"card-pf-items\">\n-                            <button class=\"btn btn-primary btn-lg\" data-field=\"btnExport\" data-i18n-key=\"export\"></button>\n+                            <button class=\"btn btn-primary btn-lg\"\n+                                data-field=\"btnExport\"\n+                                data-i18n-key=\"export\"></button>\n+                            <button class=\"btn btn-primary btn-lg\"\n+                                data-field=\"btnGradualExport\"\n+                                data-i18n-key=\"gradual_export\"></button>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc0NDEyNw==", "bodyText": "I think it won't work for other languages, like Japanese.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413744127", "createdAt": "2020-04-23T11:42:05Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/export/wizard/ExportSummaryWizardPageView.java", "diffHunk": "@@ -0,0 +1,111 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer.export.wizard;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+import javax.inject.Named;\n+\n+import com.google.gwt.event.dom.client.ClickEvent;\n+import elemental2.dom.HTMLAnchorElement;\n+import elemental2.dom.HTMLButtonElement;\n+import elemental2.dom.HTMLDivElement;\n+import elemental2.dom.HTMLElement;\n+import elemental2.dom.HTMLHeadingElement;\n+import org.dashbuilder.transfer.DataTransferExportModel;\n+import org.jboss.errai.ui.shared.api.annotations.DataField;\n+import org.jboss.errai.ui.shared.api.annotations.EventHandler;\n+import org.jboss.errai.ui.shared.api.annotations.Templated;\n+\n+@Templated\n+@ApplicationScoped\n+public class ExportSummaryWizardPageView implements ExportSummaryWizardPage.View {\n+\n+    @Inject\n+    @DataField\n+    HTMLDivElement exportWizardSummary;\n+\n+    @Inject\n+    @DataField\n+    @Named(\"span\")\n+    HTMLElement datasetsInformation;\n+\n+    @Inject\n+    @DataField\n+    @Named(\"span\")\n+    HTMLElement pagesInformation;\n+\n+    @Inject\n+    @DataField\n+    HTMLAnchorElement datasetsInfoAnchor;\n+\n+    @Inject\n+    @DataField\n+    HTMLAnchorElement pagesInfoAnchor;\n+\n+    @Inject\n+    @DataField\n+    HTMLButtonElement downloadExport;\n+    \n+    @Inject\n+    @DataField\n+    @Named(\"h1\")\n+    HTMLHeadingElement exportHeading;\n+    \n+    private ExportSummaryWizardPage presenter;\n+\n+    @Override\n+    public void init(ExportSummaryWizardPage presenter) {\n+        this.presenter = presenter;\n+    }\n+\n+    @Override\n+    public HTMLElement getElement() {\n+        return exportWizardSummary;\n+    }\n+\n+    @EventHandler(\"downloadExport\")\n+    public void downloadAction(ClickEvent click) {\n+        presenter.confirmDownload();\n+    }\n+\n+    @EventHandler(\"datasetsInfoAnchor\")\n+    public void datasetsInfoAnchorClicked(ClickEvent click) {\n+        presenter.goToDataSetsPage();\n+    }\n+\n+    @EventHandler(\"pagesInfoAnchor\")\n+    public void pagesInfoAnchorClicked(ClickEvent click) {\n+        presenter.goToPagesPage();\n+    }\n+\n+    @Override\n+    public void show(DataTransferExportModel dataTransferExportModel) {\n+        pagesInformation.textContent = checkPlural(dataTransferExportModel.getPages().size(), \"page\");\n+        datasetsInformation.textContent = checkPlural(dataTransferExportModel.getDatasetDefinitions().size(),\n+                                                      \"dataset\");\n+    }\n+\n+    private String checkPlural(int size, String text) {\n+        String finalText = size + \" \" + text;\n+        if (size == 1) {\n+            return finalText;\n+        }\n+        return finalText.concat(\"s\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 108}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc0NTQwMg==", "bodyText": "Consider using i18n for \"page\" and \"dataset\".", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413745402", "createdAt": "2020-04-23T11:44:24Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/export/wizard/ExportSummaryWizardPageView.java", "diffHunk": "@@ -0,0 +1,111 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer.export.wizard;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+import javax.inject.Named;\n+\n+import com.google.gwt.event.dom.client.ClickEvent;\n+import elemental2.dom.HTMLAnchorElement;\n+import elemental2.dom.HTMLButtonElement;\n+import elemental2.dom.HTMLDivElement;\n+import elemental2.dom.HTMLElement;\n+import elemental2.dom.HTMLHeadingElement;\n+import org.dashbuilder.transfer.DataTransferExportModel;\n+import org.jboss.errai.ui.shared.api.annotations.DataField;\n+import org.jboss.errai.ui.shared.api.annotations.EventHandler;\n+import org.jboss.errai.ui.shared.api.annotations.Templated;\n+\n+@Templated\n+@ApplicationScoped\n+public class ExportSummaryWizardPageView implements ExportSummaryWizardPage.View {\n+\n+    @Inject\n+    @DataField\n+    HTMLDivElement exportWizardSummary;\n+\n+    @Inject\n+    @DataField\n+    @Named(\"span\")\n+    HTMLElement datasetsInformation;\n+\n+    @Inject\n+    @DataField\n+    @Named(\"span\")\n+    HTMLElement pagesInformation;\n+\n+    @Inject\n+    @DataField\n+    HTMLAnchorElement datasetsInfoAnchor;\n+\n+    @Inject\n+    @DataField\n+    HTMLAnchorElement pagesInfoAnchor;\n+\n+    @Inject\n+    @DataField\n+    HTMLButtonElement downloadExport;\n+    \n+    @Inject\n+    @DataField\n+    @Named(\"h1\")\n+    HTMLHeadingElement exportHeading;\n+    \n+    private ExportSummaryWizardPage presenter;\n+\n+    @Override\n+    public void init(ExportSummaryWizardPage presenter) {\n+        this.presenter = presenter;\n+    }\n+\n+    @Override\n+    public HTMLElement getElement() {\n+        return exportWizardSummary;\n+    }\n+\n+    @EventHandler(\"downloadExport\")\n+    public void downloadAction(ClickEvent click) {\n+        presenter.confirmDownload();\n+    }\n+\n+    @EventHandler(\"datasetsInfoAnchor\")\n+    public void datasetsInfoAnchorClicked(ClickEvent click) {\n+        presenter.goToDataSetsPage();\n+    }\n+\n+    @EventHandler(\"pagesInfoAnchor\")\n+    public void pagesInfoAnchorClicked(ClickEvent click) {\n+        presenter.goToPagesPage();\n+    }\n+\n+    @Override\n+    public void show(DataTransferExportModel dataTransferExportModel) {\n+        pagesInformation.textContent = checkPlural(dataTransferExportModel.getPages().size(), \"page\");\n+        datasetsInformation.textContent = checkPlural(dataTransferExportModel.getDatasetDefinitions().size(),\n+                                                      \"dataset\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 100}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc0NzE3Mw==", "bodyText": "Please add the copyright header to this file.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413747173", "createdAt": "2020-04-23T11:47:29Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/export/wizard/ExportSummaryWizardPageView.html", "diffHunk": "@@ -0,0 +1,24 @@\n+<div id=\"exportWizardSummary\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc0NzQ4NQ==", "bodyText": "Consider using i18n for \"Your export is ready\".", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413747485", "createdAt": "2020-04-23T11:48:05Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/export/wizard/ExportSummaryWizardPageView.html", "diffHunk": "@@ -0,0 +1,24 @@\n+<div id=\"exportWizardSummary\">\n+    <div class=\"blank-slate-pf summaryContainer\">\n+        <div class=\"blank-slate-pf-icon\">\n+            <span class=\"pficon pficon-ok\"></span>\n+        </div>\n+        <h1 id=\"exportHeading\">Your export is ready</h1>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc0Nzc0NQ==", "bodyText": "Consider using i18n for \"Download\".", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413747745", "createdAt": "2020-04-23T11:48:33Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/export/wizard/ExportSummaryWizardPageView.html", "diffHunk": "@@ -0,0 +1,24 @@\n+<div id=\"exportWizardSummary\">\n+    <div class=\"blank-slate-pf summaryContainer\">\n+        <div class=\"blank-slate-pf-icon\">\n+            <span class=\"pficon pficon-ok\"></span>\n+        </div>\n+        <h1 id=\"exportHeading\">Your export is ready</h1>\n+\n+        <div class=\"list-group\">\n+            <div class=\"list-group-item\">\n+                <span class=\"fa fa-database\"></span> <a href=\"#\"\n+                    id=\"datasetsInfoAnchor\"> <span\n+                    id=\"datasetsInformation\"></span></a>\n+            </div>\n+            <div class=\"list-group-item\">\n+                <span class=\"glyphicon glyphicon-list-alt\"></span> <a\n+                    href=\"#\" id=\"pagesInfoAnchor\"><span\n+                    id=\"pagesInformation\"></span></a>\n+            </div>\n+        </div>\n+        <div class=\"blank-slate-pf-main-action\">\n+            <button class=\"btn btn-primary btn-lg\" id=\"downloadExport\">Download</button>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc0OTA5MA==", "bodyText": "Is it a TODO?", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413749090", "createdAt": "2020-04-23T11:50:51Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/export/wizard/ExportSummaryWizardPage.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer.export.wizard;\n+\n+import java.util.function.Supplier;\n+\n+import javax.annotation.PostConstruct;\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import com.google.gwt.user.client.ui.Widget;\n+import org.dashbuilder.transfer.DataTransferExportModel;\n+import org.jboss.errai.common.client.ui.ElementWrapperWidget;\n+import org.uberfire.client.callbacks.Callback;\n+import org.uberfire.client.mvp.UberElemental;\n+import org.uberfire.ext.widgets.core.client.wizards.WizardPage;\n+import org.uberfire.mvp.Command;\n+import org.uberfire.mvp.ParameterizedCommand;\n+\n+@ApplicationScoped\n+public class ExportSummaryWizardPage implements WizardPage {\n+\n+    @Inject\n+    View view;\n+\n+    private Supplier<DataTransferExportModel> exportModelSupplier;\n+    private ParameterizedCommand<DataTransferExportModel> dataTransferExportModelCallback;\n+    private DataTransferExportModel dataTransferExportModel;\n+\n+    private Command goToDataSetsCommand = () -> {\n+    };\n+\n+    private Command goToPagesPage = () -> {\n+    };\n+\n+    public interface View extends UberElemental<ExportSummaryWizardPage> {\n+\n+        void show(DataTransferExportModel dataTransferExportModel);\n+\n+    }\n+\n+    @PostConstruct\n+    public void init() {\n+        view.init(this);\n+    }\n+\n+    @Override\n+    public Widget asWidget() {\n+        return ElementWrapperWidget.getWidget(view.getElement());\n+    }\n+\n+    @Override\n+    public String getTitle() {\n+        return \"Export Summary\";\n+    }\n+\n+    @Override\n+    public void isComplete(Callback<Boolean> callback) {\n+        // add validation here when it is ready", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc1MDEzNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private Command goToPagesPage = () -> {\n          \n          \n            \n                private Command goToPagesCommand = () -> {", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413750135", "createdAt": "2020-04-23T11:52:33Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/export/wizard/ExportSummaryWizardPage.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer.export.wizard;\n+\n+import java.util.function.Supplier;\n+\n+import javax.annotation.PostConstruct;\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import com.google.gwt.user.client.ui.Widget;\n+import org.dashbuilder.transfer.DataTransferExportModel;\n+import org.jboss.errai.common.client.ui.ElementWrapperWidget;\n+import org.uberfire.client.callbacks.Callback;\n+import org.uberfire.client.mvp.UberElemental;\n+import org.uberfire.ext.widgets.core.client.wizards.WizardPage;\n+import org.uberfire.mvp.Command;\n+import org.uberfire.mvp.ParameterizedCommand;\n+\n+@ApplicationScoped\n+public class ExportSummaryWizardPage implements WizardPage {\n+\n+    @Inject\n+    View view;\n+\n+    private Supplier<DataTransferExportModel> exportModelSupplier;\n+    private ParameterizedCommand<DataTransferExportModel> dataTransferExportModelCallback;\n+    private DataTransferExportModel dataTransferExportModel;\n+\n+    private Command goToDataSetsCommand = () -> {\n+    };\n+\n+    private Command goToPagesPage = () -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc1MDkzNA==", "bodyText": "Consider using i18n for \"Select Datasets\".", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413750934", "createdAt": "2020-04-23T11:53:50Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/export/wizard/DataSetsWizardPage.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer.export.wizard;\n+\n+import java.util.List;\n+\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.inject.Inject;\n+\n+import com.google.gwt.user.client.ui.Widget;\n+import org.dashbuilder.client.cms.screen.transfer.export.wizard.widget.DataSetsTable;\n+import org.dashbuilder.dataset.def.DataSetDef;\n+import org.jboss.errai.common.client.ui.ElementWrapperWidget;\n+import org.uberfire.client.callbacks.Callback;\n+import org.uberfire.ext.widgets.core.client.wizards.WizardPage;\n+\n+@ApplicationScoped\n+public class DataSetsWizardPage implements WizardPage {\n+\n+    @Inject\n+    DataSetsTable dataSetsTable;\n+\n+    @Override\n+    public Widget asWidget() {\n+        return ElementWrapperWidget.getWidget(dataSetsTable.getElement());\n+    }\n+\n+    @Override\n+    public String getTitle() {\n+        return \"Select Datasets\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc1NjMxMQ==", "bodyText": "Are you using this variable?\nCan it be injected on the constructor just like the others?", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413756311", "createdAt": "2020-04-23T12:02:29Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferView.java", "diffHunk": "@@ -55,6 +54,8 @@\n     private Elemental2DomUtil elem2Dom;\n     private Event<NotificationEvent> workbenchNotification;\n     private PathUrlFactory pathUrlFactory;\n+    \n+    @Inject PagesTable pagesTable;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc2MDk3Mg==", "bodyText": "Consider using i18n for \"Export Wizard\".", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413760972", "createdAt": "2020-04-23T12:10:04Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/export/wizard/ExportWizard.java", "diffHunk": "@@ -0,0 +1,129 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.dashbuilder.client.cms.screen.transfer.export.wizard;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import javax.annotation.PostConstruct;\n+import javax.enterprise.context.ApplicationScoped;\n+import javax.enterprise.event.Event;\n+import javax.enterprise.event.Observes;\n+import javax.inject.Inject;\n+\n+import com.google.gwt.user.client.ui.Widget;\n+import org.dashbuilder.transfer.DataTransferAssets;\n+import org.dashbuilder.transfer.DataTransferExportModel;\n+import org.uberfire.client.callbacks.Callback;\n+import org.uberfire.ext.widgets.core.client.wizards.AbstractWizard;\n+import org.uberfire.ext.widgets.core.client.wizards.WizardPage;\n+import org.uberfire.ext.widgets.core.client.wizards.WizardPageSelectedEvent;\n+import org.uberfire.mvp.ParameterizedCommand;\n+\n+@ApplicationScoped\n+public class ExportWizard extends AbstractWizard {\n+\n+    @Inject\n+    DataSetsWizardPage dataSetsWizardPage;\n+\n+    @Inject\n+    PagesWizardPage pagesWizardPage;\n+\n+    @Inject\n+    ExportSummaryWizardPage exportSummaryWizardPage;\n+\n+    @Inject\n+    Event<WizardPageSelectedEvent> wizardPageSelectedEvent;\n+\n+    private List<WizardPage> wizardPages;\n+\n+    private boolean canConclude;\n+\n+    @PostConstruct\n+    void init() {\n+        wizardPages = new ArrayList<>();\n+        wizardPages.add(dataSetsWizardPage);\n+        wizardPages.add(pagesWizardPage);\n+        wizardPages.add(exportSummaryWizardPage);\n+\n+        exportSummaryWizardPage.setExportSummary(this::getDataTransferExportModel);\n+        exportSummaryWizardPage.setGoToDataSetsCommand(() -> goTo(dataSetsWizardPage));\n+        exportSummaryWizardPage.setGoToPagesCommand(() -> goTo(pagesWizardPage));\n+    }\n+\n+    public void start(DataTransferAssets assets) {\n+        dataSetsWizardPage.setDataSets(assets.getDatasetsDefinitions());\n+        pagesWizardPage.setPages(assets.getPages());\n+\n+        this.start();\n+    }\n+\n+    @Override\n+    public List<WizardPage> getPages() {\n+        return wizardPages;\n+    }\n+\n+    @Override\n+    public Widget getPageWidget(int pageNumber) {\n+        return wizardPages.get(pageNumber).asWidget();\n+    }\n+\n+    @Override\n+    public String getTitle() {\n+        return \"Export Wizard\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc2Nzk2Mw==", "bodyText": "Consider using i18n for \"Loading Export Wizard\".", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413767963", "createdAt": "2020-04-23T12:21:00Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferScreen.java", "diffHunk": "@@ -70,49 +81,53 @@ public View part() {\n     @PostConstruct\n     public void init() {\n         view.init(this);\n+        exportWizard.setCallback(this::callExportService);\n     }\n \n     public void doExport() {\n-        try {\n-            dataTransferServices.call(\n-                (RemoteCallback<String>) path -> {\n-                    view.exportOK();\n-                    view.download(path);\n-\n-                }, (ErrorCallback<Exception>) (message, throwable) -> {\n-                    view.exportError(throwable);\n-                    return false;\n-\n-                }).doExport();\n+        callExportService(DataTransferExportModel.exportAll());\n+    }\n \n-        } catch (Exception e) {\n-            view.exportError(e);\n-        }\n+    public void doGradualExport() {\n+        busyIndicatorView.showBusyIndicator(\"Loading Export Wizard\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzc3MTIwNw==", "bodyText": "Could this call take noticeable time? If so, consider using BusyIndicator here as well.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r413771207", "createdAt": "2020-04-23T12:25:53Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-client/dashbuilder-cms-client/src/main/java/org/dashbuilder/client/cms/screen/transfer/DataTransferScreen.java", "diffHunk": "@@ -127,4 +142,22 @@ public String getExportFileName() {\n     public String getImportFileName() {\n         return DataTransferServices.IMPORT_FILE_NAME;\n     }\n-}\n+\n+    private void callExportService(DataTransferExportModel dataTransferExportModel) {\n+        try {\n+            dataTransferServices.call((RemoteCallback<String>) path -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d"}, "originalPosition": 131}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d69d8664df26eb75dd81da41958168b149dde09d", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/d69d8664df26eb75dd81da41958168b149dde09d", "committedDate": "2020-04-20T20:45:19Z", "message": "Changing from PopUp to Wizard"}, "afterCommit": {"oid": "99820b5d5dc802107e6d814671e6632247ea0cf6", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/99820b5d5dc802107e6d814671e6632247ea0cf6", "committedDate": "2020-04-24T20:48:44Z", "message": "i18n correctly and minor corrections"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMjY4NDE5", "url": "https://github.com/kiegroup/appformer/pull/933#pullrequestreview-400268419", "createdAt": "2020-04-24T21:02:10Z", "commit": {"oid": "99820b5d5dc802107e6d814671e6632247ea0cf6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNTc3NDg1", "url": "https://github.com/kiegroup/appformer/pull/933#pullrequestreview-402577485", "createdAt": "2020-04-29T11:26:43Z", "commit": {"oid": "fcf9c5b4296277f31107e6642cc5d30b8db6fe1b"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxMTo0OToxNVrOGN7O_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxMTo1MDo0NFrOGN7RtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzI1NTE2Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Copyright 202 Red Hat, Inc. and/or its affiliates.\n          \n          \n            \n             * Copyright 2020 Red Hat, Inc. and/or its affiliates.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r417255166", "createdAt": "2020-04-29T11:49:15Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-shared/dashbuilder-services-api/src/main/java/org/dashbuilder/transfer/ExportModelValidationService.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright 202 Red Hat, Inc. and/or its affiliates.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcf9c5b4296277f31107e6642cc5d30b8db6fe1b"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzI1NTMwMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Copyright 202 Red Hat, Inc. and/or its affiliates.\n          \n          \n            \n             * Copyright 2020 Red Hat, Inc. and/or its affiliates.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r417255300", "createdAt": "2020-04-29T11:49:31Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-backend/dashbuilder-services/src/main/java/org/dashbuilder/transfer/ExportModelValidationServiceImpl.java", "diffHunk": "@@ -0,0 +1,87 @@\n+/*\n+ * Copyright 202 Red Hat, Inc. and/or its affiliates.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcf9c5b4296277f31107e6642cc5d30b8db6fe1b"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzI1NTg2MQ==", "bodyText": "Consider adding what's returned.", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r417255861", "createdAt": "2020-04-29T11:50:44Z", "author": {"login": "caponetto"}, "path": "dashbuilder/dashbuilder-shared/dashbuilder-services-api/src/main/java/org/dashbuilder/transfer/ExportModelValidationService.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright 202 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.dashbuilder.transfer;\n+\n+import java.util.List;\n+import java.util.Map;\n+\n+import org.jboss.errai.bus.server.annotations.Remote;\n+\n+/**\n+ * Perform validations on an ExportModel\n+ *\n+ */\n+@Remote\n+public interface ExportModelValidationService {\n+\n+    /**\n+     * Check if there is datasets not exported for the given export model\n+     * \n+     * @param exportModel\n+     * @return", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fcf9c5b4296277f31107e6642cc5d30b8db6fe1b"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyNjQ3MDk2", "url": "https://github.com/kiegroup/appformer/pull/933#pullrequestreview-402647096", "createdAt": "2020-04-29T13:08:32Z", "commit": {"oid": "3ce0ffb238f10aad563277b50186abc89c9febbf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1Mjg5NzEx", "url": "https://github.com/kiegroup/appformer/pull/933#pullrequestreview-405289711", "createdAt": "2020-05-04T19:39:41Z", "commit": {"oid": "3ce0ffb238f10aad563277b50186abc89c9febbf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3ce0ffb238f10aad563277b50186abc89c9febbf", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/3ce0ffb238f10aad563277b50186abc89c9febbf", "committedDate": "2020-04-29T13:02:31Z", "message": "Comments minor fixes"}, "afterCommit": {"oid": "82d355a81ad264dbe5d6cc86c238cb1fb5916d66", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/82d355a81ad264dbe5d6cc86c238cb1fb5916d66", "committedDate": "2020-05-04T20:17:35Z", "message": "Comments minor fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDcyMjEw", "url": "https://github.com/kiegroup/appformer/pull/933#pullrequestreview-406472210", "createdAt": "2020-05-06T10:09:18Z", "commit": {"oid": "b07f076cea68660be763a5d5056e9d928657876a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxMDowOToxOFrOGRMQag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxMDowOToxOFrOGRMQag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY3OTc4Ng==", "bodyText": "is the isExportNavigation() still relevant? the navigation is always exported in the custom export", "url": "https://github.com/kiegroup/appformer/pull/933#discussion_r420679786", "createdAt": "2020-05-06T10:09:18Z", "author": {"login": "barboras7"}, "path": "dashbuilder/dashbuilder-backend/dashbuilder-services/src/main/java/org/dashbuilder/transfer/DataTransferServicesImpl.java", "diffHunk": "@@ -108,22 +114,37 @@ public DataTransferServicesImpl(\n     }\n \n     @Override\n-    public String doExport() throws java.io.IOException {\n-        String zipLocation = new StringBuilder()\n-            .append(System.getProperty(\"java.io.tmpdir\"))\n-            .append(File.separator)\n-            .append(FILE_PATH)\n-            .append(File.separator)\n-            .append(EXPORT_FILE_NAME)\n-            .toString();\n+    public String doExport(DataTransferExportModel exportModel) throws java.io.IOException {\n+        String zipLocation = new StringBuilder().append(TMP_DIR)\n+                                                .append(File.separator)\n+                                                .append(FILE_PATH)\n+                                                .append(File.separator)\n+                                                .append(EXPORT_FILE_NAME)\n+                                                .toString();\n+\n+        Predicate<Path> readmeFilter = p -> p.toString().toLowerCase().endsWith(\"readme.md\");\n+        Predicate<Path> datasetsFilter = def -> true;\n+        Predicate<Path> pagesFilter = page -> true;\n+        boolean exportNavigation = true;\n+\n+        if (!exportModel.isExportAll()) {\n+            datasetsFilter = filterDatasets(exportModel.getDatasetDefinitions());\n+            pagesFilter = filterPages(exportModel.getPages());\n+            exportNavigation = exportModel.isExportNavigation();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b07f076cea68660be763a5d5056e9d928657876a"}, "originalPosition": 125}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4OTI0OTA0", "url": "https://github.com/kiegroup/appformer/pull/933#pullrequestreview-408924904", "createdAt": "2020-05-11T07:30:17Z", "commit": {"oid": "ba0aeddff9cf3e9aa7f70b050c87eaafc23e525a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65d2327089f0cd11e8d2a192e16d72914b344064", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/65d2327089f0cd11e8d2a192e16d72914b344064", "committedDate": "2020-05-11T13:06:15Z", "message": "AF-2456: Support Gradual Export in Data Transfer API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a0d3d4c77b671e9acd4c3e6b092bc1a1a5dbb4b", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/4a0d3d4c77b671e9acd4c3e6b092bc1a1a5dbb4b", "committedDate": "2020-05-11T13:06:15Z", "message": "Export navigation adjustments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bb1e5354d8b2d4249b75e87a0d5e4cb8761a924", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/2bb1e5354d8b2d4249b75e87a0d5e4cb8761a924", "committedDate": "2020-05-11T13:09:23Z", "message": "Changing from PopUp to Wizard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "273f310214667b23f4cc2c172072c174f7d0edfc", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/273f310214667b23f4cc2c172072c174f7d0edfc", "committedDate": "2020-05-11T13:10:03Z", "message": "i18n correctly and minor corrections"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d863679893a098fd2e06912a33033cc54b1ac273", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/d863679893a098fd2e06912a33033cc54b1ac273", "committedDate": "2020-05-11T13:10:03Z", "message": "AF-2458: Validate Exported Dashboards"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "61a3f5760e97054e0be085b7a03ac7451dd1841a", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/61a3f5760e97054e0be085b7a03ac7451dd1841a", "committedDate": "2020-05-11T13:10:04Z", "message": "Comments minor fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54bf8e0681f81a07315d12d78582583e3c2ab23a", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/54bf8e0681f81a07315d12d78582583e3c2ab23a", "committedDate": "2020-05-11T13:10:04Z", "message": "Fix on page select"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f47be2a2c35557d63568897e9899406ec1257cc5", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/f47be2a2c35557d63568897e9899406ec1257cc5", "committedDate": "2020-05-11T13:10:04Z", "message": "Removing Warning state and improving export wizard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9582833a1dd2938ed65dfbcb8cf0ce7f11b6d964", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/9582833a1dd2938ed65dfbcb8cf0ce7f11b6d964", "committedDate": "2020-05-11T13:10:04Z", "message": "Avoid validation of null UUID"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83584de59e0e5a2e847d4ee97661fbf3fa8a431d", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/83584de59e0e5a2e847d4ee97661fbf3fa8a431d", "committedDate": "2020-05-11T17:33:35Z", "message": "leftovers after rebase"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ba0aeddff9cf3e9aa7f70b050c87eaafc23e525a", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/ba0aeddff9cf3e9aa7f70b050c87eaafc23e525a", "committedDate": "2020-05-07T13:55:58Z", "message": "Avoid validation of null UUID"}, "afterCommit": {"oid": "83584de59e0e5a2e847d4ee97661fbf3fa8a431d", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/83584de59e0e5a2e847d4ee97661fbf3fa8a431d", "committedDate": "2020-05-11T17:33:35Z", "message": "leftovers after rebase"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35eeb29f56eb660ce71d6716279860b6ea5c1274", "author": {"user": {"login": "jesuino", "name": "William Ant\u00f4nio Siqueira"}}, "url": "https://github.com/kiegroup/appformer/commit/35eeb29f56eb660ce71d6716279860b6ea5c1274", "committedDate": "2020-05-11T17:55:54Z", "message": "Add data transfer to a Dashbuilder menu"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2083, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}