{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0OTE1Nzgx", "number": 467, "title": "Add integrationtest for metrics-aggregation-plugin", "bodyText": "Team mit @MxKilian\n@uhafner Das ist aktuell der Grundriss, wie ich mir den Integrationstest vorgestellt h\u00e4tte. Analog zu den bisherigen Integrationstests im Autograding-Plugin, habe ich es auch mit einem Recorder versucht, um den Freestylejob zu konfigurieren. Allerdings ist mir nicht klar, wie der MetricsRecorder aus dem Metrics-Aggregation-Plugin importiert/eingebunden werden kann. (https://github.com/jenkinsci/metrics-aggregation-plugin/blob/master/plugin/src/main/java/io/jenkins/plugins/metrics/analysis/steps/MetricsRecorder.java)\nIst das \u00fcberhaupt der richtige Weg? Bisher wird der Import nicht erkannt (https://github.com/jenkinsci/warnings-ng-plugin/pull/467/files#diff-0dc4278a460ec6d4a2925f90f024948bR11)", "createdAt": "2020-05-07T20:57:41Z", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/467", "merged": true, "mergeCommit": {"oid": "ed2072941c5e2093ea8309cbbc753d1fe87684df"}, "closed": true, "closedAt": "2020-05-28T18:57:03Z", "author": {"login": "ThoGro"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfDp4sAH2gAyNDE0OTE1NzgxOjlhZTcxYWRlNTVkNzQ2YjQzMmU4MzU1ZjgwMzcyODc4ZTZlZTlmMzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclg-SygH2gAyNDE0OTE1NzgxOmVkMjA3Mjk0MWM1ZTIwOTNlYTgzMDljYmJjNzUzZDFmZTg3Njg0ZGY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9ae71ade55d746b432e8355f80372878e6ee9f39", "author": {"user": {"login": "ThoGro", "name": "Thomas Gro\u00dfbeck"}}, "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/9ae71ade55d746b432e8355f80372878e6ee9f39", "committedDate": "2020-05-07T20:53:12Z", "message": "Add integrationtest for metrics-aggregation-plugin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNzQ0MDM0", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/467#pullrequestreview-411744034", "createdAt": "2020-05-14T12:17:20Z", "commit": {"oid": "9ae71ade55d746b432e8355f80372878e6ee9f39"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxMjoxNzoyMFrOGVZfcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxMjoxNzoyMFrOGVZfcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTA5MDkzMA==", "bodyText": "Build build = scheduleBuild();\nbuild.getAction(Metrics*Action.class).getResults().getMetrics().hasErrorFromWarnings();", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/467#discussion_r425090930", "createdAt": "2020-05-14T12:17:20Z", "author": {"login": "uhafner"}, "path": "plugin/src/test/java/io/jenkins/plugins/analysis/warnings/plugins/MetricsAggregationPluginITest.java", "diffHunk": "@@ -0,0 +1,39 @@\n+package io.jenkins.plugins.analysis.warnings.plugins;\n+\n+import org.junit.Test;\n+\n+import hudson.model.FreeStyleProject;\n+import hudson.model.Result;\n+\n+import io.jenkins.plugins.analysis.core.model.AnalysisResult;\n+import io.jenkins.plugins.analysis.core.testutil.IntegrationTestWithJenkinsPerSuite;\n+import io.jenkins.plugins.analysis.warnings.Java;\n+import io.jenkins.plugins.metrics.analysis.steps.MetricsRecorder;\n+\n+import static io.jenkins.plugins.analysis.core.assertions.Assertions.*;\n+\n+public class MetricsAggregationPluginITest extends IntegrationTestWithJenkinsPerSuite {\n+\n+    @Test\n+    public void shouldAggregateMetrics() {\n+        FreeStyleProject project = createJavaWarningsFreestyleProject(\"pmd.xml\", \"cpd.xml\", \"spotbugsXml.xml\");\n+\n+        MetricsRecorder recorder = new MetricsRecorder();\n+        recorder.setFilePattern(\"**/*.txt\");\n+\n+        project.getPublishersList().add(recorder);\n+\n+        AnalysisResult analysisResult = scheduleBuildAndAssertStatus(project, Result.SUCCESS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ae71ade55d746b432e8355f80372878e6ee9f39"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed2072941c5e2093ea8309cbbc753d1fe87684df", "author": {"user": {"login": "ThoGro", "name": "Thomas Gro\u00dfbeck"}}, "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/ed2072941c5e2093ea8309cbbc753d1fe87684df", "committedDate": "2020-05-27T22:26:17Z", "message": "Test Metrics Aggregation Plugin with MetricsViewAction"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 141, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}