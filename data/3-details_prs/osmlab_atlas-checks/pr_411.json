{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE2NTQ5MjYy", "number": 411, "title": "MapRouletteUploadCommand: support for Tag fixSuggestions", "bodyText": "Description:\nThis is an update to MapRouletteUploadCommand (and related files) to send up tag-related fix suggestions.\nThe new process is to upload line delimited geojson using the MR upload command is as follows: we read each line in the geojson file and deserialize it using the CheckFlagDeserializer, extract relevant data from the newly created CheckFlag to create Challenges, and use CheckFlag's built in getMapRouletteTask() to batch and upload Tasks to MR.\nNotable points:\nA new parameter for the MR upload command determines whether or not fix suggestions are uploaded. Supply true if you want all fix suggestions to be uploaded, or false if you want none. -includeFixSuggestions=<true/false>\nTaskDeserializer is no longer used, its sole usage having been in the MR upload command and it being replaced by the CheckFlagDeserializer. I would argue TaskDeserializer is obsolete as it does not consider fix suggestions, while CheckFlagDeserializer does\nIf there are no issues with this reasoning I can delete TaskDeserializer.\nPotential Impact:\n\nA FlaggedPoint extends FlaggedObject created by one of its constructors is now associated with a country, IF the supplied constructor data is derived from an Atlas. Another method to create FlaggedPoints is from a raw Location -- such FlaggedPoints are not associated with countries and behave as before\nOpenStreetMapCheckFlagConverter uses the input CheckFlag's challenge name as its own challenge name if one exists\n\nUnit Test Approach:\nTagChangeOperationTest, and some tweaks to existing tests\nTest Results:\nSample upload for tag update fix suggestion:\n\nfor tag remove:", "createdAt": "2020-11-06T06:57:17Z", "url": "https://github.com/osmlab/atlas-checks/pull/411", "merged": true, "mergeCommit": {"oid": "3ff1627e3dff3537f7248a31fb9a426e393a4437"}, "closed": true, "closedAt": "2020-11-16T16:31:15Z", "author": {"login": "seancoulter"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZw2-dAH2gAyNTE2NTQ5MjYyOjk5OGM1OGZlMjk1MjY2ODE4YzAwYmFmODgyNzk0MWE1NGNkMDdlMzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcBosUAFqTUyOTgxNDM3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "998c58fe295266818c00baf8827941a54cd07e38", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/998c58fe295266818c00baf8827941a54cd07e38", "committedDate": "2020-11-06T06:20:50Z", "message": "implement without tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0db74c37cc14d495bf2dee5ae6b830d977f88ce7", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/0db74c37cc14d495bf2dee5ae6b830d977f88ce7", "committedDate": "2020-11-06T20:19:30Z", "message": "update some tests and fix some bugs; use osm flag for upload"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "affc7f233b064e26329cb2f68eb35f6eef225d89", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/affc7f233b064e26329cb2f68eb35f6eef225d89", "committedDate": "2020-11-07T02:10:11Z", "message": "various clean ups and tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI3Mzk0NDU3", "url": "https://github.com/osmlab/atlas-checks/pull/411#pullrequestreview-527394457", "createdAt": "2020-11-10T16:40:32Z", "commit": {"oid": "affc7f233b064e26329cb2f68eb35f6eef225d89"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNjo0MDozMlrOHwla4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNjo0MDozMlrOHwla4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcwNjc4Nw==", "bodyText": "I think this should be optional. Can we add a parameter to this method to set whether we want to include the fix suggestions? This could also be accompanied by an overloaded version of this method that enables this by default, to keep things backwards compatible. We should then also have a command argument for the upload command to set this.", "url": "https://github.com/osmlab/atlas-checks/pull/411#discussion_r520706787", "createdAt": "2020-11-10T16:40:32Z", "author": {"login": "Bentleysb"}, "path": "src/main/java/org/openstreetmap/atlas/checks/flag/CheckFlag.java", "diffHunk": "@@ -485,6 +485,10 @@ public Task getMapRouletteTask()\n                     .map(flaggedRelation -> flaggedRelation.asGeoJsonFeature(this.identifier))\n                     .forEach(features::add);\n         }\n+        if (!this.fixSuggestions.isEmpty())\n+        {\n+            task.setCooperativeWork(this.fixSuggestions);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "affc7f233b064e26329cb2f68eb35f6eef225d89"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f1d8c1668e1cd2e3624f97b7b4bd3763062f365", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/1f1d8c1668e1cd2e3624f97b7b4bd3763062f365", "committedDate": "2020-11-10T19:56:33Z", "message": "fix suggestion upload optional"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca619a2cb6cd1b353ba6d61e55ede7d1ba98f44f", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/ca619a2cb6cd1b353ba6d61e55ede7d1ba98f44f", "committedDate": "2020-11-11T21:47:43Z", "message": "sonar"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4NjQ4MjU2", "url": "https://github.com/osmlab/atlas-checks/pull/411#pullrequestreview-528648256", "createdAt": "2020-11-12T00:21:36Z", "commit": {"oid": "ca619a2cb6cd1b353ba6d61e55ede7d1ba98f44f"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "157281c5f190f6f818baaa0d06f9d6d62d9bf989", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/157281c5f190f6f818baaa0d06f9d6d62d9bf989", "committedDate": "2020-11-12T00:54:54Z", "message": "ignore cognitive complexity and delete unused file"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4Njc1NTg4", "url": "https://github.com/osmlab/atlas-checks/pull/411#pullrequestreview-528675588", "createdAt": "2020-11-12T01:44:44Z", "commit": {"oid": "157281c5f190f6f818baaa0d06f9d6d62d9bf989"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5ODE0Mzc2", "url": "https://github.com/osmlab/atlas-checks/pull/411#pullrequestreview-529814376", "createdAt": "2020-11-13T07:01:28Z", "commit": {"oid": "157281c5f190f6f818baaa0d06f9d6d62d9bf989"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3214, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}