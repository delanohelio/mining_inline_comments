{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0OTQ4NzM4", "number": 435, "title": "Handle invalid serialized CheckFlags: solves https://github.com/osmlab/atlas-checks/issues/415", "bodyText": "Description:\nThis is a 3 file change to better handle CheckFlags that do not hold any flagged objects. Changed files are as follows -\nCheckFlagDeserializer.java: return a null CheckFlag if the data being deserialized does not have a type field (type indicates it's a feature collection). By definition, a CheckFlag flags one or more objects, and the absence of a type field in the checkflag geojson means there are no objects. So we short circuit here\nMap roulette upload command: do not upload a task with no flagged features\nWaterAreaCheck.java: make sure to flag features as we encounter flaggable scenarios\nPotential Impact:\nCheckFlagDeserializer will not deserialize feature collections that have no actual features Flagged.\nWaterAreaCheck produces CheckFlags with flagged features in more scenarios\nMR upload command doesn't upload flags with no flagged features\nUnit Test Approach:\nTested the MR upload command on a WaterAreaCheck flag dump\nTest Results:\nThe MR upload command ignored invalid flags and uploaded valid ones as expected", "createdAt": "2020-11-20T21:02:02Z", "url": "https://github.com/osmlab/atlas-checks/pull/435", "merged": true, "mergeCommit": {"oid": "b8e85029a710e2821352ea089e914df42c5fd1d4"}, "closed": true, "closedAt": "2020-12-02T18:31:55Z", "author": {"login": "seancoulter"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddmIvrgH2gAyNTI0OTQ4NzM4Ojc5NTM4Zjg1YmI1MTI2OWI4ZGM3NmQwZmNlNmNlMzBlN2I1OGE1MjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiRF9EgFqTU0MzAxMTY4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "79538f85bb51269b8dc76d0fce6ce30e7b58a525", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/79538f85bb51269b8dc76d0fce6ce30e7b58a525", "committedDate": "2020-11-18T04:06:59Z", "message": "update waterAreaCheck and CheckFlagDeserializer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad93764a56aa1bc4e13110d773dac4e3e98a4c20", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/ad93764a56aa1bc4e13110d773dac4e3e98a4c20", "committedDate": "2020-11-20T20:50:41Z", "message": "Merge https://github.com/osmlab/atlas-checks into mrUploadFixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1NzgwMTE2", "url": "https://github.com/osmlab/atlas-checks/pull/435#pullrequestreview-535780116", "createdAt": "2020-11-20T21:13:56Z", "commit": {"oid": "ad93764a56aa1bc4e13110d773dac4e3e98a4c20"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b01f4f91ebc5b9f9bd5f9543a46dead3a362fb4", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/0b01f4f91ebc5b9f9bd5f9543a46dead3a362fb4", "committedDate": "2020-11-24T19:21:55Z", "message": "fix javadoc warning"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11c4e165cabea524a685f43070185a72b78d5ff9", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/11c4e165cabea524a685f43070185a72b78d5ff9", "committedDate": "2020-11-25T05:59:37Z", "message": "add null check test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4NzU2NTAy", "url": "https://github.com/osmlab/atlas-checks/pull/435#pullrequestreview-538756502", "createdAt": "2020-11-25T18:26:26Z", "commit": {"oid": "11c4e165cabea524a685f43070185a72b78d5ff9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMDExNjgw", "url": "https://github.com/osmlab/atlas-checks/pull/435#pullrequestreview-543011680", "createdAt": "2020-12-02T16:25:19Z", "commit": {"oid": "11c4e165cabea524a685f43070185a72b78d5ff9"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNjoyNToxOVrOH9jQow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNjoyNToxOVrOH9jQow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMwMjg4Mw==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/osmlab/atlas-checks/pull/435#discussion_r534302883", "createdAt": "2020-12-02T16:25:19Z", "author": {"login": "sayas01"}, "path": "src/main/java/org/openstreetmap/atlas/checks/flag/serializer/CheckFlagDeserializer.java", "diffHunk": "@@ -94,6 +94,12 @@ public CheckFlag deserialize(final JsonElement json, final Type typeOfT,\n             final JsonDeserializationContext context)\n     {\n         final JsonObject full = json.getAsJsonObject();\n+        if (full.get(\"type\") == null)\n+        {\n+            // Consumers of this deserializer will have to handle this null result. Indicates the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11c4e165cabea524a685f43070185a72b78d5ff9"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3235, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}