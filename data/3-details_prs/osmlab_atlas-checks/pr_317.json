{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1NTM3NzM4", "number": 317, "title": "Vlad roundabout bad tagging", "bodyText": "Description:\nbug fix for flagging roundabouts with SyntheticBoundaryNode\n#316\nPotential Impact:\nN/A\nUnit Test Approach:\nTook existent unit test which suppose to flag an issue. Added SyntheticBoundaryNode tag to random Node. tags = { \"synthetic_boundary_node=YES\" }). Roundabout is not flagging anymore.\nTest Results:\npassed.", "createdAt": "2020-06-17T00:44:08Z", "url": "https://github.com/osmlab/atlas-checks/pull/317", "merged": true, "mergeCommit": {"oid": "9fc7ccc29684fc4b5a4ffaf38b95347e7cf1f032"}, "closed": true, "closedAt": "2020-06-24T23:27:14Z", "author": {"login": "vladlemberg"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcr-w1mgH2gAyNDM1NTM3NzM4OmRmOGE0MjQ0NWVhNTMzYTFjY2IzZGE1M2ZhNGFjYzk1NmE4ODljMWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuh9ILAFqTQzNzA1NDU2NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "df8a42445ea533a1ccb3da53fa4acc956a889c1e", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/df8a42445ea533a1ccb3da53fa4acc956a889c1e", "committedDate": "2020-06-17T00:32:17Z", "message": "Fix flagging roundabout with Synthetic Node\nhttps://github.com/osmlab/atlas-checks/issues/316"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0cfc6de6c54538cb2d826ec0a3cb6be44162076", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/e0cfc6de6c54538cb2d826ec0a3cb6be44162076", "committedDate": "2020-06-17T00:33:09Z", "message": "Unit Test for Synthetic Node flagging\nhttps://github.com/osmlab/atlas-checks/issues/316"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0cc038c3b0606e2a2f2826c8059ddca97a64aa00", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/0cc038c3b0606e2a2f2826c8059ddca97a64aa00", "committedDate": "2020-06-17T13:15:34Z", "message": "fixing style issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9564d5e45aecb04cbd4d33c135b79eb06d75ad62", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/9564d5e45aecb04cbd4d33c135b79eb06d75ad62", "committedDate": "2020-06-17T16:31:55Z", "message": "fixing style issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12ef88abf5782b3f1ad9fb3e837531b9a40007a4", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/12ef88abf5782b3f1ad9fb3e837531b9a40007a4", "committedDate": "2020-06-17T16:38:44Z", "message": "fixing style issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1b3145f99e08aee85f43540b721f5a530c55bbb", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/a1b3145f99e08aee85f43540b721f5a530c55bbb", "committedDate": "2020-06-17T16:50:46Z", "message": "fixing style issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7000d0e5af02b20f13c0bb477de967961902bb1a", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/7000d0e5af02b20f13c0bb477de967961902bb1a", "committedDate": "2020-06-17T16:55:50Z", "message": "fixing style issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNjkwOTE2", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-432690916", "createdAt": "2020-06-17T19:01:07Z", "commit": {"oid": "7000d0e5af02b20f13c0bb477de967961902bb1a"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNDc3MzI1", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-433477325", "createdAt": "2020-06-18T16:59:43Z", "commit": {"oid": "7000d0e5af02b20f13c0bb477de967961902bb1a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNjo1OTo0M1rOGl4RJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQxNjo1OTo0M1rOGl4RJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjM3MjM4OQ==", "bodyText": "Ah! I missed to add the comment! Please add this keyword here: this.isEdgeWithSyntheticBoundaryNode", "url": "https://github.com/osmlab/atlas-checks/pull/317#discussion_r442372389", "createdAt": "2020-06-18T16:59:43Z", "author": {"login": "sayas01"}, "path": "src/main/java/org/openstreetmap/atlas/checks/validation/linear/edges/MalformedRoundaboutCheck.java", "diffHunk": "@@ -87,6 +91,14 @@ public boolean validCheckForObject(final AtlasObject object)\n     protected Optional<CheckFlag> flag(final AtlasObject object)\n     {\n         final Set<String> instructions = new HashSet<>();\n+\n+        // Skip if roundabout contains synthetic node. bug fix:\n+        // https://github.com/osmlab/atlas-checks/issues/316\n+        if (isEdgeWithSyntheticBoundaryNode(object))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7000d0e5af02b20f13c0bb477de967961902bb1a"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0630fe5f086dad16cf6948aa18ee66ca67c7a77e", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/0630fe5f086dad16cf6948aa18ee66ca67c7a77e", "committedDate": "2020-06-18T17:05:35Z", "message": "fixing code review comments."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNDgzMDMx", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-433483031", "createdAt": "2020-06-18T17:07:14Z", "commit": {"oid": "0630fe5f086dad16cf6948aa18ee66ca67c7a77e"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNjUyNzM5", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-433652739", "createdAt": "2020-06-18T21:15:22Z", "commit": {"oid": "0630fe5f086dad16cf6948aa18ee66ca67c7a77e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMToxNToyM1rOGmAePQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOFQyMToxNToyM1rOGmAePQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjUwNjgxMw==", "bodyText": "This is not needed, unless sonar is throwing a fit. The object has already been verified to be an Edge in validCheckForObject.", "url": "https://github.com/osmlab/atlas-checks/pull/317#discussion_r442506813", "createdAt": "2020-06-18T21:15:23Z", "author": {"login": "Bentleysb"}, "path": "src/main/java/org/openstreetmap/atlas/checks/validation/linear/edges/MalformedRoundaboutCheck.java", "diffHunk": "@@ -163,6 +175,21 @@ private boolean intersectsWithEnclosedGeometry(final Polygon polygon, final Edge\n                         || polygon.fullyGeometricallyEncloses(polyline));\n     }\n \n+    /**\n+     * Checks if {@link AtlasObject} contains synthetic boundary Node\n+     * \n+     * @param object\n+     * @return true if roundabout contains synthetic boundary Node.\n+     */\n+    private boolean isEdgeWithSyntheticBoundaryNode(final AtlasObject object)\n+    {\n+        return object instanceof Edge", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0630fe5f086dad16cf6948aa18ee66ca67c7a77e"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNjUzMzUx", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-433653351", "createdAt": "2020-06-18T21:16:27Z", "commit": {"oid": "0630fe5f086dad16cf6948aa18ee66ca67c7a77e"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06e0c6d5aea34bebe7ecba641aeced9a29eba04c", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/06e0c6d5aea34bebe7ecba641aeced9a29eba04c", "committedDate": "2020-06-18T21:22:10Z", "message": "remove object verification."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84a8c2b8c6ed183af70400621871e834132d880d", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/84a8c2b8c6ed183af70400621871e834132d880d", "committedDate": "2020-06-18T21:23:05Z", "message": "remove object verification."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNjcxNjg1", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-433671685", "createdAt": "2020-06-18T21:49:57Z", "commit": {"oid": "84a8c2b8c6ed183af70400621871e834132d880d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzODExMTUy", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-433811152", "createdAt": "2020-06-19T05:29:27Z", "commit": {"oid": "84a8c2b8c6ed183af70400621871e834132d880d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2OTc4MzEx", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-436978311", "createdAt": "2020-06-24T20:22:27Z", "commit": {"oid": "84a8c2b8c6ed183af70400621871e834132d880d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMDoyMjoyN1rOGohwpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMDoyMjoyN1rOGohwpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTE0OTM1MQ==", "bodyText": "nit: could markAsFlagged() the object and the other edges picked up here to avoid reprocessing them", "url": "https://github.com/osmlab/atlas-checks/pull/317#discussion_r445149351", "createdAt": "2020-06-24T20:22:27Z", "author": {"login": "seancoulter"}, "path": "src/main/java/org/openstreetmap/atlas/checks/validation/linear/edges/MalformedRoundaboutCheck.java", "diffHunk": "@@ -87,6 +91,14 @@ public boolean validCheckForObject(final AtlasObject object)\n     protected Optional<CheckFlag> flag(final AtlasObject object)\n     {\n         final Set<String> instructions = new HashSet<>();\n+\n+        // Skip if roundabout contains synthetic node. bug fix:\n+        // https://github.com/osmlab/atlas-checks/issues/316\n+        if (this.isEdgeWithSyntheticBoundaryNode(object))\n+        {\n+            return Optional.empty();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84a8c2b8c6ed183af70400621871e834132d880d"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2OTgwNDA3", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-436980407", "createdAt": "2020-06-24T20:25:32Z", "commit": {"oid": "84a8c2b8c6ed183af70400621871e834132d880d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMDoyNTozM1rOGoh28Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQyMDoyNTozM1rOGoh28Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTE1MDk2MQ==", "bodyText": "Should we use the same constraints as validCheckForObject here? In that method we check !isExcludedHighway instead of HighwayTag.isCarNavigableHighway()", "url": "https://github.com/osmlab/atlas-checks/pull/317#discussion_r445150961", "createdAt": "2020-06-24T20:25:33Z", "author": {"login": "seancoulter"}, "path": "src/main/java/org/openstreetmap/atlas/checks/validation/linear/edges/MalformedRoundaboutCheck.java", "diffHunk": "@@ -176,6 +201,19 @@ private boolean isExcludedHighway(final AtlasObject object)\n                 HighwayTag.PEDESTRIAN, HighwayTag.FOOTWAY);\n     }\n \n+    /**\n+     * Function for {@link SimpleEdgeWalker} that gathers connected edges that are part of a\n+     * roundabout.\n+     *\n+     * @return {@link Function} for {@link SimpleEdgeWalker}\n+     */\n+    private Function<Edge, Stream<Edge>> isRoundaboutEdge()\n+    {\n+        return edge -> edge.connectedEdges().stream()\n+                .filter(connected -> JunctionTag.isRoundabout(connected)\n+                        && HighwayTag.isCarNavigableHighway(connected));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "84a8c2b8c6ed183af70400621871e834132d880d"}, "originalPosition": 73}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60ce742d3926ea6b993033927e1e5826b8a7a75f", "author": {"user": {"login": "vladlemberg", "name": "Vladimir Lemberg"}}, "url": "https://github.com/osmlab/atlas-checks/commit/60ce742d3926ea6b993033927e1e5826b8a7a75f", "committedDate": "2020-06-24T22:28:07Z", "message": "added code review suggestions."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MDUzMzkx", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-437053391", "createdAt": "2020-06-24T22:37:13Z", "commit": {"oid": "60ce742d3926ea6b993033927e1e5826b8a7a75f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MDU0NTY1", "url": "https://github.com/osmlab/atlas-checks/pull/317#pullrequestreview-437054565", "createdAt": "2020-06-24T22:40:14Z", "commit": {"oid": "60ce742d3926ea6b993033927e1e5826b8a7a75f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3359, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}