{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MjgzMDc0", "number": 285, "title": "OceanBleedingCheck update - coastlines and ferries", "bodyText": "Description:\nThis is a 2 part enhancement to OceanBleedingCheck:\n-- Flag features that intersect natural=coastline LineItems\n--Do not flag streets that end at (intersect) ocean boundaries where the node at the location of intersection is tagged with amenity=ferry_terminal.\nTo accomplish the first part of the enhancement, a new configurable ocean.boundary was added which can be used to represent  tags found on ocean/land boundaries. This caused a change to the check's understanding of an ocean feature. Some changes had to be made to account for the separation of the definition of an ocean feature. Below are current definitions for an ocean feature and their flaggable scenarios.\n-- A closed area which fully contains water, defined by water tagging. Flaggable items are found within or intersecting the feature.\n-- A closed area which fully contains land (where the boundary is tagged natural=coastline). Flaggable items are found intersecting the feature.\n-- A Line of land, defined by natural=coastline. Flaggable items are found intersecting the feature.\n-- A Line of water, defined by water tagging. Flaggable items are found intersecting the feature.\nTo accomplish the second part of the enhancement, a check was added to make sure that if a LineItem ends at an ocean feature boundary, that point of intersection must be marked by an amenity=ferry_terminal tag.\nNote: there's also a change to IntersectionUtilities.haveExplicitLocationsForIntersections so that it now takes in a PolyLine instead of Polygon. Polyline is Polygon's superclass, and outside of this check it's used by LineCrossingWaterbody and LineCrossingBuilding, which both give Polygons as args, so no refactoring required there.\nPotential Impact:\nNew configurable ocean.boundary, which should be used to define tags for ocean boundary line features that when crossed by streets/railways/buildings, should be flagged.\nShould have an increase in flags due to introducing natural=coastline as a flaggable scenario. Should have a slight reduction of flag count because we no longer flag streets that end with amenity=ferry_terminal at ocean boundaries. Net increase expected.\nUnit Test Approach:\nNew unit tests\nTest Results:\nPassing", "createdAt": "2020-04-20T20:25:13Z", "url": "https://github.com/osmlab/atlas-checks/pull/285", "merged": true, "mergeCommit": {"oid": "b7e88b26e6a494d946932295bfc16b35691950ad"}, "closed": true, "closedAt": "2020-05-13T21:56:49Z", "author": {"login": "seancoulter"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXqkphgH2gAyNDA2MjgzMDc0OmM5NmJhMjZlZGViZjVmMzlmOWUyYjRjZjExZjkzM2MxMGRkZjM5ZDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcg-wdNAFqTQxMTI2ODMyMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c96ba26edebf5f39f9e2b4cf11f933c10ddf39d9", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/c96ba26edebf5f39f9e2b4cf11f933c10ddf39d9", "committedDate": "2020-04-14T21:42:23Z", "message": "OceanBleeding - flag intersections w natural=coastline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48823968c0f034800770475105ab80cc91b84b45", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/48823968c0f034800770475105ab80cc91b84b45", "committedDate": "2020-04-20T20:18:55Z", "message": "spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "faa52ce51b870892980566bb0de2b546af4a718f", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/faa52ce51b870892980566bb0de2b546af4a718f", "committedDate": "2020-04-20T20:19:49Z", "message": "Merge https://github.com/osmlab/atlas-checks into oceanBleedingUpdate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzNzI2NjA4", "url": "https://github.com/osmlab/atlas-checks/pull/285#pullrequestreview-403726608", "createdAt": "2020-04-30T17:24:03Z", "commit": {"oid": "faa52ce51b870892980566bb0de2b546af4a718f"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "379247b6a64b01b85ed30755ac81ea7dbe1b8f24", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/379247b6a64b01b85ed30755ac81ea7dbe1b8f24", "committedDate": "2020-04-30T17:24:08Z", "message": "Merge branch 'dev' into oceanBleedingUpdate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87741342eff02dd2920a7352ec8430c32e811cb6", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/87741342eff02dd2920a7352ec8430c32e811cb6", "committedDate": "2020-05-07T20:18:17Z", "message": "saving some work"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0984d13bd89de36286a0ae459b17d3f35cab15cb", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/0984d13bd89de36286a0ae459b17d3f35cab15cb", "committedDate": "2020-05-07T20:18:24Z", "message": "Merge branch 'oceanBleedingUpdate' of https://github.com/seancoulter/atlas-checks into oceanBleedingUpdate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eab1de1be0dac29124b33f1d60d199436840264a", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/eab1de1be0dac29124b33f1d60d199436840264a", "committedDate": "2020-05-07T21:54:31Z", "message": "fix intersecting/within"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "feb67b7fa2935f08332ec8ea714e26f205373f4c", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/feb67b7fa2935f08332ec8ea714e26f205373f4c", "committedDate": "2020-05-07T23:16:08Z", "message": "spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a38fb25eb99218ce7cd6aad2bfb1c0cade51b445", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/a38fb25eb99218ce7cd6aad2bfb1c0cade51b445", "committedDate": "2020-05-09T00:50:54Z", "message": "equalsIgnoreCase tag; flag nonexplicit intersections"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d62137a5716ebd2f90256b3cd3ddcc474b77d92d", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/d62137a5716ebd2f90256b3cd3ddcc474b77d92d", "committedDate": "2020-05-10T01:43:39Z", "message": "unit tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "500b0e7408e2f1fc1c356778d367490debfd89e5", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/500b0e7408e2f1fc1c356778d367490debfd89e5", "committedDate": "2020-05-10T01:59:16Z", "message": "reduce cognitive complexity"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMzk2NTAz", "url": "https://github.com/osmlab/atlas-checks/pull/285#pullrequestreview-410396503", "createdAt": "2020-05-12T20:27:52Z", "commit": {"oid": "500b0e7408e2f1fc1c356778d367490debfd89e5"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDoyNzo1MlrOGUXtIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDoyNzo1MlrOGUXtIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAxMzA4OA==", "bodyText": "nit: areaCrossed -> lineCrossed", "url": "https://github.com/osmlab/atlas-checks/pull/285#discussion_r424013088", "createdAt": "2020-05-12T20:27:52Z", "author": {"login": "Bentleysb"}, "path": "src/main/java/org/openstreetmap/atlas/checks/utility/IntersectionUtilities.java", "diffHunk": "@@ -73,17 +73,17 @@ public static double findIntersectionPercentage(final Polygon polygon,\n     }\n \n     /**\n-     * Verifies intersections of given {@link Polygon} and {@link LineItem} are explicit\n+     * Verifies intersections of given {@link PolyLine} and {@link LineItem} are explicit\n      * {@link Location}s for both items\n      *\n      * @param areaCrossed\n-     *            {@link Polygon} being crossed\n+     *            {@link PolyLine} being crossed\n      * @param crossingItem\n      *            {@link LineItem} crossing\n-     * @return whether given {@link Polygon} and {@link LineItem}'s intersections are actual\n+     * @return whether given {@link PolyLine} and {@link LineItem}'s intersections are actual\n      *         {@link Location}s for both items\n      */\n-    public static boolean haveExplicitLocationsForIntersections(final Polygon areaCrossed,\n+    public static boolean haveExplicitLocationsForIntersections(final PolyLine areaCrossed,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "500b0e7408e2f1fc1c356778d367490debfd89e5"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NjY4MDM2", "url": "https://github.com/osmlab/atlas-checks/pull/285#pullrequestreview-409668036", "createdAt": "2020-05-12T03:08:28Z", "commit": {"oid": "500b0e7408e2f1fc1c356778d367490debfd89e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwMzowODoyOFrOGT0djQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwMzowODoyOFrOGT0djQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQzNTY2MQ==", "bodyText": "Will this break any other usage of this?", "url": "https://github.com/osmlab/atlas-checks/pull/285#discussion_r423435661", "createdAt": "2020-05-12T03:08:28Z", "author": {"login": "danielduhh"}, "path": "src/main/java/org/openstreetmap/atlas/checks/utility/IntersectionUtilities.java", "diffHunk": "@@ -73,17 +73,17 @@ public static double findIntersectionPercentage(final Polygon polygon,\n     }\n \n     /**\n-     * Verifies intersections of given {@link Polygon} and {@link LineItem} are explicit\n+     * Verifies intersections of given {@link PolyLine} and {@link LineItem} are explicit\n      * {@link Location}s for both items\n      *\n      * @param areaCrossed\n-     *            {@link Polygon} being crossed\n+     *            {@link PolyLine} being crossed\n      * @param crossingItem\n      *            {@link LineItem} crossing\n-     * @return whether given {@link Polygon} and {@link LineItem}'s intersections are actual\n+     * @return whether given {@link PolyLine} and {@link LineItem}'s intersections are actual\n      *         {@link Location}s for both items\n      */\n-    public static boolean haveExplicitLocationsForIntersections(final Polygon areaCrossed,\n+    public static boolean haveExplicitLocationsForIntersections(final PolyLine areaCrossed,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "500b0e7408e2f1fc1c356778d367490debfd89e5"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f3ea82ad6560cb0bdf54cbae9dc7bfa08717456", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/2f3ea82ad6560cb0bdf54cbae9dc7bfa08717456", "committedDate": "2020-05-13T15:17:58Z", "message": "Merge branch 'dev' into oceanBleedingUpdate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f61a30bee09c7816adacb3b222eee7425de65ed8", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/f61a30bee09c7816adacb3b222eee7425de65ed8", "committedDate": "2020-05-13T18:56:49Z", "message": "nit and docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "773346d478b1d56400f581d9f71d4c9870eb0fd4", "author": {"user": null}, "url": "https://github.com/osmlab/atlas-checks/commit/773346d478b1d56400f581d9f71d4c9870eb0fd4", "committedDate": "2020-05-13T18:56:57Z", "message": "Merge branch 'oceanBleedingUpdate' of https://github.com/seancoulter/atlas-checks into oceanBleedingUpdate"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMjQxMzE4", "url": "https://github.com/osmlab/atlas-checks/pull/285#pullrequestreview-411241318", "createdAt": "2020-05-13T19:39:35Z", "commit": {"oid": "773346d478b1d56400f581d9f71d4c9870eb0fd4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxOTozOTozNVrOGVAwPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxOTozOTozNVrOGVAwPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY4NTYyOA==", "bodyText": "Is it possible to concatenate the ids into a single \"Way\" instruction? Same for \"Building\".\nThat way we can avoid instructions like:\nOcean feature 693833861 has invalid intersections.Way 781473903 intersects the ocean feature.Way 781473903 intersects the ocean feature.Way 781473903 intersects the ocean feature.Way 781473903 intersects the ocean feature.Way 373430804 intersects the ocean feature.Way 373430804 intersects the ocean feature.Way 373430800 intersects the ocean feature.Way 373430800 intersects the ocean feature.", "url": "https://github.com/osmlab/atlas-checks/pull/285#discussion_r424685628", "createdAt": "2020-05-13T19:39:35Z", "author": {"login": "danielduhh"}, "path": "src/main/java/org/openstreetmap/atlas/checks/validation/intersections/OceanBleedingCheck.java", "diffHunk": "@@ -37,15 +45,17 @@\n             + \"|wetland->bog,fen,mangrove,marsh,saltern,saltmarsh,string_bog,swamp,wet_meadow\"\n             + \"|landuse->*\";\n     private final TaggableFilter invalidOceanTags;\n+    private static final String DEFAULT_OCEAN_BOUNDARY_TAGS = \"natural->coastline\";\n+    private final TaggableFilter oceanBoundaryTags;\n     private static final String DEFAULT_OFFENDING_MISCELLANEOUS_LINEITEMS = \"railway->rail,narrow_gauge,preserved,subway,disused,monorail,tram,light_rail,funicular,construction,miniature\";\n     private final TaggableFilter defaultOffendingLineitems;\n     private static final String DEFAULT_HIGHWAY_MINIMUM = \"TOLL_GANTRY\";\n     private final HighwayTag highwayMinimum;\n     private static final List<String> DEFAULT_HIGHWAYS_EXCLUDE = Collections.emptyList();\n     private final List<HighwayTag> highwaysExclude;\n-    private static final String OCEAN_INSTRUCTION = \"Ocean feature {0,number,#} has invalid intersections.\";\n-    private static final String BLEEDING_BUILDING_INSTRUCTION = \"Building {0,number,#} intersects the ocean feature.\";\n-    private static final String BLEEDING_LINEITEM_INSTRUCTION = \"Way {0,number,#} intersects the ocean feature.\";\n+    private static final String OCEAN_INSTRUCTION = \"Ocean feature {0,number,#} has invalid intersections. \";\n+    private static final String BLEEDING_BUILDING_INSTRUCTION = \"Building {0,number,#} intersects the ocean feature. \";\n+    private static final String BLEEDING_LINEITEM_INSTRUCTION = \"Way {0,number,#} intersects the ocean feature. \";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "773346d478b1d56400f581d9f71d4c9870eb0fd4"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMjQxMzc4", "url": "https://github.com/osmlab/atlas-checks/pull/285#pullrequestreview-411241378", "createdAt": "2020-05-13T19:39:40Z", "commit": {"oid": "773346d478b1d56400f581d9f71d4c9870eb0fd4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExMjY4MzIy", "url": "https://github.com/osmlab/atlas-checks/pull/285#pullrequestreview-411268322", "createdAt": "2020-05-13T20:18:42Z", "commit": {"oid": "773346d478b1d56400f581d9f71d4c9870eb0fd4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3312, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}