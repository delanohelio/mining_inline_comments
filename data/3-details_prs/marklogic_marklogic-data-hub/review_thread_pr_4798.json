{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyNjg5MDg5", "number": 4798, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxNjo1MFrOEz9xtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxODo0M1rOEz9zcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyOTI0OTgzOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/mapping-card.module.scss", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxNjo1MFrOHrgt0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxNjo1MFrOHrgt0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM4NjgzNA==", "bodyText": "Can we fix the CSS code styling here so we have a space between the selector and the curly brace, e.g.: .stepLink {", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4798#discussion_r515386834", "createdAt": "2020-10-30T21:16:50Z", "author": {"login": "wooldridge"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/mapping-card.module.scss", "diffHunk": "@@ -114,3 +119,16 @@\n     margin-top: 7px;\n     margin-bottom: 10px;\n }\n+\n+.stepLink{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac964bb1465df761406a4a1c13aba153c4cb8588"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyOTI1MjQzOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/mapping-card.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxNzo1MVrOHrgvXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxNzo1MVrOHrgvXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM4NzIyOQ==", "bodyText": "Can we fix the code styling here so we have a space after the if and before the curly brace, e.g.: if (addRun) {", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4798#discussion_r515387229", "createdAt": "2020-10-30T21:17:51Z", "author": {"login": "wooldridge"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/mapping-card.tsx", "diffHunk": "@@ -602,17 +612,63 @@ const MappingCard: React.FC<Props> = (props) => {\n     const onAddOk = async (lName, fName) => {\n         await props.addStepToFlow(lName, fName, 'mapping')\n         setAddDialogVisible(false);\n-\n-        history.push({\n-            pathname: '/tiles/run/add',\n-            state: {\n-                flowName: fName,\n-                flowsDefaultKey: [props.flows.findIndex(el => el.name === fName)],\n-                existingFlow: true\n-            }\n-        })\n+        \n+        if(addRun){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac964bb1465df761406a4a1c13aba153c4cb8588"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyOTI1MzUxOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/flows/flows.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxODoyNVrOHrgv_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxODoyNVrOHrgv_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM4NzM5MA==", "bodyText": "Add spaces, see above comment?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4798#discussion_r515387390", "createdAt": "2020-10-30T21:18:25Z", "author": {"login": "wooldridge"}, "path": "marklogic-data-hub-central/ui/src/components/flows/flows.tsx", "diffHunk": "@@ -73,18 +74,50 @@ const Flows: React.FC<Props> = (props) => {\n     const [openNewFlow, setOpenNewFlow] = useState(props.newStepToFlowOptions?.addingStepToFlow && !props.newStepToFlowOptions?.existingFlow);\n     const [activeKeys, setActiveKeys] = useState(JSON.stringify(props.newStepToFlowOptions?.flowsDefaultKey) !== JSON.stringify([\"-1\"]) ? props.newStepToFlowOptions?.flowsDefaultKey : ['-1']);\n     const [showLinks, setShowLinks] = useState('');\n+    const [startRun, setStartRun] = useState(false);\n     const [latestJobData, setLatestJobData] = useState<any>({});\n     const [createAdd, setCreateAdd] = useState(true);\n \n \n     useEffect(() => {\n-        if (JSON.stringify(props.flowsDefaultActiveKey) !== JSON.stringify([])) {\n+        if (JSON.stringify(props.flowsDefaultActiveKey) !== JSON.stringify([]) && props.flowsDefaultActiveKey.length >= activeKeys.length) {\n             setActiveKeys([...props.flowsDefaultActiveKey]);\n         }\n         // Get the latest job info when a step is added to an existing flow from Curate or Load Tile\n         if(JSON.stringify(props.flows) !== JSON.stringify([])){\n-            if(props.newStepToFlowOptions && props.newStepToFlowOptions.flowsDefaultKey && props.newStepToFlowOptions.flowsDefaultKey != -1){\n+            if(props.newStepToFlowOptions && props.newStepToFlowOptions.addingStepToFlow && props.newStepToFlowOptions.flowsDefaultKey && props.newStepToFlowOptions.flowsDefaultKey != -1){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac964bb1465df761406a4a1c13aba153c4cb8588"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyOTI1NDI3OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/flows/flows.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxODo0M1rOHrgwdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMToxODo0M1rOHrgwdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTM4NzUwOA==", "bodyText": "Add spaces?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4798#discussion_r515387508", "createdAt": "2020-10-30T21:18:43Z", "author": {"login": "wooldridge"}, "path": "marklogic-data-hub-central/ui/src/components/flows/flows.tsx", "diffHunk": "@@ -73,18 +74,50 @@ const Flows: React.FC<Props> = (props) => {\n     const [openNewFlow, setOpenNewFlow] = useState(props.newStepToFlowOptions?.addingStepToFlow && !props.newStepToFlowOptions?.existingFlow);\n     const [activeKeys, setActiveKeys] = useState(JSON.stringify(props.newStepToFlowOptions?.flowsDefaultKey) !== JSON.stringify([\"-1\"]) ? props.newStepToFlowOptions?.flowsDefaultKey : ['-1']);\n     const [showLinks, setShowLinks] = useState('');\n+    const [startRun, setStartRun] = useState(false);\n     const [latestJobData, setLatestJobData] = useState<any>({});\n     const [createAdd, setCreateAdd] = useState(true);\n \n \n     useEffect(() => {\n-        if (JSON.stringify(props.flowsDefaultActiveKey) !== JSON.stringify([])) {\n+        if (JSON.stringify(props.flowsDefaultActiveKey) !== JSON.stringify([]) && props.flowsDefaultActiveKey.length >= activeKeys.length) {\n             setActiveKeys([...props.flowsDefaultActiveKey]);\n         }\n         // Get the latest job info when a step is added to an existing flow from Curate or Load Tile\n         if(JSON.stringify(props.flows) !== JSON.stringify([])){\n-            if(props.newStepToFlowOptions && props.newStepToFlowOptions.flowsDefaultKey && props.newStepToFlowOptions.flowsDefaultKey != -1){\n+            if(props.newStepToFlowOptions && props.newStepToFlowOptions.addingStepToFlow && props.newStepToFlowOptions.flowsDefaultKey && props.newStepToFlowOptions.flowsDefaultKey != -1){\n                 getFlowWithJobInfo(props.newStepToFlowOptions.flowsDefaultKey);\n+                if(startRun && props.newStepToFlowOptions.existingFlow){\n+                        //run step after step is added to an existing flow\n+                        if(props.newStepToFlowOptions.stepDefinitionType === 'ingestion'){\n+                            setShowUploadError(false);\n+                            setRunningStep(props.flows[props.newStepToFlowOptions.flowsDefaultKey].steps[props.flows[props.newStepToFlowOptions.flowsDefaultKey].steps.length - 1]);\n+                            setRunningFlow(props.newStepToFlowOptions?.flowName);\n+                            openFilePicker();\n+                            setStartRun(false);\n+                        }else{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac964bb1465df761406a4a1c13aba153c4cb8588"}, "originalPosition": 35}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3206, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}