{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0Mjc0OTY5", "number": 3920, "title": "DHFPROD-4888: Add entity type title as collection to mapped documents", "bodyText": "Description\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-05-06T18:57:27Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3920", "merged": true, "mergeCommit": {"oid": "4f9c5536a793a57e616ea54597bb247a3e49b9c3"}, "closed": true, "closedAt": "2020-05-08T21:18:56Z", "author": {"login": "ryanjdew"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcetkgogFqTQwNjkwODUzOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfG63sAFqTQwNzkyNjkzMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2OTA4NTM5", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3920#pullrequestreview-406908539", "createdAt": "2020-05-06T19:09:17Z", "commit": {"oid": "8b798f1a0621e256fa8e771ed5c845c7cafe8f55"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxOTowOToxN1rOGRhfOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxOTowOToxN1rOGRhfOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTAyNzY0MA==", "bodyText": "Thoughts on parsing this out instead of doing a query? I'm just thinking that for mapping 1 million docs, this means 1 million additional triple lookups.\nI've also tried to start a naming convention in entity-lib.sjs where \"find\" indicates that a function will do a query, and \"get\" indicates that a function will not do a query. I've found this to be helpful on previous projects, though of course this is just one of dozens of DH libraries. But I do think it's a helpful way so readers can quickly detect where queries occur when analyzing code for performance.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3920#discussion_r421027640", "createdAt": "2020-05-06T19:09:17Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/impl/hub-es.sjs", "diffHunk": "@@ -121,8 +121,23 @@ function getRefEntityIdentifiers(entityIRI, entityInfo, prop) {\n   return refEntityId;\n }\n \n+function getEntityServiceTitle(iri) {\n+  if (!(iri instanceof sem.iri)) {\n+    iri = sem.iri(iri);\n+  }\n+  const triple = fn.head(cts.triples(iri,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b798f1a0621e256fa8e771ed5c845c7cafe8f55"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8b798f1a0621e256fa8e771ed5c845c7cafe8f55", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/8b798f1a0621e256fa8e771ed5c845c7cafe8f55", "committedDate": "2020-05-06T18:56:50Z", "message": "DHFPROD-4888: Add entity type title as collection to mapped documents"}, "afterCommit": {"oid": "ae4fa171b79a3a05e5f024a9a0e25c408bf0d7f4", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/ae4fa171b79a3a05e5f024a9a0e25c408bf0d7f4", "committedDate": "2020-05-06T21:39:01Z", "message": "DHFPROD-4888: Add entity type title as collection to mapped documents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MTk3MDUx", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3920#pullrequestreview-407197051", "createdAt": "2020-05-07T07:01:12Z", "commit": {"oid": "ae4fa171b79a3a05e5f024a9a0e25c408bf0d7f4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNzowMToxMlrOGRw-pQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwNzowMToxMlrOGRw-pQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTI4MTQ0NQ==", "bodyText": "Shouldnt the default collection be both entityType title and stepName to be consistent with pre 5.3?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3920#discussion_r421281445", "createdAt": "2020-05-07T07:01:12Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/src/test/java/com/marklogic/hub/central/controllers/MappingControllerTest.java", "diffHunk": "@@ -166,7 +166,7 @@ public void testMappingSettings() {\n         // Check for defaults\n         assertEquals(\"TestCustomerMapping\", result.get(\"artifactName\").asText());\n         assertEquals(1, result.get(\"collections\").size());\n-        assertEquals(\"default-mapping\", result.get(\"collections\").get(0).asText());\n+        assertEquals(\"Customer\", result.get(\"collections\").get(0).asText());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ae4fa171b79a3a05e5f024a9a0e25c408bf0d7f4"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae4fa171b79a3a05e5f024a9a0e25c408bf0d7f4", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/ae4fa171b79a3a05e5f024a9a0e25c408bf0d7f4", "committedDate": "2020-05-06T21:39:01Z", "message": "DHFPROD-4888: Add entity type title as collection to mapped documents"}, "afterCommit": {"oid": "7cf3d62611327087a26a4fd163590650d6409556", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/7cf3d62611327087a26a4fd163590650d6409556", "committedDate": "2020-05-07T16:47:41Z", "message": "DHFPROD-4888: Add entity type title as collection to mapped documents"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f181af14eba600b3af8ea54dde171676784545d", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/0f181af14eba600b3af8ea54dde171676784545d", "committedDate": "2020-05-07T21:11:55Z", "message": "DHFPROD-4888: Add entity type title as collection to mapped documents"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7cf3d62611327087a26a4fd163590650d6409556", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/7cf3d62611327087a26a4fd163590650d6409556", "committedDate": "2020-05-07T16:47:41Z", "message": "DHFPROD-4888: Add entity type title as collection to mapped documents"}, "afterCommit": {"oid": "0f181af14eba600b3af8ea54dde171676784545d", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/0f181af14eba600b3af8ea54dde171676784545d", "committedDate": "2020-05-07T21:11:55Z", "message": "DHFPROD-4888: Add entity type title as collection to mapped documents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3OTEzMzIw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3920#pullrequestreview-407913320", "createdAt": "2020-05-07T23:57:56Z", "commit": {"oid": "0f181af14eba600b3af8ea54dde171676784545d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3OTI2OTMz", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3920#pullrequestreview-407926933", "createdAt": "2020-05-08T00:41:28Z", "commit": {"oid": "0f181af14eba600b3af8ea54dde171676784545d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2864, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}