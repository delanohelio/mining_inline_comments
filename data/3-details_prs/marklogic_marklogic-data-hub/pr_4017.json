{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0NjM4NTM1", "number": 4017, "title": "DHFPROD-4452: Add editing capability for entity type description", "bodyText": "Description\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-05-28T17:46:52Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4017", "merged": true, "mergeCommit": {"oid": "9251f573856f9272957fbb6a89907543d7cb11c3"}, "closed": true, "closedAt": "2020-05-29T21:24:11Z", "author": {"login": "akshaysonvane"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclyiBvAFqTQyMDM5NzU1Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcmJGk6AFqTQyMTI4OTk5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMzk3NTUz", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4017#pullrequestreview-420397553", "createdAt": "2020-05-28T18:52:54Z", "commit": {"oid": "ea964753f9acca47c16d3a0cefa903269d089b7a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxODo1Mjo1NFrOGcCRLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxODo1Mjo1NFrOGcCRLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA1MDQ3OQ==", "bodyText": "I keep seeing this code repeated in the UI - couldn't this be in some sort of \"common\" library and reused, perhaps as a callback/promise so that if hasOwnProperty('message') is true, then the caller determines what to do, with the common function providing the value of error['response']['data']['message']?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4017#discussion_r432050479", "createdAt": "2020-05-28T18:52:54Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "diffHunk": "@@ -47,51 +57,74 @@ const EntityTypeModal: React.FC<Props> = (props) => {\n     if (event.target.id === 'description') {\n       setDescription(event.target.value);\n     }\n-  }\n+  };\n \n   const onOk = (event) => {\n     event.preventDefault();\n-    if (!NAME_REGEX.test(name)) {\n-      setErrorMessage(ModelingTooltips.addEntityName)\n+    if (props.isEditModal) {\n+      updateEntityDescription(name, description);\n     } else {\n-      createEntityType(name, description);\n+      if (!NAME_REGEX.test(name)) {\n+        setErrorMessage(ModelingTooltips.addEntityName)\n+      } else {\n+        createEntityType(name, description);\n+      }\n+    }\n+  };\n+\n+  const updateEntityDescription = async (name: string, description: string) => {\n+    try {\n+      const response = await updateModelInfo(name, description);\n+      if (response['status'] === 200) {\n+        props.updateEntityTypesAndHideModal();\n+      }\n+    } catch (error) {\n+      if (error.response.status === 400) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea964753f9acca47c16d3a0cefa903269d089b7a"}, "originalPosition": 81}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNTM1NTk4", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4017#pullrequestreview-420535598", "createdAt": "2020-05-28T22:26:53Z", "commit": {"oid": "ea964753f9acca47c16d3a0cefa903269d089b7a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMjoyNjo1NFrOGcI3AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMjozMjo1MVrOGcI_Fw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE1ODQ2NQ==", "bodyText": "I think this could work, but make the errorFunction conditional more generic to support more customization", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4017#discussion_r432158465", "createdAt": "2020-05-28T22:26:54Z", "author": {"login": "brucean52"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "diffHunk": "@@ -47,51 +57,74 @@ const EntityTypeModal: React.FC<Props> = (props) => {\n     if (event.target.id === 'description') {\n       setDescription(event.target.value);\n     }\n-  }\n+  };\n \n   const onOk = (event) => {\n     event.preventDefault();\n-    if (!NAME_REGEX.test(name)) {\n-      setErrorMessage(ModelingTooltips.addEntityName)\n+    if (props.isEditModal) {\n+      updateEntityDescription(name, description);\n     } else {\n-      createEntityType(name, description);\n+      if (!NAME_REGEX.test(name)) {\n+        setErrorMessage(ModelingTooltips.addEntityName)\n+      } else {\n+        createEntityType(name, description);\n+      }\n+    }\n+  };\n+\n+  const updateEntityDescription = async (name: string, description: string) => {\n+    try {\n+      const response = await updateModelInfo(name, description);\n+      if (response['status'] === 200) {\n+        props.updateEntityTypesAndHideModal();\n+      }\n+    } catch (error) {\n+      if (error.response.status === 400) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA1MDQ3OQ=="}, "originalCommit": {"oid": "ea964753f9acca47c16d3a0cefa903269d089b7a"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE1OTQwNw==", "bodyText": "Going by the wireframe, Edit is supposed to have the Entity Type name as text, not as a disabled input", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4017#discussion_r432159407", "createdAt": "2020-05-28T22:29:28Z", "author": {"login": "brucean52"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "diffHunk": "@@ -102,7 +135,7 @@ const EntityTypeModal: React.FC<Props> = (props) => {\n         <Form.Item\n           className={styles.formItem}\n           label={<span>\n-            Name:&nbsp;<span className={styles.asterisk}>*</span>\n+            Name:&nbsp;{props.isEditModal ? null : <span className={styles.asterisk}>*</span>}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea964753f9acca47c16d3a0cefa903269d089b7a"}, "originalPosition": 145}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE2MDUzNQ==", "bodyText": "Please add CSS to make this look similar to the instance link. ( color change, cursor: pointer )", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4017#discussion_r432160535", "createdAt": "2020-05-28T22:32:51Z", "author": {"login": "brucean52"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-table/entity-type-table.tsx", "diffHunk": "@@ -23,15 +24,24 @@ const EntityTypeTable: React.FC<Props> = (props) => {\n       title: 'Name',\n       dataIndex: 'name',\n       width: 400,\n-      // TODO - Edit Entity DHFPROD-4452\n       render: text => {\n+        let parseText = text.split(',');\n+        let entityName = parseText[0];\n+        let entityDescription = parseText[1];\n+\n         return (\n           <Tooltip title={ModelingTooltips.entityTypeName}>\n-            <span data-testid={text + '-span'}>{text}</span>\n+            <span data-testid={text + '-span'}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea964753f9acca47c16d3a0cefa903269d089b7a"}, "originalPosition": 31}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea964753f9acca47c16d3a0cefa903269d089b7a", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/ea964753f9acca47c16d3a0cefa903269d089b7a", "committedDate": "2020-05-28T16:22:39Z", "message": "DHFPROD-4452: Add editing capability for entity type description"}, "afterCommit": {"oid": "e8d869cc937370f183c2574b9e61293edd943442", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/e8d869cc937370f183c2574b9e61293edd943442", "committedDate": "2020-05-29T17:19:06Z", "message": "DHFPROD-4452: Add editing capability for entity type description"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66a106c21259f8686b11ba8c3079afb1c111e184", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/66a106c21259f8686b11ba8c3079afb1c111e184", "committedDate": "2020-05-29T17:41:13Z", "message": "DHFPROD-4452: Add editing capability for entity type description"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e8d869cc937370f183c2574b9e61293edd943442", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/e8d869cc937370f183c2574b9e61293edd943442", "committedDate": "2020-05-29T17:19:06Z", "message": "DHFPROD-4452: Add editing capability for entity type description"}, "afterCommit": {"oid": "66a106c21259f8686b11ba8c3079afb1c111e184", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/66a106c21259f8686b11ba8c3079afb1c111e184", "committedDate": "2020-05-29T17:41:13Z", "message": "DHFPROD-4452: Add editing capability for entity type description"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMjYzNDQ4", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4017#pullrequestreview-421263448", "createdAt": "2020-05-29T20:21:54Z", "commit": {"oid": "66a106c21259f8686b11ba8c3079afb1c111e184"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMjg5OTk1", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4017#pullrequestreview-421289995", "createdAt": "2020-05-29T21:11:32Z", "commit": {"oid": "66a106c21259f8686b11ba8c3079afb1c111e184"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2660, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}