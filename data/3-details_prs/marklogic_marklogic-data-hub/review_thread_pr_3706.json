{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5NTAwMDMw", "number": 3706, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzoyNToyNVrODoiMmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMjoxNTozM1rODosgkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzODI5OTEzOnYy", "diffSide": "RIGHT", "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzoyNToyNVrOF3JIeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMzo1ODoyNFrOF3JsAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2NTYyNg==", "bodyText": "Do we have test for this in place?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3706#discussion_r393365626", "createdAt": "2020-03-16T23:25:25Z", "author": {"login": "bsrikan"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "diffHunk": "@@ -182,18 +182,6 @@ public JsonNode getLatestJobInfo(String modelName) {\n     }\n \n     JsonNode getJobInfoFromDB(DatabaseClient dbClient, String modelName) {\n-        JsonNode node = null;\n-        try {\n-            node = JobInfo.on(dbClient).getLatestJobData(modelName);\n-        }\n-        catch (MarkLogicServerException e) {\n-            /*\n-             * As MarkLogic server throws a FailedRequestException for both data-service module not found\n-             * and if the user is unauthorized to access the module; we need to fail silently and log the\n-             * issue.\n-             */\n-            logger.error(e.getMessage());\n-        }\n-        return node;\n+        return JobInfo.on(dbClient).getLatestJobData(modelName);\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2245169212d6f17458e4242d07cff74d41f0cb57"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3NDYyMQ==", "bodyText": "Yes, the data service is tested via ml-unit-test", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3706#discussion_r393374621", "createdAt": "2020-03-16T23:57:53Z", "author": {"login": "akshaysonvane"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "diffHunk": "@@ -182,18 +182,6 @@ public JsonNode getLatestJobInfo(String modelName) {\n     }\n \n     JsonNode getJobInfoFromDB(DatabaseClient dbClient, String modelName) {\n-        JsonNode node = null;\n-        try {\n-            node = JobInfo.on(dbClient).getLatestJobData(modelName);\n-        }\n-        catch (MarkLogicServerException e) {\n-            /*\n-             * As MarkLogic server throws a FailedRequestException for both data-service module not found\n-             * and if the user is unauthorized to access the module; we need to fail silently and log the\n-             * issue.\n-             */\n-            logger.error(e.getMessage());\n-        }\n-        return node;\n+        return JobInfo.on(dbClient).getLatestJobData(modelName);\n     }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2NTYyNg=="}, "originalCommit": {"oid": "2245169212d6f17458e4242d07cff74d41f0cb57"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM3NDcyMg==", "bodyText": "This PR just removes the try/catch block surrounding the code.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3706#discussion_r393374722", "createdAt": "2020-03-16T23:58:24Z", "author": {"login": "akshaysonvane"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "diffHunk": "@@ -182,18 +182,6 @@ public JsonNode getLatestJobInfo(String modelName) {\n     }\n \n     JsonNode getJobInfoFromDB(DatabaseClient dbClient, String modelName) {\n-        JsonNode node = null;\n-        try {\n-            node = JobInfo.on(dbClient).getLatestJobData(modelName);\n-        }\n-        catch (MarkLogicServerException e) {\n-            /*\n-             * As MarkLogic server throws a FailedRequestException for both data-service module not found\n-             * and if the user is unauthorized to access the module; we need to fail silently and log the\n-             * issue.\n-             */\n-            logger.error(e.getMessage());\n-        }\n-        return node;\n+        return JobInfo.on(dbClient).getLatestJobData(modelName);\n     }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM2NTYyNg=="}, "originalCommit": {"oid": "2245169212d6f17458e4242d07cff74d41f0cb57"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzOTk4ODY1OnYy", "diffSide": "RIGHT", "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxMjoxNTozM1rOF3ZmhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxOTo0Mjo1M1rOF3rVhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYzNTQ2MQ==", "bodyText": "I think the client should just call JobInfo then - there's no point in having this additional layer to go through. If we did keep it, I think we'd want the method names to be the same - i.e. the Manager method should be getLatestJobData.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3706#discussion_r393635461", "createdAt": "2020-03-17T12:15:33Z", "author": {"login": "rjrudin"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "diffHunk": "@@ -182,18 +182,6 @@ public JsonNode getLatestJobInfo(String modelName) {\n     }\n \n     JsonNode getJobInfoFromDB(DatabaseClient dbClient, String modelName) {\n-        JsonNode node = null;\n-        try {\n-            node = JobInfo.on(dbClient).getLatestJobData(modelName);\n-        }\n-        catch (MarkLogicServerException e) {\n-            /*\n-             * As MarkLogic server throws a FailedRequestException for both data-service module not found\n-             * and if the user is unauthorized to access the module; we need to fail silently and log the\n-             * issue.\n-             */\n-            logger.error(e.getMessage());\n-        }\n-        return node;\n+        return JobInfo.on(dbClient).getLatestJobData(modelName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2245169212d6f17458e4242d07cff74d41f0cb57"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzgwNDQzOQ==", "bodyText": "The separate method is used for mocking the database call in the ModelManagerTest class\ndoReturn(expectedNode).when(modelManager).getJobInfoFromDB(dataServiceClient, modelName);\n\nI'll change the method name to getLatestJobData", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3706#discussion_r393804439", "createdAt": "2020-03-17T16:22:02Z", "author": {"login": "akshaysonvane"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "diffHunk": "@@ -182,18 +182,6 @@ public JsonNode getLatestJobInfo(String modelName) {\n     }\n \n     JsonNode getJobInfoFromDB(DatabaseClient dbClient, String modelName) {\n-        JsonNode node = null;\n-        try {\n-            node = JobInfo.on(dbClient).getLatestJobData(modelName);\n-        }\n-        catch (MarkLogicServerException e) {\n-            /*\n-             * As MarkLogic server throws a FailedRequestException for both data-service module not found\n-             * and if the user is unauthorized to access the module; we need to fail silently and log the\n-             * issue.\n-             */\n-            logger.error(e.getMessage());\n-        }\n-        return node;\n+        return JobInfo.on(dbClient).getLatestJobData(modelName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYzNTQ2MQ=="}, "originalCommit": {"oid": "2245169212d6f17458e4242d07cff74d41f0cb57"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzgzMDM4Mw==", "bodyText": "Can you mock ArtifactsService instead? That's supposed to be one of the benefits of data services - that there's an interface class that can be mocked for testing purposes.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3706#discussion_r393830383", "createdAt": "2020-03-17T16:59:28Z", "author": {"login": "rjrudin"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "diffHunk": "@@ -182,18 +182,6 @@ public JsonNode getLatestJobInfo(String modelName) {\n     }\n \n     JsonNode getJobInfoFromDB(DatabaseClient dbClient, String modelName) {\n-        JsonNode node = null;\n-        try {\n-            node = JobInfo.on(dbClient).getLatestJobData(modelName);\n-        }\n-        catch (MarkLogicServerException e) {\n-            /*\n-             * As MarkLogic server throws a FailedRequestException for both data-service module not found\n-             * and if the user is unauthorized to access the module; we need to fail silently and log the\n-             * issue.\n-             */\n-            logger.error(e.getMessage());\n-        }\n-        return node;\n+        return JobInfo.on(dbClient).getLatestJobData(modelName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYzNTQ2MQ=="}, "originalCommit": {"oid": "2245169212d6f17458e4242d07cff74d41f0cb57"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzg0MDMyMA==", "bodyText": "But - if it's easier to just mock a single thing - i.e. ModelManager - that's fine too.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3706#discussion_r393840320", "createdAt": "2020-03-17T17:14:59Z", "author": {"login": "rjrudin"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "diffHunk": "@@ -182,18 +182,6 @@ public JsonNode getLatestJobInfo(String modelName) {\n     }\n \n     JsonNode getJobInfoFromDB(DatabaseClient dbClient, String modelName) {\n-        JsonNode node = null;\n-        try {\n-            node = JobInfo.on(dbClient).getLatestJobData(modelName);\n-        }\n-        catch (MarkLogicServerException e) {\n-            /*\n-             * As MarkLogic server throws a FailedRequestException for both data-service module not found\n-             * and if the user is unauthorized to access the module; we need to fail silently and log the\n-             * issue.\n-             */\n-            logger.error(e.getMessage());\n-        }\n-        return node;\n+        return JobInfo.on(dbClient).getLatestJobData(modelName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYzNTQ2MQ=="}, "originalCommit": {"oid": "2245169212d6f17458e4242d07cff74d41f0cb57"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzkyNjAyMw==", "bodyText": "Can you mock ArtifactsService instead? That's supposed to be one of the benefits of data services - that there's an interface class that can be mocked for testing purposes.\n\nBy ArtifactsService I am guessing you mean the JobInfo interface that was generated by the data service.\nJobInfo has a static on method which we call as\nJobInfo.on(finalDataServiceClient).getLatestJobData(s)\n\nI believe mockito does not support mocking static stuff and would require us to use a testing framework like powermockito.\nHence, in this case, it's simpler to just mock the getLatestJobData  method of ModelManager.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3706#discussion_r393926023", "createdAt": "2020-03-17T19:42:53Z", "author": {"login": "akshaysonvane"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/managers/ModelManager.java", "diffHunk": "@@ -182,18 +182,6 @@ public JsonNode getLatestJobInfo(String modelName) {\n     }\n \n     JsonNode getJobInfoFromDB(DatabaseClient dbClient, String modelName) {\n-        JsonNode node = null;\n-        try {\n-            node = JobInfo.on(dbClient).getLatestJobData(modelName);\n-        }\n-        catch (MarkLogicServerException e) {\n-            /*\n-             * As MarkLogic server throws a FailedRequestException for both data-service module not found\n-             * and if the user is unauthorized to access the module; we need to fail silently and log the\n-             * issue.\n-             */\n-            logger.error(e.getMessage());\n-        }\n-        return node;\n+        return JobInfo.on(dbClient).getLatestJobData(modelName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzYzNTQ2MQ=="}, "originalCommit": {"oid": "2245169212d6f17458e4242d07cff74d41f0cb57"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3483, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}