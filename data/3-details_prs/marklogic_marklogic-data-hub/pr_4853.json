{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5NTYxMDY4", "number": 4853, "title": "DHFPROD-6234:Fix failing tests in 9.0-x server", "bodyText": "Description\nFix failing tests in 9.0-x server. This PR fixes 3 failing tests in https://jenkins.marklogic.com/blue/organizations/jenkins/Datahub_CI/detail/develop/1611/tests/.\ndeployExplorerOptionsWithoutContainerConstraint() \u2013 com.marklogic.hub.entity.EntityManagerTest test is failing in 9.0-x.\n@rjrudin, @akshaysonvane , @ryanjdew ,\nIt looks like we do not generate entity constraints in 9.0-x server.\nNot sure what should be done here, should the test be excluded in 9.0-x ?\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-11-12T01:57:11Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4853", "merged": true, "mergeCommit": {"oid": "61edd8491ad982537c1e040d0e9c951c9f950500"}, "closed": true, "closedAt": "2020-11-12T23:55:03Z", "author": {"login": "srinathgit"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbyeS2AFqTUyOTA3NTQyOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdb7cKYgFqTUyOTU5NTkyMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MDc1NDI5", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4853#pullrequestreview-529075429", "createdAt": "2020-11-12T13:17:15Z", "commit": {"oid": "89803d10d48adca0d40855f35e7790115c40b7a6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMzoxNzoxNVrOHx6URg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxMzoyMDo0NlrOHx6cDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjA5NzczNA==", "bodyText": "Let's change this to asserting that datahubCreatedBy exists and is not \"\". The tests can be run by different users. We don't care about the identity of the user, we just care that the metadata is set to something.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4853#discussion_r522097734", "createdAt": "2020-11-12T13:17:15Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/marklogic-data-hub-spark-connector/writeRecords/ingestionWithNullParams.sjs", "diffHunk": "@@ -33,6 +33,7 @@ const envelope = record.document.envelope;\n \n   //should add default metadata\n   test.assertExists(record.metadata.datahubCreatedOn),\n+  String(xdmp.version()).startsWith(\"9\") ? test.assertEqual(\"flow-developer\",record.metadata.datahubCreatedBy):", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89803d10d48adca0d40855f35e7790115c40b7a6"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjA5OTcyNw==", "bodyText": "It's not the role that's needed, it's the http://marklogic.com/data-hub/privileges/write-match-merge privilege, right? I think it's totally fine to add those privileges to flow-developer-role, I think that's the right fix here. flow-developer-role is already over-powered since it has the manage-admin role, there's no harm in giving it more DHF privileges.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4853#discussion_r522099727", "createdAt": "2020-11-12T13:20:46Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/java/com/marklogic/hub/scaffolding/CreateStepTest.java", "diffHunk": "@@ -52,8 +52,11 @@ void ingestionStep() throws IOException {\n         verifyArtifactsAreWrittenToDbAndProject(\"myIngest2\", \"ingestion\", null);\n     }\n \n+    // runAsDataHubDeveloper() runs as \"flow-developer-role\" in 9.0-x who doesn't have \"hub-central-match-merge-writer, so explicitly", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89803d10d48adca0d40855f35e7790115c40b7a6"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cecd16baf55b88ed56cbbecce4be775dd1341ce4", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/cecd16baf55b88ed56cbbecce4be775dd1341ce4", "committedDate": "2020-11-12T22:20:14Z", "message": "DHFPROD-6234:Fix failing tests in 9.0-x server"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "89803d10d48adca0d40855f35e7790115c40b7a6", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/89803d10d48adca0d40855f35e7790115c40b7a6", "committedDate": "2020-11-12T01:20:12Z", "message": "DHFPROD-6234:Fix failing tests in 9.0-x server"}, "afterCommit": {"oid": "cecd16baf55b88ed56cbbecce4be775dd1341ce4", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/cecd16baf55b88ed56cbbecce4be775dd1341ce4", "committedDate": "2020-11-12T22:20:14Z", "message": "DHFPROD-6234:Fix failing tests in 9.0-x server"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5NTg3MjQx", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4853#pullrequestreview-529587241", "createdAt": "2020-11-12T23:32:20Z", "commit": {"oid": "cecd16baf55b88ed56cbbecce4be775dd1341ce4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5NTkyNDEy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4853#pullrequestreview-529592412", "createdAt": "2020-11-12T23:41:14Z", "commit": {"oid": "cecd16baf55b88ed56cbbecce4be775dd1341ce4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5NTk1OTIy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4853#pullrequestreview-529595922", "createdAt": "2020-11-12T23:48:21Z", "commit": {"oid": "cecd16baf55b88ed56cbbecce4be775dd1341ce4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1652, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}