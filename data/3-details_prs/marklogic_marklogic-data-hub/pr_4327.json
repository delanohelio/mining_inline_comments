{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYwNTc1NDgx", "number": 4327, "title": "DHFPROD-5325:Add link from Hub Central to documentation site", "bodyText": "Description\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-07-31T22:33:33Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4327", "merged": true, "mergeCommit": {"oid": "fcc7ad7e63037f2ff25ed3492373ef9da177e1e7"}, "closed": true, "closedAt": "2020-08-04T01:50:02Z", "author": {"login": "briantang"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6cNCGABqjM2MTA2ODYxMjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7b4wxgFqTQ2MDQyNzgxOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2cf8e4b07ef4066c9612ddd3a3bc702e307d2a62", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/2cf8e4b07ef4066c9612ddd3a3bc702e307d2a62", "committedDate": "2020-07-31T22:26:04Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}, "afterCommit": {"oid": "776d3f8913b8ae384f10fe8ad7d0bb33683dbfbd", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/776d3f8913b8ae384f10fe8ad7d0bb33683dbfbd", "committedDate": "2020-07-31T22:45:05Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "776d3f8913b8ae384f10fe8ad7d0bb33683dbfbd", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/776d3f8913b8ae384f10fe8ad7d0bb33683dbfbd", "committedDate": "2020-07-31T22:45:05Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}, "afterCommit": {"oid": "b9151cb3b0eb380074415e9db5d28ff42fd0bbdc", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/b9151cb3b0eb380074415e9db5d28ff42fd0bbdc", "committedDate": "2020-08-03T05:17:47Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMTgyNTM5", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4327#pullrequestreview-460182539", "createdAt": "2020-08-03T16:49:32Z", "commit": {"oid": "b9151cb3b0eb380074415e9db5d28ff42fd0bbdc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b9151cb3b0eb380074415e9db5d28ff42fd0bbdc", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/b9151cb3b0eb380074415e9db5d28ff42fd0bbdc", "committedDate": "2020-08-03T05:17:47Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}, "afterCommit": {"oid": "4ebf8c37201f2b3fa196a5f239fc32fa425bc0cf", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/4ebf8c37201f2b3fa196a5f239fc32fa425bc0cf", "committedDate": "2020-08-03T20:11:37Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzE4MjQ5", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4327#pullrequestreview-460318249", "createdAt": "2020-08-03T20:27:16Z", "commit": {"oid": "4ebf8c37201f2b3fa196a5f239fc32fa425bc0cf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ebf8c37201f2b3fa196a5f239fc32fa425bc0cf", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/4ebf8c37201f2b3fa196a5f239fc32fa425bc0cf", "committedDate": "2020-08-03T20:11:37Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}, "afterCommit": {"oid": "c728507b35f3103de1fa466366a23c96490f8af6", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/c728507b35f3103de1fa466366a23c96490f8af6", "committedDate": "2020-08-03T22:02:07Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c728507b35f3103de1fa466366a23c96490f8af6", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/c728507b35f3103de1fa466366a23c96490f8af6", "committedDate": "2020-08-03T22:02:07Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}, "afterCommit": {"oid": "6d03c66d4c06791c80ed6a22d5a8681c4b1ce040", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/6d03c66d4c06791c80ed6a22d5a8681c4b1ce040", "committedDate": "2020-08-03T22:07:05Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2b45589f02816ef9ca1ed5ecc55eceff5065d1b", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/d2b45589f02816ef9ca1ed5ecc55eceff5065d1b", "committedDate": "2020-08-03T22:10:41Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d03c66d4c06791c80ed6a22d5a8681c4b1ce040", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/6d03c66d4c06791c80ed6a22d5a8681c4b1ce040", "committedDate": "2020-08-03T22:07:05Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}, "afterCommit": {"oid": "d2b45589f02816ef9ca1ed5ecc55eceff5065d1b", "author": {"user": {"login": "briantang", "name": "Brian Tang"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/d2b45589f02816ef9ca1ed5ecc55eceff5065d1b", "committedDate": "2020-08-03T22:10:41Z", "message": "DHFPROD-5325:Add link from Hub Central to documentation site"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwMzc1NDY2", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4327#pullrequestreview-460375466", "createdAt": "2020-08-03T22:16:12Z", "commit": {"oid": "d2b45589f02816ef9ca1ed5ecc55eceff5065d1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwNDI3Nzcy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4327#pullrequestreview-460427772", "createdAt": "2020-08-04T00:56:52Z", "commit": {"oid": "d2b45589f02816ef9ca1ed5ecc55eceff5065d1b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQwMDo1Njo1MlrOG7NYUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNFQwMDo1Njo1MlrOG7NYUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDczODM4Ng==", "bodyText": "This is ok for now. Next time you make a PR, pls try and use rerender to test with different variable options in the same test.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4327#discussion_r464738386", "createdAt": "2020-08-04T00:56:52Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/header/header.test.tsx", "diffHunk": "@@ -15,36 +15,60 @@ describe('Header component', () => {\n \n     const { getByText, getByLabelText, queryByText } = render(\n       <Router>\n-        <UserContext.Provider value={userNotAuthenticated}>\n-          <Header environment={data.environment}/>\n-        </UserContext.Provider>\n+        <Header environment={data.environment}/>\n       </Router>\n     )\n-\n+    \n     expect(getByLabelText('header-logo')).toBeInTheDocument();\n     expect(getByText(Application.title)).toBeInTheDocument();\n     expect(getByLabelText('icon: question-circle')).toBeInTheDocument();\n     expect(queryByText('icon: user')).not.toBeInTheDocument();\n-\n+    //unauthenticated users get sent to default Marklogic docs \n+    expect(document.querySelector('#help-link')).toHaveAttribute('href', 'https://docs.marklogic.com/datahub/')\n   });\n \n   test('should render correctly when a user is logged in', async () => {\n \n     const { getByText, getByLabelText } = render(\n       <Router>\n         <UserContext.Provider value={userAuthenticated}>\n-          <Header environment={data.environment}/>\n+          <Header environment = {{...data.environment, dataHubVersion: '5.3-SNAPSHOT'}}/>\n         </UserContext.Provider>\n       </Router>\n     )\n-\n     expect(getByLabelText('header-logo')).toBeInTheDocument();\n     expect(getByText(Application.title)).toBeInTheDocument();\n     expect(getByText(data.environment.serviceName)).toBeInTheDocument();\n     // expect(getByLabelText('icon: search')).toBeInTheDocument();\n     expect(getByLabelText('icon: question-circle')).toBeInTheDocument();\n+    //test version specific link is correct when environment hub version data is set to '5.3-SNAPSHOT'\n+    expect(document.querySelector('#help-link')).toHaveAttribute('href', 'https://docs.marklogic.com/datahub/5.3');\n     // expect(getByLabelText('icon: setting')).toBeInTheDocument();\n     expect(getByLabelText('icon: user')).toBeInTheDocument();\n   });\n \n-});\n+  test('Verify proper version link given specific release dataHub release version', async () => {\n+    const {} = render(\n+      <Router>\n+        <UserContext.Provider value={userAuthenticated}>\n+          <Header environment = {{...data.environment, dataHubVersion: '5.2.1'}}/>\n+        </UserContext.Provider>\n+      </Router>\n+    )\n+    expect(document.querySelector('#help-link')).toHaveAttribute('href', 'https://docs.marklogic.com/datahub/5.2');\n+\n+  });\n+\n+  test('Verify proper version link given scenario with multi-digit dataHub versions', async () => {\n+    const {} = render(\n+      <Router>\n+        <UserContext.Provider value={userAuthenticated}>\n+          <Header environment = {{...data.environment, dataHubVersion: '5.64.123456'}}/>\n+        </UserContext.Provider>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2b45589f02816ef9ca1ed5ecc55eceff5065d1b"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwNDI3ODE4", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4327#pullrequestreview-460427818", "createdAt": "2020-08-04T00:57:03Z", "commit": {"oid": "d2b45589f02816ef9ca1ed5ecc55eceff5065d1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2532, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}