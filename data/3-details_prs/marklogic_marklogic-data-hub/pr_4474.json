{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyODIxNTc0", "number": 4474, "title": "DHFPROD-5183: Transform merge steps to new model", "bodyText": "Description\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-08-24T22:33:36Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4474", "merged": true, "mergeCommit": {"oid": "11953069cbd53fd7ee0bb120bfc6629924bd9b1e"}, "closed": true, "closedAt": "2020-08-25T16:30:48Z", "author": {"login": "fsnow"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCWMJoAFqTQ3NDQxNzk3MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCZZmEAFqTQ3NDYyNzYzOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0NDE3OTcw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4474#pullrequestreview-474417970", "createdAt": "2020-08-25T12:13:28Z", "commit": {"oid": "14fc9113fea29ccda599de6fc86b0dad0dcbcbc9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMjoxMzo0MlrOHGVLXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxMjoxNTo1MlrOHGVP8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjQwMDQ3Nw==", "bodyText": "No need to change this, but just an FYI, pinging @srinathgit  and @ryanjdew  on this too - one thing I'd like to do, particularly in our tests, is get a HubClient as early as possible and use that for all connections. The benefit is that it doesn't create a new DatabaseClient each time the way HubConfig does when you call one of its new*Client methods. That also means less and less code that depends on HubConfig - I'd really like our code to depend on HubClient and (if needed) HubProject, with HubConfig becoming something that's discarded once those two things are obtained. But again, no need to change this, just a note.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4474#discussion_r476400477", "createdAt": "2020-08-25T12:13:42Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/java/com/marklogic/hub/hubcentral/conversion/FlowConverter.java", "diffHunk": "@@ -514,4 +524,23 @@ protected void transformMatchingOptions(ObjectNode stepNode) {\n             stepNode.set(fieldName, node);\n         }\n     }\n+\n+    protected void transformMergingOptions(ObjectNode stepNode) {\n+        JsonNode beforeNode = stepNode.get(\"mergeOptions\");\n+        // if mergeOptions is null, this conversion has already run\n+        if (beforeNode == null) {\n+            return;\n+        }\n+\n+        JsonNode afterNode = MasteringService.on(hubConfig.newHubClient().getStagingClient()).updateMergeOptions(beforeNode);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9e2848b65b802e8b218b030ca9e4330b80d1290"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjQwMTY0OA==", "bodyText": "Can you add unit tests for these functions?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4474#discussion_r476401648", "createdAt": "2020-08-25T12:15:52Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/data-services/mastering/updateMergeOptionsLib.sjs", "diffHunk": "@@ -0,0 +1,209 @@\n+'use strict';\n+\n+function updateMergeOptions(opt)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9e2848b65b802e8b218b030ca9e4330b80d1290"}, "originalPosition": 3}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84b03b08ceb353ca775db41208f912e56b4a74d3", "author": {"user": {"login": "fsnow", "name": "Frank Snow"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/84b03b08ceb353ca775db41208f912e56b4a74d3", "committedDate": "2020-08-25T12:37:21Z", "message": "DHFPROD-5183: Transform merge steps to new model"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0NTE4MjE4", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4474#pullrequestreview-474518218", "createdAt": "2020-08-25T14:08:00Z", "commit": {"oid": "84b03b08ceb353ca775db41208f912e56b4a74d3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0NjI3NjM5", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4474#pullrequestreview-474627639", "createdAt": "2020-08-25T16:00:40Z", "commit": {"oid": "84b03b08ceb353ca775db41208f912e56b4a74d3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2158, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}