{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3MTcyMTkx", "number": 4663, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzo1NjowN1rOEqVGyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzo1OTowMVrOEqVMDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyODIxNDQ4OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/mapping-functions/core.sjs", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzo1NjowN1rOHcePRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzo1NjowN1rOHcePRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYxNzYwNw==", "bodyText": "I recommend removing these comments. They don't add anything - the code is clear in that if the value is null or whitespace, then null will be returned.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4663#discussion_r499617607", "createdAt": "2020-10-05T13:56:07Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/mapping-functions/core.sjs", "diffHunk": "@@ -91,8 +91,20 @@ function parseDate(value, pattern) {\n   if (pattern != null) {\n     pattern = pattern.toString().replace(\", \", \",\");\n   }\n-  if (value != null) {\n+  //return in case 'value' is null or undefined", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a585dff1b5b5127c9392a79a952cdc09b558b40d"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyODIyNTIwOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/mapping-functions/core.sjs", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzo1ODoyM1rOHceVwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzo1ODoyM1rOHceVwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYxOTI2NQ==", "bodyText": "This logic is almost identical. You can reduce the duplication and further remove the need for any comments by introducing a new function here.\nThe 'replace(\", \", \",\");' bit should then be done on \"value\" after the new function eturns false.\nThe code would then read e.g.:\nif (isNullOrEmpty(value)) {\n  return null;\n}", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4663#discussion_r499619265", "createdAt": "2020-10-05T13:58:23Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/mapping-functions/core.sjs", "diffHunk": "@@ -151,6 +163,19 @@ function parseDateTime(value, pattern) {\n   let supportedFormats = [\"YYYYMMDDThhmmss\", \"DD/MM/YYYY-hh:mm:ss\", \"DD/MM/YYYY hh:mm:ss\", \"YYYY/MM/DD-hh:mm:ss\" , \"YYYY/MM/DD hh:mm:ss\"];\n   let response;\n   let errorMsg = `The pattern '${pattern}' cannot be applied to the value '${value}'`;\n+\n+  if (value) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a585dff1b5b5127c9392a79a952cdc09b558b40d"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyODIyNzk4OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/mapping-functions/parseDate.sjs", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzo1OTowMVrOHceXcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxMzo1OTowMVrOHceXcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTYxOTY5OQ==", "bodyText": "Throw in a test case for \"undefined\" as well - shouldn't require any code changes.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4663#discussion_r499619699", "createdAt": "2020-10-05T13:59:01Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/mapping-functions/parseDate.sjs", "diffHunk": "@@ -22,7 +22,10 @@ function testMoreParseDate() {\n     test.assertEqual(xs.date(\"1996-07-16\"), core.parseDate(\"1996.07.16\", \"yyyy.MM.dd\")),\n \n     test.assertEqual(null, core.parseDate(\"07.16.1996\", \"Mon DD,YYYY\")),\n-    test.assertEqual(null, core.parseDate(\"notADate\", \"Mon DD,YYYY\"))\n+    test.assertEqual(null, core.parseDate(\"notADate\", \"Mon DD,YYYY\")),\n+    test.assertEqual(null, core.parseDate(null, \"Mon DD,YYYY\")),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a585dff1b5b5127c9392a79a952cdc09b558b40d"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3263, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}