{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUzNzYwMzk3", "number": 4245, "title": "DHFPROD-5163: e2e tests for ingestion", "bodyText": "Description\nsome e2e tests for ingestion using singe file uploaded\nmultiple file uploads will come up next sprint. Needs a bit more handling in custom commands.\ncsv and xml file tests are commented because of open bug.\nFixes to unit tests\nUpdated locators where necessary\n@xnikhil08 @wooldridge @srinathgit Found lot of redundant code for confirmation modal and so I had to add aria-label for the tests to use in every single one of them. Something to note for the future so we can create a common component, just like we have for dropdownsearch.\n@Sanjeevani19 @timur-isangulov FYI\nPinged failing explorer tests for your review. They arent related to the changes in this PR.\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-07-20T19:25:46Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4245", "merged": true, "mergeCommit": {"oid": "520dbaac64b9869cc0ab85c8be292f6880a63c6a"}, "closed": true, "closedAt": "2020-07-21T16:23:26Z", "author": {"login": "bsrikan"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc22qyUAH2gAyNDUzNzYwMzk3OjI0MDM5OWM2MzkyOWRmYWUzYTlkODM4OGZkMjBkNzQzMDhiYjlkNjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3IGihAFqTQ1MjU4NTIwMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "240399c63929dfae3a9d8388fd20d74308bb9d66", "author": {"user": {"login": "bsrikan", "name": "Srikanth Balasubramanian"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/240399c63929dfae3a9d8388fd20d74308bb9d66", "committedDate": "2020-07-20T19:19:36Z", "message": "DHFPROD-5163: add custom commands for upload and flow verifications\n\nDHFPROD-5163: ingestion e2e tests\n\nFixing unit tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxODk2OTQw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4245#pullrequestreview-451896940", "createdAt": "2020-07-20T19:29:38Z", "commit": {"oid": "240399c63929dfae3a9d8388fd20d74308bb9d66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxOToyOTozOFrOG0cQDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxOToyOTozOFrOG0cQDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY0MTk5Nw==", "bodyText": "Trying to create these docs for custom commands and locators that are not self explanatory.\nProbably a good practice if we start writing tests across teams.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4245#discussion_r457641997", "createdAt": "2020-07-20T19:29:38Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/e2e/cypress/support/index.d.ts", "diffHunk": "@@ -72,5 +72,27 @@ declare namespace Cypress {\n        * @example cy.deleteSavedQueries()\n       */\n       deleteSavedQueries(): Chainable<Element>\n+\n+      deleteFlows(...flowNames: any[]): Chainable<Element>\n+\n+      deleteSteps(stepType: string, ...stepNames: any[]): Chainable<Element>\n+\n+      waitForModalToDisappear(): void\n+\n+      verifyStepAddedToFlow(stepType: string, stepName: string): Chainable<Element>\n+\n+      /**\n+       * Custom command to upload files for running a load step.\n+       * @param filePath - a list of input file path\n+      */\n+      uploadFile(filePath: string): Chainable<Element>\n+\n+      /**\n+       * Custom command to verify status of a step when run in a flow\n+       * @param jobStatus - success, failed or failed_with_error\n+       * @param stepType - Ingestion, Mapping, Matching, Merging, Mastering or Custom\n+       * @param stepName - name of the step\n+       */\n+      verifyStepRunResult(jobStatus: string, stepType: string, stepName: string): Chainable<Element>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "240399c63929dfae3a9d8388fd20d74308bb9d66"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxODk4NDYy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4245#pullrequestreview-451898462", "createdAt": "2020-07-20T19:31:51Z", "commit": {"oid": "240399c63929dfae3a9d8388fd20d74308bb9d66"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxOTozMTo1MVrOG0cUkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxOTozMTo1MVrOG0cUkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY0MzE1NQ==", "bodyText": "more docs for locators that are self explanatory but input format is a need to know", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4245#discussion_r457643155", "createdAt": "2020-07-20T19:31:51Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/e2e/cypress/support/pages/load.tsx", "diffHunk": "@@ -0,0 +1,230 @@\n+import {FileLocation} from \"ts-loader/dist/types/interfaces\";\n+import {Simulate} from \"react-dom/test-utils\";\n+import mouseOver = Simulate.mouseOver;\n+\n+class LoadPage {\n+\n+    //Load tile list view page objects\n+    /**\n+     * @param type - accepts `table` for list-view or `th-large` for card-view\n+     */\n+    loadView(type: string) {\n+        return cy.get(`[data-icon=\"${type}\"`);\n+    }\n+\n+    /**\n+     * @param type - accepts `list` or `card`\n+     */\n+    addNewButton(type: string) {\n+        return cy.findByLabelText(`add-new-${type}`)\n+    }\n+\n+    stepName(stepName: string) {\n+        return cy.findByText(stepName);\n+    }\n+\n+    stepDescription(stepName: string) {\n+\n+    }\n+\n+    stepSourceFormat(stepName: string) {\n+\n+    }\n+\n+    stepTargetFormat(stepName: string) {\n+\n+    }\n+\n+    stepLastUpdated(stepName: string) {\n+\n+    }\n+\n+    columnSort(columnName: string) {\n+\n+    }\n+\n+    closeModal() {\n+        return cy.get('[aria-label=\"icon: close\"]')\n+    }\n+\n+    stepSettings(stepName: string) {\n+        return cy.findByTestId(`${stepName}-settings`);\n+    }\n+\n+    deleteStep(stepName: string) {\n+        return cy.findByTestId(`${stepName}-delete`);\n+    }\n+\n+    deleteConfirmation(option: string) {\n+        return cy.findByLabelText(option);\n+    }\n+\n+    pagination() {\n+\n+    }\n+\n+    /**\n+     * @param text - a string that matches any button by its label\n+     */\n+    findByButtonText(text: string) {\n+        return cy.findByLabelText(text);\n+    }\n+\n+    //New/Edit modal page objects\n+    stepNameInput() {\n+        return  cy.findByPlaceholderText('Enter name');\n+    }\n+\n+    stepDescriptionInput() {\n+        return cy.findByPlaceholderText('Enter description');\n+    }\n+\n+    selectSourceFormat(format: string) {\n+        cy.get('#sourceFormat').click();\n+        cy.findAllByText(`${format}`).last().click();\n+    }\n+\n+    selectTargetFormat(format: string) {\n+        cy.get('#targetFormat').click();\n+        cy.findAllByText(`${format}`).last().click();\n+    }\n+\n+    uriPrefixInput() {\n+        return cy.findByPlaceholderText('Enter URI Prefix');\n+    }\n+\n+    cancelButton() {\n+        return cy.findByLabelText('Cancel');\n+    }\n+\n+    confirmationOptions(option: string) {\n+        return cy.findByLabelText(option);\n+    }\n+\n+    saveButton() {\n+        return cy.findByLabelText('Save');\n+    }\n+\n+    //Settings page objects\n+    stepNameInSettings() {\n+        return cy.get('div p').last();\n+    }\n+\n+    /**\n+     * Clicks on a database option\n+     * @param db - accepts `STAGING` or `FINAL`\n+     */\n+    selectTargetDB(db: string) {\n+        cy.findByLabelText('targetDatabase-select').click();\n+        cy.findByTestId(`targetDbOptions-data-hub-${db}`).click();\n+    }\n+\n+    /**\n+     * This input field takes multiple values with special character sequences for keyboard events\n+     */\n+    targetCollectionInput() {\n+        return cy.findByLabelText('additionalColl-select');\n+    }\n+\n+    defaultCollections(collectionName: string) {\n+        return cy.findByTestId(`defaultCollections-${collectionName}`);\n+    }\n+\n+    /**\n+     * Overwrite the existing default permissions\n+     * @param permissions - accepts a comma separated text of roles and capabilities alternately\n+     * @example role1,cap1,role2,cap2\n+     */\n+    setTargetPermissions(permissions: string) {\n+        return cy.get('#targetPermissions').clear().type(permissions);\n+    }\n+\n+    /**\n+     * Add to the existing default permissions\n+     * @param permissions - accepts a comma separated text of roles and capabilities alternately\n+     * @example role1,cap1,role2,cap2\n+     */\n+    appendTargetPermissions(permissions: string) {\n+        return cy.get('#targetPermissions').type(`,${permissions}`);\n+    }\n+\n+    selectProvGranularity(options: string) {\n+        cy.get('#provGranularity').click();\n+        cy.findByTestId(`provOptions-${options}`).click();\n+    }\n+\n+    setBatchSize(batchSize: string) {\n+        cy.get('#batchSize').clear().type(batchSize);\n+    }\n+\n+    /**\n+     * Textarea that takes a file path in fixtures and pastes the json object {} in the text area\n+     * @param fixturePath - file path to headerContent json config file\n+     * @see https://docs.cypress.io/api/commands/type.html#Key-Combinations\n+     */\n+    setHeaderContent(fixturePath: string) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "240399c63929dfae3a9d8388fd20d74308bb9d66"}, "originalPosition": 165}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyMDE1ODYz", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4245#pullrequestreview-452015863", "createdAt": "2020-07-20T23:00:15Z", "commit": {"oid": "240399c63929dfae3a9d8388fd20d74308bb9d66"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUyNTg1MjAy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4245#pullrequestreview-452585202", "createdAt": "2020-07-21T15:38:18Z", "commit": {"oid": "240399c63929dfae3a9d8388fd20d74308bb9d66"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2405, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}