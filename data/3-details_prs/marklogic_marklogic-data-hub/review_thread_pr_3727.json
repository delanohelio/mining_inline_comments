{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNzY0ODcz", "number": 3727, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMjozNDozNVrODpfPjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMjozNToxNFrODpfQaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0ODMwMDk0OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/builtins/steps/mapping/default/lib.sjs", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMjozNDozNVrOF4sahw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxOToyNjowMFrOF49NiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk5MjI2Mw==", "bodyText": "What change is causing a String cast to be needed here and in the places below?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3727#discussion_r394992263", "createdAt": "2020-03-19T12:34:35Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/builtins/steps/mapping/default/lib.sjs", "diffHunk": "@@ -128,7 +128,7 @@ function extractInstanceFromModel(model, modelName, mapping, content, provenance\n     }\n     let value = null;\n     if (!dataType && prop['$ref']) {\n-      let refArr = prop['$ref'].split('/');\n+      let refArr = String(prop['$ref']).split('/');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26d1a195900ea2dc23b87ce7ecee5873af60f36c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTA2NTQwMw==", "bodyText": "Not exactly a change. The OpenApi specs were wrong and had \"targetEntity\" instead of \"targetEntityType\". That was hitting the split error since targetEntityType was null. The cast was part of the debugging. I left it since the error \"Couldn't find targetEntityType: \" more clearly indicated what was wrong than the split undefined error we we seeing.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3727#discussion_r395065403", "createdAt": "2020-03-19T14:25:57Z", "author": {"login": "ryanjdew"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/builtins/steps/mapping/default/lib.sjs", "diffHunk": "@@ -128,7 +128,7 @@ function extractInstanceFromModel(model, modelName, mapping, content, provenance\n     }\n     let value = null;\n     if (!dataType && prop['$ref']) {\n-      let refArr = prop['$ref'].split('/');\n+      let refArr = String(prop['$ref']).split('/');", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk5MjI2Mw=="}, "originalCommit": {"oid": "26d1a195900ea2dc23b87ce7ecee5873af60f36c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTE5NzUxMA==", "bodyText": "@ryanjdew, some tests are failing with missing [\"targetEntityType\"] error.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3727#discussion_r395197510", "createdAt": "2020-03-19T17:27:06Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/builtins/steps/mapping/default/lib.sjs", "diffHunk": "@@ -128,7 +128,7 @@ function extractInstanceFromModel(model, modelName, mapping, content, provenance\n     }\n     let value = null;\n     if (!dataType && prop['$ref']) {\n-      let refArr = prop['$ref'].split('/');\n+      let refArr = String(prop['$ref']).split('/');", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk5MjI2Mw=="}, "originalCommit": {"oid": "26d1a195900ea2dc23b87ce7ecee5873af60f36c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI2NzQ2NA==", "bodyText": "@bsrikan addressing the issues now", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3727#discussion_r395267464", "createdAt": "2020-03-19T19:26:00Z", "author": {"login": "ryanjdew"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/builtins/steps/mapping/default/lib.sjs", "diffHunk": "@@ -128,7 +128,7 @@ function extractInstanceFromModel(model, modelName, mapping, content, provenance\n     }\n     let value = null;\n     if (!dataType && prop['$ref']) {\n-      let refArr = prop['$ref'].split('/');\n+      let refArr = String(prop['$ref']).split('/');", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk5MjI2Mw=="}, "originalCommit": {"oid": "26d1a195900ea2dc23b87ce7ecee5873af60f36c"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0ODMwMzEyOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/builtins/steps/mapping/entity-services/lib.sjs", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMjozNToxNFrOF4sb6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxNDoyNzowN1rOF4w7gw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk5MjYxOA==", "bodyText": "What's an example of a targetEntityType that this is now handling?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3727#discussion_r394992618", "createdAt": "2020-03-19T12:35:14Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/builtins/steps/mapping/entity-services/lib.sjs", "diffHunk": "@@ -259,9 +259,9 @@ function getEntityName(targetEntityType) {\n }\n \n function fallbackLegacyEntityLookup(targetEntityType) {\n-  let targetArr = targetEntityType.split('/');\n+  let targetArr = String(targetEntityType).split('/');\n   let entityName = targetArr[targetArr.length - 1];\n-  let tVersion = targetArr[targetArr.length - 2].split('-');\n+  let tVersion = targetArr[targetArr.length - 2] ? targetArr[targetArr.length - 2].split('-') : '';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "26d1a195900ea2dc23b87ce7ecee5873af60f36c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTA2NjI0Mw==", "bodyText": "same as above. it was throwing a confusing error when targetEntityType was missing.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3727#discussion_r395066243", "createdAt": "2020-03-19T14:27:07Z", "author": {"login": "ryanjdew"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/builtins/steps/mapping/entity-services/lib.sjs", "diffHunk": "@@ -259,9 +259,9 @@ function getEntityName(targetEntityType) {\n }\n \n function fallbackLegacyEntityLookup(targetEntityType) {\n-  let targetArr = targetEntityType.split('/');\n+  let targetArr = String(targetEntityType).split('/');\n   let entityName = targetArr[targetArr.length - 1];\n-  let tVersion = targetArr[targetArr.length - 2].split('-');\n+  let tVersion = targetArr[targetArr.length - 2] ? targetArr[targetArr.length - 2].split('-') : '';", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDk5MjYxOA=="}, "originalCommit": {"oid": "26d1a195900ea2dc23b87ce7ecee5873af60f36c"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3495, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}