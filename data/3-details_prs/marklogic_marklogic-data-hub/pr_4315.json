{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5MzUxNzYx", "number": 4315, "title": "DHFPROD-5484: Package hub-central as a RPM", "bodyText": "Description\nThe package does not perform a dependency check on Java 11 because the java dependency could be satisfied by various packages (oracle java, openjdk java, etc). We can only add a dependency on one of the packages and if we change the java vendor or the package type in the future on DHS then the RPM will complain and not install. So I think its best not to include this dependency check.\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n[N/A] Added Tests\n\n\nReviewer:\n\n\n[N/A] Reviewed Tests", "createdAt": "2020-07-30T16:11:19Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315", "merged": true, "mergeCommit": {"oid": "d5b80f4a4e44a12dacb7eb5e2957dc70b789beec"}, "closed": true, "closedAt": "2020-07-31T17:56:08Z", "author": {"login": "akshaysonvane"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6CgUYAFqTQ1ODU3NzUwNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6YDSSAFqTQ1OTM1NzA3NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NTc3NTA3", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#pullrequestreview-458577507", "createdAt": "2020-07-30T16:44:07Z", "commit": {"oid": "8432c73241070ec78248a74c684a840696e01b10"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNjo0NDowN1rOG5rQ_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNjo0ODozNVrOG5rcPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEzMDg3Nw==", "bodyText": "Can you include a comment here indicating why this is needed - i.e. so we can run it as a service?\nI think Spring bean declarations and Gradle configuration blocks are similar - both can get a lot done in a small amount of code, but there's often a question of why the code exists. It's really slick that all we need is \"launchScript()\" here, but it begs the question of why we need it.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#discussion_r463130877", "createdAt": "2020-07-30T16:44:07Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub-central/build.gradle", "diffHunk": "@@ -38,6 +39,7 @@ ext.junitJupiterVersion = '5.3.1'\n \n bootWar {\n     baseName = springBootJarName\n+    launchScript()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8432c73241070ec78248a74c684a840696e01b10"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEzMTE3NQ==", "bodyText": "What does \"release\" mean/affect here? When would we change this to some other value?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#discussion_r463131175", "createdAt": "2020-07-30T16:44:31Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub-central/build.gradle", "diffHunk": "@@ -186,6 +188,63 @@ test {\n \tuseJUnitPlatform()\n }\n \n+ospackage {\n+    packageName = 'hub-central'\n+    version = \"${project.version}\"\n+    release = 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8432c73241070ec78248a74c684a840696e01b10"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEzMzc1Ng==", "bodyText": "Can you try moving this config to \"build-rpm.gradle\" in the same directory? I've found that build.gradle files can become very long over time - this seems like an easy way to split it up. On the other hand, sometimes extracting a separate file is harder than it should be.\nIdeally, we can move the ospackage plugin declaration to build-rpm.gradle, and also the entire ospackage block. The trick is often where you apply the separate file within build.gradle. We may still need ospackage declared in build.gradle.\nThe benefit would be that we'd have one separate Gradle file for everything pertaining to the rpm, instead of having to sift through hundreds of lines of config in build.gradle to find it.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#discussion_r463133756", "createdAt": "2020-07-30T16:48:35Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub-central/build.gradle", "diffHunk": "@@ -186,6 +188,63 @@ test {\n \tuseJUnitPlatform()\n }\n \n+ospackage {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8432c73241070ec78248a74c684a840696e01b10"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NTg5MTA2", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#pullrequestreview-458589106", "createdAt": "2020-07-30T16:58:51Z", "commit": {"oid": "8432c73241070ec78248a74c684a840696e01b10"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNjo1ODo1MVrOG5r0dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNjo1ODo1MVrOG5r0dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEzOTk1OQ==", "bodyText": "One other comment - can you put these files under \"src/rpm\"? I like to avoid a lot of root-level directories, and these files all still count as \"source code\".", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#discussion_r463139959", "createdAt": "2020-07-30T16:58:51Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub-central/installer/configs/hub-central.conf", "diffHunk": "@@ -0,0 +1,6 @@\n+# The location of the java executable is discovered by using the PATH by default, ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8432c73241070ec78248a74c684a840696e01b10"}, "originalPosition": 1}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8432c73241070ec78248a74c684a840696e01b10", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/8432c73241070ec78248a74c684a840696e01b10", "committedDate": "2020-07-30T05:32:07Z", "message": "DHFPROD-5484: Package hub-central as a RPM"}, "afterCommit": {"oid": "0db7f21bcb05585ae03664bfadb155888b0cb166", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/0db7f21bcb05585ae03664bfadb155888b0cb166", "committedDate": "2020-07-30T17:51:49Z", "message": "DHFPROD-5484: Package hub-central as a RPM"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0db7f21bcb05585ae03664bfadb155888b0cb166", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/0db7f21bcb05585ae03664bfadb155888b0cb166", "committedDate": "2020-07-30T17:51:49Z", "message": "DHFPROD-5484: Package hub-central as a RPM"}, "afterCommit": {"oid": "922debd5124c98ef4e0751124c0052a585156f25", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/922debd5124c98ef4e0751124c0052a585156f25", "committedDate": "2020-07-30T18:04:17Z", "message": "DHFPROD-5484: Package hub-central as a RPM"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NjM3NjYz", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#pullrequestreview-458637663", "createdAt": "2020-07-30T18:05:53Z", "commit": {"oid": "922debd5124c98ef4e0751124c0052a585156f25"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxODowNTo1M1rOG5uJdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxODowNTo1M1rOG5uJdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE3ODEwMw==", "bodyText": "Build fails if we remove it from here.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#discussion_r463178103", "createdAt": "2020-07-30T18:05:53Z", "author": {"login": "akshaysonvane"}, "path": "marklogic-data-hub-central/build.gradle", "diffHunk": "@@ -13,6 +13,7 @@ buildscript {\n plugins {\n     id \"net.saliman.properties\" version \"1.5.1\"\n     id \"java\"\n+    id \"nebula.ospackage\" version \"8.4.1\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "922debd5124c98ef4e0751124c0052a585156f25"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MTUxODUx", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#pullrequestreview-459151851", "createdAt": "2020-07-31T12:56:54Z", "commit": {"oid": "922debd5124c98ef4e0751124c0052a585156f25"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxMjo1Njo1NFrOG6HjyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxMjo1ODozOFrOG6Hm_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzU5NDQ0MA==", "bodyText": "This is really cool, thanks for getting this together. Makes me think we should opt for an rpm whenever possible now.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#discussion_r463594440", "createdAt": "2020-07-31T12:56:54Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub-central/build-rpm.gradle", "diffHunk": "@@ -0,0 +1,55 @@\n+ospackage {\n+    packageName = 'hub-central'\n+    version = \"${project.version}\"\n+    release = 1\n+    os = LINUX\n+    type = BINARY\n+    arch = NOARCH\n+    summary = 'Hub Central Application Server'\n+    url = 'http://marklogic.com/'\n+    vendor = 'MarkLogic Corporation'\n+\n+    preInstall file('src/rpm/scripts/pre-install.sh')\n+    postInstall file('src/rpm/scripts/post-install.sh')\n+    preUninstall file('src/rpm/scripts/pre-uninstall.sh')\n+    postUninstall file('src/rpm/scripts/post-uninstall.sh')\n+\n+    requires('systemd')\n+\n+    user 'hc-runner'\n+    permissionGroup 'hc-runner'\n+\n+    from(war.outputs.files) {\n+        rename { String fileName ->\n+            fileName.replace(\"marklogic-data-hub-central-${project.version}\", \"hub-central\")\n+        }\n+        fileMode 0755\n+        into '/opt/hub-central'\n+    }\n+\n+    from('src/rpm/services/hub-central.service') {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "922debd5124c98ef4e0751124c0052a585156f25"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzU5NDg5Mg==", "bodyText": "Can this line not be in build-rpm.gradle? No problem if it has to be here.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#discussion_r463594892", "createdAt": "2020-07-31T12:57:47Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub-central/build.gradle", "diffHunk": "@@ -186,6 +192,7 @@ test {\n \tuseJUnitPlatform()\n }\n \n+tasks.buildRpm.dependsOn(buildUi, copyUiFiles, bootWar)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "922debd5124c98ef4e0751124c0052a585156f25"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzU5NTI2MQ==", "bodyText": "Where does this write the rpm file to?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#discussion_r463595261", "createdAt": "2020-07-31T12:58:38Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub-central/build-rpm.gradle", "diffHunk": "@@ -0,0 +1,55 @@\n+ospackage {\n+    packageName = 'hub-central'\n+    version = \"${project.version}\"\n+    release = 1\n+    os = LINUX\n+    type = BINARY\n+    arch = NOARCH\n+    summary = 'Hub Central Application Server'\n+    url = 'http://marklogic.com/'\n+    vendor = 'MarkLogic Corporation'\n+\n+    preInstall file('src/rpm/scripts/pre-install.sh')\n+    postInstall file('src/rpm/scripts/post-install.sh')\n+    preUninstall file('src/rpm/scripts/pre-uninstall.sh')\n+    postUninstall file('src/rpm/scripts/post-uninstall.sh')\n+\n+    requires('systemd')\n+\n+    user 'hc-runner'\n+    permissionGroup 'hc-runner'\n+\n+    from(war.outputs.files) {\n+        rename { String fileName ->\n+            fileName.replace(\"marklogic-data-hub-central-${project.version}\", \"hub-central\")\n+        }\n+        fileMode 0755\n+        into '/opt/hub-central'\n+    }\n+\n+    from('src/rpm/services/hub-central.service') {\n+        addParentDirs(false)\n+        fileMode 0755\n+        into '/etc/systemd/system'\n+    }\n+\n+    from('src/rpm/configs/hub-central.conf') {\n+        fileType CONFIG | NOREPLACE\n+        fileMode 0644\n+        into '/opt/hub-central'\n+    }\n+\n+    from('src/rpm/configs/hub-central.properties') {\n+        addParentDirs(false)\n+        fileType CONFIG | NOREPLACE\n+        fileMode 0644\n+        into '/etc/opt/hub-central'\n+    }\n+}\n+\n+buildRpm {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "922debd5124c98ef4e0751124c0052a585156f25"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b32bafb4aa0d268c3c0d8941592d563eb5dec925", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/b32bafb4aa0d268c3c0d8941592d563eb5dec925", "committedDate": "2020-07-31T16:23:18Z", "message": "DHFPROD-5484: Package hub-central as a RPM"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "922debd5124c98ef4e0751124c0052a585156f25", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/922debd5124c98ef4e0751124c0052a585156f25", "committedDate": "2020-07-30T18:04:17Z", "message": "DHFPROD-5484: Package hub-central as a RPM"}, "afterCommit": {"oid": "b32bafb4aa0d268c3c0d8941592d563eb5dec925", "author": {"user": {"login": "akshaysonvane", "name": "Akshay Sonvane"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/b32bafb4aa0d268c3c0d8941592d563eb5dec925", "committedDate": "2020-07-31T16:23:18Z", "message": "DHFPROD-5484: Package hub-central as a RPM"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MzAzMDM2", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#pullrequestreview-459303036", "createdAt": "2020-07-31T16:25:47Z", "commit": {"oid": "b32bafb4aa0d268c3c0d8941592d563eb5dec925"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MzU3MDc0", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4315#pullrequestreview-459357074", "createdAt": "2020-07-31T17:55:00Z", "commit": {"oid": "b32bafb4aa0d268c3c0d8941592d563eb5dec925"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2507, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}