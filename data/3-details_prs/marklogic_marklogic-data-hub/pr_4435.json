{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5Nzk1NTI2", "number": 4435, "title": "DHFPROD-5762: Adding sources object in Entity Headers to search result", "bodyText": "Description\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-08-18T23:27:48Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4435", "merged": true, "mergeCommit": {"oid": "a1cc0b960a356acd48a9c4d1ee4029ea79dc280b"}, "closed": true, "closedAt": "2020-08-19T16:42:26Z", "author": {"login": "rahulvudutala"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAQ1QOgFqTQ2OTk0NTE2MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAeQI-gFqTQ3MDYzOTkyMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5OTQ1MTYx", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4435#pullrequestreview-469945161", "createdAt": "2020-08-19T00:53:43Z", "commit": {"oid": "6aacaf214a04b84800f41076c317b23163067c2f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwMDo1Mzo0M1rOHCrkFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwMDo1Mzo0M1rOHCrkFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU3Mjk0OA==", "bodyText": "What's the actual requirement here? The JIRA ticket mentions that \"headers are not extracted\", and this function is called \"getEntityInstanceHeaders\", but the code is specifically interested in the sources part of headers.\nWhat is the UI looking to do with the sources?\nIf the intent is to provide an array of sources for an entity instance, I think this function should be called \"getEntitySources\" (I think the word 'instance' adds a little confusion because 'instance' and 'headers' are two separate parts of the envelope).", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4435#discussion_r472572948", "createdAt": "2020-08-19T00:53:43Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/entities/entity-search-lib.sjs", "diffHunk": "@@ -263,12 +264,28 @@ function getEntityInstance(docUri) {\n }\n \n function getEntityInstanceHeaders(docUri) {\n-    let doc = cts.doc(docUri);\n+  const doc = cts.doc(docUri);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6aacaf214a04b84800f41076c317b23163067c2f"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6aacaf214a04b84800f41076c317b23163067c2f", "author": {"user": {"login": "rahulvudutala", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/6aacaf214a04b84800f41076c317b23163067c2f", "committedDate": "2020-08-18T23:25:42Z", "message": "DHFPROD-5762: Headers from search result for XML documents"}, "afterCommit": {"oid": "1f34d0cb55f4577613c816d520ca0e1853448cc0", "author": {"user": {"login": "rahulvudutala", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/1f34d0cb55f4577613c816d520ca0e1853448cc0", "committedDate": "2020-08-19T14:22:06Z", "message": "DHFPROD-5762: Adding sources object in Entity Headers to search result"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNTIyMTU2", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4435#pullrequestreview-470522156", "createdAt": "2020-08-19T14:34:53Z", "commit": {"oid": "1f34d0cb55f4577613c816d520ca0e1853448cc0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxNDozNDo1M1rOHDKYbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxNDozNTowMVrOHDKY7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzA3Nzg3MQ==", "bodyText": "You can remove the \"?\" operator here because getEntitySources always returns an array, right?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4435#discussion_r473077871", "createdAt": "2020-08-19T14:34:53Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/entities/entity-search-lib.sjs", "diffHunk": "@@ -370,7 +387,7 @@ function addEntitySpecificProperties(result, entityInfo, selectedPropertyMetadat\n     console.log(`Unable to obtain document with URI '${result.uri}'; will not add document metadata to its search result`);\n   }\n   result.entityInstance = entityInstance;\n-  result.sources = getEntityInstanceHeaders(result.uri) ? getEntityInstanceHeaders(result.uri) : result.sources;\n+  result.sources = getEntitySources(result.uri) ? getEntitySources(result.uri) : result.sources;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f34d0cb55f4577613c816d520ca0e1853448cc0"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzA3Nzk5Ng==", "bodyText": "Same here, don't need the \"?\".", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4435#discussion_r473077996", "createdAt": "2020-08-19T14:35:01Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/entities/entity-search-lib.sjs", "diffHunk": "@@ -423,7 +440,7 @@ function addGenericEntityProperties(result) {\n     \"propertyValue\": identifierValue\n   };\n   result.entityInstance = entityInstance;\n-  result.sources = getEntityInstanceHeaders(result.uri) ? getEntityInstanceHeaders(result.uri) : result.sources;\n+  result.sources = getEntitySources(result.uri) ? getEntitySources(result.uri) : result.sources;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f34d0cb55f4577613c816d520ca0e1853448cc0"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d58e91c983393d3e6c59d3f4a0a9adb0ce196db8", "author": {"user": {"login": "rahulvudutala", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/d58e91c983393d3e6c59d3f4a0a9adb0ce196db8", "committedDate": "2020-08-19T15:22:55Z", "message": "DHFPROD-5762: Adding sources object in Entity Headers to search result"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1f34d0cb55f4577613c816d520ca0e1853448cc0", "author": {"user": {"login": "rahulvudutala", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/1f34d0cb55f4577613c816d520ca0e1853448cc0", "committedDate": "2020-08-19T14:22:06Z", "message": "DHFPROD-5762: Adding sources object in Entity Headers to search result"}, "afterCommit": {"oid": "d58e91c983393d3e6c59d3f4a0a9adb0ce196db8", "author": {"user": {"login": "rahulvudutala", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/d58e91c983393d3e6c59d3f4a0a9adb0ce196db8", "committedDate": "2020-08-19T15:22:55Z", "message": "DHFPROD-5762: Adding sources object in Entity Headers to search result"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNjM4NDcw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4435#pullrequestreview-470638470", "createdAt": "2020-08-19T16:30:08Z", "commit": {"oid": "d58e91c983393d3e6c59d3f4a0a9adb0ce196db8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNjM5OTIx", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4435#pullrequestreview-470639921", "createdAt": "2020-08-19T16:32:01Z", "commit": {"oid": "d58e91c983393d3e6c59d3f4a0a9adb0ce196db8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2114, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}