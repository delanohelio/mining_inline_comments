{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0ODI3NzYz", "number": 3831, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzoyNzoyNVrODz1u4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNzoyODozNVrOD1Y_sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1Njg0MzIxOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/scenarios.modeling.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzoyNzoyNVrOGIfi9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNjozMTozNlrOGJNUIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU1ODY0NA==", "bodyText": "I would like us to avoid writing integration/e2e tests for scenarios that can be covered using RTL. Form validations and table rendering test below can be verified using RTL as unit tests.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r411558644", "createdAt": "2020-04-20T17:27:25Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/scenarios.modeling.tsx", "diffHunk": "@@ -0,0 +1,72 @@\n+/// <reference types=\"cypress\"/>\n+\n+import HomePage from \"../support/pages/home\";\n+import ModelingPage from '../support/pages/modeling';\n+\n+const homePage = new HomePage();\n+const modelingPage = new ModelingPage();\n+\n+describe('Entity Modeling Page', () => {\n+\n+  //login with valid account\n+  beforeEach(() => {\n+    cy.visit('/');\n+    cy.contains('MarkLogic Data Hub');\n+    cy.fixture('users').then(user => {\n+      cy.login(user.username, user.password);\n+    })\n+    cy.wait(500);\n+    homePage.getModeling().click();\n+  });\n+\n+  it('can add an entity type', () => {\n+    modelingPage.addEntityType();\n+    modelingPage.newEntityName('New-Model');\n+    modelingPage.newEntityDescription('Description for New-Model');\n+    modelingPage.submitNewEntityForm();\n+    cy.wait(2000);\n+    modelingPage.getEntity('New-Model').should('exist');\n+  });\n+\n+  it('add entity input with invalid name', () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMwODUxNA==", "bodyText": "I agree with this, I removed the integration test scenarios for now.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r412308514", "createdAt": "2020-04-21T16:31:36Z", "author": {"login": "brucean52"}, "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/scenarios.modeling.tsx", "diffHunk": "@@ -0,0 +1,72 @@\n+/// <reference types=\"cypress\"/>\n+\n+import HomePage from \"../support/pages/home\";\n+import ModelingPage from '../support/pages/modeling';\n+\n+const homePage = new HomePage();\n+const modelingPage = new ModelingPage();\n+\n+describe('Entity Modeling Page', () => {\n+\n+  //login with valid account\n+  beforeEach(() => {\n+    cy.visit('/');\n+    cy.contains('MarkLogic Data Hub');\n+    cy.fixture('users').then(user => {\n+      cy.login(user.username, user.password);\n+    })\n+    cy.wait(500);\n+    homePage.getModeling().click();\n+  });\n+\n+  it('can add an entity type', () => {\n+    modelingPage.addEntityType();\n+    modelingPage.newEntityName('New-Model');\n+    modelingPage.newEntityDescription('Description for New-Model');\n+    modelingPage.submitNewEntityForm();\n+    cy.wait(2000);\n+    modelingPage.getEntity('New-Model').should('exist');\n+  });\n+\n+  it('add entity input with invalid name', () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU1ODY0NA=="}, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1Njg1NTIyOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzozMDoxMFrOGIfqNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNjozMzoyMFrOGJNZ5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MDUwMQ==", "bodyText": "I would also like us to avoid using data-testid heavily and use it as a last resort. We can instead use getByTitle, getByLabelText, getByPlaceholderText etc wherever possible.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r411560501", "createdAt": "2020-04-20T17:30:10Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "diffHunk": "@@ -0,0 +1,128 @@\n+import React, { useState, useEffect, useContext } from 'react';\n+import { Modal, Form, Input, Tooltip } from 'antd';\n+import { faQuestionCircle } from \"@fortawesome/free-solid-svg-icons\";\n+import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n+import styles from './entity-type-modal.module.scss'\n+\n+import { UserContext } from '../../../util/user-context';\n+import { createModel } from '../../../api/modeling';\n+import { ModelingTooltips } from '../../../config/tooltips.config';\n+\n+type Props = {\n+  isVisible: boolean;\n+  toggleModal: (isVisible: boolean) => void;\n+  newEntityAdded: () => void;\n+};\n+\n+const EntityTypeModal: React.FC<Props> = (props) => {\n+  const { handleError, resetSessionTime } = useContext(UserContext);\n+  // Must start with a letter & only letters, numbers, hyphens, and underscores are allowed\n+  const NAME_REGEX = new RegExp('^[A-Za-z][A-Za-z0-9_-]*$');\n+  const formItemLayout = {\n+    labelCol: { span: 4},\n+    wrapperCol: { span: 18 },\n+  };\n+\n+  const [name, setName] = useState('');\n+  const [isNameValid, toggleIsNameValid] = useState(true);\n+  const [description, setDescription] = useState('');\n+\n+  useEffect(() => {\n+    if (props.isVisible){\n+      setName('')\n+      setDescription('')\n+    }\n+  }, [props.isVisible]);\n+\n+  const handleChange = (event) => {\n+    if (event.target.id === 'name') {\n+      setName(event.target.value);\n+    }\n+    if (event.target.id === 'description') {\n+      setDescription(event.target.value);\n+    }\n+  }\n+\n+  const onOk = (event) => {\n+    event.preventDefault();\n+    if (NAME_REGEX.test(name)) {\n+      toggleIsNameValid(true);\n+      createEntityType(name, description);\n+    } else {\n+      toggleIsNameValid(false);\n+    }\n+  };\n+\n+  const createEntityType = async (entityName: string, description: string) => {\n+    try {\n+      const response = await createModel(entityName, description);\n+      if (response['data']) {\n+        props.newEntityAdded();\n+      }\n+    } catch (error) {\n+      handleError(error);\n+    } finally {\n+      resetSessionTime();\n+    }\n+  }\n+\n+  const onCancel = () => {\n+    props.toggleModal(false)\n+  };\n+\n+  return (\n+    <Modal\n+      visible={props.isVisible} \n+      closable={true}\n+      title={\"Add Entity Type\"} \n+      cancelText=\"Cancel\"\n+      onCancel={() => onCancel()} \n+      okText=\"Add\"\n+      onOk={onOk}\n+      okButtonProps={{form:'entity-type-form', htmlType: 'submit'}}\n+      maskClosable={false}\n+      data-testid=\"entity-type-modal\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMwOTk5MQ==", "bodyText": "I tried getByLabelText, but it didn't work with the Ant Design form. There is no placeholder for these inputs.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r412309991", "createdAt": "2020-04-21T16:33:20Z", "author": {"login": "brucean52"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "diffHunk": "@@ -0,0 +1,128 @@\n+import React, { useState, useEffect, useContext } from 'react';\n+import { Modal, Form, Input, Tooltip } from 'antd';\n+import { faQuestionCircle } from \"@fortawesome/free-solid-svg-icons\";\n+import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n+import styles from './entity-type-modal.module.scss'\n+\n+import { UserContext } from '../../../util/user-context';\n+import { createModel } from '../../../api/modeling';\n+import { ModelingTooltips } from '../../../config/tooltips.config';\n+\n+type Props = {\n+  isVisible: boolean;\n+  toggleModal: (isVisible: boolean) => void;\n+  newEntityAdded: () => void;\n+};\n+\n+const EntityTypeModal: React.FC<Props> = (props) => {\n+  const { handleError, resetSessionTime } = useContext(UserContext);\n+  // Must start with a letter & only letters, numbers, hyphens, and underscores are allowed\n+  const NAME_REGEX = new RegExp('^[A-Za-z][A-Za-z0-9_-]*$');\n+  const formItemLayout = {\n+    labelCol: { span: 4},\n+    wrapperCol: { span: 18 },\n+  };\n+\n+  const [name, setName] = useState('');\n+  const [isNameValid, toggleIsNameValid] = useState(true);\n+  const [description, setDescription] = useState('');\n+\n+  useEffect(() => {\n+    if (props.isVisible){\n+      setName('')\n+      setDescription('')\n+    }\n+  }, [props.isVisible]);\n+\n+  const handleChange = (event) => {\n+    if (event.target.id === 'name') {\n+      setName(event.target.value);\n+    }\n+    if (event.target.id === 'description') {\n+      setDescription(event.target.value);\n+    }\n+  }\n+\n+  const onOk = (event) => {\n+    event.preventDefault();\n+    if (NAME_REGEX.test(name)) {\n+      toggleIsNameValid(true);\n+      createEntityType(name, description);\n+    } else {\n+      toggleIsNameValid(false);\n+    }\n+  };\n+\n+  const createEntityType = async (entityName: string, description: string) => {\n+    try {\n+      const response = await createModel(entityName, description);\n+      if (response['data']) {\n+        props.newEntityAdded();\n+      }\n+    } catch (error) {\n+      handleError(error);\n+    } finally {\n+      resetSessionTime();\n+    }\n+  }\n+\n+  const onCancel = () => {\n+    props.toggleModal(false)\n+  };\n+\n+  return (\n+    <Modal\n+      visible={props.isVisible} \n+      closable={true}\n+      title={\"Add Entity Type\"} \n+      cancelText=\"Cancel\"\n+      onCancel={() => onCancel()} \n+      okText=\"Add\"\n+      onOk={onOk}\n+      okButtonProps={{form:'entity-type-form', htmlType: 'submit'}}\n+      maskClosable={false}\n+      data-testid=\"entity-type-modal\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MDUwMQ=="}, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 84}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1Njg1OTcyOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzozMToxOFrOGIfs7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzozMToxOFrOGIfs7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MTE5Ng==", "bodyText": "can replace with placeholderText similar to other input/select fields in the app.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r411561196", "createdAt": "2020-04-20T17:31:18Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "diffHunk": "@@ -0,0 +1,128 @@\n+import React, { useState, useEffect, useContext } from 'react';\n+import { Modal, Form, Input, Tooltip } from 'antd';\n+import { faQuestionCircle } from \"@fortawesome/free-solid-svg-icons\";\n+import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n+import styles from './entity-type-modal.module.scss'\n+\n+import { UserContext } from '../../../util/user-context';\n+import { createModel } from '../../../api/modeling';\n+import { ModelingTooltips } from '../../../config/tooltips.config';\n+\n+type Props = {\n+  isVisible: boolean;\n+  toggleModal: (isVisible: boolean) => void;\n+  newEntityAdded: () => void;\n+};\n+\n+const EntityTypeModal: React.FC<Props> = (props) => {\n+  const { handleError, resetSessionTime } = useContext(UserContext);\n+  // Must start with a letter & only letters, numbers, hyphens, and underscores are allowed\n+  const NAME_REGEX = new RegExp('^[A-Za-z][A-Za-z0-9_-]*$');\n+  const formItemLayout = {\n+    labelCol: { span: 4},\n+    wrapperCol: { span: 18 },\n+  };\n+\n+  const [name, setName] = useState('');\n+  const [isNameValid, toggleIsNameValid] = useState(true);\n+  const [description, setDescription] = useState('');\n+\n+  useEffect(() => {\n+    if (props.isVisible){\n+      setName('')\n+      setDescription('')\n+    }\n+  }, [props.isVisible]);\n+\n+  const handleChange = (event) => {\n+    if (event.target.id === 'name') {\n+      setName(event.target.value);\n+    }\n+    if (event.target.id === 'description') {\n+      setDescription(event.target.value);\n+    }\n+  }\n+\n+  const onOk = (event) => {\n+    event.preventDefault();\n+    if (NAME_REGEX.test(name)) {\n+      toggleIsNameValid(true);\n+      createEntityType(name, description);\n+    } else {\n+      toggleIsNameValid(false);\n+    }\n+  };\n+\n+  const createEntityType = async (entityName: string, description: string) => {\n+    try {\n+      const response = await createModel(entityName, description);\n+      if (response['data']) {\n+        props.newEntityAdded();\n+      }\n+    } catch (error) {\n+      handleError(error);\n+    } finally {\n+      resetSessionTime();\n+    }\n+  }\n+\n+  const onCancel = () => {\n+    props.toggleModal(false)\n+  };\n+\n+  return (\n+    <Modal\n+      visible={props.isVisible} \n+      closable={true}\n+      title={\"Add Entity Type\"} \n+      cancelText=\"Cancel\"\n+      onCancel={() => onCancel()} \n+      okText=\"Add\"\n+      onOk={onOk}\n+      okButtonProps={{form:'entity-type-form', htmlType: 'submit'}}\n+      maskClosable={false}\n+      data-testid=\"entity-type-modal\"\n+    >\n+      <Form {...formItemLayout}\n+        id='entity-type-form'\n+        onSubmit={onOk} \n+      >\n+        <Form.Item \n+          label='Name'\n+          required\n+          hasFeedback\n+          validateStatus={isNameValid ? '' : 'error'}\n+          help={isNameValid ? '' : ModelingTooltips.addEntityName}\n+        >\n+          <Input\n+            id=\"name\"\n+            data-testid=\"name\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 99}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1Njg2MTU5OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzozMTo0NlrOGIfuFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzozMTo0NlrOGIfuFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MTQ5NQ==", "bodyText": "Same as before. Can replace with placeholderText", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r411561495", "createdAt": "2020-04-20T17:31:46Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.tsx", "diffHunk": "@@ -0,0 +1,128 @@\n+import React, { useState, useEffect, useContext } from 'react';\n+import { Modal, Form, Input, Tooltip } from 'antd';\n+import { faQuestionCircle } from \"@fortawesome/free-solid-svg-icons\";\n+import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n+import styles from './entity-type-modal.module.scss'\n+\n+import { UserContext } from '../../../util/user-context';\n+import { createModel } from '../../../api/modeling';\n+import { ModelingTooltips } from '../../../config/tooltips.config';\n+\n+type Props = {\n+  isVisible: boolean;\n+  toggleModal: (isVisible: boolean) => void;\n+  newEntityAdded: () => void;\n+};\n+\n+const EntityTypeModal: React.FC<Props> = (props) => {\n+  const { handleError, resetSessionTime } = useContext(UserContext);\n+  // Must start with a letter & only letters, numbers, hyphens, and underscores are allowed\n+  const NAME_REGEX = new RegExp('^[A-Za-z][A-Za-z0-9_-]*$');\n+  const formItemLayout = {\n+    labelCol: { span: 4},\n+    wrapperCol: { span: 18 },\n+  };\n+\n+  const [name, setName] = useState('');\n+  const [isNameValid, toggleIsNameValid] = useState(true);\n+  const [description, setDescription] = useState('');\n+\n+  useEffect(() => {\n+    if (props.isVisible){\n+      setName('')\n+      setDescription('')\n+    }\n+  }, [props.isVisible]);\n+\n+  const handleChange = (event) => {\n+    if (event.target.id === 'name') {\n+      setName(event.target.value);\n+    }\n+    if (event.target.id === 'description') {\n+      setDescription(event.target.value);\n+    }\n+  }\n+\n+  const onOk = (event) => {\n+    event.preventDefault();\n+    if (NAME_REGEX.test(name)) {\n+      toggleIsNameValid(true);\n+      createEntityType(name, description);\n+    } else {\n+      toggleIsNameValid(false);\n+    }\n+  };\n+\n+  const createEntityType = async (entityName: string, description: string) => {\n+    try {\n+      const response = await createModel(entityName, description);\n+      if (response['data']) {\n+        props.newEntityAdded();\n+      }\n+    } catch (error) {\n+      handleError(error);\n+    } finally {\n+      resetSessionTime();\n+    }\n+  }\n+\n+  const onCancel = () => {\n+    props.toggleModal(false)\n+  };\n+\n+  return (\n+    <Modal\n+      visible={props.isVisible} \n+      closable={true}\n+      title={\"Add Entity Type\"} \n+      cancelText=\"Cancel\"\n+      onCancel={() => onCancel()} \n+      okText=\"Add\"\n+      onOk={onOk}\n+      okButtonProps={{form:'entity-type-form', htmlType: 'submit'}}\n+      maskClosable={false}\n+      data-testid=\"entity-type-modal\"\n+    >\n+      <Form {...formItemLayout}\n+        id='entity-type-form'\n+        onSubmit={onOk} \n+      >\n+        <Form.Item \n+          label='Name'\n+          required\n+          hasFeedback\n+          validateStatus={isNameValid ? '' : 'error'}\n+          help={isNameValid ? '' : ModelingTooltips.addEntityName}\n+        >\n+          <Input\n+            id=\"name\"\n+            data-testid=\"name\"\n+            className={styles.input}\n+            value={name}\n+            onChange={handleChange}\n+            onBlur={handleChange}\n+          />\n+          <Tooltip title={ModelingTooltips.addEntityName}>\n+            <FontAwesomeIcon className={styles.icon}  icon={faQuestionCircle} />\n+          </Tooltip> \n+        </Form.Item>\n+\n+        <Form.Item label=\"Description\">\n+          <Input\n+            id=\"description\"\n+            data-testid=\"description\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 113}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1Njg3MjY3OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzozNDoyN1rOGIf0qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNjozNTo0N1rOGJNhGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MzE3OQ==", "bodyText": "Is \"Add\" button disabled in the absence of required field? Can add asserttion for that.\nCan add a test to verify form error to test Name is a required field.\nWill be good to include tests to update description(and edit entity) here, unless there is a separate story for that.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r411563179", "createdAt": "2020-04-20T17:34:27Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import React from 'react';\n+import { render } from '@testing-library/react';\n+import userEvent from \"@testing-library/user-event\";\n+import EntityTypeModal from './entity-type-modal';\n+\n+describe('EntityTypeModal Component', () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMxMTgzNQ==", "bodyText": "I've added disabling of the \"Add\" button and updated the tests. There is a separate story for editing", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r412311835", "createdAt": "2020-04-21T16:35:47Z", "author": {"login": "brucean52"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.test.tsx", "diffHunk": "@@ -0,0 +1,69 @@\n+import React from 'react';\n+import { render } from '@testing-library/react';\n+import userEvent from \"@testing-library/user-event\";\n+import EntityTypeModal from './entity-type-modal';\n+\n+describe('EntityTypeModal Component', () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2MzE3OQ=="}, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1Njg5NzY4OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-table/entity-type-table.test.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzo0MDoyMVrOGIgDpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNzo0MDoyMVrOGIgDpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTU2NzAxNA==", "bodyText": "We can get rid of corresponding cypress integration test since we have this unit test in place, to reduce duplication and run time.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r411567014", "createdAt": "2020-04-20T17:40:21Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-table/entity-type-table.test.tsx", "diffHunk": "@@ -0,0 +1,43 @@\n+import React from 'react';\n+import { BrowserRouter as Router } from 'react-router-dom';\n+import { render } from '@testing-library/react';\n+import userEvent from \"@testing-library/user-event\";\n+import EntityTypeTable from './entity-type-table';\n+\n+import { getEntityTypes } from '../../../assets/mock-data/modeling';\n+\n+describe('EntityTypeModal Component', () => {\n+  test('Table renders with empty array prop', () => {\n+    const { getByText } =  render(\n+      <Router>\n+        <EntityTypeTable \n+          allEntityTypesData={[]}\n+        />\n+      </Router>);\n+\n+    expect(getByText(/No Data/i)).toBeInTheDocument();\n+  });\n+\n+    test('Table renders with mock data', () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1NzI3Nzk1OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/scenarios.modeling.tsx", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxOToxMzoyNVrOGIjmnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxOToxMzoyNVrOGIjmnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTYyNTExOQ==", "bodyText": "We also shouldnt login via GUI for every test. Lets use cy.request('POST', '/login', {\nusername,\npassword\n}) instead to build up state without using browser\u2019s UI", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r411625119", "createdAt": "2020-04-20T19:13:25Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/scenarios.modeling.tsx", "diffHunk": "@@ -0,0 +1,72 @@\n+/// <reference types=\"cypress\"/>\n+\n+import HomePage from \"../support/pages/home\";\n+import ModelingPage from '../support/pages/modeling';\n+\n+const homePage = new HomePage();\n+const modelingPage = new ModelingPage();\n+\n+describe('Entity Modeling Page', () => {\n+\n+  //login with valid account\n+  beforeEach(() => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "56d54d43b6d87c09531ab4658da6180f1bb6f71c"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzA3MjA4OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNzoyMTowN1rOGKzbqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QyMTowODo0M1rOGK8NMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4MTYwOQ==", "bodyText": "Test is missing assertion for invalid entry.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r413981609", "createdAt": "2020-04-23T17:21:07Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.test.tsx", "diffHunk": "@@ -0,0 +1,68 @@\n+import React from 'react';\n+import { render } from '@testing-library/react';\n+import userEvent from \"@testing-library/user-event\";\n+import EntityTypeModal from './entity-type-modal';\n+\n+describe('EntityTypeModal Component', () => {\n+  test('Modal is not visible', () => {\n+    const { queryByTestId } =  render(\n+    <EntityTypeModal \n+      isVisible={false} \n+      toggleModal={jest.fn()}\n+      newEntityAdded={jest.fn()}\n+    />);\n+\n+    expect(queryByTestId('entity-type-modal')).toBeNull();\n+  });\n+\n+  test('Valid Entity name is used', async () => {\n+    const { getByTestId, getByText } =  render(\n+      <EntityTypeModal \n+        isVisible={true} \n+        toggleModal={jest.fn()}\n+        newEntityAdded={jest.fn()}\n+      />);\n+    expect(getByText(/Add Entity Type/i)).toBeInTheDocument();\n+\n+    await userEvent.type(getByTestId('name'), 'AnotherModel');\n+    expect(getByTestId('name')).toHaveAttribute('value', 'AnotherModel');\n+\n+    await userEvent.type(getByTestId('description'), 'Testing');\n+    expect(getByTestId('description')).toHaveAttribute('value', 'Testing');\n+\n+    userEvent.click(getByText('Add'));\n+  });\n+\n+  test('Invalid Entity name shows error', async () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5d7ab74582293710722e12c6531a95c53dfda3b"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDEyNTM2MA==", "bodyText": "I've updated the test and design to disable the button if the name isn't valid. I've added an additional test that mocks 400 error response for duplicate entity names", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r414125360", "createdAt": "2020-04-23T21:08:43Z", "author": {"login": "brucean52"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.test.tsx", "diffHunk": "@@ -0,0 +1,68 @@\n+import React from 'react';\n+import { render } from '@testing-library/react';\n+import userEvent from \"@testing-library/user-event\";\n+import EntityTypeModal from './entity-type-modal';\n+\n+describe('EntityTypeModal Component', () => {\n+  test('Modal is not visible', () => {\n+    const { queryByTestId } =  render(\n+    <EntityTypeModal \n+      isVisible={false} \n+      toggleModal={jest.fn()}\n+      newEntityAdded={jest.fn()}\n+    />);\n+\n+    expect(queryByTestId('entity-type-modal')).toBeNull();\n+  });\n+\n+  test('Valid Entity name is used', async () => {\n+    const { getByTestId, getByText } =  render(\n+      <EntityTypeModal \n+        isVisible={true} \n+        toggleModal={jest.fn()}\n+        newEntityAdded={jest.fn()}\n+      />);\n+    expect(getByText(/Add Entity Type/i)).toBeInTheDocument();\n+\n+    await userEvent.type(getByTestId('name'), 'AnotherModel');\n+    expect(getByTestId('name')).toHaveAttribute('value', 'AnotherModel');\n+\n+    await userEvent.type(getByTestId('description'), 'Testing');\n+    expect(getByTestId('description')).toHaveAttribute('value', 'Testing');\n+\n+    userEvent.click(getByText('Add'));\n+  });\n+\n+  test('Invalid Entity name shows error', async () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4MTYwOQ=="}, "originalCommit": {"oid": "f5d7ab74582293710722e12c6531a95c53dfda3b"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MzEwNjQzOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNzoyODozNVrOGKzwVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QyMTowOTo0NFrOGK8PhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4NjkwMg==", "bodyText": "This is about data-testid again. We seem to be using \"Add Entity Type\" text for assertion elsewhere. Since that works we can probably get rid of this data-testid? I will leave it up to you @brucean52.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r413986902", "createdAt": "2020-04-23T17:28:35Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.test.tsx", "diffHunk": "@@ -0,0 +1,68 @@\n+import React from 'react';\n+import { render } from '@testing-library/react';\n+import userEvent from \"@testing-library/user-event\";\n+import EntityTypeModal from './entity-type-modal';\n+\n+describe('EntityTypeModal Component', () => {\n+  test('Modal is not visible', () => {\n+    const { queryByTestId } =  render(\n+    <EntityTypeModal \n+      isVisible={false} \n+      toggleModal={jest.fn()}\n+      newEntityAdded={jest.fn()}\n+    />);\n+\n+    expect(queryByTestId('entity-type-modal')).toBeNull();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5d7ab74582293710722e12c6531a95c53dfda3b"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDEyNTk1Nw==", "bodyText": "I've removed this testid and I'm doing queryByText for Null checks", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3831#discussion_r414125957", "createdAt": "2020-04-23T21:09:44Z", "author": {"login": "brucean52"}, "path": "marklogic-data-hub-central/ui/src/components/modeling/entity-type-modal/entity-type-modal.test.tsx", "diffHunk": "@@ -0,0 +1,68 @@\n+import React from 'react';\n+import { render } from '@testing-library/react';\n+import userEvent from \"@testing-library/user-event\";\n+import EntityTypeModal from './entity-type-modal';\n+\n+describe('EntityTypeModal Component', () => {\n+  test('Modal is not visible', () => {\n+    const { queryByTestId } =  render(\n+    <EntityTypeModal \n+      isVisible={false} \n+      toggleModal={jest.fn()}\n+      newEntityAdded={jest.fn()}\n+    />);\n+\n+    expect(queryByTestId('entity-type-modal')).toBeNull();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzk4NjkwMg=="}, "originalCommit": {"oid": "f5d7ab74582293710722e12c6531a95c53dfda3b"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3412, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}