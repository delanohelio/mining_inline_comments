{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4Nzc1MTYx", "number": 3870, "title": "DHFPROD-4728: Adding roles and users to export entity instances", "bodyText": "Description\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-04-24T21:34:11Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3870", "merged": true, "mergeCommit": {"oid": "46bb34e568fb6fe3f682ae9fe9b59ce49e5116d8"}, "closed": true, "closedAt": "2020-04-27T15:25:57Z", "author": {"login": "rahulvudutala"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABca5pq4gFqTQwMDMxNDc3OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcboXoTgFqTQwMDYzNDA3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMzE0Nzc4", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3870#pullrequestreview-400314778", "createdAt": "2020-04-24T22:58:13Z", "commit": {"oid": "a4cc7e7356559322ca822e1acfcecbf44f6db07f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMjo1ODoxM1rOGLr9EA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQyMjo1ODoxM1rOGLr9EA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDkwNzY2NA==", "bodyText": "Can we test for this file?\ntestInit() in HubProjectTest already performs such a test.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3870#discussion_r414907664", "createdAt": "2020-04-24T22:58:13Z", "author": {"login": "akshaysonvane"}, "path": "marklogic-data-hub/src/main/java/com/marklogic/hub/impl/HubProjectImpl.java", "diffHunk": "@@ -371,6 +371,7 @@ public Path getCustomMappingFunctionsDir() {\n         writeRoleFile(rolesDir, \"data-hub-saved-query-reader.json\");\n         writeRoleFile(rolesDir, \"data-hub-saved-query-writer.json\");\n         writeRoleFile(rolesDir, \"hub-central-downloader.json\");\n+        writeRoleFile(rolesDir, \"hub-central-entity-exporter.json\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4cc7e7356559322ca822e1acfcecbf44f6db07f"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0608c7f7e66b4694c8e34ea41304f971207365a", "author": {"user": {"login": "rahulvudutala", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/e0608c7f7e66b4694c8e34ea41304f971207365a", "committedDate": "2020-04-25T00:03:20Z", "message": "DHFPROD-4728: Adding roles and users to export entity instances"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a4cc7e7356559322ca822e1acfcecbf44f6db07f", "author": {"user": {"login": "rahulvudutala", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/a4cc7e7356559322ca822e1acfcecbf44f6db07f", "committedDate": "2020-04-24T21:22:42Z", "message": "DHFPROD-4728: Adding roles and users to export entity instances"}, "afterCommit": {"oid": "e0608c7f7e66b4694c8e34ea41304f971207365a", "author": {"user": {"login": "rahulvudutala", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/e0608c7f7e66b4694c8e34ea41304f971207365a", "committedDate": "2020-04-25T00:03:20Z", "message": "DHFPROD-4728: Adding roles and users to export entity instances"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMzMxMjI3", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3870#pullrequestreview-400331227", "createdAt": "2020-04-25T00:07:26Z", "commit": {"oid": "e0608c7f7e66b4694c8e34ea41304f971207365a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNTk2MDUw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3870#pullrequestreview-400596050", "createdAt": "2020-04-27T02:48:41Z", "commit": {"oid": "e0608c7f7e66b4694c8e34ea41304f971207365a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwMjo0ODo0MVrOGMOfvg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QwMjo0ODo0MVrOGMOfvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQ3MzU5OA==", "bodyText": "The middle tier endpoint for exporting should then have @secured(\"canExportEntityInstances\") on it. You can use setTestUserRoles to verify that a user with and without the role can access the endpoint.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3870#discussion_r415473598", "createdAt": "2020-04-27T02:48:41Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/impl/security.sjs", "diffHunk": "@@ -43,6 +43,10 @@ class Security {\n       response.authorities.push('canManageSavedQuery');\n     }\n \n+    if (currentRoleNames.includes('hub-central-entity-exporter')) {\n+      response.authorities.push('canExportEntityInstances');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0608c7f7e66b4694c8e34ea41304f971207365a"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNjM0MDcx", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3870#pullrequestreview-400634071", "createdAt": "2020-04-27T05:24:03Z", "commit": {"oid": "e0608c7f7e66b4694c8e34ea41304f971207365a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3115, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}