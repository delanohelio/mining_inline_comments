{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1ODU4MzEx", "number": 4383, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxMjoxMzozN1rOEXLr0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxOTowMDowMlrOEXV7Bw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyNzQ0MTQ0OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/entities/search/getEntityInstance.sjs", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxMjoxMzozN1rOG-1B8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNTo0NDowOVrOG--Acw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODUzMzc0Nw==", "bodyText": "Are these functions really testing anything? Our current expectation of getEntityInstance is that it simply fetches the instance from the document, nothing more. So I don't think we need these tests, because we expect the instance to be returned as-is - we don't have any reason to think that the instance would be modified by getEntityInstance. If getEntityInstance were performing some logic on the instance, then we'd want tests, but that's not the case.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4383#discussion_r468533747", "createdAt": "2020-08-11T12:13:37Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/entities/search/getEntityInstance.sjs", "diffHunk": "@@ -160,14 +160,39 @@ function getInstanceFromTextDocument() {\n   ]\n }\n \n+function getInstanceFromMergedJsonDocument() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2ea1be25aa652df86cf57d27e8a707dcaecaa65c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY3MTQ0MQ==", "bodyText": "@rjrudin In getEntityInstance.sjs, we are validating if es:instance-json-from-document is returning the instance in various scenarios such as a mapped document with namespace, instance without info, instance with nonexistent modelName. Similarly, I added a test case for a merged document too.\nShould I remove this test case or this test file?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4383#discussion_r468671441", "createdAt": "2020-08-11T15:30:41Z", "author": {"login": "rahulvudutala"}, "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/entities/search/getEntityInstance.sjs", "diffHunk": "@@ -160,14 +160,39 @@ function getInstanceFromTextDocument() {\n   ]\n }\n \n+function getInstanceFromMergedJsonDocument() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODUzMzc0Nw=="}, "originalCommit": {"oid": "2ea1be25aa652df86cf57d27e8a707dcaecaa65c"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODY4MDgxOQ==", "bodyText": "I don't believe there's any difference in how the instance is obtained for a merged entity vs a non-merged entity - i.e. the instance is still at /:envelope/:instance. So I don't think a test is needed. We'd need one if a merged document instead had something like /:envelope/:merged/*:instance.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4383#discussion_r468680819", "createdAt": "2020-08-11T15:44:09Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/entities/search/getEntityInstance.sjs", "diffHunk": "@@ -160,14 +160,39 @@ function getInstanceFromTextDocument() {\n   ]\n }\n \n+function getInstanceFromMergedJsonDocument() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODUzMzc0Nw=="}, "originalCommit": {"oid": "2ea1be25aa652df86cf57d27e8a707dcaecaa65c"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyOTExODc5OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/entities/search/getEntityInstance.sjs", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxOTowMDowMlrOG_FRcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQyMToxODo0MVrOG_JmKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODc5OTg1Nw==", "bodyText": "@rahulvudutala  We still don't need this test :) - I was just raising a hypothetical. Though I'm curious - does es.instanceJsonFromDocument actually return the instance when \"es:instance\" is at any depth?\nI would normally say - there's no need to support \"/:envelope//es:instance\". But if es.instanceJsonFromDocument can handle that, then I suppose it's okay to include.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4383#discussion_r468799857", "createdAt": "2020-08-11T19:00:02Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/entities/search/getEntityInstance.sjs", "diffHunk": "@@ -160,14 +160,19 @@ function getInstanceFromTextDocument() {\n   ]\n }\n \n+function getInstanceWithInstanceInDifferentXpath() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0eee4ec6148ceb9b56e32453bbfdf99e498019f9"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODgyODE3Nw==", "bodyText": "@rjrudin es.instanceJsonFromDocument is returning the instance when \"es:instance\" is at any depth\nI tried on the document which has the path /es:envelope/es:merged/es:instance. The instance is returned (There is no  /es:envelope/es:instance in the document)", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4383#discussion_r468828177", "createdAt": "2020-08-11T19:54:52Z", "author": {"login": "rahulvudutala"}, "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/entities/search/getEntityInstance.sjs", "diffHunk": "@@ -160,14 +160,19 @@ function getInstanceFromTextDocument() {\n   ]\n }\n \n+function getInstanceWithInstanceInDifferentXpath() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODc5OTg1Nw=="}, "originalCommit": {"oid": "0eee4ec6148ceb9b56e32453bbfdf99e498019f9"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODg3MDY5Nw==", "bodyText": "Huh - well I guess that's good? Definitely surprising behavior, but I don't think there's a real downside to it.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4383#discussion_r468870697", "createdAt": "2020-08-11T21:18:41Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/ml-modules/root/test/suites/data-hub/5/entities/search/getEntityInstance.sjs", "diffHunk": "@@ -160,14 +160,19 @@ function getInstanceFromTextDocument() {\n   ]\n }\n \n+function getInstanceWithInstanceInDifferentXpath() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODc5OTg1Nw=="}, "originalCommit": {"oid": "0eee4ec6148ceb9b56e32453bbfdf99e498019f9"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3777, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}