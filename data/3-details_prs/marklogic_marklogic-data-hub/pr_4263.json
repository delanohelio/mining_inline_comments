{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NDA1NTE3", "number": 4263, "title": "DHFPROD-5362: Add Entity button disabled if duplicate name is used fix", "bodyText": "Description\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-07-22T23:30:00Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4263", "merged": true, "mergeCommit": {"oid": "4e65cc351ee9e5e5930e2700c94a9b90458205f3"}, "closed": true, "closedAt": "2020-07-25T17:08:10Z", "author": {"login": "brucean52"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3jZwyAH2gAyNDU1NDA1NTE3OjcxNzY2ZmYwNzU5ZGU1YTE4ZDRmMzA3MDYzYjM5ODcwMzAyMGNiZjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc4HFBsAFqTQ1NTA0NTUxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "71766ff0759de5a18d4f307063b398703020cbf1", "author": {"user": null}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/71766ff0759de5a18d4f307063b398703020cbf1", "committedDate": "2020-07-22T23:26:44Z", "message": "DHFPROD-5362: Add Entity disabled if duplicate  fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MDI1MzQx", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4263#pullrequestreview-455025341", "createdAt": "2020-07-24T16:30:07Z", "commit": {"oid": "71766ff0759de5a18d4f307063b398703020cbf1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MDQ0ODcw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4263#pullrequestreview-455044870", "createdAt": "2020-07-24T16:59:47Z", "commit": {"oid": "71766ff0759de5a18d4f307063b398703020cbf1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxNjo1OTo0N1rOG228oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxNjo1OTo0N1rOG228oQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDE3NjU0NQ==", "bodyText": "I would prefer to update existing unit test 'Creating duplicate entity shows error message' to verify Add button is enabled, than verifying this in e2e. This is ok now and something to keep in mind for future tests.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4263#discussion_r460176545", "createdAt": "2020-07-24T16:59:47Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/e2e/cypress/integration/modeling/scenarios.modeling.tsx", "diffHunk": "@@ -89,30 +89,47 @@ describe('Entity Modeling', () => {\n \n     propertyTable.editProperty('fname');\n     cy.waitUntil(() => propertyModal.getToggleStepsButton().should('exist')).click();\n-    cy.contains('mapPersonJSON');\n-    cy.contains('match-person');\n-    cy.contains('merge-person');\n-    cy.contains('master-person');\n-    cy.contains('Hide Steps...');\n+    cy.contains('mapPersonJSON').should('be.visible');\n+    cy.contains('match-person').should('be.visible');\n+    cy.contains('merge-person').should('be.visible');\n+    cy.contains('master-person').should('be.visible');\n+    cy.contains('Hide Steps...').should('be.visible');\n+\n+    cy.contains('Show Steps...').should('not.be.visible');\n+\n     propertyModal.getToggleStepsButton().click();\n-    cy.contains('Show Steps...');\n+\n+    cy.contains('Show Steps...').should('be.visible');\n+\n+    cy.contains('mapPersonJSON').should('not.be.visible');\n+    cy.contains('match-person').should('not.be.visible');\n+    cy.contains('merge-person').should('not.be.visible');\n+    cy.contains('master-person').should('not.be.visible');\n+    cy.contains('Hide Steps...').should('not.be.visible');\n     propertyModal.getCancelButton().click();\n \n     entityTypeTable.getDeleteEntityIcon('Person').click();\n-    cy.contains('Entity type is used in one or more steps.');\n-    cy.contains('Show Steps...');\n+    cy.contains('Entity type is used in one or more steps.').should('be.visible');\n+    cy.contains('Show Steps...').should('be.visible');\n+    cy.contains('Hide Steps...').should('not.be.visible');\n \n     confirmationModal.getToggleStepsButton().click();\n-    cy.contains('mapPersonJSON');\n-    cy.contains('Hide Steps...');\n+    cy.contains('mapPersonJSON').should('be.visible');\n+    cy.contains('Hide Steps...').should('be.visible');\n+    cy.contains('Show Steps...').should('not.be.visible');\n \n     confirmationModal.getCloseButton(ConfirmationType.DeleteEntityStepWarn).click();\n     entityTypeTable.getEntity('Person').should('exist');\n   });\n \n-  it('can create a new entity, add relationship type, and add identifier confirmation, delete property from modal, and delete entity', () => {\n-    modelPage.getAddEntityButton().should('exist');\n-    modelPage.getAddEntityButton().click();\n+  it('can check for duplicate entity, create a new entity, add relationship type, and add identifier confirmation, delete property from modal, and delete entity', () => {\n+    cy.waitUntil(() => modelPage.getAddEntityButton()).click();\n+    entityTypeModal.newEntityName('Person');\n+    entityTypeModal.getAddButton().click();\n+    cy.contains('An entity type already exists with a name of Person').should('be.visible');\n+    entityTypeModal.getAddButton().should('not.be.disabled');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71766ff0759de5a18d4f307063b398703020cbf1"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MDQ1NTE2", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4263#pullrequestreview-455045516", "createdAt": "2020-07-24T17:00:40Z", "commit": {"oid": "71766ff0759de5a18d4f307063b398703020cbf1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2437, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}