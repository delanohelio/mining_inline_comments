{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5MjA2NjQ3", "number": 4425, "title": "DHFPROD-5372: Handle strings and null values correctly in mapping source", "bodyText": "Updates to source value display in mapping:\n\nStrings surrounded with double quotes\nProperties equal to null or \"\" are displayed in source table\nProperties equal to null or \"\" are displayed correctly in source dropdown in entity table\n\nMore details in the Jira ticket: https://project.marklogic.com/jira/browse/DHFPROD-5372\nDescription\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-08-18T05:12:18Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425", "merged": true, "mergeCommit": {"oid": "d65b0acbe6f3e1e67f4202b0e9ac16b6fae25a72"}, "closed": true, "closedAt": "2020-08-19T02:06:52Z", "author": {"login": "wooldridge"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAFZVdAFqTQ2OTI3ODUyNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAQGbKAFqTQ2OTkwODE5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5Mjc4NTI2", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#pullrequestreview-469278526", "createdAt": "2020-08-18T11:33:56Z", "commit": {"oid": "a9de1b1b64346ae83712275e94818ba444baee9f"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMTozMzo1NlrOHCPTmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMTozMzo1NlrOHCPTmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjEwOTk3OA==", "bodyText": "This is fine, but the backend should really provide all of this data - for 5.4, we've gotta do a better job of shifting more of the burden to the backend so that life is as easy as possible for the UI.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#discussion_r472109978", "createdAt": "2020-08-18T11:33:56Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/mapping-card.tsx", "diffHunk": "@@ -203,8 +203,10 @@ const MappingCard: React.FC<Props> = (props) => {\n                 let parsedDoc: any;\n                 if(typeof(srcDocResp.data) === 'string'){\n                     parsedDoc = getParsedXMLDoc(srcDocResp);\n+                    setSourceFormat('xml');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9de1b1b64346ae83712275e94818ba444baee9f"}, "originalPosition": 29}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTg3MzQ5", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#pullrequestreview-469587349", "createdAt": "2020-08-18T15:46:07Z", "commit": {"oid": "a9de1b1b64346ae83712275e94818ba444baee9f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNTo0NjowOFrOHCav0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNTo0NjowOFrOHCav0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI5NzQyNg==", "bodyText": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#discussion_r472297426", "createdAt": "2020-08-18T15:46:08Z", "author": {"login": "jmakeig"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/mapping-card.tsx", "diffHunk": "@@ -368,7 +378,7 @@ const MappingCard: React.FC<Props> = (props) => {\n                     if(parentNamespace !== tempNS){\n                         parentNamespace = tempNS;\n                     }\n-                } else if (val.constructor.name === \"Array\") {\n+                } else if (val && val.constructor && val.constructor.name === \"Array\") {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9de1b1b64346ae83712275e94818ba444baee9f"}, "originalPosition": 100}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTg4NjMz", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#pullrequestreview-469588633", "createdAt": "2020-08-18T15:47:33Z", "commit": {"oid": "a9de1b1b64346ae83712275e94818ba444baee9f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNTo0NzozNFrOHCazww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNTo0NzozNFrOHCazww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI5ODQzNQ==", "bodyText": "\ud83d\udc4d\ud83c\udffd", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#discussion_r472298435", "createdAt": "2020-08-18T15:47:34Z", "author": {"login": "jmakeig"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.scss", "diffHunk": "@@ -7,3 +7,14 @@\n .ant-table-filter-icon.ant-dropdown-trigger.ant-table-filter-selected{\n     background: #394494; \n }\n+\n+.datatype-string::before {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9de1b1b64346ae83712275e94818ba444baee9f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NjQ0NTM5", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#pullrequestreview-469644539", "createdAt": "2020-08-18T16:52:23Z", "commit": {"oid": "a9de1b1b64346ae83712275e94818ba444baee9f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjo1MjoyM1rOHCdX9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjo1MjoyM1rOHCdX9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM0MDQ3MQ==", "bodyText": "@wooldridge can we pls also add a test for white space here.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#discussion_r472340471", "createdAt": "2020-08-18T16:52:23Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "diffHunk": "@@ -29,14 +29,25 @@ describe('RTL Source-to-entity map tests', () => {\n     });\n \n     test('RTL tests with source data',  () => {\n-        const { getByTestId,  getByText, queryByText, rerender} = render(<SourceToEntityMap {...data.mapProps} mappingVisible={true}/>);\n+        const { getByTestId,  getByText, queryByText, rerender } = render(<SourceToEntityMap {...data.mapProps} mappingVisible={true}/>);\n         expect(getByText('Source Data')).toBeInTheDocument();\n         expect(getByText('proteinId')).toBeInTheDocument();\n+        expect(getByText('emptyString')).toBeInTheDocument();\n+        expect(getByText('nullValue')).toBeInTheDocument();\n+        expect(getByText('numberValue')).toBeInTheDocument();\n+        expect(getByText('booleanValue')).toBeInTheDocument();\n         expect(getByTestId(\"entityContainer\")).toBeInTheDocument();\n         expect(getByTestId(\"srcContainer\")).toBeInTheDocument();\n         expect(getByTestId(\"srcContainer\")).toHaveClass(\"sourceContainer\");\n         expect(getByText('Entity: Person')).toBeInTheDocument();\n         expect(getByText('Test')).toBeEnabled();\n+\n+        // Check datatype class names for source values\n+        expect(getByTestId(\"emptyString-srcValue\").children[0].className.includes('datatype-string')).toBe(true);\n+        expect(getByTestId(\"nullValue-srcValue\").children[0].className.includes('datatype-null')).toBe(true);\n+        expect(getByTestId(\"numberValue-srcValue\").children[0].className.includes('datatype-number')).toBe(true);\n+        expect(getByTestId(\"booleanValue-srcValue\").children[0].className.includes('datatype-boolean')).toBe(true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9de1b1b64346ae83712275e94818ba444baee9f"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac1c1b061ebbba3632a9ef4c0233ba96c6fdba1b", "author": {"user": {"login": "wooldridge", "name": "Mike Wooldridge"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/ac1c1b061ebbba3632a9ef4c0233ba96c6fdba1b", "committedDate": "2020-08-18T18:43:10Z", "message": "DHFPROD-5372: Handle strings and null values correctly in mapping source\n\n- Strings surrounded with double quotes\n- Properties equal to null or \"\" are displayed in source table\n- Properties equal to null or \"\" are displayed correctly in source dropdown in entity table"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9de1b1b64346ae83712275e94818ba444baee9f", "author": {"user": {"login": "wooldridge", "name": "Mike Wooldridge"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/a9de1b1b64346ae83712275e94818ba444baee9f", "committedDate": "2020-08-18T05:07:12Z", "message": "DHFPROD-5372: Handle strings and null values correctly in mapping source\n\n- Strings surrounded with double quotes\n- Properties equal to null or \"\" are displayed in source table\n- Properties equal to null or \"\" are displayed correctly in source dropdown in entity table"}, "afterCommit": {"oid": "ac1c1b061ebbba3632a9ef4c0233ba96c6fdba1b", "author": {"user": {"login": "wooldridge", "name": "Mike Wooldridge"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/ac1c1b061ebbba3632a9ef4c0233ba96c6fdba1b", "committedDate": "2020-08-18T18:43:10Z", "message": "DHFPROD-5372: Handle strings and null values correctly in mapping source\n\n- Strings surrounded with double quotes\n- Properties equal to null or \"\" are displayed in source table\n- Properties equal to null or \"\" are displayed correctly in source dropdown in entity table"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NzkyODQy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#pullrequestreview-469792842", "createdAt": "2020-08-18T20:06:23Z", "commit": {"oid": "ac1c1b061ebbba3632a9ef4c0233ba96c6fdba1b"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5ODE3OTc4", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#pullrequestreview-469817978", "createdAt": "2020-08-18T20:45:59Z", "commit": {"oid": "ac1c1b061ebbba3632a9ef4c0233ba96c6fdba1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5OTA4MTk0", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4425#pullrequestreview-469908194", "createdAt": "2020-08-19T00:02:44Z", "commit": {"oid": "ac1c1b061ebbba3632a9ef4c0233ba96c6fdba1b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2354, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}