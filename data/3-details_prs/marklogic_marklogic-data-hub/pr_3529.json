{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5MjE5MDUx", "number": 3529, "title": "DHFPROD-4105: Add API for linking/removing artifacts from steps", "bodyText": "", "createdAt": "2020-01-30T18:21:12Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3529", "merged": true, "mergeCommit": {"oid": "64e849d2adf788e3d92dbaba20a01550806e14d5"}, "closed": true, "closedAt": "2020-01-31T23:13:08Z", "author": {"login": "ryanjdew"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb_iN51gFqTM1MTE1NjI4Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_12OIgFqTM1MTc4MjQ4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxMTU2Mjgy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3529#pullrequestreview-351156282", "createdAt": "2020-01-30T21:32:19Z", "commit": {"oid": "03bca674dabaf585e28e4d78f45d237fe8d01d15"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQyMTozMjoxOVrOFj6meQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQyMjoyMjoyMFrOFj75zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzIwNDYwMQ==", "bodyText": "I think it's easier just to rethrow this or declare throws Exception on the method.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3529#discussion_r373204601", "createdAt": "2020-01-30T21:32:19Z", "author": {"login": "rjrudin"}, "path": "one-ui/src/test/java/com/marklogic/hub/curation/controllers/FlowControllerTest.java", "diffHunk": "@@ -135,6 +160,9 @@ void getFlow() throws JsonProcessingException {\n             catch (Exception e){\n                 logger.info(\"Exception is expected as the step being fetched has been deleted\");\n             }\n+        } catch (Exception e) {\n+            e.printStackTrace();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03bca674dabaf585e28e4d78f45d237fe8d01d15"}, "originalPosition": 96}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzIwNjExMQ==", "bodyText": "This seems a little awkward for a URL. I can see flowName/steps/stepId/link, as the link of a step is an actual thing that's referenceable. But I think the artifact properties should go into the RequestBody, which can be declared as a JsonNode - or by using ArtifactTypeInfo possibly?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3529#discussion_r373206111", "createdAt": "2020-01-30T21:36:00Z", "author": {"login": "rjrudin"}, "path": "one-ui/src/main/java/com/marklogic/hub/curation/controllers/FlowController.java", "diffHunk": "@@ -102,4 +108,38 @@\n         return new ResponseEntity<>(HttpStatus.OK);\n     }\n \n+    @RequestMapping(value = \"/{flowName}/steps/{stepId}/link/{artifactType}/{artifactName}\", method = RequestMethod.POST)\n+    @ResponseBody\n+    public ResponseEntity<?> linkArtifact(@PathVariable String flowName, @PathVariable String stepId, @PathVariable String artifactType, @PathVariable String artifactName) {\n+        return linkArtifact(flowName, stepId, artifactType, artifactName, null);\n+    }\n+\n+    @RequestMapping(value = \"/{flowName}/steps/{stepId}/link/{artifactType}/{artifactName}/{artifactVersion}\", method = RequestMethod.POST)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03bca674dabaf585e28e4d78f45d237fe8d01d15"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzIyNTkzNA==", "bodyText": "I may have missed it, but this seems like an ideal candidate for some nice unit tests to verify that it's doing its thing correctly, as opposed to trying to verify this in the context of a complex integration test.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3529#discussion_r373225934", "createdAt": "2020-01-30T22:22:20Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/impl/hub-utils.sjs", "diffHunk": "@@ -192,6 +209,22 @@ class HubUtils {\n     return permissions;\n   }\n \n+  // this function can be used to create xquery/xpath templates that are safe from injection attacks\n+  xquerySanitizer(strings, ...values) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03bca674dabaf585e28e4d78f45d237fe8d01d15"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8fac98fcd01ccd689b3b3d29519fe17ff285f50", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/c8fac98fcd01ccd689b3b3d29519fe17ff285f50", "committedDate": "2020-01-31T20:59:07Z", "message": "DHFPROD-4105: Add API for linking/removing artifacts from steps"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03bca674dabaf585e28e4d78f45d237fe8d01d15", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/03bca674dabaf585e28e4d78f45d237fe8d01d15", "committedDate": "2020-01-30T18:20:09Z", "message": "DHFPROD-4105: Add API for linking/removing artifacts from steps"}, "afterCommit": {"oid": "c8fac98fcd01ccd689b3b3d29519fe17ff285f50", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/c8fac98fcd01ccd689b3b3d29519fe17ff285f50", "committedDate": "2020-01-31T20:59:07Z", "message": "DHFPROD-4105: Add API for linking/removing artifacts from steps"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzUxNzgyNDgw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3529#pullrequestreview-351782480", "createdAt": "2020-01-31T21:16:21Z", "commit": {"oid": "c8fac98fcd01ccd689b3b3d29519fe17ff285f50"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2397, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}