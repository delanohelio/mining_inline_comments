{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5ODc2MDQ0", "number": 5002, "title": "DHFPROD-6359: Fix ML9 cluster regression in MasterTest", "bodyText": "Description\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Code passes ESLint tests\n\n\nN/A Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-12-14T23:51:55Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/5002", "merged": true, "mergeCommit": {"oid": "3a6c2b758dea881544c25cb75316b4197e25f324"}, "closed": true, "closedAt": "2020-12-15T18:00:22Z", "author": {"login": "ryanjdew"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmOlbzgH2gAyNTM5ODc2MDQ0OjE2ZjIwZWFkNTUyZmUwYWZiOGFhNDE4ZGZlNWFlMTk1MDViMWRjY2E=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmeBKpgFqTU1MjcxMTk2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "16f20ead552fe0afb8aa418dfe5ae19505b1dcca", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/16f20ead552fe0afb8aa418dfe5ae19505b1dcca", "committedDate": "2020-12-14T23:45:55Z", "message": "DHFPROD-6359: Fix ML9 cluster regression in MasterTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMTY1ODEy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/5002#pullrequestreview-552165812", "createdAt": "2020-12-15T07:23:43Z", "commit": {"oid": "16f20ead552fe0afb8aa418dfe5ae19505b1dcca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNDUwNjI2", "url": "https://github.com/marklogic/marklogic-data-hub/pull/5002#pullrequestreview-552450626", "createdAt": "2020-12-15T13:32:00Z", "commit": {"oid": "16f20ead552fe0afb8aa418dfe5ae19505b1dcca"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMzozMjowMVrOIGLBXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQxMzozMjowMVrOIGLBXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzM0Mjk0MA==", "bodyText": "Is this removed because it was not having any impact? I looked at the surrounding code - since \"$key\" comes from map:keys($all-matches), it looks like this would never resolve to true and thus never call lock-for-update - right?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/5002#discussion_r543342940", "createdAt": "2020-12-15T13:32:01Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/com.marklogic.smart-mastering/impl/process.xqy", "diffHunk": "@@ -325,7 +325,6 @@ declare function proc-impl:consolidate-notifies($all-matches as map:map, $merged\n     let $updated-notification-uris :=\n       for $key-notification in $key-notifications[@threshold = $key-threshold]\n       let $key-uri as xs:string := $key-notification/@uri\n-      let $_lock-on-uri := if (fn:not(map:contains($all-matches, $key))) then merge-impl:lock-for-update($key-uri) else ()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16f20ead552fe0afb8aa418dfe5ae19505b1dcca"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNzExOTYy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/5002#pullrequestreview-552711962", "createdAt": "2020-12-15T17:44:47Z", "commit": {"oid": "16f20ead552fe0afb8aa418dfe5ae19505b1dcca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1578, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}