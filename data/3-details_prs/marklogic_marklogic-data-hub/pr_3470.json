{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzMzg5NDMz", "number": 3470, "title": "DHFPROD-3764: Initial work for new curation UI", "bodyText": "", "createdAt": "2020-01-15T23:46:32Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470", "merged": true, "mergeCommit": {"oid": "28d5007f3d29200c6290a2a94a54dc721cbf6f1d"}, "closed": true, "closedAt": "2020-01-24T20:58:49Z", "author": {"login": "ryanjdew"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb6vBUfgFqTM0MzYwOTA3MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9kqeQgFqTM0ODE5NTgxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzNjA5MDcw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#pullrequestreview-343609070", "createdAt": "2020-01-16T00:26:36Z", "commit": {"oid": "b0f609e0e46b435b5d16edfe035368567fc70e84"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwMDoyNjozNlrOFeKqig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwMDoyODowN1rOFeKsAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3NjMzMA==", "bodyText": "I recommend adding a constructor instead", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#discussion_r367176330", "createdAt": "2020-01-16T00:26:36Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/java/com/marklogic/hub/deploy/commands/GenerateFunctionMetadataCommand.java", "diffHunk": "@@ -91,4 +91,9 @@ public void execute(CommandContext context) {\n             logger.warn(\"GenerateFunctionMetadataCommand is not supported on this MarkLogic server version \");\n         }\n     }\n+\n+    public void setHubConfig(HubConfig hubConfig) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0f609e0e46b435b5d16edfe035368567fc70e84"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3NjU5OA==", "bodyText": "I recommend using the constructor for each of these", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#discussion_r367176598", "createdAt": "2020-01-16T00:27:43Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/java/com/marklogic/hub/impl/DataHubImpl.java", "diffHunk": "@@ -895,10 +895,31 @@ protected void prepareProjectBeforeUpgrading(HubProject hubProject, String curre\n     // only used in test\n     public void setHubConfig(HubConfigImpl hubConfig) {\n         this.hubConfig = hubConfig;\n+        if (this.loadUserModulesCommand != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0f609e0e46b435b5d16edfe035368567fc70e84"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzE3NjcwNQ==", "bodyText": "I recommend just ditching this, it only complicates things. Just change each reference to hubConfig.getHubProject().", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#discussion_r367176705", "createdAt": "2020-01-16T00:28:07Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/java/com/marklogic/hub/impl/EntityManagerImpl.java", "diffHunk": "@@ -35,32 +35,44 @@\n import com.marklogic.hub.EntityManager;\n import com.marklogic.hub.HubConfig;\n import com.marklogic.hub.HubProject;\n-import com.marklogic.hub.entity.*;\n+import com.marklogic.hub.entity.DefinitionType;\n+import com.marklogic.hub.entity.DefinitionsType;\n+import com.marklogic.hub.entity.HubEntity;\n+import com.marklogic.hub.entity.InfoType;\n+import com.marklogic.hub.entity.ItemType;\n+import com.marklogic.hub.entity.PropertyType;\n import com.marklogic.hub.error.EntityServicesGenerationException;\n import com.marklogic.hub.util.HubModuleManager;\n import org.apache.commons.io.FileUtils;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.core.io.FileSystemResource;\n import org.springframework.core.io.Resource;\n import org.springframework.stereotype.Component;\n+import org.springframework.web.context.annotation.SessionScope;\n \n+import javax.annotation.PostConstruct;\n import java.io.File;\n import java.io.FileInputStream;\n import java.io.IOException;\n import java.nio.file.Path;\n import java.nio.file.Paths;\n-import java.util.*;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n import java.util.stream.Collectors;\n \n+@SessionScope\n @Component\n public class EntityManagerImpl extends LoggingObject implements EntityManager {\n     private static final String ENTITY_FILE_EXTENSION = \".entity.json\";\n \n     @Autowired\n     private HubConfig hubConfig;\n \n-    @Autowired\n-    private HubProject hubProject;\n+    private HubProject hubProject = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0f609e0e46b435b5d16edfe035368567fc70e84"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1NjMyNjE0", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#pullrequestreview-345632614", "createdAt": "2020-01-21T04:47:00Z", "commit": {"oid": "b0f609e0e46b435b5d16edfe035368567fc70e84"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQwNDo0NzowMFrOFfuXJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQwNDo0NzowMFrOFfuXJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODgwOTc2NA==", "bodyText": "EntityManagerImpl is the only implementation of EntityManager. Maybe we should add the setHubConfig as an new interface method instead of checking the instance type and do the cast...", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#discussion_r368809764", "createdAt": "2020-01-21T04:47:00Z", "author": {"login": "hao1st"}, "path": "marklogic-data-hub/src/main/java/com/marklogic/hub/deploy/commands/LoadUserModulesCommand.java", "diffHunk": "@@ -270,6 +270,12 @@ public FileVisitResult visitFile(Path file, BasicFileAttributes attrs) {\n \n     public void setHubConfig(HubConfig hubConfig) {\n         this.hubConfig = hubConfig;\n+        if (this.entityManager == null) {\n+            this.entityManager = new EntityManagerImpl();\n+        }\n+        if (this.entityManager instanceof EntityManagerImpl) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b0f609e0e46b435b5d16edfe035368567fc70e84"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5435f79e194b8f1cb9ee7ec819c6f8be1573c74d", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/5435f79e194b8f1cb9ee7ec819c6f8be1573c74d", "committedDate": "2020-01-21T22:09:48Z", "message": "DHFPROD-4104:Use DS to perform flow/step CRUD operations (#3476)"}, "afterCommit": {"oid": "6e8f852dfafb69e8d8919106c3d481ac9f74c092", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/6e8f852dfafb69e8d8919106c3d481ac9f74c092", "committedDate": "2020-01-21T22:15:36Z", "message": "DHFPROD-4166: Bring in latest changes from one-ui"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2NTM3NzIy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#pullrequestreview-346537722", "createdAt": "2020-01-22T12:04:40Z", "commit": {"oid": "6e8f852dfafb69e8d8919106c3d481ac9f74c092"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6e8f852dfafb69e8d8919106c3d481ac9f74c092", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/6e8f852dfafb69e8d8919106c3d481ac9f74c092", "committedDate": "2020-01-21T22:15:36Z", "message": "DHFPROD-4166: Bring in latest changes from one-ui"}, "afterCommit": {"oid": "0caab273d445ff8aefa2c62a37c40041cb6afdfa", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/0caab273d445ff8aefa2c62a37c40041cb6afdfa", "committedDate": "2020-01-22T18:37:02Z", "message": "DHFPROD-4166: Bring in latest changes from one-ui"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0cb257d105129e23b776d2374ead5f95c2483d00", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/0cb257d105129e23b776d2374ead5f95c2483d00", "committedDate": "2020-01-22T23:09:54Z", "message": "DHFPROD-3764: Fixing tests for Java update"}, "afterCommit": {"oid": "53c6fb2872598c7ef72c719288d8d4f9665abc1d", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/53c6fb2872598c7ef72c719288d8d4f9665abc1d", "committedDate": "2020-01-23T06:21:18Z", "message": "DHFPROD-3764: Fixing tests for Java update"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "53c6fb2872598c7ef72c719288d8d4f9665abc1d", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/53c6fb2872598c7ef72c719288d8d4f9665abc1d", "committedDate": "2020-01-23T06:21:18Z", "message": "DHFPROD-3764: Fixing tests for Java update"}, "afterCommit": {"oid": "29c8ee5bd699508ebedcdd833f4d5101f170c6ba", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/29c8ee5bd699508ebedcdd833f4d5101f170c6ba", "committedDate": "2020-01-23T20:41:54Z", "message": "DHFPROD-3764: Fixing tests for Java update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbad38f25217f9814f7ce4623ed83e72dae4d5f4", "author": {"user": {"login": "SameeraPriyathamTadikonda", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/cbad38f25217f9814f7ce4623ed83e72dae4d5f4", "committedDate": "2020-01-23T22:07:35Z", "message": "updating version to 5.3-snapshots"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bc1643f8a973fb2d323c6e701b20ce162a35718", "author": {"user": {"login": "SameeraPriyathamTadikonda", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/6bc1643f8a973fb2d323c6e701b20ce162a35718", "committedDate": "2020-01-23T22:07:35Z", "message": "updated task and version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7507428164f0dda52284c1497f62cc0d0f370c47", "author": {"user": {"login": "SameeraPriyathamTadikonda", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/7507428164f0dda52284c1497f62cc0d0f370c47", "committedDate": "2020-01-23T22:07:36Z", "message": "Updating target branch from develop to feature/5.3.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e00259db53eebda73f25b3f90076d4f4322b78db", "author": {"user": {"login": "SameeraPriyathamTadikonda", "name": null}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/e00259db53eebda73f25b3f90076d4f4322b78db", "committedDate": "2020-01-23T22:07:36Z", "message": "DHFPROD-4067:Updating to Java 11"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ3OTg4MTQ1", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#pullrequestreview-347988145", "createdAt": "2020-01-24T14:28:22Z", "commit": {"oid": "1fee0210f03926728718fc706237ede15fdc9da4"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTAxNTA0", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#pullrequestreview-348101504", "createdAt": "2020-01-24T17:15:31Z", "commit": {"oid": "1fee0210f03926728718fc706237ede15fdc9da4"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7feeea42c60e870dc92abf9205ff7f67da10323a", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/7feeea42c60e870dc92abf9205ff7f67da10323a", "committedDate": "2020-01-24T17:27:38Z", "message": "DHFPROD-3984: Add data services for artifacts (#3417)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5d8c5b7db241a9191d37236a516f2b9e394b214", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/b5d8c5b7db241a9191d37236a516f2b9e394b214", "committedDate": "2020-01-24T17:27:38Z", "message": "DHFPROD-3974: Changes for new UI install (#3450)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15b26f95b9477d7e6ae11a37980351595f2eac75", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/15b26f95b9477d7e6ae11a37980351595f2eac75", "committedDate": "2020-01-24T17:27:38Z", "message": "DHFPROD-4166: Move one-ui to marklogic data hub"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f56a4e12a0aa778c657f1329637abde6d29ad2b", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/9f56a4e12a0aa778c657f1329637abde6d29ad2b", "committedDate": "2020-01-24T17:27:38Z", "message": "DHFPROD-4104:Use DS to perform flow/step CRUD operations (#3476)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48eff90cd8d823db693f999add46f61597cf2450", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/48eff90cd8d823db693f999add46f61597cf2450", "committedDate": "2020-01-24T17:27:38Z", "message": "DHFPROD-4166: Bring in latest changes from one-ui"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c644d3fe3ec888eefc6de1c1657ae715d2f4648", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/1c644d3fe3ec888eefc6de1c1657ae715d2f4648", "committedDate": "2020-01-24T17:27:38Z", "message": "DHFPROD-3764: Fixing tests for Java update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTA5NTIy", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#pullrequestreview-348109522", "createdAt": "2020-01-24T17:29:53Z", "commit": {"oid": "1fee0210f03926728718fc706237ede15fdc9da4"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e582d063c8d2333be6d9b25cd46332efe8c4406", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/9e582d063c8d2333be6d9b25cd46332efe8c4406", "committedDate": "2020-01-24T18:03:05Z", "message": "DHFPROD-4166: Move one-ui to marklogic data hub"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dedb04dbdb3b0a406c048e798686cc70cd5599ac", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/dedb04dbdb3b0a406c048e798686cc70cd5599ac", "committedDate": "2020-01-24T18:22:13Z", "message": "DHFPROD-4166: Bring in latest changes from one-ui"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a23fd69cbf2bb19dbb7cad2c52d9d450fb5a195", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/4a23fd69cbf2bb19dbb7cad2c52d9d450fb5a195", "committedDate": "2020-01-24T18:22:13Z", "message": "DHFPROD-4104:Middle tier for flow/step CRUD"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60ba7b7535a24d94f3c6380e6e1c1c508b11e32e", "author": {"user": {"login": "ryanjdew", "name": "Ryan Dew"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/60ba7b7535a24d94f3c6380e6e1c1c508b11e32e", "committedDate": "2020-01-24T18:22:13Z", "message": "DHFPROD-4210: Allow for the deletion of a data set via API (#3494)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60ba7ed220f554fe2daad10f7e738979dadbeffa", "author": {"user": {"login": "wooldridge", "name": "Mike Wooldridge"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/60ba7ed220f554fe2daad10f7e738979dadbeffa", "committedDate": "2020-01-24T18:25:25Z", "message": "DHFPROD-3978: Add reset route\n\nA UI convenience as we develop login functionality, resets hostname setting on server."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc22b5aa6d322d07fdadc823261c30f317399948", "author": {"user": {"login": "wooldridge", "name": "Mike Wooldridge"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/bc22b5aa6d322d07fdadc823261c30f317399948", "committedDate": "2020-01-24T18:25:25Z", "message": "DHFPROD-4144: Add backup font faces for app name in header\n\nFirefox not recognizing 'HelveticaNeue-Light'."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1fee0210f03926728718fc706237ede15fdc9da4", "author": {"user": {"login": "wooldridge", "name": "Mike Wooldridge"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/1fee0210f03926728718fc706237ede15fdc9da4", "committedDate": "2020-01-24T07:26:15Z", "message": "Merge pull request #3496 from wooldridge/epic/DHFPROD-3764\n\nDHFPROD-3978: Misc UI updates"}, "afterCommit": {"oid": "bc22b5aa6d322d07fdadc823261c30f317399948", "author": {"user": {"login": "wooldridge", "name": "Mike Wooldridge"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/bc22b5aa6d322d07fdadc823261c30f317399948", "committedDate": "2020-01-24T18:25:25Z", "message": "DHFPROD-4144: Add backup font faces for app name in header\n\nFirefox not recognizing 'HelveticaNeue-Light'."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTg5NDgz", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#pullrequestreview-348189483", "createdAt": "2020-01-24T19:55:19Z", "commit": {"oid": "bc22b5aa6d322d07fdadc823261c30f317399948"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTk1ODE0", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3470#pullrequestreview-348195814", "createdAt": "2020-01-24T20:07:17Z", "commit": {"oid": "bc22b5aa6d322d07fdadc823261c30f317399948"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2350, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}