{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwMDAyMTc2", "number": 4440, "title": "DHFPROD-5735:Enable writing temporal documents", "bodyText": "Description\nEnable writing temporal documents\nChecklist:\n- Note: do not change the below\n\n\nOwner:\n\n\n JIRA_ID included in all the commit messages\n\n\n PR title is in the format JIRA_ID:Title\n\n\n Rebase the branch with upstream\n\n\n Squashed all commits into a single commit\n\n\n Added Tests\n\n\nReviewer:\n\n\n Reviewed Tests", "createdAt": "2020-08-19T08:22:26Z", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440", "merged": true, "mergeCommit": {"oid": "711008aebf77d0c33e1f5d11804359d346d506b8"}, "closed": true, "closedAt": "2020-08-20T17:18:24Z", "author": {"login": "srinathgit"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAXceKgBqjM2Njk2OTY4NTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAyqnPAFqTQ3MTc3ODE2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "720ef40f358698e8d923e59e2ae2848cda709e56", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/720ef40f358698e8d923e59e2ae2848cda709e56", "committedDate": "2020-08-19T08:14:06Z", "message": "DHFPROD-5735:Enable writing temporal documents"}, "afterCommit": {"oid": "60fbe99a13f457d8dd985dd927475e80d1e4ffbf", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/60fbe99a13f457d8dd985dd927475e80d1e4ffbf", "committedDate": "2020-08-19T08:35:34Z", "message": "DHFPROD-5735:Enable writing temporal documents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNDEyMjQ4", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#pullrequestreview-470412248", "createdAt": "2020-08-19T12:36:44Z", "commit": {"oid": "60fbe99a13f457d8dd985dd927475e80d1e4ffbf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjozNjo0NFrOHDFVSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjo0MzoyNFrOHDFlDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5NTE0Nw==", "bodyText": "I think it'd be better for this to just call temporal.collections(). Returning an object with each collection as the key and a value of \"true\" is very specific to what invoke-queue-write wants. invoke-queue-write should be responsible for doing that; this should just call temporal.collections() and return the result.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#discussion_r472995147", "createdAt": "2020-08-19T12:36:44Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/temporal/hub-temporal.sjs", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Copyright 2020 MarkLogic Corporation\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+'use strict';\n+const temporal = require(\"/MarkLogic/temporal.xqy\");\n+\n+module.exports.getTemporalCollections = module.amp(\n+  function getTemporalCollections() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60fbe99a13f457d8dd985dd927475e80d1e4ffbf"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5NjA3Ng==", "bodyText": "Can you move the new project files to test-projects/temporal-test? I'd eventually like for all of the test projects to be in that folder so that we don't have so many folders directly under src/test/resources.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#discussion_r472996076", "createdAt": "2020-08-19T12:38:15Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/java/com/marklogic/hub/flow/TemporalWriteTest.java", "diffHunk": "@@ -0,0 +1,128 @@\n+package com.marklogic.hub.flow;\n+\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ArrayNode;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.marklogic.appdeployer.command.temporal.DeployTemporalAxesCommand;\n+import com.marklogic.appdeployer.command.temporal.DeployTemporalCollectionsCommand;\n+import com.marklogic.appdeployer.impl.SimpleAppDeployer;\n+import com.marklogic.client.io.DocumentMetadataHandle;\n+import com.marklogic.client.io.JacksonHandle;\n+import com.marklogic.hub.AbstractHubCoreTest;\n+import com.marklogic.hub.HubConfig;\n+import com.marklogic.mgmt.resource.databases.DatabaseManager;\n+import com.marklogic.mgmt.util.ObjectMapperFactory;\n+import org.junit.jupiter.api.AfterEach;\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import static com.marklogic.client.io.DocumentMetadataHandle.Capability.*;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+public class TemporalWriteTest extends AbstractHubCoreTest {\n+\n+    @BeforeEach\n+    void setUp() {\n+        runAsDataHubDeveloper();\n+        installProjectInFolder(\"temporal-test\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60fbe99a13f457d8dd985dd927475e80d1e4ffbf"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5OTE4Mg==", "bodyText": "This is not related, but pinging @fsnow and @ryanjdew and @bsrikan about this - I've wondered if step definitions should go away. They certainly seem like unnecessary work when making a custom step. The only thing of interest here is the modulePath, and if I'm making a custom step, it's easier to make one new file - the custom step with a modulePath in it - vs making two new files.\nPerhaps step definitions don't need to go away, but should just become optional. They are a useful way to refer to OOTB step modules... though arguably, just using the OOTB step modulePath would be just as easy. The indirection added by having a step definition name and type just doesn't seem to buy much. The odds of the module path changing seem as low as the odds of the step definition name/type changing, so tossing the OOTB module path into a step seems fine.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#discussion_r472999182", "createdAt": "2020-08-19T12:43:24Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/resources/temporal-test/step-definitions/custom/temporal-test/temporal-test.step.json", "diffHunk": "@@ -0,0 +1,9 @@\n+{\n+  \"lang\": \"zxx\",\n+  \"name\": \"temporal-test\",\n+  \"type\": \"CUSTOM\",\n+  \"options\": {\n+    \"outputFormat\": \"json\"\n+  },\n+  \"modulePath\": \"/custom-modules/custom/temporal-step/main.sjs\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60fbe99a13f457d8dd985dd927475e80d1e4ffbf"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "60fbe99a13f457d8dd985dd927475e80d1e4ffbf", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/60fbe99a13f457d8dd985dd927475e80d1e4ffbf", "committedDate": "2020-08-19T08:35:34Z", "message": "DHFPROD-5735:Enable writing temporal documents"}, "afterCommit": {"oid": "8bb0c4a2f02571f7210e324296a830db80e958a5", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/8bb0c4a2f02571f7210e324296a830db80e958a5", "committedDate": "2020-08-19T16:30:51Z", "message": "DHFPROD-5735:Enable writing temporal documents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNjQ1NTM0", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#pullrequestreview-470645534", "createdAt": "2020-08-19T16:39:03Z", "commit": {"oid": "8bb0c4a2f02571f7210e324296a830db80e958a5"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNjQ5OTcw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#pullrequestreview-470649970", "createdAt": "2020-08-19T16:44:57Z", "commit": {"oid": "8bb0c4a2f02571f7210e324296a830db80e958a5"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad48f24eec9ca5d403387ae1bcb5d777a1cbf25c", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/ad48f24eec9ca5d403387ae1bcb5d777a1cbf25c", "committedDate": "2020-08-20T03:24:07Z", "message": "DHFPROD-5735:Enable writing temporal documents"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8bb0c4a2f02571f7210e324296a830db80e958a5", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/8bb0c4a2f02571f7210e324296a830db80e958a5", "committedDate": "2020-08-19T16:30:51Z", "message": "DHFPROD-5735:Enable writing temporal documents"}, "afterCommit": {"oid": "ad48f24eec9ca5d403387ae1bcb5d777a1cbf25c", "author": {"user": {"login": "srinathgit", "name": "Srinath S"}}, "url": "https://github.com/marklogic/marklogic-data-hub/commit/ad48f24eec9ca5d403387ae1bcb5d777a1cbf25c", "committedDate": "2020-08-20T03:24:07Z", "message": "DHFPROD-5735:Enable writing temporal documents"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxNTU3ODYw", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#pullrequestreview-471557860", "createdAt": "2020-08-20T12:47:11Z", "commit": {"oid": "ad48f24eec9ca5d403387ae1bcb5d777a1cbf25c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxNzc4MTYz", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#pullrequestreview-471778163", "createdAt": "2020-08-20T16:19:02Z", "commit": {"oid": "ad48f24eec9ca5d403387ae1bcb5d777a1cbf25c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2122, "cost": 1, "resetAt": "2021-10-28T18:54:27Z"}}}