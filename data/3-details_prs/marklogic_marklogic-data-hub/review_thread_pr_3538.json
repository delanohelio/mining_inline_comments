{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5Nzc3ODc0", "number": 3538, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQxNzozMzozN1rODcbY7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQxNzozMzozN1rODcbY7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMTM1NDY4OnYy", "diffSide": "RIGHT", "path": "one-ui/src/main/java/com/marklogic/hub/oneui/services/EnvironmentConfig.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQxNzozMzozN1rOFkeb8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNzo1NDoxMlrOFldptA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc5MTczMQ==", "bodyText": "I know this has been merged already, but I really encourage trying to minimize dependencies on HubConfig. Note that some of it is user-specific, but most of it is not. HubProject is not user-specific, and ideally that can be depended on without depending on HubConfig. Staging port is not user-specific. It's awkward because this is depending on a user-specific object for data that isn't user-specific.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3538#discussion_r373791731", "createdAt": "2020-02-01T17:33:37Z", "author": {"login": "rjrudin"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/services/EnvironmentConfig.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2012-2019 MarkLogic Corporation\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package com.marklogic.hub.oneui.services;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.marklogic.hub.DatabaseKind;\n+import com.marklogic.hub.HubProject;\n+import com.marklogic.hub.impl.Versions;\n+import com.marklogic.hub.oneui.models.HubConfigSession;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class EnvironmentConfig {\n+\n+    private String projectDir;\n+    private String projectName;\n+    private String dataHubVersion;\n+    private String marklogicVersion;\n+    private int stagingPort;\n+    private String host;\n+\n+    @Autowired\n+    @JsonIgnore\n+    private HubConfigSession hubConfig;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "072b237bec35deb478076fa8937749f683a3a53b"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ2OTExNg==", "bodyText": "@rjrudin ,\nIn one-ui, HubConfigSession is the first object created and hence every object depends on it. If I autowire, HubProject object, it's value is  is null ,so it has to be obtained from HubConfigSession and hence the dependency on it.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3538#discussion_r374469116", "createdAt": "2020-02-04T04:27:58Z", "author": {"login": "srinathgit"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/services/EnvironmentConfig.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2012-2019 MarkLogic Corporation\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package com.marklogic.hub.oneui.services;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.marklogic.hub.DatabaseKind;\n+import com.marklogic.hub.HubProject;\n+import com.marklogic.hub.impl.Versions;\n+import com.marklogic.hub.oneui.models.HubConfigSession;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class EnvironmentConfig {\n+\n+    private String projectDir;\n+    private String projectName;\n+    private String dataHubVersion;\n+    private String marklogicVersion;\n+    private int stagingPort;\n+    private String host;\n+\n+    @Autowired\n+    @JsonIgnore\n+    private HubConfigSession hubConfig;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc5MTczMQ=="}, "originalCommit": {"oid": "072b237bec35deb478076fa8937749f683a3a53b"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY0ODg1MA==", "bodyText": "Isn't there a Spring container running by the time the user logs in (which I assume results in the creation of a HubConfigSession), and couldn't HubProject just be obtained from the Spring container?", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3538#discussion_r374648850", "createdAt": "2020-02-04T12:43:56Z", "author": {"login": "rjrudin"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/services/EnvironmentConfig.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2012-2019 MarkLogic Corporation\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package com.marklogic.hub.oneui.services;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.marklogic.hub.DatabaseKind;\n+import com.marklogic.hub.HubProject;\n+import com.marklogic.hub.impl.Versions;\n+import com.marklogic.hub.oneui.models.HubConfigSession;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class EnvironmentConfig {\n+\n+    private String projectDir;\n+    private String projectName;\n+    private String dataHubVersion;\n+    private String marklogicVersion;\n+    private int stagingPort;\n+    private String host;\n+\n+    @Autowired\n+    @JsonIgnore\n+    private HubConfigSession hubConfig;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc5MTczMQ=="}, "originalCommit": {"oid": "072b237bec35deb478076fa8937749f683a3a53b"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgxNzI4Mw==", "bodyText": "Yeah, the HubProject is created prior to the user logging in by the Spring container but it's fields are all null. That's why I had to get the project from HubConfigSession.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3538#discussion_r374817283", "createdAt": "2020-02-04T17:33:21Z", "author": {"login": "srinathgit"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/services/EnvironmentConfig.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2012-2019 MarkLogic Corporation\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package com.marklogic.hub.oneui.services;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.marklogic.hub.DatabaseKind;\n+import com.marklogic.hub.HubProject;\n+import com.marklogic.hub.impl.Versions;\n+import com.marklogic.hub.oneui.models.HubConfigSession;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class EnvironmentConfig {\n+\n+    private String projectDir;\n+    private String projectName;\n+    private String dataHubVersion;\n+    private String marklogicVersion;\n+    private int stagingPort;\n+    private String host;\n+\n+    @Autowired\n+    @JsonIgnore\n+    private HubConfigSession hubConfig;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc5MTczMQ=="}, "originalCommit": {"oid": "072b237bec35deb478076fa8937749f683a3a53b"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgyNzQ0NA==", "bodyText": "That seems strange that the HubProject fields are null, as it's not a user-specific object, and thus I wouldn't think that its state depends on a user being logged in. I would think that when the application starts up, a HubProjectImpl can be fully initialized and stored as a singleton in the Spring container.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3538#discussion_r374827444", "createdAt": "2020-02-04T17:54:12Z", "author": {"login": "rjrudin"}, "path": "one-ui/src/main/java/com/marklogic/hub/oneui/services/EnvironmentConfig.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2012-2019 MarkLogic Corporation\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package com.marklogic.hub.oneui.services;\n+\n+import com.fasterxml.jackson.annotation.JsonIgnore;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.marklogic.hub.DatabaseKind;\n+import com.marklogic.hub.HubProject;\n+import com.marklogic.hub.impl.Versions;\n+import com.marklogic.hub.oneui.models.HubConfigSession;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class EnvironmentConfig {\n+\n+    private String projectDir;\n+    private String projectName;\n+    private String dataHubVersion;\n+    private String marklogicVersion;\n+    private int stagingPort;\n+    private String host;\n+\n+    @Autowired\n+    @JsonIgnore\n+    private HubConfigSession hubConfig;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc5MTczMQ=="}, "originalCommit": {"oid": "072b237bec35deb478076fa8937749f683a3a53b"}, "originalPosition": 41}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3685, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}