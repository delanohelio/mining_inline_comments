{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExOTYwNzY1", "number": 3901, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMTozMDo0NlrOD40SCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMzowOToxOVrOD40vOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwOTAzNDMyOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMTozMDo0NlrOGPvr6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxODozMjo0N1rOGQ2agw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE2MzExMw==", "bodyText": "Can we update the testid to say expandCollapseBtn-source and expandCollapseBtn-entity so its clear than rowKey and key.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r419163113", "createdAt": "2020-05-03T21:30:46Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.tsx", "diffHunk": "@@ -954,20 +1072,23 @@ const SourceToEntityMap = (props) => {\n                             </div>\n                             :\n                             <div id=\"dataPresent\">\n-                                <div className={styles.navigationCollapseButtons}>{navigationButtons}</div>\n+                                \n+                                <div className={styles.navigationCollapseButtons}><span><Button data-testid=\"expandCollapseBtn-rowKey\" onClick={() => handleExpandCollapse('rowKey')} className={styles.expandCollapseBtn}>{expandedSourceFlag ? 'Collapse All' : 'Expand All'}</Button></span><span>{navigationButtons}</span></div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e79093577a661399790d5683c46854dfc88d5702"}, "originalPosition": 184}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMyMTkyMw==", "bodyText": "Done", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r420321923", "createdAt": "2020-05-05T18:32:47Z", "author": {"login": "xnikhil08"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.tsx", "diffHunk": "@@ -954,20 +1072,23 @@ const SourceToEntityMap = (props) => {\n                             </div>\n                             :\n                             <div id=\"dataPresent\">\n-                                <div className={styles.navigationCollapseButtons}>{navigationButtons}</div>\n+                                \n+                                <div className={styles.navigationCollapseButtons}><span><Button data-testid=\"expandCollapseBtn-rowKey\" onClick={() => handleExpandCollapse('rowKey')} className={styles.expandCollapseBtn}>{expandedSourceFlag ? 'Collapse All' : 'Expand All'}</Button></span><span>{navigationButtons}</span></div>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE2MzExMw=="}, "originalCommit": {"oid": "e79093577a661399790d5683c46854dfc88d5702"}, "originalPosition": 184}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwOTEwNjQwOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMzowNTo1MFrOGPwQfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxODozMjozOVrOGQ2aKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3MjQ3OQ==", "bodyText": "can we add an assertion for indentation check. Something similar to this used in this test file:\nexpect(getByText('suffix')).toHaveStyle(\"line-height: 2vh; text-indent: 20px;\"); as applicable", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r419172479", "createdAt": "2020-05-03T23:05:50Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "diffHunk": "@@ -390,6 +398,79 @@ describe('RTL Source-to-entity map tests', () => {\n          */\n     })\n \n+    test('CollapseAll/Expand All feature in JSON Source data table and Entity table', () => {\n+\n+        const { getByTestId, getByText, debug, queryByText } = render(<SourceToEntityMap {...data.mapProps}\n+            mappingVisible={true}\n+        />);\n+\n+        /* Validate collapse-expand in source table */\n+        //Check if the expected source table elements are present in the DOM before hittting the Expan/Collapse button\n+        expect(queryByText('suffix')).not.toBeInTheDocument();\n+        expect(getByText('nutFreeName')).toBeInTheDocument();\n+        expect(getByText('FirstNamePreferred')).toBeInTheDocument();\n+        expect(getByText('LastName')).toBeInTheDocument();\n+\n+        let expandCollapseBtn = getByTestId('expandCollapseBtn-rowKey');\n+\n+        expect(expandCollapseBtn.textContent).toBe('Expand All'); // Validating the button label \n+\n+        fireEvent.click(expandCollapseBtn); //Expanding all nested levels\n+        expect(expandCollapseBtn.textContent).toBe('Collapse All'); // Validating the button label \n+        expect(getByText('suffix')).toBeInTheDocument();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e79093577a661399790d5683c46854dfc88d5702"}, "originalPosition": 138}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMyMTgzMw==", "bodyText": "Done", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r420321833", "createdAt": "2020-05-05T18:32:39Z", "author": {"login": "xnikhil08"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "diffHunk": "@@ -390,6 +398,79 @@ describe('RTL Source-to-entity map tests', () => {\n          */\n     })\n \n+    test('CollapseAll/Expand All feature in JSON Source data table and Entity table', () => {\n+\n+        const { getByTestId, getByText, debug, queryByText } = render(<SourceToEntityMap {...data.mapProps}\n+            mappingVisible={true}\n+        />);\n+\n+        /* Validate collapse-expand in source table */\n+        //Check if the expected source table elements are present in the DOM before hittting the Expan/Collapse button\n+        expect(queryByText('suffix')).not.toBeInTheDocument();\n+        expect(getByText('nutFreeName')).toBeInTheDocument();\n+        expect(getByText('FirstNamePreferred')).toBeInTheDocument();\n+        expect(getByText('LastName')).toBeInTheDocument();\n+\n+        let expandCollapseBtn = getByTestId('expandCollapseBtn-rowKey');\n+\n+        expect(expandCollapseBtn.textContent).toBe('Expand All'); // Validating the button label \n+\n+        fireEvent.click(expandCollapseBtn); //Expanding all nested levels\n+        expect(expandCollapseBtn.textContent).toBe('Collapse All'); // Validating the button label \n+        expect(getByText('suffix')).toBeInTheDocument();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3MjQ3OQ=="}, "originalCommit": {"oid": "e79093577a661399790d5683c46854dfc88d5702"}, "originalPosition": 138}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwOTEwOTA3OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wM1QyMzowOToxOVrOGPwR2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxODozMjoyMFrOGQ2Zcg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3MjgyNQ==", "bodyText": "can you try using onClosestTableRow from the test-util.ts\nexpect(onClosesTableRow(getByText('suffix')).style.display).toBe('none')", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r419172825", "createdAt": "2020-05-03T23:09:19Z", "author": {"login": "bsrikan"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "diffHunk": "@@ -390,6 +398,79 @@ describe('RTL Source-to-entity map tests', () => {\n          */\n     })\n \n+    test('CollapseAll/Expand All feature in JSON Source data table and Entity table', () => {\n+\n+        const { getByTestId, getByText, debug, queryByText } = render(<SourceToEntityMap {...data.mapProps}\n+            mappingVisible={true}\n+        />);\n+\n+        /* Validate collapse-expand in source table */\n+        //Check if the expected source table elements are present in the DOM before hittting the Expan/Collapse button\n+        expect(queryByText('suffix')).not.toBeInTheDocument();\n+        expect(getByText('nutFreeName')).toBeInTheDocument();\n+        expect(getByText('FirstNamePreferred')).toBeInTheDocument();\n+        expect(getByText('LastName')).toBeInTheDocument();\n+\n+        let expandCollapseBtn = getByTestId('expandCollapseBtn-rowKey');\n+\n+        expect(expandCollapseBtn.textContent).toBe('Expand All'); // Validating the button label \n+\n+        fireEvent.click(expandCollapseBtn); //Expanding all nested levels\n+        expect(expandCollapseBtn.textContent).toBe('Collapse All'); // Validating the button label \n+        expect(getByText('suffix')).toBeInTheDocument();\n+\n+        fireEvent.click(expandCollapseBtn); //Collapsing back to the default view (root and 1st level)\n+        expect(expandCollapseBtn.textContent).toBe('Expand All'); // Validating the button label \n+        expect(getByText('suffix').closest('tr')?.style.display).toBe('none'); // Checking if the row is marked hidden in DOM. All collapsed rows are marked hidden(display: none) once you click on Collapse All button.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e79093577a661399790d5683c46854dfc88d5702"}, "originalPosition": 142}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMyMTY1MA==", "bodyText": "Done.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/3901#discussion_r420321650", "createdAt": "2020-05-05T18:32:20Z", "author": {"login": "xnikhil08"}, "path": "marklogic-data-hub-central/ui/src/components/entities/mapping/source-entity-map/source-to-entity-map.test.tsx", "diffHunk": "@@ -390,6 +398,79 @@ describe('RTL Source-to-entity map tests', () => {\n          */\n     })\n \n+    test('CollapseAll/Expand All feature in JSON Source data table and Entity table', () => {\n+\n+        const { getByTestId, getByText, debug, queryByText } = render(<SourceToEntityMap {...data.mapProps}\n+            mappingVisible={true}\n+        />);\n+\n+        /* Validate collapse-expand in source table */\n+        //Check if the expected source table elements are present in the DOM before hittting the Expan/Collapse button\n+        expect(queryByText('suffix')).not.toBeInTheDocument();\n+        expect(getByText('nutFreeName')).toBeInTheDocument();\n+        expect(getByText('FirstNamePreferred')).toBeInTheDocument();\n+        expect(getByText('LastName')).toBeInTheDocument();\n+\n+        let expandCollapseBtn = getByTestId('expandCollapseBtn-rowKey');\n+\n+        expect(expandCollapseBtn.textContent).toBe('Expand All'); // Validating the button label \n+\n+        fireEvent.click(expandCollapseBtn); //Expanding all nested levels\n+        expect(expandCollapseBtn.textContent).toBe('Collapse All'); // Validating the button label \n+        expect(getByText('suffix')).toBeInTheDocument();\n+\n+        fireEvent.click(expandCollapseBtn); //Collapsing back to the default view (root and 1st level)\n+        expect(expandCollapseBtn.textContent).toBe('Expand All'); // Validating the button label \n+        expect(getByText('suffix').closest('tr')?.style.display).toBe('none'); // Checking if the row is marked hidden in DOM. All collapsed rows are marked hidden(display: none) once you click on Collapse All button.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTE3MjgyNQ=="}, "originalCommit": {"oid": "e79093577a661399790d5683c46854dfc88d5702"}, "originalPosition": 142}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4086, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}