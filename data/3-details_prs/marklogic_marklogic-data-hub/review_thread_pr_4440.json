{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwMDAyMTc2", "number": 4440, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjozNjo0NFrOEZ9RBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjo0MzoyNFrOEZ9bFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1NjUzNjM3OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/temporal/hub-temporal.sjs", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjozNjo0NFrOHDFVSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjozNjo0NFrOHDFVSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5NTE0Nw==", "bodyText": "I think it'd be better for this to just call temporal.collections(). Returning an object with each collection as the key and a value of \"true\" is very specific to what invoke-queue-write wants. invoke-queue-write should be responsible for doing that; this should just call temporal.collections() and return the result.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#discussion_r472995147", "createdAt": "2020-08-19T12:36:44Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/main/resources/ml-modules/root/data-hub/5/temporal/hub-temporal.sjs", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Copyright 2020 MarkLogic Corporation\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+'use strict';\n+const temporal = require(\"/MarkLogic/temporal.xqy\");\n+\n+module.exports.getTemporalCollections = module.amp(\n+  function getTemporalCollections() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60fbe99a13f457d8dd985dd927475e80d1e4ffbf"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1NjU0MjUwOnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/test/java/com/marklogic/hub/flow/TemporalWriteTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjozODoxNVrOHDFY7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjozODoxNVrOHDFY7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5NjA3Ng==", "bodyText": "Can you move the new project files to test-projects/temporal-test? I'd eventually like for all of the test projects to be in that folder so that we don't have so many folders directly under src/test/resources.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#discussion_r472996076", "createdAt": "2020-08-19T12:38:15Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/java/com/marklogic/hub/flow/TemporalWriteTest.java", "diffHunk": "@@ -0,0 +1,128 @@\n+package com.marklogic.hub.flow;\n+\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.databind.node.ArrayNode;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import com.marklogic.appdeployer.command.temporal.DeployTemporalAxesCommand;\n+import com.marklogic.appdeployer.command.temporal.DeployTemporalCollectionsCommand;\n+import com.marklogic.appdeployer.impl.SimpleAppDeployer;\n+import com.marklogic.client.io.DocumentMetadataHandle;\n+import com.marklogic.client.io.JacksonHandle;\n+import com.marklogic.hub.AbstractHubCoreTest;\n+import com.marklogic.hub.HubConfig;\n+import com.marklogic.mgmt.resource.databases.DatabaseManager;\n+import com.marklogic.mgmt.util.ObjectMapperFactory;\n+import org.junit.jupiter.api.AfterEach;\n+import org.junit.jupiter.api.Assertions;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+\n+import static com.marklogic.client.io.DocumentMetadataHandle.Capability.*;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+public class TemporalWriteTest extends AbstractHubCoreTest {\n+\n+    @BeforeEach\n+    void setUp() {\n+        runAsDataHubDeveloper();\n+        installProjectInFolder(\"temporal-test\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60fbe99a13f457d8dd985dd927475e80d1e4ffbf"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1NjU2MjE1OnYy", "diffSide": "RIGHT", "path": "marklogic-data-hub/src/test/resources/temporal-test/step-definitions/custom/temporal-test/temporal-test.step.json", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjo0MzoyNFrOHDFlDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMjo0MzoyNFrOHDFlDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk5OTE4Mg==", "bodyText": "This is not related, but pinging @fsnow and @ryanjdew and @bsrikan about this - I've wondered if step definitions should go away. They certainly seem like unnecessary work when making a custom step. The only thing of interest here is the modulePath, and if I'm making a custom step, it's easier to make one new file - the custom step with a modulePath in it - vs making two new files.\nPerhaps step definitions don't need to go away, but should just become optional. They are a useful way to refer to OOTB step modules... though arguably, just using the OOTB step modulePath would be just as easy. The indirection added by having a step definition name and type just doesn't seem to buy much. The odds of the module path changing seem as low as the odds of the step definition name/type changing, so tossing the OOTB module path into a step seems fine.", "url": "https://github.com/marklogic/marklogic-data-hub/pull/4440#discussion_r472999182", "createdAt": "2020-08-19T12:43:24Z", "author": {"login": "rjrudin"}, "path": "marklogic-data-hub/src/test/resources/temporal-test/step-definitions/custom/temporal-test/temporal-test.step.json", "diffHunk": "@@ -0,0 +1,9 @@\n+{\n+  \"lang\": \"zxx\",\n+  \"name\": \"temporal-test\",\n+  \"type\": \"CUSTOM\",\n+  \"options\": {\n+    \"outputFormat\": \"json\"\n+  },\n+  \"modulePath\": \"/custom-modules/custom/temporal-step/main.sjs\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60fbe99a13f457d8dd985dd927475e80d1e4ffbf"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3691, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}