{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg4Mzk4OTk5", "number": 1431, "title": "Adding internal table-api config for table-api rate limits", "bodyText": "Issues: currently the table api read/write rate limit is not emitted by samza\nChanges:\n\nEmit table API read/write rate limit in RemoteTableDescriptor. The names of the new metrics are:\ntables.table-id.io.read.credits and tables.table-io.write.credits\n\nTests:\n\nUnit Tests\n\nAPI Changes: None\nUpgrade Instructions: None\nUsage Instructions: None", "createdAt": "2020-09-17T04:45:13Z", "url": "https://github.com/apache/samza/pull/1431", "merged": true, "mergeCommit": {"oid": "7eb7079e0016eac39c5a923fef7e306668418ad1"}, "closed": true, "closedAt": "2020-09-21T19:19:10Z", "author": {"login": "xiefan46"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJpdg_AH2gAyNDg4Mzk4OTk5OjM5YTk0YWJkN2U0MTBlYjZmMDI2ZDJjNDk3NzYzNTllYjllN2RkYmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLHKzKAFqTQ5Mjg0ODkzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "39a94abd7e410eb6f026d2c49776359eb9e7ddbc", "author": {"user": {"login": "xiefan46", "name": "FAN XIE"}}, "url": "https://github.com/apache/samza/commit/39a94abd7e410eb6f026d2c49776359eb9e7ddbc", "committedDate": "2020-09-17T04:40:54Z", "message": "Adding internal table-api config for table-api rate limits"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxNzcyMzQx", "url": "https://github.com/apache/samza/pull/1431#pullrequestreview-491772341", "createdAt": "2020-09-18T20:48:15Z", "commit": {"oid": "39a94abd7e410eb6f026d2c49776359eb9e7ddbc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDo0ODoxNVrOHUbdxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDo0ODoxNVrOHUbdxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE4MzU1OA==", "bodyText": "Please undo indent/superfluous changes like these, it pollutes the git blame history, also makes it harder to review things.\nI believe auto-indent on your IDE may be the culprit here.", "url": "https://github.com/apache/samza/pull/1431#discussion_r491183558", "createdAt": "2020-09-18T20:48:15Z", "author": {"login": "rmatharu"}, "path": "samza-api/src/main/java/org/apache/samza/table/descriptors/RemoteTableDescriptor.java", "diffHunk": "@@ -288,7 +289,8 @@ public String getProviderFactoryClassName() {\n       RateLimiter defaultRateLimiter;\n       try {\n         @SuppressWarnings(\"unchecked\")\n-        Class<? extends RateLimiter> clazz = (Class<? extends RateLimiter>) Class.forName(DEFAULT_RATE_LIMITER_CLASS_NAME);\n+        Class<? extends RateLimiter> clazz =\n+            (Class<? extends RateLimiter>) Class.forName(DEFAULT_RATE_LIMITER_CLASS_NAME);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39a94abd7e410eb6f026d2c49776359eb9e7ddbc"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxNzcyNDY4", "url": "https://github.com/apache/samza/pull/1431#pullrequestreview-491772468", "createdAt": "2020-09-18T20:48:31Z", "commit": {"oid": "39a94abd7e410eb6f026d2c49776359eb9e7ddbc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxNzgwNDM2", "url": "https://github.com/apache/samza/pull/1431#pullrequestreview-491780436", "createdAt": "2020-09-18T21:04:47Z", "commit": {"oid": "39a94abd7e410eb6f026d2c49776359eb9e7ddbc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMTowNDo0N1rOHUb3dw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMTowNDo0N1rOHUb3dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE5MDEzNQ==", "bodyText": "Minor: move them next to other rate limiter related configs (io.ratelimiter) etc.\nWould it make sense to call these io.read.credits and io.write.credits for consistent terminology with rest of the configs?\nCan you also document how this config is used?", "url": "https://github.com/apache/samza/pull/1431#discussion_r491190135", "createdAt": "2020-09-18T21:04:47Z", "author": {"login": "prateekm"}, "path": "samza-api/src/main/java/org/apache/samza/table/descriptors/RemoteTableDescriptor.java", "diffHunk": "@@ -76,6 +76,8 @@\n   public static final String READ_RETRY_POLICY = \"io.read.retry.policy\";\n   public static final String WRITE_RETRY_POLICY = \"io.write.retry.policy\";\n   public static final String BATCH_PROVIDER = \"io.batch.provider\";\n+  public static final String READ_RATE_LIMIT = \"io.read.ratelimit\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39a94abd7e410eb6f026d2c49776359eb9e7ddbc"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxNzgwNTE0", "url": "https://github.com/apache/samza/pull/1431#pullrequestreview-491780514", "createdAt": "2020-09-18T21:04:54Z", "commit": {"oid": "39a94abd7e410eb6f026d2c49776359eb9e7ddbc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMTowNDo1NFrOHUb3vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMTowNDo1NFrOHUb3vw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE5MDIwNw==", "bodyText": "s/emit/write.\nCan you extract all of the rate limiter related config generation logic (factory, serde, limits) to a helper method? Will be easier to read.", "url": "https://github.com/apache/samza/pull/1431#discussion_r491190207", "createdAt": "2020-09-18T21:04:54Z", "author": {"login": "prateekm"}, "path": "samza-api/src/main/java/org/apache/samza/table/descriptors/RemoteTableDescriptor.java", "diffHunk": "@@ -305,6 +307,14 @@ public String getProviderFactoryClassName() {\n       }\n     }\n \n+    //emit table api read/write rate limit\n+    if (this.enableReadRateLimiter && tagCreditsMap.containsKey(RL_READ_TAG)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39a94abd7e410eb6f026d2c49776359eb9e7ddbc"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ae8e76d34be1f906c717792f853a51300101844", "author": {"user": {"login": "xiefan46", "name": "FAN XIE"}}, "url": "https://github.com/apache/samza/commit/3ae8e76d34be1f906c717792f853a51300101844", "committedDate": "2020-09-19T00:53:56Z", "message": "address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1d1c0c8cc6826274ceb2ccbebe4f72869bc4b80", "author": {"user": {"login": "xiefan46", "name": "FAN XIE"}}, "url": "https://github.com/apache/samza/commit/a1d1c0c8cc6826274ceb2ccbebe4f72869bc4b80", "committedDate": "2020-09-19T00:56:11Z", "message": "style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8b5b5a049b5f4599465247a8d0a968d1f9f07ef", "author": {"user": {"login": "xiefan46", "name": "FAN XIE"}}, "url": "https://github.com/apache/samza/commit/f8b5b5a049b5f4599465247a8d0a968d1f9f07ef", "committedDate": "2020-09-19T01:03:03Z", "message": "style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyODQ4OTMx", "url": "https://github.com/apache/samza/pull/1431#pullrequestreview-492848931", "createdAt": "2020-09-21T17:51:32Z", "commit": {"oid": "f8b5b5a049b5f4599465247a8d0a968d1f9f07ef"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4722, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}