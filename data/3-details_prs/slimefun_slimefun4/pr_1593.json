{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwOTM4Mzk5", "number": 1593, "title": "General performance improvements", "bodyText": "Description\nGeneral performance improvements\nChanges\nFix re-compiling patterns, bad appends, useless string concat. Also done some small cleanup.\nRelated Issues\nN/A\nTestability\n\n\n I have fully tested the proposed changes and promise that they will not break everything into chaos.\n I have also tested the proposed changes in combination with various popular addons and can confirm my changes do not break them.", "createdAt": "2020-02-27T16:13:54Z", "url": "https://github.com/Slimefun/Slimefun4/pull/1593", "merged": true, "mergeCommit": {"oid": "106487b2e9889beb807f7d0bce2590e9311bc9ff"}, "closed": true, "closedAt": "2020-03-01T15:00:36Z", "author": {"login": "WalshyDev"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIdq2yAH2gAyMzgwOTM4Mzk5OmNiZDdmYWY0ZDc0YWM3NGNlYTk2Yjc1ZTE4NDQyMjJjODIwMTJhZmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJacx3AFqTM2Njg2NTAxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cbd7faf4d74ac74cea96b75e1844222c82012afd", "author": {"user": {"login": "WalshyDev", "name": "Daniel Walsh"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/cbd7faf4d74ac74cea96b75e1844222c82012afd", "committedDate": "2020-02-27T16:11:32Z", "message": "General performance improvements"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTcyODE4", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#pullrequestreview-365972818", "createdAt": "2020-02-27T20:24:30Z", "commit": {"oid": "cbd7faf4d74ac74cea96b75e1844222c82012afd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDoyNDozMFrOFvgBHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDoyODoxMFrOFvgHeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM1MTk2Nw==", "bodyText": "SLASH? Shouldn't this be DASH?", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#discussion_r385351967", "createdAt": "2020-02-27T20:24:30Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/androids/ScriptHolder.java", "diffHunk": "@@ -71,7 +72,7 @@ protected void exoticFarm(BlockMenu menu, Block block) {\n \n \tpublic void openScript(Player p, Block b, String script) {\n \t\tChestMenu menu = new ChestMenu(ChatColor.DARK_AQUA + SlimefunPlugin.getLocal().getMessage(p, \"android.scripts.editor\"));\n-\t\tString[] commands = script.split(\"-\");\n+\t\tString[] commands = PatternUtils.SLASH_SEPARATOR.split(script);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbd7faf4d74ac74cea96b75e1844222c82012afd"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM1MjEzMg==", "bodyText": "Again: SLASH? Shouldn't this be DASH?", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#discussion_r385352132", "createdAt": "2020-02-27T20:24:52Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/androids/ScriptHolder.java", "diffHunk": "@@ -391,7 +392,7 @@ protected String getScriptRatingPercentage(Config script) {\n \n \tprotected void openScriptComponentEditor(Player p, Block b, String script, int index) {\n \t\tChestMenu menu = new ChestMenu(ChatColor.DARK_AQUA + SlimefunPlugin.getLocal().getMessage(p, \"android.scripts.editor\"));\n-\t\tString[] commands = script.split(\"-\");\n+\t\tString[] commands = PatternUtils.SLASH_SEPARATOR.split(script);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbd7faf4d74ac74cea96b75e1844222c82012afd"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM1MzU5Mg==", "bodyText": "Is this Slash safe here or does it need to be escaped?", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#discussion_r385353592", "createdAt": "2020-02-27T20:28:10Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/utils/PatternUtils.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package io.github.thebusybiscuit.slimefun4.utils;\n+\n+import java.util.regex.Pattern;\n+\n+/**\n+ * This class is created for common-use patterns used in things such as {@link String#split(String)}. <br />\n+ * Every time something like {@link String#split(String)} is called it will compile a {@link Pattern}, for code that is called\n+ * often this can be a massive performance loss. This class solves that, one compile but many uses!\n+ */\n+public final class PatternUtils {\n+\n+    private PatternUtils() {}\n+\n+    public static final Pattern SEMICOLON = Pattern.compile(\";\");\n+    public static final Pattern HASH = Pattern.compile(\"#\");\n+    public static final Pattern COMMA = Pattern.compile(\",\");\n+    public static final Pattern SLASH_SEPARATOR = Pattern.compile(\" / \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbd7faf4d74ac74cea96b75e1844222c82012afd"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTc1Nzgw", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#pullrequestreview-365975780", "createdAt": "2020-02-27T20:29:39Z", "commit": {"oid": "cbd7faf4d74ac74cea96b75e1844222c82012afd"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDoyOTozOVrOFvgJ7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDoyOTozOVrOFvgJ7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM1NDIyMQ==", "bodyText": "Please fix the indentation here.", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#discussion_r385354221", "createdAt": "2020-02-27T20:29:39Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/GearListener.java", "diffHunk": "@@ -1,68 +1,57 @@\n package io.github.thebusybiscuit.slimefun4.implementation.listeners;\n \n-import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import io.github.thebusybiscuit.slimefun4.implementation.tasks.JetBootsTask;\n+import io.github.thebusybiscuit.slimefun4.implementation.tasks.JetpackTask;\n+import io.github.thebusybiscuit.slimefun4.implementation.tasks.MagnetTask;\n+import io.github.thebusybiscuit.slimefun4.implementation.tasks.ParachuteTask;\n import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.JetBoots;\n import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.Jetpack;\n import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.SlimefunItem;\n import me.mrCookieSlime.Slimefun.Setup.SlimefunManager;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n import me.mrCookieSlime.Slimefun.api.Slimefun;\n-\n-import org.bukkit.Bukkit;\n import org.bukkit.entity.Player;\n import org.bukkit.event.EventHandler;\n import org.bukkit.event.Listener;\n import org.bukkit.event.player.PlayerToggleSneakEvent;\n \n-import io.github.thebusybiscuit.slimefun4.implementation.tasks.JetBootsTask;\n-import io.github.thebusybiscuit.slimefun4.implementation.tasks.JetpackTask;\n-import io.github.thebusybiscuit.slimefun4.implementation.tasks.MagnetTask;\n-import io.github.thebusybiscuit.slimefun4.implementation.tasks.ParachuteTask;\n-\n public class GearListener implements Listener {\n \n-\tpublic GearListener(SlimefunPlugin plugin) {\n-\t\tplugin.getServer().getPluginManager().registerEvents(this, plugin);\n-\t}\n+    public GearListener(SlimefunPlugin plugin) {\n+        plugin.getServer().getPluginManager().registerEvents(this, plugin);\n+    }\n+\n+    @EventHandler\n+    public void onToggleSneak(PlayerToggleSneakEvent e) {\n+        if (!e.isSneaking()) return;\n+\t\tPlayer p = e.getPlayer();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbd7faf4d74ac74cea96b75e1844222c82012afd"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTc2Njg3", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#pullrequestreview-365976687", "createdAt": "2020-02-27T20:31:08Z", "commit": {"oid": "cbd7faf4d74ac74cea96b75e1844222c82012afd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDozMTowOVrOFvgMsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDozMTowOVrOFvgMsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM1NDkyOA==", "bodyText": "So if the Player wears no chestplate you return.\nThe jetboots will never even get checked if you return here prematurely.", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#discussion_r385354928", "createdAt": "2020-02-27T20:31:09Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/GearListener.java", "diffHunk": "@@ -1,68 +1,57 @@\n package io.github.thebusybiscuit.slimefun4.implementation.listeners;\n \n-import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n+import io.github.thebusybiscuit.slimefun4.implementation.tasks.JetBootsTask;\n+import io.github.thebusybiscuit.slimefun4.implementation.tasks.JetpackTask;\n+import io.github.thebusybiscuit.slimefun4.implementation.tasks.MagnetTask;\n+import io.github.thebusybiscuit.slimefun4.implementation.tasks.ParachuteTask;\n import me.mrCookieSlime.Slimefun.Lists.SlimefunItems;\n import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.JetBoots;\n import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.Jetpack;\n import me.mrCookieSlime.Slimefun.Objects.SlimefunItem.SlimefunItem;\n import me.mrCookieSlime.Slimefun.Setup.SlimefunManager;\n+import me.mrCookieSlime.Slimefun.SlimefunPlugin;\n import me.mrCookieSlime.Slimefun.api.Slimefun;\n-\n-import org.bukkit.Bukkit;\n import org.bukkit.entity.Player;\n import org.bukkit.event.EventHandler;\n import org.bukkit.event.Listener;\n import org.bukkit.event.player.PlayerToggleSneakEvent;\n \n-import io.github.thebusybiscuit.slimefun4.implementation.tasks.JetBootsTask;\n-import io.github.thebusybiscuit.slimefun4.implementation.tasks.JetpackTask;\n-import io.github.thebusybiscuit.slimefun4.implementation.tasks.MagnetTask;\n-import io.github.thebusybiscuit.slimefun4.implementation.tasks.ParachuteTask;\n-\n public class GearListener implements Listener {\n \n-\tpublic GearListener(SlimefunPlugin plugin) {\n-\t\tplugin.getServer().getPluginManager().registerEvents(this, plugin);\n-\t}\n+    public GearListener(SlimefunPlugin plugin) {\n+        plugin.getServer().getPluginManager().registerEvents(this, plugin);\n+    }\n+\n+    @EventHandler\n+    public void onToggleSneak(PlayerToggleSneakEvent e) {\n+        if (!e.isSneaking()) return;\n+\t\tPlayer p = e.getPlayer();\n+\n+        if (p.getInventory().getChestplate() != null) {\n+            SlimefunItem chestplate = SlimefunItem.getByItem(p.getInventory().getChestplate());\n+            if (chestplate == null || !Slimefun.hasUnlocked(p, chestplate, true)) return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbd7faf4d74ac74cea96b75e1844222c82012afd"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "105b32583dcb0d7efbd589acb0c1a55ae59abfcb", "author": {"user": {"login": "J3fftw1", "name": "J3fftw"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/105b32583dcb0d7efbd589acb0c1a55ae59abfcb", "committedDate": "2020-03-01T13:27:11Z", "message": "Changed requested changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "efa8d81f7714377bce41916137a6d94507072e5a", "author": {"user": {"login": "J3fftw1", "name": "J3fftw"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/efa8d81f7714377bce41916137a6d94507072e5a", "committedDate": "2020-03-01T13:33:44Z", "message": "Merge branch 'master' of https://github.com/TheBusyBiscuit/Slimefun4 into fix/performance-improvements\n\n# Conflicts:\n#\tsrc/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/TalismanListener.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODYwMjI5", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#pullrequestreview-366860229", "createdAt": "2020-03-01T13:44:30Z", "commit": {"oid": "efa8d81f7714377bce41916137a6d94507072e5a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQxMzo0NDozMFrOFwOPvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMVQxMzo0NDozMFrOFwOPvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjEwOTM3NQ==", "bodyText": "This should also rather be DASH than SLASH right?", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#discussion_r386109375", "createdAt": "2020-03-01T13:44:30Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/TalismanListener.java", "diffHunk": "@@ -138,7 +139,8 @@ public void onEnchant(EnchantItemEvent e) {\n \t\t\t}\n \t\t\t\n \t\t\tString enchant = enchantments.get(random.nextInt(enchantments.size()));\n-\t\t\te.getEnchantsToAdd().put(Enchantment.getByKey(NamespacedKey.minecraft(enchant.split(\"-\")[0])), Integer.parseInt(enchant.split(\"-\")[1]));\n+\t\t\tString[] enchantSplit = PatternUtils.SLASH_SEPARATOR.split(enchant);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efa8d81f7714377bce41916137a6d94507072e5a"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56648c464f8f0c35931b32284911b35e60f83319", "author": {"user": {"login": "J3fftw1", "name": "J3fftw"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/56648c464f8f0c35931b32284911b35e60f83319", "committedDate": "2020-03-01T13:59:11Z", "message": "last fix!"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b74a347b6c1762d1b7a8049e98a84c2feaef87a", "author": {"user": {"login": "J3fftw1", "name": "J3fftw"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/7b74a347b6c1762d1b7a8049e98a84c2feaef87a", "committedDate": "2020-03-01T14:52:36Z", "message": "Merge branch 'master' of https://github.com/TheBusyBiscuit/Slimefun4 into fix/performance-improvements\n\n# Conflicts:\n#\tsrc/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/GearListener.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODY1MDE3", "url": "https://github.com/Slimefun/Slimefun4/pull/1593#pullrequestreview-366865017", "createdAt": "2020-03-01T15:00:22Z", "commit": {"oid": "7b74a347b6c1762d1b7a8049e98a84c2feaef87a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2565, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}