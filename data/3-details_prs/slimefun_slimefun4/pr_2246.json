{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyMTE1NDY0", "number": 2246, "title": "Sf give drops excess items", "bodyText": "Description\nAs /sf give was standing, anytime the command was used excess items would be lost which can be an issue when the command is not executed by a Player but rather console via other plugins. This PR provides a way to have said items drop instead, adding a config option defaulting to false which maintains the current behaviour making it safe for existing setups while allowing any user to switch at anytime.\nChanges\n\nAdded a config option with which users can opt in for excess items being dropped, defaults to false.\nEdited GiveCommand class to check for said option and, if true and if any excess items are actually present, dropping them naturally at the target's location.\n\nRelated Issues\nN/A\nChecklist\n\n\n\n I have fully tested the proposed changes and promise that they will not break everything into chaos.\n I have also tested the proposed changes in combination with various popular addons and can confirm my changes do not break them.\n I followed the existing code standards and didn't mess up the formatting.\n I did my best to add documentation to any public classes or methods I added.\n I added sufficient Unit Tests to cover my code.", "createdAt": "2020-08-23T12:07:07Z", "url": "https://github.com/Slimefun/Slimefun4/pull/2246", "merged": true, "mergeCommit": {"oid": "bab5f8a9b5e4c20c6268cb16731de0306433562a"}, "closed": true, "closedAt": "2020-08-23T15:54:15Z", "author": {"login": "Sfiguz7"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdBsr0vgH2gAyNDcyMTE1NDY0OmViNjZmM2UxODMwNjJjODg5MjVlYzQ3ZDVkNWE5MGEyNTI3NWE1ZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdBwFjUAFqTQ3MzAyMjI0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eb66f3e183062c88925ec47d5d5a90a25275a5fc", "author": {"user": {"login": "Sfiguz7", "name": "Sfiguz7"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/eb66f3e183062c88925ec47d5d5a90a25275a5fc", "committedDate": "2020-08-23T11:54:51Z", "message": "Added option to drop excess items on /sf give"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdd2adc21e8beeafc5eed51613849b7b07b1e90f", "author": {"user": {"login": "Sfiguz7", "name": "Sfiguz7"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/bdd2adc21e8beeafc5eed51613849b7b07b1e90f", "committedDate": "2020-08-23T11:56:39Z", "message": "Cleared unused imports I forgot to delete"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e06d17f8e597a22e9e1dc7c8c38269cbea7245a9", "author": {"user": {"login": "Sfiguz7", "name": "Sfiguz7"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/e06d17f8e597a22e9e1dc7c8c38269cbea7245a9", "committedDate": "2020-08-23T11:58:29Z", "message": "Restored original plugin.yml as pulling hadn't"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMDExMzY4", "url": "https://github.com/Slimefun/Slimefun4/pull/2246#pullrequestreview-473011368", "createdAt": "2020-08-23T13:26:49Z", "commit": {"oid": "e06d17f8e597a22e9e1dc7c8c38269cbea7245a9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yM1QxMzoyNjo0OVrOHFNGLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yM1QxMzoyNzoxM1rOHFNGXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIxOTUwMw==", "bodyText": "I wouldn't really use Naturally here, as it will give the item an offset to jump in a random direction.", "url": "https://github.com/Slimefun/Slimefun4/pull/2246#discussion_r475219503", "createdAt": "2020-08-23T13:26:49Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/GiveCommand.java", "diffHunk": "@@ -65,7 +66,13 @@ private void giveItem(CommandSender sender, Player p, SlimefunItem sfItem, Strin\n \n             if (amount > 0) {\n                 SlimefunPlugin.getLocalization().sendMessage(p, \"messages.given-item\", true, msg -> msg.replace(PLACEHOLDER_ITEM, sfItem.getItemName()).replace(PLACEHOLDER_AMOUNT, String.valueOf(amount)));\n-                p.getInventory().addItem(new CustomItem(sfItem.getItem(), amount));\n+                HashMap<Integer,ItemStack> excess = p.getInventory().addItem(new CustomItem(sfItem.getItem(), amount));\n+                if (SlimefunPlugin.getCfg().getBoolean(\"options.drop-excess-sf-give-items\") && !excess.isEmpty()) {\n+                        for (ItemStack is : excess.values()) {\n+                            p.getWorld().dropItemNaturally(p.getLocation(), is);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e06d17f8e597a22e9e1dc7c8c38269cbea7245a9"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIxOTU1MA==", "bodyText": "Also use the base type Map.", "url": "https://github.com/Slimefun/Slimefun4/pull/2246#discussion_r475219550", "createdAt": "2020-08-23T13:27:13Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/GiveCommand.java", "diffHunk": "@@ -65,7 +66,13 @@ private void giveItem(CommandSender sender, Player p, SlimefunItem sfItem, Strin\n \n             if (amount > 0) {\n                 SlimefunPlugin.getLocalization().sendMessage(p, \"messages.given-item\", true, msg -> msg.replace(PLACEHOLDER_ITEM, sfItem.getItemName()).replace(PLACEHOLDER_AMOUNT, String.valueOf(amount)));\n-                p.getInventory().addItem(new CustomItem(sfItem.getItem(), amount));\n+                HashMap<Integer,ItemStack> excess = p.getInventory().addItem(new CustomItem(sfItem.getItem(), amount));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e06d17f8e597a22e9e1dc7c8c38269cbea7245a9"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "813200b29c329943c5e480638ded8de140b107c2", "author": {"user": {"login": "Sfiguz7", "name": "Sfiguz7"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/813200b29c329943c5e480638ded8de140b107c2", "committedDate": "2020-08-23T13:36:10Z", "message": "Made requested changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMDIxNzg1", "url": "https://github.com/Slimefun/Slimefun4/pull/2246#pullrequestreview-473021785", "createdAt": "2020-08-23T15:45:40Z", "commit": {"oid": "813200b29c329943c5e480638ded8de140b107c2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yM1QxNTo0NTo0MFrOHFN_ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yM1QxNTo0NTo0MFrOHFN_ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIzNDIxMQ==", "bodyText": "The brackets are mis-aligned, could it be that you are using a different indentation?\nThe closing bracket does not lign up with the if.", "url": "https://github.com/Slimefun/Slimefun4/pull/2246#discussion_r475234211", "createdAt": "2020-08-23T15:45:40Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/commands/subcommands/GiveCommand.java", "diffHunk": "@@ -65,7 +66,13 @@ private void giveItem(CommandSender sender, Player p, SlimefunItem sfItem, Strin\n \n             if (amount > 0) {\n                 SlimefunPlugin.getLocalization().sendMessage(p, \"messages.given-item\", true, msg -> msg.replace(PLACEHOLDER_ITEM, sfItem.getItemName()).replace(PLACEHOLDER_AMOUNT, String.valueOf(amount)));\n-                p.getInventory().addItem(new CustomItem(sfItem.getItem(), amount));\n+                Map<Integer,ItemStack> excess = p.getInventory().addItem(new CustomItem(sfItem.getItem(), amount));\n+                if (SlimefunPlugin.getCfg().getBoolean(\"options.drop-excess-sf-give-items\") && !excess.isEmpty()) {\n+                        for (ItemStack is : excess.values()) {\n+                            p.getWorld().dropItem(p.getLocation(), is);\n+                        }\n+                    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "813200b29c329943c5e480638ded8de140b107c2"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44451d6244df3adb69d0a1f559d8d1330eff0098", "author": {"user": {"login": "Sfiguz7", "name": "Sfiguz7"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/44451d6244df3adb69d0a1f559d8d1330eff0098", "committedDate": "2020-08-23T15:49:44Z", "message": "Fixed extra indentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89fdf45d28f840e690a7b87bf210db71f6d0ee86", "author": {"user": {"login": "Sfiguz7", "name": "Sfiguz7"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/89fdf45d28f840e690a7b87bf210db71f6d0ee86", "committedDate": "2020-08-23T15:50:31Z", "message": "I said, fixed extra indentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMDIyMjA5", "url": "https://github.com/Slimefun/Slimefun4/pull/2246#pullrequestreview-473022209", "createdAt": "2020-08-23T15:52:11Z", "commit": {"oid": "89fdf45d28f840e690a7b87bf210db71f6d0ee86"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczMDIyMjQ5", "url": "https://github.com/Slimefun/Slimefun4/pull/2246#pullrequestreview-473022249", "createdAt": "2020-08-23T15:52:41Z", "commit": {"oid": "89fdf45d28f840e690a7b87bf210db71f6d0ee86"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2437, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}