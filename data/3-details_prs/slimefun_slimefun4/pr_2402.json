{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4OTEyNTgw", "number": 2402, "title": "GPS Control Panel and GEO Scanner access checks", "bodyText": "Description\nAdded checks to make sure that the player attempting to access the GPS Control Panel and GEO Scanner has sufficient permissions to access them.\nChanges\n\nslimefun.inventory.bypass permission check\nProtection manager inventory access permission check\nResearch check\nNo access message\n\nRelated Issues\nN/A\nChecklist\n\n\n\n I have fully tested the proposed changes and promise that they will not break everything into chaos.\n I have also tested the proposed changes in combination with various popular addons and can confirm my changes do not break them.\n I followed the existing code standards and didn't mess up the formatting.\n I did my best to add documentation to any public classes or methods I added.\n I have added Nonnull and Nullable annotations to my methods to indicate their behaviour for null values\n I added sufficient Unit Tests to cover my code.", "createdAt": "2020-10-07T00:50:45Z", "url": "https://github.com/Slimefun/Slimefun4/pull/2402", "merged": true, "mergeCommit": {"oid": "01d233af4d485161ec5f708ba5ff2d75e1495151"}, "closed": true, "closedAt": "2020-10-08T12:37:17Z", "author": {"login": "NCBPFluffyBear"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKhDd-AH2gAyNDk4OTEyNTgwOmE4NDNlOTlkYmYyMDhhZjM2YzU5MzUwMTA1OWRjMjEwZmE4OGI1Yzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdQgwv_AFqTUwNDcyOTk2OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a843e99dbf208af36c593501059dc210fa88b5c7", "author": {"user": {"login": "NCBPFluffyBear", "name": "FluffyBear"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/a843e99dbf208af36c593501059dc210fa88b5c7", "committedDate": "2020-09-19T21:27:08Z", "message": "Merge pull request #3 from Slimefun/master\n\nUpdate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37f0715156dd8a8f7228f532daf9e3aeec34a2a4", "author": {"user": {"login": "NCBPFluffyBear", "name": "FluffyBear"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/37f0715156dd8a8f7228f532daf9e3aeec34a2a4", "committedDate": "2020-10-07T00:46:22Z", "message": "Added permission checks for the GEO Scanner and GPS Control Panel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAzNDU2MzQ0", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#pullrequestreview-503456344", "createdAt": "2020-10-07T00:58:08Z", "commit": {"oid": "37f0715156dd8a8f7228f532daf9e3aeec34a2a4"}, "state": "DISMISSED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QwMDo1ODowOFrOHde60g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QwMDo1OTozNFrOHde8MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3NzMzMA==", "bodyText": "else on the next line after the bracket.", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#discussion_r500677330", "createdAt": "2020-10-07T00:58:08Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/gps/GPSControlPanel.java", "diffHunk": "@@ -17,6 +20,22 @@ public GPSControlPanel(Category category, SlimefunItemStack item, RecipeType rec\n \n     @Override\n     public BlockUseHandler getItemHandler() {\n-        return e -> SlimefunPlugin.getGPSNetwork().openTransmitterControlPanel(e.getPlayer());\n+        return e ->  {\n+            e.cancel();\n+\n+            Player p = e.getPlayer();\n+\n+            if (p.hasPermission(\"slimefun.inventory.bypass\")\n+                || (SlimefunPlugin.getProtectionManager().hasPermission(\n+                p, e.getClickedBlock().get().getLocation(), ProtectableAction.ACCESS_INVENTORIES))\n+                && Slimefun.hasUnlocked(p, item, false)\n+            ) {\n+\n+                SlimefunPlugin.getGPSNetwork().openTransmitterControlPanel(p);\n+            } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37f0715156dd8a8f7228f532daf9e3aeec34a2a4"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3NzM1OA==", "bodyText": "else on the next line after the bracket.", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#discussion_r500677358", "createdAt": "2020-10-07T00:58:15Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/geo/GEOScanner.java", "diffHunk": "@@ -19,10 +22,22 @@ public GEOScanner(Category category, SlimefunItemStack item, RecipeType recipeTy\n     @Override\n     public BlockUseHandler getItemHandler() {\n         return e -> {\n+            e.cancel();\n+\n             Block b = e.getClickedBlock().get();\n+            Player p = e.getPlayer();\n \n-            e.cancel();\n-            SlimefunPlugin.getGPSNetwork().getResourceManager().scan(e.getPlayer(), b, 0);\n+            if (p.hasPermission(\"slimefun.inventory.bypass\")\n+                || (SlimefunPlugin.getProtectionManager().hasPermission(\n+                p, b.getLocation(), ProtectableAction.ACCESS_INVENTORIES))\n+                && Slimefun.hasUnlocked(e.getPlayer(), item, false)\n+            ) {\n+\n+                SlimefunPlugin.getGPSNetwork().getResourceManager().scan(p, b, 0);\n+            } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37f0715156dd8a8f7228f532daf9e3aeec34a2a4"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3NzUxNw==", "bodyText": "This check is redundant as it's already done before this handler is called.", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#discussion_r500677517", "createdAt": "2020-10-07T00:58:57Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/geo/GEOScanner.java", "diffHunk": "@@ -19,10 +22,22 @@ public GEOScanner(Category category, SlimefunItemStack item, RecipeType recipeTy\n     @Override\n     public BlockUseHandler getItemHandler() {\n         return e -> {\n+            e.cancel();\n+\n             Block b = e.getClickedBlock().get();\n+            Player p = e.getPlayer();\n \n-            e.cancel();\n-            SlimefunPlugin.getGPSNetwork().getResourceManager().scan(e.getPlayer(), b, 0);\n+            if (p.hasPermission(\"slimefun.inventory.bypass\")\n+                || (SlimefunPlugin.getProtectionManager().hasPermission(\n+                p, b.getLocation(), ProtectableAction.ACCESS_INVENTORIES))\n+                && Slimefun.hasUnlocked(e.getPlayer(), item, false)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37f0715156dd8a8f7228f532daf9e3aeec34a2a4"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3NzU0MQ==", "bodyText": "This check is redundant as it's already done before this handler is called.", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#discussion_r500677541", "createdAt": "2020-10-07T00:59:02Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/gps/GPSControlPanel.java", "diffHunk": "@@ -17,6 +20,22 @@ public GPSControlPanel(Category category, SlimefunItemStack item, RecipeType rec\n \n     @Override\n     public BlockUseHandler getItemHandler() {\n-        return e -> SlimefunPlugin.getGPSNetwork().openTransmitterControlPanel(e.getPlayer());\n+        return e ->  {\n+            e.cancel();\n+\n+            Player p = e.getPlayer();\n+\n+            if (p.hasPermission(\"slimefun.inventory.bypass\")\n+                || (SlimefunPlugin.getProtectionManager().hasPermission(\n+                p, e.getClickedBlock().get().getLocation(), ProtectableAction.ACCESS_INVENTORIES))\n+                && Slimefun.hasUnlocked(p, item, false)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37f0715156dd8a8f7228f532daf9e3aeec34a2a4"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3NzY1MA==", "bodyText": "You should really have a designated permissions node for this, it's not an inventory.", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#discussion_r500677650", "createdAt": "2020-10-07T00:59:29Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/gps/GPSControlPanel.java", "diffHunk": "@@ -17,6 +20,22 @@ public GPSControlPanel(Category category, SlimefunItemStack item, RecipeType rec\n \n     @Override\n     public BlockUseHandler getItemHandler() {\n-        return e -> SlimefunPlugin.getGPSNetwork().openTransmitterControlPanel(e.getPlayer());\n+        return e ->  {\n+            e.cancel();\n+\n+            Player p = e.getPlayer();\n+\n+            if (p.hasPermission(\"slimefun.inventory.bypass\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37f0715156dd8a8f7228f532daf9e3aeec34a2a4"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDY3NzY4MQ==", "bodyText": "You should really have a designated permissions node for this, it's not an inventory.", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#discussion_r500677681", "createdAt": "2020-10-07T00:59:34Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/geo/GEOScanner.java", "diffHunk": "@@ -19,10 +22,22 @@ public GEOScanner(Category category, SlimefunItemStack item, RecipeType recipeTy\n     @Override\n     public BlockUseHandler getItemHandler() {\n         return e -> {\n+            e.cancel();\n+\n             Block b = e.getClickedBlock().get();\n+            Player p = e.getPlayer();\n \n-            e.cancel();\n-            SlimefunPlugin.getGPSNetwork().getResourceManager().scan(e.getPlayer(), b, 0);\n+            if (p.hasPermission(\"slimefun.inventory.bypass\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37f0715156dd8a8f7228f532daf9e3aeec34a2a4"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b577c1e4a369fe954420ecb7b2fe0aa2cd1ce5d7", "author": {"user": {"login": "NCBPFluffyBear", "name": "FluffyBear"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/b577c1e4a369fe954420ecb7b2fe0aa2cd1ce5d7", "committedDate": "2020-10-07T18:45:49Z", "message": "Did changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MTc3OTUz", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#pullrequestreview-504177953", "createdAt": "2020-10-07T18:56:49Z", "commit": {"oid": "b577c1e4a369fe954420ecb7b2fe0aa2cd1ce5d7"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0MjM1MjA5", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#pullrequestreview-504235209", "createdAt": "2020-10-07T20:19:37Z", "commit": {"oid": "b577c1e4a369fe954420ecb7b2fe0aa2cd1ce5d7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QyMDoxOTozN1rOHeEAhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QyMDoyMDo0NlrOHeEDBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4NDk5OA==", "bodyText": "Misplaced imports.", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#discussion_r501284998", "createdAt": "2020-10-07T20:19:37Z", "author": {"login": "LinoxGH"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/geo/GEOScanner.java", "diffHunk": "@@ -1,6 +1,9 @@\n package io.github.thebusybiscuit.slimefun4.implementation.items.geo;\n \n+import io.github.thebusybiscuit.cscorelib2.protection.ProtectableAction;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b577c1e4a369fe954420ecb7b2fe0aa2cd1ce5d7"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTI4NTYzNg==", "bodyText": "Misplaced imports.", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#discussion_r501285636", "createdAt": "2020-10-07T20:20:46Z", "author": {"login": "LinoxGH"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/items/gps/GPSControlPanel.java", "diffHunk": "@@ -1,5 +1,8 @@\n package io.github.thebusybiscuit.slimefun4.implementation.items.gps;\n \n+import io.github.thebusybiscuit.cscorelib2.protection.ProtectableAction;\n+import me.mrCookieSlime.Slimefun.api.Slimefun;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b577c1e4a369fe954420ecb7b2fe0aa2cd1ce5d7"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90ccbb2261d0da148454f551b51853f8e00aae2b", "author": {"user": {"login": "NCBPFluffyBear", "name": "FluffyBear"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/90ccbb2261d0da148454f551b51853f8e00aae2b", "committedDate": "2020-10-07T22:37:41Z", "message": "Organized imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NDMwNTEz", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#pullrequestreview-504430513", "createdAt": "2020-10-08T05:03:56Z", "commit": {"oid": "90ccbb2261d0da148454f551b51853f8e00aae2b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0NzI5OTY5", "url": "https://github.com/Slimefun/Slimefun4/pull/2402#pullrequestreview-504729969", "createdAt": "2020-10-08T12:30:14Z", "commit": {"oid": "90ccbb2261d0da148454f551b51853f8e00aae2b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2380, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}