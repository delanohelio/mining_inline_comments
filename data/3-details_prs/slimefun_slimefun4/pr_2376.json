{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk2MzkzMjIy", "number": 2376, "title": "Attempt to fix bug #2360", "bodyText": "Description\nAttempt to fix a bug where refineries can be used as pistons\nChanges\nChecks if the following condition has been met (Check if the event fired on a piston that has Slimefun block data)\nBlockStorage.check(e.getBlock()) != null\nRelated Issues\nResolves #2360\nChecklist\n\n\n\n I have fully tested the proposed changes and promise that they will not break everything into chaos.\n I have also tested the proposed changes in combination with various popular addons and can confirm my changes do not break them.\n I followed the existing code standards and didn't mess up the formatting.\n I did my best to add documentation to any public classes or methods I added.\n I have added Nonnull and Nullable annotations to my methods to indicate their behaviour for null values\n I added sufficient Unit Tests to cover my code.", "createdAt": "2020-10-01T16:34:46Z", "url": "https://github.com/Slimefun/Slimefun4/pull/2376", "merged": true, "mergeCommit": {"oid": "7d5c34a8c68a2d026ccc972ebcefcfab89b39e37"}, "closed": true, "closedAt": "2020-10-01T18:28:52Z", "author": {"login": "Chlorophytus"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdOT-W8gH2gAyNDk2MzkzMjIyOmNiYzQ4NTg0YmNjMTRjNmQ4Y2Q0ZDM0OGM1ZTNmMDQ2MWEwYTA5OTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOVbmuAFqTUwMDU5OTI3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990", "author": {"user": {"login": "Chlorophytus", "name": "Roland Metivier"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990", "committedDate": "2020-10-01T16:28:29Z", "message": "Attempt to fix bug #2360"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNTMxNzIw", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#pullrequestreview-500531720", "createdAt": "2020-10-01T16:40:40Z", "commit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNjo0MDo0MFrOHbSsTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNjo0MToyNVrOHbSt-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODM3OTg1Mg==", "bodyText": "Please use BlockStorage#hasBlockInfo() instead. Also, formatting (put a space after if)", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#discussion_r498379852", "createdAt": "2020-10-01T16:40:40Z", "author": {"login": "poma123"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/BlockPhysicsListener.java", "diffHunk": "@@ -54,17 +55,23 @@ public void onBlockFall(EntityChangeBlockEvent e) {\n \n     @EventHandler\n     public void onPistonExtend(BlockPistonExtendEvent e) {\n-        for (Block b : e.getBlocks()) {\n-            if (BlockStorage.hasBlockInfo(b) || (b.getRelative(e.getDirection()).getType() == Material.AIR && BlockStorage.hasBlockInfo(b.getRelative(e.getDirection())))) {\n-                e.setCancelled(true);\n-                return;\n+        if(BlockStorage.check(e.getBlock()) != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODM4MDI4MA==", "bodyText": "Please use BlockStorage#hasBlockInfo() instead. Also, formatting (put a space after if)", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#discussion_r498380280", "createdAt": "2020-10-01T16:41:25Z", "author": {"login": "poma123"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/BlockPhysicsListener.java", "diffHunk": "@@ -54,17 +55,23 @@ public void onBlockFall(EntityChangeBlockEvent e) {\n \n     @EventHandler\n     public void onPistonExtend(BlockPistonExtendEvent e) {\n-        for (Block b : e.getBlocks()) {\n-            if (BlockStorage.hasBlockInfo(b) || (b.getRelative(e.getDirection()).getType() == Material.AIR && BlockStorage.hasBlockInfo(b.getRelative(e.getDirection())))) {\n-                e.setCancelled(true);\n-                return;\n+        if(BlockStorage.check(e.getBlock()) != null) {\n+            e.setCancelled(true);\n+        } else {\n+            for (Block b : e.getBlocks()) {\n+                if (BlockStorage.hasBlockInfo(b) || (b.getRelative(e.getDirection()).getType() == Material.AIR && BlockStorage.hasBlockInfo(b.getRelative(e.getDirection())))) {\n+                    e.setCancelled(true);\n+                    return;\n+                }\n             }\n         }\n     }\n \n     @EventHandler\n     public void onPistonRetract(BlockPistonRetractEvent e) {\n-        if (e.isSticky()) {\n+        if(BlockStorage.check(e.getBlock()) != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNTMzODc0", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#pullrequestreview-500533874", "createdAt": "2020-10-01T16:43:32Z", "commit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNjo0MzozMlrOHbSydA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNjo0MzozMlrOHbSydA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODM4MTQyOA==", "bodyText": "Please put else { to a new line.", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#discussion_r498381428", "createdAt": "2020-10-01T16:43:32Z", "author": {"login": "poma123"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/BlockPhysicsListener.java", "diffHunk": "@@ -54,17 +55,23 @@ public void onBlockFall(EntityChangeBlockEvent e) {\n \n     @EventHandler\n     public void onPistonExtend(BlockPistonExtendEvent e) {\n-        for (Block b : e.getBlocks()) {\n-            if (BlockStorage.hasBlockInfo(b) || (b.getRelative(e.getDirection()).getType() == Material.AIR && BlockStorage.hasBlockInfo(b.getRelative(e.getDirection())))) {\n-                e.setCancelled(true);\n-                return;\n+        if(BlockStorage.check(e.getBlock()) != null) {\n+            e.setCancelled(true);\n+        } else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNTM0NTk1", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#pullrequestreview-500534595", "createdAt": "2020-10-01T16:44:29Z", "commit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNjo0NDoyOVrOHbS0bA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNjo0NDoyOVrOHbS0bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODM4MTkzMg==", "bodyText": "This is redundant.", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#discussion_r498381932", "createdAt": "2020-10-01T16:44:29Z", "author": {"login": "LinoxGH"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/BlockPhysicsListener.java", "diffHunk": "@@ -54,17 +55,23 @@ public void onBlockFall(EntityChangeBlockEvent e) {\n \n     @EventHandler\n     public void onPistonExtend(BlockPistonExtendEvent e) {\n-        for (Block b : e.getBlocks()) {\n-            if (BlockStorage.hasBlockInfo(b) || (b.getRelative(e.getDirection()).getType() == Material.AIR && BlockStorage.hasBlockInfo(b.getRelative(e.getDirection())))) {\n-                e.setCancelled(true);\n-                return;\n+        if(BlockStorage.check(e.getBlock()) != null) {\n+            e.setCancelled(true);\n+        } else {\n+            for (Block b : e.getBlocks()) {\n+                if (BlockStorage.hasBlockInfo(b) || (b.getRelative(e.getDirection()).getType() == Material.AIR && BlockStorage.hasBlockInfo(b.getRelative(e.getDirection())))) {\n+                    e.setCancelled(true);\n+                    return;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNTM2MTM5", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#pullrequestreview-500536139", "createdAt": "2020-10-01T16:46:30Z", "commit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNjo0NjozMFrOHbS4mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNjo0NjozMFrOHbS4mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODM4MzAwMw==", "bodyText": "Put else if to a new line please", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#discussion_r498383003", "createdAt": "2020-10-01T16:46:30Z", "author": {"login": "poma123"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/listeners/BlockPhysicsListener.java", "diffHunk": "@@ -54,17 +55,23 @@ public void onBlockFall(EntityChangeBlockEvent e) {\n \n     @EventHandler\n     public void onPistonExtend(BlockPistonExtendEvent e) {\n-        for (Block b : e.getBlocks()) {\n-            if (BlockStorage.hasBlockInfo(b) || (b.getRelative(e.getDirection()).getType() == Material.AIR && BlockStorage.hasBlockInfo(b.getRelative(e.getDirection())))) {\n-                e.setCancelled(true);\n-                return;\n+        if(BlockStorage.check(e.getBlock()) != null) {\n+            e.setCancelled(true);\n+        } else {\n+            for (Block b : e.getBlocks()) {\n+                if (BlockStorage.hasBlockInfo(b) || (b.getRelative(e.getDirection()).getType() == Material.AIR && BlockStorage.hasBlockInfo(b.getRelative(e.getDirection())))) {\n+                    e.setCancelled(true);\n+                    return;\n+                }\n             }\n         }\n     }\n \n     @EventHandler\n     public void onPistonRetract(BlockPistonRetractEvent e) {\n-        if (e.isSticky()) {\n+        if(BlockStorage.check(e.getBlock()) != null) {\n+            e.setCancelled(true);\n+        } else if (e.isSticky()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbc48584bcc14c6d8cd4d348c5e3f0461a0a0990"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a074e7cc1767483c0c66c5f7b89b5782a3a74966", "author": {"user": {"login": "Chlorophytus", "name": "Roland Metivier"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/a074e7cc1767483c0c66c5f7b89b5782a3a74966", "committedDate": "2020-10-01T17:32:17Z", "message": "Fix formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b327c55b5fec399260d69c955177eca2fb844ddc", "author": {"user": {"login": "Chlorophytus", "name": "Roland Metivier"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/b327c55b5fec399260d69c955177eca2fb844ddc", "committedDate": "2020-10-01T17:49:05Z", "message": "Remove redundant return statements"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfc221a7a549d17b7cc22e39a9e09e565562fb11", "author": {"user": {"login": "Chlorophytus", "name": "Roland Metivier"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/bfc221a7a549d17b7cc22e39a9e09e565562fb11", "committedDate": "2020-10-01T17:52:16Z", "message": "Replace w/break instead"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNTg4MDU2", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#pullrequestreview-500588056", "createdAt": "2020-10-01T17:55:11Z", "commit": {"oid": "bfc221a7a549d17b7cc22e39a9e09e565562fb11"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNTkzOTE1", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#pullrequestreview-500593915", "createdAt": "2020-10-01T18:02:56Z", "commit": {"oid": "bfc221a7a549d17b7cc22e39a9e09e565562fb11"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNTk5Mjc2", "url": "https://github.com/Slimefun/Slimefun4/pull/2376#pullrequestreview-500599276", "createdAt": "2020-10-01T18:10:20Z", "commit": {"oid": "bfc221a7a549d17b7cc22e39a9e09e565562fb11"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2340, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}