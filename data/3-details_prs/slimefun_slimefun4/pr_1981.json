{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzODg2ODU2", "number": 1981, "title": "allow null meta", "bodyText": "Description\n\nallow null meta for the itemstackwrapper, since hasitemmeta is checked everywhere first anyways, creating meta for every item that the cargo net checks is pretty expensive\nChanges\n\nRelated Issues\n\n\nChecklist\n\n\n\n[x ] I have fully tested the proposed changes and promise that they will not break everything into chaos.\n[x ] I have also tested the proposed changes in combination with various popular addons and can confirm my changes do not break them.\n[ x] I followed the existing code standards and didn't mess up the formatting.\n[ x] I did my best to add documentation to any public classes or methods I added.\n I added sufficient Unit Tests to cover my code.", "createdAt": "2020-06-12T21:12:51Z", "url": "https://github.com/Slimefun/Slimefun4/pull/1981", "merged": true, "mergeCommit": {"oid": "bc274372ced1ad8a0fe1609519d6548641001135"}, "closed": true, "closedAt": "2020-06-12T22:57:53Z", "author": {"login": "PhanaticD"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqpeKIgH2gAyNDMzODg2ODU2OjZiYzI4ZDZiNjk0MGExMGU3ZjY2YWM2N2RmMGRiYmRhNjBhNWQyNmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqq_jiAFqTQzMDA3NTMxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6bc28d6b6940a10e7f66ac67df0dbbda60a5d26e", "author": {"user": {"login": "PhanaticD", "name": "Josh"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/6bc28d6b6940a10e7f66ac67df0dbbda60a5d26e", "committedDate": "2020-06-12T21:09:57Z", "message": "allow null meta"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDQ0OTQx", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#pullrequestreview-430044941", "createdAt": "2020-06-12T21:22:52Z", "commit": {"oid": "6bc28d6b6940a10e7f66ac67df0dbbda60a5d26e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56bd432719ad6b30b4bfa192a6c3afe28038f986", "author": {"user": {"login": "PhanaticD", "name": "Josh"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/56bd432719ad6b30b4bfa192a6c3afe28038f986", "committedDate": "2020-06-12T21:29:04Z", "message": "check if null in getItemMeta"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDQ5MzE1", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#pullrequestreview-430049315", "createdAt": "2020-06-12T21:33:36Z", "commit": {"oid": "56bd432719ad6b30b4bfa192a6c3afe28038f986"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e989969713d0fc700dd0eba7da148674c7dcb65d", "author": {"user": {"login": "PhanaticD", "name": "Josh"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/e989969713d0fc700dd0eba7da148674c7dcb65d", "committedDate": "2020-06-12T22:01:19Z", "message": "safety check in CustomItemDataService"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDYwNjE4", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#pullrequestreview-430060618", "createdAt": "2020-06-12T22:04:40Z", "commit": {"oid": "e989969713d0fc700dd0eba7da148674c7dcb65d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjowNDo0MFrOGjSvEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjowNDo0MFrOGjSvEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY2MDMwNw==", "bodyText": "You should check hasItemMeta, just like your exception in getItemMeta says ;)", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#discussion_r439660307", "createdAt": "2020-06-12T22:04:40Z", "author": {"login": "WalshyDev"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/services/CustomItemDataService.java", "diffHunk": "@@ -45,6 +45,9 @@ public void setItemData(ItemMeta im, String id) {\n     }\n \n     public Optional<String> getItemData(ItemStack item) {\n+        if (item.getItemMeta() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e989969713d0fc700dd0eba7da148674c7dcb65d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDYwNTM0", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#pullrequestreview-430060534", "createdAt": "2020-06-12T22:04:26Z", "commit": {"oid": "e989969713d0fc700dd0eba7da148674c7dcb65d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjowNDoyNlrOGjSu1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjowNDoyNlrOGjSu1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY2MDI0Nw==", "bodyText": "You should do .hasItemMeta() here (and maybe also add a null-check for the given ItemStack parameter as pointed out before), otherwise you won't gain any performance benefit from this here, since #getItemMeta() (for normal ItemStacks) will create a new instance of ItemMeta and perform a clone operation which is very costly.\nAs Walshy also pointed out, even for ItemStackWrappers this will throw an UnsupportedOperationException now...", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#discussion_r439660247", "createdAt": "2020-06-12T22:04:26Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/services/CustomItemDataService.java", "diffHunk": "@@ -45,6 +45,9 @@ public void setItemData(ItemMeta im, String id) {\n     }\n \n     public Optional<String> getItemData(ItemStack item) {\n+        if (item.getItemMeta() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e989969713d0fc700dd0eba7da148674c7dcb65d"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f8ae4b1829e2a1bcbb4a839ba8d95dab55b0905", "author": {"user": {"login": "PhanaticD", "name": "Josh"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/5f8ae4b1829e2a1bcbb4a839ba8d95dab55b0905", "committedDate": "2020-06-12T22:04:55Z", "message": "don't get it twice"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a232d8285141d86f76f0f3c899c04a99acc5cbe3", "author": {"user": {"login": "PhanaticD", "name": "Josh"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/a232d8285141d86f76f0f3c899c04a99acc5cbe3", "committedDate": "2020-06-12T22:10:06Z", "message": "add check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDYzMjM1", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#pullrequestreview-430063235", "createdAt": "2020-06-12T22:12:47Z", "commit": {"oid": "a232d8285141d86f76f0f3c899c04a99acc5cbe3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjoxMjo0OFrOGjS3kQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjoxMjo0OFrOGjS3kQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY2MjQ4MQ==", "bodyText": "This is redundant, ItemStack#getItemMeta() will never return null, except for ItemStackWrappers but we already handled these in the previous condition. The null-check I suggested was about the ItemStack, not the meta.\nif (item == null || !item.hasItemMeta())", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#discussion_r439662481", "createdAt": "2020-06-12T22:12:48Z", "author": {"login": "TheBusyBiscuit"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/services/CustomItemDataService.java", "diffHunk": "@@ -45,7 +45,14 @@ public void setItemData(ItemMeta im, String id) {\n     }\n \n     public Optional<String> getItemData(ItemStack item) {\n-        return getItemData(item.getItemMeta());\n+        if (!item.hasItemMeta()) {\n+            return Optional.empty();\n+        }\n+        ItemMeta meta = item.getItemMeta();\n+        if (meta == null) {\n+            return Optional.empty();\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a232d8285141d86f76f0f3c899c04a99acc5cbe3"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDYzMzQy", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#pullrequestreview-430063342", "createdAt": "2020-06-12T22:13:08Z", "commit": {"oid": "a232d8285141d86f76f0f3c899c04a99acc5cbe3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjoxMzowOFrOGjS34w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMjoxMzowOFrOGjS34w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY2MjU2Mw==", "bodyText": "This isn't ever null", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#discussion_r439662563", "createdAt": "2020-06-12T22:13:08Z", "author": {"login": "WalshyDev"}, "path": "src/main/java/io/github/thebusybiscuit/slimefun4/core/services/CustomItemDataService.java", "diffHunk": "@@ -45,7 +45,14 @@ public void setItemData(ItemMeta im, String id) {\n     }\n \n     public Optional<String> getItemData(ItemStack item) {\n-        return getItemData(item.getItemMeta());\n+        if (!item.hasItemMeta()) {\n+            return Optional.empty();\n+        }\n+        ItemMeta meta = item.getItemMeta();\n+        if (meta == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a232d8285141d86f76f0f3c899c04a99acc5cbe3"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b4904831b80f8cbe8a05a26ab340c147a5b84a8", "author": {"user": {"login": "PhanaticD", "name": "Josh"}}, "url": "https://github.com/Slimefun/Slimefun4/commit/0b4904831b80f8cbe8a05a26ab340c147a5b84a8", "committedDate": "2020-06-12T22:52:54Z", "message": "update"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDc1MTA2", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#pullrequestreview-430075106", "createdAt": "2020-06-12T22:55:28Z", "commit": {"oid": "0b4904831b80f8cbe8a05a26ab340c147a5b84a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDc1MzEx", "url": "https://github.com/Slimefun/Slimefun4/pull/1981#pullrequestreview-430075311", "createdAt": "2020-06-12T22:56:20Z", "commit": {"oid": "0b4904831b80f8cbe8a05a26ab340c147a5b84a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2543, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}