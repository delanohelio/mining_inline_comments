{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwODE4ODA3", "number": 3720, "title": "Refactor Project to Gradle", "bodyText": "Gradle is better than Maven, don't @ me. okay but actually it's faster, compiles and tests in parallel more efficiently, and more epic stuff).\nTesting:\n\n Builds\n Dependencies are shaded correctly\n Plugins run without error\n Checkstyle rules added\n Verify that Crowdin works correctly (@mdcfe)\n New Maven Repo (@mdcfe)", "createdAt": "2020-10-09T21:01:35Z", "url": "https://github.com/EssentialsX/Essentials/pull/3720", "merged": true, "mergeCommit": {"oid": "9a23f806fe685fe81fa32d6da1661030e121cce8"}, "closed": true, "closedAt": "2020-11-25T20:24:24Z", "author": {"login": "JRoy"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQ9E_YgFqTUwNTk4OTU4Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgETq3gFqTUzODgyNDY0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1OTg5NTg2", "url": "https://github.com/EssentialsX/Essentials/pull/3720#pullrequestreview-505989586", "createdAt": "2020-10-09T21:07:24Z", "commit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQyMTowNzoyNFrOHfYo9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQyMToyODo0NVrOHfZGzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3MTYwNQ==", "bodyText": "why not shadow? this isn't maven.", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502671605", "createdAt": "2020-10-09T21:07:24Z", "author": {"login": "zml2008"}, "path": "shadow.gradle", "diffHunk": "@@ -0,0 +1,14 @@\n+apply plugin: \"com.github.johnrengelman.shadow\"\n+\n+configurations {\n+    shade", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3Mjc0Ng==", "bodyText": "You can reduce duplication here by doing something like:\n[\n  \"\",\n  \"AntiBuild\",\n  \"Chat\",\n  /* ... */\n].each {\n  include(\":EssentialsX$it\")\n  project(\":EssentialsX$it\").projectDir = file(\"Essentials$it\")\n}", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502672746", "createdAt": "2020-10-09T21:10:32Z", "author": {"login": "zml2008"}, "path": "settings.gradle", "diffHunk": "@@ -0,0 +1,36 @@\n+rootProject.name = 'EssentialsXParent'\n+\n+include(':EssentialsX')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3Mjk2NQ==", "bodyText": "maybe skip the custom project directory, just do include(\":providers:BaseProviders\") and update the project deps to match?", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502672965", "createdAt": "2020-10-09T21:11:11Z", "author": {"login": "zml2008"}, "path": "settings.gradle", "diffHunk": "@@ -0,0 +1,36 @@\n+rootProject.name = 'EssentialsXParent'\n+\n+include(':EssentialsX')\n+project(':EssentialsX').projectDir = file('Essentials')\n+\n+// Modules\n+include(':EssentialsXAntiBuild')\n+project(':EssentialsXAntiBuild').projectDir = file('EssentialsAntiBuild')\n+\n+include(':EssentialsXChat')\n+project(':EssentialsXChat').projectDir = file('EssentialsChat')\n+\n+include(':EssentialsXGeoIP')\n+project(':EssentialsXGeoIP').projectDir = file('EssentialsGeoIP')\n+\n+include(':EssentialsXProtect')\n+project(':EssentialsXProtect').projectDir = file('EssentialsProtect')\n+\n+include(':EssentialsXSpawn')\n+project(':EssentialsXSpawn').projectDir = file('EssentialsSpawn')\n+\n+include(':EssentialsXXMPP')\n+project(':EssentialsXXMPP').projectDir = file('EssentialsXMPP')\n+\n+// Providers\n+include(':BaseProviders')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3MzUzOA==", "bodyText": "You should be able to just set the config directory here: https://github.com/KyoriPowered/indra/blob/master/indra-common/src/main/kotlin/net/kyori/indra/IndraCheckstylePlugin.kt#L42", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502673538", "createdAt": "2020-10-09T21:12:51Z", "author": {"login": "zml2008"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NDIzOA==", "bodyText": "You should be able to do an afterEvaluate block, where you only add spigot-api as a dependency if no version of spigot or its forks has been added as a dep yet. That'd let you do this without hardcoding specific project names.", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502674238", "createdAt": "2020-10-09T21:14:51Z", "author": {"login": "zml2008"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NDYxMw==", "bodyText": "You shouldn't be using this -- the plugins block at the top is preferred.\nIf you want a plugin that isn't applied to the root project but is available to subprojects, just add apply false after the version.", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502674613", "createdAt": "2020-10-09T21:15:50Z", "author": {"login": "zml2008"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    buildscript {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NDkwMg==", "bodyText": "Apply the release flag here: https://github.com/KyoriPowered/indra/blob/master/indra-common/src/main/kotlin/net/kyori/indra/IndraPlugin.kt#L57", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502674902", "createdAt": "2020-10-09T21:16:36Z", "author": {"login": "zml2008"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    buildscript {\n+        repositories {\n+            maven {\n+                url \"https://plugins.gradle.org/m2/\"\n+            }\n+        }\n+        dependencies {\n+            classpath \"com.github.jengelman.gradle.plugins:shadow:6.1.0\"\n+        }\n+    }\n+\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": \"${version}.${GIT_DEPTH}\".toString()])\n+    }\n+\n+    sourceCompatibility = '1.8'\n+    compileJava.options.encoding = 'UTF-8'\n+\n+    tasks.withType(JavaCompile) {\n+        options.encoding = 'UTF-8'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NjE1NQ==", "bodyText": "If you're trying to suppress something from Checkstyle, you should be suppressing individual checks, not everything. https://checkstyle.org/config_filters.html#SuppressWarningsFilter might be useful", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502676155", "createdAt": "2020-10-09T21:20:03Z", "author": {"login": "zml2008"}, "path": "Essentials/src/main/java/com/earth2me/essentials/utils/StringUtil.java", "diffHunk": "@@ -8,6 +8,7 @@\n public final class StringUtil {\n     private static final Pattern INVALIDFILECHARS = Pattern.compile(\"[^a-z0-9-]\");\n     private static final Pattern STRICTINVALIDCHARS = Pattern.compile(\"[^a-z0-9]\");\n+    @SuppressWarnings(\"CheckStyle\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3Njk0MA==", "bodyText": "Jitpack should probably be specifically restricted to artifacts that supposed come from there -- at the moment is that just Vault?\nhttps://docs.gradle.org/current/userguide/declaring_repositories.html#sec:repository-content-filtering", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502676940", "createdAt": "2020-10-09T21:22:10Z", "author": {"login": "zml2008"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3NzM4Mg==", "bodyText": "Why are you applying the java and shadow plugins to the root project? There isn't any Java source here.", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502677382", "createdAt": "2020-10-09T21:23:29Z", "author": {"login": "zml2008"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3ODM0MQ==", "bodyText": "you should be able to just do from(it) here -- then you don't have to explicitly declare this task's dependency on the output tasks.", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502678341", "createdAt": "2020-10-09T21:26:15Z", "author": {"login": "zml2008"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    buildscript {\n+        repositories {\n+            maven {\n+                url \"https://plugins.gradle.org/m2/\"\n+            }\n+        }\n+        dependencies {\n+            classpath \"com.github.jengelman.gradle.plugins:shadow:6.1.0\"\n+        }\n+    }\n+\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": \"${version}.${GIT_DEPTH}\".toString()])\n+    }\n+\n+    sourceCompatibility = '1.8'\n+    compileJava.options.encoding = 'UTF-8'\n+\n+    tasks.withType(JavaCompile) {\n+        options.encoding = 'UTF-8'\n+    }\n+    tasks.withType(Jar) {\n+        archiveVersion.set(\"${this.version}.${GIT_DEPTH}\".toString())\n+    }\n+}\n+\n+def outputTasks() {\n+    [\":EssentialsX:shadowJar\", \":EssentialsXAntiBuild:jar\", \":EssentialsXChat:jar\",\n+     \":EssentialsXGeoIP:shadowJar\", \":EssentialsXProtect:jar\", \":EssentialsXSpawn:shadowJar\",\n+     \":EssentialsXXMPP:shadowJar\"].stream().map({ tasks.findByPath(it) })\n+}\n+\n+task copyToJars(type: Copy) {\n+    outputTasks().forEach {\n+        println it\n+        from(it.outputs.files)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3ODQyOQ==", "bodyText": "I assume the stuff from here on is left over from an earlier attempt?", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502678429", "createdAt": "2020-10-09T21:26:31Z", "author": {"login": "zml2008"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,143 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'com.github.johnrengelman.shadow' version '6.1.0'\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import com.github.jengelman.gradle.plugins.shadow.tasks.ConfigureShadowRelocation\n+\n+allprojects {\n+    group = 'net.ess3'\n+    version = '2.18.1'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.3-R0.1-SNAPSHOT'\n+}\n+\n+artifacts {\n+    tasks.shadowJar.outputs.files.each {\n+        archives(it) {\n+            builtBy shadowJar\n+        }\n+    }\n+}\n+\n+task relocateShadowJar(type: ConfigureShadowRelocation) {\n+    target = tasks.shadowJar\n+}\n+\n+tasks.shadowJar.dependsOn tasks.relocateShadowJar\n+\n+subprojects {\n+    apply plugin: 'java'\n+    apply plugin: 'java-library'\n+    apply plugin: 'checkstyle'\n+\n+    checkstyle {\n+        toolVersion = \"${checkstyleVersion}\"\n+        showViolations = true\n+        configFile = rootProject.file('.checkstyle/checkstyle.xml')\n+        configProperties = [\"checkstyle.suppressions.file\": rootProject.file('.checkstyle/suppressions.xml')]\n+    }\n+\n+    checkstyleMain {\n+        source = sourceSets.main.allSource\n+    }\n+\n+    tasks.build.dependsOn tasks.checkstyleMain\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven { url = 'https://jitpack.io' }\n+    }\n+\n+    dependencies {\n+        testImplementation 'junit:junit:4.12'\n+        testImplementation 'org.mockito:mockito-core:3.2.0'\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    buildscript {\n+        repositories {\n+            maven {\n+                url \"https://plugins.gradle.org/m2/\"\n+            }\n+        }\n+        dependencies {\n+            classpath \"com.github.jengelman.gradle.plugins:shadow:6.1.0\"\n+        }\n+    }\n+\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": \"${version}.${GIT_DEPTH}\".toString()])\n+    }\n+\n+    sourceCompatibility = '1.8'\n+    compileJava.options.encoding = 'UTF-8'\n+\n+    tasks.withType(JavaCompile) {\n+        options.encoding = 'UTF-8'\n+    }\n+    tasks.withType(Jar) {\n+        archiveVersion.set(\"${this.version}.${GIT_DEPTH}\".toString())\n+    }\n+}\n+\n+def outputTasks() {\n+    [\":EssentialsX:shadowJar\", \":EssentialsXAntiBuild:jar\", \":EssentialsXChat:jar\",\n+     \":EssentialsXGeoIP:shadowJar\", \":EssentialsXProtect:jar\", \":EssentialsXSpawn:shadowJar\",\n+     \":EssentialsXXMPP:shadowJar\"].stream().map({ tasks.findByPath(it) })\n+}\n+\n+task copyToJars(type: Copy) {\n+    outputTasks().forEach {\n+        println it\n+        from(it.outputs.files)\n+    }\n+\n+    rename '(.*)-all.jar', '$1.jar'\n+\n+    into file('jars')\n+}\n+\n+task cleanJars() {\n+    delete file('jars')\n+}\n+\n+build.dependsOn copyToJars\n+clean.dependsOn cleanJars\n+copyToJars.dependsOn tasks.findByPath(\":EssentialsX:processResources\")\n+tasks.build.dependsOn tasks.shadowJar\n+\n+outputTasks().forEach { copyToJars.dependsOn it }\n+\n+compileJava.options.encoding = 'UTF-8'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3ODU5OQ==", "bodyText": "is this supposed to be here?", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502678599", "createdAt": "2020-10-09T21:26:58Z", "author": {"login": "zml2008"}, "path": "gradle/wrapper/gradle-wrapper.properties", "diffHunk": "@@ -0,0 +1,6 @@\n+distributionBase=GRADLE_USER_HOME\n+distributionPath=wrapper/dists\n+distributionUrl=https\\://services.gradle.org/distributions/gradle-6.6.1-bin.zip\n+zipStoreBase=GRADLE_USER_HOME\n+zipStorePath=wrapper/dists\n+org.gral", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjY3OTI0Nw==", "bodyText": "out/ shows up from some IDE setups, probably shouldn't remove it", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r502679247", "createdAt": "2020-10-09T21:28:45Z", "author": {"login": "zml2008"}, "path": ".gitignore", "diffHunk": "@@ -17,6 +17,6 @@\n /Essentials/usermap.csv\n \n # Build files\n-target/\n+.gradle/\n jars/\n-out/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97ee48f9c3069ce9d1a2fcf21540c9bc9a069381"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46fe3f118f46b5dcc05d2696240d7dfbde57b5c3", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/46fe3f118f46b5dcc05d2696240d7dfbde57b5c3", "committedDate": "2020-10-19T21:10:51Z", "message": "Merge branch '2.x' into refactor/gradle"}, "afterCommit": {"oid": "609ce3cf09b21602d44bfa9041f23a32e6a212d1", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/609ce3cf09b21602d44bfa9041f23a32e6a212d1", "committedDate": "2020-10-19T21:12:40Z", "message": "Merge branch '2.x' into refactor/gradle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5590bcce08c20ca49810ab6a00367e56bdfc32ce", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/5590bcce08c20ca49810ab6a00367e56bdfc32ce", "committedDate": "2020-11-16T12:52:47Z", "message": "Merge branch '2.x' into refactor/gradle\n\n# Conflicts:\n#\tEssentials/pom.xml\n#\tEssentialsAntiBuild/pom.xml\n#\tEssentialsChat/pom.xml\n#\tEssentialsGeoIP/pom.xml\n#\tEssentialsProtect/pom.xml\n#\tEssentialsSpawn/pom.xml\n#\tEssentialsXMPP/pom.xml\n#\tpom.xml\n#\tproviders/1_8Provider/pom.xml\n#\tproviders/BaseProviders/pom.xml\n#\tproviders/NMSReflectionProvider/pom.xml\n#\tproviders/PaperProvider/pom.xml"}, "afterCommit": {"oid": "a6edf04a6089ab98756dacfb859ad8d418bdc940", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/a6edf04a6089ab98756dacfb859ad8d418bdc940", "committedDate": "2020-11-16T11:32:40Z", "message": "Release 2.18.2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2MDU0NjA2", "url": "https://github.com/EssentialsX/Essentials/pull/3720#pullrequestreview-536054606", "createdAt": "2020-11-22T11:57:05Z", "commit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "state": "COMMENTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMlQxMTo1NzowNVrOH32YlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMlQxMjoxMDo1MVrOH32e4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNDc1Ng==", "bodyText": "group: bukkit?", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528324756", "createdAt": "2020-11-22T11:57:05Z", "author": {"login": "mdcfe"}, "path": "Essentials/build.gradle", "diffHunk": "@@ -0,0 +1,25 @@\n+dependencies {\n+    compileOnly 'com.github.milkbowl:VaultAPI:1.7'\n+    compileOnly 'net.luckperms:api:5.0'\n+\n+    api 'io.papermc:paperlib:1.0.6-SNAPSHOT'\n+\n+    // Providers\n+    api project(':providers:BaseProviders')\n+    api project(':providers:PaperProvider')\n+    api project(':providers:NMSReflectionProvider')\n+    api(project(':providers:1_8Provider')) {\n+        exclude group: 'bukkit'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTM3OA==", "bodyText": "Shouldn't this be compileOnly?", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325378", "createdAt": "2020-11-22T12:02:38Z", "author": {"login": "mdcfe"}, "path": "EssentialsSpawn/build.gradle", "diffHunk": "@@ -0,0 +1,10 @@\n+dependencies {\n+    implementation project(':EssentialsX')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTQxNw==", "bodyText": "We could consider using EssentialsX's shaded PaperLib instead of shading our own", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325417", "createdAt": "2020-11-22T12:03:19Z", "author": {"login": "mdcfe"}, "path": "EssentialsSpawn/build.gradle", "diffHunk": "@@ -0,0 +1,10 @@\n+dependencies {\n+    implementation project(':EssentialsX')\n+}\n+\n+shadowJar {\n+    dependencies {\n+        include (dependency('io.papermc:paperlib'))\n+    }\n+    relocate 'io.papermc.lib', 'com.earth2me.essentials.spawn.paperlib'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTY4Nw==", "bodyText": "Is this necessary?", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325687", "createdAt": "2020-11-22T12:05:21Z", "author": {"login": "mdcfe"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import net.kyori.indra.data.License\n+\n+allprojects {\n+    group = 'net.essentialsx'\n+    version = '2.19.0-SNAPSHOT'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    fullVersion = \"${version}+${GIT_DEPTH}.${GIT_COMMIT}\".replace(\"-SNAPSHOT\", \"\")\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.4-R0.1-SNAPSHOT'\n+    junit5Version = '5.7.0'\n+    mockitoVersion = '3.2.0'\n+}\n+\n+subprojects {\n+    apply plugin: 'net.kyori.indra'\n+    apply plugin: 'net.kyori.indra.checkstyle'\n+    apply plugin: 'net.kyori.indra.publishing'\n+    apply plugin: 'com.github.johnrengelman.shadow'\n+\n+    repositories {\n+        mavenLocal()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTc4Mg==", "bodyText": "Todo: make root not depend on java plugin, if possible", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325782", "createdAt": "2020-11-22T12:06:03Z", "author": {"login": "mdcfe"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNTg3NQ==", "bodyText": "Also do we still need this?", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528325875", "createdAt": "2020-11-22T12:06:45Z", "author": {"login": "mdcfe"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import net.kyori.indra.data.License\n+\n+allprojects {\n+    group = 'net.essentialsx'\n+    version = '2.19.0-SNAPSHOT'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    fullVersion = \"${version}+${GIT_DEPTH}.${GIT_COMMIT}\".replace(\"-SNAPSHOT\", \"\")\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.4-R0.1-SNAPSHOT'\n+    junit5Version = '5.7.0'\n+    mockitoVersion = '3.2.0'\n+}\n+\n+subprojects {\n+    apply plugin: 'net.kyori.indra'\n+    apply plugin: 'net.kyori.indra.checkstyle'\n+    apply plugin: 'net.kyori.indra.publishing'\n+    apply plugin: 'com.github.johnrengelman.shadow'\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNjA3Nw==", "bodyText": "KyoriPowered/indra#20", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528326077", "createdAt": "2020-11-22T12:08:37Z", "author": {"login": "mdcfe"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import net.kyori.indra.data.License\n+\n+allprojects {\n+    group = 'net.essentialsx'\n+    version = '2.19.0-SNAPSHOT'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    fullVersion = \"${version}+${GIT_DEPTH}.${GIT_COMMIT}\".replace(\"-SNAPSHOT\", \"\")\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.4-R0.1-SNAPSHOT'\n+    junit5Version = '5.7.0'\n+    mockitoVersion = '3.2.0'\n+}\n+\n+subprojects {\n+    apply plugin: 'net.kyori.indra'\n+    apply plugin: 'net.kyori.indra.checkstyle'\n+    apply plugin: 'net.kyori.indra.publishing'\n+    apply plugin: 'com.github.johnrengelman.shadow'\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven {\n+            url = 'https://jitpack.io'\n+            content {\n+                includeGroup \"com.github.milkbowl\"\n+            }\n+        }\n+    }\n+\n+    dependencies {\n+        testImplementation \"org.junit.jupiter:junit-jupiter:${junit5Version}\"\n+        testRuntimeOnly \"org.junit.vintage:junit-vintage-engine:${junit5Version}\"\n+        testImplementation \"org.mockito:mockito-core:${mockitoVersion}\"\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    // Version Injection\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": fullVersion])\n+    }\n+\n+    indra {\n+        checkstyle = \"$checkstyleVersion\"\n+\n+        github('EssentialsX', 'Essentials')\n+        license = new License(\n+                'GPL-3.0-only',\n+                'GNU General Public License version 3',\n+                'https://opensource.org/licenses/GPL-3.0'\n+        )\n+\n+        publishReleasesTo('essx', 'https://repo.essentialsx.net/releases/')\n+        publishSnapshotsTo('essx', 'https://repo.essentialsx.net/snapshots/')\n+\n+        configurePublications {\n+            pom {\n+                description = 'The essential plugin suite for Minecraft servers.'\n+                url = 'https://essentialsx.net'\n+                developers {\n+                    developer {\n+                        id = 'mdcfe'\n+                        name = 'MD'\n+                        email = 'md@n3fs.co.uk'\n+                    }\n+                    developer {\n+                        id = 'pop4959'\n+                    }\n+                    developer {\n+                        id = 'JRoy'\n+                        name = 'Josh Roy'\n+                    }\n+                }\n+                ciManagement {\n+                    system = 'Jenkins'\n+                    url = 'https://ci.ender.zone/job/EssentialsX'\n+                }\n+            }\n+        }\n+    }\n+\n+    tasks.withType(Sign) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 117}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNjEyMA==", "bodyText": "KyoriPowered/indra#19", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528326120", "createdAt": "2020-11-22T12:09:01Z", "author": {"login": "mdcfe"}, "path": "build.gradle", "diffHunk": "@@ -0,0 +1,161 @@\n+plugins {\n+    id 'org.ajoberstar.grgit' version '4.1.0'\n+    id 'net.kyori.indra' version '1.0.2' apply false\n+    id 'net.kyori.indra.checkstyle' version '1.0.2' apply false\n+    id 'net.kyori.indra.publishing' version '1.0.2' apply false\n+    id 'com.github.johnrengelman.shadow' version '6.1.0' apply false\n+    id 'java'\n+}\n+\n+import org.apache.tools.ant.filters.ReplaceTokens\n+import net.kyori.indra.data.License\n+\n+allprojects {\n+    group = 'net.essentialsx'\n+    version = '2.19.0-SNAPSHOT'\n+}\n+\n+def commitsSinceLastTag() {\n+    def tags = grgit.tag.list().stream().map({it.commit}).toList()\n+    def commit = grgit.head()\n+    def depth = 0\n+    while (true) {\n+        if (tags.contains(commit))\n+            return depth\n+        depth++\n+        commit = grgit.resolve.toCommit(commit.parentIds.get(0))\n+    }\n+}\n+\n+ext {\n+    GIT_COMMIT = grgit.head().abbreviatedId\n+    GIT_DEPTH = commitsSinceLastTag()\n+\n+    fullVersion = \"${version}+${GIT_DEPTH}.${GIT_COMMIT}\".replace(\"-SNAPSHOT\", \"\")\n+\n+    checkstyleVersion = '8.36.2'\n+    spigotVersion = '1.16.4-R0.1-SNAPSHOT'\n+    junit5Version = '5.7.0'\n+    mockitoVersion = '3.2.0'\n+}\n+\n+subprojects {\n+    apply plugin: 'net.kyori.indra'\n+    apply plugin: 'net.kyori.indra.checkstyle'\n+    apply plugin: 'net.kyori.indra.publishing'\n+    apply plugin: 'com.github.johnrengelman.shadow'\n+\n+    repositories {\n+        mavenLocal()\n+        mavenCentral()\n+        maven { url = 'https://ci.ender.zone/plugin/repository/everything/' }\n+        maven { url = 'https://hub.spigotmc.org/nexus/content/groups/public/' }\n+        maven { url = 'https://papermc.io/repo/repository/maven-public/' }\n+        maven {\n+            url = 'https://jitpack.io'\n+            content {\n+                includeGroup \"com.github.milkbowl\"\n+            }\n+        }\n+    }\n+\n+    dependencies {\n+        testImplementation \"org.junit.jupiter:junit-jupiter:${junit5Version}\"\n+        testRuntimeOnly \"org.junit.vintage:junit-vintage-engine:${junit5Version}\"\n+        testImplementation \"org.mockito:mockito-core:${mockitoVersion}\"\n+\n+        if (project.name != \"1_8Provider\" && project.name != \"PaperProvider\" && project.name != \"NMSReflectionProvider\") { // These providers use their own bukkit versions\n+            api \"org.spigotmc:spigot-api:${spigotVersion}\"\n+        }\n+    }\n+\n+    // Version Injection\n+    processResources {\n+        filter(ReplaceTokens, beginToken: '${',\n+                endToken: '}', tokens: [\"full.version\": fullVersion])\n+    }\n+\n+    indra {\n+        checkstyle = \"$checkstyleVersion\"\n+\n+        github('EssentialsX', 'Essentials')\n+        license = new License(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNjMyMA==", "bodyText": "Again group: bukkit?", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528326320", "createdAt": "2020-11-22T12:10:24Z", "author": {"login": "mdcfe"}, "path": "providers/1_8Provider/build.gradle", "diffHunk": "@@ -0,0 +1,5 @@\n+dependencies {\n+    api(project(':providers:NMSReflectionProvider')) {\n+        exclude group: 'bukkit'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMyNjM2OQ==", "bodyText": "1.16.4?", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r528326369", "createdAt": "2020-11-22T12:10:51Z", "author": {"login": "mdcfe"}, "path": "providers/PaperProvider/build.gradle", "diffHunk": "@@ -0,0 +1,4 @@\n+dependencies {\n+    implementation project(':providers:BaseProviders')\n+    compileOnly 'com.destroystokyo.paper:paper-api:1.16.3-R0.1-SNAPSHOT'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c41a4e7bf2ccb58c50d27632ee24b409038992fd"}, "originalPosition": 3}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4e71ad7286c1644451a14fc0dbf55e99f7f60cfc", "author": {"user": {"login": "mdcfe", "name": "MD"}}, "url": "https://github.com/EssentialsX/Essentials/commit/4e71ad7286c1644451a14fc0dbf55e99f7f60cfc", "committedDate": "2020-11-24T21:56:54Z", "message": "Only apply java plugin to subprojects"}, "afterCommit": {"oid": "8cde9d51c5391d9e9a5409815efbc0ff106cc3ee", "author": {"user": {"login": "mdcfe", "name": "MD"}}, "url": "https://github.com/EssentialsX/Essentials/commit/8cde9d51c5391d9e9a5409815efbc0ff106cc3ee", "committedDate": "2020-11-24T22:17:12Z", "message": "Only apply java plugin to subprojects"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4NjI4Nzk5", "url": "https://github.com/EssentialsX/Essentials/pull/3720#pullrequestreview-538628799", "createdAt": "2020-11-25T15:45:18Z", "commit": {"oid": "8cde9d51c5391d9e9a5409815efbc0ff106cc3ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxNTo0NToxOFrOH55UHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQxNTo0NToxOFrOH55UHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDQ2OTkxOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  if: ${{ success() && github.event_name == 'push' && github.ref == 'refs/head/2.x' }}\n          \n          \n            \n                  if: ${{ success() && github.event_name == 'push' && github.repository == 'EssentialsX/Essentials' && github.ref == 'refs/head/2.x' }}", "url": "https://github.com/EssentialsX/Essentials/pull/3720#discussion_r530469918", "createdAt": "2020-11-25T15:45:18Z", "author": {"login": "mdcfe"}, "path": ".github/workflows/build.yml", "diffHunk": "@@ -2,37 +2,47 @@ name: Build EssentialsX\n \n on:\n   push:\n-    branches: \n+    branches:\n     - 2.x\n     - mc/*\n   pull_request:\n-    branches: \n+    branches:\n     - 2.x\n \n jobs:\n   build:\n-\n+    name: Build and upload\n     runs-on: ubuntu-latest\n \n     steps:\n     - name: Checkout Git repo\n-      uses: actions/checkout@v1\n-    - name: Restore Maven cache\n-      uses: actions/cache@v1\n+      uses: actions/checkout@v2\n+      with:\n+        fetch-depth: 0\n+    - name: Restore Gradle cache\n+      uses: actions/cache@v2\n       with:\n-        path: ~/.m2/repository\n-        key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}\n+        path: ~/.gradle/caches\n+        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}\n         restore-keys: |\n-          ${{ runner.os }}-maven-\n+          ${{ runner.os }}-gradle-\n     - name: Set up JDK 1.8\n       uses: actions/setup-java@v1\n       with:\n         java-version: 1.8\n-    - name: Build with Maven\n-      run: mvn package verify --file pom.xml\n-    - name: Copy artifacts\n-      run: mkdir -p ./out/ && cp -t ./out/ **/target/Essentials*.jar\n-    - uses: actions/upload-artifact@master\n+    - name: Build with Gradle\n+      run: |\n+        chmod +x gradlew\n+        ./gradlew build --stacktrace\n+    - name: Deploy with Gradle\n+      if: ${{ success() && github.event_name == 'push' && github.ref == 'refs/head/2.x' }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cde9d51c5391d9e9a5409815efbc0ff106cc3ee"}, "originalPosition": 51}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cd6a2175c2a73bd3eb65837510a42dd62d37dba", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/5cd6a2175c2a73bd3eb65837510a42dd62d37dba", "committedDate": "2020-11-25T16:17:27Z", "message": "Convert project to Gradle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a682b066c44ce120c3796d75d01fe9c5aeb0c211", "author": {"user": {"login": "mdcfe", "name": "MD"}}, "url": "https://github.com/EssentialsX/Essentials/commit/a682b066c44ce120c3796d75d01fe9c5aeb0c211", "committedDate": "2020-11-25T16:06:58Z", "message": "Add -dev to dev build version strings"}, "afterCommit": {"oid": "5cd6a2175c2a73bd3eb65837510a42dd62d37dba", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/5cd6a2175c2a73bd3eb65837510a42dd62d37dba", "committedDate": "2020-11-25T16:17:27Z", "message": "Convert project to Gradle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4ODI0NjQ1", "url": "https://github.com/EssentialsX/Essentials/pull/3720#pullrequestreview-538824645", "createdAt": "2020-11-25T20:23:55Z", "commit": {"oid": "5cd6a2175c2a73bd3eb65837510a42dd62d37dba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4402, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}