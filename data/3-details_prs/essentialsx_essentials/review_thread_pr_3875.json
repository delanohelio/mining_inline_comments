{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1NzUzMDU0", "number": 3875, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDozMDoyNFrOFKhb0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMjozODozMFrOFKh-xQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2NTc3ODczOnYy", "diffSide": "RIGHT", "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commanddelwarp.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDozMDoyNFrOINTp3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDozMDoyNFrOINTp3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgyNDQxMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Location location = ess.getWarps().getWarp(args[0]);\n          \n          \n            \n                    final Location location = ess.getWarps().getWarp(args[0]);", "url": "https://github.com/EssentialsX/Essentials/pull/3875#discussion_r550824412", "createdAt": "2021-01-02T00:30:24Z", "author": {"login": "JRoy"}, "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commanddelwarp.java", "diffHunk": "@@ -19,9 +22,18 @@ public void run(final Server server, final CommandSource sender, final String co\n         if (args.length == 0) {\n             throw new NotEnoughArgumentsException();\n         }\n-\n-        ess.getWarps().removeWarp(args[0]);\n-        sender.sendMessage(tl(\"deleteWarp\", args[0]));\n+        //Check if warp exists before calling the event\n+        Location location = ess.getWarps().getWarp(args[0]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9405936e4c15b2ec71cebe0091551fbdab47a88"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2NTc3OTAyOnYy", "diffSide": "RIGHT", "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commanddelwarp.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDozMDo0NFrOINTp-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDozMDo0NFrOINTp-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgyNDQ0MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (event.isCancelled()) {\n          \n          \n            \n                            return;\n          \n          \n            \n                        }\n          \n          \n            \n                        Bukkit.getServer().getPluginManager().callEvent(event);\n          \n          \n            \n                        Bukkit.getServer().getPluginManager().callEvent(event);\n          \n          \n            \n                        if (event.isCancelled()) {\n          \n          \n            \n                            return;\n          \n          \n            \n                        }", "url": "https://github.com/EssentialsX/Essentials/pull/3875#discussion_r550824441", "createdAt": "2021-01-02T00:30:44Z", "author": {"login": "JRoy"}, "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commanddelwarp.java", "diffHunk": "@@ -19,9 +22,18 @@ public void run(final Server server, final CommandSource sender, final String co\n         if (args.length == 0) {\n             throw new NotEnoughArgumentsException();\n         }\n-\n-        ess.getWarps().removeWarp(args[0]);\n-        sender.sendMessage(tl(\"deleteWarp\", args[0]));\n+        //Check if warp exists before calling the event\n+        Location location = ess.getWarps().getWarp(args[0]);\n+        if (location != null) {\n+            final WarpModifyEvent event = new WarpModifyEvent(sender.getUser(this.ess), args[0], location, null, WarpModifyEvent.WarpModifyCause.DELETE);\n+            if (event.isCancelled()) {\n+                return;\n+            }\n+            Bukkit.getServer().getPluginManager().callEvent(event);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9405936e4c15b2ec71cebe0091551fbdab47a88"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2NTc3OTQyOnYy", "diffSide": "RIGHT", "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commandsetwarp.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDozMToyOFrOINTqIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDozMToyOFrOINTqIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgyNDQ4Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (event.isCancelled()) {\n          \n          \n            \n                            return;\n          \n          \n            \n                        }\n          \n          \n            \n                        Bukkit.getServer().getPluginManager().callEvent(event);\n          \n          \n            \n                        Bukkit.getServer().getPluginManager().callEvent(event);\n          \n          \n            \n                        if (event.isCancelled()) {\n          \n          \n            \n                            return;\n          \n          \n            \n                        }", "url": "https://github.com/EssentialsX/Essentials/pull/3875#discussion_r550824483", "createdAt": "2021-01-02T00:31:28Z", "author": {"login": "JRoy"}, "path": "Essentials/src/main/java/com/earth2me/essentials/commands/Commandsetwarp.java", "diffHunk": "@@ -32,8 +34,19 @@ public void run(final Server server, final User user, final String commandLabel,\n             warpLoc = warps.getWarp(args[0]);\n         } catch (final WarpNotFoundException | InvalidWorldException ignored) {\n         }\n-\n-        if (warpLoc == null || user.isAuthorized(\"essentials.warp.overwrite.\" + StringUtil.safeString(args[0]))) {\n+        if (warpLoc == null) {\n+            final WarpModifyEvent event = new WarpModifyEvent(user, args[0], null, user.getLocation(), WarpModifyEvent.WarpModifyCause.CREATE);\n+            if (event.isCancelled()) {\n+                return;\n+            }\n+            Bukkit.getServer().getPluginManager().callEvent(event);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9405936e4c15b2ec71cebe0091551fbdab47a88"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2NTc4MDA3OnYy", "diffSide": "RIGHT", "path": "Essentials/src/main/java/net/essentialsx/api/v2/events/WarpModifyEvent.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDozMjozMlrOINTqbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDozMjozMlrOINTqbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgyNDU1Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n                private static final HandlerList handlers = new HandlerList();\n          \n          \n            \n                private static final HandlerList handlers = new HandlerList();", "url": "https://github.com/EssentialsX/Essentials/pull/3875#discussion_r550824557", "createdAt": "2021-01-02T00:32:32Z", "author": {"login": "JRoy"}, "path": "Essentials/src/main/java/net/essentialsx/api/v2/events/WarpModifyEvent.java", "diffHunk": "@@ -0,0 +1,84 @@\n+package net.essentialsx.api.v2.events;\n+\n+import net.ess3.api.IUser;\n+import org.bukkit.Location;\n+import org.bukkit.event.Cancellable;\n+import org.bukkit.event.Event;\n+import org.bukkit.event.HandlerList;\n+\n+/**\n+ * Called when a warp is about to be modified.\n+ * Includes creation and deletion as described in {@link WarpModifyCause}.\n+ */\n+public class WarpModifyEvent extends Event implements Cancellable {\n+\n+    private static final HandlerList handlers = new HandlerList();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9405936e4c15b2ec71cebe0091551fbdab47a88"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2NTc4ODg5OnYy", "diffSide": "RIGHT", "path": "Essentials/src/main/java/net/essentialsx/api/v2/events/WarpModifyEvent.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDo0NToyOFrOINTuIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDo0NToyOFrOINTuIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgyNTUwNA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n                public HandlerList getHandlers() {\n          \n          \n            \n                    return handlers;\n          \n          \n            \n                }\n          \n          \n            \n            \n          \n          \n            \n                public static HandlerList getHandlerList() {\n          \n          \n            \n                    return handlers;\n          \n          \n            \n                }", "url": "https://github.com/EssentialsX/Essentials/pull/3875#discussion_r550825504", "createdAt": "2021-01-02T00:45:28Z", "author": {"login": "JRoy"}, "path": "Essentials/src/main/java/net/essentialsx/api/v2/events/WarpModifyEvent.java", "diffHunk": "@@ -0,0 +1,84 @@\n+package net.essentialsx.api.v2.events;\n+\n+import net.ess3.api.IUser;\n+import org.bukkit.Location;\n+import org.bukkit.event.Cancellable;\n+import org.bukkit.event.Event;\n+import org.bukkit.event.HandlerList;\n+\n+/**\n+ * Called when a warp is about to be modified.\n+ * Includes creation and deletion as described in {@link WarpModifyCause}.\n+ */\n+public class WarpModifyEvent extends Event implements Cancellable {\n+\n+    private static final HandlerList handlers = new HandlerList();\n+    private final IUser issuer;\n+    private final String warpName;\n+    private final Location oldLocation;\n+    private final Location newLocation;\n+    private final WarpModifyCause cause;\n+    private boolean cancelled;\n+\n+\n+    /**\n+     * @param issuer      the {@link IUser} issuing the command\n+     * @param warpName    the name of the warp that's being altered\n+     * @param oldLocation the old location before being modified. Null if {@link WarpModifyCause#CREATE}.\n+     * @param newLocation the new location after being modified. Null if {@link WarpModifyCause#DELETE}.\n+     * @param cause       the cause of change.\n+     */\n+    public WarpModifyEvent(IUser issuer, String warpName, Location oldLocation, Location newLocation, WarpModifyCause cause) {\n+        this.issuer = issuer;\n+        this.warpName = warpName;\n+        this.oldLocation = oldLocation;\n+        this.newLocation = newLocation;\n+        this.cause = cause;\n+    }\n+\n+    public HandlerList getHandlers() {\n+        return handlers;\n+    }\n+\n+    public static HandlerList getHandlerList() {\n+        return handlers;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9405936e4c15b2ec71cebe0091551fbdab47a88"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2NTc4OTI1OnYy", "diffSide": "RIGHT", "path": "Essentials/src/main/java/net/essentialsx/api/v2/events/WarpModifyEvent.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDo0NjowMVrOINTuRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMDo0NjowMVrOINTuRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgyNTU0MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                }\n          \n          \n            \n                }\n          \n          \n            \n                \n          \n          \n            \n                public HandlerList getHandlers() {\n          \n          \n            \n                    return handlers;\n          \n          \n            \n                }\n          \n          \n            \n            \n          \n          \n            \n                public static HandlerList getHandlerList() {\n          \n          \n            \n                    return handlers;\n          \n          \n            \n                }", "url": "https://github.com/EssentialsX/Essentials/pull/3875#discussion_r550825541", "createdAt": "2021-01-02T00:46:01Z", "author": {"login": "JRoy"}, "path": "Essentials/src/main/java/net/essentialsx/api/v2/events/WarpModifyEvent.java", "diffHunk": "@@ -0,0 +1,84 @@\n+package net.essentialsx.api.v2.events;\n+\n+import net.ess3.api.IUser;\n+import org.bukkit.Location;\n+import org.bukkit.event.Cancellable;\n+import org.bukkit.event.Event;\n+import org.bukkit.event.HandlerList;\n+\n+/**\n+ * Called when a warp is about to be modified.\n+ * Includes creation and deletion as described in {@link WarpModifyCause}.\n+ */\n+public class WarpModifyEvent extends Event implements Cancellable {\n+\n+    private static final HandlerList handlers = new HandlerList();\n+    private final IUser issuer;\n+    private final String warpName;\n+    private final Location oldLocation;\n+    private final Location newLocation;\n+    private final WarpModifyCause cause;\n+    private boolean cancelled;\n+\n+\n+    /**\n+     * @param issuer      the {@link IUser} issuing the command\n+     * @param warpName    the name of the warp that's being altered\n+     * @param oldLocation the old location before being modified. Null if {@link WarpModifyCause#CREATE}.\n+     * @param newLocation the new location after being modified. Null if {@link WarpModifyCause#DELETE}.\n+     * @param cause       the cause of change.\n+     */\n+    public WarpModifyEvent(IUser issuer, String warpName, Location oldLocation, Location newLocation, WarpModifyCause cause) {\n+        this.issuer = issuer;\n+        this.warpName = warpName;\n+        this.oldLocation = oldLocation;\n+        this.newLocation = newLocation;\n+        this.cause = cause;\n+    }\n+\n+    public HandlerList getHandlers() {\n+        return handlers;\n+    }\n+\n+    public static HandlerList getHandlerList() {\n+        return handlers;\n+    }\n+\n+    @Override\n+    public boolean isCancelled() {\n+        return cancelled;\n+    }\n+\n+    @Override\n+    public void setCancelled(boolean cancel) {\n+        this.cancelled = cancel;\n+    }\n+\n+    public IUser getIssuer() {\n+        return issuer;\n+    }\n+\n+    public WarpModifyCause getCause() {\n+        return cause;\n+    }\n+\n+    public String getWarpName() {\n+        return warpName;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9405936e4c15b2ec71cebe0091551fbdab47a88"}, "originalPosition": 67}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ2NTg2ODIxOnYy", "diffSide": "RIGHT", "path": "Essentials/src/main/java/net/essentialsx/api/v2/events/WarpModifyEvent.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMjozODozMFrOINUPXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMlQwMjozODozMFrOINUPXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDgzNDAxNA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change", "url": "https://github.com/EssentialsX/Essentials/pull/3875#discussion_r550834014", "createdAt": "2021-01-02T02:38:30Z", "author": {"login": "JRoy"}, "path": "Essentials/src/main/java/net/essentialsx/api/v2/events/WarpModifyEvent.java", "diffHunk": "@@ -0,0 +1,83 @@\n+package net.essentialsx.api.v2.events;\n+\n+import net.ess3.api.IUser;\n+import org.bukkit.Location;\n+import org.bukkit.event.Cancellable;\n+import org.bukkit.event.Event;\n+import org.bukkit.event.HandlerList;\n+\n+/**\n+ * Called when a warp is about to be modified.\n+ * Includes creation and deletion as described in {@link WarpModifyCause}.\n+ */\n+public class WarpModifyEvent extends Event implements Cancellable {\n+    private static final HandlerList handlers = new HandlerList();\n+    private final IUser issuer;\n+    private final String warpName;\n+    private final Location oldLocation;\n+    private final Location newLocation;\n+    private final WarpModifyCause cause;\n+    private boolean cancelled;\n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "636d0d5f27600ff29119c27e906e3cec980b498f"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4556, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}