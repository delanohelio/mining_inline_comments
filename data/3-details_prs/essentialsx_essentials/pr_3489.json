{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ3NzI4MDc3", "number": 3489, "title": "Use playerNeverOnServer message where appropriate", "bodyText": "Use playerNeverOnServer message where it should be used:\n309e1c4\nplayerNeverOnServer=\\u00a74Player\\u00a7c {0} \\u00a74was never on this server. is currently used in the Commandmail class at Line 61, Line 116 and Line 129 however is not called as PlayerNotFoundException is thrown by #getPlayer breaking current execution (below).\nCommandmail#run() throws Exception {\n...\n    User u = getPlayer(server, args[1], true, true); // throws PlayerNotFoundException\n        if (u == null) {\n            throw new Exception(tl(\"playerNeverOnServer\", args[1]));\n    } \n...\n}\n\nBefore changes:\n\nAfter changes:\n\n\nCommandseen currently throws the default PlayerNotFoundException playerNotFound message for players that have not logged on to the server where it would be more appropriate to use the playerNeverOnServer message.\nCommandseen#run throws Exception {\n...\n    AsyncRunnable#run() {\n        User userFromBukkit = ess.getUserMap().getUserFromBukkit(args[0]);  <-- ***\n        try {\n            if (userFromBukkit != null) {                             <--- ***\n                showUserSeen(userFromBukkit);\n            } else {\n                showUserSeen(getPlayer(server, sender, args, 0)); <--- ***\n            }\n        } catch (Exception e) {\n            ess.showError(sender, e, commandLabel);\n        }\n    }\n    private void showUserSeen(User user) throws Exception {\n        if (user == null) {                                    <--- ***\n            throw new PlayerNotFoundException();\n        }\n        showSeenMessage(server, sender, user, showBan, showIp, showLocation);\n    }\n...\n}\n\n<-- ***:\nusersFromBukkit null check is performed before #showUserSeen so there is no need for another null check.\nEssentialsCommand#getPlayer throws NotEnoughArguementsException or PlayerNotFoundException after arg checks and player checks. #3489 (comment)\nBefore changes:\n\nAfter changes:\n\n\n725128e\nCatch more specfic exception PlayerNotFoundException.\nBefore changes:\n\nAfter changes:", "createdAt": "2020-07-11T06:27:13Z", "url": "https://github.com/EssentialsX/Essentials/pull/3489", "merged": true, "mergeCommit": {"oid": "f9de6763d3d840e01d553e5a69ddd569f076c1f1"}, "closed": true, "closedAt": "2020-08-04T14:30:06Z", "author": {"login": "uf0h"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczxs67AH2gAyNDQ3NzI4MDc3OjMwOWUxYzQ3MGQ0YmNmZTJhMjE4NmY5NzIwY2UzM2YyNjQ0MWI4MDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc7nfdAAFqTQ2MDg2ODIzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "309e1c470d4bcfe2a2186f9720ce33f26441b802", "author": {"user": {"login": "uf0h", "name": null}}, "url": "https://github.com/EssentialsX/Essentials/commit/309e1c470d4bcfe2a2186f9720ce33f26441b802", "committedDate": "2020-07-11T05:50:38Z", "message": "use playerNeverOnServer msg correctly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "725128e2e0ec8d7cc0ac788b5e52bb2ee12c87f7", "author": {"user": {"login": "uf0h", "name": null}}, "url": "https://github.com/EssentialsX/Essentials/commit/725128e2e0ec8d7cc0ac788b5e52bb2ee12c87f7", "committedDate": "2020-07-11T06:23:55Z", "message": "playerNotFound to playerNeverOnServer msg"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2NzgyNzky", "url": "https://github.com/EssentialsX/Essentials/pull/3489#pullrequestreview-446782792", "createdAt": "2020-07-11T06:32:27Z", "commit": {"oid": "309e1c470d4bcfe2a2186f9720ce33f26441b802"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwNjozMjoyN1rOGwK43Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQwNjozMjoyN1rOGwK43Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE2MzIyOQ==", "bodyText": "removed as line 69 already checks notnull.", "url": "https://github.com/EssentialsX/Essentials/pull/3489#discussion_r453163229", "createdAt": "2020-07-11T06:32:27Z", "author": {"login": "uf0h"}, "path": "Essentials/src/com/earth2me/essentials/commands/Commandseen.java", "diffHunk": "@@ -69,17 +69,18 @@ public void run() {\n                         if (userFromBukkit != null) {\n                             showUserSeen(userFromBukkit);\n                         } else {\n-                            showUserSeen(getPlayer(server, sender, args, 0));\n+                            try {\n+                                showUserSeen(getPlayer(server, sender, args, 0));\n+                            } catch (PlayerNotFoundException e) {\n+                                throw new Exception(tl(\"playerNeverOnServer\", args[0]));\n+                            }\n                         }\n                     } catch (Exception e) {\n                         ess.showError(sender, e, commandLabel);\n                     }\n                 }\n \n                 private void showUserSeen(User user) throws Exception {\n-                    if (user == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "309e1c470d4bcfe2a2186f9720ce33f26441b802"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODU3NDUw", "url": "https://github.com/EssentialsX/Essentials/pull/3489#pullrequestreview-446857450", "createdAt": "2020-07-12T08:26:25Z", "commit": {"oid": "725128e2e0ec8d7cc0ac788b5e52bb2ee12c87f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODgxNjA3", "url": "https://github.com/EssentialsX/Essentials/pull/3489#pullrequestreview-446881607", "createdAt": "2020-07-12T14:06:25Z", "commit": {"oid": "725128e2e0ec8d7cc0ac788b5e52bb2ee12c87f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYwODY4MjMx", "url": "https://github.com/EssentialsX/Essentials/pull/3489#pullrequestreview-460868231", "createdAt": "2020-08-04T14:28:16Z", "commit": {"oid": "725128e2e0ec8d7cc0ac788b5e52bb2ee12c87f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4565, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}