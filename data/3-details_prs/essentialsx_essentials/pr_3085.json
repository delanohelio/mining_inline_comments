{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyMDcyNjE0", "number": 3085, "title": "Add UUID and User based economy methods", "bodyText": "Adds methods to the Economy API to use UUIDs and User objects. Additionally, deprecates all the username (String) based methods", "createdAt": "2020-03-22T21:21:39Z", "url": "https://github.com/EssentialsX/Essentials/pull/3085", "merged": true, "mergeCommit": {"oid": "8ad55cb63486198b6ff91226995b2c35101ea906"}, "closed": true, "closedAt": "2020-05-04T10:00:26Z", "author": {"login": "JRoy"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQQbdugH2gAyMzkyMDcyNjE0OjBkOGMwOWU4MTVlMDE2OTFlNzNjNmQ5NzM4ZTFjZDQwYjUxMzQ5YjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcd8fYaAFqTQwNDg1MDY5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0d8c09e815e01691e73c6d9738e1cd40b51349b2", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/0d8c09e815e01691e73c6d9738e1cd40b51349b2", "committedDate": "2020-03-22T21:17:21Z", "message": "Add UUID/User friendly methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da", "committedDate": "2020-03-22T21:20:09Z", "message": "Fixup some warnings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNTQ3ODI5", "url": "https://github.com/EssentialsX/Essentials/pull/3085#pullrequestreview-382547829", "createdAt": "2020-03-27T02:45:45Z", "commit": {"oid": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NDQ3ODE0", "url": "https://github.com/EssentialsX/Essentials/pull/3085#pullrequestreview-384447814", "createdAt": "2020-03-31T06:57:05Z", "commit": {"oid": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNjo1NzowNVrOF-HuQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNzowOToyNVrOF-IDfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4MjU2MQ==", "bodyText": "Don't use RuntimeException for this. IllegalArgumentException is a far better choice.", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400682561", "createdAt": "2020-03-31T06:57:05Z", "author": {"login": "Ichbinjoe"}, "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -86,9 +88,20 @@ private static User getUserByName(String name) {\n         return user;\n     }\n \n+    private static User getUserByUUID(UUID uuid) {\n+        if (ess == null) {\n+            throw new RuntimeException(noCallBeforeLoad);\n+        }\n+        if (uuid == null) {\n+            throw new RuntimeException(\"Economy uuid cannot be null\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4NzE3Nw==", "bodyText": "IllegalArgumentException", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400687177", "createdAt": "2020-03-31T07:07:44Z", "author": {"login": "Ichbinjoe"}, "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -133,11 +160,50 @@ public static void setMoney(String name, double balance) throws UserDoesNotExist\n         }\n     }\n \n+    /**\n+     * Sets the balance of a user\n+     *\n+     * @deprecated Usernames can change use {@link Economy#setMoney(UUID, BigDecimal)} or {@link Economy#setMoney(User, BigDecimal)}\n+     *\n+     * @param name    Name of user\n+     * @param balance The balance you want to set\n+     *\n+     * @throws UserDoesNotExistException If a user by that name does not exist\n+     * @throws NoLoanPermittedException  If the user is not allowed to have a negative balance\n+     */\n+    @Deprecated\n     public static void setMoney(String name, BigDecimal balance) throws UserDoesNotExistException, NoLoanPermittedException {\n         User user = getUserByName(name);\n         if (user == null) {\n             throw new UserDoesNotExistException(name);\n         }\n+        setMoney(user, balance);\n+    }\n+\n+    /**\n+     * Sets the balance of a user\n+     *\n+     * @param uuid    UUID of user\n+     * @param balance The balance you want to set\n+     *\n+     * @throws NoLoanPermittedException If the user is not allowed to have a negative balance\n+     */\n+    public static void setMoney(UUID uuid, BigDecimal balance) throws NoLoanPermittedException {\n+        setMoney(getUserByUUID(uuid), balance);\n+    }\n+\n+    /**\n+     * Sets the balance of a user\n+     *\n+     * @param user    User\n+     * @param balance The balance you want to set\n+     *\n+     * @throws NoLoanPermittedException If the user is not allowed to have a negative balance\n+     */\n+    public static void setMoney(User user, BigDecimal balance) throws NoLoanPermittedException {\n+        if (user == null) {\n+            throw new RuntimeException(\"Economy user cannot be null\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4NzU4OA==", "bodyText": "user is not allowed", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400687588", "createdAt": "2020-03-31T07:08:35Z", "author": {"login": "Ichbinjoe"}, "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -170,17 +238,64 @@ public static void add(String name, double amount) throws UserDoesNotExistExcept\n         }\n     }\n \n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @deprecated Usernames can change, use {@link Economy#add(UUID, BigDecimal)} or {@link Economy#add(User, BigDecimal)}\n+     *\n+     * @param name   Name of the user\n+     * @param amount The money you want to add\n+     *\n+     * @throws UserDoesNotExistException If a user by that name does not exist\n+     * @throws NoLoanPermittedException  If the user is now allowed to have a negative balance\n+     * @throws ArithmeticException\n+     */\n+    @Deprecated\n     public static void add(String name, BigDecimal amount) throws UserDoesNotExistException, NoLoanPermittedException, ArithmeticException {\n-        BigDecimal result = getMoneyExact(name).add(amount, MATH_CONTEXT);\n-        setMoney(name, result);\n-        Trade.log(\"API\", \"Add\", \"API\", name, new Trade(amount, ess), null, null, null, ess);\n+        User user = getUserByName(name);\n+        if (user == null) {\n+            throw new UserDoesNotExistException(name);\n+        }\n+        add(user, amount);\n+    }\n+\n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @param uuid   UUID of the user\n+     * @param amount The money you want to add\n+     *\n+     * @throws NoLoanPermittedException  If the user is now allowed to have a negative balance\n+     * @throws ArithmeticException\n+     */\n+    public static void add(UUID uuid, BigDecimal amount) throws NoLoanPermittedException, ArithmeticException {\n+        add(getUserByUUID(uuid), amount);\n+    }\n+\n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @deprecated Usernames can change, use {@link Economy#add(UUID, BigDecimal)} or {@link Economy#add(User, BigDecimal)}\n+     *\n+     * @param user   User\n+     * @param amount The money you want to add\n+     *\n+     * @throws NoLoanPermittedException  If the user is now allowed to have a negative balance", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da"}, "originalPosition": 184}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4NzY3NA==", "bodyText": "not", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400687674", "createdAt": "2020-03-31T07:08:44Z", "author": {"login": "Ichbinjoe"}, "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -170,17 +238,64 @@ public static void add(String name, double amount) throws UserDoesNotExistExcept\n         }\n     }\n \n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @deprecated Usernames can change, use {@link Economy#add(UUID, BigDecimal)} or {@link Economy#add(User, BigDecimal)}\n+     *\n+     * @param name   Name of the user\n+     * @param amount The money you want to add\n+     *\n+     * @throws UserDoesNotExistException If a user by that name does not exist\n+     * @throws NoLoanPermittedException  If the user is now allowed to have a negative balance", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da"}, "originalPosition": 148}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4Nzk5OQ==", "bodyText": "Consider rewording all around to something more like 'The amount of money to be added to the user's account'", "url": "https://github.com/EssentialsX/Essentials/pull/3085#discussion_r400687999", "createdAt": "2020-03-31T07:09:25Z", "author": {"login": "Ichbinjoe"}, "path": "Essentials/src/com/earth2me/essentials/api/Economy.java", "diffHunk": "@@ -170,17 +238,64 @@ public static void add(String name, double amount) throws UserDoesNotExistExcept\n         }\n     }\n \n+    /**\n+     * Adds money to the balance of a user\n+     *\n+     * @deprecated Usernames can change, use {@link Economy#add(UUID, BigDecimal)} or {@link Economy#add(User, BigDecimal)}\n+     *\n+     * @param name   Name of the user\n+     * @param amount The money you want to add", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35e2df9c191cbb4ee562ff46fb9d2ad6ba3f63da"}, "originalPosition": 145}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85a32e1257efda1090eb357da4eba8ae8e2afa38", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/85a32e1257efda1090eb357da4eba8ae8e2afa38", "committedDate": "2020-03-31T15:35:02Z", "message": "Review changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMTMxNzcw", "url": "https://github.com/EssentialsX/Essentials/pull/3085#pullrequestreview-392131770", "createdAt": "2020-04-13T13:07:10Z", "commit": {"oid": "85a32e1257efda1090eb357da4eba8ae8e2afa38"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "460d2aa0783fd5a5f906f55a1862a17f466625c6", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/460d2aa0783fd5a5f906f55a1862a17f466625c6", "committedDate": "2020-04-13T14:07:53Z", "message": "Fix typos"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMTkyNTEx", "url": "https://github.com/EssentialsX/Essentials/pull/3085#pullrequestreview-392192511", "createdAt": "2020-04-13T14:49:19Z", "commit": {"oid": "460d2aa0783fd5a5f906f55a1862a17f466625c6"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f822baccc6449b21d316e5e787105d2f5c603661", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/f822baccc6449b21d316e5e787105d2f5c603661", "committedDate": "2020-05-02T18:35:48Z", "message": "Throw UserDoesNotExistException in UUID-based methods"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0ODUwNjky", "url": "https://github.com/EssentialsX/Essentials/pull/3085#pullrequestreview-404850692", "createdAt": "2020-05-04T09:58:28Z", "commit": {"oid": "f822baccc6449b21d316e5e787105d2f5c603661"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4822, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}