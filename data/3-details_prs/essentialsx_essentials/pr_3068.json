{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3ODA4MDg1", "number": 3068, "title": "Improve MuteStatusChangeEvent", "bodyText": "Adds getTimestamp and getReason methods to MuteStatusChangeEvent with the apropriate JavaDocs explaining them.\nCloses #2459", "createdAt": "2020-03-13T14:30:48Z", "url": "https://github.com/EssentialsX/Essentials/pull/3068", "merged": true, "mergeCommit": {"oid": "6bbdbc89a672c3cab909ac3ac8a13502985ebf47"}, "closed": true, "closedAt": "2020-04-23T15:28:09Z", "author": {"login": "JRoy"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcNWnlpgFqTM3NDYwOTM0OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaelpRgFqTM5OTIxNDU2MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NjA5MzQ5", "url": "https://github.com/EssentialsX/Essentials/pull/3068#pullrequestreview-374609349", "createdAt": "2020-03-13T20:44:47Z", "commit": {"oid": "b6a1f23eeb2821bbb9882f84cea6067f010d1b0f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QyMDo0NDo0N1rOF2SHSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QyMDo0ODowNFrOF2SPpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjQ2NDIwMA==", "bodyText": "The event is Cancellable, so I don't think you should be doing this before knowing the outcome. I had a similar issue while implementing #2807 (which perhaps we should merge before handling this issue, since it seems a lot of the code refactoring is already done there).", "url": "https://github.com/EssentialsX/Essentials/pull/3068#discussion_r392464200", "createdAt": "2020-03-13T20:44:47Z", "author": {"login": "pop4959"}, "path": "Essentials/src/com/earth2me/essentials/commands/Commandmute.java", "diffHunk": "@@ -40,25 +40,32 @@ public void run(final Server server, final CommandSource sender, final String co\n                 throw new Exception(tl(\"muteExempt\"));\n             }\n         }\n+\n+        long muteTimestamp = 0;\n+        String muteReason = null;\n+\n+        if (args.length > 1) {\n+            final String time = args[1];\n+            try {\n+                muteTimestamp = DateUtil.parseDateDiff(time, true);\n+                muteReason = getFinalArg(args, 2);\n+            } catch (Exception e) {\n+                muteReason = getFinalArg(args, 1);\n+            }\n+        } else {\n+            user.setMuted(!user.getMuted());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6a1f23eeb2821bbb9882f84cea6067f010d1b0f"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjQ2NjM0Mw==", "bodyText": "The second portion of this description reads poorly in my opinion. Otherwise, the timestamp with 0 should probably be Otherwise, the timestamp, or 0 to make sure it's clear.", "url": "https://github.com/EssentialsX/Essentials/pull/3068#discussion_r392466343", "createdAt": "2020-03-13T20:48:04Z", "author": {"login": "pop4959"}, "path": "Essentials/src/net/ess3/api/events/MuteStatusChangeEvent.java", "diffHunk": "@@ -4,7 +4,35 @@\n \n \n public class MuteStatusChangeEvent extends StatusChangeEvent {\n+    private Long timestamp;\n+    private String reason;\n+\n+    @Deprecated\n     public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value) {\n+        this(affected, controller, value, null, null);\n+    }\n+\n+    public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value, Long timestamp, String reason) {\n         super(affected, controller, value);\n+        this.timestamp = timestamp;\n+        if (reason == null) {\n+            this.reason = null;\n+        } else {\n+            this.reason = reason.isEmpty() ? null : reason;\n+        }\n+    }\n+\n+    /**\n+     * @return Returns null if the timestamp is unknown due to usage of deprecated api; Otherwise, the timestamp with 0 indicating permanent.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6a1f23eeb2821bbb9882f84cea6067f010d1b0f"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NjM5OTUw", "url": "https://github.com/EssentialsX/Essentials/pull/3068#pullrequestreview-374639950", "createdAt": "2020-03-13T21:54:27Z", "commit": {"oid": "b2ed4457c4a58ac2ca53c27c18771f1b7a8304f6"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e69b402d02fa1a11d710c24919b4e5a6b46b73a", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/3e69b402d02fa1a11d710c24919b4e5a6b46b73a", "committedDate": "2020-03-23T02:20:18Z", "message": "Improve MuteStatusChangeEvent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7a3d85d10b645fdad2a2ea074e4d57ce319bbe06", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/7a3d85d10b645fdad2a2ea074e4d57ce319bbe06", "committedDate": "2020-03-23T02:20:38Z", "message": "Merge remote-tracking branch 'origin/feature/better-mute-event' into feature/better-mute-event\n\n# Conflicts:\n#\tEssentials/src/com/earth2me/essentials/commands/Commandmute.java"}, "afterCommit": {"oid": "3e69b402d02fa1a11d710c24919b4e5a6b46b73a", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/3e69b402d02fa1a11d710c24919b4e5a6b46b73a", "committedDate": "2020-03-23T02:20:18Z", "message": "Improve MuteStatusChangeEvent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73b2da5653e035a938f85d88665e50e4e7586cd5", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/73b2da5653e035a938f85d88665e50e4e7586cd5", "committedDate": "2020-03-23T02:31:14Z", "message": "Rebase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NDM0Mzk3", "url": "https://github.com/EssentialsX/Essentials/pull/3068#pullrequestreview-384434397", "createdAt": "2020-03-31T06:29:53Z", "commit": {"oid": "73b2da5653e035a938f85d88665e50e4e7586cd5"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNjoyOTo1M1rOF-HDcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNjoyOTo1M1rOF-HDcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY3MTYwMQ==", "bodyText": "When will reason ever be 'empty'? Maybe if a stupid plugin makes it empty but then we should be witchhunting them, not adding this weird oneoff check here.", "url": "https://github.com/EssentialsX/Essentials/pull/3068#discussion_r400671601", "createdAt": "2020-03-31T06:29:53Z", "author": {"login": "Ichbinjoe"}, "path": "Essentials/src/net/ess3/api/events/MuteStatusChangeEvent.java", "diffHunk": "@@ -4,7 +4,35 @@\n \n \n public class MuteStatusChangeEvent extends StatusChangeEvent {\n+    private Long timestamp;\n+    private String reason;\n+\n+    @Deprecated\n     public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value) {\n+        this(affected, controller, value, null, null);\n+    }\n+\n+    public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value, Long timestamp, String reason) {\n         super(affected, controller, value);\n+        this.timestamp = timestamp;\n+        if (reason == null) {\n+            this.reason = null;\n+        } else {\n+            this.reason = reason.isEmpty() ? null : reason;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "73b2da5653e035a938f85d88665e50e4e7586cd5"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7c11fd8f2aa19fa22383769a3367f81a49671fe", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/f7c11fd8f2aa19fa22383769a3367f81a49671fe", "committedDate": "2020-03-31T16:12:48Z", "message": "Review changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzg4Mjk5", "url": "https://github.com/EssentialsX/Essentials/pull/3068#pullrequestreview-391388299", "createdAt": "2020-04-10T11:03:50Z", "commit": {"oid": "f7c11fd8f2aa19fa22383769a3367f81a49671fe"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMTowMzo1MFrOGD3p3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxMTowODo0NlrOGD3u0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjcxMDc0OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return Returns null if no reason is provided or due to the usage of a deprecated api; Otherwise, the reason.\n          \n          \n            \n                 * @return Returns the reason if provided, otherwise null.\n          \n      \n    \n    \n  \n\nOther plugins shouldn't be firing this event on our behalf, so we probably shouldn't assume they are.", "url": "https://github.com/EssentialsX/Essentials/pull/3068#discussion_r406710748", "createdAt": "2020-04-10T11:03:50Z", "author": {"login": "mdcfe"}, "path": "Essentials/src/net/ess3/api/events/MuteStatusChangeEvent.java", "diffHunk": "@@ -4,7 +4,31 @@\n \n \n public class MuteStatusChangeEvent extends StatusChangeEvent {\n+    private Long timestamp;\n+    private String reason;\n+\n+    @Deprecated\n     public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value) {\n+        this(affected, controller, value, null, null);\n+    }\n+\n+    public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value, Long timestamp, String reason) {\n         super(affected, controller, value);\n+        this.timestamp = timestamp;\n+        this.reason = reason == null ? null : (reason.isEmpty() ? null : reason);\n+    }\n+\n+    /**\n+     * @return Returns null if the timestamp is unknown due to usage of deprecated api; Otherwise, the timestamp with 0 indicating permanent.\n+     */\n+    public Long getTimestamp() {\n+        return timestamp;\n+    }\n+\n+    /**\n+     * @return Returns null if no reason is provided or due to the usage of a deprecated api; Otherwise, the reason.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7c11fd8f2aa19fa22383769a3367f81a49671fe"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjcxMTQwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return Returns null if the timestamp is unknown due to usage of deprecated api; Otherwise, the timestamp with 0 indicating permanent.\n          \n          \n            \n                 * @return If the mute is temporary, returns the timestamp; if permanent, returns 0, and if unknown, returns -1.", "url": "https://github.com/EssentialsX/Essentials/pull/3068#discussion_r406711408", "createdAt": "2020-04-10T11:06:21Z", "author": {"login": "mdcfe"}, "path": "Essentials/src/net/ess3/api/events/MuteStatusChangeEvent.java", "diffHunk": "@@ -4,7 +4,31 @@\n \n \n public class MuteStatusChangeEvent extends StatusChangeEvent {\n+    private Long timestamp;\n+    private String reason;\n+\n+    @Deprecated\n     public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value) {\n+        this(affected, controller, value, null, null);\n+    }\n+\n+    public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value, Long timestamp, String reason) {\n         super(affected, controller, value);\n+        this.timestamp = timestamp;\n+        this.reason = reason == null ? null : (reason.isEmpty() ? null : reason);\n+    }\n+\n+    /**\n+     * @return Returns null if the timestamp is unknown due to usage of deprecated api; Otherwise, the timestamp with 0 indicating permanent.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7c11fd8f2aa19fa22383769a3367f81a49671fe"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjcxMjAxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this(affected, controller, value, null, null);\n          \n          \n            \n                }\n          \n          \n            \n            \n          \n          \n            \n                public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value, Long timestamp, String reason) {\n          \n          \n            \n                    this(affected, controller, value, -1, null);\n          \n          \n            \n                }\n          \n          \n            \n            \n          \n          \n            \n                public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value, long timestamp, String reason) {", "url": "https://github.com/EssentialsX/Essentials/pull/3068#discussion_r406712017", "createdAt": "2020-04-10T11:08:46Z", "author": {"login": "mdcfe"}, "path": "Essentials/src/net/ess3/api/events/MuteStatusChangeEvent.java", "diffHunk": "@@ -4,7 +4,31 @@\n \n \n public class MuteStatusChangeEvent extends StatusChangeEvent {\n+    private Long timestamp;\n+    private String reason;\n+\n+    @Deprecated\n     public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value) {\n+        this(affected, controller, value, null, null);\n+    }\n+\n+    public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value, Long timestamp, String reason) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7c11fd8f2aa19fa22383769a3367f81a49671fe"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abcba62a19e5f2ab4a693cd06f8dd6be6bef863b", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/abcba62a19e5f2ab4a693cd06f8dd6be6bef863b", "committedDate": "2020-04-10T18:46:04Z", "message": "Apply suggestions from code review\n\nCo-Authored-By: md678685 <1917406+md678685@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "228c33ca11d86ea12dd2ba11eb24d293c4775d6e", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/228c33ca11d86ea12dd2ba11eb24d293c4775d6e", "committedDate": "2020-04-10T18:47:15Z", "message": "Remove deprecated constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d49b85d097a313fb2dcafa106287e11c74745c61", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/d49b85d097a313fb2dcafa106287e11c74745c61", "committedDate": "2020-04-10T18:48:27Z", "message": "Merge branch '2.x' into feature/better-mute-event"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMTI4NzAy", "url": "https://github.com/EssentialsX/Essentials/pull/3068#pullrequestreview-392128702", "createdAt": "2020-04-13T13:00:30Z", "commit": {"oid": "d49b85d097a313fb2dcafa106287e11c74745c61"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzowMDozMVrOGElxnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzowMDozMVrOGElxnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ2NjM5Ng==", "bodyText": "I'm not sure whether we should return 0 or null if the mute is permanent. null better describes that there isn't a timestamp for the mute to be lifted on. @Ichbinjoe any thoughts?\n(I'm aware I've changed my mind on this since my last look over this PR - apologies about the changes.)", "url": "https://github.com/EssentialsX/Essentials/pull/3068#discussion_r407466396", "createdAt": "2020-04-13T13:00:31Z", "author": {"login": "mdcfe"}, "path": "Essentials/src/net/ess3/api/events/MuteStatusChangeEvent.java", "diffHunk": "@@ -4,7 +4,26 @@\n \n \n public class MuteStatusChangeEvent extends StatusChangeEvent {\n-    public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value) {\n+    private Long timestamp;\n+    private String reason;\n+\n+    public MuteStatusChangeEvent(IUser affected, IUser controller, boolean value, long timestamp, String reason) {\n         super(affected, controller, value);\n+        this.timestamp = timestamp;\n+        this.reason = reason == null ? null : (reason.isEmpty() ? null : reason);\n+    }\n+\n+    /**\n+     * @return If the mute is temporary, returns the timestamp; if permanent, returns 0, and if unknown, returns -1.\n+     */\n+    public Long getTimestamp() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d49b85d097a313fb2dcafa106287e11c74745c61"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "890d0d953506de3d89432d1866c82df88e31324a", "author": {"user": {"login": "JRoy", "name": "Josh Roy"}}, "url": "https://github.com/EssentialsX/Essentials/commit/890d0d953506de3d89432d1866c82df88e31324a", "committedDate": "2020-04-20T21:18:17Z", "message": "Review changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MjE0NTYx", "url": "https://github.com/EssentialsX/Essentials/pull/3068#pullrequestreview-399214561", "createdAt": "2020-04-23T15:26:23Z", "commit": {"oid": "890d0d953506de3d89432d1866c82df88e31324a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4811, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}