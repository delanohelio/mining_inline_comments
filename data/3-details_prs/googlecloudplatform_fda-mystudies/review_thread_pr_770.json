{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NTYxNjIw", "number": 770, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMDoxODoyN1rOEaIn_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMTo1Nzo0NlrOEaLNoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1ODM5NzQxOnYy", "diffSide": "RIGHT", "path": "common-modules/common-tests/src/main/resources/__files/oauth-scim-service/auth-server-update-status-response.json", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMDoxODoyN1rOHDXl0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTo0Njo1MlrOHD4Emg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzI5NDI4OQ==", "bodyText": "nit: why is the indentation width here different? Please align with the current styling.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473294289", "createdAt": "2020-08-19T20:18:27Z", "author": {"login": "saminguyen"}, "path": "common-modules/common-tests/src/main/resources/__files/oauth-scim-service/auth-server-update-status-response.json", "diffHunk": "@@ -1,4 +1,5 @@\n {\n-\t\"code\": \"200\",\n-\t\"message\": \"SUCCESS\"\n+  \"status\": 200,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgyNjQ1OA==", "bodyText": "Indentation fixed.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473826458", "createdAt": "2020-08-20T09:46:52Z", "author": {"login": "madhurya-btc"}, "path": "common-modules/common-tests/src/main/resources/__files/oauth-scim-service/auth-server-update-status-response.json", "diffHunk": "@@ -1,4 +1,5 @@\n {\n-\t\"code\": \"200\",\n-\t\"message\": \"SUCCESS\"\n+  \"status\": 200,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzI5NDI4OQ=="}, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1ODcxODIwOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMTozNjozNVrOHDaxJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTo0Mzo1NlrOHD355A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM0NjM0Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public String deActivateAcct(String userId, DeactivateAcctBean deactivateBean);\n          \n          \n            \n              public String deactivateAcct(String userId, DeactivateAcctBean deactivateBean);", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473346342", "createdAt": "2020-08-19T21:36:35Z", "author": {"login": "saminguyen"}, "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileService.java", "diffHunk": "@@ -33,8 +33,7 @@ public UserDetailsBO getParticipantDetailsByEmail(\n \n   public UserDetailsBO saveParticipant(UserDetailsBO participant);\n \n-  public String deActivateAcct(\n-      String userId, DeactivateAcctBean deactivateBean, String accessToken, String clientToken);\n+  public String deActivateAcct(String userId, DeactivateAcctBean deactivateBean);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgyMzcxNg==", "bodyText": "Changed to deactivateAcct", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473823716", "createdAt": "2020-08-20T09:43:56Z", "author": {"login": "madhurya-btc"}, "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileService.java", "diffHunk": "@@ -33,8 +33,7 @@ public UserDetailsBO getParticipantDetailsByEmail(\n \n   public UserDetailsBO saveParticipant(UserDetailsBO participant);\n \n-  public String deActivateAcct(\n-      String userId, DeactivateAcctBean deactivateBean, String accessToken, String clientToken);\n+  public String deActivateAcct(String userId, DeactivateAcctBean deactivateBean);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM0NjM0Mg=="}, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1ODcyNzY0OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileServiceImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMTozODoyNVrOHDa3Tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTo0Mzo0NlrOHD35Sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM0NzkxOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public String deActivateAcct(String userId, DeactivateAcctBean deactivateAcctBean) {\n          \n          \n            \n              public String deactivateAcct(String userId, DeactivateAcctBean deactivateAcctBean) {", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473347918", "createdAt": "2020-08-19T21:38:25Z", "author": {"login": "saminguyen"}, "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileServiceImpl.java", "diffHunk": "@@ -224,11 +228,7 @@ public UserDetailsBO saveParticipant(UserDetailsBO participant) {\n   }\n \n   @Override\n-  public String deActivateAcct(\n-      String userId,\n-      DeactivateAcctBean deactivateAcctBean,\n-      String accessToken,\n-      String clientToken) {\n+  public String deActivateAcct(String userId, DeactivateAcctBean deactivateAcctBean) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgyMzU2Mw==", "bodyText": "Changed to deactivateAcct", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473823563", "createdAt": "2020-08-20T09:43:46Z", "author": {"login": "madhurya-btc"}, "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileServiceImpl.java", "diffHunk": "@@ -224,11 +228,7 @@ public UserDetailsBO saveParticipant(UserDetailsBO participant) {\n   }\n \n   @Override\n-  public String deActivateAcct(\n-      String userId,\n-      DeactivateAcctBean deactivateAcctBean,\n-      String accessToken,\n-      String clientToken) {\n+  public String deActivateAcct(String userId, DeactivateAcctBean deactivateAcctBean) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM0NzkxOA=="}, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1ODgyMTE3OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileServiceImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMTo1Nzo0MlrOHDb2BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTo0MzozMVrOHD34ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2Mzk3Mw==", "bodyText": "Add verifying that this was called in UserProfileControllerTest", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473363973", "createdAt": "2020-08-19T21:57:42Z", "author": {"login": "saminguyen"}, "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileServiceImpl.java", "diffHunk": "@@ -240,8 +240,12 @@ public String deActivateAcct(\n     List<String> deleteData = new ArrayList<String>();\n     try {\n       userDetailsId = commonDao.getUserInfoDetails(userId);\n-      message = userManagementUtil.deactivateAcct(userId, accessToken, clientToken);\n-      if (message.equalsIgnoreCase(MyStudiesUserRegUtil.ErrorCodes.SUCCESS.getValue())) {\n+      UpdateEmailStatusRequest updateEmailStatusRequest = new UpdateEmailStatusRequest();\n+      updateEmailStatusRequest.setStatus(UserAccountStatus.DEACTIVATED.getStatus());\n+      UpdateEmailStatusResponse updateStatusResponse =\n+          userManagementUtil.updateUserInfoInAuthServer(updateEmailStatusRequest, userId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgyMzQxOA==", "bodyText": "In UserProfileControllerTest its already present\nverify(1, putRequestedFor(urlEqualTo(\"/oauth-scim-service/users/\" + Constants.VALID_USER_ID)));", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473823418", "createdAt": "2020-08-20T09:43:31Z", "author": {"login": "madhurya-btc"}, "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileServiceImpl.java", "diffHunk": "@@ -240,8 +240,12 @@ public String deActivateAcct(\n     List<String> deleteData = new ArrayList<String>();\n     try {\n       userDetailsId = commonDao.getUserInfoDetails(userId);\n-      message = userManagementUtil.deactivateAcct(userId, accessToken, clientToken);\n-      if (message.equalsIgnoreCase(MyStudiesUserRegUtil.ErrorCodes.SUCCESS.getValue())) {\n+      UpdateEmailStatusRequest updateEmailStatusRequest = new UpdateEmailStatusRequest();\n+      updateEmailStatusRequest.setStatus(UserAccountStatus.DEACTIVATED.getStatus());\n+      UpdateEmailStatusResponse updateStatusResponse =\n+          userManagementUtil.updateUserInfoInAuthServer(updateEmailStatusRequest, userId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2Mzk3Mw=="}, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1ODgyMTQ0OnYy", "diffSide": "LEFT", "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileServiceImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMTo1Nzo0NlrOHDb2Ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwOTo0MjoyMFrOHD31aw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2NDAyMg==", "bodyText": "remove deactivateAcct in UserManagementUtil if not used anymore", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473364022", "createdAt": "2020-08-19T21:57:46Z", "author": {"login": "saminguyen"}, "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileServiceImpl.java", "diffHunk": "@@ -240,8 +240,12 @@ public String deActivateAcct(\n     List<String> deleteData = new ArrayList<String>();\n     try {\n       userDetailsId = commonDao.getUserInfoDetails(userId);\n-      message = userManagementUtil.deactivateAcct(userId, accessToken, clientToken);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgyMjU3MQ==", "bodyText": "Removed deactivateAcct in UserManagementUtil.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/770#discussion_r473822571", "createdAt": "2020-08-20T09:42:20Z", "author": {"login": "madhurya-btc"}, "path": "user-registration-server-ws/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserManagementProfileServiceImpl.java", "diffHunk": "@@ -240,8 +240,12 @@ public String deActivateAcct(\n     List<String> deleteData = new ArrayList<String>();\n     try {\n       userDetailsId = commonDao.getUserInfoDetails(userId);\n-      message = userManagementUtil.deactivateAcct(userId, accessToken, clientToken);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2NDAyMg=="}, "originalCommit": {"oid": "de292fc60dafb1f24ddf6de9cb1ed4e80ff7fe07"}, "originalPosition": 39}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2151, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}