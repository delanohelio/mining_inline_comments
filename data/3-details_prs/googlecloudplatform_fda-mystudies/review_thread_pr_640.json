{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5MzI5NjYy", "number": 640, "reviewThreads": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODozMDo0M1rOEOlSbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNDoyOTo1NVrOEa_Xvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzI2NDQ0OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenServiceImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODozMDo0M1rOGxz2kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODozMDo0M1rOGxz2kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg4Mjk2Mw==", "bodyText": "[enroll-mgmt Checks] reported by reviewdog \ud83d\udc36\nWrong lexicographical order for 'com.google.cloud.healthcare.fdamystudies.model.UserDetailsBO' import. Should be before 'org.springframework.stereotype.Service'.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r454882963", "createdAt": "2020-07-15T08:30:43Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenServiceImpl.java", "diffHunk": "@@ -9,15 +9,18 @@\n package com.google.cloud.healthcare.fdamystudies.service;\n \n import javax.validation.constraints.NotNull;\n+\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Service;\n+\n import com.google.cloud.healthcare.fdamystudies.beans.EnrollmentResponseBean;\n import com.google.cloud.healthcare.fdamystudies.dao.EnrollmentTokenDao;\n import com.google.cloud.healthcare.fdamystudies.exception.InvalidRequestException;\n import com.google.cloud.healthcare.fdamystudies.exception.SystemException;\n import com.google.cloud.healthcare.fdamystudies.exception.UnAuthorizedRequestException;\n+import com.google.cloud.healthcare.fdamystudies.model.UserDetailsBO;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e15285c90599bc33c38bd643c0db2802f3d20b4"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNzI2NDQ1OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODozMDo0M1rOGxz2lA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoxNjowNlrOGz6YOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg4Mjk2NA==", "bodyText": "[enroll-mgmt Checks] reported by reviewdog \ud83d\udc36\nLine is longer than 100 characters (found 137).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r454882964", "createdAt": "2020-07-15T08:30:43Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -120,7 +125,7 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n               .createQuery(\n                   \"from ParticipantStudiesBO PS,StudyInfoBO SB, ParticipantRegistrySite PR\"\n                       + \" where SB.id =PS.studyInfo.id and PS.participantRegistrySite.id=PR.id\"\n-                      + \" and PS.status='Enrolled' and PR.enrollmentToken=:token and SB.customId=:studyId\")\n+                      + \" and PS.status in ('Enrolled','Withdrawn','inProgress') and PR.enrollmentToken=:token and SB.customId=:studyId\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0e15285c90599bc33c38bd643c0db2802f3d20b4"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNTIxNA==", "bodyText": "please fix.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r455215214", "createdAt": "2020-07-15T17:28:19Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -120,7 +125,7 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n               .createQuery(\n                   \"from ParticipantStudiesBO PS,StudyInfoBO SB, ParticipantRegistrySite PR\"\n                       + \" where SB.id =PS.studyInfo.id and PS.participantRegistrySite.id=PR.id\"\n-                      + \" and PS.status='Enrolled' and PR.enrollmentToken=:token and SB.customId=:studyId\")\n+                      + \" and PS.status in ('Enrolled','Withdrawn','inProgress') and PR.enrollmentToken=:token and SB.customId=:studyId\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg4Mjk2NA=="}, "originalCommit": {"oid": "0e15285c90599bc33c38bd643c0db2802f3d20b4"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA4NzAzNA==", "bodyText": "resolved this linter issue", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r457087034", "createdAt": "2020-07-20T06:16:06Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -120,7 +125,7 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n               .createQuery(\n                   \"from ParticipantStudiesBO PS,StudyInfoBO SB, ParticipantRegistrySite PR\"\n                       + \" where SB.id =PS.studyInfo.id and PS.participantRegistrySite.id=PR.id\"\n-                      + \" and PS.status='Enrolled' and PR.enrollmentToken=:token and SB.customId=:studyId\")\n+                      + \" and PS.status in ('Enrolled','Withdrawn','inProgress') and PR.enrollmentToken=:token and SB.customId=:studyId\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg4Mjk2NA=="}, "originalCommit": {"oid": "0e15285c90599bc33c38bd643c0db2802f3d20b4"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzOTM1NTc3OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDao.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNzoyNjo1NlrOGyIDzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoxNTo0MlrOGz6XaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNDAyOA==", "bodyText": "nit: rename emailId to email", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r455214028", "createdAt": "2020-07-15T17:26:56Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDao.java", "diffHunk": "@@ -19,7 +21,8 @@\n \n   public boolean hasParticipant(@NotNull String shortName, @NotNull String tokenValue);\n \n-  public boolean isValidStudyToken(@NotNull String token, @NotNull String shortName);\n+  public boolean isValidStudyToken(\n+      @NotNull String token, @NotNull String shortName, @NotNull String emailId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA4NjgyNQ==", "bodyText": "changed to email", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r457086825", "createdAt": "2020-07-20T06:15:42Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDao.java", "diffHunk": "@@ -19,7 +21,8 @@\n \n   public boolean hasParticipant(@NotNull String shortName, @NotNull String tokenValue);\n \n-  public boolean isValidStudyToken(@NotNull String token, @NotNull String shortName);\n+  public boolean isValidStudyToken(\n+      @NotNull String token, @NotNull String shortName, @NotNull String emailId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNDAyOA=="}, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzOTM3MDk4OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNzoyOTo0NFrOGyIOWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoxNjo0MVrOGz6ZTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNjczMA==", "bodyText": "change to studyID similar to above. please name params consistently.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r455216730", "createdAt": "2020-07-15T17:29:44Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenService.java", "diffHunk": "@@ -21,7 +23,8 @@\n \n   public boolean hasParticipant(@NotNull String shortName, @NotNull String tokenValue);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA4NzMxMQ==", "bodyText": "changed this to studyId to make it consistent", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r457087311", "createdAt": "2020-07-20T06:16:41Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenService.java", "diffHunk": "@@ -21,7 +23,8 @@\n \n   public boolean hasParticipant(@NotNull String shortName, @NotNull String tokenValue);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxNjczMA=="}, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzOTQzMTI4OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNzo0MDo0MlrOGyI3Sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzo1Mjo0NVrOHEggRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyNzIxMQ==", "bodyText": "this query assumes that a token is unique within the context of a study_id.\nI do not see that as a constraint in the database, please add it, otherwise your token validation would take other participants into account and fail to validate.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r455227211", "createdAt": "2020-07-15T17:40:42Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -120,7 +125,7 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n               .createQuery(\n                   \"from ParticipantStudiesBO PS,StudyInfoBO SB, ParticipantRegistrySite PR\"\n                       + \" where SB.id =PS.studyInfo.id and PS.participantRegistrySite.id=PR.id\"\n-                      + \" and PS.status='Enrolled' and PR.enrollmentToken=:token and SB.customId=:studyId\")\n+                      + \" and PS.status in ('Enrolled','Withdrawn','inProgress') and PR.enrollmentToken=:token and SB.customId=:studyId\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA4ODEwMA==", "bodyText": "As we discussed database constraints will be taken care as part of data integrity issue fixes.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r457088100", "createdAt": "2020-07-20T06:18:18Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -120,7 +125,7 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n               .createQuery(\n                   \"from ParticipantStudiesBO PS,StudyInfoBO SB, ParticipantRegistrySite PR\"\n                       + \" where SB.id =PS.studyInfo.id and PS.participantRegistrySite.id=PR.id\"\n-                      + \" and PS.status='Enrolled' and PR.enrollmentToken=:token and SB.customId=:studyId\")\n+                      + \" and PS.status in ('Enrolled','Withdrawn','inProgress') and PR.enrollmentToken=:token and SB.customId=:studyId\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyNzIxMQ=="}, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzQ2NTkyNA==", "bodyText": "let's fix the ones you are working on when you have the context fresh in your mind. It will probably take less time.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r457465924", "createdAt": "2020-07-20T14:58:11Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -120,7 +125,7 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n               .createQuery(\n                   \"from ParticipantStudiesBO PS,StudyInfoBO SB, ParticipantRegistrySite PR\"\n                       + \" where SB.id =PS.studyInfo.id and PS.participantRegistrySite.id=PR.id\"\n-                      + \" and PS.status='Enrolled' and PR.enrollmentToken=:token and SB.customId=:studyId\")\n+                      + \" and PS.status in ('Enrolled','Withdrawn','inProgress') and PR.enrollmentToken=:token and SB.customId=:studyId\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyNzIxMQ=="}, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ4ODkwMg==", "bodyText": "Added the fixes to this PR now along with test case modification to accommodate the data integrity checks", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r474488902", "createdAt": "2020-08-21T07:52:45Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -120,7 +125,7 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n               .createQuery(\n                   \"from ParticipantStudiesBO PS,StudyInfoBO SB, ParticipantRegistrySite PR\"\n                       + \" where SB.id =PS.studyInfo.id and PS.participantRegistrySite.id=PR.id\"\n-                      + \" and PS.status='Enrolled' and PR.enrollmentToken=:token and SB.customId=:studyId\")\n+                      + \" and PS.status in ('Enrolled','Withdrawn','inProgress') and PR.enrollmentToken=:token and SB.customId=:studyId\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyNzIxMQ=="}, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzOTQzMTkzOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNzo0MDo0OVrOGyI3rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoxODozNVrOGz6c-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyNzMwOQ==", "bodyText": "nit: isEnrollmentTokenValid\nYou are using the term studyToken frequently here, whereas the correct term should be enrollmentToken", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r455227309", "createdAt": "2020-07-15T17:40:49Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenService.java", "diffHunk": "@@ -21,7 +23,8 @@\n \n   public boolean hasParticipant(@NotNull String shortName, @NotNull String tokenValue);\n \n-  public boolean isValidStudyToken(@NotNull String token, @NotNull String shortName);\n+  public boolean isValidStudyToken(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA4ODI0OA==", "bodyText": "changed it isEnrollmentTokenValid", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r457088248", "createdAt": "2020-07-20T06:18:35Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenService.java", "diffHunk": "@@ -21,7 +23,8 @@\n \n   public boolean hasParticipant(@NotNull String shortName, @NotNull String tokenValue);\n \n-  public boolean isValidStudyToken(@NotNull String token, @NotNull String shortName);\n+  public boolean isValidStudyToken(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyNzMwOQ=="}, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzOTQzNjgwOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/test/resources/data.sql", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNzo0MjoxOVrOGyI66w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoxOTo0MVrOGz6fNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyODEzOQ==", "bodyText": "why are these values changed?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r455228139", "createdAt": "2020-07-15T17:42:19Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/test/resources/data.sql", "diffHunk": "@@ -24,12 +24,12 @@ INSERT INTO `user_details` (`user_details_id`, `user_id`, `app_info_id`, `email`\n \t(45, 'leqmF97faSdVEB8-aUpS0dbXtSMDwIC-Iu9DgRWEcGxZezM', 1, 'cdash93@gmail.com', 1, 'test', 'user', 0, 0,  0, 0, '2020-01-30 20:21:28', '2020-02-05 19:11:05');\n \t\n INSERT INTO `participant_registry_site` (`id`, `site_id`, `study_info_id`, `email`, `invitation_date`, `onboarding_status`, `enrollment_token`, `enrollment_token_expiry`, `created`, `created_by`, `invitation_count`) VALUES\n-\t(30, 1, 1, 'abc@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n-\t(33, 1, 1, 'abc@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n-\t(34, 1, 4, 'xyz@gf.com', '2020-02-07 20:38:36', 'N', 'YB0CZICQ', '2020-02-09 18:42:34', '2020-02-09 18:42:32', 3, 0),\n+\t(30, 1, 1, 'cdash93@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA4ODgyMg==", "bodyText": "these data changed due to modification in logic to restrict the token usage  against mapped to email id only .", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r457088822", "createdAt": "2020-07-20T06:19:41Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/test/resources/data.sql", "diffHunk": "@@ -24,12 +24,12 @@ INSERT INTO `user_details` (`user_details_id`, `user_id`, `app_info_id`, `email`\n \t(45, 'leqmF97faSdVEB8-aUpS0dbXtSMDwIC-Iu9DgRWEcGxZezM', 1, 'cdash93@gmail.com', 1, 'test', 'user', 0, 0,  0, 0, '2020-01-30 20:21:28', '2020-02-05 19:11:05');\n \t\n INSERT INTO `participant_registry_site` (`id`, `site_id`, `study_info_id`, `email`, `invitation_date`, `onboarding_status`, `enrollment_token`, `enrollment_token_expiry`, `created`, `created_by`, `invitation_count`) VALUES\n-\t(30, 1, 1, 'abc@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n-\t(33, 1, 1, 'abc@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n-\t(34, 1, 4, 'xyz@gf.com', '2020-02-07 20:38:36', 'N', 'YB0CZICQ', '2020-02-09 18:42:34', '2020-02-09 18:42:32', 3, 0),\n+\t(30, 1, 1, 'cdash93@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyODEzOQ=="}, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzOTQ0MTk1OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/test/resources/data.sql", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNzo0Mzo0M1rOGyI-Lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoxOTo1N1rOGz6fzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyODk3NA==", "bodyText": "do we expect the same email, to be registered in the same study and site twice?\nThis should be invalid and the database should include unique constraints to prevent this from happening. Filed #643", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r455228974", "createdAt": "2020-07-15T17:43:43Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/test/resources/data.sql", "diffHunk": "@@ -24,12 +24,12 @@ INSERT INTO `user_details` (`user_details_id`, `user_id`, `app_info_id`, `email`\n \t(45, 'leqmF97faSdVEB8-aUpS0dbXtSMDwIC-Iu9DgRWEcGxZezM', 1, 'cdash93@gmail.com', 1, 'test', 'user', 0, 0,  0, 0, '2020-01-30 20:21:28', '2020-02-05 19:11:05');\n \t\n INSERT INTO `participant_registry_site` (`id`, `site_id`, `study_info_id`, `email`, `invitation_date`, `onboarding_status`, `enrollment_token`, `enrollment_token_expiry`, `created`, `created_by`, `invitation_count`) VALUES\n-\t(30, 1, 1, 'abc@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n-\t(33, 1, 1, 'abc@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n-\t(34, 1, 4, 'xyz@gf.com', '2020-02-07 20:38:36', 'N', 'YB0CZICQ', '2020-02-09 18:42:34', '2020-02-09 18:42:32', 3, 0),\n+\t(30, 1, 1, 'cdash93@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n+\t(33, 1, 1, 'cdash93@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA4ODk3Mw==", "bodyText": "removed this duplicate entry", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r457088973", "createdAt": "2020-07-20T06:19:57Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/test/resources/data.sql", "diffHunk": "@@ -24,12 +24,12 @@ INSERT INTO `user_details` (`user_details_id`, `user_id`, `app_info_id`, `email`\n \t(45, 'leqmF97faSdVEB8-aUpS0dbXtSMDwIC-Iu9DgRWEcGxZezM', 1, 'cdash93@gmail.com', 1, 'test', 'user', 0, 0,  0, 0, '2020-01-30 20:21:28', '2020-02-05 19:11:05');\n \t\n INSERT INTO `participant_registry_site` (`id`, `site_id`, `study_info_id`, `email`, `invitation_date`, `onboarding_status`, `enrollment_token`, `enrollment_token_expiry`, `created`, `created_by`, `invitation_count`) VALUES\n-\t(30, 1, 1, 'abc@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n-\t(33, 1, 1, 'abc@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n-\t(34, 1, 4, 'xyz@gf.com', '2020-02-07 20:38:36', 'N', 'YB0CZICQ', '2020-02-09 18:42:34', '2020-02-09 18:42:32', 3, 0),\n+\t(30, 1, 1, 'cdash93@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),\n+\t(33, 1, 1, 'cdash93@gmail.com', '2020-02-07 20:37:25', 'I', 'BSEEMNH6', '2020-02-09 18:42:32', '2020-02-09 18:42:32', 2, 0),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIyODk3NA=="}, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzOTQ3NTA2OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/EnrollmentTokenController.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxNzo1Mjo0MFrOGyJSxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNjoyMzo0OVrOGz6nuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIzNDI0NA==", "bodyText": "I am confused with this code, why are you checking for participants associated with a token? and looking at their status?\nDoesn't it make more sense to simply flag a token as used and/or remove it after the user has registered?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r455234244", "createdAt": "2020-07-15T17:52:40Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/EnrollmentTokenController.java", "diffHunk": "@@ -159,7 +161,7 @@ else if (enrollmentTokenfService.enrollmentTokenRequired(enrollmentBean.getStudy\n                     enrollmentBean.getStudyId(), enrollmentBean.getToken())) {\n                   if (enrollManagementUtil.isChecksumValid(enrollmentBean.getToken())) {\n                     if (enrollmentTokenfService.isValidStudyToken(\n-                        enrollmentBean.getToken(), enrollmentBean.getStudyId())) {\n+                        enrollmentBean.getToken(), enrollmentBean.getStudyId(), userId)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA5MTAwMQ==", "bodyText": "In the current scope the token cannot be removed as response server referred these tokens.  And the reason we added this check is to restrict the token usage against mapped to email id only .", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r457091001", "createdAt": "2020-07-20T06:23:49Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/EnrollmentTokenController.java", "diffHunk": "@@ -159,7 +161,7 @@ else if (enrollmentTokenfService.enrollmentTokenRequired(enrollmentBean.getStudy\n                     enrollmentBean.getStudyId(), enrollmentBean.getToken())) {\n                   if (enrollManagementUtil.isChecksumValid(enrollmentBean.getToken())) {\n                     if (enrollmentTokenfService.isValidStudyToken(\n-                        enrollmentBean.getToken(), enrollmentBean.getStudyId())) {\n+                        enrollmentBean.getToken(), enrollmentBean.getStudyId(), userId)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIzNDI0NA=="}, "originalCommit": {"oid": "c1794f273ee1bad1268617b8c0ff1ca1e98aff7e"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0NzM0ODM0OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/EnrollmentTokenController.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxNDo1NTozNlrOHBsRtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzo1Mjo1N1rOHEghCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTUzNjA1Mg==", "bodyText": "remove the extra space between import. Please refer to the styleguide on how to format imports.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r471536052", "createdAt": "2020-08-17T14:55:36Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/EnrollmentTokenController.java", "diffHunk": "@@ -22,6 +23,7 @@\n import org.springframework.web.bind.annotation.RequestHeader;\n import org.springframework.web.bind.annotation.RequestMapping;\n import org.springframework.web.bind.annotation.RestController;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed344613d51ed0f9367f79d5e833e556f624bc57"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ4OTA5Ng==", "bodyText": "Fix the format issue now", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r474489096", "createdAt": "2020-08-21T07:52:57Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/EnrollmentTokenController.java", "diffHunk": "@@ -22,6 +23,7 @@\n import org.springframework.web.bind.annotation.RequestHeader;\n import org.springframework.web.bind.annotation.RequestMapping;\n import org.springframework.web.bind.annotation.RestController;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTUzNjA1Mg=="}, "originalCommit": {"oid": "ed344613d51ed0f9367f79d5e833e556f624bc57"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0NzM1MTc3OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDao.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxNDo1NjoyMVrOHBsTwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzo1MzowOFrOHEghlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTUzNjU3OA==", "bodyText": "same here; please fox the format", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r471536578", "createdAt": "2020-08-17T14:56:21Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDao.java", "diffHunk": "@@ -9,22 +9,25 @@\n package com.google.cloud.healthcare.fdamystudies.dao;\n \n import javax.validation.constraints.NotNull;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed344613d51ed0f9367f79d5e833e556f624bc57"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ4OTIzOA==", "bodyText": "fixed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r474489238", "createdAt": "2020-08-21T07:53:08Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDao.java", "diffHunk": "@@ -9,22 +9,25 @@\n package com.google.cloud.healthcare.fdamystudies.dao;\n \n import javax.validation.constraints.NotNull;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTUzNjU3OA=="}, "originalCommit": {"oid": "ed344613d51ed0f9367f79d5e833e556f624bc57"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0NzQ3OTkzOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxNToyNjowMVrOHBthpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzo1NToxMlrOHEgomw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU1NjUxOA==", "bodyText": "these values should be passed from the enum values, not hardcoded in the query.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r471556518", "createdAt": "2020-08-17T15:26:01Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -120,7 +125,8 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n               .createQuery(\n                   \"from ParticipantStudiesBO PS,StudyInfoBO SB, ParticipantRegistrySite PR\"\n                       + \" where SB.id =PS.studyInfo.id and PS.participantRegistrySite.id=PR.id\"\n-                      + \" and PS.status='Enrolled' and PR.enrollmentToken=:token and SB.customId=:studyId\")\n+                      + \" and PS.status in ('Enrolled','Withdrawn','inProgress') \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed344613d51ed0f9367f79d5e833e556f624bc57"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ5MTAzNQ==", "bodyText": "created a ParticipantStudyStateStatus.java enum class  and replaced in the hasParticipant() DAO method", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r474491035", "createdAt": "2020-08-21T07:55:12Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -120,7 +125,8 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n               .createQuery(\n                   \"from ParticipantStudiesBO PS,StudyInfoBO SB, ParticipantRegistrySite PR\"\n                       + \" where SB.id =PS.studyInfo.id and PS.participantRegistrySite.id=PR.id\"\n-                      + \" and PS.status='Enrolled' and PR.enrollmentToken=:token and SB.customId=:studyId\")\n+                      + \" and PS.status in ('Enrolled','Withdrawn','inProgress') \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU1NjUxOA=="}, "originalCommit": {"oid": "ed344613d51ed0f9367f79d5e833e556f624bc57"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0NzQ4MTA2OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxNToyNjoxN1rOHBtiVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQwNzo1NToxOVrOHEgpAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU1NjY5Mw==", "bodyText": "please fix the format.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r471556693", "createdAt": "2020-08-17T15:26:17Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenService.java", "diffHunk": "@@ -9,23 +9,26 @@\n package com.google.cloud.healthcare.fdamystudies.service;\n \n import javax.validation.constraints.NotNull;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed344613d51ed0f9367f79d5e833e556f624bc57"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDQ5MTEzOA==", "bodyText": "fixed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r474491138", "createdAt": "2020-08-21T07:55:19Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EnrollmentTokenService.java", "diffHunk": "@@ -9,23 +9,26 @@\n package com.google.cloud.healthcare.fdamystudies.service;\n \n import javax.validation.constraints.NotNull;\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU1NjY5Mw=="}, "originalCommit": {"oid": "ed344613d51ed0f9367f79d5e833e556f624bc57"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NzM2NzAzOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNDoyOTo1NVrOHEviMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yM1QxMDo1NToxOVrOHFML2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDczNTE1NA==", "bodyText": "these are all the values for ParticpantStudyStateStatus, are we missing a value?\nIf not, maybe we don't need to filter by the status, if all status values are allowed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r474735154", "createdAt": "2020-08-21T14:29:55Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -115,12 +118,18 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n     List<Object[]> participantList = null;\n     boolean hasParticipant = false;\n     try (Session session = entityManagerFactory.unwrap(SessionFactory.class).openSession()) {\n+      List studyStateStatus = new ArrayList();\n+      studyStateStatus.add(ParticipantStudyStateStatus.ENROLLED.getValue());\n+      studyStateStatus.add(ParticipantStudyStateStatus.WITHDRAWN.getValue());\n+      studyStateStatus.add(ParticipantStudyStateStatus.INPROGRESS.getValue());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3d243b3abc194a650e207150f9c10fbaf5265e0"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTIwNDU3MQ==", "bodyText": "Yes, we have few more status like notEligible,yetToJoin,etc. But those are not required in the current scope, hence did not added. However I will add those values in enum and merge the code for future usage.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/640#discussion_r475204571", "createdAt": "2020-08-23T10:55:19Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/enroll-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/EnrollmentTokenDaoImpl.java", "diffHunk": "@@ -115,12 +118,18 @@ public boolean hasParticipant(@NotNull String studyId, @NotNull String tokenValu\n     List<Object[]> participantList = null;\n     boolean hasParticipant = false;\n     try (Session session = entityManagerFactory.unwrap(SessionFactory.class).openSession()) {\n+      List studyStateStatus = new ArrayList();\n+      studyStateStatus.add(ParticipantStudyStateStatus.ENROLLED.getValue());\n+      studyStateStatus.add(ParticipantStudyStateStatus.WITHDRAWN.getValue());\n+      studyStateStatus.add(ParticipantStudyStateStatus.INPROGRESS.getValue());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDczNTE1NA=="}, "originalCommit": {"oid": "d3d243b3abc194a650e207150f9c10fbaf5265e0"}, "originalPosition": 60}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2308, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}