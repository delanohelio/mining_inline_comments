{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2OTUwNzEx", "number": 1561, "title": "[Participant-enroll-mgnt-datastore]- \"/withdrawfromstudy\" endpoint issue fixes", "bodyText": "This PR contains the issue fixes for issue #1365\nDate of withdrawal was displaying NA.\nDate of withdrawal added in withdrawal process", "createdAt": "2020-10-20T16:42:02Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1561", "merged": true, "mergeCommit": {"oid": "9f2504795def21be885e612087a2315fe933361c"}, "closed": true, "closedAt": "2020-10-27T05:55:44Z", "author": {"login": "chiranjibi009"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdTKeBFAH2gAyNTA2OTUwNzExOjU1YTJkZmRjY2FlMDcwMzI5YTBiMmI1ZTVkNmRkMjM3NGRkZDM2OWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWicmlgH2gAyNTA2OTUwNzExOjIwN2MzNDdmNmIyNWJjODA0ZTMzYmY2MGIzYTkwMjMxNWYwNzYyYzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "55a2dfdccae070329a0b2b5e5d6dd2374ddd369d", "author": {"user": {"login": "chiranjibi009", "name": "Chiranjibi Dash"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/55a2dfdccae070329a0b2b5e5d6dd2374ddd369d", "committedDate": "2020-10-16T18:13:38Z", "message": "issue #1365 fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2073ea8dd5ee558fd9bf4927b3691c72a0c3df9e", "author": {"user": {"login": "chiranjibi009", "name": "Chiranjibi Dash"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2073ea8dd5ee558fd9bf4927b3691c72a0c3df9e", "committedDate": "2020-10-20T15:02:29Z", "message": "isEmpty used for empty string validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e477f1b4e3387b59e65cf9758cdd4276da28905", "author": {"user": {"login": "chiranjibi009", "name": "Chiranjibi Dash"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7e477f1b4e3387b59e65cf9758cdd4276da28905", "committedDate": "2020-10-20T16:29:49Z", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into issue-1365-fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d9551ed7962a725b15ec5d1f55c333a701e3d59", "author": {"user": {"login": "chiranjibi009", "name": "Chiranjibi Dash"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7d9551ed7962a725b15ec5d1f55c333a701e3d59", "committedDate": "2020-10-20T16:38:29Z", "message": "organized imports + code formated"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MTA5Mjc3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1561#pullrequestreview-514109277", "createdAt": "2020-10-21T19:26:59Z", "commit": {"oid": "7d9551ed7962a725b15ec5d1f55c333a701e3d59"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxOToyNjo1OVrOHmAAVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQxOToyNjo1OVrOHmAAVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTYwODAyMg==", "bodyText": "Why are all these checks being removed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1561#discussion_r509608022", "createdAt": "2020-10-21T19:26:59Z", "author": {"login": "saminguyen"}, "path": "participant-datastore/enroll-mgmt-module/enroll-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/StudyStateControllerTest.java", "diffHunk": "@@ -273,40 +271,18 @@ public void withdrawFromStudySuccess() throws Exception {\n \n     verifyTokenIntrospectRequest();\n \n-    MvcResult result =\n-        mockMvc\n-            .perform(\n-                get(ApiEndpoint.STUDY_STATE_PATH.getPath())\n-                    .headers(headers)\n-                    .contextPath(getContextPath()))\n-            .andDo(print())\n-            .andExpect(status().isOk())\n-            .andReturn();\n+    mockMvc\n+        .perform(\n+            get(ApiEndpoint.STUDY_STATE_PATH.getPath())\n+                .headers(headers)\n+                .contextPath(getContextPath()))\n+        .andDo(print())\n+        .andExpect(status().isOk())\n+        .andExpect(jsonPath(\"$.studies[3].participantId\").isEmpty())\n+        .andExpect(jsonPath(\"$.studies[3].status\", is(EnrollmentStatus.WITHDRAWN.getStatus())))\n+        .andReturn();\n \n     verifyTokenIntrospectRequest(2);\n-\n-    StudyStateResponse response =\n-        getObjectMapper()\n-            .readValue(result.getResponse().getContentAsString(), StudyStateResponse.class);\n-    Optional<StudyStateBean> study =\n-        response\n-            .getStudies()\n-            .stream()\n-            .filter(s -> s.getParticipantId().equals(Constants.PARTICIPANT_ID))\n-            .findFirst();\n-\n-    Optional<ParticipantStudyEntity> participantStudy =\n-        participantStudyRepository.findByParticipantId(Constants.PARTICIPANT_ID);\n-\n-    Optional<ParticipantRegistrySiteEntity> optParticipantRegistrySite =\n-        participantRegistrySiteRepository.findById(\n-            participantStudy.get().getParticipantRegistrySite().getId());\n-\n-    assertTrue(study.isPresent());\n-    assertEquals(\n-        optParticipantRegistrySite.get().getOnboardingStatus(),\n-        OnboardingStatus.DISABLED.getCode());\n-    assertEquals(AppConstants.WITHDRAWN, study.get().getStatus());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d9551ed7962a725b15ec5d1f55c333a701e3d59"}, "originalPosition": 89}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db312e1b594929dfdf5b89be377b0a3cdeb2d61e", "author": {"user": {"login": "chiranjibi009", "name": "Chiranjibi Dash"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/db312e1b594929dfdf5b89be377b0a3cdeb2d61e", "committedDate": "2020-10-22T06:08:45Z", "message": "Merge branch 'develop' into issue-1365-fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c38fed910ee14c7112403af318a5f76e64310c7", "author": {"user": {"login": "chiranjibi009", "name": "Chiranjibi Dash"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7c38fed910ee14c7112403af318a5f76e64310c7", "committedDate": "2020-10-23T10:34:48Z", "message": "Merge branch 'develop' into issue-1365-fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MTIzODAx", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1561#pullrequestreview-517123801", "createdAt": "2020-10-26T19:51:25Z", "commit": {"oid": "7c38fed910ee14c7112403af318a5f76e64310c7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "207c347f6b25bc804e33bf60b3a902315f0762c9", "author": {"user": {"login": "chiranjibi009", "name": "Chiranjibi Dash"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/207c347f6b25bc804e33bf60b3a902315f0762c9", "committedDate": "2020-10-27T05:51:35Z", "message": "Merge branch 'develop' into issue-1365-fixes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 154, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}