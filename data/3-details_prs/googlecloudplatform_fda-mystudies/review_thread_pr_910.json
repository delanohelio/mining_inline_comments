{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxODMzNTY4", "number": 910, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNDo0NDowMlrOEhSBsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNDo1Mjo1OFrOEhSSSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzMzMzODEwOnYy", "diffSide": "RIGHT", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/config/HibernateConfiguration.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNDo0NDowMlrOHOgoLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMjo1Njo1MFrOHPGApg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk3NjY4Nw==", "bodyText": "It doesn't seem like this is strictly necessary, spring-boot-data seems like it does this for you https://stackoverflow.com/a/41643269", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/910#discussion_r484976687", "createdAt": "2020-09-08T14:44:02Z", "author": {"login": "nikklassen"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/config/HibernateConfiguration.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.config;\n+\n+import java.util.Properties;\n+import javax.sql.DataSource;\n+import org.apache.commons.lang3.StringUtils;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.jdbc.datasource.DriverManagerDataSource;\n+import org.springframework.orm.hibernate5.HibernateTransactionManager;\n+import org.springframework.orm.hibernate5.LocalSessionFactoryBean;\n+import org.springframework.transaction.annotation.EnableTransactionManagement;\n+\n+@Configuration\n+@EnableTransactionManagement", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "422705145683a17a72b52594666eda04b8d7ce1d"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTU4OTE1OA==", "bodyText": "Removed @EnableTransactionManagement annotation.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/910#discussion_r485589158", "createdAt": "2020-09-09T12:56:50Z", "author": {"login": "monica-BTC"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/config/HibernateConfiguration.java", "diffHunk": "@@ -0,0 +1,92 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.config;\n+\n+import java.util.Properties;\n+import javax.sql.DataSource;\n+import org.apache.commons.lang3.StringUtils;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.jdbc.datasource.DriverManagerDataSource;\n+import org.springframework.orm.hibernate5.HibernateTransactionManager;\n+import org.springframework.orm.hibernate5.LocalSessionFactoryBean;\n+import org.springframework.transaction.annotation.EnableTransactionManagement;\n+\n+@Configuration\n+@EnableTransactionManagement", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk3NjY4Nw=="}, "originalCommit": {"oid": "422705145683a17a72b52594666eda04b8d7ce1d"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzMzM3NzM1OnYy", "diffSide": "LEFT", "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/CloudStorageService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNDo1MjoxOFrOHOhAxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxMzo0NjoxMVrOHPIJBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk4Mjk4MA==", "bodyText": "Why are these changes included?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/910#discussion_r484982980", "createdAt": "2020-09-08T14:52:18Z", "author": {"login": "nikklassen"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/CloudStorageService.java", "diffHunk": "@@ -66,27 +58,14 @@ public String saveFile(String fileName, String content, String underDirectory) {\n   }\n \n   @Override\n-  public void downloadFileTo(String absoluteFileName, OutputStream outputStream) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "422705145683a17a72b52594666eda04b8d7ce1d"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTYyNDA2OQ==", "bodyText": "Some of the tests were failing so we needed to fix them. We implemented Cloud Storage mock in Participant Manager so we've refactored the code to follow same approach here.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/910#discussion_r485624069", "createdAt": "2020-09-09T13:46:11Z", "author": {"login": "dhanyak-btc"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/CloudStorageService.java", "diffHunk": "@@ -66,27 +58,14 @@ public String saveFile(String fileName, String content, String underDirectory) {\n   }\n \n   @Override\n-  public void downloadFileTo(String absoluteFileName, OutputStream outputStream) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk4Mjk4MA=="}, "originalCommit": {"oid": "422705145683a17a72b52594666eda04b8d7ce1d"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzMzM4MDU5OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserConsentManagementServiceImpl.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNDo1Mjo1OFrOHOhCuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNDowMDo0NFrOHPI1bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk4MzQ4Mw==", "bodyText": "Shouldn't these annotations be on the Dao class? That way you add them in one place instead of everywhere that the Dao is used", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/910#discussion_r484983483", "createdAt": "2020-09-08T14:52:58Z", "author": {"login": "nikklassen"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserConsentManagementServiceImpl.java", "diffHunk": "@@ -42,6 +41,7 @@\n       LoggerFactory.getLogger(UserConsentManagementServiceImpl.class);\n \n   @Override\n+  @Transactional(readOnly = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "422705145683a17a72b52594666eda04b8d7ce1d"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTYyNTY2NA==", "bodyText": "I checked SO post Where should \u201c@Transactional\u201d be place Service Layer or DAO\nWe should add @Transactional in Service layer.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/910#discussion_r485625664", "createdAt": "2020-09-09T13:48:13Z", "author": {"login": "dhanyak-btc"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserConsentManagementServiceImpl.java", "diffHunk": "@@ -42,6 +41,7 @@\n       LoggerFactory.getLogger(UserConsentManagementServiceImpl.class);\n \n   @Override\n+  @Transactional(readOnly = true)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk4MzQ4Mw=="}, "originalCommit": {"oid": "422705145683a17a72b52594666eda04b8d7ce1d"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTYzNTQzNg==", "bodyText": "You also see on that post.\n\nThere are a lot of CRUD applications that don't have any significant business logic, for them having a service layer that just passes stuff through between the controllers and data access objects is not useful. In these cases we can put transaction annotation on Dao.\n\nIt's really just a judgement call of where your logical transactions exist. Either way is fine here I guess, I just wanted to highlight that this isn't a hard rule.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/910#discussion_r485635436", "createdAt": "2020-09-09T14:00:44Z", "author": {"login": "nikklassen"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserConsentManagementServiceImpl.java", "diffHunk": "@@ -42,6 +41,7 @@\n       LoggerFactory.getLogger(UserConsentManagementServiceImpl.class);\n \n   @Override\n+  @Transactional(readOnly = true)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDk4MzQ4Mw=="}, "originalCommit": {"oid": "422705145683a17a72b52594666eda04b8d7ce1d"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1972, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}