{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MjIwNzYy", "number": 684, "title": "sites tab implementation", "bodyText": "sites tab implementation ,css splitting has been done", "createdAt": "2020-07-27T15:00:39Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684", "merged": true, "mergeCommit": {"oid": "2e0fb6ac67cde8faeaac3829e06b219316aad269"}, "closed": true, "closedAt": "2020-08-11T06:39:10Z", "author": {"login": "firdosebtc1"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5CTR3AH2gAyNDU3MjIwNzYyOjczYzdkNDRmNDYwNmMyNmY5MzQ4Y2FmNjY1YjY3NTkxZWQ3ZjU4MjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9w7TkgH2gAyNDU3MjIwNzYyOjAwMDQyZDlkZWQxMTE1MThkYjljZTc4YWZhNmFkMDk3NDFmOTFlZWU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "73c7d44f4606c26f9348caf665b67591ed7f5822", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/73c7d44f4606c26f9348caf665b67591ed7f5822", "committedDate": "2020-07-27T14:00:38Z", "message": "sites tab implementation ,css splitting and moving test case data to seperate file has been done"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d610506ea1db9bd317345af7ac790b7e95ff5c1e", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d610506ea1db9bd317345af7ac790b7e95ff5c1e", "committedDate": "2020-07-28T08:16:42Z", "message": "removed css splitting code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f65b2545f7f0807189ddf143d47220ead4e3a7c", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6f65b2545f7f0807189ddf143d47220ead4e3a7c", "committedDate": "2020-07-28T08:23:07Z", "message": "style.css changes has been moved to another brnach and it will be raised as a seperate PR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3dccf843be1c52d837de210e0d4cc74f122fea9", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d3dccf843be1c52d837de210e0d4cc74f122fea9", "committedDate": "2020-07-30T14:25:18Z", "message": "code review comments as per #685"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aed2c8907efdca4f4e914e24d9d0f813653a8ea6", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/aed2c8907efdca4f4e914e24d9d0f813653a8ea6", "committedDate": "2020-07-31T16:10:37Z", "message": "test case has been updated with mock data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf037bedbb0481573903bf426b31108512cf3de9", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/bf037bedbb0481573903bf426b31108512cf3de9", "committedDate": "2020-08-05T13:09:55Z", "message": "changed add site to directly call http method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6610f2d3ead967f743f1564a114e4db80dfe737", "author": {"user": {"login": "nikklassen", "name": "Nik Klassen"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/b6610f2d3ead967f743f1564a114e4db80dfe737", "committedDate": "2020-08-05T15:53:11Z", "message": "Merge branch 'develop' into urwebapp-sites-tab"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/70348d08ba0769cbf2bb75ac625a375d2920739a", "committedDate": "2020-08-05T16:52:36Z", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into urwebapp-sites-tab\n\n# Conflicts:\n#\tUR-web-app/src/app/app.module.ts\n#\tUR-web-app/src/app/entity/api.response.model.ts\n#\tUR-web-app/src/app/entity/mockLocationData.ts\n#\tUR-web-app/src/app/entity/mockStudiesData.ts\n#\tUR-web-app/src/app/http-interceptors/auth.interceptor.ts\n#\tUR-web-app/src/app/site-coordinator/location/shared/location.service.spec.ts\n#\tUR-web-app/src/app/site-coordinator/studies/study-list/study-list.component.spec.ts\n#\tUR-web-app/src/app/sub-sink.ts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxODY4NTIz", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#pullrequestreview-461868523", "createdAt": "2020-08-05T17:17:50Z", "commit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNzoxNzo1MFrOG8TMNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxNzo0OTo0MVrOG8UR9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg4MjE2Ng==", "bodyText": "Don't build queries yourself. Let the HttpClient do this for you, i.e.\n    return this.http.get<Location[]>('locations-for-site-creation', {\n      params: {studyId},\n    });\nIt's a lot easier to understand with more parameters, and you don't have to worry about encoding the url param", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465882166", "createdAt": "2020-08-05T17:17:50Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.ts", "diffHunk": "@@ -21,6 +21,11 @@ export class LocationService {\n   getLocations(): Observable<Location[]> {\n     return this.entityService.getCollection('locations');\n   }\n+  getLocationsForSiteCreation(studyId: string): Observable<Location[]> {\n+    return this.entityService.getCollection(\n+      'locations-for-site-creation?studyId=' + studyId,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5MzMyOA==", "bodyText": "nit: toHaveBeenCalledTimes", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465893328", "createdAt": "2020-08-05T17:37:35Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/sites/add-site/add-site.component.spec.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+} from '@angular/core/testing';\n+\n+import {AddSiteComponent} from './add-site.component';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n+import {of} from 'rxjs';\n+import {SiteCoordinatorModule} from '../../site-coordinator.module';\n+import {\n+  BrowserAnimationsModule,\n+  NoopAnimationsModule,\n+} from '@angular/platform-browser/animations';\n+import {SitesModule} from '../sites.module';\n+import {LocationService} from '../../location/shared/location.service';\n+import {SitesService} from '../shared/sites.service';\n+import {expectedLocationList} from 'src/app/entity/mockLocationData';\n+import {\n+  expectedSiteResponse,\n+  expectedStudyId,\n+} from 'src/app/entity/mockStudiesData';\n+import {DebugElement} from '@angular/core';\n+describe('AddSiteComponent', () => {\n+  let component: AddSiteComponent;\n+  let fixture: ComponentFixture<AddSiteComponent>;\n+  let addSite: DebugElement;\n+  let cancelSite: DebugElement;\n+  beforeEach(async(async () => {\n+    const sitesServiceSpy = jasmine.createSpyObj<SitesService>('SitesService', [\n+      'add',\n+    ]);\n+    const locationServiceSpy = jasmine.createSpyObj<LocationService>(\n+      'LocationService',\n+      ['getLocationsForSiteCreation'],\n+    );\n+    await TestBed.configureTestingModule({\n+      declarations: [AddSiteComponent],\n+      imports: [\n+        SiteCoordinatorModule,\n+        BrowserAnimationsModule,\n+        SitesModule,\n+        NoopAnimationsModule,\n+        HttpClientModule,\n+        RouterTestingModule.withRoutes([]),\n+        ModalModule.forRoot(),\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [\n+        EntityService,\n+        LocationService,\n+        BsModalService,\n+        {provide: SitesService, useValue: sitesServiceSpy},\n+      ],\n+    })\n+      .compileComponents()\n+      .then(() => {\n+        locationServiceSpy.getLocationsForSiteCreation.and.returnValue(\n+          of(expectedLocationList),\n+        );\n+        sitesServiceSpy.add.and.returnValue(of(expectedSiteResponse));\n+      });\n+  }));\n+\n+  beforeEach(() => {\n+    fixture = TestBed.createComponent(AddSiteComponent);\n+    component = fixture.componentInstance;\n+    fixture.detectChanges();\n+    addSite = fixture.debugElement.query(By.css('[name=\"add\"]'));\n+    cancelSite = fixture.debugElement.query(By.css('[name=\"cancel\"]'));\n+  });\n+\n+  it('should create', () => {\n+    expect(component).toBeTruthy();\n+  });\n+\n+  it('should call get location list for dropdown ', fakeAsync(() => {\n+    const spyobjs = spyOn(component, 'getLocation');\n+    component.getLocation(expectedStudyId.id);\n+    fixture.detectChanges();\n+    expect(spyobjs.calls.count()).toBe(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5MzUzOQ==", "bodyText": "This is the method you just spied on, don't call spies in tests. Did you mean to spy on the service?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465893539", "createdAt": "2020-08-05T17:37:58Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/sites/add-site/add-site.component.spec.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+} from '@angular/core/testing';\n+\n+import {AddSiteComponent} from './add-site.component';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n+import {of} from 'rxjs';\n+import {SiteCoordinatorModule} from '../../site-coordinator.module';\n+import {\n+  BrowserAnimationsModule,\n+  NoopAnimationsModule,\n+} from '@angular/platform-browser/animations';\n+import {SitesModule} from '../sites.module';\n+import {LocationService} from '../../location/shared/location.service';\n+import {SitesService} from '../shared/sites.service';\n+import {expectedLocationList} from 'src/app/entity/mockLocationData';\n+import {\n+  expectedSiteResponse,\n+  expectedStudyId,\n+} from 'src/app/entity/mockStudiesData';\n+import {DebugElement} from '@angular/core';\n+describe('AddSiteComponent', () => {\n+  let component: AddSiteComponent;\n+  let fixture: ComponentFixture<AddSiteComponent>;\n+  let addSite: DebugElement;\n+  let cancelSite: DebugElement;\n+  beforeEach(async(async () => {\n+    const sitesServiceSpy = jasmine.createSpyObj<SitesService>('SitesService', [\n+      'add',\n+    ]);\n+    const locationServiceSpy = jasmine.createSpyObj<LocationService>(\n+      'LocationService',\n+      ['getLocationsForSiteCreation'],\n+    );\n+    await TestBed.configureTestingModule({\n+      declarations: [AddSiteComponent],\n+      imports: [\n+        SiteCoordinatorModule,\n+        BrowserAnimationsModule,\n+        SitesModule,\n+        NoopAnimationsModule,\n+        HttpClientModule,\n+        RouterTestingModule.withRoutes([]),\n+        ModalModule.forRoot(),\n+        ToastrModule.forRoot({\n+          positionClass: 'toast-top-center',\n+          preventDuplicates: true,\n+          enableHtml: true,\n+        }),\n+      ],\n+      providers: [\n+        EntityService,\n+        LocationService,\n+        BsModalService,\n+        {provide: SitesService, useValue: sitesServiceSpy},\n+      ],\n+    })\n+      .compileComponents()\n+      .then(() => {\n+        locationServiceSpy.getLocationsForSiteCreation.and.returnValue(\n+          of(expectedLocationList),\n+        );\n+        sitesServiceSpy.add.and.returnValue(of(expectedSiteResponse));\n+      });\n+  }));\n+\n+  beforeEach(() => {\n+    fixture = TestBed.createComponent(AddSiteComponent);\n+    component = fixture.componentInstance;\n+    fixture.detectChanges();\n+    addSite = fixture.debugElement.query(By.css('[name=\"add\"]'));\n+    cancelSite = fixture.debugElement.query(By.css('[name=\"cancel\"]'));\n+  });\n+\n+  it('should create', () => {\n+    expect(component).toBeTruthy();\n+  });\n+\n+  it('should call get location list for dropdown ', fakeAsync(() => {\n+    const spyobjs = spyOn(component, 'getLocation');\n+    component.getLocation(expectedStudyId.id);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5NTY3OQ==", "bodyText": "nit: use String(...) or ...toString() consistently", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465895679", "createdAt": "2020-08-05T17:41:52Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/sites/add-site/add-site.component.ts", "diffHunk": "@@ -0,0 +1,64 @@\n+import {Component, Input, OnInit, EventEmitter, Output} from '@angular/core';\n+import {getMessage} from 'src/app/shared/success.codes.enum';\n+import {SitesService} from '../shared/sites.service';\n+import {UnsubscribeOnDestroyAdapter} from 'src/app/unsubscribe-on-destroy-adapter';\n+import {ToastrService} from 'ngx-toastr';\n+import {Study} from '../../studies/shared/study.model';\n+import {AddSite} from '../shared/add.sites.model';\n+import {LocationService} from '../../location/shared/location.service';\n+import {Location} from '../../location/shared/location.model';\n+@Component({\n+  selector: 'add-site',\n+  templateUrl: './add-site.component.html',\n+  styleUrls: ['./add-site.component.scss'],\n+})\n+export class AddSiteComponent extends UnsubscribeOnDestroyAdapter\n+  implements OnInit {\n+  @Input() study = {} as Study;\n+  @Output() closeModalEvent = new EventEmitter();\n+  newSite = {} as Study;\n+  site = {} as AddSite;\n+  locations: Location[] = [];\n+  constructor(\n+    private readonly siteService: SitesService,\n+    private readonly toastr: ToastrService,\n+    private readonly locationService: LocationService,\n+  ) {\n+    super();\n+  }\n+  ngOnInit(): void {\n+    this.newSite.customId = this.study.customId;\n+    this.newSite.appId = this.study.appId;\n+    this.site.studyId = String(this.study.id);\n+    this.getLocation(this.study.id);\n+  }\n+  getLocation(studyId: number): void {\n+    if (studyId) {\n+      this.locationService\n+        .getLocationsForSiteCreation(studyId.toString())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5NzI5MQ==", "bodyText": "nit: You don't need include .model in these file names. add-site-response.ts would be preferred.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465897291", "createdAt": "2020-08-05T17:44:42Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/sites/shared/add.sites.model.ts", "diffHunk": "@@ -0,0 +1,6 @@\n+import {ApiResponse} from 'src/app/entity/api.response.model';\n+\n+export interface AddSite extends ApiResponse {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5Nzk5NQ==", "bodyText": "This interface extends ApiResponse, but you are creating it here. There should be a separate AddSiteRequest and AddSiteResponse.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465897995", "createdAt": "2020-08-05T17:45:54Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/sites/add-site/add-site.component.ts", "diffHunk": "@@ -0,0 +1,64 @@\n+import {Component, Input, OnInit, EventEmitter, Output} from '@angular/core';\n+import {getMessage} from 'src/app/shared/success.codes.enum';\n+import {SitesService} from '../shared/sites.service';\n+import {UnsubscribeOnDestroyAdapter} from 'src/app/unsubscribe-on-destroy-adapter';\n+import {ToastrService} from 'ngx-toastr';\n+import {Study} from '../../studies/shared/study.model';\n+import {AddSite} from '../shared/add.sites.model';\n+import {LocationService} from '../../location/shared/location.service';\n+import {Location} from '../../location/shared/location.model';\n+@Component({\n+  selector: 'add-site',\n+  templateUrl: './add-site.component.html',\n+  styleUrls: ['./add-site.component.scss'],\n+})\n+export class AddSiteComponent extends UnsubscribeOnDestroyAdapter\n+  implements OnInit {\n+  @Input() study = {} as Study;\n+  @Output() closeModalEvent = new EventEmitter();\n+  newSite = {} as Study;\n+  site = {} as AddSite;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5ODMzOA==", "bodyText": "This can use an async pipe.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465898338", "createdAt": "2020-08-05T17:46:32Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/sites/add-site/add-site.component.html", "diffHunk": "@@ -0,0 +1,55 @@\n+<div class=\"modal-body modal__body\">\n+    <div class=\"row border__bottom__c4d1e6 background__dfe4ec\">\n+        <div class=\"col-xs-12 col-md-5 p-none\">\n+            <div name=\"customId\" class=\"mb-lg\">\n+                <label>study</label>\n+                <div>{{ newSite.customId }}</div>\n+            </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-7 p-none\">\n+            <div name=\"appId\" class=\"mb-lg\">\n+                <label>app</label>\n+                <div>{{ newSite.appId }}</div>\n+            </div>\n+        </div>\n+    </div>\n+    <form ngForm #addSiteForm=\"ngForm\" autocomplete=\"off\">\n+        <div class=\"row border__bottom__c4d1e6\">\n+            <div class=\"col-xs-12 col-md-12 p-none\">\n+                <div class=\"form-group\">\n+                    <div class=\"form-item\">\n+                        <label>Location</label>\n+                        <div class=\"select-wrap\">\n+                            <select class=\"form-item__element form-item__element--select\" [(ngModel)]=\"site.locationId\"\n+                                required name=\"location\" #location=\"ngModel\">\n+                                <option disabled selected>Select Location</option>\n+                                <option class=\"cursor__pointer\" *ngFor=\"let location of locations\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5OTQwNA==", "bodyText": "nit: formatting, newline before {{", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465899404", "createdAt": "2020-08-05T17:48:31Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/sites/site-list/site-list.component.html", "diffHunk": "@@ -0,0 +1,78 @@\n+<div class=\"max__w__1280\">\n+    <div class=\"tab-content\">\n+        <ng-container *ngIf=\"study$ | async as studies\">\n+            <div *ngIf=\"studies.length != 0\">\n+                <div *ngFor=\"let study of studies\" class=\"bg__white cards box__shadow-cmn ml-none mr-none studies_row\">\n+                    <div class=\"flex__ flex__row\">\n+                        <div class=\"img__container__left\" *ngIf=\"study.logo\">\n+                            <img [src]=\"study.logo\" alt=\"studyLogo\" />\n+                        </div>\n+                        <div class=\"width__100\">\n+                            <div class=\"row\">\n+                                <div class=\"col-xs-12 col-md-12 p-none dashboard-card__title cursor__pointer\">\n+                                    {{ study.customId }}\n+                                </div>\n+                                <div class=\"text-grey__sm row flex-wrap-unset col-xs-12 col-md-12 p-none\">\n+                                    <div class=\"col-xs-6 col-md-3 p-none\">\n+                                        <span\n+                                            *ngIf=\"study.type != 'OPEN'\">{{ study.sites.length | i18nPlural: messageMapping }}\n+                                        </span>\n+                                        <span *ngIf=\"study.type == 'OPEN'\">Open Study</span>\n+                                    </div>\n+                                    <div class=\"col-xs-6 col-md-9 text-right p-none mb__display__none\">\n+                                        Enrolled /\n+                                        <span *ngIf=\"study.type != 'OPEN'\">Invited</span>\n+                                        <span *ngIf=\"study.type == 'OPEN'\">Target</span>\n+                                    </div>\n+                                </div>\n+                                <div class=\"col-xs-12 col-md-12 p-none border__bottom__red progress__bar\">\n+                                    <div *ngFor=\"let site of study.sites\"\n+                                        class=\"row display-flex-center progress__bar__row\" (click)=\"\n+                      study.type != 'OPEN'\n+                        ? navigateToParticipantList('site', site.id)\n+                        : navigateToParticipantList('study', study.id)\n+                    \">\n+                                        <div class=\"col-xs-12 col-md-8 p-none cursor__pointer\">\n+                                            <span *ngIf=\"study.type != 'OPEN'\" class=\"sites_row\">{{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkwMDAyMg==", "bodyText": "unsubscribe here", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465900022", "createdAt": "2020-08-05T17:49:41Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/sites/site-list/site-list.component.ts", "diffHunk": "@@ -0,0 +1,67 @@\n+import {Component, OnInit} from '@angular/core';\n+import {BehaviorSubject, combineLatest, Observable} from 'rxjs';\n+import {map} from 'rxjs/operators';\n+import {of} from 'rxjs';\n+import {Study} from '../../studies/shared/study.model';\n+import {Site} from '../../studies/shared/site.model';\n+import {BsModalService, BsModalRef} from 'ngx-bootstrap/modal';\n+import {StudiesService} from '../../studies/shared/studies.service';\n+\n+@Component({\n+  selector: 'app-site-list',\n+  templateUrl: './site-list.component.html',\n+  styleUrls: ['./site-list.component.scss'],\n+})\n+export class SiteListComponent implements OnInit {\n+  query$ = new BehaviorSubject('');\n+  study$: Observable<Study[]> = of([]);\n+  study = {} as Study;\n+  messageMapping: {[k: string]: string} = {\n+    '=0': 'No Sites',\n+    '=1': 'One Site',\n+    'other': '# Sites',\n+  };\n+  constructor(\n+    private readonly studiesService: StudiesService,\n+    private readonly modalService: BsModalService,\n+    private modalRef: BsModalRef,\n+  ) {}\n+\n+  ngOnInit(): void {\n+    this.getStudies();\n+  }\n+  closeModal(): void {\n+    this.modalRef.hide();\n+    this.getStudies();\n+  }\n+  getStudies(): void {\n+    this.study$ = combineLatest(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NjQ4ODIz", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#pullrequestreview-458648823", "createdAt": "2020-07-30T18:22:02Z", "commit": {"oid": "d3dccf843be1c52d837de210e0d4cc74f122fea9"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxODoyMjowMlrOG5urzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxOTo1MDoyMVrOG8YOvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE4Njg5NA==", "bodyText": "Is there any reason that the Location variable's name is plural while the array variable above (line 2) is singular?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r463186894", "createdAt": "2020-07-30T18:22:02Z", "author": {"login": "sunxd-chromium"}, "path": "UR-web-app/src/app/entity/mockLocationData.ts", "diffHunk": "@@ -0,0 +1,62 @@\n+import {Location} from 'src/app/site-coordinator/location/shared/location.model';\n+export const expectedLocation: Location[] = [\n+  {\n+    id: 2,\n+    customId: 'customid3',\n+    name: 'name -1-updated0',\n+    description: 'location-descp-updated',\n+    status: '1',\n+    studiesCount: 0,\n+  },\n+] as Location[];\n+export const expectedLocations: Location = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3dccf843be1c52d837de210e0d4cc74f122fea9"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzc5OTc2MQ==", "bodyText": "It's a bit odd that a location object has a plural name while location list's name is singular, can you rename the variables in this file in this way:\n\nexpectedLocation for single objects\nexpectedLocationList for arrays", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r463799761", "createdAt": "2020-07-31T19:46:13Z", "author": {"login": "sunxd-chromium"}, "path": "UR-web-app/src/app/entity/mockLocationData.ts", "diffHunk": "@@ -0,0 +1,62 @@\n+import {Location} from 'src/app/site-coordinator/location/shared/location.model';\n+export const expectedLocation = [\n+  {\n+    id: 2,\n+    customId: 'customid3',\n+    name: 'name -1-updated0',\n+    description: 'location-descp-updated',\n+    status: '1',\n+    studiesCount: 0,\n+  },\n+] as Location[];\n+export const expectedLocations = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aed2c8907efdca4f4e914e24d9d0f813653a8ea6"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTIyNTM5OQ==", "bodyText": "Does it work if you write:\nexport const expectedSiteResponse: AddSite = {\n...\n};", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465225399", "createdAt": "2020-08-04T17:50:03Z", "author": {"login": "sunxd-chromium"}, "path": "UR-web-app/src/app/entity/mockStudiesData.ts", "diffHunk": "@@ -0,0 +1,92 @@\n+import {Study} from '../site-coordinator/studies/shared/study.model';\n+import {AddSite} from '../site-coordinator/sites/shared/add.sites.model';\n+\n+export const expectedStudyList = [\n+  {\n+    appId: '',\n+    appInfoId: 0,\n+    customId: 'NewStudyTest',\n+    enrolledCount: 41,\n+    enrollmentPercentage: 38,\n+    id: 1,\n+    invitedCount: 4,\n+    name: 'New Study Test',\n+    sites: [\n+      {\n+        edit: 1,\n+        enrolledCount: 7,\n+        enrollmentPercentage: 50,\n+        id: 11,\n+        invitedCount: 14,\n+        name: 'Location 1',\n+        status: '',\n+      },\n+    ],\n+    studyPermission: 2,\n+    totalSitesCount: 16,\n+    type: 'CLOSE',\n+    logo: '/path_to_img/',\n+  },\n+  {\n+    appId: '',\n+    appInfoId: 0,\n+    customId: 'OpenStudy',\n+    enrolledCount: 5,\n+    enrollmentPercentage: 0,\n+    id: 12,\n+    invitedCount: 9,\n+    name: 'Open Study 02',\n+    sites: [\n+      {\n+        edit: 1,\n+        enrolledCount: 12,\n+        enrollmentPercentage: 14,\n+        id: 10,\n+        invitedCount: 0,\n+        name: 'Location 2',\n+        status: '',\n+      },\n+      {\n+        edit: 1,\n+        enrolledCount: 32,\n+        enrollmentPercentage: 44,\n+        id: 10,\n+        invitedCount: 0,\n+        name: 'Location 3',\n+        status: '',\n+      },\n+    ],\n+    studyPermission: 1,\n+    totalSitesCount: 5,\n+    type: 'CLOSE',\n+    logo: '/path_to_img/',\n+  },\n+  {\n+    appId: '',\n+    appInfoId: 0,\n+    customId: 'ClosedStudy',\n+    enrolledCount: 54,\n+    enrollmentPercentage: 17,\n+    id: 14,\n+    invitedCount: 0,\n+    name: 'Closed Study',\n+    sites: [],\n+    studyPermission: 2,\n+    totalSitesCount: 6,\n+    type: 'OPEN',\n+    logo: '/path_to_img/',\n+  },\n+] as Study[];\n+\n+export const expectedSiteResponse = {\n+  studyId: '1',\n+  locationId: '1',\n+  message: 'New site added successfully',\n+} as AddSite;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aed2c8907efdca4f4e914e24d9d0f813653a8ea6"}, "originalPosition": 85}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTMyMDIzMA==", "bodyText": "Can you make this one line?\nOr you can write:\nimport * as expectedResults from 'src/app/entity/mockLocationData';\nand use those expected consts by expectedResults.expectedLocation etc. in this file.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465320230", "createdAt": "2020-08-04T20:46:14Z", "author": {"login": "sunxd-chromium"}, "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.spec.ts", "diffHunk": "@@ -9,50 +9,16 @@ import {EntityService} from '../../../service/entity.service';\n import {throwError, of} from 'rxjs';\n import {Location} from '../shared/location.model';\n import {ApiResponse} from 'src/app/entity/api.response.model';\n+import {\n+  expectedLocation,\n+  expectedLocations,\n+  expectedResponse,\n+  expectedLocatiodId,\n+  expectedLocationList,\n+} from 'src/app/entity/mockLocationData';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aed2c8907efdca4f4e914e24d9d0f813653a8ea6"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTc0MDc5MA==", "bodyText": "Is this \"as ApiResponse\" redundant?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465740790", "createdAt": "2020-08-05T13:50:14Z", "author": {"login": "sunxd-chromium"}, "path": "UR-web-app/src/app/site-coordinator/location/shared/location.service.spec.ts", "diffHunk": "@@ -122,8 +107,7 @@ describe('LocationService', () => {\n     locationService = new LocationService(entityServicespy);\n     const errorResponse: ApiResponse = {\n       message: 'User does not exist',\n-      code: 'MSG_013',\n-    };\n+    } as ApiResponse;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aed2c8907efdca4f4e914e24d9d0f813653a8ea6"}, "originalPosition": 116}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk2NDA3Mw==", "bodyText": "If you use \"==\" operands, it doesn't check the type but instead convert everything to number and compare, so I think '' == 0, you may need only two comparison here: locationId == 0 || locationiD == null.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465964073", "createdAt": "2020-08-05T19:49:05Z", "author": {"login": "sunxd-chromium"}, "path": "UR-web-app/src/app/site-coordinator/sites/add-site/add-site.component.html", "diffHunk": "@@ -0,0 +1,55 @@\n+<div class=\"modal-body modal__body\">\n+    <div class=\"row border__bottom__c4d1e6 background__dfe4ec\">\n+        <div class=\"col-xs-12 col-md-5 p-none\">\n+            <div name=\"customId\" class=\"mb-lg\">\n+                <label>study</label>\n+                <div>{{ newSite.customId }}</div>\n+            </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-7 p-none\">\n+            <div name=\"appId\" class=\"mb-lg\">\n+                <label>app</label>\n+                <div>{{ newSite.appId }}</div>\n+            </div>\n+        </div>\n+    </div>\n+    <form ngForm #addSiteForm=\"ngForm\" autocomplete=\"off\">\n+        <div class=\"row border__bottom__c4d1e6\">\n+            <div class=\"col-xs-12 col-md-12 p-none\">\n+                <div class=\"form-group\">\n+                    <div class=\"form-item\">\n+                        <label>Location</label>\n+                        <div class=\"select-wrap\">\n+                            <select class=\"form-item__element form-item__element--select\" [(ngModel)]=\"site.locationId\"\n+                                required name=\"location\" #location=\"ngModel\">\n+                                <option disabled selected>Select Location</option>\n+                                <option class=\"cursor__pointer\" *ngFor=\"let location of locations\"\n+                                    value=\"{{ location.id }}\">\n+                                    {{ location.name }}</option>\n+                            </select>\n+                        </div>\n+                    </div>\n+                    <div class=\"validation-error\" *ngIf=\"location.dirty || location.touched\">\n+                        <span class=\"help-block with-errors error__msg\" *ngIf=\"\n+                  site.locationId == '' ||\n+                  site.locationId == null ||\n+                  site.locationId == 0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTk2NDczNA==", "bodyText": "Nit: new line.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#discussion_r465964734", "createdAt": "2020-08-05T19:50:21Z", "author": {"login": "sunxd-chromium"}, "path": "UR-web-app/src/app/site-coordinator/sites/add-site/add-site.component.spec.ts", "diffHunk": "@@ -0,0 +1,107 @@\n+import {\n+  async,\n+  ComponentFixture,\n+  TestBed,\n+  fakeAsync,\n+} from '@angular/core/testing';\n+\n+import {AddSiteComponent} from './add-site.component';\n+import {ToastrModule} from 'ngx-toastr';\n+import {BsModalService, ModalModule} from 'ngx-bootstrap/modal';\n+import {RouterTestingModule} from '@angular/router/testing';\n+import {EntityService} from 'src/app/service/entity.service';\n+import {HttpClientModule} from '@angular/common/http';\n+import {By} from '@angular/platform-browser';\n+import {of} from 'rxjs';\n+import {SiteCoordinatorModule} from '../../site-coordinator.module';\n+import {\n+  BrowserAnimationsModule,\n+  NoopAnimationsModule,\n+} from '@angular/platform-browser/animations';\n+import {SitesModule} from '../sites.module';\n+import {LocationService} from '../../location/shared/location.service';\n+import {SitesService} from '../shared/sites.service';\n+import {expectedLocationList} from 'src/app/entity/mockLocationData';\n+import {\n+  expectedSiteResponse,\n+  expectedStudyId,\n+} from 'src/app/entity/mockStudiesData';\n+import {DebugElement} from '@angular/core';\n+describe('AddSiteComponent', () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70348d08ba0769cbf2bb75ac625a375d2920739a"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a62c6a395daf7b827679df90d7206aa0acc5308", "author": {"user": {"login": "rohithd-btc", "name": "Rohith D C"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6a62c6a395daf7b827679df90d7206aa0acc5308", "committedDate": "2020-08-06T11:11:56Z", "message": "PR Comments has been resolved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0ec351e1063858e89281df68276ed19dc4a6305", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e0ec351e1063858e89281df68276ed19dc4a6305", "committedDate": "2020-08-06T11:27:58Z", "message": "code review commets has been fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d98ac2fdf679c0ffedbc5ea49fec7fed5d74cb5", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6d98ac2fdf679c0ffedbc5ea49fec7fed5d74cb5", "committedDate": "2020-08-06T11:30:15Z", "message": "Merge branch 'urwebapp-sites-tab' of https://github.com/GoogleCloudPlatform/fda-mystudies into urwebapp-sites-tab\n\n# Conflicts:\n#\tUR-web-app/src/app/site-coordinator/sites/shared/sites.service.spec.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "764404f55448d1e07badc4a6d9d7bc47f92bf0f6", "author": {"user": {"login": "rohithd-btc", "name": "Rohith D C"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/764404f55448d1e07badc4a6d9d7bc47f92bf0f6", "committedDate": "2020-08-06T12:00:50Z", "message": "Entity changes fix has been resolved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb420a71137bf19d234bd5849ad607e842a0f574", "author": {"user": {"login": "rohithd-btc", "name": "Rohith D C"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/cb420a71137bf19d234bd5849ad607e842a0f574", "committedDate": "2020-08-06T14:10:22Z", "message": "Changing the type declaration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f4b5ca550268e2c070086d8dcebb99ed1f83216", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9f4b5ca550268e2c070086d8dcebb99ed1f83216", "committedDate": "2020-08-07T16:53:58Z", "message": "async pipe has been added"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fe9dda4c7af940366cdf23cb651afa81e2d0ba0", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6fe9dda4c7af940366cdf23cb651afa81e2d0ba0", "committedDate": "2020-08-07T17:12:15Z", "message": "removed unnecessary condition"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3cc80bbfabe3b5f5a14cf0a12a6df35438cd95d", "author": {"user": {"login": "rohithd-btc", "name": "Rohith D C"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f3cc80bbfabe3b5f5a14cf0a12a6df35438cd95d", "committedDate": "2020-08-08T13:25:49Z", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into urwebapp-sites-tab\n\n# Conflicts:\n#\tUR-web-app/src/app/site-coordinator/location/shared/location.service.spec.ts\n#\tUR-web-app/src/app/site-coordinator/studies/shared/studies.service.spec.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85d9f5e52ca8743549f7395f4869f08d790acb8e", "author": {"user": {"login": "rohithd-btc", "name": "Rohith D C"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/85d9f5e52ca8743549f7395f4869f08d790acb8e", "committedDate": "2020-08-08T13:47:07Z", "message": "Pr comments Resolved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1f12563d82268af3a3e575122e46982af6b40ec", "author": {"user": {"login": "rohithd-btc", "name": "Rohith D C"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d1f12563d82268af3a3e575122e46982af6b40ec", "committedDate": "2020-08-08T13:57:59Z", "message": "Linter issues fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ecc525653a7e55e1a51cd8ff9e8ce63553badc9", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7ecc525653a7e55e1a51cd8ff9e8ce63553badc9", "committedDate": "2020-08-10T05:14:00Z", "message": "added routing for site participant"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d446744daa3ecec911db8506cc435cb4a271c97", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3d446744daa3ecec911db8506cc435cb4a271c97", "committedDate": "2020-08-10T05:14:24Z", "message": "Merge branch 'urwebapp-sites-tab' of https://github.com/GoogleCloudPlatform/fda-mystudies into urwebapp-sites-tab"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDI3Mzk0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/684#pullrequestreview-464427394", "createdAt": "2020-08-10T17:23:06Z", "commit": {"oid": "3d446744daa3ecec911db8506cc435cb4a271c97"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "00042d9ded111518db9ce78afa6ad09741f91eee", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/00042d9ded111518db9ce78afa6ad09741f91eee", "committedDate": "2020-08-11T06:35:41Z", "message": "Merge branch 'develop' into urwebapp-sites-tab"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 550, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}