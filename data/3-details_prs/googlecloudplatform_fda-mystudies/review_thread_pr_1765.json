{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzOTcwNDEz", "number": 1765, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwOToxOTowMVrOE0t7_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwOToxOTozMlrOE0t80w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNzE0MDQ2OnYy", "diffSide": "RIGHT", "path": "participant-manager-datastore/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/StudyControllerTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwOToxOTowMVrOHsl6HQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMTo0ODoyNlrOHsrTRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjUyMDQ3Nw==", "bodyText": "Should we expect the studies array to be empty here?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1765#discussion_r516520477", "createdAt": "2020-11-03T09:19:01Z", "author": {"login": "saminguyen"}, "path": "participant-manager-datastore/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/StudyControllerTest.java", "diffHunk": "@@ -865,6 +865,24 @@ public void shouldReturnUserNotFoundForUpdateTargetEnrollment() throws Exception\n     verifyTokenIntrospectRequest();\n   }\n \n+  @Test\n+  public void shouldNotReturnStudiesIfNoSitesForSuperAdmin() throws Exception {\n+    HttpHeaders headers = testDataHelper.newCommonHeaders();\n+    headers.add(USER_ID_HEADER, userRegAdminEntity.getId());\n+\n+    /* Set study in the site to null and expect no study if there is no site associated with that study*/\n+    siteEntity.setStudy(null);\n+    testDataHelper.getSiteRepository().saveAndFlush(siteEntity);\n+\n+    mockMvc\n+        .perform(\n+            get(ApiEndpoint.GET_STUDIES.getPath()).headers(headers).contextPath(getContextPath()))\n+        .andDo(print())\n+        .andExpect(status().isOk());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "108b766f7bc76c43013c9a99cb5298f707298ce1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjYwODgzOA==", "bodyText": "Yes, added assertion to expect an empty array", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1765#discussion_r516608838", "createdAt": "2020-11-03T11:48:26Z", "author": {"login": "Kantharajut-btc"}, "path": "participant-manager-datastore/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/StudyControllerTest.java", "diffHunk": "@@ -865,6 +865,24 @@ public void shouldReturnUserNotFoundForUpdateTargetEnrollment() throws Exception\n     verifyTokenIntrospectRequest();\n   }\n \n+  @Test\n+  public void shouldNotReturnStudiesIfNoSitesForSuperAdmin() throws Exception {\n+    HttpHeaders headers = testDataHelper.newCommonHeaders();\n+    headers.add(USER_ID_HEADER, userRegAdminEntity.getId());\n+\n+    /* Set study in the site to null and expect no study if there is no site associated with that study*/\n+    siteEntity.setStudy(null);\n+    testDataHelper.getSiteRepository().saveAndFlush(siteEntity);\n+\n+    mockMvc\n+        .perform(\n+            get(ApiEndpoint.GET_STUDIES.getPath()).headers(headers).contextPath(getContextPath()))\n+        .andDo(print())\n+        .andExpect(status().isOk());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjUyMDQ3Nw=="}, "originalCommit": {"oid": "108b766f7bc76c43013c9a99cb5298f707298ce1"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNzE0MjU5OnYy", "diffSide": "RIGHT", "path": "participant-manager-datastore/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/StudyControllerTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwOToxOTozMlrOHsl7Yw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxMTo0ODo1OVrOHsrUgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjUyMDgwMw==", "bodyText": "Move this to the section with other tests for the GET_STUDIES endpoint", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1765#discussion_r516520803", "createdAt": "2020-11-03T09:19:32Z", "author": {"login": "saminguyen"}, "path": "participant-manager-datastore/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/StudyControllerTest.java", "diffHunk": "@@ -865,6 +865,24 @@ public void shouldReturnUserNotFoundForUpdateTargetEnrollment() throws Exception\n     verifyTokenIntrospectRequest();\n   }\n \n+  @Test\n+  public void shouldNotReturnStudiesIfNoSitesForSuperAdmin() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "108b766f7bc76c43013c9a99cb5298f707298ce1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjYwOTE1Mg==", "bodyText": "moved to existing test case", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1765#discussion_r516609152", "createdAt": "2020-11-03T11:48:59Z", "author": {"login": "Kantharajut-btc"}, "path": "participant-manager-datastore/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/StudyControllerTest.java", "diffHunk": "@@ -865,6 +865,24 @@ public void shouldReturnUserNotFoundForUpdateTargetEnrollment() throws Exception\n     verifyTokenIntrospectRequest();\n   }\n \n+  @Test\n+  public void shouldNotReturnStudiesIfNoSitesForSuperAdmin() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjUyMDgwMw=="}, "originalCommit": {"oid": "108b766f7bc76c43013c9a99cb5298f707298ce1"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1634, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}