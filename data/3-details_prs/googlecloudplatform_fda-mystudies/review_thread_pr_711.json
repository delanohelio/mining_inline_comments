{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYwMTc5NDY0", "number": 711, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMjozMjozMlrOEUOLYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMzozNDozN1rOEUOvhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjM5MjY3OnYy", "diffSide": "RIGHT", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MessageCode.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMjozMjozMlrOG6Yk-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjoyMDowOVrOG6tZdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3MzI3NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              PARTICIPANTS_INVITED_SUCCESS(HttpStatus.OK, \"MSG-0016\", \"participants are invited\"),\n          \n          \n            \n              PARTICIPANTS_INVITED_SUCCESS(HttpStatus.OK, \"MSG-0016\", \"Participants are invited\"),", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r463873275", "createdAt": "2020-07-31T22:32:32Z", "author": {"login": "saminguyen"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MessageCode.java", "diffHunk": "@@ -64,7 +67,12 @@\n       HttpStatus.OK, \"MSG-0023\", \"Get user profile with security code successfully\"),\n \n   GET_PARTICIPANT_DETAILS_SUCCESS(\n-      HttpStatus.OK, \"MSG-0019\", \"Get participant details successfully\");\n+      HttpStatus.OK, \"MSG-0019\", \"Get participant details successfully\"),\n+\n+  PARTICIPANTS_INVITED_SUCCESS(HttpStatus.OK, \"MSG-0016\", \"participants are invited\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNDM5MA==", "bodyText": "Changed to Participants.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r464214390", "createdAt": "2020-08-03T06:20:09Z", "author": {"login": "madhurya-btc"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MessageCode.java", "diffHunk": "@@ -64,7 +67,12 @@\n       HttpStatus.OK, \"MSG-0023\", \"Get user profile with security code successfully\"),\n \n   GET_PARTICIPANT_DETAILS_SUCCESS(\n-      HttpStatus.OK, \"MSG-0019\", \"Get participant details successfully\");\n+      HttpStatus.OK, \"MSG-0019\", \"Get participant details successfully\"),\n+\n+  PARTICIPANTS_INVITED_SUCCESS(HttpStatus.OK, \"MSG-0016\", \"participants are invited\"),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3MzI3NQ=="}, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjQwNzc4OnYy", "diffSide": "RIGHT", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EmailServiceImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMjo0MjowOFrOG6YtyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjoxNTozOFrOG6tUFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3NTUyOA==", "bodyText": "Can you just use the built in isEmpty for this? I think even when CC and BCC are empty these ArrayLists should not be null, just empty right?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r463875528", "createdAt": "2020-07-31T22:42:08Z", "author": {"login": "saminguyen"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EmailServiceImpl.java", "diffHunk": "@@ -34,23 +40,30 @@\n   @Autowired private JavaMailSender emailSender;\n \n   @Override\n-  public EmailResponse sendSimpleMail(EmailRequest emailRequest) {\n-    logger.entry(\"Begin sendSimpleMail()\");\n+  public EmailResponse sendMimeMail(EmailRequest emailRequest) {\n+    logger.entry(\"Begin sendMimeMail()\");\n     try {\n-      SimpleMailMessage message = new SimpleMailMessage();\n-      message.setFrom(emailRequest.getFrom());\n-      message.setBcc(emailRequest.getBcc());\n-      message.setCc(emailRequest.getCc());\n-      message.setTo(emailRequest.getTo());\n+      MimeMessage message = emailSender.createMimeMessage();\n+      MimeMessageHelper helper = new MimeMessageHelper(message, true);\n+      helper.setFrom(emailRequest.getFrom());\n+      helper.setTo(emailRequest.getTo());\n+\n+      if (ArrayUtils.isNotEmpty(emailRequest.getCc())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxMzAxNA==", "bodyText": "In EmailRequest  CC and BCC are not initialized and type of String[], hence checking ArrayUtils.isNotEmpty.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r464213014", "createdAt": "2020-08-03T06:15:38Z", "author": {"login": "madhurya-btc"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/EmailServiceImpl.java", "diffHunk": "@@ -34,23 +40,30 @@\n   @Autowired private JavaMailSender emailSender;\n \n   @Override\n-  public EmailResponse sendSimpleMail(EmailRequest emailRequest) {\n-    logger.entry(\"Begin sendSimpleMail()\");\n+  public EmailResponse sendMimeMail(EmailRequest emailRequest) {\n+    logger.entry(\"Begin sendMimeMail()\");\n     try {\n-      SimpleMailMessage message = new SimpleMailMessage();\n-      message.setFrom(emailRequest.getFrom());\n-      message.setBcc(emailRequest.getBcc());\n-      message.setCc(emailRequest.getCc());\n-      message.setTo(emailRequest.getTo());\n+      MimeMessage message = emailSender.createMimeMessage();\n+      MimeMessageHelper helper = new MimeMessageHelper(message, true);\n+      helper.setFrom(emailRequest.getFrom());\n+      helper.setTo(emailRequest.getTo());\n+\n+      if (ArrayUtils.isNotEmpty(emailRequest.getCc())) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3NTUyOA=="}, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjQxMDc1OnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/config/AppPropertyConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMjo0NDowM1rOG6Yviw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjoxOTo1M1rOG6tZAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3NTk3OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private Integer enrollmentTokenExpiryinHours;\n          \n          \n            \n              private Integer enrollmentTokenExpiryInHours;", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r463875979", "createdAt": "2020-07-31T22:44:03Z", "author": {"login": "saminguyen"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/config/AppPropertyConfig.java", "diffHunk": "@@ -23,4 +25,28 @@\n \n   @Value(\"${securityCodeExpireDate}\")\n   private String securityCodeExpireDate;\n+\n+  @Value(\"${enrollmentTokenExpiryinHours}\")\n+  private Integer enrollmentTokenExpiryinHours;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNDI3NQ==", "bodyText": "Changed to enrollmentTokenExpiryInHours.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r464214275", "createdAt": "2020-08-03T06:19:53Z", "author": {"login": "madhurya-btc"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/config/AppPropertyConfig.java", "diffHunk": "@@ -23,4 +25,28 @@\n \n   @Value(\"${securityCodeExpireDate}\")\n   private String securityCodeExpireDate;\n+\n+  @Value(\"${enrollmentTokenExpiryinHours}\")\n+  private Integer enrollmentTokenExpiryinHours;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg3NTk3OQ=="}, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjQzOTk2OnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMzowMzowMFrOG6ZAiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjoxOTo0MVrOG6tYyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg4MDMyOQ==", "bodyText": "participantsList", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r463880329", "createdAt": "2020-07-31T23:03:00Z", "author": {"login": "saminguyen"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java", "diffHunk": "@@ -564,4 +580,113 @@ private ErrorCode validateParticipantDetailsRequest(\n     }\n     return null;\n   }\n+\n+  @Override\n+  @Transactional\n+  public InviteParticipantResponse inviteParticipants(\n+      InviteParticipantRequest inviteParticipantRequest) {\n+    logger.entry(\"begin inviteParticipants()\");\n+\n+    Optional<SiteEntity> optSiteEntity =\n+        siteRepository.findById(inviteParticipantRequest.getSiteId());\n+\n+    if (!optSiteEntity.isPresent() || !ACTIVE_STATUS.equals(optSiteEntity.get().getStatus())) {\n+      logger.exit(ErrorCode.SITE_NOT_EXIST_OR_INACTIVE);\n+      return new InviteParticipantResponse(ErrorCode.SITE_NOT_EXIST_OR_INACTIVE);\n+    }\n+\n+    Optional<SitePermissionEntity> optSitePermissionEntity =\n+        sitePermissionRepository.findSitePermissionByUserIdAndSiteId(\n+            inviteParticipantRequest.getUserId(), inviteParticipantRequest.getSiteId());\n+    if (!optSitePermissionEntity.isPresent()\n+        || Permission.READ_EDIT\n+            != Permission.fromValue(optSitePermissionEntity.get().getCanEdit())) {\n+      logger.exit(ErrorCode.MANAGE_SITE_PERMISSION_ACCESS_DENIED);\n+      return new InviteParticipantResponse(ErrorCode.MANAGE_SITE_PERMISSION_ACCESS_DENIED);\n+    }\n+\n+    List<ParticipantRegistrySiteEntity> listOfparticipants =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNDIxNw==", "bodyText": "Changed to participantsList.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r464214217", "createdAt": "2020-08-03T06:19:41Z", "author": {"login": "madhurya-btc"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java", "diffHunk": "@@ -564,4 +580,113 @@ private ErrorCode validateParticipantDetailsRequest(\n     }\n     return null;\n   }\n+\n+  @Override\n+  @Transactional\n+  public InviteParticipantResponse inviteParticipants(\n+      InviteParticipantRequest inviteParticipantRequest) {\n+    logger.entry(\"begin inviteParticipants()\");\n+\n+    Optional<SiteEntity> optSiteEntity =\n+        siteRepository.findById(inviteParticipantRequest.getSiteId());\n+\n+    if (!optSiteEntity.isPresent() || !ACTIVE_STATUS.equals(optSiteEntity.get().getStatus())) {\n+      logger.exit(ErrorCode.SITE_NOT_EXIST_OR_INACTIVE);\n+      return new InviteParticipantResponse(ErrorCode.SITE_NOT_EXIST_OR_INACTIVE);\n+    }\n+\n+    Optional<SitePermissionEntity> optSitePermissionEntity =\n+        sitePermissionRepository.findSitePermissionByUserIdAndSiteId(\n+            inviteParticipantRequest.getUserId(), inviteParticipantRequest.getSiteId());\n+    if (!optSitePermissionEntity.isPresent()\n+        || Permission.READ_EDIT\n+            != Permission.fromValue(optSitePermissionEntity.get().getCanEdit())) {\n+      logger.exit(ErrorCode.MANAGE_SITE_PERMISSION_ACCESS_DENIED);\n+      return new InviteParticipantResponse(ErrorCode.MANAGE_SITE_PERMISSION_ACCESS_DENIED);\n+    }\n+\n+    List<ParticipantRegistrySiteEntity> listOfparticipants =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg4MDMyOQ=="}, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 121}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjQ2OTk3OnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/common/ApiEndpoint.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMzoyMzo1MFrOG6ZRiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjoxOToyNlrOG6tYbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg4NDY4MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              INVITE_PARTICIPANT(\n          \n          \n            \n              INVITE_PARTICIPANTS(", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r463884680", "createdAt": "2020-07-31T23:23:50Z", "author": {"login": "saminguyen"}, "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/common/ApiEndpoint.java", "diffHunk": "@@ -51,7 +51,10 @@\n   GET_USER_DETAILS(\"http://localhost:8080/participant-manager-service/users\"),\n \n   GET_PARTICIPANT_DETAILS(\n-      \"http://localhost:8080/participant-manager-service/sites/{participantRegistrySite}/participant\");\n+      \"http://localhost:8080/participant-manager-service/sites/{participantRegistrySite}/participant\"),\n+\n+  INVITE_PARTICIPANT(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNDEyNw==", "bodyText": "Changed to INVITE_PARTICIPANTS.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r464214127", "createdAt": "2020-08-03T06:19:26Z", "author": {"login": "madhurya-btc"}, "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/common/ApiEndpoint.java", "diffHunk": "@@ -51,7 +51,10 @@\n   GET_USER_DETAILS(\"http://localhost:8080/participant-manager-service/users\"),\n \n   GET_PARTICIPANT_DETAILS(\n-      \"http://localhost:8080/participant-manager-service/sites/{participantRegistrySite}/participant\");\n+      \"http://localhost:8080/participant-manager-service/sites/{participantRegistrySite}/participant\"),\n+\n+  INVITE_PARTICIPANT(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg4NDY4MA=="}, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NjQ4NTE5OnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/SitesControllerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQyMzozNDozN1rOG6ZaMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwNjoxOToxMlrOG6tYNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg4Njg5Nw==", "bodyText": "We should have more success cases in test, requests with multiple Ids, with some failed participantIds being returned", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r463886897", "createdAt": "2020-07-31T23:34:37Z", "author": {"login": "saminguyen"}, "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/SitesControllerTest.java", "diffHunk": "@@ -661,6 +663,73 @@ public void shouldReturnAccessDeniedForGetParticipantDetails() throws Exception\n                 is(ErrorCode.MANAGE_SITE_PERMISSION_ACCESS_DENIED.getDescription())));\n   }\n \n+  @Test\n+  public void shouldReturnSiteNotFoundForInviteParticipant() throws Exception {\n+    HttpHeaders headers = testDataHelper.newCommonHeaders();\n+    headers.set(USER_ID_HEADER, userRegAdminEntity.getId());\n+\n+    InviteParticipantRequest inviteParticipantRequest = new InviteParticipantRequest();\n+    inviteParticipantRequest.setIds(Arrays.asList(participantRegistrySiteEntity.getId()));\n+    mockMvc\n+        .perform(\n+            post(ApiEndpoint.INVITE_PARTICIPANT.getPath(), IdGenerator.id())\n+                .content(asJsonString(inviteParticipantRequest))\n+                .headers(headers)\n+                .contextPath(getContextPath()))\n+        .andDo(print())\n+        .andExpect(status().isBadRequest())\n+        .andExpect(\n+            jsonPath(\n+                \"$.error_description\", is(ErrorCode.SITE_NOT_EXIST_OR_INACTIVE.getDescription())));\n+  }\n+\n+  @Test\n+  public void shouldInviteParticipant() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDIxNDA2OQ==", "bodyText": "Added test for failed invites.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/711#discussion_r464214069", "createdAt": "2020-08-03T06:19:12Z", "author": {"login": "madhurya-btc"}, "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/SitesControllerTest.java", "diffHunk": "@@ -661,6 +663,73 @@ public void shouldReturnAccessDeniedForGetParticipantDetails() throws Exception\n                 is(ErrorCode.MANAGE_SITE_PERMISSION_ACCESS_DENIED.getDescription())));\n   }\n \n+  @Test\n+  public void shouldReturnSiteNotFoundForInviteParticipant() throws Exception {\n+    HttpHeaders headers = testDataHelper.newCommonHeaders();\n+    headers.set(USER_ID_HEADER, userRegAdminEntity.getId());\n+\n+    InviteParticipantRequest inviteParticipantRequest = new InviteParticipantRequest();\n+    inviteParticipantRequest.setIds(Arrays.asList(participantRegistrySiteEntity.getId()));\n+    mockMvc\n+        .perform(\n+            post(ApiEndpoint.INVITE_PARTICIPANT.getPath(), IdGenerator.id())\n+                .content(asJsonString(inviteParticipantRequest))\n+                .headers(headers)\n+                .contextPath(getContextPath()))\n+        .andDo(print())\n+        .andExpect(status().isBadRequest())\n+        .andExpect(\n+            jsonPath(\n+                \"$.error_description\", is(ErrorCode.SITE_NOT_EXIST_OR_INACTIVE.getDescription())));\n+  }\n+\n+  @Test\n+  public void shouldInviteParticipant() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg4Njg5Nw=="}, "originalCommit": {"oid": "5fa2a6fd154c998076abfa2296da09fd59ccabd9"}, "originalPosition": 41}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2075, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}