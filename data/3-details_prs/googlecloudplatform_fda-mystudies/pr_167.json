{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1MTI3Mzgy", "number": 167, "title": "User Mgmt module issue fixes", "bodyText": "Please find the latest PR description:\n\nVerify Email Code issue fix #130\nResend Confirmation issue fix for already deactivated account's email id\nPush notification issue fix based on internal review\nModel class changes to make it consistent across all components.", "createdAt": "2020-04-17T13:18:41Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/167", "merged": true, "mergeCommit": {"oid": "05bf2d618843931148e78df32dc27457135bce55"}, "closed": true, "closedAt": "2020-04-20T14:48:14Z", "author": {"login": "aswinijena100"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYg9YIAH2gAyNDA1MTI3MzgyOjdlNGJjYjlmMzJiN2JlNmQ4YzgzMGY1YzQ4MmM0NDllZWE2MWUyMmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZfrnQgH2gAyNDA1MTI3MzgyOmFlYjMxY2E1NzY1MDEzN2IyOTE3Y2QzNDdmMGExN2RjMzYzNDZiYWE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7e4bcb9f32b7be6d8c830f5c482c449eea61e22e", "author": {"user": {"login": "aswinijena100", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7e4bcb9f32b7be6d8c830f5c482c449eea61e22e", "committedDate": "2020-04-17T13:04:16Z", "message": "Latest code push with below changes:                                                                                                                                                                                                                                                                                                    1. Verify Email Code issue fix #130\n2. Resend Confirmation issue fix for alraedy deactivated account's email id\n3. Push notification issue fix based on internal review\n4. Model class changes to make it consistent across all components."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e14eef39c114d99a920d1f7c16e0e83af962b112", "author": {"user": {"login": "aswinijena100", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e14eef39c114d99a920d1f7c16e0e83af962b112", "committedDate": "2020-04-17T13:08:40Z", "message": "Revert \"Latest code push with below changes:                                                                                                                                                                                                                                                                                                    1. Verify Email Code issue fix #130\"\n\nThis reverts commit 7e4bcb9f32b7be6d8c830f5c482c449eea61e22e."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6dc0227ecc340d7e2a5999c2220a732285947f98", "author": {"user": {"login": "aswinijena100", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6dc0227ecc340d7e2a5999c2220a732285947f98", "committedDate": "2020-04-17T13:15:50Z", "message": "latest code commit with changes as bellow                                                                                                                                                                                                                                                                                          1. Verify Email Code issue fix #130\n2. Resend Confirmation issue fix for alraedy deactivated account's email id\n3. Push notification issue fix based on internal review\n4. Model class changes to make it consistent across all components."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c984cc3089d7fd61920a50571f4283c18f466bb3", "author": {"user": {"login": "aswinijena100", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c984cc3089d7fd61920a50571f4283c18f466bb3", "committedDate": "2020-04-17T13:26:51Z", "message": "Merge branch 'early-access' into early-access-build"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NDgwNzkx", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/167#pullrequestreview-395480791", "createdAt": "2020-04-17T14:01:46Z", "commit": {"oid": "c984cc3089d7fd61920a50571f4283c18f466bb3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxNDowMTo0N1rOGHPRRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxNDowMTo0N1rOGHPRRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDI0MzM5OQ==", "bodyText": "StringUtils.IsEmpty checks for null values as well; so there is not need for a separate null check of each value.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/167#discussion_r410243399", "createdAt": "2020-04-17T14:01:47Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/VerifyEmailIdController.java", "diffHunk": "@@ -60,7 +60,7 @@\n         || (accessToken.length() == 0 || StringUtils.isEmpty(accessToken))\n         || (userId.length() == 0 || StringUtils.isEmpty(userId))\n         || (verificationForm.getCode() == null\n-            && StringUtils.isEmpty(verificationForm.getCode()))) {\n+            || StringUtils.isEmpty(verificationForm.getCode()))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c984cc3089d7fd61920a50571f4283c18f466bb3"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6b80e6e3412344f65f5550b3b08a1f0b0007b6b", "author": {"user": {"login": "aswinijena100", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/b6b80e6e3412344f65f5550b3b08a1f0b0007b6b", "committedDate": "2020-04-17T14:23:03Z", "message": "Null check removed as per Zohreh's comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1NTI2MzQw", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/167#pullrequestreview-395526340", "createdAt": "2020-04-17T14:54:47Z", "commit": {"oid": "b6b80e6e3412344f65f5550b3b08a1f0b0007b6b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxNDo1NDo0N1rOGHRWBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QxNTowNDo0NFrOGHRvlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDI3NzM4MQ==", "bodyText": "Why not allocate the value below instead of creating an array with an explicit length here?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/167#discussion_r410277381", "createdAt": "2020-04-17T14:54:47Z", "author": {"login": "nikklassen"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/UserProfileManagementDaoImpl.java", "diffHunk": "@@ -146,7 +146,7 @@ public UserDetailsBO getParticipantDetailsByEmail(\n     CriteriaBuilder criteriaBuilder = null;\n     CriteriaQuery<UserDetailsBO> criteriaQuery = null;\n     Root<UserDetailsBO> userDetailsBoRoot = null;\n-    Predicate[] predicates = new Predicate[2];\n+    Predicate[] predicates = new Predicate[3];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6b80e6e3412344f65f5550b3b08a1f0b0007b6b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDI4MjEzNQ==", "bodyText": "It looks like this is still \"CHAR(8)\" in the enroll-mgmt model. I assume these should be in sync? Would an Enum be more appropriate for this field though?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/167#discussion_r410282135", "createdAt": "2020-04-17T15:02:05Z", "author": {"login": "nikklassen"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantRegistrySite.java", "diffHunk": "@@ -46,10 +50,16 @@\n   @Column(name = \"invitation_date\", columnDefinition = \"TIMESTAMP\")\n   private Date invitationDate;\n \n+  @Column(name = \"invitation_count\", nullable = false, columnDefinition = \"bigint(20) default 0\")\n+  private Long invitationCount = 0L;\n+\n+  @Column(name = \"disabled_date\", columnDefinition = \"TIMESTAMP default NULL\")\n+  private Date disabledDate;\n+\n   @Column(name = \"enrollment_token_expiry\", columnDefinition = \"TIMESTAMP\")\n   private Date enrollmentTokenExpiry;\n \n-  @Column(name = \"onboarding_status\", columnDefinition = \"CHAR(8)\")\n+  @Column(name = \"onboarding_status\", columnDefinition = \"CHAR(1)\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6b80e6e3412344f65f5550b3b08a1f0b0007b6b"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDI4MzkyNQ==", "bodyText": "A boolean and calling this \"canEdit\" seems more appopriate, unless I'm misunderstanding the purpose of this field.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/167#discussion_r410283925", "createdAt": "2020-04-17T15:04:44Z", "author": {"login": "nikklassen"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/model/SitePermission.java", "diffHunk": "@@ -0,0 +1,77 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.time.LocalDateTime;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.GenerationType;\n+import javax.persistence.Id;\n+import javax.persistence.JoinColumn;\n+import javax.persistence.ManyToOne;\n+import javax.persistence.Table;\n+import lombok.Getter;\n+import lombok.Setter;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"sites_permissions\")\n+public class SitePermission {\n+\n+  @Id\n+  @Column(name = \"id\")\n+  @GeneratedValue(strategy = GenerationType.AUTO)\n+  private Integer id;\n+\n+  @ManyToOne\n+  @JoinColumn(name = \"ur_admin_user_id\", insertable = false, updatable = false)\n+  private UserRegAdminUser urAdminUser;\n+\n+  @ManyToOne\n+  @JoinColumn(name = \"study_id\", insertable = true, updatable = true)\n+  private StudyInfoBO studyInfo;\n+\n+  @ManyToOne\n+  @JoinColumn(name = \"site_id\", insertable = true, updatable = true)\n+  private SiteBo siteBo;\n+\n+  @ManyToOne\n+  @JoinColumn(name = \"app_info_id\", insertable = true, updatable = true)\n+  private AppInfoDetailsBO appInfo;\n+\n+  @Column(name = \"edit\", columnDefinition = \"TINYINT(1) default 0\")\n+  private Integer edit = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6b80e6e3412344f65f5550b3b08a1f0b0007b6b"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "426f1e0956bc82abd7d3c3ff1b50fa9dc1d94fa4", "author": {"user": {"login": "aswinijena100", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/426f1e0956bc82abd7d3c3ff1b50fa9dc1d94fa4", "committedDate": "2020-04-18T12:15:33Z", "message": "Changes made as per requested changes on the pull request by Nik and Internal QA issue fixes for FISMA popup in WCP sign in"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NDU2MTY0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/167#pullrequestreview-396456164", "createdAt": "2020-04-20T13:33:22Z", "commit": {"oid": "426f1e0956bc82abd7d3c3ff1b50fa9dc1d94fa4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aeb31ca57650137b2917cd347f0a17dc36346baa", "author": {"user": {"login": "aswinijena100", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/aeb31ca57650137b2917cd347f0a17dc36346baa", "committedDate": "2020-04-20T14:08:53Z", "message": "Merge branch 'early-access' into early-access-build"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1105, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}