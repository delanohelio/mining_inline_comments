{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyMzk4OTMw", "number": 317, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNDo0NTo0MFrOD4moJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNjowODowMFrOD4oBqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwNjc5NzE5OnYy", "diffSide": "RIGHT", "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNDo0NTo0MVrOGPfLSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNDo1NjoyOVrOGPfboA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODg5MjYxOQ==", "bodyText": "user-registration", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418892619", "createdAt": "2020-05-02T04:45:41Z", "author": {"login": "xingao267"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      response-server = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"\n+      }\n+    }\n+  }\n+}\n+\n+\n inputs = {\n   network = dependency.network.outputs.private_network.id\n+  consent_documents_iam_members = [{\n+    role   = \"roles/storage.objectCreator\"\n+    member = \"serviceAccount:${dependency.apps.outputs.apps_service_accounts[\"response-server\"].email}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODg5NTQ1Ng==", "bodyText": "The right sa or server here should be user-registration according to https://github.com/GoogleCloudPlatform/fda-mystudies/pull/313/files?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418895456", "createdAt": "2020-05-02T04:53:09Z", "author": {"login": "xingao267"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      response-server = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"\n+      }\n+    }\n+  }\n+}\n+\n+\n inputs = {\n   network = dependency.network.outputs.private_network.id\n+  consent_documents_iam_members = [{\n+    role   = \"roles/storage.objectCreator\"\n+    member = \"serviceAccount:${dependency.apps.outputs.apps_service_accounts[\"response-server\"].email}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODg5MjYxOQ=="}, "originalCommit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODg5NjgwMA==", "bodyText": "Sorry you're right. Too late at night :D The title of the PR confuesd me", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418896800", "createdAt": "2020-05-02T04:56:29Z", "author": {"login": "umairidris"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      response-server = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"\n+      }\n+    }\n+  }\n+}\n+\n+\n inputs = {\n   network = dependency.network.outputs.private_network.id\n+  consent_documents_iam_members = [{\n+    role   = \"roles/storage.objectCreator\"\n+    member = \"serviceAccount:${dependency.apps.outputs.apps_service_accounts[\"response-server\"].email}\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODg5MjYxOQ=="}, "originalCommit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwNjgxMjQ5OnYy", "diffSide": "RIGHT", "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNDo1MDoxOFrOGPfSOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQxNzo1NToyNVrOGPk_5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODg5NDM5Mg==", "bodyText": "user-registration", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418894392", "createdAt": "2020-05-02T04:50:18Z", "author": {"login": "xingao267"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      response-server = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4ODAwNQ==", "bodyText": "Done", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418988005", "createdAt": "2020-05-02T17:55:25Z", "author": {"login": "umairidris"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      response-server = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODg5NDM5Mg=="}, "originalCommit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwNjk4OTgzOnYy", "diffSide": "RIGHT", "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNTo0Mjo1M1rOGPghPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQxNzo1NToxNVrOGPk_zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkxNDYyMg==", "bodyText": "I think we need objectAdmin here because it also needs to read data from this bucket (e.g. when user download their own consent form).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418914622", "createdAt": "2020-05-02T05:42:53Z", "author": {"login": "kuoyuchi"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      user-registration = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"\n+      }\n+    }\n+  }\n+}\n+\n+\n inputs = {\n   network = dependency.network.outputs.private_network.id\n+  consent_documents_iam_members = [{\n+    role   = \"roles/storage.objectCreator\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afba32e29750f088f7240d2a5ea3268cfff02ad3"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4Nzk4Mg==", "bodyText": "Done", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418987982", "createdAt": "2020-05-02T17:55:15Z", "author": {"login": "umairidris"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      user-registration = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"\n+      }\n+    }\n+  }\n+}\n+\n+\n inputs = {\n   network = dependency.network.outputs.private_network.id\n+  consent_documents_iam_members = [{\n+    role   = \"roles/storage.objectCreator\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkxNDYyMg=="}, "originalCommit": {"oid": "afba32e29750f088f7240d2a5ea3268cfff02ad3"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwNzAxOTk3OnYy", "diffSide": "RIGHT", "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-resp-firebase/iam/terraform.tfvars", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNTo1ODoyNVrOGPguPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQxNzo1Njo0MVrOGPlAZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkxNzk1MA==", "bodyText": "I think for whatever reason, the current project name is \"heroes-hat-dev-resp-firebase\".", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418917950", "createdAt": "2020-05-02T05:58:25Z", "author": {"login": "kuoyuchi"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-resp-firebase/iam/terraform.tfvars", "diffHunk": "@@ -0,0 +1,15 @@\n+# Copyright 2020 Google Inc.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+project_id = \"heroes-hat-dev-firebase\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f64f5c13b928f0d534b9c19b52c5c63df6b46534"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4ODEzNA==", "bodyText": "Fixed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418988134", "createdAt": "2020-05-02T17:56:41Z", "author": {"login": "umairidris"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-resp-firebase/iam/terraform.tfvars", "diffHunk": "@@ -0,0 +1,15 @@\n+# Copyright 2020 Google Inc.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+project_id = \"heroes-hat-dev-firebase\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkxNzk1MA=="}, "originalCommit": {"oid": "f64f5c13b928f0d534b9c19b52c5c63df6b46534"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwNzAyNjMyOnYy", "diffSide": "RIGHT", "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-resp-firebase/iam/main.tf", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNjowODowMFrOGPgxKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQxNzo1NTo0NVrOGPk_9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkxODY5OA==", "bodyText": "Do we need to add the \"serviceAccount:\" prefix here as well?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418918698", "createdAt": "2020-05-02T06:08:00Z", "author": {"login": "kuoyuchi"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-resp-firebase/iam/main.tf", "diffHunk": "@@ -0,0 +1,29 @@\n+# Copyright 2020 Google Inc.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+terraform {\n+  required_version = \"~> 0.12.0\"\n+  required_providers {\n+    google      = \"~> 3.0\"\n+    google-beta = \"~> 3.0\"\n+  }\n+  backend \"gcs\" {}\n+}\n+\n+resource \"google_project_iam_member\" \"datastore_user_service_accounts\" {\n+  for_each = toset(var.datastore_user_service_accounts)\n+  project  = var.project_id\n+  role     = \"roles/datastore.user\"\n+  member   = each.key", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f64f5c13b928f0d534b9c19b52c5c63df6b46534"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODk4ODAyMw==", "bodyText": "I added it in the terragrunt.hcl file", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418988023", "createdAt": "2020-05-02T17:55:45Z", "author": {"login": "umairidris"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-resp-firebase/iam/main.tf", "diffHunk": "@@ -0,0 +1,29 @@\n+# Copyright 2020 Google Inc.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+terraform {\n+  required_version = \"~> 0.12.0\"\n+  required_providers {\n+    google      = \"~> 3.0\"\n+    google-beta = \"~> 3.0\"\n+  }\n+  backend \"gcs\" {}\n+}\n+\n+resource \"google_project_iam_member\" \"datastore_user_service_accounts\" {\n+  for_each = toset(var.datastore_user_service_accounts)\n+  project  = var.project_id\n+  role     = \"roles/datastore.user\"\n+  member   = each.key", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkxODY5OA=="}, "originalCommit": {"oid": "f64f5c13b928f0d534b9c19b52c5c63df6b46534"}, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1050, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}