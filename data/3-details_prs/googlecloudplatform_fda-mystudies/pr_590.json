{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzOTk3NTE4", "number": 590, "title": "Audit Log Event Implementation for Reset Password with integration tests", "bodyText": "Added common code to call /v1/events endpoint to post audit log event. Implemented PASSWORD_RESET_SUCCESS and PASSWORD_RESET_FAILED audit log events.\nUsed @ConditionalOnProperty to conditionally load components from common-service.\nMinor changes to audit log service and fixed the integration tests.", "createdAt": "2020-07-03T11:01:52Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590", "merged": true, "mergeCommit": {"oid": "4c3989aa1a685dac283b429405b843aeea81a686"}, "closed": true, "closedAt": "2020-07-31T12:57:15Z", "author": {"login": "dhanyak-btc"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcxRVKEAH2gAyNDQzOTk3NTE4OjdlMWNhMGQxMzE2YjE0NWFjMzliYjNmYTczYTJjNTRkMjE3Y2UzYzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6Tkd1gFqTQ1OTE0MjUxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7e1ca0d1316b145ac39bb3fa73a2c54d217ce3c2", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7e1ca0d1316b145ac39bb3fa73a2c54d217ce3c2", "committedDate": "2020-07-03T10:59:52Z", "message": "Audit Log Event Implementation for Reset Password with integration tests\n\nAdded common code to call /v1/events endpoint to post audit log event and implemented fallback option with a scheduler.\n\nUsed @ConditionalOnProperty to conditionally load components from common-service.\n\nMinor changes to audit log service and fixed the integration tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/830ce809510d79ad2ea9d109e462b6f4640aa35c", "committedDate": "2020-07-04T03:14:20Z", "message": "Removed fallback option code to reduce the PR#590 size\n\nRemoved fallback option code to reduce the PR#590 size"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2Njk0MzM3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#pullrequestreview-446694337", "createdAt": "2020-07-10T20:52:56Z", "commit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQyMDo1Mjo1NlrOGwFURA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QxNDoyMzowN1rOGwq15A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3MTk0MA==", "bodyText": "why was this removed?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453071940", "createdAt": "2020-07-10T20:52:56Z", "author": {"login": "zohrehj"}, "path": "audit-log-module/audit-log-service/src/main/resources/application-local.properties", "diffHunk": "@@ -34,5 +35,4 @@ management.endpoints.enabled-by-default=true\n management.endpoints.web.exposure.include=*\n \n # SECURITY OAUTH2 WITH ORY HYDRA\n-security.oauth2.health_endpoint=http://localhost:8002/oauth-scim-service/v1/health", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3MjQ1Mg==", "bodyText": "please explain what these flags do.\nWhich functionality of the commonservice is dependent on this flag?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453072452", "createdAt": "2020-07-10T20:54:27Z", "author": {"login": "zohrehj"}, "path": "audit-log-module/audit-log-service/src/main/resources/application.properties", "diffHunk": "@@ -18,4 +18,6 @@ server.servlet.context-path=/audit-log-service\n spring.datasource.initialize=false\n \n # other app configurations\n-auditlog.platform-version=1.0\n\\ No newline at end of file\n+auditlog.platform-version=1.0\n+commonservice.auditlogevent.enabled=false\n+commonservice.email.enabled=false", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3MjkyNg==", "bodyText": "Test should not have dependency on one another.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453072926", "createdAt": "2020-07-10T20:55:35Z", "author": {"login": "zohrehj"}, "path": "audit-log-module/audit-log-service/src/test/java/com/google/cloud/healthcare/fdamystudies/auditlog/controller/AuditLogEventControllerTest.java", "diffHunk": "@@ -27,19 +31,24 @@\n import java.util.Collections;\n import java.util.UUID;\n import org.apache.commons.lang3.RandomStringUtils;\n+import org.junit.jupiter.api.MethodOrderer.OrderAnnotation;\n+import org.junit.jupiter.api.Order;\n import org.junit.jupiter.api.Test;\n+import org.junit.jupiter.api.TestMethodOrder;\n import org.skyscreamer.jsonassert.JSONAssert;\n import org.skyscreamer.jsonassert.JSONCompareMode;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.http.HttpHeaders;\n import org.springframework.http.MediaType;\n import org.springframework.test.web.servlet.MvcResult;\n \n+@TestMethodOrder(OrderAnnotation.class)\n public class AuditLogEventControllerTest extends BaseMockIT {\n \n   @Autowired private AuditLogEventRepository repository;\n \n   @Test\n+  @Order(1)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3MzI1OA==", "bodyText": "please remove ordering, instead you can clean up the matching event from the logs.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453073258", "createdAt": "2020-07-10T20:56:23Z", "author": {"login": "zohrehj"}, "path": "audit-log-module/audit-log-service/src/test/java/com/google/cloud/healthcare/fdamystudies/auditlog/controller/AuditLogEventControllerTest.java", "diffHunk": "@@ -68,9 +77,15 @@ public void shouldSaveAuditLogEvent() throws Exception {\n \n     // Step-3 cleanup - delete the event from database\n     repository.deleteById(eventId);\n+\n+    verify(\n+        1,\n+        postRequestedFor(urlEqualTo(\"/oauth-scim-service/v1/oauth2/introspect\"))\n+            .withRequestBody(new ContainsPattern(VALID_TOKEN)));\n   }\n \n   @Test\n+  @Order(2)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3MzkwMg==", "bodyText": "rename to something more descriptive, e.g. auditRequest", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453073902", "createdAt": "2020-07-10T20:57:52Z", "author": {"login": "zohrehj"}, "path": "audit-log-module/audit-log-service/src/test/java/com/google/cloud/healthcare/fdamystudies/auditlog/controller/AuditLogEventControllerTest.java", "diffHunk": "@@ -105,6 +133,7 @@ public void shouldReturnBadRequestForInvalidContent() throws Exception {\n     aleRequest.setSystemId(RandomStringUtils.randomAlphanumeric(40));\n     aleRequest.setUserId(RandomStringUtils.randomAlphanumeric(101));\n     aleRequest.setSystemIp(\"0.0.0.\");\n+    aleRequest.setClientIp(getRandomSystemIp());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 100}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3NDM4NA==", "bodyText": "this is not PII, we don't need to exclude it form logs.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453074384", "createdAt": "2020-07-10T20:58:56Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/AuditLogEventRequest.java", "diffHunk": "@@ -43,6 +43,11 @@\n   @ToString.Exclude\n   private String systemIp;\n \n+  @NotBlank\n+  @Size(min = 7, max = 39)\n+  @ToString.Exclude", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3NzQ1OQ==", "bodyText": "If I recall correctly we had agreed to remove OrgID entirely, so there is no point in adding it here.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453077459", "createdAt": "2020-07-10T21:06:46Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/mapper/AuditEventMapper.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.google.cloud.healthcare.fdamystudies.mapper;\n+\n+import com.google.cloud.healthcare.fdamystudies.beans.AuditLogEventRequest;\n+import java.net.InetAddress;\n+import java.net.UnknownHostException;\n+import java.util.Arrays;\n+import javax.servlet.http.Cookie;\n+import javax.servlet.http.HttpServletRequest;\n+import org.apache.commons.lang3.StringUtils;\n+\n+public final class AuditEventMapper {\n+\n+  private AuditEventMapper() {}\n+\n+  private static final String APP_ID = \"appId\";\n+\n+  private static final String CLIENT_ID = \"clientId\";\n+\n+  private static final String DEVICE_TYPE = \"deviceType\";\n+\n+  private static final String DEVICE_PLATFORM = \"devicePlatform\";\n+\n+  private static final String CLIENT_APP_VERSION = \"clientAppVersion\";\n+\n+  private static final String CORRELATION_ID = \"correlationId\";\n+\n+  private static final String USER_ID = \"userId\";\n+\n+  private static final String ORG_ID = \"orgId\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3NzcwMA==", "bodyText": "system IP to be removed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453077700", "createdAt": "2020-07-10T21:07:29Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/mapper/AuditEventMapper.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.google.cloud.healthcare.fdamystudies.mapper;\n+\n+import com.google.cloud.healthcare.fdamystudies.beans.AuditLogEventRequest;\n+import java.net.InetAddress;\n+import java.net.UnknownHostException;\n+import java.util.Arrays;\n+import javax.servlet.http.Cookie;\n+import javax.servlet.http.HttpServletRequest;\n+import org.apache.commons.lang3.StringUtils;\n+\n+public final class AuditEventMapper {\n+\n+  private AuditEventMapper() {}\n+\n+  private static final String APP_ID = \"appId\";\n+\n+  private static final String CLIENT_ID = \"clientId\";\n+\n+  private static final String DEVICE_TYPE = \"deviceType\";\n+\n+  private static final String DEVICE_PLATFORM = \"devicePlatform\";\n+\n+  private static final String CLIENT_APP_VERSION = \"clientAppVersion\";\n+\n+  private static final String CORRELATION_ID = \"correlationId\";\n+\n+  private static final String USER_ID = \"userId\";\n+\n+  private static final String ORG_ID = \"orgId\";\n+\n+  public static AuditLogEventRequest fromHttpServletRequest(HttpServletRequest request)\n+      throws UnknownHostException {\n+    AuditLogEventRequest aleRequest = new AuditLogEventRequest();\n+    aleRequest.setOrgId(getValue(request, ORG_ID));\n+    aleRequest.setAppId(getValue(request, APP_ID));\n+    aleRequest.setClientAppVersion(getValue(request, CLIENT_APP_VERSION));\n+    aleRequest.setCorrelationId(getValue(request, CORRELATION_ID));\n+    aleRequest.setDeviceType(getValue(request, DEVICE_TYPE));\n+    aleRequest.setDevicePlatform(getValue(request, DEVICE_PLATFORM));\n+    aleRequest.setClientId(getValue(request, CLIENT_ID));\n+    aleRequest.setUserId(getValue(request, USER_ID));\n+    aleRequest.setClientIp(getClientIP(request));\n+    aleRequest.setRequestUri(request.getRequestURI());\n+    aleRequest.setSystemIp(InetAddress.getLocalHost().getHostAddress());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3ODE2OQ==", "bodyText": "where is this used and why is cookie not encrypted?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453078169", "createdAt": "2020-07-10T21:08:47Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/mapper/AuditEventMapper.java", "diffHunk": "@@ -0,0 +1,71 @@\n+package com.google.cloud.healthcare.fdamystudies.mapper;\n+\n+import com.google.cloud.healthcare.fdamystudies.beans.AuditLogEventRequest;\n+import java.net.InetAddress;\n+import java.net.UnknownHostException;\n+import java.util.Arrays;\n+import javax.servlet.http.Cookie;\n+import javax.servlet.http.HttpServletRequest;\n+import org.apache.commons.lang3.StringUtils;\n+\n+public final class AuditEventMapper {\n+\n+  private AuditEventMapper() {}\n+\n+  private static final String APP_ID = \"appId\";\n+\n+  private static final String CLIENT_ID = \"clientId\";\n+\n+  private static final String DEVICE_TYPE = \"deviceType\";\n+\n+  private static final String DEVICE_PLATFORM = \"devicePlatform\";\n+\n+  private static final String CLIENT_APP_VERSION = \"clientAppVersion\";\n+\n+  private static final String CORRELATION_ID = \"correlationId\";\n+\n+  private static final String USER_ID = \"userId\";\n+\n+  private static final String ORG_ID = \"orgId\";\n+\n+  public static AuditLogEventRequest fromHttpServletRequest(HttpServletRequest request)\n+      throws UnknownHostException {\n+    AuditLogEventRequest aleRequest = new AuditLogEventRequest();\n+    aleRequest.setOrgId(getValue(request, ORG_ID));\n+    aleRequest.setAppId(getValue(request, APP_ID));\n+    aleRequest.setClientAppVersion(getValue(request, CLIENT_APP_VERSION));\n+    aleRequest.setCorrelationId(getValue(request, CORRELATION_ID));\n+    aleRequest.setDeviceType(getValue(request, DEVICE_TYPE));\n+    aleRequest.setDevicePlatform(getValue(request, DEVICE_PLATFORM));\n+    aleRequest.setClientId(getValue(request, CLIENT_ID));\n+    aleRequest.setUserId(getValue(request, USER_ID));\n+    aleRequest.setClientIp(getClientIP(request));\n+    aleRequest.setRequestUri(request.getRequestURI());\n+    aleRequest.setSystemIp(InetAddress.getLocalHost().getHostAddress());\n+    return aleRequest;\n+  }\n+\n+  private static String getValue(HttpServletRequest request, String name) {\n+    String value = request.getHeader(name);\n+    if (StringUtils.isEmpty(value)) {\n+      value = getCookieValue(request, name);\n+    }\n+    return value;\n+  }\n+\n+  private static String getClientIP(HttpServletRequest request) {\n+    return StringUtils.defaultIfEmpty(\n+        request.getHeader(\"X-FORWARDED-FOR\"), request.getRemoteAddr());\n+  }\n+\n+  private static String getCookieValue(HttpServletRequest req, String cookieName) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3ODYxMg==", "bodyText": "let's postpone this until we have a decision with regard to the fallback and retry approach.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453078612", "createdAt": "2020-07-10T21:10:01Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/AuditEventEntity.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.model;\n+\n+import java.sql.Timestamp;\n+import javax.persistence.Column;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.Table;\n+import lombok.Getter;\n+import lombok.Setter;\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.commons.text.StringEscapeUtils;\n+import org.hibernate.annotations.GenericGenerator;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+\n+@Setter\n+@Getter\n+@Entity\n+@Table(name = \"audit_events\")\n+@ConditionalOnProperty(\n+    value = \"commonservice.auditlogevent.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = true)\n+public class AuditEventEntity {\n+\n+  @Id\n+  @GeneratedValue(generator = \"system-uuid\")\n+  @GenericGenerator(name = \"system-uuid\", strategy = \"uuid\")\n+  @Column(name = \"id\", updatable = false, nullable = false)\n+  private String id;\n+\n+  /** Refer AuditLogEventStatus enum for values. */\n+  @Column(name = \"status\")\n+  private int status;\n+\n+  @Column(name = \"http_status_code\")\n+  private int httpStatusCode;\n+\n+  @Column(name = \"retry_count\", nullable = true)\n+  private long retryCount;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY3NTA2MA==", "bodyText": "please rename to auditRequest", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453675060", "createdAt": "2020-07-13T14:05:52Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/AuditEventServiceImpl.java", "diffHunk": "@@ -0,0 +1,114 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.service;\n+\n+import static com.google.cloud.healthcare.fdamystudies.common.JsonUtils.getObjectMapper;\n+import static com.google.cloud.healthcare.fdamystudies.common.JsonUtils.getTextValue;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.google.cloud.healthcare.fdamystudies.beans.AuditLogEventRequest;\n+import com.google.cloud.healthcare.fdamystudies.beans.AuditLogEventResponse;\n+import com.google.cloud.healthcare.fdamystudies.common.AuditLogEvent;\n+import com.google.cloud.healthcare.fdamystudies.repository.AuditEventRepository;\n+import java.time.Instant;\n+import org.slf4j.ext.XLogger;\n+import org.slf4j.ext.XLoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n+import org.springframework.http.HttpHeaders;\n+import org.springframework.http.HttpMethod;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.http.ResponseEntity;\n+import org.springframework.stereotype.Service;\n+import org.springframework.web.client.RestClientResponseException;\n+\n+@Service\n+@ConditionalOnProperty(\n+    value = \"commonservice.auditlogevent.enabled\",\n+    havingValue = \"true\",\n+    matchIfMissing = true)\n+public class AuditEventServiceImpl extends BaseServiceImpl implements AuditEventService {\n+\n+  private XLogger logger = XLoggerFactory.getXLogger(AuditEventServiceImpl.class.getName());\n+\n+  @Value(\"${auditlog.events_endpoint:}\")\n+  private String eventsEndpoint;\n+\n+  @Value(\"${auditlog.app.component.name:}\")\n+  private String appComponentName;\n+\n+  @Value(\"${auditlog.application.version:}\")\n+  private String applicationVersion;\n+\n+  @Autowired AuditEventRepository auditEventRepository;\n+\n+  @Autowired private OAuthService oauthService;\n+\n+  @Override\n+  public AuditLogEventResponse postAuditLogEvent(\n+      AuditLogEvent eventEnum, AuditLogEventRequest aleRequest) {\n+    logger.entry(String.format(\"begin postAuditLogEvent() for %s event\", eventEnum.getEventName()));\n+\n+    // prepare the request for POST method\n+    aleRequest.setEventName(eventEnum.getEventName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY3NzA3MQ==", "bodyText": "isSuccessful is probably descriptive enough, is2xx is an implementation detail.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453677071", "createdAt": "2020-07-13T14:08:59Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/OAuthServiceImpl.java", "diffHunk": "@@ -62,4 +89,56 @@\n             response.getStatusCodeValue(), response.getBody().get(ACTIVE).booleanValue()));\n     return response;\n   }\n+\n+  @Override\n+  public String getAccessToken() {\n+    if (StringUtils.isEmpty(accessToken)) {\n+      this.accessToken = getNewAccessToken();\n+    }\n+    return this.accessToken;\n+  }\n+\n+  @Override\n+  public String getNewAccessToken() {\n+    logger.entry(\"begin getNewAccessToken()\");\n+    ResponseEntity<JsonNode> response = getToken();\n+    if (response.getStatusCode().is2xxSuccessful()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY3ODIwMA==", "bodyText": "please rename all aleRequest and aleResponses to auditRequest and auditRepsponse.\nale will be quite confusing to new users.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453678200", "createdAt": "2020-07-13T14:10:39Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/controller/UserController.java", "diffHunk": "@@ -97,15 +100,16 @@\n       consumes = MediaType.APPLICATION_JSON_VALUE)\n   public ResponseEntity<?> resetPassword(\n       @Valid @RequestBody UpdateUserRequest userRequest, HttpServletRequest request)\n-      throws JsonProcessingException {\n+      throws JsonProcessingException, UnknownHostException {\n     logger.entry(String.format(BEGIN_S_REQUEST_LOG, request.getRequestURI()));\n     ValidationErrorResponse validationResult = UserValidator.validate(userRequest);\n     if (validationResult.hasErrors()) {\n       logger.exit(String.format(VALIDATION_ERROS_LOG, validationResult));\n       return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(validationResult);\n     }\n \n-    UpdateUserResponse userResponse = userService.resetPassword(userRequest);\n+    AuditLogEventRequest aleRequest = AuditEventMapper.fromHttpServletRequest(request);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY3ODcyMw==", "bodyText": "please remove all versioning instances from this code and other dependent PRs", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453678723", "createdAt": "2020-07-13T14:11:23Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/filter/TokenIntrospectionFilter.java", "diffHunk": "@@ -31,6 +31,12 @@ public void init() {\n     uriTemplateAndMethods.put(\n         String.format(\"%s/v1/users\", context.getContextPath()),\n         new String[] {HttpMethod.POST.name()});\n+    uriTemplateAndMethods.put(\n+        String.format(\"%s/v1/users/{userId}\", context.getContextPath()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY4MDI1Ng==", "bodyText": "nit: would be nice to extract common header in one file and reuse them", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453680256", "createdAt": "2020-07-13T14:13:46Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/service/HydraOAuthServiceImpl.java", "diffHunk": "@@ -25,6 +25,11 @@\n @Service\n class HydraOAuthServiceImpl extends BaseServiceImpl implements OAuthService {\n \n+  private static final String APPLICATION_X_WWW_FORM_URLENCODED_CHARSET_UTF_8 =\n+      \"application/x-www-form-urlencoded;charset=UTF-8\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY4NDA3Ng==", "bodyText": "Unit tests should be independent of one another; having these dependency on previous tests means that if one of the early tests fails, all following tests will also fail which is misleading and can hide other potential failures.\nPlease fix and remove @order from all unit tests.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453684076", "createdAt": "2020-07-13T14:19:13Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/test/java/com/google/cloud/healthcare/fdamystudies/oauthscim/controller/UserControllerTest.java", "diffHunk": "@@ -219,6 +248,11 @@ public void shouldReturnBadRequestForChangePasswordAction()\n     actualResponse = result.getResponse().getContentAsString();\n     expectedResponse = readJsonFile(\"/response/change_password_bad_request_from_validator.json\");\n     JSONAssert.assertEquals(expectedResponse, actualResponse, JSONCompareMode.NON_EXTENSIBLE);\n+\n+    verify(\n+        5,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY4NDg1MA==", "bodyText": "this will removed as well.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453684850", "createdAt": "2020-07-13T14:20:21Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/common/AuthScimEvent.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.oauthscim.common;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.AuditLogEvent;\n+import lombok.Getter;\n+\n+@Getter\n+public enum AuthScimEvent implements AuditLogEvent {\n+  PASSWORD_RESET_SUCCESS(\n+      false,\n+      Constants.APP_USER,\n+      Constants.FMSGCAUTHSVR,\n+      Constants.FMSGCMOBAPP,\n+      Constants.APP_LEVEL,\n+      Constants.PARTICIPANT_DATASTORE,\n+      \"Password reset success\",\n+      \"Password reset for User ID ${user_id} was successful.\",\n+      \"PASSWORD_RESET_SUCCESS\",\n+      true),\n+\n+  PASSWORD_RESET_FAILED(\n+      false,\n+      Constants.APP_USER,\n+      Constants.FMSGCAUTHSVR,\n+      Constants.FMSGCMOBAPP,\n+      Constants.APP_LEVEL,\n+      Constants.PARTICIPANT_DATASTORE,\n+      \"Password reset failure\",\n+      \"Password reset for User ID ${user_id}, failed.\",\n+      \"PASSWORD_RESET_FAILED\",\n+      true);\n+\n+  private final String eventName;\n+  private final boolean alert;\n+  private final String systemId;\n+  private final String accessLevel;\n+  private final String clientId;\n+  private final String clientAccessLevel;\n+  private final String resourceServer;\n+  private final String eventDetail;\n+  private final String description;\n+  private final boolean fallback;\n+\n+  private AuthScimEvent(\n+      boolean alert,\n+      String accessLevel,\n+      String systemId,\n+      String clientId,\n+      String clientAccessLevel,\n+      String resourceServer,\n+      String eventDetail,\n+      String description,\n+      String eventName,\n+      boolean fallback) {\n+    this.alert = alert;\n+    this.accessLevel = accessLevel;\n+    this.systemId = systemId;\n+    this.clientId = clientId;\n+    this.clientAccessLevel = clientAccessLevel;\n+    this.resourceServer = resourceServer;\n+    this.description = description;\n+    this.eventDetail = eventDetail;\n+    this.eventName = eventName;\n+    this.fallback = fallback;\n+  }\n+\n+  private static class Constants {\n+    private static final String APP_LEVEL = \"App-level\";\n+\n+    private static final String FMSGCAUTHSVR = \"FMSGCAUTHSVR\";\n+\n+    private static final String APP_USER = \"App User\";\n+\n+    private static final String PARTICIPANT_DATASTORE = \"Participant Datastore\";\n+\n+    private static final String FMSGCMOBAPP = \"FMSGCMOBAPP\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzY4Njc1Ng==", "bodyText": "there is not a lot of value in constants that equal their own value. A better approach would be to name the constant as to what it is, similar to how a variable is named, and its value should be the content for your environment, class, etc.\nIf values are possible values for the same thing that can be used by the application, you have an enum hiding in your class.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r453686756", "createdAt": "2020-07-13T14:23:07Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/common/AuthScimEvent.java", "diffHunk": "@@ -0,0 +1,85 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.oauthscim.common;\n+\n+import com.google.cloud.healthcare.fdamystudies.common.AuditLogEvent;\n+import lombok.Getter;\n+\n+@Getter\n+public enum AuthScimEvent implements AuditLogEvent {\n+  PASSWORD_RESET_SUCCESS(\n+      false,\n+      Constants.APP_USER,\n+      Constants.FMSGCAUTHSVR,\n+      Constants.FMSGCMOBAPP,\n+      Constants.APP_LEVEL,\n+      Constants.PARTICIPANT_DATASTORE,\n+      \"Password reset success\",\n+      \"Password reset for User ID ${user_id} was successful.\",\n+      \"PASSWORD_RESET_SUCCESS\",\n+      true),\n+\n+  PASSWORD_RESET_FAILED(\n+      false,\n+      Constants.APP_USER,\n+      Constants.FMSGCAUTHSVR,\n+      Constants.FMSGCMOBAPP,\n+      Constants.APP_LEVEL,\n+      Constants.PARTICIPANT_DATASTORE,\n+      \"Password reset failure\",\n+      \"Password reset for User ID ${user_id}, failed.\",\n+      \"PASSWORD_RESET_FAILED\",\n+      true);\n+\n+  private final String eventName;\n+  private final boolean alert;\n+  private final String systemId;\n+  private final String accessLevel;\n+  private final String clientId;\n+  private final String clientAccessLevel;\n+  private final String resourceServer;\n+  private final String eventDetail;\n+  private final String description;\n+  private final boolean fallback;\n+\n+  private AuthScimEvent(\n+      boolean alert,\n+      String accessLevel,\n+      String systemId,\n+      String clientId,\n+      String clientAccessLevel,\n+      String resourceServer,\n+      String eventDetail,\n+      String description,\n+      String eventName,\n+      boolean fallback) {\n+    this.alert = alert;\n+    this.accessLevel = accessLevel;\n+    this.systemId = systemId;\n+    this.clientId = clientId;\n+    this.clientAccessLevel = clientAccessLevel;\n+    this.resourceServer = resourceServer;\n+    this.description = description;\n+    this.eventDetail = eventDetail;\n+    this.eventName = eventName;\n+    this.fallback = fallback;\n+  }\n+\n+  private static class Constants {\n+    private static final String APP_LEVEL = \"App-level\";\n+\n+    private static final String FMSGCAUTHSVR = \"FMSGCAUTHSVR\";\n+\n+    private static final String APP_USER = \"App User\";\n+\n+    private static final String PARTICIPANT_DATASTORE = \"Participant Datastore\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "830ce809510d79ad2ea9d109e462b6f4640aa35c"}, "originalPosition": 81}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "128fb22be14d467f1f6a620fe65471ce8d0d27bd", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/128fb22be14d467f1f6a620fe65471ce8d0d27bd", "committedDate": "2020-07-14T07:41:27Z", "message": "Fixed #590 review comments and Created Issue #628\n\nFixed #590 review comments, Created Issue #628 to fix few review comments in followup PR."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/b61edc8eb8de718aa503080c82acf6ef90bf1cfc", "committedDate": "2020-07-29T16:19:13Z", "message": "Audit log implementation as per new requirements\n\nAdded following enums - UserAccessLevel, PlatformComponent, MobilePlatform\nEncryptionUtils - replaced sha3_512Hex with sha512Hex\nRefactored the code and tests."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3ODA1MzMz", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#pullrequestreview-457805333", "createdAt": "2020-07-29T19:01:38Z", "commit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxOTowMTozOVrOG5GBrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxOTo0MDoxNlrOG5HWVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjUyMDc0OA==", "bodyText": "We are removing event names. Event code should be sufficient.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462520748", "createdAt": "2020-07-29T19:01:39Z", "author": {"login": "zohrehj"}, "path": "audit-log-module/audit-log-service/src/test/java/com/google/cloud/healthcare/fdamystudies/auditlog/controller/AuditLogEventControllerTest.java", "diffHunk": "@@ -167,31 +171,25 @@ private HttpHeaders getCommonHeaders() {\n   private AuditLogEventRequest createAuditLogEventRequest() {\n     AuditLogEventRequest auditRequest = new AuditLogEventRequest();\n     auditRequest.setUserId(UUID.randomUUID().toString());\n-    auditRequest.setAccessLevel(null);\n-    auditRequest.setAlert(false);\n+    auditRequest.setUserAccessLevel(UserAccessLevel.APP_STUDY_ADMIN.getValue());\n     auditRequest.setAppId(\"MyStudies\");\n-    auditRequest.setApplicationComponentName(\"Auth Server\");\n-    auditRequest.setApplicationVersion(\"v1.0\");\n-    auditRequest.setClientId(\"FMSGCPARDTST\");\n-    auditRequest.setClientAccessLevel(\"System-level\");\n-    auditRequest.setClientAppVersion(\"v1.1\");\n+    auditRequest.setSource(PlatformComponent.PARTICIPANT_DATASTORE.getValue());\n+    auditRequest.setResourceServer(PlatformComponent.PARTICIPANT_DATASTORE.getValue());\n+    auditRequest.setAppVersion(\"v1.0\");\n+    auditRequest.setDestination(PlatformComponent.SCIM_AUTH_SERVER.getValue());\n     auditRequest.setCorrelationId(UUID.randomUUID().toString());\n     auditRequest.setDescription(\n         String.format(\n-            \"App user registration successful for username %s and user ID %s returned to Resource Server\",\n-            \"mock_ale@grr.la\", auditRequest.getUserId()));\n-    auditRequest.setDevicePlatform(\"Android\");\n-    auditRequest.setDeviceType(\"MOBILE\");\n-    auditRequest.setEventDetail(\"App user registration success\");\n-    auditRequest.setEventName(\"REGISTRATION_SUCCESS\");\n-    auditRequest.setOccured(Instant.now().toEpochMilli());\n-    auditRequest.setOrgId(\"FDA\");\n-    auditRequest.setRequestUri(null);\n-    auditRequest.setResourceServer(\"Participant Datastore\");\n-    auditRequest.setSystemId(\"FMSGCAUTHSVR\");\n-    auditRequest.setSystemIp(getRandomSystemIp());\n-    auditRequest.setClientIp(getRandomSystemIp());\n-\n+            \"Password reset for User ID ${user_id} was successful.\", auditRequest.getUserId()));\n+    auditRequest.setMobilePlatform(MobilePlatform.ANDROID.getValue());\n+    auditRequest.setEventName(\"Password reset success\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 146}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjUyMzAyNA==", "bodyText": "event_id is sufficient. This should be removed. Please refer to the Audit log columns doc for the final list of fields.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462523024", "createdAt": "2020-07-29T19:05:32Z", "author": {"login": "zohrehj"}, "path": "audit-log-module/audit-log-service/src/main/java/com/google/cloud/healthcare/fdamystudies/auditlog/model/AuditLogEventEntity.java", "diffHunk": "@@ -50,62 +47,57 @@\n       columnDefinition = \"TIMESTAMP DEFAULT CURRENT_TIMESTAMP\")\n   private Timestamp created;\n \n-  @Column(name = \"alert\", nullable = false, length = 1)\n-  private boolean alert;\n-\n-  @Column(name = \"app_id\", nullable = true, length = 100)\n+  @Column(name = \"app_id\", nullable = true, length = 64)\n   private String appId;\n \n-  @Column(name = \"org_id\", nullable = true, length = 100)\n-  private String orgId;\n-\n   @ToString.Exclude\n-  @Column(name = \"user_id\", nullable = true, length = 100)\n+  @Column(name = \"user_id\", nullable = true, length = 64)\n   private String userId;\n \n   @ToString.Exclude\n-  @Column(name = \"system_ip\", nullable = false, length = 39)\n-  private String systemIp;\n+  @Column(name = \"user_ip\", nullable = true, length = 39)\n+  private String userIp;\n \n   @ToString.Exclude\n   @Column(name = \"description\", nullable = false, length = 255)\n   private String description;\n \n-  @ToString.Exclude\n-  @Column(name = \"event_detail\", nullable = false, length = 255)\n-  private String eventDetail;\n+  @Column(name = \"event_name\", nullable = false, length = 255)\n+  private String eventName;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjUzMTIzOA==", "bodyText": "let's not implement this for now.\nVersioning is something that we have not discussed yet, we briefly talked about it a few months ago and decided to consider the whole platform as a connected entity and return the same fixed version for all until we have had the chance to revisit the API between the components.\nSo for here, let's return a single version for now. i.e. \"application.version\" works for now.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462531238", "createdAt": "2020-07-29T19:19:58Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/AuditEventServiceImpl.java", "diffHunk": "@@ -111,4 +111,31 @@ private AuditLogEventResponse callEventsApi(JsonNode requestBody) {\n         String.format(\n             \"%s event not received/processed by the central audit log system.\", eventName));\n   }\n+\n+  private String getApplicationVersion(PlatformComponent source) {\n+    switch (source) {\n+      case MOBILE_APP:\n+        return commonPropConfig.getMobileApplicationVersion();\n+      case RESPONSE_DATASTORE:\n+        return commonPropConfig.getResponseDatastoreApplicationVersion();\n+      case PARTICIPANT_DATASTORE:\n+        return commonPropConfig.getParticipantDatastoreApplicationVersion();\n+      case STUDY_BUILDER:\n+        return commonPropConfig.getStudyBuilderApplicationVersion();\n+      case STUDY_BUILDER_APP:\n+        return commonPropConfig.getStudyBuilderAppApplicationVersion();\n+      case CLOUD_STORAGE:\n+        return commonPropConfig.getCloudStorageApplicationVersion();\n+      case SCIM_AUTH_SERVER:\n+        return commonPropConfig.getScimAuthServerApplicationVersion();\n+      case AUTH_SERVER:\n+        return commonPropConfig.getAuthServerApplicationVersion();\n+      case PARTICIPANT_MANAGER:\n+        return commonPropConfig.getParticipantManagerApplicationVersion();\n+      case PARTICIPANT_MANAGER_APP:\n+        return commonPropConfig.getParticipantManagerAppApplicationVersion();\n+      default:\n+        return \"Unknown\";\n+    }\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjUzNTQ5MQ==", "bodyText": "description is also redundant for this event, since the action is taken by the same user and so the user_id field would point to the same user.\nIf description text is redundant, then it should not be skipped. Introducing free form text in the audit log, increases the chance of accidentally leaking PII and PHI, so I would like to limit that to events that absolutely need this information.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462535491", "createdAt": "2020-07-29T19:27:53Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/common/AuthScimEvent.java", "diffHunk": "@@ -8,80 +8,41 @@\n \n package com.google.cloud.healthcare.fdamystudies.oauthscim.common;\n \n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.PARTICIPANT_DATASTORE;\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.SCIM_AUTH_SERVER;\n+\n import com.google.cloud.healthcare.fdamystudies.common.AuditLogEvent;\n+import com.google.cloud.healthcare.fdamystudies.common.PlatformComponent;\n+import com.google.cloud.healthcare.fdamystudies.common.UserAccessLevel;\n+import lombok.AllArgsConstructor;\n import lombok.Getter;\n \n @Getter\n+@AllArgsConstructor\n public enum AuthScimEvent implements AuditLogEvent {\n   PASSWORD_RESET_SUCCESS(\n-      false,\n-      Constant.APP_USER,\n-      Constant.SYSTEM_ID,\n-      Constant.CLIENT_ID,\n-      Constant.APP_LEVEL,\n-      Constant.PARTICIPANT_DATASTORE,\n+      PARTICIPANT_DATASTORE,\n+      SCIM_AUTH_SERVER,\n+      PARTICIPANT_DATASTORE,\n       \"Password reset success\",\n       \"Password reset for User ID ${user_id} was successful.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjUzNTgxMg==", "bodyText": "please remove event name from the code entirely. EventCode field should be descriptive enough.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462535812", "createdAt": "2020-07-29T19:28:28Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/common/AuthScimEvent.java", "diffHunk": "@@ -8,80 +8,41 @@\n \n package com.google.cloud.healthcare.fdamystudies.oauthscim.common;\n \n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.PARTICIPANT_DATASTORE;\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.SCIM_AUTH_SERVER;\n+\n import com.google.cloud.healthcare.fdamystudies.common.AuditLogEvent;\n+import com.google.cloud.healthcare.fdamystudies.common.PlatformComponent;\n+import com.google.cloud.healthcare.fdamystudies.common.UserAccessLevel;\n+import lombok.AllArgsConstructor;\n import lombok.Getter;\n \n @Getter\n+@AllArgsConstructor\n public enum AuthScimEvent implements AuditLogEvent {\n   PASSWORD_RESET_SUCCESS(\n-      false,\n-      Constant.APP_USER,\n-      Constant.SYSTEM_ID,\n-      Constant.CLIENT_ID,\n-      Constant.APP_LEVEL,\n-      Constant.PARTICIPANT_DATASTORE,\n+      PARTICIPANT_DATASTORE,\n+      SCIM_AUTH_SERVER,\n+      PARTICIPANT_DATASTORE,\n       \"Password reset success\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjUzNzUyMA==", "bodyText": "I don't see the value of creating these event enums, Can you explain why you are creating them in advance and not calling a generic submit event method in the code itself?\nalso what happens if we integrated WCP or other mobile apps with the auth server. Do you expect to have a separate PASSWORD_RESET_SUCCESS event for each source component?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462537520", "createdAt": "2020-07-29T19:31:23Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/common/AuthScimEvent.java", "diffHunk": "@@ -8,80 +8,41 @@\n \n package com.google.cloud.healthcare.fdamystudies.oauthscim.common;\n \n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.PARTICIPANT_DATASTORE;\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.SCIM_AUTH_SERVER;\n+\n import com.google.cloud.healthcare.fdamystudies.common.AuditLogEvent;\n+import com.google.cloud.healthcare.fdamystudies.common.PlatformComponent;\n+import com.google.cloud.healthcare.fdamystudies.common.UserAccessLevel;\n+import lombok.AllArgsConstructor;\n import lombok.Getter;\n \n @Getter\n+@AllArgsConstructor\n public enum AuthScimEvent implements AuditLogEvent {\n   PASSWORD_RESET_SUCCESS(\n-      false,\n-      Constant.APP_USER,\n-      Constant.SYSTEM_ID,\n-      Constant.CLIENT_ID,\n-      Constant.APP_LEVEL,\n-      Constant.PARTICIPANT_DATASTORE,\n+      PARTICIPANT_DATASTORE,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjUzODUzOA==", "bodyText": "please change the text for \"unknown\" to \"Any other value. Should not happen\"", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462538538", "createdAt": "2020-07-29T19:33:19Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MobilePlatform.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+\n+@Getter\n+@AllArgsConstructor\n+public enum MobilePlatform {\n+  ANDROID(\"ANDROID\", \"Represents an android platform\"),\n+  IOS(\"IOS\", \"Represents an apple platform\"),\n+  UNKNOWN(\"UNKNOWN\", \"Represents unknown platform\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjUzODY3Ng==", "bodyText": "nit: capitalize Android and Apple", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462538676", "createdAt": "2020-07-29T19:33:33Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MobilePlatform.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+\n+@Getter\n+@AllArgsConstructor\n+public enum MobilePlatform {\n+  ANDROID(\"ANDROID\", \"Represents an android platform\"),\n+  IOS(\"IOS\", \"Represents an apple platform\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU0MTU4NQ==", "bodyText": "please use the naming as specified in the FDA MyStudies nomeclature document that I just shared with you.\nFormat: let's keep a consistent format. Change this to match the device platform, in uppercase.\nAlso please change App to Application all around.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462541585", "createdAt": "2020-07-29T19:38:57Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/PlatformComponent.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+\n+@Getter\n+@AllArgsConstructor\n+public enum PlatformComponent {\n+  MOBILE_APP(\"Mobile App\"),\n+  RESPONSE_DATASTORE(\"Response Datastore\"),\n+  PARTICIPANT_DATASTORE(\"Participant Datastore\"),\n+  STUDY_BUILDER(\"Study Builder\"),\n+  STUDY_BUILDER_APP(\"Study Builder App\"),\n+  CLOUD_STORAGE(\"Cloud Storage\"),\n+  SCIM_AUTH_SERVER(\"SCIM Auth Server\"),\n+  AUTH_SERVER(\"Auth Server\"),\n+  PARTICIPANT_MANAGER(\"Participant Manager\"),\n+  PARTICIPANT_MANAGER_APP(\"Participant Manager App\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU0MjQyMA==", "bodyText": "What is SB admin?\n@jkrogers18 These values would be stored in our audit logs, do you have any input on what these access levels should be?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r462542420", "createdAt": "2020-07-29T19:40:16Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/UserAccessLevel.java", "diffHunk": "@@ -0,0 +1,23 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+\n+@Getter\n+@AllArgsConstructor\n+public enum UserAccessLevel {\n+  SUPER_ADMIN(\"Superadmin\"),\n+  SB_ADMIN(\"SB Admin\"),\n+  APP_STUDY_ADMIN(\"App/Study Admin\"),\n+  SITE_ADMIN(\"Site Admin\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba1920c4457b8d0562fdb166210ca113c58ba914", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ba1920c4457b8d0562fdb166210ca113c58ba914", "committedDate": "2020-07-30T09:05:07Z", "message": "Fixed PR #590 review comments\n\nFixed PR #590 review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e723dd6a45131061fff7c2309485f950890a0d8", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9e723dd6a45131061fff7c2309485f950890a0d8", "committedDate": "2020-07-30T10:24:39Z", "message": "Fixed review comments\n\nFixed review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d227b85115edbbace70f2f248d244612436a035", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8d227b85115edbbace70f2f248d244612436a035", "committedDate": "2020-07-30T10:25:39Z", "message": "added a line spacing for readability\n\nadded a line spacing for readability"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c8bf15362b0ba36bc41a4723ff1203b37853515", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6c8bf15362b0ba36bc41a4723ff1203b37853515", "committedDate": "2020-07-30T10:44:44Z", "message": "renamed aleHelper to auditHelper and used static import for AuthScimEvent\n\nrenamed aleHelper to auditHelper and used static import for AuthScimEvent"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NTk5NDYy", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#pullrequestreview-458599462", "createdAt": "2020-07-30T17:12:48Z", "commit": {"oid": "6c8bf15362b0ba36bc41a4723ff1203b37853515"}, "state": "DISMISSED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNzoxMjo0OVrOG5sTcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNzoyMDo0NFrOG5slMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE0Nzg4OQ==", "bodyText": "not compatible with the format.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r463147889", "createdAt": "2020-07-30T17:12:49Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/PlatformComponent.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+\n+@Getter\n+@AllArgsConstructor\n+public enum PlatformComponent {\n+  MOBILE_APPS(\n+      \"MOBILE APPS\", \"The iOS and Android apps that participants use to interact with MyStudies\"),\n+\n+  RESPONSE_DATASTORE(\n+      \"RESPONSE DATASTORE\",\n+      \"The back-end components that manage participant response data (does not include PII) \"),\n+\n+  PARTICIPANT_DATASTORE(\n+      \"PARTICIPANT DATASTORE\",\n+      \"The back-end components that manage app user / study participant data (includes PII)\"),\n+\n+  STUDY_BUILDER(\"STUDY BUILDER\", \"The UI that researchers use to design and deploy studies\"),\n+\n+  STUDY_DATASTORE(\n+      \"STUDY DATASTORE\",\n+      \"This is the back-end component that manages the study builder data and holds the study configurations\"),\n+\n+  SCIM_AUTH_SERVER(\n+      \"SCIM AUTH SERVER\",\n+      \"This component implements login/consent flow and integrates with ORY Hydra for access and refresh tokens\"),\n+\n+  AUTH_SERVER(\n+      \"Auth Server\",\n+      \"This is back-end component that manages user accounts and issues access and refresh tokens\"),\n+\n+  PARTICIPANT_MANAGER(\n+      \"PARTICIPANT MANAGER\",\n+      \"The UI that administrators use to invite participants to studies and track enrollment progress\"),\n+\n+  CLOUD_STORAGE(\n+      \"Cloud Storage\", \"for storing and accessing data on Google Cloud Platform infrastructure\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c8bf15362b0ba36bc41a4723ff1203b37853515"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE0ODM0Mw==", "bodyText": "these should also follow the capitalized format for enums", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r463148343", "createdAt": "2020-07-30T17:13:40Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/UserAccessLevel.java", "diffHunk": "@@ -0,0 +1,23 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import lombok.AllArgsConstructor;\n+import lombok.Getter;\n+\n+@Getter\n+@AllArgsConstructor\n+public enum UserAccessLevel {\n+  SUPER_ADMIN(\"Superadmin\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c8bf15362b0ba36bc41a4723ff1203b37853515"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE1MDU3Mg==", "bodyText": "should /v1 be removed from all these endpoints too?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r463150572", "createdAt": "2020-07-30T17:17:35Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-tests/src/main/resources/application-mockit-common.properties", "diffHunk": "@@ -25,8 +26,14 @@ logging.level.org.hibernate.type=ERROR\n logging.level.org.hibernate.stat=ERROR\n \n # oauth configuration\n-security.oauth2.health_endpoint=http://localhost:8080/oauth-scim-service/v1/health\n+security.oauth2.client.client-id= oauth-scim-client-id\n+security.oauth2.client.client-secret= oauth-scim-client-secret\n+security.oauth2.client.redirect-uri=http://localhost:8002/oauth-scim-service/login\n security.oauth2.introspection_endpoint=http://localhost:8080/oauth-scim-service/v1/oauth2/introspect\n+security.oauth2.token_endpoint=http://localhost:8080/oauth-scim-service/v1/oauth2/token", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c8bf15362b0ba36bc41a4723ff1203b37853515"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE1MTAyOA==", "bodyText": "ok, that sounds good.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r463151028", "createdAt": "2020-07-30T17:18:25Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/common/AuthScimEvent.java", "diffHunk": "@@ -8,80 +8,41 @@\n \n package com.google.cloud.healthcare.fdamystudies.oauthscim.common;\n \n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.PARTICIPANT_DATASTORE;\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.SCIM_AUTH_SERVER;\n+\n import com.google.cloud.healthcare.fdamystudies.common.AuditLogEvent;\n+import com.google.cloud.healthcare.fdamystudies.common.PlatformComponent;\n+import com.google.cloud.healthcare.fdamystudies.common.UserAccessLevel;\n+import lombok.AllArgsConstructor;\n import lombok.Getter;\n \n @Getter\n+@AllArgsConstructor\n public enum AuthScimEvent implements AuditLogEvent {\n   PASSWORD_RESET_SUCCESS(\n-      false,\n-      Constant.APP_USER,\n-      Constant.SYSTEM_ID,\n-      Constant.CLIENT_ID,\n-      Constant.APP_LEVEL,\n-      Constant.PARTICIPANT_DATASTORE,\n+      PARTICIPANT_DATASTORE,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjUzNzUyMA=="}, "originalCommit": {"oid": "b61edc8eb8de718aa503080c82acf6ef90bf1cfc"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE1MjQzMw==", "bodyText": "/v1 ?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#discussion_r463152433", "createdAt": "2020-07-30T17:20:44Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/resources/application-local.properties", "diffHunk": "@@ -51,3 +54,6 @@ spring.mail.properties.mail.smtp.auth=true\n spring.mail.properties.mail.smtp.socketFactory.fallback=false\n spring.mail.properties.mail.smtp.starttls.enable=true\n spring.mail.properties.mail.smtp.ssl.enable = true\n+\n+# audit log endpoints\n+auditlog.events_endpoint=http://localhost:8001/audit-log-service/v1/events", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c8bf15362b0ba36bc41a4723ff1203b37853515"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b60cca07039e22800e36522b6ba26865e1bf3180", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/b60cca07039e22800e36522b6ba26865e1bf3180", "committedDate": "2020-07-31T04:55:38Z", "message": "Fixed minor review comments\n\nFixed minor review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e96a2ab76f393a88f8f5508fd3e58e3e03c932b8", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e96a2ab76f393a88f8f5508fd3e58e3e03c932b8", "committedDate": "2020-07-31T06:37:43Z", "message": "Merge branch 'develop' into password_reset_auditlog_events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29135b70e4ca1a7bfc000dab35e55526dd5f180f", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/29135b70e4ca1a7bfc000dab35e55526dd5f180f", "committedDate": "2020-07-31T06:38:22Z", "message": "Resolve Conflicts: Fixed tests and compilation issues\n\nResolve Conflicts: Fixed tests and compilation issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MTQyNTEz", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/590#pullrequestreview-459142513", "createdAt": "2020-07-31T12:41:43Z", "commit": {"oid": "29135b70e4ca1a7bfc000dab35e55526dd5f180f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 786, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}