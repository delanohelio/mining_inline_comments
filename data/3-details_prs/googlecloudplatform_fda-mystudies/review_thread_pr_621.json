{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MjI2NDI0", "number": 621, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNzo1Njo0MVrOEPPWLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMDoxNDo0NVrOEPWXeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NDE1NTMyOnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNzo1Njo0MVrOGy2J-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNTozNDo1N1rOGz5KcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk2OTI3NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                boolean allowed = isEditPermissionAllowed(siteRequest);\n          \n          \n            \n                boolean canEdit = isEditPermissionAllowed(siteRequest);\n          \n      \n    \n    \n  \n\nor editAllowed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#discussion_r455969275", "createdAt": "2020-07-16T17:56:41Z", "author": {"login": "saminguyen"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java", "diffHunk": "@@ -0,0 +1,158 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.service;\n+\n+import static com.google.cloud.healthcare.fdamystudies.util.Constants.ACTIVE;\n+import static com.google.cloud.healthcare.fdamystudies.util.Constants.EDIT_VALUE;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import org.slf4j.ext.XLogger;\n+import org.slf4j.ext.XLoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Service;\n+import org.springframework.transaction.annotation.Transactional;\n+\n+import com.google.cloud.healthcare.fdamystudies.beans.SiteRequest;\n+import com.google.cloud.healthcare.fdamystudies.beans.SiteResponse;\n+import com.google.cloud.healthcare.fdamystudies.common.ErrorCode;\n+import com.google.cloud.healthcare.fdamystudies.common.MessageCode;\n+import com.google.cloud.healthcare.fdamystudies.mapper.SiteMapper;\n+import com.google.cloud.healthcare.fdamystudies.model.AppPermissionEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.LocationEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.SiteEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.SitePermissionEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.StudyEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.StudyPermissionEntity;\n+import com.google.cloud.healthcare.fdamystudies.repository.AppPermissionRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.LocationRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.SiteRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.StudyPermissionRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.StudyRepository;\n+\n+@Service\n+public class SiteServiceImpl implements SiteService {\n+\n+  private XLogger logger = XLoggerFactory.getXLogger(SiteServiceImpl.class.getName());\n+\n+  @Autowired private SiteRepository siteRepository;\n+\n+  @Autowired private LocationRepository locationRepository;\n+\n+  @Autowired private StudyRepository studyRepository;\n+\n+  @Autowired private StudyPermissionRepository studyPermissionRepository;\n+\n+  @Autowired private AppPermissionRepository appPermissionRepository;\n+\n+  @Override\n+  @Transactional\n+  public SiteResponse addSite(SiteRequest siteRequest) {\n+    logger.entry(\"begin addSite()\");\n+    boolean allowed = isEditPermissionAllowed(siteRequest);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA2NzEyMA==", "bodyText": "changed to canEdit", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#discussion_r457067120", "createdAt": "2020-07-20T05:34:57Z", "author": {"login": "Kantharajut-btc"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java", "diffHunk": "@@ -0,0 +1,158 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.service;\n+\n+import static com.google.cloud.healthcare.fdamystudies.util.Constants.ACTIVE;\n+import static com.google.cloud.healthcare.fdamystudies.util.Constants.EDIT_VALUE;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import org.slf4j.ext.XLogger;\n+import org.slf4j.ext.XLoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Service;\n+import org.springframework.transaction.annotation.Transactional;\n+\n+import com.google.cloud.healthcare.fdamystudies.beans.SiteRequest;\n+import com.google.cloud.healthcare.fdamystudies.beans.SiteResponse;\n+import com.google.cloud.healthcare.fdamystudies.common.ErrorCode;\n+import com.google.cloud.healthcare.fdamystudies.common.MessageCode;\n+import com.google.cloud.healthcare.fdamystudies.mapper.SiteMapper;\n+import com.google.cloud.healthcare.fdamystudies.model.AppPermissionEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.LocationEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.SiteEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.SitePermissionEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.StudyEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.StudyPermissionEntity;\n+import com.google.cloud.healthcare.fdamystudies.repository.AppPermissionRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.LocationRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.SiteRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.StudyPermissionRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.StudyRepository;\n+\n+@Service\n+public class SiteServiceImpl implements SiteService {\n+\n+  private XLogger logger = XLoggerFactory.getXLogger(SiteServiceImpl.class.getName());\n+\n+  @Autowired private SiteRepository siteRepository;\n+\n+  @Autowired private LocationRepository locationRepository;\n+\n+  @Autowired private StudyRepository studyRepository;\n+\n+  @Autowired private StudyPermissionRepository studyPermissionRepository;\n+\n+  @Autowired private AppPermissionRepository appPermissionRepository;\n+\n+  @Override\n+  @Transactional\n+  public SiteResponse addSite(SiteRequest siteRequest) {\n+    logger.entry(\"begin addSite()\");\n+    boolean allowed = isEditPermissionAllowed(siteRequest);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk2OTI3NQ=="}, "originalCommit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NDMzNDgxOnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/util/Constants.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxODo0NDozOVrOGy33sg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNTozNTo0MVrOGz5L3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk5NzM2Mg==", "bodyText": "add the word PERMISSION", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#discussion_r455997362", "createdAt": "2020-07-16T18:44:39Z", "author": {"login": "saminguyen"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/util/Constants.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.util;\n+\n+public final class Constants {\n+\n+  private Constants() {}\n+\n+  public static final int VIEW_VALUE = 0;\n+\n+  public static final int EDIT_VALUE = 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA2NzQ4NA==", "bodyText": "Replaced with Permission enum", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#discussion_r457067484", "createdAt": "2020-07-20T05:35:41Z", "author": {"login": "Kantharajut-btc"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/util/Constants.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.util;\n+\n+public final class Constants {\n+\n+  private Constants() {}\n+\n+  public static final int VIEW_VALUE = 0;\n+\n+  public static final int EDIT_VALUE = 1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk5NzM2Mg=="}, "originalCommit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NTMwNTUyOnYy", "diffSide": "RIGHT", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMDoxNDo0NVrOGzBCMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQwNTozNjozMVrOGz5Nmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0NzUwNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              SITE_PERMISSION_ACEESS_DENIED(\n          \n          \n            \n              SITE_PERMISSION_ACCESS_DENIED(", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#discussion_r456147507", "createdAt": "2020-07-17T00:14:45Z", "author": {"login": "saminguyen"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java", "diffHunk": "@@ -57,7 +61,15 @@\n       500,\n       \"EC-500\",\n       \"Internal Server Error\",\n-      \"Sorry, an error has occurred and your request could not be processed. Please try again later.\");\n+      \"Sorry, an error has occurred and your request could not be processed. Please try again later.\"),\n+\n+  SITE_PERMISSION_ACEESS_DENIED(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzA2NzkzMQ==", "bodyText": "typo corrected", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#discussion_r457067931", "createdAt": "2020-07-20T05:36:31Z", "author": {"login": "Kantharajut-btc"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java", "diffHunk": "@@ -57,7 +61,15 @@\n       500,\n       \"EC-500\",\n       \"Internal Server Error\",\n-      \"Sorry, an error has occurred and your request could not be processed. Please try again later.\");\n+      \"Sorry, an error has occurred and your request could not be processed. Please try again later.\"),\n+\n+  SITE_PERMISSION_ACEESS_DENIED(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0NzUwNw=="}, "originalCommit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "originalPosition": 26}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2283, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}