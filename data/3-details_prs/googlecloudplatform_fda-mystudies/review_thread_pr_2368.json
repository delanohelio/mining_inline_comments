{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5NDcxMDk1", "number": 2368, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozMzowMFrOFFEq_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozMzowMFrOFFEq_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwODYzNzQxOnYy", "diffSide": "RIGHT", "path": "participant-manager/src/app/service/locations.guard.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozMzowMFrOIFZIkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjo1MDo0M1rOIFZ_hA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUyNTU4NA==", "bodyText": "At first glance looks like you are allowing both view and edit permissions to activate location. The question that comes up is what is then being excluded?\nin other words, what values can manageLocations have and what do each of them mean?\nYou can move these values into well defined constants to make the code more readable.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2368#discussion_r542525584", "createdAt": "2020-12-14T16:33:00Z", "author": {"login": "zohrehj"}, "path": "participant-manager/src/app/service/locations.guard.ts", "diffHunk": "@@ -0,0 +1,23 @@\n+import {Injectable} from '@angular/core';\n+import {CanActivate, UrlTree} from '@angular/router';\n+import {UserService} from '../service/user.service';\n+import {Profile} from '../site-coordinator/account/shared/profile.model';\n+\n+@Injectable({\n+  providedIn: 'root',\n+})\n+export class LocationsGuard implements CanActivate {\n+  user = {} as Profile;\n+\n+  constructor(private readonly userService: UserService) {\n+    this.user = this.userService.getUserProfile();\n+  }\n+\n+  canActivate(): boolean | UrlTree {\n+    return (\n+      this.user.superAdmin ||\n+      this.user.manageLocations === 1 ||\n+      this.user.manageLocations === 0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70356cddb64af7dd845cefc4aeacfd063e9328a9"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUzOTY1Mg==", "bodyText": "if manageLocations value is null, it means user has no permissions to manage locations and updated code to check null instead of view or viewAndEdit permission", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2368#discussion_r542539652", "createdAt": "2020-12-14T16:50:43Z", "author": {"login": "firdosebtc1"}, "path": "participant-manager/src/app/service/locations.guard.ts", "diffHunk": "@@ -0,0 +1,23 @@\n+import {Injectable} from '@angular/core';\n+import {CanActivate, UrlTree} from '@angular/router';\n+import {UserService} from '../service/user.service';\n+import {Profile} from '../site-coordinator/account/shared/profile.model';\n+\n+@Injectable({\n+  providedIn: 'root',\n+})\n+export class LocationsGuard implements CanActivate {\n+  user = {} as Profile;\n+\n+  constructor(private readonly userService: UserService) {\n+    this.user = this.userService.getUserProfile();\n+  }\n+\n+  canActivate(): boolean | UrlTree {\n+    return (\n+      this.user.superAdmin ||\n+      this.user.manageLocations === 1 ||\n+      this.user.manageLocations === 0", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUyNTU4NA=="}, "originalCommit": {"oid": "70356cddb64af7dd845cefc4aeacfd063e9328a9"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1411, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}