{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4NzYzMzUz", "number": 1622, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzoyNToxM1rOExNG4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzo1MjozNlrOExNzGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwMDMwNDM0OnYy", "diffSide": "RIGHT", "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzoyNToxM1rOHnNunQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNToxMzoxMlrOHpvKWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4MTQzNw==", "bodyText": "You've used setInteger above for studyId, since we know studyId is an integer please use setInteger in other places as well.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#discussion_r510881437", "createdAt": "2020-10-23T13:25:13Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -166,9 +173,9 @@ public int comprehensionTestQuestionOrder(Integer studyId) {\n       session = hibernateTemplate.getSessionFactory().openSession();\n       query =\n           session.createQuery(\n-              \"From ComprehensionTestQuestionBo CTQBO where CTQBO.studyId=\"\n-                  + studyId\n+              \"From ComprehensionTestQuestionBo CTQBO where CTQBO.studyId=:studyId\"\n                   + \" and CTQBO.active=1 order by CTQBO.sequenceNo desc\");\n+      query.setParameter(\"studyId\", studyId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUyNjM2Mw==", "bodyText": "fixed as suggested way", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#discussion_r513526363", "createdAt": "2020-10-28T15:13:12Z", "author": {"login": "vigneshjbtc"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -166,9 +173,9 @@ public int comprehensionTestQuestionOrder(Integer studyId) {\n       session = hibernateTemplate.getSessionFactory().openSession();\n       query =\n           session.createQuery(\n-              \"From ComprehensionTestQuestionBo CTQBO where CTQBO.studyId=\"\n-                  + studyId\n+              \"From ComprehensionTestQuestionBo CTQBO where CTQBO.studyId=:studyId\"\n                   + \" and CTQBO.active=1 order by CTQBO.sequenceNo desc\");\n+      query.setParameter(\"studyId\", studyId);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4MTQzNw=="}, "originalCommit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "originalPosition": 51}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwMDMyNzU2OnYy", "diffSide": "RIGHT", "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzozMTowNVrOHnN81Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNToxMjo1MlrOHpvJXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4NTA3Nw==", "bodyText": "please remove all commented out code", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#discussion_r510885077", "createdAt": "2020-10-23T13:31:05Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -638,163 +656,358 @@ public String deleteStudyByIdOrCustomstudyId(\n     logger.info(\"StudyDAOImpl - deleteStudyByIdOrCustomstudyId() - Starts\");\n     String message = FdahpStudyDesignerConstants.FAILURE;\n     List<StudyBo> studyBOList = null;\n-    String subQuery = \"\";\n+    // String subQuery = \"\";\n     String studyCustomQuery = \"\";\n     List<Integer> idList = null;\n+    List<String> studyIdList = new ArrayList<>();\n     try {\n+      studyIdList = this.getStudyIdAsList(studyId);\n+\n       if (StringUtils.isNotEmpty(customStudyId)) {\n-        studyCustomQuery = \" FROM StudyBo SBO WHERE SBO.customStudyId ='\" + customStudyId + \"'\";\n-        subQuery = \"(SELECT id FROM studies WHERE custom_study_id='\" + customStudyId + \"')\";\n+        studyCustomQuery = \" FROM StudyBo SBO WHERE SBO.customStudyId =:customStudyId\";\n+        // subQuery = \"(SELECT id FROM studies WHERE custom_study_id=:customStudyId)\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "originalPosition": 272}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUyNjEwOA==", "bodyText": "fixed as suggested", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#discussion_r513526108", "createdAt": "2020-10-28T15:12:52Z", "author": {"login": "vigneshjbtc"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -638,163 +656,358 @@ public String deleteStudyByIdOrCustomstudyId(\n     logger.info(\"StudyDAOImpl - deleteStudyByIdOrCustomstudyId() - Starts\");\n     String message = FdahpStudyDesignerConstants.FAILURE;\n     List<StudyBo> studyBOList = null;\n-    String subQuery = \"\";\n+    // String subQuery = \"\";\n     String studyCustomQuery = \"\";\n     List<Integer> idList = null;\n+    List<String> studyIdList = new ArrayList<>();\n     try {\n+      studyIdList = this.getStudyIdAsList(studyId);\n+\n       if (StringUtils.isNotEmpty(customStudyId)) {\n-        studyCustomQuery = \" FROM StudyBo SBO WHERE SBO.customStudyId ='\" + customStudyId + \"'\";\n-        subQuery = \"(SELECT id FROM studies WHERE custom_study_id='\" + customStudyId + \"')\";\n+        studyCustomQuery = \" FROM StudyBo SBO WHERE SBO.customStudyId =:customStudyId\";\n+        // subQuery = \"(SELECT id FROM studies WHERE custom_study_id=:customStudyId)\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4NTA3Nw=="}, "originalCommit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "originalPosition": 272}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwMDQxNzU0OnYy", "diffSide": "RIGHT", "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzo1MjozNlrOHnOzlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNToxMzozMFrOHpvLVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg5OTA5Mw==", "bodyText": "what exceptions are you expecting here? arryList.add shouldn't throw any.\nI would recommend removing both try/catch blocks in this method.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#discussion_r510899093", "createdAt": "2020-10-23T13:52:36Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -6855,4 +7400,29 @@ public String updateDraftToEditedStatus(\n     logger.info(\"AuditLogDAOImpl - updateDraftToEditedStatus - Ends\");\n     return message;\n   }\n+\n+  public List<String> getStudyIdAsList(String statusId) {\n+    List<String> outputList = new ArrayList<>();\n+    try {\n+      if (!StringUtils.isEmpty(statusId)) {\n+        if (statusId.contains(\",\")) {\n+          String[] statusIdArray = statusId.split(\",\");\n+          for (int i = 0; i < statusIdArray.length; i++) {\n+            try {\n+              outputList.add(statusIdArray[i]);\n+            } catch (Exception e) {\n+              e.printStackTrace();\n+              logger.error(\"AuditLogDAOImpl - getStatusIdAsList -Loop - ERROR\", e);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "originalPosition": 1633}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzUyNjYxNQ==", "bodyText": "removed the try / catch block", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#discussion_r513526615", "createdAt": "2020-10-28T15:13:30Z", "author": {"login": "vigneshjbtc"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -6855,4 +7400,29 @@ public String updateDraftToEditedStatus(\n     logger.info(\"AuditLogDAOImpl - updateDraftToEditedStatus - Ends\");\n     return message;\n   }\n+\n+  public List<String> getStudyIdAsList(String statusId) {\n+    List<String> outputList = new ArrayList<>();\n+    try {\n+      if (!StringUtils.isEmpty(statusId)) {\n+        if (statusId.contains(\",\")) {\n+          String[] statusIdArray = statusId.split(\",\");\n+          for (int i = 0; i < statusIdArray.length; i++) {\n+            try {\n+              outputList.add(statusIdArray[i]);\n+            } catch (Exception e) {\n+              e.printStackTrace();\n+              logger.error(\"AuditLogDAOImpl - getStatusIdAsList -Loop - ERROR\", e);\n+            }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg5OTA5Mw=="}, "originalCommit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "originalPosition": 1633}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1714, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}