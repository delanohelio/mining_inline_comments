{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1NTMzNDgy", "number": 852, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToxNzo0OFrOEeWdeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMjoyODozOVrOEf96Kw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjYwNzI4OnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/UserStatusRequest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToxNzo0OFrOHJ9Grw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxNToxNzoyMVrOHL0Xww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMDM2Nw==", "bodyText": "let's use an enum instead? that would make it more clear what 0 and 1 are at a glance.\nIf you are looking for a boolean behavior, lets change the name to something that indicates that, e.g. active instead of status and change the value to Boolean instead of Integer", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r480200367", "createdAt": "2020-08-31T15:17:48Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/UserStatusRequest.java", "diffHunk": "@@ -0,0 +1,21 @@\n+package com.google.cloud.healthcare.fdamystudies.beans;\n+\n+import javax.validation.constraints.Max;\n+import javax.validation.constraints.Min;\n+import javax.validation.constraints.NotNull;\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Getter\n+@Setter\n+@ToString\n+public class UserStatusRequest {\n+\n+  @Min(0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE1NDQzNQ==", "bodyText": "There is no annotation for validating enum values in Bean Validation built-in constraints. We may need to write custom enum validator or check the value in service layer and throw an ErrorCodeException.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482154435", "createdAt": "2020-09-02T15:17:21Z", "author": {"login": "dhanyak-btc"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/UserStatusRequest.java", "diffHunk": "@@ -0,0 +1,21 @@\n+package com.google.cloud.healthcare.fdamystudies.beans;\n+\n+import javax.validation.constraints.Max;\n+import javax.validation.constraints.Min;\n+import javax.validation.constraints.NotNull;\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Getter\n+@Setter\n+@ToString\n+public class UserStatusRequest {\n+\n+  @Min(0)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMDM2Nw=="}, "originalCommit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAwMjYzNzkyOnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyNTozNlrOHJ9ZMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwNzowMTowMVrOHMYmXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwNTEwNw==", "bodyText": "this does not follow REST URL formats, status is not a resource and it is also not a custom action on the user.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r480205107", "createdAt": "2020-08-31T15:25:36Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}/status\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjE1NTM2OQ==", "bodyText": "We need to update just single field in this API, I referred Rest uri design for changing the status for resource", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482155369", "createdAt": "2020-09-02T15:18:42Z", "author": {"login": "dhanyak-btc"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}/status\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwNTEwNw=="}, "originalCommit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM0NjE1Mw==", "bodyText": "Your solution is a mixture of the two answers, you are status in the URL, so treating it as a resource, but using patch which could have just as easily been called on the user itself.\nthe two solutions are:\nPATCH /users/{user_id}\n{status: \"active\"}\n\nand\nPUT /users/{user_id}/status\n\n\"active\"\n\ndepending on the number of complexity of the status and logic associated with it I would recommend a different option.\nLess complex, option 1, more complex: option 2 which makes it easier to move the complex logic into a UserStatusController.\nIf you are only setting active/deactive, I am not sure this even is suitable for status property. Status has a broad meaning and anyone reading the code would expect it to hold any of the following values:\ncreated, unverified, deactivated, deleted ...\nThis is why it is useful to share your initial thoughts and plans in a doc before starting implementation.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482346153", "createdAt": "2020-09-02T19:33:59Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}/status\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwNTEwNw=="}, "originalCommit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjc0Nzk5Ng==", "bodyText": "Thanks @zohrehj for the two solutions. I've asked @Kantharajut-btc to change the endpoint as below:\nPATCH /users/{user_id}\n{status: 0}\n\nTeam is trying to remove the blockers for angular/mobile app teams during integration so we are making the code changes and then address any review comments. I totally agree with you, this is not the best practice to follow in future releases/tracks.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482747996", "createdAt": "2020-09-03T07:01:01Z", "author": {"login": "dhanyak-btc"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}/status\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwNTEwNw=="}, "originalCommit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTU0ODUzOnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMjoyNjozNlrOHMkNAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMzowMDo1OFrOHMleyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzODExNA==", "bodyText": "should this be a more generic request then? since we can in future add more fields here.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482938114", "createdAt": "2020-09-03T12:26:36Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}\",\n       consumes = MediaType.APPLICATION_JSON_VALUE,\n       produces = MediaType.APPLICATION_JSON_VALUE)\n-  public ResponseEntity<DeactivateAccountResponse> deactivateAccount(\n-      @PathVariable String userId, HttpServletRequest request) {\n-\n+  public ResponseEntity<UserAccountStatusResponse> updateUserAccountStatus(\n+      @PathVariable String userId,\n+      @Valid @RequestBody UserStatusRequest statusRequest,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjk1OTA1MA==", "bodyText": "renamed to PatchUserRequest", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482959050", "createdAt": "2020-09-03T13:00:58Z", "author": {"login": "Kantharajut-btc"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}\",\n       consumes = MediaType.APPLICATION_JSON_VALUE,\n       produces = MediaType.APPLICATION_JSON_VALUE)\n-  public ResponseEntity<DeactivateAccountResponse> deactivateAccount(\n-      @PathVariable String userId, HttpServletRequest request) {\n-\n+  public ResponseEntity<UserAccountStatusResponse> updateUserAccountStatus(\n+      @PathVariable String userId,\n+      @Valid @RequestBody UserStatusRequest statusRequest,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzODExNA=="}, "originalCommit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTU1MTM1OnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMjoyNzoxN1rOHMkOpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMzowMDozMVrOHMldnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzODUzMw==", "bodyText": "please rename. deactivateResponse is no longer accurate.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482938533", "createdAt": "2020-09-03T12:27:17Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}\",\n       consumes = MediaType.APPLICATION_JSON_VALUE,\n       produces = MediaType.APPLICATION_JSON_VALUE)\n-  public ResponseEntity<DeactivateAccountResponse> deactivateAccount(\n-      @PathVariable String userId, HttpServletRequest request) {\n-\n+  public ResponseEntity<UserAccountStatusResponse> updateUserAccountStatus(\n+      @PathVariable String userId,\n+      @Valid @RequestBody UserStatusRequest statusRequest,\n+      HttpServletRequest request) {\n     logger.entry(String.format(BEGIN_REQUEST_LOG, request.getRequestURI()));\n \n-    DeactivateAccountResponse deactivateResponse = userProfileService.deactivateAccount(userId);\n+    statusRequest.setUserId(userId);\n+    UserAccountStatusResponse deactivateResponse =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjk1ODc1MQ==", "bodyText": "renamed to PatchUserResponse", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482958751", "createdAt": "2020-09-03T13:00:31Z", "author": {"login": "Kantharajut-btc"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}\",\n       consumes = MediaType.APPLICATION_JSON_VALUE,\n       produces = MediaType.APPLICATION_JSON_VALUE)\n-  public ResponseEntity<DeactivateAccountResponse> deactivateAccount(\n-      @PathVariable String userId, HttpServletRequest request) {\n-\n+  public ResponseEntity<UserAccountStatusResponse> updateUserAccountStatus(\n+      @PathVariable String userId,\n+      @Valid @RequestBody UserStatusRequest statusRequest,\n+      HttpServletRequest request) {\n     logger.entry(String.format(BEGIN_REQUEST_LOG, request.getRequestURI()));\n \n-    DeactivateAccountResponse deactivateResponse = userProfileService.deactivateAccount(userId);\n+    statusRequest.setUserId(userId);\n+    UserAccountStatusResponse deactivateResponse =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzODUzMw=="}, "originalCommit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTU1NjI3OnYy", "diffSide": "RIGHT", "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/common/ApiEndpoint.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMjoyODozOVrOHMkRpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMjo1OTozNFrOHMlbDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzOTMwMw==", "bodyText": "why not user PATCH_USER?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482939303", "createdAt": "2020-09-03T12:28:39Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/common/ApiEndpoint.java", "diffHunk": "@@ -20,7 +20,7 @@\n \n   SET_UP_ACCOUNT(\"http://localhost:8080/participant-manager-service/users/\"),\n \n-  DEACTIVATE_ACCOUNT(\"http://localhost:8080/participant-manager-service/users/{userId}/deactivate\"),\n+  UPDATE_USER_STATUS(\"http://localhost:8080/participant-manager-service/users/{userId}\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjk1ODA5NQ==", "bodyText": "renamed to PATCH_USER", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482958095", "createdAt": "2020-09-03T12:59:34Z", "author": {"login": "Kantharajut-btc"}, "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/common/ApiEndpoint.java", "diffHunk": "@@ -20,7 +20,7 @@\n \n   SET_UP_ACCOUNT(\"http://localhost:8080/participant-manager-service/users/\"),\n \n-  DEACTIVATE_ACCOUNT(\"http://localhost:8080/participant-manager-service/users/{userId}/deactivate\"),\n+  UPDATE_USER_STATUS(\"http://localhost:8080/participant-manager-service/users/{userId}\"),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzOTMwMw=="}, "originalCommit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1916, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}