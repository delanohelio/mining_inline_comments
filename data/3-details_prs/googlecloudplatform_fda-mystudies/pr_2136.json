{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2NDcxMDI2", "number": 2136, "title": "[participant-manager-datastore] : Fixed issue #2106", "bodyText": "Added @RequestParam(required = false) String[] excludeEnrollmentStatus, where front end team will send status which is not to be display(yetToJoin and notEligible).\nWritten Test Case.", "createdAt": "2020-11-24T13:14:23Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2136", "merged": true, "mergeCommit": {"oid": "35f7555c5112265c6aadccc0e87682c5aa0f35fd"}, "closed": true, "closedAt": "2020-12-03T09:45:23Z", "author": {"login": "Kantharajut-btc"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfpYlhgH2gAyNTI2NDcxMDI2OjliNGVjZDA2MDBmMDRmYmU0NTYyMDQ1MGEzNThlYTkwNTE5MmY3NWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdif6o5AH2gAyNTI2NDcxMDI2OjZmNWFhMTNhMzFiZjcyZWVmZjA4ZWQ2OTAzMDZlNDg0NmMzMmEyOWQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9b4ecd0600f04fbe45620450a358ea905192f75e", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9b4ecd0600f04fbe45620450a358ea905192f75e", "committedDate": "2020-11-24T13:01:51Z", "message": "Fixed issue #2106\n\nFixed issue #2106"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cb8283308cf2a0a7353503f1328a9110e87393f", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3cb8283308cf2a0a7353503f1328a9110e87393f", "committedDate": "2020-11-24T13:12:21Z", "message": "added test case\n\nadded test case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NzcwMDg1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2136#pullrequestreview-537770085", "createdAt": "2020-11-24T17:56:57Z", "commit": {"oid": "3cb8283308cf2a0a7353503f1328a9110e87393f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNzo1Njo1OFrOH5Op0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNzo1Njo1OFrOH5Op0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTc3MDk2MQ==", "bodyText": "Shouldn't we have a test here for when excludeEnrollmentStatus includes notEligible and yetToEnroll and check for empty array being returned instead", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2136#discussion_r529770961", "createdAt": "2020-11-24T17:56:58Z", "author": {"login": "saminguyen"}, "path": "participant-manager-datastore/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/SiteControllerTest.java", "diffHunk": "@@ -710,6 +710,33 @@ public void shouldReturnSiteParticipantsForDisabled() throws Exception {\n     verifyTokenIntrospectRequest();\n   }\n \n+  @Test\n+  public void shouldNotReturnSiteParticipantsForNotEligible() throws Exception {\n+    siteEntity = testDataHelper.createSiteEntity(studyEntity, userRegAdminEntity, appEntity);\n+    participantRegistrySiteEntity =\n+        testDataHelper.createParticipantRegistrySite(siteEntity, studyEntity);\n+\n+    participantStudyEntity.setStatus(\"notEligible\");\n+    testDataHelper.getParticipantStudyRepository().saveAndFlush(participantStudyEntity);\n+    HttpHeaders headers = testDataHelper.newCommonHeaders();\n+    headers.add(USER_ID_HEADER, userRegAdminEntity.getId());\n+\n+    mockMvc\n+        .perform(\n+            get(ApiEndpoint.GET_SITE_PARTICIPANTS.getPath(), siteEntity.getId())\n+                .headers(headers)\n+                .contextPath(getContextPath()))\n+        .andDo(print())\n+        .andExpect(status().isOk())\n+        .andExpect(jsonPath(\"$.participantRegistryDetail.registryParticipants\").isArray())\n+        .andExpect(\n+            jsonPath(\n+                \"$.participantRegistryDetail.registryParticipants[0].enrollmentStatus\",\n+                is(CommonConstants.YET_TO_ENROLL)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3cb8283308cf2a0a7353503f1328a9110e87393f"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a84a3ec319583032e70f3ec72adfa71ba4bf1580", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a84a3ec319583032e70f3ec72adfa71ba4bf1580", "committedDate": "2020-11-25T16:44:35Z", "message": "Fixed PR comment\n\nFixed PR comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49abdcc7c427955c2ecabc58342c8f7b89b8ced8", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/49abdcc7c427955c2ecabc58342c8f7b89b8ced8", "committedDate": "2020-11-25T16:45:06Z", "message": "Merge branch 'develop' into participant-manager-issue-2106"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7195e723c0169e8cb84eabc6925f7339b0f9165", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e7195e723c0169e8cb84eabc6925f7339b0f9165", "committedDate": "2020-12-01T05:35:52Z", "message": "Merge branch 'develop' into participant-manager-issue-2106"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMTUwNDgx", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2136#pullrequestreview-542150481", "createdAt": "2020-12-01T17:48:32Z", "commit": {"oid": "e7195e723c0169e8cb84eabc6925f7339b0f9165"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNzo0ODozMlrOH84seg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxNzo0ODozMlrOH84seg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzYwNTQ5OA==", "bodyText": "verify array size to show clearly that the enrollment status got excluded", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2136#discussion_r533605498", "createdAt": "2020-12-01T17:48:32Z", "author": {"login": "saminguyen"}, "path": "participant-manager-datastore/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/SiteControllerTest.java", "diffHunk": "@@ -725,14 +726,11 @@ public void shouldNotReturnSiteParticipantsForNotEligible() throws Exception {\n         .perform(\n             get(ApiEndpoint.GET_SITE_PARTICIPANTS.getPath(), siteEntity.getId())\n                 .headers(headers)\n+                .queryParam(\"excludeEnrollmentStatus\", \"notEligible\", \"yetToJoin \")\n                 .contextPath(getContextPath()))\n         .andDo(print())\n         .andExpect(status().isOk())\n-        .andExpect(jsonPath(\"$.participantRegistryDetail.registryParticipants\").isArray())\n-        .andExpect(\n-            jsonPath(\n-                \"$.participantRegistryDetail.registryParticipants[0].enrollmentStatus\",\n-                is(CommonConstants.YET_TO_ENROLL)));\n+        .andExpect(jsonPath(\"$.participantRegistryDetail.registryParticipants\").isArray());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7195e723c0169e8cb84eabc6925f7339b0f9165"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07a8dc299400f3ddadeec61d3b83de763b198eff", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/07a8dc299400f3ddadeec61d3b83de763b198eff", "committedDate": "2020-12-02T06:27:21Z", "message": "Fixed PR comments\n\nFixed PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "100a0430f00930e442eafa0b9bbf8d198340e7f6", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/100a0430f00930e442eafa0b9bbf8d198340e7f6", "committedDate": "2020-12-02T06:29:56Z", "message": "Merge branch 'develop' into participant-manager-issue-2106"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyOTQxMDkz", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2136#pullrequestreview-542941093", "createdAt": "2020-12-02T15:17:36Z", "commit": {"oid": "100a0430f00930e442eafa0b9bbf8d198340e7f6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f5aa13a31bf72eeff08ed690306e4846c32a29d", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6f5aa13a31bf72eeff08ed690306e4846c32a29d", "committedDate": "2020-12-03T09:41:46Z", "message": "Merge branch 'develop' into participant-manager-issue-2106"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1237, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}