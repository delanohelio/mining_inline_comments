{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyOTM0MzI5", "number": 1744, "title": "SQL injection Fixes for remaining line of code in StudyDAOImpl.java", "bodyText": "SQL injection Fixes for remaining line of code in StudyDAOImpl.java", "createdAt": "2020-10-30T11:31:33Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744", "merged": true, "mergeCommit": {"oid": "82ff2eab8292ba53348bef1f18cdb6e85065e0d5"}, "closed": true, "closedAt": "2020-11-02T15:28:25Z", "author": {"login": "vigneshjbtc"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXlFY4AH2gAyNTEyOTM0MzI5OjljYzc2Yzg0NDQzNjg2N2U4NjJiMmMxYzBiZDkwZTdlNjE4MjNmODM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYmRBQAH2gAyNTEyOTM0MzI5OmViOGI4MjIzNzYyZDhkMTVjZjQzNjBmMjVmMTFiYjNmODQ4ZTY4NWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83", "author": {"user": {"login": "vigneshjbtc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9cc76c844436867e862b2c1c0bd90e7e61823f83", "committedDate": "2020-10-30T11:29:52Z", "message": "SQL injection Fixes for remaining line of code in StudyDAOImpl.java\n\nSQL injection Fixes for remaining line of code in StudyDAOImpl.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwNzA0NTc2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#pullrequestreview-520704576", "createdAt": "2020-10-30T14:10:00Z", "commit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNDoxMDowMFrOHrQx0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNTowOTo0MVrOHrTY7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEyNTcxMw==", "bodyText": "please remove commented code", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515125713", "createdAt": "2020-10-30T14:10:00Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -2890,12 +2851,17 @@ public boolean resetDraftStudyByCustomStudyId(\n         String permissionQuery =\n             \"select s.user_id,s.view_permission\"\n                 + \" from study_permission s, user_permission_mapping u, user_permissions p\"\n-                + \" where s.study_id=\"\n-                + liveStudyBo.getId()\n+                + \" where s.study_id= :id\"\n+                //                + liveStudyBo.getId()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 392}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEyNjI0OQ==", "bodyText": ":liveStudyBo.getId()  should be :id", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515126249", "createdAt": "2020-10-30T14:10:52Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -2923,7 +2889,8 @@ public boolean resetDraftStudyByCustomStudyId(\n         session.save(studySequenceBo);\n \n         // Over View\n-        query = session.createQuery(\"from StudyPageBo where studyId=\" + liveStudyBo.getId());\n+        query = session.createQuery(\"from StudyPageBo where studyId= :liveStudyBo.getId() \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 411}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTEyNjY2Mw==", "bodyText": "please remove", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515126663", "createdAt": "2020-10-30T14:11:30Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -3029,10 +2994,13 @@ public boolean resetDraftStudyByCustomStudyId(\n                   .getFrequency()\n                   .equalsIgnoreCase(FdahpStudyDesignerConstants.FREQUENCY_TYPE_MANUALLY_SCHEDULE)) {\n                 searchQuery =\n-                    \"From QuestionnaireCustomScheduleBo QCSBO where QCSBO.questionnairesId=\"\n-                        + questionnaireBo.getId();\n+                    \"From QuestionnaireCustomScheduleBo QCSBO where QCSBO.questionnairesId=:id\";\n+                //                        + questionnaireBo.getId();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 448}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE2MjMwNA==", "bodyText": "please remove all commented code", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515162304", "createdAt": "2020-10-30T15:00:09Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -6975,25 +6891,48 @@ public boolean validateAppId(String customStudyId, String appId, String studyTyp\n     Session session = null;\n     List<StudyBo> studyBos = null;\n     String searchQuery = \"\";\n-    String subQry = \"\";\n+    // String subQry = \"\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 1675}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE2MjQ0Mg==", "bodyText": "same here", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515162442", "createdAt": "2020-10-30T15:00:18Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -6975,25 +6891,48 @@ public boolean validateAppId(String customStudyId, String appId, String studyTyp\n     Session session = null;\n     List<StudyBo> studyBos = null;\n     String searchQuery = \"\";\n-    String subQry = \"\";\n+    // String subQry = \"\";\n     try {\n       session = hibernateTemplate.getSessionFactory().openSession();\n       if (!studyType.isEmpty() && !appId.isEmpty()) {\n-        if (StringUtils.isNotEmpty(customStudyId)) {\n-          subQry = \" and customStudyId!='\" + customStudyId + \"'\";\n-        }\n+        //        if (StringUtils.isNotEmpty(customStudyId)) {\n+        //          subQry = \" and customStudyId!=:customStudyId\";\n+        //        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 1684}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE2NDA0OQ==", "bodyText": "remove", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515164049", "createdAt": "2020-10-30T15:02:47Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -7143,29 +7088,40 @@ public String updateDraftToEditedStatus(\n       }\n       if ((userId != null) && (studyId != null)) {\n         if ((actionType != null) && (FdahpStudyDesignerConstants.DRAFT_STUDY).equals(actionType)) {\n-          draftColumn = \"hasStudyDraft = 1\";\n+          // draftColumn = \"hasStudyDraft = 1\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 1785}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE2NDI3NA==", "bodyText": "same her, please clean these comments", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515164274", "createdAt": "2020-10-30T15:03:09Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -7143,29 +7088,40 @@ public String updateDraftToEditedStatus(\n       }\n       if ((userId != null) && (studyId != null)) {\n         if ((actionType != null) && (FdahpStudyDesignerConstants.DRAFT_STUDY).equals(actionType)) {\n-          draftColumn = \"hasStudyDraft = 1\";\n+          // draftColumn = \"hasStudyDraft = 1\";\n+          queryString =\n+              \" Update StudyBo set hasStudyDraft = 1 , modifiedBy =:userId , modifiedOn = now() where id = :studyId \";\n         } else if ((actionType != null)\n             && (FdahpStudyDesignerConstants.DRAFT_QUESTIONNAIRE).equals(actionType)) {\n-          draftColumn = \"hasQuestionnaireDraft = 1, hasStudyDraft = 1 \";\n+          //          draftColumn = \"hasQuestionnaireDraft = 1, hasStudyDraft = 1 \";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 1791}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE2NjAwNQ==", "bodyText": "remove all this commented code please", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515166005", "createdAt": "2020-10-30T15:05:45Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -7143,29 +7088,40 @@ public String updateDraftToEditedStatus(\n       }\n       if ((userId != null) && (studyId != null)) {\n         if ((actionType != null) && (FdahpStudyDesignerConstants.DRAFT_STUDY).equals(actionType)) {\n-          draftColumn = \"hasStudyDraft = 1\";\n+          // draftColumn = \"hasStudyDraft = 1\";\n+          queryString =\n+              \" Update StudyBo set hasStudyDraft = 1 , modifiedBy =:userId , modifiedOn = now() where id = :studyId \";\n         } else if ((actionType != null)\n             && (FdahpStudyDesignerConstants.DRAFT_QUESTIONNAIRE).equals(actionType)) {\n-          draftColumn = \"hasQuestionnaireDraft = 1, hasStudyDraft = 1 \";\n+          //          draftColumn = \"hasQuestionnaireDraft = 1, hasStudyDraft = 1 \";\n+          queryString =\n+              \" Update StudyBo set hasQuestionnaireDraft = 1, hasStudyDraft = 1  , modifiedBy =:userId , modifiedOn = now() where id = :studyId \";\n         } else if ((actionType != null)\n             && (FdahpStudyDesignerConstants.DRAFT_ACTIVETASK).equals(actionType)) {\n-          draftColumn = \"hasActivetaskDraft = 1, hasStudyDraft = 1 \";\n+          //          draftColumn = \"hasActivetaskDraft = 1, hasStudyDraft = 1 \";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 1797}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE2Nzc4NA==", "bodyText": "please remove input.contains(\",\") check.\nWith this condition your method will return an empty list even if the input string contains a single element.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515167784", "createdAt": "2020-10-30T15:08:40Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -7201,4 +7157,15 @@ public String updateDraftToEditedStatus(\n     }\n     return outputList;\n   }\n+\n+  public List<String> convertStringToList(String input) {\n+    List<String> outputList = new ArrayList<>();\n+    if (!StringUtils.isEmpty(input) && input.contains(\",\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 1843}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE2ODQ5Mg==", "bodyText": "please rename this to something more generic, e.g. itemArray. StatusIdArray assumes that input contains list of statusIds.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#discussion_r515168492", "createdAt": "2020-10-30T15:09:41Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -7201,4 +7157,15 @@ public String updateDraftToEditedStatus(\n     }\n     return outputList;\n   }\n+\n+  public List<String> convertStringToList(String input) {\n+    List<String> outputList = new ArrayList<>();\n+    if (!StringUtils.isEmpty(input) && input.contains(\",\")) {\n+      String[] statusIdArray = input.split(\",\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9cc76c844436867e862b2c1c0bd90e7e61823f83"}, "originalPosition": 1844}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85c16464c6935db347af242ce2098f280a47e3f0", "author": {"user": {"login": "vigneshjbtc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/85c16464c6935db347af242ce2098f280a47e3f0", "committedDate": "2020-11-02T07:24:38Z", "message": "All the issue has been fixed it.\n\nAll the issue has been fixed it."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNjM5NTg1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1744#pullrequestreview-521639585", "createdAt": "2020-11-02T13:45:35Z", "commit": {"oid": "85c16464c6935db347af242ce2098f280a47e3f0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb8b8223762d8d15cf4360f25f11bb3f848e685f", "author": {"user": {"login": "aswinijena100", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/eb8b8223762d8d15cf4360f25f11bb3f848e685f", "committedDate": "2020-11-02T15:26:24Z", "message": "Merge branch 'develop' into Sql_injection_part2_from_2000_line_onwards"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1371, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}