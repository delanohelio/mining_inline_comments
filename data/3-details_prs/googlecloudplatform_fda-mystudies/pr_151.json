{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzOTAyOTU5", "number": 151, "title": "add bastion service account as sql client", "bodyText": "https://cloud.google.com/sql/docs/mysql/connect-compute-engine#gce-connect-proxy", "createdAt": "2020-04-15T17:50:45Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151", "merged": true, "mergeCommit": {"oid": "ce8f72780ad4bd406cb238f9c463e8fd9048d332"}, "closed": true, "closedAt": "2020-04-15T20:48:21Z", "author": {"login": "umairidris"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcX72TPgH2gAyNDAzOTAyOTU5OjZhZmVkN2I1OWMyMTE4NGZkNThiZDA0OWNjZjFjNDBhNWQ5OTQxNTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcX-TIWgFqTM5NDExODkzOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6afed7b59c21184fd58bd049ccf1c40a5d994159", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6afed7b59c21184fd58bd049ccf1c40a5d994159", "committedDate": "2020-04-15T17:50:03Z", "message": "add bastion service account as sql client"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51e02753dfdbc741e713232071e2f07d470846bf", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/51e02753dfdbc741e713232071e2f07d470846bf", "committedDate": "2020-04-15T17:51:34Z", "message": "fix var"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MDA0MTk1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#pullrequestreview-394004195", "createdAt": "2020-04-15T17:54:21Z", "commit": {"oid": "51e02753dfdbc741e713232071e2f07d470846bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo1NDoyMVrOGGFEbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo1NDoyMVrOGGFEbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyNzY5Mw==", "bodyText": "Can you update the connect instruction above as well? Proxy wasn't necessary when I try to connect from bastion using mysql", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#discussion_r409027693", "createdAt": "2020-04-15T17:54:21Z", "author": {"login": "xingao267"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-networks/networks/bastion.tf", "diffHunk": "@@ -26,14 +26,15 @@ module \"bastion\" {\n   subnet         = module.private.subnets[\"${var.region}/${local.bastion_subnet_name}\"].self_link\n   image_family   = \"ubuntu-1804-lts\"\n   members        = var.bastion_users\n+  scopes         = [\n+    \"https://www.googleapis.com/auth/sqlservice.admin\",\n+  ]\n   startup_script = <<EOF\n #!/bin/bash\n-if dpkg -l mysql-client-core-5.7; then\n-  echo \"mysql-client already installed\"\n-else\n-  sudo apt-get -y update\n-  sudo apt-get -y install mysql-client-core-5.7\n-fi\n+sudo apt-get -y update\n+sudo apt-get -y install mysql-client-core-5.7\n+wget https://dl.google.com/cloudsql/cloud_sql_proxy.linux.amd64 -O cloud_sql_proxy", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51e02753dfdbc741e713232071e2f07d470846bf"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MDA1MjI4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#pullrequestreview-394005228", "createdAt": "2020-04-15T17:55:44Z", "commit": {"oid": "51e02753dfdbc741e713232071e2f07d470846bf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo1NTo0NFrOGGFHzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQxNzo1NTo0NFrOGGFHzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTAyODU1Ng==", "bodyText": "maybe sql_client_service_accounts to be clear they should only be SAs.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#discussion_r409028556", "createdAt": "2020-04-15T17:55:44Z", "author": {"login": "xingao267"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/iam/variables.tf", "diffHunk": "@@ -2,8 +2,7 @@ variable \"project_id\" {\n   type = string\n }\n \n-variable \"gke_service_account\" {\n-  description = \"The service account used by the GKE cluster\"\n-  type        = string\n+variable \"sql_clients\" {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51e02753dfdbc741e713232071e2f07d470846bf"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54b289f919b1cbded56d600b4c0378a362fda8f3", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/54b289f919b1cbded56d600b4c0378a362fda8f3", "committedDate": "2020-04-15T18:02:06Z", "message": "update sql connectionon instructions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4661312a33de7a07790466fa64d956982824cdc8", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/4661312a33de7a07790466fa64d956982824cdc8", "committedDate": "2020-04-15T18:03:42Z", "message": "rename sql_clients to sql_client_service_accounts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MDI2MzA3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#pullrequestreview-394026307", "createdAt": "2020-04-15T18:25:12Z", "commit": {"oid": "4661312a33de7a07790466fa64d956982824cdc8"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97ce05400fd660c31d892c2580c2a66d6993a9fa", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/97ce05400fd660c31d892c2580c2a66d6993a9fa", "committedDate": "2020-04-15T19:24:50Z", "message": "fix gke apps terragrunt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd2ac0dcef02ca8a8ed5bdacfcf68c6c8cdcd3ad", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/dd2ac0dcef02ca8a8ed5bdacfcf68c6c8cdcd3ad", "committedDate": "2020-04-15T20:35:46Z", "message": "Merge branch 'terraform' into bastion_sql"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6eb3458f5b4f52271e66a62d312e76b4a9a7444", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e6eb3458f5b4f52271e66a62d312e76b4a9a7444", "committedDate": "2020-04-15T20:39:45Z", "message": "fmt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54c3eaf839ec11528f62498eeeadf5138f091cbb", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/54c3eaf839ec11528f62498eeeadf5138f091cbb", "committedDate": "2020-04-15T20:39:52Z", "message": "Merge branch 'bastion_sql' of https://github.com/GoogleCloudPlatform/fda-mystudies into bastion_sql"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MTE4OTM4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/151#pullrequestreview-394118938", "createdAt": "2020-04-15T20:41:22Z", "commit": {"oid": "54c3eaf839ec11528f62498eeeadf5138f091cbb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1309, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}