{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MjY3NjYx", "number": 79, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjo0Njo1N1rODudUsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNzoyMDowM1rODueccw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMDQxNTIxOnYy", "diffSide": "RIGHT", "path": "auth-server-ws/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/AuthenticationController.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjo0Njo1N1rOGAdqsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjoxNjo1M1rOGCAtSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzEzOTI1MQ==", "bodyText": "why is this an error log? it doesn't contain an exception message, so it's confusing to log it as error.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r403139251", "createdAt": "2020-04-03T16:46:57Z", "author": {"login": "zohrehj"}, "path": "auth-server-ws/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/AuthenticationController.java", "diffHunk": "@@ -1011,7 +1014,7 @@ private AuthServerRegistrationResponse prepareSuccessResponse(\n       responseBean.setMessage(ErrorCode.EC_113.errorMessage());\n       return new ResponseEntity<>(responseBean, HttpStatus.BAD_REQUEST);\n     }\n-    logger.info(\"AuthenticationController forgotPassword() - Ends \");\n+    logger.error(\"AuthenticationController forgotPassword() - Ends \");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc2MTkyOQ==", "bodyText": "We will fix this in the next PR", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r404761929", "createdAt": "2020-04-07T12:16:53Z", "author": {"login": "aswinijena100"}, "path": "auth-server-ws/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/AuthenticationController.java", "diffHunk": "@@ -1011,7 +1014,7 @@ private AuthServerRegistrationResponse prepareSuccessResponse(\n       responseBean.setMessage(ErrorCode.EC_113.errorMessage());\n       return new ResponseEntity<>(responseBean, HttpStatus.BAD_REQUEST);\n     }\n-    logger.info(\"AuthenticationController forgotPassword() - Ends \");\n+    logger.error(\"AuthenticationController forgotPassword() - Ends \");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzEzOTI1MQ=="}, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 69}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMDQyMDQ0OnYy", "diffSide": "RIGHT", "path": "auth-server-ws/src/main/java/com/google/cloud/healthcare/fdamystudies/utils/MyStudiesUserRegUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjo0ODozMlrOGAdt_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNjozMDoxMlrOGBJZ7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE0MDA5NA==", "bodyText": "This error message does not give any more context to the user, and is not actionable.\nI think what the bug wants is a clear actionable message telling user what the issue is and how they can resolve it.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r403140094", "createdAt": "2020-04-03T16:48:32Z", "author": {"login": "zohrehj"}, "path": "auth-server-ws/src/main/java/com/google/cloud/healthcare/fdamystudies/utils/MyStudiesUserRegUtil.java", "diffHunk": "@@ -52,7 +52,8 @@\n     EMAIL_ID_VERIFIED(\"EmailId has already verified\"),\n     INVALID_CLIENTID_OR_SECRET_KEY(\"Invalid Client Id or Secret Key\"),\n     INVALID_CLIENT_TOKEN(\"Invalid client token\"),\n-    SYSTEM_ERROR_FOUND(\"System error found\"),\n+    SYSTEM_ERROR_FOUND(\n+        \"Sorry, an error has occurred and your request could not be processed. Please try again later.\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg1NTg1Mw==", "bodyText": "We r logging this error whenever there will a system level error/exception like database down,etc . For which there won't be any actionable from the user's prospective , hence the generic message. However please let us know what should be the message in such scenarios when there is system failure .", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r403855853", "createdAt": "2020-04-06T06:30:12Z", "author": {"login": "aswinijena100"}, "path": "auth-server-ws/src/main/java/com/google/cloud/healthcare/fdamystudies/utils/MyStudiesUserRegUtil.java", "diffHunk": "@@ -52,7 +52,8 @@\n     EMAIL_ID_VERIFIED(\"EmailId has already verified\"),\n     INVALID_CLIENTID_OR_SECRET_KEY(\"Invalid Client Id or Secret Key\"),\n     INVALID_CLIENT_TOKEN(\"Invalid client token\"),\n-    SYSTEM_ERROR_FOUND(\"System error found\"),\n+    SYSTEM_ERROR_FOUND(\n+        \"Sorry, an error has occurred and your request could not be processed. Please try again later.\"),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE0MDA5NA=="}, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMDQyNTQ3OnYy", "diffSide": "RIGHT", "path": "response-server-ws/src/main/java/com/google/cloud/healthcare/fdamystudies/service/CommonServiceImpl.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjo1MDowMlrOGAdxNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjo1MDowMlrOGAdxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE0MDkxOQ==", "bodyText": "If this exception is related to user credential, why is it throwing a systemException?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r403140919", "createdAt": "2020-04-03T16:50:02Z", "author": {"login": "zohrehj"}, "path": "response-server-ws/src/main/java/com/google/cloud/healthcare/fdamystudies/service/CommonServiceImpl.java", "diffHunk": "@@ -77,16 +77,16 @@ public boolean validateServerClientCredentials(String clientId, String clientSec\n       logger.error(\"ERROR: \", e);\n \n       if (e.getRawStatusCode() == 401) {\n-        logger.error(\"Invalid client Id or client secret.\");\n+        logger.error(\"Invalid client credentials.\");\n         throw new UnAuthorizedRequestException();\n       } else if (e.getRawStatusCode() == 400) {\n-        logger.error(\"Client verification ended with Bad Request\");\n+        logger.error(\"Client credentials verification error.\");\n         throw new InvalidRequestException();\n       } else {\n         throw new SystemException();\n       }\n     }\n-    logger.error(\"Invalid client Id or client secret.\");\n+    logger.error(\"Invalid client credentials.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMDQzMDUxOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/VerifyEmailIdController.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjo1MTozOFrOGAd0cQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxMjoxNjowMVrOGCArYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE0MTc0NQ==", "bodyText": "this would also remove spaces in the middle of a token, why not use trim()?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r403141745", "createdAt": "2020-04-03T16:51:38Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/VerifyEmailIdController.java", "diffHunk": "@@ -75,8 +75,9 @@\n       return new ResponseEntity<>(verifyEmailIdResponse, HttpStatus.BAD_REQUEST);\n     }\n     try {\n-      VerifyCodeResponse serviceResult =\n-          userDetailsService.verifyCode(verificationForm.getCode(), userId);\n+      verificationCode =\n+          verificationForm.getCode().replaceAll(\"\\\\s\", \"\"); // trim the surrounding whitespace.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDc2MTQ0MQ==", "bodyText": "In the current implementation random generated token does not have space in between hence I added replaceAll method instead of  trim. However will fix this issue by adding trim() .", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r404761441", "createdAt": "2020-04-07T12:16:01Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/VerifyEmailIdController.java", "diffHunk": "@@ -75,8 +75,9 @@\n       return new ResponseEntity<>(verifyEmailIdResponse, HttpStatus.BAD_REQUEST);\n     }\n     try {\n-      VerifyCodeResponse serviceResult =\n-          userDetailsService.verifyCode(verificationForm.getCode(), userId);\n+      verificationCode =\n+          verificationForm.getCode().replaceAll(\"\\\\s\", \"\"); // trim the surrounding whitespace.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE0MTc0NQ=="}, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMDQzMjU0OnYy", "diffSide": "LEFT", "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/StudiesDaoImpl.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNjo1MjoxN1rOGAd1yA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNjozMToyN1rOGBJbeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE0MjA4OA==", "bodyText": "why was this code removed?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r403142088", "createdAt": "2020-04-03T16:52:17Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/StudiesDaoImpl.java", "diffHunk": "@@ -215,61 +211,4 @@ private void decommisionSiteFromStudy(Session session, Integer studyId) {\n     }\n     logger.info(\"StudiesDaoImpl - decommisionSiteFromStudy() : ends\");\n   }\n-\n-  @Override\n-  public String withdrawFromStudy(String participantId, String studyId, boolean delete) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg1NjI1MA==", "bodyText": "Same piece of  code were duplicated under 2 bundles , hence removed .", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r403856250", "createdAt": "2020-04-06T06:31:27Z", "author": {"login": "aswinijena100"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/StudiesDaoImpl.java", "diffHunk": "@@ -215,61 +211,4 @@ private void decommisionSiteFromStudy(Session session, Integer studyId) {\n     }\n     logger.info(\"StudiesDaoImpl - decommisionSiteFromStudy() : ends\");\n   }\n-\n-  @Override\n-  public String withdrawFromStudy(String participantId, String studyId, boolean delete) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE0MjA4OA=="}, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMDU5ODkxOnYy", "diffSide": "RIGHT", "path": "WCP-WS/src/main/resources/authorizationResource.properties", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxNzoyMDowM1rOGAfQ0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNjozODozNlrOGBJlxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE2NTM5Mw==", "bodyText": "I am not clear as to how this works? given that the key seems to be on the right and value on left?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r403165393", "createdAt": "2020-04-03T17:20:03Z", "author": {"login": "zohrehj"}, "path": "WCP-WS/src/main/resources/authorizationResource.properties", "diffHunk": "@@ -1,8 +1,9 @@\n ############################# AUTHORIZATION DETAILS #############################\n \n-83d92ad3-ec27-424b-af92-fa7aa9a88c7b=labkey.apptoken\n-com.labkey.fda=labkey.bundleid\n-83d92ad3-ec27-424b-af92-fa7aa9a88c7b_com.labkey.fda=\n+83d92ad3-ec27-424b-af92-fa7aa9a88c7b=responseserver.apptoken", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg1ODg4NQ==", "bodyText": "In the existing FDA open implementation similar way properties are getting read by the application. Technically it is reading all properties and put all the values in a Map object and later on it is checking whether sent value is exist or not in the Map.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/79#discussion_r403858885", "createdAt": "2020-04-06T06:38:36Z", "author": {"login": "aswinijena100"}, "path": "WCP-WS/src/main/resources/authorizationResource.properties", "diffHunk": "@@ -1,8 +1,9 @@\n ############################# AUTHORIZATION DETAILS #############################\n \n-83d92ad3-ec27-424b-af92-fa7aa9a88c7b=labkey.apptoken\n-com.labkey.fda=labkey.bundleid\n-83d92ad3-ec27-424b-af92-fa7aa9a88c7b_com.labkey.fda=\n+83d92ad3-ec27-424b-af92-fa7aa9a88c7b=responseserver.apptoken", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzE2NTM5Mw=="}, "originalCommit": {"oid": "cdf53a094c73a23e1a16d8ac883628d9b48214e3"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1250, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}