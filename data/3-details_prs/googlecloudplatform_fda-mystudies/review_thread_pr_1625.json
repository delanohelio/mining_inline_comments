{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4ODAxMTE1", "number": 1625, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzoyMjowM1rOExNB8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzoyMjowM1rOExNB8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIwMDI5MTY4OnYy", "diffSide": "RIGHT", "path": "study-datastore/src/main/java/com/hphc/mystudies/web/servlet/AuthenticationService.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzoyMjowM1rOHnNm6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxMzoyNzowM1rOHqbuAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3OTQ2NQ==", "bodyText": "Shouldn't it be?\nif (authPropMap.cotainsKey(bundleId) && ((String)authPropMap.get(bundleId) == appToken))", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1625#discussion_r510879465", "createdAt": "2020-10-23T13:22:03Z", "author": {"login": "zohrehj"}, "path": "study-datastore/src/main/java/com/hphc/mystudies/web/servlet/AuthenticationService.java", "diffHunk": "@@ -49,7 +49,7 @@ public boolean authenticate(String authCredentials) {\n           final StringTokenizer tokenizer = new StringTokenizer(bundleIdAndAppToken, \":\");\n           final String bundleId = tokenizer.nextToken();\n           final String appToken = tokenizer.nextToken();\n-          if (authPropMap.containsKey(bundleId) && authPropMap.containsKey(appToken)) {\n+          if (authPropMap.containsValue(bundleId) && authPropMap.containsValue(appToken)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08f73abb10460d0e9aa5866046c1e929c537b1a4"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ5ODMyOQ==", "bodyText": "I tried with if (authPropMap.cotainsKey(bundleId) && ((String)authPropMap.get(bundleId) == appToken)) , its fails to validate the key and value. Hence I have changed the key value pair format in authorizationResource.properties file by keeping key on the left side and value on the right side as the logic to fetch value in  from environment variable in PropertiesUtil.java is commonly shared by remaining properties file as well.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1625#discussion_r512498329", "createdAt": "2020-10-27T08:31:26Z", "author": {"login": "aswinijena100"}, "path": "study-datastore/src/main/java/com/hphc/mystudies/web/servlet/AuthenticationService.java", "diffHunk": "@@ -49,7 +49,7 @@ public boolean authenticate(String authCredentials) {\n           final StringTokenizer tokenizer = new StringTokenizer(bundleIdAndAppToken, \":\");\n           final String bundleId = tokenizer.nextToken();\n           final String appToken = tokenizer.nextToken();\n-          if (authPropMap.containsKey(bundleId) && authPropMap.containsKey(appToken)) {\n+          if (authPropMap.containsValue(bundleId) && authPropMap.containsValue(appToken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3OTQ2NQ=="}, "originalCommit": {"oid": "08f73abb10460d0e9aa5866046c1e929c537b1a4"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY5NDM0MQ==", "bodyText": "the main issue with your approach is that they could sign in with any pair of bundleId and token, e.g iOS bundleID and Android appToken. We should prevent that.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1625#discussion_r512694341", "createdAt": "2020-10-27T13:33:29Z", "author": {"login": "zohrehj"}, "path": "study-datastore/src/main/java/com/hphc/mystudies/web/servlet/AuthenticationService.java", "diffHunk": "@@ -49,7 +49,7 @@ public boolean authenticate(String authCredentials) {\n           final StringTokenizer tokenizer = new StringTokenizer(bundleIdAndAppToken, \":\");\n           final String bundleId = tokenizer.nextToken();\n           final String appToken = tokenizer.nextToken();\n-          if (authPropMap.containsKey(bundleId) && authPropMap.containsKey(appToken)) {\n+          if (authPropMap.containsValue(bundleId) && authPropMap.containsValue(appToken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3OTQ2NQ=="}, "originalCommit": {"oid": "08f73abb10460d0e9aa5866046c1e929c537b1a4"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDE3MTczOQ==", "bodyText": "The same issue exist in FDA open implementation as well . To fix this issue code level changes are required to handle this scenario. Hence if you are okay I can raise one ticket and take it up this as a separate issue fix .", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1625#discussion_r514171739", "createdAt": "2020-10-29T10:59:05Z", "author": {"login": "aswinijena100"}, "path": "study-datastore/src/main/java/com/hphc/mystudies/web/servlet/AuthenticationService.java", "diffHunk": "@@ -49,7 +49,7 @@ public boolean authenticate(String authCredentials) {\n           final StringTokenizer tokenizer = new StringTokenizer(bundleIdAndAppToken, \":\");\n           final String bundleId = tokenizer.nextToken();\n           final String appToken = tokenizer.nextToken();\n-          if (authPropMap.containsKey(bundleId) && authPropMap.containsKey(appToken)) {\n+          if (authPropMap.containsValue(bundleId) && authPropMap.containsValue(appToken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3OTQ2NQ=="}, "originalCommit": {"oid": "08f73abb10460d0e9aa5866046c1e929c537b1a4"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI0NzgxMg==", "bodyText": "sounds good.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1625#discussion_r514247812", "createdAt": "2020-10-29T13:14:12Z", "author": {"login": "zohrehj"}, "path": "study-datastore/src/main/java/com/hphc/mystudies/web/servlet/AuthenticationService.java", "diffHunk": "@@ -49,7 +49,7 @@ public boolean authenticate(String authCredentials) {\n           final StringTokenizer tokenizer = new StringTokenizer(bundleIdAndAppToken, \":\");\n           final String bundleId = tokenizer.nextToken();\n           final String appToken = tokenizer.nextToken();\n-          if (authPropMap.containsKey(bundleId) && authPropMap.containsKey(appToken)) {\n+          if (authPropMap.containsValue(bundleId) && authPropMap.containsValue(appToken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3OTQ2NQ=="}, "originalCommit": {"oid": "08f73abb10460d0e9aa5866046c1e929c537b1a4"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDI1NjM4Nw==", "bodyText": "Issue #1714  created for this", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1625#discussion_r514256387", "createdAt": "2020-10-29T13:27:03Z", "author": {"login": "aswinijena100"}, "path": "study-datastore/src/main/java/com/hphc/mystudies/web/servlet/AuthenticationService.java", "diffHunk": "@@ -49,7 +49,7 @@ public boolean authenticate(String authCredentials) {\n           final StringTokenizer tokenizer = new StringTokenizer(bundleIdAndAppToken, \":\");\n           final String bundleId = tokenizer.nextToken();\n           final String appToken = tokenizer.nextToken();\n-          if (authPropMap.containsKey(bundleId) && authPropMap.containsKey(appToken)) {\n+          if (authPropMap.containsValue(bundleId) && authPropMap.containsValue(appToken)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg3OTQ2NQ=="}, "originalCommit": {"oid": "08f73abb10460d0e9aa5866046c1e929c537b1a4"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1717, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}