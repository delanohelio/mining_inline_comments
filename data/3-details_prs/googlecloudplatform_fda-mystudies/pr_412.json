{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNDY0MjE2", "number": 412, "title": "update docs and scripts", "bodyText": "", "createdAt": "2020-05-21T16:52:17Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/412", "merged": true, "mergeCommit": {"oid": "e0bc229c6216f885112f1fcb2a2b599c366581e0"}, "closed": true, "closedAt": "2020-05-21T20:52:05Z", "author": {"login": "xingao267"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjgmC8gH2gAyNDIxNDY0MjE2OjQ1ZDM3M2E0OWE1OGY0Yzc0ZWNkNjE1Yzk3OTBlOWE2ZTFiZmI4Yzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjj8tOgH2gAyNDIxNDY0MjE2OjNmZGM2ZGU5MzFhZjBhMWE4MGIwYjE5YTlkOGEzN2UwZjEyNWJkYmM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "45d373a49a58f4c74ecd615c9790e9a6e1bfb8c8", "author": {"user": {"login": "xingao267", "name": "Xin Gao"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/45d373a49a58f4c74ecd615c9790e9a6e1bfb8c8", "committedDate": "2020-05-21T16:51:57Z", "message": "update docs and scripts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MzIyNTEy", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/412#pullrequestreview-416322512", "createdAt": "2020-05-21T16:55:29Z", "commit": {"oid": "45d373a49a58f4c74ecd615c9790e9a6e1bfb8c8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MzI5NTAx", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/412#pullrequestreview-416329501", "createdAt": "2020-05-21T17:04:40Z", "commit": {"oid": "45d373a49a58f4c74ecd615c9790e9a6e1bfb8c8"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNzowNDo0MVrOGY7LNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNzowNDo0MVrOGY7LNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODc4ODUzMw==", "bodyText": "I'm wondering if git mv would be better for git history purpose, but this PR is good as is.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/412#discussion_r428788533", "createdAt": "2020-05-21T17:04:41Z", "author": {"login": "kuoyuchi"}, "path": "Terraform/rename.sh", "diffHunk": "@@ -53,17 +72,16 @@ do\n   cp -r ${SRC_PROJ_BASE}-$d/project ${DST_PROJ_BASE}-$d/\n done\n \n-# Phase 2\n-cp -r ${SRC_PROJ_BASE}-networks/networks ${DST_PROJ_BASE}-networks/\n-cp -r ${SRC_PROJ_BASE}-data/data ${DST_PROJ_BASE}-data/\n-cp -r ${SRC_PROJ_BASE}-resp-firebase/firebase ${DST_PROJ_BASE}-resp-firebase/\n+# Deployment Phase 2 - Uncomment after Phase 1 is deployed\n+# cp -r ${SRC_PROJ_BASE}-networks/networks ${DST_PROJ_BASE}-networks/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45d373a49a58f4c74ecd615c9790e9a6e1bfb8c8"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2MzM4MjM5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/412#pullrequestreview-416338239", "createdAt": "2020-05-21T17:16:34Z", "commit": {"oid": "45d373a49a58f4c74ecd615c9790e9a6e1bfb8c8"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNzoxNjozNFrOGY7k3A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxNzoxNjozNFrOGY7k3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODc5NTEwMA==", "bodyText": "I wonder if we can create a link instead, e.g. comment out [GCS backend](../bootstrap/main.tf#L32-L35)", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/412#discussion_r428795100", "createdAt": "2020-05-21T17:16:34Z", "author": {"login": "zohrehj"}, "path": "Terraform/README.md", "diffHunk": "@@ -97,72 +97,140 @@ To see what resources each deployment provisions, check out the comments in each\n \n ## Deployment Steps\n \n-1.  Authenticate as a super admin using `gcloud auth login [ACCOUNT]`.\n+1. Authenticate as a super admin using `gcloud auth login [ACCOUNT]`.\n \n     WARNING: remember to run `gcloud auth revoke` to logout as a super admin.\n     Being logged in as a super admin beyond the initial setup is dangerous!\n \n-1.  Checkout the Terraform configs and set some helper environment variables.\n+1. Checkout the Terraform configs and set some helper environment variables.\n \n-    ```\n-    $ git clone my-repo\n-    $ cd my-repo\n-    $ ROOT=$PWD\n+    ```bash\n+    git clone my-repo\n+    cd my-repo\n+    ROOT=$PWD\n     ```\n \n     If you would like to deploy the same infrastructure based on the Terraform\n     configs in this directory but in a different organization with different\n-    resource prefix or namings, use the `rename.sh` script.\n+    resource prefix or namings, use the `rename.sh` script with your environment\n+    specific values filled in. Note that `rename.sh` should be run several times\n+    with corresponding deployment phase block uncommented. Cross reference this\n+    `README.md` file and documentations in the `rename.sh` together do complete\n+    the deployment.\n \n-1.  The bootstrap config must be deployed first in order to create the `devops`\n-    project which will host your Terraform state and CICD pipelines.\n+    `rename.sh` script uses configs in this directory and copy them over with value\n+    substitutions to a target local directory to host your new final Terraform configs.\n \n-    ```\n-    $ cd $ROOT/bootstrap\n-    $ terraform init\n-    $ terraform plan\n-    $ terraform apply\n+1. Run `rename.sh` in this directory (later referenced as the original directory) to\n+    copy the Deployment Phase 1 configs to your target directory.\n+\n+1. Go to the target directory.\n+\n+1. Deploy the `$ROOT/bootstrap/` folder first to create the `devops` project and\n+    Terraform state bucket.\n+\n+    Make sure in your first deployment in a new organization, Comment out the `backend`\n+    block (L32-35) in `$ROOT/bootstrap/main.tf` first.\n+\n+    ```bash\n+    cd $ROOT/bootstrap\n+    terraform init\n+    terraform apply\n     ```\n \n     Your `devops` project should now be ready.\n \n-1.  Backup the state of the `devops` project to the newly created state bucket\n-    by uncommenting out the `terraform` block in `$ROOT/bootstrap/main.tf` and\n-    running:\n+1. Backup the state of the `devops` project to the newly created state bucket", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45d373a49a58f4c74ecd615c9790e9a6e1bfb8c8"}, "originalPosition": 155}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41b481baac8458bd562c8ac1dd883fc5b3e804a7", "author": {"user": {"login": "xingao267", "name": "Xin Gao"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/41b481baac8458bd562c8ac1dd883fc5b3e804a7", "committedDate": "2020-05-21T18:56:06Z", "message": "add link"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8236b03721b201d6b5e85f7951657f42e45b5fdc", "author": {"user": {"login": "xingao267", "name": "Xin Gao"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8236b03721b201d6b5e85f7951657f42e45b5fdc", "committedDate": "2020-05-21T18:59:23Z", "message": "fix links"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4489f0c4e7fd2b4aa273e510915df7d22815e4df", "author": {"user": {"login": "xingao267", "name": "Xin Gao"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/4489f0c4e7fd2b4aa273e510915df7d22815e4df", "committedDate": "2020-05-21T19:03:53Z", "message": "more links"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0847be24f470efe27e27807e188ccc677c769a22", "author": {"user": {"login": "xingao267", "name": "Xin Gao"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/0847be24f470efe27e27807e188ccc677c769a22", "committedDate": "2020-05-21T19:08:00Z", "message": "more doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fdc6de931af0a1a80b0b19a9d8a37e0f125bdbc", "author": {"user": {"login": "xingao267", "name": "Xin Gao"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3fdc6de931af0a1a80b0b19a9d8a37e0f125bdbc", "committedDate": "2020-05-21T20:46:25Z", "message": "Add mobile app secrets copy to sql instruction."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1077, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}