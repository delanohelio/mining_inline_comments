{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5NDcxMDk1", "number": 2368, "title": "PM web app issue #1722 fixed", "bodyText": "added locations and roles guard for not allowing navigation to locations and users sections if user doesn't have required permissions", "createdAt": "2020-12-14T13:56:04Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2368", "merged": true, "mergeCommit": {"oid": "85a58d7c561acbe6b6ca7958592a743fa3483d0b"}, "closed": true, "closedAt": "2020-12-15T14:49:49Z", "author": {"login": "firdosebtc1"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdmGGregH2gAyNTM5NDcxMDk1OmE3MzVkZDdkYmM2MzA5OGU5MzQ4OWVkOWYwNjFiZGQxOTlhZThjMmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmbgmSAH2gAyNTM5NDcxMDk1OjExYTk2ZWNiODA4ZWE0NTM1YTYzMmJiZDM0NzFhODY5OTk1ZmMwOTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a735dd7dbc63098e93489ed9f061bdd199ae8c2a", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a735dd7dbc63098e93489ed9f061bdd199ae8c2a", "committedDate": "2020-12-14T13:53:05Z", "message": "issue #1722 fixed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46970cdd7feca8ff5d258f60eb97a049416b64a7", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/46970cdd7feca8ff5d258f60eb97a049416b64a7", "committedDate": "2020-12-14T13:54:10Z", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into pm-webapp-issue-fixing-dec14"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70356cddb64af7dd845cefc4aeacfd063e9328a9", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/70356cddb64af7dd845cefc4aeacfd063e9328a9", "committedDate": "2020-12-14T14:55:40Z", "message": "Merge branch 'develop' into pm-webapp-issue-fixing-dec14"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxNTY1Nzgy", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2368#pullrequestreview-551565782", "createdAt": "2020-12-14T16:33:00Z", "commit": {"oid": "70356cddb64af7dd845cefc4aeacfd063e9328a9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozMzowMFrOIFZIkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNjozMzowMFrOIFZIkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjUyNTU4NA==", "bodyText": "At first glance looks like you are allowing both view and edit permissions to activate location. The question that comes up is what is then being excluded?\nin other words, what values can manageLocations have and what do each of them mean?\nYou can move these values into well defined constants to make the code more readable.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2368#discussion_r542525584", "createdAt": "2020-12-14T16:33:00Z", "author": {"login": "zohrehj"}, "path": "participant-manager/src/app/service/locations.guard.ts", "diffHunk": "@@ -0,0 +1,23 @@\n+import {Injectable} from '@angular/core';\n+import {CanActivate, UrlTree} from '@angular/router';\n+import {UserService} from '../service/user.service';\n+import {Profile} from '../site-coordinator/account/shared/profile.model';\n+\n+@Injectable({\n+  providedIn: 'root',\n+})\n+export class LocationsGuard implements CanActivate {\n+  user = {} as Profile;\n+\n+  constructor(private readonly userService: UserService) {\n+    this.user = this.userService.getUserProfile();\n+  }\n+\n+  canActivate(): boolean | UrlTree {\n+    return (\n+      this.user.superAdmin ||\n+      this.user.manageLocations === 1 ||\n+      this.user.manageLocations === 0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70356cddb64af7dd845cefc4aeacfd063e9328a9"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "291174eee660e581770f9f35a5413ba9c20d68c2", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/291174eee660e581770f9f35a5413ba9c20d68c2", "committedDate": "2020-12-15T06:22:39Z", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into pm-webapp-issue-fixing-dec14\n\n# Conflicts:\n#\tparticipant-manager/src/app/site-coordinator/site-coordinator.module.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c7eb16e85177cfb7b0e3579c3604bd1cadaa42f", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7c7eb16e85177cfb7b0e3579c3604bd1cadaa42f", "committedDate": "2020-12-15T06:33:59Z", "message": "code review comments has been fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyNTA1MTk3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2368#pullrequestreview-552505197", "createdAt": "2020-12-15T14:19:12Z", "commit": {"oid": "7c7eb16e85177cfb7b0e3579c3604bd1cadaa42f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da3b71361769d6949489a8588ca1b7e46bd8c39c", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/da3b71361769d6949489a8588ca1b7e46bd8c39c", "committedDate": "2020-12-15T14:46:51Z", "message": "Merge branch 'develop' into pm-webapp-issue-fixing-dec14"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11a96ecb808ea4535a632bbd3471a869995fc093", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/11a96ecb808ea4535a632bbd3471a869995fc093", "committedDate": "2020-12-15T14:49:24Z", "message": "Merge branch 'develop' into pm-webapp-issue-fixing-dec14"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1042, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}