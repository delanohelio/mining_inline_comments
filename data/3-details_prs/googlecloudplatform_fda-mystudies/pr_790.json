{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxNjk2Njgy", "number": 790, "title": "Participant Manager WebApp Add Admin ", "bodyText": "", "createdAt": "2020-08-21T15:20:02Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790", "merged": true, "mergeCommit": {"oid": "c22587dd950be269cfd3ee24b661165b5d79f5f3"}, "closed": true, "closedAt": "2020-08-26T15:29:18Z", "author": {"login": "firdosebtc1"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdBGZVsAH2gAyNDcxNjk2NjgyOmJhYWY3MTY2NjhhYWQ5OWRkMTJmMzY2MDZkOGY3ZjYzN2UxZDVjMmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdCti4tgH2gAyNDcxNjk2NjgyOmFkNDE2MmE3NzdjZmRjMWI5NWVmZTM4N2ZjZDYwZTdlMjY1MzJhMTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/baaf716668aad99dd12f36606d8f7f637e1d5c2b", "committedDate": "2020-08-21T15:18:16Z", "message": "add admin has been implemented"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNTk0OTA0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#pullrequestreview-472594904", "createdAt": "2020-08-21T15:38:20Z", "commit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNTozODoyMFrOHEyCrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxOTo0Mzo0NVrOHE54SQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc3NjIzOA==", "bodyText": "I would change this to \"Add an app\"", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474776238", "createdAt": "2020-08-21T15:38:20Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,478 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Locations</label>\n+              </div>\n+              <div class=\"pl-xl pt-xs\">\n+                <span>\n+                  <input\n+                    [value]=\"permission.View\"\n+                    type=\"radio\"\n+                    id=\"location_view_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_permssion\">View</label>\n+                </span>\n+                <span>\n+                  <input\n+                    [value]=\"permission.ViewAndEdit\"\n+                    type=\"radio\"\n+                    id=\"location_view_edit_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_edit_permssion\">\n+                    View And Edit\n+                  </label>\n+                </span>\n+              </div>\n+            </div>\n+          </div>\n+        </div>\n+      </section>\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"form-group\">\n+          <div class=\"user__card__title pb-lg\">Sites, Studies and Apps</div>\n+          <div\n+            class=\"select__form-control__parent\"\n+            style=\"padding-bottom: 10px;\"\n+          >\n+            <label class=\"wrap\">\n+              Select and Add App", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 216}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc3NjM4MQ==", "bodyText": "Looks like there should be more space between this header and the next label.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474776381", "createdAt": "2020-08-21T15:38:38Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,478 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Locations</label>\n+              </div>\n+              <div class=\"pl-xl pt-xs\">\n+                <span>\n+                  <input\n+                    [value]=\"permission.View\"\n+                    type=\"radio\"\n+                    id=\"location_view_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_permssion\">View</label>\n+                </span>\n+                <span>\n+                  <input\n+                    [value]=\"permission.ViewAndEdit\"\n+                    type=\"radio\"\n+                    id=\"location_view_edit_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_edit_permssion\">\n+                    View And Edit\n+                  </label>\n+                </span>\n+              </div>\n+            </div>\n+          </div>\n+        </div>\n+      </section>\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"form-group\">\n+          <div class=\"user__card__title pb-lg\">Sites, Studies and Apps</div>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 210}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc3Njc5MQ==", "bodyText": "There should be a gap between these buttons.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474776791", "createdAt": "2020-08-21T15:39:23Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,478 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Locations</label>\n+              </div>\n+              <div class=\"pl-xl pt-xs\">\n+                <span>\n+                  <input\n+                    [value]=\"permission.View\"\n+                    type=\"radio\"\n+                    id=\"location_view_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_permssion\">View</label>\n+                </span>\n+                <span>\n+                  <input\n+                    [value]=\"permission.ViewAndEdit\"\n+                    type=\"radio\"\n+                    id=\"location_view_edit_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_edit_permssion\">\n+                    View And Edit\n+                  </label>\n+                </span>\n+              </div>\n+            </div>\n+          </div>\n+        </div>\n+      </section>\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"form-group\">\n+          <div class=\"user__card__title pb-lg\">Sites, Studies and Apps</div>\n+          <div\n+            class=\"select__form-control__parent\"\n+            style=\"padding-bottom: 10px;\"\n+          >\n+            <label class=\"wrap\">\n+              Select and Add App\n+              <ng-select\n+                [items]=\"appDetails.apps\"\n+                [clearable]=\"false\"\n+                [multiple]=\"true\"\n+                bindLabel=\"name\"\n+                class=\"form-control select__form-control\"\n+                placeholder=\"Enter App ID or Name\"\n+                [hideSelected]=\"true\"\n+                [(ngModel)]=\"selectedApps\"\n+                [ngModelOptions]=\"{standalone: true}\"\n+              ></ng-select>\n+            </label>\n+          </div>\n+        </div>\n+        <div class=\"form-group pt-none\">\n+          <div class=\"accordion\" id=\"accordionExample\">\n+            <div *ngFor=\"let app of selectedApps\" class=\"card\">\n+              <div class=\"flex__justify__space-between\">\n+                <div class=\"acc__dele\">\n+                  <div class=\"card-header\">\n+                    <div class=\"mb-0 flex__justify__space-between\">\n+                      <div>\n+                        <div class=\"custom__labels\">\n+                          <input\n+                            type=\"checkbox\"\n+                            name=\"checkbox2\"\n+                            id=\"appCheckBox{{ app.id }}\"\n+                            [(ngModel)]=\"app.selected\"\n+                            [ngModelOptions]=\"{standalone: true}\"\n+                            (change)=\"appCheckBoxChange(app)\"\n+                          />\n+                          <label for=\"appCheckBox{{ app.id }}\">\n+                            {{ app.name }}({{ app.customId }})\n+                            <span class=\"app__id ml-xs\"></span>\n+                            <span>\n+                              {{\n+                                app.selectedSitesCount\n+                                  | i18nPlural: sitesMessageMapping\n+                              }}\n+                            </span>\n+                          </label>\n+                        </div>\n+                        <div class=\"pl-xl pt-xs\">\n+                          <span>\n+                            <input\n+                              type=\"radio\"\n+                              [value]=\"permission.View\"\n+                              [(ngModel)]=\"app.permission\"\n+                              [disabled]=\"!app.selected\"\n+                              [ngModelOptions]=\"{standalone: true}\"\n+                              id=\"appRadioView{{ app.id }}\"\n+                              name=\"appRadioGroup{{ app.id }}\"\n+                              (change)=\"appRadioButtonChange(app)\"\n+                            />\n+                            <label for=\"appRadioView{{ app.id }}\">View</label>\n+                          </span>\n+                          <span>\n+                            <input\n+                              type=\"radio\"\n+                              [value]=\"permission.ViewAndEdit\"\n+                              [(ngModel)]=\"app.permission\"\n+                              [disabled]=\"!app.selected\"\n+                              [ngModelOptions]=\"{standalone: true}\"\n+                              id=\"appRadioEdit{{ app.id }}\"\n+                              name=\"appRadioGroup{{ app.id }}\"\n+                              (change)=\"appRadioButtonChange(app)\"\n+                            />\n+                            <label for=\"appRadioEdit{{ app.id }}\">\n+                              View And Edit\n+                            </label>\n+                          </span>\n+                        </div>\n+                      </div>\n+                      <div\n+                        class=\"fa__plus__minus\"\n+                        type=\"button\"\n+                        data-toggle=\"collapse\"\n+                        [attr.data-target]=\"'#collapse' + app.id\"\n+                        aria-expanded=\"false\"\n+                      ></div>\n+                    </div>\n+                  </div>\n+                  <div\n+                    id=\"collapse{{ app.id }}\"\n+                    class=\"collapse\"\n+                    data-parent=\"#accordionExample\"\n+                  >\n+                    <div class=\"card-body\">\n+                      <div\n+                        class=\"accordion sub__accordian card-body__pad\"\n+                        id=\"accordionExample{{ app.id }}\"\n+                      >\n+                        <div class=\"orange__text__sm pb-sm\"></div>\n+\n+                        <div class=\"card\" *ngFor=\"let study of app.studies\">\n+                          <div class=\"card-header\">\n+                            <div class=\"mb-0 flex__justify__space-between\">\n+                              <div>\n+                                <div class=\"custom__labels\">\n+                                  <input\n+                                    (change)=\"studyCheckBoxChange(study, app)\"\n+                                    [disabled]=\"app.selected\"\n+                                    type=\"checkbox\"\n+                                    name=\"checkbox2\"\n+                                    id=\"studyCheckBox{{ study.studyId }}\"\n+                                    [(ngModel)]=\"study.selected\"\n+                                    [ngModelOptions]=\"{standalone: true}\"\n+                                  />\n+                                  <label for=\"studyCheckBox{{ study.studyId }}\">\n+                                    {{ study.studyName }}\n+                                  </label>\n+                                </div>\n+                                <div class=\"custom__labels__radio\">\n+                                  <span>\n+                                    <input\n+                                      [disabled]=\"\n+                                        app.selected || !study.selected\n+                                      \"\n+                                      type=\"radio\"\n+                                      [value]=\"permission.View\"\n+                                      [(ngModel)]=\"study.permission\"\n+                                      [ngModelOptions]=\"{standalone: true}\"\n+                                      id=\"studyRadioView{{ study.studyId }}\"\n+                                      name=\"studyRadioGroup{{ study.studyId }}\"\n+                                      (change)=\"studyRadioButtonChange(study)\"\n+                                    />\n+                                    <label\n+                                      for=\"studyRadioView{{ study.studyId }}\"\n+                                    >\n+                                      View\n+                                    </label>\n+                                  </span>\n+                                  <span>\n+                                    <input\n+                                      [disabled]=\"\n+                                        app.selected || !study.selected\n+                                      \"\n+                                      type=\"radio\"\n+                                      [value]=\"permission.ViewAndEdit\"\n+                                      [(ngModel)]=\"study.permission\"\n+                                      [ngModelOptions]=\"{standalone: true}\"\n+                                      id=\"studyRadioEdit{{ study.studyId }}\"\n+                                      name=\"studyRadioGroup{{ study.studyId }}\"\n+                                      (change)=\"studyRadioButtonChange(study)\"\n+                                    />\n+                                    <label\n+                                      for=\"studyRadioEdit{{ study.studyId }}\"\n+                                    >\n+                                      View And Edit\n+                                    </label>\n+                                  </span>\n+                                </div>\n+                              </div>\n+                              <div\n+                                class=\"fa__plus__minus\"\n+                                type=\"button\"\n+                                data-toggle=\"collapse\"\n+                                [attr.data-target]=\"\n+                                  '#collapseTwo' + study.studyId\n+                                \"\n+                                aria-expanded=\"false\"\n+                              ></div>\n+                            </div>\n+                          </div>\n+                          <div\n+                            id=\"collapseTwo{{ study.studyId }}\"\n+                            class=\"collapse\"\n+                            [attr.data-parent]=\"'#accordionExample' + app.id\"\n+                          >\n+                            <div class=\"card-body\">\n+                              <div class=\"orange__text__sm pad__T10__B20\">\n+                                {{\n+                                  study.selectedSitesCount\n+                                    | i18nPlural: sitesMessageMapping\n+                                }}\n+                              </div>\n+                              <div *ngFor=\"let site of study.sites\">\n+                                <div class=\"custom__labels\">\n+                                  <input\n+                                    (change)=\"\n+                                      siteCheckBoxChange(site, study, app)\n+                                    \"\n+                                    [disabled]=\"study.selected\"\n+                                    type=\"checkbox\"\n+                                    name=\"checkbox2\"\n+                                    id=\"siteCheckBox{{ site.siteId }}\"\n+                                    [ngModelOptions]=\"{standalone: true}\"\n+                                    [(ngModel)]=\"site.selected\"\n+                                  />\n+                                  <label for=\"siteCheckBox{{ site.siteId }}\">\n+                                    {{ site.locationName }}\n+                                  </label>\n+                                </div>\n+                                <div class=\"custom__labels__radio\">\n+                                  <span>\n+                                    <input\n+                                      [disabled]=\"\n+                                        study.selected || !site.selected\n+                                      \"\n+                                      type=\"radio\"\n+                                      [value]=\"permission.View\"\n+                                      [(ngModel)]=\"site.permission\"\n+                                      [ngModelOptions]=\"{standalone: true}\"\n+                                      id=\"siteRadioRead{{ site.siteId }}\"\n+                                      name=\"siteRadioGroup{{ site.siteId }}\"\n+                                    />\n+                                    <label for=\"siteRadioRead{{ site.siteId }}\">\n+                                      View\n+                                    </label>\n+                                  </span>\n+                                  <span>\n+                                    <input\n+                                      [disabled]=\"\n+                                        study.selected || !site.selected\n+                                      \"\n+                                      type=\"radio\"\n+                                      [value]=\"permission.ViewAndEdit\"\n+                                      [(ngModel)]=\"site.permission\"\n+                                      [ngModelOptions]=\"{standalone: true}\"\n+                                      id=\"siteRadioEdit{{ site.siteId }}\"\n+                                      name=\"siteRadioGroup{{ site.siteId }}\"\n+                                    />\n+                                    <label for=\"siteRadioEdit{{ site.siteId }}\">\n+                                      View And Edit\n+                                    </label>\n+                                  </span>\n+                                </div>\n+                              </div>\n+                            </div>\n+                          </div>\n+                        </div>\n+                      </div>\n+                    </div>\n+                  </div>\n+                </div>\n+                <button class=\"btn\" (click)=\"deleteAppFromList(app.id)\">\n+                  <img src=\"assets/svgs/delete.svg\" alt=\"Delete\" />\n+                </button>\n+              </div>\n+            </div>\n+          </div>\n+        </div>\n+      </section>\n+    </div>\n+    <section class=\"btn__container\">\n+      <button\n+        [disabled]=\"!addUserForm.form.valid\"\n+        type=\"submit\"\n+        name=\"add\"\n+        class=\"btn bt__add bt__add__auto mr-sm\"\n+      >\n+        Create User and Invite\n+      </button>\n+      <button", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 470}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg4OTk3Ng==", "bodyText": "Can you elaborate on this for the user? Maybe \"Allow access to locations\"?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474889976", "createdAt": "2020-08-21T19:25:16Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,478 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Locations</label>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 170}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg5MDgwNg==", "bodyText": "It might be clearer to hide these until the box it checked.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474890806", "createdAt": "2020-08-21T19:26:21Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,478 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Locations</label>\n+              </div>\n+              <div class=\"pl-xl pt-xs\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 172}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg5MTI1Mg==", "bodyText": "\"Creating a user\" is more of a technical operation. \"Add\" works a bit better from the user's perspective. You could probably also make this just \"Invite\"", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474891252", "createdAt": "2020-08-21T19:26:58Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,478 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Locations</label>\n+              </div>\n+              <div class=\"pl-xl pt-xs\">\n+                <span>\n+                  <input\n+                    [value]=\"permission.View\"\n+                    type=\"radio\"\n+                    id=\"location_view_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_permssion\">View</label>\n+                </span>\n+                <span>\n+                  <input\n+                    [value]=\"permission.ViewAndEdit\"\n+                    type=\"radio\"\n+                    id=\"location_view_edit_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_edit_permssion\">\n+                    View And Edit\n+                  </label>\n+                </span>\n+              </div>\n+            </div>\n+          </div>\n+        </div>\n+      </section>\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"form-group\">\n+          <div class=\"user__card__title pb-lg\">Sites, Studies and Apps</div>\n+          <div\n+            class=\"select__form-control__parent\"\n+            style=\"padding-bottom: 10px;\"\n+          >\n+            <label class=\"wrap\">\n+              Select and Add App\n+              <ng-select\n+                [items]=\"appDetails.apps\"\n+                [clearable]=\"false\"\n+                [multiple]=\"true\"\n+                bindLabel=\"name\"\n+                class=\"form-control select__form-control\"\n+                placeholder=\"Enter App ID or Name\"\n+                [hideSelected]=\"true\"\n+                [(ngModel)]=\"selectedApps\"\n+                [ngModelOptions]=\"{standalone: true}\"\n+              ></ng-select>\n+            </label>\n+          </div>\n+        </div>\n+        <div class=\"form-group pt-none\">\n+          <div class=\"accordion\" id=\"accordionExample\">\n+            <div *ngFor=\"let app of selectedApps\" class=\"card\">\n+              <div class=\"flex__justify__space-between\">\n+                <div class=\"acc__dele\">\n+                  <div class=\"card-header\">\n+                    <div class=\"mb-0 flex__justify__space-between\">\n+                      <div>\n+                        <div class=\"custom__labels\">\n+                          <input\n+                            type=\"checkbox\"\n+                            name=\"checkbox2\"\n+                            id=\"appCheckBox{{ app.id }}\"\n+                            [(ngModel)]=\"app.selected\"\n+                            [ngModelOptions]=\"{standalone: true}\"\n+                            (change)=\"appCheckBoxChange(app)\"\n+                          />\n+                          <label for=\"appCheckBox{{ app.id }}\">\n+                            {{ app.name }}({{ app.customId }})\n+                            <span class=\"app__id ml-xs\"></span>\n+                            <span>\n+                              {{\n+                                app.selectedSitesCount\n+                                  | i18nPlural: sitesMessageMapping\n+                              }}\n+                            </span>\n+                          </label>\n+                        </div>\n+                        <div class=\"pl-xl pt-xs\">\n+                          <span>\n+                            <input\n+                              type=\"radio\"\n+                              [value]=\"permission.View\"\n+                              [(ngModel)]=\"app.permission\"\n+                              [disabled]=\"!app.selected\"\n+                              [ngModelOptions]=\"{standalone: true}\"\n+                              id=\"appRadioView{{ app.id }}\"\n+                              name=\"appRadioGroup{{ app.id }}\"\n+                              (change)=\"appRadioButtonChange(app)\"\n+                            />\n+                            <label for=\"appRadioView{{ app.id }}\">View</label>\n+                          </span>\n+                          <span>\n+                            <input\n+                              type=\"radio\"\n+                              [value]=\"permission.ViewAndEdit\"\n+                              [(ngModel)]=\"app.permission\"\n+                              [disabled]=\"!app.selected\"\n+                              [ngModelOptions]=\"{standalone: true}\"\n+                              id=\"appRadioEdit{{ app.id }}\"\n+                              name=\"appRadioGroup{{ app.id }}\"\n+                              (change)=\"appRadioButtonChange(app)\"\n+                            />\n+                            <label for=\"appRadioEdit{{ app.id }}\">\n+                              View And Edit\n+                            </label>\n+                          </span>\n+                        </div>\n+                      </div>\n+                      <div\n+                        class=\"fa__plus__minus\"\n+                        type=\"button\"\n+                        data-toggle=\"collapse\"\n+                        [attr.data-target]=\"'#collapse' + app.id\"\n+                        aria-expanded=\"false\"\n+                      ></div>\n+                    </div>\n+                  </div>\n+                  <div\n+                    id=\"collapse{{ app.id }}\"\n+                    class=\"collapse\"\n+                    data-parent=\"#accordionExample\"\n+                  >\n+                    <div class=\"card-body\">\n+                      <div\n+                        class=\"accordion sub__accordian card-body__pad\"\n+                        id=\"accordionExample{{ app.id }}\"\n+                      >\n+                        <div class=\"orange__text__sm pb-sm\"></div>\n+\n+                        <div class=\"card\" *ngFor=\"let study of app.studies\">\n+                          <div class=\"card-header\">\n+                            <div class=\"mb-0 flex__justify__space-between\">\n+                              <div>\n+                                <div class=\"custom__labels\">\n+                                  <input\n+                                    (change)=\"studyCheckBoxChange(study, app)\"\n+                                    [disabled]=\"app.selected\"\n+                                    type=\"checkbox\"\n+                                    name=\"checkbox2\"\n+                                    id=\"studyCheckBox{{ study.studyId }}\"\n+                                    [(ngModel)]=\"study.selected\"\n+                                    [ngModelOptions]=\"{standalone: true}\"\n+                                  />\n+                                  <label for=\"studyCheckBox{{ study.studyId }}\">\n+                                    {{ study.studyName }}\n+                                  </label>\n+                                </div>\n+                                <div class=\"custom__labels__radio\">\n+                                  <span>\n+                                    <input\n+                                      [disabled]=\"\n+                                        app.selected || !study.selected\n+                                      \"\n+                                      type=\"radio\"\n+                                      [value]=\"permission.View\"\n+                                      [(ngModel)]=\"study.permission\"\n+                                      [ngModelOptions]=\"{standalone: true}\"\n+                                      id=\"studyRadioView{{ study.studyId }}\"\n+                                      name=\"studyRadioGroup{{ study.studyId }}\"\n+                                      (change)=\"studyRadioButtonChange(study)\"\n+                                    />\n+                                    <label\n+                                      for=\"studyRadioView{{ study.studyId }}\"\n+                                    >\n+                                      View\n+                                    </label>\n+                                  </span>\n+                                  <span>\n+                                    <input\n+                                      [disabled]=\"\n+                                        app.selected || !study.selected\n+                                      \"\n+                                      type=\"radio\"\n+                                      [value]=\"permission.ViewAndEdit\"\n+                                      [(ngModel)]=\"study.permission\"\n+                                      [ngModelOptions]=\"{standalone: true}\"\n+                                      id=\"studyRadioEdit{{ study.studyId }}\"\n+                                      name=\"studyRadioGroup{{ study.studyId }}\"\n+                                      (change)=\"studyRadioButtonChange(study)\"\n+                                    />\n+                                    <label\n+                                      for=\"studyRadioEdit{{ study.studyId }}\"\n+                                    >\n+                                      View And Edit\n+                                    </label>\n+                                  </span>\n+                                </div>\n+                              </div>\n+                              <div\n+                                class=\"fa__plus__minus\"\n+                                type=\"button\"\n+                                data-toggle=\"collapse\"\n+                                [attr.data-target]=\"\n+                                  '#collapseTwo' + study.studyId\n+                                \"\n+                                aria-expanded=\"false\"\n+                              ></div>\n+                            </div>\n+                          </div>\n+                          <div\n+                            id=\"collapseTwo{{ study.studyId }}\"\n+                            class=\"collapse\"\n+                            [attr.data-parent]=\"'#accordionExample' + app.id\"\n+                          >\n+                            <div class=\"card-body\">\n+                              <div class=\"orange__text__sm pad__T10__B20\">\n+                                {{\n+                                  study.selectedSitesCount\n+                                    | i18nPlural: sitesMessageMapping\n+                                }}\n+                              </div>\n+                              <div *ngFor=\"let site of study.sites\">\n+                                <div class=\"custom__labels\">\n+                                  <input\n+                                    (change)=\"\n+                                      siteCheckBoxChange(site, study, app)\n+                                    \"\n+                                    [disabled]=\"study.selected\"\n+                                    type=\"checkbox\"\n+                                    name=\"checkbox2\"\n+                                    id=\"siteCheckBox{{ site.siteId }}\"\n+                                    [ngModelOptions]=\"{standalone: true}\"\n+                                    [(ngModel)]=\"site.selected\"\n+                                  />\n+                                  <label for=\"siteCheckBox{{ site.siteId }}\">\n+                                    {{ site.locationName }}\n+                                  </label>\n+                                </div>\n+                                <div class=\"custom__labels__radio\">\n+                                  <span>\n+                                    <input\n+                                      [disabled]=\"\n+                                        study.selected || !site.selected\n+                                      \"\n+                                      type=\"radio\"\n+                                      [value]=\"permission.View\"\n+                                      [(ngModel)]=\"site.permission\"\n+                                      [ngModelOptions]=\"{standalone: true}\"\n+                                      id=\"siteRadioRead{{ site.siteId }}\"\n+                                      name=\"siteRadioGroup{{ site.siteId }}\"\n+                                    />\n+                                    <label for=\"siteRadioRead{{ site.siteId }}\">\n+                                      View\n+                                    </label>\n+                                  </span>\n+                                  <span>\n+                                    <input\n+                                      [disabled]=\"\n+                                        study.selected || !site.selected\n+                                      \"\n+                                      type=\"radio\"\n+                                      [value]=\"permission.ViewAndEdit\"\n+                                      [(ngModel)]=\"site.permission\"\n+                                      [ngModelOptions]=\"{standalone: true}\"\n+                                      id=\"siteRadioEdit{{ site.siteId }}\"\n+                                      name=\"siteRadioGroup{{ site.siteId }}\"\n+                                    />\n+                                    <label for=\"siteRadioEdit{{ site.siteId }}\">\n+                                      View And Edit\n+                                    </label>\n+                                  </span>\n+                                </div>\n+                              </div>\n+                            </div>\n+                          </div>\n+                        </div>\n+                      </div>\n+                    </div>\n+                  </div>\n+                </div>\n+                <button class=\"btn\" (click)=\"deleteAppFromList(app.id)\">\n+                  <img src=\"assets/svgs/delete.svg\" alt=\"Delete\" />\n+                </button>\n+              </div>\n+            </div>\n+          </div>\n+        </div>\n+      </section>\n+    </div>\n+    <section class=\"btn__container\">\n+      <button\n+        [disabled]=\"!addUserForm.form.valid\"\n+        type=\"submit\"\n+        name=\"add\"\n+        class=\"btn bt__add bt__add__auto mr-sm\"\n+      >\n+        Create User and Invite", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 468}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg5MzQ3NQ==", "bodyText": "The styling on this is a little strange, is there something going on here?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474893475", "createdAt": "2020-08-21T19:29:50Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,478 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Locations</label>\n+              </div>\n+              <div class=\"pl-xl pt-xs\">\n+                <span>\n+                  <input\n+                    [value]=\"permission.View\"\n+                    type=\"radio\"\n+                    id=\"location_view_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_permssion\">View</label>\n+                </span>\n+                <span>\n+                  <input\n+                    [value]=\"permission.ViewAndEdit\"\n+                    type=\"radio\"\n+                    id=\"location_view_edit_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_edit_permssion\">\n+                    View And Edit\n+                  </label>\n+                </span>\n+              </div>\n+            </div>\n+          </div>\n+        </div>\n+      </section>\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"form-group\">\n+          <div class=\"user__card__title pb-lg\">Sites, Studies and Apps</div>\n+          <div\n+            class=\"select__form-control__parent\"\n+            style=\"padding-bottom: 10px;\"\n+          >\n+            <label class=\"wrap\">\n+              Select and Add App\n+              <ng-select", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 217}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg5Mzk3Ng==", "bodyText": "I've only seen checkboxes wrapped in labels (so you have more area to click on). I think it may cause some issues wrapped around a select.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474893976", "createdAt": "2020-08-21T19:30:26Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,478 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Locations</label>\n+              </div>\n+              <div class=\"pl-xl pt-xs\">\n+                <span>\n+                  <input\n+                    [value]=\"permission.View\"\n+                    type=\"radio\"\n+                    id=\"location_view_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_permssion\">View</label>\n+                </span>\n+                <span>\n+                  <input\n+                    [value]=\"permission.ViewAndEdit\"\n+                    type=\"radio\"\n+                    id=\"location_view_edit_permssion\"\n+                    name=\"radio-group2\"\n+                    [(ngModel)]=\"user.manageLocations\"\n+                    name=\"manageLocationsPermission\"\n+                    #manageLocationsPermission=\"ngModel\"\n+                    [ngModelOptions]=\"{standalone: true}\"\n+                    [disabled]=\"!user.manageLocationsSelected\"\n+                  />\n+                  <label for=\"location_view_edit_permssion\">\n+                    View And Edit\n+                  </label>\n+                </span>\n+              </div>\n+            </div>\n+          </div>\n+        </div>\n+      </section>\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"form-group\">\n+          <div class=\"user__card__title pb-lg\">Sites, Studies and Apps</div>\n+          <div\n+            class=\"select__form-control__parent\"\n+            style=\"padding-bottom: 10px;\"\n+          >\n+            <label class=\"wrap\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 215}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg5NTc2NQ==", "bodyText": "nit: can you put the constructor after public/private properties?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474895765", "createdAt": "2020-08-21T19:32:43Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.ts", "diffHunk": "@@ -1,8 +1,160 @@\n-import {Component} from '@angular/core';\n+import {Component, OnInit} from '@angular/core';\n+import {UserService} from '../shared/user.service';\n+import {Router} from '@angular/router';\n+import {ToastrService} from 'ngx-toastr';\n+import {AppDetails, App, Study, Site} from '../shared/app-details';\n+import {User} from 'src/app/entity/user';\n+import {ApiResponse} from 'src/app/entity/api.response.model';\n+import {getMessage} from 'src/app/shared/success.codes.enum';\n+import {Permission} from 'src/app/shared/permission-enums';\n \n @Component({\n   selector: 'user-new',\n   templateUrl: './new-user.component.html',\n   styleUrls: ['./new-user.component.scss'],\n })\n-export class AddNewUserComponent {}\n+export class AddNewUserComponent implements OnInit {\n+  constructor(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDkwMzA2MQ==", "bodyText": "@ViewChildren is a safer way of getting elements from the DOM. But if the model (selectedApps) is updated when the check boxes are updated then do we really have to check both?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474903061", "createdAt": "2020-08-21T19:41:48Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.ts", "diffHunk": "@@ -1,8 +1,160 @@\n-import {Component} from '@angular/core';\n+import {Component, OnInit} from '@angular/core';\n+import {UserService} from '../shared/user.service';\n+import {Router} from '@angular/router';\n+import {ToastrService} from 'ngx-toastr';\n+import {AppDetails, App, Study, Site} from '../shared/app-details';\n+import {User} from 'src/app/entity/user';\n+import {ApiResponse} from 'src/app/entity/api.response.model';\n+import {getMessage} from 'src/app/shared/success.codes.enum';\n+import {Permission} from 'src/app/shared/permission-enums';\n \n @Component({\n   selector: 'user-new',\n   templateUrl: './new-user.component.html',\n   styleUrls: ['./new-user.component.scss'],\n })\n-export class AddNewUserComponent {}\n+export class AddNewUserComponent implements OnInit {\n+  constructor(\n+    private readonly router: Router,\n+    private readonly userService: UserService,\n+    private readonly toastr: ToastrService,\n+  ) {}\n+  appDetails = {} as AppDetails;\n+  selectedApps: App[] = [];\n+  user = {} as User;\n+  permission = Permission;\n+  sitesMessageMapping: {[k: string]: string} = {\n+    '=0': '0 Sites',\n+    '=1': '1 Site',\n+    'other': '# Sites',\n+  };\n+  ngOnInit(): void {\n+    this.getAllApps();\n+  }\n+\n+  getAllApps(): void {\n+    this.userService.getAllApps().subscribe((data) => {\n+      this.appDetails = data;\n+    });\n+  }\n+\n+  deleteAppFromList(appId: string): void {\n+    this.selectedApps = this.selectedApps.filter((obj) => obj.id !== appId);\n+  }\n+\n+  appCheckBoxChange(app: App): void {\n+    if (app.selected) {\n+      app.permission = this.permission.View;\n+      app.selectedSitesCount = app.totalSitesCount;\n+    } else {\n+      app.permission = null;\n+      app.selectedSitesCount = 0;\n+    }\n+    app.studies.forEach((study) => {\n+      study.permission = app.permission as number;\n+      study.selected = app.selected;\n+      if (study.selected) {\n+        study.selectedSitesCount = study.totalSitesCount;\n+      } else {\n+        study.selectedSitesCount = 0;\n+      }\n+      study.sites.forEach((site) => {\n+        site.permission = study.permission;\n+        site.selected = study.selected;\n+      });\n+    });\n+  }\n+\n+  appRadioButtonChange(app: App): void {\n+    app.studies.forEach((study) => {\n+      study.permission = app.permission;\n+      study.sites.forEach((site) => {\n+        site.permission = app.permission;\n+      });\n+    });\n+  }\n+\n+  studyCheckBoxChange(study: Study, app: App): void {\n+    const alreadySelectedSitesCount = study.sites.filter((s) => s.selected)\n+      .length;\n+    if (!app.selectedSitesCount) {\n+      app.selectedSitesCount = 0;\n+    }\n+    if (study.selected) {\n+      study.permission = this.permission.View;\n+      app.selectedSitesCount =\n+        app.selectedSitesCount - alreadySelectedSitesCount + study.sites.length;\n+      study.selectedSitesCount = study.sites.length;\n+    } else {\n+      study.permission = null;\n+      app.selectedSitesCount = app.selectedSitesCount - study.sites.length;\n+      study.selectedSitesCount = 0;\n+    }\n+    study.sites.forEach((site) => {\n+      site.permission = study.permission;\n+      site.selected = study.selected;\n+    });\n+  }\n+\n+  studyRadioButtonChange(study: Study): void {\n+    study.sites.forEach((site) => {\n+      site.permission = study.permission as number;\n+    });\n+  }\n+\n+  siteCheckBoxChange(site: Site, study: Study, app: App): void {\n+    if (!study.selectedSitesCount) {\n+      study.selectedSitesCount = 0;\n+    }\n+    if (!app.selectedSitesCount) {\n+      app.selectedSitesCount = 0;\n+    }\n+    if (site.selected) {\n+      site.permission = this.permission.View;\n+      study.selectedSitesCount += 1;\n+      app.selectedSitesCount += 1;\n+    } else {\n+      site.permission = null;\n+      study.selectedSitesCount -= 1;\n+      app.selectedSitesCount -= 1;\n+    }\n+  }\n+\n+  locationsCheckBoxChange(): void {\n+    if (this.user.manageLocationsSelected) {\n+      this.user.manageLocations = this.permission.View;\n+    } else {\n+      this.user.manageLocations = null;\n+    }\n+  }\n+\n+  add(): void {\n+    const checkedBoxes = document.querySelectorAll(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 134}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDkwNDY0OQ==", "bodyText": "This is a request to the apps API, so it would be better to put this in an AppService", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r474904649", "createdAt": "2020-08-21T19:43:45Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/shared/user.service.ts", "diffHunk": "@@ -1,6 +1,22 @@\n import {Injectable} from '@angular/core';\n+import {HttpClient} from '@angular/common/http';\n+import {AppDetails} from './app-details';\n+import {Observable} from 'rxjs';\n+import {environment} from '@environment';\n+import {ApiResponse} from 'src/app/entity/api.response.model';\n+import {User} from 'src/app/entity/user';\n \n @Injectable({\n   providedIn: 'root',\n })\n-export class UserService {}\n+export class UserService {\n+  constructor(private readonly http: HttpClient) {}\n+  getAllApps(): Observable<AppDetails> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ede459fee3f6992779ab9fc6e8227fc581ec76d7", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ede459fee3f6992779ab9fc6e8227fc581ec76d7", "committedDate": "2020-08-23T09:52:02Z", "message": "code review comments has been resolved."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNDUyMjQy", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#pullrequestreview-473452242", "createdAt": "2020-08-24T13:15:15Z", "commit": {"oid": "ede459fee3f6992779ab9fc6e8227fc581ec76d7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzoxNToxNVrOHFjxKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzoxNjoxNFrOHFjzcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU5MDk1Mg==", "bodyText": "Use params option instead of building the query", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r475590952", "createdAt": "2020-08-24T13:15:15Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/apps/shared/apps.service.ts", "diffHunk": "@@ -2,13 +2,24 @@ import {Injectable} from '@angular/core';\n import {EntityService} from 'src/app/service/entity.service';\n import {App} from './app.model';\n import {Observable} from 'rxjs';\n+import {AppDetails} from '../../user/shared/app-details';\n+import {environment} from '@environment';\n+import {HttpClient} from '@angular/common/http';\n \n @Injectable({\n   providedIn: 'root',\n })\n export class AppsService {\n-  constructor(private readonly entityService: EntityService<App>) {}\n+  constructor(\n+    private readonly entityService: EntityService<App>,\n+    private readonly http: HttpClient,\n+  ) {}\n   getApps(): Observable<App[]> {\n     return this.entityService.getCollection('apps');\n   }\n+  getAllApps(): Observable<AppDetails> {\n+    return this.http.get<AppDetails>(\n+      `${environment.baseUrl}/apps?fields=studies,sites`,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ede459fee3f6992779ab9fc6e8227fc581ec76d7"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU5MTUzNg==", "bodyText": "Why is this different than getApps()? Can you use different function names to distinguish the difference?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r475591536", "createdAt": "2020-08-24T13:16:14Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/apps/shared/apps.service.ts", "diffHunk": "@@ -2,13 +2,24 @@ import {Injectable} from '@angular/core';\n import {EntityService} from 'src/app/service/entity.service';\n import {App} from './app.model';\n import {Observable} from 'rxjs';\n+import {AppDetails} from '../../user/shared/app-details';\n+import {environment} from '@environment';\n+import {HttpClient} from '@angular/common/http';\n \n @Injectable({\n   providedIn: 'root',\n })\n export class AppsService {\n-  constructor(private readonly entityService: EntityService<App>) {}\n+  constructor(\n+    private readonly entityService: EntityService<App>,\n+    private readonly http: HttpClient,\n+  ) {}\n   getApps(): Observable<App[]> {\n     return this.entityService.getCollection('apps');\n   }\n+  getAllApps(): Observable<AppDetails> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ede459fee3f6992779ab9fc6e8227fc581ec76d7"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c1383eb0aa421868e6e987e477f6dced0115867", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7c1383eb0aa421868e6e987e477f6dced0115867", "committedDate": "2020-08-24T14:27:08Z", "message": "code review comments has been resolved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0dc26efd8c43a3b78d3f652b54ddfae1c65d27b", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f0dc26efd8c43a3b78d3f652b54ddfae1c65d27b", "committedDate": "2020-08-24T14:27:47Z", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into participant-manager-webapp-add-admin"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDczNTkxNjE2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#pullrequestreview-473591616", "createdAt": "2020-08-24T15:04:37Z", "commit": {"oid": "f0dc26efd8c43a3b78d3f652b54ddfae1c65d27b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNTowNDozN1rOHFpcMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNToyMjowMVrOHFqKgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY4Mzg5MQ==", "bodyText": "getUserApps", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r475683891", "createdAt": "2020-08-24T15:04:37Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/apps/shared/apps.service.ts", "diffHunk": "@@ -14,12 +14,12 @@ export class AppsService {\n     private readonly entityService: EntityService<App>,\n     private readonly http: HttpClient,\n   ) {}\n-  getApps(): Observable<App[]> {\n+  getAppsOfUser(): Observable<App[]> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0dc26efd8c43a3b78d3f652b54ddfae1c65d27b"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY4ODU2MA==", "bodyText": "Honestly I'm a bit confused either way. But we may as well keep it this way. It might make more sense if the user could select the View/View and Edit, and the checkbox would automatically check? But I leave it up to the UI team's judgement.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r475688560", "createdAt": "2020-08-24T15:11:26Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,478 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Locations</label>\n+              </div>\n+              <div class=\"pl-xl pt-xs\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg5MDgwNg=="}, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 172}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY4OTg1NQ==", "bodyText": "This is an action, so we shouldn't be using titlecase. Invite should be lowercase.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r475689855", "createdAt": "2020-08-24T15:13:18Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -462,9 +459,9 @@ <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n         [disabled]=\"!addUserForm.form.valid\"\n         type=\"submit\"\n         name=\"add\"\n-        class=\"btn bt__add bt__add__auto mr-sm\"\n+        class=\"btn bt__add bt__add__auto mr-lg\"\n       >\n-        Create User and Invite\n+        Add user and Invite", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0dc26efd8c43a3b78d3f652b54ddfae1c65d27b"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY5MTUxMQ==", "bodyText": "Can you remove the text-transform from labels? text-transform: capitalize doesn't really work, stopwords like \"to\" should always be lowercase, even in titles. But this isn't a title, so sentence case is correct for labels like this.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r475691511", "createdAt": "2020-08-24T15:15:46Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.html", "diffHunk": "@@ -1 +1,475 @@\n-<p>add-new-user works!</p>\n+<section class=\"subheader p-none pl-none\">\n+  <div class=\"max__w__850 m-none\">\n+    <div class=\"row\">\n+      <div class=\"col-xs-12 col-md-12 pl-none\">\n+        <a routerLink=\"/coordinator/users\" class=\"subheader__title\">\n+          <img class=\"mr-sm\" src=\"assets/svgs/back-arrow.svg\" alt=\"Go Back\" />\n+          <span class=\"ml-xs\">Add New User</span>\n+        </a>\n+      </div>\n+    </div>\n+  </div>\n+</section>\n+\n+<section class=\"max__w__850 add__location\">\n+  <form #addUserForm=\"ngForm\" autocomplete=\"off\" (submit)=\"add()\">\n+    <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+      <div class=\"row border-bottom__c4d1e6\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"fname\">First Name</label>\n+            <input\n+              placeholder=\"Enter First Name\"\n+              type=\"text\"\n+              class=\"form-control\"\n+              id=\"fname\"\n+              minlength=\"3\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.firstName\"\n+              name=\"firstName\"\n+              #firstName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+            />\n+            <div\n+              class=\"validation-error\"\n+              *ngIf=\"\n+                firstName.invalid && (firstName.dirty || firstName.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"firstName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none\">\n+          <div class=\"form-group\">\n+            <label for=\"lname\">Last Name</label>\n+            <input\n+              type=\"text\"\n+              minlength=\"2\"\n+              maxlength=\"50\"\n+              [(ngModel)]=\"user.lastName\"\n+              name=\"lastName\"\n+              #lastName=\"ngModel\"\n+              required\n+              pattern=\".*[^ ].*\"\n+              class=\"form-control\"\n+              id=\"lname\"\n+              placeholder=\"Enter Last Name\"\n+            />\n+\n+            <div\n+              *ngIf=\"lastName.invalid && (lastName.dirty || lastName.touched)\"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"lastName.errors?.pattern\"\n+              >\n+                Please fill out this field.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+      <div class=\"row\">\n+        <div class=\"col-xs-12 col-md-6 p-none border-right__c4d1e6\">\n+          <div class=\"form-group\">\n+            <label for=\"emailId\">Email ID</label>\n+            <input\n+              type=\"email\"\n+              class=\"form-control\"\n+              id=\"emailId\"\n+              placeholder=\"Enter Email\"\n+              [(ngModel)]=\"user.email\"\n+              pattern='((\"[\\w-\\s]+\")|([\\w-]+(?:\\.[\\w-]+)*)|(\"[\\w-\\s]+\")([\\w-]+(?:\\.[\\w-]+)*))(@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,6}(?:\\.[a-z]{2})?)$)|(@\\[?((25[0-5]\\.|2[0-4][0-9]\\.|1[0-9]{2}\\.|[0-9]{1,2}\\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\\]?$)'\n+              name=\"emailText\"\n+              #emailText=\"ngModel\"\n+              required\n+            />\n+            <div\n+              *ngIf=\"\n+                emailText.invalid && (emailText.dirty || emailText.touched)\n+              \"\n+            >\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.required\"\n+              >\n+                Please fill out this field.\n+              </span>\n+              <span\n+                class=\"help-block with-errors error__msg\"\n+                *ngIf=\"emailText.errors?.pattern\"\n+              >\n+                Email is invalid.\n+              </span>\n+            </div>\n+          </div>\n+        </div>\n+        <div class=\"col-xs-12 col-md-6 p-none flex__justify__space-between\">\n+          <div class=\"form-group\">\n+            <label>Role</label>\n+            <div class=\"custom__labels\">\n+              <input\n+                type=\"checkbox\"\n+                id=\"Users\"\n+                [(ngModel)]=\"user.superAdmin\"\n+                name=\"superAdminCheckBox\"\n+                #superAdminCheckBox=\"ngModel\"\n+              />\n+              <label class=\"mt-xs\" for=\"Users\">\n+                Super Admin\n+                <span\n+                  class=\"tool\"\n+                  data-tip=\"A superadmin user has application-wide permissions; can manage users and in addition, can manage locations and all sites, studies and apps. Non-superadmin users or Site Admins, will have permission-based access to manage locations and specific sites, studies and apps only.\"\n+                  tabindex=\"1\"\n+                >\n+                  <i class=\"fa fa-info-circle ml-sm\" aria-hidden=\"true\"></i>\n+                </span>\n+              </label>\n+            </div>\n+          </div>\n+        </div>\n+      </div>\n+    </section>\n+    <div *ngIf=\"!user.superAdmin\">\n+      <h2 class=\"subheader__title mb-sm\">Permissions</h2>\n+\n+      <section class=\"bg__white card__inside__pad box__shadow-cmn m-none\">\n+        <div class=\"row\">\n+          <div class=\"col-xs-12 col-md-12 p-none\">\n+            <div class=\"form-group\">\n+              <div class=\"custom__labels\">\n+                <input\n+                  type=\"checkbox\"\n+                  id=\"location\"\n+                  [(ngModel)]=\"user.manageLocationsSelected\"\n+                  name=\"manageLocationsSelected\"\n+                  #manageLocationsSelected=\"ngModel\"\n+                  [ngModelOptions]=\"{standalone: true}\"\n+                  (change)=\"locationsCheckBoxChange()\"\n+                />\n+                <label for=\"location\">Allow access to locations</label>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0dc26efd8c43a3b78d3f652b54ddfae1c65d27b"}, "originalPosition": 170}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY5NTc0Ng==", "bodyText": "I prefer the looping solution because it corresponds better to the business logic here. It's not clear why certain checkboxes would be called \"checkbox2\". You also hardly ever see document.querySelector in an Angular application, it's generally a code smell.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#discussion_r475695746", "createdAt": "2020-08-24T15:22:01Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/user/new-user/new-user.component.ts", "diffHunk": "@@ -1,8 +1,160 @@\n-import {Component} from '@angular/core';\n+import {Component, OnInit} from '@angular/core';\n+import {UserService} from '../shared/user.service';\n+import {Router} from '@angular/router';\n+import {ToastrService} from 'ngx-toastr';\n+import {AppDetails, App, Study, Site} from '../shared/app-details';\n+import {User} from 'src/app/entity/user';\n+import {ApiResponse} from 'src/app/entity/api.response.model';\n+import {getMessage} from 'src/app/shared/success.codes.enum';\n+import {Permission} from 'src/app/shared/permission-enums';\n \n @Component({\n   selector: 'user-new',\n   templateUrl: './new-user.component.html',\n   styleUrls: ['./new-user.component.scss'],\n })\n-export class AddNewUserComponent {}\n+export class AddNewUserComponent implements OnInit {\n+  constructor(\n+    private readonly router: Router,\n+    private readonly userService: UserService,\n+    private readonly toastr: ToastrService,\n+  ) {}\n+  appDetails = {} as AppDetails;\n+  selectedApps: App[] = [];\n+  user = {} as User;\n+  permission = Permission;\n+  sitesMessageMapping: {[k: string]: string} = {\n+    '=0': '0 Sites',\n+    '=1': '1 Site',\n+    'other': '# Sites',\n+  };\n+  ngOnInit(): void {\n+    this.getAllApps();\n+  }\n+\n+  getAllApps(): void {\n+    this.userService.getAllApps().subscribe((data) => {\n+      this.appDetails = data;\n+    });\n+  }\n+\n+  deleteAppFromList(appId: string): void {\n+    this.selectedApps = this.selectedApps.filter((obj) => obj.id !== appId);\n+  }\n+\n+  appCheckBoxChange(app: App): void {\n+    if (app.selected) {\n+      app.permission = this.permission.View;\n+      app.selectedSitesCount = app.totalSitesCount;\n+    } else {\n+      app.permission = null;\n+      app.selectedSitesCount = 0;\n+    }\n+    app.studies.forEach((study) => {\n+      study.permission = app.permission as number;\n+      study.selected = app.selected;\n+      if (study.selected) {\n+        study.selectedSitesCount = study.totalSitesCount;\n+      } else {\n+        study.selectedSitesCount = 0;\n+      }\n+      study.sites.forEach((site) => {\n+        site.permission = study.permission;\n+        site.selected = study.selected;\n+      });\n+    });\n+  }\n+\n+  appRadioButtonChange(app: App): void {\n+    app.studies.forEach((study) => {\n+      study.permission = app.permission;\n+      study.sites.forEach((site) => {\n+        site.permission = app.permission;\n+      });\n+    });\n+  }\n+\n+  studyCheckBoxChange(study: Study, app: App): void {\n+    const alreadySelectedSitesCount = study.sites.filter((s) => s.selected)\n+      .length;\n+    if (!app.selectedSitesCount) {\n+      app.selectedSitesCount = 0;\n+    }\n+    if (study.selected) {\n+      study.permission = this.permission.View;\n+      app.selectedSitesCount =\n+        app.selectedSitesCount - alreadySelectedSitesCount + study.sites.length;\n+      study.selectedSitesCount = study.sites.length;\n+    } else {\n+      study.permission = null;\n+      app.selectedSitesCount = app.selectedSitesCount - study.sites.length;\n+      study.selectedSitesCount = 0;\n+    }\n+    study.sites.forEach((site) => {\n+      site.permission = study.permission;\n+      site.selected = study.selected;\n+    });\n+  }\n+\n+  studyRadioButtonChange(study: Study): void {\n+    study.sites.forEach((site) => {\n+      site.permission = study.permission as number;\n+    });\n+  }\n+\n+  siteCheckBoxChange(site: Site, study: Study, app: App): void {\n+    if (!study.selectedSitesCount) {\n+      study.selectedSitesCount = 0;\n+    }\n+    if (!app.selectedSitesCount) {\n+      app.selectedSitesCount = 0;\n+    }\n+    if (site.selected) {\n+      site.permission = this.permission.View;\n+      study.selectedSitesCount += 1;\n+      app.selectedSitesCount += 1;\n+    } else {\n+      site.permission = null;\n+      study.selectedSitesCount -= 1;\n+      app.selectedSitesCount -= 1;\n+    }\n+  }\n+\n+  locationsCheckBoxChange(): void {\n+    if (this.user.manageLocationsSelected) {\n+      this.user.manageLocations = this.permission.View;\n+    } else {\n+      this.user.manageLocations = null;\n+    }\n+  }\n+\n+  add(): void {\n+    const checkedBoxes = document.querySelectorAll(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDkwMzA2MQ=="}, "originalCommit": {"oid": "baaf716668aad99dd12f36606d8f7f637e1d5c2b"}, "originalPosition": 134}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8056425cb76841ba8c5e2077dbebe237d4583bb3", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8056425cb76841ba8c5e2077dbebe237d4583bb3", "committedDate": "2020-08-26T08:22:55Z", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into participant-manager-webapp-add-admin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac78081616222f2b0e713fe5d8e1fa13417f90d2", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ac78081616222f2b0e713fe5d8e1fa13417f90d2", "committedDate": "2020-08-26T08:28:46Z", "message": "code review comments has been reslved"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1NTQzNTI0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/790#pullrequestreview-475543524", "createdAt": "2020-08-26T14:25:10Z", "commit": {"oid": "ac78081616222f2b0e713fe5d8e1fa13417f90d2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad4162a777cfdc1b95efe387fcd60e7e26532a11", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ad4162a777cfdc1b95efe387fcd60e7e26532a11", "committedDate": "2020-08-26T15:28:55Z", "message": "Merge branch 'develop' into participant-manager-webapp-add-admin"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 718, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}