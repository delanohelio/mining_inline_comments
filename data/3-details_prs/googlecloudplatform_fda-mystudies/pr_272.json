{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwOTE4MTc0", "number": 272, "title": "Setup app-specific secrets.", "bodyText": "", "createdAt": "2020-04-29T19:50:28Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/272", "merged": true, "mergeCommit": {"oid": "335aaf44ffe299c856e85cc33fa55390c664bb8a"}, "closed": true, "closedAt": "2020-04-29T21:10:35Z", "author": {"login": "kuoyuchi"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccdQcPAH2gAyNDEwOTE4MTc0OjAxNWQ1Y2M4ZTNmZThmMTc5NjYwYjlmNGM2MTYxNzFkMWQ4ODA4NmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccfAXUgH2gAyNDEwOTE4MTc0OjJmNWU1ZjlkNDU0MzVlM2IxNTVlM2RjOWM1MjZjOGE1OTk3YmI0YTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "015d5cc8e3fe8f179660b9f4c616171d1d88086f", "author": {"user": {"login": "kuoyuchi", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/015d5cc8e3fe8f179660b9f4c616171d1d88086f", "committedDate": "2020-04-29T19:01:10Z", "message": "Generate google_secret_manager_secrets for client_id and secret_key"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf7610d1b600443326a06f4bb233e9af65d2b856", "author": {"user": {"login": "kuoyuchi", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/cf7610d1b600443326a06f4bb233e9af65d2b856", "committedDate": "2020-04-29T19:49:24Z", "message": "Introduce new app-specific kubernetes secrets."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyOTkzNDg0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/272#pullrequestreview-402993484", "createdAt": "2020-04-29T19:59:15Z", "commit": {"oid": "cf7610d1b600443326a06f4bb233e9af65d2b856"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxOTo1OToxNVrOGOOxdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQxOTo1OToxNVrOGOOxdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU3NTI4Ng==", "bodyText": "thanks for adding these!", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/272#discussion_r417575286", "createdAt": "2020-04-29T19:59:15Z", "author": {"login": "zohrehj"}, "path": "Terraform/kubernetes/secrets.tf", "diffHunk": "@@ -46,7 +53,9 @@ data \"google_secret_manager_secret_version\" \"secrets\" {\n       \"my-studies-email-password\",\n     ],\n     formatlist(\"%s-db-user\", local.apps),\n-    formatlist(\"%s-db-password\", local.apps))\n+    formatlist(\"%s-db-password\", local.apps),\n+    formatlist(\"mystudies-%s-client-id\", local.auth_server_app_codes),\n+    formatlist(\"mystudies-%s-secret-key\", local.auth_server_app_codes))\n   )", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7610d1b600443326a06f4bb233e9af65d2b856"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAzMDAyNTAy", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/272#pullrequestreview-403002502", "createdAt": "2020-04-29T20:12:18Z", "commit": {"oid": "cf7610d1b600443326a06f4bb233e9af65d2b856"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQyMDoxMjoxOFrOGOPNPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOVQyMDoxMjoxOFrOGOPNPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzU4MjM5OA==", "bodyText": "where is apps_db_names used?\nalso we really need to clean these up :-(", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/272#discussion_r417582398", "createdAt": "2020-04-29T20:12:18Z", "author": {"login": "zohrehj"}, "path": "Terraform/secrets/main.tf", "diffHunk": "@@ -26,6 +26,31 @@ terraform {\n   }\n }\n \n+locals {\n+  apps = [\n+    \"auth-server\",\n+    \"response-server\",\n+    \"study-designer\",\n+    \"study-meta-data\",\n+    \"user-registration\",\n+  ]\n+  apps_db_names = {\n+    \"auth-server\"       = \"auth_server\"\n+    \"response-server\"   = \"mystudies_response_server\"\n+    \"study-designer\"    = \"fda_hphc\"\n+    \"study-meta-data\"   = \"fda_hphc\"\n+    \"user-registration\" = \"mystudies_userregistration\"\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf7610d1b600443326a06f4bb233e9af65d2b856"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aea0aebb8334ad576510883ecb0576f0dbc466d0", "author": {"user": {"login": "kuoyuchi", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/aea0aebb8334ad576510883ecb0576f0dbc466d0", "committedDate": "2020-04-29T20:47:09Z", "message": "Remove unused variables."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18026c7c8dda219a6ccb34d0afc477a6b2547e11", "author": {"user": {"login": "kuoyuchi", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/18026c7c8dda219a6ccb34d0afc477a6b2547e11", "committedDate": "2020-04-29T20:49:01Z", "message": "Merge branch 'early-access' into tf-secrets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c8e534e7c4e601a71310a364ecce454aa70a32c", "author": {"user": {"login": "kuoyuchi", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1c8e534e7c4e601a71310a364ecce454aa70a32c", "committedDate": "2020-04-29T21:02:58Z", "message": "run terraform fmt to fix presubmit."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f5e5f9d45435e3b155e3dc9c526c8a5997bb4a4", "author": {"user": {"login": "kuoyuchi", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2f5e5f9d45435e3b155e3dc9c526c8a5997bb4a4", "committedDate": "2020-04-29T21:03:25Z", "message": "Merge branch 'tf-secrets' of https://github.com/GoogleCloudPlatform/fda-mystudies into tf-secrets"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1191, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}