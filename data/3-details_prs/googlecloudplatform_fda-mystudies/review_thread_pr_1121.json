{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MDQ1MDgw", "number": 1121, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMzo1MzoxOVrOEuAZhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMzo1MzoxOVrOEuAZhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE2Njc2NDg2OnYy", "diffSide": "RIGHT", "path": "iOS/HPHC/HPHC/Controllers/SplashViewController.swift", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMzo1MzoxOVrOHiI-iA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMFQxNzo1OTozMFrOHlKYzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU2MDcxMg==", "bodyText": "This is dangerous and could make your app vulnerable to future attacks. You should not make any changes to the flow of the code in order to test it.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1121#discussion_r505560712", "createdAt": "2020-10-15T13:53:19Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Controllers/SplashViewController.swift", "diffHunk": "@@ -60,7 +60,7 @@ class SplashViewController: UIViewController {\n       self.initilizeStudyForStandaloneApp()\n     } else {\n \n-      if User.currentUser.authToken != nil {\n+      if User.currentUser.authToken != nil || isTestingLoggedUser {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0aa2783e13476b8af398232b0ef5db752e7aec19"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODE5MjAyNg==", "bodyText": "This is the App launch argument passed from the test bundle and common practice to mock some exceptional cases.\nvar isTestingLoggedUser: Bool { return ProcessInfo.processInfo.arguments.contains(\"LOGGED_USER\") }\nIn case of change the password, the user should be logged In. There're two ways to listen to this launch argument, either in the test bundle or in the App. From the test bundle, we can run the test case to log in to the test user before executing the actual test case but I can't mock the login part as it's on web.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1121#discussion_r508192026", "createdAt": "2020-10-20T03:47:12Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Controllers/SplashViewController.swift", "diffHunk": "@@ -60,7 +60,7 @@ class SplashViewController: UIViewController {\n       self.initilizeStudyForStandaloneApp()\n     } else {\n \n-      if User.currentUser.authToken != nil {\n+      if User.currentUser.authToken != nil || isTestingLoggedUser {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU2MDcxMg=="}, "originalCommit": {"oid": "0aa2783e13476b8af398232b0ef5db752e7aec19"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODQ2NzYzOA==", "bodyText": "Can you stub the request to the web login and return a fake login token?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1121#discussion_r508467638", "createdAt": "2020-10-20T12:42:56Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Controllers/SplashViewController.swift", "diffHunk": "@@ -60,7 +60,7 @@ class SplashViewController: UIViewController {\n       self.initilizeStudyForStandaloneApp()\n     } else {\n \n-      if User.currentUser.authToken != nil {\n+      if User.currentUser.authToken != nil || isTestingLoggedUser {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU2MDcxMg=="}, "originalCommit": {"oid": "0aa2783e13476b8af398232b0ef5db752e7aec19"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODcxNDEyMQ==", "bodyText": "No, mocking the web login requires it to be loaded. I've already tried many ways to make it easy and found this to be working fine.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1121#discussion_r508714121", "createdAt": "2020-10-20T17:34:56Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Controllers/SplashViewController.swift", "diffHunk": "@@ -60,7 +60,7 @@ class SplashViewController: UIViewController {\n       self.initilizeStudyForStandaloneApp()\n     } else {\n \n-      if User.currentUser.authToken != nil {\n+      if User.currentUser.authToken != nil || isTestingLoggedUser {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU2MDcxMg=="}, "originalCommit": {"oid": "0aa2783e13476b8af398232b0ef5db752e7aec19"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODcyNDcxNw==", "bodyText": "not mocking, stubbing the get request that loads the URL and instead running the function that returns the fake login token.\nThis discussion is getting long, please file a bug to address this in a separate PR and I will approve to unblock you for now.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1121#discussion_r508724717", "createdAt": "2020-10-20T17:52:02Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Controllers/SplashViewController.swift", "diffHunk": "@@ -60,7 +60,7 @@ class SplashViewController: UIViewController {\n       self.initilizeStudyForStandaloneApp()\n     } else {\n \n-      if User.currentUser.authToken != nil {\n+      if User.currentUser.authToken != nil || isTestingLoggedUser {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU2MDcxMg=="}, "originalCommit": {"oid": "0aa2783e13476b8af398232b0ef5db752e7aec19"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODcyOTU1MA==", "bodyText": "There are multiple calls happening in the login flow. I've opened issue #1563 to update the test case with another possible approach later.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1121#discussion_r508729550", "createdAt": "2020-10-20T17:59:30Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Controllers/SplashViewController.swift", "diffHunk": "@@ -60,7 +60,7 @@ class SplashViewController: UIViewController {\n       self.initilizeStudyForStandaloneApp()\n     } else {\n \n-      if User.currentUser.authToken != nil {\n+      if User.currentUser.authToken != nil || isTestingLoggedUser {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU2MDcxMg=="}, "originalCommit": {"oid": "0aa2783e13476b8af398232b0ef5db752e7aec19"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1870, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}