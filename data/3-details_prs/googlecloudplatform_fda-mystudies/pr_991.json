{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5NDAzNDQw", "number": 991, "title": "Participant manager webapp header changes based on logged in user", "bodyText": "", "createdAt": "2020-09-18T15:55:57Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991", "merged": true, "mergeCommit": {"oid": "a9adc4658a52bd4cd79684e7b325110524011585"}, "closed": true, "closedAt": "2020-09-25T09:58:08Z", "author": {"login": "firdosebtc1"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdKDaY4gH2gAyNDg5NDAzNDQwOjdhZmViNTQ0M2U0YjJmZjdhZjUzMDNkYWM0NmU5YmNjODNmYmNmNTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLay22gFqTQ5MzY1NTkwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7afeb5443e4b2ff7af5303dac46e9bcc83fbcf56", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7afeb5443e4b2ff7af5303dac46e9bcc83fbcf56", "committedDate": "2020-09-18T10:55:01Z", "message": "header implementation for permission"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba6875eae701e668f8612eef3b96e9a358f25af0", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ba6875eae701e668f8612eef3b96e9a358f25af0", "committedDate": "2020-09-18T15:54:36Z", "message": "Merge branch 'participant-manager-webapp-Login-Setup-implementation' of https://github.com/GoogleCloudPlatform/fda-mystudies into participant-manager-webapp-header-changes\n\n# Conflicts:\n#\tUR-web-app/src/app/auth/login-callback/login-callback.component.ts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bec996851b7855ba9461982e66c8ee98f39b9072", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/bec996851b7855ba9461982e66c8ee98f39b9072", "committedDate": "2020-09-18T15:59:37Z", "message": "formatting has been dobe"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxNzU5Njc1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#pullrequestreview-491759675", "createdAt": "2020-09-18T20:24:51Z", "commit": {"oid": "bec996851b7855ba9461982e66c8ee98f39b9072"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDoyNDo1MVrOHUa2OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xOFQyMDoyNzo1M1rOHUa7PQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3MzQzMw==", "bodyText": "nit: use ?. to avoid having multiple checks, i.e. user?.manageLocations !== null", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#discussion_r491173433", "createdAt": "2020-09-18T20:24:51Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/mobile-menu/mobile-menu.component.html", "diffHunk": "@@ -75,6 +75,10 @@\n         </li>\n         <li>\n           <a\n+            *ngIf=\"\n+              (user && user.manageLocations !== null) ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bec996851b7855ba9461982e66c8ee98f39b9072"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTE3NDcxNw==", "bodyText": "Can you move this to the UserService and use it here and in mobile-menu? Centralizing the logic ensures: the key doesn't change, parsing doesn't change, the default is consistently {}, etc. Basically sessionStorage.getItem(key) should only be called in one place for each key.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#discussion_r491174717", "createdAt": "2020-09-18T20:27:53Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/site-coordinator/sitecoordinator.component.ts", "diffHunk": "@@ -12,10 +13,14 @@ export class SiteCoordinatorComponent implements OnInit {\n   showSearchBar = false;\n   filterQuery = '';\n   searchBar: SearchBar | undefined;\n+  user = {} as Profile;\n \n   constructor(private readonly searchService: SearchService) {}\n \n   ngOnInit(): void {\n+    const userObject = sessionStorage.getItem('user');", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bec996851b7855ba9461982e66c8ee98f39b9072"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e70bf6cc3bf6f154388e64918a53812fb0e3470", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1e70bf6cc3bf6f154388e64918a53812fb0e3470", "committedDate": "2020-09-21T10:15:29Z", "message": "code review comments has been resolved"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNTk4NjM3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#pullrequestreview-492598637", "createdAt": "2020-09-21T13:27:22Z", "commit": {"oid": "1e70bf6cc3bf6f154388e64918a53812fb0e3470"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMzoyNzoyMlrOHVP7-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMzoyNzoyMlrOHVP7-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA0MzI1OQ==", "bodyText": "You don't need to save this as a property. It can just be a local variable with how this is written.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#discussion_r492043259", "createdAt": "2020-09-21T13:27:22Z", "author": {"login": "nikklassen"}, "path": "UR-web-app/src/app/service/user.service.ts", "diffHunk": "@@ -3,11 +3,20 @@ import {HttpClient} from '@angular/common/http';\n import {User} from '../entity/user';\n import {Observable} from 'rxjs';\n import {environment} from 'src/environments/environment';\n+import {Profile} from '../site-coordinator/account/shared/profile.model';\n @Injectable({providedIn: 'root'})\n export class UserService {\n+  user = {} as Profile;\n+\n   constructor(private readonly http: HttpClient) {}\n \n   getUserDetails(): Observable<User> {\n     return this.http.get<User>(`${environment.baseUrl}/users/profile`);\n   }\n+\n+  getUserProfile(): Profile {\n+    const userObject = sessionStorage.getItem('user');\n+    if (userObject) this.user = JSON.parse(userObject) as Profile;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e70bf6cc3bf6f154388e64918a53812fb0e3470"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c97998d7ef5f4a8ac56d968576e875c687357514", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c97998d7ef5f4a8ac56d968576e875c687357514", "committedDate": "2020-09-21T15:42:16Z", "message": "code review comments has been resolved"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ba5a56b0fca7a72824e56bfacc162e42c0270b3", "author": {"user": {"login": "rohithd-btc", "name": "Rohith D C"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2ba5a56b0fca7a72824e56bfacc162e42c0270b3", "committedDate": "2020-09-21T15:47:13Z", "message": "build issue fix\n\nbuild issue fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45aa0e5333ea76c97a00f52c2fa20287cbd0b6c1", "author": {"user": {"login": "firdosebtc1", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/45aa0e5333ea76c97a00f52c2fa20287cbd0b6c1", "committedDate": "2020-09-21T16:17:30Z", "message": "test build issues fixed"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzNjU1OTAw", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/991#pullrequestreview-493655900", "createdAt": "2020-09-22T16:43:29Z", "commit": {"oid": "45aa0e5333ea76c97a00f52c2fa20287cbd0b6c1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 270, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}