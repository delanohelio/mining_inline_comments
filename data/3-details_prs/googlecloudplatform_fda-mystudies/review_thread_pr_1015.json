{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkxNTIzMTM1", "number": 1015, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxNDo0NTowMFrOEnfINw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODo1OTozNFrOEpKeBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5ODM5OTI3OnYy", "diffSide": "RIGHT", "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantActivitiesBo.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxNDo0NTowMFrOHYGt5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTowODoyOFrOHaiUIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAzNzkyNw==", "bodyText": "shouldn't participantId be a foreign key?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r495037927", "createdAt": "2020-09-25T14:45:00Z", "author": {"login": "zohrehj"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantActivitiesBo.java", "diffHunk": "@@ -15,14 +15,22 @@\n import javax.persistence.GeneratedValue;\n import javax.persistence.GenerationType;\n import javax.persistence.Id;\n+import javax.persistence.Index;\n import javax.persistence.Table;\n import lombok.Getter;\n import lombok.Setter;\n \n @Setter\n @Getter\n @Entity\n-@Table(name = \"participant_activities\")\n+@Table(\n+    name = \"participant_activities\",\n+    indexes = {\n+      @Index(\n+          name = \"participant_activities_participant_identifier_idx\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d34c070b9d5e82041d75d4c17e23232bb80e9d87"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU4NzIzMw==", "bodyText": "participantId can not be a foreign key in Response Server. This value is coming from Mobile during [POST] /participant/update-activity-state api endpoint.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r497587233", "createdAt": "2020-09-30T15:08:28Z", "author": {"login": "monica-BTC"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantActivitiesBo.java", "diffHunk": "@@ -15,14 +15,22 @@\n import javax.persistence.GeneratedValue;\n import javax.persistence.GenerationType;\n import javax.persistence.Id;\n+import javax.persistence.Index;\n import javax.persistence.Table;\n import lombok.Getter;\n import lombok.Setter;\n \n @Setter\n @Getter\n @Entity\n-@Table(name = \"participant_activities\")\n+@Table(\n+    name = \"participant_activities\",\n+    indexes = {\n+      @Index(\n+          name = \"participant_activities_participant_identifier_idx\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAzNzkyNw=="}, "originalCommit": {"oid": "d34c070b9d5e82041d75d4c17e23232bb80e9d87"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA5ODQwNjU4OnYy", "diffSide": "RIGHT", "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantBo.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxNDo0Njo1MFrOHYGyew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTowODozMVrOHaiUUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAzOTA5OQ==", "bodyText": "if token needs to be unique, please add the unique annotation to it and see if that generates the index. If hibernate/SQL creates the index already (as I think MySQL would), then that is the preferred approach.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r495039099", "createdAt": "2020-09-25T14:46:50Z", "author": {"login": "zohrehj"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantBo.java", "diffHunk": "@@ -16,10 +16,18 @@\n import javax.persistence.GeneratedValue;\n import javax.persistence.GenerationType;\n import javax.persistence.Id;\n+import javax.persistence.Index;\n import javax.persistence.Table;\n \n @Entity\n-@Table(name = \"participant_info\")\n+@Table(\n+    name = \"participant_info\",\n+    indexes = {\n+      @Index(\n+          name = \"participant_info_token_identifier_idx\",\n+          columnList = \"token_identifier\",\n+          unique = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d34c070b9d5e82041d75d4c17e23232bb80e9d87"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU4NzI4MA==", "bodyText": "Removed unique from participant_info_token_identifier_idx as discussed with the team. Token identifier may not be unique. It is a hashed version of a user's enrollment token. There is no requirement that the enrollment token is unique across studies. This means that if there is a possibility that the token is not unique", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r497587280", "createdAt": "2020-09-30T15:08:31Z", "author": {"login": "monica-BTC"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/ParticipantBo.java", "diffHunk": "@@ -16,10 +16,18 @@\n import javax.persistence.GeneratedValue;\n import javax.persistence.GenerationType;\n import javax.persistence.Id;\n+import javax.persistence.Index;\n import javax.persistence.Table;\n \n @Entity\n-@Table(name = \"participant_info\")\n+@Table(\n+    name = \"participant_info\",\n+    indexes = {\n+      @Index(\n+          name = \"participant_info_token_identifier_idx\",\n+          columnList = \"token_identifier\",\n+          unique = true)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAzOTA5OQ=="}, "originalCommit": {"oid": "d34c070b9d5e82041d75d4c17e23232bb80e9d87"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTA2OTEzOnYy", "diffSide": "RIGHT", "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/response/model/ParticipantActivity.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNTowNzoxNFrOHaiQZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNTo1NDoxOFrOHbQ-dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU4NjI3Ng==", "bodyText": "[response-server Checks] reported by reviewdog \ud83d\udc36\n'package' should be separated from previous statement.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r497586276", "createdAt": "2020-09-30T15:07:14Z", "author": {"login": "github-actions"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/response/model/ParticipantActivity.java", "diffHunk": "@@ -5,7 +5,7 @@\n  * license that can be found in the LICENSE file or at\n  * https://opensource.org/licenses/MIT.\n  */\n-package com.google.cloud.healthcare.fdamystudies.model;\n+package com.google.cloud.healthcare.fdamystudies.response.model;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a121f3df8e88812effb7ea4e570a57e336982924"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzczMTkxMQ==", "bodyText": "please fix", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r497731911", "createdAt": "2020-09-30T18:56:34Z", "author": {"login": "zohrehj"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/response/model/ParticipantActivity.java", "diffHunk": "@@ -5,7 +5,7 @@\n  * license that can be found in the LICENSE file or at\n  * https://opensource.org/licenses/MIT.\n  */\n-package com.google.cloud.healthcare.fdamystudies.model;\n+package com.google.cloud.healthcare.fdamystudies.response.model;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU4NjI3Ng=="}, "originalCommit": {"oid": "a121f3df8e88812effb7ea4e570a57e336982924"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODMzNzk3NQ==", "bodyText": "looks like you missed this comment", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r498337975", "createdAt": "2020-10-01T15:34:40Z", "author": {"login": "zohrehj"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/response/model/ParticipantActivity.java", "diffHunk": "@@ -5,7 +5,7 @@\n  * license that can be found in the LICENSE file or at\n  * https://opensource.org/licenses/MIT.\n  */\n-package com.google.cloud.healthcare.fdamystudies.model;\n+package com.google.cloud.healthcare.fdamystudies.response.model;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU4NjI3Ng=="}, "originalCommit": {"oid": "a121f3df8e88812effb7ea4e570a57e336982924"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODM1MTczNA==", "bodyText": "I have already fixed this, hence merging this PR.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r498351734", "createdAt": "2020-10-01T15:54:18Z", "author": {"login": "monica-BTC"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/response/model/ParticipantActivity.java", "diffHunk": "@@ -5,7 +5,7 @@\n  * license that can be found in the LICENSE file or at\n  * https://opensource.org/licenses/MIT.\n  */\n-package com.google.cloud.healthcare.fdamystudies.model;\n+package com.google.cloud.healthcare.fdamystudies.response.model;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU4NjI3Ng=="}, "originalCommit": {"oid": "a121f3df8e88812effb7ea4e570a57e336982924"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTk4NTk4OnYy", "diffSide": "RIGHT", "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/response/model/ParticipantBo.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODo1OTozNVrOHarPxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxNTozNjoxMVrOHbQM8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzczMzU3NA==", "bodyText": "since the token is not unique, most likely your query includes more than just the token_identifier; so it is possible that a composite index might be a better solution.\nPlease document the query you need this index for so that I can verify if this is the appropriate index for it.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r497733574", "createdAt": "2020-09-30T18:59:35Z", "author": {"login": "zohrehj"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/response/model/ParticipantBo.java", "diffHunk": "@@ -16,10 +16,15 @@\n import javax.persistence.GeneratedValue;\n import javax.persistence.GenerationType;\n import javax.persistence.Id;\n+import javax.persistence.Index;\n import javax.persistence.Table;\n \n @Entity\n-@Table(name = \"participant_info\")\n+@Table(\n+    name = \"participant_info\",\n+    indexes = {\n+      @Index(name = \"participant_info_token_identifier_idx\", columnList = \"token_identifier\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1419ea122dd026e06c8267db694eb53cb1b1cfff"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODE3MTQyNA==", "bodyText": "Yes I had missed that, in the query we are fetching based on participant_identifier and token_identifier. Now made it composite index. Please refer below code snippet\npredicate[0] =\n          builder.equal(\n              root.get(AppConstants.PARTICIPANT_TOKEN_IDENTIFIER_KEY),\n              participantBo.getTokenIdentifier());\n      predicate[1] =\n          builder.equal(\n              root.get(AppConstants.PARTICIPANT_IDENTIFIER_KEY),\n              participantBo.getParticipantIdentifier());\n      participantBoCriteria.select(root).where(predicate);", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r498171424", "createdAt": "2020-10-01T11:25:50Z", "author": {"login": "monica-BTC"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/response/model/ParticipantBo.java", "diffHunk": "@@ -16,10 +16,15 @@\n import javax.persistence.GeneratedValue;\n import javax.persistence.GenerationType;\n import javax.persistence.Id;\n+import javax.persistence.Index;\n import javax.persistence.Table;\n \n @Entity\n-@Table(name = \"participant_info\")\n+@Table(\n+    name = \"participant_info\",\n+    indexes = {\n+      @Index(name = \"participant_info_token_identifier_idx\", columnList = \"token_identifier\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzczMzU3NA=="}, "originalCommit": {"oid": "1419ea122dd026e06c8267db694eb53cb1b1cfff"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODMzOTA1Nw==", "bodyText": "looks good, thanks for the fix.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1015#discussion_r498339057", "createdAt": "2020-10-01T15:36:11Z", "author": {"login": "zohrehj"}, "path": "response-server-module/response-server-service/src/main/java/com/google/cloud/healthcare/fdamystudies/response/model/ParticipantBo.java", "diffHunk": "@@ -16,10 +16,15 @@\n import javax.persistence.GeneratedValue;\n import javax.persistence.GenerationType;\n import javax.persistence.Id;\n+import javax.persistence.Index;\n import javax.persistence.Table;\n \n @Entity\n-@Table(name = \"participant_info\")\n+@Table(\n+    name = \"participant_info\",\n+    indexes = {\n+      @Index(name = \"participant_info_token_identifier_idx\", columnList = \"token_identifier\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzczMzU3NA=="}, "originalCommit": {"oid": "1419ea122dd026e06c8267db694eb53cb1b1cfff"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1812, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}