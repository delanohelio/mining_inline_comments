{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyMzk4OTMw", "number": 317, "title": "Add IAM on consent documents bucket and firebase project", "bodyText": "Also remove unnecessary dependency.", "createdAt": "2020-05-02T04:41:26Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317", "merged": true, "mergeCommit": {"oid": "a9dbdb19e8b166c9b35e140bd1789944cb118378"}, "closed": true, "closedAt": "2020-05-02T20:32:24Z", "author": {"login": "umairidris"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcdOuGxgH2gAyNDEyMzk4OTMwOmVlNTI2ZmRiNjUyZjI4MGRhYTJmMjQyMDYxMDYxOGEyNjg2MmE3MDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcdcRmTgFqTQwNDU1ODEyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ee526fdb652f280daa2f2420610618a26862a703", "committedDate": "2020-05-02T04:38:55Z", "message": "add iam"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTAwMDcw", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#pullrequestreview-404500070", "createdAt": "2020-05-02T04:45:40Z", "commit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNDo0NTo0MVrOGPfLSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNDo0NTo0MVrOGPfLSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODg5MjYxOQ==", "bodyText": "user-registration", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418892619", "createdAt": "2020-05-02T04:45:41Z", "author": {"login": "xingao267"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      response-server = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"\n+      }\n+    }\n+  }\n+}\n+\n+\n inputs = {\n   network = dependency.network.outputs.private_network.id\n+  consent_documents_iam_members = [{\n+    role   = \"roles/storage.objectCreator\"\n+    member = \"serviceAccount:${dependency.apps.outputs.apps_service_accounts[\"response-server\"].email}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTAwMzE5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#pullrequestreview-404500319", "createdAt": "2020-05-02T04:50:18Z", "commit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNDo1MDoxOFrOGPfSOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNDo1MDoxOFrOGPfSOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODg5NDM5Mg==", "bodyText": "user-registration", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418894392", "createdAt": "2020-05-02T04:50:18Z", "author": {"login": "xingao267"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      response-server = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ee526fdb652f280daa2f2420610618a26862a703"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afba32e29750f088f7240d2a5ea3268cfff02ad3", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/afba32e29750f088f7240d2a5ea3268cfff02ad3", "committedDate": "2020-05-02T04:58:42Z", "message": "user"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTAwODUx", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#pullrequestreview-404500851", "createdAt": "2020-05-02T05:00:42Z", "commit": {"oid": "afba32e29750f088f7240d2a5ea3268cfff02ad3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTAyNjg2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#pullrequestreview-404502686", "createdAt": "2020-05-02T05:42:52Z", "commit": {"oid": "afba32e29750f088f7240d2a5ea3268cfff02ad3"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNTo0Mjo1M1rOGPghPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNTo0Mjo1M1rOGPghPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkxNDYyMg==", "bodyText": "I think we need objectAdmin here because it also needs to read data from this bucket (e.g. when user download their own consent form).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418914622", "createdAt": "2020-05-02T05:42:53Z", "author": {"login": "kuoyuchi"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-data/data/terragrunt.hcl", "diffHunk": "@@ -31,6 +31,24 @@ dependency \"network\" {\n   }\n }\n \n+dependency \"apps\" {\n+  config_path = \"../../project.heroes-hat-dev-apps/apps\"\n+\n+  mock_outputs = {\n+    service_account = \"mock-gke-service-account\"\n+    apps_service_accounts = {\n+      user-registration = {\n+        email = \"mock-app-gke@mock-project.iam.gserviceaccount.com\"\n+      }\n+    }\n+  }\n+}\n+\n+\n inputs = {\n   network = dependency.network.outputs.private_network.id\n+  consent_documents_iam_members = [{\n+    role   = \"roles/storage.objectCreator\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "afba32e29750f088f7240d2a5ea3268cfff02ad3"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f64f5c13b928f0d534b9c19b52c5c63df6b46534", "author": {"user": {"login": "kuoyuchi", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f64f5c13b928f0d534b9c19b52c5c63df6b46534", "committedDate": "2020-05-02T05:43:45Z", "message": "Merge branch 'early-access' into simplify"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTAzMzI2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#pullrequestreview-404503326", "createdAt": "2020-05-02T05:58:25Z", "commit": {"oid": "f64f5c13b928f0d534b9c19b52c5c63df6b46534"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNTo1ODoyNVrOGPguPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNTo1ODoyNVrOGPguPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkxNzk1MA==", "bodyText": "I think for whatever reason, the current project name is \"heroes-hat-dev-resp-firebase\".", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418917950", "createdAt": "2020-05-02T05:58:25Z", "author": {"login": "kuoyuchi"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-resp-firebase/iam/terraform.tfvars", "diffHunk": "@@ -0,0 +1,15 @@\n+# Copyright 2020 Google Inc.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+project_id = \"heroes-hat-dev-firebase\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f64f5c13b928f0d534b9c19b52c5c63df6b46534"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTAzNzI2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#pullrequestreview-404503726", "createdAt": "2020-05-02T06:08:00Z", "commit": {"oid": "f64f5c13b928f0d534b9c19b52c5c63df6b46534"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNjowODowMFrOGPgxKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMlQwNjowODowMFrOGPgxKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkxODY5OA==", "bodyText": "Do we need to add the \"serviceAccount:\" prefix here as well?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#discussion_r418918698", "createdAt": "2020-05-02T06:08:00Z", "author": {"login": "kuoyuchi"}, "path": "Terraform/org/folder.fda-my-studies/project.heroes-hat-dev-resp-firebase/iam/main.tf", "diffHunk": "@@ -0,0 +1,29 @@\n+# Copyright 2020 Google Inc.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#      http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+terraform {\n+  required_version = \"~> 0.12.0\"\n+  required_providers {\n+    google      = \"~> 3.0\"\n+    google-beta = \"~> 3.0\"\n+  }\n+  backend \"gcs\" {}\n+}\n+\n+resource \"google_project_iam_member\" \"datastore_user_service_accounts\" {\n+  for_each = toset(var.datastore_user_service_accounts)\n+  project  = var.project_id\n+  role     = \"roles/datastore.user\"\n+  member   = each.key", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f64f5c13b928f0d534b9c19b52c5c63df6b46534"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfef0156d239c6a8bff5371fba8190a8af67caa3", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/cfef0156d239c6a8bff5371fba8190a8af67caa3", "committedDate": "2020-05-02T17:54:41Z", "message": "obj adm"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c98a4ce8603453fdc55992e064da58f7445f4f0f", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c98a4ce8603453fdc55992e064da58f7445f4f0f", "committedDate": "2020-05-02T17:54:48Z", "message": "Merge branch 'simplify' of https://github.com/GoogleCloudPlatform/fda-mystudies into simplify"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "468cdfd8149d5da90dd70d69338e63335cf69f84", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/468cdfd8149d5da90dd70d69338e63335cf69f84", "committedDate": "2020-05-02T17:55:30Z", "message": "Merge branch 'early-access' into simplify"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1499e73cc20ff30b141db2697485beff352693f8", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1499e73cc20ff30b141db2697485beff352693f8", "committedDate": "2020-05-02T17:56:25Z", "message": "project id"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eabd103d2f93434dd1d914f80383502d4c217837", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/eabd103d2f93434dd1d914f80383502d4c217837", "committedDate": "2020-05-02T17:56:30Z", "message": "Merge branch 'simplify' of https://github.com/GoogleCloudPlatform/fda-mystudies into simplify"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0cb7a631608788466232f9ef114daa39a42168f3", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/0cb7a631608788466232f9ef114daa39a42168f3", "committedDate": "2020-05-02T19:56:27Z", "message": "Merge branch 'early-access' into simplify"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebbb09f1ad65c4f67f77fe7713c11fe7888df26f", "author": {"user": {"login": "umairidris", "name": "Umair Idris"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ebbb09f1ad65c4f67f77fe7713c11fe7888df26f", "committedDate": "2020-05-02T20:18:29Z", "message": "Merge branch 'early-access' into simplify"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0NTU4MTI4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/317#pullrequestreview-404558128", "createdAt": "2020-05-02T20:26:27Z", "commit": {"oid": "ebbb09f1ad65c4f67f77fe7713c11fe7888df26f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 989, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}