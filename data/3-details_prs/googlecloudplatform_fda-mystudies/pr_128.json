{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNjc2OTAz", "number": 128, "title": "Create utility to substitute environment vars in WCP-WS", "bodyText": "WCP-WS should correctly use environment variables in the application.properties file. Fixes #75", "createdAt": "2020-04-09T22:34:39Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/128", "merged": true, "mergeCommit": {"oid": "deca74c1a0641cfa0a65b11a32f31e4ad7280584"}, "closed": true, "closedAt": "2020-04-13T18:10:38Z", "author": {"login": "wamills"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWENzngH2gAyNDAxNjc2OTAzOjE2MzI2MGU0MjVkNTc0MTgzZGEwOTM0YTFjODc4NDM3N2VkNzUyN2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXS2DGAFqTM5MjMyMTY5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "163260e425d574183da0934a1c8784377ed7527e", "author": {"user": {"login": "wamills", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/163260e425d574183da0934a1c8784377ed7527e", "committedDate": "2020-04-09T22:27:07Z", "message": "Add new utility that substitutes environment variables from a provided properties file into a Java Properties class."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cd499b2d9305ea98518fd8b6a69038a2bae647a", "author": {"user": {"login": "wamills", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6cd499b2d9305ea98518fd8b6a69038a2bae647a", "committedDate": "2020-04-09T22:30:45Z", "message": "Rename properties file to be inline with other services."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07f528a799a010b28fb268ac3666f51f35ac81ec", "author": {"user": {"login": "wamills", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/07f528a799a010b28fb268ac3666f51f35ac81ec", "committedDate": "2020-04-09T22:32:11Z", "message": "Use new util use Properties with correctly substituted environment variables."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21bbd9643f66711970575fa55942eb692123cbb8", "author": {"user": {"login": "wamills", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/21bbd9643f66711970575fa55942eb692123cbb8", "committedDate": "2020-04-13T16:47:11Z", "message": "Only allow environment vars in the form ."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMjc1Mjcy", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/128#pullrequestreview-392275272", "createdAt": "2020-04-13T16:54:50Z", "commit": {"oid": "21bbd9643f66711970575fa55942eb692123cbb8"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNjo1NDo1MVrOGEtCmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNjo1NTowNFrOGEtDGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU4NTQzMg==", "bodyText": "Should this stay as \"application_local.properties\"? I think the files are here: https://github.com/GoogleCloudPlatform/fda-mystudies/tree/early-access/WCP-WS/src/main/resources", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/128#discussion_r407585432", "createdAt": "2020-04-13T16:54:51Z", "author": {"login": "kuoyuchi"}, "path": "WCP-WS/src/main/java/com/hphc/mystudies/util/HibernateUtil.java", "diffHunk": "@@ -42,18 +42,9 @@ public static SessionFactory getSessionFactory() {\n     logger.info(\"INFO: HibernateUtil - getSessionFactory() :: Starts\");\n     try {\n       if (sessionFactory == null) {\n-\n-        InputStream inputStream =\n-            HibernateUtil.class\n-                .getClassLoader()\n-                .getResourceAsStream(\"application_local.properties\");\n-\n-        Properties properties = new Properties();\n-\n-        properties.load(inputStream);\n         sessionFactory =\n             new AnnotationConfiguration()\n-                .addProperties(properties)\n+                .addProperties(PropertiesUtil.makePropertiesWithEnvironmentVariables(\"application.properties\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21bbd9643f66711970575fa55942eb692123cbb8"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU4NTU2MQ==", "bodyText": "application_local.properties", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/128#discussion_r407585561", "createdAt": "2020-04-13T16:55:04Z", "author": {"login": "kuoyuchi"}, "path": "WCP-WS/src/main/java/com/hphc/mystudies/util/StudyMetaDataUtil.java", "diffHunk": "@@ -74,11 +74,8 @@ public static HashMap getAppProperties() {\n         hm.put(key, value);\n       }\n       ServletContext context = ServletContextHolder.getServletContext();\n-      Properties prop = new Properties();\n \n-      InputStream inputStream =\n-          HibernateUtil.class.getClassLoader().getResourceAsStream(\"application_local.properties\");\n-      prop.load(inputStream);\n+      Properties prop = PropertiesUtil.makePropertiesWithEnvironmentVariables(\"application.properties\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "21bbd9643f66711970575fa55942eb692123cbb8"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23520c8ab19d0ef97916a20eb116fe87fd36b58c", "author": {"user": {"login": "wamills", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/23520c8ab19d0ef97916a20eb116fe87fd36b58c", "committedDate": "2020-04-13T17:42:55Z", "message": "Rename META-INF context path for application.properties."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b716b2c8888a6c716202c585e72497bebcb2c07", "author": {"user": {"login": "wamills", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/4b716b2c8888a6c716202c585e72497bebcb2c07", "committedDate": "2020-04-13T17:47:06Z", "message": "Merge branch 'early-access' into wamills_wcp_env_var_fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMzIxNjkx", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/128#pullrequestreview-392321691", "createdAt": "2020-04-13T18:03:36Z", "commit": {"oid": "4b716b2c8888a6c716202c585e72497bebcb2c07"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxODowMzozNlrOGEvYHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxODowMzozNlrOGEvYHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzYyMzcwOA==", "bodyText": "SGTM. Thanks for explaining.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/128#discussion_r407623708", "createdAt": "2020-04-13T18:03:36Z", "author": {"login": "kuoyuchi"}, "path": "WCP-WS/src/main/java/com/hphc/mystudies/util/HibernateUtil.java", "diffHunk": "@@ -42,18 +42,9 @@ public static SessionFactory getSessionFactory() {\n     logger.info(\"INFO: HibernateUtil - getSessionFactory() :: Starts\");\n     try {\n       if (sessionFactory == null) {\n-\n-        InputStream inputStream =\n-            HibernateUtil.class\n-                .getClassLoader()\n-                .getResourceAsStream(\"application_local.properties\");\n-\n-        Properties properties = new Properties();\n-\n-        properties.load(inputStream);\n         sessionFactory =\n             new AnnotationConfiguration()\n-                .addProperties(properties)\n+                .addProperties(PropertiesUtil.makePropertiesWithEnvironmentVariables(\"application.properties\"))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU4NTQzMg=="}, "originalCommit": {"oid": "21bbd9643f66711970575fa55942eb692123cbb8"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1279, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}