{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxNDk4NjU3", "number": 414, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxODozNzowNFrOD-tMiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxOTozMjowNVrOD-uQSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MDc4NzkyOnYy", "diffSide": "RIGHT", "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxODozNzowNFrOGY-Reg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxNDoxMToxNlrOGaCa2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgzOTI5MA==", "bodyText": "why is \"labkeyresponse\" text is needed?\nincidentally, I would prefer if we remove the work labkey entirely from the code, since it is accurate anymore.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r428839290", "createdAt": "2020-05-21T18:37:04Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,\n+              data: responseValue,\n+              fkDuration: Int(count),\n+              date: date\n+            )\n           }\n         }\n       }\n-      let key = \"LabKeyResponse\" + (Study.currentStudy?.studyId)!\n+    }\n+\n+    if let studyID = Study.currentStudy?.studyId {\n+      let key = \"LabKeyResponse\" + studyID", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMzNDUyOA==", "bodyText": "I see it has been used at a couple of other places as a hardcoded String. Do you want me to update that in this PR or shall I make changes and open another PR?\nChanges will require one round of QA testing.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r429334528", "createdAt": "2020-05-22T16:13:29Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,\n+              data: responseValue,\n+              fkDuration: Int(count),\n+              date: date\n+            )\n           }\n         }\n       }\n-      let key = \"LabKeyResponse\" + (Study.currentStudy?.studyId)!\n+    }\n+\n+    if let studyID = Study.currentStudy?.studyId {\n+      let key = \"LabKeyResponse\" + studyID", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgzOTI5MA=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk1NTgwMQ==", "bodyText": "feel free to open another PR.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r429955801", "createdAt": "2020-05-25T14:11:16Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,\n+              data: responseValue,\n+              fkDuration: Int(count),\n+              date: date\n+            )\n           }\n         }\n       }\n-      let key = \"LabKeyResponse\" + (Study.currentStudy?.studyId)!\n+    }\n+\n+    if let studyID = Study.currentStudy?.studyId {\n+      let key = \"LabKeyResponse\" + studyID", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgzOTI5MA=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MDc5ODg0OnYy", "diffSide": "RIGHT", "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxODo0MDoyM1rOGY-YRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNjo1NDo1MFrOGaQ4sw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MTAzMQ==", "bodyText": "what happens if the casting fails? it doesn't look like the case is handled.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r428841031", "createdAt": "2020-05-21T18:40:23Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,\n+              data: responseValue,\n+              fkDuration: Int(count),\n+              date: date\n+            )\n           }\n         }\n       }\n-      let key = \"LabKeyResponse\" + (Study.currentStudy?.studyId)!\n+    }\n+\n+    if let studyID = Study.currentStudy?.studyId {\n+      let key = \"LabKeyResponse\" + studyID\n       UserDefaults.standard.set(true, forKey: key)\n+    }\n \n-      let appDelegate = (UIApplication.shared.delegate as? AppDelegate)!\n+    if let appDelegate = UIApplication.shared.delegate as? AppDelegate {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MTUyMw==", "bodyText": "if it's not an expected case, maybe use as! instead?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r428841523", "createdAt": "2020-05-21T18:41:24Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,\n+              data: responseValue,\n+              fkDuration: Int(count),\n+              date: date\n+            )\n           }\n         }\n       }\n-      let key = \"LabKeyResponse\" + (Study.currentStudy?.studyId)!\n+    }\n+\n+    if let studyID = Study.currentStudy?.studyId {\n+      let key = \"LabKeyResponse\" + studyID\n       UserDefaults.standard.set(true, forKey: key)\n+    }\n \n-      let appDelegate = (UIApplication.shared.delegate as? AppDelegate)!\n+    if let appDelegate = UIApplication.shared.delegate as? AppDelegate {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MTAzMQ=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMzMjUxMA==", "bodyText": "what happens if the casting fails? it doesn't look like the case is handled.\n\nIt wouldn't fail since AppDelegate is the starting point of the App. However, it's good to safely unwrap it.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r429332510", "createdAt": "2020-05-22T16:09:57Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,\n+              data: responseValue,\n+              fkDuration: Int(count),\n+              date: date\n+            )\n           }\n         }\n       }\n-      let key = \"LabKeyResponse\" + (Study.currentStudy?.studyId)!\n+    }\n+\n+    if let studyID = Study.currentStudy?.studyId {\n+      let key = \"LabKeyResponse\" + studyID\n       UserDefaults.standard.set(true, forKey: key)\n+    }\n \n-      let appDelegate = (UIApplication.shared.delegate as? AppDelegate)!\n+    if let appDelegate = UIApplication.shared.delegate as? AppDelegate {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MTAzMQ=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk1NjIzMw==", "bodyText": "then it doesn't matter if you use as! instead?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r429956233", "createdAt": "2020-05-25T14:12:13Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,\n+              data: responseValue,\n+              fkDuration: Int(count),\n+              date: date\n+            )\n           }\n         }\n       }\n-      let key = \"LabKeyResponse\" + (Study.currentStudy?.studyId)!\n+    }\n+\n+    if let studyID = Study.currentStudy?.studyId {\n+      let key = \"LabKeyResponse\" + studyID\n       UserDefaults.standard.set(true, forKey: key)\n+    }\n \n-      let appDelegate = (UIApplication.shared.delegate as? AppDelegate)!\n+    if let appDelegate = UIApplication.shared.delegate as? AppDelegate {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MTAzMQ=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE5MjgxOQ==", "bodyText": "Since its an optional type, force casting is a violation here.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r430192819", "createdAt": "2020-05-26T06:54:50Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,\n+              data: responseValue,\n+              fkDuration: Int(count),\n+              date: date\n+            )\n           }\n         }\n       }\n-      let key = \"LabKeyResponse\" + (Study.currentStudy?.studyId)!\n+    }\n+\n+    if let studyID = Study.currentStudy?.studyId {\n+      let key = \"LabKeyResponse\" + studyID\n       UserDefaults.standard.set(true, forKey: key)\n+    }\n \n-      let appDelegate = (UIApplication.shared.delegate as? AppDelegate)!\n+    if let appDelegate = UIApplication.shared.delegate as? AppDelegate {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MTAzMQ=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MDg1NzU1OnYy", "diffSide": "RIGHT", "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxODo1ODoyMFrOGY-9ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNjo1Njo1NFrOGaQ8aA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MDUzMg==", "bodyText": "why are you removing the unwrapping of activityID and key?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r428850532", "createdAt": "2020-05-21T18:58:20Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTMzNDQ0OQ==", "bodyText": "It an optional type and it was forced unwrapped which isn't a good practice. I'm unwrapping it safely now to avoid the crash if there's no key or activityID.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r429334449", "createdAt": "2020-05-22T16:13:19Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MDUzMg=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk1NzQ3NQ==", "bodyText": "where is the case where the value is nil being handled?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r429957475", "createdAt": "2020-05-25T14:14:56Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MDUzMg=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE5Mzc2OA==", "bodyText": "If it's nil means there wasn't any value from the server response and it'd just not save it in DB.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r430193768", "createdAt": "2020-05-26T06:56:54Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Views/UIViews+Additions/Activity/ActivitySchedule/ActivitySchedules.swift", "diffHunk": "@@ -228,29 +228,30 @@ class ResponseDataFetch: NMWebServiceDelegate {\n           let count = (value[\"count\"] as? Float)!\n           let dateString = value[\"date\"] as? String ?? \"\"\n           // SetData Format\n-          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString) {\n-            let localDateAsString = ResponseDataFetch.localDateFormatter.string(from: date)\n-            if let localDate = ResponseDataFetch.localDateFormatter.date(\n-              from: localDateAsString\n-            ) {\n-              // Save Stats to DB\n-              DBHandler.saveStatisticsDataFor(\n-                activityId: activityId!,\n-                key: key!,\n-                data: responseValue,\n-                fkDuration: Int(count),\n-                date: localDate\n-              )\n-            }\n+          if let date = ResponseDataFetch.responseDateFormatter.date(from: dateString),\n+            let key = key,\n+            let activityID = activityId\n+          {\n+            // Save Stats to DB\n+            DBHandler.saveStatisticsDataFor(\n+              activityId: activityID,\n+              key: key,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg1MDUzMg=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3MDk2MTM3OnYy", "diffSide": "RIGHT", "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQxOTozMjowNVrOGY__6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQxNjozNzoyOVrOGZdNIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg2NzU2Mw==", "bodyText": "this code is deeply nested and very complex, please consider refactoring it into smaller methods.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r428867563", "createdAt": "2020-05-21T19:32:05Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "diffHunk": "@@ -371,28 +359,28 @@ class ResponseServices: NSObject {\n             }\n \n           } else {\n-            for responseData in dashBoardResponse {\n-\n-              if let keyValue = data[responseData.key!] as? [String: Any] {\n-\n-                if Utilities.isValidValue(\n-                  someObject: keyValue[\"value\"] as AnyObject?\n-                ) {\n-                  var value: Float = 0.0\n-                  if let n = keyValue[\"value\"] as? NSNumber {\n-                    value = n.floatValue\n-                  }\n-                  let valueDetail =\n-                    [\n-                      \"value\": value,\n-                      \"count\": Float(0.0),\n-                      \"date\": date,\n-                    ] as [String: Any]\n-\n-                  responseData.values.append(valueDetail)\n-                }\n+            for (index, dict) in dataDictArr.enumerated() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM0NjA4Mw==", "bodyText": "I've made some changes by adding an initializer for DashboardResponse class and a method to parse those values from the Dictionary.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/414#discussion_r429346083", "createdAt": "2020-05-22T16:37:29Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "diffHunk": "@@ -371,28 +359,28 @@ class ResponseServices: NSObject {\n             }\n \n           } else {\n-            for responseData in dashBoardResponse {\n-\n-              if let keyValue = data[responseData.key!] as? [String: Any] {\n-\n-                if Utilities.isValidValue(\n-                  someObject: keyValue[\"value\"] as AnyObject?\n-                ) {\n-                  var value: Float = 0.0\n-                  if let n = keyValue[\"value\"] as? NSNumber {\n-                    value = n.floatValue\n-                  }\n-                  let valueDetail =\n-                    [\n-                      \"value\": value,\n-                      \"count\": Float(0.0),\n-                      \"date\": date,\n-                    ] as [String: Any]\n-\n-                  responseData.values.append(valueDetail)\n-                }\n+            for (index, dict) in dataDictArr.enumerated() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg2NzU2Mw=="}, "originalCommit": {"oid": "0527d345e1f4ba968d4cb67ee5b0ada99f56473f"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1131, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}