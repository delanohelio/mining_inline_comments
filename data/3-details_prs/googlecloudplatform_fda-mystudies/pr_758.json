{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY4NzczMzcx", "number": 758, "title": "OAuth Scim Service - login/consent/error UI implementation with client/server-side validations and exception handling", "bodyText": "PR #717 was raised 2 weeks ago but UI screens got changed to display errors and also to incorporate Jamie's feedback.\nPlease note, I've addressed review comments from PR 717 here. I'll close the PR 717.\n\n\nThere are 2 CSS files, combined LOC is 450+ hence this PR looks big.\n\n\nMobilePlatform enum was introduced in earlier PR (audit log implementation) hence removed DevicePlatform enum to avoid duplicate code\n\n\nAdded mystudies_ prefix to cookie names.\n\n\nUpdated tests to fix the errors, all tests are passing\n\n\nKindly review and approve the PR.", "createdAt": "2020-08-17T11:32:46Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758", "merged": true, "mergeCommit": {"oid": "99dbd4bdc9bf7163bafdf6b102dfec6277e55ec2"}, "closed": true, "closedAt": "2020-08-18T15:00:40Z", "author": {"login": "dhanyak-btc"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_gY4ZgH2gAyNDY4NzczMzcxOmY5OWViYTFiZTNiMzI5NGU5MGZhYmFjYzhkMjE4NjBmZDY1YTY1NmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAIUIiAH2gAyNDY4NzczMzcxOjZjOTNmMDFjOGNmMWRlNzU2N2FkMzI5YmU1Y2E4MjJhYjNjYTNkZjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f99eba1be3b3294e90fabacc8d21860fd65a656c", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f99eba1be3b3294e90fabacc8d21860fd65a656c", "committedDate": "2020-08-16T16:27:27Z", "message": "Implementation of login/consent with actual UI, validations and exception handling\n\nRemoved DevicePlatform and error redirect URLs,\nRenamed view name variables,\nImplemented server side validation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "461d3cdc8ad61a046806bd81bab118001084b265", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/461d3cdc8ad61a046806bd81bab118001084b265", "committedDate": "2020-08-16T17:04:02Z", "message": "Replace DevicePlatform with MobilePlatform, Added mobileDevice attribute to model\n\nReplace DevicePlatform with MobilePlatform, Added mobileDevice attribute to model"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edf1907cc913500d897d8dd0258acb44957c138d", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/edf1907cc913500d897d8dd0258acb44957c138d", "committedDate": "2020-08-16T17:22:15Z", "message": "Fixed test failures\n\nFixed test failures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f853564b0b3e23e91ac08cfd5d7f5cf53c6e8988", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f853564b0b3e23e91ac08cfd5d7f5cf53c6e8988", "committedDate": "2020-08-16T17:59:51Z", "message": "Updated logger statement and added @JsonInclude(Include.NON_NULL) in BaseResponse\n\nUpdated logger statement and added @JsonInclude(Include.NON_NULL) in BaseResponse"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c0caabfdd209faa4f6a9eccaa16434fb90e9cd1", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8c0caabfdd209faa4f6a9eccaa16434fb90e9cd1", "committedDate": "2020-08-16T18:23:00Z", "message": "Added grant_scope in request to get refresh token for authorization_code grant\n\nWhen accepting the consent request, offline_access must be in the list of grant_scope to get the refresh_token"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "849c5fd0de21285a3ee91902d2ebf741dd31dea9", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/849c5fd0de21285a3ee91902d2ebf741dd31dea9", "committedDate": "2020-08-17T06:44:52Z", "message": "Added mystudies_ prefix to cookies, added comments to grantScopes and code formatting\n\nAdded mystudies_ prefix to cookies, added comments to grantScopes and code formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bdc1a68ea7dc1231295a63b957be23edcf87e17", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6bdc1a68ea7dc1231295a63b957be23edcf87e17", "committedDate": "2020-08-17T10:35:46Z", "message": "fixed ui design review feedback\n\nfixed ui design review feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cb62c5e3019fe9839ede95bd5b28f5dd4f91094", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3cb62c5e3019fe9839ede95bd5b28f5dd4f91094", "committedDate": "2020-08-17T11:05:32Z", "message": "Removed Loader.gif and Loader.svg\n\nRemoved Loader.gif and Loader.svg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2eb97d9f34e78f37c33b6fa3756962ad98fee4f", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a2eb97d9f34e78f37c33b6fa3756962ad98fee4f", "committedDate": "2020-08-17T11:07:01Z", "message": "Added animated loader.svg and css classnames, updated cmn_error\n\nAdded animated loader.svg and css classnames, updated cmn_error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "729b1b6e861b7f96ec978d815fabf5cb9da85f95", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/729b1b6e861b7f96ec978d815fabf5cb9da85f95", "committedDate": "2020-08-17T11:12:04Z", "message": "added . to error description\n\nadded . to error description"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e", "committedDate": "2020-08-17T13:44:26Z", "message": "Removed unused imports\n\nRemoved unused imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4NTQ2NTIw", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#pullrequestreview-468546520", "createdAt": "2020-08-17T15:05:02Z", "commit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxNTowNTowMlrOHBsqlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxNTowNToyN1rOHBsrpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU0MjQyMw==", "bodyText": "Why do we make the user wait 5 seconds?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#discussion_r471542423", "createdAt": "2020-08-17T15:05:02Z", "author": {"login": "nikklassen"}, "path": "oauth-scim-module/oauth-scim-service/src/main/resources/templates/autoLogin.html", "diffHunk": "@@ -1,12 +1,42 @@\n+<!-- \n+  Copyright 2020 Google LLC\n+ \n+  Use of this source code is governed by an MIT-style\n+  license that can be found in the LICENSE file or at\n+  https://opensource.org/licenses/MIT. -->\n+  \n <!DOCTYPE html>\n-<!-- // TODO(#662) -->\n-<html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"\"\n-  xmlns:th=\"https://www.thymeleaf.org\"\n-  xmlns:sec=\"https://www.thymeleaf.org/thymeleaf-extras-springsecurity3\">\n+<html xmlns=\"http://www.w3.org/1999/xhtml\"\n+  xmlns:th=\"https://www.thymeleaf.org\">\n <head>\n <title>Please wait</title>\n+\n+<link rel=\"stylesheet\"\n+  href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\">\n+<link rel=\"stylesheet\" th:href=\"@{/css/style.css}\">\n+<link rel=\"stylesheet\" th:href=\"@{/css/utilities.css}\">\n+<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+<script type=\"text/javascript\">\n+  window.onload = function() {\n+    window.setTimeout(function() {\n+      document.autoSignInForm.submit();\n+    }, 5000);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU0MjY5NQ==", "bodyText": "Same here", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#discussion_r471542695", "createdAt": "2020-08-17T15:05:27Z", "author": {"login": "nikklassen"}, "path": "oauth-scim-module/oauth-scim-service/src/main/resources/templates/consent.html", "diffHunk": "@@ -1,12 +1,43 @@\n+<!-- \n+  Copyright 2020 Google LLC\n+ \n+  Use of this source code is governed by an MIT-style\n+  license that can be found in the LICENSE file or at\n+  https://opensource.org/licenses/MIT. -->\n+  \n <!DOCTYPE html>\n-<!-- // TODO(#650) Remove this file -->\n-<html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"\"\n-  xmlns:th=\"https://www.thymeleaf.org\"\n-  xmlns:sec=\"https://www.thymeleaf.org/thymeleaf-extras-springsecurity3\">\n+<html xmlns=\"http://www.w3.org/1999/xhtml\"\n+  xmlns:th=\"https://www.thymeleaf.org\">\n <head>\n <title>Please wait</title>\n+\n+<link rel=\"stylesheet\"\n+  href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\">\n+<link rel=\"stylesheet\" th:href=\"@{/css/style.css}\">\n+<link rel=\"stylesheet\" th:href=\"@{/css/utilities.css}\">\n+<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+<script type=\"text/javascript\">\n+\twindow.onload = function() {\n+\t\twindow.setTimeout(function() {\n+\t\t\tdocument.consentForm.submit();\n+\t\t}, 5000);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4NTk2MjA3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#pullrequestreview-468596207", "createdAt": "2020-08-17T16:02:48Z", "commit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxNjowMjo0OFrOHBvCBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxNjoxNToyMlrOHBvfpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU4MTE5MQ==", "bodyText": "nit: no need to enforce size in regex since you already have min and max specified.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#discussion_r471581191", "createdAt": "2020-08-17T16:02:48Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/beans/LoginRequest.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.oauthscim.beans;\n+\n+import javax.validation.constraints.Email;\n+import javax.validation.constraints.Pattern;\n+import javax.validation.constraints.Size;\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Getter\n+@Setter\n+public class LoginRequest {\n+\n+  private static final String PASSWORD_REGEX =\n+      \"^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!\\\\\\\\\\\\\\\"#$%&'()*+,-.:;<=>?@\\\\\\\\\\\\\\\\[\\\\\\\\\\\\\\\\]^_`{|}~]).{8,64}$\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU4NTcwMA==", "bodyText": "It doesn't look like we are requiring spacial characters in the password here, which I thought was a requirement.\nAlso not sure why we are limiting the spacial characters that the user can use?\nwhy not just accept whatever they provide, and just enforce the min character?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#discussion_r471585700", "createdAt": "2020-08-17T16:10:04Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/beans/LoginRequest.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.oauthscim.beans;\n+\n+import javax.validation.constraints.Email;\n+import javax.validation.constraints.Pattern;\n+import javax.validation.constraints.Size;\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Getter\n+@Setter\n+public class LoginRequest {\n+\n+  private static final String PASSWORD_REGEX =\n+      \"^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!\\\\\\\\\\\\\\\"#$%&'()*+,-.:;<=>?@\\\\\\\\\\\\\\\\[\\\\\\\\\\\\\\\\]^_`{|}~]).{8,64}$\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU4MTE5MQ=="}, "originalCommit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU4NzEzNg==", "bodyText": "this is not adding the cookie prefix, it is removing it form the name before adding the cookie; the opposite of what I was referring to.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#discussion_r471587136", "createdAt": "2020-08-17T16:12:30Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/common/CookieHelper.java", "diffHunk": "@@ -20,10 +21,17 @@\n \n   @Autowired private AppPropertyConfig appConfig;\n \n+  private static final String COOKIE_PREFIX = \"mystudies_\";\n+\n   public void addCookies(\n       HttpServletResponse response, MultiValueMap<String, String> params, String... cookieNames) {\n+    String paramName = null;\n     for (String cookieName : cookieNames) {\n-      addCookie(response, cookieName, params.getFirst(cookieName));\n+      paramName =\n+          StringUtils.startsWith(cookieName, COOKIE_PREFIX)\n+              ? cookieName.substring(cookieName.indexOf('_') + 1)\n+              : cookieName;\n+      addCookie(response, cookieName, params.getFirst(paramName));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU4Nzg5OQ==", "bodyText": "please log error here", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#discussion_r471587899", "createdAt": "2020-08-17T16:13:56Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/service/HydraOAuthServiceImpl.java", "diffHunk": "@@ -86,27 +89,33 @@ public void init() {\n \n   public ResponseEntity<?> getToken(MultiValueMap<String, String> paramMap, HttpHeaders headers)\n       throws JsonProcessingException {\n+    logger.entry(String.format(\"getToken() for grant_type=%s\", paramMap.getFirst(GRANT_TYPE)));\n+\n     headers.add(CONTENT_TYPE, APPLICATION_X_WWW_FORM_URLENCODED_CHARSET_UTF_8);\n \n-    if (REFRESH_TOKEN.equals(paramMap.getFirst(GRANT_TYPE))) {\n+    String grantType = paramMap.getFirst(GRANT_TYPE);\n+    if (REFRESH_TOKEN.equals(grantType) || AUTHORIZATION_CODE.equals(grantType)) {\n       headers.set(AUTHORIZATION, encodedAuthorization);\n     }\n \n     HttpEntity<Object> requestEntity = new HttpEntity<>(paramMap, headers);\n     ResponseEntity<JsonNode> response =\n         getRestTemplate().postForEntity(tokenEndpoint, requestEntity, JsonNode.class);\n \n-    String grantType = paramMap.getFirst(GRANT_TYPE);\n     if ((REFRESH_TOKEN.equals(grantType) || AUTHORIZATION_CODE.equals(grantType))\n         && response.getBody().hasNonNull(REFRESH_TOKEN)) {\n       String refreshToken = getTextValue(response.getBody(), REFRESH_TOKEN);\n       UserResponse userResponse =\n           userService.revokeAndReplaceRefreshToken(paramMap.getFirst(USER_ID), refreshToken);\n       if (!HttpStatus.valueOf(userResponse.getHttpStatusCode()).is2xxSuccessful()) {\n+        logger.exit(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU4ODc3NQ==", "bodyText": "please keep indentation to 2 spaces, similar to the html one", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#discussion_r471588775", "createdAt": "2020-08-17T16:15:22Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/resources/templates/login.html", "diffHunk": "@@ -1,13 +1,117 @@\n+<!-- \n+  Copyright 2020 Google LLC\n+ \n+  Use of this source code is governed by an MIT-style\n+  license that can be found in the LICENSE file or at\n+  https://opensource.org/licenses/MIT. -->\n+\n <!DOCTYPE html>\n-<!-- // TODO(#662) -->\n-<html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"\"\n-  xmlns:th=\"https://www.thymeleaf.org\"\n-  xmlns:sec=\"https://www.thymeleaf.org/thymeleaf-extras-springsecurity3\">\n+<html xmlns=\"http://www.w3.org/1999/xhtml\"\n+  xmlns:th=\"https://www.thymeleaf.org\">\n <head>\n <title>Login</title>\n+\n+<link rel=\"stylesheet\"\n+  href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\">\n+<link rel=\"stylesheet\" th:href=\"@{/css/style.css}\">\n+<link rel=\"stylesheet\" th:href=\"@{/css/utilities.css}\">\n+<link rel=\"stylesheet\"\n+  href=\"https://fonts.googleapis.com/css?family=Muli:200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap\">\n+\n+<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+\n+<script type=\"text/javascript\">\n+\tfunction validateField(elementId) {\n+\t\tvar element = document.getElementById(elementId);\n+\t\tvar isValid = element.checkValidity();\n+\t\tvar errorDiv = document.getElementById(elementId + \"_error\");\n+\n+\t\tif (isValid) {\n+\t\t\terrorDiv.style.display = \"none\";\n+\t\t} else {\n+\t\t\terrorDiv.style.display = \"block\";\n+\t\t}\n+\n+\t\treturn isValid;\n+\t}\n+\n+\tfunction validateform() {\n+\t\treturn validateField(\"email\") && validateField(\"password\");\n+\t}\n+</script>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0dd35fbf290f01981c41d9969933b39b99dd305", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c0dd35fbf290f01981c41d9969933b39b99dd305", "committedDate": "2020-08-17T17:17:45Z", "message": "Fixed review comments - extracted javascript code from html files into js files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NDM1MjU3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#pullrequestreview-469435257", "createdAt": "2020-08-18T13:06:18Z", "commit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "state": "DISMISSED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMzowNjoxOFrOHCTNPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMzowNjoxOFrOHCTNPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjE3Mzg4Ng==", "bodyText": "I see. I was expecting you to be adding the cookie prefix here, instead of at each method; but that woks too.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#discussion_r472173886", "createdAt": "2020-08-18T13:06:18Z", "author": {"login": "zohrehj"}, "path": "oauth-scim-module/oauth-scim-service/src/main/java/com/google/cloud/healthcare/fdamystudies/oauthscim/common/CookieHelper.java", "diffHunk": "@@ -20,10 +21,17 @@\n \n   @Autowired private AppPropertyConfig appConfig;\n \n+  private static final String COOKIE_PREFIX = \"mystudies_\";\n+\n   public void addCookies(\n       HttpServletResponse response, MultiValueMap<String, String> params, String... cookieNames) {\n+    String paramName = null;\n     for (String cookieName : cookieNames) {\n-      addCookie(response, cookieName, params.getFirst(cookieName));\n+      paramName =\n+          StringUtils.startsWith(cookieName, COOKIE_PREFIX)\n+              ? cookieName.substring(cookieName.indexOf('_') + 1)\n+              : cookieName;\n+      addCookie(response, cookieName, params.getFirst(paramName));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTU4NzEzNg=="}, "originalCommit": {"oid": "86d0dcf8dc50f8b765cede55a6690eaf5a2e6e5e"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "611960495e711ec3c262172c8f2e5e038f8455fe", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/611960495e711ec3c262172c8f2e5e038f8455fe", "committedDate": "2020-08-18T14:15:23Z", "message": "Fixed review comment and added TODO for Issue 769\n\nFixed review comment and added TODO for Issue 769"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTQxNjMz", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/758#pullrequestreview-469541633", "createdAt": "2020-08-18T14:57:50Z", "commit": {"oid": "611960495e711ec3c262172c8f2e5e038f8455fe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c93f01c8cf1de7567ad329be5ca822ab3ca3df1", "author": {"user": {"login": "dhanyak-btc", "name": "Dhanya Kumar KV"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6c93f01c8cf1de7567ad329be5ca822ab3ca3df1", "committedDate": "2020-08-18T14:58:28Z", "message": "Merge branch 'develop' into oauth_scim_ui_with_validations"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 658, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}