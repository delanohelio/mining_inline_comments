{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4MjI2NDI0", "number": 621, "title": "Participant manager's [POST]  /sites endpoint implementation", "bodyText": "participant manager [POST] /sites endpoint implementation without integration test cases. Integration test cases are not included in this PR because LOC is exceeding the expected limit and we will be raising followup PR for the same.", "createdAt": "2020-07-13T12:33:53Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621", "merged": true, "mergeCommit": {"oid": "239d6783f18d558f156d08e9bac5d8df1c06cd11"}, "closed": true, "closedAt": "2020-08-08T05:45:40Z", "author": {"login": "Kantharajut-btc"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0goTuAH2gAyNDQ4MjI2NDI0OmQzY2RjNGQyNWNlZDMwOWEzN2U2ODBiZDgyMmI1YWRmNDI2ZjJlZjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8suEkgH2gAyNDQ4MjI2NDI0OjZlMTY3ODY4Njk1ZWE4YzkwMjJmMDdhNmVhODU5ZWUzNGQ2NTkxYWU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d3cdc4d25ced309a37e680bd822b5adf426f2ef2", "committedDate": "2020-07-13T12:31:08Z", "message": "participant manager /sites end point implementation\n\nparticipant manager /sites end point implementation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMDg0MTA3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#pullrequestreview-450084107", "createdAt": "2020-07-16T17:56:41Z", "commit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxNzo1Njo0MVrOGy2J-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxODo0NDozOVrOGy33sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk2OTI3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                boolean allowed = isEditPermissionAllowed(siteRequest);\n          \n          \n            \n                boolean canEdit = isEditPermissionAllowed(siteRequest);\n          \n      \n    \n    \n  \n\nor editAllowed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#discussion_r455969275", "createdAt": "2020-07-16T17:56:41Z", "author": {"login": "saminguyen"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java", "diffHunk": "@@ -0,0 +1,158 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.service;\n+\n+import static com.google.cloud.healthcare.fdamystudies.util.Constants.ACTIVE;\n+import static com.google.cloud.healthcare.fdamystudies.util.Constants.EDIT_VALUE;\n+\n+import java.util.List;\n+import java.util.Optional;\n+\n+import org.slf4j.ext.XLogger;\n+import org.slf4j.ext.XLoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Service;\n+import org.springframework.transaction.annotation.Transactional;\n+\n+import com.google.cloud.healthcare.fdamystudies.beans.SiteRequest;\n+import com.google.cloud.healthcare.fdamystudies.beans.SiteResponse;\n+import com.google.cloud.healthcare.fdamystudies.common.ErrorCode;\n+import com.google.cloud.healthcare.fdamystudies.common.MessageCode;\n+import com.google.cloud.healthcare.fdamystudies.mapper.SiteMapper;\n+import com.google.cloud.healthcare.fdamystudies.model.AppPermissionEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.LocationEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.SiteEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.SitePermissionEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.StudyEntity;\n+import com.google.cloud.healthcare.fdamystudies.model.StudyPermissionEntity;\n+import com.google.cloud.healthcare.fdamystudies.repository.AppPermissionRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.LocationRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.SiteRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.StudyPermissionRepository;\n+import com.google.cloud.healthcare.fdamystudies.repository.StudyRepository;\n+\n+@Service\n+public class SiteServiceImpl implements SiteService {\n+\n+  private XLogger logger = XLoggerFactory.getXLogger(SiteServiceImpl.class.getName());\n+\n+  @Autowired private SiteRepository siteRepository;\n+\n+  @Autowired private LocationRepository locationRepository;\n+\n+  @Autowired private StudyRepository studyRepository;\n+\n+  @Autowired private StudyPermissionRepository studyPermissionRepository;\n+\n+  @Autowired private AppPermissionRepository appPermissionRepository;\n+\n+  @Override\n+  @Transactional\n+  public SiteResponse addSite(SiteRequest siteRequest) {\n+    logger.entry(\"begin addSite()\");\n+    boolean allowed = isEditPermissionAllowed(siteRequest);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTk5NzM2Mg==", "bodyText": "add the word PERMISSION", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#discussion_r455997362", "createdAt": "2020-07-16T18:44:39Z", "author": {"login": "saminguyen"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/util/Constants.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.util;\n+\n+public final class Constants {\n+\n+  private Constants() {}\n+\n+  public static final int VIEW_VALUE = 0;\n+\n+  public static final int EDIT_VALUE = 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMjk2NTE1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#pullrequestreview-450296515", "createdAt": "2020-07-17T00:14:45Z", "commit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMDoxNDo0NVrOGzBCMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMDoxNDo0NVrOGzBCMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjE0NzUwNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              SITE_PERMISSION_ACEESS_DENIED(\n          \n          \n            \n              SITE_PERMISSION_ACCESS_DENIED(", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#discussion_r456147507", "createdAt": "2020-07-17T00:14:45Z", "author": {"login": "saminguyen"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java", "diffHunk": "@@ -57,7 +61,15 @@\n       500,\n       \"EC-500\",\n       \"Internal Server Error\",\n-      \"Sorry, an error has occurred and your request could not be processed. Please try again later.\");\n+      \"Sorry, an error has occurred and your request could not be processed. Please try again later.\"),\n+\n+  SITE_PERMISSION_ACEESS_DENIED(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3cdc4d25ced309a37e680bd822b5adf426f2ef2"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09ab5db1e9e444c2ef41689b0edd8f9fe0100a3e", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/09ab5db1e9e444c2ef41689b0edd8f9fe0100a3e", "committedDate": "2020-07-20T05:33:51Z", "message": "Fixed PR #621 comments\n\nAdded Permission enum and fixed other review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eacf153a8e0715e770009b5b25e816801017dbef", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/eacf153a8e0715e770009b5b25e816801017dbef", "committedDate": "2020-07-20T10:39:44Z", "message": "PR review comment fixes\n\nPR review comment fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a76fca0b704284591d742502124677081422d41", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/5a76fca0b704284591d742502124677081422d41", "committedDate": "2020-07-20T10:45:02Z", "message": "Merge branch 'participant-manager-service-sites-pending-entities' into participant-manager-service-sites-end-point"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxNzM3NTYy", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#pullrequestreview-451737562", "createdAt": "2020-07-20T15:50:43Z", "commit": {"oid": "5a76fca0b704284591d742502124677081422d41"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5ba630a4a06b5ee9161968d884f8dc4e6faa85d", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f5ba630a4a06b5ee9161968d884f8dc4e6faa85d", "committedDate": "2020-08-07T03:58:35Z", "message": "Merge branch 'develop' into participant-manager-service-sites-end-point"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "884567ba0ba014bfee54e080012418c5ec6f738f", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/884567ba0ba014bfee54e080012418c5ec6f738f", "committedDate": "2020-08-07T06:06:06Z", "message": "Resolved conflicts\n\nResolved conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNjgyMTE3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/621#pullrequestreview-463682117", "createdAt": "2020-08-07T23:07:36Z", "commit": {"oid": "884567ba0ba014bfee54e080012418c5ec6f738f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e167868695ea8c9022f07a6ea859ee34d6591ae", "author": {"user": {"login": "saminguyen", "name": "Sami Nguyen"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6e167868695ea8c9022f07a6ea859ee34d6591ae", "committedDate": "2020-08-07T23:07:41Z", "message": "Merge branch 'develop' into participant-manager-service-sites-end-point"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 825, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}