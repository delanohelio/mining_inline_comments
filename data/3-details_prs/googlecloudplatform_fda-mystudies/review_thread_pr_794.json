{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcyNDQ2ODUz", "number": 794, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzo1MDo1OFrOEblAsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzo1NDo0MlrOEblLBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3MzUzMzkzOnYy", "diffSide": "RIGHT", "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzo1MDo1OFrOHFlrjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDozMTo1MVrOHFnvMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTYyMjI4Nw==", "bodyText": "why is this toggle and not = true?\nin what situation would we want to set this to false when calling syncOfflineSavedData ?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/794#discussion_r475622287", "createdAt": "2020-08-24T13:50:58Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "diffHunk": "@@ -187,7 +189,7 @@ class ResponseServices: NSObject {\n     headers: [String: String]?,\n     delegate: NMWebServiceDelegate\n   ) {\n-\n+    self.isOfflineSyncRequest.toggle()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f3621a07d1016da97a6e2c384bd3347f9d1b4da"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY1MzgyNg==", "bodyText": "It's initialized as false initially and this method gets called only from Offline Syncing which will toggle it to true.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/794#discussion_r475653826", "createdAt": "2020-08-24T14:28:55Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "diffHunk": "@@ -187,7 +189,7 @@ class ResponseServices: NSObject {\n     headers: [String: String]?,\n     delegate: NMWebServiceDelegate\n   ) {\n-\n+    self.isOfflineSyncRequest.toggle()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTYyMjI4Nw=="}, "originalCommit": {"oid": "4f3621a07d1016da97a6e2c384bd3347f9d1b4da"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY1NTk4NA==", "bodyText": "then change to = true to be clear on that", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/794#discussion_r475655984", "createdAt": "2020-08-24T14:31:51Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "diffHunk": "@@ -187,7 +189,7 @@ class ResponseServices: NSObject {\n     headers: [String: String]?,\n     delegate: NMWebServiceDelegate\n   ) {\n-\n+    self.isOfflineSyncRequest.toggle()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTYyMjI4Nw=="}, "originalCommit": {"oid": "4f3621a07d1016da97a6e2c384bd3347f9d1b4da"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3MzU0MjY4OnYy", "diffSide": "RIGHT", "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzo1MjoxMlrOHFlxFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDozMTo0N1rOHFnu_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTYyMzcwMg==", "bodyText": "Do you simply ignore the NetworkErrors on offlineSyncRequest?\nIf yes, please leave a comment to explain why it is safe to ignore", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/794#discussion_r475623702", "createdAt": "2020-08-24T13:52:12Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "diffHunk": "@@ -446,13 +448,13 @@ extension ResponseServices: NMWebServiceDelegate {\n       || requestName as String == ResponseMethods.updateActivityState.description\n     {\n \n-      if error.code == kNoNetworkErrorCode {\n+      if error.code == kNoNetworkErrorCode, !isOfflineSyncRequest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f3621a07d1016da97a6e2c384bd3347f9d1b4da"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY1NTkzMw==", "bodyText": "I'm ignoring this block execution with offline syncing call as it was saving the object again in the DB if the request gets failed due to network again. I'll add a comment here why it's ignored.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/794#discussion_r475655933", "createdAt": "2020-08-24T14:31:47Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Networking/APIs/ResponseServices.swift", "diffHunk": "@@ -446,13 +448,13 @@ extension ResponseServices: NMWebServiceDelegate {\n       || requestName as String == ResponseMethods.updateActivityState.description\n     {\n \n-      if error.code == kNoNetworkErrorCode {\n+      if error.code == kNoNetworkErrorCode, !isOfflineSyncRequest {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTYyMzcwMg=="}, "originalCommit": {"oid": "4f3621a07d1016da97a6e2c384bd3347f9d1b4da"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk3MzU2MDM3OnYy", "diffSide": "RIGHT", "path": "iOS/HPHC/HPHC/Utils/Helpers/SyncUpdate/SyncUpdate.swift", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxMzo1NDo0MlrOHFl8zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNFQxNDozMzozOVrOHFnzsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTYyNjcwMA==", "bodyText": "what happens if the sync fails?\nMaybe we should delete the previous value only when the sync request has succeeded?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/794#discussion_r475626700", "createdAt": "2020-08-24T13:54:42Z", "author": {"login": "zohrehj"}, "path": "iOS/HPHC/HPHC/Utils/Helpers/SyncUpdate/SyncUpdate.swift", "diffHunk": "@@ -106,7 +117,8 @@ extension SyncUpdate: NMWebServiceDelegate {\n   func startedRequest(_ manager: NetworkManager, requestName: NSString) {}\n \n   func finishedRequest(_ manager: NetworkManager, requestName: NSString, response: AnyObject?) {\n-    self.syncDataToServer()\n+    deleteSyncedObject()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4f3621a07d1016da97a6e2c384bd3347f9d1b4da"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY1NzEzNg==", "bodyText": "This func finishedRequest gets called only when the sync is successful and I'm deleting the synced value after that only.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/794#discussion_r475657136", "createdAt": "2020-08-24T14:33:39Z", "author": {"login": "tushar-boston"}, "path": "iOS/HPHC/HPHC/Utils/Helpers/SyncUpdate/SyncUpdate.swift", "diffHunk": "@@ -106,7 +117,8 @@ extension SyncUpdate: NMWebServiceDelegate {\n   func startedRequest(_ manager: NetworkManager, requestName: NSString) {}\n \n   func finishedRequest(_ manager: NetworkManager, requestName: NSString, response: AnyObject?) {\n-    self.syncDataToServer()\n+    deleteSyncedObject()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTYyNjcwMA=="}, "originalCommit": {"oid": "4f3621a07d1016da97a6e2c384bd3347f9d1b4da"}, "originalPosition": 71}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2181, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}