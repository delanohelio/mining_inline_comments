{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc1NTMzNDgy", "number": 852, "title": "Participant Manager Service: [PATCH] /users/{userId}/status  endpoint implementation with integration tests", "bodyText": "Current Implementation: The /users/{userId}/deactivate endpoint was not providing any flexibility to update the status to UserStatus enum values.\npublic enum UserStatus {\n  DEACTIVATED(0, \"Deactivated\"),\n  ACTIVE(1, \"Active\"),\n  INVITED(2, \"Invited\");\n}\n\nSuggested Changes: Refactor the API to update the status to value received from the client application in request body. Also update the user account status in OAuth Scim service if the status is ACTIVE or DEACTIVATED.", "createdAt": "2020-08-28T17:09:17Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852", "merged": true, "mergeCommit": {"oid": "e04e28bc33092241c9caf282729e7fcda5db3596"}, "closed": true, "closedAt": "2020-09-03T14:17:08Z", "author": {"login": "Kantharajut-btc"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDYF1RAH2gAyNDc1NTMzNDgyOjM3ZmM2YjRlOGEzMDE4YmU0YzA0MWM3MGQ0OTRlOWFiNDkxYThlOTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFRTJCgFqTQ4MTg4NDQwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/37fc6b4e8a3018be4c041c70d494e9ab491a8e93", "committedDate": "2020-08-28T17:03:06Z", "message": "Deactivate/Reactivate User endpoint implementation\n\nDeactivate/Reactivate User endpoint implementation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4NzA2ODcz", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#pullrequestreview-478706873", "createdAt": "2020-08-31T15:17:48Z", "commit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToxNzo0OFrOHJ9Grw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNToyNTozNlrOHJ9ZMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwMDM2Nw==", "bodyText": "let's use an enum instead? that would make it more clear what 0 and 1 are at a glance.\nIf you are looking for a boolean behavior, lets change the name to something that indicates that, e.g. active instead of status and change the value to Boolean instead of Integer", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r480200367", "createdAt": "2020-08-31T15:17:48Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/UserStatusRequest.java", "diffHunk": "@@ -0,0 +1,21 @@\n+package com.google.cloud.healthcare.fdamystudies.beans;\n+\n+import javax.validation.constraints.Max;\n+import javax.validation.constraints.Min;\n+import javax.validation.constraints.NotNull;\n+import lombok.Getter;\n+import lombok.Setter;\n+import lombok.ToString;\n+\n+@Getter\n+@Setter\n+@ToString\n+public class UserStatusRequest {\n+\n+  @Min(0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwNTEwNw==", "bodyText": "this does not follow REST URL formats, status is not a resource and it is also not a custom action on the user.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r480205107", "createdAt": "2020-08-31T15:25:36Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}/status\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "37fc6b4e8a3018be4c041c70d494e9ab491a8e93"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b2a2f6c9e28abbaea0e43ee9efcce727b131a1f5", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/b2a2f6c9e28abbaea0e43ee9efcce727b131a1f5", "committedDate": "2020-09-02T15:12:40Z", "message": "fixed PR comments\n\nfixed PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxMjM4ODc2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#pullrequestreview-481238876", "createdAt": "2020-09-02T19:34:37Z", "commit": {"oid": "b2a2f6c9e28abbaea0e43ee9efcce727b131a1f5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ca7608be9965985cc042ca2e29a74c66c63e1aad", "committedDate": "2020-09-03T06:59:38Z", "message": "Fixed PR comment\n\nFixed PR comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxNzg2MTA0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#pullrequestreview-481786104", "createdAt": "2020-09-03T12:26:36Z", "commit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMjoyNjozNlrOHMkNAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxMjoyODozOVrOHMkRpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzODExNA==", "bodyText": "should this be a more generic request then? since we can in future add more fields here.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482938114", "createdAt": "2020-09-03T12:26:36Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}\",\n       consumes = MediaType.APPLICATION_JSON_VALUE,\n       produces = MediaType.APPLICATION_JSON_VALUE)\n-  public ResponseEntity<DeactivateAccountResponse> deactivateAccount(\n-      @PathVariable String userId, HttpServletRequest request) {\n-\n+  public ResponseEntity<UserAccountStatusResponse> updateUserAccountStatus(\n+      @PathVariable String userId,\n+      @Valid @RequestBody UserStatusRequest statusRequest,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzODUzMw==", "bodyText": "please rename. deactivateResponse is no longer accurate.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482938533", "createdAt": "2020-09-03T12:27:17Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserProfileController.java", "diffHunk": "@@ -98,15 +99,18 @@\n   }\n \n   @PatchMapping(\n-      value = \"/users/{userId}/deactivate\",\n+      value = \"/users/{userId}\",\n       consumes = MediaType.APPLICATION_JSON_VALUE,\n       produces = MediaType.APPLICATION_JSON_VALUE)\n-  public ResponseEntity<DeactivateAccountResponse> deactivateAccount(\n-      @PathVariable String userId, HttpServletRequest request) {\n-\n+  public ResponseEntity<UserAccountStatusResponse> updateUserAccountStatus(\n+      @PathVariable String userId,\n+      @Valid @RequestBody UserStatusRequest statusRequest,\n+      HttpServletRequest request) {\n     logger.entry(String.format(BEGIN_REQUEST_LOG, request.getRequestURI()));\n \n-    DeactivateAccountResponse deactivateResponse = userProfileService.deactivateAccount(userId);\n+    statusRequest.setUserId(userId);\n+    UserAccountStatusResponse deactivateResponse =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjkzOTMwMw==", "bodyText": "why not user PATCH_USER?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#discussion_r482939303", "createdAt": "2020-09-03T12:28:39Z", "author": {"login": "zohrehj"}, "path": "participant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/common/ApiEndpoint.java", "diffHunk": "@@ -20,7 +20,7 @@\n \n   SET_UP_ACCOUNT(\"http://localhost:8080/participant-manager-service/users/\"),\n \n-  DEACTIVATE_ACCOUNT(\"http://localhost:8080/participant-manager-service/users/{userId}/deactivate\"),\n+  UPDATE_USER_STATUS(\"http://localhost:8080/participant-manager-service/users/{userId}\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7608be9965985cc042ca2e29a74c66c63e1aad"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6755c91a296eb9f5946f2a10bd39116d25575d2d", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6755c91a296eb9f5946f2a10bd39116d25575d2d", "committedDate": "2020-09-03T12:58:36Z", "message": "Fixed PR comments\n\nFixed PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxODUwMDY5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#pullrequestreview-481850069", "createdAt": "2020-09-03T13:41:12Z", "commit": {"oid": "6755c91a296eb9f5946f2a10bd39116d25575d2d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e86bc4448c997fc276e190aad93f679f34430d5f", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e86bc4448c997fc276e190aad93f679f34430d5f", "committedDate": "2020-09-03T13:56:33Z", "message": "Merge branch 'develop' into participant-manager-deactivate-user-code-changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d82fa0bae0693a9c1cd57cb3809389c446a3c3d9", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d82fa0bae0693a9c1cd57cb3809389c446a3c3d9", "committedDate": "2020-09-03T14:11:13Z", "message": "Merge branch 'develop' into participant-manager-deactivate-user-code-changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxODg0NDA1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/852#pullrequestreview-481884405", "createdAt": "2020-09-03T14:16:09Z", "commit": {"oid": "d82fa0bae0693a9c1cd57cb3809389c446a3c3d9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 404, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}