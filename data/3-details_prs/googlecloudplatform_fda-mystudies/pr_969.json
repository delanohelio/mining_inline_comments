{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NzExNjQy", "number": 969, "title": "Fixed issue #968 OAuth Scim Service - verify MimeMessage content in Tests ", "bodyText": "Fixed issue #968 OAuth Scim Service - verify MimeMessage content in Tests\nIn PlaceholderReplacer class \"@\" was causing issue when the text has email so, replaced \"@\" with \"{{\" and \"}}\"", "createdAt": "2020-09-14T15:41:12Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/969", "merged": true, "mergeCommit": {"oid": "01d345a9f44c94a005db298cc91bb27d1cc19473"}, "closed": true, "closedAt": "2020-09-18T05:05:21Z", "author": {"login": "monica-BTC"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdI07VTAH2gAyNDg2NzExNjQyOjY4N2FiNmIzYzAzOGJkZGVjMjhhOGNjOTMzY2MxMmFmYjE3MmJiZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJ-XsigH2gAyNDg2NzExNjQyOjE1NzE4ZmEyMzQwMDIyZDU2MGJhYTgzYTY5MjVlMmM1ZDcwOWQ4ZDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "687ab6b3c038bddec28a8cc933cc12afb172bbd7", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/687ab6b3c038bddec28a8cc933cc12afb172bbd7", "committedDate": "2020-09-14T15:28:30Z", "message": "oauth scim email service implementation for resetPassword and sendAccountLockedEmail\n\noauth scim email service implementation for resetPassword and sendAccountLockedEmail"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d497e8d81031a58691b36aa9e5011122f7751be", "author": {"user": {"login": "saminguyen", "name": "Sami Nguyen"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2d497e8d81031a58691b36aa9e5011122f7751be", "committedDate": "2020-09-15T05:03:01Z", "message": "Merge branch 'develop' into oauth-scim-email-service-implementation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4MzM5MDg1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/969#pullrequestreview-488339085", "createdAt": "2020-09-15T05:39:28Z", "commit": {"oid": "687ab6b3c038bddec28a8cc933cc12afb172bbd7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNTozOToyOVrOHRxb1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwNTozOToyOVrOHRxb1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODM5Nzc4Mg==", "bodyText": "If this is done for all MimeMessage verification it would make sense to move it into verifyMimeMessage() itself, and we can just make the method void", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/969#discussion_r488397782", "createdAt": "2020-09-15T05:39:29Z", "author": {"login": "saminguyen"}, "path": "oauth-scim-module/oauth-scim-service/src/test/java/com/google/cloud/healthcare/fdamystudies/oauthscim/controller/LoginControllerTest.java", "diffHunk": "@@ -363,6 +370,24 @@ public void shouldSendAccountLockedEmail() throws Exception {\n     userEntity = userRepository.findByUserId(userResponse.getUserId()).get();\n     assertTrue(\n         UserAccountStatus.ACCOUNT_LOCKED.equals(UserAccountStatus.valueOf(userEntity.getStatus())));\n+\n+    String subject = getMailAccountLockedSubject();\n+    String body =\n+        String.join(\n+            \"<br/>\",\n+            \"This is to inform you that, as a security measure, your user account for MyStudies app\",\n+            \"has been temporarily locked for a period of 15 minutes, due to multiple consecutive failed sign-in\",\n+            \"attempts with incorrect password.\");\n+\n+    MimeMessage mail =\n+        verifyMimeMessage(EMAIL_VALUE, appPropertyConfig.getFromEmail(), subject, body);\n+    verifyDoesNotContain(mail.getContent().toString(), \"@tempPassword@\", \"@appId\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "687ab6b3c038bddec28a8cc933cc12afb172bbd7"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a52c8544a44990cb9c6e04e5a4518eb7f1878e2", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/5a52c8544a44990cb9c6e04e5a4518eb7f1878e2", "committedDate": "2020-09-15T06:04:09Z", "message": "Fixed Build issue\n\nFixed Build issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwNzg3ODM4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/969#pullrequestreview-490787838", "createdAt": "2020-09-17T16:34:46Z", "commit": {"oid": "5a52c8544a44990cb9c6e04e5a4518eb7f1878e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15718fa2340022d560baa83a6925e2c5d709d8d1", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/15718fa2340022d560baa83a6925e2c5d709d8d1", "committedDate": "2020-09-18T05:02:33Z", "message": "Merge branch 'develop' into oauth-scim-email-service-implementation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 527, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}