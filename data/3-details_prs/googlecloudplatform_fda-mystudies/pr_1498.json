{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2MDg0NTgy", "number": 1498, "title": "Study-Builder: Scheduler audit log", "bodyText": "Reasons for not writing test case:\n\n\nNotificationDAO.getPushNotificationList(date, time) -> It uses system date and time so even a second difference will result in zero records returned from this method so no audit event is logged. This may result in unpredictable test results.\n\n\nHttpClient client object is created with new keyword, so this can't be mocked, it always throws connection error.", "createdAt": "2020-10-19T15:45:03Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1498", "merged": true, "mergeCommit": {"oid": "54eb1ad90c37f82ccbee34d3dfb6e611782aa4f4"}, "closed": true, "closedAt": "2020-10-23T05:52:08Z", "author": {"login": "navya-BTC"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdUGEgCAH2gAyNTA2MDg0NTgyOmEyNjgwZWJiMTk3YmNlMjI0NTIyOGE5ODYwZjUxNWRhMzk1ZGNhZjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVQBxuAH2gAyNTA2MDg0NTgyOjU0MDI3ZjFkMjMzODBlODhiMmRkYzIzMjA0YzNiMDJiOTI1N2M1YTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a2680ebb197bce2245228a9860f515da395dcaf7", "author": {"user": {"login": "navya-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a2680ebb197bce2245228a9860f515da395dcaf7", "committedDate": "2020-10-19T15:40:04Z", "message": "scheduler audit log"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyMTEwMzI2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1498#pullrequestreview-512110326", "createdAt": "2020-10-19T19:55:05Z", "commit": {"oid": "a2680ebb197bce2245228a9860f515da395dcaf7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxOTo1NTowNVrOHkfUGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQxOTo1Njo0NFrOHkfX7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAyMzgzNQ==", "bodyText": "Keep empty line between static and non static imports", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1498#discussion_r508023835", "createdAt": "2020-10-19T19:55:05Z", "author": {"login": "saminguyen"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/common/StudyBuilderAuditEvent.java", "diffHunk": "@@ -12,7 +12,6 @@\n import static com.fdahpstudydesigner.common.PlatformComponent.RESPONSE_DATASTORE;\n import static com.fdahpstudydesigner.common.PlatformComponent.STUDY_BUILDER;\n import static com.fdahpstudydesigner.common.PlatformComponent.STUDY_DATASTORE;\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2680ebb197bce2245228a9860f515da395dcaf7"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAyNDEwMw==", "bodyText": "please fix typo here", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1498#discussion_r508024103", "createdAt": "2020-10-19T19:55:29Z", "author": {"login": "saminguyen"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/scheduler/FDASchedulerService.java", "diffHunk": "@@ -78,6 +89,8 @@\n \n   @Autowired private NotificationService notificationService;\n \n+  @Autowired private StudyBuilderAuditEventHelper auditLogEvtHelper;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2680ebb197bce2245228a9860f515da395dcaf7"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODAyNDgxMg==", "bodyText": "Please add unit testing for these audit log cases", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1498#discussion_r508024812", "createdAt": "2020-10-19T19:56:44Z", "author": {"login": "saminguyen"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/scheduler/FDASchedulerService.java", "diffHunk": "@@ -228,11 +241,32 @@ public void sendPushNotification() {\n             new StringEntity(json.toString(), ContentType.APPLICATION_JSON);\n         post.setEntity(requestEntity);\n         client.execute(post);\n+        client.execute(post);\n+        HttpResponse response = client.execute(post);\n+        StatusLine statusLine = response.getStatusLine();\n+        if (statusLine.getStatusCode() == 200) {\n+          logSendNotificationFailedEvent(NOTIFICATION_METADATA_SENT_TO_PARTICIPANT_DATASTORE);\n+        } else {\n+          logSendNotificationFailedEvent(NOTIFICATION_METADATA_SEND_OPERATION_FAILED);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2680ebb197bce2245228a9860f515da395dcaf7"}, "originalPosition": 57}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7942e957061702ba7eb423ab0d73ce31cd1186b", "author": {"user": {"login": "navya-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d7942e957061702ba7eb423ab0d73ce31cd1186b", "committedDate": "2020-10-20T07:56:48Z", "message": "Fixed the comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82038ac81f16d647ad1fa1d431e07a27181f9133", "author": {"user": {"login": "navya-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/82038ac81f16d647ad1fa1d431e07a27181f9133", "committedDate": "2020-10-20T07:58:06Z", "message": "Merge branch 'develop' into studyBuilder-scheduler-audit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d3fad3963fdf90d08bbeac8b78975fbb0f09a24", "author": {"user": {"login": "navya-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/4d3fad3963fdf90d08bbeac8b78975fbb0f09a24", "committedDate": "2020-10-20T08:03:45Z", "message": "Update FDASchedulerService.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab9e85cd7ae58b191046193221418d04f25c6aa5", "author": {"user": {"login": "navya-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/ab9e85cd7ae58b191046193221418d04f25c6aa5", "committedDate": "2020-10-22T13:46:03Z", "message": "Merge branch 'develop' into studyBuilder-scheduler-audit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0OTMzOTg5", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1498#pullrequestreview-514933989", "createdAt": "2020-10-22T16:55:09Z", "commit": {"oid": "ab9e85cd7ae58b191046193221418d04f25c6aa5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eda0721e424db13836cdd7b5950f8bfcf19856e9", "author": {"user": {"login": "saminguyen", "name": "Sami Nguyen"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/eda0721e424db13836cdd7b5950f8bfcf19856e9", "committedDate": "2020-10-22T16:55:13Z", "message": "Merge branch 'develop' into studyBuilder-scheduler-audit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54027f1d23380e88b2ddc23204c3b02b9257c5a5", "author": {"user": {"login": "navya-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/54027f1d23380e88b2ddc23204c3b02b9257c5a5", "committedDate": "2020-10-23T05:50:04Z", "message": "Merge branch 'develop' into studyBuilder-scheduler-audit"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 122, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}