{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcwODE0OTM2", "number": 780, "title": "Consent Module : Audit Log Events Implementation", "bodyText": "Removed old audit log implementation methods - createActivityLog() from CommonServiceImpl\nRemoved ActivityLogBOand ActivityLogRepository\nImplemented audit log events listed in HIPAA-grade Audit Logs - FDA MyStudies on Google Cloud -EAP V3.1-2020-08-01 - Consent Service(Participant Datastore)", "createdAt": "2020-08-20T10:25:21Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780", "merged": true, "mergeCommit": {"oid": "e7a73810edda46855e66db484f31ae306ce53ab6"}, "closed": true, "closedAt": "2020-08-31T15:40:07Z", "author": {"login": "monica-BTC"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAtZzkgH2gAyNDcwODE0OTM2OjAzMWY4NzYwM2JiNTM3MWQ5MTcwNmQ4MWQ0N2YwNDVjMTcyYzg5NWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEUqrbgH2gAyNDcwODE0OTM2Ojc1MzZiMWUwOGVkMzMyOTlkNDdmODIxODgxYjZmNjg3NmRhYmUwNmY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "031f87603bb5371d91706d81d47f045c172c895c", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/031f87603bb5371d91706d81d47f045c172c895c", "committedDate": "2020-08-20T10:11:09Z", "message": "Audit Log Implementation for Consent Module\n\nAudit Log Implementation for Consent Module"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "813491a5f7ef57cc06610906b24848069984fad6", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/813491a5f7ef57cc06610906b24848069984fad6", "committedDate": "2020-08-20T10:19:43Z", "message": "removed old audit log code\n\nremoved old audit log code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "679804f525adfdc04eb8decd34a0451178c406f5", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/679804f525adfdc04eb8decd34a0451178c406f5", "committedDate": "2020-08-20T10:23:06Z", "message": "removed ActivityLogBO\n\nremoved ActivityLogBO"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxNDYyNDk1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#pullrequestreview-471462495", "createdAt": "2020-08-20T10:26:05Z", "commit": {"oid": "679804f525adfdc04eb8decd34a0451178c406f5"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMDoyNjowNlrOHD6DyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxMDoyNjowNlrOHD6DzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg1OTAxNw==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nMissing a Javadoc comment.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#discussion_r473859017", "createdAt": "2020-08-20T10:26:06Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ConsentAuditHelper.java", "diffHunk": "@@ -0,0 +1,33 @@\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import com.google.cloud.healthcare.fdamystudies.beans.AuditLogEventRequest;\n+import com.google.cloud.healthcare.fdamystudies.mapper.AuditEventMapper;\n+import com.google.cloud.healthcare.fdamystudies.service.AuditEventService;\n+import java.util.Map;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class ConsentAuditHelper {\n+\n+  @Autowired AuditEventService auditService;\n+\n+  @Autowired private CommonApplicationPropertyConfig commonPropConfig;\n+\n+  public void logEvent(AuditLogEvent eventEnum, AuditLogEventRequest auditRequest) {\n+    logEvent(eventEnum, auditRequest, null);\n+  }\n+\n+  public void logEvent(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "679804f525adfdc04eb8decd34a0451178c406f5"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzg1OTAyMQ==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nLine is longer than 100 characters (found 146).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#discussion_r473859021", "createdAt": "2020-08-20T10:26:06Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ConsentManagementEnum.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.MOBILE_APPS;\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.PARTICIPANT_DATASTORE;\n+\n+import java.util.Optional;\n+import lombok.Getter;\n+\n+@Getter\n+public enum ConsentManagementEnum implements AuditLogEvent {\n+  INFORMED_CONSENT_PROVIDED_FOR_STUDY(\n+      MOBILE_APPS,\n+      PARTICIPANT_DATASTORE,\n+      null,\n+      \"Informed consent provided by app user for the study (consent version: ${consent_version}, data-sharing consent: ${data_sharing_consent}).\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "679804f525adfdc04eb8decd34a0451178c406f5"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxNjU2NjA3", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#pullrequestreview-471656607", "createdAt": "2020-08-20T14:13:36Z", "commit": {"oid": "679804f525adfdc04eb8decd34a0451178c406f5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f14e02664efb969afd880cbc488cf42bf327096", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7f14e02664efb969afd880cbc488cf42bf327096", "committedDate": "2020-08-23T08:16:05Z", "message": "consent audit logs with tests\n\nconsent audit logs with tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f073c72b83b3980901e5e523394a1ddda5588b4", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8f073c72b83b3980901e5e523394a1ddda5588b4", "committedDate": "2020-08-23T15:34:28Z", "message": "Added Test cases for Audit Log Events\n\nAdded Test cases for Audit Log Events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "491623fd2ca4db19fd6bda4f11fd5241e26b41f6", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/491623fd2ca4db19fd6bda4f11fd5241e26b41f6", "committedDate": "2020-08-24T09:01:53Z", "message": "Added test case for READ_OPERATION_FAILED_FOR_SIGNED_CONSENT_DOCUMENT audit log\n\nAdded test case for READ_OPERATION_FAILED_FOR_SIGNED_CONSENT_DOCUMENT audit log"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0MTM4NzA2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#pullrequestreview-474138706", "createdAt": "2020-08-25T05:10:13Z", "commit": {"oid": "491623fd2ca4db19fd6bda4f11fd5241e26b41f6"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e4156f5a460eadf68059f5caa518e519a64ffe0", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/0e4156f5a460eadf68059f5caa518e519a64ffe0", "committedDate": "2020-08-25T06:20:55Z", "message": "Merge branch 'develop' into consent-audit-logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7394e0e797c7dd3540ff0d6b8ef07b59d38c18a4", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7394e0e797c7dd3540ff0d6b8ef07b59d38c18a4", "committedDate": "2020-08-25T06:42:05Z", "message": "Resolved conflicts\n\nResolved conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3d973082ab3f98de9a5873e027468a63603494a", "author": {"user": {"login": "saminguyen", "name": "Sami Nguyen"}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a3d973082ab3f98de9a5873e027468a63603494a", "committedDate": "2020-08-25T14:42:27Z", "message": "Merge branch 'develop' into consent-audit-logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "205969295225fdc94a2468d64c83af85ea9efc5c", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/205969295225fdc94a2468d64c83af85ea9efc5c", "committedDate": "2020-08-28T12:31:44Z", "message": "Merge branch 'develop' into consent-audit-logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24a1fd10d405158500228cd303bd3f70258d7481", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/24a1fd10d405158500228cd303bd3f70258d7481", "committedDate": "2020-08-28T12:56:23Z", "message": "Merge branch 'consent-audit-logs' of https://github.com/GoogleCloudPlatform/fda-mystudies into consent-audit-logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6741e88c173394dd1e40f3c9092b6634eef82c11", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6741e88c173394dd1e40f3c9092b6634eef82c11", "committedDate": "2020-08-28T12:56:29Z", "message": "Merge branch 'consent-audit-logs' of https://github.com/GoogleCloudPlatform/fda-mystudies into consent-audit-logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c364b055c6c456ce375a48e6b3cb54b4d1127b51", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c364b055c6c456ce375a48e6b3cb54b4d1127b51", "committedDate": "2020-08-28T13:00:30Z", "message": "Fixed Build issue\n\nFixed Build issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3NzA4MDAx", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#pullrequestreview-477708001", "createdAt": "2020-08-28T13:01:24Z", "commit": {"oid": "c364b055c6c456ce375a48e6b3cb54b4d1127b51"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMzowMToyNFrOHJD_8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMzowMToyNVrOHJD_9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTI2NDc1NQ==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nLine is longer than 100 characters (found 117).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#discussion_r479264755", "createdAt": "2020-08-28T13:01:24Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ConsentManagementEnum.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.CLOUD_STORAGE;\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.MOBILE_APPS;\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.PARTICIPANT_DATASTORE;\n+\n+import java.util.Optional;\n+import lombok.Getter;\n+\n+@Getter\n+public enum ConsentManagementEnum implements AuditLogEvent {\n+  INFORMED_CONSENT_PROVIDED_FOR_STUDY(\n+      MOBILE_APPS,\n+      PARTICIPANT_DATASTORE,\n+      null,\n+      \"Informed consent provided by app user for the study (consent version: ${consent_version}, \"\n+          + \"data-sharing consent: ${data_sharing_consent}).\",\n+      \"INFORMED_CONSENT_PROVIDED_FOR_STUDY\"),\n+\n+  USER_ENROLLED_INTO_STUDY(\n+      MOBILE_APPS, PARTICIPANT_DATASTORE, null, null, \"USER_ENROLLED_INTO_STUDY\"),\n+\n+  STUDY_ENROLLMENT_FAILED(\n+      MOBILE_APPS, PARTICIPANT_DATASTORE, null, null, \"STUDY_ENROLLMENT_FAILED\"),\n+\n+  READ_OPERATION_SUCCEEDED_FOR_SIGNED_CONSENT_DOCUMENT(\n+      MOBILE_APPS,\n+      CLOUD_STORAGE,\n+      PARTICIPANT_DATASTORE,\n+      \"Participant's consent document (${file_name}) retrieved.\",\n+      \"READ_OPERATION_SUCCEEDED_FOR_SIGNED_CONSENT_DOCUMENT\"),\n+\n+  READ_OPERATION_FAILED_FOR_SIGNED_CONSENT_DOCUMENT(\n+      MOBILE_APPS,\n+      CLOUD_STORAGE,\n+      PARTICIPANT_DATASTORE,\n+      \"Attempt to retrieve participant's consent document failed.\",\n+      \"READ_OPERATION_FAILED_FOR_SIGNED_CONSENT_DOCUMENT\"),\n+\n+  SIGNED_CONSENT_DOCUMENT_SAVED(\n+      MOBILE_APPS,\n+      CLOUD_STORAGE,\n+      PARTICIPANT_DATASTORE,\n+      \"Consent document (${file_name}) for consent version ${consent_version} saved in directory ${directory_name}.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c364b055c6c456ce375a48e6b3cb54b4d1127b51"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTI2NDc1OQ==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nLine is longer than 100 characters (found 130).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#discussion_r479264759", "createdAt": "2020-08-28T13:01:25Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ConsentManagementEnum.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Use of this source code is governed by an MIT-style\n+ * license that can be found in the LICENSE file or at\n+ * https://opensource.org/licenses/MIT.\n+ */\n+\n+package com.google.cloud.healthcare.fdamystudies.common;\n+\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.CLOUD_STORAGE;\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.MOBILE_APPS;\n+import static com.google.cloud.healthcare.fdamystudies.common.PlatformComponent.PARTICIPANT_DATASTORE;\n+\n+import java.util.Optional;\n+import lombok.Getter;\n+\n+@Getter\n+public enum ConsentManagementEnum implements AuditLogEvent {\n+  INFORMED_CONSENT_PROVIDED_FOR_STUDY(\n+      MOBILE_APPS,\n+      PARTICIPANT_DATASTORE,\n+      null,\n+      \"Informed consent provided by app user for the study (consent version: ${consent_version}, \"\n+          + \"data-sharing consent: ${data_sharing_consent}).\",\n+      \"INFORMED_CONSENT_PROVIDED_FOR_STUDY\"),\n+\n+  USER_ENROLLED_INTO_STUDY(\n+      MOBILE_APPS, PARTICIPANT_DATASTORE, null, null, \"USER_ENROLLED_INTO_STUDY\"),\n+\n+  STUDY_ENROLLMENT_FAILED(\n+      MOBILE_APPS, PARTICIPANT_DATASTORE, null, null, \"STUDY_ENROLLMENT_FAILED\"),\n+\n+  READ_OPERATION_SUCCEEDED_FOR_SIGNED_CONSENT_DOCUMENT(\n+      MOBILE_APPS,\n+      CLOUD_STORAGE,\n+      PARTICIPANT_DATASTORE,\n+      \"Participant's consent document (${file_name}) retrieved.\",\n+      \"READ_OPERATION_SUCCEEDED_FOR_SIGNED_CONSENT_DOCUMENT\"),\n+\n+  READ_OPERATION_FAILED_FOR_SIGNED_CONSENT_DOCUMENT(\n+      MOBILE_APPS,\n+      CLOUD_STORAGE,\n+      PARTICIPANT_DATASTORE,\n+      \"Attempt to retrieve participant's consent document failed.\",\n+      \"READ_OPERATION_FAILED_FOR_SIGNED_CONSENT_DOCUMENT\"),\n+\n+  SIGNED_CONSENT_DOCUMENT_SAVED(\n+      MOBILE_APPS,\n+      CLOUD_STORAGE,\n+      PARTICIPANT_DATASTORE,\n+      \"Consent document (${file_name}) for consent version ${consent_version} saved in directory ${directory_name}.\",\n+      \"SIGNED_CONSENT_DOCUMENT_SAVED\"),\n+\n+  SIGNED_CONSENT_DOCUMENT_SAVE_FAILED(\n+      MOBILE_APPS,\n+      CLOUD_STORAGE,\n+      PARTICIPANT_DATASTORE,\n+      \"Consent document (${file_name}) for consent version ${consent_version} could not be saved in directory ${directory_name}.\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c364b055c6c456ce375a48e6b3cb54b4d1127b51"}, "originalPosition": 59}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88d89e240627e7060f09150aa6747e0ade69533a", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/88d89e240627e7060f09150aa6747e0ade69533a", "committedDate": "2020-08-28T13:14:25Z", "message": "Splitted into 2 lines\n\nSplitted into 2 lines"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3OTUyNDA0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#pullrequestreview-477952404", "createdAt": "2020-08-28T18:46:26Z", "commit": {"oid": "88d89e240627e7060f09150aa6747e0ade69533a"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "713a80a1df77ba15ef3466267b30e70660a07f9b", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/713a80a1df77ba15ef3466267b30e70660a07f9b", "committedDate": "2020-08-31T05:20:15Z", "message": "Merge branch 'develop' into consent-audit-logs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4NjY4MDM2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#pullrequestreview-478668036", "createdAt": "2020-08-31T14:31:39Z", "commit": {"oid": "713a80a1df77ba15ef3466267b30e70660a07f9b"}, "state": "DISMISSED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNDozMTo0MFrOHJ7SPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMVQxNDo0MDo0N1rOHJ7pmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE3MDU1OA==", "bodyText": "remove debug log", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#discussion_r480170558", "createdAt": "2020-08-31T14:31:40Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-tests/src/main/java/com/google/cloud/healthcare/fdamystudies/common/BaseMockIT.java", "diffHunk": "@@ -224,7 +226,7 @@ protected void verifyAuditEventCall(AuditLogEvent... auditEvents) {\n \n     for (AuditLogEvent auditEvent : auditEvents) {\n       AuditLogEventRequest auditRequest = auditRequestByEventCode.get(auditEvent.getEventCode());\n-\n+      logger.debug(auditRequest.toString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "713a80a1df77ba15ef3466267b30e70660a07f9b"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE3NDk2MA==", "bodyText": "nit: I would prefer if audit log call is called here and not bundled with saving to cloudstorage.\nIt would be more consistent with how it is called in other scenarios.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#discussion_r480174960", "createdAt": "2020-08-31T14:38:18Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserConsentManagementController.java", "diffHunk": "@@ -126,10 +149,9 @@ public String ping() {\n                           + \"_\"\n                           + new SimpleDateFormat(\"MMddyyyyHHmmss\").format(new Date())\n                           + \".pdf\";\n-                  String content = consentStatusBean.getConsent().getPdf();\n-                  String path = cloudStorageService.saveFile(fileName, content, underDirectory);\n-                  studyConsent.setPdfPath(path);\n-                  studyConsent.setPdfStorage(1);\n+\n+                  saveToCloudAndLogAudit(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "713a80a1df77ba15ef3466267b30e70660a07f9b"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE3NjUzOQ==", "bodyText": "where is the success scenario audit log gets submitted?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#discussion_r480176539", "createdAt": "2020-08-31T14:40:47Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserConsentManagementController.java", "diffHunk": "@@ -232,11 +280,16 @@ public String ping() {\n         studyInfoBean = userConsentManagementService.getStudyInfoId(studyId);\n         consentStudyResponseBean =\n             userConsentManagementService.getStudyConsentDetails(\n-                userId, studyInfoBean.getStudyInfoId(), consentVersion);\n-        if (consentStudyResponseBean != null) {\n+                userId, studyInfoBean.getStudyInfoId(), consentVersion, auditRequest);\n+        auditRequest.setUserId(userId);\n+        auditRequest.setStudyId(studyId);\n+\n+        if (consentStudyResponseBean.getConsent().getContent() != null) {\n           consentStudyResponseBean.setMessage(\n               MyStudiesUserRegUtil.ErrorCodes.SUCCESS.getValue().toLowerCase());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "713a80a1df77ba15ef3466267b30e70660a07f9b"}, "originalPosition": 184}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8bb1b5fe08f42cadc9dd4dda4688f8c635e90f8", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e8bb1b5fe08f42cadc9dd4dda4688f8c635e90f8", "committedDate": "2020-08-31T15:10:34Z", "message": "Fixed Review Comments\n\nFixed Review Comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09b193505bba837be81bd00e683a73190e37d1fa", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/09b193505bba837be81bd00e683a73190e37d1fa", "committedDate": "2020-08-31T15:14:59Z", "message": "Merge branch 'develop' into consent-audit-logs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4NzE4MzI4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/780#pullrequestreview-478718328", "createdAt": "2020-08-31T15:32:07Z", "commit": {"oid": "09b193505bba837be81bd00e683a73190e37d1fa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7536b1e08ed33299d47f821881b6f6876dabe06f", "author": {"user": {"login": "monica-BTC", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7536b1e08ed33299d47f821881b6f6876dabe06f", "committedDate": "2020-08-31T15:37:39Z", "message": "Merge branch 'develop' into consent-audit-logs"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 703, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}