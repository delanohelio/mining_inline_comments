{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA4NzYzMzUz", "number": 1622, "title": "Fixed SQL injection for the first 2000 lines of StudyDAOImpl.java", "bodyText": "Fixed sql injection for the first 2000 lines of StudyDAOImpl.java", "createdAt": "2020-10-23T06:58:46Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622", "merged": true, "mergeCommit": {"oid": "24f82b0c078ae4c34a705d94a3857c05889360f8"}, "closed": true, "closedAt": "2020-10-29T06:23:47Z", "author": {"login": "vigneshjbtc"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVQ_RRAH2gAyNTA4NzYzMzUzOjc3OGI1MTg5YTU1NWI1YjBiMWM4MDAzMDcyNWE3YTdjZWU5ZTMxZGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXMFD-gH2gAyNTA4NzYzMzUzOjk1YTAzYzJiOTBjMzdjZmQ0ZDQ0MzdhZTU1ZWJiMjI3N2JkYzRlNmQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "778b5189a555b5b0b1c80030725a7a7cee9e31dd", "author": {"user": {"login": "vigneshjbtc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/778b5189a555b5b0b1c80030725a7a7cee9e31dd", "committedDate": "2020-10-23T06:57:14Z", "message": "Fixed sql injection for the first 2000 lines of StudyDAOImpl.java\n\nFixed sql injection for the first 2000 lines of StudyDAOImpl.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8", "author": {"user": {"login": "vigneshjbtc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/0dcd65e210774bdc67bedb7e7094464b1cfd84b8", "committedDate": "2020-10-23T08:20:43Z", "message": "code is aligned properly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE1NjYzMjkw", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#pullrequestreview-515663290", "createdAt": "2020-10-23T13:25:13Z", "commit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzoyNToxM1rOHnNunQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yM1QxMzo1MjozNlrOHnOzlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4MTQzNw==", "bodyText": "You've used setInteger above for studyId, since we know studyId is an integer please use setInteger in other places as well.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#discussion_r510881437", "createdAt": "2020-10-23T13:25:13Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -166,9 +173,9 @@ public int comprehensionTestQuestionOrder(Integer studyId) {\n       session = hibernateTemplate.getSessionFactory().openSession();\n       query =\n           session.createQuery(\n-              \"From ComprehensionTestQuestionBo CTQBO where CTQBO.studyId=\"\n-                  + studyId\n+              \"From ComprehensionTestQuestionBo CTQBO where CTQBO.studyId=:studyId\"\n                   + \" and CTQBO.active=1 order by CTQBO.sequenceNo desc\");\n+      query.setParameter(\"studyId\", studyId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4NTA3Nw==", "bodyText": "please remove all commented out code", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#discussion_r510885077", "createdAt": "2020-10-23T13:31:05Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -638,163 +656,358 @@ public String deleteStudyByIdOrCustomstudyId(\n     logger.info(\"StudyDAOImpl - deleteStudyByIdOrCustomstudyId() - Starts\");\n     String message = FdahpStudyDesignerConstants.FAILURE;\n     List<StudyBo> studyBOList = null;\n-    String subQuery = \"\";\n+    // String subQuery = \"\";\n     String studyCustomQuery = \"\";\n     List<Integer> idList = null;\n+    List<String> studyIdList = new ArrayList<>();\n     try {\n+      studyIdList = this.getStudyIdAsList(studyId);\n+\n       if (StringUtils.isNotEmpty(customStudyId)) {\n-        studyCustomQuery = \" FROM StudyBo SBO WHERE SBO.customStudyId ='\" + customStudyId + \"'\";\n-        subQuery = \"(SELECT id FROM studies WHERE custom_study_id='\" + customStudyId + \"')\";\n+        studyCustomQuery = \" FROM StudyBo SBO WHERE SBO.customStudyId =:customStudyId\";\n+        // subQuery = \"(SELECT id FROM studies WHERE custom_study_id=:customStudyId)\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "originalPosition": 272}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg5OTA5Mw==", "bodyText": "what exceptions are you expecting here? arryList.add shouldn't throw any.\nI would recommend removing both try/catch blocks in this method.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#discussion_r510899093", "createdAt": "2020-10-23T13:52:36Z", "author": {"login": "zohrehj"}, "path": "study-builder/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/dao/StudyDAOImpl.java", "diffHunk": "@@ -6855,4 +7400,29 @@ public String updateDraftToEditedStatus(\n     logger.info(\"AuditLogDAOImpl - updateDraftToEditedStatus - Ends\");\n     return message;\n   }\n+\n+  public List<String> getStudyIdAsList(String statusId) {\n+    List<String> outputList = new ArrayList<>();\n+    try {\n+      if (!StringUtils.isEmpty(statusId)) {\n+        if (statusId.contains(\",\")) {\n+          String[] statusIdArray = statusId.split(\",\");\n+          for (int i = 0; i < statusIdArray.length; i++) {\n+            try {\n+              outputList.add(statusIdArray[i]);\n+            } catch (Exception e) {\n+              e.printStackTrace();\n+              logger.error(\"AuditLogDAOImpl - getStatusIdAsList -Loop - ERROR\", e);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0dcd65e210774bdc67bedb7e7094464b1cfd84b8"}, "originalPosition": 1633}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a46ed699d24bc6fb193228c9fd0c614ea36a2668", "author": {"user": {"login": "vigneshjbtc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a46ed699d24bc6fb193228c9fd0c614ea36a2668", "committedDate": "2020-10-28T15:04:38Z", "message": "All setParmeter has been changed to setXXX methods\n\nModified the SetParameter to setXXXX methods  and removed the commented lines.\nthen removed the  try/catch block from \"getStudyIdAsList\" method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MDYyMTk1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1622#pullrequestreview-519062195", "createdAt": "2020-10-28T20:35:56Z", "commit": {"oid": "a46ed699d24bc6fb193228c9fd0c614ea36a2668"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95a03c2b90c37cfd4d4437ae55ebb2277bdc4e6d", "author": {"user": {"login": "vigneshjbtc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/95a03c2b90c37cfd4d4437ae55ebb2277bdc4e6d", "committedDate": "2020-10-29T06:21:53Z", "message": "Merge branch 'develop' into SQL_Injection-_Issue_fix_StudyDAO_till_2000line"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 172, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}