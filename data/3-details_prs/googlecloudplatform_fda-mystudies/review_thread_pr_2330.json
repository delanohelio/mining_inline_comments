{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2MTAwNTUy", "number": 2330, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwNDo1MzoyMFrOFD0H8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNDowMDo0MFrOFE_y5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5NTQ0MDQ5OnYy", "diffSide": "RIGHT", "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwNDo1MzoyMFrOIDpFUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQwNjowNToyMlrOIDqctg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDY4OTc0NA==", "bodyText": "this should check whether page > 1, to prevent ever returning a negative offset.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r540689744", "createdAt": "2020-12-11T04:53:20Z", "author": {"login": "zohrehj"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -59,23 +63,45 @@ export class AppDetailsComponent\n \n   fetchParticipantsDetails(): void {\n     this.appDetail$ = combineLatest(\n-      this.appDetailsService.get(this.appId),\n-      this.query$,\n+      this.appDetailsService.get(\n+        this.appId,\n+        this.offset,\n+        this.limit,\n+        this.searchTerm,\n+        this.sortBy[0].replace('_', ''),\n+        this.sortOrder,\n+      ),\n     ).pipe(\n-      map(([appDetails, query]) => {\n-        this.appDetailsBackup = JSON.parse(\n-          JSON.stringify(appDetails),\n-        ) as AppDetails;\n-        this.appDetailsBackup.participants = this.appDetailsBackup.participants.filter(\n-          (participant: Participant) =>\n-            participant.email?.toLowerCase().includes(query.toLowerCase()),\n-        );\n-        return this.appDetailsBackup;\n+      map(([appDetails]) => {\n+        return appDetails;\n       }),\n     );\n   }\n \n   search(query: string): void {\n-    this.query$.next(query.trim());\n+    this.currentPage = 1;\n+    this.offset = 0;\n+    this.searchTerm = query.trim().toLowerCase();\n+    this.fetchParticipantsDetails();\n+  }\n+\n+  pageChange(page: number): void {\n+    this.currentPage = page;\n+    this.offset = (page - 1) * this.limit;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "375fce69af013ab3a51b32da88ce3948cc09777b"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDcxMjExOA==", "bodyText": "Updated.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r540712118", "createdAt": "2020-12-11T06:05:22Z", "author": {"login": "firdosebtc1"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -59,23 +63,45 @@ export class AppDetailsComponent\n \n   fetchParticipantsDetails(): void {\n     this.appDetail$ = combineLatest(\n-      this.appDetailsService.get(this.appId),\n-      this.query$,\n+      this.appDetailsService.get(\n+        this.appId,\n+        this.offset,\n+        this.limit,\n+        this.searchTerm,\n+        this.sortBy[0].replace('_', ''),\n+        this.sortOrder,\n+      ),\n     ).pipe(\n-      map(([appDetails, query]) => {\n-        this.appDetailsBackup = JSON.parse(\n-          JSON.stringify(appDetails),\n-        ) as AppDetails;\n-        this.appDetailsBackup.participants = this.appDetailsBackup.participants.filter(\n-          (participant: Participant) =>\n-            participant.email?.toLowerCase().includes(query.toLowerCase()),\n-        );\n-        return this.appDetailsBackup;\n+      map(([appDetails]) => {\n+        return appDetails;\n       }),\n     );\n   }\n \n   search(query: string): void {\n-    this.query$.next(query.trim());\n+    this.currentPage = 1;\n+    this.offset = 0;\n+    this.searchTerm = query.trim().toLowerCase();\n+    this.fetchParticipantsDetails();\n+  }\n+\n+  pageChange(page: number): void {\n+    this.currentPage = page;\n+    this.offset = (page - 1) * this.limit;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDY4OTc0NA=="}, "originalCommit": {"oid": "375fce69af013ab3a51b32da88ce3948cc09777b"}, "originalPosition": 72}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM5ODQxMTkwOnYy", "diffSide": "RIGHT", "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNzo1MjoxMVrOIEDhiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxODozMDoxNFrOIFerzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEyMjk1Mw==", "bodyText": "you need to handle the case when page =0, your code does nothing right now", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r541122953", "createdAt": "2020-12-11T17:52:11Z", "author": {"login": "zohrehj"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -59,23 +63,47 @@ export class AppDetailsComponent\n \n   fetchParticipantsDetails(): void {\n     this.appDetail$ = combineLatest(\n-      this.appDetailsService.get(this.appId),\n-      this.query$,\n+      this.appDetailsService.get(\n+        this.appId,\n+        this.offset,\n+        this.limit,\n+        this.searchTerm,\n+        this.sortBy[0].replace('_', ''),\n+        this.sortOrder,\n+      ),\n     ).pipe(\n-      map(([appDetails, query]) => {\n-        this.appDetailsBackup = JSON.parse(\n-          JSON.stringify(appDetails),\n-        ) as AppDetails;\n-        this.appDetailsBackup.participants = this.appDetailsBackup.participants.filter(\n-          (participant: Participant) =>\n-            participant.email?.toLowerCase().includes(query.toLowerCase()),\n-        );\n-        return this.appDetailsBackup;\n+      map(([appDetails]) => {\n+        return appDetails;\n       }),\n     );\n   }\n \n   search(query: string): void {\n-    this.query$.next(query.trim());\n+    this.currentPage = 1;\n+    this.offset = 0;\n+    this.searchTerm = query.trim().toLowerCase();\n+    this.fetchParticipantsDetails();\n+  }\n+\n+  pageChange(page: number): void {\n+    if (page >= 1) {\n+      this.currentPage = page;\n+      this.offset = (page - 1) * this.limit;\n+      this.fetchParticipantsDetails();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e88bf312cb325125acad03b20b0c523c4b2187de"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjE0NjA5OQ==", "bodyText": "we are using ngx-pagination plugin for pagination and the plugin gives page numbers from 1 to n ,0 can't be a page number here", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r542146099", "createdAt": "2020-12-14T06:42:45Z", "author": {"login": "firdosebtc1"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -59,23 +63,47 @@ export class AppDetailsComponent\n \n   fetchParticipantsDetails(): void {\n     this.appDetail$ = combineLatest(\n-      this.appDetailsService.get(this.appId),\n-      this.query$,\n+      this.appDetailsService.get(\n+        this.appId,\n+        this.offset,\n+        this.limit,\n+        this.searchTerm,\n+        this.sortBy[0].replace('_', ''),\n+        this.sortOrder,\n+      ),\n     ).pipe(\n-      map(([appDetails, query]) => {\n-        this.appDetailsBackup = JSON.parse(\n-          JSON.stringify(appDetails),\n-        ) as AppDetails;\n-        this.appDetailsBackup.participants = this.appDetailsBackup.participants.filter(\n-          (participant: Participant) =>\n-            participant.email?.toLowerCase().includes(query.toLowerCase()),\n-        );\n-        return this.appDetailsBackup;\n+      map(([appDetails]) => {\n+        return appDetails;\n       }),\n     );\n   }\n \n   search(query: string): void {\n-    this.query$.next(query.trim());\n+    this.currentPage = 1;\n+    this.offset = 0;\n+    this.searchTerm = query.trim().toLowerCase();\n+    this.fetchParticipantsDetails();\n+  }\n+\n+  pageChange(page: number): void {\n+    if (page >= 1) {\n+      this.currentPage = page;\n+      this.offset = (page - 1) * this.limit;\n+      this.fetchParticipantsDetails();\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEyMjk1Mw=="}, "originalCommit": {"oid": "e88bf312cb325125acad03b20b0c523c4b2187de"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjM5Njg2Nw==", "bodyText": "what is page set to if it's not passed through pagination?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r542396867", "createdAt": "2020-12-14T13:49:17Z", "author": {"login": "zohrehj"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -59,23 +63,47 @@ export class AppDetailsComponent\n \n   fetchParticipantsDetails(): void {\n     this.appDetail$ = combineLatest(\n-      this.appDetailsService.get(this.appId),\n-      this.query$,\n+      this.appDetailsService.get(\n+        this.appId,\n+        this.offset,\n+        this.limit,\n+        this.searchTerm,\n+        this.sortBy[0].replace('_', ''),\n+        this.sortOrder,\n+      ),\n     ).pipe(\n-      map(([appDetails, query]) => {\n-        this.appDetailsBackup = JSON.parse(\n-          JSON.stringify(appDetails),\n-        ) as AppDetails;\n-        this.appDetailsBackup.participants = this.appDetailsBackup.participants.filter(\n-          (participant: Participant) =>\n-            participant.email?.toLowerCase().includes(query.toLowerCase()),\n-        );\n-        return this.appDetailsBackup;\n+      map(([appDetails]) => {\n+        return appDetails;\n       }),\n     );\n   }\n \n   search(query: string): void {\n-    this.query$.next(query.trim());\n+    this.currentPage = 1;\n+    this.offset = 0;\n+    this.searchTerm = query.trim().toLowerCase();\n+    this.fetchParticipantsDetails();\n+  }\n+\n+  pageChange(page: number): void {\n+    if (page >= 1) {\n+      this.currentPage = page;\n+      this.offset = (page - 1) * this.limit;\n+      this.fetchParticipantsDetails();\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEyMjk1Mw=="}, "originalCommit": {"oid": "e88bf312cb325125acad03b20b0c523c4b2187de"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQwNTU4MQ==", "bodyText": "by default current page will be 1 on page load", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r542405581", "createdAt": "2020-12-14T14:01:08Z", "author": {"login": "firdosebtc1"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -59,23 +63,47 @@ export class AppDetailsComponent\n \n   fetchParticipantsDetails(): void {\n     this.appDetail$ = combineLatest(\n-      this.appDetailsService.get(this.appId),\n-      this.query$,\n+      this.appDetailsService.get(\n+        this.appId,\n+        this.offset,\n+        this.limit,\n+        this.searchTerm,\n+        this.sortBy[0].replace('_', ''),\n+        this.sortOrder,\n+      ),\n     ).pipe(\n-      map(([appDetails, query]) => {\n-        this.appDetailsBackup = JSON.parse(\n-          JSON.stringify(appDetails),\n-        ) as AppDetails;\n-        this.appDetailsBackup.participants = this.appDetailsBackup.participants.filter(\n-          (participant: Participant) =>\n-            participant.email?.toLowerCase().includes(query.toLowerCase()),\n-        );\n-        return this.appDetailsBackup;\n+      map(([appDetails]) => {\n+        return appDetails;\n       }),\n     );\n   }\n \n   search(query: string): void {\n-    this.query$.next(query.trim());\n+    this.currentPage = 1;\n+    this.offset = 0;\n+    this.searchTerm = query.trim().toLowerCase();\n+    this.fetchParticipantsDetails();\n+  }\n+\n+  pageChange(page: number): void {\n+    if (page >= 1) {\n+      this.currentPage = page;\n+      this.offset = (page - 1) * this.limit;\n+      this.fetchParticipantsDetails();\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEyMjk1Mw=="}, "originalCommit": {"oid": "e88bf312cb325125acad03b20b0c523c4b2187de"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjYxNjUyNQ==", "bodyText": "what does your backend expect? most databases assume first page is 0.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r542616525", "createdAt": "2020-12-14T18:30:14Z", "author": {"login": "zohrehj"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -59,23 +63,47 @@ export class AppDetailsComponent\n \n   fetchParticipantsDetails(): void {\n     this.appDetail$ = combineLatest(\n-      this.appDetailsService.get(this.appId),\n-      this.query$,\n+      this.appDetailsService.get(\n+        this.appId,\n+        this.offset,\n+        this.limit,\n+        this.searchTerm,\n+        this.sortBy[0].replace('_', ''),\n+        this.sortOrder,\n+      ),\n     ).pipe(\n-      map(([appDetails, query]) => {\n-        this.appDetailsBackup = JSON.parse(\n-          JSON.stringify(appDetails),\n-        ) as AppDetails;\n-        this.appDetailsBackup.participants = this.appDetailsBackup.participants.filter(\n-          (participant: Participant) =>\n-            participant.email?.toLowerCase().includes(query.toLowerCase()),\n-        );\n-        return this.appDetailsBackup;\n+      map(([appDetails]) => {\n+        return appDetails;\n       }),\n     );\n   }\n \n   search(query: string): void {\n-    this.query$.next(query.trim());\n+    this.currentPage = 1;\n+    this.offset = 0;\n+    this.searchTerm = query.trim().toLowerCase();\n+    this.fetchParticipantsDetails();\n+  }\n+\n+  pageChange(page: number): void {\n+    if (page >= 1) {\n+      this.currentPage = page;\n+      this.offset = (page - 1) * this.limit;\n+      this.fetchParticipantsDetails();\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEyMjk1Mw=="}, "originalCommit": {"oid": "e88bf312cb325125acad03b20b0c523c4b2187de"}, "originalPosition": 75}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwNzgzODQ1OnYy", "diffSide": "RIGHT", "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNDowMDo0MFrOIFRyjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNzoyODo0NFrOIFbxXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQwNTI2Mg==", "bodyText": "by default current page will be 1 on page load", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r542405262", "createdAt": "2020-12-14T14:00:40Z", "author": {"login": "firdosebtc1"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -18,13 +18,17 @@ export class AppDetailsComponent\n   extends UnsubscribeOnDestroyAdapter\n   implements OnInit {\n   appId = '';\n-  query$ = new BehaviorSubject('');\n   appDetail$: Observable<AppDetails> = of();\n-  appDetailsBackup = {} as AppDetails;\n   statusEnum = Status;\n   enrolledStudies: EnrolledStudy[] = [];\n   studyTypes = StudyType;\n-\n+  // pagination\n+  limit = 10;\n+  currentPage = 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e5053968c9535358f2c07e9d2505b215deb8cd50"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQzODMyNw==", "bodyText": "then why are onSortOrder and other methods setting it to 0?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r542438327", "createdAt": "2020-12-14T14:44:16Z", "author": {"login": "zohrehj"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -18,13 +18,17 @@ export class AppDetailsComponent\n   extends UnsubscribeOnDestroyAdapter\n   implements OnInit {\n   appId = '';\n-  query$ = new BehaviorSubject('');\n   appDetail$: Observable<AppDetails> = of();\n-  appDetailsBackup = {} as AppDetails;\n   statusEnum = Status;\n   enrolledStudies: EnrolledStudy[] = [];\n   studyTypes = StudyType;\n-\n+  // pagination\n+  limit = 10;\n+  currentPage = 1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQwNTI2Mg=="}, "originalCommit": {"oid": "e5053968c9535358f2c07e9d2505b215deb8cd50"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU2ODc5Nw==", "bodyText": "updated current page to 0 in all places ,Please check", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2330#discussion_r542568797", "createdAt": "2020-12-14T17:28:44Z", "author": {"login": "firdosebtc1"}, "path": "participant-manager/src/app/site-coordinator/apps/app-details/app-details.component.ts", "diffHunk": "@@ -18,13 +18,17 @@ export class AppDetailsComponent\n   extends UnsubscribeOnDestroyAdapter\n   implements OnInit {\n   appId = '';\n-  query$ = new BehaviorSubject('');\n   appDetail$: Observable<AppDetails> = of();\n-  appDetailsBackup = {} as AppDetails;\n   statusEnum = Status;\n   enrolledStudies: EnrolledStudy[] = [];\n   studyTypes = StudyType;\n-\n+  // pagination\n+  limit = 10;\n+  currentPage = 1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjQwNTI2Mg=="}, "originalCommit": {"oid": "e5053968c9535358f2c07e9d2505b215deb8cd50"}, "originalPosition": 24}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1378, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}