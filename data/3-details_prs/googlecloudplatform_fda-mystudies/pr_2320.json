{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1ODc4MzMw", "number": 2320, "title": "[PM, UM] Enrollment status changes", "bodyText": "As per BA discussion, changed YET_TO_JOIN to YET_TO_ENROLL\nIN_PROGRESS  to ENROLLED", "createdAt": "2020-12-10T11:47:21Z", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320", "merged": true, "mergeCommit": {"oid": "5b0824a6520538987f377947857dfec60d06a244"}, "closed": true, "closedAt": "2020-12-14T14:50:27Z", "author": {"login": "madhurya-btc"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkuMI2AH2gAyNTM1ODc4MzMwOmE1ODgwZTU2NzBiYWU4ZjBmOWMzY2RlZGFiYmY5YTA0NmQzZjRjNTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmG4k1gH2gAyNTM1ODc4MzMwOmU3NWFjM2QyMGY2ZjE4MDk3ZDc1ZjliMDNkYTVmMGNkNTA5MzY0NWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a5880e5670bae8f0f9c3cdedabbf9a046d3f4c55", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/a5880e5670bae8f0f9c3cdedabbf9a046d3f4c55", "committedDate": "2020-12-10T07:27:24Z", "message": "enrollment status changes\n\nenrollment status changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "275b4325fb64a495284f3c5dc4eee3a0f975e28a", "author": {"user": {"login": "madhurya-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/275b4325fb64a495284f3c5dc4eee3a0f975e28a", "committedDate": "2020-12-10T07:47:27Z", "message": "Enrolment status change\n\nEnrolment status change"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MjkxMjI2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320#pullrequestreview-549291226", "createdAt": "2020-12-10T15:07:29Z", "commit": {"oid": "275b4325fb64a495284f3c5dc4eee3a0f975e28a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNTowNzoyOVrOIDN3qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNToyMjozN1rOIDOo5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI0Mzg4Mw==", "bodyText": "why was this removed?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320#discussion_r540243883", "createdAt": "2020-12-10T15:07:29Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/EnrollmentStatus.java", "diffHunk": "@@ -1,28 +1,20 @@\n-/*\n- * Copyright 2020 Google LLC\n- *\n- * Use of this source code is governed by an MIT-style\n- * license that can be found in the LICENSE file or at\n- * https://opensource.org/licenses/MIT.\n- */\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "275b4325fb64a495284f3c5dc4eee3a0f975e28a"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI0NDgzMw==", "bodyText": "is \"YetToEnroll\" status not needed here? how do you display participants that have tokens generated for them but have not yet joined then?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320#discussion_r540244833", "createdAt": "2020-12-10T15:08:44Z", "author": {"login": "zohrehj"}, "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ParticipantStudyStateStatus.java", "diffHunk": "@@ -14,8 +14,6 @@\n public enum ParticipantStudyStateStatus {\n   ENROLLED(\"Enrolled\"),\n   WITHDRAWN(\"Withdrawn\"),\n-  INPROGRESS(\"inProgress\"),\n-  YETTOJOIN(\"yetToJoin\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "275b4325fb64a495284f3c5dc4eee3a0f975e28a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI1MzQzMg==", "bodyText": "there is a change in logic here that is not explained:\n\n\nwhy is  enrollmentStatus set to EnrollmentStatus.YET_TO_ENROLL.getDisplayValue()? is it supposed to be a status or a display value? I am guessing those two are not the same thing.\nfor other cases you are directly setting this to studyParticipantDetail.getEnrolledStatus(), why is yet_to_enroll` case treated differentky?\n\n\nyou are not setting enrollmentDate to null when participant is in yet to enroll status anymore. why is this changed?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320#discussion_r540253432", "createdAt": "2020-12-10T15:19:00Z", "author": {"login": "zohrehj"}, "path": "participant-manager-datastore/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/mapper/ParticipantMapper.java", "diffHunk": "@@ -60,21 +60,16 @@ public static ParticipantDetail fromParticipantStudy(\n     participantDetail.setInvitedDate(StringUtils.defaultIfEmpty(invitedDate, NOT_APPLICABLE));\n \n     if (studyParticipantDetail.getEnrolledStatus() != null) {\n-      if (studyParticipantDetail.getEnrolledStatus().equals(CommonConstants.YET_TO_ENROLL)) {\n-        participantDetail.setEnrollmentStatus(studyParticipantDetail.getEnrolledStatus());\n-        participantDetail.setEnrollmentDate(null);\n-      } else {\n-        String enrollmentStatus =\n-            EnrollmentStatus.IN_PROGRESS\n-                    .getStatus()\n-                    .equalsIgnoreCase(studyParticipantDetail.getEnrolledStatus())\n-                ? EnrollmentStatus.ENROLLED.getStatus()\n-                : studyParticipantDetail.getEnrolledStatus();\n-        participantDetail.setEnrollmentStatus(enrollmentStatus);\n-        String enrollmentDate = DateTimeUtils.format(studyParticipantDetail.getEnrolledDate());\n-        participantDetail.setEnrollmentDate(\n-            StringUtils.defaultIfEmpty(enrollmentDate, NOT_APPLICABLE));\n-      }\n+      String enrollmentStatus =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "275b4325fb64a495284f3c5dc4eee3a0f975e28a"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDI1NjQ4NQ==", "bodyText": "same as above, change in logic is not explained. e.g. enrollmentDate is now being set to NOT_APPLICABLE instead of null for other cases. Setting a date to enum seems wrong and unintuitive; is there any tests to test these scenarios and make sure the app works as expected?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320#discussion_r540256485", "createdAt": "2020-12-10T15:22:37Z", "author": {"login": "zohrehj"}, "path": "participant-manager-datastore/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/mapper/ParticipantMapper.java", "diffHunk": "@@ -149,18 +144,13 @@ public static ParticipantDetail toParticipantDetails(\n \n     ParticipantStudyEntity participantStudy = idMap.get(participantRegistrySite.getId());\n     if (participantStudy != null) {\n-      if (CommonConstants.YET_TO_ENROLL.equals(participantStudy.getStatus())) {\n-        participant.setEnrollmentStatus(participantStudy.getStatus());\n-        participant.setEnrollmentDate(null);\n-      } else {\n-        String enrollmentStatus =\n-            EnrollmentStatus.IN_PROGRESS.getStatus().equalsIgnoreCase(participantStudy.getStatus())\n-                ? EnrollmentStatus.ENROLLED.getStatus()\n-                : participantStudy.getStatus();\n-        participant.setEnrollmentStatus(enrollmentStatus);\n-        String enrollmentDate = DateTimeUtils.format(participantStudy.getEnrolledDate());\n-        participant.setEnrollmentDate(StringUtils.defaultIfEmpty(enrollmentDate, NOT_APPLICABLE));\n-      }\n+      String enrollmentStatus =\n+          EnrollmentStatus.YET_TO_ENROLL.getStatus().equalsIgnoreCase(participantStudy.getStatus())\n+              ? EnrollmentStatus.YET_TO_ENROLL.getDisplayValue()\n+              : participantStudy.getStatus();\n+      participant.setEnrollmentStatus(enrollmentStatus);\n+      String enrollmentDate = DateTimeUtils.format(participantStudy.getEnrolledDate());\n+      participant.setEnrollmentDate(StringUtils.defaultIfEmpty(enrollmentDate, NOT_APPLICABLE));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "275b4325fb64a495284f3c5dc4eee3a0f975e28a"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcfad74cfad43cc6ab583f27de2bb9cfcc49506c", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/dcfad74cfad43cc6ab583f27de2bb9cfcc49506c", "committedDate": "2020-12-10T15:43:57Z", "message": "Fixed PR comments\n\nFixed PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fccad75ef215d1955ed2d0758361ef3427074273", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/fccad75ef215d1955ed2d0758361ef3427074273", "committedDate": "2020-12-11T12:02:19Z", "message": "Fixed PR commments\n\nFixed PR commments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9e471a26d34ce43f672218426bf6ab1c914875d", "author": {"user": {"login": "madhurya-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e9e471a26d34ce43f672218426bf6ab1c914875d", "committedDate": "2020-12-11T14:24:52Z", "message": "enrollment status changes for withdrawn and enrolled\n\nenrollment status changes for withdrawn and enrolled"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMTQyMTQ0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320#pullrequestreview-550142144", "createdAt": "2020-12-11T14:25:52Z", "commit": {"oid": "e9e471a26d34ce43f672218426bf6ab1c914875d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNDoyNTo1MlrOID7CXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMVQxNDoyNTo1MlrOID7CXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDk4MzkwMQ==", "bodyText": "[user-mgmt Checks] reported by reviewdog \ud83d\udc36\nLine is longer than 100 characters (found 166).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320#discussion_r540983901", "createdAt": "2020-12-11T14:25:52Z", "author": {"login": "github-actions"}, "path": "participant-datastore/user-mgmt-module/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/dao/CommonDaoImpl.java", "diffHunk": "@@ -223,7 +223,7 @@ public String getUserInfoDetails(String userId) {\n           session\n               .createSQLQuery(\n                   \"SELECT sp.study_info_id, GROUP_CONCAT(a.device_token) as device_token,GROUP_CONCAT(a.device_type) as device_type FROM participant_study_info sp, auth_info a\"\n-                      + \" where sp.user_details_id = a.user_details_id and sp.status not in('yetToJoin','withdrawn','notEligible') and a.remote_notification_flag=1\"\n+                      + \" where sp.user_details_id = a.user_details_id and sp.status not in('yetToEnroll','withdrawn','notEligible') and a.remote_notification_flag=1\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e9e471a26d34ce43f672218426bf6ab1c914875d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwMzYyNjUw", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320#pullrequestreview-550362650", "createdAt": "2020-12-11T17:45:40Z", "commit": {"oid": "e9e471a26d34ce43f672218426bf6ab1c914875d"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb3a36c7016f9ed7a04dbd5f1eeff89b1e5bf152", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/bb3a36c7016f9ed7a04dbd5f1eeff89b1e5bf152", "committedDate": "2020-12-14T07:04:18Z", "message": "Merge branch 'develop' into participant-manager-enrollment-status-changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eafb81422cf0b8ba43ca70a052a7fd036c49bf52", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/eafb81422cf0b8ba43ca70a052a7fd036c49bf52", "committedDate": "2020-12-14T07:18:09Z", "message": "Merge branch 'develop' into participant-manager-enrollment-status-changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69934dd5fe9c158b6daace6aa930950034d57ff9", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/69934dd5fe9c158b6daace6aa930950034d57ff9", "committedDate": "2020-12-14T07:59:08Z", "message": "Merge branch 'develop' into participant-manager-enrollment-status-changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e59a80fbc86fddfb84a4d9a385ec5e33bf9a8bb7", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e59a80fbc86fddfb84a4d9a385ec5e33bf9a8bb7", "committedDate": "2020-12-14T08:04:54Z", "message": "resolved merge conflict\n\nresolved merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e02c3147928ae3a42f7e53b68a265d640612a9f", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/5e02c3147928ae3a42f7e53b68a265d640612a9f", "committedDate": "2020-12-14T08:11:33Z", "message": "fixed build issue"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxMzgwMzUx", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2320#pullrequestreview-551380351", "createdAt": "2020-12-14T13:47:40Z", "commit": {"oid": "5e02c3147928ae3a42f7e53b68a265d640612a9f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e75ac3d20f6f18097d75f9b03da5f0cd5093645f", "author": {"user": {"login": "Kantharajut-btc", "name": null}}, "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e75ac3d20f6f18097d75f9b03da5f0cd5093645f", "committedDate": "2020-12-14T14:47:35Z", "message": "Merge branch 'develop' into participant-manager-enrollment-status-changes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1003, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}