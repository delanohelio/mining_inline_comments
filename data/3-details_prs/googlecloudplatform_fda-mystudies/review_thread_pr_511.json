{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0MjA4MjM2", "number": 511, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0NTo0M1rOEFl-BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0OToyNVrOEFmDxQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0MzAwNDIxOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/VerifyEmailIdController.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0NTo0M1rOGj4DwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNzozNzoyNlrOGj8HpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3MTgwOQ==", "bodyText": "\" bad request.\"?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/511#discussion_r440271809", "createdAt": "2020-06-15T15:45:43Z", "author": {"login": "nikklassen"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/VerifyEmailIdController.java", "diffHunk": "@@ -70,7 +70,7 @@\n       verifyEmailIdResponse.setCode(HttpStatus.BAD_REQUEST.value());\n       verifyEmailIdResponse.setMessage(\n           MyStudiesUserRegUtil.ErrorCodes.INVALID_INPUT_ERROR_MSG.getValue());\n-      logger.info(AppConstants.VERIFY_EMAILID_CONTROLLER_ENDS_MESSAGE);\n+      logger.warn(AppConstants.VERIFY_EMAILID_CONTROLLER_ENDS_MESSAGE + \"Bad request\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b5710bcc9ac61244a31efd0f749c818dff044b"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMzODM0MQ==", "bodyText": "done.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/511#discussion_r440338341", "createdAt": "2020-06-15T17:37:26Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/VerifyEmailIdController.java", "diffHunk": "@@ -70,7 +70,7 @@\n       verifyEmailIdResponse.setCode(HttpStatus.BAD_REQUEST.value());\n       verifyEmailIdResponse.setMessage(\n           MyStudiesUserRegUtil.ErrorCodes.INVALID_INPUT_ERROR_MSG.getValue());\n-      logger.info(AppConstants.VERIFY_EMAILID_CONTROLLER_ENDS_MESSAGE);\n+      logger.warn(AppConstants.VERIFY_EMAILID_CONTROLLER_ENDS_MESSAGE + \"Bad request\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3MTgwOQ=="}, "originalCommit": {"oid": "f6b5710bcc9ac61244a31efd0f749c818dff044b"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0MzAxMzE0OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserRegistrationController.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0Nzo1NVrOGj4Jfg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNzozOToyM1rOGj8Lsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3MzI3OA==", "bodyText": "nit: should we use the format // TODO(#496)? Not sure if it really makes them easier to find, but it could help.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/511#discussion_r440273278", "createdAt": "2020-06-15T15:47:55Z", "author": {"login": "nikklassen"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserRegistrationController.java", "diffHunk": "@@ -245,26 +250,12 @@ void deleteUserFromAuthServer(AuthRegistrationResponseBean authServerResponse, S\n     List<String> emailContent = null;\n     if (otp != null) {\n       emailContent = new ArrayList<>();\n-      String message =\n-          \"<html>\"\n-              + \"<body>\"\n-              + \"<div style='margin:20px;padding:10px;font-family: sans-serif;font-size: 14px;'>\"\n-              + \"<span>Hi,</span><br/><br/>\"\n-              + \"<span>Thank you for registering with us! We look forward to having you on board and actively taking part in<br/>research studies conducted by the &lt;Org Name&gt; and its partners.</span><br/><br/>\"\n-              + \"<span>Your sign-up process is almost complete. Please use the verification code provided below to<br/>complete the Verification step in the mobile app. </span><br/><br/>\"\n-              + \"<span><strong>Verification Code: </strong>\"\n-              + otp\n-              + \"</span><br/><br/>\"\n-              + \"<span>This code can be used only once and is valid for a period of 48 hours only.</span><br/><br/>\"\n-              + \"<span>Please note that  registration (or sign up) for the app  is requested only to provide you with a <br/>seamless experience of using the app. Your registration information does not become part of <br/>the data collected for any study housed in the app. Each study has its own consent process <br/> and no data for any study will not be collected unless and until you provide an informed consent<br/> prior to joining the study </span><br/><br/>\"\n-              + \"<span>For any questions or assistance, please write to <a> &lt;contact email address&gt; </a> </span><br/><br/>\"\n-              + \"<span style='font-size:15px;'>Thanks,</span><br/><span>The &lt;Org Name&gt; MyStudies Support Team</span>\"\n-              + \"<br/><span>----------------------------------------------------</span><br/>\"\n-              + \"<span style='font-size:10px;'>PS - This is an auto-generated email. Please do not reply.</span>\"\n-              + \"</div>\"\n-              + \"</body>\"\n-              + \"</html>\";\n-      String subject = \"Welcome to the <App Name> App!\";\n+      Map<String, String> emailMap = new HashMap<String, String>();\n+      emailMap.put(\"$securitytoken\", otp);\n+      // TODO: replace with actual study's org name in #496.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b5710bcc9ac61244a31efd0f749c818dff044b"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDMzOTM3OQ==", "bodyText": "Good idea. Fixed in both places.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/511#discussion_r440339379", "createdAt": "2020-06-15T17:39:23Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserRegistrationController.java", "diffHunk": "@@ -245,26 +250,12 @@ void deleteUserFromAuthServer(AuthRegistrationResponseBean authServerResponse, S\n     List<String> emailContent = null;\n     if (otp != null) {\n       emailContent = new ArrayList<>();\n-      String message =\n-          \"<html>\"\n-              + \"<body>\"\n-              + \"<div style='margin:20px;padding:10px;font-family: sans-serif;font-size: 14px;'>\"\n-              + \"<span>Hi,</span><br/><br/>\"\n-              + \"<span>Thank you for registering with us! We look forward to having you on board and actively taking part in<br/>research studies conducted by the &lt;Org Name&gt; and its partners.</span><br/><br/>\"\n-              + \"<span>Your sign-up process is almost complete. Please use the verification code provided below to<br/>complete the Verification step in the mobile app. </span><br/><br/>\"\n-              + \"<span><strong>Verification Code: </strong>\"\n-              + otp\n-              + \"</span><br/><br/>\"\n-              + \"<span>This code can be used only once and is valid for a period of 48 hours only.</span><br/><br/>\"\n-              + \"<span>Please note that  registration (or sign up) for the app  is requested only to provide you with a <br/>seamless experience of using the app. Your registration information does not become part of <br/>the data collected for any study housed in the app. Each study has its own consent process <br/> and no data for any study will not be collected unless and until you provide an informed consent<br/> prior to joining the study </span><br/><br/>\"\n-              + \"<span>For any questions or assistance, please write to <a> &lt;contact email address&gt; </a> </span><br/><br/>\"\n-              + \"<span style='font-size:15px;'>Thanks,</span><br/><span>The &lt;Org Name&gt; MyStudies Support Team</span>\"\n-              + \"<br/><span>----------------------------------------------------</span><br/>\"\n-              + \"<span style='font-size:10px;'>PS - This is an auto-generated email. Please do not reply.</span>\"\n-              + \"</div>\"\n-              + \"</body>\"\n-              + \"</html>\";\n-      String subject = \"Welcome to the <App Name> App!\";\n+      Map<String, String> emailMap = new HashMap<String, String>();\n+      emailMap.put(\"$securitytoken\", otp);\n+      // TODO: replace with actual study's org name in #496.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3MzI3OA=="}, "originalCommit": {"oid": "f6b5710bcc9ac61244a31efd0f749c818dff044b"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0MzAxODkzOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/util/Mail.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0OToyNVrOGj4NZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNzo0MDozMFrOGj8OJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3NDI3OQ==", "bodyText": "logger.debug for consistency.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/511#discussion_r440274279", "createdAt": "2020-06-15T15:49:25Z", "author": {"login": "nikklassen"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/util/Mail.java", "diffHunk": "@@ -159,7 +159,7 @@ public boolean sendMailWithAttachment() throws Exception {\n         } catch (Exception e) {\n             logger.error(\"ERROR:  sendemail() - \" + e + \" : \");\n         }\n-        logger.info(\"Mail.sendemail() :: Ends\");\n+        logger.info(\"Mail.sendMailWithAttachment() :: Ends\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f6b5710bcc9ac61244a31efd0f749c818dff044b"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0MDAwNw==", "bodyText": "Good catch! fixed it.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/511#discussion_r440340007", "createdAt": "2020-06-15T17:40:30Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/user-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/util/Mail.java", "diffHunk": "@@ -159,7 +159,7 @@ public boolean sendMailWithAttachment() throws Exception {\n         } catch (Exception e) {\n             logger.error(\"ERROR:  sendemail() - \" + e + \" : \");\n         }\n-        logger.info(\"Mail.sendemail() :: Ends\");\n+        logger.info(\"Mail.sendMailWithAttachment() :: Ends\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3NDI3OQ=="}, "originalCommit": {"oid": "f6b5710bcc9ac61244a31efd0f749c818dff044b"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2413, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}