{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0OTkzNTY5", "number": 1082, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxODo1MzoxOFrOEosyMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoyMToxOFrOEpJpZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExMTEyMjQwOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserConsentManagementController.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxODo1MzoxOFrOHZ8VKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoyMjoxNVrOHap93Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njk2NDkwNw==", "bodyText": "this has the same flakiness issue around midnight. A better solution is to return the generated filename (with timestamp) and use the returned value in tests.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1082#discussion_r496964907", "createdAt": "2020-09-29T18:53:18Z", "author": {"login": "zohrehj"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserConsentManagementController.java", "diffHunk": "@@ -154,13 +154,9 @@\n               if (!StringUtils.isEmpty(consentStatusBean.getConsent().getPdf())) {\n                 String underDirectory = userId + \"/\" + consentStatusBean.getStudyId();\n                 String fileName =\n-                    userId\n+                    consentStatusBean.getConsent().getVersion()\n                         + \"_\"\n-                        + consentStatusBean.getStudyId()\n-                        + \"_\"\n-                        + consentStatusBean.getConsent().getVersion()\n-                        + \"_\"\n-                        + new SimpleDateFormat(\"MMddyyyyHHmmss\").format(new Date())\n+                        + new SimpleDateFormat(\"MMddyyyy\").format(new Date())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e3a3171ee6ebce0ba3be0151cb623d79da5687c"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcxMjYwNQ==", "bodyText": "Fixed Review comment.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1082#discussion_r497712605", "createdAt": "2020-09-30T18:22:15Z", "author": {"login": "monica-BTC"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/UserConsentManagementController.java", "diffHunk": "@@ -154,13 +154,9 @@\n               if (!StringUtils.isEmpty(consentStatusBean.getConsent().getPdf())) {\n                 String underDirectory = userId + \"/\" + consentStatusBean.getStudyId();\n                 String fileName =\n-                    userId\n+                    consentStatusBean.getConsent().getVersion()\n                         + \"_\"\n-                        + consentStatusBean.getStudyId()\n-                        + \"_\"\n-                        + consentStatusBean.getConsent().getVersion()\n-                        + \"_\"\n-                        + new SimpleDateFormat(\"MMddyyyyHHmmss\").format(new Date())\n+                        + new SimpleDateFormat(\"MMddyyyy\").format(new Date())", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njk2NDkwNw=="}, "originalCommit": {"oid": "5e3a3171ee6ebce0ba3be0151cb623d79da5687c"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTgzMDYxOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoxNToxMlrOHapvDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoxNToxMlrOHapvDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcwODgxMg==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nDistance between variable 'consentDocumentFileName' declaration and its first usage is 10, but allowed 3.  Consider making that variable final if you still need to store its value in advance (before method calls that might have side effects on the original value).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1082#discussion_r497708812", "createdAt": "2020-09-30T18:15:12Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "diffHunk": "@@ -106,15 +105,21 @@ public void updateEligibilityConsentStatus() throws Exception {\n     HttpHeaders headers = TestUtils.getCommonHeaders();\n     headers.add(\"Authorization\", VALID_BEARER_TOKEN);\n     TestUtils.addContentTypeAcceptHeaders(headers);\n-    mockMvc\n-        .perform(\n-            post(ApiEndpoint.UPDATE_ELIGIBILITY_CONSENT.getPath())\n-                .content(requestJson)\n-                .headers(headers)\n-                .contextPath(getContextPath()))\n-        .andDo(print())\n-        .andExpect(status().isOk())\n-        .andExpect(content().string(containsString(Constants.UPDATE_CONSENT_SUCCESS_MSG)));\n+    MvcResult result =\n+        mockMvc\n+            .perform(\n+                post(ApiEndpoint.UPDATE_ELIGIBILITY_CONSENT.getPath())\n+                    .content(requestJson)\n+                    .headers(headers)\n+                    .contextPath(getContextPath()))\n+            .andDo(print())\n+            .andExpect(status().isOk())\n+            .andExpect(content().string(containsString(Constants.UPDATE_CONSENT_SUCCESS_MSG)))\n+            .andExpect(jsonPath(\"$.consentDocumentFileName\").isNotEmpty())\n+            .andReturn();\n+\n+    String consentDocumentFileName =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f12218598a8597c063e0fa4718f915595b717a51"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTgzMDYyOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoxNToxMlrOHapvDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoxNToxMlrOHapvDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcwODgxMw==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nDistance between variable 'consentDocumentFileName' declaration and its first usage is 10, but allowed 3.  Consider making that variable final if you still need to store its value in advance (before method calls that might have side effects on the original value).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1082#discussion_r497708813", "createdAt": "2020-09-30T18:15:12Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "diffHunk": "@@ -210,15 +202,21 @@ public void updateEligibilityConsentStatusUpdateExisting() throws Exception {\n     HttpHeaders headers = TestUtils.getCommonHeaders();\n     TestUtils.addContentTypeAcceptHeaders(headers);\n     headers.add(\"Authorization\", VALID_BEARER_TOKEN);\n-    mockMvc\n-        .perform(\n-            post(ApiEndpoint.UPDATE_ELIGIBILITY_CONSENT.getPath())\n-                .content(requestJson)\n-                .headers(headers)\n-                .contextPath(getContextPath()))\n-        .andDo(print())\n-        .andExpect(status().isOk())\n-        .andExpect(content().string(containsString(Constants.UPDATE_CONSENT_SUCCESS_MSG)));\n+    MvcResult result =\n+        mockMvc\n+            .perform(\n+                post(ApiEndpoint.UPDATE_ELIGIBILITY_CONSENT.getPath())\n+                    .content(requestJson)\n+                    .headers(headers)\n+                    .contextPath(getContextPath()))\n+            .andDo(print())\n+            .andExpect(status().isOk())\n+            .andExpect(content().string(containsString(Constants.UPDATE_CONSENT_SUCCESS_MSG)))\n+            .andExpect(jsonPath(\"$.consentDocumentFileName\").isNotEmpty())\n+            .andReturn();\n+\n+    String consentDocumentFileName =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f12218598a8597c063e0fa4718f915595b717a51"}, "originalPosition": 106}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTgzMDYzOnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoxNToxMlrOHapvDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoxNToxMlrOHapvDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcwODgxNA==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nDistance between variable 'consentDocumentFileName' declaration and its first usage is 10, but allowed 3.  Consider making that variable final if you still need to store its value in advance (before method calls that might have side effects on the original value).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1082#discussion_r497708814", "createdAt": "2020-09-30T18:15:12Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "diffHunk": "@@ -310,15 +295,21 @@ public void updateEligibilityConsentStatusAddNewVersion() throws Exception {\n     HttpHeaders headers = TestUtils.getCommonHeaders();\n     TestUtils.addContentTypeAcceptHeaders(headers);\n     headers.add(\"Authorization\", VALID_BEARER_TOKEN);\n-    mockMvc\n-        .perform(\n-            post(ApiEndpoint.UPDATE_ELIGIBILITY_CONSENT.getPath())\n-                .content(requestJson)\n-                .headers(headers)\n-                .contextPath(getContextPath()))\n-        .andDo(print())\n-        .andExpect(status().isOk())\n-        .andExpect(content().string(containsString(Constants.UPDATE_CONSENT_SUCCESS_MSG)));\n+    MvcResult result =\n+        mockMvc\n+            .perform(\n+                post(ApiEndpoint.UPDATE_ELIGIBILITY_CONSENT.getPath())\n+                    .content(requestJson)\n+                    .headers(headers)\n+                    .contextPath(getContextPath()))\n+            .andDo(print())\n+            .andExpect(status().isOk())\n+            .andExpect(content().string(containsString(Constants.UPDATE_CONSENT_SUCCESS_MSG)))\n+            .andExpect(jsonPath(\"$.consentDocumentFileName\").isNotEmpty())\n+            .andReturn();\n+\n+    String consentDocumentFileName =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f12218598a8597c063e0fa4718f915595b717a51"}, "originalPosition": 168}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTg1MTI0OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoyMToxOFrOHap79A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoyMToxOFrOHap79A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcxMjExNg==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nDistance between variable 'result' declaration and its first usage is 10, but allowed 3.  Consider making that variable final if you still need to store its value in advance (before method calls that might have side effects on the original value).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1082#discussion_r497712116", "createdAt": "2020-09-30T18:21:18Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "diffHunk": "@@ -106,15 +105,18 @@ public void updateEligibilityConsentStatus() throws Exception {\n     HttpHeaders headers = TestUtils.getCommonHeaders();\n     headers.add(\"Authorization\", VALID_BEARER_TOKEN);\n     TestUtils.addContentTypeAcceptHeaders(headers);\n-    mockMvc\n-        .perform(\n-            post(ApiEndpoint.UPDATE_ELIGIBILITY_CONSENT.getPath())\n-                .content(requestJson)\n-                .headers(headers)\n-                .contextPath(getContextPath()))\n-        .andDo(print())\n-        .andExpect(status().isOk())\n-        .andExpect(content().string(containsString(Constants.UPDATE_CONSENT_SUCCESS_MSG)));\n+    MvcResult result =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9800a2f9eeca710adace9463db4127ca6aa42c87"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTg1MTI1OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoyMToxOFrOHap79g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoyMToxOFrOHap79g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcxMjExOA==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nDistance between variable 'result' declaration and its first usage is 10, but allowed 3.  Consider making that variable final if you still need to store its value in advance (before method calls that might have side effects on the original value).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1082#discussion_r497712118", "createdAt": "2020-09-30T18:21:18Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "diffHunk": "@@ -210,15 +200,18 @@ public void updateEligibilityConsentStatusUpdateExisting() throws Exception {\n     HttpHeaders headers = TestUtils.getCommonHeaders();\n     TestUtils.addContentTypeAcceptHeaders(headers);\n     headers.add(\"Authorization\", VALID_BEARER_TOKEN);\n-    mockMvc\n-        .perform(\n-            post(ApiEndpoint.UPDATE_ELIGIBILITY_CONSENT.getPath())\n-                .content(requestJson)\n-                .headers(headers)\n-                .contextPath(getContextPath()))\n-        .andDo(print())\n-        .andExpect(status().isOk())\n-        .andExpect(content().string(containsString(Constants.UPDATE_CONSENT_SUCCESS_MSG)));\n+    MvcResult result =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9800a2f9eeca710adace9463db4127ca6aa42c87"}, "originalPosition": 93}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExNTg1MTI2OnYy", "diffSide": "RIGHT", "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoyMToxOFrOHap79w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxODoyMToxOFrOHap79w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzcxMjExOQ==", "bodyText": "[consent-mgmt Checks] reported by reviewdog \ud83d\udc36\nDistance between variable 'result' declaration and its first usage is 10, but allowed 3.  Consider making that variable final if you still need to store its value in advance (before method calls that might have side effects on the original value).", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1082#discussion_r497712119", "createdAt": "2020-09-30T18:21:18Z", "author": {"login": "github-actions"}, "path": "user-registration-server-ws/consent-mgmt-module/consent-mgmt/src/test/java/com/google/cloud/healthcare/fdamystudies/controller/tests/UserConsentManagementControllerTests.java", "diffHunk": "@@ -310,15 +293,18 @@ public void updateEligibilityConsentStatusAddNewVersion() throws Exception {\n     HttpHeaders headers = TestUtils.getCommonHeaders();\n     TestUtils.addContentTypeAcceptHeaders(headers);\n     headers.add(\"Authorization\", VALID_BEARER_TOKEN);\n-    mockMvc\n-        .perform(\n-            post(ApiEndpoint.UPDATE_ELIGIBILITY_CONSENT.getPath())\n-                .content(requestJson)\n-                .headers(headers)\n-                .contextPath(getContextPath()))\n-        .andDo(print())\n-        .andExpect(status().isOk())\n-        .andExpect(content().string(containsString(Constants.UPDATE_CONSENT_SUCCESS_MSG)));\n+    MvcResult result =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9800a2f9eeca710adace9463db4127ca6aa42c87"}, "originalPosition": 155}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1852, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}