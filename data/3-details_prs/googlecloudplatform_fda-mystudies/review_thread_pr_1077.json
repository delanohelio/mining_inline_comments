{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0OTA0NTAz", "number": 1077, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjoyNToxMlrOEopS_g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjozMzo1N1rOEopjWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExMDU1MTAyOnYy", "diffSide": "RIGHT", "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjoyNToxMlrOHZ2ynA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjo0MzozMVrOHZ3kWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg3NDE0MA==", "bodyText": "typo here, please fix", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1077#discussion_r496874140", "createdAt": "2020-09-29T16:25:12Z", "author": {"login": "saminguyen"}, "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "diffHunk": "@@ -470,4 +488,435 @@ public void shouldSaveOrUpdateSyudySettings() throws Exception {\n \n     verifyAuditEventCall(STUDY_SETTINGS_SAVED_OR_UPDATED);\n   }\n+\n+  @Test\n+  public void shouldSaveOrUpdateStudyConsentSection() throws Exception {\n+    HttpHeaders headers = getCommonHeaders();\n+\n+    SessionObject session = new SessionObject();\n+    session.setUserId(Integer.parseInt(USER_ID_VALUE));\n+    session.setStudySession(new ArrayList<>(Arrays.asList(0)));\n+    session.setSessionId(UUID.randomUUID().toString());\n+\n+    HashMap<String, Object> sessionAttributes = getSessionAttributes();\n+    sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n+    sessionAttributes.put(STUDY_ID_ATTR_NAME, STUDY_ID_VALUE);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, CUSTOM_STUDY_ID_VALUE);\n+\n+    ConsentInfoBo ConsentInfoBo = new ConsentInfoBo();\n+    ConsentInfoBo.setStudyId(678574);\n+\n+    MockHttpServletRequestBuilder requestBuilder =\n+        post(PathMappingUri.SAVE_OR_UPDATE_CONSENT_INFO.getPath())\n+            .headers(headers)\n+            .sessionAttrs(sessionAttributes);\n+\n+    addParams(requestBuilder, ConsentInfoBo);\n+    mockMvc\n+        .perform(requestBuilder)\n+        .andDo(print())\n+        .andExpect(status().isFound())\n+        .andExpect(view().name(\"redirect:/adminStudies/consentListPage.do\"));\n+\n+    verifyAuditEventCall(STUDY_CONSENT_SECTIONS_SAVED_OR_UPDATED);\n+  }\n+\n+  @Test\n+  public void shouldCompleteSyudySettings() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc39d388c37b9c6598c245aad036a840decccecb"}, "originalPosition": 127}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4Njg3Mw==", "bodyText": "Fixed review comment", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1077#discussion_r496886873", "createdAt": "2020-09-29T16:43:31Z", "author": {"login": "harisboston"}, "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "diffHunk": "@@ -470,4 +488,435 @@ public void shouldSaveOrUpdateSyudySettings() throws Exception {\n \n     verifyAuditEventCall(STUDY_SETTINGS_SAVED_OR_UPDATED);\n   }\n+\n+  @Test\n+  public void shouldSaveOrUpdateStudyConsentSection() throws Exception {\n+    HttpHeaders headers = getCommonHeaders();\n+\n+    SessionObject session = new SessionObject();\n+    session.setUserId(Integer.parseInt(USER_ID_VALUE));\n+    session.setStudySession(new ArrayList<>(Arrays.asList(0)));\n+    session.setSessionId(UUID.randomUUID().toString());\n+\n+    HashMap<String, Object> sessionAttributes = getSessionAttributes();\n+    sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n+    sessionAttributes.put(STUDY_ID_ATTR_NAME, STUDY_ID_VALUE);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, CUSTOM_STUDY_ID_VALUE);\n+\n+    ConsentInfoBo ConsentInfoBo = new ConsentInfoBo();\n+    ConsentInfoBo.setStudyId(678574);\n+\n+    MockHttpServletRequestBuilder requestBuilder =\n+        post(PathMappingUri.SAVE_OR_UPDATE_CONSENT_INFO.getPath())\n+            .headers(headers)\n+            .sessionAttrs(sessionAttributes);\n+\n+    addParams(requestBuilder, ConsentInfoBo);\n+    mockMvc\n+        .perform(requestBuilder)\n+        .andDo(print())\n+        .andExpect(status().isFound())\n+        .andExpect(view().name(\"redirect:/adminStudies/consentListPage.do\"));\n+\n+    verifyAuditEventCall(STUDY_CONSENT_SECTIONS_SAVED_OR_UPDATED);\n+  }\n+\n+  @Test\n+  public void shouldCompleteSyudySettings() throws Exception {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg3NDE0MA=="}, "originalCommit": {"oid": "cc39d388c37b9c6598c245aad036a840decccecb"}, "originalPosition": 127}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExMDU4NTM0OnYy", "diffSide": "RIGHT", "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjozMjoxN1rOHZ3Hnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjo1Mzo1NlrOHZ3_ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg3OTUxOQ==", "bodyText": "Why are we changing these values. Also this makes CUSTOM_STUDY_ID_VALUE an unused var, please remove if not needed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1077#discussion_r496879519", "createdAt": "2020-09-29T16:32:17Z", "author": {"login": "saminguyen"}, "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "diffHunk": "@@ -326,12 +344,12 @@ public void shouldLaunchStudy() throws Exception {\n \n     HashMap<String, Object> sessionAttributes = getSessionAttributes();\n     sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n-    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, CUSTOM_STUDY_ID_VALUE);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, \"678595\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc39d388c37b9c6598c245aad036a840decccecb"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg5Mzc5Ng==", "bodyText": "Since multiple test cases are using common table, so it will override the values and effect other test case.\nso we need to have different rows and respective ID's.\nCUSTOM_STUDY_ID_VALUE is used in many places, modified the value only for effected test cases.", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1077#discussion_r496893796", "createdAt": "2020-09-29T16:53:56Z", "author": {"login": "harisboston"}, "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "diffHunk": "@@ -326,12 +344,12 @@ public void shouldLaunchStudy() throws Exception {\n \n     HashMap<String, Object> sessionAttributes = getSessionAttributes();\n     sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n-    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, CUSTOM_STUDY_ID_VALUE);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, \"678595\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg3OTUxOQ=="}, "originalCommit": {"oid": "cc39d388c37b9c6598c245aad036a840decccecb"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExMDU5MTAxOnYy", "diffSide": "RIGHT", "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjozMzo0MVrOHZ3LMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjo0NzozNVrOHZ3u-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4MDQzMg==", "bodyText": "store this in a constant?", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1077#discussion_r496880432", "createdAt": "2020-09-29T16:33:41Z", "author": {"login": "saminguyen"}, "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "diffHunk": "@@ -470,4 +488,435 @@ public void shouldSaveOrUpdateSyudySettings() throws Exception {\n \n     verifyAuditEventCall(STUDY_SETTINGS_SAVED_OR_UPDATED);\n   }\n+\n+  @Test\n+  public void shouldSaveOrUpdateStudyConsentSection() throws Exception {\n+    HttpHeaders headers = getCommonHeaders();\n+\n+    SessionObject session = new SessionObject();\n+    session.setUserId(Integer.parseInt(USER_ID_VALUE));\n+    session.setStudySession(new ArrayList<>(Arrays.asList(0)));\n+    session.setSessionId(UUID.randomUUID().toString());\n+\n+    HashMap<String, Object> sessionAttributes = getSessionAttributes();\n+    sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n+    sessionAttributes.put(STUDY_ID_ATTR_NAME, STUDY_ID_VALUE);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, CUSTOM_STUDY_ID_VALUE);\n+\n+    ConsentInfoBo ConsentInfoBo = new ConsentInfoBo();\n+    ConsentInfoBo.setStudyId(678574);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc39d388c37b9c6598c245aad036a840decccecb"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4OTU5NQ==", "bodyText": "Fixed review comment", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1077#discussion_r496889595", "createdAt": "2020-09-29T16:47:35Z", "author": {"login": "harisboston"}, "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "diffHunk": "@@ -470,4 +488,435 @@ public void shouldSaveOrUpdateSyudySettings() throws Exception {\n \n     verifyAuditEventCall(STUDY_SETTINGS_SAVED_OR_UPDATED);\n   }\n+\n+  @Test\n+  public void shouldSaveOrUpdateStudyConsentSection() throws Exception {\n+    HttpHeaders headers = getCommonHeaders();\n+\n+    SessionObject session = new SessionObject();\n+    session.setUserId(Integer.parseInt(USER_ID_VALUE));\n+    session.setStudySession(new ArrayList<>(Arrays.asList(0)));\n+    session.setSessionId(UUID.randomUUID().toString());\n+\n+    HashMap<String, Object> sessionAttributes = getSessionAttributes();\n+    sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n+    sessionAttributes.put(STUDY_ID_ATTR_NAME, STUDY_ID_VALUE);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, CUSTOM_STUDY_ID_VALUE);\n+\n+    ConsentInfoBo ConsentInfoBo = new ConsentInfoBo();\n+    ConsentInfoBo.setStudyId(678574);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4MDQzMg=="}, "originalCommit": {"oid": "cc39d388c37b9c6598c245aad036a840decccecb"}, "originalPosition": 109}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExMDU5Mjg5OnYy", "diffSide": "RIGHT", "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjozMzo1N1rOHZ3MRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOVQxNjo0Nzo1MVrOHZ3vuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4MDcwOA==", "bodyText": "similar as above", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1077#discussion_r496880708", "createdAt": "2020-09-29T16:33:57Z", "author": {"login": "saminguyen"}, "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "diffHunk": "@@ -470,4 +488,435 @@ public void shouldSaveOrUpdateSyudySettings() throws Exception {\n \n     verifyAuditEventCall(STUDY_SETTINGS_SAVED_OR_UPDATED);\n   }\n+\n+  @Test\n+  public void shouldSaveOrUpdateStudyConsentSection() throws Exception {\n+    HttpHeaders headers = getCommonHeaders();\n+\n+    SessionObject session = new SessionObject();\n+    session.setUserId(Integer.parseInt(USER_ID_VALUE));\n+    session.setStudySession(new ArrayList<>(Arrays.asList(0)));\n+    session.setSessionId(UUID.randomUUID().toString());\n+\n+    HashMap<String, Object> sessionAttributes = getSessionAttributes();\n+    sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n+    sessionAttributes.put(STUDY_ID_ATTR_NAME, STUDY_ID_VALUE);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, CUSTOM_STUDY_ID_VALUE);\n+\n+    ConsentInfoBo ConsentInfoBo = new ConsentInfoBo();\n+    ConsentInfoBo.setStudyId(678574);\n+\n+    MockHttpServletRequestBuilder requestBuilder =\n+        post(PathMappingUri.SAVE_OR_UPDATE_CONSENT_INFO.getPath())\n+            .headers(headers)\n+            .sessionAttrs(sessionAttributes);\n+\n+    addParams(requestBuilder, ConsentInfoBo);\n+    mockMvc\n+        .perform(requestBuilder)\n+        .andDo(print())\n+        .andExpect(status().isFound())\n+        .andExpect(view().name(\"redirect:/adminStudies/consentListPage.do\"));\n+\n+    verifyAuditEventCall(STUDY_CONSENT_SECTIONS_SAVED_OR_UPDATED);\n+  }\n+\n+  @Test\n+  public void shouldCompleteSyudySettings() throws Exception {\n+    HttpHeaders headers = getCommonHeaders();\n+\n+    SessionObject session = new SessionObject();\n+    session.setUserId(Integer.parseInt(STUDY_ID_VALUE));\n+    session.setStudySession(new ArrayList<>(Arrays.asList(0)));\n+    session.setSessionId(UUID.randomUUID().toString());\n+\n+    HashMap<String, Object> sessionAttributes = getSessionAttributes();\n+    sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, STUDY_ID_VALUE);\n+\n+    StudyBo studyBo = new StudyBo();\n+    studyBo.setId(678574);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc39d388c37b9c6598c245aad036a840decccecb"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4OTc4NA==", "bodyText": "Fixed review comment", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1077#discussion_r496889784", "createdAt": "2020-09-29T16:47:51Z", "author": {"login": "harisboston"}, "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "diffHunk": "@@ -470,4 +488,435 @@ public void shouldSaveOrUpdateSyudySettings() throws Exception {\n \n     verifyAuditEventCall(STUDY_SETTINGS_SAVED_OR_UPDATED);\n   }\n+\n+  @Test\n+  public void shouldSaveOrUpdateStudyConsentSection() throws Exception {\n+    HttpHeaders headers = getCommonHeaders();\n+\n+    SessionObject session = new SessionObject();\n+    session.setUserId(Integer.parseInt(USER_ID_VALUE));\n+    session.setStudySession(new ArrayList<>(Arrays.asList(0)));\n+    session.setSessionId(UUID.randomUUID().toString());\n+\n+    HashMap<String, Object> sessionAttributes = getSessionAttributes();\n+    sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n+    sessionAttributes.put(STUDY_ID_ATTR_NAME, STUDY_ID_VALUE);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, CUSTOM_STUDY_ID_VALUE);\n+\n+    ConsentInfoBo ConsentInfoBo = new ConsentInfoBo();\n+    ConsentInfoBo.setStudyId(678574);\n+\n+    MockHttpServletRequestBuilder requestBuilder =\n+        post(PathMappingUri.SAVE_OR_UPDATE_CONSENT_INFO.getPath())\n+            .headers(headers)\n+            .sessionAttrs(sessionAttributes);\n+\n+    addParams(requestBuilder, ConsentInfoBo);\n+    mockMvc\n+        .perform(requestBuilder)\n+        .andDo(print())\n+        .andExpect(status().isFound())\n+        .andExpect(view().name(\"redirect:/adminStudies/consentListPage.do\"));\n+\n+    verifyAuditEventCall(STUDY_CONSENT_SECTIONS_SAVED_OR_UPDATED);\n+  }\n+\n+  @Test\n+  public void shouldCompleteSyudySettings() throws Exception {\n+    HttpHeaders headers = getCommonHeaders();\n+\n+    SessionObject session = new SessionObject();\n+    session.setUserId(Integer.parseInt(STUDY_ID_VALUE));\n+    session.setStudySession(new ArrayList<>(Arrays.asList(0)));\n+    session.setSessionId(UUID.randomUUID().toString());\n+\n+    HashMap<String, Object> sessionAttributes = getSessionAttributes();\n+    sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n+    sessionAttributes.put(CUSTOM_STUDY_ID_ATTR_NAME, STUDY_ID_VALUE);\n+\n+    StudyBo studyBo = new StudyBo();\n+    studyBo.setId(678574);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njg4MDcwOA=="}, "originalCommit": {"oid": "cc39d388c37b9c6598c245aad036a840decccecb"}, "originalPosition": 140}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1843, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}