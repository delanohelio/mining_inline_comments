{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxMTI5MjIw", "number": 1854, "title": "Split testComponent_linkageCheckResult into Java 8 and Java 11", "bodyText": "Fixes #1849 . As explained in this issue, the difference comes from the 5 removed classes in Java 11:\nClass javax.activation.DataSource is not found;\n  referenced by 9 class files\n    com.google.appengine.api.utils.HttpRequestParser (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    com.google.apphosting.utils.servlet.MultipartMimeUtils (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    javax.mail.MultipartDataSource (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    javax.mail.internet.MimeMultipart (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    javax.mail.internet.MimePartDataSource (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    javax.mail.internet.MimeUtility (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    javax.mail.util.ByteArrayDataSource (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    org.apache.geronimo.mail.handlers.MessageHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    org.apache.geronimo.mail.handlers.TextHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n  Cause:\n    Unknown\nClass javax.activation.FileDataSource is not found;\n  referenced by 1 class file\n    javax.mail.internet.MimeBodyPart (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n  Cause:\n    Unknown\nClass javax.activation.DataHandler is not found;\n  referenced by 4 class files\n    javax.mail.internet.MimeBodyPart (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    javax.mail.internet.MimeMessage (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    javax.mail.internet.MimeUtility (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    javax.mail.internet.PreencodedMimeBodyPart (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n  Cause:\n    Unknown\nClass javax.activation.ActivationDataFlavor is not found;\n  referenced by 5 class files\n    org.apache.geronimo.mail.handlers.HtmlHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    org.apache.geronimo.mail.handlers.MessageHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    org.apache.geronimo.mail.handlers.MultipartHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    org.apache.geronimo.mail.handlers.TextHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    org.apache.geronimo.mail.handlers.XMLHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n  Cause:\n    Unknown\nClass javax.activation.DataContentHandler is not found;\n  referenced by 3 class files\n    org.apache.geronimo.mail.handlers.MessageHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    org.apache.geronimo.mail.handlers.MultipartHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n    org.apache.geronimo.mail.handlers.TextHandler (com.google.appengine:appengine-api-1.0-sdk:1.9.71)\n  Cause:\n    Unknown\nProblematic artifacts in the dependency tree:\ncom.google.appengine:appengine-api-1.0-sdk:1.9.71 is at:\n  com.google.http-client:google-http-client-appengine:1.38.0 (compile) / com.google.appengine:appengine-api-1.0-sdk:1.9.71 (provided)\n  and 2 other dependency paths.\n\njavax.activation package has been removed in Java 11 (JEP 320: Remove the Java EE and CORBA Modules)", "createdAt": "2020-12-02T16:17:07Z", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1854", "merged": true, "mergeCommit": {"oid": "2967cea85a5f9952fa28ea5b8193f785231de9b0"}, "closed": true, "closedAt": "2020-12-02T21:32:41Z", "author": {"login": "suztomo"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiQ8ldgH2gAyNTMxMTI5MjIwOjRkZjllYzU4ZTQ4NjY5MDdlOTJmNjk0ZTRmZGRkMDhmMzM3MTk1OWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiVbUDAFqTU0MzI1MTU2Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4df9ec58e4866907e92f694e4fddd08f3371959e", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/4df9ec58e4866907e92f694e4fddd08f3371959e", "committedDate": "2020-12-02T16:15:19Z", "message": "Split testComponent_linkageCheckResult to 8 and 11"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMDgxNjk5", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1854#pullrequestreview-543081699", "createdAt": "2020-12-02T17:38:25Z", "commit": {"oid": "4df9ec58e4866907e92f694e4fddd08f3371959e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNzozODoyNVrOH9miMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNzozOTo0MlrOH9mluw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM1NjUzMA==", "bodyText": "This should be explained here, not just in the PR description.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1854#discussion_r534356530", "createdAt": "2020-12-02T17:38:25Z", "author": {"login": "elharo"}, "path": "dashboard/src/test/java/com/google/cloud/tools/opensource/dashboard/DashboardTest.java", "diffHunk": "@@ -314,6 +317,34 @@ public void testComponent_linkageCheckResult() throws IOException, ParsingExcept\n                 + \" referenced from 21 classes \u25b6\"); // '\u25b6' is the toggle button\n   }\n \n+  @Test\n+  public void testComponent_linkageCheckResult_java11() throws IOException, ParsingException {\n+    String javaVersion = System.getProperty(\"java.version\");\n+    // javaMajorVersion is 1 when we use Java 8. Still good indicator to ensure Java 11 or higher.\n+    int javaMajorVersion = Integer.parseInt(javaVersion.split(\"\\\\.\")[0]);\n+    Assume.assumeTrue(javaMajorVersion >= 11);\n+\n+    // version used in libraries-bom 1.0.0\n+    Document document = parseOutputFile(\n+        \"com.google.http-client_google-http-client-appengine_1.29.1.html\");\n+    Nodes reports = document.query(\"//p[@class='jar-linkage-report']\");\n+    Assert.assertEquals(2, reports.size());\n+    // This number differs between Java 8 and Java 11", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4df9ec58e4866907e92f694e4fddd08f3371959e"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM1NzQzNQ==", "bodyText": "Is this difference still present in more recent http clients? If not, we could simply update the version we use for the test.\nIf it is present, we should probably file a bug against the http client since it should work with Java 11.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1854#discussion_r534357435", "createdAt": "2020-12-02T17:39:42Z", "author": {"login": "elharo"}, "path": "dashboard/src/test/java/com/google/cloud/tools/opensource/dashboard/DashboardTest.java", "diffHunk": "@@ -314,6 +317,34 @@ public void testComponent_linkageCheckResult() throws IOException, ParsingExcept\n                 + \" referenced from 21 classes \u25b6\"); // '\u25b6' is the toggle button\n   }\n \n+  @Test\n+  public void testComponent_linkageCheckResult_java11() throws IOException, ParsingException {\n+    String javaVersion = System.getProperty(\"java.version\");\n+    // javaMajorVersion is 1 when we use Java 8. Still good indicator to ensure Java 11 or higher.\n+    int javaMajorVersion = Integer.parseInt(javaVersion.split(\"\\\\.\")[0]);\n+    Assume.assumeTrue(javaMajorVersion >= 11);\n+\n+    // version used in libraries-bom 1.0.0\n+    Document document = parseOutputFile(\n+        \"com.google.http-client_google-http-client-appengine_1.29.1.html\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4df9ec58e4866907e92f694e4fddd08f3371959e"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd0dba44a98337c4055d0dac7c3c36b167d165af", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/fd0dba44a98337c4055d0dac7c3c36b167d165af", "committedDate": "2020-12-02T18:51:38Z", "message": "Merge remote-tracking branch 'origin/master' into i1849"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc04b9271dbf0d7c62b411b51361f924bacc2ffa", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/fc04b9271dbf0d7c62b411b51361f924bacc2ffa", "committedDate": "2020-12-02T18:54:08Z", "message": "Added comment on the linkage errors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMTMzMzk5", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1854#pullrequestreview-543133399", "createdAt": "2020-12-02T18:42:19Z", "commit": {"oid": "4df9ec58e4866907e92f694e4fddd08f3371959e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxODo0MjoxOVrOH9pEAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxODo0ODoxOFrOH9pSyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM5Nzk1NQ==", "bodyText": "Yes, updated.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1854#discussion_r534397955", "createdAt": "2020-12-02T18:42:19Z", "author": {"login": "suztomo"}, "path": "dashboard/src/test/java/com/google/cloud/tools/opensource/dashboard/DashboardTest.java", "diffHunk": "@@ -314,6 +317,34 @@ public void testComponent_linkageCheckResult() throws IOException, ParsingExcept\n                 + \" referenced from 21 classes \u25b6\"); // '\u25b6' is the toggle button\n   }\n \n+  @Test\n+  public void testComponent_linkageCheckResult_java11() throws IOException, ParsingException {\n+    String javaVersion = System.getProperty(\"java.version\");\n+    // javaMajorVersion is 1 when we use Java 8. Still good indicator to ensure Java 11 or higher.\n+    int javaMajorVersion = Integer.parseInt(javaVersion.split(\"\\\\.\")[0]);\n+    Assume.assumeTrue(javaMajorVersion >= 11);\n+\n+    // version used in libraries-bom 1.0.0\n+    Document document = parseOutputFile(\n+        \"com.google.http-client_google-http-client-appengine_1.29.1.html\");\n+    Nodes reports = document.query(\"//p[@class='jar-linkage-report']\");\n+    Assert.assertEquals(2, reports.size());\n+    // This number differs between Java 8 and Java 11", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM1NjUzMA=="}, "originalCommit": {"oid": "4df9ec58e4866907e92f694e4fddd08f3371959e"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQwMTczNw==", "bodyText": "Added more description. This test does not check the difference between Java 8 and Java 11. Rather, this test ensures that the dashboard generated using Java 11 has the expected linkage error section.\nFor the linkage errors in google-http-client-appengine, the two artifacts (\"commons-logging:commons-logging:1.2\" and \"com.google.appengine:appengine-api-1.0-sdk:1.9.71\") still show the (known) linkage errors. They are present in Java 8 too: https://storage.googleapis.com/cloud-opensource-java-dashboard/com.google.cloud/libraries-bom/snapshot/com.google.http-client_google-http-client-appengine_1.38.0.html", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1854#discussion_r534401737", "createdAt": "2020-12-02T18:48:18Z", "author": {"login": "suztomo"}, "path": "dashboard/src/test/java/com/google/cloud/tools/opensource/dashboard/DashboardTest.java", "diffHunk": "@@ -314,6 +317,34 @@ public void testComponent_linkageCheckResult() throws IOException, ParsingExcept\n                 + \" referenced from 21 classes \u25b6\"); // '\u25b6' is the toggle button\n   }\n \n+  @Test\n+  public void testComponent_linkageCheckResult_java11() throws IOException, ParsingException {\n+    String javaVersion = System.getProperty(\"java.version\");\n+    // javaMajorVersion is 1 when we use Java 8. Still good indicator to ensure Java 11 or higher.\n+    int javaMajorVersion = Integer.parseInt(javaVersion.split(\"\\\\.\")[0]);\n+    Assume.assumeTrue(javaMajorVersion >= 11);\n+\n+    // version used in libraries-bom 1.0.0\n+    Document document = parseOutputFile(\n+        \"com.google.http-client_google-http-client-appengine_1.29.1.html\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM1NzQzNQ=="}, "originalCommit": {"oid": "4df9ec58e4866907e92f694e4fddd08f3371959e"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQzMjUxNTY3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1854#pullrequestreview-543251567", "createdAt": "2020-12-02T21:28:30Z", "commit": {"oid": "fc04b9271dbf0d7c62b411b51361f924bacc2ffa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1300, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}