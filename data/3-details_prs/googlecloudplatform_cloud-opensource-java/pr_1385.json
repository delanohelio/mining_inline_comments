{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNjA3MTUz", "number": 1385, "title": "move readBom methods to Bom class", "bodyText": "@suztomo", "createdAt": "2020-05-05T16:01:08Z", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1385", "merged": true, "mergeCommit": {"oid": "c8f0f9030a08c29b71da0d8d5b883ffb722fc3c7"}, "closed": true, "closedAt": "2020-05-05T20:22:16Z", "author": {"login": "elharo"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceWO50AH2gAyNDEzNjA3MTUzOmI2ZjgwYTQ4YTM0ZDdmYWYwNjk1NjJhNDMyZjBlZTYzMDIwMDhlYzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABceYteQAH2gAyNDEzNjA3MTUzOmNkYzE0Zjc1OGU5NWNkZTk3ZDQ5ODA5Zjc4YjhmNDRkZDM5ZmYyYWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b6f80a48a34d7faf069562a432f0ee6302008ec2", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/b6f80a48a34d7faf069562a432f0ee6302008ec2", "committedDate": "2020-05-05T15:58:00Z", "message": "move readBom methods to Bom class"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MDE0NTM1", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1385#pullrequestreview-406014535", "createdAt": "2020-05-05T17:42:16Z", "commit": {"oid": "b6f80a48a34d7faf069562a432f0ee6302008ec2"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzo0MjoxNlrOGQ0ing==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzo0NDowNlrOGQ0m_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI5MTIzMA==", "bodyText": "Unnecessary space at the end of line/", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1385#discussion_r420291230", "createdAt": "2020-05-05T17:42:16Z", "author": {"login": "suztomo"}, "path": "dashboard/src/test/java/com/google/cloud/tools/opensource/dashboard/BomTest.java", "diffHunk": "@@ -26,19 +26,19 @@\n import org.eclipse.aether.artifact.Artifact;\n import org.junit.Assert;\n import org.junit.Test;\n+import com.google.cloud.tools.opensource.dependencies.Bom;\n import com.google.cloud.tools.opensource.dependencies.MavenRepositoryException;\n-import com.google.cloud.tools.opensource.dependencies.RepositoryUtility;\n \n public class BomTest {\n \n   private static final Path CLOUD_OSS_BOM_PATH =\n-      Paths.get(\"..\", \"boms\", \"cloud-oss-bom\", \"pom.xml\").toAbsolutePath();\n-\n+      Paths.get(\"..\", \"boms\", \"cloud-oss-bom\", \"pom.xml\").toAbsolutePath();  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6f80a48a34d7faf069562a432f0ee6302008ec2"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI5MTYzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * Parse the dependencyManagement section of an artifact and return the artifacts included there.\n          \n          \n            \n               * Parses the dependencyManagement section of an artifact and returns the artifacts included there.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1385#discussion_r420291636", "createdAt": "2020-05-05T17:42:57Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/Bom.java", "diffHunk": "@@ -59,6 +72,75 @@ public String getCoordinates() {\n     return coordinates;\n   }\n \n+  public static Bom readBom(Path pomFile) throws MavenRepositoryException {\n+    RepositorySystem system = RepositoryUtility.newRepositorySystem();\n+    RepositorySystemSession session = RepositoryUtility.newSession(system);\n+  \n+    MavenProject mavenProject = RepositoryUtility.createMavenProject(pomFile, session);\n+    String coordinates = mavenProject.getGroupId() + \":\" + mavenProject.getArtifactId() \n+        + \":\" + mavenProject.getVersion();\n+    DependencyManagement dependencyManagement = mavenProject.getDependencyManagement();\n+    List<org.apache.maven.model.Dependency> dependencies = dependencyManagement.getDependencies();\n+  \n+    ArtifactTypeRegistry registry = session.getArtifactTypeRegistry();\n+    ImmutableList<Artifact> artifacts = dependencies.stream()\n+        .map(dependency -> RepositoryUtils.toDependency(dependency, registry))\n+        .map(Dependency::getArtifact)\n+        .filter(artifact -> !shouldSkipBomMember(artifact))\n+        .collect(ImmutableList.toImmutableList());\n+    \n+    Bom bom = new Bom(coordinates, artifacts);\n+    return bom;\n+  }\n+\n+  /**\n+   * Parse the dependencyManagement section of an artifact and return the artifacts included there.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6f80a48a34d7faf069562a432f0ee6302008ec2"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI5MjM0OA==", "bodyText": "Insert an empty line between static imports and non-static imports.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1385#discussion_r420292348", "createdAt": "2020-05-05T17:44:06Z", "author": {"login": "suztomo"}, "path": "dependencies/src/test/java/com/google/cloud/tools/opensource/classpath/ClassPathBuilderTest.java", "diffHunk": "@@ -19,8 +19,7 @@\n import static com.google.cloud.tools.opensource.classpath.TestHelper.COORDINATES;\n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertNotNull;\n-\n-import com.google.cloud.tools.opensource.dependencies.RepositoryUtility;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b6f80a48a34d7faf069562a432f0ee6302008ec2"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d329b2415de8520b3db8b3799994efca84e724a9", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/d329b2415de8520b3db8b3799994efca84e724a9", "committedDate": "2020-05-05T18:48:31Z", "message": "order imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdc14f758e95cde97d49809f78b8f44dd39ff2ab", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/cdc14f758e95cde97d49809f78b8f44dd39ff2ab", "committedDate": "2020-05-05T18:51:12Z", "message": "improve javadoc"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 381, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}