{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNzI5MDU4", "number": 1310, "title": "BlockHound's VirtualMachine exclusion rule for JNA", "bodyText": "Fixes #1296 .\nI confirmed gRPC 1.28.0 passes MaximumLinkageErrorsTest.\nsuztomo-macbookpro44% git diff\ndiff --git a/boms/cloud-oss-bom/pom.xml b/boms/cloud-oss-bom/pom.xml\nindex 822c0269..2aae9b55 100644\n--- a/boms/cloud-oss-bom/pom.xml\n+++ b/boms/cloud-oss-bom/pom.xml\n@@ -46,7 +46,7 @@\n     <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n     <guava.version>28.2-android</guava.version>\n     <google.cloud.java.version>0.122.5-alpha</google.cloud.java.version>\n-    <io.grpc.version>1.27.2</io.grpc.version>\n+    <io.grpc.version>1.28.0</io.grpc.version>\n     <protobuf.version>3.11.4</protobuf.version>\n     <http.version>1.34.2</http.version>\n   </properties>\nsuztomo-macbookpro44% cd boms \nsuztomo-macbookpro44% mvn clean install\n...\n[INFO] -------------------------------------------------------\n[INFO]  T E S T S\n[INFO] -------------------------------------------------------\n[INFO] Running com.google.cloud.MaximumLinkageErrorsTest\nSLF4J: Failed to load class \"org.slf4j.impl.StaticLoggerBinder\".\nSLF4J: Defaulting to no-operation (NOP) logger implementation\nSLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.\n[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 120.623 s - in com.google.cloud.MaximumLinkageErrorsTest\n[INFO] \n[INFO] Results:\n[INFO] \n[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0\n[INFO] \n[INFO] \n[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ integration-tests ---\n[WARNING] JAR will be empty - no content was marked for inclusion!\n[INFO] Building jar: /Users/suztomo/cloud-opensource-java/boms/integration-tests/target/integration-tests-1.2.0-SNAPSHOT.jar\n[INFO] \n[INFO] --- maven-install-plugin:2.4:install (default-install) @ integration-tests ---\n[INFO] Installing /Users/suztomo/cloud-opensource-java/boms/integration-tests/target/integration-tests-1.2.0-SNAPSHOT.jar to /Users/suztomo/.m2/repository/com/google/cloud/integration-tests/1.2.0-SNAPSHOT/integration-tests-1.2.0-SNAPSHOT.jar\n[INFO] Installing /Users/suztomo/cloud-opensource-java/boms/integration-tests/pom.xml to /Users/suztomo/.m2/repository/com/google/cloud/integration-tests/1.2.0-SNAPSHOT/integration-tests-1.2.0-SNAPSHOT.pom\n[INFO] ------------------------------------------------------------------------\n[INFO] Reactor Summary:\n[INFO] \n[INFO] Google Cloud Platform Supported Libraries 4.3.1-SNAPSHOT SUCCESS [  0.294 s]\n[INFO] BOM Parent 1.0-SNAPSHOT ............................ SUCCESS [  0.008 s]\n[INFO] Cloud Platform Supported Libraries Upper Bounds Check 2.0.0-SNAPSHOT SUCCESS [  0.730 s]\n[INFO] integration-tests 1.2.0-SNAPSHOT ................... SUCCESS [02:03 min]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  02:04 min\n[INFO] Finished at: 2020-03-25T13:44:30-04:00\n[INFO] ------------------------------------------------------------------------", "createdAt": "2020-03-25T17:37:05Z", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310", "merged": true, "mergeCommit": {"oid": "6348216619c3320cadcded6a1f14baaae3b20680"}, "closed": true, "closedAt": "2020-03-25T19:40:13Z", "author": {"login": "suztomo"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRLH26AH2gAyMzkzNzI5MDU4OjRmY2RkZGU3ZmQyMTk2NGJjYzc1ZjlhZTIzZjc0N2NlNGI5YTY5OTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRMVDVgH2gAyMzkzNzI5MDU4OjQwMjhlNjU0MjJmYmZiODNiNzJlYzc3YjJkODE3NmYwNjk4ZTdhZGI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4fcddde7fd21964bcc75f9ae23f747ce4b9a6997", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/4fcddde7fd21964bcc75f9ae23f747ce4b9a6997", "committedDate": "2020-03-25T17:40:20Z", "message": "BlockHound exclusion rule"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7d34ef0b29a74b4962b7b7017bdef2a69d1d123", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/c7d34ef0b29a74b4962b7b7017bdef2a69d1d123", "committedDate": "2020-03-25T17:40:20Z", "message": "Adding URL"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d7f5c2d619f67b226c23312a216a76ee76e22e6", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/3d7f5c2d619f67b226c23312a216a76ee76e22e6", "committedDate": "2020-03-25T17:40:20Z", "message": "Reason"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bf987d7b2d19627fbb9814164fc224eefadb7976", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/bf987d7b2d19627fbb9814164fc224eefadb7976", "committedDate": "2020-03-25T17:38:43Z", "message": "Reason"}, "afterCommit": {"oid": "3d7f5c2d619f67b226c23312a216a76ee76e22e6", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/3d7f5c2d619f67b226c23312a216a76ee76e22e6", "committedDate": "2020-03-25T17:40:20Z", "message": "Reason"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzk1MTIx", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#pullrequestreview-381395121", "createdAt": "2020-03-25T17:51:44Z", "commit": {"oid": "3d7f5c2d619f67b226c23312a216a76ee76e22e6"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzo1MTo0NVrOF7nSng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNzo1MjozMlrOF7nUhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1NDA0Ng==", "bodyText": "Blockhound's --> Blockhound", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398054046", "createdAt": "2020-03-25T17:51:45Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/resources/linkage-checker-exclusion-default.xml", "diffHunk": "@@ -57,4 +57,18 @@\n       https://github.com/GoogleCloudPlatform/cloud-opensource-java/issues/407\n     </Reason>\n   </LinkageError>\n+  <LinkageError>\n+    <Target>\n+      <Package name=\"com.sun.jna\" />\n+    </Target>\n+    <Source>\n+      <Package name=\"reactor.blockhound.shaded.net.bytebuddy.agent.VirtualMachine\" />\n+    </Source>\n+    <Reason>\n+      BlockHound's shades ByteBuddy's VirtualMachine class. The class uses Java Native Access (JNA)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d7f5c2d619f67b226c23312a216a76ee76e22e6"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1NDQzOA==", "bodyText": "If it's guarding the class, the rule above should reference the class (or classes) rather than a package.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398054438", "createdAt": "2020-03-25T17:52:24Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/resources/linkage-checker-exclusion-default.xml", "diffHunk": "@@ -57,4 +57,18 @@\n       https://github.com/GoogleCloudPlatform/cloud-opensource-java/issues/407\n     </Reason>\n   </LinkageError>\n+  <LinkageError>\n+    <Target>\n+      <Package name=\"com.sun.jna\" />\n+    </Target>\n+    <Source>\n+      <Package name=\"reactor.blockhound.shaded.net.bytebuddy.agent.VirtualMachine\" />\n+    </Source>\n+    <Reason>\n+      BlockHound's shades ByteBuddy's VirtualMachine class. The class uses Java Native Access (JNA)\n+      only when the class is available by catching ClassNotFoundException. Therefore the invalid", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d7f5c2d619f67b226c23312a216a76ee76e22e6"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1NDUzNQ==", "bodyText": "should --> do", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398054535", "createdAt": "2020-03-25T17:52:32Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/resources/linkage-checker-exclusion-default.xml", "diffHunk": "@@ -57,4 +57,18 @@\n       https://github.com/GoogleCloudPlatform/cloud-opensource-java/issues/407\n     </Reason>\n   </LinkageError>\n+  <LinkageError>\n+    <Target>\n+      <Package name=\"com.sun.jna\" />\n+    </Target>\n+    <Source>\n+      <Package name=\"reactor.blockhound.shaded.net.bytebuddy.agent.VirtualMachine\" />\n+    </Source>\n+    <Reason>\n+      BlockHound's shades ByteBuddy's VirtualMachine class. The class uses Java Native Access (JNA)\n+      only when the class is available by catching ClassNotFoundException. Therefore the invalid\n+      references should not cause linkage errors at runtime.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d7f5c2d619f67b226c23312a216a76ee76e22e6"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b663993b55980a61a24f5bef3138aacfb56c28c", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/0b663993b55980a61a24f5bef3138aacfb56c28c", "committedDate": "2020-03-25T18:02:57Z", "message": "Applied review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDE0MDE3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#pullrequestreview-381414017", "createdAt": "2020-03-25T18:14:28Z", "commit": {"oid": "0b663993b55980a61a24f5bef3138aacfb56c28c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxODoxNDoyOFrOF7oOVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxODoxNDoyOFrOF7oOVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA2OTMzMw==", "bodyText": "This sentence doesn't quite work. Perhaps break out \" by catching ClassNotFoundException\" into a sentence of its own that explains how the access is guarded, or just delete it.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#discussion_r398069333", "createdAt": "2020-03-25T18:14:28Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/resources/linkage-checker-exclusion-default.xml", "diffHunk": "@@ -57,4 +57,19 @@\n       https://github.com/GoogleCloudPlatform/cloud-opensource-java/issues/407\n     </Reason>\n   </LinkageError>\n+  <LinkageError>\n+    <Target>\n+      <Package name=\"com.sun.jna\" />\n+    </Target>\n+    <Source>\n+      <Package name=\"reactor.blockhound.shaded.net.bytebuddy.agent.VirtualMachine\" />\n+    </Source>\n+    <Reason>\n+      BlockHound shades ByteBuddy's VirtualMachine class. The class uses Java Native Access (JNA)\n+      only when the com.sun.jna package is available by catching ClassNotFoundException. Therefore", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b663993b55980a61a24f5bef3138aacfb56c28c"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5834a4d4b7ed97d6b0effaad05ccbbb1c0fb823", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/a5834a4d4b7ed97d6b0effaad05ccbbb1c0fb823", "committedDate": "2020-03-25T18:16:11Z", "message": "removed 'by catching...'"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDUwNTk1", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1310#pullrequestreview-381450595", "createdAt": "2020-03-25T19:01:46Z", "commit": {"oid": "a5834a4d4b7ed97d6b0effaad05ccbbb1c0fb823"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4028e65422fbfb83b72ec77b2d8176f0698e7adb", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/4028e65422fbfb83b72ec77b2d8176f0698e7adb", "committedDate": "2020-03-25T19:04:39Z", "message": "Merge remote-tracking branch 'origin/master' into blockhound_exclusion"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 308, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}