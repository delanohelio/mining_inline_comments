{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY5NzUzMzM3", "number": 1171, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMDoxNDozOFrODcWL8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNzoxNjoxMlrODdD1fQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMDUwMjI0OnYy", "diffSide": "RIGHT", "path": "linkage-monitor/src/test/resources/testproject/testsubproject/build/pom.xml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMDoxNDozOFrOFkWxzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMDoxNDozOFrOFkWxzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY2NjI1NA==", "bodyText": "LinkageMonitorTest.testFindLocalArtifacts ensures this file is not picked up.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r373666254", "createdAt": "2020-01-31T20:14:38Z", "author": {"login": "suztomo"}, "path": "linkage-monitor/src/test/resources/testproject/testsubproject/build/pom.xml", "diffHunk": "@@ -0,0 +1,14 @@\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6632398639feff188e548705ecfc48691f975d63"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMDU2MjA5OnYy", "diffSide": "RIGHT", "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMDo0MDozNVrOFkXXgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMToyODoxNlrOFkYcLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY3NTkwNg==", "bodyText": "Is this truly necessary? Usually there's a cleaner approach that does not use continue. Here I think you can reverse the if and avoid continue.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r373675906", "createdAt": "2020-01-31T20:40:35Z", "author": {"login": "elharo"}, "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -105,10 +105,20 @@ public static void main(String[] arguments)\n       RepositorySystem repositorySystem, RepositorySystemSession session, Path projectDirectory) {\n     ImmutableMap.Builder<String, String> artifactToVersion = ImmutableMap.builder();\n     Iterable<Path> paths = MoreFiles.fileTraverser().breadthFirst(projectDirectory);\n+\n+    PATHS_LOOP:\n     for (Path path : paths) {\n       if (!path.getFileName().endsWith(\"pom.xml\")) {\n         continue;\n       }\n+      for (Path pathElement : path) {\n+        String name = pathElement.toString();\n+        if (name.equals(\"build\") || name.equals(\"target\")) {\n+          // Exclude Gradle's build directory and Maven's target directory.\n+          continue PATHS_LOOP;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6632398639feff188e548705ecfc48691f975d63"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY5MzQ4Ng==", "bodyText": "Removed the label. Does this look good now?", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r373693486", "createdAt": "2020-01-31T21:28:16Z", "author": {"login": "suztomo"}, "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -105,10 +105,20 @@ public static void main(String[] arguments)\n       RepositorySystem repositorySystem, RepositorySystemSession session, Path projectDirectory) {\n     ImmutableMap.Builder<String, String> artifactToVersion = ImmutableMap.builder();\n     Iterable<Path> paths = MoreFiles.fileTraverser().breadthFirst(projectDirectory);\n+\n+    PATHS_LOOP:\n     for (Path path : paths) {\n       if (!path.getFileName().endsWith(\"pom.xml\")) {\n         continue;\n       }\n+      for (Path pathElement : path) {\n+        String name = pathElement.toString();\n+        if (name.equals(\"build\") || name.equals(\"target\")) {\n+          // Exclude Gradle's build directory and Maven's target directory.\n+          continue PATHS_LOOP;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzY3NTkwNg=="}, "originalCommit": {"oid": "6632398639feff188e548705ecfc48691f975d63"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMDcxMTM4OnYy", "diffSide": "RIGHT", "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMVQyMTo0NzowN1rOFkY2JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzoyMTowMFrOFlTvXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcwMDEzMg==", "bodyText": "Does it matter where in the path this directory occurs? Can it be only at the end? What if a something several levels up has the name build or target?", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r373700132", "createdAt": "2020-01-31T21:47:07Z", "author": {"login": "elharo"}, "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -105,10 +105,18 @@ public static void main(String[] arguments)\n       RepositorySystem repositorySystem, RepositorySystemSession session, Path projectDirectory) {\n     ImmutableMap.Builder<String, String> artifactToVersion = ImmutableMap.builder();\n     Iterable<Path> paths = MoreFiles.fileTraverser().breadthFirst(projectDirectory);\n+\n     for (Path path : paths) {\n       if (!path.getFileName().endsWith(\"pom.xml\")) {\n         continue;\n       }\n+\n+      ImmutableSet<Path> elements = ImmutableSet.copyOf(path);\n+      if (elements.contains(Paths.get(\"build\")) || elements.contains(Paths.get(\"target\"))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e72da6d2f5794a3a2c0af5d0babfaf8343799a42"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcwMzg0Mg==", "bodyText": "I would say it does not matter.\nFrom my experience, it's a common practice to avoid using \"build\" or \"target\" directory to place something to be published.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r373703842", "createdAt": "2020-01-31T21:58:02Z", "author": {"login": "suztomo"}, "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -105,10 +105,18 @@ public static void main(String[] arguments)\n       RepositorySystem repositorySystem, RepositorySystemSession session, Path projectDirectory) {\n     ImmutableMap.Builder<String, String> artifactToVersion = ImmutableMap.builder();\n     Iterable<Path> paths = MoreFiles.fileTraverser().breadthFirst(projectDirectory);\n+\n     for (Path path : paths) {\n       if (!path.getFileName().endsWith(\"pom.xml\")) {\n         continue;\n       }\n+\n+      ImmutableSet<Path> elements = ImmutableSet.copyOf(path);\n+      if (elements.contains(Paths.get(\"build\")) || elements.contains(Paths.get(\"target\"))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcwMDEzMg=="}, "originalCommit": {"oid": "e72da6d2f5794a3a2c0af5d0babfaf8343799a42"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc1NTIzNw==", "bodyText": "Another logic I have in mind: flags to indicate the existence of \"build.gradle\" and \"pom.xml\" files. (It gets complicated as it seeks for accuracy)", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r373755237", "createdAt": "2020-02-01T03:44:52Z", "author": {"login": "suztomo"}, "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -105,10 +105,18 @@ public static void main(String[] arguments)\n       RepositorySystem repositorySystem, RepositorySystemSession session, Path projectDirectory) {\n     ImmutableMap.Builder<String, String> artifactToVersion = ImmutableMap.builder();\n     Iterable<Path> paths = MoreFiles.fileTraverser().breadthFirst(projectDirectory);\n+\n     for (Path path : paths) {\n       if (!path.getFileName().endsWith(\"pom.xml\")) {\n         continue;\n       }\n+\n+      ImmutableSet<Path> elements = ImmutableSet.copyOf(path);\n+      if (elements.contains(Paths.get(\"build\")) || elements.contains(Paths.get(\"target\"))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcwMDEzMg=="}, "originalCommit": {"oid": "e72da6d2f5794a3a2c0af5d0babfaf8343799a42"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY2NTA1Mw==", "bodyText": "Perhaps we can talk about this offline, but I don't think this one is answered. As written, this seems buggy to me.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r374665053", "createdAt": "2020-02-04T13:21:00Z", "author": {"login": "elharo"}, "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -105,10 +105,18 @@ public static void main(String[] arguments)\n       RepositorySystem repositorySystem, RepositorySystemSession session, Path projectDirectory) {\n     ImmutableMap.Builder<String, String> artifactToVersion = ImmutableMap.builder();\n     Iterable<Path> paths = MoreFiles.fileTraverser().breadthFirst(projectDirectory);\n+\n     for (Path path : paths) {\n       if (!path.getFileName().endsWith(\"pom.xml\")) {\n         continue;\n       }\n+\n+      ImmutableSet<Path> elements = ImmutableSet.copyOf(path);\n+      if (elements.contains(Paths.get(\"build\")) || elements.contains(Paths.get(\"target\"))) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzcwMDEzMg=="}, "originalCommit": {"oid": "e72da6d2f5794a3a2c0af5d0babfaf8343799a42"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzA4NDA3OnYy", "diffSide": "RIGHT", "path": "linkage-monitor/README.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzoyMTozNFrOFlTwoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzoyMTozNFrOFlTwoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY2NTM3Nw==", "bodyText": "to --> in the", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r374665377", "createdAt": "2020-02-04T13:21:34Z", "author": {"login": "elharo"}, "path": "linkage-monitor/README.md", "diffHunk": "@@ -21,6 +21,9 @@ set -e # fail if any of command fails\n # Install artifacts to local Maven repository. The command depends on build system of the project.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a47d7420209dde5961db2690f619de929bca66d0"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzk4MTQxOnYy", "diffSide": "RIGHT", "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNzoxNjoxMlrOFlcd7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxNzoyOTozMVrOFlc6UQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgwODA0NA==", "bodyText": "This will throw an exception the calling code isn't prepared to handle. This method should handle both cases here.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r374808044", "createdAt": "2020-02-04T17:16:12Z", "author": {"login": "elharo"}, "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -112,13 +113,18 @@ public static void main(String[] arguments)\n   static ImmutableMap<String, String> findLocalArtifacts(\n       RepositorySystem repositorySystem, RepositorySystemSession session, Path projectDirectory) {\n     ImmutableMap.Builder<String, String> artifactToVersion = ImmutableMap.builder();\n+\n+    // Relative paths to the files in the project\n     Iterable<Path> paths = MoreFiles.fileTraverser().breadthFirst(projectDirectory);\n \n     for (Path path : paths) {\n       if (!path.getFileName().endsWith(\"pom.xml\")) {\n         continue;\n       }\n \n+      Verify.verify(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3df642ae1fdac168a2d65bbff1ee3bc9a3495d3b"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgxNTMxMw==", "bodyText": "Updated to use path.relativize in case it is an absolute path.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1171#discussion_r374815313", "createdAt": "2020-02-04T17:29:31Z", "author": {"login": "suztomo"}, "path": "linkage-monitor/src/main/java/com/google/cloud/tools/dependencies/linkagemonitor/LinkageMonitor.java", "diffHunk": "@@ -112,13 +113,18 @@ public static void main(String[] arguments)\n   static ImmutableMap<String, String> findLocalArtifacts(\n       RepositorySystem repositorySystem, RepositorySystemSession session, Path projectDirectory) {\n     ImmutableMap.Builder<String, String> artifactToVersion = ImmutableMap.builder();\n+\n+    // Relative paths to the files in the project\n     Iterable<Path> paths = MoreFiles.fileTraverser().breadthFirst(projectDirectory);\n \n     for (Path path : paths) {\n       if (!path.getFileName().endsWith(\"pom.xml\")) {\n         continue;\n       }\n \n+      Verify.verify(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDgwODA0NA=="}, "originalCommit": {"oid": "3df642ae1fdac168a2d65bbff1ee3bc9a3495d3b"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2782, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}