{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2OTMxMTAz", "number": 1152, "title": "LinkageCheckerMain to report dependency paths", "bodyText": "Applying #981 (and #983) for LinkageCheckerMain, which I use for Apache Beam.\nExample output:\nbeam-sdks-java-core-2.20.0-SNAPSHOT.jar is at:\n  org.apache.beam:beam-sdks-java-io-hadoop-format:2.20.0-SNAPSHOT (compile) / org.apache.beam:beam-sdks-java-core:2.20.0-SNAPSHOT (compile)\n  and 1 dependency path.\nbeam-vendor-bytebuddy-1_9_3-0.1.jar is at:\n  org.apache.beam:beam-sdks-java-io-hadoop-format:2.20.0-SNAPSHOT (compile) / org.apache.beam:beam-sdks-java-core:2.20.0-SNAPSHOT (compile) / org.apache.beam:beam-vendor-bytebuddy-1_9_3:0.1 (compile)\n  and 1 dependency path.\njackson-xc-1.8.3.jar is at:\n  org.apache.beam:beam-sdks-java-io-hadoop-format:2.20.0-SNAPSHOT (compile) / org.apache.hadoop:hadoop-common:2.8.5 (provided) / com.sun.jersey:jersey-json:1.9 (compile) / org.codehaus.jackson:jackson-xc:1.8.3 (compile)\n  and 125 other dependency paths.\njackson-mapper-asl-1.9.13.jar is at:\n  org.apache.beam:beam-sdks-java-io-hadoop-format:2.20.0-SNAPSHOT (compile) / org.apache.hadoop:hadoop-common:2.8.5 (provided) / org.codehaus.jackson:jackson-mapper-asl:1.9.13 (compile)\n  and 177 other dependency paths.\nweld-osgi-bundle-1.1.0.Final.jar is at:\n  org.apache.beam:beam-sdks-java-io-hadoop-format:2.20.0-SNAPSHOT (compile) / org.apache.hadoop:hadoop-common:2.8.5 (provided) / com.sun.jersey:jersey-server:1.9 (compile) / org.jboss.weld:weld-osgi-bundle:1.1.0.Final (provided)\n  and 151 other dependency paths.\nguava-11.0.2.jar is at:\n  org.apache.beam:beam-sdks-java-io-hadoop-format:2.20.0-SNAPSHOT (compile) / org.apache.hadoop:hadoop-common:2.8.5 (provided) / com.google.guava:guava:11.0.2 (compile)\n  and 194 other dependency paths.\napacheds-kerberos-codec-2.0.0-M15.jar is at:\n  org.apache.beam:beam-sdks-java-io-hadoop-format:2.20.0-SNAPSHOT (compile) / org.apache.hadoop:hadoop-common:2.8.5 (provided) / org.apache.hadoop:hadoop-auth:2.8.5 (compile) / org.apache.directory.server:apacheds-kerberos-codec:2.0.0-M15 (compile)\n  and 100 other dependency paths.", "createdAt": "2020-01-24T17:03:55Z", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1152", "merged": true, "mergeCommit": {"oid": "8a89aa30f42ec7eb1a02ee682de77b108fb10916"}, "closed": true, "closedAt": "2020-01-24T20:31:00Z", "author": {"login": "suztomo"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb9h9HiAH2gAyMzY2OTMxMTAzOjcyNWE0MWNkYTIxZDY1ZmJiNzliZGNjMGNjYTRlOWE2M2M1MjVmYjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9kvM_gH2gAyMzY2OTMxMTAzOmVlYjdjZWMzOTk4ODkxZjBhMzlkMWJhMjIyZjFhY2JmY2NkNTFmZDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "725a41cda21d65fbb79bdcc0cca4e9a63c525fb8", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/725a41cda21d65fbb79bdcc0cca4e9a63c525fb8", "committedDate": "2020-01-24T16:57:56Z", "message": "LinkageCheckerMain to report dependency paths"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MDk5NDI3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1152#pullrequestreview-348099427", "createdAt": "2020-01-24T17:11:56Z", "commit": {"oid": "725a41cda21d65fbb79bdcc0cca4e9a63c525fb8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxNzoxMTo1NlrOFhkeXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxNzoxMTo1NlrOFhkeXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc0NDkyNA==", "bodyText": "and 163 other dependency paths\ninstead\nand other 163 dependency paths", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1152#discussion_r370744924", "createdAt": "2020-01-24T17:11:56Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ClassPathResult.java", "diffHunk": "@@ -69,4 +71,24 @@ public ClassPathResult(\n   ImmutableList<UnresolvableArtifactProblem> getArtifactProblems() {\n     return artifactProblems;\n   }\n+\n+  /** Returns text describing dependency paths to {@code jars} in the dependency tree. */\n+  public String formatDependencyPaths(Iterable<Path> jars) {\n+    StringBuilder message = new StringBuilder();\n+    for (Path jar : jars) {\n+      ImmutableList<DependencyPath> dependencyPaths = getDependencyPaths(jar);\n+      checkArgument(dependencyPaths.size() >= 1, \"%s is not in the class path\", jar);\n+\n+      message.append(jar.getFileName() + \" is at:\\n\");\n+\n+      int otherCount = dependencyPaths.size() - 1;\n+      message.append(\"  \" + dependencyPaths.get(0) + \"\\n\");\n+      if (otherCount == 1) {\n+        message.append(\"  and 1 dependency path.\\n\");\n+      } else if (otherCount > 1) {\n+        message.append(\"  and other \" + otherCount + \" dependency paths.\\n\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "725a41cda21d65fbb79bdcc0cca4e9a63c525fb8"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6cc92b4c1be265e76e99b3e7d420eb2f6f56159", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/c6cc92b4c1be265e76e99b3e7d420eb2f6f56159", "committedDate": "2020-01-24T17:26:04Z", "message": "Applied review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTA3OTQ2", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1152#pullrequestreview-348107946", "createdAt": "2020-01-24T17:27:02Z", "commit": {"oid": "725a41cda21d65fbb79bdcc0cca4e9a63c525fb8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxNzoyNzowMlrOFhk4Hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxNzoyNzowMlrOFhk4Hw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc1MTUxOQ==", "bodyText": "Updated.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1152#discussion_r370751519", "createdAt": "2020-01-24T17:27:02Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ClassPathResult.java", "diffHunk": "@@ -69,4 +71,24 @@ public ClassPathResult(\n   ImmutableList<UnresolvableArtifactProblem> getArtifactProblems() {\n     return artifactProblems;\n   }\n+\n+  /** Returns text describing dependency paths to {@code jars} in the dependency tree. */\n+  public String formatDependencyPaths(Iterable<Path> jars) {\n+    StringBuilder message = new StringBuilder();\n+    for (Path jar : jars) {\n+      ImmutableList<DependencyPath> dependencyPaths = getDependencyPaths(jar);\n+      checkArgument(dependencyPaths.size() >= 1, \"%s is not in the class path\", jar);\n+\n+      message.append(jar.getFileName() + \" is at:\\n\");\n+\n+      int otherCount = dependencyPaths.size() - 1;\n+      message.append(\"  \" + dependencyPaths.get(0) + \"\\n\");\n+      if (otherCount == 1) {\n+        message.append(\"  and 1 dependency path.\\n\");\n+      } else if (otherCount > 1) {\n+        message.append(\"  and other \" + otherCount + \" dependency paths.\\n\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc0NDkyNA=="}, "originalCommit": {"oid": "725a41cda21d65fbb79bdcc0cca4e9a63c525fb8"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe7d13a8ea02b5dd47dca2c7cba3db72dabd8ad6", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/fe7d13a8ea02b5dd47dca2c7cba3db72dabd8ad6", "committedDate": "2020-01-24T17:33:07Z", "message": "Added comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTI4ODU3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1152#pullrequestreview-348128857", "createdAt": "2020-01-24T18:05:46Z", "commit": {"oid": "fe7d13a8ea02b5dd47dca2c7cba3db72dabd8ad6"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxODowNTo0N1rOFhl3uQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQxODowNzowNlrOFhl52Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc2NzgwMQ==", "bodyText": "This could be simpler if this method only formatted a single jar. Then you'd only need one loop in LinkageChecker.main and you wouldn't have to build an intermediate list.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1152#discussion_r370767801", "createdAt": "2020-01-24T18:05:47Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ClassPathResult.java", "diffHunk": "@@ -69,4 +71,24 @@ public ClassPathResult(\n   ImmutableList<UnresolvableArtifactProblem> getArtifactProblems() {\n     return artifactProblems;\n   }\n+\n+  /** Returns text describing dependency paths to {@code jars} in the dependency tree. */\n+  public String formatDependencyPaths(Iterable<Path> jars) {\n+    StringBuilder message = new StringBuilder();\n+    for (Path jar : jars) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe7d13a8ea02b5dd47dca2c7cba3db72dabd8ad6"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDc2ODM0NQ==", "bodyText": "You don't need this set, just print each jar as you find it. That should also make the order more predictable.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1152#discussion_r370768345", "createdAt": "2020-01-24T18:07:06Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/LinkageCheckerMain.java", "diffHunk": "@@ -82,6 +86,20 @@ public static void main(String[] arguments)\n \n     System.out.println(SymbolProblem.formatSymbolProblems(symbolProblems));\n \n+    if (classPathResult != null && !symbolProblems.isEmpty()) {\n+      ImmutableSet.Builder<Path> problematicJars = ImmutableSet.builder();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe7d13a8ea02b5dd47dca2c7cba3db72dabd8ad6"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MTkwNzQ3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1152#pullrequestreview-348190747", "createdAt": "2020-01-24T19:57:32Z", "commit": {"oid": "fe7d13a8ea02b5dd47dca2c7cba3db72dabd8ad6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eeb7cec3998891f0a39d1ba222f1acbfccd51fd4", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/eeb7cec3998891f0a39d1ba222f1acbfccd51fd4", "committedDate": "2020-01-24T20:12:27Z", "message": "Merge branch 'master' into problematic_jars"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1290, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}