{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1ODI1NzM3", "number": 1283, "reviewThreads": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQyMToyNzozOVrODmeBPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxOToyNToxN1rODnNy8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxNjY0MzE4OnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQyMToyNzozOVrOFz5-5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQyMToyNzozOVrOFz5-5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk3MTY4Nw==", "bodyText": "The package name of this library is strange. This library org.relaxng:jing is from https://relaxng.org/jclark/api/jing/index.html\n\nYou can use Jing's native API.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r389971687", "createdAt": "2020-03-09T21:27:39Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -17,8 +17,14 @@\n package com.google.cloud.tools.opensource.classpath;\n \n import com.google.common.collect.ImmutableList;\n+import com.thaiopensource.util.SinglePropertyMap;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxNjY1MDA1OnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQyMTozMDoxMVrOFz6DNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxOTo0OTowMlrOF0efog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk3Mjc5MQ==", "bodyText": "I'm really not convinced that we want to do this when processing the documents.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r389972791", "createdAt": "2020-03-09T21:30:11Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,11 +68,25 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    // DraconianErrorHandler throws SAXException upon invalid structure\n+    ValidationDriver validationDriver =", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDU2OTg5MA==", "bodyText": "Memo:\nCost\n\nperformance for high qps services. (not this case)\ntoo restrictive. For example, users cannot put their exclusion files in pom.xml.\nadding dependencies. (fine)\nadding validation makes a system more fragile", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r390569890", "createdAt": "2020-03-10T19:49:02Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,11 +68,25 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    // DraconianErrorHandler throws SAXException upon invalid structure\n+    ValidationDriver validationDriver =", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk3Mjc5MQ=="}, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMjc1OTM0OnYy", "diffSide": "RIGHT", "path": "dependencies/pom.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMjoyMjoxOVrOF00oeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1MDoxM1rOF06a6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzMjYwMg==", "bodyText": "Can you find a license for this? I don't see one anywhere. I think it's BSD but I don't see a statement about that.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r390932602", "createdAt": "2020-03-11T12:22:19Z", "author": {"login": "elharo"}, "path": "dependencies/pom.xml", "diffHunk": "@@ -79,6 +79,11 @@\n       <artifactId>httpclient</artifactId>\n       <version>4.5.12</version>\n     </dependency>\n+    <dependency>\n+      <groupId>org.relaxng</groupId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAyNzQzMw==", "bodyText": "Found in https://search.maven.org/artifact/org.relaxng/jing/20181222/jar\n    <license>\n      <name>3-clause BSD license</name>\n      <url>https://github.com/relaxng/jing-trang/blob/master/copying.txt</url>\n      <distribution>repo</distribution>\n    </license>", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391027433", "createdAt": "2020-03-11T14:50:13Z", "author": {"login": "suztomo"}, "path": "dependencies/pom.xml", "diffHunk": "@@ -79,6 +79,11 @@\n       <artifactId>httpclient</artifactId>\n       <version>4.5.12</version>\n     </dependency>\n+    <dependency>\n+      <groupId>org.relaxng</groupId>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzMjYwMg=="}, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMjc3Mjk3OnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMjoyNjozNFrOF00wqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1NToxM1rOF06prg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzNDY5OQ==", "bodyText": "You might want to extract all this into a helper method, just for clarity.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r390934699", "createdAt": "2020-03-11T12:26:34Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,11 +68,25 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    // DraconianErrorHandler throws SAXException upon invalid structure", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzMTIxNA==", "bodyText": "Nice idea. Updated.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391031214", "createdAt": "2020-03-11T14:55:13Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,11 +68,25 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    // DraconianErrorHandler throws SAXException upon invalid structure", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzNDY5OQ=="}, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMjc3Mzc0OnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/resources/linkage-checker-exclusion-relax-ng.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMjoyNjo1MFrOF00xJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1NjozN1rOF06t5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzNDgyMQ==", "bodyText": "copyright", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r390934821", "createdAt": "2020-03-11T12:26:50Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/resources/linkage-checker-exclusion-relax-ng.xml", "diffHunk": "@@ -0,0 +1,56 @@\n+<element name=\"LinkageCheckerFilter\" xmlns=\"http://relaxng.org/ns/structure/1.0\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzMjI5NA==", "bodyText": "Added.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391032294", "createdAt": "2020-03-11T14:56:37Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/resources/linkage-checker-exclusion-relax-ng.xml", "diffHunk": "@@ -0,0 +1,56 @@\n+<element name=\"LinkageCheckerFilter\" xmlns=\"http://relaxng.org/ns/structure/1.0\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzNDgyMQ=="}, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMjc3NjI1OnYy", "diffSide": "RIGHT", "path": "dependencies/src/test/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParserTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMjoyNzo0NVrOF00y0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1ODozNFrOF06zlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzNTI0OA==", "bodyText": "In this pattern, we sometimes name the exception expected", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r390935248", "createdAt": "2020-03-11T12:27:45Z", "author": {"login": "elharo"}, "path": "dependencies/src/test/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParserTest.java", "diffHunk": "@@ -192,15 +192,44 @@ public void testParse_sourceAndTarget_unmatch()\n   }\n \n   @Test\n-  public void testParse_namespaceException() throws URISyntaxException, IOException, SAXException {\n+  public void testParse_namespaceException() throws URISyntaxException, SAXException, IOException {\n     Path exclusionFile = absolutePathOfResource(\"exclusion-sample-rules/target-with-namespace.xml\");\n     try {\n       ImmutableList<LinkageErrorMatcher> matchers = ExclusionFileParser.parse(exclusionFile);\n       fail();\n-    } catch (SAXException ex) {\n+    } catch (SAXParseException ex) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzMzc0OA==", "bodyText": "That's more explanatory. Updated.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391033748", "createdAt": "2020-03-11T14:58:34Z", "author": {"login": "suztomo"}, "path": "dependencies/src/test/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParserTest.java", "diffHunk": "@@ -192,15 +192,44 @@ public void testParse_sourceAndTarget_unmatch()\n   }\n \n   @Test\n-  public void testParse_namespaceException() throws URISyntaxException, IOException, SAXException {\n+  public void testParse_namespaceException() throws URISyntaxException, SAXException, IOException {\n     Path exclusionFile = absolutePathOfResource(\"exclusion-sample-rules/target-with-namespace.xml\");\n     try {\n       ImmutableList<LinkageErrorMatcher> matchers = ExclusionFileParser.parse(exclusionFile);\n       fail();\n-    } catch (SAXException ex) {\n+    } catch (SAXParseException ex) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzNTI0OA=="}, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMjc3ODAzOnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/resources/linkage-checker-exclusion-relax-ng.xml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMjoyODoyMFrOF00z7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNDo1NzoxOFrOF06v6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzNTUzMg==", "bodyText": "indent +2", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r390935532", "createdAt": "2020-03-11T12:28:20Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/resources/linkage-checker-exclusion-relax-ng.xml", "diffHunk": "@@ -0,0 +1,56 @@\n+<element name=\"LinkageCheckerFilter\" xmlns=\"http://relaxng.org/ns/structure/1.0\">\n+  <zeroOrMore>\n+    <element name=\"LinkageError\">\n+      <interleave>\n+        <optional>\n+          <element name=\"Target\">\n+            <choice>\n+              <element name=\"Package\">\n+                <attribute name=\"name\">\n+                  <text/>\n+                </attribute>\n+              </element>\n+              <element name=\"Class\">\n+                <attribute name=\"name\">\n+                  <text/>\n+                </attribute>\n+              </element>\n+              <element name=\"Method\">\n+                <attribute name=\"name\">\n+                  <text/>\n+                </attribute>\n+                <attribute name=\"className\">\n+                  <text/>\n+                </attribute>\n+              </element>\n+              <element name=\"Field\">\n+                <attribute name=\"name\">\n+                  <text/>\n+                </attribute>\n+                <attribute name=\"className\">\n+                  <text/>\n+                </attribute>\n+              </element>\n+            </choice>\n+          </element>\n+        </optional>\n+        <optional>\n+        <element name=\"Source\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzMjgxMA==", "bodyText": "Fixed.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391032810", "createdAt": "2020-03-11T14:57:18Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/resources/linkage-checker-exclusion-relax-ng.xml", "diffHunk": "@@ -0,0 +1,56 @@\n+<element name=\"LinkageCheckerFilter\" xmlns=\"http://relaxng.org/ns/structure/1.0\">\n+  <zeroOrMore>\n+    <element name=\"LinkageError\">\n+      <interleave>\n+        <optional>\n+          <element name=\"Target\">\n+            <choice>\n+              <element name=\"Package\">\n+                <attribute name=\"name\">\n+                  <text/>\n+                </attribute>\n+              </element>\n+              <element name=\"Class\">\n+                <attribute name=\"name\">\n+                  <text/>\n+                </attribute>\n+              </element>\n+              <element name=\"Method\">\n+                <attribute name=\"name\">\n+                  <text/>\n+                </attribute>\n+                <attribute name=\"className\">\n+                  <text/>\n+                </attribute>\n+              </element>\n+              <element name=\"Field\">\n+                <attribute name=\"name\">\n+                  <text/>\n+                </attribute>\n+                <attribute name=\"className\">\n+                  <text/>\n+                </attribute>\n+              </element>\n+            </choice>\n+          </element>\n+        </optional>\n+        <optional>\n+        <element name=\"Source\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzNTUzMg=="}, "originalCommit": {"oid": "7ffcf9d0984007f5f11b7d20aa25dc7a7193e60a"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyMzQxNDYxOnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/resources/linkage-checker-exclusion-relax-ng.xml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNTowMzozN1rOF07Cyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNTowMzozN1rOF07Cyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzNzY0Mg==", "bodyText": "Added copyright", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391037642", "createdAt": "2020-03-11T15:03:37Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/resources/linkage-checker-exclusion-relax-ng.xml", "diffHunk": "@@ -0,0 +1,71 @@\n+<!--\n+  ~ Copyright 2020 Google LLC.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "166d155651ac8e297b8a9b92cd7bd78ac318edfe"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNDEzMTAwOnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNzo0NzowM1rOF1CHJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxODowMjoxNVrOF1Csdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE1MzQ0Ng==", "bodyText": "why convert to a File? Can we stick to Paths all the way through?", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391153446", "createdAt": "2020-03-11T17:47:03Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,12 +68,29 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    File exclusion = exclusionFile.toFile();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "166d155651ac8e297b8a9b92cd7bd78ac318edfe"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE2Mjk5OA==", "bodyText": "Updated to use Files.newInputStream.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391162998", "createdAt": "2020-03-11T18:02:15Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,12 +68,29 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    File exclusion = exclusionFile.toFile();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE1MzQ0Ng=="}, "originalCommit": {"oid": "166d155651ac8e297b8a9b92cd7bd78ac318edfe"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNDE0MTg1OnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNzo0OTozOVrOF1CNvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxODoxMToxM1rOF1DAOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE1NTEzNQ==", "bodyText": "If you call inputSource.setSystemId(path.toURI()) or some such thing here, error reporting will improve.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391155135", "createdAt": "2020-03-11T17:49:39Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,12 +68,29 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    File exclusion = exclusionFile.toFile();\n+    validate(exclusion);\n+\n     XMLReader xmlReader = XMLReaderFactory.createXMLReader();\n     ExclusionFileHandler handler = new ExclusionFileHandler();\n     xmlReader.setContentHandler(handler);\n \n-    InputSource inputSource = new InputSource(new FileInputStream(exclusionFile.toFile()));\n+    InputSource inputSource = new InputSource(new FileInputStream(exclusion));\n     xmlReader.parse(inputSource);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "166d155651ac8e297b8a9b92cd7bd78ac318edfe"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE2ODA1Ng==", "bodyText": "Updated.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391168056", "createdAt": "2020-03-11T18:11:13Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,12 +68,29 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    File exclusion = exclusionFile.toFile();\n+    validate(exclusion);\n+\n     XMLReader xmlReader = XMLReaderFactory.createXMLReader();\n     ExclusionFileHandler handler = new ExclusionFileHandler();\n     xmlReader.setContentHandler(handler);\n \n-    InputSource inputSource = new InputSource(new FileInputStream(exclusionFile.toFile()));\n+    InputSource inputSource = new InputSource(new FileInputStream(exclusion));\n     xmlReader.parse(inputSource);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE1NTEzNQ=="}, "originalCommit": {"oid": "166d155651ac8e297b8a9b92cd7bd78ac318edfe"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNDE0NDI1OnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNzo1MDoxNlrOF1CPSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxODowMjoyNVrOF1Cs4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE1NTUyOA==", "bodyText": "Files.newInputStream(path)", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391155528", "createdAt": "2020-03-11T17:50:16Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,12 +68,29 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    File exclusion = exclusionFile.toFile();\n+    validate(exclusion);\n+\n     XMLReader xmlReader = XMLReaderFactory.createXMLReader();\n     ExclusionFileHandler handler = new ExclusionFileHandler();\n     xmlReader.setContentHandler(handler);\n \n-    InputSource inputSource = new InputSource(new FileInputStream(exclusionFile.toFile()));\n+    InputSource inputSource = new InputSource(new FileInputStream(exclusion));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "166d155651ac8e297b8a9b92cd7bd78ac318edfe"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE2MzEwNA==", "bodyText": "Updated.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391163104", "createdAt": "2020-03-11T18:02:25Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,12 +68,29 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    File exclusion = exclusionFile.toFile();\n+    validate(exclusion);\n+\n     XMLReader xmlReader = XMLReaderFactory.createXMLReader();\n     ExclusionFileHandler handler = new ExclusionFileHandler();\n     xmlReader.setContentHandler(handler);\n \n-    InputSource inputSource = new InputSource(new FileInputStream(exclusionFile.toFile()));\n+    InputSource inputSource = new InputSource(new FileInputStream(exclusion));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE1NTUyOA=="}, "originalCommit": {"oid": "166d155651ac8e297b8a9b92cd7bd78ac318edfe"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNDE0NzQ3OnYy", "diffSide": "RIGHT", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNzo1MToxM1rOF1CRaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxODoxODowNFrOF1DQvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE1NjA3NQ==", "bodyText": "This reads the file twice: once to validate and once to parse. Can this be combined into a single pass?", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391156075", "createdAt": "2020-03-11T17:51:13Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,12 +68,29 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    File exclusion = exclusionFile.toFile();\n+    validate(exclusion);\n+\n     XMLReader xmlReader = XMLReaderFactory.createXMLReader();\n     ExclusionFileHandler handler = new ExclusionFileHandler();\n     xmlReader.setContentHandler(handler);\n \n-    InputSource inputSource = new InputSource(new FileInputStream(exclusionFile.toFile()));\n+    InputSource inputSource = new InputSource(new FileInputStream(exclusion));\n     xmlReader.parse(inputSource);\n     return handler.getMatchers();\n   }\n+\n+  private static void validate(File file) throws IOException, SAXException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "166d155651ac8e297b8a9b92cd7bd78ac318edfe"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE3MjI4Ng==", "bodyText": "I didn't think of a way to do that. ValidationDriver does not give a method related to XMLReader.\nI thought reusing InputSource, but it's not intended to be reused:\n\nso applications should not attempt to re-use such streams after they have been handed to a parser.\n\nhttps://docs.oracle.com/javase/7/docs/api/org/xml/sax/InputSource.html#setPublicId(java.lang.String)", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391172286", "createdAt": "2020-03-11T18:18:04Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/ExclusionFileParser.java", "diffHunk": "@@ -62,12 +68,29 @@\n   static ImmutableList<LinkageErrorMatcher> parse(Path exclusionFile)\n       throws SAXException, IOException {\n \n+    File exclusion = exclusionFile.toFile();\n+    validate(exclusion);\n+\n     XMLReader xmlReader = XMLReaderFactory.createXMLReader();\n     ExclusionFileHandler handler = new ExclusionFileHandler();\n     xmlReader.setContentHandler(handler);\n \n-    InputSource inputSource = new InputSource(new FileInputStream(exclusionFile.toFile()));\n+    InputSource inputSource = new InputSource(new FileInputStream(exclusion));\n     xmlReader.parse(inputSource);\n     return handler.getMatchers();\n   }\n+\n+  private static void validate(File file) throws IOException, SAXException {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTE1NjA3NQ=="}, "originalCommit": {"oid": "166d155651ac8e297b8a9b92cd7bd78ac318edfe"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQyNDQ3MDg4OnYy", "diffSide": "RIGHT", "path": "dependencies/pom.xml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxOToyNToxN1rOF1FfmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxOToyNToxN1rOF1FfmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTIwODg1Nw==", "bodyText": "http://iso-relax.sourceforge.net/ :  the MIT license", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1283#discussion_r391208857", "createdAt": "2020-03-11T19:25:17Z", "author": {"login": "suztomo"}, "path": "dependencies/pom.xml", "diffHunk": "@@ -79,6 +79,16 @@\n       <artifactId>httpclient</artifactId>\n       <version>4.5.12</version>\n     </dependency>\n+    <dependency>\n+      <groupId>org.relaxng</groupId>\n+      <artifactId>jing</artifactId>\n+      <version>20181222</version>\n+    </dependency>\n+    <dependency>\n+      <groupId>isorelax</groupId>\n+      <artifactId>isorelax</artifactId>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45aa358c64d2f70bb5c4e3e8bf05ed645849b53f"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2666, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}