{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwMTkwNDMw", "number": 1500, "title": "add method to get verbose graph for list of artifacts", "bodyText": "@suztomo @ian-lavallee", "createdAt": "2020-06-25T18:35:12Z", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1500", "merged": true, "mergeCommit": {"oid": "1af7a0ae7f8df41c1ba433cc16073d8ada05909c"}, "closed": true, "closedAt": "2020-07-07T21:06:13Z", "author": {"login": "elharo"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuzCqgAH2gAyNDQwMTkwNDMwOjZlYzc3ZjExNzc1OTk4NGI3YmM1MjJkYzE1MmY5YzlhYmQxYjAwZGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyqiggAH2gAyNDQwMTkwNDMwOjk1YjM4MzBjYzc2ZmRhOTcyN2FjYjc0ZjY3ZDRhMjA0NjQxMjRhYTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6ec77f117759984b7bc522dc152f9c9abd1b00df", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/6ec77f117759984b7bc522dc152f9c9abd1b00df", "committedDate": "2020-06-25T18:34:40Z", "message": "add method to get verbose graph for list of artifacts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MzU5MzI2", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1500#pullrequestreview-438359326", "createdAt": "2020-06-26T14:49:08Z", "commit": {"oid": "6ec77f117759984b7bc522dc152f9c9abd1b00df"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNDo0OTowOFrOGpjw8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQxNDo0OTowOFrOGpjw8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjIzMDc3MQ==", "bodyText": "Shouldn't the tests assert that the whole graph is what we expect not just the first node and the amount of nodes?", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1500#discussion_r446230771", "createdAt": "2020-06-26T14:49:08Z", "author": {"login": "ian-lavallee"}, "path": "dependencies/src/test/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilderTest.java", "diffHunk": "@@ -199,6 +201,45 @@ public void testBuildLinkageCheckDependencyGraph_multipleArtifacts() {\n         secondElement.getLeaf().getArtifactId());\n   }\n \n+  @Test\n+  public void testBuildVerboseDependencyGraph_singleArtifact() {\n+    DependencyGraph graph =\n+        dependencyGraphBuilder.buildVerboseDependencyGraph(logging);\n+\n+    List<DependencyPath> list = graph.list();\n+    DependencyPath firstElement = list.get(0);\n+    Assert.assertEquals(\n+        \"commons-logging\",\n+        firstElement.getLeaf().getArtifactId());\n+    Assert.assertEquals(6, list.size()); // optional dependencies are included", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6ec77f117759984b7bc522dc152f9c9abd1b00df"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NDYyNDIz", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1500#pullrequestreview-438462423", "createdAt": "2020-06-26T17:12:30Z", "commit": {"oid": "6ec77f117759984b7bc522dc152f9c9abd1b00df"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fb2ba83832d064f6e60d4b01824e6c26f9c441b", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/1fb2ba83832d064f6e60d4b01824e6c26f9c441b", "committedDate": "2020-06-26T17:50:08Z", "message": "assert more of the graph"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5e48e2b1d29a3b4d530b1f9e1b475c7d6c9d335", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/c5e48e2b1d29a3b4d530b1f9e1b475c7d6c9d335", "committedDate": "2020-06-29T13:57:50Z", "message": "Merge branch 'master' into list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "acdd0b4865e72c48e0817fcf813db3d3a4d7de84", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/acdd0b4865e72c48e0817fcf813db3d3a4d7de84", "committedDate": "2020-06-29T15:24:27Z", "message": "Merge branch 'master' into list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15cf0e9ac4afe6ef554698abe857eb819658939d", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/15cf0e9ac4afe6ef554698abe857eb819658939d", "committedDate": "2020-06-30T18:06:49Z", "message": "Merge branch 'master' into list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79805079d3603f574a924bc17f7133bc7d67b800", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/79805079d3603f574a924bc17f7133bc7d67b800", "committedDate": "2020-07-06T10:58:55Z", "message": "Merge branch 'master' into list"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzMTkzMTcw", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1500#pullrequestreview-443193170", "createdAt": "2020-07-06T15:41:54Z", "commit": {"oid": "79805079d3603f574a924bc17f7133bc7d67b800"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNDU3OTM2", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1500#pullrequestreview-443457936", "createdAt": "2020-07-06T22:59:47Z", "commit": {"oid": "79805079d3603f574a924bc17f7133bc7d67b800"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMjo1OTo0N1rOGtpqBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMjo1OTo0N1rOGtpqBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDUyMTYwNQ==", "bodyText": "To follow Maven's default behavior, we need to include \"direct optional dependencies\" (depth 1).\norg.eclipse.aether.util.graph.selector.OptionalDependencySelector does that.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1500#discussion_r450521605", "createdAt": "2020-07-06T22:59:47Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/BanOptionalDependencySelector.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.cloud.tools.opensource.dependencies;\n+\n+import org.eclipse.aether.collection.DependencyCollectionContext;\n+import org.eclipse.aether.collection.DependencySelector;\n+import org.eclipse.aether.graph.Dependency;\n+\n+/**\n+ * A dependency selector that disallows all optional dependencies regardless of depth.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79805079d3603f574a924bc17f7133bc7d67b800"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2726cd9ca4ce63dd8e94aaeb074ef9bf0e4f875", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/a2726cd9ca4ce63dd8e94aaeb074ef9bf0e4f875", "committedDate": "2020-07-07T12:35:30Z", "message": "Merge branch 'master' into list"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MDAyNjE3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1500#pullrequestreview-444002617", "createdAt": "2020-07-07T15:25:19Z", "commit": {"oid": "a2726cd9ca4ce63dd8e94aaeb074ef9bf0e4f875"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNToyNToxOVrOGuD1uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxNToyNToxOVrOGuD1uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk1MDU4Nw==", "bodyText": "That would be only for a specific artifact. This is for a lost of artifacts so all optional dependencies are effectively transitive.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1500#discussion_r450950587", "createdAt": "2020-07-07T15:25:19Z", "author": {"login": "elharo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/BanOptionalDependencySelector.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.google.cloud.tools.opensource.dependencies;\n+\n+import org.eclipse.aether.collection.DependencyCollectionContext;\n+import org.eclipse.aether.collection.DependencySelector;\n+import org.eclipse.aether.graph.Dependency;\n+\n+/**\n+ * A dependency selector that disallows all optional dependencies regardless of depth.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDUyMTYwNQ=="}, "originalCommit": {"oid": "79805079d3603f574a924bc17f7133bc7d67b800"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "634f4a8e378f873ee1043b522c8af4bc049fdf1d", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/634f4a8e378f873ee1043b522c8af4bc049fdf1d", "committedDate": "2020-07-07T18:21:37Z", "message": "Merge branch 'master' into list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95b3830cc76fda9727acb74f67d4a20464124aa2", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/95b3830cc76fda9727acb74f67d4a20464124aa2", "committedDate": "2020-07-07T18:56:00Z", "message": "Merge branch 'master' into list"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 228, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}