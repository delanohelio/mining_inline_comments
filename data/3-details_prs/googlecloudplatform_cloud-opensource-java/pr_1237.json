{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3OTIxODAw", "number": 1237, "title": "DependencyTreeFormatter to respect scopes and optional flags", "bodyText": "Revise of #1229 .\nDependencyTreeFormatter was assuming every dependency has \"compile\" scope and optional false:\n      parentArtifactPath.forEach(\n          parentArtifactPathNode ->\n              parentDependencyPath.add(new Dependency(parentArtifactPathNode, \"compile\", false)));\n\nhttps://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1237/files#diff-e825ccadbd98c809005839481296b814L84\nThis caused incorrect tree output when a dependency is not compile scope or optional=true.", "createdAt": "2020-02-20T19:00:24Z", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1237", "merged": true, "mergeCommit": {"oid": "658610ef75508963e11dad42f3fea11cd41d1405"}, "closed": true, "closedAt": "2020-02-20T19:49:26Z", "author": {"login": "suztomo"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGP347gH2gAyMzc3OTIxODAwOjIyMjBiZTY2MDI3MGE0YzljN2I5NmUyYWIwNTM0NjgwMGU5M2RkMmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcGQYSLAFqTM2MjE3Njg2Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2220be660270a4c9c7b96e2ab05346800e93dd2a", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/2220be660270a4c9c7b96e2ab05346800e93dd2a", "committedDate": "2020-02-20T18:59:15Z", "message": "DependencyTreeFormatter to respect scope"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMTU2MTIy", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1237#pullrequestreview-362156122", "createdAt": "2020-02-20T19:03:31Z", "commit": {"oid": "2220be660270a4c9c7b96e2ab05346800e93dd2a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxOTowMzozMVrOFsfeGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMFQxOTowMzozMVrOFsfeGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjE5NzI3Mw==", "bodyText": "This test was failing before this fix. DependencyTreeFormatter was ignoring scopes and optional flags (https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1237/files#diff-e825ccadbd98c809005839481296b814L84), while it was relying on equality of DependencyPath to find parent-child relationship from a Multimap.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1237#discussion_r382197273", "createdAt": "2020-02-20T19:03:31Z", "author": {"login": "suztomo"}, "path": "dependencies/src/test/java/com/google/cloud/tools/opensource/dependencies/DependencyTreeFormatterTest.java", "diffHunk": "@@ -73,4 +73,24 @@ public void testDependencyTree() {\n         \"The dependency should be output as tree with indentation\",\n         expectedTreeOutput, actualTreeOutput);\n   }\n+\n+  @Test\n+  public void testDependencyTree_scopeAndOptionalFlag() {\n+    List<DependencyPath> dependencyPathList = new ArrayList<>();\n+\n+    DependencyPath path1 = new DependencyPath();\n+    path1.add(new Dependency(new DefaultArtifact(\"io.grpc:grpc-auth:jar:1.15.0\"), \"compile\", true));\n+    dependencyPathList.add(path1);\n+\n+    DependencyPath path2 = new DependencyPath();\n+    path2.add(new Dependency(new DefaultArtifact(\"io.grpc:grpc-auth:jar:1.15.0\"), \"compile\", true));\n+    path2.add(\n+        new Dependency(new DefaultArtifact(\"io.grpc:grpc-core:jar:1.15.0\"), \"provided\", false));\n+    dependencyPathList.add(path2);\n+\n+    String actualTreeOutput = DependencyTreeFormatter.formatDependencyPaths(dependencyPathList);\n+    String expectedTreeOutput =\n+        \"  io.grpc:grpc-auth:jar:1.15.0\\n\" + \"    io.grpc:grpc-core:jar:1.15.0\\n\";\n+    Assert.assertEquals(expectedTreeOutput, actualTreeOutput);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2220be660270a4c9c7b96e2ab05346800e93dd2a"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7154645bf63ea9e66b3957258822c6aa78b6642c", "author": {"user": {"login": "suztomo", "name": "Tomo Suzuki"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/7154645bf63ea9e66b3957258822c6aa78b6642c", "committedDate": "2020-02-20T19:10:49Z", "message": "javadoc"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyMTc2ODY3", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1237#pullrequestreview-362176867", "createdAt": "2020-02-20T19:34:38Z", "commit": {"oid": "7154645bf63ea9e66b3957258822c6aa78b6642c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 485, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}