{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzNjgxNjEx", "number": 1469, "title": "Build dependency graph without optional dependencies", "bodyText": "@suztomo Building the infrastructure for #1464 in parallel without yet modifying existing behavior", "createdAt": "2020-06-12T13:31:56Z", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1469", "merged": true, "mergeCommit": {"oid": "2907ea34b512a4a19e94b8c12847f2b81f986980"}, "closed": true, "closedAt": "2020-06-12T16:20:38Z", "author": {"login": "elharo"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqQ2NyAH2gAyNDMzNjgxNjExOmEzN2ZmYWY4MjRkYmRiMTlmYWFkNjg4OWY0YzcxY2EwY2UzMTdmYzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqk3_9gH2gAyNDMzNjgxNjExOjdiNzI0NjVkNDhmZmJjNTMyNTQxMzAxMjQ3MWNmZTlkMDViOWZkZWQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a37ffaf824dbdb19faad6889f4c71ca0ce317fc7", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/a37ffaf824dbdb19faad6889f4c71ca0ce317fc7", "committedDate": "2020-06-11T16:28:36Z", "message": "add test to expose current behavior arond optional dependencies"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52c86b7ca2bd9fcb4521c5c3baf59fff52e54d07", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/52c86b7ca2bd9fcb4521c5c3baf59fff52e54d07", "committedDate": "2020-06-11T16:35:32Z", "message": "add test for direct optional dependency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd15786b046acad11e0d173477799191ec5f4f57", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/cd15786b046acad11e0d173477799191ec5f4f57", "committedDate": "2020-06-12T12:49:12Z", "message": "Merge branch 'master' into opt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89410742ed5716b272dbbb0304917d8bf72316ed", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/89410742ed5716b272dbbb0304917d8bf72316ed", "committedDate": "2020-06-12T13:28:30Z", "message": "add method to get a dependency graph with multiple versions and without transitive optional dependencies"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5NzU5MzY4", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1469#pullrequestreview-429759368", "createdAt": "2020-06-12T13:54:12Z", "commit": {"oid": "89410742ed5716b272dbbb0304917d8bf72316ed"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxMzo1NDoxMlrOGjE1Ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQxNDowMTo0MlrOGjFI2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQzMjQ2Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * provided dependencies. t does includes direct optional dependencies of the root node but not\n          \n          \n            \n               * provided dependencies. It does include direct optional dependencies of the root node but not", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1469#discussion_r439432467", "createdAt": "2020-06-12T13:54:12Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java", "diffHunk": "@@ -137,6 +137,25 @@ public DependencyGraph buildFullDependencyGraph(List<Artifact> artifacts) {\n     DefaultRepositorySystemSession session = RepositoryUtility.newSessionForFullDependency(system);\n     return buildDependencyGraph(dependencyNodes, session);\n   }\n+  \n+  /**\n+   * Finds the full compile time, transitive dependency graph including conflicting versions and\n+   * provided dependencies. t does includes direct optional dependencies of the root node but not", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89410742ed5716b272dbbb0304917d8bf72316ed"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQzNTMzOQ==", "bodyText": "I feel \"verbose\" sounds strange. But I don't think of better one. Good for now.", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1469#discussion_r439435339", "createdAt": "2020-06-12T13:58:17Z", "author": {"login": "suztomo"}, "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java", "diffHunk": "@@ -137,6 +137,25 @@ public DependencyGraph buildFullDependencyGraph(List<Artifact> artifacts) {\n     DefaultRepositorySystemSession session = RepositoryUtility.newSessionForFullDependency(system);\n     return buildDependencyGraph(dependencyNodes, session);\n   }\n+  \n+  /**\n+   * Finds the full compile time, transitive dependency graph including conflicting versions and\n+   * provided dependencies. t does includes direct optional dependencies of the root node but not\n+   * optional dependencies of transitive dependencies.\n+   *\n+   * <p>In the event of I/O errors, missing artifacts, and other problems, it can return an\n+   * incomplete graph. Each node's dependencies are resolved recursively. The scope of a dependency\n+   * does not affect the scope of its children's dependencies. Provided and optional dependencies\n+   * are not treated differently than any other dependency.\n+   *\n+   * @param dependency the root\n+   * @return the graph as built by Maven before dependency mediation\n+   */\n+  DependencyGraph buildVerboseDependencyGraph(Dependency dependency) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89410742ed5716b272dbbb0304917d8bf72316ed"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQzNzUzMQ==", "bodyText": "Truth.assertThat(paths).containsNoDuplicates();", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1469#discussion_r439437531", "createdAt": "2020-06-12T14:01:42Z", "author": {"login": "suztomo"}, "path": "dependencies/src/test/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilderTest.java", "diffHunk": "@@ -115,6 +131,22 @@ public void testGetCompleteDependencies() {\n     int guavaCount = countArtifactId(graph, \"guava\");\n     Assert.assertEquals(29, guavaCount);\n   }\n+  \n+  @Test\n+  public void testGetVerboseDependencies() {\n+    Dependency dependency = new Dependency(datastore, \"compile\");\n+    DependencyGraph graph = dependencyGraphBuilder.buildVerboseDependencyGraph(dependency);\n+    List<DependencyPath> paths = graph.list();\n+    Assert.assertTrue(paths.size() > 10);\n+\n+    // verify we didn't double count anything\n+    HashSet<DependencyPath> noDups = new HashSet<>(paths);\n+    Assert.assertEquals(paths.size(), noDups.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89410742ed5716b272dbbb0304917d8bf72316ed"}, "originalPosition": 58}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "349ccbf13ad1a15d30a7ab0cce399957c018c9d1", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/349ccbf13ad1a15d30a7ab0cce399957c018c9d1", "committedDate": "2020-06-12T14:45:52Z", "message": "code review"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5ODE5NzAw", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1469#pullrequestreview-429819700", "createdAt": "2020-06-12T15:07:35Z", "commit": {"oid": "349ccbf13ad1a15d30a7ab0cce399957c018c9d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5ODE5Nzkx", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1469#pullrequestreview-429819791", "createdAt": "2020-06-12T15:07:43Z", "commit": {"oid": "349ccbf13ad1a15d30a7ab0cce399957c018c9d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a543105536b073d4eb34612591db6729e8010b6", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/4a543105536b073d4eb34612591db6729e8010b6", "committedDate": "2020-06-12T15:16:55Z", "message": "Merge branch 'master' into opt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b72465d48ffbc5325413012471cfe9d05b9fded", "author": {"user": {"login": "elharo", "name": "Elliotte Rusty Harold"}}, "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/7b72465d48ffbc5325413012471cfe9d05b9fded", "committedDate": "2020-06-12T15:48:39Z", "message": "unused import"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 205, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}