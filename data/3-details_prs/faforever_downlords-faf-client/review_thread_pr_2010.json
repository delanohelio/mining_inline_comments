{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzNTc1Nzgz", "number": 2010, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMjo1ODoyNFrOE2E4PA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNTowNDoxOVrOE2XFHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MTM4NDkyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/faforever/client/chat/ChatUserService.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQxMjo1ODoyNFrOHutDrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNlQyMjowNToxNVrOHu-__w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODczNDc2Nw==", "bodyText": "This would be better if the i18n key was an instance variable of the enum. See RatingMode.java for an example.", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r518734767", "createdAt": "2020-11-06T12:58:24Z", "author": {"login": "Sheikah45"}, "path": "src/main/java/com/faforever/client/chat/ChatUserService.java", "diffHunk": "@@ -128,6 +130,15 @@ public void onChatUserGameChange(ChatUserGameChangeEvent event) {\n       chatChannelUser.setStatusImage(null);\n     }\n   }\n+\n+  private String getLocalizedStatusGame(PlayerStatus status) {\n+    return switch (status) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "17602d7c0cdc1cd830c3d4330076d88b5d10659f"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODk5NDkxMQ==", "bodyText": "Okay, I can do it better, but what about a separate IDLE variable that does not have a string? I do not want to put an empty string '' or null for this because a man will have to write extra checks for an empty string or null before getting a localized string else we will get exception NoSuchMessageException.\nHow about adding this check to the get(String, Object...) method of I18n class? Like:\npublic String get(String key, Object... args) {\n    return key == null || key.isEmpty() ? null : get(userSpecificLocale, key, args);\n  }\nOr to implement a method like:\npublic String tryGet(String key, Object... args) {\n    try {\n      return get(key, args);\n    } catch (NoSuchMessageException e) {\n      return null;\n    }\n  }\nWhat do you think about it?", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r518994911", "createdAt": "2020-11-06T20:42:28Z", "author": {"login": "ivan-gryzunov"}, "path": "src/main/java/com/faforever/client/chat/ChatUserService.java", "diffHunk": "@@ -128,6 +130,15 @@ public void onChatUserGameChange(ChatUserGameChangeEvent event) {\n       chatChannelUser.setStatusImage(null);\n     }\n   }\n+\n+  private String getLocalizedStatusGame(PlayerStatus status) {\n+    return switch (status) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODczNDc2Nw=="}, "originalCommit": {"oid": "17602d7c0cdc1cd830c3d4330076d88b5d10659f"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTAyODczNQ==", "bodyText": "I think it would be best to just give idle a message that way if it is used in the future it can be as well.", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519028735", "createdAt": "2020-11-06T22:05:15Z", "author": {"login": "Sheikah45"}, "path": "src/main/java/com/faforever/client/chat/ChatUserService.java", "diffHunk": "@@ -128,6 +130,15 @@ public void onChatUserGameChange(ChatUserGameChangeEvent event) {\n       chatChannelUser.setStatusImage(null);\n     }\n   }\n+\n+  private String getLocalizedStatusGame(PlayerStatus status) {\n+    return switch (status) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODczNDc2Nw=="}, "originalCommit": {"oid": "17602d7c0cdc1cd830c3d4330076d88b5d10659f"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MzQ3ODAwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QwMDowMTo1MlrOHvBB4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QwMDowMTo1MlrOHvBB4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA2MTk4NQ==", "bodyText": "You can just use this no need for the switch statement\ngameStatusMenu.setText(i18n.get(status.getI18nKey()));", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519061985", "createdAt": "2020-11-07T00:01:52Z", "author": {"login": "Sheikah45"}, "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "diffHunk": "@@ -209,19 +209,13 @@ private void updateGameStatusMenuText(PlayerStatus status) {\n       return;\n     }\n \n-    switch (status) {\n-      case PLAYING:\n-        gameStatusMenu.setText(i18n.get(\"game.gameStatus.playing\"));\n-        break;\n-      case LOBBYING:\n-        gameStatusMenu.setText(i18n.get(\"game.gameStatus.lobby\"));\n-        break;\n-      case IDLE:\n-        gameStatusMenu.setText(i18n.get(\"game.gameStatus.none\"));\n-        break;\n-      default:\n-        throw new ProgrammingError(\"Uncovered player status: \" + status);\n-    }\n+    String key =  switch (status) {\n+      case PLAYING -> PLAYING.getI18nKey();\n+      case LOBBYING -> LOBBYING.getI18nKey();\n+      case IDLE -> IDLE.getI18nKey();\n+      default -> throw new ProgrammingError(\"Uncovered player status: \" + status);\n+    };\n+    gameStatusMenu.setText(i18n.get(key));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "509317d6ec57fb6a0e1ef560d2959c56eaf48eb6"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1MzU1OTQzOnYy", "diffSide": "RIGHT", "path": "src/main/resources/i18n/messages_nl.properties", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QwMTowMzoyNlrOHvBu7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QwMTowMzoyNlrOHvBu7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA3MzUxNw==", "bodyText": "If this isnt translated it shouldnt be here", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519073517", "createdAt": "2020-11-07T01:03:26Z", "author": {"login": "Sheikah45"}, "path": "src/main/resources/i18n/messages_nl.properties", "diffHunk": "@@ -197,6 +197,7 @@ game.full.action = Klik om spel te openen\n game.mods.twoAndMore = {0} en {1,number,\\#} meer\n game.gameStatus = Spel status\n game.gameStatus.playing = Spelen\n+game.gameStatus.hosting = Hosting", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a490255f77696a11d79c884dc2a2b7f22f61005a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1NDM2NDMzOnYy", "diffSide": "RIGHT", "path": "src/main/resources/i18n/messages_ru.properties", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNTowMDowOFrOHvIl4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QyMDowMDoxMFrOHvKPNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NTg5MQ==", "bodyText": "no translations are ever made on github!!! poeditor.com", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519185891", "createdAt": "2020-11-07T15:00:08Z", "author": {"login": "1-alex98"}, "path": "src/main/resources/i18n/messages_ru.properties", "diffHunk": "@@ -205,6 +205,7 @@ game.full.action = \u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0438\u0433\u0440\u0443\n game.mods.twoAndMore = {0} \u0438 {1,number,\\#} \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435\n game.gameStatus = \u0421\u0442\u0430\u0442\u0443\u0441\n game.gameStatus.playing = \u0418\u0433\u0440\u0430\u0435\u0442\n+game.gameStatus.hosting = \u0425\u043e\u0441\u0442\u0438\u0442 \u0438\u0433\u0440\u0443", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a490255f77696a11d79c884dc2a2b7f22f61005a"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTIxMjg1Mw==", "bodyText": "Sorry. Now I understand how it works. I will remove all changes excluding the messages.properties file.", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519212853", "createdAt": "2020-11-07T20:00:10Z", "author": {"login": "ivan-gryzunov"}, "path": "src/main/resources/i18n/messages_ru.properties", "diffHunk": "@@ -205,6 +205,7 @@ game.full.action = \u041d\u0430\u0436\u043c\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043a\u0440\u044b\u0442\u044c \u0438\u0433\u0440\u0443\n game.mods.twoAndMore = {0} \u0438 {1,number,\\#} \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435\n game.gameStatus = \u0421\u0442\u0430\u0442\u0443\u0441\n game.gameStatus.playing = \u0418\u0433\u0440\u0430\u0435\u0442\n+game.gameStatus.hosting = \u0425\u043e\u0441\u0442\u0438\u0442 \u0438\u0433\u0440\u0443", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NTg5MQ=="}, "originalCommit": {"oid": "a490255f77696a11d79c884dc2a2b7f22f61005a"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1NDM2NTIyOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNTowMToyOFrOHvImSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNTowMjo0MFrOHvImsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NTk5NA==", "bodyText": "java fx tooltips are dangerous in terms of memory leaks. Especially here where content is frequently changed", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519185994", "createdAt": "2020-11-07T15:01:28Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "diffHunk": "@@ -70,14 +73,17 @@\n   private final WeakInvalidationListener weakFormatInvalidationListener;\n   private final WeakInvalidationListener weakColorPerUserInvalidationListener;\n \n+  public ImageView playerMapImage;\n   public ImageView playerStatusIndicator;\n+  protected Tooltip statusGameTooltip;\n+  protected Tooltip gameInfoTooltip;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a490255f77696a11d79c884dc2a2b7f22f61005a"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjA5OA==", "bodyText": "but you seem to take care of it", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519186098", "createdAt": "2020-11-07T15:02:40Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "diffHunk": "@@ -70,14 +73,17 @@\n   private final WeakInvalidationListener weakFormatInvalidationListener;\n   private final WeakInvalidationListener weakColorPerUserInvalidationListener;\n \n+  public ImageView playerMapImage;\n   public ImageView playerStatusIndicator;\n+  protected Tooltip statusGameTooltip;\n+  protected Tooltip gameInfoTooltip;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NTk5NA=="}, "originalCommit": {"oid": "a490255f77696a11d79c884dc2a2b7f22f61005a"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1NDM2NzAwOnYy", "diffSide": "RIGHT", "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNTowNDoxOVrOHvInLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QyMzowMjoyNlrOHvLUSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIyMA==", "bodyText": "Chat user items are in a recycler view. Meaning tons of them are created and destroyed while scrolling. So all this is safer if it runs on mouse over only", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519186220", "createdAt": "2020-11-07T15:04:19Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "diffHunk": "@@ -151,8 +151,72 @@ public void initialize() {\n     JavaFxUtil.bind(playerMapImage.visibleProperty(), Bindings.isNotNull(playerMapImage.imageProperty()));\n \n     updateFormat();\n+    addEventHandlersToPlayerMapImage();\n+  }\n+\n+  private void initializeTooltips() {\n+    userTooltip = new Tooltip();\n+    usernameLabel.setTooltip(userTooltip);\n+\n+    avatarTooltip = new Tooltip();\n+    avatarTooltip.setAnchorLocation(PopupWindow.AnchorLocation.CONTENT_TOP_LEFT);\n+    Tooltip.install(avatarImageView, avatarTooltip);\n+\n+    countryTooltip = new Tooltip();\n+    countryTooltip.showDelayProperty().set(Duration.millis(250));\n+    Tooltip.install(countryImageView, countryTooltip);\n+\n+    statusGameTooltip = new Tooltip();\n+    statusGameTooltip.setShowDuration(Duration.seconds(30));\n+    statusGameTooltip.setShowDelay(Duration.ZERO);\n+    statusGameTooltip.setHideDelay(Duration.ZERO);\n+    Tooltip.install(playerStatusIndicator, statusGameTooltip);\n   }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a490255f77696a11d79c884dc2a2b7f22f61005a"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjczMw==", "bodyText": "This was a change in the chat optimization so might not be related to this pr specifically and would probably need to be done in another pr.", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519186733", "createdAt": "2020-11-07T15:09:57Z", "author": {"login": "Sheikah45"}, "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "diffHunk": "@@ -151,8 +151,72 @@ public void initialize() {\n     JavaFxUtil.bind(playerMapImage.visibleProperty(), Bindings.isNotNull(playerMapImage.imageProperty()));\n \n     updateFormat();\n+    addEventHandlersToPlayerMapImage();\n+  }\n+\n+  private void initializeTooltips() {\n+    userTooltip = new Tooltip();\n+    usernameLabel.setTooltip(userTooltip);\n+\n+    avatarTooltip = new Tooltip();\n+    avatarTooltip.setAnchorLocation(PopupWindow.AnchorLocation.CONTENT_TOP_LEFT);\n+    Tooltip.install(avatarImageView, avatarTooltip);\n+\n+    countryTooltip = new Tooltip();\n+    countryTooltip.showDelayProperty().set(Duration.millis(250));\n+    Tooltip.install(countryImageView, countryTooltip);\n+\n+    statusGameTooltip = new Tooltip();\n+    statusGameTooltip.setShowDuration(Duration.seconds(30));\n+    statusGameTooltip.setShowDelay(Duration.ZERO);\n+    statusGameTooltip.setHideDelay(Duration.ZERO);\n+    Tooltip.install(playerStatusIndicator, statusGameTooltip);\n   }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIyMA=="}, "originalCommit": {"oid": "a490255f77696a11d79c884dc2a2b7f22f61005a"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTIxNjEzOA==", "bodyText": "I understand that there is no need to redo this code?", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519216138", "createdAt": "2020-11-07T20:38:52Z", "author": {"login": "ivan-gryzunov"}, "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "diffHunk": "@@ -151,8 +151,72 @@ public void initialize() {\n     JavaFxUtil.bind(playerMapImage.visibleProperty(), Bindings.isNotNull(playerMapImage.imageProperty()));\n \n     updateFormat();\n+    addEventHandlersToPlayerMapImage();\n+  }\n+\n+  private void initializeTooltips() {\n+    userTooltip = new Tooltip();\n+    usernameLabel.setTooltip(userTooltip);\n+\n+    avatarTooltip = new Tooltip();\n+    avatarTooltip.setAnchorLocation(PopupWindow.AnchorLocation.CONTENT_TOP_LEFT);\n+    Tooltip.install(avatarImageView, avatarTooltip);\n+\n+    countryTooltip = new Tooltip();\n+    countryTooltip.showDelayProperty().set(Duration.millis(250));\n+    Tooltip.install(countryImageView, countryTooltip);\n+\n+    statusGameTooltip = new Tooltip();\n+    statusGameTooltip.setShowDuration(Duration.seconds(30));\n+    statusGameTooltip.setShowDelay(Duration.ZERO);\n+    statusGameTooltip.setHideDelay(Duration.ZERO);\n+    Tooltip.install(playerStatusIndicator, statusGameTooltip);\n   }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIyMA=="}, "originalCommit": {"oid": "a490255f77696a11d79c884dc2a2b7f22f61005a"}, "originalPosition": 77}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTIzMDUzNg==", "bodyText": "Yeah if it is redone it wont be in this pr", "url": "https://github.com/FAForever/downlords-faf-client/pull/2010#discussion_r519230536", "createdAt": "2020-11-07T23:02:26Z", "author": {"login": "Sheikah45"}, "path": "src/main/java/com/faforever/client/chat/ChatUserItemController.java", "diffHunk": "@@ -151,8 +151,72 @@ public void initialize() {\n     JavaFxUtil.bind(playerMapImage.visibleProperty(), Bindings.isNotNull(playerMapImage.imageProperty()));\n \n     updateFormat();\n+    addEventHandlersToPlayerMapImage();\n+  }\n+\n+  private void initializeTooltips() {\n+    userTooltip = new Tooltip();\n+    usernameLabel.setTooltip(userTooltip);\n+\n+    avatarTooltip = new Tooltip();\n+    avatarTooltip.setAnchorLocation(PopupWindow.AnchorLocation.CONTENT_TOP_LEFT);\n+    Tooltip.install(avatarImageView, avatarTooltip);\n+\n+    countryTooltip = new Tooltip();\n+    countryTooltip.showDelayProperty().set(Duration.millis(250));\n+    Tooltip.install(countryImageView, countryTooltip);\n+\n+    statusGameTooltip = new Tooltip();\n+    statusGameTooltip.setShowDuration(Duration.seconds(30));\n+    statusGameTooltip.setShowDelay(Duration.ZERO);\n+    statusGameTooltip.setHideDelay(Duration.ZERO);\n+    Tooltip.install(playerStatusIndicator, statusGameTooltip);\n   }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4NjIyMA=="}, "originalCommit": {"oid": "a490255f77696a11d79c884dc2a2b7f22f61005a"}, "originalPosition": 77}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1972, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}