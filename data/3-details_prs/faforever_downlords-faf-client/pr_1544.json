{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4OTAwNDc2", "number": 1544, "title": "Display accurate replay durations in vault", "bodyText": "Uses replays tick numbers (extracted by the new replay server) to display accurate in game durations of replays. These times can be significantly shorter than the real time calculated using startTime and endTime. The accurate times will be favored over the real times when displaying the replay cards, and both times are displayed on the replay details. Also added tooltips to the labels on the replay details pane to make it even more clear what the icons represent.\n\nThe new icon is the timer icon with a little \"play\" icon (triangle within a circle) on the side. It ended up being pretty hard to see in the client because it's so small, so I may change it to just the timer with the triangle inside instead of the little minute hand. Let me know what you think.\nEdit:\nOk, here's how that looks:", "createdAt": "2020-01-03T07:39:30Z", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544", "merged": true, "mergeCommit": {"oid": "5225b785df47e205382df6bffd836ad63f1a6205"}, "closed": true, "closedAt": "2020-01-29T21:22:30Z", "author": {"login": "Askaholic"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb2o8nXgH2gAyMzU4OTAwNDc2OjhmMTU2NWMzYTJhOTZmMWQxNDY4OWQ0YjUyZjEwZmQzZDdmZjk2ZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8QKf6AFqTM0NTQ1OTEyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8f1565c3a2a96f1d14689d4b52f10fd3d7ff96fc", "author": {"user": {"login": "Askaholic", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/8f1565c3a2a96f1d14689d4b52f10fd3d7ff96fc", "committedDate": "2020-01-03T07:09:15Z", "message": "Add replay time to replay details"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5829bd0031f35ff49c7e78f2a5a7551ab63dfd8f", "author": {"user": {"login": "Askaholic", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/5829bd0031f35ff49c7e78f2a5a7551ab63dfd8f", "committedDate": "2020-01-03T07:29:07Z", "message": "Use replay tick duration on cards if available"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a10f807871ea87ee7ce98e200fcd1b837f4512b1", "author": {"user": {"login": "Askaholic", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/a10f807871ea87ee7ce98e200fcd1b837f4512b1", "committedDate": "2020-01-03T07:29:23Z", "message": "Add tooltips to replay detail labels"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3OTc5NjM4", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#pullrequestreview-337979638", "createdAt": "2020-01-03T08:16:40Z", "commit": {"oid": "a10f807871ea87ee7ce98e200fcd1b837f4512b1"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wM1QwODoxNjo0MFrOFZ7Tbw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wM1QwODoxNzo0NVrOFZ7UIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjczMDM1MQ==", "bodyText": "just for my information, where is that object property used?", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#discussion_r362730351", "createdAt": "2020-01-03T08:16:40Z", "author": {"login": "norraxx"}, "path": "src/main/java/com/faforever/client/replay/Replay.java", "diffHunk": "@@ -219,6 +222,19 @@ public void setEndTime(Temporal endTime) {\n     return endTime;\n   }\n \n+  @Nullable\n+  public Integer getReplayTicks() {\n+    return replayTicks.get();\n+  }\n+\n+  public void setReplayTicks(Integer replayTicks) {\n+    this.replayTicks.set(replayTicks);\n+  }\n+\n+  public ObjectProperty<Integer> replayTicksProperty() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a10f807871ea87ee7ce98e200fcd1b837f4512b1"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjczMDQyOQ==", "bodyText": "isn't millis 1000?", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#discussion_r362730429", "createdAt": "2020-01-03T08:17:09Z", "author": {"login": "norraxx"}, "path": "src/main/java/com/faforever/client/replay/ReplayCardController.java", "diffHunk": "@@ -98,9 +98,15 @@ public void setReplay(Replay replay) {\n         .average()\n         .ifPresent(averageRating -> ratingLabel.setText(i18n.number((int) averageRating)));\n \n-    durationLabel.setText(Optional.ofNullable(replay.getEndTime())\n-        .map(endTime -> timeService.shortDuration(Duration.between(replay.getStartTime(), endTime)))\n-        .orElse(i18n.get(\"notAvailable\")));\n+    Integer replayTicks = replay.getReplayTicks();\n+    if (replayTicks != null) {\n+      durationLabel.setText(timeService.shortDuration(Duration.ofMillis(replayTicks * 100)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a10f807871ea87ee7ce98e200fcd1b837f4512b1"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjczMDUzMA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#discussion_r362730530", "createdAt": "2020-01-03T08:17:45Z", "author": {"login": "norraxx"}, "path": "src/main/java/com/faforever/client/replay/ReplayDetailController.java", "diffHunk": "@@ -142,7 +144,18 @@ public void initialize() {\n \n     reviewsController.getRoot().setMaxSize(Integer.MAX_VALUE, Integer.MAX_VALUE);\n \n+\n     copyButton.setText(i18n.get(\"replay.copyUrl\"));\n+\n+    dateLabel.setTooltip(new Tooltip(i18n.get(\"replay.dateTooltip\")));\n+    timeLabel.setTooltip(new Tooltip(i18n.get(\"replay.timeTooltip\")));\n+    modLabel.setTooltip(new Tooltip(i18n.get(\"replay.modTooltip\")));\n+    durationLabel.setTooltip(new Tooltip(i18n.get(\"replay.durationTooltip\")));\n+    replayDurationLabel.setTooltip(new Tooltip(i18n.get(\"replay.replayDurationTooltip\")));\n+    playerCountLabel.setTooltip(new Tooltip(i18n.get(\"replay.playerCountTooltip\")));\n+    ratingLabel.setTooltip(new Tooltip(i18n.get(\"replay.ratingTooltip\")));\n+    qualityLabel.setTooltip(new Tooltip(i18n.get(\"replay.qualityTooltip\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a10f807871ea87ee7ce98e200fcd1b837f4512b1"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3f85e7cbb95572efbfe7a754bd9ff704bfe1b9f", "author": {"user": {"login": "Askaholic", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/d3f85e7cbb95572efbfe7a754bd9ff704bfe1b9f", "committedDate": "2020-01-04T00:17:16Z", "message": "Make icon be a timer with play symbol in the center"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzY5NTkw", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#pullrequestreview-338369590", "createdAt": "2020-01-04T20:50:36Z", "commit": {"oid": "d3f85e7cbb95572efbfe7a754bd9ff704bfe1b9f"}, "state": "DISMISSED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMDo1MDozNlrOFaPFsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQyMDo1MDo1OFrOFaPFyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NDUxNQ==", "bodyText": "Yes u do it correctly", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#discussion_r363054515", "createdAt": "2020-01-04T20:50:36Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/replay/Replay.java", "diffHunk": "@@ -219,6 +222,19 @@ public void setEndTime(Temporal endTime) {\n     return endTime;\n   }\n \n+  @Nullable\n+  public Integer getReplayTicks() {\n+    return replayTicks.get();\n+  }\n+\n+  public void setReplayTicks(Integer replayTicks) {\n+    this.replayTicks.set(replayTicks);\n+  }\n+\n+  public ObjectProperty<Integer> replayTicksProperty() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjczMDM1MQ=="}, "originalCommit": {"oid": "a10f807871ea87ee7ce98e200fcd1b837f4512b1"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NDUzNg==", "bodyText": "it is an object where u can listen for changes", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#discussion_r363054536", "createdAt": "2020-01-04T20:50:58Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/replay/Replay.java", "diffHunk": "@@ -219,6 +222,19 @@ public void setEndTime(Temporal endTime) {\n     return endTime;\n   }\n \n+  @Nullable\n+  public Integer getReplayTicks() {\n+    return replayTicks.get();\n+  }\n+\n+  public void setReplayTicks(Integer replayTicks) {\n+    this.replayTicks.set(replayTicks);\n+  }\n+\n+  public ObjectProperty<Integer> replayTicksProperty() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjczMDM1MQ=="}, "originalCommit": {"oid": "a10f807871ea87ee7ce98e200fcd1b837f4512b1"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7fd505133d7f29daa849fd200a6d68c24cd2af9", "author": {"user": {"login": "Askaholic", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/f7fd505133d7f29daa849fd200a6d68c24cd2af9", "committedDate": "2020-01-07T03:57:10Z", "message": "Add test for checking that replayDurationLabel is set"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwMDgyOTM0", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#pullrequestreview-340082934", "createdAt": "2020-01-08T19:12:56Z", "commit": {"oid": "f7fd505133d7f29daa849fd200a6d68c24cd2af9"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0356436209419e8b0aa4dfad62d2cffbabf34a44", "author": {"user": {"login": "Askaholic", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/0356436209419e8b0aa4dfad62d2cffbabf34a44", "committedDate": "2020-01-19T00:21:17Z", "message": "Change 'Game quality' tooltip to 'Quality'"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1NDU5MTI5", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#pullrequestreview-345459129", "createdAt": "2020-01-20T17:40:14Z", "commit": {"oid": "0356436209419e8b0aa4dfad62d2cffbabf34a44"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzo0MDoxNVrOFfllEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNzo0MDoxNVrOFfllEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODY2NTg3NQ==", "bodyText": "Maybe we should use the unicode format ala \\u0055??", "url": "https://github.com/FAForever/downlords-faf-client/pull/1544#discussion_r368665875", "createdAt": "2020-01-20T17:40:15Z", "author": {"login": "norraxx"}, "path": "src/main/java/com/faforever/client/replay/ReplayCardController.java", "diffHunk": "@@ -98,9 +98,15 @@ public void setReplay(Replay replay) {\n         .average()\n         .ifPresent(averageRating -> ratingLabel.setText(i18n.number((int) averageRating)));\n \n-    durationLabel.setText(Optional.ofNullable(replay.getEndTime())\n-        .map(endTime -> timeService.shortDuration(Duration.between(replay.getStartTime(), endTime)))\n-        .orElse(i18n.get(\"notAvailable\")));\n+    Integer replayTicks = replay.getReplayTicks();\n+    if (replayTicks != null) {\n+      durationLabel.setText(timeService.shortDuration(Duration.ofMillis(replayTicks * 100)));\n+      ((Label) durationLabel.getGraphic()).setText(\"\ue953\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0356436209419e8b0aa4dfad62d2cffbabf34a44"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3330, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}