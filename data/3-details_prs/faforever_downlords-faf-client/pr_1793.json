{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NDY3OTQ4", "number": 1793, "title": "Feature/#1792 theme", "bodyText": "Also wrote a wiki article", "createdAt": "2020-06-20T22:26:43Z", "url": "https://github.com/FAForever/downlords-faf-client/pull/1793", "merged": true, "mergeCommit": {"oid": "9107f842d1529997a242aa5a984db7fecdc048d9"}, "closed": true, "closedAt": "2020-08-01T18:53:22Z", "author": {"login": "1-alex98"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABctPZ7LABqjM0NjUwNDkwNTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6QeSPgBqjM2MDc1OTk1ODY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fabd8e2b19a5b7081b0028f8ab98144f86aed8d3", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/fabd8e2b19a5b7081b0028f8ab98144f86aed8d3", "committedDate": "2020-06-20T22:26:09Z", "message": "Themes support\n\nFixes #1792"}, "afterCommit": {"oid": "9e76771b23606c90959ae1792c4b7a207c8b2a54", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/9e76771b23606c90959ae1792c4b7a207c8b2a54", "committedDate": "2020-06-20T22:29:22Z", "message": "Themes support\n\nFixes #1792"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9e76771b23606c90959ae1792c4b7a207c8b2a54", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/9e76771b23606c90959ae1792c4b7a207c8b2a54", "committedDate": "2020-06-20T22:29:22Z", "message": "Themes support\n\nFixes #1792"}, "afterCommit": {"oid": "a3c3055ff30b9d2c6f1b8d803c2c7dacef465d73", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/a3c3055ff30b9d2c6f1b8d803c2c7dacef465d73", "committedDate": "2020-06-20T22:33:33Z", "message": "Themes support\n\nFixes #1792"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NDg4NDk0", "url": "https://github.com/FAForever/downlords-faf-client/pull/1793#pullrequestreview-434488494", "createdAt": "2020-06-21T10:18:26Z", "commit": {"oid": "a3c3055ff30b9d2c6f1b8d803c2c7dacef465d73"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMVQxMDoxODoyN1rOGmrDwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMVQxMDoxODoyN1rOGmrDwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzIwNDU0NA==", "bodyText": "when the theme.properties specifies needsRestart=true I get an exception here. I think these are the relevant ones:\nat org.springframework.context.support.AbstractMessageSource.getMessage(AbstractMessageSource.java:153) at com.faforever.client.i18n.I18n.get(I18n.java:94) at com.faforever.client.i18n.I18n.get(I18n.java:90) at com.faforever.client.preferences.ui.SettingsController.lambda$initialize$8(SettingsController.java:245) [...] Caused by: java.lang.NumberFormatException: For input string: \"\"", "url": "https://github.com/FAForever/downlords-faf-client/pull/1793#discussion_r443204544", "createdAt": "2020-06-21T10:18:27Z", "author": {"login": "BlackYps"}, "path": "src/main/java/com/faforever/client/preferences/ui/SettingsController.java", "diffHunk": "@@ -239,7 +239,14 @@ public void initialize() {\n     });\n \n     currentThemeChangeListener = (observable, oldValue, newValue) -> themeComboBox.getSelectionModel().select(newValue);\n-    selectedThemeChangeListener = (observable, oldValue, newValue) -> uiService.setTheme(newValue);\n+    selectedThemeChangeListener = (observable, oldValue, newValue) -> {\n+      uiService.setTheme(newValue);\n+      if (newValue.isNeedsRestart()) {\n+        notificationService.addNotification(new PersistentNotification(i18n.get(\"theme.needsRestart.message\", newValue.getDisplayName()), Severity.WARN,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3c3055ff30b9d2c6f1b8d803c2c7dacef465d73"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a3c3055ff30b9d2c6f1b8d803c2c7dacef465d73", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/a3c3055ff30b9d2c6f1b8d803c2c7dacef465d73", "committedDate": "2020-06-20T22:33:33Z", "message": "Themes support\n\nFixes #1792"}, "afterCommit": {"oid": "4014ca95483152481c882f55f74789fbcb028cee", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/4014ca95483152481c882f55f74789fbcb028cee", "committedDate": "2020-07-10T18:32:44Z", "message": "Themes support\n\nFixes #1792"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODAwODAy", "url": "https://github.com/FAForever/downlords-faf-client/pull/1793#pullrequestreview-446800802", "createdAt": "2020-07-11T12:51:48Z", "commit": {"oid": "4014ca95483152481c882f55f74789fbcb028cee"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2ODEwNDY0", "url": "https://github.com/FAForever/downlords-faf-client/pull/1793#pullrequestreview-446810464", "createdAt": "2020-07-11T15:39:46Z", "commit": {"oid": "4014ca95483152481c882f55f74789fbcb028cee"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQxNTozOTo0NlrOGwNifQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMVQxNTozOTo0NlrOGwNifQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIwNjY1Mw==", "bodyText": "I'm still against having such a property.", "url": "https://github.com/FAForever/downlords-faf-client/pull/1793#discussion_r453206653", "createdAt": "2020-07-11T15:39:46Z", "author": {"login": "micheljung"}, "path": "src/main/java/com/faforever/client/theme/Theme.java", "diffHunk": "@@ -13,21 +15,20 @@\n   private static final String AUTHOR = \"author\";\n   private static final String COMPATIBILITY_VERSION = \"compatibilityVersion\";\n   private static final String THEME_VERSION = \"themeVersion\";\n+  private static final String NEEDS_RESTART = \"needsRestart\";\n \n-  private StringProperty displayName;\n-  private StringProperty author;\n-  private SimpleObjectProperty<Integer> compatibilityVersion;\n-  private StringProperty themeVersion;\n+  private final StringProperty displayName;\n+  private final StringProperty author;\n+  private final SimpleObjectProperty<Integer> compatibilityVersion;\n+  private final StringProperty themeVersion;\n+  private final BooleanProperty needsRestart;\n \n-  public Theme() {\n-    this(null, null, null, null);\n-  }\n-\n-  public Theme(String displayName, String author, Integer compatibilityVersion, String themeVersion) {\n+  public Theme(String displayName, String author, Integer compatibilityVersion, String themeVersion, boolean needsRestart) {\n     this.displayName = new SimpleStringProperty(displayName);\n     this.author = new SimpleStringProperty(author);\n     this.compatibilityVersion = new SimpleObjectProperty<>(compatibilityVersion);\n     this.themeVersion = new SimpleStringProperty(themeVersion);\n+    this.needsRestart = new SimpleBooleanProperty(needsRestart);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4014ca95483152481c882f55f74789fbcb028cee"}, "originalPosition": 34}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4014ca95483152481c882f55f74789fbcb028cee", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/4014ca95483152481c882f55f74789fbcb028cee", "committedDate": "2020-07-10T18:32:44Z", "message": "Themes support\n\nFixes #1792"}, "afterCommit": {"oid": "8da5e25353fdd763cfcc6e91583574528078067e", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/8da5e25353fdd763cfcc6e91583574528078067e", "committedDate": "2020-07-20T16:17:33Z", "message": "Themes support\n\nFixes #1792"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8da5e25353fdd763cfcc6e91583574528078067e", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/8da5e25353fdd763cfcc6e91583574528078067e", "committedDate": "2020-07-20T16:17:33Z", "message": "Themes support\n\nFixes #1792"}, "afterCommit": {"oid": "05d6f9228a459d166efc3e8df8ad4e8e3dfde69b", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/05d6f9228a459d166efc3e8df8ad4e8e3dfde69b", "committedDate": "2020-07-20T16:25:40Z", "message": "Theming\n\nFixes #1792"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05d6f9228a459d166efc3e8df8ad4e8e3dfde69b", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/05d6f9228a459d166efc3e8df8ad4e8e3dfde69b", "committedDate": "2020-07-20T16:25:40Z", "message": "Theming\n\nFixes #1792"}, "afterCommit": {"oid": "cb30a3bee7527743e22fdf91d39b02897edf8351", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/cb30a3bee7527743e22fdf91d39b02897edf8351", "committedDate": "2020-07-20T17:19:35Z", "message": "Theming\n\nFixes #1792"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cb30a3bee7527743e22fdf91d39b02897edf8351", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/cb30a3bee7527743e22fdf91d39b02897edf8351", "committedDate": "2020-07-20T17:19:35Z", "message": "Theming\n\nFixes #1792"}, "afterCommit": {"oid": "bc37865c553d2c03e5918dd527830ecf2206f548", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/bc37865c553d2c03e5918dd527830ecf2206f548", "committedDate": "2020-07-23T15:48:29Z", "message": "Correct tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4Nzc1ODk2", "url": "https://github.com/FAForever/downlords-faf-client/pull/1793#pullrequestreview-458775896", "createdAt": "2020-07-30T21:40:23Z", "commit": {"oid": "bc37865c553d2c03e5918dd527830ecf2206f548"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQyMTo0MDoyNFrOG50ztQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQyMTo0MDoyNFrOG50ztQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzI4NzIyMQ==", "bodyText": "This will always return the theme.properties file", "url": "https://github.com/FAForever/downlords-faf-client/pull/1793#discussion_r463287221", "createdAt": "2020-07-30T21:40:24Z", "author": {"login": "BlackYps"}, "path": "src/main/java/com/faforever/client/theme/UiService.java", "diffHunk": "@@ -472,4 +472,11 @@ public JFXDialog showInDialog(StackPane parent, Node content, String title) {\n     dialog.show(parent);\n     return dialog;\n   }\n+\n+  @SneakyThrows\n+  public boolean doesThemeNeedRestart(Theme theme) {\n+    try (Stream<Path> stream = Files.list(getThemeDirectory(theme))) {\n+      return stream.anyMatch(path -> Files.isRegularFile(path) && !path.endsWith(\".css\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc37865c553d2c03e5918dd527830ecf2206f548"}, "originalPosition": 121}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bc37865c553d2c03e5918dd527830ecf2206f548", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/bc37865c553d2c03e5918dd527830ecf2206f548", "committedDate": "2020-07-23T15:48:29Z", "message": "Correct tests"}, "afterCommit": {"oid": "fbc5f644b9ff38d989d79b0ada7337cd2d391fb0", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/fbc5f644b9ff38d989d79b0ada7337cd2d391fb0", "committedDate": "2020-07-31T09:02:25Z", "message": "Correct tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fbc5f644b9ff38d989d79b0ada7337cd2d391fb0", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/fbc5f644b9ff38d989d79b0ada7337cd2d391fb0", "committedDate": "2020-07-31T09:02:25Z", "message": "Correct tests"}, "afterCommit": {"oid": "494520c12b995bb1e42721469333c15b824709c4", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/494520c12b995bb1e42721469333c15b824709c4", "committedDate": "2020-07-31T09:03:46Z", "message": "Correct tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81dc1f5bcb459d23350460b2711dc4a6222f8037", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/81dc1f5bcb459d23350460b2711dc4a6222f8037", "committedDate": "2020-07-31T09:05:02Z", "message": "Allow Theming\n\nFixes #1792"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "494520c12b995bb1e42721469333c15b824709c4", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/494520c12b995bb1e42721469333c15b824709c4", "committedDate": "2020-07-31T09:03:46Z", "message": "Correct tests"}, "afterCommit": {"oid": "81dc1f5bcb459d23350460b2711dc4a6222f8037", "author": {"user": {"login": "1-alex98", "name": "Alexander von Trostorff"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/81dc1f5bcb459d23350460b2711dc4a6222f8037", "committedDate": "2020-07-31T09:05:02Z", "message": "Allow Theming\n\nFixes #1792"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3208, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}