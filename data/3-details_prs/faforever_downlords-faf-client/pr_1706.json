{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5NDc5NjM1", "number": 1706, "title": "New news page", "bodyText": "Anihilnine requested me to make the news tab load the soon-to-be-deployed new news page.\nThe logic for the listview with the news items got kicked out. I hope I didn't forget to delete any leftover code.\nLooks like this now:", "createdAt": "2020-05-18T12:49:15Z", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706", "merged": true, "mergeCommit": {"oid": "c63f253fc97731b06060948d09cdc4f6a1efb70f"}, "closed": true, "closedAt": "2020-05-30T22:12:13Z", "author": {"login": "BlackYps"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcifE0vAH2gAyNDE5NDc5NjM1OjJjMjQwZWI2ZGMwNjZmZjNiYTJhYmRiNmIxNzYzODVmYWQwNTgwZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcmejvuAFqTQyMTQ0NzA4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2c240eb6dc066ff3ba2abdb6b176385fad0580d7", "author": {"user": {"login": "BlackYps", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/2c240eb6dc066ff3ba2abdb6b176385fad0580d7", "committedDate": "2020-05-18T12:31:50Z", "message": "load new news page"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c33ecdc1b72c4409af87553d4967a81363811d82", "author": {"user": {"login": "BlackYps", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/c33ecdc1b72c4409af87553d4967a81363811d82", "committedDate": "2020-05-18T12:48:28Z", "message": "delete news_detail.html"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzNjAyMDE2", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#pullrequestreview-413602016", "createdAt": "2020-05-18T13:38:11Z", "commit": {"oid": "c33ecdc1b72c4409af87553d4967a81363811d82"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMzozODoxMVrOGW3jqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMzo0MToyOFrOGW3sqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjYzMjEwNQ==", "bodyText": "Never ever do hardcoded urls.\nWe either load it from the FafApiProperties class and declare it in the application.yml\nOr we add it to the remote preferences which would give us a bit more flexibility until things have settled.", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#discussion_r426632105", "createdAt": "2020-05-18T13:38:11Z", "author": {"login": "Brutus5000"}, "path": "src/main/java/com/faforever/client/news/NewsController.java", "diffHunk": "@@ -108,38 +87,14 @@ public void onUnreadNewsEvent(UnreadNewsEvent unreadNewsEvent) {\n \n \n   private void loadNews() {\n-    newsService.fetchNews().thenAccept(newsItems -> {\n-      Platform.runLater(() -> {\n-        newsListView.getItems().setAll(newsItems);\n-        onLoadingStop();\n-        if (!newsItems.isEmpty()) {\n-          NewsItem mostRecentItem = newsItems.get(0);\n-          preferencesService.getPreferences().getNews().setLastReadNewsUrl(mostRecentItem.getLink());\n-          preferencesService.storeInBackground();\n-        }\n-        newsListView.getSelectionModel().selectFirst();\n-      });\n+    Platform.runLater(() -> {\n+      newsWebView.getEngine().load(\"https://www.faforever.com/news\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c33ecdc1b72c4409af87553d4967a81363811d82"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjYzNDQwOQ==", "bodyText": "I am missing changes to remove this service and related tests.", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#discussion_r426634409", "createdAt": "2020-05-18T13:41:28Z", "author": {"login": "Brutus5000"}, "path": "src/main/java/com/faforever/client/news/NewsController.java", "diffHunk": "@@ -31,25 +31,14 @@\n @Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)\n public class NewsController extends AbstractViewController<Node> {\n \n-  private static final ClassPathResource NEWS_DETAIL_HTML_RESOURCE = new ClassPathResource(\"/theme/news_detail.html\");\n-  private final PreferencesService preferencesService;\n-  private final I18n i18n;\n-  private final NewsService newsService;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c33ecdc1b72c4409af87553d4967a81363811d82"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0d3013555f4e676d306702e52f84bc52873c930", "author": {"user": {"login": "BlackYps", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/f0d3013555f4e676d306702e52f84bc52873c930", "committedDate": "2020-05-21T17:23:06Z", "message": "load url from properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11da7700d3f3d00399ac90e2672892f9006e3d62", "author": {"user": {"login": "BlackYps", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/11da7700d3f3d00399ac90e2672892f9006e3d62", "committedDate": "2020-05-21T17:23:14Z", "message": "set user agent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "482fe4c7ded221afcbc62601b8bfb71837a0ec1a", "author": {"user": {"login": "BlackYps", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/482fe4c7ded221afcbc62601b8bfb71837a0ec1a", "committedDate": "2020-05-21T17:16:54Z", "message": "set user agent"}, "afterCommit": {"oid": "11da7700d3f3d00399ac90e2672892f9006e3d62", "author": {"user": {"login": "BlackYps", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/11da7700d3f3d00399ac90e2672892f9006e3d62", "committedDate": "2020-05-21T17:23:14Z", "message": "set user agent"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MzQ4NDAx", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#pullrequestreview-417348401", "createdAt": "2020-05-24T11:10:55Z", "commit": {"oid": "11da7700d3f3d00399ac90e2672892f9006e3d62"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxMToxMDo1NlrOGZuPSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxMToxMDo1NlrOGZuPSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyNTE2MQ==", "bodyText": "Check for related tests to remove", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#discussion_r429625161", "createdAt": "2020-05-24T11:10:56Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/news/NewsController.java", "diffHunk": "@@ -1,57 +1,37 @@\n package com.faforever.client.news;\n \n+import com.faforever.client.config.ClientProperties;\n+import com.faforever.client.config.ClientProperties.Website;\n import com.faforever.client.fx.AbstractViewController;\n import com.faforever.client.fx.WebViewConfigurer;\n-import com.faforever.client.i18n.I18n;\n import com.faforever.client.main.event.NavigateEvent;\n-import com.faforever.client.main.event.ShowLadderMapsEvent;\n-import com.faforever.client.preferences.PreferencesService;\n-import com.faforever.client.theme.UiService;\n import com.google.common.eventbus.EventBus;\n import com.google.common.eventbus.Subscribe;\n-import com.google.common.io.CharStreams;\n import javafx.application.Platform;\n import javafx.beans.value.ChangeListener;\n import javafx.scene.Node;\n-import javafx.scene.control.Button;\n import javafx.scene.control.Control;\n-import javafx.scene.control.ListView;\n import javafx.scene.layout.Pane;\n import javafx.scene.web.WebView;\n-import lombok.SneakyThrows;\n import org.springframework.beans.factory.config.ConfigurableBeanFactory;\n import org.springframework.context.annotation.Scope;\n-import org.springframework.core.io.ClassPathResource;\n import org.springframework.stereotype.Component;\n \n-import java.io.InputStreamReader;\n-import java.io.Reader;\n-\n @Component\n @Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)\n public class NewsController extends AbstractViewController<Node> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11da7700d3f3d00399ac90e2672892f9006e3d62"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3c635c87a74cfecc490ae8733e12901b6c8c79c", "author": {"user": {"login": "BlackYps", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/d3c635c87a74cfecc490ae8733e12901b6c8c79c", "committedDate": "2020-05-26T15:22:32Z", "message": "configure webView only once\n\nalso delete leftover NewsService"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4NTUwMjUy", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#pullrequestreview-418550252", "createdAt": "2020-05-26T18:05:49Z", "commit": {"oid": "d3c635c87a74cfecc490ae8733e12901b6c8c79c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxODowNTo0OVrOGaqMnA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxODowNTo0OVrOGaqMnA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYwNzUxNg==", "bodyText": "The loading should be removed the way it is now it is technical impossible to see the loading spinner", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#discussion_r430607516", "createdAt": "2020-05-26T18:05:49Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/news/NewsController.java", "diffHunk": "@@ -108,38 +78,15 @@ public void onUnreadNewsEvent(UnreadNewsEvent unreadNewsEvent) {\n \n \n   private void loadNews() {\n-    newsService.fetchNews().thenAccept(newsItems -> {\n-      Platform.runLater(() -> {\n-        newsListView.getItems().setAll(newsItems);\n-        onLoadingStop();\n-        if (!newsItems.isEmpty()) {\n-          NewsItem mostRecentItem = newsItems.get(0);\n-          preferencesService.getPreferences().getNews().setLastReadNewsUrl(mostRecentItem.getLink());\n-          preferencesService.storeInBackground();\n-        }\n-        newsListView.getSelectionModel().selectFirst();\n-      });\n+    Platform.runLater(() -> {\n+      Website website = clientProperties.getWebsite();\n+      newsWebView.getEngine().load(website.getNewsHubUrl());\n+      onLoadingStop();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d3c635c87a74cfecc490ae8733e12901b6c8c79c"}, "originalPosition": 111}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7a5a504ece347c71a9f3f6c2f5f0765cfe87bc2", "author": {"user": {"login": "BlackYps", "name": null}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/d7a5a504ece347c71a9f3f6c2f5f0765cfe87bc2", "committedDate": "2020-05-27T15:36:57Z", "message": "make loading spinner possible to see"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MzY2NjA4", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#pullrequestreview-419366608", "createdAt": "2020-05-27T15:53:10Z", "commit": {"oid": "d7a5a504ece347c71a9f3f6c2f5f0765cfe87bc2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDQ0ODQz", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#pullrequestreview-421444843", "createdAt": "2020-05-30T21:23:48Z", "commit": {"oid": "d7a5a504ece347c71a9f3f6c2f5f0765cfe87bc2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDQ2MDgx", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#pullrequestreview-421446081", "createdAt": "2020-05-30T21:49:02Z", "commit": {"oid": "d7a5a504ece347c71a9f3f6c2f5f0765cfe87bc2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDQ3MDgy", "url": "https://github.com/FAForever/downlords-faf-client/pull/1706#pullrequestreview-421447082", "createdAt": "2020-05-30T22:11:25Z", "commit": {"oid": "d7a5a504ece347c71a9f3f6c2f5f0765cfe87bc2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3377, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}