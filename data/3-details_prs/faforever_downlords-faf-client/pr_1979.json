{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMDEwNzY4", "number": 1979, "title": "#1978 Implemented a filter for country in the chat window.", "bodyText": "Pull request adds country filtering for the chat.\nFirst time contributor here.\nI come from a .NET core web development background, so I expect something to be missing or poorly implemented.\nWould love feedback! Especially regarding tests. (I'm not sure they ran properly on my machine. Saw a lot of exception messages but the tests seemed to pass anyway.)", "createdAt": "2020-10-10T17:30:22Z", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979", "merged": true, "mergeCommit": {"oid": "b1188c53c16d3322371d0ec5273af1ef198bbbb7"}, "closed": true, "closedAt": "2020-10-24T16:34:31Z", "author": {"login": "chrsin"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdROHccgH2gAyNTAxMDEwNzY4OjAxZTA4OThhMjY1ODE2N2VjOWYzMDdhMDA3NTlhNTgxZmYzZmU3ODI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUUC4RAFqTUxMjQyODkwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782", "author": {"user": {"login": "chrsin", "name": "Christian Sindberg"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/01e0898a2658167ec9f307a00759a581ff3fe782", "committedDate": "2020-10-10T17:20:45Z", "message": "#1978 Implemented a filter for country in the chat window."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MTkyNzU4", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#pullrequestreview-506192758", "createdAt": "2020-10-11T15:55:06Z", "commit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MjEwODgw", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#pullrequestreview-506210880", "createdAt": "2020-10-11T19:48:41Z", "commit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxOTo0ODo0MlrOHfqHWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxOTo1NDowMlrOHfqJrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1NzkxNQ==", "bodyText": "A lot of code for a simple thing:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public List<String> getCountries(String startsWith) {\n          \n          \n            \n                String[] countries = Locale.getISOCountries();\n          \n          \n            \n                if(startsWith == null) {\n          \n          \n            \n                  return Arrays.asList(countries);\n          \n          \n            \n                }\n          \n          \n            \n            \n          \n          \n            \n                startsWith = startsWith.toLowerCase();\n          \n          \n            \n            \n          \n          \n            \n                ArrayList<String> result = new ArrayList(countries.length);\n          \n          \n            \n                for(String country : countries)  {\n          \n          \n            \n                  if(country.toLowerCase().startsWith(startsWith))\n          \n          \n            \n                    result.add(country);\n          \n          \n            \n                }\n          \n          \n            \n            \n          \n          \n            \n                return result;\n          \n          \n            \n              }\n          \n          \n            \n              return Arrays.stream(Locale.getISOCountries())\n          \n          \n            \n                    .filter(country -> startsWith == null || country.startsWith(startsWith))\n          \n          \n            \n                    .collect(Collectors.toList());", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r502957915", "createdAt": "2020-10-11T19:48:42Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/CountryFlagService.java", "diffHunk": "@@ -35,6 +39,24 @@\n         .map(url -> new Image(url.toString(), true));\n   }\n \n+  @Cacheable(COUNTRY_NAMES)\n+  public List<String> getCountries(String startsWith) {\n+    String[] countries = Locale.getISOCountries();\n+    if(startsWith == null) {\n+      return Arrays.asList(countries);\n+    }\n+\n+    startsWith = startsWith.toLowerCase();\n+\n+    ArrayList<String> result = new ArrayList(countries.length);\n+    for(String country : countries)  {\n+      if(country.toLowerCase().startsWith(startsWith))\n+        result.add(country);\n+    }\n+\n+    return result;\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1Nzk4Nw==", "bodyText": "for code style reasons we use {} always", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r502957987", "createdAt": "2020-10-11T19:49:20Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/CountryFlagService.java", "diffHunk": "@@ -35,6 +39,24 @@\n         .map(url -> new Image(url.toString(), true));\n   }\n \n+  @Cacheable(COUNTRY_NAMES)\n+  public List<String> getCountries(String startsWith) {\n+    String[] countries = Locale.getISOCountries();\n+    if(startsWith == null) {\n+      return Arrays.asList(countries);\n+    }\n+\n+    startsWith = startsWith.toLowerCase();\n+\n+    ArrayList<String> result = new ArrayList(countries.length);\n+    for(String country : countries)  {\n+      if(country.toLowerCase().startsWith(startsWith))\n+        result.add(country);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1ODAyNw==", "bodyText": "final\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private CountryFlagService flagService;\n          \n          \n            \n              private final CountryFlagService flagService;", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r502958027", "createdAt": "2020-10-11T19:49:34Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "diffHunk": "@@ -30,20 +33,24 @@\n public class UserFilterController implements Controller<Node> {\n \n   private final I18n i18n;\n+  private CountryFlagService flagService;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1ODIxMA==", "bodyText": "A ComboBox of what. See how Intelij warns you. In order to achieve type safety please use the Type parameter:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public ComboBox countryFilterField;\n          \n          \n            \n              public ComboBox<String> countryFilterField;", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r502958210", "createdAt": "2020-10-11T19:50:58Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "diffHunk": "@@ -30,20 +33,24 @@\n public class UserFilterController implements Controller<Node> {\n \n   private final I18n i18n;\n+  private CountryFlagService flagService;\n   public MenuButton gameStatusMenu;\n   public GridPane filterUserRoot;\n   public TextField clanFilterField;\n   public TextField minRatingFilterField;\n   public TextField maxRatingFilterField;\n   public ToggleGroup gameStatusToggleGroup;\n+  public ComboBox countryFilterField;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1ODI2NA==", "bodyText": "We avoid var for code style reasons", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r502958264", "createdAt": "2020-10-11T19:51:43Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "diffHunk": "@@ -159,6 +172,27 @@ boolean isGameStatusMatch(ChatChannelUser chatUser) {\n     }\n   }\n \n+  boolean isCountryMatch(ChatChannelUser chatUser) {\n+    var fieldValue = countryFilterField.getEditor().getText();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1ODMwNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                if(fieldValue.isEmpty())\n          \n          \n            \n                  return true;\n          \n          \n            \n                if(fieldValue.isEmpty()){\n          \n          \n            \n                  return true;\n          \n          \n            \n                }", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r502958307", "createdAt": "2020-10-11T19:52:04Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "diffHunk": "@@ -159,6 +172,27 @@ boolean isGameStatusMatch(ChatChannelUser chatUser) {\n     }\n   }\n \n+  boolean isCountryMatch(ChatChannelUser chatUser) {\n+    var fieldValue = countryFilterField.getEditor().getText();\n+    if(fieldValue.isEmpty())\n+      return true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1ODMyMQ==", "bodyText": "{}", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r502958321", "createdAt": "2020-10-11T19:52:12Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "diffHunk": "@@ -159,6 +172,27 @@ boolean isGameStatusMatch(ChatChannelUser chatUser) {\n     }\n   }\n \n+  boolean isCountryMatch(ChatChannelUser chatUser) {\n+    var fieldValue = countryFilterField.getEditor().getText();\n+    if(fieldValue.isEmpty())\n+      return true;\n+\n+    Optional<Player> playerOptional = chatUser.getPlayer();\n+\n+    if(!playerOptional.isPresent())\n+      return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1ODM3Nw==", "bodyText": "...", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r502958377", "createdAt": "2020-10-11T19:52:41Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "diffHunk": "@@ -159,6 +172,27 @@ boolean isGameStatusMatch(ChatChannelUser chatUser) {\n     }\n   }\n \n+  boolean isCountryMatch(ChatChannelUser chatUser) {\n+    var fieldValue = countryFilterField.getEditor().getText();\n+    if(fieldValue.isEmpty())\n+      return true;\n+\n+    Optional<Player> playerOptional = chatUser.getPlayer();\n+\n+    if(!playerOptional.isPresent())\n+      return false;\n+\n+    Player player = playerOptional.get();\n+\n+    var country = player.getCountry();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1ODUwOQ==", "bodyText": "Translations are made on poeditor.com don't ever commit changes to message properties file other than the English one", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r502958509", "createdAt": "2020-10-11T19:54:02Z", "author": {"login": "1-alex98"}, "path": "src/main/resources/i18n/messages_de.properties", "diffHunk": "@@ -793,4 +793,5 @@ settings.general.startTab = Starter \"Tab\"\n startTab.selectTab = W\u00e4hlen Sie den \"Tab\", mit dem Sie beginnen m\u00f6chten\\:\n startTab.message = Hier k\u00f6nnen Sie den \"Tab\" ausw\u00e4hlen, mit dem der Client startet. Sie k\u00f6nnen dies sp\u00e4ter in den Einstellungen \u00e4ndern, wenn Sie m\u00f6chten.\n startTab.save = Speichern\n-vault.replays.onlyShowLastYear = Nur ein Jahr alte\n\\ No newline at end of file\n+vault.replays.onlyShowLastYear = Nur ein Jahr alte\n+chat.filter.countryPrompt=Country", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b56347539bc8d5835413ddcd3bcee2805b1f9fdf", "author": {"user": {"login": "chrsin", "name": "Christian Sindberg"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/b56347539bc8d5835413ddcd3bcee2805b1f9fdf", "committedDate": "2020-10-12T18:07:38Z", "message": "#1978 implemented country filter using a TextField instead of ComboBox"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2OTI0ODAy", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#pullrequestreview-506924802", "createdAt": "2020-10-12T21:23:42Z", "commit": {"oid": "b56347539bc8d5835413ddcd3bcee2805b1f9fdf"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNzAzNzM5", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#pullrequestreview-510703739", "createdAt": "2020-10-16T18:19:12Z", "commit": {"oid": "b56347539bc8d5835413ddcd3bcee2805b1f9fdf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxODoxOToxMlrOHjLXJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNlQxODoyMToxMVrOHjLbFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjY0ODM1OA==", "bodyText": "Use @RequiredArgsConstructor above the class instead", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r506648358", "createdAt": "2020-10-16T18:19:12Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/CountryFlagService.java", "diffHunk": "@@ -24,6 +30,12 @@\n   private static final Logger logger = LoggerFactory.getLogger(MethodHandles.lookup().lookupClass());\n \n   private static final Collection<String> NON_COUNTRY_CODES = Arrays.asList(\"A1\", \"A2\", \"\");\n+  private final I18n i18n;\n+\n+  public CountryFlagService(I18n i18n) {\n+    this.i18n = i18n;\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b56347539bc8d5835413ddcd3bcee2805b1f9fdf"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjY0OTM2Nw==", "bodyText": "still", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#discussion_r506649367", "createdAt": "2020-10-16T18:21:11Z", "author": {"login": "1-alex98"}, "path": "src/main/java/com/faforever/client/chat/UserFilterController.java", "diffHunk": "@@ -159,6 +172,27 @@ boolean isGameStatusMatch(ChatChannelUser chatUser) {\n     }\n   }\n \n+  boolean isCountryMatch(ChatChannelUser chatUser) {\n+    var fieldValue = countryFilterField.getEditor().getText();\n+    if(fieldValue.isEmpty())\n+      return true;\n+\n+    Optional<Player> playerOptional = chatUser.getPlayer();\n+\n+    if(!playerOptional.isPresent())\n+      return false;\n+\n+    Player player = playerOptional.get();\n+\n+    var country = player.getCountry();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk1ODM3Nw=="}, "originalCommit": {"oid": "01e0898a2658167ec9f307a00759a581ff3fe782"}, "originalPosition": 91}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2e779f839829bc65f5863214a68b5706a321ea50", "author": {"user": {"login": "chrsin", "name": "Christian Sindberg"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/2e779f839829bc65f5863214a68b5706a321ea50", "committedDate": "2020-10-18T09:08:56Z", "message": "#1978 Made some minor changes to satisfy the standards"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d890c1cdf795178ee4413d52c49d375e0f4c013", "author": {"user": {"login": "chrsin", "name": "Christian Sindberg"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/0d890c1cdf795178ee4413d52c49d375e0f4c013", "committedDate": "2020-10-19T17:10:58Z", "message": "Merge remote-tracking branch 'faf/develop' into develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d55679a3bd3c5e8193c48936ecf986e7790e032d", "author": {"user": {"login": "chrsin", "name": "Christian Sindberg"}}, "url": "https://github.com/FAForever/downlords-faf-client/commit/d55679a3bd3c5e8193c48936ecf986e7790e032d", "committedDate": "2020-10-19T17:17:30Z", "message": "Merge remote-tracking branch 'faf/develop' into develop\n\n# Conflicts:\n#\tsrc/main/resources/i18n/messages.properties"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyMzkwNDM2", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#pullrequestreview-512390436", "createdAt": "2020-10-20T07:08:08Z", "commit": {"oid": "d55679a3bd3c5e8193c48936ecf986e7790e032d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyNDI4OTA5", "url": "https://github.com/FAForever/downlords-faf-client/pull/1979#pullrequestreview-512428909", "createdAt": "2020-10-20T07:56:58Z", "commit": {"oid": "d55679a3bd3c5e8193c48936ecf986e7790e032d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3320, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}