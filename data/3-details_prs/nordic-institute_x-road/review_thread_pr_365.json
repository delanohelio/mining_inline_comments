{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc0NDI4NTU4", "number": 365, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDo0NDowM1rODgWDcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDo0NDowM1rODgWDcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1MjQyMzUzOnYy", "diffSide": "RIGHT", "path": "src/packages/src/xroad/ubuntu/generic/xroad-opmonitor.postinst", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDo0NDowM1rOFqf8pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xN1QxMDo0NDowM1rOFqf8pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDEwNzk0Mw==", "bodyText": "I suppose that this can still fail if opmonitor is standalone and using remote DB? This could be fixed by reverting the changes, and making the db_get not to fail (makes it also possible to use a pre-initialized remote db). Something like:\nRET=\ndb_get xroad-common/database-host || true\ndb_host=\"${RET:-127.0.0.1:5432}\"\ndb_stop", "url": "https://github.com/nordic-institute/X-Road/pull/365#discussion_r380107943", "createdAt": "2020-02-17T10:44:03Z", "author": {"login": "jhyoty"}, "path": "src/packages/src/xroad/ubuntu/generic/xroad-opmonitor.postinst", "diffHunk": "@@ -33,24 +33,25 @@ configure() {\n \n   db_properties=/etc/xroad/db.properties\n   root_properties=/etc/xroad.properties\n-\n-  RET=\n-  db_get xroad-common/database-host\n-  db_host=\"$RET\"\n-  db_url=jdbc:postgresql://${db_host}/${db_name}\n-  db_addr=${db_host%%:*}\n-  db_port=${db_host##*:}\n-  db_initialized=false\n+  db_host=127.0.0.1:5432\n \n   if  [[ -f ${root_properties} && $(get_prop ${root_properties} postgres.connection.password) != \"\" ]]\n   then\n     master_passwd=$(crudini --get ${root_properties} '' postgres.connection.password)\n     export PGPASSWORD=${master_passwd}\n     psql_cmd=remote_psql\n+    RET=\n+    db_get xroad-common/database-host", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c2c245a932fbe534e5b35db0fa66ee350f1bc93c"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2927, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}