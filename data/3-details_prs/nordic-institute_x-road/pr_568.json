{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM5Njc0MjU1", "number": 568, "title": "XRDDEV-1159", "bodyText": "Disable operational monitoring JMX interface by default\nUpdate documentation\nAdd instructions how to enable environmental and operational monitoring JMX interfaces\n\nJIRA issue: https://jira.niis.org/browse/XRDDEV-1159", "createdAt": "2020-06-25T05:31:53Z", "url": "https://github.com/nordic-institute/X-Road/pull/568", "merged": true, "mergeCommit": {"oid": "db67cc73e2c9fb60bfd275f54127487d281b9af8"}, "closed": true, "closedAt": "2020-06-25T07:46:26Z", "author": {"login": "petkivim"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcua8H2AH2gAyNDM5Njc0MjU1OjBkNzZjZmU0OWY5MzkzNTRmOGVhZDNjZWI1NGVjMDQyMjE2ZjY5Yzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcupwysAFqTQzNzI0NTg5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0d76cfe49f939354f8ead3ceb54ec042216f69c8", "author": {"user": {"login": "petkivim", "name": "Petteri Kivim\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/0d76cfe49f939354f8ead3ceb54ec042216f69c8", "committedDate": "2020-06-24T14:29:48Z", "message": "XRDDEV-1159 Disable JMX in opmon default configuration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49368e41ca740909117a337ca7120e06df953c92", "author": {"user": {"login": "petkivim", "name": "Petteri Kivim\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/49368e41ca740909117a337ca7120e06df953c92", "committedDate": "2020-06-24T14:33:49Z", "message": "XRDDEV-1159 Remove JMX daemon ports from SS installation guides"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d8f169e35bf77fbeebb1e8e9191fd29fac8c468", "author": {"user": {"login": "petkivim", "name": "Petteri Kivim\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/2d8f169e35bf77fbeebb1e8e9191fd29fac8c468", "committedDate": "2020-06-25T05:16:25Z", "message": "XRDDEV-1159 Update documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b813fd96514d5618908327c5b200fb9cedc5f1c", "author": {"user": {"login": "petkivim", "name": "Petteri Kivim\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/5b813fd96514d5618908327c5b200fb9cedc5f1c", "committedDate": "2020-06-25T05:27:55Z", "message": "XRDDEV-1159 Update documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MjE1NDA2", "url": "https://github.com/nordic-institute/X-Road/pull/568#pullrequestreview-437215406", "createdAt": "2020-06-25T06:57:06Z", "commit": {"oid": "5b813fd96514d5618908327c5b200fb9cedc5f1c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwNjo1NzowN1rOGotssQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwNjo1NzowN1rOGotssQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM0NDk0NQ==", "bodyText": "PROXY_PARAMS should be MONITOR_PARAMS", "url": "https://github.com/nordic-institute/X-Road/pull/568#discussion_r445344945", "createdAt": "2020-06-25T06:57:07Z", "author": {"login": "jhyoty"}, "path": "doc/EnvironmentalMonitoring/Monitoring-architecture.md", "diffHunk": "@@ -126,10 +128,24 @@ The following sensors produce monitoring data:\n \n Monitoring service is installed as a separate package, with name `xroad-monitor`. It runs in a separate process.\n \n-The service also publishes the monitoring data via JMX. Local monitoring agents can use this as an alternative way to fetch monitoring data. With default configuration, JMX access is only allowed from localhost.\n+#### 2.2.1 JMX interface\n+\n+The service also publishes the monitoring data via JMX. Local monitoring agents can use this as an alternative way to fetch monitoring data. With the default configuration, JMX is disabled.\n \n ![monitoring JMX agent](img/monitoring-jmx.png)\n \n+JMX is enabled by adding the required configuration in `/etc/xroad/services/local.conf` file. The file is opened for editing and changes are made on the `PROXY_PARAMS` variable value. After the `PROXY_PARAMS` variable value has been updated, the `xroad-monitor` service must be restarted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b813fd96514d5618908327c5b200fb9cedc5f1c"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5dc529081b6b03772304c8bb5f390e4e1cb010f7", "author": {"user": {"login": "petkivim", "name": "Petteri Kivim\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/5dc529081b6b03772304c8bb5f390e4e1cb010f7", "committedDate": "2020-06-25T07:00:54Z", "message": "XRDDEV-1159 Change PROXY_PARAMS to MONITOR_PARAMS"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MjIyNjQ4", "url": "https://github.com/nordic-institute/X-Road/pull/568#pullrequestreview-437222648", "createdAt": "2020-06-25T07:10:32Z", "commit": {"oid": "5dc529081b6b03772304c8bb5f390e4e1cb010f7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwNzoxMDozMlrOGouCpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQwNzoxMDozMlrOGouCpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTM1MDU2Nw==", "bodyText": "Should be:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            OPMON_PARAMS=\"OPMON_PARAMS \\\n          \n          \n            \n            OPMON_PARAMS=\"$OPMON_PARAMS \\", "url": "https://github.com/nordic-institute/X-Road/pull/568#discussion_r445350567", "createdAt": "2020-06-25T07:10:32Z", "author": {"login": "jhyoty"}, "path": "doc/OperationalMonitoring/Testing/test-opmon_x-road_operational_monitoring_testing_plan_Y-1104-2.md", "diffHunk": "@@ -166,11 +167,10 @@ Direct observation of JMX metrics in `jconsole` is described in the following se\n \n ### 6.1 Testing the JMXMP Interface Using jconsole\n \n-By default, the JMX interface of the operational monitoring daemon has been configured to listen on localhost, with authentication disabled and TLS enabled. In order to conveniently access this interface from a remote host, either directly or through an SSH tunnel, the following configuration must be used in `/etc/xroad/services/local.conf`, effectively overriding the value of the variable OPMON_PARAMS:\n+By default, the JMX interface of the operational monitoring daemon is disabled. In order to conveniently access this interface from a remote host, either directly or through an SSH tunnel, the following configuration must be used in `/etc/xroad/services/local.conf`, effectively making changes on the `OPMON_PARAMS` parameter value:\n \n ```bash\n-OPMON_PARAMS=\" -javaagent:$METRICS_BUGFIX_AGENT -Xms50m -Xmx256m -XX:MaxMetaspaceSize=70m \\\n--Dlogback.configurationFile=/etc/xroad/conf.d/op-monitor-logback.xml \\\n+OPMON_PARAMS=\"OPMON_PARAMS \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5dc529081b6b03772304c8bb5f390e4e1cb010f7"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "888f256c4d908bf0e7f8c06c92139cbba4b96546", "author": {"user": {"login": "petkivim", "name": "Petteri Kivim\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/888f256c4d908bf0e7f8c06c92139cbba4b96546", "committedDate": "2020-06-25T07:41:19Z", "message": "XRDDEV-1159 Fix minor error in documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3MjQ1ODkw", "url": "https://github.com/nordic-institute/X-Road/pull/568#pullrequestreview-437245890", "createdAt": "2020-06-25T07:46:00Z", "commit": {"oid": "888f256c4d908bf0e7f8c06c92139cbba4b96546"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4116, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}