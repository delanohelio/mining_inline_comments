{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczNDA2NzA3", "number": 359, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMjozMDoyOVrODfKNEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzoyMDo0NlrODfLHmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzOTk5NjM1OnYy", "diffSide": "RIGHT", "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsSignCertificateProfileInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMjozMDoyOVrOFosyOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMjozMDoyOVrOFosyOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODIyMTExMg==", "bodyText": "clientId.xRoadInstance is already encoded as countryName and clientId.memberClass as organizationName. If the intention is to make the DN unique in case the member is a client of multiple security servers, maybe this should be something like:\n params.getServerId().toShortString(); // INSTANCE/CLASS/MEMBERCODE/SERVERCODE\n\n(And even that is prone to errors since serialNumber should be a ASN.1 PrintableString (https://en.wikipedia.org/wiki/PrintableString), and serverId can include \"non-PrintableString\" chars)", "url": "https://github.com/nordic-institute/X-Road/pull/359#discussion_r378221112", "createdAt": "2020-02-12T12:30:29Z", "author": {"login": "jhyoty"}, "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsSignCertificateProfileInfo.java", "diffHunk": "@@ -45,23 +45,38 @@\n      */\n     public IsSignCertificateProfileInfo(Parameters params) {\n         super(new DnFieldDescription[] {\n-                // Country Code\n-                new EnumLocalizedFieldDescriptionImpl(\n-                        \"C\", DnFieldLabelLocalizationKey.COUNTRY_CODE, \"IS\").setReadOnly(true),\n \n-                // Organization name\n+                // Instance identifier\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"O\", DnFieldLabelLocalizationKey.ORGANIZATION_NAME, \"\").setReadOnly(false),\n+                        \"C\",\n+                        DnFieldLabelLocalizationKey.INSTANCE_IDENTIFIER,\n+                        params.getClientId().getXRoadInstance()\n+                ).setReadOnly(true),\n \n-                // Serialnumber\n-                new EnumLocalizedFieldDescriptionImpl(\"serialNumber\", DnFieldLabelLocalizationKey.SERIAL_NUMBER,\n-                        params.getClientId().getXRoadInstance() + \"/\" + params.getServerId().getServerCode()\n-                                + \"/\" + params.getClientId().getMemberClass()).setReadOnly(true),\n+                // Member class\n+                new EnumLocalizedFieldDescriptionImpl(\n+                        \"O\",\n+                        DnFieldLabelLocalizationKey.MEMBER_CLASS,\n+                        params.getClientId().getMemberClass()\n+                ).setReadOnly(true),\n \n                 // Member code\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"CN\", DnFieldLabelLocalizationKey.MEMBER_CODE, params.getClientId().getMemberCode())\n-                        .setReadOnly(true) });\n+                        \"CN\",\n+                        DnFieldLabelLocalizationKey.MEMBER_CODE,\n+                        params.getClientId().getMemberCode()\n+                ).setReadOnly(true),\n+\n+                // Serialnumber\n+                new EnumLocalizedFieldDescriptionImpl(\n+                        \"serialNumber\",\n+                        DnFieldLabelLocalizationKey.SERIAL_NUMBER,\n+                        params.getClientId().getXRoadInstance()\n+                        + \"/\" + params.getServerId().getServerCode()\n+                        + \"/\" + params.getClientId().getMemberClass()\n+                ).setReadOnly(true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78007df0285fbe820a27da0281abf7532afd92d1"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MDA0MjcxOnYy", "diffSide": "RIGHT", "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsSignCertificateProfileInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMjo0NjoxMFrOFotOCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMjo0NjoxMFrOFotOCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODIyODIzMg==", "bodyText": "Note: Valid values for the countryName attribute are ISO 3166 alpha-2 codes (2-character country codes). It would be safer to map the instance identifier to e.g. \"O\" (and memberClass to OU) in case a CA uses strict validation.", "url": "https://github.com/nordic-institute/X-Road/pull/359#discussion_r378228232", "createdAt": "2020-02-12T12:46:10Z", "author": {"login": "jhyoty"}, "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsSignCertificateProfileInfo.java", "diffHunk": "@@ -45,23 +45,38 @@\n      */\n     public IsSignCertificateProfileInfo(Parameters params) {\n         super(new DnFieldDescription[] {\n-                // Country Code\n-                new EnumLocalizedFieldDescriptionImpl(\n-                        \"C\", DnFieldLabelLocalizationKey.COUNTRY_CODE, \"IS\").setReadOnly(true),\n \n-                // Organization name\n+                // Instance identifier\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"O\", DnFieldLabelLocalizationKey.ORGANIZATION_NAME, \"\").setReadOnly(false),\n+                        \"C\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78007df0285fbe820a27da0281abf7532afd92d1"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MDA1OTU3OnYy", "diffSide": "RIGHT", "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsAuthCertificateProfileInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMjo1MTo1N1rOFotYeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMjo1MTo1N1rOFotYeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODIzMDkwNA==", "bodyText": "Note: Valid values for the countryName attribute are ISO 3166 alpha-2 codes (2-character country codes). It would be safer to map the instance identifier to e.g. \"organizationName\" in case a CA uses strict validation.", "url": "https://github.com/nordic-institute/X-Road/pull/359#discussion_r378230904", "createdAt": "2020-02-12T12:51:57Z", "author": {"login": "jhyoty"}, "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsAuthCertificateProfileInfo.java", "diffHunk": "@@ -39,21 +39,28 @@\n      */\n     public IsAuthCertificateProfileInfo(Parameters params) {\n         super(new DnFieldDescription[] {\n-                // Country Code\n+                // Instance identifier\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"C\", DnFieldLabelLocalizationKey.COUNTRY_CODE, \"IS\").setReadOnly(true),\n+                        \"C\",\n+                        DnFieldLabelLocalizationKey.INSTANCE_IDENTIFIER,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78007df0285fbe820a27da0281abf7532afd92d1"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM0MDE0NjE2OnYy", "diffSide": "RIGHT", "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsAuthCertificateProfileInfo.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzoyMDo0NlrOFouOmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMzoyMDo0NlrOFouOmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODI0NDc2Mw==", "bodyText": "Maybe serialNumber value could be something like  params.getServerId().getOwner().toShortString()  if the intention is to make the DN unique (serverCode is already mapped to CN).\nNote that serialNumber should be an ASN.1 PrintableString (https://en.wikipedia.org/wiki/PrintableString), and the identifiers (serverId components) can include \"non-PrintableString\" chars.", "url": "https://github.com/nordic-institute/X-Road/pull/359#discussion_r378244763", "createdAt": "2020-02-12T13:20:46Z", "author": {"login": "jhyoty"}, "path": "src/common-util/src/main/java/ee/ria/xroad/common/certificateprofile/impl/IsAuthCertificateProfileInfo.java", "diffHunk": "@@ -39,21 +39,28 @@\n      */\n     public IsAuthCertificateProfileInfo(Parameters params) {\n         super(new DnFieldDescription[] {\n-                // Country Code\n+                // Instance identifier\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"C\", DnFieldLabelLocalizationKey.COUNTRY_CODE, \"IS\").setReadOnly(true),\n+                        \"C\",\n+                        DnFieldLabelLocalizationKey.INSTANCE_IDENTIFIER,\n+                        params.getServerId().getXRoadInstance()\n+                ).setReadOnly(true),\n \n-                // Organization name\n+                // Server code\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"O\", DnFieldLabelLocalizationKey.ORGANIZATION_NAME, \"\").setReadOnly(false),\n+                        \"CN\",\n+                        DnFieldLabelLocalizationKey.SERVER_CODE,\n+                        params.getServerId().getServerCode()\n+                ).setReadOnly(true),\n \n                 // Serialnumber\n-                new EnumLocalizedFieldDescriptionImpl(\"serialNumber\", DnFieldLabelLocalizationKey.SERIAL_NUMBER,\n-                        params.getServerId().getXRoadInstance() + \"/\" + params.getServerId().getServerCode()\n-                                + \"/\" + params.getServerId().getMemberClass()).setReadOnly(true),\n-\n-                // Server code\n                 new EnumLocalizedFieldDescriptionImpl(\n-                        \"CN\", DnFieldLabelLocalizationKey.SERVER_DNS_NAME, \"\").setReadOnly(false) });\n+                        \"serialNumber\",\n+                        DnFieldLabelLocalizationKey.SERIAL_NUMBER,\n+                        params.getServerId().getXRoadInstance()\n+                        + \"/\" + params.getServerId().getServerCode()\n+                        + \"/\" + params.getServerId().getMemberClass()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78007df0285fbe820a27da0281abf7532afd92d1"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2922, "cost": 1, "resetAt": "2021-11-12T20:28:25Z"}}}