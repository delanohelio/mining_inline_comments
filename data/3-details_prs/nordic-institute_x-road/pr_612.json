{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NzQwMTIy", "number": 612, "title": "XRDDEV-1183 Client flow improvement", "bodyText": "https://jira.niis.org/browse/XRDDEV-1183\n\nAdd client flow handles existing csr / certificate scenarios in similar way as add member flow\nSome cleanup for add member flow\n\nMerge PR 606 before this\n#606", "createdAt": "2020-07-23T14:18:06Z", "url": "https://github.com/nordic-institute/X-Road/pull/612", "merged": true, "mergeCommit": {"oid": "6cd2f64d8c7c4b5707d43e197e8dce5b65aed654"}, "closed": true, "closedAt": "2020-07-24T12:40:21Z", "author": {"login": "Riippi"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc2v_LIAH2gAyNDU1NzQwMTIyOjA2OWZhMTQ0ZmE1YzdmOTk5NTY2ZGU2ZDEwYTk5ZWJmNDcwNTlhYWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc4DV2EgFqTQ1NDg1MjQwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "069fa144fa5c7f999566de6d10a99ebf47059aab", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/069fa144fa5c7f999566de6d10a99ebf47059aab", "committedDate": "2020-07-20T11:32:32Z", "message": "XRDDEV-1182 Add functions for a case when the csr exists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de23630860f69e9c7ac97d93ebea0550cc01001b", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/de23630860f69e9c7ac97d93ebea0550cc01001b", "committedDate": "2020-07-21T18:54:50Z", "message": "Merge branch 'XRDDEV-1182-add-member-with-csr' into XRDDEV-1183-client-flow-improvement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29900c9d53be9394a1e0868405f17490b3e3482a", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/29900c9d53be9394a1e0868405f17490b3e3482a", "committedDate": "2020-07-22T13:33:17Z", "message": "XRDDEV-1183 Simplify step methods in add member wizard"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53cc991db385cf6f93cf4b79cecb31a2e16862e5", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/53cc991db385cf6f93cf4b79cecb31a2e16862e5", "committedDate": "2020-07-22T13:42:42Z", "message": "XRDDEV-1183 Fix add member dialog title"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cacfd0df2292e5f1ed3752a1e558640ce99e87ed", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/cacfd0df2292e5f1ed3752a1e558640ce99e87ed", "committedDate": "2020-07-22T13:43:07Z", "message": "XRDDEV-1183 Update localisations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "122c061cb26747e54f2eb9c7029d44e1ebb7ac30", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/122c061cb26747e54f2eb9c7029d44e1ebb7ac30", "committedDate": "2020-07-22T13:43:39Z", "message": "XRDDEV-1183 Cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df57c4c5780de14d0be657f9105a418d46b94c9f", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/df57c4c5780de14d0be657f9105a418d46b94c9f", "committedDate": "2020-07-23T08:31:33Z", "message": "Merge commit '2422c189216f0518bd5b8f788015781e36684c41' into XRDDEV-1183-client-flow-improvement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "402893e2a9e9c34058ad271e39906b730a979fa4", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/402893e2a9e9c34058ad271e39906b730a979fa4", "committedDate": "2020-07-23T08:43:07Z", "message": "XRDDEV-1183 Fix comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0efbe7abb78b253c843893b4445ad79606136c96", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/0efbe7abb78b253c843893b4445ad79606136c96", "committedDate": "2020-07-23T08:45:10Z", "message": "XRDDEV-1183 Update add client flow"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NzI0MDYz", "url": "https://github.com/nordic-institute/X-Road/pull/612#pullrequestreview-454724063", "createdAt": "2020-07-24T08:44:15Z", "commit": {"oid": "0efbe7abb78b253c843893b4445ad79606136c96"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwODo0NDoxNVrOG2nrMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwODo0Njo0NVrOG2nvWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkyNjMyMw==", "bodyText": "This doesn't seem to work, API call that results from this is \"/api/v1/clients/undefined:ORG:TEST/register\" (instance is undefined), resulting in failure to register the client.\nI think this identifier should also include the subsystem that is being added.", "url": "https://github.com/nordic-institute/X-Road/pull/612#discussion_r459926323", "createdAt": "2020-07-24T08:44:15Z", "author": {"login": "raits"}, "path": "src/proxy-ui-api/frontend/src/views/AddClient/FinishPage.vue", "diffHunk": "@@ -115,21 +163,66 @@ export default Vue.extend({\n       this.createClient(true);\n     },\n \n-    generateCsr(): void {\n+    generateKeyAndCsr(): void {\n       const tokenId = this.$store.getters.csrTokenId;\n \n-      this.$store.dispatch('generateKeyAndCsr', tokenId).then(\n-        () => {\n+      this.$store\n+        .dispatch('generateKeyAndCsr', tokenId)\n+        .then(\n+          () => {\n+            this.$emit('done');\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        )\n+        .finally(() => {\n           this.disableCancel = false;\n           this.submitLoading = false;\n-          this.$emit('done');\n-        },\n-        (error) => {\n-          this.$store.dispatch('showError', error);\n+        });\n+    },\n+\n+    generateCsr(): void {\n+      const tokenId = this.$store.getters.csrTokenId;\n+\n+      this.$store\n+        .dispatch('generateCsr', tokenId)\n+        .then(\n+          () => {\n+            this.$emit('done');\n+          },\n+          (error) => {\n+            this.$store.dispatch('showError', error);\n+          },\n+        )\n+        .finally(() => {\n           this.disableCancel = false;\n           this.submitLoading = false;\n-        },\n+        });\n+    },\n+\n+    registerClient(): void {\n+      const clientId = createClientId(\n+        this.currentSecurityServer.instanceId,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0efbe7abb78b253c843893b4445ad79606136c96"}, "originalPosition": 143}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTkyNzM4NQ==", "bodyText": "This doesn't seem to be used anymore, maybe it should be removed?", "url": "https://github.com/nordic-institute/X-Road/pull/612#discussion_r459927385", "createdAt": "2020-07-24T08:46:45Z", "author": {"login": "raits"}, "path": "src/proxy-ui-api/frontend/src/views/AddClient/ClientDetailsPage.vue", "diffHunk": "@@ -180,9 +185,9 @@ export default Vue.extend({\n   data() {\n     return {\n       disableDone: false,\n-      certificationService: undefined,\n       filteredServiceList: [],", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0efbe7abb78b253c843893b4445ad79606136c96"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "055304a5b0284f1a124014fe5cd697d8c112d857", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/055304a5b0284f1a124014fe5cd697d8c112d857", "committedDate": "2020-07-24T11:18:28Z", "message": "XRDDEV-1183 Fixes for PR issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5e9d2b2c6831ebc5f0b544e2db048e6edc79993", "author": {"user": {"login": "Riippi", "name": "Mikko Riippi"}}, "url": "https://github.com/nordic-institute/X-Road/commit/d5e9d2b2c6831ebc5f0b544e2db048e6edc79993", "committedDate": "2020-07-24T12:15:24Z", "message": "XRDDEV-1183 Fix missing parameter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0ODUyNDAw", "url": "https://github.com/nordic-institute/X-Road/pull/612#pullrequestreview-454852400", "createdAt": "2020-07-24T12:39:25Z", "commit": {"oid": "d5e9d2b2c6831ebc5f0b544e2db048e6edc79993"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4150, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}