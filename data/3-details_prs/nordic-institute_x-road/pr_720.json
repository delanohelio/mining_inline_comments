{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkwMzIxODMw", "number": 720, "title": "XRDDEV-1272-and-665 OpenAPI Documentation", "bodyText": "Includes two very similar JIRA tasks.\n\nImprove docs for all endpoints that can return warnings or error metadata.\nAdd examples of different error and warning responses\nAdd better requestBody examples.\nClean unused schemas.\n\nJIRA: https://jira.niis.org/browse/XRDDEV-1272\nJIRA: https://jira.niis.org/browse/XRDDEV-665\nSwaggerHub (to see the improvements in action): https://app.swaggerhub.com/apis/Gofore/X-Road/1.0.30", "createdAt": "2020-09-21T14:03:05Z", "url": "https://github.com/nordic-institute/X-Road/pull/720", "merged": true, "mergeCommit": {"oid": "158a273299f1e88fa5f2ff11a48c5571f8cfc3e2"}, "closed": true, "closedAt": "2020-10-22T07:31:32Z", "author": {"login": "carohauta"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJZw2KAH2gAyNDkwMzIxODMwOjg1MGUwYWFhNzM1NDhlOWZhODM4ZWM0NGE4ZGE5NjAzMDg3NGZlNDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUrlfHgFqTUxMzU3MDIzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "850e0aaa73548e9fa838ec44a8da96030874fe42", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/850e0aaa73548e9fa838ec44a8da96030874fe42", "committedDate": "2020-09-16T10:23:32Z", "message": "XRDDEV-1272 Document all warnings in the API definition\n\n* also fix one list init in ServiceDescriptionService"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4938b797b575916733c103c47c96bcf3d747acc", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/a4938b797b575916733c103c47c96bcf3d747acc", "committedDate": "2020-09-16T13:00:50Z", "message": "XRDDEV-1272 Better CSR examples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "faad1003fdd9ad4512e7621183aa0cb4260d6b2d", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/faad1003fdd9ad4512e7621183aa0cb4260d6b2d", "committedDate": "2020-09-17T05:49:32Z", "message": "XRDDEV-1272 Better id array examples\n\n* also remove unused schema GlobalConfiguration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94238865ed86950a796752b917d2faf9b5270e68", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/94238865ed86950a796752b917d2faf9b5270e68", "committedDate": "2020-09-17T05:50:18Z", "message": "Merge branch 'develop' into XRDDEV-1272-improve-openapi-docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db730a042e04e8421de850e5007f8fa5f05140dc", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/db730a042e04e8421de850e5007f8fa5f05140dc", "committedDate": "2020-09-17T10:34:43Z", "message": "XRDDEV-665 Fix error responses to objects instead of arrays"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f26dcd7fb1157112aa407c9a99b2d9f14450dcc", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/1f26dcd7fb1157112aa407c9a99b2d9f14450dcc", "committedDate": "2020-09-18T13:11:38Z", "message": "XRDDEV-665 Add error, error metadata, warnings and validation error examples where needed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b333d4e2b46880e39a2e30b050586f0ef6aa516", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/9b333d4e2b46880e39a2e30b050586f0ef6aa516", "committedDate": "2020-09-21T12:58:29Z", "message": "XRDDEV-665 Add error, error metadata, warnings and validation error examples where needed part 2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea8cdc0281eef78b98fb935ba1c1961e60473571", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/ea8cdc0281eef78b98fb935ba1c1961e60473571", "committedDate": "2020-09-21T13:26:01Z", "message": "XRDDEV-665 Add validation error example in github docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37a293b135b23c81ec4a7444c0536cf9b9420fc9", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/37a293b135b23c81ec4a7444c0536cf9b9420fc9", "committedDate": "2020-09-21T13:26:54Z", "message": "Merge branch 'develop' into XRDDEV-665-metadata-documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/067685e5f67ae1cbd60c6095601895431ed63b64", "committedDate": "2020-09-21T14:02:07Z", "message": "XRDDEV-665 Add possible error metadata mentions in endpoint descriptions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3NDAwNTE2", "url": "https://github.com/nordic-institute/X-Road/pull/720#pullrequestreview-497400516", "createdAt": "2020-09-28T10:56:20Z", "commit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxMDo1NjoyMFrOHY4iqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxNTo1MDo1NFrOHZE3kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg1NDI1MQ==", "bodyText": "I think instead of a generic WarningsExample, we should have context-specific examples. Such as\n    AddUnregisterClientWarningExample:\n      summary: response from calling addClient with unregistered client and ignore_warnings = false\n\n{\n    \"status\": 400,\n    \"error\": {\n        \"code\": \"warnings_detected\"\n    },\n    \"warnings\": [\n        {\n            \"code\": \"unregistered_member\",\n            \"metadata\": [\n                \"LXD/ipsu/dese\"\n            ]\n        }\n    ]\n}\n\nEndpoint description \"Adds new client to the system....Attempt to add unregistered member with ignore_warnings....\" explains this but is pretty complicated and average API user will benefit from an example that shows this is practise.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495854251", "createdAt": "2020-09-28T10:56:20Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -738,10 +835,14 @@ paths:\n           content:\n             application/json:\n               schema:\n-                type: array\n-                uniqueItems: true\n-                items:\n-                  $ref: '#/components/schemas/ErrorInfo'\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_response:\n+                  $ref: '#/components/examples/ErrorExample'\n+                warnings_response:\n+                  $ref: '#/components/examples/WarningsExample'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 278}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg1ODk4Ng==", "bodyText": "I think general explanation about the warnings-mechanism should probably be described here, in the SS user guide?\nOpenAPI definition explains how warnings work on the specific endpoints, but the general concept and the rationale behind it would probably be better explained here.\nWithout it, end user might not fully understand why ignore_warnings handling exists, and what it tries to accomplish (offer a possibility to first attempt an update without ignore, then make a decision about possibly ignoring the warning, and proceeding). Without an explanation of the mechanism, end user may just view ignore_warnings as some random frustrating weirdness in the API. And e.g. just always by default set ignore_warnings = true since it seems to make life easier and errors go away.\nThere is some text in https://confluence.niis.org/pages/viewpage.action?pageId=8520435#APIGuidelines&Examples-Warnings that might be usable.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495858986", "createdAt": "2020-09-28T11:06:12Z", "author": {"login": "jansu76"}, "path": "doc/Manuals/ug-ss_x-road_6_security_server_user_guide.md", "diffHunk": "@@ -2143,7 +2144,39 @@ For example, these log messages are related to an API call with correlation ID `\n \n ### 19.4 Validation errors", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg4MDYwMA==", "bodyText": "A context-specific warnings example would be helpful. See AddClient for elaboration.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495880600", "createdAt": "2020-09-28T11:50:56Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -150,6 +164,15 @@ paths:\n           description: item accepted\n         '400':\n           description: request was invalid\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_response:\n+                  $ref: '#/components/examples/ErrorExample'\n+                warnings_response:\n+                  $ref: '#/components/examples/WarningsExample'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg4MjAwMg==", "bodyText": "Add period to improve readability, especially in swaggerhub?\nI wonder if there's any formatting options, like newlines, to make the description more readable, in swaggerhub it is all joined together and not so easy to read when there is a long explanation about how warnings work.\nActually I see now that addClientServiceDescription seems to highlight ignore_warnings as code, that might be good for readability elsewhere too?", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495882002", "createdAt": "2020-09-28T11:53:45Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -123,7 +133,11 @@ paths:\n         - backups\n       summary: upload new backup for the security server\n       operationId: uploadBackup\n-      description: Uploads new security server backup to the system\n+      description: >\n+        Uploads new security server backup to the system", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg4OTkxMA==", "bodyText": "This does not include all warning types. Adding or removing services causes warnings too, at least for WSDL service descriptions.\nI guess same wording could be used for both service description types: (WSDL/OpenAPI3 document) has non-fatal errors that are returned as warnings (or maybe \"has non-fatal errors that may be ignored\"?) Now the different wording for WSDL and OpenAPI3 makes you think there's some conceptual difference, I guess there is not?\nA really good client facing documentation would also explain the difference between a fatal validation error and a non-fatal validation warning. Now it's kind of a mystery. Maybe this file is not the best place for that though. It should be somewhere...not sure...maybe it does not exist at the moment?", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495889910", "createdAt": "2020-09-28T12:09:42Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -1555,14 +1708,29 @@ paths:\n           description: resource requested does not exists\n         '406':\n           description: request specified an invalid format\n+        '409':\n+          description: an existing item already exists\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_metadata_response:\n+                  $ref: '#/components/examples/ErrorWithMetadataExample'\n         '500':\n           description: internal server error\n     post: # ok\n       tags:\n         - clients\n       summary: add new service description for the security server client\n       operationId: addClientServiceDescription\n-      description: Administrator adds a new service description for the client.\n+      description: >\n+        Administrator adds a new service description for the client. This endpoint can also return metadata in the error response.\n+        The metadata array can contain error messages about why adding the service description did not succeed.\n+        This endpoint can return a warnings response which can be ignored by setting `ServiceDescriptionAdd.ignore_warnings` = true.\n+        If ServiceDescriptionAdd.ignore_warnings = false, a warnings response will be returned if any one of the following conditions is true:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 430}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg5MTA0OQ==", "bodyText": "A context-specific warnings example would be helpful. See AddClient for elaboration.\nThere could even be multiple examples: one for adding / removing services (which the WarningsExample really is) and one for non-fatal validation warnings.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495891049", "createdAt": "2020-09-28T12:11:52Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -1590,10 +1758,17 @@ paths:\n           content:\n             application/json:\n               schema:\n-                type: array\n-                uniqueItems: true\n-                items:\n-                  $ref: '#/components/schemas/ErrorInfo'\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_response:\n+                  $ref: '#/components/examples/ErrorExample'\n+                error_metadata_response:\n+                  $ref: '#/components/examples/ErrorWithMetadataExample'\n+                warnings_response:\n+                  $ref: '#/components/examples/WarningsExample'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 451}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg5MTU4OQ==", "bodyText": "A context-specific warnings example would be helpful. See AddClient for elaboration.\nThere could even be multiple examples.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495891589", "createdAt": "2020-09-28T12:12:54Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -1838,6 +2039,19 @@ paths:\n           description: security server initialized\n         '400':\n           description: request was invalid\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_response:\n+                  $ref: '#/components/examples/ErrorExample'\n+                error_metadata_response:\n+                  $ref: '#/components/examples/ErrorWithMetadataExample'\n+                warnings_response:\n+                  $ref: '#/components/examples/WarningsExample'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 530}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg5MjUwMg==", "bodyText": "A context-specific warnings example would be helpful. See AddClient for elaboration.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495892502", "createdAt": "2020-09-28T12:14:40Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -2166,6 +2381,17 @@ paths:\n           description: key deletion was successful\n         '400':\n           description: request was invalid\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_response:\n+                  $ref: '#/components/examples/ErrorExample'\n+                error_metadata_response:\n+                  $ref: '#/components/examples/ErrorWithMetadataExample'\n+                warnings_response:\n+                  $ref: '#/components/examples/WarningsExample'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 560}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg5MzUyMA==", "bodyText": "A context-specific warnings example would be helpful. See AddClient for elaboration.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495893520", "createdAt": "2020-09-28T12:16:29Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -2723,6 +2966,15 @@ paths:\n                 $ref: '#/components/schemas/Service'\n         '400':\n           description: request was invalid\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_response:\n+                  $ref: '#/components/examples/ErrorExample'\n+                warnings_response:\n+                  $ref: '#/components/examples/WarningsExample'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 616}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg5NDE1MQ==", "bodyText": "A context-specific warnings example would be helpful. See AddClient for elaboration.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495894151", "createdAt": "2020-09-28T12:17:44Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -3339,10 +3747,14 @@ paths:\n           content:\n             application/json:\n               schema:\n-                type: array\n-                uniqueItems: true\n-                items:\n-                  $ref: '#/components/schemas/ErrorInfo'\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_response:\n+                  $ref: '#/components/examples/ErrorExample'\n+                error_metadata_response:\n+                  $ref: '#/components/examples/ErrorWithMetadataExample'\n+                warnings_response:\n+                  $ref: '#/components/examples/WarningsExample'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 1012}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTg5NTc1OQ==", "bodyText": "A context-specific warnings example would be helpful. See AddClient for elaboration.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495895759", "createdAt": "2020-09-28T12:20:45Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -3196,10 +3583,16 @@ paths:\n           content:\n             application/json:\n               schema:\n-                type: array\n-                uniqueItems: true\n-                items:\n-                  $ref: '#/components/schemas/ErrorInfo'\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_response:\n+                  $ref: '#/components/examples/ErrorExample'\n+                error_metadata_response:\n+                  $ref: '#/components/examples/ErrorWithMetadataExample'\n+                warnings_response:\n+                  $ref: '#/components/examples/WarningsExample'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 960}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTkyNjQwMA==", "bodyText": "Should specify metadata on the detail level that enables API client to utilize the metadata, example from   https://jira.niis.org/browse/XRDDEV-665\n{\n   \"status\": 409,\n   \"error\": {\n     \"code\": \"service_already_exists\",\n     \"metadata\": [\n       \"duplicateService.v1\",\n       \"http://xroad-lxd-cs.lxd/duplicate1.wsdl\"\n     ]\n   }\n }\n\n\nwhen conflict 409 about duplicate service happens, error code service_already_exists is used and\nmetadata has a list of strings C1,U1,C2,U2....Cn,Un where\nC1 = duplicate service full code\nU1 = URL of the existing WSDL that has the duplicate\n\nSimilar documentation should be added to all error and warning metadata. It might be good to use context-specific error metadata examples (at least in more complex cases)?\nThere are some cases where metadata is used even if it is not really called for, for example metadata contains human-readable error messages. I think these should be fixed, and there is probably no point in documenting them in API definition.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r495926400", "createdAt": "2020-09-28T13:10:40Z", "author": {"login": "jansu76"}, "path": "src/proxy-ui-api/src/main/resources/openapi-definition.yaml", "diffHunk": "@@ -1555,14 +1708,29 @@ paths:\n           description: resource requested does not exists\n         '406':\n           description: request specified an invalid format\n+        '409':\n+          description: an existing item already exists\n+          content:\n+            application/json:\n+              schema:\n+                $ref: '#/components/schemas/ErrorInfo'\n+              examples:\n+                error_metadata_response:\n+                  $ref: '#/components/examples/ErrorWithMetadataExample'\n         '500':\n           description: internal server error\n     post: # ok\n       tags:\n         - clients\n       summary: add new service description for the security server client\n       operationId: addClientServiceDescription\n-      description: Administrator adds a new service description for the client.\n+      description: >\n+        Administrator adds a new service description for the client. This endpoint can also return metadata in the error response.\n+        The metadata array can contain error messages about why adding the service description did not succeed.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 428}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA1MjE2NA==", "bodyText": "The following lines are not part of this PR, but are related to acceptance criteria, and anyway since we're already at the topic....\n\nIn addition to the validation messages declared in Java Validation API, the following validation errors are possible\n\nHow about a table with simple one sentence explanations (maybe just the defaultMessage) about each custom validation error type? Granted most are pretty self-explanatory, but Normalized is probably not.\nAlso, is the list up to date? IdentifierValidationErrorInfo seems to think there is NoControlChars instead of Normalized?", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r496052164", "createdAt": "2020-09-28T15:45:02Z", "author": {"login": "jansu76"}, "path": "doc/Manuals/ug-ss_x-road_6_security_server_user_guide.md", "diffHunk": "@@ -2143,7 +2144,39 @@ For example, these log messages are related to an API call with correlation ID `\n \n ### 19.4 Validation errors\n \n-An error response from the REST API can include validation errors if an unsupported parameter was provided with the request. \n+An error response from the REST API can include validation errors if an unsupported parameter was provided with the request.\n+When \n+\n+Example request and response of adding a new subsystem with illegal characters:\n+```\n+POST https://ss1:4100/api/v1/clients\n+\n+Request body:\n+{\n+  \"client\": {\n+    \"member_class\": \"ORG\",\n+    \"member_code\": \"0/1234\",\n+    \"subsystem_code\": \"Subsystem%Code\"\n+  },\n+  \"ignore_warnings\": false\n+}\n+\n+Response body:\n+{\n+  \"error\": {\n+    \"code\": \"validation_failure\",\n+    \"validation_errors\": {\n+      \"clientAdd.client.memberCode\": [\n+        \"NoForwardslashes\"\n+      ],\n+      \"clientAdd.client.subsystemCode\": [\n+        \"NoPercents\"\n+      ]\n+    }\n+  },\n+  \"status\": 400\n+}\n+```", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA1NjIxMA==", "bodyText": "It would also be good to make \"Java Validation API\" a proper external reference", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r496056210", "createdAt": "2020-09-28T15:50:54Z", "author": {"login": "jansu76"}, "path": "doc/Manuals/ug-ss_x-road_6_security_server_user_guide.md", "diffHunk": "@@ -2143,7 +2144,39 @@ For example, these log messages are related to an API call with correlation ID `\n \n ### 19.4 Validation errors\n \n-An error response from the REST API can include validation errors if an unsupported parameter was provided with the request. \n+An error response from the REST API can include validation errors if an unsupported parameter was provided with the request.\n+When \n+\n+Example request and response of adding a new subsystem with illegal characters:\n+```\n+POST https://ss1:4100/api/v1/clients\n+\n+Request body:\n+{\n+  \"client\": {\n+    \"member_class\": \"ORG\",\n+    \"member_code\": \"0/1234\",\n+    \"subsystem_code\": \"Subsystem%Code\"\n+  },\n+  \"ignore_warnings\": false\n+}\n+\n+Response body:\n+{\n+  \"error\": {\n+    \"code\": \"validation_failure\",\n+    \"validation_errors\": {\n+      \"clientAdd.client.memberCode\": [\n+        \"NoForwardslashes\"\n+      ],\n+      \"clientAdd.client.subsystemCode\": [\n+        \"NoPercents\"\n+      ]\n+    }\n+  },\n+  \"status\": 400\n+}\n+```", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjA1MjE2NA=="}, "originalCommit": {"oid": "067685e5f67ae1cbd60c6095601895431ed63b64"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0a138d8c9ea7255c3c53b68e4ad1b53acb00d6a", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/e0a138d8c9ea7255c3c53b68e4ad1b53acb00d6a", "committedDate": "2020-10-09T06:56:41Z", "message": "XRDDEV-665 Context specific API warning examples"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20cbd05ce21a77e37417dc0b9c6d0202058cc293", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/20cbd05ce21a77e37417dc0b9c6d0202058cc293", "committedDate": "2020-10-13T09:41:34Z", "message": "XRDDEV-665 Context specific API warning examples part 2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f843be849eda8c50f76f4f38edeadddd56a6b7a", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/6f843be849eda8c50f76f4f38edeadddd56a6b7a", "committedDate": "2020-10-13T11:02:31Z", "message": "XRDDEV-665 Add warnings section to the user guide"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca7064aa6fc3cfa58614ecd17ec1e7851ada7ea4", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/ca7064aa6fc3cfa58614ecd17ec1e7851ada7ea4", "committedDate": "2020-10-13T13:08:39Z", "message": "XRDDEV-665 Format all endpoint descriptions properly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1fd2f774391c213fff7d30307d4818a8092bb7e", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/b1fd2f774391c213fff7d30307d4818a8092bb7e", "committedDate": "2020-10-13T14:48:52Z", "message": "XRDDEV-665 Remove endpoint id from conflict exception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e858273585e5be2d2c05234cacda614ee84f8e24", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/e858273585e5be2d2c05234cacda614ee84f8e24", "committedDate": "2020-10-13T14:49:29Z", "message": "XRDDEV-665 Add better metadata docs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe5bfc1bdb14ff79066362e211f803ef2137ad0d", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/fe5bfc1bdb14ff79066362e211f803ef2137ad0d", "committedDate": "2020-10-13T15:13:07Z", "message": "XRDDEV-665 Add better metadata docs for initialization"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a986bcf66d48a49518a7edb4b0ad2827c17ff39d", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/a986bcf66d48a49518a7edb4b0ad2827c17ff39d", "committedDate": "2020-10-14T05:43:02Z", "message": "Merge branch 'develop' into XRDDEV-665-metadata-documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NDM3NjU0", "url": "https://github.com/nordic-institute/X-Road/pull/720#pullrequestreview-509437654", "createdAt": "2020-10-15T14:24:35Z", "commit": {"oid": "a986bcf66d48a49518a7edb4b0ad2827c17ff39d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNDoyNDozNlrOHiKfow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNDoyNDozNlrOHiKfow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU4NTU3MQ==", "bodyText": "Suggestion, would slight rewording make this easier to understand?\n\n\nIf the warnings can be ignored, client resends the REST request, but with ignore_warnings parameter set to true. If the request was sent via the admin UI and a warning popup with the CONTINUE button is shown, clicking the button will ignore warnings and proceed to executing the operation\n\n\n->\n\n\nIf the warnings can be ignored, client resends the REST request, but with ignore_warnings parameter set to true. If the original request was sent via the admin UI and a warning popup with the CONTINUE button was shown, clicking the button will cause this resending to happen.\n\n\nOr, alternatively, maybe remove mentions of admin UI from steps 1-5 and explain how admin UI handles this via popup, after 1-5. At current form step 4 is maybe a bit confusing as it combines explaining \"general client\" and \"concrete admin UI\" cases, I feel.", "url": "https://github.com/nordic-institute/X-Road/pull/720#discussion_r505585571", "createdAt": "2020-10-15T14:24:36Z", "author": {"login": "jansu76"}, "path": "doc/Manuals/ug-ss_x-road_6_security_server_user_guide.md", "diffHunk": "@@ -2143,18 +2146,83 @@ For example, these log messages are related to an API call with correlation ID `\n \n ### 19.4 Validation errors\n \n-An error response from the REST API can include validation errors if an unsupported parameter was provided with the request. \n+An error response from the REST API can include validation errors if an unsupported parameter was provided with the request.\n+When \n \n-In addition to the validation messages declared in Java Validation API, the following validation errors are possible:\n+Example request and response of adding a new subsystem with illegal characters:\n ```\n-Normalized\n+POST https://ss1:4100/api/v1/clients\n+\n+Request body:\n+{\n+  \"client\": {\n+    \"member_class\": \"ORG\",\n+    \"member_code\": \"0/1234\",\n+    \"subsystem_code\": \"Subsystem%Code\"\n+  },\n+  \"ignore_warnings\": false\n+}\n+\n+Response body:\n+{\n+  \"error\": {\n+    \"code\": \"validation_failure\",\n+    \"validation_errors\": {\n+      \"clientAdd.client.memberCode\": [\n+        \"NoForwardslashes\"\n+      ],\n+      \"clientAdd.client.subsystemCode\": [\n+        \"NoPercents\"\n+      ]\n+    }\n+  },\n+  \"status\": 400\n+}\n+```\n+\n+In addition to the validation messages declared in [Java Validation API](https://javaee.github.io/javaee-spec/javadocs/javax/validation/constraints/package-summary.html), the following validation errors are possible:\n+```\n+NoControlChars\n NoColons\n NoSemicolons\n NoForwardslashes\n NoBackslashes\n NoPercents\n ```\n \n+### 19.5 Warning responses\n+\n+Error response from the Management API can include additional warnings that you can ignore if seen necessary. The warnings can be ignored by your decision, by executing the same operation with `ignore_warnings` boolean parameter set to `true`. *Always consider the warning before making the decision to ignore it.* \n+\n+An example case:\n+1. Client executes a REST request, without `ignore_warnings` parameter, to backend\n+2. Backend notices warnings and responds with error message that contains the warnings. Nothing is updated at this point\n+3. Client determines if warnings can be ignored. If the request was sent via the admin UI, a popup with `CONTINUE` button is shown\n+4. If the warnings can be ignored, client resends the REST request, but with `ignore_warnings` parameter set to `true`. If the request was sent via the admin UI and a warning popup with the `CONTINUE` button is shown, clicking the button will ignore warnings and proceed to executing the operation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a986bcf66d48a49518a7edb4b0ad2827c17ff39d"}, "originalPosition": 85}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75ac80d41a183e8218cd811d3c118565e7cdbc7f", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/75ac80d41a183e8218cd811d3c118565e7cdbc7f", "committedDate": "2020-10-19T11:22:20Z", "message": "Merge branch 'develop' into XRDDEV-665-metadata-documentation\n\n# Conflicts:\n#\tdoc/Manuals/ug-ss_x-road_6_security_server_user_guide.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f707ea971c8937ae4e299c9e2a5d224a9de7db25", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/f707ea971c8937ae4e299c9e2a5d224a9de7db25", "committedDate": "2020-10-19T12:25:25Z", "message": "XRDDEV-665 Update validation errors chapter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9a4946ec68f1afe56ebe99c27cf692088309a8c", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/f9a4946ec68f1afe56ebe99c27cf692088309a8c", "committedDate": "2020-10-19T12:28:08Z", "message": "XRDDEV-665 Update validation errors chapter part 2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c291efdecf1edd4c13a8aad068784c272c3fd1b2", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/c291efdecf1edd4c13a8aad068784c272c3fd1b2", "committedDate": "2020-10-19T12:52:36Z", "message": "XRDDEV-665 Warning mechanism in the admin UI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c4dd09c98b5451e69125c888e25e49a84a8eb8e", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/4c4dd09c98b5451e69125c888e25e49a84a8eb8e", "committedDate": "2020-10-19T15:14:10Z", "message": "XRDDEV-665 More specific warnings and error metadata descriptions\n\n* also changed OpenAPI parser warning code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6d111eee4f3eddaaf508791143842b62f94f588", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/b6d111eee4f3eddaaf508791143842b62f94f588", "committedDate": "2020-10-20T17:28:36Z", "message": "XRDDEV-665 Add missing error metadata description and remove redundants"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "042c67533cadebfa6ea1c6c4f3fcc0568960496c", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/042c67533cadebfa6ea1c6c4f3fcc0568960496c", "committedDate": "2020-10-20T17:35:02Z", "message": "XRDDEV-665 Add disclaimer about metadatas"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b094977e95466c97d4e8786236379bc9cbf85f0d", "author": {"user": {"login": "carohauta", "name": "Caro Hautam\u00e4ki"}}, "url": "https://github.com/nordic-institute/X-Road/commit/b094977e95466c97d4e8786236379bc9cbf85f0d", "committedDate": "2020-10-21T11:20:37Z", "message": "XRDDEV-665 Fix service description example references"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEzNTcwMjM1", "url": "https://github.com/nordic-institute/X-Road/pull/720#pullrequestreview-513570235", "createdAt": "2020-10-21T11:22:35Z", "commit": {"oid": "b094977e95466c97d4e8786236379bc9cbf85f0d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4080, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}