{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMyOTk0NTI5", "number": 3396, "title": "Suggester rebuild terminate on undeploy", "bodyText": "This should take care of the long wait on undeploy when there is a number of outstanding suggester rebuild jobs.\nIt does so by setting a flag so if there is a long running rebuild in progress already it will still wait for that. That would be the case also when shutting down an executor (interrupting the threads by shutting the executor down immediately would not be a good practice).", "createdAt": "2020-12-05T10:24:00Z", "url": "https://github.com/oracle/opengrok/pull/3396", "merged": true, "mergeCommit": {"oid": "f1379d6e526c53d055d727b6452e99de920130d1"}, "closed": true, "closedAt": "2020-12-08T18:28:56Z", "author": {"login": "vladak"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdjJrG-gH2gAyNTMyOTk0NTI5OjNjOWE2ZDM5YmQyYThhMGVkOTM1NDQ5NGNkNzE2NmRmYzRmOTliODc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkNddRgFqTU0NzQ1NTE4MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3c9a6d39bd2a8a0ed9354494cd7166dfc4f99b87", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/3c9a6d39bd2a8a0ed9354494cd7166dfc4f99b87", "committedDate": "2020-12-05T10:20:49Z", "message": "do not start rebuild jobs once webapp is undeployed\n\nfixes #3395"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62b8e45d3cd5ddf17881b0855c28f4c6fde8dfdf", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/62b8e45d3cd5ddf17881b0855c28f4c6fde8dfdf", "committedDate": "2020-12-05T10:21:24Z", "message": "rename logger -> LOGGER"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NzI3NjU3", "url": "https://github.com/oracle/opengrok/pull/3396#pullrequestreview-545727657", "createdAt": "2020-12-06T16:55:48Z", "commit": {"oid": "62b8e45d3cd5ddf17881b0855c28f4c6fde8dfdf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNlQxNjo1NTo0OFrOIAMu0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNlQxNjo1NTo0OFrOIAMu0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzA3OTUwNA==", "bodyText": "What would you think about also short-circuiting the init- and rebuild-runnables to check terminating?", "url": "https://github.com/oracle/opengrok/pull/3396#discussion_r537079504", "createdAt": "2020-12-06T16:55:48Z", "author": {"login": "idodeclare"}, "path": "suggester/src/main/java/org/opengrok/suggest/Suggester.java", "diffHunk": "@@ -278,8 +279,12 @@ public void rebuild(final Collection<NamedIndexDir> indexDirs) {\n         rebuildLock.unlock();\n \n         synchronized (lock) {\n+            if (terminating) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62b8e45d3cd5ddf17881b0855c28f4c6fde8dfdf"}, "originalPosition": 96}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "538c9b1f4fce134098324e6cf0f774d46758473d", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/538c9b1f4fce134098324e6cf0f774d46758473d", "committedDate": "2020-12-07T09:59:03Z", "message": "check terminating in init()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2115c1c61b198fc0979859e9069fe81cb7f3ae41", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/2115c1c61b198fc0979859e9069fe81cb7f3ae41", "committedDate": "2020-12-07T10:03:25Z", "message": "more the check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b5f4264b81a1deac088ee265d4f63d5cd7a8c55", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/0b5f4264b81a1deac088ee265d4f63d5cd7a8c55", "committedDate": "2020-12-07T10:18:29Z", "message": "terminate the cycles in init()/rebuild()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ccd600e4edcdea7a05ac952d3c2f967ce6ec4c1", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/0ccd600e4edcdea7a05ac952d3c2f967ce6ec4c1", "committedDate": "2020-12-08T09:03:03Z", "message": "Revert \"terminate the cycles in init()/rebuild()\"\n\nThis reverts commit 0b5f4264b81a1deac088ee265d4f63d5cd7a8c55."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3495007dcf807f538d7f327a29f88f06a4a24b64", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/3495007dcf807f538d7f327a29f88f06a4a24b64", "committedDate": "2020-12-08T09:04:46Z", "message": "check terminating in the runnables"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ3NDU1MTgw", "url": "https://github.com/oracle/opengrok/pull/3396#pullrequestreview-547455180", "createdAt": "2020-12-08T17:19:27Z", "commit": {"oid": "3495007dcf807f538d7f327a29f88f06a4a24b64"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 137, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}