{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk5MzM2ODcx", "number": 3269, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNTozNzoxMlrOErPS6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODozODo1N1rOErvjWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzNzc0ODI2OnYy", "diffSide": "RIGHT", "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNTozNzoxMlrOHd5eUA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNTo0NDoyOVrOHd5zbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExMjQwMA==", "bodyText": "I wonder if this is going to work well w.r.t. caching. So far we relied on the version number to change I think.", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501112400", "createdAt": "2020-10-07T15:37:12Z", "author": {"login": "vladak"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";\n         }\n \n     }\n \n     protected static final Map<String, Script> SCRIPTS = new TreeMap<>();\n \n+    private static final WebJarAssetLocator assetLocator = new WebJarAssetLocator();\n+\n     /**\n      * Aliases for the page scripts. The path in the FileScript is relatively to\n      * the request's context path.\n      *\n      * @see HttpServletRequest#getContextPath()\n      */\n     static {\n-        putjs(\"jquery\", \"js/jquery-3.4.1\", 10);\n+        putFromWebJar(\"jquery\", \"jquery.min.js\", 10);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNDA0MQ==", "bodyText": "The final code looks like this so version is still there :)\n<script type=\"text/javascript\" src=\"/opengrok_web_war/webjars/jquery/3.5.1/jquery.min.js\" data-priority=\"10\"</script>", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501114041", "createdAt": "2020-10-07T15:39:29Z", "author": {"login": "ahornace"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";\n         }\n \n     }\n \n     protected static final Map<String, Script> SCRIPTS = new TreeMap<>();\n \n+    private static final WebJarAssetLocator assetLocator = new WebJarAssetLocator();\n+\n     /**\n      * Aliases for the page scripts. The path in the FileScript is relatively to\n      * the request's context path.\n      *\n      * @see HttpServletRequest#getContextPath()\n      */\n     static {\n-        putjs(\"jquery\", \"js/jquery-3.4.1\", 10);\n+        putFromWebJar(\"jquery\", \"jquery.min.js\", 10);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExMjQwMA=="}, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNDY2Nw==", "bodyText": "Yes, caching.", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501114667", "createdAt": "2020-10-07T15:40:18Z", "author": {"login": "tulinkry"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";\n         }\n \n     }\n \n     protected static final Map<String, Script> SCRIPTS = new TreeMap<>();\n \n+    private static final WebJarAssetLocator assetLocator = new WebJarAssetLocator();\n+\n     /**\n      * Aliases for the page scripts. The path in the FileScript is relatively to\n      * the request's context path.\n      *\n      * @see HttpServletRequest#getContextPath()\n      */\n     static {\n-        putjs(\"jquery\", \"js/jquery-3.4.1\", 10);\n+        putFromWebJar(\"jquery\", \"jquery.min.js\", 10);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExMjQwMA=="}, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNjMxNQ==", "bodyText": "I'll probably need to modify ExpiresOneDayFilter to include /webjars.", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501116315", "createdAt": "2020-10-07T15:42:31Z", "author": {"login": "ahornace"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";\n         }\n \n     }\n \n     protected static final Map<String, Script> SCRIPTS = new TreeMap<>();\n \n+    private static final WebJarAssetLocator assetLocator = new WebJarAssetLocator();\n+\n     /**\n      * Aliases for the page scripts. The path in the FileScript is relatively to\n      * the request's context path.\n      *\n      * @see HttpServletRequest#getContextPath()\n      */\n     static {\n-        putjs(\"jquery\", \"js/jquery-3.4.1\", 10);\n+        putFromWebJar(\"jquery\", \"jquery.min.js\", 10);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExMjQwMA=="}, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNzgwNw==", "bodyText": "Then it would be ok I guess.", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501117807", "createdAt": "2020-10-07T15:44:29Z", "author": {"login": "tulinkry"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";\n         }\n \n     }\n \n     protected static final Map<String, Script> SCRIPTS = new TreeMap<>();\n \n+    private static final WebJarAssetLocator assetLocator = new WebJarAssetLocator();\n+\n     /**\n      * Aliases for the page scripts. The path in the FileScript is relatively to\n      * the request's context path.\n      *\n      * @see HttpServletRequest#getContextPath()\n      */\n     static {\n-        putjs(\"jquery\", \"js/jquery-3.4.1\", 10);\n+        putFromWebJar(\"jquery\", \"jquery.min.js\", 10);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExMjQwMA=="}, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzNzc3MzMwOnYy", "diffSide": "RIGHT", "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNTo0MjozMFrOHd5thQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wN1QxNTo1Njo1NVrOHd6WvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNjI5Mw==", "bodyText": "I didn't know + was better than a builder", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501116293", "createdAt": "2020-10-07T15:42:30Z", "author": {"login": "tulinkry"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExODUzNg==", "bodyText": "better = faster ?", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501118536", "createdAt": "2020-10-07T15:45:26Z", "author": {"login": "vladak"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNjI5Mw=="}, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExODU5Mg==", "bodyText": "String concatenation uses StringBuilder in the backend so there is no performance gain but it's shorter this way.", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501118592", "createdAt": "2020-10-07T15:45:31Z", "author": {"login": "ahornace"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNjI5Mw=="}, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTEyMDQ2OQ==", "bodyText": "In this case the builder approach was slightly more readable for me however that's probably just a matter of taste.", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501120469", "createdAt": "2020-10-07T15:48:04Z", "author": {"login": "vladak"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNjI5Mw=="}, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTEyMjA5MQ==", "bodyText": "This was suggested by IDEA and I thought removing the clutter is better but I can revert it back :)", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501122091", "createdAt": "2020-10-07T15:50:22Z", "author": {"login": "ahornace"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNjI5Mw=="}, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTEyNjg0NA==", "bodyText": "Ok", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501126844", "createdAt": "2020-10-07T15:56:55Z", "author": {"login": "tulinkry"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/Scripts.java", "diffHunk": "@@ -86,27 +89,27 @@ public FileScript(String script, int priority) {\n \n         @Override\n         public String toHtml() {\n-            StringBuilder builder = new StringBuilder();\n-            builder.append(\"\\t<script type=\\\"text/javascript\\\" src=\\\"\");\n-            builder.append(this.getScriptData());\n-            builder.append(\"\\\" data-priority=\\\"\");\n-            builder.append(this.getPriority());\n-            builder.append(\"\\\"></script>\\n\");\n-            return builder.toString();\n+            return \"\\t<script type=\\\"text/javascript\\\" src=\\\"\" +\n+                    this.getScriptData() +\n+                    \"\\\" data-priority=\\\"\" +\n+                    this.getPriority() +\n+                    \"\\\"></script>\\n\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTExNjI5Mw=="}, "originalCommit": {"oid": "970368ef493d36762dfb95ad282019ffbb6a51a7"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE0MzAzMzIzOnYy", "diffSide": "RIGHT", "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODozODo1N1rOHerpXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODozODo1N1rOHerpXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkzNDQzMQ==", "bodyText": "there you go :-)", "url": "https://github.com/oracle/opengrok/pull/3269#discussion_r501934431", "createdAt": "2020-10-08T18:38:57Z", "author": {"login": "vladak"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -80,6 +80,7 @@ public String toString() {\n             return messageLevelString;\n         }\n \n+        @SuppressWarnings(\"rawtypes\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07bd0b3fc065b2048470df46b2942516609bae06"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4984, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}