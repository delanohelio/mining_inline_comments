{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4OTkzNzgx", "number": 3011, "title": "Messages class rework", "bodyText": "This change makes message class levels first class citizens and propagates them to the UI so that the color reflects the highest message level for given project.\nMost of the changes were done in 2019 so leaving the copyright year as is.\nExample with 2 messages (info + error):\n\nI also verified search results case and directory listing view.", "createdAt": "2020-01-03T13:46:52Z", "url": "https://github.com/oracle/opengrok/pull/3011", "merged": true, "mergeCommit": {"oid": "57396dcb69c9b0521bc58f615ccd0bf7c141a544"}, "closed": true, "closedAt": "2020-01-15T14:59:36Z", "author": {"login": "vladak"}, "timelineItems": {"totalCount": 37, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb2rvjhAH2gAyMzU4OTkzNzgxOjRkYTMwNWE0ODUzMzE3ZTJiODEwYTRmZDk2MTVlZGU0YjgyZjNmNzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6mc19AH2gAyMzU4OTkzNzgxOmJhYzUzMDJmNzI1Y2IwNzczM2I0ZDY3YjkyOWEyOWE5NTVhNjk3ZmU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4da305a4853317e2b810a4fd9615ede4b82f3f72", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/4da305a4853317e2b810a4fd9615ede4b82f3f72", "committedDate": "2020-01-03T10:24:42Z", "message": "convert Message#cssClass to enum and check values"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b100736a6713c7da285466047a1fe1cbb0e0789", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/4b100736a6713c7da285466047a1fe1cbb0e0789", "committedDate": "2020-01-03T10:24:42Z", "message": "add test for invalid cssClass"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7365a438fc5e84382ab7b88ecbf660a52c52ad8c", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/7365a438fc5e84382ab7b88ecbf660a52c52ad8c", "committedDate": "2020-01-03T10:24:42Z", "message": "add getHighestCssClassLevel()\n\nplus test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec68aca65e20c791da344ed5ec3445594821a90f", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/ec68aca65e20c791da344ed5ec3445594821a90f", "committedDate": "2020-01-03T13:32:38Z", "message": "use distinct tags so that messages appear individually"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0890bb960b0b070fd577006588725945b66d650c", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/0890bb960b0b070fd577006588725945b66d650c", "committedDate": "2020-01-03T13:33:05Z", "message": "basic work on getting CSS classes reflected in the UI (JSP only)\n\n- move getHighestCssClassLevel to MessagesUtils\n- introduce basic CSS styles\n\nfixes #2974"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42447496730d2d2183e57d2d1e9e59eaca88ce22", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/42447496730d2d2183e57d2d1e9e59eaca88ce22", "committedDate": "2020-01-03T13:33:05Z", "message": "add note style to autocomplete error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a726308e91ff7befa0c127cf1c16d2efb13653d2", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/a726308e91ff7befa0c127cf1c16d2efb13653d2", "committedDate": "2020-01-03T13:33:05Z", "message": "add message level for SOL"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fde1380c5134a5f413e341cd7efc3c6af5efbc4d", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/fde1380c5134a5f413e341cd7efc3c6af5efbc4d", "committedDate": "2020-01-03T13:33:05Z", "message": "bump SOL ver"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "38487b850f2ab98afce84d228d5aef4868228447", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/38487b850f2ab98afce84d228d5aef4868228447", "committedDate": "2020-01-03T13:33:05Z", "message": "bump utils ver"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4ODYzODY1", "url": "https://github.com/oracle/opengrok/pull/3011#pullrequestreview-338863865", "createdAt": "2020-01-06T20:02:56Z", "commit": {"oid": "38487b850f2ab98afce84d228d5aef4868228447"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQyMDowMjo1NlrOFanzXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQyMDowNzoxM1rOFan5rQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQ1OTQyMg==", "bodyText": "I think I've never seen a java method starting with capital letter", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363459422", "createdAt": "2020-01-06T20:02:56Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -50,7 +50,44 @@\n     @NotEmpty(message = \"tags cannot be empty\")\n     private Set<String> tags = Collections.singleton(MESSAGES_MAIN_PAGE_TAG);\n \n-    private String cssClass = \"info\";\n+    public enum CssClassType {\n+        /**\n+         * Known values: SUCCESS, INFO, WARNING, ERROR.\n+         * The values are sorted according to their level. Higher numeric value of the level (i.e. the enum ordinal)\n+         * means higher priority.\n+         */\n+        SUCCESS(\"success\"), INFO(\"info\"), WARNING(\"warning\"), ERROR(\"error\");\n+\n+        private String cssClassString;\n+\n+        CssClassType(String str) {\n+            cssClassString = str;\n+        }\n+\n+        public static CssClassType StringToCssClassType(String val) throws IllegalArgumentException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38487b850f2ab98afce84d228d5aef4868228447"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQ1OTcyNw==", "bodyText": "this should be illegal argument as well no? the caller should check for null and assing default INFO", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363459727", "createdAt": "2020-01-06T20:03:43Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -50,7 +50,44 @@\n     @NotEmpty(message = \"tags cannot be empty\")\n     private Set<String> tags = Collections.singleton(MESSAGES_MAIN_PAGE_TAG);\n \n-    private String cssClass = \"info\";\n+    public enum CssClassType {\n+        /**\n+         * Known values: SUCCESS, INFO, WARNING, ERROR.\n+         * The values are sorted according to their level. Higher numeric value of the level (i.e. the enum ordinal)\n+         * means higher priority.\n+         */\n+        SUCCESS(\"success\"), INFO(\"info\"), WARNING(\"warning\"), ERROR(\"error\");\n+\n+        private String cssClassString;\n+\n+        CssClassType(String str) {\n+            cssClassString = str;\n+        }\n+\n+        public static CssClassType StringToCssClassType(String val) throws IllegalArgumentException {\n+            if (val == null) {\n+                return INFO;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38487b850f2ab98afce84d228d5aef4868228447"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQ1OTg2NA==", "bodyText": "there is compareTo of a Comparable interface", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363459864", "createdAt": "2020-01-06T20:04:04Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -50,7 +50,44 @@\n     @NotEmpty(message = \"tags cannot be empty\")\n     private Set<String> tags = Collections.singleton(MESSAGES_MAIN_PAGE_TAG);\n \n-    private String cssClass = \"info\";\n+    public enum CssClassType {\n+        /**\n+         * Known values: SUCCESS, INFO, WARNING, ERROR.\n+         * The values are sorted according to their level. Higher numeric value of the level (i.e. the enum ordinal)\n+         * means higher priority.\n+         */\n+        SUCCESS(\"success\"), INFO(\"info\"), WARNING(\"warning\"), ERROR(\"error\");\n+\n+        private String cssClassString;\n+\n+        CssClassType(String str) {\n+            cssClassString = str;\n+        }\n+\n+        public static CssClassType StringToCssClassType(String val) throws IllegalArgumentException {\n+            if (val == null) {\n+                return INFO;\n+            }\n+            for (CssClassType v : CssClassType.values()) {\n+                if (v.toString().equals(val)) {\n+                    return v;\n+                }\n+            }\n+            throw new IllegalArgumentException(\"class type does not match any known value\");\n+        }\n+\n+        @Override\n+        public String toString() {\n+            return cssClassString;\n+        }\n+\n+        public static int compare(CssClassType c1, CssClassType c2) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38487b850f2ab98afce84d228d5aef4868228447"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQ1OTkyMA==", "bodyText": "you should implement it", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363459920", "createdAt": "2020-01-06T20:04:14Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -50,7 +50,44 @@\n     @NotEmpty(message = \"tags cannot be empty\")\n     private Set<String> tags = Collections.singleton(MESSAGES_MAIN_PAGE_TAG);\n \n-    private String cssClass = \"info\";\n+    public enum CssClassType {\n+        /**\n+         * Known values: SUCCESS, INFO, WARNING, ERROR.\n+         * The values are sorted according to their level. Higher numeric value of the level (i.e. the enum ordinal)\n+         * means higher priority.\n+         */\n+        SUCCESS(\"success\"), INFO(\"info\"), WARNING(\"warning\"), ERROR(\"error\");\n+\n+        private String cssClassString;\n+\n+        CssClassType(String str) {\n+            cssClassString = str;\n+        }\n+\n+        public static CssClassType StringToCssClassType(String val) throws IllegalArgumentException {\n+            if (val == null) {\n+                return INFO;\n+            }\n+            for (CssClassType v : CssClassType.values()) {\n+                if (v.toString().equals(val)) {\n+                    return v;\n+                }\n+            }\n+            throw new IllegalArgumentException(\"class type does not match any known value\");\n+        }\n+\n+        @Override\n+        public String toString() {\n+            return cssClassString;\n+        }\n+\n+        public static int compare(CssClassType c1, CssClassType c2) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQ1OTg2NA=="}, "originalCommit": {"oid": "38487b850f2ab98afce84d228d5aef4868228447"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQ2MTAzNw==", "bodyText": "sounds like a job for flatMap", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363461037", "createdAt": "2020-01-06T20:07:13Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/MessagesUtils.java", "diffHunk": "@@ -230,4 +231,32 @@ private static String messagesToJson(Group group, String... additionalTags) {\n     public static String messagesToJson(Group group) {\n         return messagesToJson(group, new String[0]);\n     }\n+\n+    /**\n+     * @return name of highest cssClass of messages present in the system or null.\n+     */\n+    static String getHighestCssClassLevel(Set<MessagesContainer.AcceptedMessage> messages) {\n+        return messages.\n+                stream().\n+                map(MessagesContainer.AcceptedMessage::getCssClass).\n+                map(Message.CssClassType::StringToCssClassType).\n+                max(Message.CssClassType::compare).\n+                map(Message.CssClassType::toString).\n+                orElse(null);\n+    }\n+\n+    /**\n+     * @param tags message tags\n+     * @return name of highest cssClass of messages present in the system or null.\n+     */\n+    public static String getCssClass(String... tags) {\n+        Set<MessagesContainer.AcceptedMessage> messages = new TreeSet<>();\n+        RuntimeEnvironment env = RuntimeEnvironment.getInstance();\n+\n+        for (String tag : tags) {\n+            messages.addAll(env.getMessages(tag));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "38487b850f2ab98afce84d228d5aef4868228447"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1929a055e8170a971a6fca6a7cdba7fe64c38c8d", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/1929a055e8170a971a6fca6a7cdba7fe64c38c8d", "committedDate": "2020-01-07T09:09:50Z", "message": "avoid initial capital letter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9a9289e56e572bf2740394023aa9ad1bcb70642", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/a9a9289e56e572bf2740394023aa9ad1bcb70642", "committedDate": "2020-01-07T09:30:04Z", "message": "avoid null handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "869213561fb8dad0dfe7a3ffa21001e6154d290f", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/869213561fb8dad0dfe7a3ffa21001e6154d290f", "committedDate": "2020-01-07T09:59:34Z", "message": "use Comparator for max()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "916f4938f9913f3a8ffbdd2816686d61a20209bc", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/916f4938f9913f3a8ffbdd2816686d61a20209bc", "committedDate": "2020-01-07T10:03:03Z", "message": "use Collection instead of Set"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5Mjc5MzE4", "url": "https://github.com/oracle/opengrok/pull/3011#pullrequestreview-339279318", "createdAt": "2020-01-07T14:45:27Z", "commit": {"oid": "869213561fb8dad0dfe7a3ffa21001e6154d290f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxNDo0NToyOFrOFa7aKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxNDo0NToyOFrOFa7aKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzc4MDY0OQ==", "bodyText": "can be final and thus with constant naming scheme - capital letters", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363780649", "createdAt": "2020-01-07T14:45:28Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -78,9 +79,7 @@ public String toString() {\n             return cssClassString;\n         }\n \n-        public static int compare(CssClassType c1, CssClassType c2) {\n-            return Integer.compare(c1.ordinal(), c2.ordinal());\n-        }\n+        public static Comparator<CssClassType> valueComparator = Comparator.comparingInt(Enum::ordinal);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "869213561fb8dad0dfe7a3ffa21001e6154d290f"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b19e4aece1af09bba5ad5080df0b9ffafe8a52fd", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/b19e4aece1af09bba5ad5080df0b9ffafe8a52fd", "committedDate": "2020-01-07T15:52:09Z", "message": "use flatMap and add test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c1b1195f15356e92d273a6d9ef9ca4bd30233ab", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/9c1b1195f15356e92d273a6d9ef9ca4bd30233ab", "committedDate": "2020-01-07T15:55:19Z", "message": "make value comparator final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "da12b340419691fe52986c402985e2890821f4ef", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/da12b340419691fe52986c402985e2890821f4ef", "committedDate": "2020-01-07T17:46:34Z", "message": "get rid of CSS class in names"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c64ca27ddb01739704f41e0fb8427013befeae51", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/c64ca27ddb01739704f41e0fb8427013befeae51", "committedDate": "2020-01-07T16:02:37Z", "message": "get rid of CSS class in names"}, "afterCommit": {"oid": "da12b340419691fe52986c402985e2890821f4ef", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/da12b340419691fe52986c402985e2890821f4ef", "committedDate": "2020-01-07T17:46:34Z", "message": "get rid of CSS class in names"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5NDI4NTYy", "url": "https://github.com/oracle/opengrok/pull/3011#pullrequestreview-339428562", "createdAt": "2020-01-07T18:41:33Z", "commit": {"oid": "da12b340419691fe52986c402985e2890821f4ef"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxODo0MTozM1rOFbCNmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QxODo0Mjo0OVrOFbCPcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5MjEyMg==", "bodyText": "use valid value", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363892122", "createdAt": "2020-01-07T18:41:33Z", "author": {"login": "ktulinger"}, "path": "apiary.apib", "diffHunk": "@@ -84,7 +84,7 @@ see https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html#parse-java\n \n         {\n           \"tags\": [\"main\"],\n-          \"cssClass\": \"class\",\n+          \"messageLevel\": \"class\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da12b340419691fe52986c402985e2890821f4ef"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5MjQ0OQ==", "bodyText": "why not use the MessageLevel type?", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363892449", "createdAt": "2020-01-07T18:42:22Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -100,7 +100,7 @@ private Message() { // needed for deserialization\n     public Message(\n             final String text,\n             final Set<String> tags,\n-            final String cssClass,\n+            final String messageLevel,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da12b340419691fe52986c402985e2890821f4ef"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5MjUwMg==", "bodyText": "why not use the MessageLevel type?", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363892502", "createdAt": "2020-01-07T18:42:31Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -115,16 +115,16 @@ public Message(\n \n         this.text = text;\n         this.tags = tags;\n-        this.cssClass = CssClassType.stringToCssClassType(cssClass);\n+        this.messageLevel = MessageLevel.stringToMessageLevel(messageLevel);\n         this.duration = duration;\n     }\n \n     public Set<String> getTags() {\n         return tags;\n     }\n \n-    public String getCssClass() {\n-        return cssClass.toString();\n+    public String getMessageLevel() {\n+        return messageLevel.toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da12b340419691fe52986c402985e2890821f4ef"}, "originalPosition": 73}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mzg5MjU5Mg==", "bodyText": "why not use the MessageLevel type?", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r363892592", "createdAt": "2020-01-07T18:42:49Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/MessagesContainer.java", "diffHunk": "@@ -250,9 +250,9 @@ public String getText() {\n             return message.getText();\n         }\n \n-        @JsonProperty(\"cssClass\")\n-        public String getCssClass() {\n-            return message.getCssClass();\n+        @JsonProperty(\"messageLevel\")\n+        public String getMessageLevel() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da12b340419691fe52986c402985e2890821f4ef"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a1df588bc0edda87fadba6a4bea20dfcf9ed104", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/0a1df588bc0edda87fadba6a4bea20dfcf9ed104", "committedDate": "2020-01-08T12:03:32Z", "message": "use info level"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56b4528b31418a754ab4d1859cc69523580a2946", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/56b4528b31418a754ab4d1859cc69523580a2946", "committedDate": "2020-01-08T12:08:05Z", "message": "make Message.getMessageLevel() return MessageLevel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93565afd4a0100f0cdededc51bd2f963e00bce87", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/93565afd4a0100f0cdededc51bd2f963e00bce87", "committedDate": "2020-01-09T11:44:26Z", "message": "fix MessageLevel string handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0d03a7622c3c7bc4aff8c024c2304098a726fc8", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/e0d03a7622c3c7bc4aff8c024c2304098a726fc8", "committedDate": "2020-01-09T12:10:17Z", "message": "use MessageLevel in Message constructor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwNjg3MTY2", "url": "https://github.com/oracle/opengrok/pull/3011#pullrequestreview-340687166", "createdAt": "2020-01-09T17:21:34Z", "commit": {"oid": "e0d03a7622c3c7bc4aff8c024c2304098a726fc8"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNzoyMTozNFrOFb9mMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQxNzoyMjo0MlrOFb9oOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg2NTA3NQ==", "bodyText": "can be final", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r364865075", "createdAt": "2020-01-09T17:21:34Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -50,7 +52,39 @@\n     @NotEmpty(message = \"tags cannot be empty\")\n     private Set<String> tags = Collections.singleton(MESSAGES_MAIN_PAGE_TAG);\n \n-    private String cssClass = \"info\";\n+    public enum MessageLevel {\n+        /**\n+         * Known values: {@code SUCCESS}, {@code INFO}, {@code WARNING}, {@code ERROR}.\n+         * The values are sorted according to their level. Higher numeric value of the level (i.e. the enum ordinal)\n+         * means higher priority.\n+         */\n+        SUCCESS(\"success\"), INFO(\"info\"), WARNING(\"warning\"), ERROR(\"error\");\n+\n+        private String messageLevelString;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0d03a7622c3c7bc4aff8c024c2304098a726fc8"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg2NTU5Mw==", "bodyText": "class should start with capital letter", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r364865593", "createdAt": "2020-01-09T17:22:42Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -157,6 +191,28 @@ public int compareTo(final Message o) {\n         return tags.size() - o.tags.size();\n     }\n \n+    private static class messageLevelDeserializer extends StdDeserializer<MessageLevel> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0d03a7622c3c7bc4aff8c024c2304098a726fc8"}, "originalPosition": 100}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNDQ0MTY3", "url": "https://github.com/oracle/opengrok/pull/3011#pullrequestreview-341444167", "createdAt": "2020-01-10T21:57:37Z", "commit": {"oid": "e0d03a7622c3c7bc4aff8c024c2304098a726fc8"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6efbc8f44bff189bfcdf8dde51efdeb719dd1fa1", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/6efbc8f44bff189bfcdf8dde51efdeb719dd1fa1", "committedDate": "2020-01-13T10:00:31Z", "message": "make messageLevelString final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aa645945ab275d974ff08b85094ad0896f278e9a", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/aa645945ab275d974ff08b85094ad0896f278e9a", "committedDate": "2020-01-13T10:01:07Z", "message": "classes should start with capital letter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyNDYyOTA3", "url": "https://github.com/oracle/opengrok/pull/3011#pullrequestreview-342462907", "createdAt": "2020-01-14T11:25:24Z", "commit": {"oid": "aa645945ab275d974ff08b85094ad0896f278e9a"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxMToyNToyNFrOFdUSSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxMTozMDoxMFrOFdUZoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI4NTM4Nw==", "bodyText": "non blocking, I usually found these as fromString", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r366285387", "createdAt": "2020-01-14T11:25:24Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -50,7 +52,39 @@\n     @NotEmpty(message = \"tags cannot be empty\")\n     private Set<String> tags = Collections.singleton(MESSAGES_MAIN_PAGE_TAG);\n \n-    private String cssClass = \"info\";\n+    public enum MessageLevel {\n+        /**\n+         * Known values: {@code SUCCESS}, {@code INFO}, {@code WARNING}, {@code ERROR}.\n+         * The values are sorted according to their level. Higher numeric value of the level (i.e. the enum ordinal)\n+         * means higher priority.\n+         */\n+        SUCCESS(\"success\"), INFO(\"info\"), WARNING(\"warning\"), ERROR(\"error\");\n+\n+        private final String messageLevelString;\n+\n+        MessageLevel(String str) {\n+            messageLevelString = str;\n+        }\n+\n+        public static MessageLevel stringToMessageLevel(String val) throws IllegalArgumentException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa645945ab275d974ff08b85094ad0896f278e9a"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI4NjEwOQ==", "bodyText": "I just wonder, serializer is not needed?", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r366286109", "createdAt": "2020-01-14T11:27:08Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/Message.java", "diffHunk": "@@ -157,6 +191,28 @@ public int compareTo(final Message o) {\n         return tags.size() - o.tags.size();\n     }\n \n+    private static class MessageLevelDeserializer extends StdDeserializer<MessageLevel> {\n+        private static final long serialVersionUID = 928540953227342817L;\n+\n+        MessageLevelDeserializer() {\n+            this(null);\n+        }\n+\n+        MessageLevelDeserializer(Class<?> vc) {\n+            super(vc);\n+        }\n+\n+        @Override\n+        public MessageLevel deserialize(final JsonParser parser, final DeserializationContext context)\n+                throws IOException {\n+            try {\n+                return MessageLevel.stringToMessageLevel(context.readValue(parser, String.class));\n+            } catch (DateTimeParseException e) {\n+                throw new IOException(e);\n+            }\n+        }\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa645945ab275d974ff08b85094ad0896f278e9a"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI4NjY0MQ==", "bodyText": "I'd qualify here with the class name so the name does not seem a little out of context.", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r366286641", "createdAt": "2020-01-14T11:28:31Z", "author": {"login": "ktulinger"}, "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/messages/MessagesUtils.java", "diffHunk": "@@ -230,4 +234,32 @@ private static String messagesToJson(Group group, String... additionalTags) {\n     public static String messagesToJson(Group group) {\n         return messagesToJson(group, new String[0]);\n     }\n+\n+    /**\n+     * @return name of highest cssClass of messages present in the system or null.\n+     */\n+    static String getHighestMessageLevel(Collection<MessagesContainer.AcceptedMessage> messages) {\n+        return messages.\n+                stream().\n+                map(MessagesContainer.AcceptedMessage::getMessageLevel).\n+                max(VALUE_COMPARATOR).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa645945ab275d974ff08b85094ad0896f278e9a"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI4NzI2NQ==", "bodyText": "a question here is if you want to restrict these classes to be used only for important-note or just without any restriction (one can use it later for completely unrelated styling with the given colour).", "url": "https://github.com/oracle/opengrok/pull/3011#discussion_r366287265", "createdAt": "2020-01-14T11:30:10Z", "author": {"login": "ktulinger"}, "path": "opengrok-web/src/main/webapp/default/style.css", "diffHunk": "@@ -1249,6 +1236,34 @@ h6.message-group-caption {\n     line-height: 1.3;\n }\n \n+.important-note {\n+    text-align: center;\n+    display: inline-block;\n+    max-height: 100%;\n+}\n+\n+.note-success {\n+    background-color: #3c763d;\n+}\n+\n+.note-info {\n+    background-color: #31708f;\n+}\n+\n+.note-warning {\n+    background-color: #8a6d3b;\n+}\n+\n+.note-error {\n+    background-color: #a94442;\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aa645945ab275d974ff08b85094ad0896f278e9a"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70d38c7ec68300c4e04d3c9aa5ac72dc477f92e5", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/70d38c7ec68300c4e04d3c9aa5ac72dc477f92e5", "committedDate": "2020-01-14T13:13:32Z", "message": "rename stringToMessageLevel() to fromString()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5b51f9f839e3bafc21cd8a14f017b841e5312af", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/d5b51f9f839e3bafc21cd8a14f017b841e5312af", "committedDate": "2020-01-14T13:15:55Z", "message": "qualify value comparator using full(er) name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46b9358f179a6f55c4ad6471c10e6c4e75821f62", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/46b9358f179a6f55c4ad6471c10e6c4e75821f62", "committedDate": "2020-01-15T12:19:50Z", "message": "fix method name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09d8df66e8f56a5e49eab0e765d58ce22b9d75b9", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/09d8df66e8f56a5e49eab0e765d58ce22b9d75b9", "committedDate": "2020-01-15T12:30:25Z", "message": "fix script versions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "028775af04b130a9bbe5f858afa6b3c710fe54bf", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/028775af04b130a9bbe5f858afa6b3c710fe54bf", "committedDate": "2020-01-15T13:27:35Z", "message": "fix colors in message window"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "256e291c3afa49b8367f13b6b31d5bb726838d34", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/256e291c3afa49b8367f13b6b31d5bb726838d34", "committedDate": "2020-01-15T13:27:46Z", "message": "allow note style to be used only together with important-note style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzMjM1NTg2", "url": "https://github.com/oracle/opengrok/pull/3011#pullrequestreview-343235586", "createdAt": "2020-01-15T13:58:56Z", "commit": {"oid": "256e291c3afa49b8367f13b6b31d5bb726838d34"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bac5302f725cb07733b4d67b929a29a955a697fe", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/bac5302f725cb07733b4d67b929a29a955a697fe", "committedDate": "2020-01-15T14:30:26Z", "message": "fix test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 265, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}