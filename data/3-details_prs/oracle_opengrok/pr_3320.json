{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwMjYxOTEy", "number": 3320, "title": "enable GitHub actions for building", "bodyText": "Travis backlog has started being unbearable recently (see https://www.traviscistatus.com/). This change enables basic Github actions for building. Relase related tasks will be done in later PR.\nThe macOS build fails due to #3296. For the Windows build to pass I had to exclude some of the tests. Will file issues for these.\nInfo about the build environments: https://github.com/actions/virtual-environments", "createdAt": "2020-10-26T19:37:45Z", "url": "https://github.com/oracle/opengrok/pull/3320", "merged": true, "mergeCommit": {"oid": "75a76d7e1d0f725aef215b86fc6d6fae7cc81ef6"}, "closed": true, "closedAt": "2020-10-27T13:18:41Z", "author": {"login": "vladak"}, "timelineItems": {"totalCount": 34, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWYzHDgH2gAyNTEwMjYxOTEyOjRlOGJhOTUyMjZhOGFjYjVmODk5YmQ1YjZhZTBiNmMyZWIyOTI0OGQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWo1ASAFqTUxNzY5MDI0Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4e8ba95226a8acb5f899bd5b6ae0b6c2eb29248d", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/4e8ba95226a8acb5f899bd5b6ae0b6c2eb29248d", "committedDate": "2020-10-26T18:37:07Z", "message": "enable Github actions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7a60c257f13ac83ad328ed4e3e7919cc5576399", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/a7a60c257f13ac83ad328ed4e3e7919cc5576399", "committedDate": "2020-10-26T18:38:49Z", "message": "add on"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6780305e20e1668819c8afe60c98c0cb18839930", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/6780305e20e1668819c8afe60c98c0cb18839930", "committedDate": "2020-10-26T18:41:38Z", "message": "add setup-java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6de5c297581c0bffb4685717368385e07d948328", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/6de5c297581c0bffb4685717368385e07d948328", "committedDate": "2020-10-26T18:42:31Z", "message": "fix name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "411e2ab49a61ae796e9d3cfae1129cf0012881f0", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/411e2ab49a61ae796e9d3cfae1129cf0012881f0", "committedDate": "2020-10-26T18:45:37Z", "message": "honor RUNNER_OS=Linux"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1c0d84be26177a2ae3f8343ef1d73c211cfc0a0", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/b1c0d84be26177a2ae3f8343ef1d73c211cfc0a0", "committedDate": "2020-10-26T18:47:38Z", "message": "fix variable ref"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "caedaf5ce477512ab33400a7e1d33775e59a80e4", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/caedaf5ce477512ab33400a7e1d33775e59a80e4", "committedDate": "2020-10-26T18:57:57Z", "message": "add macOS+Windows"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bafb74fd4c53116798b5938f798886a94895326", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/7bafb74fd4c53116798b5938f798886a94895326", "committedDate": "2020-10-26T19:01:36Z", "message": "honor RUNNER_OS=macOS"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb720c4a562047f5e2d118d42e62b7cc268a0070", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/fb720c4a562047f5e2d118d42e62b7cc268a0070", "committedDate": "2020-10-26T19:03:46Z", "message": "enable Maven cache"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ceae8bd6ce479f1138f9c1bf9c705ee5f0a378ca", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/ceae8bd6ce479f1138f9c1bf9c705ee5f0a378ca", "committedDate": "2020-10-26T19:08:26Z", "message": "install autoconf+automake on macOS"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9091a8e4a07f051fa5b38b0bc4a9a5403eadfce8", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/9091a8e4a07f051fa5b38b0bc4a9a5403eadfce8", "committedDate": "2020-10-26T19:40:45Z", "message": "run the actions for PRs too"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55a8f683258e8133c01d0bbf4e3295e9bf6dc03f", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/55a8f683258e8133c01d0bbf4e3295e9bf6dc03f", "committedDate": "2020-10-26T19:54:35Z", "message": "windows: install ctags+svn, run Maven"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7364a05e4da2a31c1821b4e4d52767930afcf3c6", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/7364a05e4da2a31c1821b4e4d52767930afcf3c6", "committedDate": "2020-10-26T19:58:09Z", "message": "enable Maven cache for Windows too"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8f7c1aa13d3a88806bce2fc872cff93fc41882b", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/e8f7c1aa13d3a88806bce2fc872cff93fc41882b", "committedDate": "2020-10-26T20:23:42Z", "message": "no before actions for Windows"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff275e62b849661abe7a08b5d40a693f86ba69fb", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/ff275e62b849661abe7a08b5d40a693f86ba69fb", "committedDate": "2020-10-26T20:35:03Z", "message": "no need to install Subversion on Windows"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "675d990334988bca02d023f6cd7f6b32d73ead18", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/675d990334988bca02d023f6cd7f6b32d73ead18", "committedDate": "2020-10-27T07:46:30Z", "message": "skip MercurialRepositoryTest on Windows\n\nit times out when running 'hg update mybranch'"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1427ccfc71d146ca7b7905193343be1caf34e18e", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/1427ccfc71d146ca7b7905193343be1caf34e18e", "committedDate": "2020-10-27T07:51:20Z", "message": "add Apiary check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdf2cb315e27a71848abf5cf68d8b02f85e1c7ae", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/cdf2cb315e27a71848abf5cf68d8b02f85e1c7ae", "committedDate": "2020-10-27T07:53:11Z", "message": "install drafter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "26322cac0cf3f160c6e1467ae5a06e60d87f02ed", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/26322cac0cf3f160c6e1467ae5a06e60d87f02ed", "committedDate": "2020-10-27T07:56:14Z", "message": "add comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a713f1344a7f9fb59a87a82d46ee76f0975f2b5e", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/a713f1344a7f9fb59a87a82d46ee76f0975f2b5e", "committedDate": "2020-10-27T07:57:15Z", "message": "move Apiary blueprint check to Github actions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ddca3b54e064ec6e347780dec6569375ed45069", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/8ddca3b54e064ec6e347780dec6569375ed45069", "committedDate": "2020-10-27T08:00:22Z", "message": "restrict path"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "096d2bb8d0de792dca2b4968852d69ce3def6593", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/096d2bb8d0de792dca2b4968852d69ce3def6593", "committedDate": "2020-10-27T08:11:40Z", "message": "revert files to avoid uncommitted changes error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a73998433430739717a3f561a0f13b52e249748d", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/a73998433430739717a3f561a0f13b52e249748d", "committedDate": "2020-10-27T08:24:21Z", "message": "add Docker build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "802a85dc79bf29b5257cc700011771b70f915f9f", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/802a85dc79bf29b5257cc700011771b70f915f9f", "committedDate": "2020-10-27T08:44:38Z", "message": "testSymlink() fails:\n\nIndexerRepoTest.testSymlinks:193 Should match (with macOS leeway):\nC:\\Users\\RUNNER~1\\AppData\\Local\\Temp\\src14654515561148586437\\symlink\nv.\nC:\\Users\\runneradmin\\AppData\\Local\\Temp\\src14654515561148586437\\symlink"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "448c330aaf8268ba45fbd1bc06a6a649e55d6f5d", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/448c330aaf8268ba45fbd1bc06a6a649e55d6f5d", "committedDate": "2020-10-27T09:22:27Z", "message": "revert prior to hg import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "acf42fe65da6408724f173789310235816e35f82", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/acf42fe65da6408724f173789310235816e35f82", "committedDate": "2020-10-27T10:08:34Z", "message": "testIndexed() fails with:\n\ncurrent version should be refreshed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccdbe4ca14dac739cd2f5c9676d1a3406371dd4e", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/ccdbe4ca14dac739cd2f5c9676d1a3406371dd4e", "committedDate": "2020-10-27T10:11:21Z", "message": "add prints"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a66a841c48522f5698998bb8060569e129ddcf6", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/1a66a841c48522f5698998bb8060569e129ddcf6", "committedDate": "2020-10-27T10:15:27Z", "message": "run Javadoc refresh script"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "323cc85f8424157d28196340f9f78134fd370667", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/323cc85f8424157d28196340f9f78134fd370667", "committedDate": "2020-10-27T10:52:59Z", "message": "remove regular builds"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NjQ2ODM2", "url": "https://github.com/oracle/opengrok/pull/3320#pullrequestreview-517646836", "createdAt": "2020-10-27T12:27:17Z", "commit": {"oid": "323cc85f8424157d28196340f9f78134fd370667"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMjoyNzoxN1rOHo5sBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMjoyNzoxN1rOHo5sBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY1MDI0NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  run: mvn -B -V verify\n          \n          \n            \n                  run: ./mvnw -B -V verify\n          \n      \n    \n    \n  \n\nMaybe use mvnw? I don't know what is the command on Windows to run a script :D", "url": "https://github.com/oracle/opengrok/pull/3320#discussion_r512650245", "createdAt": "2020-10-27T12:27:17Z", "author": {"login": "ahornace"}, "path": ".github/workflows/build.yml", "diffHunk": "@@ -0,0 +1,69 @@\n+name: Build\n+\n+on: [push, pull_request]\n+\n+jobs:\n+  ubuntu:\n+    name: Ubuntu with Java 11\n+    runs-on: ubuntu-latest\n+    steps:\n+    - name: Checkout master branch\n+      uses: actions/checkout@v2\n+    - name: Set up JDK 11\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: 11\n+    - name: Cache Maven packages\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.m2\n+        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n+        restore-keys: ${{ runner.os }}-m2\n+    - name: Install pre-requisites\n+      run: ./dev/before_install\n+    - name: Before build actions\n+      run: ./dev/before\n+    - name: Build\n+      run: ./dev/main\n+  macos:\n+    name: macOS with Java 11\n+    runs-on: macos-latest\n+    steps:\n+    - name: Checkout master branch\n+      uses: actions/checkout@v2\n+    - name: Set up JDK 11\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: 11\n+    - name: Cache Maven packages\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.m2\n+        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n+        restore-keys: ${{ runner.os }}-m2\n+    - name: Install pre-requisites\n+      run: ./dev/before_install\n+    - name: Before build actions\n+      run: ./dev/before\n+    - name: Build\n+      run: ./dev/main\n+  windows:\n+    name: Windows with Java 11\n+    runs-on: windows-latest\n+    steps:\n+    - name: Checkout master branch\n+      uses: actions/checkout@v2\n+    - name: Set up JDK 11\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: 11\n+    - name: Cache Maven packages\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.m2\n+        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n+        restore-keys: ${{ runner.os }}-m2\n+    - name: Install Universal ctags\n+      run: choco install universal-ctags\n+    - name: Build\n+      run: mvn -B -V verify", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "323cc85f8424157d28196340f9f78134fd370667"}, "originalPosition": 69}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NjY0NTI5", "url": "https://github.com/oracle/opengrok/pull/3320#pullrequestreview-517664529", "createdAt": "2020-10-27T12:49:23Z", "commit": {"oid": "323cc85f8424157d28196340f9f78134fd370667"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMjo0OToyNFrOHo6gIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMjo0OToyNFrOHo6gIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY2MzU4Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  run: ./dev/docker.sh\n          \n          \n            \n                  run: ./dev/javadoc.sh\n          \n      \n    \n    \n  \n\nMaybe this script instead of docker.sh?", "url": "https://github.com/oracle/opengrok/pull/3320#discussion_r512663587", "createdAt": "2020-10-27T12:49:24Z", "author": {"login": "ahornace"}, "path": ".github/workflows/javadoc.yml", "diffHunk": "@@ -0,0 +1,22 @@\n+name: Upload javadocs to Github pages\n+\n+on: push\n+\n+jobs:\n+  ubuntu:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - name: Checkout master branch\n+      uses: actions/checkout@v2\n+    - name: Set up JDK 11\n+      uses: actions/setup-java@v1\n+      with:\n+        java-version: 11\n+    - name: Cache Maven packages\n+      uses: actions/cache@v2\n+      with:\n+        path: ~/.m2\n+        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}\n+        restore-keys: ${{ runner.os }}-m2\n+    - name: Refresh Javadoc\n+      run: ./dev/docker.sh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "323cc85f8424157d28196340f9f78134fd370667"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ea8ab00f90576fc047dbdc5d75b9d0f2bb536a7", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/2ea8ab00f90576fc047dbdc5d75b9d0f2bb536a7", "committedDate": "2020-10-27T12:55:10Z", "message": "restrict to master branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57e26bf2294803342d00a61d56124e03802bfc32", "author": {"user": {"login": "vladak", "name": "Vladimir Kotal"}}, "url": "https://github.com/oracle/opengrok/commit/57e26bf2294803342d00a61d56124e03802bfc32", "committedDate": "2020-10-27T13:14:56Z", "message": "run javadoc.sh\n\nCo-authored-by: Adam Horn\u00e1\u010dek <adam.hornacek@icloud.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NjkwMjQ2", "url": "https://github.com/oracle/opengrok/pull/3320#pullrequestreview-517690246", "createdAt": "2020-10-27T13:17:40Z", "commit": {"oid": "57e26bf2294803342d00a61d56124e03802bfc32"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 262, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}