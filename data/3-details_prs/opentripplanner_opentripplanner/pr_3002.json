{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MzU4NDIx", "number": 3002, "title": "Routing request slak parameters", "bodyText": "This PR reimplement the following parameters:\n\nboardSlack\nalightSlack\nminTransferTime\n\nAlso the board/alight times pr mode in the router-config.json will be supported by this PR.\nTo be completed by pull request submitter:\n\n issue: This is a regression - reimplementing some of the RequestParameters no longer working after switching to the Raptor implementation.\n roadmap: yes. Raptor.\n tests: No.\n formatting: Yes.\n documentation: When analyzing how to implement this I also documented the design. This is included in this PR.\n changelog: No.\n\nTo be completed by @opentripplanner/plc:\n\n reviews and approvals by 2 members, ideally from different organizations\n after merging: update the relevant card on the roadmap", "createdAt": "2020-03-10T20:51:43Z", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3002", "merged": true, "mergeCommit": {"oid": "62bf81eebe4424851e184bcaafd04a79f2290faa"}, "closed": true, "closedAt": "2020-04-02T08:30:07Z", "author": {"login": "t2gran"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMY-H4gBqjMxMTY0MjYzMzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcToAXrgFqTM4NjIwNzk4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df6f3c70f1890001f6e86584baeb6559bc737463", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/df6f3c70f1890001f6e86584baeb6559bc737463", "committedDate": "2020-03-10T20:38:05Z", "message": "Raptor Documentation - Added documentation on the Range Raptor \"time-line\" and forward vs. reverse search.\n - Rename calculator 'latestArrivalTime' to 'stopArrivalTime'."}, "afterCommit": {"oid": "d076d93e6fd7b9cc4bec1fe35373512488dba00d", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/d076d93e6fd7b9cc4bec1fe35373512488dba00d", "committedDate": "2020-03-10T20:58:28Z", "message": "Raptor Documentation - Added documentation on the Range Raptor \"time-line\" and forward vs. reverse search.\n - Rename calculator 'latestArrivalTime' to 'stopArrivalTime'."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d076d93e6fd7b9cc4bec1fe35373512488dba00d", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/d076d93e6fd7b9cc4bec1fe35373512488dba00d", "committedDate": "2020-03-10T20:58:28Z", "message": "Raptor Documentation - Added documentation on the Range Raptor \"time-line\" and forward vs. reverse search.\n - Rename calculator 'latestArrivalTime' to 'stopArrivalTime'."}, "afterCommit": {"oid": "94c867511d59137d16b333bc77f8985600070b60", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/94c867511d59137d16b333bc77f8985600070b60", "committedDate": "2020-03-17T11:09:17Z", "message": "temp"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "94c867511d59137d16b333bc77f8985600070b60", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/94c867511d59137d16b333bc77f8985600070b60", "committedDate": "2020-03-17T11:09:17Z", "message": "temp"}, "afterCommit": {"oid": "3457f06013d2d0a0c1be96a01d9aa2debbe4b579", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/3457f06013d2d0a0c1be96a01d9aa2debbe4b579", "committedDate": "2020-03-19T17:12:15Z", "message": "Refactor RaptorTripPattern into 3 separate roles: RaptorRoute, RaptorTimeTable and RaptorTripPattern."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3457f06013d2d0a0c1be96a01d9aa2debbe4b579", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/3457f06013d2d0a0c1be96a01d9aa2debbe4b579", "committedDate": "2020-03-19T17:12:15Z", "message": "Refactor RaptorTripPattern into 3 separate roles: RaptorRoute, RaptorTimeTable and RaptorTripPattern."}, "afterCommit": {"oid": "f25eb07a436c3816bbcab69d1d72fcb81abab977", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/f25eb07a436c3816bbcab69d1d72fcb81abab977", "committedDate": "2020-03-23T12:32:45Z", "message": "Map board and alight slack (default & pr mode) for RouterConfig and RoutingRequest to RaptorRequest."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f25eb07a436c3816bbcab69d1d72fcb81abab977", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/f25eb07a436c3816bbcab69d1d72fcb81abab977", "committedDate": "2020-03-23T12:32:45Z", "message": "Map board and alight slack (default & pr mode) for RouterConfig and RoutingRequest to RaptorRequest."}, "afterCommit": {"oid": "66aeda57ea4730ea110aa60d29c6bb6545a7d646", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/66aeda57ea4730ea110aa60d29c6bb6545a7d646", "committedDate": "2020-03-24T21:51:23Z", "message": "Map board and alight slack (default & pr mode) for RouterConfig and RoutingRequest to RaptorRequest."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d979dca2f3ee58725a852840fc7431a64645347", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/1d979dca2f3ee58725a852840fc7431a64645347", "committedDate": "2020-03-24T21:54:23Z", "message": "Merge remote-tracking branch 'entur/otp2_bugfix_routing_config_overloaded' into otp2_routing_request_slak_params"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97a99f7ec4554d0aeccb8b4f9a940cb7b8a7ec6f", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/97a99f7ec4554d0aeccb8b4f9a940cb7b8a7ec6f", "committedDate": "2020-03-24T21:56:40Z", "message": "Clean Code - Rename `TransferLeg` to `RaptorTransfer`."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43aafd3bcaf5381f0706f12d296f084d2e3c645a", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/43aafd3bcaf5381f0706f12d296f084d2e3c645a", "committedDate": "2020-03-24T21:56:51Z", "message": "Refactor RaptorTripPattern into 3 separate roles: RaptorRoute, RaptorTimeTable and RaptorTripPattern."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2b55f8101f8d2a89a409d92b0ec07816a21ae05d", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/2b55f8101f8d2a89a409d92b0ec07816a21ae05d", "committedDate": "2020-03-24T21:56:55Z", "message": "Added navigation from RaptorTripSchedule to RaptorTripPattern.\n - Renamed TransitDataProvider to RaptorTransitDataProvider.\n - Fixed a few spelling errors in TestRaptorTripSchedule."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d9fe2b499830e21b49122da97d2930893095391", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/7d9fe2b499830e21b49122da97d2930893095391", "committedDate": "2020-03-24T21:56:58Z", "message": "Implement board-slack in Raptor."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1b0b4c6e688dcf1c09febeb52d96169d4c902bb", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/a1b0b4c6e688dcf1c09febeb52d96169d4c902bb", "committedDate": "2020-03-24T21:57:02Z", "message": "Map board and alight slack (default & pr mode) for RouterConfig and RoutingRequest to RaptorRequest."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5fe875acf0e63d9762348d9b60c771ecb73a004c", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/5fe875acf0e63d9762348d9b60c771ecb73a004c", "committedDate": "2020-03-30T17:14:22Z", "message": "Fix time-shift issues and add board and alight slack to Transmodel Graph QL API.\n  - Add toString to Raptor path classes to be able to debug the path more easily.\n  - Improve naming by more consistent naming.\n  - Improve unit tests."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "66aeda57ea4730ea110aa60d29c6bb6545a7d646", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/66aeda57ea4730ea110aa60d29c6bb6545a7d646", "committedDate": "2020-03-24T21:51:23Z", "message": "Map board and alight slack (default & pr mode) for RouterConfig and RoutingRequest to RaptorRequest."}, "afterCommit": {"oid": "5fe875acf0e63d9762348d9b60c771ecb73a004c", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/5fe875acf0e63d9762348d9b60c771ecb73a004c", "committedDate": "2020-03-30T17:14:22Z", "message": "Fix time-shift issues and add board and alight slack to Transmodel Graph QL API.\n  - Add toString to Raptor path classes to be able to debug the path more easily.\n  - Improve naming by more consistent naming.\n  - Improve unit tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b5c9da6144b814616896d1c60233a4f4180413b", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/6b5c9da6144b814616896d1c60233a4f4180413b", "committedDate": "2020-03-30T17:18:17Z", "message": "Merge remote-tracking branch 'otp/dev-2.x' into otp2_routing_request_slak_params"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "060027d8097084b7325807d776c5277b72718d42", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/060027d8097084b7325807d776c5277b72718d42", "committedDate": "2020-03-31T09:51:59Z", "message": "Merge remote-tracking branch 'otp/dev-2.x' into otp2_routing_request_slak_params"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NTk5MzA3", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3002#pullrequestreview-384599307", "createdAt": "2020-03-31T10:26:03Z", "commit": {"oid": "a1b0b4c6e688dcf1c09febeb52d96169d4c902bb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxMDoyNjowM1rOF-PL1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxMDoyNjowM1rOF-PL1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDgwNDgyMQ==", "bodyText": "reverseBoardSlack rather than revere", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3002#discussion_r400804821", "createdAt": "2020-03-31T10:26:03Z", "author": {"login": "abyrd"}, "path": "src/main/java/org/opentripplanner/transit/raptor/rangeraptor/transit/ReverseSlackProvider.java", "diffHunk": "@@ -12,31 +13,39 @@\n  *\n  * @param <T> The TripSchedule type defined by the user of the raptor API.\n  */\n-public final class ReverseSlackProvider<T extends RaptorTripSchedule> implements SlackProvider<T> {\n+public final class ReverseSlackProvider<T extends RaptorTripSchedule> implements SlackProvider {\n \n-    private final int boardSlack;\n-    //private boolean ignoreTransferSlack;\n+    private final RaptorSlackProvider source;\n+    private boolean ignoreTransferSlack = true;\n+    private int reverseAlightSlack;\n+    private int revereBoardSlack;\n \n-    public ReverseSlackProvider(int boardSlack, WorkerLifeCycle lifeCycle) {\n-        this.boardSlack = boardSlack;\n-        //lifeCycle.onPrepareForNextRound(this::notifyNewRound);\n+    public ReverseSlackProvider(RaptorSlackProvider source, WorkerLifeCycle lifeCycle) {\n+        this.source = source;\n+        lifeCycle.onPrepareForNextRound(this::notifyNewRound);\n     }\n \n-    public final void notifyNewRound(int round) {\n-        //ignoreTransferSlack = round < 2;\n+    public void notifyNewRound(int round) {\n+        ignoreTransferSlack = round < 2;\n     }\n \n     @Override\n-    public final void setCurrentPattern(RaptorTripPattern pattern) { }\n+    public void setCurrentPattern(RaptorTripPattern pattern) {\n+        this.revereBoardSlack = source.alightSlack(pattern);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1b0b4c6e688dcf1c09febeb52d96169d4c902bb"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f51f9e74b8dfd2c480d12957aac6439a27c950b6", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/f51f9e74b8dfd2c480d12957aac6439a27c950b6", "committedDate": "2020-03-31T11:54:10Z", "message": "Raptor documentation updated with board/alight slack implementation notes in the README."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "59002def6ff5634ccc332275ba8542ba4bd30e6d", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/59002def6ff5634ccc332275ba8542ba4bd30e6d", "committedDate": "2020-03-31T12:45:27Z", "message": "Temp"}, "afterCommit": {"oid": "f51f9e74b8dfd2c480d12957aac6439a27c950b6", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/f51f9e74b8dfd2c480d12957aac6439a27c950b6", "committedDate": "2020-03-31T11:54:10Z", "message": "Raptor documentation updated with board/alight slack implementation notes in the README."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4083618dc25a5d75649f21f44f125977f28cddb", "author": {"user": {"login": "abyrd", "name": "Andrew Byrd"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/f4083618dc25a5d75649f21f44f125977f28cddb", "committedDate": "2020-04-02T08:22:04Z", "message": "Update README.md"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MjA3OTgz", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3002#pullrequestreview-386207983", "createdAt": "2020-04-02T08:27:15Z", "commit": {"oid": "f4083618dc25a5d75649f21f44f125977f28cddb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2076, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}