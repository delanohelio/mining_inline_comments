{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyODUzNTQ3", "number": 3063, "title": "Generalize kiss and ride mode as car_pickup mode", "bodyText": "To be completed by pull request submitter:\n\n issue: #2581\n roadmap: Not on the roadmap, but a refactor of existing functionality.\n tests: Have you added relevant test coverage? Are all the tests passing on the continuous integration service (Travis CI)?\n formatting: Have you followed the suggested code style?\n documentation: If you are adding a new configuration option, have you added an explanation to the configuration documentation tables and sections?\n changelog: add a bullet point to the changelog file with description and link to the linked issue\n\nTo be completed by @opentripplanner/plc:\n\n reviews and approvals by 2 members, ideally from different organizations\n after merging: update the relevant card on the roadmap\n\nThis relates to #2777 and #2581.\nThe kiss and ride is a mode where you started in a car and then you would exit the car by the street and walk the rest of the way. Basically it is the same as park and ride, except that you don't have to find a place to park. This could be someone driving you there, or taking a taxi.\nIn OTP1 we added a ride and kiss feature that was the opposite of this and allowed you to be picked up after riding transit, and then traveling by car to your destination.\nThis pull request generalizes the kiss and ride and ride and kiss features and renames it to car_pickup. Instead of starting or ending in a car, you will always start out walking, then get picked up by a car, and get dropped off so you can walk the rest of the way. In this way, the same option can be used for access, egress and direct searches.\nWe will probably eventually have to refactor the a star search in order to use a more general state machine implementation for these street modes. This pull request follows the pattern already in place, where the StateData class is used to keep track of which phase of the search we are in (carParked, bikePark etc. booleans). The car_pickup mode is changed to use a new CarPickupState enum, which contains the three possible states (WALK_TO_PICKUP, IN_CAR, WALK_FROM_DROP_OFF).\nThe StreetEdge class is then changed from 2 to 4 possible transitions (2 in each direction), while keeping the existing pattern.\nTo test this with the built-in client you have to change QualifiedModeSet.getRequestModes to return StreetMode.CAR_PICKUP as either directMode or egress/access mode, as there is currently no option in the REST API that maps to car_pickup.\nYou also should change the maximum walk field in the client to a higher number.\nTry setting the start/end locations inside parks to test the walking at the ends.", "createdAt": "2020-05-04T10:01:39Z", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3063", "merged": true, "mergeCommit": {"oid": "dad722e7fc56008184bda524c153b18c72e0db67"}, "closed": true, "closedAt": "2020-05-14T08:47:01Z", "author": {"login": "gmellemstrand"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceQjIkAH2gAyNDEyODUzNTQ3OjBhNTFkOTM1MGE0NDM3YWQ0MDU5MzIzNGJjZTYxMWRkOTFhOWRmMmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchJYgpAH2gAyNDEyODUzNTQ3OmM4YjlhNzk4N2YzM2IzYjQ4ZTNlMTY2MDRmZjkyYjY5MTM2YTg4YjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "0a51d9350a4437ad40593234bce611dd91a9df2e", "author": {"user": {"login": "gmellemstrand", "name": null}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/0a51d9350a4437ad40593234bce611dd91a9df2e", "committedDate": "2020-05-05T09:20:40Z", "message": "Added taxi mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "883071816e3ad7803fb565bb7eb1487dd52d115b", "author": {"user": {"login": "gmellemstrand", "name": null}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/883071816e3ad7803fb565bb7eb1487dd52d115b", "committedDate": "2020-05-05T09:20:40Z", "message": "Add changelog entry"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c1b5cc2e56564cfa1614a540ead1775fff8ade9", "author": {"user": {"login": "gmellemstrand", "name": null}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/5c1b5cc2e56564cfa1614a540ead1775fff8ade9", "committedDate": "2020-05-04T10:03:24Z", "message": "Add changelog entry"}, "afterCommit": {"oid": "883071816e3ad7803fb565bb7eb1487dd52d115b", "author": {"user": {"login": "gmellemstrand", "name": null}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/883071816e3ad7803fb565bb7eb1487dd52d115b", "committedDate": "2020-05-05T09:20:40Z", "message": "Add changelog entry"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "704bde5d871344699999502f43eaab547472676a", "author": {"user": {"login": "gmellemstrand", "name": null}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/704bde5d871344699999502f43eaab547472676a", "committedDate": "2020-05-06T09:41:26Z", "message": "Change name from taxi to car_pickup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7407d83da6d3302e7f87ed5d0714909340b0c0ea", "author": {"user": {"login": "gmellemstrand", "name": null}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/7407d83da6d3302e7f87ed5d0714909340b0c0ea", "committedDate": "2020-05-06T09:46:08Z", "message": "Merge branch 'dev-2.x' into otp2_add_taxi_mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e38cd8e7de1f01a8e07429bbe20b4815e3a7b78", "author": {"user": {"login": "gmellemstrand", "name": null}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/9e38cd8e7de1f01a8e07429bbe20b4815e3a7b78", "committedDate": "2020-05-07T10:14:17Z", "message": "Change taxi to car pickup in all relevant places"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNTM2MTc1", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3063#pullrequestreview-411536175", "createdAt": "2020-05-14T07:33:57Z", "commit": {"oid": "9e38cd8e7de1f01a8e07429bbe20b4815e3a7b78"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzozMzo1N1rOGVPjuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzozNTozNFrOGVPm8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkyODE4Nw==", "bodyText": "rename method to reflect \"car pickup\" term", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3063#discussion_r424928187", "createdAt": "2020-05-14T07:33:57Z", "author": {"login": "abyrd"}, "path": "src/main/java/org/opentripplanner/routing/core/State.java", "diffHunk": "@@ -159,6 +165,10 @@ public String toStringVerbose() {\n                 \" br=\" + this.isBikeRenting() +\n                 \" pr=\" + this.isCarParked() + \">\";\n     }\n+\n+    public CarPickupState getTaxiState() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e38cd8e7de1f01a8e07429bbe20b4815e3a7b78"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkyOTAxMA==", "bodyText": "rename to match new term \"car pickup\", for example to pickedUpByCar.", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3063#discussion_r424929010", "createdAt": "2020-05-14T07:35:34Z", "author": {"login": "abyrd"}, "path": "src/main/java/org/opentripplanner/routing/core/State.java", "diffHunk": "@@ -191,25 +201,30 @@ public boolean isBikeParked() {\n      */\n     public boolean isFinal() {\n         // When drive-to-transit is enabled, we need to check whether the car has been parked (or whether it has been picked up in reverse).\n-        boolean parkAndRide = stateData.opt.parkAndRide || stateData.opt.kissAndRide;\n+        boolean parkAndRide = stateData.opt.parkAndRide;\n         boolean bikeParkAndRide = stateData.opt.bikeParkAndRide;\n         boolean bikeRentingOk;\n         boolean bikeParkAndRideOk;\n         boolean carParkAndRideOk;\n+        boolean taxiOk;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e38cd8e7de1f01a8e07429bbe20b4815e3a7b78"}, "originalPosition": 36}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce890e33ba8169be56c8c88f0530f147fc7aca7a", "author": {"user": {"login": "gmellemstrand", "name": null}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/ce890e33ba8169be56c8c88f0530f147fc7aca7a", "committedDate": "2020-05-14T07:41:57Z", "message": "Changed a few missing identifiers from taxi to carPickup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92de78726dfc4f8debaa4cd994d002c5efa46c24", "author": {"user": {"login": "gmellemstrand", "name": null}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/92de78726dfc4f8debaa4cd994d002c5efa46c24", "committedDate": "2020-05-14T07:42:38Z", "message": "Merge branch 'dev-2.x' into otp2_add_taxi_mode"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNTg3MDEw", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3063#pullrequestreview-411587010", "createdAt": "2020-05-14T08:41:06Z", "commit": {"oid": "92de78726dfc4f8debaa4cd994d002c5efa46c24"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8b9a7987f33b3b48e3e16604ff92b69136a88b3", "author": {"user": {"login": "abyrd", "name": "Andrew Byrd"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/c8b9a7987f33b3b48e3e16604ff92b69136a88b3", "committedDate": "2020-05-14T08:41:30Z", "message": "Merge branch 'dev-2.x' into otp2_add_taxi_mode"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2113, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}