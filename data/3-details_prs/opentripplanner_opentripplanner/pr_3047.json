{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NDA1Mjc5", "number": 3047, "title": "Add transfer priority to station", "bodyText": "This is based on #3045.\nTo be completed by pull request submitter:\n\n issue: #2935\n roadmap: No, this is a NeTEx specific feature.\n tests: Unit-tests are added and updated.\n formatting: Yes.\n documentation: The Configuration documentation is updated, not only with respect to this feature, but all OTP2 router tuning parameters.\n changelog: No, specific to NeTEx. No changes for GTFS feeds. If this feature is not configured, then there is very little changed.\n\nTo be completed by @opentripplanner/plc:\n\n reviews and approvals by 2 members, ideally from different organizations\n after merging: update the relevant card on the roadmap", "createdAt": "2020-04-22T16:37:50Z", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3047", "merged": true, "mergeCommit": {"oid": "5de2b3e095601ab67c99ce50c21bbbfa386d4bd8"}, "closed": true, "closedAt": "2020-04-23T13:47:58Z", "author": {"login": "t2gran"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaLUUqABqjMyNjE1NTQzNzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcadK5qAFqTM5OTExMTUxOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "53df999bd2b234f8c9a20ea78ce127f9bfc910ef", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/53df999bd2b234f8c9a20ea78ce127f9bfc910ef", "committedDate": "2020-04-22T16:25:47Z", "message": "Integrate Stop Transfer board/alight cost with into the Raptor routing.\n- Add documentation on configuration and update JavaDoc.\n- Add/update unit tests on config, mapping and calculations."}, "afterCommit": {"oid": "23e96b1485b40f2acd1dcb67ca63d72368cc9394", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/23e96b1485b40f2acd1dcb67ca63d72368cc9394", "committedDate": "2020-04-22T16:58:13Z", "message": "Integrate Stop Transfer board/alight cost with into the Raptor routing.\n- Add documentation on configuration and update JavaDoc.\n- Add/update unit tests on config, mapping and calculations."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bf966189b6212c440813d93f8fb2d5d812ef56b", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/3bf966189b6212c440813d93f8fb2d5d812ef56b", "committedDate": "2020-04-22T17:03:55Z", "message": "Clean code - SpeedTest - Log OTP version at the end of the test, so it become easy to compare results with other versions of OTP."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73d504954a8ff36575af6dc7e1d2791f8eb17d8a", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/73d504954a8ff36575af6dc7e1d2791f8eb17d8a", "committedDate": "2020-04-22T17:03:55Z", "message": "Remove boardSlack from heuristic cost minimum calculation, the board/alight slack is part of the minTravelTime and should not be part of any additional cost. The current heuristic cost calculation is not working properly - this is just a temporary correction. A real fix to this is to use a reverse search to calculate the generalized cost, not estimating it from an other search."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d87bb9a2cf3688dd8c448494377e43e7c336d06", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/0d87bb9a2cf3688dd8c448494377e43e7c336d06", "committedDate": "2020-04-22T17:03:55Z", "message": "Clean code\n  - Rename OTP internal 'cost' in Raptor path to 'generalizedCost'.\n  - Make CostCalculator.toOtpDomainCost none static, this enable extracting interface later.\n  - Make SearchContext.lifeCycleSubscriptions final, and add a close() method to prevent new subscriptions from being added."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2823d9c333a9268a8b54ef8a416e9694204f08b0", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/2823d9c333a9268a8b54ef8a416e9694204f08b0", "committedDate": "2020-04-22T17:03:55Z", "message": "Clean code - Extract CostCalculator as an interface. This wil enable us to provide alternative cost calculators later."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60f6ed4eaa1976bbf2aa3399dc745ce8bd2cd9c9", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/60f6ed4eaa1976bbf2aa3399dc745ce8bd2cd9c9", "committedDate": "2020-04-22T17:03:55Z", "message": "Refactor Station, Stop and all other StationElements to have final fields for all fields with basic types. This will make it simpler tp make the internal OTP Transit domain model immutable later."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a01aa5322ee617c0d36aea06fbead7fbd03557fa", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/a01aa5322ee617c0d36aea06fbead7fbd03557fa", "committedDate": "2020-04-22T17:03:55Z", "message": "Add TransferCostPriority to internal model and map from NeTEx model into internal domain model."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b08b7489d6d448f00c70c6348665afd3d390c37d", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/b08b7489d6d448f00c70c6348665afd3d390c37d", "committedDate": "2020-04-22T17:03:55Z", "message": "Clean code - Formatting McRangeRaptorWorkerState - no code changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccde367e0f06cd18a163dd03d6275ce3b9dc76e1", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/ccde367e0f06cd18a163dd03d6275ce3b9dc76e1", "committedDate": "2020-04-22T17:03:55Z", "message": "Clean code - Add OtpStartupInfo to the SpeedTest as well."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "23e96b1485b40f2acd1dcb67ca63d72368cc9394", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/23e96b1485b40f2acd1dcb67ca63d72368cc9394", "committedDate": "2020-04-22T16:58:13Z", "message": "Integrate Stop Transfer board/alight cost with into the Raptor routing.\n- Add documentation on configuration and update JavaDoc.\n- Add/update unit tests on config, mapping and calculations."}, "afterCommit": {"oid": "8f3cc789ebfcf35080c98876592bee8f0c452477", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/8f3cc789ebfcf35080c98876592bee8f0c452477", "committedDate": "2020-04-22T17:03:55Z", "message": "Integrate Stop Transfer board/alight cost with into the Raptor routing.\n- Add documentation on configuration and update JavaDoc.\n- Add/update unit tests on config, mapping and calculations."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "916bc210eb6f759acc1e1c8d98a8e426e984ea59", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/916bc210eb6f759acc1e1c8d98a8e426e984ea59", "committedDate": "2020-04-22T17:50:47Z", "message": "Integrate Stop Transfer board/alight cost with into the Raptor routing.\n- Add documentation on configuration and update JavaDoc.\n- Add/update unit tests on config, mapping and calculations."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8f3cc789ebfcf35080c98876592bee8f0c452477", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/8f3cc789ebfcf35080c98876592bee8f0c452477", "committedDate": "2020-04-22T17:03:55Z", "message": "Integrate Stop Transfer board/alight cost with into the Raptor routing.\n- Add documentation on configuration and update JavaDoc.\n- Add/update unit tests on config, mapping and calculations."}, "afterCommit": {"oid": "916bc210eb6f759acc1e1c8d98a8e426e984ea59", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/916bc210eb6f759acc1e1c8d98a8e426e984ea59", "committedDate": "2020-04-22T17:50:47Z", "message": "Integrate Stop Transfer board/alight cost with into the Raptor routing.\n- Add documentation on configuration and update JavaDoc.\n- Add/update unit tests on config, mapping and calculations."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7a4b925b137fba89e23e76c8269ffaa2030015e", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/a7a4b925b137fba89e23e76c8269ffaa2030015e", "committedDate": "2020-04-23T08:51:15Z", "message": "Merge branch 'dev-2.x' into otp2_station_priority"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4OTI2MTIw", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3047#pullrequestreview-398926120", "createdAt": "2020-04-23T09:34:14Z", "commit": {"oid": "a01aa5322ee617c0d36aea06fbead7fbd03557fa"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwOTozNDoxNFrOGKgEWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwOTo0MDozMFrOGKgVPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzY2NDM0Nw==", "bodyText": "Cost is an implementation detail, it does not need to be mentioned in the name. We could change to TransferPriority.", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3047#discussion_r413664347", "createdAt": "2020-04-23T09:34:14Z", "author": {"login": "abyrd"}, "path": "src/main/java/org/opentripplanner/model/TransferCostPriority.java", "diffHunk": "@@ -0,0 +1,24 @@\n+package org.opentripplanner.model;\n+\n+\n+/**\n+ * Categorize how suitable a Station or Transfer is it for transfer. The values arrange\n+ * stops from transfer FORBIDDEN to PREFERRED. First of all this should encourage\n+ * transfers between two trips/routes to happen at the best possible location if there\n+ * are multiple stop to choose from. But, it will also apply to score a journey over\n+ * another one, if one of the journeys score better on the transfers, and they have the\n+ * same cost.\n+ */\n+public enum TransferCostPriority {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a01aa5322ee617c0d36aea06fbead7fbd03557fa"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzY2ODY2OQ==", "bodyText": "Change mapper class name to match TransferCostPriority.", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3047#discussion_r413668669", "createdAt": "2020-04-23T09:40:30Z", "author": {"login": "abyrd"}, "path": "src/main/java/org/opentripplanner/netex/loader/mapping/TransferCostPriorityMapper.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package org.opentripplanner.netex.loader.mapping;\n+\n+import org.opentripplanner.model.TransferCostPriority;\n+import org.rutebanken.netex.model.InterchangeWeightingEnumeration;\n+\n+public class TransferCostPriorityMapper {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a01aa5322ee617c0d36aea06fbead7fbd03557fa"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0eeeb5ccce605eeb0abe418f22e2351922f7e450", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/0eeeb5ccce605eeb0abe418f22e2351922f7e450", "committedDate": "2020-04-23T10:25:35Z", "message": "Bugfix - The `enableStopTransferPriority()` is inverted. StopTransferPriority should only be enabled if it is configured, not if it is NOT configured."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64d058227253de3a256021ab876a73d9a6a64cf6", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/64d058227253de3a256021ab876a73d9a6a64cf6", "committedDate": "2020-04-23T10:29:33Z", "message": "Clean code - Take away the frame around the ASCII ART at start-up."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27d45ce0befb571acf7eef1be17ebf35d4bd926d", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/27d45ce0befb571acf7eef1be17ebf35d4bd926d", "committedDate": "2020-04-23T10:29:38Z", "message": "PR Review - Rename TransferCostPriority to TransferPriority, and all related classes like test and mappers. The documentation is also updated."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76a38e218ce8f0017c34e6fa962c1f02cd8541cb", "author": {"user": {"login": "t2gran", "name": "Thomas Gran"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/76a38e218ce8f0017c34e6fa962c1f02cd8541cb", "committedDate": "2020-04-23T10:33:27Z", "message": "Merge branch 'dev-2.x' into otp2_station_priority"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk5MTExNTE5", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3047#pullrequestreview-399111519", "createdAt": "2020-04-23T13:47:16Z", "commit": {"oid": "76a38e218ce8f0017c34e6fa962c1f02cd8541cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2102, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}