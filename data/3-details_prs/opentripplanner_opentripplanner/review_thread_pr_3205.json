{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3NjkzMzgz", "number": 3205, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwODo1OTo1M1rOEqoi7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowNjoyNFrOEqosfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMTM5OTQ5OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/opentripplanner/model/Timetable.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwODo1OTo1M1rOHc8uyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwODo1OTo1M1rOHc8uyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDExNzE5Mg==", "bodyText": "Add final", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3205#discussion_r500117192", "createdAt": "2020-10-06T08:59:53Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/model/Timetable.java", "diffHunk": "@@ -265,6 +264,8 @@ public TripTimes createUpdatedTripTimes(TripUpdate tripUpdate, TimeZone timeZone\n             int numStops = newTimes.getNumStops();\n             Integer delay = null;\n \n+            long today = updateServiceDate.getAsDate(timeZone).getTime() / 1000;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7398d1964c3aec554a1cc3e7d71bac6254288c5"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMTQwNDU1OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/opentripplanner/model/TimetableSnapshot.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowMToxMVrOHc8x7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowMToxMVrOHc8x7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDExNzk5OA==", "bodyText": "Add  a comment to this, why we need a SetMultimap.", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3205#discussion_r500117998", "createdAt": "2020-10-06T09:01:11Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/model/TimetableSnapshot.java", "diffHunk": "@@ -123,7 +122,7 @@ public boolean equals(Object obj) {\n      *\n      * TODO Find a generic way to keep all realtime indexes.\n      */\n-    private Multimap<Stop, TripPattern> patternsForStop = ArrayListMultimap.create();\n+    private SetMultimap<Stop, TripPattern> patternsForStop = HashMultimap.create();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7398d1964c3aec554a1cc3e7d71bac6254288c5"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMTQxNDYxOnYy", "diffSide": "RIGHT", "path": "src/main/java/org/opentripplanner/model/TimetableSnapshot.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowMzo1OFrOHc84WQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowMzo1OFrOHc84WQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDExOTY0MQ==", "bodyText": "Add a method to the TripPattern.isCreatedByRealTimeUpdater() : boolean and use it here.", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3205#discussion_r500119641", "createdAt": "2020-10-06T09:03:58Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/model/TimetableSnapshot.java", "diffHunk": "@@ -386,17 +385,22 @@ public String toString() {\n         return timetables.keySet();\n     }\n \n+    /**\n+     * Add the patterns to the stop index, only if they come from a modified pattern\n+     */\n     private void addPatternToIndex(TripPattern tripPattern) {\n-        for (Stop stop: tripPattern.getStops()) {\n-            patternsForStop.put(stop, tripPattern);\n+        if (tripPattern.getOriginalTripPattern() != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7398d1964c3aec554a1cc3e7d71bac6254288c5"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEzMTQyMzk4OnYy", "diffSide": "RIGHT", "path": "src/main/java/org/opentripplanner/model/TransitEntity.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowNjoyNFrOHc8-TA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNlQwOTowNjoyNFrOHc8-TA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEyMTE2NA==", "bodyText": "This is great! Should  have been done a long  time ago!", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3205#discussion_r500121164", "createdAt": "2020-10-06T09:06:24Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/model/TransitEntity.java", "diffHunk": "@@ -30,7 +30,7 @@ public void setId(T id) {\n      * example after reloading a serialized instance.\n      */\n     @Override\n-    public boolean equals(Object obj) {\n+    final public boolean equals(Object obj) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7398d1964c3aec554a1cc3e7d71bac6254288c5"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1696, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}