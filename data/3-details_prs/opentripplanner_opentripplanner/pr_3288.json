{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM2OTgwMDAz", "number": 3288, "title": "Tranks link pathway id in response", "bodyText": "To be completed by pull request submitter:\n\nFixes #3287\nNot on the roadmap but starts to address a TODO in LegMapper.java\nChangelog Added pathway FeedScopedId as the route text to trip plan responses. #3287\n\nTo be completed by @opentripplanner/plc:\n\n reviews and approvals by 2 members, ideally from different organizations\n after merging: update the relevant card on the roadmap", "createdAt": "2020-12-11T14:59:32Z", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3288", "merged": true, "mergeCommit": {"oid": "a060c5e467f2f7cccc31a3d6497aaecf68697386"}, "closed": true, "closedAt": "2021-03-11T14:40:19Z", "author": {"login": "mmaranda-cs"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkSM_DgH2gAyNTM2OTgwMDAzOjdlNDc3OTViNzVmMzBjNTQ5ODY0NDg4ZDEyMDFjYTYxOTg4YmUzYmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABeCG62kgFqTYwOTgzMzIwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7e47795b75f30c549864488d1201ca61988be3bb", "author": {"user": {"login": "mmaranda-cs", "name": "Matt Maranda"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/7e47795b75f30c549864488d1201ca61988be3bb", "committedDate": "2020-12-08T22:50:59Z", "message": "TOTP-9 changes to pass the feedscopedID to the the route for pathways."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49fde08938b9af81f4e2f6676a58e6780ae7d0f1", "author": {"user": {"login": "mmaranda-cs", "name": "Matt Maranda"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/49fde08938b9af81f4e2f6676a58e6780ae7d0f1", "committedDate": "2020-12-11T14:57:04Z", "message": "Updating Changelog.md"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22e2ce4ddddd3c6a0f13ff57a26a25511033ed2f", "author": {"user": {"login": "mmaranda-cs", "name": "Matt Maranda"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/22e2ce4ddddd3c6a0f13ff57a26a25511033ed2f", "committedDate": "2020-12-15T13:06:40Z", "message": "Merge branch 'dev-2.x' into tranksLink_pathway_id_in_response"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MzI3NTk2", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3288#pullrequestreview-555327596", "createdAt": "2020-12-18T09:27:06Z", "commit": {"oid": "22e2ce4ddddd3c6a0f13ff57a26a25511033ed2f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOToyNzowNlrOIIbNpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOTo0MjowOVrOIIb2CQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcwNTM4MA==", "bodyText": "We avoid using toString anywhere in the mapping. The internal model objects uses the toString for logging and debugging ONLY. Here you should use the: FeedScopedIdMapper.mapToApi(..), also we want to support different id implementation in the future, and this code would fail silently if we do that.", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3288#discussion_r545705380", "createdAt": "2020-12-18T09:27:06Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/api/mapping/LegMapper.java", "diffHunk": "@@ -80,6 +80,9 @@ public ApiLeg mapLeg(Leg domain, Calendar arrivalTimeFromPlace, Calendar departu\n             api.tripShortName = trip.getTripShortName();\n             api.tripBlockId = trip.getBlockId();\n         }\n+        else if (domain.pathway) {\n+            api.route = domain.edgeIdentifier.toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22e2ce4ddddd3c6a0f13ff57a26a25511033ed2f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcwOTY2NQ==", "bodyText": "Minor thing, but try to keep the constructor arguments in the order they are defined. Theid is normally the first field in an entity class, but since the class inherit edge, put the id after the toVertex in the list.", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3288#discussion_r545709665", "createdAt": "2020-12-18T09:31:33Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/graph_builder/module/AddTransitModelEntitiesToGraph.java", "diffHunk": "@@ -205,7 +205,8 @@ private void createPathwayEdgesAndAddThemToGraph(Graph graph) {\n                         pathway.getLength(),\n                         pathway.getStairCount(),\n                         pathway.getSlope(),\n-                        pathway.isPathwayModeWheelchairAccessible()\n+                        pathway.isPathwayModeWheelchairAccessible(),\n+                        pathway.getId()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22e2ce4ddddd3c6a0f13ff57a26a25511033ed2f"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcxMDE5Mw==", "bodyText": "We do not use * imports in OTP2.", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3288#discussion_r545710193", "createdAt": "2020-12-18T09:32:19Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/model/plan/Leg.java", "diffHunk": "@@ -1,10 +1,6 @@\n package org.opentripplanner.model.plan;\n \n-import org.opentripplanner.model.Agency;\n-import org.opentripplanner.model.Operator;\n-import org.opentripplanner.model.Route;\n-import org.opentripplanner.model.StreetNote;\n-import org.opentripplanner.model.Trip;\n+import org.opentripplanner.model.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22e2ce4ddddd3c6a0f13ff57a26a25511033ed2f"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcxMDI5Ng==", "bodyText": "indentation", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3288#discussion_r545710296", "createdAt": "2020-12-18T09:32:30Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/model/plan/Leg.java", "diffHunk": "@@ -29,6 +25,7 @@\n    */\n   public final TraverseMode mode;\n \n+    public FeedScopedId edgeIdentifier;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22e2ce4ddddd3c6a0f13ff57a26a25511033ed2f"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcxMTM2OA==", "bodyText": "Rename and add javadoc", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3288#discussion_r545711368", "createdAt": "2020-12-18T09:34:28Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/routing/algorithm/mapping/GraphPathToItineraryMapper.java", "diffHunk": "@@ -357,6 +358,19 @@ private static void setLegPathwayFlag(List<Leg> legs, State[][] legsStates) {\n         }\n     }\n \n+    private static void setRoute(List<Leg> legs, State[][] legsStates) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22e2ce4ddddd3c6a0f13ff57a26a25511033ed2f"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcxNTcyMQ==", "bodyText": "Move id up as the first field. We try to keep things readable, and it is a common de-facto standard that ids are defined before other fields in entities.  The serialVersionUID is also defined after the constructor, could you clean it up a bit and move it up as the first declared field. I know you did not do that.", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3288#discussion_r545715721", "createdAt": "2020-12-18T09:42:09Z", "author": {"login": "t2gran"}, "path": "src/main/java/org/opentripplanner/routing/edgetype/PathwayEdge.java", "diffHunk": "@@ -23,6 +24,7 @@\n     private String name = \"pathway\";\n \n     private boolean wheelchairAccessible = true;\n+    private FeedScopedId id;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22e2ce4ddddd3c6a0f13ff57a26a25511033ed2f"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfbb29c779ddb2d40888a513b05efd0aa910838d", "author": {"user": {"login": "mmaranda-cs", "name": "Matt Maranda"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/bfbb29c779ddb2d40888a513b05efd0aa910838d", "committedDate": "2020-12-29T14:59:37Z", "message": "Adding the relaxed Cost setter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ed55dbc90c8615f8ba7508601ce2370b43bf269", "author": {"user": {"login": "mmaranda-cs", "name": "Matt Maranda"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/7ed55dbc90c8615f8ba7508601ce2370b43bf269", "committedDate": "2020-12-29T15:31:27Z", "message": "Adding the relaxed Cost setter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b4769d14660e605fda60566bc5b7fe457603fd1", "author": {"user": {"login": "mmaranda-cs", "name": "Matt Maranda"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/1b4769d14660e605fda60566bc5b7fe457603fd1", "committedDate": "2020-12-29T15:31:52Z", "message": "Merge branch 'dev-2.x' of https://github.com/opentripplanner/OpenTripPlanner into tranksLink_pathway_id_in_response"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98bbc784e9194f4298fadb8651a3a5708baeffa5", "author": {"user": {"login": "mmaranda-cs", "name": "Matt Maranda"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/98bbc784e9194f4298fadb8651a3a5708baeffa5", "committedDate": "2020-12-29T15:41:25Z", "message": "Merge remote-tracking branch 'origin/tranksLink_pathway_id_in_response' into tranksLink_pathway_id_in_response"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb4c052620759f599d3053d7b5ae6531ffe874f", "author": {"user": {"login": "mmaranda-cs", "name": "Matt Maranda"}}, "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/9eb4c052620759f599d3053d7b5ae6531ffe874f", "committedDate": "2021-03-01T13:55:59Z", "message": "Merge branch 'dev-2.x' of https://github.com/opentripplanner/OpenTripPlanner into tranksLink_pathway_id_in_response"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA5ODMzMjA2", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3288#pullrequestreview-609833206", "createdAt": "2021-03-11T14:39:57Z", "commit": {"oid": "9eb4c052620759f599d3053d7b5ae6531ffe874f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2042, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}