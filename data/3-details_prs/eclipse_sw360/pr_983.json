{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3NzY0MjMy", "number": 983, "title": "feat(ObligationDataModel): Changes in Obligation data model", "bodyText": "Changes in Obligation data model\n\nRenamed struct Obligations to struct Obligation in License.thrift\nRenamed existing obligationType to obligationLevel\nCreated new obligationType field which has Permission,Risk,Exception,Restriction as options\nFixed adding obligation in licenses tab\n\n\n\n\nWhich issue is this pull request belonging to and how is it solving it? (#982, #959)\nDid you add or update any new dependencies that are required for your change? - No\n\n\nHow To Test?\n\n\nRun migration scripts - old data should be migrated and functional in Project administrator ,Clearing Report, Obligation View\nNo unused design doc should be left behind\nAdd Obligation from Obligation View and License View and verify its functionality\n\n\n\nHave you implemented any additional tests? - No\n\nChecklist\nMust:\n\n All related issues are referenced in commit messages and in PR\n\nSigned-off-by: Jaideep Palit jaideep.palit@siemens.com", "createdAt": "2020-09-16T06:31:33Z", "url": "https://github.com/eclipse/sw360/pull/983", "merged": true, "mergeCommit": {"oid": "27ea7a2a60705aba090054b031b1e4ce17b348f7"}, "closed": true, "closedAt": "2020-09-17T08:35:08Z", "author": {"login": "JaideepPalit"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJaCZNAFqTQ4OTQ5MjM5OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJo2rogFqTQ5MDIyNTg0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5NDkyMzk5", "url": "https://github.com/eclipse/sw360/pull/983#pullrequestreview-489492399", "createdAt": "2020-09-16T10:33:35Z", "commit": {"oid": "b24fdd5fdff4ac63395326cfd20a1ac775f0ea96"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMDozMzozNVrOHSqsbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNlQxMDo0MToyMlrOHSq8qA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMzNTkxNw==", "bodyText": "Please remove this count variable, It seems like it is not used anywhere.", "url": "https://github.com/eclipse/sw360/pull/983#discussion_r489335917", "createdAt": "2020-09-16T10:33:35Z", "author": {"login": "smrutis1"}, "path": "scripts/migrations/024_update_type_from_obligations_to_obligation.py", "diffHunk": "@@ -0,0 +1,85 @@\n+#!/usr/bin/python\n+# -----------------------------------------------------------------------------\n+# Copyright Siemens AG, 2020. Part of the SW360 Portal Project.\n+#\n+# This program and the accompanying materials are made\n+# available under the terms of the Eclipse Public License 2.0\n+# which is available at https://www.eclipse.org/legal/epl-2.0/\n+#\n+# SPDX-License-Identifier: EPL-2.0\n+#\n+# This is a manual database migration script. It is assumed that a\n+# dedicated framework for automatic migration will be written in the\n+# future. When that happens, this script should be refactored to conform\n+# to the framework's prerequisites to be run by the framework. For\n+# example, server address and db name should be parameterized, the code\n+# reorganized into a single class or function, etc.\n+#\n+# This script updates type of document from obligations to obligation\n+# ---------------------------------------------------------------------------------------------------------------------------------------------------------------\n+\n+import time\n+import couchdb\n+import json\n+from webbrowser import get\n+\n+# ---------------------------------------\n+# constants\n+# ---------------------------------------\n+\n+DRY_RUN = True\n+\n+COUCHSERVER = \"http://localhost:5984/\"\n+DBNAME = 'sw360db'\n+\n+couch=couchdb.Server(COUCHSERVER)\n+db = couch[DBNAME]\n+\n+# set fieldName\n+newValue = \"obligation\"\n+\n+# ----------------------------------------\n+# queries\n+# ----------------------------------------\n+\n+# get all obligations\n+all_obligations_query = {\"selector\": {\"type\": {\"$eq\": \"obligations\"}}}\n+\n+# ---------------------------------------\n+# functions\n+# ---------------------------------------\n+\n+def run():\n+    log = {}\n+    count = 0;\n+    log['updatedObligation'] = []\n+    print 'Getting all obligations'\n+    all_obligations = db.find(all_obligations_query)\n+    print 'found ' + str(len(all_obligations)) + ' obligations in db!'\n+    log['totalCount'] = len(all_obligations)\n+\n+    for obligation in all_obligations:\n+        print '\\tUpdating type of document from obligations to '+newValue+' for ID -> ' + obligation.get('_id')\n+        obligation['type'] = newValue\n+        updatedObligation = {}\n+        updatedObligation['id'] = obligation.get('_id')\n+        log['updatedObligation'].append(updatedObligation)\n+        count = count + 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b24fdd5fdff4ac63395326cfd20a1ac775f0ea96"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTM0MDA3Mg==", "bodyText": "It should be  ${oblig.listOfobligation} instead of ${oblig.obligations}", "url": "https://github.com/eclipse/sw360/pull/983#discussion_r489340072", "createdAt": "2020-09-16T10:41:22Z", "author": {"login": "smrutis1"}, "path": "frontend/sw360-portlet/src/main/resources/META-INF/resources/html/licenses/includes/detailTodos.jspf", "diffHunk": "@@ -95,15 +95,15 @@\n                     <td><sw360:DisplayBoolean value=\"${oblig.development}\" defined=\"${oblig.setDevelopment}\"/></td>\n                     <td><sw360:DisplayBoolean value=\"${oblig.distribution}\" defined=\"${oblig.setDistribution}\"/></td>\n                     <td><sw360:DisplayMap value=\"${oblig.customPropertyToValue}\"/></td>\n-                    <core_rt:if test=\"${oblig.listOfobligationSize > 0}\">\n-                        <td>\n+                    <td>\n+                        <core_rt:if test=\"${oblig.listOfobligationSize > 0}\">\n                             <ul>\n                                 <core_rt:forEach var=\"ob\" varStatus=\"status\" items=\"${oblig.obligations}\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b24fdd5fdff4ac63395326cfd20a1ac775f0ea96"}, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b24fdd5fdff4ac63395326cfd20a1ac775f0ea96", "author": {"user": {"login": "JaideepPalit", "name": "Jaideep Palit"}}, "url": "https://github.com/eclipse/sw360/commit/b24fdd5fdff4ac63395326cfd20a1ac775f0ea96", "committedDate": "2020-09-16T06:10:04Z", "message": "feat(ObligationDataModel): Changes in Obligation data model\n  * Renamed struct Obligations to struct Obligation in License.thrift\n  * Renamed existing obligationType to obligationLevel\n  * Created new obligationType field which has Permission,Risk,Exception,Restriction as options\n  * Fixed adding obligation in licenses tab\n\nSigned-off-by: Jaideep Palit <jaideep.palit@siemens.com>"}, "afterCommit": {"oid": "19bf2d8e4ef6bf6e0841bafa2f4f902c94dbb0ea", "author": {"user": {"login": "JaideepPalit", "name": "Jaideep Palit"}}, "url": "https://github.com/eclipse/sw360/commit/19bf2d8e4ef6bf6e0841bafa2f4f902c94dbb0ea", "committedDate": "2020-09-16T11:20:02Z", "message": "feat(ObligationDataModel): Changes in Obligation data model\n  * Renamed struct Obligations to struct Obligation in License.thrift\n  * Renamed existing obligationType to obligationLevel\n  * Created new obligationType field which has Permission,Risk,Exception,Restriction as options\n  * Fixed adding obligation in licenses tab\n\nSigned-off-by: Jaideep Palit <jaideep.palit@siemens.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c13cc93a498005828c276e3855d1124a6a6e0af", "author": {"user": {"login": "JaideepPalit", "name": "Jaideep Palit"}}, "url": "https://github.com/eclipse/sw360/commit/6c13cc93a498005828c276e3855d1124a6a6e0af", "committedDate": "2020-09-16T11:47:35Z", "message": "feat(ObligationDataModel): Changes in Obligation data model\n  * Renamed struct Obligations to struct Obligation in License.thrift\n  * Renamed existing obligationType to obligationLevel\n  * Created new obligationType field which has Permission,Risk,Exception,Restriction as options\n  * Fixed adding obligation in licenses tab\n\nSigned-off-by: Jaideep Palit <jaideep.palit@siemens.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "19bf2d8e4ef6bf6e0841bafa2f4f902c94dbb0ea", "author": {"user": {"login": "JaideepPalit", "name": "Jaideep Palit"}}, "url": "https://github.com/eclipse/sw360/commit/19bf2d8e4ef6bf6e0841bafa2f4f902c94dbb0ea", "committedDate": "2020-09-16T11:20:02Z", "message": "feat(ObligationDataModel): Changes in Obligation data model\n  * Renamed struct Obligations to struct Obligation in License.thrift\n  * Renamed existing obligationType to obligationLevel\n  * Created new obligationType field which has Permission,Risk,Exception,Restriction as options\n  * Fixed adding obligation in licenses tab\n\nSigned-off-by: Jaideep Palit <jaideep.palit@siemens.com>"}, "afterCommit": {"oid": "6c13cc93a498005828c276e3855d1124a6a6e0af", "author": {"user": {"login": "JaideepPalit", "name": "Jaideep Palit"}}, "url": "https://github.com/eclipse/sw360/commit/6c13cc93a498005828c276e3855d1124a6a6e0af", "committedDate": "2020-09-16T11:47:35Z", "message": "feat(ObligationDataModel): Changes in Obligation data model\n  * Renamed struct Obligations to struct Obligation in License.thrift\n  * Renamed existing obligationType to obligationLevel\n  * Created new obligationType field which has Permission,Risk,Exception,Restriction as options\n  * Fixed adding obligation in licenses tab\n\nSigned-off-by: Jaideep Palit <jaideep.palit@siemens.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMjI1ODQ5", "url": "https://github.com/eclipse/sw360/pull/983#pullrequestreview-490225849", "createdAt": "2020-09-17T03:58:29Z", "commit": {"oid": "6c13cc93a498005828c276e3855d1124a6a6e0af"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4844, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}