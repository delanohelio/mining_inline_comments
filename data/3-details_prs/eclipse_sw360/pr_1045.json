{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyMjMwMzY1", "number": 1045, "title": "feat(projectEdit): Project creators and moderators can edit few fields in a closed project", "bodyText": "Please provide a summary of your changes here.\n\nWhich issue is this pull request belonging to and how is it solving it?\n\n\nCloses: #1044\n\n\nDid you add or update any new dependencies that are required for your change? -\n\n\nNo\nIssue:  #1044\nSuggest Reviewer\n\nYou can suggest reviewers here with an @mention.\n\nHow To Test?\n\nHow should these changes be tested by the reviewer?\n\nAdd some user as moderator to a project. Make the project clearing state to closed. Login with user which is added as a moderator and edit the project. All fields should be disabled except editing external id, security vulnerability monitoring and security vulnerabilities display\n\nHave you implemented any additional tests? - No\n\nChecklist\nMust:\n\n All related issues are referenced in commit messages and in PR\n\nSigned-off-by: Smruti Prakash Sahoo smruti.sahoo@siemens.com", "createdAt": "2020-11-17T08:24:06Z", "url": "https://github.com/eclipse/sw360/pull/1045", "merged": true, "mergeCommit": {"oid": "7245e0929bbe114ed49de219c312b2c0b3b1900b"}, "closed": true, "closedAt": "2020-11-20T09:17:37Z", "author": {"login": "smrutis1"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddtXZDgFqTUzMzM2NDY3MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeQ76UgFqTUzNTEzNDQ2NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMzMzY0Njcx", "url": "https://github.com/eclipse/sw360/pull/1045#pullrequestreview-533364671", "createdAt": "2020-11-18T11:46:28Z", "commit": {"oid": "3d6a9298bcf4f8eb3db793816e8945620b16e767"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMTo0NjoyOVrOH1p_pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQxMTo1OTozMFrOH1qdGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjAyNDYxNQ==", "bodyText": "rename variable clearingStateClosedNUserNotAdmin to clearingStateClosedAndUserNotAdmin", "url": "https://github.com/eclipse/sw360/pull/1045#discussion_r526024615", "createdAt": "2020-11-18T11:46:29Z", "author": {"login": "akapti"}, "path": "frontend/sw360-portlet/src/main/resources/META-INF/resources/html/projects/includes/projects/administrationEdit.jspf", "diffHunk": "@@ -12,6 +12,7 @@\n <%@page import=\"org.eclipse.sw360.datahandler.thrift.projects.ProjectState\"%>\n <%@page import=\"org.eclipse.sw360.datahandler.thrift.projects.Project\" %>\n <core_rt:set var=\"isUnknownCTeamEnabled\" value='<%=PortalConstants.IS_CLEARING_TEAM_UNKNOWN_ENABLED%>'/>\n+<core_rt:set var=\"clearingStateClosedNUserNotAdmin\" value=\"${(project.clearingState eq 'CLOSED') && (isUserAdmin != 'Yes')}\"/>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d6a9298bcf4f8eb3db793816e8945620b16e767"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjAzMjE1NA==", "bodyText": "Can we re-use this method by moving to some commonly accessible class?", "url": "https://github.com/eclipse/sw360/pull/1045#discussion_r526032154", "createdAt": "2020-11-18T11:59:30Z", "author": {"login": "akapti"}, "path": "backend/src-common/src/main/java/org/eclipse/sw360/datahandler/db/ProjectDatabaseHandler.java", "diffHunk": "@@ -616,12 +616,19 @@ private boolean duplicateAttachmentExist(Project project) {\n \n     private boolean updateProjectAllowed(Project project, User user) {\n         if (project.clearingState != null && project.clearingState.equals(ProjectClearingState.CLOSED)\n-                && !PermissionUtils.isUserAtLeast(UserGroup.SW360_ADMIN, user)) {\n+                && !PermissionUtils.isUserAtLeast(UserGroup.SW360_ADMIN, user) && !isModeratorOrCreator(project, user)) {\n             return false;\n         }\n         return true;\n     }\n \n+    private boolean isModeratorOrCreator(Project project, User user) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d6a9298bcf4f8eb3db793816e8945620b16e767"}, "originalPosition": 11}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d6a9298bcf4f8eb3db793816e8945620b16e767", "author": {"user": {"login": "smrutis1", "name": "Smruti Prakash Sahoo"}}, "url": "https://github.com/eclipse/sw360/commit/3d6a9298bcf4f8eb3db793816e8945620b16e767", "committedDate": "2020-11-17T08:16:03Z", "message": "feat(projectEdit): Project creators and moderators can edit few fields in a closed project\n\nSigned-off-by: Smruti Prakash Sahoo <smruti.sahoo@siemens.com>"}, "afterCommit": {"oid": "178f98066c2d6eb01b06674be00e0f974cdebb47", "author": {"user": {"login": "smrutis1", "name": "Smruti Prakash Sahoo"}}, "url": "https://github.com/eclipse/sw360/commit/178f98066c2d6eb01b06674be00e0f974cdebb47", "committedDate": "2020-11-19T08:07:31Z", "message": "feat(projectEdit): Project creators, moderators and security responsibles can edit few fields in a closed project\n\nSigned-off-by: Smruti Prakash Sahoo <smruti.sahoo@siemens.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6cf31a312fd0e8a2368dd870ec09dbba900ad65", "author": {"user": {"login": "smrutis1", "name": "Smruti Prakash Sahoo"}}, "url": "https://github.com/eclipse/sw360/commit/a6cf31a312fd0e8a2368dd870ec09dbba900ad65", "committedDate": "2020-11-19T08:33:09Z", "message": "feat(projectEdit): Project creators and moderators can edit few fields in a closed project\n\nSigned-off-by: Smruti Prakash Sahoo <smruti.sahoo@siemens.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "178f98066c2d6eb01b06674be00e0f974cdebb47", "author": {"user": {"login": "smrutis1", "name": "Smruti Prakash Sahoo"}}, "url": "https://github.com/eclipse/sw360/commit/178f98066c2d6eb01b06674be00e0f974cdebb47", "committedDate": "2020-11-19T08:07:31Z", "message": "feat(projectEdit): Project creators, moderators and security responsibles can edit few fields in a closed project\n\nSigned-off-by: Smruti Prakash Sahoo <smruti.sahoo@siemens.com>"}, "afterCommit": {"oid": "a6cf31a312fd0e8a2368dd870ec09dbba900ad65", "author": {"user": {"login": "smrutis1", "name": "Smruti Prakash Sahoo"}}, "url": "https://github.com/eclipse/sw360/commit/a6cf31a312fd0e8a2368dd870ec09dbba900ad65", "committedDate": "2020-11-19T08:33:09Z", "message": "feat(projectEdit): Project creators and moderators can edit few fields in a closed project\n\nSigned-off-by: Smruti Prakash Sahoo <smruti.sahoo@siemens.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NDU5NzAz", "url": "https://github.com/eclipse/sw360/pull/1045#pullrequestreview-534459703", "createdAt": "2020-11-19T13:46:51Z", "commit": {"oid": "a6cf31a312fd0e8a2368dd870ec09dbba900ad65"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM1MTM0NDY1", "url": "https://github.com/eclipse/sw360/pull/1045#pullrequestreview-535134465", "createdAt": "2020-11-20T05:58:53Z", "commit": {"oid": "a6cf31a312fd0e8a2368dd870ec09dbba900ad65"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4862, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}