{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5OTMwNjMz", "number": 1331, "title": "Remove unnecessary subscription allowed check.", "bodyText": "Purpose\nRemove the additional check for the subscription validation\nIssues\n\nFixes #1332\nAutomation tests\n\nUnit tests added: Yes/No\nIntegration tests added: Yes/No\n\nTested environments\n\nNot Tested\n\nMaintainers: Check before merge\n\n Assigned 'Type' label\n Assigned the project\n Validated respective github issues\n Assigned milestone to the github issue(s)", "createdAt": "2020-07-16T06:31:30Z", "url": "https://github.com/wso2/product-microgateway/pull/1331", "merged": true, "mergeCommit": {"oid": "9603fbd554d200cca33c10114f70232dbe9b7b6c"}, "closed": true, "closedAt": "2020-07-16T09:57:51Z", "author": {"login": "menakaj"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1ZRJ9AH2gAyNDQ5OTMwNjMzOmJkZmIyZjUxZDdlZmMzMGExZTNlYzQ4NGEwM2QxMjI1Y2NkYjI0NzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1b61VAFqTQ0OTY4MjY5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bdfb2f51d7efc30a1e3ec484a03d1225ccdb2476", "author": {"user": {"login": "menakaj", "name": "Menaka Jayawardena"}}, "url": "https://github.com/wso2/product-microgateway/commit/bdfb2f51d7efc30a1e3ec484a03d1225ccdb2476", "committedDate": "2020-07-16T06:30:26Z", "message": "Remove unnecessary subscription allowed check."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NTg0OTk2", "url": "https://github.com/wso2/product-microgateway/pull/1331#pullrequestreview-449584996", "createdAt": "2020-07-16T07:34:52Z", "commit": {"oid": "bdfb2f51d7efc30a1e3ec484a03d1225ccdb2476"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNzozNDo1M1rOGydynQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwNzozNDo1M1rOGydynQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU3MDA3Nw==", "bodyText": "When subscription validation is enabled and the client id is missing, we need to handle that error scenario as well.", "url": "https://github.com/wso2/product-microgateway/pull/1331#discussion_r455570077", "createdAt": "2020-07-16T07:34:53Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-core/src/main/ballerina/src/gateway/handlers/token_introspection_handler.bal", "diffHunk": "@@ -91,7 +91,7 @@ public type KeyValidationHandler object {\n                 any clientId = claims[CLIENT_ID];\n                 boolean isAllowed = false;\n                 // If validateSubscription is true and clientID is present, do the subscription validation.\n-                if (clientId != () && clientId is string && self.validateSubscriptions) {\n+                if (clientId != () && clientId is string) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bdfb2f51d7efc30a1e3ec484a03d1225ccdb2476"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94b285498042de08d4df06fe949a5b1e18af1c78", "author": {"user": {"login": "menakaj", "name": "Menaka Jayawardena"}}, "url": "https://github.com/wso2/product-microgateway/commit/94b285498042de08d4df06fe949a5b1e18af1c78", "committedDate": "2020-07-16T08:13:08Z", "message": "Fix review comments.\n\n* Handle scenarios where client id is empty and validate subscription is enabled."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2be3d215c45c563a471bbceb988c508b00fa970b", "author": {"user": {"login": "menakaj", "name": "Menaka Jayawardena"}}, "url": "https://github.com/wso2/product-microgateway/commit/2be3d215c45c563a471bbceb988c508b00fa970b", "committedDate": "2020-07-16T09:16:42Z", "message": "Add test cases for empty client id scenario."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NjcxOTIy", "url": "https://github.com/wso2/product-microgateway/pull/1331#pullrequestreview-449671922", "createdAt": "2020-07-16T09:21:48Z", "commit": {"oid": "2be3d215c45c563a471bbceb988c508b00fa970b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwOToyMTo0OFrOGyihyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwOToyMTo0OFrOGyihyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY0NzY5MA==", "bodyText": "Is this print statement intentional?", "url": "https://github.com/wso2/product-microgateway/pull/1331#discussion_r455647690", "createdAt": "2020-07-16T09:21:48Z", "author": {"login": "AmaliMatharaarachchi"}, "path": "components/micro-gateway-core/src/main/ballerina/src/gateway/handlers/token_introspection_handler.bal", "diffHunk": "@@ -90,8 +90,16 @@ public type KeyValidationHandler object {\n                 map<any>? claims = principal?.claims;\n                 any clientId = claims[CLIENT_ID];\n                 boolean isAllowed = false;\n-                // If validateSubscription is true and clientID is present, do the subscription validation.\n-                if (clientId != () && clientId is string && self.validateSubscriptions) {\n+                io:println(\"Client Id ------>>>>>> \", (clientId is () || (clientId is string && clientId == \"\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2be3d215c45c563a471bbceb988c508b00fa970b"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "796a939d190c2fbc8d52304eb185513fd7b924fd", "author": {"user": {"login": "menakaj", "name": "Menaka Jayawardena"}}, "url": "https://github.com/wso2/product-microgateway/commit/796a939d190c2fbc8d52304eb185513fd7b924fd", "committedDate": "2020-07-16T09:23:10Z", "message": "Removed the print stmt."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NjgyNjk0", "url": "https://github.com/wso2/product-microgateway/pull/1331#pullrequestreview-449682694", "createdAt": "2020-07-16T09:35:46Z", "commit": {"oid": "796a939d190c2fbc8d52304eb185513fd7b924fd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1125, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}