{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1Njc4NDM0", "number": 944, "reviewThreads": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo0MDowM1rODZuhiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNTozNDoyMVrODaxK-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzAzMjQxOnYy", "diffSide": "RIGHT", "path": "components/micro-gateway-cli/src/main/resources/templates/listeners.mustache", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo0MDowM1rOFgR0rA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNjo1MToyOFrOFh5GWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5MDc2NA==", "bodyText": "Diff in this file says ballerinaKeystore is in different paths for different k8s configs. For example,\n\"${mgw-runtime.home}/runtime/bre/security/ballerinaKeystore.p12\"),\n\"{mgw-runtime.home}/security/ballerinaKeystore.p12\"),\n\"${mgw-runtime.home}/bre/security/ballerinaKeystore.p12\"", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369390764", "createdAt": "2020-01-22T06:40:03Z", "author": {"login": "praminda"}, "path": "components/micro-gateway-cli/src/main/resources/templates/listeners.mustache", "diffHunk": "@@ -90,7 +90,7 @@ listener http:Listener tokenListenerEndpoint = new (\n         secureSocket: {\n             keyStore: {\n                 path: gateway:getConfigValue(gateway:LISTENER_CONF_INSTANCE_ID, gateway:LISTENER_CONF_KEY_STORE_PATH,\n-                    \"${ballerina.home}/bre/security/ballerinaKeystore.p12\"),\n+                    \"${mgw-runtime.home}/runtime/bre/security/ballerinaKeystore.p12\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "234e440320af552ac9e93f6e046e14258580276d"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA4Mjg0MA==", "bodyText": "fixed with 116f0fd", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r371082840", "createdAt": "2020-01-27T06:51:28Z", "author": {"login": "VirajSalaka"}, "path": "components/micro-gateway-cli/src/main/resources/templates/listeners.mustache", "diffHunk": "@@ -90,7 +90,7 @@ listener http:Listener tokenListenerEndpoint = new (\n         secureSocket: {\n             keyStore: {\n                 path: gateway:getConfigValue(gateway:LISTENER_CONF_INSTANCE_ID, gateway:LISTENER_CONF_KEY_STORE_PATH,\n-                    \"${ballerina.home}/bre/security/ballerinaKeystore.p12\"),\n+                    \"${mgw-runtime.home}/runtime/bre/security/ballerinaKeystore.p12\"),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5MDc2NA=="}, "originalCommit": {"oid": "234e440320af552ac9e93f6e046e14258580276d"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzA1ODYxOnYy", "diffSide": "RIGHT", "path": "distribution/src/main/assembly/gw_runtimes/gw_runtime_windows.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo1NDozMlrOFgSDxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo1NDozMlrOFgSDxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5NDYzMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <source>${basedir}/target/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>\n          \n          \n            \n                        <source>${project.build.directory}/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369394630", "createdAt": "2020-01-22T06:54:32Z", "author": {"login": "praminda"}, "path": "distribution/src/main/assembly/gw_runtimes/gw_runtime_windows.xml", "diffHunk": "@@ -73,6 +59,14 @@\n             <source>${basedir}/resources/bin/gateway</source>\n             <outputDirectory>wso2am-micro-gw-windows-${project.version}/bin</outputDirectory>\n         </file>\n+        <file>\n+            <source>${basedir}/resources/ballerinaTruststore.p12</source>\n+            <outputDirectory>wso2am-micro-gw-windows-${project.version}/runtime/bre/security</outputDirectory>\n+        </file>\n+        <file>\n+            <source>${basedir}/target/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzA1OTI2OnYy", "diffSide": "RIGHT", "path": "distribution/src/main/assembly/gw_runtimes/gw_runtime_macos.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo1NDo1NFrOFgSEKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo1NDo1NFrOFgSEKA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5NDcyOA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <source>${basedir}/target/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>\n          \n          \n            \n                        <source>${project.build.directory}/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369394728", "createdAt": "2020-01-22T06:54:54Z", "author": {"login": "praminda"}, "path": "distribution/src/main/assembly/gw_runtimes/gw_runtime_macos.xml", "diffHunk": "@@ -74,6 +60,14 @@\n             <source>${basedir}/resources/bin/gateway.bat</source>\n             <outputDirectory>wso2am-micro-gw-macos-${project.version}/bin</outputDirectory>\n         </file>\n+        <file>\n+            <source>${basedir}/resources/ballerinaTruststore.p12</source>\n+            <outputDirectory>wso2am-micro-gw-macos-${project.version}/runtime/bre/security</outputDirectory>\n+        </file>\n+        <file>\n+            <source>${basedir}/target/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzA2MDA2OnYy", "diffSide": "RIGHT", "path": "distribution/src/main/assembly/gw_runtimes/gw_runtime_linux.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo1NTozMlrOFgSErw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo1NTozMlrOFgSErw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5NDg2Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <source>${basedir}/target/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>\n          \n          \n            \n                        <source>${project.build.directory}/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369394863", "createdAt": "2020-01-22T06:55:32Z", "author": {"login": "praminda"}, "path": "distribution/src/main/assembly/gw_runtimes/gw_runtime_linux.xml", "diffHunk": "@@ -74,6 +60,14 @@\n             <source>${basedir}/resources/bin/gateway.bat</source>\n             <outputDirectory>wso2am-micro-gw-linux-${project.version}/bin</outputDirectory>\n         </file>\n+        <file>\n+            <source>${basedir}/resources/ballerinaTruststore.p12</source>\n+            <outputDirectory>wso2am-micro-gw-linux-${project.version}/runtime/bre/security</outputDirectory>\n+        </file>\n+        <file>\n+            <source>${basedir}/target/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzA2MDQ4OnYy", "diffSide": "RIGHT", "path": "distribution/src/main/assembly/gw_runtimes/gw_runtime.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo1NTo1MVrOFgSE9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNjo1NTo1MVrOFgSE9A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM5NDkzMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        <source>${basedir}/target/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>\n          \n          \n            \n                        <source>${project.build.directory}/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369394932", "createdAt": "2020-01-22T06:55:51Z", "author": {"login": "praminda"}, "path": "distribution/src/main/assembly/gw_runtimes/gw_runtime.xml", "diffHunk": "@@ -73,6 +59,14 @@\n             <source>${basedir}/resources/bin/gateway.bat</source>\n             <outputDirectory>wso2am-micro-gw-${project.version}/bin</outputDirectory>\n         </file>\n+        <file>\n+            <source>${basedir}/resources/ballerinaTruststore.p12</source>\n+            <outputDirectory>wso2am-micro-gw-linux-${project.version}/runtime/bre/security</outputDirectory>\n+        </file>\n+        <file>\n+            <source>${basedir}/target/ballerina/jballerina-tools-${ballerina.platform.version}/bre/security/ballerinaKeystore.p12</source>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzE0NzQ1OnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNzo0NjowN1rOFgS5Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNjo1MTo0NlrOFh5GoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQwODI4Mg==", "bodyText": "We no longer need to export this since we don;t use unzip utility. Shall we rename GWHOME to GW_HOME to follow the naming standards.", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369408282", "createdAt": "2020-01-22T07:46:07Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA4MjkxMw==", "bodyText": "changed with 116f0fd", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r371082913", "createdAt": "2020-01-27T06:51:46Z", "author": {"login": "VirajSalaka"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQwODI4Mg=="}, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzE1MjM0OnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNzo0ODozNlrOFgS78Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNzo0ODozNlrOFgS78Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQwOTAwOQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            if test -d \"$JAVA_PATH\"; then\n          \n          \n            \n            if [ -d \"$JAVA_PATH\" ]; then", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369409009", "createdAt": "2020-01-22T07:48:36Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzE3MjA4OnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNzo1ODo0MVrOFgTITQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNjo1MzowMVrOFh5Hjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQxMjE3Mw==", "bodyText": "So what should be the command for this case?\nmicro-gw test --debug???", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369412173", "createdAt": "2020-01-22T07:58:41Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then\n+  JAVA_HOME=$JAVA_PATH\n fi\n \n-#To run the Java classes\n-java_cmd () {\n-  if [ -z \"$JAVACMD\" ] ; then\n-      if [ -n \"$JAVA_HOME\"  ] ; then\n-          if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n-              # IBM's JDK on AIX uses strange locations for the executables\n-              JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n-          else\n-              JAVACMD=\"$JAVA_HOME/bin/java\"\n-          fi\n-      else\n+BASE_DIR=$PWD\n+cygwin=false;\n+darwin=false;\n+os400=false;\n+mingw=false;\n+case \"`uname`\" in\n+CYGWIN*) cygwin=true;;\n+MINGW*) mingw=true;;\n+OS400*) os400=true;;\n+Darwin*) darwin=true\n+esac\n+\n+# For Cygwin, ensure paths are in UNIX format before anything is touched\n+if $cygwin; then\n+  [ -n \"$JAVA_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JAVA_HOME\"`\n+fi\n+\n+# For OS400\n+if $os400; then\n+  # Set job priority to standard for interactive (interactive - 6) by using\n+  # the interactive priority - 6, the helper threads that respond to requests\n+  # will be running at the same priority as interactive jobs.\n+  COMMAND='chgjob job('$JOBNAME') runpty(6)'\n+  system $COMMAND\n+\n+  # Enable multi threading\n+  QIBM_MULTI_THREADED=Y\n+  export QIBM_MULTI_THREADED\n+fi\n+\n+# For Migwn, ensure paths are in UNIX format before anything is touched\n+if $mingw ; then\n+  [ -n \"$JAVA_HOME\" ] &&\n+    JAVA_HOME=\"`(cd \"$JAVA_HOME\"; pwd)`\"\n+fi\n+\n+if [ -z \"$JAVACMD\" ] ; then\n+    if [ -n \"$JAVA_HOME\"  ] ; then\n+        if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n+            # IBM's JDK on AIX uses strange locations for the executables\n+            JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n+        else\n+            JAVACMD=\"$JAVA_HOME/bin/java\"\n+        fi\n+    else\n           JAVACMD=java\n+    fi\n+fi\n+\n+# For Cygwin, switch paths to Windows format before running java\n+if $cygwin; then\n+    JAVACMD=`cygpath --absolute --windows \"$JAVACMD\"`\n+fi\n+\n+if [ ! -x \"$JAVACMD\" ] ; then\n+  echo \"Error: JAVA Package inside the microgateway runtime distribution is not working.\"\n+  exit 1\n+fi\n+\n+# Ballerina test/debug command\n+argsLength=$#\n+args=($@)\n+for (( i=0; i<argsLength; i++ )); do\n+  if [  \"${args[$i]}\" = \"test\" ]; then\n+    for (( j=0; j<argsLength; j++ )); do\n+      if [ \"${args[$j]}\" = \"--debug\" ]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA4MzE1MA==", "bodyText": "This is added because the ballerina platform supports these parameters.", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r371083150", "createdAt": "2020-01-27T06:53:01Z", "author": {"login": "VirajSalaka"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then\n+  JAVA_HOME=$JAVA_PATH\n fi\n \n-#To run the Java classes\n-java_cmd () {\n-  if [ -z \"$JAVACMD\" ] ; then\n-      if [ -n \"$JAVA_HOME\"  ] ; then\n-          if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n-              # IBM's JDK on AIX uses strange locations for the executables\n-              JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n-          else\n-              JAVACMD=\"$JAVA_HOME/bin/java\"\n-          fi\n-      else\n+BASE_DIR=$PWD\n+cygwin=false;\n+darwin=false;\n+os400=false;\n+mingw=false;\n+case \"`uname`\" in\n+CYGWIN*) cygwin=true;;\n+MINGW*) mingw=true;;\n+OS400*) os400=true;;\n+Darwin*) darwin=true\n+esac\n+\n+# For Cygwin, ensure paths are in UNIX format before anything is touched\n+if $cygwin; then\n+  [ -n \"$JAVA_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JAVA_HOME\"`\n+fi\n+\n+# For OS400\n+if $os400; then\n+  # Set job priority to standard for interactive (interactive - 6) by using\n+  # the interactive priority - 6, the helper threads that respond to requests\n+  # will be running at the same priority as interactive jobs.\n+  COMMAND='chgjob job('$JOBNAME') runpty(6)'\n+  system $COMMAND\n+\n+  # Enable multi threading\n+  QIBM_MULTI_THREADED=Y\n+  export QIBM_MULTI_THREADED\n+fi\n+\n+# For Migwn, ensure paths are in UNIX format before anything is touched\n+if $mingw ; then\n+  [ -n \"$JAVA_HOME\" ] &&\n+    JAVA_HOME=\"`(cd \"$JAVA_HOME\"; pwd)`\"\n+fi\n+\n+if [ -z \"$JAVACMD\" ] ; then\n+    if [ -n \"$JAVA_HOME\"  ] ; then\n+        if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n+            # IBM's JDK on AIX uses strange locations for the executables\n+            JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n+        else\n+            JAVACMD=\"$JAVA_HOME/bin/java\"\n+        fi\n+    else\n           JAVACMD=java\n+    fi\n+fi\n+\n+# For Cygwin, switch paths to Windows format before running java\n+if $cygwin; then\n+    JAVACMD=`cygpath --absolute --windows \"$JAVACMD\"`\n+fi\n+\n+if [ ! -x \"$JAVACMD\" ] ; then\n+  echo \"Error: JAVA Package inside the microgateway runtime distribution is not working.\"\n+  exit 1\n+fi\n+\n+# Ballerina test/debug command\n+argsLength=$#\n+args=($@)\n+for (( i=0; i<argsLength; i++ )); do\n+  if [  \"${args[$i]}\" = \"test\" ]; then\n+    for (( j=0; j<argsLength; j++ )); do\n+      if [ \"${args[$j]}\" = \"--debug\" ]; then", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQxMjE3Mw=="}, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 92}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzE3ODM1OnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODowMTozNlrOFgTL7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODowMTozNlrOFgTL7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQxMzEwMw==", "bodyText": "As I see BAL_JAVA_DEBUG is not a variable known to user. Shall we say,\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    echo \"Please specify the debug port for the BAL_JAVA_DEBUG variable\"\n          \n          \n            \n                    echo \"Please specify the debug port for debug parameter\"", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369413103", "createdAt": "2020-01-22T08:01:36Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then\n+  JAVA_HOME=$JAVA_PATH\n fi\n \n-#To run the Java classes\n-java_cmd () {\n-  if [ -z \"$JAVACMD\" ] ; then\n-      if [ -n \"$JAVA_HOME\"  ] ; then\n-          if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n-              # IBM's JDK on AIX uses strange locations for the executables\n-              JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n-          else\n-              JAVACMD=\"$JAVA_HOME/bin/java\"\n-          fi\n-      else\n+BASE_DIR=$PWD\n+cygwin=false;\n+darwin=false;\n+os400=false;\n+mingw=false;\n+case \"`uname`\" in\n+CYGWIN*) cygwin=true;;\n+MINGW*) mingw=true;;\n+OS400*) os400=true;;\n+Darwin*) darwin=true\n+esac\n+\n+# For Cygwin, ensure paths are in UNIX format before anything is touched\n+if $cygwin; then\n+  [ -n \"$JAVA_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JAVA_HOME\"`\n+fi\n+\n+# For OS400\n+if $os400; then\n+  # Set job priority to standard for interactive (interactive - 6) by using\n+  # the interactive priority - 6, the helper threads that respond to requests\n+  # will be running at the same priority as interactive jobs.\n+  COMMAND='chgjob job('$JOBNAME') runpty(6)'\n+  system $COMMAND\n+\n+  # Enable multi threading\n+  QIBM_MULTI_THREADED=Y\n+  export QIBM_MULTI_THREADED\n+fi\n+\n+# For Migwn, ensure paths are in UNIX format before anything is touched\n+if $mingw ; then\n+  [ -n \"$JAVA_HOME\" ] &&\n+    JAVA_HOME=\"`(cd \"$JAVA_HOME\"; pwd)`\"\n+fi\n+\n+if [ -z \"$JAVACMD\" ] ; then\n+    if [ -n \"$JAVA_HOME\"  ] ; then\n+        if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n+            # IBM's JDK on AIX uses strange locations for the executables\n+            JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n+        else\n+            JAVACMD=\"$JAVA_HOME/bin/java\"\n+        fi\n+    else\n           JAVACMD=java\n+    fi\n+fi\n+\n+# For Cygwin, switch paths to Windows format before running java\n+if $cygwin; then\n+    JAVACMD=`cygpath --absolute --windows \"$JAVACMD\"`\n+fi\n+\n+if [ ! -x \"$JAVACMD\" ] ; then\n+  echo \"Error: JAVA Package inside the microgateway runtime distribution is not working.\"\n+  exit 1\n+fi\n+\n+# Ballerina test/debug command\n+argsLength=$#\n+args=($@)\n+for (( i=0; i<argsLength; i++ )); do\n+  if [  \"${args[$i]}\" = \"test\" ]; then\n+    for (( j=0; j<argsLength; j++ )); do\n+      if [ \"${args[$j]}\" = \"--debug\" ]; then\n+        BAL_JAVA_DEBUG=${args[$j+1]}\n       fi\n+    done\n   fi\n+done\n+\n+if [ -n \"${BAL_JAVA_DEBUG+set}\" ]; then\n+    if [ -z \"$BAL_JAVA_DEBUG\" ]; then\n+        echo \"Please specify the debug port for the BAL_JAVA_DEBUG variable\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 101}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzE3OTE3OnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODowMjowMFrOFgTMag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODowMjowMFrOFgTMag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQxMzIyNg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              exit 1\n          \n          \n            \n                    exit 1", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369413226", "createdAt": "2020-01-22T08:02:00Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then\n+  JAVA_HOME=$JAVA_PATH\n fi\n \n-#To run the Java classes\n-java_cmd () {\n-  if [ -z \"$JAVACMD\" ] ; then\n-      if [ -n \"$JAVA_HOME\"  ] ; then\n-          if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n-              # IBM's JDK on AIX uses strange locations for the executables\n-              JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n-          else\n-              JAVACMD=\"$JAVA_HOME/bin/java\"\n-          fi\n-      else\n+BASE_DIR=$PWD\n+cygwin=false;\n+darwin=false;\n+os400=false;\n+mingw=false;\n+case \"`uname`\" in\n+CYGWIN*) cygwin=true;;\n+MINGW*) mingw=true;;\n+OS400*) os400=true;;\n+Darwin*) darwin=true\n+esac\n+\n+# For Cygwin, ensure paths are in UNIX format before anything is touched\n+if $cygwin; then\n+  [ -n \"$JAVA_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JAVA_HOME\"`\n+fi\n+\n+# For OS400\n+if $os400; then\n+  # Set job priority to standard for interactive (interactive - 6) by using\n+  # the interactive priority - 6, the helper threads that respond to requests\n+  # will be running at the same priority as interactive jobs.\n+  COMMAND='chgjob job('$JOBNAME') runpty(6)'\n+  system $COMMAND\n+\n+  # Enable multi threading\n+  QIBM_MULTI_THREADED=Y\n+  export QIBM_MULTI_THREADED\n+fi\n+\n+# For Migwn, ensure paths are in UNIX format before anything is touched\n+if $mingw ; then\n+  [ -n \"$JAVA_HOME\" ] &&\n+    JAVA_HOME=\"`(cd \"$JAVA_HOME\"; pwd)`\"\n+fi\n+\n+if [ -z \"$JAVACMD\" ] ; then\n+    if [ -n \"$JAVA_HOME\"  ] ; then\n+        if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n+            # IBM's JDK on AIX uses strange locations for the executables\n+            JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n+        else\n+            JAVACMD=\"$JAVA_HOME/bin/java\"\n+        fi\n+    else\n           JAVACMD=java\n+    fi\n+fi\n+\n+# For Cygwin, switch paths to Windows format before running java\n+if $cygwin; then\n+    JAVACMD=`cygpath --absolute --windows \"$JAVACMD\"`\n+fi\n+\n+if [ ! -x \"$JAVACMD\" ] ; then\n+  echo \"Error: JAVA Package inside the microgateway runtime distribution is not working.\"\n+  exit 1\n+fi\n+\n+# Ballerina test/debug command\n+argsLength=$#\n+args=($@)\n+for (( i=0; i<argsLength; i++ )); do\n+  if [  \"${args[$i]}\" = \"test\" ]; then\n+    for (( j=0; j<argsLength; j++ )); do\n+      if [ \"${args[$j]}\" = \"--debug\" ]; then\n+        BAL_JAVA_DEBUG=${args[$j+1]}\n       fi\n+    done\n   fi\n+done\n+\n+if [ -n \"${BAL_JAVA_DEBUG+set}\" ]; then\n+    if [ -z \"$BAL_JAVA_DEBUG\" ]; then\n+        echo \"Please specify the debug port for the BAL_JAVA_DEBUG variable\"\n+  exit 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6877ea4e6a7953477ac2a7ed10c8f6621019e33c"}, "originalPosition": 102}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzI0MTQwOnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODoyODo0MlrOFgTyZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNjo1Nzo1M1rOFh5K6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyMjk0OQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                echo \"Warning !!!. User specified JAVA_OPTS may interfere with BAL_JAVA_DEBUG\"\n          \n          \n            \n                echo \"Warn: User specified JAVA_OPTS may interfere with BAL_JAVA_DEBUG\"", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369422949", "createdAt": "2020-01-22T08:28:42Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then\n+  JAVA_HOME=$JAVA_PATH\n fi\n \n-#To run the Java classes\n-java_cmd () {\n-  if [ -z \"$JAVACMD\" ] ; then\n-      if [ -n \"$JAVA_HOME\"  ] ; then\n-          if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n-              # IBM's JDK on AIX uses strange locations for the executables\n-              JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n-          else\n-              JAVACMD=\"$JAVA_HOME/bin/java\"\n-          fi\n-      else\n+BASE_DIR=$PWD\n+cygwin=false;\n+darwin=false;\n+os400=false;\n+mingw=false;\n+case \"`uname`\" in\n+CYGWIN*) cygwin=true;;\n+MINGW*) mingw=true;;\n+OS400*) os400=true;;\n+Darwin*) darwin=true\n+esac\n+\n+# For Cygwin, ensure paths are in UNIX format before anything is touched\n+if $cygwin; then\n+  [ -n \"$JAVA_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JAVA_HOME\"`\n+fi\n+\n+# For OS400\n+if $os400; then\n+  # Set job priority to standard for interactive (interactive - 6) by using\n+  # the interactive priority - 6, the helper threads that respond to requests\n+  # will be running at the same priority as interactive jobs.\n+  COMMAND='chgjob job('$JOBNAME') runpty(6)'\n+  system $COMMAND\n+\n+  # Enable multi threading\n+  QIBM_MULTI_THREADED=Y\n+  export QIBM_MULTI_THREADED\n+fi\n+\n+# For Migwn, ensure paths are in UNIX format before anything is touched\n+if $mingw ; then\n+  [ -n \"$JAVA_HOME\" ] &&\n+    JAVA_HOME=\"`(cd \"$JAVA_HOME\"; pwd)`\"\n+fi\n+\n+if [ -z \"$JAVACMD\" ] ; then\n+    if [ -n \"$JAVA_HOME\"  ] ; then\n+        if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n+            # IBM's JDK on AIX uses strange locations for the executables\n+            JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n+        else\n+            JAVACMD=\"$JAVA_HOME/bin/java\"\n+        fi\n+    else\n           JAVACMD=java\n+    fi\n+fi\n+\n+# For Cygwin, switch paths to Windows format before running java\n+if $cygwin; then\n+    JAVACMD=`cygpath --absolute --windows \"$JAVACMD\"`\n+fi\n+\n+if [ ! -x \"$JAVACMD\" ] ; then\n+  echo \"Error: JAVA Package inside the microgateway runtime distribution is not working.\"\n+  exit 1\n+fi\n+\n+# Ballerina test/debug command\n+argsLength=$#\n+args=($@)\n+for (( i=0; i<argsLength; i++ )); do\n+  if [  \"${args[$i]}\" = \"test\" ]; then\n+    for (( j=0; j<argsLength; j++ )); do\n+      if [ \"${args[$j]}\" = \"--debug\" ]; then\n+        BAL_JAVA_DEBUG=${args[$j+1]}\n       fi\n+    done\n   fi\n+done\n+\n+if [ -n \"${BAL_JAVA_DEBUG+set}\" ]; then\n+    if [ -z \"$BAL_JAVA_DEBUG\" ]; then\n+        echo \"Please specify the debug port for the BAL_JAVA_DEBUG variable\"\n+  exit 1\n+    else\n+  if [ -n \"$JAVA_OPTS\" ]; then\n+    echo \"Warning !!!. User specified JAVA_OPTS may interfere with BAL_JAVA_DEBUG\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA4NDAwOQ==", "bodyText": "fixed with ee002a5", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r371084009", "createdAt": "2020-01-27T06:57:53Z", "author": {"login": "VirajSalaka"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then\n+  JAVA_HOME=$JAVA_PATH\n fi\n \n-#To run the Java classes\n-java_cmd () {\n-  if [ -z \"$JAVACMD\" ] ; then\n-      if [ -n \"$JAVA_HOME\"  ] ; then\n-          if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n-              # IBM's JDK on AIX uses strange locations for the executables\n-              JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n-          else\n-              JAVACMD=\"$JAVA_HOME/bin/java\"\n-          fi\n-      else\n+BASE_DIR=$PWD\n+cygwin=false;\n+darwin=false;\n+os400=false;\n+mingw=false;\n+case \"`uname`\" in\n+CYGWIN*) cygwin=true;;\n+MINGW*) mingw=true;;\n+OS400*) os400=true;;\n+Darwin*) darwin=true\n+esac\n+\n+# For Cygwin, ensure paths are in UNIX format before anything is touched\n+if $cygwin; then\n+  [ -n \"$JAVA_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JAVA_HOME\"`\n+fi\n+\n+# For OS400\n+if $os400; then\n+  # Set job priority to standard for interactive (interactive - 6) by using\n+  # the interactive priority - 6, the helper threads that respond to requests\n+  # will be running at the same priority as interactive jobs.\n+  COMMAND='chgjob job('$JOBNAME') runpty(6)'\n+  system $COMMAND\n+\n+  # Enable multi threading\n+  QIBM_MULTI_THREADED=Y\n+  export QIBM_MULTI_THREADED\n+fi\n+\n+# For Migwn, ensure paths are in UNIX format before anything is touched\n+if $mingw ; then\n+  [ -n \"$JAVA_HOME\" ] &&\n+    JAVA_HOME=\"`(cd \"$JAVA_HOME\"; pwd)`\"\n+fi\n+\n+if [ -z \"$JAVACMD\" ] ; then\n+    if [ -n \"$JAVA_HOME\"  ] ; then\n+        if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n+            # IBM's JDK on AIX uses strange locations for the executables\n+            JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n+        else\n+            JAVACMD=\"$JAVA_HOME/bin/java\"\n+        fi\n+    else\n           JAVACMD=java\n+    fi\n+fi\n+\n+# For Cygwin, switch paths to Windows format before running java\n+if $cygwin; then\n+    JAVACMD=`cygpath --absolute --windows \"$JAVACMD\"`\n+fi\n+\n+if [ ! -x \"$JAVACMD\" ] ; then\n+  echo \"Error: JAVA Package inside the microgateway runtime distribution is not working.\"\n+  exit 1\n+fi\n+\n+# Ballerina test/debug command\n+argsLength=$#\n+args=($@)\n+for (( i=0; i<argsLength; i++ )); do\n+  if [  \"${args[$i]}\" = \"test\" ]; then\n+    for (( j=0; j<argsLength; j++ )); do\n+      if [ \"${args[$j]}\" = \"--debug\" ]; then\n+        BAL_JAVA_DEBUG=${args[$j+1]}\n       fi\n+    done\n   fi\n+done\n+\n+if [ -n \"${BAL_JAVA_DEBUG+set}\" ]; then\n+    if [ -z \"$BAL_JAVA_DEBUG\" ]; then\n+        echo \"Please specify the debug port for the BAL_JAVA_DEBUG variable\"\n+  exit 1\n+    else\n+  if [ -n \"$JAVA_OPTS\" ]; then\n+    echo \"Warning !!!. User specified JAVA_OPTS may interfere with BAL_JAVA_DEBUG\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyMjk0OQ=="}, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 105}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzI0MjU3OnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODoyOTowOVrOFgTzHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNjo1Nzo0M1rOFh5Kxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyMzEzMw==", "bodyText": "Please add a comment explaining whats going on in these conditions", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369423133", "createdAt": "2020-01-22T08:29:09Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then\n+  JAVA_HOME=$JAVA_PATH\n fi\n \n-#To run the Java classes\n-java_cmd () {\n-  if [ -z \"$JAVACMD\" ] ; then\n-      if [ -n \"$JAVA_HOME\"  ] ; then\n-          if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n-              # IBM's JDK on AIX uses strange locations for the executables\n-              JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n-          else\n-              JAVACMD=\"$JAVA_HOME/bin/java\"\n-          fi\n-      else\n+BASE_DIR=$PWD\n+cygwin=false;\n+darwin=false;\n+os400=false;\n+mingw=false;\n+case \"`uname`\" in\n+CYGWIN*) cygwin=true;;\n+MINGW*) mingw=true;;\n+OS400*) os400=true;;\n+Darwin*) darwin=true\n+esac\n+\n+# For Cygwin, ensure paths are in UNIX format before anything is touched\n+if $cygwin; then\n+  [ -n \"$JAVA_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JAVA_HOME\"`\n+fi\n+\n+# For OS400\n+if $os400; then\n+  # Set job priority to standard for interactive (interactive - 6) by using\n+  # the interactive priority - 6, the helper threads that respond to requests\n+  # will be running at the same priority as interactive jobs.\n+  COMMAND='chgjob job('$JOBNAME') runpty(6)'\n+  system $COMMAND\n+\n+  # Enable multi threading\n+  QIBM_MULTI_THREADED=Y\n+  export QIBM_MULTI_THREADED\n+fi\n+\n+# For Migwn, ensure paths are in UNIX format before anything is touched\n+if $mingw ; then\n+  [ -n \"$JAVA_HOME\" ] &&\n+    JAVA_HOME=\"`(cd \"$JAVA_HOME\"; pwd)`\"\n+fi\n+\n+if [ -z \"$JAVACMD\" ] ; then\n+    if [ -n \"$JAVA_HOME\"  ] ; then\n+        if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n+            # IBM's JDK on AIX uses strange locations for the executables\n+            JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n+        else\n+            JAVACMD=\"$JAVA_HOME/bin/java\"\n+        fi\n+    else\n           JAVACMD=java\n+    fi\n+fi\n+\n+# For Cygwin, switch paths to Windows format before running java\n+if $cygwin; then\n+    JAVACMD=`cygpath --absolute --windows \"$JAVACMD\"`\n+fi\n+\n+if [ ! -x \"$JAVACMD\" ] ; then\n+  echo \"Error: JAVA Package inside the microgateway runtime distribution is not working.\"\n+  exit 1\n+fi\n+\n+# Ballerina test/debug command\n+argsLength=$#\n+args=($@)\n+for (( i=0; i<argsLength; i++ )); do\n+  if [  \"${args[$i]}\" = \"test\" ]; then\n+    for (( j=0; j<argsLength; j++ )); do\n+      if [ \"${args[$j]}\" = \"--debug\" ]; then\n+        BAL_JAVA_DEBUG=${args[$j+1]}\n       fi\n+    done\n   fi\n+done\n+\n+if [ -n \"${BAL_JAVA_DEBUG+set}\" ]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 99}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA4Mzk3NA==", "bodyText": "added with ee002a5", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r371083974", "createdAt": "2020-01-27T06:57:43Z", "author": {"login": "VirajSalaka"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then\n+  JAVA_HOME=$JAVA_PATH\n fi\n \n-#To run the Java classes\n-java_cmd () {\n-  if [ -z \"$JAVACMD\" ] ; then\n-      if [ -n \"$JAVA_HOME\"  ] ; then\n-          if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n-              # IBM's JDK on AIX uses strange locations for the executables\n-              JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n-          else\n-              JAVACMD=\"$JAVA_HOME/bin/java\"\n-          fi\n-      else\n+BASE_DIR=$PWD\n+cygwin=false;\n+darwin=false;\n+os400=false;\n+mingw=false;\n+case \"`uname`\" in\n+CYGWIN*) cygwin=true;;\n+MINGW*) mingw=true;;\n+OS400*) os400=true;;\n+Darwin*) darwin=true\n+esac\n+\n+# For Cygwin, ensure paths are in UNIX format before anything is touched\n+if $cygwin; then\n+  [ -n \"$JAVA_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JAVA_HOME\"`\n+fi\n+\n+# For OS400\n+if $os400; then\n+  # Set job priority to standard for interactive (interactive - 6) by using\n+  # the interactive priority - 6, the helper threads that respond to requests\n+  # will be running at the same priority as interactive jobs.\n+  COMMAND='chgjob job('$JOBNAME') runpty(6)'\n+  system $COMMAND\n+\n+  # Enable multi threading\n+  QIBM_MULTI_THREADED=Y\n+  export QIBM_MULTI_THREADED\n+fi\n+\n+# For Migwn, ensure paths are in UNIX format before anything is touched\n+if $mingw ; then\n+  [ -n \"$JAVA_HOME\" ] &&\n+    JAVA_HOME=\"`(cd \"$JAVA_HOME\"; pwd)`\"\n+fi\n+\n+if [ -z \"$JAVACMD\" ] ; then\n+    if [ -n \"$JAVA_HOME\"  ] ; then\n+        if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n+            # IBM's JDK on AIX uses strange locations for the executables\n+            JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n+        else\n+            JAVACMD=\"$JAVA_HOME/bin/java\"\n+        fi\n+    else\n           JAVACMD=java\n+    fi\n+fi\n+\n+# For Cygwin, switch paths to Windows format before running java\n+if $cygwin; then\n+    JAVACMD=`cygpath --absolute --windows \"$JAVACMD\"`\n+fi\n+\n+if [ ! -x \"$JAVACMD\" ] ; then\n+  echo \"Error: JAVA Package inside the microgateway runtime distribution is not working.\"\n+  exit 1\n+fi\n+\n+# Ballerina test/debug command\n+argsLength=$#\n+args=($@)\n+for (( i=0; i<argsLength; i++ )); do\n+  if [  \"${args[$i]}\" = \"test\" ]; then\n+    for (( j=0; j<argsLength; j++ )); do\n+      if [ \"${args[$j]}\" = \"--debug\" ]; then\n+        BAL_JAVA_DEBUG=${args[$j+1]}\n       fi\n+    done\n   fi\n+done\n+\n+if [ -n \"${BAL_JAVA_DEBUG+set}\" ]; then", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyMzEzMw=="}, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 99}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzI0MzMzOnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODoyOTozMlrOFgTzmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODoyOTozMlrOFgTzmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyMzI1OA==", "bodyText": "Check the indentation of else block", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369423258", "createdAt": "2020-01-22T08:29:32Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -45,30 +45,106 @@ PRGDIR=`dirname \"$PRG\"`\n \n # set BALLERINA_HOME\n GWHOME=`cd \"$PRGDIR/..\" ; pwd`\n-export BALLERINA_HOME=$GWHOME'/runtime'\n export JAVA_HOME=$GWHOME'/lib/jdk8u202-b08-jre'\n export MGW_VERSION=\"3.1.0\"\n export GW_HOME=\"$GWHOME\"\n \n-if [ -e \"$GWHOME/bin/gateway.pid\" ]; then\n-  PID=`cat \"$GWHOME\"/bin/gateway.pid`\n+JAVA_PATH=$GWHOME/lib/jdk8u202-b08-jre\n+if test -d \"$JAVA_PATH\"; then\n+  JAVA_HOME=$JAVA_PATH\n fi\n \n-#To run the Java classes\n-java_cmd () {\n-  if [ -z \"$JAVACMD\" ] ; then\n-      if [ -n \"$JAVA_HOME\"  ] ; then\n-          if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n-              # IBM's JDK on AIX uses strange locations for the executables\n-              JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n-          else\n-              JAVACMD=\"$JAVA_HOME/bin/java\"\n-          fi\n-      else\n+BASE_DIR=$PWD\n+cygwin=false;\n+darwin=false;\n+os400=false;\n+mingw=false;\n+case \"`uname`\" in\n+CYGWIN*) cygwin=true;;\n+MINGW*) mingw=true;;\n+OS400*) os400=true;;\n+Darwin*) darwin=true\n+esac\n+\n+# For Cygwin, ensure paths are in UNIX format before anything is touched\n+if $cygwin; then\n+  [ -n \"$JAVA_HOME\" ] && JAVA_HOME=`cygpath --unix \"$JAVA_HOME\"`\n+fi\n+\n+# For OS400\n+if $os400; then\n+  # Set job priority to standard for interactive (interactive - 6) by using\n+  # the interactive priority - 6, the helper threads that respond to requests\n+  # will be running at the same priority as interactive jobs.\n+  COMMAND='chgjob job('$JOBNAME') runpty(6)'\n+  system $COMMAND\n+\n+  # Enable multi threading\n+  QIBM_MULTI_THREADED=Y\n+  export QIBM_MULTI_THREADED\n+fi\n+\n+# For Migwn, ensure paths are in UNIX format before anything is touched\n+if $mingw ; then\n+  [ -n \"$JAVA_HOME\" ] &&\n+    JAVA_HOME=\"`(cd \"$JAVA_HOME\"; pwd)`\"\n+fi\n+\n+if [ -z \"$JAVACMD\" ] ; then\n+    if [ -n \"$JAVA_HOME\"  ] ; then\n+        if [ -x \"$JAVA_HOME/jre/sh/java\" ] ; then\n+            # IBM's JDK on AIX uses strange locations for the executables\n+            JAVACMD=\"$JAVA_HOME/jre/sh/java\"\n+        else\n+            JAVACMD=\"$JAVA_HOME/bin/java\"\n+        fi\n+    else\n           JAVACMD=java\n+    fi\n+fi\n+\n+# For Cygwin, switch paths to Windows format before running java\n+if $cygwin; then\n+    JAVACMD=`cygpath --absolute --windows \"$JAVACMD\"`\n+fi\n+\n+if [ ! -x \"$JAVACMD\" ] ; then\n+  echo \"Error: JAVA Package inside the microgateway runtime distribution is not working.\"\n+  exit 1\n+fi\n+\n+# Ballerina test/debug command\n+argsLength=$#\n+args=($@)\n+for (( i=0; i<argsLength; i++ )); do\n+  if [  \"${args[$i]}\" = \"test\" ]; then\n+    for (( j=0; j<argsLength; j++ )); do\n+      if [ \"${args[$j]}\" = \"--debug\" ]; then\n+        BAL_JAVA_DEBUG=${args[$j+1]}\n       fi\n+    done\n   fi\n+done\n+\n+if [ -n \"${BAL_JAVA_DEBUG+set}\" ]; then\n+    if [ -z \"$BAL_JAVA_DEBUG\" ]; then\n+        echo \"Please specify the debug port for the BAL_JAVA_DEBUG variable\"\n+  exit 1\n+    else", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 103}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzI0OTIyOnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODozMTo0OFrOFgT3Og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODozMTo0OFrOFgT3Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNDE4Ng==", "bodyText": "Looks like the block is indented with two spaces", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369424186", "createdAt": "2020-01-22T08:31:48Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -113,61 +214,53 @@ done\n for last; do true; done\n \n if [ ! \"$CMD\" = \"stop\" ]; then\n-  if [[ ! -f \"$1\" ]]; then\n+  if [[ \"$CMD\" == \"\" ]]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 158}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzI1NzU0OnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODozNDo1OVrOFgT8Nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODozNDo1OVrOFgT8Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNTQ2Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            java_cmd_tools \"$CONFIG_FILE $CONFIG_OUT_FILE\"\n          \n          \n            \n                java_cmd_tools \"$CONFIG_FILE $CONFIG_OUT_FILE\"", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369425463", "createdAt": "2020-01-22T08:34:59Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -113,61 +214,53 @@ done\n for last; do true; done\n \n if [ ! \"$CMD\" = \"stop\" ]; then\n-  if [[ ! -f \"$1\" ]]; then\n+  if [[ \"$CMD\" == \"\" ]]; then\n+    if [[ ! -f \"$1\" ]]; then\n       echo \"Path to executable jar file is invalid\"\n       exit 0\n-  fi\n-fi\n-\n-\n-# Extract ballerina runtime\n-if [ ! -d \"$GWHOME/runtime\" ]; then\n-    echo \"Initializing Runtime...\"\n-    java_cmd \"unzip\"\n-    if [ $? -eq 0 ]; then\n-        cp $GWHOME/lib/gateway/*.jar $GWHOME/runtime/bre/lib/\n     fi\n+  elif [[ ! -f \"${args[1]}\" ]]; then\n+      echo \"Path to executable jar file is invalid\"\n+      exit 0\n+  fi\n fi\n \n-# Set JAVA Xms and Xmx values in Ballerina runtime\n-sed -i\".back\" \"s/-Xms[0-9]*m/-Xms$JAVA_XMS_VALUE/\" $BALLERINA_HOME/bin/ballerina\n-sed -i\".back\" \"s/-Xmx[0-9]*m/-Xmx$JAVA_XMX_VALUE/\" $BALLERINA_HOME/bin/ballerina\n-rm $BALLERINA_HOME/bin/ballerina.back\n-\n-FLAG=\"false\"\n+OBSERVABILITY_FLAG=\"false\"\n CONFIG_FILE=\"$GWHOME/conf/micro-gw.conf\"\n CONFIG_OUT_FILE=\"$GWHOME/.config\"\n \n if [[ $b7a_observability_metrics_enabled == \"true\" ]]; then\n-    FLAG=\"true\"\n+    OBSERVABILITY_FLAG=\"true\"\n else\n     for c in $*\n     do\n-        if [ \"$c\" = \"--b7a.observability.enabled=true\" ] || [ \"$c\" = \"--b7a.observability.metrics.enabled=true\" ]; then \n-            FLAG=\"true\"\n-            break    \n+        if [ \"$c\" = \"--b7a.observability.enabled=true\" ] || [ \"$c\" = \"--b7a.observability.metrics.enabled=true\" ]; then\n+            OBSERVABILITY_FLAG=\"true\"\n+            break\n         fi\n-    done    \n+    done\n fi\n \n-java_cmd \"getConfig $CONFIG_FILE $CONFIG_OUT_FILE\"\n-\n-if [ -f \"$CONFIG_OUT_FILE\" ]; then\n-    if [ \"$FLAG\" != \"true\" ]; then \n-        if [ $(sed -n '1p' $CONFIG_OUT_FILE) == \"true\" ]; then\n-            FLAG=\"true\"\n-        fi\n-    fi\n-    if [ \"$FLAG\" == \"true\" ]; then\n-        jmx_port=$(sed -n '2p' $CONFIG_OUT_FILE)\n-        export JAVA_OPTS=\"-javaagent:$GWHOME/lib/gateway/jmx_prometheus_javaagent-0.12.0.jar=$jmx_port:$GWHOME/conf/Prometheus/config.yml\"\n-    fi\n-else\n-    echo \"Error while reading Observability configurations from the file\"\n+if [ ! \"$CMD\" = \"stop\" ]; then\n+java_cmd_tools \"$CONFIG_FILE $CONFIG_OUT_FILE\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 221}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzI1ODQ3OnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODozNToxN1rOFgT8tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODozNToxN1rOFgT8tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNTU5MQ==", "bodyText": "Block is indented with two spaces", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369425591", "createdAt": "2020-01-22T08:35:17Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -113,61 +214,53 @@ done\n for last; do true; done\n \n if [ ! \"$CMD\" = \"stop\" ]; then\n-  if [[ ! -f \"$1\" ]]; then\n+  if [[ \"$CMD\" == \"\" ]]; then\n+    if [[ ! -f \"$1\" ]]; then\n       echo \"Path to executable jar file is invalid\"\n       exit 0\n-  fi\n-fi\n-\n-\n-# Extract ballerina runtime\n-if [ ! -d \"$GWHOME/runtime\" ]; then\n-    echo \"Initializing Runtime...\"\n-    java_cmd \"unzip\"\n-    if [ $? -eq 0 ]; then\n-        cp $GWHOME/lib/gateway/*.jar $GWHOME/runtime/bre/lib/\n     fi\n+  elif [[ ! -f \"${args[1]}\" ]]; then\n+      echo \"Path to executable jar file is invalid\"\n+      exit 0\n+  fi\n fi\n \n-# Set JAVA Xms and Xmx values in Ballerina runtime\n-sed -i\".back\" \"s/-Xms[0-9]*m/-Xms$JAVA_XMS_VALUE/\" $BALLERINA_HOME/bin/ballerina\n-sed -i\".back\" \"s/-Xmx[0-9]*m/-Xmx$JAVA_XMX_VALUE/\" $BALLERINA_HOME/bin/ballerina\n-rm $BALLERINA_HOME/bin/ballerina.back\n-\n-FLAG=\"false\"\n+OBSERVABILITY_FLAG=\"false\"\n CONFIG_FILE=\"$GWHOME/conf/micro-gw.conf\"\n CONFIG_OUT_FILE=\"$GWHOME/.config\"\n \n if [[ $b7a_observability_metrics_enabled == \"true\" ]]; then\n-    FLAG=\"true\"\n+    OBSERVABILITY_FLAG=\"true\"\n else\n     for c in $*\n     do\n-        if [ \"$c\" = \"--b7a.observability.enabled=true\" ] || [ \"$c\" = \"--b7a.observability.metrics.enabled=true\" ]; then \n-            FLAG=\"true\"\n-            break    \n+        if [ \"$c\" = \"--b7a.observability.enabled=true\" ] || [ \"$c\" = \"--b7a.observability.metrics.enabled=true\" ]; then\n+            OBSERVABILITY_FLAG=\"true\"\n+            break\n         fi\n-    done    \n+    done\n fi\n \n-java_cmd \"getConfig $CONFIG_FILE $CONFIG_OUT_FILE\"\n-\n-if [ -f \"$CONFIG_OUT_FILE\" ]; then\n-    if [ \"$FLAG\" != \"true\" ]; then \n-        if [ $(sed -n '1p' $CONFIG_OUT_FILE) == \"true\" ]; then\n-            FLAG=\"true\"\n-        fi\n-    fi\n-    if [ \"$FLAG\" == \"true\" ]; then\n-        jmx_port=$(sed -n '2p' $CONFIG_OUT_FILE)\n-        export JAVA_OPTS=\"-javaagent:$GWHOME/lib/gateway/jmx_prometheus_javaagent-0.12.0.jar=$jmx_port:$GWHOME/conf/Prometheus/config.yml\"\n-    fi\n-else\n-    echo \"Error while reading Observability configurations from the file\"\n+if [ ! \"$CMD\" = \"stop\" ]; then\n+java_cmd_tools \"$CONFIG_FILE $CONFIG_OUT_FILE\"\n+  if [ -f \"$CONFIG_OUT_FILE\" ]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 222}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4MzI2ODcxOnYy", "diffSide": "RIGHT", "path": "distribution/resources/bin/gateway", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODozOToxM1rOFgUDBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNjo1MDoxOVrOFh5FfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNzIwNw==", "bodyText": "Shall we check $? = 0 before saying success?", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r369427207", "createdAt": "2020-01-22T08:39:13Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -201,14 +293,13 @@ EOF\n   done\n elif [ \"$CMD\" = \"stop\" ]; then\n   export GWHOME=\"$GWHOME\"\n-  kill -term `cat \"$GWHOME\"/bin/gateway.pid`\n-  kill -9 `lsof -t $GWHOME/logs/access_logs`\n+  kill -term `cat $GWHOME/bin/gateway.pid`\n   rm -f file $GWHOME/bin/gateway.pid\n+  echo \"Microgateway has been stopped successfully\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 267}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA4MjYyMQ==", "bodyText": "fixed with 94a724d", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r371082621", "createdAt": "2020-01-27T06:50:19Z", "author": {"login": "VirajSalaka"}, "path": "distribution/resources/bin/gateway", "diffHunk": "@@ -201,14 +293,13 @@ EOF\n   done\n elif [ \"$CMD\" = \"stop\" ]; then\n   export GWHOME=\"$GWHOME\"\n-  kill -term `cat \"$GWHOME\"/bin/gateway.pid`\n-  kill -9 `lsof -t $GWHOME/logs/access_logs`\n+  kill -term `cat $GWHOME/bin/gateway.pid`\n   rm -f file $GWHOME/bin/gateway.pid\n+  echo \"Microgateway has been stopped successfully\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNzIwNw=="}, "originalCommit": {"oid": "9724977d61d59bffe0ea4592c779ea35f2d7f28a"}, "originalPosition": 267}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5Mzk1MTE4OnYy", "diffSide": "RIGHT", "path": "components/micro-gateway-cli/.factorypath", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNTozMzoyOFrOFh4QMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNTozMzoyOFrOFh4QMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA2ODk3Nw==", "bodyText": "Please remove this file", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r371068977", "createdAt": "2020-01-27T05:33:28Z", "author": {"login": "praminda"}, "path": "components/micro-gateway-cli/.factorypath", "diffHunk": "@@ -0,0 +1,230 @@\n+<factorypath>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f10fb73078b9661fc291ea975e9f6702429a2f6b"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5Mzk1MTQ3OnYy", "diffSide": "RIGHT", "path": "components/micro-gateway-core/.factorypath", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNTozMzo1MFrOFh4QYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNTozMzo1MFrOFh4QYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA2OTAyNA==", "bodyText": "Please remove this file from the PR", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r371069024", "createdAt": "2020-01-27T05:33:50Z", "author": {"login": "praminda"}, "path": "components/micro-gateway-core/.factorypath", "diffHunk": "@@ -0,0 +1,159 @@\n+<factorypath>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f10fb73078b9661fc291ea975e9f6702429a2f6b"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5Mzk1MTkyOnYy", "diffSide": "RIGHT", "path": "tests/.factorypath", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNTozNDoyMVrOFh4Qqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QwNTozNDoyMVrOFh4Qqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTA2OTA5OQ==", "bodyText": "Remove this file", "url": "https://github.com/wso2/product-microgateway/pull/944#discussion_r371069099", "createdAt": "2020-01-27T05:34:21Z", "author": {"login": "praminda"}, "path": "tests/.factorypath", "diffHunk": "@@ -0,0 +1,221 @@\n+<factorypath>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f10fb73078b9661fc291ea975e9f6702429a2f6b"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1362, "cost": 1, "resetAt": "2021-11-13T14:23:39Z"}}}