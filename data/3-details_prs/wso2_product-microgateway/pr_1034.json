{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5NTI2MTI1", "number": 1034, "title": "Revamp json schema validator", "bodyText": "Purpose\nRevamp validation filter and wrap java methods to ballerina interop\nIssues\n#1033\nFixes #\nAutomation tests\n\nUnit tests added: Yes/No\nIntegration tests added: Yes/No\n\nTested environments\n\nNot Tested\n\nMaintainers: Check before merge\n\n Assigned 'Type' label\n Assigned the project\n Validated respective github issues\n Assigned milestone to the github issue(s)", "createdAt": "2020-02-25T11:31:24Z", "url": "https://github.com/wso2/product-microgateway/pull/1034", "merged": true, "mergeCommit": {"oid": "bc603659bb676b9916e4070b410a7b349e93be68"}, "closed": true, "closedAt": "2020-03-01T08:28:56Z", "author": {"login": "hasuniea"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHJnFHgH2gAyMzc5NTI2MTI1OmVhNDVhNTc4MGVjMzNiNWZkNmQyNDVkMmVjYmMzNmRiYTllMzM4YTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcJU1joAFqTM2Njg0Mjc3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ea45a5780ec33b5fd6d245d2ecbc36dba9e338a0", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/ea45a5780ec33b5fd6d245d2ecbc36dba9e338a0", "committedDate": "2020-02-23T14:15:23Z", "message": "extract resources artifacts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bddefbaeca6b4d312c1e2abb458f3ef2171e8ab0", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/bddefbaeca6b4d312c1e2abb458f3ef2171e8ab0", "committedDate": "2020-02-23T23:53:05Z", "message": "adding validation filter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "582fc84548f7769287b29c7ef4e1c527da9c99e6", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/582fc84548f7769287b29c7ef4e1c527da9c99e6", "committedDate": "2020-02-25T04:41:07Z", "message": "adding resource folder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4f50b7a9cf35c65ce841e3b64f2041a8769fe99", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/c4f50b7a9cf35c65ce841e3b64f2041a8769fe99", "committedDate": "2020-02-25T04:43:58Z", "message": "fix merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11434a497f2188acfda0b7ef42945fa8747a54c3", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/11434a497f2188acfda0b7ef42945fa8747a54c3", "committedDate": "2020-02-25T11:08:00Z", "message": "fixing issues in validator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/19b842948040c90bfe6b9929c09d54a467f58979", "committedDate": "2020-02-25T11:28:00Z", "message": "fix code issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cabbb94979b354fee0e0a07c1d059e9ffcde8a0", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/4cabbb94979b354fee0e0a07c1d059e9ffcde8a0", "committedDate": "2020-02-26T04:14:01Z", "message": "Merge branch 'master' of https://github.com/wso2/product-microgateway into restRel"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDQwMTQ1", "url": "https://github.com/wso2/product-microgateway/pull/1034#pullrequestreview-365440145", "createdAt": "2020-02-27T06:30:51Z", "commit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjozMDo1MVrOFvGkRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjozMDo1MVrOFvGkRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNDk4Mw==", "bodyText": "Why are we not copying this", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r384934983", "createdAt": "2020-02-27T06:30:51Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-cli/src/main/java/org/wso2/apimgt/gateway/cli/cmd/BuildCmd.java", "diffHunk": "@@ -135,9 +139,16 @@ public void execute() {\n             ThrottlePolicyGenerator policyGenerator = new ThrottlePolicyGenerator();\n             policyGenerator.generate(genPoliciesPath, projectName);\n \n+            // Created resources directory\n+            String resourcesPath =\n+                    CmdUtils.getProjectTargetModulePath(projectName) + File.separator + CliConstants.RESOURCES_DIR;\n+            CmdUtils.copyFolder(CmdUtils.getAPIDefinitionPath(projectName), resourcesPath);\n+            // If resources folder contains .yaml file, replace the .yaml with .json file\n+            replaceYAMLFilesToJson(resourcesPath);\n+\n             // Copy static source files\n-            CmdUtils.copyAndReplaceFolder(CmdUtils.getProjectInterceptorsPath(projectName),\n-                    CmdUtils.getProjectTargetInterceptorsPath(projectName));\n+            //CmdUtils.copyAndReplaceFolder(CmdUtils.getProjectInterceptorsPath(projectName),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDQwNTc5", "url": "https://github.com/wso2/product-microgateway/pull/1034#pullrequestreview-365440579", "createdAt": "2020-02-27T06:32:20Z", "commit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjozMjoyMFrOFvGlmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjozMjoyMFrOFvGlmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNTMyMA==", "bodyText": "Streams are not closed properly", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r384935320", "createdAt": "2020-02-27T06:32:20Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-cli/src/main/java/org/wso2/apimgt/gateway/cli/cmd/BuildCmd.java", "diffHunk": "@@ -146,6 +157,40 @@ public void execute() {\n         }\n     }\n \n+    private String convertYamlToJson(String yaml) throws IOException {\n+        ObjectMapper yamlReader = new ObjectMapper(new YAMLFactory());\n+        Object obj = yamlReader.readValue(yaml, Object.class);\n+\n+        ObjectMapper jsonWriter = new ObjectMapper();\n+        return jsonWriter.writeValueAsString(obj);\n+    }\n+\n+    private void replaceYAMLFilesToJson(String resPath) throws IOException {\n+        String fileContent;\n+        String val = null;\n+        FileInputStream fileInputStream;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDQwNzI3", "url": "https://github.com/wso2/product-microgateway/pull/1034#pullrequestreview-365440727", "createdAt": "2020-02-27T06:32:47Z", "commit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjozMjo0OFrOFvGmAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjozMjo0OFrOFvGmAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNTQyNw==", "bodyText": "Lets remove this from the API", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r384935427", "createdAt": "2020-02-27T06:32:48Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-cli/src/main/java/org/wso2/apimgt/gateway/cli/model/rest/ext/ExtendedAPI.java", "diffHunk": "@@ -33,6 +33,8 @@\n     private String mgwApiScope = null;\n     //isGrpc\n     private boolean isGrpc = false;\n+    //projectName\n+    private  String projectName = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDQxNjYz", "url": "https://github.com/wso2/product-microgateway/pull/1034#pullrequestreview-365441663", "createdAt": "2020-02-27T06:35:22Z", "commit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjozNToyM1rOFvGpRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjozNToyM1rOFvGpRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzNjI2MA==", "bodyText": "Why is this test case commented", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r384936260", "createdAt": "2020-02-27T06:35:23Z", "author": {"login": "Rajith90"}, "path": "tests/src/test/resources/testng.xml", "diffHunk": "@@ -64,7 +64,7 @@\n             <class name=\"org.wso2.micro.gateway.tests.extensions.OASAPIInvokeTestCase\"/>\n             <!--            <class name=\"org.wso2.micro.gateway.tests.security.CookieAuthTestCase\"/>-->\n             <!--            <class name=\"org.wso2.micro.gateway.tests.validation.ValidationTestCase\"/>-->\n-            <class name=\"org.wso2.micro.gateway.tests.interceptor.InterceptorTestCase\"/>\n+<!--            <class name=\"org.wso2.micro.gateway.tests.interceptor.InterceptorTestCase\"/>-->", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NDQzNzA1", "url": "https://github.com/wso2/product-microgateway/pull/1034#pullrequestreview-365443705", "createdAt": "2020-02-27T06:41:49Z", "commit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjo0MTo0OVrOFvGwEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwNjo0MTo0OVrOFvGwEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkzODAwMw==", "bodyText": "I think we can save the open APIs at the java side", "url": "https://github.com/wso2/product-microgateway/pull/1034#discussion_r384938003", "createdAt": "2020-02-27T06:41:49Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-core/src/main/ballerina/src/gateway/utils/utils.bal", "diffHunk": "@@ -40,6 +40,8 @@ map<FilterConfiguration?> filterConfigAnnotationMap = {};\n map<http:InboundAuthHandler> authHandlersMap = {}; //all handlers except for jwt handlers\n http:InboundAuthHandler[] jwtHandlers = [];//all jwt issuer handlers\n string authHeaderFromConfig = getConfigValue(AUTH_CONF_INSTANCE_ID, AUTH_HEADER_NAME, DEFAULT_AUTH_HEADER_NAME);\n+map<string> openAPIs = {};", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "19b842948040c90bfe6b9929c09d54a467f58979"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a76b499dbfd26ea381450b66c35a01838e47c35", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/2a76b499dbfd26ea381450b66c35a01838e47c35", "committedDate": "2020-02-29T12:29:00Z", "message": "fixed issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d67438be3293d2c9506a5e492c3b6d548b11f878", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/d67438be3293d2c9506a5e492c3b6d548b11f878", "committedDate": "2020-02-29T18:27:47Z", "message": "fix merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e36d7dac48546c4c6e79530533cc087b88b5d278", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/e36d7dac48546c4c6e79530533cc087b88b5d278", "committedDate": "2020-02-29T18:39:39Z", "message": "adding tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1b76d060d92419c3a402bf05be29a6abc8cd63d", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/f1b76d060d92419c3a402bf05be29a6abc8cd63d", "committedDate": "2020-02-29T18:51:56Z", "message": "remove project property"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b37d27d344a8ff5eeaf35bc7fcbb7b8026b1eaf1", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/b37d27d344a8ff5eeaf35bc7fcbb7b8026b1eaf1", "committedDate": "2020-02-29T18:55:20Z", "message": "enable testcases"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5ddae06c1e77ac90c69b131d7a97db903ed72f5", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/d5ddae06c1e77ac90c69b131d7a97db903ed72f5", "committedDate": "2020-03-01T05:41:50Z", "message": "Merge branch 'master' of https://github.com/wso2/product-microgateway into restRel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7652806eee474e65ff89568bb109b82d2c845104", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/7652806eee474e65ff89568bb109b82d2c845104", "committedDate": "2020-03-01T06:36:38Z", "message": "add copy dependency"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec2b9f42a2802d24bf3a06f580ee87892dcab7c5", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/ec2b9f42a2802d24bf3a06f580ee87892dcab7c5", "committedDate": "2020-03-01T08:21:41Z", "message": "fix testng"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODQyNzc2", "url": "https://github.com/wso2/product-microgateway/pull/1034#pullrequestreview-366842776", "createdAt": "2020-03-01T08:28:00Z", "commit": {"oid": "ec2b9f42a2802d24bf3a06f580ee87892dcab7c5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1168, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}