{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4NTE5NzM3", "number": 1503, "title": "fix java_args not being set during the startup of gateway batch script", "bodyText": "Purpose\nAddresses the issue where the JAVA_ARGS parameter is not properly set in the batch script. (gateway.bat). The reason is that when some environmental variable is set and executed within parentheses of the if/else block, the execution command does not get the environmental parameter. Hence the setting environmental variable and being called should be separated.\nIssues\n\nFixes #1502\nAutomation tests\n\nUnit tests added:No\nIntegration tests added: No\n\nTested environments\n\nWindows 10\n\nMaintainers: Check before merge\n\n Assigned 'Type' label\n Assigned the project\n Validated respective github issues\n Assigned milestone to the github issue(s)", "createdAt": "2020-11-27T10:12:56Z", "url": "https://github.com/wso2/product-microgateway/pull/1503", "merged": true, "mergeCommit": {"oid": "534e110473fa2635b4123f6f38d6e0de01cb5ccd"}, "closed": true, "closedAt": "2021-02-22T06:57:04Z", "author": {"login": "VirajSalaka"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgkgRxgH2gAyNTI4NTE5NzM3OjFmZjFmMDY5ZDI4M2U1ZmRlZmMxZTRkMzJkNDIzMmUxODMyNDhiZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABd3CFGXgFqTU4NDAxOTkzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1ff1f069d283e5fdefc1e4d32d4232e183248bd4", "author": {"user": {"login": "VirajSalaka", "name": "Viraj Salaka"}}, "url": "https://github.com/wso2/product-microgateway/commit/1ff1f069d283e5fdefc1e4d32d4232e183248bd4", "committedDate": "2020-11-27T09:54:39Z", "message": "fix java_args not being set during the startup of gateway batch script"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5ODYxNjAx", "url": "https://github.com/wso2/product-microgateway/pull/1503#pullrequestreview-539861601", "createdAt": "2020-11-27T10:17:23Z", "commit": {"oid": "1ff1f069d283e5fdefc1e4d32d4232e183248bd4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMDoxNzoyM1rOH64ozg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMDoxNzoyM1rOH64ozg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUwNzQwNg==", "bodyText": "This will use heap dump path with single quotes. @praminda hope that would be okay?", "url": "https://github.com/wso2/product-microgateway/pull/1503#discussion_r531507406", "createdAt": "2020-11-27T10:17:23Z", "author": {"login": "VirajSalaka"}, "path": "distribution/resources/bin/gateway.bat", "diffHunk": "@@ -132,14 +132,10 @@ REM Start the gateway using internal ballerina distribution as the runtime\n     IF %ERRORLEVEL% NEQ 0 (\n         ECHO WARN: Can't find powershell in the system!\n         ECHO WARN: STDERR and STDOUT will be piped to %GW_HOME%\\logs\\microgateway.log\n-        SET JAVA_ARGS=-Xms%JAVA_XMS_VALUE% -Xmx%JAVA_XMX_VALUE% -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=\"%GW_HOME%\\heap-dump.hprof\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ff1f069d283e5fdefc1e4d32d4232e183248bd4"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5ODYxNTQ4", "url": "https://github.com/wso2/product-microgateway/pull/1503#pullrequestreview-539861548", "createdAt": "2020-11-27T10:17:20Z", "commit": {"oid": "1ff1f069d283e5fdefc1e4d32d4232e183248bd4"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMDoxNzoyMFrOH64opw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yN1QxMDoxODo1M1rOH64r7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUwNzM2Nw==", "bodyText": "How about renaming this as setupAndRun because this label setup the java args and start the gateway\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                CALL :setJavaArgs %*\n          \n          \n            \n                CALL :setupAndRun %*", "url": "https://github.com/wso2/product-microgateway/pull/1503#discussion_r531507367", "createdAt": "2020-11-27T10:17:20Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway.bat", "diffHunk": "@@ -112,7 +112,7 @@ IF EXIST %CONF_OUT_FILE% DEL /Q /F %CONF_OUT_FILE%\n     SET usage_path=%GW_HOME%\\api-usage-data\n     CALL SET USAGE_DATA_PATH=%%usage_path:\\=%separator%%%\n \n-    CALL :startGateway %*\n+    CALL :setJavaArgs %*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ff1f069d283e5fdefc1e4d32d4232e183248bd4"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUwODIwNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            :setJavaArgs\n          \n          \n            \n            :setupAndRun", "url": "https://github.com/wso2/product-microgateway/pull/1503#discussion_r531508207", "createdAt": "2020-11-27T10:18:53Z", "author": {"login": "praminda"}, "path": "distribution/resources/bin/gateway.bat", "diffHunk": "@@ -232,14 +228,15 @@ REM We need to issolate the jar file path and wrap it with quotes\n     GOTO :buildBalArgs\n \n REM add the system variable containing log4j properties file\n-:setLog4jProperties\n-    SET LOG4J_CONFIGURATION_FILE=%GW_HOME%\\conf\\log4j2.properties\n-    IF EXIST %LOG4J_CONFIGURATION_FILE% (\n-        SET JAVA_ARGS=%JAVA_ARGS% -Dlog4j.configurationFile=%LOG4J_CONFIGURATION_FILE%\n+:setJavaArgs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ff1f069d283e5fdefc1e4d32d4232e183248bd4"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b28daeffb4ba98b9ea305ab657b47059979ad40", "author": {"user": {"login": "VirajSalaka", "name": "Viraj Salaka"}}, "url": "https://github.com/wso2/product-microgateway/commit/5b28daeffb4ba98b9ea305ab657b47059979ad40", "committedDate": "2020-11-27T16:23:47Z", "message": "fix log4j2 configuration file system variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b00f6d26f01b025d8e7db8e17286b423f663059", "author": {"user": {"login": "VirajSalaka", "name": "Viraj Salaka"}}, "url": "https://github.com/wso2/product-microgateway/commit/9b00f6d26f01b025d8e7db8e17286b423f663059", "committedDate": "2020-11-27T16:24:45Z", "message": "Update distribution/resources/bin/gateway.bat\n\nCo-authored-by: Praminda <pramindabj@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "346033260a66770694bfc46aadbc06f4ace88290", "author": {"user": {"login": "VirajSalaka", "name": "Viraj Salaka"}}, "url": "https://github.com/wso2/product-microgateway/commit/346033260a66770694bfc46aadbc06f4ace88290", "committedDate": "2020-11-27T16:24:53Z", "message": "Update distribution/resources/bin/gateway.bat\n\nCo-authored-by: Praminda <pramindabj@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg0MDE5OTM1", "url": "https://github.com/wso2/product-microgateway/pull/1503#pullrequestreview-584019935", "createdAt": "2021-02-05T04:48:27Z", "commit": {"oid": "346033260a66770694bfc46aadbc06f4ace88290"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1020, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}