{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2NjkyMDkz", "number": 1129, "title": "Fixes for schema validation feature", "bodyText": "Purpose\nThis PR fixes #1125 #1081 #1080 #1033 #936\nIssues\nFixes #1125\nFixes #1081\nFixes #1080\nFixes #1033\nFixes #936\nAutomation tests\n\nUnit tests added: Yes/No\nIntegration tests added: Yes/No\n\nTested environments\n\nNot Tested\n\nMaintainers: Check before merge\n\n Assigned 'Type' label\n Assigned the project\n Validated respective github issues\n Assigned milestone to the github issue(s)", "createdAt": "2020-03-11T13:33:04Z", "url": "https://github.com/wso2/product-microgateway/pull/1129", "merged": true, "mergeCommit": {"oid": "03df376ff79c18522e2a761294f624ec9d6f2e5b"}, "closed": true, "closedAt": "2020-03-12T06:59:30Z", "author": {"login": "hasuniea"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcK9HVsgH2gAyMzg2NjkyMDkzOmY4NTQ5NDA3MjY2MjE2YWJjNGJkYmU3NjIyNzc4Mjc1OThhMmE1NmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcM2JNDAFqTM3MzMxNDU5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f8549407266216abc4bdbe762277827598a2a56f", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/f8549407266216abc4bdbe762277827598a2a56f", "committedDate": "2020-03-06T09:57:33Z", "message": "changing jar vsersions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffb87eb7753ef3be8e0ef5fb65e5de93cd4fede0", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/ffb87eb7753ef3be8e0ef5fb65e5de93cd4fede0", "committedDate": "2020-03-11T12:55:07Z", "message": "fixes#936 #1033 #1125 #1081 #1080"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96e171f6bf7f75f85cc66b56927bb7d627833fa7", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/96e171f6bf7f75f85cc66b56927bb7d627833fa7", "committedDate": "2020-03-11T13:00:36Z", "message": "fix merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79d01671532d269c4094f173b9896383e3e7897f", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/79d01671532d269c4094f173b9896383e3e7897f", "committedDate": "2020-03-11T13:25:38Z", "message": "fix formatting issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyODY1MTIx", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-372865121", "createdAt": "2020-03-11T15:24:49Z", "commit": {"oid": "79d01671532d269c4094f173b9896383e3e7897f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNToyNDo0OVrOF07_6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNToyNDo0OVrOF07_6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA1MzI5MQ==", "bodyText": "Isn't these responses used by other test cases to validate", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391053291", "createdAt": "2020-03-11T15:24:49Z", "author": {"login": "Rajith90"}, "path": "tests/src/test/java/org/wso2/micro/gateway/tests/common/ResponseConstants.java", "diffHunk": "@@ -25,16 +25,15 @@\n     public static final String responseBodyV1 = \"{\\\"id\\\":222222222, \\\"category\\\":{ \\\"id\\\":1, \\\"name\\\":\\\"Test\\\" },\" +\n             \" \\\"name\\\":\\\"doggie\\\", \\\"photoUrls\\\":[ \\\"SampleImage1.png\\\" ], \\\"tags\\\":[ { \\\"id\\\":0, \" +\n             \"\\\"name\\\":\\\"TestTag1\\\" } ], \\\"status\\\":\\\"pending\\\"}\";\n-    public static final String petByIdResponse = \"{\\\"id\\\": 9199424981609281000,\" + \"  \\\"category\\\": {\"\n-            + \"    \\\"id\\\": 0,\" + \"    \\\"name\\\": \\\"string\\\"\" + \"  },\" + \"  \\\"name\\\": \\\"doggie\\\",\"\n-            + \"  \\\"photoUrls\\\": [\" + \"    \\\"string\\\"\" + \"  ],\" + \"  \\\"tags\\\": [\" + \"    {\"\n-            + \"      \\\"id\\\": 0,\" + \"      \\\"name\\\": \\\"string\\\"\" + \"    }\" + \"  ],\"\n-            + \"  \\\"status\\\": \\\"available\\\"\" + \"}\";\n-    public static final String petByIdResponseV1 = \"{\\\"id\\\": 33333333333333,\" + \"  \\\"category\\\": {\"\n-            + \"    \\\"id\\\": 0,\" + \"    \\\"name\\\": \\\"string\\\"\" + \"  },\" + \"  \\\"name\\\": \\\"doggieNew\\\",\"\n-            + \"  \\\"photoUrls\\\": [\" + \"    \\\"string\\\"\" + \"  ],\" + \"  \\\"tags\\\": [\" + \"    {\"\n-            + \"      \\\"id\\\": 0,\" + \"      \\\"name\\\": \\\"string\\\"\" + \"    }\" + \"  ],\"\n-            + \"  \\\"status\\\": \\\"available\\\"\" + \"}\";\n+    public static final String petByIdResponse = \"{\\\"id\\\":2, \\\"category\\\":{\\\"id\\\":1, \\\"name\\\":\\\"John Doe\\\"}, \" +\n+            \"\\\"name\\\":\\\"shre\\\", \\\"photoUrls\\\":[\\\"ArrayItem1\\\"], \\\"tags\\\":[{\\\"id\\\":1, \\\"name\\\":\\\"TfNSW\\\"}],\" +\n+            \" \\\"status\\\":\\\"hello\\\"}\";\n+    public static final String petByIdResponseV1 = \"{\\\"id\\\":2, \\\"category\\\":{\\\"id\\\":1, \\\"name\\\":\\\"John Doe\\\"}, \" +\n+            \"\\\"name\\\":\\\"shre\\\", \\\"photoUrls\\\":[\\\"ArrayItem1\\\"], \\\"tags\\\":[{\\\"id\\\":1, \\\"name\\\":\\\"TfNSW\\\"}], \" +\n+            \"\\\"status\\\":\\\"hello\\\"}\";\n+    public static final String getPetResponse = \"{\\\"id\\\":2, \\\"category\\\":{\\\"id\\\":1, \\\"name\\\":\\\"John Doe\\\"},\" +\n+            \" \\\"name\\\":\\\"shre\\\", \\\"photoUrls\\\":[\\\"ArrayItem1\\\"], \\\"tags\\\":[{\\\"id\\\":1, \\\"name\\\":\\\"TfNSW\\\"}],\" +\n+            \" \\\"status\\\":\\\"hello\\\"}\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79d01671532d269c4094f173b9896383e3e7897f"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyODY1ODY5", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-372865869", "createdAt": "2020-03-11T15:25:33Z", "commit": {"oid": "79d01671532d269c4094f173b9896383e3e7897f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNToyNTozM1rOF08CGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNToyNTozM1rOF08CGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA1Mzg1MA==", "bodyText": "This test class no need to have after class. This will cause test failures", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391053850", "createdAt": "2020-03-11T15:25:33Z", "author": {"login": "Rajith90"}, "path": "tests/src/test/java/org/wso2/micro/gateway/tests/extensions/OASAPIInvokeTestCase.java", "diffHunk": "@@ -67,4 +68,9 @@ public void testApiInvokeWithJWT() throws Exception {\n         Assert.assertEquals(response.getData(), ResponseConstants.petByIdResponse);\n         Assert.assertEquals(response.getResponseCode(), 200, \"Response code mismatched\");\n     }\n+\n+    @AfterClass\n+    public void stop() throws Exception {\n+        super.finalize();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79d01671532d269c4094f173b9896383e3e7897f"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyODcwMjY4", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-372870268", "createdAt": "2020-03-11T15:29:49Z", "commit": {"oid": "79d01671532d269c4094f173b9896383e3e7897f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNToyOTo0OVrOF08PDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNToyOTo0OVrOF08PDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA1NzE2Nw==", "bodyText": "Isn't this constant have usage in https://github.com/wso2/product-microgateway/blob/master/components/micro-gateway-core/src/main/ballerina/src/gateway/filters/throttle_filter.bal#L186", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391057167", "createdAt": "2020-03-11T15:29:49Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-core/src/main/java/org/wso2/micro/gateway/core/Constants.java", "diffHunk": "@@ -58,7 +56,6 @@\n     public static final String JSON_CONTENT = \".application/json.schema.$ref\";\n     public static final String SCHEMA = \".schema\";\n     public static final String EMPTY_ARRAY = \"[]\";\n-    public static final String INTERNAL_ERROR_CODE = \"500\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79d01671532d269c4094f173b9896383e3e7897f"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/e8e4b9595f92da5f99c6959c0ac4d2847bb4e702", "committedDate": "2020-03-11T19:49:08Z", "message": "fix suggested changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjgxMTEw", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373281110", "createdAt": "2020-03-12T05:06:49Z", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNTowNjo0OVrOF1RX-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNTowNjo0OVrOF1RX-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwMzUxMw==", "bodyText": "Handle the error scenario", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391403513", "createdAt": "2020-03-12T05:06:49Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-core/src/main/ballerina/src/gateway/filters/validation_filter.bal", "diffHunk": "@@ -94,9 +94,14 @@\n         if (valResult is handle && stringutils:equalsIgnoreCase(valResult.toString(), VALIDATION_STATUS)) {\n             return true;\n         } else {\n+             json newPayload = { fault: {\n+                                    code: 400,\n+                                    message: \"Bad Request\",\n+                                    description: valResult.toString()\n+                                } };\n             http:Response res = new;\n             res.statusCode = 400;\n-            res.setPayload(valResult.toString());\n+            res.setJsonPayload(newPayload);\n             var rcal = caller->respond(res);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjgxOTU2", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373281956", "createdAt": "2020-03-12T05:10:21Z", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToxMDoyMVrOF1RauA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToxMDoyMVrOF1RauA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwNDIxNg==", "bodyText": "Lets try to use the constants if available in b7a http module", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391404216", "createdAt": "2020-03-12T05:10:21Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-core/src/main/ballerina/src/gateway/filters/validation_filter.bal", "diffHunk": "@@ -118,15 +124,22 @@\n          if (method is string) {\n             reqMethod = method;\n          }\n-         string resPayload = response.getJsonPayload().toString();\n+         var payload = response.getJsonPayload();\n+         if (payload is map<json>)  {\n+              resPayload = payload.toJsonString();\n+         }\n          string servName = context.getServiceName();\n-         printDebug(KEY_VALIDATION_FILTER, \"The Response payload : \" + resPayload);\n-         var valResult = responseValidate(resPath, requestMethod, responseCode, resPayload, servName);\n+         var valResult = responseValidate(resPath, reqMethod, responseCode, resPayload, servName);\n          if (valResult is handle && stringutils:equalsIgnoreCase(valResult.toString(), VALIDATION_STATUS)) {\n              return true;\n          } else {\n+             json newPayload = { fault: {\n+                                        code: 500,\n+                                        message: \"Bad Response\",\n+                                        description: valResult.toString()\n+                               } };\n              response.statusCode = 500;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjgyMjcw", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373282270", "createdAt": "2020-03-12T05:11:33Z", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToxMTozM1rOF1Rb0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToxMTozM1rOF1Rb0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwNDQ5OQ==", "bodyText": "Lets remove static imports", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391404499", "createdAt": "2020-03-12T05:11:33Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-core/src/main/java/org/wso2/micro/gateway/core/validation/Validate.java", "diffHunk": "@@ -44,6 +44,7 @@\n import java.util.zip.ZipEntry;\n import java.util.zip.ZipInputStream;\n \n+import static org.wso2.micro.gateway.core.Constants.EMPTY_ARRAY;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjgyOTEz", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373282913", "createdAt": "2020-03-12T05:13:59Z", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToxMzo1OVrOF1ReGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToxMzo1OVrOF1ReGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwNTA4Mw==", "bodyText": "If schema is available and payload is null then, this will gives the status as true", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391405083", "createdAt": "2020-03-12T05:13:59Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-core/src/main/java/org/wso2/micro/gateway/core/validation/Validate.java", "diffHunk": "@@ -70,7 +71,12 @@ public static String validateRequest(String requestPath, String reqMethod, Strin\n             return VALIDATED_STATUS;\n         }\n         String schema = extractSchemaFromRequest(requestPath, reqMethod, swagger);\n-        return validateContent(payload, schema);\n+        if (schema != null && !EMPTY_ARRAY.equals(schema) &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjg0MDA1", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373284005", "createdAt": "2020-03-12T05:18:29Z", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToxODoyOVrOF1Rh4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToxODoyOVrOF1Rh4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwNjA1MA==", "bodyText": "use the || in if condition", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391406050", "createdAt": "2020-03-12T05:18:29Z", "author": {"login": "Rajith90"}, "path": "components/micro-gateway-core/src/main/java/org/wso2/micro/gateway/core/validation/Validate.java", "diffHunk": "@@ -125,13 +140,13 @@ private static String extractSchemaFromRequest(String resourcePath, String reque\n         swaggerObject = swagger;\n         String value = JsonPath.read(swagger, Constants.JSON_PATH +\n                 Constants.OPEN_API).toString();\n-        if (value != null && !value.equals(Constants.EMPTY_ARRAY)) {\n+        if (value != null && !value.equals(EMPTY_ARRAY)) {\n             //refer schema\n             StringBuilder jsonPath = new StringBuilder();\n             jsonPath.append(Constants.PATHS)\n                     .append(resourcePath).append(Constants.BODY_CONTENT);\n             schema = JsonPath.read(swagger, jsonPath.toString()).toString();\n-            if (schema == null | Constants.EMPTY_ARRAY.equals(schema)) {\n+            if (schema == null | EMPTY_ARRAY.equals(schema)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "originalPosition": 75}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjg0ODI5", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373284829", "createdAt": "2020-03-12T05:21:32Z", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToyMTozMlrOF1RkWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToyMTozMlrOF1RkWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwNjY4MA==", "bodyText": "lets keep the new version", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391406680", "createdAt": "2020-03-12T05:21:32Z", "author": {"login": "Rajith90"}, "path": "pom.xml", "diffHunk": "@@ -596,15 +601,15 @@\n         <apache.commons.version>1.5.6.wso2v1</apache.commons.version>\n         <everit.version>1.5.0.wso2.v1</everit.version>\n         <jayway.jsonpath.version>2.4.0</jayway.jsonpath.version>\n-        <com.google.guava.version>27.1-jre</com.google.guava.version>\n+        <com.google.guava.version>27.0-jre</com.google.guava.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjg1MDM3", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373285037", "createdAt": "2020-03-12T05:22:20Z", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToyMjoyMFrOF1RlAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNToyMjoyMFrOF1RlAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQwNjg1MA==", "bodyText": "Lets remove the orbit", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391406850", "createdAt": "2020-03-12T05:22:20Z", "author": {"login": "Rajith90"}, "path": "pom.xml", "diffHunk": "@@ -596,15 +601,15 @@\n         <apache.commons.version>1.5.6.wso2v1</apache.commons.version>\n         <everit.version>1.5.0.wso2.v1</everit.version>\n         <jayway.jsonpath.version>2.4.0</jayway.jsonpath.version>\n-        <com.google.guava.version>27.1-jre</com.google.guava.version>\n+        <com.google.guava.version>27.0-jre</com.google.guava.version>\n         <commons-logging.version>1.1.1</commons-logging.version>\n         <commons-io.version>2.6</commons-io.version>\n         <commons-lang3.version>3.9</commons-lang3.version>\n-        <org.json.version>20160810</org.json.version>\n         <com.jayway.jsonpath.version>2.4.0.wso2v2</com.jayway.jsonpath.version>\n-        <json.orbit.version>3.0.0.wso2v1</json.orbit.version>\n-        <jackson-data-bind.version>2.9.10.1</jackson-data-bind.version>\n         <jackson-core.version>2.9.9</jackson-core.version>\n+        <everit.version>1.5.0.wso2.v1</everit.version>\n+        <fasterxml.jackson.databind.version>2.9.10</fasterxml.jackson.databind.version>\n+        <json.orbit.version>3.0.0.wso2v1</json.orbit.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjg5NTM5", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373289539", "createdAt": "2020-03-12T05:39:07Z", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNTozOTowN1rOF1RzwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNTozOTowN1rOF1RzwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQxMDYyNA==", "bodyText": "We can remove these configs since we can use the default values for this test case.", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391410624", "createdAt": "2020-03-12T05:39:07Z", "author": {"login": "AmaliMatharaarachchi"}, "path": "tests/src/test/resources/confs/validation.conf", "diffHunk": "@@ -4,32 +4,31 @@ httpsPort=9595\n tokenListenerPort=9596\n \n [b7a.users]\n-[b7a.users.generalUser1]\n-password=\"5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8\"\n-\n-[validationConfig]\n-enableRequestValidation = true\n-enableResponseValidation = true\n+  [b7a.users.generalUser1]\n+    password=\"5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8\"\n \n [apikey.tokenConfigs]\n-issuer=\"https://localhost:9095/apikey\"\n-audience=\"http://org.wso2.apimgt/gateway\"\n-certificateAlias=\"ballerina\"\n-validateAllowedAPIs=true\n+  issuer=\"https://localhost:9095/apikey\"\n+  audience=\"http://org.wso2.apimgt/gateway\"\n+  certificateAlias=\"ballerina\"\n+  validateAllowedAPIs=true\n \n [apikey.issuer]\n-[apikey.issuer.tokenConfig]\n-enabled=true\n-keyStorePath=\"${ballerina.home}/bre/security/ballerinaKeystore.p12\"\n-keyStorePassword=\"ballerina\"\n-issuer=\"https://localhost:9095/apikey\"\n-audience=\"http://org.wso2.apimgt/gateway\"\n-certificateAlias=\"ballerina\"\n-validityTime=600\n-[apikey.issuer.apis]\n-[apikey.issuer.apis.1]\n-name=\"PetStoreAPI\"\n-versions=\"1.0.0\"\n+  [apikey.issuer.tokenConfig]\n+   enabled=true\n+   keyStorePath=\"${ballerina.home}/bre/security/ballerinaKeystore.p12\"\n+   keyStorePassword=\"ballerina\"\n+   issuer=\"https://localhost:9095/apikey\"\n+   audience=\"http://org.wso2.apimgt/gateway\"\n+   certificateAlias=\"ballerina\"\n+   validityTime=600\n+[[apikey.issuer.api]]\n+   name=\"PetStoreAPI\"\n+   versions=\"1.0.0\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMjg5Njg5", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373289689", "createdAt": "2020-03-12T05:39:40Z", "commit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNTozOTo0MFrOF1R0Lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQwNTozOTo0MFrOF1R0Lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQxMDczNQ==", "bodyText": "Let's remove these configs since we can use the default values for this test case", "url": "https://github.com/wso2/product-microgateway/pull/1129#discussion_r391410735", "createdAt": "2020-03-12T05:39:40Z", "author": {"login": "AmaliMatharaarachchi"}, "path": "tests/src/test/resources/confs/validation.conf", "diffHunk": "@@ -4,32 +4,31 @@ httpsPort=9595\n tokenListenerPort=9596\n \n [b7a.users]\n-[b7a.users.generalUser1]\n-password=\"5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8\"\n-\n-[validationConfig]\n-enableRequestValidation = true\n-enableResponseValidation = true\n+  [b7a.users.generalUser1]\n+    password=\"5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8\"\n \n [apikey.tokenConfigs]\n-issuer=\"https://localhost:9095/apikey\"\n-audience=\"http://org.wso2.apimgt/gateway\"\n-certificateAlias=\"ballerina\"\n-validateAllowedAPIs=true\n+  issuer=\"https://localhost:9095/apikey\"\n+  audience=\"http://org.wso2.apimgt/gateway\"\n+  certificateAlias=\"ballerina\"\n+  validateAllowedAPIs=true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8e4b9595f92da5f99c6959c0ac4d2847bb4e702"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0efe80a5ce404ae9feb28383a5273fdbf54831c3", "author": {"user": {"login": "hasuniea", "name": "Hasunie"}}, "url": "https://github.com/wso2/product-microgateway/commit/0efe80a5ce404ae9feb28383a5273fdbf54831c3", "committedDate": "2020-03-12T06:45:31Z", "message": "fixed suggested changes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczMzE0NTkx", "url": "https://github.com/wso2/product-microgateway/pull/1129#pullrequestreview-373314591", "createdAt": "2020-03-12T06:58:06Z", "commit": {"oid": "0efe80a5ce404ae9feb28383a5273fdbf54831c3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1208, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}