{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcyMjY2MTcx", "number": 974, "title": "x-wso2-owner extension addition", "bodyText": "Purpose\n\nTo publish analytics data similar to APIM API invokes. Before adding this extension there were some mismatches in the APIM Analytics dashboard values (API version usage, total API usage etc).\n\nDisplays analytics data correctly in APIM Analytics dashboard tables\nUpdates API usage pie chart correctly\n\nAlso adds new wso2 carbon certificate under the name apim300.\nIssues\n\nFixes #937\n\nTotal API invokes for APIM and Microgateway not updated properly in the API usage pie chart (Microgateway API invokes not included in the total count).\nAlso API invoke count listed as \"unknown\" field value under a separate row. (For imported APIs from APIM)\n\nAutomation tests\n\nUnit tests added: No\nIntegration tests added: No\n\nTested environments\n\n\nUbuntu 18.04.3 LTS\nBallerina Version (1.1.0)\nJava open JDK version \"11.0.5\"\nwso2am-analytics-3.1.0-alpha\nwso2am-3.1.0-alpha\n\n\nMaintainers: Check before merge\n\n Assigned 'Type' label\n Assigned the project\n Validated respective github issues\n Assigned milestone to the github issue(s)", "createdAt": "2020-02-07T07:07:37Z", "url": "https://github.com/wso2/product-microgateway/pull/974", "merged": true, "mergeCommit": {"oid": "ac905e15b21ca470a7033e4e009c947e5b467c2b"}, "closed": true, "closedAt": "2020-02-07T08:29:57Z", "author": {"login": "slahirucd7"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb-_XpggH2gAyMzcyMjY2MTcxOmM2MjA5ZGExMzRiMGE2OTkwMWU4ZTU2MTA3YzA0M2E1Zjk4MWJlMmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcB7CZ_AFqTM1NDk5Mzc4Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c6209da134b0a69901e8e56107c043a5f981be2e", "author": {"user": {"login": "slahirucd7", "name": "SLahiruC"}}, "url": "https://github.com/wso2/product-microgateway/commit/c6209da134b0a69901e8e56107c043a5f981be2e", "committedDate": "2020-01-29T05:48:05Z", "message": "Add x-wso2-owner extension\n\nTo support API provider details coming from the APIM when and\nAPI is imported. This information is required by analytics to\ncorrectly populate the event data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6b56b6baf122ddfbb05d896e2dc510a17d5e82a", "author": {"user": {"login": "slahirucd7", "name": "SLahiruC"}}, "url": "https://github.com/wso2/product-microgateway/commit/d6b56b6baf122ddfbb05d896e2dc510a17d5e82a", "committedDate": "2020-01-29T05:48:51Z", "message": "Update truststores with new APIM certs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2de8ae78b1d3e16493466271572fc9772c9d249", "author": {"user": {"login": "slahirucd7", "name": "SLahiruC"}}, "url": "https://github.com/wso2/product-microgateway/commit/a2de8ae78b1d3e16493466271572fc9772c9d249", "committedDate": "2020-01-29T05:49:41Z", "message": "Update gitignore for vscode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a01841421eda5fa5f7a6e350ac9ea9fe2ba4efa9", "author": {"user": {"login": "slahirucd7", "name": "SLahiruC"}}, "url": "https://github.com/wso2/product-microgateway/commit/a01841421eda5fa5f7a6e350ac9ea9fe2ba4efa9", "committedDate": "2020-01-29T09:28:10Z", "message": "fix for api creator and userTenantDomain if x-wso2-owner not specified."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c24e659192b1c367e1725b10b723b8393c3ff7f9", "author": {"user": {"login": "slahirucd7", "name": "SLahiruC"}}, "url": "https://github.com/wso2/product-microgateway/commit/c24e659192b1c367e1725b10b723b8393c3ff7f9", "committedDate": "2020-02-07T07:01:15Z", "message": "userTenantDomain converted to previous implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e7fcd188eb76a74862498e3af1150167a072f48", "author": {"user": {"login": "slahirucd7", "name": "SLahiruC"}}, "url": "https://github.com/wso2/product-microgateway/commit/0e7fcd188eb76a74862498e3af1150167a072f48", "committedDate": "2020-02-07T07:01:36Z", "message": "Apply suggestions from code review\r\n\r\nimplemented review suggestions for responsetime_util.bal  & MockAPIPublisher.java\n\nCo-Authored-By: Praminda <pramindabj@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d6d18fea1e53ee23f9ef8950fad6a8ac3b51ae8", "author": {"user": {"login": "slahirucd7", "name": "SLahiruC"}}, "url": "https://github.com/wso2/product-microgateway/commit/4d6d18fea1e53ee23f9ef8950fad6a8ac3b51ae8", "committedDate": "2020-02-07T07:01:51Z", "message": "api creator changes in responsetime_util.bal file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1", "author": {"user": {"login": "slahirucd7", "name": "SLahiruC"}}, "url": "https://github.com/wso2/product-microgateway/commit/94dfa64ffbdc1deda81eb11f62824b3dd2201ad1", "committedDate": "2020-02-07T07:02:11Z", "message": "Merge branch 'master' of https://github.com/wso2/product-microgateway into extension"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0OTg1MjQx", "url": "https://github.com/wso2/product-microgateway/pull/974#pullrequestreview-354985241", "createdAt": "2020-02-07T08:08:06Z", "commit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0OTg1ODE5", "url": "https://github.com/wso2/product-microgateway/pull/974#pullrequestreview-354985819", "createdAt": "2020-02-07T08:09:31Z", "commit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODowOTozMVrOFm1C5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODowOTozMVrOFm1C5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjI1OTMwMQ==", "bodyText": "120 character length exceeds.", "url": "https://github.com/wso2/product-microgateway/pull/974#discussion_r376259301", "createdAt": "2020-02-07T08:09:31Z", "author": {"login": "AmaliMatharaarachchi"}, "path": "components/micro-gateway-core/src/main/ballerina/src/gateway/analytics/responsetime_util.bal", "diffHunk": "@@ -99,8 +98,10 @@ public function generateRequestResponseExecutionDataEvent(http:Response response\n     }\n     APIConfiguration? apiConfiguration = apiConfigAnnotationMap[context.getServiceName()];\n     if (apiConfiguration is APIConfiguration) {\n-        if (!stringutils:equalsIgnoreCase(\"\", <string>apiConfiguration.publisher)) {\n+        if (!stringutils:equalsIgnoreCase(\"\", <string>apiConfiguration.publisher) && stringutils:equalsIgnoreCase(\"\", <string>requestResponseExecutionDTO.apiCreator)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0OTg2MTYx", "url": "https://github.com/wso2/product-microgateway/pull/974#pullrequestreview-354986161", "createdAt": "2020-02-07T08:10:21Z", "commit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODoxMDoyMVrOFm1D5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODoxMDoyMVrOFm1D5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjI1OTU1OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (openAPI.getExtensions().get(OpenAPIConstants.API_OWNER) != null) {\n          \n          \n            \n                    if (openAPI.getExtensions().containsKey(OpenAPIConstants.API_OWNER)) {", "url": "https://github.com/wso2/product-microgateway/pull/974#discussion_r376259558", "createdAt": "2020-02-07T08:10:21Z", "author": {"login": "AmaliMatharaarachchi"}, "path": "components/micro-gateway-cli/src/main/java/org/wso2/apimgt/gateway/cli/utils/OpenAPICodegenUtils.java", "diffHunk": "@@ -289,6 +300,10 @@ public static void setAdditionalConfigsDevFirst(ExtendedAPI api, OpenAPI openAPI\n \n         setMgwAPISecurityAndScopes(api, openAPI);\n         api.setSpecificBasepath(openAPI.getExtensions().get(OpenAPIConstants.BASEPATH).toString());\n+        //assigns x-wso2-owner value to API provider\n+        if (openAPI.getExtensions().get(OpenAPIConstants.API_OWNER) != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0OTg3OTMw", "url": "https://github.com/wso2/product-microgateway/pull/974#pullrequestreview-354987930", "createdAt": "2020-02-07T08:14:34Z", "commit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODoxNDozNFrOFm1JhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODoxNDozNFrOFm1JhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjI2MDk5Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (!stringutils:equalsIgnoreCase(\"\", <string>apiConfiguration.publisher) && stringutils:equalsIgnoreCase(\"\", <string>requestResponseExecutionDTO.apiCreator)) {\n          \n          \n            \n                    if (!stringutils:equalsIgnoreCase(\"\", <string>apiConfiguration.publisher) \n          \n          \n            \n                        && stringutils:equalsIgnoreCase(\"\", <string>requestResponseExecutionDTO.apiCreator)) {", "url": "https://github.com/wso2/product-microgateway/pull/974#discussion_r376260996", "createdAt": "2020-02-07T08:14:34Z", "author": {"login": "praminda"}, "path": "components/micro-gateway-core/src/main/ballerina/src/gateway/analytics/responsetime_util.bal", "diffHunk": "@@ -99,8 +98,10 @@ public function generateRequestResponseExecutionDataEvent(http:Response response\n     }\n     APIConfiguration? apiConfiguration = apiConfigAnnotationMap[context.getServiceName()];\n     if (apiConfiguration is APIConfiguration) {\n-        if (!stringutils:equalsIgnoreCase(\"\", <string>apiConfiguration.publisher)) {\n+        if (!stringutils:equalsIgnoreCase(\"\", <string>apiConfiguration.publisher) && stringutils:equalsIgnoreCase(\"\", <string>requestResponseExecutionDTO.apiCreator)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9d021c6be2c9ecde12067d7cdb894f3558b9743", "author": {"user": {"login": "slahirucd7", "name": "SLahiruC"}}, "url": "https://github.com/wso2/product-microgateway/commit/c9d021c6be2c9ecde12067d7cdb894f3558b9743", "committedDate": "2020-02-07T08:21:53Z", "message": "Apply suggestions from code review\r\n\r\nApplied changes for ApiCodegenUtils.java and responsetime_util.bal files.\n\nCo-Authored-By: Amali Matharaarachchi <amalim@wso2.com>\nCo-Authored-By: Praminda <pramindabj@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0OTkyMjIz", "url": "https://github.com/wso2/product-microgateway/pull/974#pullrequestreview-354992223", "createdAt": "2020-02-07T08:23:31Z", "commit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODoyMzozMVrOFm1XEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QwODoyMzozMVrOFm1XEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjI2NDQ2Ng==", "bodyText": "duplicated code in populateThrottleAnalyticsDTO and populateFaultAnalyticsDTO. I think you can use a common method for them.", "url": "https://github.com/wso2/product-microgateway/pull/974#discussion_r376264466", "createdAt": "2020-02-07T08:23:31Z", "author": {"login": "AmaliMatharaarachchi"}, "path": "components/micro-gateway-core/src/main/ballerina/src/gateway/utils/analytics_util.bal", "diffHunk": "@@ -35,7 +36,13 @@ function populateThrottleAnalyticsDTO(http:FilterContext context) returns (Throt\n     APIConfiguration? apiConfiguration = apiConfigAnnotationMap[context.getServiceName()];\n     if (apiConfiguration is APIConfiguration) {\n         eventDto.apiVersion = apiConfiguration.apiVersion;\n-    }\n+        if (!stringutils:equalsIgnoreCase(\"\", <string>apiConfiguration.publisher)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "94dfa64ffbdc1deda81eb11f62824b3dd2201ad1"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0OTkzNzg2", "url": "https://github.com/wso2/product-microgateway/pull/974#pullrequestreview-354993786", "createdAt": "2020-02-07T08:27:02Z", "commit": {"oid": "c9d021c6be2c9ecde12067d7cdb894f3558b9743"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1145, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}