{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIwMzk4Njg5", "number": 3466, "title": "Added Bigtable emulator container support", "bodyText": "/cc @eddumelendez", "createdAt": "2020-11-13T07:12:28Z", "url": "https://github.com/testcontainers/testcontainers-java/pull/3466", "merged": true, "mergeCommit": {"oid": "f76970f570fd1f1dcd0a6087162de8a3e7733d29"}, "closed": true, "closedAt": "2020-12-10T10:59:22Z", "author": {"login": "saturnism"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcBx_CgH2gAyNTIwMzk4Njg5OjA0N2U2NmYyNjI5YjgzMDEwZDZiNjFlMDRlZTk3NTcxZWU4ODEzZTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdkxNwcgFqTU0OTA4MDMxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "047e66f2629b83010d6b61e04ee97571ee8813e3", "author": {"user": {"login": "saturnism", "name": "Ray Tsang"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/047e66f2629b83010d6b61e04ee97571ee8813e3", "committedDate": "2020-11-13T07:11:37Z", "message": "Added Bigtable emulator container support"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f1564b217ae77955dd41f68d55032a2f09c4584", "author": {"user": {"login": "saturnism", "name": "Ray Tsang"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/9f1564b217ae77955dd41f68d55032a2f09c4584", "committedDate": "2020-11-13T07:13:15Z", "message": "changed port to be consistent w/ other emulators"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNTc0NjI2", "url": "https://github.com/testcontainers/testcontainers-java/pull/3466#pullrequestreview-542574626", "createdAt": "2020-12-02T07:57:50Z", "commit": {"oid": "9f1564b217ae77955dd41f68d55032a2f09c4584"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzo1Nzo1MFrOH9OdoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzo1Nzo1MFrOH9OdoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk2MjE0NA==", "bodyText": "given that we have getHost() now, do you think we still need this one?", "url": "https://github.com/testcontainers/testcontainers-java/pull/3466#discussion_r533962144", "createdAt": "2020-12-02T07:57:50Z", "author": {"login": "bsideup"}, "path": "modules/gcloud/src/main/java/org/testcontainers/containers/BigtableEmulatorContainer.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.testcontainers.containers;\n+\n+import org.testcontainers.containers.wait.strategy.LogMessageWaitStrategy;\n+import org.testcontainers.utility.DockerImageName;\n+\n+/**\n+ * A Bigtable container that relies in google cloud sdk.\n+ *\n+ * Default port is 9000.\n+ *\n+ * @author Edd\u00fa Mel\u00e9ndez\n+ * @author Ray Tsang\n+ */\n+public class BigtableEmulatorContainer extends GenericContainer<BigtableEmulatorContainer> {\n+\n+    private static final DockerImageName DEFAULT_IMAGE_NAME = DockerImageName.parse(\"gcr.io/google.com/cloudsdktool/cloud-sdk\");\n+\n+    private static final String CMD = \"gcloud beta emulators bigtable start --host-port 0.0.0.0:9000\";\n+    private static final int PORT = 9000;\n+\n+    public BigtableEmulatorContainer(final DockerImageName dockerImageName) {\n+        super(dockerImageName);\n+\n+        dockerImageName.assertCompatibleWith(DEFAULT_IMAGE_NAME);\n+\n+        withExposedPorts(PORT);\n+        setWaitStrategy(new LogMessageWaitStrategy()\n+                .withRegEx(\"(?s).*running.*$\"));\n+        withCommand(\"/bin/sh\", \"-c\", CMD);\n+    }\n+\n+    /**\n+     * @return a <code>host:port</code> pair corresponding to the address on which the emulator is\n+     * reachable from the test host machine. Directly usable as a parameter to the\n+     * com.google.cloud.ServiceOptions.Builder#setHost(java.lang.String) method.\n+     */\n+    public String getEmulatorEndpoint() {\n+        return getContainerIpAddress() + \":\" + getMappedPort(PORT);\n+    }\n+\n+    public String getEmulatorHost() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f1564b217ae77955dd41f68d55032a2f09c4584"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNTc0Njk5", "url": "https://github.com/testcontainers/testcontainers-java/pull/3466#pullrequestreview-542574699", "createdAt": "2020-12-02T07:57:58Z", "commit": {"oid": "9f1564b217ae77955dd41f68d55032a2f09c4584"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzo1Nzo1OFrOH9Od4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzo1Nzo1OFrOH9Od4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk2MjIwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return getContainerIpAddress() + \":\" + getMappedPort(PORT);\n          \n          \n            \n                    return getHost() + \":\" + getEmulatorPort();", "url": "https://github.com/testcontainers/testcontainers-java/pull/3466#discussion_r533962208", "createdAt": "2020-12-02T07:57:58Z", "author": {"login": "bsideup"}, "path": "modules/gcloud/src/main/java/org/testcontainers/containers/BigtableEmulatorContainer.java", "diffHunk": "@@ -0,0 +1,48 @@\n+package org.testcontainers.containers;\n+\n+import org.testcontainers.containers.wait.strategy.LogMessageWaitStrategy;\n+import org.testcontainers.utility.DockerImageName;\n+\n+/**\n+ * A Bigtable container that relies in google cloud sdk.\n+ *\n+ * Default port is 9000.\n+ *\n+ * @author Edd\u00fa Mel\u00e9ndez\n+ * @author Ray Tsang\n+ */\n+public class BigtableEmulatorContainer extends GenericContainer<BigtableEmulatorContainer> {\n+\n+    private static final DockerImageName DEFAULT_IMAGE_NAME = DockerImageName.parse(\"gcr.io/google.com/cloudsdktool/cloud-sdk\");\n+\n+    private static final String CMD = \"gcloud beta emulators bigtable start --host-port 0.0.0.0:9000\";\n+    private static final int PORT = 9000;\n+\n+    public BigtableEmulatorContainer(final DockerImageName dockerImageName) {\n+        super(dockerImageName);\n+\n+        dockerImageName.assertCompatibleWith(DEFAULT_IMAGE_NAME);\n+\n+        withExposedPorts(PORT);\n+        setWaitStrategy(new LogMessageWaitStrategy()\n+                .withRegEx(\"(?s).*running.*$\"));\n+        withCommand(\"/bin/sh\", \"-c\", CMD);\n+    }\n+\n+    /**\n+     * @return a <code>host:port</code> pair corresponding to the address on which the emulator is\n+     * reachable from the test host machine. Directly usable as a parameter to the\n+     * com.google.cloud.ServiceOptions.Builder#setHost(java.lang.String) method.\n+     */\n+    public String getEmulatorEndpoint() {\n+        return getContainerIpAddress() + \":\" + getMappedPort(PORT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9f1564b217ae77955dd41f68d55032a2f09c4584"}, "originalPosition": 38}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f667c73b114b962bf5baa7e442a33b4b13301824", "author": {"user": {"login": "saturnism", "name": "Ray Tsang"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/f667c73b114b962bf5baa7e442a33b4b13301824", "committedDate": "2020-12-02T08:18:53Z", "message": "Update modules/gcloud/src/main/java/org/testcontainers/containers/BigtableEmulatorContainer.java\n\nCo-authored-by: Sergei Egorov <bsideup@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6345cc669fcc16cb2d9484e554ccc72584e3585b", "author": {"user": {"login": "saturnism", "name": "Ray Tsang"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/6345cc669fcc16cb2d9484e554ccc72584e3585b", "committedDate": "2020-12-02T08:21:07Z", "message": "Merge remote-tracking branch 'upstream/master' into gcloud-bigtable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb8b58a4a78e8570448b78817720eae62ef02ad1", "author": {"user": {"login": "saturnism", "name": "Ray Tsang"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/eb8b58a4a78e8570448b78817720eae62ef02ad1", "committedDate": "2020-12-02T08:38:06Z", "message": "Removed `getEmulatorHost`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e34eacd4954848f91f8a4c705f443c867042af77", "author": {"user": {"login": "saturnism", "name": "Ray Tsang"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/e34eacd4954848f91f8a4c705f443c867042af77", "committedDate": "2020-12-03T03:18:19Z", "message": "Merge branch 'gcloud-bigtable' of github.com:saturnism/testcontainers-java into gcloud-bigtable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MDgwMzE0", "url": "https://github.com/testcontainers/testcontainers-java/pull/3466#pullrequestreview-549080314", "createdAt": "2020-12-10T10:58:53Z", "commit": {"oid": "e34eacd4954848f91f8a4c705f443c867042af77"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3310, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}