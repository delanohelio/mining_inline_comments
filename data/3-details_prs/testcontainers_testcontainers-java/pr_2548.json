{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxOTAxNzkx", "number": 2548, "title": "VNC recording with BrowserWebdriverContainer in Spock-Extension", "bodyText": "Revives #726.\nInitially done as part of the Hackergarten at Gr8ConfEU 2018 (yes, that long ago \ud83d\ude05).\nThanks to Tamer Shahin, Marcin Erdmann and Dawid Kublik for working on this \ud83d\ude42  !\nFixes #631.", "createdAt": "2020-04-10T13:07:23Z", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548", "merged": true, "mergeCommit": {"oid": "631a3f46971156e65f3f9843624acd4188768b71"}, "closed": true, "closedAt": "2020-04-12T18:08:19Z", "author": {"login": "kiview"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWPURWAH2gAyNDAxOTAxNzkxOjhkZGUwNGEwMDUyMzk4NWNjMzA4Y2UyM2M3YzI4ZmE4NGJjNmVjN2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcW-LN9gH2gAyNDAxOTAxNzkxOmMxNjEzODI1YTcxMTc4ZjZkYmM5ZTk3NmFiNDMzZDFlMmI2Yjk3ZTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8dde04a00523985cc308ce23c7c28fa84bc6ec7d", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/8dde04a00523985cc308ce23c7c28fa84bc6ec7d", "committedDate": "2020-04-10T11:23:08Z", "message": "WIP for VNC recording with BrowserWebdriverContainer in Spock-Extension"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43a514861bd9e38b9077691d845bc01da8a052af", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/43a514861bd9e38b9077691d845bc01da8a052af", "committedDate": "2020-04-10T13:04:43Z", "message": "Update to current interfaces and module structure"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c662c37a04739d77fa6f3abdc6b6ae297860a5b9", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/c662c37a04739d77fa6f3abdc6b6ae297860a5b9", "committedDate": "2020-04-10T13:40:59Z", "message": "Use TestLifecycleAware interface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98d947ef5a54ec9061cc8d638524cfbb747a3ee9", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/98d947ef5a54ec9061cc8d638524cfbb747a3ee9", "committedDate": "2020-04-10T14:28:14Z", "message": "Use TestLifecycleAware methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/1a995de63aa6f17230f7c07809de1432fa8c77b7", "committedDate": "2020-04-10T15:28:14Z", "message": "Use correct filenames for TestDescription"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzU2MTI0", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#pullrequestreview-391756124", "createdAt": "2020-04-11T10:46:32Z", "commit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo0NjozM1rOGEMRBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo0NjozM1rOGEMRBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA0ODQ1Mg==", "bodyText": "AFAIK specName can be an arbitrary string. Perhaps we should encode it (similar to #1326)", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#discussion_r407048452", "createdAt": "2020-04-11T10:46:33Z", "author": {"login": "bsideup"}, "path": "modules/spock/src/main/groovy/org/testcontainers/spock/SpockTestDescription.groovy", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.testcontainers.spock\n+\n+import groovy.transform.PackageScope\n+import org.spockframework.runtime.extension.IMethodInvocation\n+import org.testcontainers.lifecycle.TestDescription\n+\n+/**\n+ * Spock specific implementation of a Testcontainers TestDescription.\n+ *\n+ * Filesystem friendly name is based on Specification and Feature.\n+ */\n+@PackageScope\n+class SpockTestDescription implements TestDescription {\n+\n+    String specName\n+    String featureName\n+\n+    static SpockTestDescription fromTestDescription(IMethodInvocation invocation) {\n+        return new SpockTestDescription([\n+            specName: invocation.spec.name,\n+            featureName: invocation.feature.name\n+        ])\n+    }\n+\n+    @Override\n+    String getTestId() {\n+        return null\n+    }\n+\n+    @Override\n+    String getFilesystemFriendlyName() {\n+        return [specName, featureName].collect {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzU2MTI3", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#pullrequestreview-391756127", "createdAt": "2020-04-11T10:46:36Z", "commit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo0NjozNlrOGEMRBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo0NjozNlrOGEMRBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA0ODQ1Mw==", "bodyText": "huh?", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#discussion_r407048453", "createdAt": "2020-04-11T10:46:36Z", "author": {"login": "bsideup"}, "path": "modules/spock/src/main/groovy/org/testcontainers/spock/SpockTestDescription.groovy", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.testcontainers.spock\n+\n+import groovy.transform.PackageScope\n+import org.spockframework.runtime.extension.IMethodInvocation\n+import org.testcontainers.lifecycle.TestDescription\n+\n+/**\n+ * Spock specific implementation of a Testcontainers TestDescription.\n+ *\n+ * Filesystem friendly name is based on Specification and Feature.\n+ */\n+@PackageScope\n+class SpockTestDescription implements TestDescription {\n+\n+    String specName\n+    String featureName\n+\n+    static SpockTestDescription fromTestDescription(IMethodInvocation invocation) {\n+        return new SpockTestDescription([\n+            specName: invocation.spec.name,\n+            featureName: invocation.feature.name\n+        ])\n+    }\n+\n+    @Override\n+    String getTestId() {\n+        return null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzU2MTUy", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#pullrequestreview-391756152", "createdAt": "2020-04-11T10:47:13Z", "commit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo0NzoxM1rOGEMRNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo0NzoxM1rOGEMRNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA0ODUwMg==", "bodyText": "private?", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#discussion_r407048502", "createdAt": "2020-04-11T10:47:13Z", "author": {"login": "bsideup"}, "path": "modules/spock/src/main/groovy/org/testcontainers/spock/TestcontainersExtension.groovy", "diffHunk": "@@ -1,17 +1,32 @@\n package org.testcontainers.spock\n \n+import org.spockframework.runtime.AbstractRunListener\n import org.spockframework.runtime.extension.AbstractAnnotationDrivenExtension\n+import org.spockframework.runtime.model.ErrorInfo\n import org.spockframework.runtime.model.SpecInfo\n \n class TestcontainersExtension extends AbstractAnnotationDrivenExtension<Testcontainers> {\n \n     @Override\n     void visitSpecAnnotation(Testcontainers annotation, SpecInfo spec) {\n-        def interceptor = new TestcontainersMethodInterceptor(spec)\n+        def listener = new ErrorListener()\n+        def interceptor = new TestcontainersMethodInterceptor(spec, listener)\n         spec.addSetupSpecInterceptor(interceptor)\n         spec.addCleanupSpecInterceptor(interceptor)\n         spec.addSetupInterceptor(interceptor)\n         spec.addCleanupInterceptor(interceptor)\n+\n+        spec.addListener(listener)\n+\n+    }\n+\n+    class ErrorListener extends AbstractRunListener {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzU2MTg5", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#pullrequestreview-391756189", "createdAt": "2020-04-11T10:47:50Z", "commit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo0Nzo1MFrOGEMRbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo0Nzo1MFrOGEMRbg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA0ODU1OA==", "bodyText": "TIL! Cool :)", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#discussion_r407048558", "createdAt": "2020-04-11T10:47:50Z", "author": {"login": "bsideup"}, "path": "modules/spock/src/test/groovy/org/testcontainers/spock/BrowserVncRecordingIT.groovy", "diffHunk": "@@ -0,0 +1,176 @@\n+package org.testcontainers.spock\n+\n+import org.intellij.lang.annotations.Language\n+import org.junit.Rule\n+import org.junit.rules.TemporaryFolder\n+import spock.lang.Specification\n+import spock.util.EmbeddedSpecRunner\n+\n+class BrowserVncRecordingIT extends Specification {\n+\n+    @Rule\n+    TemporaryFolder temp\n+\n+    String recordingDir\n+\n+    def setup() {\n+        recordingDir = temp.getRoot().getAbsolutePath()\n+    }\n+\n+    def \"retains all recordings for RECORD_ALL if successful\"() {\n+        given:\n+\n+        //noinspection GrPackage\n+        @Language(\"groovy\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNzU2NDIy", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#pullrequestreview-391756422", "createdAt": "2020-04-11T10:51:09Z", "commit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo1MTowOVrOGEMSvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMVQxMDo1MTowOVrOGEMSvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzA0ODg5Mg==", "bodyText": "FYI invocation.feature is marked as @Nullable", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#discussion_r407048892", "createdAt": "2020-04-11T10:51:09Z", "author": {"login": "bsideup"}, "path": "modules/spock/src/main/groovy/org/testcontainers/spock/SpockTestDescription.groovy", "diffHunk": "@@ -0,0 +1,36 @@\n+package org.testcontainers.spock\n+\n+import groovy.transform.PackageScope\n+import org.spockframework.runtime.extension.IMethodInvocation\n+import org.testcontainers.lifecycle.TestDescription\n+\n+/**\n+ * Spock specific implementation of a Testcontainers TestDescription.\n+ *\n+ * Filesystem friendly name is based on Specification and Feature.\n+ */\n+@PackageScope\n+class SpockTestDescription implements TestDescription {\n+\n+    String specName\n+    String featureName\n+\n+    static SpockTestDescription fromTestDescription(IMethodInvocation invocation) {\n+        return new SpockTestDescription([\n+            specName: invocation.spec.name,\n+            featureName: invocation.feature.name", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a995de63aa6f17230f7c07809de1432fa8c77b7"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "385a3a5ac6b9e1254ccb0b316b1a7b65d01d3976", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/385a3a5ac6b9e1254ccb0b316b1a7b65d01d3976", "committedDate": "2020-04-11T14:42:49Z", "message": "URL encode spec and feature name, private ErrorListener"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "068452c30705e686c7ae7815d8fd6f413a088ba8", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/068452c30705e686c7ae7815d8fd6f413a088ba8", "committedDate": "2020-04-11T14:49:24Z", "message": "Merge branch 'master' into spock-vnc-recording"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3bd659091d781d0d51d0841fcefc20d26cfd6ef", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/f3bd659091d781d0d51d0841fcefc20d26cfd6ef", "committedDate": "2020-04-12T08:59:14Z", "message": "Merge branch 'master' into spock-vnc-recording"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd34121f44c8b37e9e8664f8c9c4336165d04143", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/fd34121f44c8b37e9e8664f8c9c4336165d04143", "committedDate": "2020-04-12T11:34:02Z", "message": "Merge branch 'master' into spock-vnc-recording"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODQ5MTMz", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#pullrequestreview-391849133", "createdAt": "2020-04-12T11:50:12Z", "commit": {"oid": "fd34121f44c8b37e9e8664f8c9c4336165d04143"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxMTo1MDoxMlrOGEUuyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxMTo1MDoxMlrOGEUuyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE4NzE0NQ==", "bodyText": "would be cool to parameterize these 3 tests into something like:\n| mode | fails | files |\n| RECORD_ALL | false | BrowserWebdriverContainerIT-should+record |\n| RECORD_FAILING | false | |\n| RECORD_FAILING | true | BrowserWebdriverContainerIT-should+record |", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#discussion_r407187145", "createdAt": "2020-04-12T11:50:12Z", "author": {"login": "bsideup"}, "path": "modules/spock/src/test/groovy/org/testcontainers/spock/BrowserVncRecordingIT.groovy", "diffHunk": "@@ -0,0 +1,176 @@\n+package org.testcontainers.spock\n+\n+import org.intellij.lang.annotations.Language\n+import org.junit.Rule\n+import org.junit.rules.TemporaryFolder\n+import spock.lang.Specification\n+import spock.util.EmbeddedSpecRunner\n+\n+class BrowserVncRecordingIT extends Specification {\n+\n+    @Rule\n+    TemporaryFolder temp\n+\n+    String recordingDir\n+\n+    def setup() {\n+        recordingDir = temp.getRoot().getAbsolutePath()\n+    }\n+\n+    def \"retains all recordings for RECORD_ALL if successful\"() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd34121f44c8b37e9e8664f8c9c4336165d04143"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba0050b7a703bc7b694d3df8895db598e707f86f", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/ba0050b7a703bc7b694d3df8895db598e707f86f", "committedDate": "2020-04-12T14:14:45Z", "message": "Merge branch 'master' into spock-vnc-recording"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a5cc8d0735c8765c426e6f6c1f5c42662a338bf", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/8a5cc8d0735c8765c426e6f6c1f5c42662a338bf", "committedDate": "2020-04-12T17:02:10Z", "message": "Use filesystemFriendlyName as testId in SpockTestDescription"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODc3MDk5", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#pullrequestreview-391877099", "createdAt": "2020-04-12T17:05:51Z", "commit": {"oid": "8a5cc8d0735c8765c426e6f6c1f5c42662a338bf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59c1ac678b711611cb013d5cc8a077fc65c3fdba", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/59c1ac678b711611cb013d5cc8a077fc65c3fdba", "committedDate": "2020-04-12T17:23:41Z", "message": "Use data-driven test in BrowserVncRecordingIT"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODc4Nzcw", "url": "https://github.com/testcontainers/testcontainers-java/pull/2548#pullrequestreview-391878770", "createdAt": "2020-04-12T17:25:28Z", "commit": {"oid": "59c1ac678b711611cb013d5cc8a077fc65c3fdba"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c1613825a71178f6dbc9e976ab433d1e2b6b97e8", "author": {"user": {"login": "kiview", "name": "Kevin Wittek"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/c1613825a71178f6dbc9e976ab433d1e2b6b97e8", "committedDate": "2020-04-12T17:58:47Z", "message": "Merge branch 'master' into spock-vnc-recording"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3391, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}