{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMzcyNTk1", "number": 2558, "title": "Include image name in RemoteDockerImage#toString", "bodyText": "This PR superseeds #2450 with some minor fixes", "createdAt": "2020-04-12T17:33:38Z", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558", "merged": true, "mergeCommit": {"oid": "95c828d01eaa8532a4878a89587d0116e413ebd4"}, "closed": true, "closedAt": "2020-04-12T18:41:31Z", "author": {"login": "bsideup"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOrSUegH2gAyNDAyMzcyNTk1OjQxMGU5NmVjNzY0YmRmYjY2NDk4ZjA5NDU1YTk5OWU5NzcxNDc4OTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXAb02AFqTM5MTg5MzA3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "410e96ec764bdfb66498f09455a999e977147894", "author": {"user": null}, "url": "https://github.com/testcontainers/testcontainers-java/commit/410e96ec764bdfb66498f09455a999e977147894", "committedDate": "2020-03-17T23:26:57Z", "message": "clean up imports in GenericContainer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12c3b1c8ef80c39f24b00c0235973214a3fd3c37", "author": {"user": null}, "url": "https://github.com/testcontainers/testcontainers-java/commit/12c3b1c8ef80c39f24b00c0235973214a3fd3c37", "committedDate": "2020-03-17T23:37:48Z", "message": "include image name in RemoteDockerImage.toString() to fix #2443"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47329ba7747df814e8d10615eeb474af8b84cc03", "author": {"user": null}, "url": "https://github.com/testcontainers/testcontainers-java/commit/47329ba7747df814e8d10615eeb474af8b84cc03", "committedDate": "2020-03-18T21:29:41Z", "message": "test RemoteDockerImage directly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b316322b2f323b32dbc861253154389485eb094", "author": {"user": null}, "url": "https://github.com/testcontainers/testcontainers-java/commit/9b316322b2f323b32dbc861253154389485eb094", "committedDate": "2020-03-19T01:16:41Z", "message": "handle failures getting the image name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1af3325d90bddb46e8a66fe1494639c550bdc574", "author": {"user": null}, "url": "https://github.com/testcontainers/testcontainers-java/commit/1af3325d90bddb46e8a66fe1494639c550bdc574", "committedDate": "2020-03-19T15:54:41Z", "message": "use completeExceptionally instead of mocking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c78defa80a7d3183973ee2b2757622fd6dd33c0a", "author": {"user": null}, "url": "https://github.com/testcontainers/testcontainers-java/commit/c78defa80a7d3183973ee2b2757622fd6dd33c0a", "committedDate": "2020-03-19T15:55:04Z", "message": "tweak assertions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a7318f0f4f6f6aee61690b78667b84d404f6fa4", "author": {"user": null}, "url": "https://github.com/testcontainers/testcontainers-java/commit/8a7318f0f4f6f6aee61690b78667b84d404f6fa4", "committedDate": "2020-03-23T18:59:02Z", "message": "more assertion tweaks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d6908d0ede4cb4fde2a6d488eb6cfc041ac93c73", "author": {"user": null}, "url": "https://github.com/testcontainers/testcontainers-java/commit/d6908d0ede4cb4fde2a6d488eb6cfc041ac93c73", "committedDate": "2020-03-23T18:59:32Z", "message": "add isDone check to RemoteDockerImage.toString -- still figuring out why test fails"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a31c5ce6739f66d38918253ef0c173a09f9e4d9", "author": {"user": null}, "url": "https://github.com/testcontainers/testcontainers-java/commit/1a31c5ce6739f66d38918253ef0c173a09f9e4d9", "committedDate": "2020-03-27T20:33:27Z", "message": "go back to using lombok @ToString, exclude dockerClient while we're at it"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d70c67a28fc3e7279d842c3bd645a6021f8d9c0c", "author": {"user": {"login": "bsideup", "name": "Sergei Egorov"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/d70c67a28fc3e7279d842c3bd645a6021f8d9c0c", "committedDate": "2020-04-12T17:30:33Z", "message": "Merge branch 'image_name_in_RemoteDockerImage_toString' of https://github.com/locationlabs/testcontainers-java into locationlabs-image_name_in_RemoteDockerImage_toString"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f627bca1774b74b4eefe91dbba59ca3c864d47b", "author": {"user": {"login": "bsideup", "name": "Sergei Egorov"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/4f627bca1774b74b4eefe91dbba59ca3c864d47b", "committedDate": "2020-04-12T17:33:05Z", "message": "use `Futures.lazyTransform` that also proxies `isDone`"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6756f78c1d8917140b768a596d55217fc6a5efea", "author": {"user": {"login": "bsideup", "name": "Sergei Egorov"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/6756f78c1d8917140b768a596d55217fc6a5efea", "committedDate": "2020-04-12T17:35:39Z", "message": "`imageNameToString` should not be public"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31630ce22bdebd3ea8c3e6c25037980622ad3b07", "author": {"user": {"login": "bsideup", "name": "Sergei Egorov"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/31630ce22bdebd3ea8c3e6c25037980622ad3b07", "committedDate": "2020-04-12T17:39:55Z", "message": "Include the message on error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067", "author": {"user": {"login": "bsideup", "name": "Sergei Egorov"}}, "url": "https://github.com/testcontainers/testcontainers-java/commit/d5c42d1014057473a6c985f9d79f84440033b067", "committedDate": "2020-04-12T17:59:49Z", "message": "Merge branch 'master' into locationlabs-image_name_in_RemoteDockerImage_toString"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODgzMTcw", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#pullrequestreview-391883170", "createdAt": "2020-04-12T18:20:58Z", "commit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxODoyMDo1OFrOGEXoSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxODoyMzowNVrOGEXpKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIzNDYzNQ==", "bodyText": "Why is try necessary after the future is done?", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#discussion_r407234635", "createdAt": "2020-04-12T18:20:58Z", "author": {"login": "kiview"}, "path": "core/src/main/java/org/testcontainers/images/RemoteDockerImage.java", "diffHunk": "@@ -95,4 +92,21 @@ protected final String resolve() {\n             throw new ContainerFetchException(\"Failed to get Docker client for \" + imageName, e);\n         }\n     }\n+\n+    private DockerImageName getImageName() throws InterruptedException, ExecutionException {\n+        return imageNameFuture.get();\n+    }\n+\n+    @ToString.Include(name = \"imageName\", rank = 1)\n+    private String imageNameToString() {\n+        if (!imageNameFuture.isDone()) {\n+            return \"<resolving>\";\n+        }\n+\n+        try {\n+            return getImageName().toString();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIzNDg1OQ==", "bodyText": "Why random string?", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#discussion_r407234859", "createdAt": "2020-04-12T18:23:05Z", "author": {"login": "kiview"}, "path": "core/src/test/java/org/testcontainers/images/RemoteDockerImageTest.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package org.testcontainers.images;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertThat;\n+\n+import org.junit.Test;\n+import org.testcontainers.utility.Base58;\n+\n+import java.util.concurrent.CompletableFuture;\n+\n+public class RemoteDockerImageTest {\n+\n+    @Test\n+    public void toStringContainsOnlyImageName() {\n+        String imageName = Base58.randomString(8).toLowerCase();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODgzNzQx", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#pullrequestreview-391883741", "createdAt": "2020-04-12T18:28:07Z", "commit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxODoyODowN1rOGEXrkg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxODoyODowN1rOGEXrkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIzNTQ3NA==", "bodyText": "This caught me by surprise - in case of a failure, why would we not rethrow? At first sight it seems odd that an exception message could become the 'name' of the image...", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#discussion_r407235474", "createdAt": "2020-04-12T18:28:07Z", "author": {"login": "rnorth"}, "path": "core/src/main/java/org/testcontainers/images/RemoteDockerImage.java", "diffHunk": "@@ -95,4 +92,21 @@ protected final String resolve() {\n             throw new ContainerFetchException(\"Failed to get Docker client for \" + imageName, e);\n         }\n     }\n+\n+    private DockerImageName getImageName() throws InterruptedException, ExecutionException {\n+        return imageNameFuture.get();\n+    }\n+\n+    @ToString.Include(name = \"imageName\", rank = 1)\n+    private String imageNameToString() {\n+        if (!imageNameFuture.isDone()) {\n+            return \"<resolving>\";\n+        }\n+\n+        try {\n+            return getImageName().toString();\n+        } catch (InterruptedException | ExecutionException e) {\n+            return e.getMessage();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "originalPosition": 62}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODg0NTg5", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#pullrequestreview-391884589", "createdAt": "2020-04-12T18:39:07Z", "commit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODkyOTA1", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#pullrequestreview-391892905", "createdAt": "2020-04-12T20:34:20Z", "commit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQyMDozNDoyMVrOGEYgXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQyMDozNDoyMVrOGEYgXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzI0ODk4OQ==", "bodyText": "Looks like this method name doesn't really match the contents anymore", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#discussion_r407248989", "createdAt": "2020-04-12T20:34:21Z", "author": {"login": "dbyron0"}, "path": "core/src/test/java/org/testcontainers/images/RemoteDockerImageTest.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package org.testcontainers.images;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertThat;\n+\n+import org.junit.Test;\n+import org.testcontainers.utility.Base58;\n+\n+import java.util.concurrent.CompletableFuture;\n+\n+public class RemoteDockerImageTest {\n+\n+    @Test\n+    public void toStringContainsOnlyImageName() {\n+        String imageName = Base58.randomString(8).toLowerCase();\n+        RemoteDockerImage remoteDockerImage = new RemoteDockerImage(imageName);\n+        assertThat(remoteDockerImage.toString(), containsString(\"imageName=\" + imageName));\n+    }\n+\n+    @Test\n+    public void toStringWithExceptionContainsOnlyImageNameFuture()  {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODkzMDcy", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#pullrequestreview-391893072", "createdAt": "2020-04-12T20:36:44Z", "commit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQyMDozNjo0NFrOGEYhZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQyMDozNjo0NFrOGEYhZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzI0OTI1Mw==", "bodyText": "This method name came to be back when there was a choice between imageName and imageNameFuture.  Maybe a better name now is toStringWithCompletedImageName ?", "url": "https://github.com/testcontainers/testcontainers-java/pull/2558#discussion_r407249253", "createdAt": "2020-04-12T20:36:44Z", "author": {"login": "dbyron0"}, "path": "core/src/test/java/org/testcontainers/images/RemoteDockerImageTest.java", "diffHunk": "@@ -0,0 +1,47 @@\n+package org.testcontainers.images;\n+\n+import static org.hamcrest.CoreMatchers.containsString;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertThat;\n+\n+import org.junit.Test;\n+import org.testcontainers.utility.Base58;\n+\n+import java.util.concurrent.CompletableFuture;\n+\n+public class RemoteDockerImageTest {\n+\n+    @Test\n+    public void toStringContainsOnlyImageName() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5c42d1014057473a6c985f9d79f84440033b067"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3393, "cost": 1, "resetAt": "2021-11-02T12:20:56Z"}}}