{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyNjExMjIy", "number": 2017, "title": "Ignore testUpdateImageName if the image tag is 14.1.1.0-11", "bodyText": "Jenkins job for image 14.1.1.0-11\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/2933/testReport/\nFor testUpdateImageName\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/2933/testReport/oracle.weblogic.kubernetes/ItIntrospectVersion/testUpdateImageName/\n\"Skipped\noracle.weblogic.kubernetes.ItIntrospectVersion.testUpdateImageName\"\nJenkins Job for image 12.2.1.4\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/2934/testReport/\nFor testUpdateImageName\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/2934/consoleFull\n\"Test PASSED testUpdateImageName()\"", "createdAt": "2020-10-29T22:43:28Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017", "merged": true, "mergeCommit": {"oid": "37086746146de8314b1f5a40f46810f7633903ca"}, "closed": true, "closedAt": "2020-11-05T14:47:23Z", "author": {"login": "maggiehe00"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdWsBXYgH2gAyNTEyNjExMjIyOjJhNjVkNDY1MDcyYmRiZmUxOTI2ZjA3NjZmNDQ0MmZjYzVhNjNkMWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZTnNfAFqTUyMzcwMjc5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2a65d465072bdbfe1926f0766f4442fcc5a63d1a", "author": {"user": {"login": "maggiehe00", "name": "Maggie He"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/2a65d465072bdbfe1926f0766f4442fcc5a63d1a", "committedDate": "2020-10-27T17:00:53Z", "message": "abort the test if the image tag is 14.1.1.0-11"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ead3e1c88fa24afee48ca8e589955f2cde8b0a3b", "author": {"user": {"login": "maggiehe00", "name": "Maggie He"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ead3e1c88fa24afee48ca8e589955f2cde8b0a3b", "committedDate": "2020-10-27T17:08:38Z", "message": "Merge remote-tracking branch 'origin/develop' into ignoreTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad439031ba12fd7e43c87dc888d16d0e493af162", "author": {"user": {"login": "maggiehe00", "name": "Maggie He"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ad439031ba12fd7e43c87dc888d16d0e493af162", "committedDate": "2020-10-29T16:27:50Z", "message": "minor change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4fc09d7dd0234c9e1c23980bd2c6f76d230700ff", "author": {"user": {"login": "maggiehe00", "name": "Maggie He"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4fc09d7dd0234c9e1c23980bd2c6f76d230700ff", "committedDate": "2020-10-29T16:32:19Z", "message": "Merge remote-tracking branch 'origin/develop' into ignoreTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwMTU2MDU5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#pullrequestreview-520156059", "createdAt": "2020-10-29T23:23:58Z", "commit": {"oid": "4fc09d7dd0234c9e1c23980bd2c6f76d230700ff"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMzoyMzo1OFrOHqyGTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMzoyNTozOVrOHqyI1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDYyMzA1NA==", "bodyText": "Hi Maggie, Instead of modifying the framework methods you can use conditional check to skip a test. You can use the following annotation.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#discussion_r514623054", "createdAt": "2020-10-29T23:23:58Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/IntegrationTestWatcher.java", "diffHunk": "@@ -211,8 +211,15 @@ public void interceptTestMethod(Invocation<Void> invocation,\n   @Override\n   public void handleTestExecutionException(ExtensionContext context, Throwable throwable)\n       throws Throwable {\n-    printHeader(String.format(\"Test failed %s()\", methodName), \"!\");\n-    getLogger().severe(getStackTraceAsString(throwable));\n+    getLogger().info(\"Test Execution Exception is: \" + throwable.getMessage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4fc09d7dd0234c9e1c23980bd2c6f76d230700ff"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDYyMzM5Mw==", "bodyText": "`  class WebLogicImageCondition implements ExecutionCondition {\n@Override\npublic ConditionEvaluationResult evaluateExecutionCondition(ExtensionContext context) {\n  if (WEBLOGIC_IMAGE_TAG.equals(WLS_UPDATE_IMAGE_TAG)) {\n    return ConditionEvaluationResult.\n        disabled(String.format(\"No latest image availbale to continue test. Skipping test!\"));\n  } else {\n    return ConditionEvaluationResult.\n        enabled(String.format(\"Updating image to '%s'. Continuing test!\", WLS_UPDATE_IMAGE_TAG));\n  }\n}\n\n}\n@retention(RetentionPolicy.RUNTIME)\n@ExtendWith(WebLogicImageCondition.class)\n@interface AssumeWebLogicImage {\n}`", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#discussion_r514623393", "createdAt": "2020-10-29T23:24:47Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/ItIntrospectVersion.java", "diffHunk": "@@ -848,12 +850,15 @@ public void testCreateNewCluster() {\n    * To: \"image: container-registry.oracle.com/middleware/weblogic:14.1.1.0-11\"\n    * Verify all the pods are restarted and back to ready state\n    * Verify the admin server is accessible and cluster members are healthy\n+   * This test will be aborted if the image tag is: 14.1.1.0-11\n    */\n   @Order(5)\n   @Test\n   @DisplayName(\"Verify server pods are restarted by updating image name\")\n   public void testUpdateImageName() {\n-\n+    logger.info(\"In the testUpdateImageName() the image version is: \" + WEBLOGIC_IMAGE_TAG);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4fc09d7dd0234c9e1c23980bd2c6f76d230700ff"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDYyMzcwMQ==", "bodyText": "Then you can annotate the test method with @AssumeWebLogicImage", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#discussion_r514623701", "createdAt": "2020-10-29T23:25:39Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/ItIntrospectVersion.java", "diffHunk": "@@ -848,12 +850,15 @@ public void testCreateNewCluster() {\n    * To: \"image: container-registry.oracle.com/middleware/weblogic:14.1.1.0-11\"\n    * Verify all the pods are restarted and back to ready state\n    * Verify the admin server is accessible and cluster members are healthy\n+   * This test will be aborted if the image tag is: 14.1.1.0-11\n    */\n   @Order(5)\n   @Test\n   @DisplayName(\"Verify server pods are restarted by updating image name\")\n   public void testUpdateImageName() {\n-\n+    logger.info(\"In the testUpdateImageName() the image version is: \" + WEBLOGIC_IMAGE_TAG);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDYyMzM5Mw=="}, "originalCommit": {"oid": "4fc09d7dd0234c9e1c23980bd2c6f76d230700ff"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e37855eb8b2a837ea58871aa95b6fd26f987e68", "author": {"user": {"login": "maggiehe00", "name": "Maggie He"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0e37855eb8b2a837ea58871aa95b6fd26f987e68", "committedDate": "2020-10-30T21:06:07Z", "message": "implement the custom annotation @AssumeWebLogicImage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3088ebb3cfdfa292ad30e9a4a54b20dac8fa7dca", "author": {"user": {"login": "maggiehe00", "name": "Maggie He"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3088ebb3cfdfa292ad30e9a4a54b20dac8fa7dca", "committedDate": "2020-10-30T21:12:26Z", "message": "Merge remote-tracking branch 'origin/develop' into ignoreTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81fa97dd09c71576cbc9e4181fd1a1325a678f96", "author": {"user": {"login": "maggiehe00", "name": "Maggie He"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/81fa97dd09c71576cbc9e4181fd1a1325a678f96", "committedDate": "2020-10-30T21:55:35Z", "message": "checkstyple"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNzg5NDU5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#pullrequestreview-521789459", "createdAt": "2020-11-02T16:27:03Z", "commit": {"oid": "81fa97dd09c71576cbc9e4181fd1a1325a678f96"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNjoyNzowM1rOHsL1nw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNjoyNzowM1rOHsL1nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA5MzM0Mw==", "bodyText": "Hi Maggie, Since this is the only test using this annotation you can put these 2 methods directly in the test class. There is no need to add extra classes IMO.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#discussion_r516093343", "createdAt": "2020-11-02T16:27:03Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/annotations/AssumeWebLogicImage.java", "diffHunk": "@@ -0,0 +1,20 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa97dd09c71576cbc9e4181fd1a1325a678f96"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20d8865a4399c327779e3cd1cf9c554a974fedd7", "author": {"user": {"login": "maggiehe00", "name": "Maggie He"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/20d8865a4399c327779e3cd1cf9c554a974fedd7", "committedDate": "2020-11-02T20:39:48Z", "message": "adding the review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e483d73460aa533f3a4a3987691828a9ddd409ab", "author": {"user": {"login": "maggiehe00", "name": "Maggie He"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e483d73460aa533f3a4a3987691828a9ddd409ab", "committedDate": "2020-11-02T20:41:46Z", "message": "Merge remote-tracking branch 'origin/develop' into ignoreTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyODQ2MTYx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#pullrequestreview-522846161", "createdAt": "2020-11-03T20:21:17Z", "commit": {"oid": "e483d73460aa533f3a4a3987691828a9ddd409ab"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDoyMToxN1rOHs_G_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMDoyMToxN1rOHs_G_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkzMzM3Mg==", "bodyText": "Do we need this annotation? There is no annotation called \"assume-weblogic-image\" right?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#discussion_r516933372", "createdAt": "2020-11-03T20:21:17Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/ItIntrospectVersion.java", "diffHunk": "@@ -1014,4 +1025,40 @@ public void tearDownAll() {\n     }\n   }\n \n+  /**\n+  *  JUnit5 extension class to implement ExecutionCondition for the custom\n+  *  annotation @AssumeWebLogicImage.\n+  */\n+  private static class WebLogicImageCondition implements ExecutionCondition {\n+\n+    /**\n+     * Determine if the the test \"testUpdateImageName\" will be skipped based on WebLogic image tag.\n+     * Skip the test if the image tag is the latest one.\n+     *\n+     * @param context the current extension context\n+     * @return ConditionEvaluationResult disabled if the image tag is the latest one, enabled if the\n+     *         image tag is not the latest one\n+    */\n+    @Override\n+    public ConditionEvaluationResult evaluateExecutionCondition(ExtensionContext context) {\n+      if (WEBLOGIC_IMAGE_TAG.equals(WLS_LATEST_IMAGE_TAG)) {\n+        getLogger().info(\"WebLogic image tag is {0}. No latest image available to continue test. Skipping test\",\n+            WLS_LATEST_IMAGE_TAG);\n+        return ConditionEvaluationResult\n+            .disabled(String.format(\"No latest image available to continue test. Skipping test!\"));\n+      } else {\n+        getLogger().info(\"Updating image to {0}. Continuing test!\", WLS_UPDATE_IMAGE_TAG);\n+        return ConditionEvaluationResult\n+            .enabled(String.format(\"Updating image to {0}. Continuing test!\", WLS_UPDATE_IMAGE_TAG));\n+      }\n+    }\n+  }\n+\n+  @Target({ElementType.TYPE, ElementType.METHOD})\n+  @Retention(RetentionPolicy.RUNTIME)\n+  @Tag(\"assume-weblogic-image\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e483d73460aa533f3a4a3987691828a9ddd409ab"}, "originalPosition": 155}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNTQzMTkx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#pullrequestreview-523543191", "createdAt": "2020-11-04T16:43:28Z", "commit": {"oid": "e483d73460aa533f3a4a3987691828a9ddd409ab"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxNjo0MzoyOFrOHtgmFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQxNjo0MzoyOFrOHtgmFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQ4MjAwNA==", "bodyText": "ok alright.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#discussion_r517482004", "createdAt": "2020-11-04T16:43:28Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/ItIntrospectVersion.java", "diffHunk": "@@ -1014,4 +1025,40 @@ public void tearDownAll() {\n     }\n   }\n \n+  /**\n+  *  JUnit5 extension class to implement ExecutionCondition for the custom\n+  *  annotation @AssumeWebLogicImage.\n+  */\n+  private static class WebLogicImageCondition implements ExecutionCondition {\n+\n+    /**\n+     * Determine if the the test \"testUpdateImageName\" will be skipped based on WebLogic image tag.\n+     * Skip the test if the image tag is the latest one.\n+     *\n+     * @param context the current extension context\n+     * @return ConditionEvaluationResult disabled if the image tag is the latest one, enabled if the\n+     *         image tag is not the latest one\n+    */\n+    @Override\n+    public ConditionEvaluationResult evaluateExecutionCondition(ExtensionContext context) {\n+      if (WEBLOGIC_IMAGE_TAG.equals(WLS_LATEST_IMAGE_TAG)) {\n+        getLogger().info(\"WebLogic image tag is {0}. No latest image available to continue test. Skipping test\",\n+            WLS_LATEST_IMAGE_TAG);\n+        return ConditionEvaluationResult\n+            .disabled(String.format(\"No latest image available to continue test. Skipping test!\"));\n+      } else {\n+        getLogger().info(\"Updating image to {0}. Continuing test!\", WLS_UPDATE_IMAGE_TAG);\n+        return ConditionEvaluationResult\n+            .enabled(String.format(\"Updating image to {0}. Continuing test!\", WLS_UPDATE_IMAGE_TAG));\n+      }\n+    }\n+  }\n+\n+  @Target({ElementType.TYPE, ElementType.METHOD})\n+  @Retention(RetentionPolicy.RUNTIME)\n+  @Tag(\"assume-weblogic-image\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjkzMzM3Mg=="}, "originalCommit": {"oid": "e483d73460aa533f3a4a3987691828a9ddd409ab"}, "originalPosition": 155}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIzNzAyNzk4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2017#pullrequestreview-523702798", "createdAt": "2020-11-04T20:16:22Z", "commit": {"oid": "e483d73460aa533f3a4a3987691828a9ddd409ab"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4057, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}