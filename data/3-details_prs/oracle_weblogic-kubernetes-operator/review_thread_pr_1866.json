{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY2ODIzMTMy", "number": 1866, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNzoyOTowMFrOEXuenw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNzo0NTozN1rOEXu12A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzMzE0MjA3OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/CommonPatchTestUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNzoyOTowMFrOG_rW8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMTo0MjowNVrOG_z4Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQyMzg1Nw==", "bodyText": "remove the empty line here.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1866#discussion_r469423857", "createdAt": "2020-08-12T17:29:00Z", "author": {"login": "xiancao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/CommonPatchTestUtils.java", "diffHunk": "@@ -180,4 +180,26 @@ public static void checkPodRestartVersionUpdated(\n         String.format(\"Label weblogic.domainRestartVersion of pod %s in namespace %s has not been updated\",\n             podName, namespace));\n   }\n+\n+  /**\n+   * Patch the domain with the given string.\n+   *\n+   * @param domainUid unique domain identifier\n+   * @param domainNamespace the Kubernetes namespace where the domain is\n+   * @param patchStr the string for patching\n+   * @return true if successful, false otherwise\n+   */\n+  public static boolean patchDomainResource(String domainUid, String domainNamespace, StringBuffer patchStr) {\n+\n+    LoggingFacade logger = getLogger();\n+    logger.info(\"Modify domain resource for domain {0} in namespace {1} using patch string: {2}\",\n+        domainUid, domainNamespace, patchStr.toString());\n+\n+    V1Patch patch = new V1Patch(new String(patchStr));\n+\n+    return patchDomainCustomResource(domainUid, domainNamespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe16c0bad1f24bda5b26e5707513114ef25ad99c"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU2MzQyMg==", "bodyText": "Done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1866#discussion_r469563422", "createdAt": "2020-08-12T21:42:05Z", "author": {"login": "maggiehe00"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/CommonPatchTestUtils.java", "diffHunk": "@@ -180,4 +180,26 @@ public static void checkPodRestartVersionUpdated(\n         String.format(\"Label weblogic.domainRestartVersion of pod %s in namespace %s has not been updated\",\n             podName, namespace));\n   }\n+\n+  /**\n+   * Patch the domain with the given string.\n+   *\n+   * @param domainUid unique domain identifier\n+   * @param domainNamespace the Kubernetes namespace where the domain is\n+   * @param patchStr the string for patching\n+   * @return true if successful, false otherwise\n+   */\n+  public static boolean patchDomainResource(String domainUid, String domainNamespace, StringBuffer patchStr) {\n+\n+    LoggingFacade logger = getLogger();\n+    logger.info(\"Modify domain resource for domain {0} in namespace {1} using patch string: {2}\",\n+        domainUid, domainNamespace, patchStr.toString());\n+\n+    V1Patch patch = new V1Patch(new String(patchStr));\n+\n+    return patchDomainCustomResource(domainUid, domainNamespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQyMzg1Nw=="}, "originalCommit": {"oid": "fe16c0bad1f24bda5b26e5707513114ef25ad99c"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzMzE0NDAyOnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNzoyOTozNVrOG_rYOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMTo0MjoyMFrOG_z4hQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQyNDE4NQ==", "bodyText": "remove empty line here", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1866#discussion_r469424185", "createdAt": "2020-08-12T17:29:35Z", "author": {"login": "xiancao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "diffHunk": "@@ -222,8 +206,288 @@ public void testServerPodsRestartByChangingResource() {\n     assertEquals(requests.get(\"cpu\").getNumber().compareTo(cpuRequest), 0,\n         String.format(\"server pod compute resources requests was not updated correctly, set cpu request to %s, got %s\",\n             cpuRequest, requests.get(\"cpu\").getNumber()));\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify the domain scope property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The resource tested: includeServerOutInPodLog: true --> includeServerOutInPodLog: false.\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing IncludeServerOutInPodLog\")\n+  @Slow\n+  public void testServerPodsRestartByChangingIncludeServerOutInPodLog() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    // get the map with server pods and their original creation timestamps\n+    podsWithTimeStamps = getPodsWithTimeStamps();\n+\n+    //print out the original IncludeServerOutInPodLog\n+    Boolean includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"Original IncludeServerOutInPodLog is: {0}\", includeServerOutInPodLog);\n+\n+    //change includeServerOutInPodLog: true --> includeServerOutInPodLog: false\n+    StringBuffer patchStr = null;\n+    patchStr = new StringBuffer(\"[{\");\n+    patchStr.append(\"\\\"op\\\": \\\"replace\\\",\")\n+        .append(\" \\\"path\\\": \\\"/spec/includeServerOutInPodLog\\\",\")\n+        .append(\"\\\"value\\\": \")\n+        .append(false)\n+        .append(\"}]\");\n+    logger.info(\"PatchStr for includeServerOutInPodLog: {0}\", patchStr.toString());\n+\n+    boolean cmPatched = patchDomainResource(domainUid, domainNamespace, patchStr);\n+    assertTrue(cmPatched, \"patchDomainCustomResource(IncludeServerOutInPodLog) failed\");\n+\n+    domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"In the new patched domain IncludeServerOutInPodLog is: {0}\",\n+        includeServerOutInPodLog);\n+    assertFalse(includeServerOutInPodLog, \"IncludeServerOutInPodLog was not updated\");\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify domain scope serverPod env property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The env property tested: \"-Dweblogic.StdoutDebugEnabled=false\" --> \"-Dweblogic.StdoutDebugEnabled=true\".\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing serverPod env property\")\n+  @Slow\n+  public void testServerPodsRestartByChangingEnvProperty() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \" /spec/serverPod is null\");\n+    assertNotNull(domain1.getSpec().getServerPod(), domain1 + \" /spec/serverPod is null\");\n+    assertNotNull(domain1.getSpec().getServerPod().getEnv(), domain1 + \"/spec/serverPod/env is null\");\n+\n+    // get the map with server pods and their original creation timestamps\n+    podsWithTimeStamps = getPodsWithTimeStamps();\n+\n+    //print out the original env\n+    List<V1EnvVar> envList = domain1.getSpec().getServerPod().getEnv();\n+    envList.forEach(env -> {\n+      logger.info(\"The name is: {0}, value is: {1}\", env.getName(), env.getValue());\n+      if (env.getName().equalsIgnoreCase(\"JAVA_OPTIONS\")\n+          && env.getValue().equalsIgnoreCase(\"-Dweblogic.StdoutDebugEnabled=false\")) {\n+        logger.info(\"Change JAVA_OPTIONS to -Dweblogic.StdoutDebugEnabled=true\");\n+        StringBuffer patchStr = null;\n+        patchStr = new StringBuffer(\"[{\");\n+        patchStr.append(\"\\\"op\\\": \\\"replace\\\",\")\n+            .append(\" \\\"path\\\": \\\"/spec/serverPod/env/0/value\\\",\")\n+            .append(\"\\\"value\\\": \\\"\")\n+            .append(\"-Dweblogic.StdoutDebugEnabled=true\")\n+            .append(\"\\\"}]\");\n+        logger.info(\"PatchStr for JAVA_OPTIONS {0}\", patchStr.toString());\n+\n+        boolean cmPatched = patchDomainResource(domainUid, domainNamespace, patchStr);\n+        assertTrue(cmPatched, \"patchDomainCustomResource(StdoutDebugEnabled=true) failed\");\n+      }\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe16c0bad1f24bda5b26e5707513114ef25ad99c"}, "originalPosition": 197}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU2MzUyNQ==", "bodyText": "Done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1866#discussion_r469563525", "createdAt": "2020-08-12T21:42:20Z", "author": {"login": "maggiehe00"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "diffHunk": "@@ -222,8 +206,288 @@ public void testServerPodsRestartByChangingResource() {\n     assertEquals(requests.get(\"cpu\").getNumber().compareTo(cpuRequest), 0,\n         String.format(\"server pod compute resources requests was not updated correctly, set cpu request to %s, got %s\",\n             cpuRequest, requests.get(\"cpu\").getNumber()));\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify the domain scope property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The resource tested: includeServerOutInPodLog: true --> includeServerOutInPodLog: false.\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing IncludeServerOutInPodLog\")\n+  @Slow\n+  public void testServerPodsRestartByChangingIncludeServerOutInPodLog() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    // get the map with server pods and their original creation timestamps\n+    podsWithTimeStamps = getPodsWithTimeStamps();\n+\n+    //print out the original IncludeServerOutInPodLog\n+    Boolean includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"Original IncludeServerOutInPodLog is: {0}\", includeServerOutInPodLog);\n+\n+    //change includeServerOutInPodLog: true --> includeServerOutInPodLog: false\n+    StringBuffer patchStr = null;\n+    patchStr = new StringBuffer(\"[{\");\n+    patchStr.append(\"\\\"op\\\": \\\"replace\\\",\")\n+        .append(\" \\\"path\\\": \\\"/spec/includeServerOutInPodLog\\\",\")\n+        .append(\"\\\"value\\\": \")\n+        .append(false)\n+        .append(\"}]\");\n+    logger.info(\"PatchStr for includeServerOutInPodLog: {0}\", patchStr.toString());\n+\n+    boolean cmPatched = patchDomainResource(domainUid, domainNamespace, patchStr);\n+    assertTrue(cmPatched, \"patchDomainCustomResource(IncludeServerOutInPodLog) failed\");\n+\n+    domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"In the new patched domain IncludeServerOutInPodLog is: {0}\",\n+        includeServerOutInPodLog);\n+    assertFalse(includeServerOutInPodLog, \"IncludeServerOutInPodLog was not updated\");\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify domain scope serverPod env property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The env property tested: \"-Dweblogic.StdoutDebugEnabled=false\" --> \"-Dweblogic.StdoutDebugEnabled=true\".\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing serverPod env property\")\n+  @Slow\n+  public void testServerPodsRestartByChangingEnvProperty() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \" /spec/serverPod is null\");\n+    assertNotNull(domain1.getSpec().getServerPod(), domain1 + \" /spec/serverPod is null\");\n+    assertNotNull(domain1.getSpec().getServerPod().getEnv(), domain1 + \"/spec/serverPod/env is null\");\n+\n+    // get the map with server pods and their original creation timestamps\n+    podsWithTimeStamps = getPodsWithTimeStamps();\n+\n+    //print out the original env\n+    List<V1EnvVar> envList = domain1.getSpec().getServerPod().getEnv();\n+    envList.forEach(env -> {\n+      logger.info(\"The name is: {0}, value is: {1}\", env.getName(), env.getValue());\n+      if (env.getName().equalsIgnoreCase(\"JAVA_OPTIONS\")\n+          && env.getValue().equalsIgnoreCase(\"-Dweblogic.StdoutDebugEnabled=false\")) {\n+        logger.info(\"Change JAVA_OPTIONS to -Dweblogic.StdoutDebugEnabled=true\");\n+        StringBuffer patchStr = null;\n+        patchStr = new StringBuffer(\"[{\");\n+        patchStr.append(\"\\\"op\\\": \\\"replace\\\",\")\n+            .append(\" \\\"path\\\": \\\"/spec/serverPod/env/0/value\\\",\")\n+            .append(\"\\\"value\\\": \\\"\")\n+            .append(\"-Dweblogic.StdoutDebugEnabled=true\")\n+            .append(\"\\\"}]\");\n+        logger.info(\"PatchStr for JAVA_OPTIONS {0}\", patchStr.toString());\n+\n+        boolean cmPatched = patchDomainResource(domainUid, domainNamespace, patchStr);\n+        assertTrue(cmPatched, \"patchDomainCustomResource(StdoutDebugEnabled=true) failed\");\n+      }\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQyNDE4NQ=="}, "originalCommit": {"oid": "fe16c0bad1f24bda5b26e5707513114ef25ad99c"}, "originalPosition": 197}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzMzIwMDU4OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNzo0NToyNVrOG_r7ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMTo0MjoyN1rOG_z4ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQzMzI3NA==", "bodyText": "If the domain1 is Null, it will throw a NPE. We can change the statement to\nassertNotNull(domain1, \"Got Null Domain Resource after patching \");", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1866#discussion_r469433274", "createdAt": "2020-08-12T17:45:25Z", "author": {"login": "anpanigr"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "diffHunk": "@@ -222,8 +206,288 @@ public void testServerPodsRestartByChangingResource() {\n     assertEquals(requests.get(\"cpu\").getNumber().compareTo(cpuRequest), 0,\n         String.format(\"server pod compute resources requests was not updated correctly, set cpu request to %s, got %s\",\n             cpuRequest, requests.get(\"cpu\").getNumber()));\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify the domain scope property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The resource tested: includeServerOutInPodLog: true --> includeServerOutInPodLog: false.\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing IncludeServerOutInPodLog\")\n+  @Slow\n+  public void testServerPodsRestartByChangingIncludeServerOutInPodLog() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    // get the map with server pods and their original creation timestamps\n+    podsWithTimeStamps = getPodsWithTimeStamps();\n+\n+    //print out the original IncludeServerOutInPodLog\n+    Boolean includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"Original IncludeServerOutInPodLog is: {0}\", includeServerOutInPodLog);\n+\n+    //change includeServerOutInPodLog: true --> includeServerOutInPodLog: false\n+    StringBuffer patchStr = null;\n+    patchStr = new StringBuffer(\"[{\");\n+    patchStr.append(\"\\\"op\\\": \\\"replace\\\",\")\n+        .append(\" \\\"path\\\": \\\"/spec/includeServerOutInPodLog\\\",\")\n+        .append(\"\\\"value\\\": \")\n+        .append(false)\n+        .append(\"}]\");\n+    logger.info(\"PatchStr for includeServerOutInPodLog: {0}\", patchStr.toString());\n+\n+    boolean cmPatched = patchDomainResource(domainUid, domainNamespace, patchStr);\n+    assertTrue(cmPatched, \"patchDomainCustomResource(IncludeServerOutInPodLog) failed\");\n+\n+    domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe16c0bad1f24bda5b26e5707513114ef25ad99c"}, "originalPosition": 138}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU2MzU4Nw==", "bodyText": "Done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1866#discussion_r469563587", "createdAt": "2020-08-12T21:42:27Z", "author": {"login": "maggiehe00"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "diffHunk": "@@ -222,8 +206,288 @@ public void testServerPodsRestartByChangingResource() {\n     assertEquals(requests.get(\"cpu\").getNumber().compareTo(cpuRequest), 0,\n         String.format(\"server pod compute resources requests was not updated correctly, set cpu request to %s, got %s\",\n             cpuRequest, requests.get(\"cpu\").getNumber()));\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify the domain scope property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The resource tested: includeServerOutInPodLog: true --> includeServerOutInPodLog: false.\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing IncludeServerOutInPodLog\")\n+  @Slow\n+  public void testServerPodsRestartByChangingIncludeServerOutInPodLog() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    // get the map with server pods and their original creation timestamps\n+    podsWithTimeStamps = getPodsWithTimeStamps();\n+\n+    //print out the original IncludeServerOutInPodLog\n+    Boolean includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"Original IncludeServerOutInPodLog is: {0}\", includeServerOutInPodLog);\n+\n+    //change includeServerOutInPodLog: true --> includeServerOutInPodLog: false\n+    StringBuffer patchStr = null;\n+    patchStr = new StringBuffer(\"[{\");\n+    patchStr.append(\"\\\"op\\\": \\\"replace\\\",\")\n+        .append(\" \\\"path\\\": \\\"/spec/includeServerOutInPodLog\\\",\")\n+        .append(\"\\\"value\\\": \")\n+        .append(false)\n+        .append(\"}]\");\n+    logger.info(\"PatchStr for includeServerOutInPodLog: {0}\", patchStr.toString());\n+\n+    boolean cmPatched = patchDomainResource(domainUid, domainNamespace, patchStr);\n+    assertTrue(cmPatched, \"patchDomainCustomResource(IncludeServerOutInPodLog) failed\");\n+\n+    domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQzMzI3NA=="}, "originalCommit": {"oid": "fe16c0bad1f24bda5b26e5707513114ef25ad99c"}, "originalPosition": 138}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkzMzIwMTUyOnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQxNzo0NTozN1rOG_r8SA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMTo0MjozNFrOG_z49Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQzMzQxNg==", "bodyText": "If the domain1 is Null, it will throw a NPE. We can change the statement to\nassertNotNull(domain1, \"Got Null Domain Resource after patching \");\nCheck same thing for all occurrences", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1866#discussion_r469433416", "createdAt": "2020-08-12T17:45:37Z", "author": {"login": "anpanigr"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "diffHunk": "@@ -222,8 +206,288 @@ public void testServerPodsRestartByChangingResource() {\n     assertEquals(requests.get(\"cpu\").getNumber().compareTo(cpuRequest), 0,\n         String.format(\"server pod compute resources requests was not updated correctly, set cpu request to %s, got %s\",\n             cpuRequest, requests.get(\"cpu\").getNumber()));\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify the domain scope property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The resource tested: includeServerOutInPodLog: true --> includeServerOutInPodLog: false.\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing IncludeServerOutInPodLog\")\n+  @Slow\n+  public void testServerPodsRestartByChangingIncludeServerOutInPodLog() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    // get the map with server pods and their original creation timestamps\n+    podsWithTimeStamps = getPodsWithTimeStamps();\n+\n+    //print out the original IncludeServerOutInPodLog\n+    Boolean includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"Original IncludeServerOutInPodLog is: {0}\", includeServerOutInPodLog);\n+\n+    //change includeServerOutInPodLog: true --> includeServerOutInPodLog: false\n+    StringBuffer patchStr = null;\n+    patchStr = new StringBuffer(\"[{\");\n+    patchStr.append(\"\\\"op\\\": \\\"replace\\\",\")\n+        .append(\" \\\"path\\\": \\\"/spec/includeServerOutInPodLog\\\",\")\n+        .append(\"\\\"value\\\": \")\n+        .append(false)\n+        .append(\"}]\");\n+    logger.info(\"PatchStr for includeServerOutInPodLog: {0}\", patchStr.toString());\n+\n+    boolean cmPatched = patchDomainResource(domainUid, domainNamespace, patchStr);\n+    assertTrue(cmPatched, \"patchDomainCustomResource(IncludeServerOutInPodLog) failed\");\n+\n+    domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"In the new patched domain IncludeServerOutInPodLog is: {0}\",\n+        includeServerOutInPodLog);\n+    assertFalse(includeServerOutInPodLog, \"IncludeServerOutInPodLog was not updated\");\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify domain scope serverPod env property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The env property tested: \"-Dweblogic.StdoutDebugEnabled=false\" --> \"-Dweblogic.StdoutDebugEnabled=true\".\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing serverPod env property\")\n+  @Slow\n+  public void testServerPodsRestartByChangingEnvProperty() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \" /spec/serverPod is null\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe16c0bad1f24bda5b26e5707513114ef25ad99c"}, "originalPosition": 170}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU2MzYzNw==", "bodyText": "Done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1866#discussion_r469563637", "createdAt": "2020-08-12T21:42:34Z", "author": {"login": "maggiehe00"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItPodsRestart.java", "diffHunk": "@@ -222,8 +206,288 @@ public void testServerPodsRestartByChangingResource() {\n     assertEquals(requests.get(\"cpu\").getNumber().compareTo(cpuRequest), 0,\n         String.format(\"server pod compute resources requests was not updated correctly, set cpu request to %s, got %s\",\n             cpuRequest, requests.get(\"cpu\").getNumber()));\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify the domain scope property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The resource tested: includeServerOutInPodLog: true --> includeServerOutInPodLog: false.\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing IncludeServerOutInPodLog\")\n+  @Slow\n+  public void testServerPodsRestartByChangingIncludeServerOutInPodLog() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    // get the map with server pods and their original creation timestamps\n+    podsWithTimeStamps = getPodsWithTimeStamps();\n+\n+    //print out the original IncludeServerOutInPodLog\n+    Boolean includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"Original IncludeServerOutInPodLog is: {0}\", includeServerOutInPodLog);\n+\n+    //change includeServerOutInPodLog: true --> includeServerOutInPodLog: false\n+    StringBuffer patchStr = null;\n+    patchStr = new StringBuffer(\"[{\");\n+    patchStr.append(\"\\\"op\\\": \\\"replace\\\",\")\n+        .append(\" \\\"path\\\": \\\"/spec/includeServerOutInPodLog\\\",\")\n+        .append(\"\\\"value\\\": \")\n+        .append(false)\n+        .append(\"}]\");\n+    logger.info(\"PatchStr for includeServerOutInPodLog: {0}\", patchStr.toString());\n+\n+    boolean cmPatched = patchDomainResource(domainUid, domainNamespace, patchStr);\n+    assertTrue(cmPatched, \"patchDomainCustomResource(IncludeServerOutInPodLog) failed\");\n+\n+    domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \"/spec is null\");\n+\n+    includeServerOutInPodLog = domain1.getSpec().getIncludeServerOutInPodLog();\n+    logger.info(\"In the new patched domain IncludeServerOutInPodLog is: {0}\",\n+        includeServerOutInPodLog);\n+    assertFalse(includeServerOutInPodLog, \"IncludeServerOutInPodLog was not updated\");\n+\n+    // verify the server pods are rolling restarted and back to ready state\n+    logger.info(\"Verifying rolling restart occurred for domain {0} in namespace {1}\",\n+        domainUid, domainNamespace);\n+    assertTrue(assertDoesNotThrow(\n+        () -> verifyRollingRestartOccurred(podsWithTimeStamps, 1, domainNamespace),\n+        \"More than one pod was restarted at same time\"),\n+        String.format(\"Rolling restart failed for domain %s in namespace %s\", domainUid, domainNamespace));\n+\n+  }\n+\n+  /**\n+   * Modify domain scope serverPod env property on the domain resource.\n+   * Verify all pods are restarted and back to ready state.\n+   * The env property tested: \"-Dweblogic.StdoutDebugEnabled=false\" --> \"-Dweblogic.StdoutDebugEnabled=true\".\n+   */\n+  @Test\n+  @DisplayName(\"Verify server pods are restarted by changing serverPod env property\")\n+  @Slow\n+  public void testServerPodsRestartByChangingEnvProperty() {\n+    // get the original domain resource before update\n+    Domain domain1 = assertDoesNotThrow(() -> getDomainCustomResource(domainUid, domainNamespace),\n+        String.format(\"getDomainCustomResource failed with ApiException when tried to get domain %s in namespace %s\",\n+            domainUid, domainNamespace));\n+    assertNotNull(domain1, domain1 + \" is null\");\n+    assertNotNull(domain1.getSpec(), domain1 + \" /spec/serverPod is null\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTQzMzQxNg=="}, "originalCommit": {"oid": "fe16c0bad1f24bda5b26e5707513114ef25ad99c"}, "originalPosition": 170}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4195, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}