{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5NjAyMjQ1", "number": 2077, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxODo1MjowNlrOE_SwCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QyMToxMTo0OVrOFAfKYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0ODAyOTUyOnYy", "diffSide": "RIGHT", "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQxODo1MjowNlrOH87GzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwMDowMjoxMlrOH9E0Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY0NTAwNQ==", "bodyText": "should env var configued in initContainer take precedence over those configured in server or cluster?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r533645005", "createdAt": "2020-12-01T18:52:06Z", "author": {"login": "alai8"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -588,14 +589,22 @@ private static String formatHashLabel(String hash) {\n   protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n     V1PodSpec podSpec = createPodSpec(tuningParameters)\n         .readinessGates(getReadinessGates())\n-        .initContainers(getServerSpec().getInitContainers());\n+        .initContainers(getServerSpec().getInitContainers().stream()\n+                .map(c -> c.env(createEnv(c, tuningParameters))).collect(Collectors.toList()));\n \n     for (V1Volume additionalVolume : getVolumes(getDomainUid())) {\n       podSpec.addVolumesItem(additionalVolume);\n     }\n     return podSpec;\n   }\n \n+  private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n+    List<V1EnvVar> envVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "97838bbc19d1e78d0c3fc27a2ca0278fe9ff5bf3"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY1MDE4MQ==", "bodyText": "That's a good point. I had thought that the env var list will be mutually exclusive or env variables configured in server or cluster will take precedence. I'm not sure if customers would want to override  server/domain env variables in the init containers. @rjeberhard thoughts? Thanks.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r533650181", "createdAt": "2020-12-01T19:00:08Z", "author": {"login": "ankedia"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -588,14 +589,22 @@ private static String formatHashLabel(String hash) {\n   protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n     V1PodSpec podSpec = createPodSpec(tuningParameters)\n         .readinessGates(getReadinessGates())\n-        .initContainers(getServerSpec().getInitContainers());\n+        .initContainers(getServerSpec().getInitContainers().stream()\n+                .map(c -> c.env(createEnv(c, tuningParameters))).collect(Collectors.toList()));\n \n     for (V1Volume additionalVolume : getVolumes(getDomainUid())) {\n       podSpec.addVolumesItem(additionalVolume);\n     }\n     return podSpec;\n   }\n \n+  private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n+    List<V1EnvVar> envVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY0NTAwNQ=="}, "originalCommit": {"oid": "97838bbc19d1e78d0c3fc27a2ca0278fe9ff5bf3"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY2OTIxNg==", "bodyText": "I guess that I would lean the other direction... That is, the highest precedence would be the most local configuration, which in this case, I think would be the environment variables specifically on the initContainer.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r533669216", "createdAt": "2020-12-01T19:32:35Z", "author": {"login": "rjeberhard"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -588,14 +589,22 @@ private static String formatHashLabel(String hash) {\n   protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n     V1PodSpec podSpec = createPodSpec(tuningParameters)\n         .readinessGates(getReadinessGates())\n-        .initContainers(getServerSpec().getInitContainers());\n+        .initContainers(getServerSpec().getInitContainers().stream()\n+                .map(c -> c.env(createEnv(c, tuningParameters))).collect(Collectors.toList()));\n \n     for (V1Volume additionalVolume : getVolumes(getDomainUid())) {\n       podSpec.addVolumesItem(additionalVolume);\n     }\n     return podSpec;\n   }\n \n+  private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n+    List<V1EnvVar> envVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY0NTAwNQ=="}, "originalCommit": {"oid": "97838bbc19d1e78d0c3fc27a2ca0278fe9ff5bf3"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzczNjU1OQ==", "bodyText": "I have made the change to set higher precedence for environment variables set in init containers in cad0c30. Please let me know if I missed something. Thanks.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r533736559", "createdAt": "2020-12-01T21:35:42Z", "author": {"login": "ankedia"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -588,14 +589,22 @@ private static String formatHashLabel(String hash) {\n   protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n     V1PodSpec podSpec = createPodSpec(tuningParameters)\n         .readinessGates(getReadinessGates())\n-        .initContainers(getServerSpec().getInitContainers());\n+        .initContainers(getServerSpec().getInitContainers().stream()\n+                .map(c -> c.env(createEnv(c, tuningParameters))).collect(Collectors.toList()));\n \n     for (V1Volume additionalVolume : getVolumes(getDomainUid())) {\n       podSpec.addVolumesItem(additionalVolume);\n     }\n     return podSpec;\n   }\n \n+  private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n+    List<V1EnvVar> envVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY0NTAwNQ=="}, "originalCommit": {"oid": "97838bbc19d1e78d0c3fc27a2ca0278fe9ff5bf3"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc0MjQ5OA==", "bodyText": "please add a test case for testing the precedence. Thanks", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r533742498", "createdAt": "2020-12-01T21:47:13Z", "author": {"login": "alai8"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -588,14 +589,22 @@ private static String formatHashLabel(String hash) {\n   protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n     V1PodSpec podSpec = createPodSpec(tuningParameters)\n         .readinessGates(getReadinessGates())\n-        .initContainers(getServerSpec().getInitContainers());\n+        .initContainers(getServerSpec().getInitContainers().stream()\n+                .map(c -> c.env(createEnv(c, tuningParameters))).collect(Collectors.toList()));\n \n     for (V1Volume additionalVolume : getVolumes(getDomainUid())) {\n       podSpec.addVolumesItem(additionalVolume);\n     }\n     return podSpec;\n   }\n \n+  private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n+    List<V1EnvVar> envVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY0NTAwNQ=="}, "originalCommit": {"oid": "97838bbc19d1e78d0c3fc27a2ca0278fe9ff5bf3"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzgwNDExNQ==", "bodyText": "Added whenInitContainersHaveEnvVar_verifyInitContainersEnvVarTakesPrecedenceOverPreConfiguredEnvVar test in 66f56c5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r533804115", "createdAt": "2020-12-02T00:02:12Z", "author": {"login": "ankedia"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -588,14 +589,22 @@ private static String formatHashLabel(String hash) {\n   protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n     V1PodSpec podSpec = createPodSpec(tuningParameters)\n         .readinessGates(getReadinessGates())\n-        .initContainers(getServerSpec().getInitContainers());\n+        .initContainers(getServerSpec().getInitContainers().stream()\n+                .map(c -> c.env(createEnv(c, tuningParameters))).collect(Collectors.toList()));\n \n     for (V1Volume additionalVolume : getVolumes(getDomainUid())) {\n       podSpec.addVolumesItem(additionalVolume);\n     }\n     return podSpec;\n   }\n \n+  private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n+    List<V1EnvVar> envVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzY0NTAwNQ=="}, "originalCommit": {"oid": "97838bbc19d1e78d0c3fc27a2ca0278fe9ff5bf3"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM0ODY1MjgwOnYy", "diffSide": "RIGHT", "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMTo0Njo0MFrOH9BClA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxNjo1NDoyMVrOH9kn4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc0MjIyOA==", "bodyText": "addDefaultEnvVarIfMissing does not handle V1EnvVar with ValueFrom.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r533742228", "createdAt": "2020-12-01T21:46:40Z", "author": {"login": "alai8"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -599,10 +599,11 @@ protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n   }\n \n   private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n-    List<V1EnvVar> envVars = new ArrayList<>();\n-    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);\n-    envVars.addAll(getEnvironmentVariables(tuningParameters));\n-    return envVars;\n+    List<V1EnvVar> initContainerEnvVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(initContainerEnvVars::addAll);\n+    getEnvironmentVariables(tuningParameters).forEach(envVar ->\n+            addDefaultEnvVarIfMissing(initContainerEnvVars, envVar.getName(), envVar.getValue()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cad0c306067ef3650d61a9194a560443bb3e1e24"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzgwNTg5Mw==", "bodyText": "As discussed, V1EnvVar with ValueFrom is already handled in getEnvironmentVariables(tuningParameters) method.  I have created a new method addIfMissing to add the env variable to list only if it's missing from the list. I also tested setting env var with ValueFrom in init containers and it's handled correctly.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r533805893", "createdAt": "2020-12-02T00:07:19Z", "author": {"login": "ankedia"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -599,10 +599,11 @@ protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n   }\n \n   private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n-    List<V1EnvVar> envVars = new ArrayList<>();\n-    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);\n-    envVars.addAll(getEnvironmentVariables(tuningParameters));\n-    return envVars;\n+    List<V1EnvVar> initContainerEnvVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(initContainerEnvVars::addAll);\n+    getEnvironmentVariables(tuningParameters).forEach(envVar ->\n+            addDefaultEnvVarIfMissing(initContainerEnvVars, envVar.getName(), envVar.getValue()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc0MjIyOA=="}, "originalCommit": {"oid": "cad0c306067ef3650d61a9194a560443bb3e1e24"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzgzODI5Mg==", "bodyText": "can you also verify env var with ValueFrom in server spec are also set correctly in initContainer? Thanks", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r533838292", "createdAt": "2020-12-02T01:37:39Z", "author": {"login": "alai8"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -599,10 +599,11 @@ protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n   }\n \n   private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n-    List<V1EnvVar> envVars = new ArrayList<>();\n-    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);\n-    envVars.addAll(getEnvironmentVariables(tuningParameters));\n-    return envVars;\n+    List<V1EnvVar> initContainerEnvVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(initContainerEnvVars::addAll);\n+    getEnvironmentVariables(tuningParameters).forEach(envVar ->\n+            addDefaultEnvVarIfMissing(initContainerEnvVars, envVar.getName(), envVar.getValue()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc0MjIyOA=="}, "originalCommit": {"oid": "cad0c306067ef3650d61a9194a560443bb3e1e24"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMyNTIxOA==", "bodyText": "I have pushed a change in 4646578 to handle ValueFrom in addIfMissing which will add the env variable with ValueFrom if env value is empty or null. I have also functionally tested that env var is set in initContainer. Thanks.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r534325218", "createdAt": "2020-12-02T16:54:21Z", "author": {"login": "ankedia"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -599,10 +599,11 @@ protected V1PodSpec createSpec(TuningParameters tuningParameters) {\n   }\n \n   private List<V1EnvVar> createEnv(V1Container c, TuningParameters tuningParameters) {\n-    List<V1EnvVar> envVars = new ArrayList<>();\n-    Optional.ofNullable(c.getEnv()).ifPresent(envVars::addAll);\n-    envVars.addAll(getEnvironmentVariables(tuningParameters));\n-    return envVars;\n+    List<V1EnvVar> initContainerEnvVars = new ArrayList<>();\n+    Optional.ofNullable(c.getEnv()).ifPresent(initContainerEnvVars::addAll);\n+    getEnvironmentVariables(tuningParameters).forEach(envVar ->\n+            addDefaultEnvVarIfMissing(initContainerEnvVars, envVar.getName(), envVar.getValue()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc0MjIyOA=="}, "originalCommit": {"oid": "cad0c306067ef3650d61a9194a560443bb3e1e24"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM2MDU0ODgxOnYy", "diffSide": "RIGHT", "path": "operator/src/test/java/oracle/kubernetes/operator/helpers/Matchers.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QyMToxMTo0OVrOH-z6eA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQwMjoyMjozMVrOH-94Pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTYyNDMxMg==", "bodyText": "Those new methods (createXXX, listXXX and addXXX) do not seem to belong to this class.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r535624312", "createdAt": "2020-12-03T21:11:49Z", "author": {"login": "doxiao"}, "path": "operator/src/test/java/oracle/kubernetes/operator/helpers/Matchers.java", "diffHunk": "@@ -66,6 +78,39 @@ private static V1Container createContainer(String name, String image, String...\n     return new V1Container().name(name).image(image).command(Arrays.asList(command));\n   }\n \n+  private static V1Container createInitContainer(String name, String image, String serverName, String... command) {\n+    return new V1Container().name(name).image(image).command(Arrays.asList(command))\n+            .env(PodHelperTestBase.getPredefinedEnvVariables(serverName));\n+  }\n+\n+  private static V1Container createInitContainerWithEnvVar(String name, String image, String serverName,\n+                                                           V1EnvVar envVar, String... command) {\n+    List<V1EnvVar> envVars = new ArrayList<>(Arrays.asList(envVar));\n+    PodHelperTestBase.getPredefinedEnvVariables(serverName).forEach(predefEnvVar ->\n+            addIfMissing(envVars, predefEnvVar.getName(), predefEnvVar.getValue()));\n+    return new V1Container().name(name).image(image).command(Arrays.asList(command))\n+            .env(envVars);\n+  }\n+\n+  protected static void addEnvVar(List<V1EnvVar> vars, String name, String value) {\n+    vars.add(new V1EnvVar().name(name).value(value));\n+  }\n+\n+  protected static boolean listHasEnvVar(List<V1EnvVar> vars, String name) {\n+    for (V1EnvVar var : vars) {\n+      if (name.equals(var.getName())) {\n+        return true;\n+      }\n+    }\n+    return false;\n+  }\n+\n+  protected static void addIfMissing(List<V1EnvVar> vars, String name, String value) {\n+    if (!listHasEnvVar(vars, name)) {\n+      addEnvVar(vars, name, value);\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46465788b1bc17357e3ff9c659af74f24ff77159"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTY4NDU4OA==", "bodyText": "Thanks. These methods are used by the helper methods hasInitContainer and hasInitContainerWithEnvVar to verify if the init containers in the pod has appropriate pre-populated environment variables. Any suggestions on what would be a good place to move them?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r535684588", "createdAt": "2020-12-03T22:18:07Z", "author": {"login": "ankedia"}, "path": "operator/src/test/java/oracle/kubernetes/operator/helpers/Matchers.java", "diffHunk": "@@ -66,6 +78,39 @@ private static V1Container createContainer(String name, String image, String...\n     return new V1Container().name(name).image(image).command(Arrays.asList(command));\n   }\n \n+  private static V1Container createInitContainer(String name, String image, String serverName, String... command) {\n+    return new V1Container().name(name).image(image).command(Arrays.asList(command))\n+            .env(PodHelperTestBase.getPredefinedEnvVariables(serverName));\n+  }\n+\n+  private static V1Container createInitContainerWithEnvVar(String name, String image, String serverName,\n+                                                           V1EnvVar envVar, String... command) {\n+    List<V1EnvVar> envVars = new ArrayList<>(Arrays.asList(envVar));\n+    PodHelperTestBase.getPredefinedEnvVariables(serverName).forEach(predefEnvVar ->\n+            addIfMissing(envVars, predefEnvVar.getName(), predefEnvVar.getValue()));\n+    return new V1Container().name(name).image(image).command(Arrays.asList(command))\n+            .env(envVars);\n+  }\n+\n+  protected static void addEnvVar(List<V1EnvVar> vars, String name, String value) {\n+    vars.add(new V1EnvVar().name(name).value(value));\n+  }\n+\n+  protected static boolean listHasEnvVar(List<V1EnvVar> vars, String name) {\n+    for (V1EnvVar var : vars) {\n+      if (name.equals(var.getName())) {\n+        return true;\n+      }\n+    }\n+    return false;\n+  }\n+\n+  protected static void addIfMissing(List<V1EnvVar> vars, String name, String value) {\n+    if (!listHasEnvVar(vars, name)) {\n+      addEnvVar(vars, name, value);\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTYyNDMxMg=="}, "originalCommit": {"oid": "46465788b1bc17357e3ff9c659af74f24ff77159"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTc4NzU4Mw==", "bodyText": "Now I see other helper methods in this class too.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2077#discussion_r535787583", "createdAt": "2020-12-04T02:22:31Z", "author": {"login": "doxiao"}, "path": "operator/src/test/java/oracle/kubernetes/operator/helpers/Matchers.java", "diffHunk": "@@ -66,6 +78,39 @@ private static V1Container createContainer(String name, String image, String...\n     return new V1Container().name(name).image(image).command(Arrays.asList(command));\n   }\n \n+  private static V1Container createInitContainer(String name, String image, String serverName, String... command) {\n+    return new V1Container().name(name).image(image).command(Arrays.asList(command))\n+            .env(PodHelperTestBase.getPredefinedEnvVariables(serverName));\n+  }\n+\n+  private static V1Container createInitContainerWithEnvVar(String name, String image, String serverName,\n+                                                           V1EnvVar envVar, String... command) {\n+    List<V1EnvVar> envVars = new ArrayList<>(Arrays.asList(envVar));\n+    PodHelperTestBase.getPredefinedEnvVariables(serverName).forEach(predefEnvVar ->\n+            addIfMissing(envVars, predefEnvVar.getName(), predefEnvVar.getValue()));\n+    return new V1Container().name(name).image(image).command(Arrays.asList(command))\n+            .env(envVars);\n+  }\n+\n+  protected static void addEnvVar(List<V1EnvVar> vars, String name, String value) {\n+    vars.add(new V1EnvVar().name(name).value(value));\n+  }\n+\n+  protected static boolean listHasEnvVar(List<V1EnvVar> vars, String name) {\n+    for (V1EnvVar var : vars) {\n+      if (name.equals(var.getName())) {\n+        return true;\n+      }\n+    }\n+    return false;\n+  }\n+\n+  protected static void addIfMissing(List<V1EnvVar> vars, String name, String value) {\n+    if (!listHasEnvVar(vars, name)) {\n+      addEnvVar(vars, name, value);\n+    }\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTYyNDMxMg=="}, "originalCommit": {"oid": "46465788b1bc17357e3ff9c659af74f24ff77159"}, "originalPosition": 63}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3783, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}