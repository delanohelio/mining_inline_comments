{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEwMDY1OTY4", "number": 1605, "title": "Attempt to clean up use of bad exec()", "bodyText": "This PR attempts to resolve a number of test failures that occur due\nto the bad use of the TestUtils.exec() method.  This method throws a\nRuntimeException if the return code of the executed command is non-zero.\nThis method is being used in many places (over 40).  Many of those do\nnot appear to need or want that behavior, and should instead be using\nthe ExecCommand.exec() method which executes a command and then returns\nthe result, without throwing an exception if the command fails.\nIn this PR, I have done a visual inspection of each use of\nTestUtils.exec() and changed them to ExecCommand.exec() where it\nappeared to make sense.  This includes every case where the call was\nusing the return value from the method, and those where it appears clear\nfrom the subsequent logic that a failed command was not expected to\nterminate the process.\nThere were some calls that I left because I could not be sure of the\nintent, and these will require more study.\nIn order to make the code clearer, and make people think twice about\nusing TestUtils.exec(), which has caused so many failures, I renamed\nthat method to TestUtils.execOrAbortProcess().  Hopefully that will make\nit clearer that that method has a dangerous and unexpected side effect.\nNote: This PR does include unmerged changes from PR 1601", "createdAt": "2020-04-28T11:47:18Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1605", "merged": true, "mergeCommit": {"oid": "30367dc3c58c780beb57470cfb772d246b00ee1a"}, "closed": true, "closedAt": "2020-04-28T19:01:45Z", "author": {"login": "markxnelson"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcb0AOmgH2gAyNDEwMDY1OTY4OmIyMDQzZDRiZDllMjQwOGU5MzdjNGY2MmFiNTBlMDM5ZjRlN2IwYjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccIqeoAFqTQwMjEyNjc1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b2043d4bd9e2408e937c4f62ab50e039f4e7b0b9", "author": {"user": {"login": "markxnelson", "name": "Mark Nelson"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b2043d4bd9e2408e937c4f62ab50e039f4e7b0b9", "committedDate": "2020-04-27T18:57:21Z", "message": "add some debugging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5edb8db5aca8810aadd48e970c29c052cbee75e3", "author": {"user": {"login": "markxnelson", "name": "Mark Nelson"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5edb8db5aca8810aadd48e970c29c052cbee75e3", "committedDate": "2020-04-28T00:34:37Z", "message": "fix checkstyle errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe110d259dc580b1a2cda88740d5fb25bef1db83", "author": {"user": {"login": "markxnelson", "name": "Mark Nelson"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fe110d259dc580b1a2cda88740d5fb25bef1db83", "committedDate": "2020-04-28T11:18:06Z", "message": "fix logging test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90da85f34f49af79f89b4382c102cdfba1229082", "author": {"user": {"login": "markxnelson", "name": "Mark Nelson"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/90da85f34f49af79f89b4382c102cdfba1229082", "committedDate": "2020-04-28T11:32:05Z", "message": "Merge branch 'it-resilience-2' of https://github.com/oracle/weblogic-kubernetes-operator into it-resilience-3"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d0f5da7c3488da3861f718ef35cb9197864e94e", "author": {"user": {"login": "markxnelson", "name": "Mark Nelson"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7d0f5da7c3488da3861f718ef35cb9197864e94e", "committedDate": "2020-04-28T11:41:36Z", "message": "Attempt to clean up use of bad exec()\n\nThis commit attempts to resolve a number of test failures that occur due\nto the bad use of the TestUtils.exec() method.  This method throws a\nRuntimeException if the return code of the executed command is non-zero.\nThis method is being used in many places (over 40).  Many of those do\nnot appear to need or want that behavior, and should instead be using\nthe ExecCommand.exec() method which executes a command and then returns\nthe result, without throwing an exception if the command fails.\n\nIn this commit, I have done a visual inspection of each use of\nTestUtils.exec() and changed them to ExecCommand.exec() where it\nappeared to make sense.  This includes every case where the call was\nusing the return value from the method, and those where it appears clear\nfrom the subsequent logic that a failed command was not expected to\nterminate the process.\n\nThere were some calls that I left because I could not be sure of the\nintent, and these will require more study.\n\nIn order to make the code clearer, and make people think twice about\nusing TestUtils.exec(), which has caused so many failures, I renamed\nthat method to TestUtils.execOrAbortProcess().  Hopefully that will make\nit clearer that that method has a dangerous and unexpected side effect."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNzc2MDYz", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1605#pullrequestreview-401776063", "createdAt": "2020-04-28T12:18:13Z", "commit": {"oid": "7d0f5da7c3488da3861f718ef35cb9197864e94e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMjoxODoxM1rOGNRH_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQxMjoxODoxM1rOGNRH_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjU2NTI0NA==", "bodyText": "we looked into this test yesterday, this should be ExecCommand.exec() ?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1605#discussion_r416565244", "createdAt": "2020-04-28T12:18:13Z", "author": {"login": "vanajamukkara"}, "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItElasticLogging.java", "diffHunk": "@@ -514,12 +516,14 @@ private String execSearchQuery(String queryCriteria, String index)\n             .append(\"'\")\n             .toString();\n     LoggerHelper.getLocal().log(Level.INFO, \"Command to search: \" + cmd);\n-    ExecResult result = TestUtils.exec(cmd);\n+    ExecResult result = TestUtils.execOrAbortProcess(cmd);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d0f5da7c3488da3861f718ef35cb9197864e94e"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41a05dcd9a4fcd2cb97f2c9e37c6be58bf6e18df", "author": {"user": {"login": "rjeberhard", "name": "Ryan Eberhard"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/41a05dcd9a4fcd2cb97f2c9e37c6be58bf6e18df", "committedDate": "2020-04-28T14:15:34Z", "message": "Merge remote-tracking branch 'origin/develop' into it-resilience-3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMTI2NzU3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1605#pullrequestreview-402126757", "createdAt": "2020-04-28T19:01:36Z", "commit": {"oid": "41a05dcd9a4fcd2cb97f2c9e37c6be58bf6e18df"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4720, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}