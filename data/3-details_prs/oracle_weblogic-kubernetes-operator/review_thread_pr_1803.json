{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NTQ1Mzkx", "number": 1803, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwNDozMDo0NVrOEOGLzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwNDozMDo0NVrOEOGLzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMjE2ODQ3OnYy", "diffSide": "RIGHT", "path": "src/integration-tests/model-in-image/deploy-traefik.sh", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwNDozMDo0NVrOGxDpLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxNTo1NjoyNFrOGxaO3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDA5MzEwMQ==", "bodyText": "Can you use the the script setup.sh  in samples/charts/utils directory to configure traefik.  The latest version of traefik  ( v 2.2.1) has different chart repository ( containous.github.io/traefik-helm-chart), The chart name is not stable/traefik but traefik/traefik.  I am working on a PR to upgrade the traefik version.  All these will be taken care by setup.sh, provided you use the command \"setup.sh create traefik\" in your script.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1803#discussion_r454093101", "createdAt": "2020-07-14T04:30:45Z", "author": {"login": "anpanigr"}, "path": "src/integration-tests/model-in-image/deploy-traefik.sh", "diffHunk": "@@ -49,32 +53,60 @@ set +e\n helm get values ${TRAEFIK_NAME} -n ${TRAEFIK_NAMESPACE} > $WORKDIR/test-out/traefik-values.cur 2>&1\n res=$?\n set -e\n-echo ${DOMAIN_NAMESPACE} >> $WORKDIR/test-out/traefik-values.cur\n+for evar in DOMAIN_NAMESPACE TRAEFIK_NAMESPACE TRAEFIK_NAME TRAEFIK_HTTP_NODEPORT TRAEFIK_HTTPS_NODEPORT; do\n+  echo \"${evar}=${!evar}\" >> $WORKDIR/test-out/traefik-values.cur\n+done\n if [ $res -eq 0 ] \\\n    && [ -e \"$WORKDIR/test-out/traefik-values.orig\" ] \\\n    && [ \"$(cat $WORKDIR/test-out/traefik-values.cur)\" = \"$(cat $WORKDIR/test-out/traefik-values.orig)\" ]; then\n   echo \"@@\"\n-  echo \"@@ Traefik already installed. Skipping uninstall/install.\"\n+  echo \"@@ Traefik already installed. Skipping uninstall/install. Current values:\"\n+  cat $WORKDIR/test-out/traefik-values.orig\n   echo \"@@\"\n else\n   set +e\n+  echo \"@@\"\n+  echo \"@@ Uninstalling old install (if any) using 'helm uninstall $TRAEFIK_NAME -n $TRAEFIK_NAMESPACE'\"\n+  echo \"@@\"\n   helm uninstall $TRAEFIK_NAME -n $TRAEFIK_NAMESPACE\n+  echo \"@@ Creating traefik namespace '$TRAEFIK_NAMESPACE' and domain namepace '$DOMAIN_NAMESPACE'\"\n   kubectl create namespace $TRAEFIK_NAMESPACE\n   kubectl create namespace $DOMAIN_NAMESPACE\n   set -e\n \n   cd ${SRCDIR}\n \n+  echo \"@@ Installing traefik\"\n+\n   # you only need to add the repo once, but we do it every time for simplicity\n   helm repo add stable https://kubernetes-charts.storage.googleapis.com/\n \n+  set -x\n+\n   helm install ${TRAEFIK_NAME} stable/traefik \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81b924154e59e9428c6b9dcdec3a5250606b5d8b"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQwMjA2OQ==", "bodyText": "How about I do that in a future PR once the newest version of setup.sh is ready?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1803#discussion_r454402069", "createdAt": "2020-07-14T14:33:33Z", "author": {"login": "tbarnes-us"}, "path": "src/integration-tests/model-in-image/deploy-traefik.sh", "diffHunk": "@@ -49,32 +53,60 @@ set +e\n helm get values ${TRAEFIK_NAME} -n ${TRAEFIK_NAMESPACE} > $WORKDIR/test-out/traefik-values.cur 2>&1\n res=$?\n set -e\n-echo ${DOMAIN_NAMESPACE} >> $WORKDIR/test-out/traefik-values.cur\n+for evar in DOMAIN_NAMESPACE TRAEFIK_NAMESPACE TRAEFIK_NAME TRAEFIK_HTTP_NODEPORT TRAEFIK_HTTPS_NODEPORT; do\n+  echo \"${evar}=${!evar}\" >> $WORKDIR/test-out/traefik-values.cur\n+done\n if [ $res -eq 0 ] \\\n    && [ -e \"$WORKDIR/test-out/traefik-values.orig\" ] \\\n    && [ \"$(cat $WORKDIR/test-out/traefik-values.cur)\" = \"$(cat $WORKDIR/test-out/traefik-values.orig)\" ]; then\n   echo \"@@\"\n-  echo \"@@ Traefik already installed. Skipping uninstall/install.\"\n+  echo \"@@ Traefik already installed. Skipping uninstall/install. Current values:\"\n+  cat $WORKDIR/test-out/traefik-values.orig\n   echo \"@@\"\n else\n   set +e\n+  echo \"@@\"\n+  echo \"@@ Uninstalling old install (if any) using 'helm uninstall $TRAEFIK_NAME -n $TRAEFIK_NAMESPACE'\"\n+  echo \"@@\"\n   helm uninstall $TRAEFIK_NAME -n $TRAEFIK_NAMESPACE\n+  echo \"@@ Creating traefik namespace '$TRAEFIK_NAMESPACE' and domain namepace '$DOMAIN_NAMESPACE'\"\n   kubectl create namespace $TRAEFIK_NAMESPACE\n   kubectl create namespace $DOMAIN_NAMESPACE\n   set -e\n \n   cd ${SRCDIR}\n \n+  echo \"@@ Installing traefik\"\n+\n   # you only need to add the repo once, but we do it every time for simplicity\n   helm repo add stable https://kubernetes-charts.storage.googleapis.com/\n \n+  set -x\n+\n   helm install ${TRAEFIK_NAME} stable/traefik \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDA5MzEwMQ=="}, "originalCommit": {"oid": "81b924154e59e9428c6b9dcdec3a5250606b5d8b"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ0NzQ1NA==", "bodyText": "Note: The interface to setup.sh will not change unless you want a non default Traefik version.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1803#discussion_r454447454", "createdAt": "2020-07-14T15:33:35Z", "author": {"login": "anpanigr"}, "path": "src/integration-tests/model-in-image/deploy-traefik.sh", "diffHunk": "@@ -49,32 +53,60 @@ set +e\n helm get values ${TRAEFIK_NAME} -n ${TRAEFIK_NAMESPACE} > $WORKDIR/test-out/traefik-values.cur 2>&1\n res=$?\n set -e\n-echo ${DOMAIN_NAMESPACE} >> $WORKDIR/test-out/traefik-values.cur\n+for evar in DOMAIN_NAMESPACE TRAEFIK_NAMESPACE TRAEFIK_NAME TRAEFIK_HTTP_NODEPORT TRAEFIK_HTTPS_NODEPORT; do\n+  echo \"${evar}=${!evar}\" >> $WORKDIR/test-out/traefik-values.cur\n+done\n if [ $res -eq 0 ] \\\n    && [ -e \"$WORKDIR/test-out/traefik-values.orig\" ] \\\n    && [ \"$(cat $WORKDIR/test-out/traefik-values.cur)\" = \"$(cat $WORKDIR/test-out/traefik-values.orig)\" ]; then\n   echo \"@@\"\n-  echo \"@@ Traefik already installed. Skipping uninstall/install.\"\n+  echo \"@@ Traefik already installed. Skipping uninstall/install. Current values:\"\n+  cat $WORKDIR/test-out/traefik-values.orig\n   echo \"@@\"\n else\n   set +e\n+  echo \"@@\"\n+  echo \"@@ Uninstalling old install (if any) using 'helm uninstall $TRAEFIK_NAME -n $TRAEFIK_NAMESPACE'\"\n+  echo \"@@\"\n   helm uninstall $TRAEFIK_NAME -n $TRAEFIK_NAMESPACE\n+  echo \"@@ Creating traefik namespace '$TRAEFIK_NAMESPACE' and domain namepace '$DOMAIN_NAMESPACE'\"\n   kubectl create namespace $TRAEFIK_NAMESPACE\n   kubectl create namespace $DOMAIN_NAMESPACE\n   set -e\n \n   cd ${SRCDIR}\n \n+  echo \"@@ Installing traefik\"\n+\n   # you only need to add the repo once, but we do it every time for simplicity\n   helm repo add stable https://kubernetes-charts.storage.googleapis.com/\n \n+  set -x\n+\n   helm install ${TRAEFIK_NAME} stable/traefik \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDA5MzEwMQ=="}, "originalCommit": {"oid": "81b924154e59e9428c6b9dcdec3a5250606b5d8b"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ2MzE5OQ==", "bodyText": "We will wire in setup.sh in a different pull, as discussed in the meeting.  Please approve if you're fine with this change.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1803#discussion_r454463199", "createdAt": "2020-07-14T15:56:24Z", "author": {"login": "tbarnes-us"}, "path": "src/integration-tests/model-in-image/deploy-traefik.sh", "diffHunk": "@@ -49,32 +53,60 @@ set +e\n helm get values ${TRAEFIK_NAME} -n ${TRAEFIK_NAMESPACE} > $WORKDIR/test-out/traefik-values.cur 2>&1\n res=$?\n set -e\n-echo ${DOMAIN_NAMESPACE} >> $WORKDIR/test-out/traefik-values.cur\n+for evar in DOMAIN_NAMESPACE TRAEFIK_NAMESPACE TRAEFIK_NAME TRAEFIK_HTTP_NODEPORT TRAEFIK_HTTPS_NODEPORT; do\n+  echo \"${evar}=${!evar}\" >> $WORKDIR/test-out/traefik-values.cur\n+done\n if [ $res -eq 0 ] \\\n    && [ -e \"$WORKDIR/test-out/traefik-values.orig\" ] \\\n    && [ \"$(cat $WORKDIR/test-out/traefik-values.cur)\" = \"$(cat $WORKDIR/test-out/traefik-values.orig)\" ]; then\n   echo \"@@\"\n-  echo \"@@ Traefik already installed. Skipping uninstall/install.\"\n+  echo \"@@ Traefik already installed. Skipping uninstall/install. Current values:\"\n+  cat $WORKDIR/test-out/traefik-values.orig\n   echo \"@@\"\n else\n   set +e\n+  echo \"@@\"\n+  echo \"@@ Uninstalling old install (if any) using 'helm uninstall $TRAEFIK_NAME -n $TRAEFIK_NAMESPACE'\"\n+  echo \"@@\"\n   helm uninstall $TRAEFIK_NAME -n $TRAEFIK_NAMESPACE\n+  echo \"@@ Creating traefik namespace '$TRAEFIK_NAMESPACE' and domain namepace '$DOMAIN_NAMESPACE'\"\n   kubectl create namespace $TRAEFIK_NAMESPACE\n   kubectl create namespace $DOMAIN_NAMESPACE\n   set -e\n \n   cd ${SRCDIR}\n \n+  echo \"@@ Installing traefik\"\n+\n   # you only need to add the repo once, but we do it every time for simplicity\n   helm repo add stable https://kubernetes-charts.storage.googleapis.com/\n \n+  set -x\n+\n   helm install ${TRAEFIK_NAME} stable/traefik \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDA5MzEwMQ=="}, "originalCommit": {"oid": "81b924154e59e9428c6b9dcdec3a5250606b5d8b"}, "originalPosition": 52}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4100, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}