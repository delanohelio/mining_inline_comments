{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3NTY1OTkz", "number": 1705, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTozNDowNlrOECnhAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTo1NzoxN1rOECoM6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMTgwMDM0OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTozNDowNlrOGfLxDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxODowNDoyMVrOGfRqOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1MTgyMA==", "bodyText": "need checks here - if secretName is empty string, it should not proceed further, error message needs to be logged...method can be renamed to getSecretOfServiceAccount", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1705#discussion_r435351820", "createdAt": "2020-06-04T15:34:06Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "diffHunk": "@@ -173,4 +177,63 @@ public static boolean scaleCluster(String domainUid, String namespace, String cl\n     return Kubernetes.patchDomainCustomResource(domainUid, namespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n   }\n \n+  /**\n+   * Scale the cluster of the domain in the specified namespace with REST API.\n+   *\n+   * @param domainUid domainUid of the domain to be scaled\n+   * @param clusterName name of the WebLogic cluster to be scaled in the domain\n+   * @param numOfServers number of servers to be scaled to\n+   * @param externalRestHttpsPort node port allocated for the external operator REST HTTPS interface\n+   * @param opNamespace namespace of WebLogic operator\n+   * @param opServiceAccount the service account for operator\n+   * @return true if REST call succeeds, false otherwise\n+   */\n+  public static boolean scaleClusterWithRestApi(String domainUid,\n+                                                String clusterName,\n+                                                int numOfServers,\n+                                                int externalRestHttpsPort,\n+                                                String opNamespace,\n+                                                String opServiceAccount) {\n+\n+    String secretName = Secret.getSecretFromServiceAccount(opNamespace, opServiceAccount);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc4421b0ccdea8527225c1f83db368c860654939"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM3NDI0Nw==", "bodyText": "add this comment\n//Get the service account token stored in secret to authenticate as the service account.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1705#discussion_r435374247", "createdAt": "2020-06-04T16:03:38Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "diffHunk": "@@ -173,4 +177,63 @@ public static boolean scaleCluster(String domainUid, String namespace, String cl\n     return Kubernetes.patchDomainCustomResource(domainUid, namespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n   }\n \n+  /**\n+   * Scale the cluster of the domain in the specified namespace with REST API.\n+   *\n+   * @param domainUid domainUid of the domain to be scaled\n+   * @param clusterName name of the WebLogic cluster to be scaled in the domain\n+   * @param numOfServers number of servers to be scaled to\n+   * @param externalRestHttpsPort node port allocated for the external operator REST HTTPS interface\n+   * @param opNamespace namespace of WebLogic operator\n+   * @param opServiceAccount the service account for operator\n+   * @return true if REST call succeeds, false otherwise\n+   */\n+  public static boolean scaleClusterWithRestApi(String domainUid,\n+                                                String clusterName,\n+                                                int numOfServers,\n+                                                int externalRestHttpsPort,\n+                                                String opNamespace,\n+                                                String opServiceAccount) {\n+\n+    String secretName = Secret.getSecretFromServiceAccount(opNamespace, opServiceAccount);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1MTgyMA=="}, "originalCommit": {"oid": "fc4421b0ccdea8527225c1f83db368c860654939"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQ0ODM3Ng==", "bodyText": "fixed", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1705#discussion_r435448376", "createdAt": "2020-06-04T18:04:21Z", "author": {"login": "xiancao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "diffHunk": "@@ -173,4 +177,63 @@ public static boolean scaleCluster(String domainUid, String namespace, String cl\n     return Kubernetes.patchDomainCustomResource(domainUid, namespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n   }\n \n+  /**\n+   * Scale the cluster of the domain in the specified namespace with REST API.\n+   *\n+   * @param domainUid domainUid of the domain to be scaled\n+   * @param clusterName name of the WebLogic cluster to be scaled in the domain\n+   * @param numOfServers number of servers to be scaled to\n+   * @param externalRestHttpsPort node port allocated for the external operator REST HTTPS interface\n+   * @param opNamespace namespace of WebLogic operator\n+   * @param opServiceAccount the service account for operator\n+   * @return true if REST call succeeds, false otherwise\n+   */\n+  public static boolean scaleClusterWithRestApi(String domainUid,\n+                                                String clusterName,\n+                                                int numOfServers,\n+                                                int externalRestHttpsPort,\n+                                                String opNamespace,\n+                                                String opServiceAccount) {\n+\n+    String secretName = Secret.getSecretFromServiceAccount(opNamespace, opServiceAccount);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1MTgyMA=="}, "originalCommit": {"oid": "fc4421b0ccdea8527225c1f83db368c860654939"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMTgzMjE5OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTozOTowMFrOGfMEuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxODowNDoyOVrOGfRqgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1Njg1Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                logger.info(\"Got secret {0} in operator namespace {1}\", secretName, opNamespace);\n          \n          \n            \n                logger.info(\"Got secret {0} associated with service account {1} in operator namespace {2}\", secretName, opServiceAccount, opNamespace);", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1705#discussion_r435356857", "createdAt": "2020-06-04T15:39:00Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "diffHunk": "@@ -173,4 +177,63 @@ public static boolean scaleCluster(String domainUid, String namespace, String cl\n     return Kubernetes.patchDomainCustomResource(domainUid, namespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n   }\n \n+  /**\n+   * Scale the cluster of the domain in the specified namespace with REST API.\n+   *\n+   * @param domainUid domainUid of the domain to be scaled\n+   * @param clusterName name of the WebLogic cluster to be scaled in the domain\n+   * @param numOfServers number of servers to be scaled to\n+   * @param externalRestHttpsPort node port allocated for the external operator REST HTTPS interface\n+   * @param opNamespace namespace of WebLogic operator\n+   * @param opServiceAccount the service account for operator\n+   * @return true if REST call succeeds, false otherwise\n+   */\n+  public static boolean scaleClusterWithRestApi(String domainUid,\n+                                                String clusterName,\n+                                                int numOfServers,\n+                                                int externalRestHttpsPort,\n+                                                String opNamespace,\n+                                                String opServiceAccount) {\n+\n+    String secretName = Secret.getSecretFromServiceAccount(opNamespace, opServiceAccount);\n+    logger.info(\"Got secret {0} in operator namespace {1}\", secretName, opNamespace);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc4421b0ccdea8527225c1f83db368c860654939"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQ0ODQ0OQ==", "bodyText": "fixed", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1705#discussion_r435448449", "createdAt": "2020-06-04T18:04:29Z", "author": {"login": "xiancao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "diffHunk": "@@ -173,4 +177,63 @@ public static boolean scaleCluster(String domainUid, String namespace, String cl\n     return Kubernetes.patchDomainCustomResource(domainUid, namespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n   }\n \n+  /**\n+   * Scale the cluster of the domain in the specified namespace with REST API.\n+   *\n+   * @param domainUid domainUid of the domain to be scaled\n+   * @param clusterName name of the WebLogic cluster to be scaled in the domain\n+   * @param numOfServers number of servers to be scaled to\n+   * @param externalRestHttpsPort node port allocated for the external operator REST HTTPS interface\n+   * @param opNamespace namespace of WebLogic operator\n+   * @param opServiceAccount the service account for operator\n+   * @return true if REST call succeeds, false otherwise\n+   */\n+  public static boolean scaleClusterWithRestApi(String domainUid,\n+                                                String clusterName,\n+                                                int numOfServers,\n+                                                int externalRestHttpsPort,\n+                                                String opNamespace,\n+                                                String opServiceAccount) {\n+\n+    String secretName = Secret.getSecretFromServiceAccount(opNamespace, opServiceAccount);\n+    logger.info(\"Got secret {0} in operator namespace {1}\", secretName, opNamespace);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM1Njg1Nw=="}, "originalCommit": {"oid": "fc4421b0ccdea8527225c1f83db368c860654939"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMTg2MjE3OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTo0NTowN1rOGfMXeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxODowNDozOVrOGfRq4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM2MTY1Nw==", "bodyText": "same as above", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1705#discussion_r435361657", "createdAt": "2020-06-04T15:45:07Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "diffHunk": "@@ -173,4 +177,63 @@ public static boolean scaleCluster(String domainUid, String namespace, String cl\n     return Kubernetes.patchDomainCustomResource(domainUid, namespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n   }\n \n+  /**\n+   * Scale the cluster of the domain in the specified namespace with REST API.\n+   *\n+   * @param domainUid domainUid of the domain to be scaled\n+   * @param clusterName name of the WebLogic cluster to be scaled in the domain\n+   * @param numOfServers number of servers to be scaled to\n+   * @param externalRestHttpsPort node port allocated for the external operator REST HTTPS interface\n+   * @param opNamespace namespace of WebLogic operator\n+   * @param opServiceAccount the service account for operator\n+   * @return true if REST call succeeds, false otherwise\n+   */\n+  public static boolean scaleClusterWithRestApi(String domainUid,\n+                                                String clusterName,\n+                                                int numOfServers,\n+                                                int externalRestHttpsPort,\n+                                                String opNamespace,\n+                                                String opServiceAccount) {\n+\n+    String secretName = Secret.getSecretFromServiceAccount(opNamespace, opServiceAccount);\n+    logger.info(\"Got secret {0} in operator namespace {1}\", secretName, opNamespace);\n+\n+    String secretToken = Secret.getSecretEncodedToken(opNamespace, secretName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc4421b0ccdea8527225c1f83db368c860654939"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQ0ODU0Ng==", "bodyText": "fixed", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1705#discussion_r435448546", "createdAt": "2020-06-04T18:04:39Z", "author": {"login": "xiancao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/Domain.java", "diffHunk": "@@ -173,4 +177,63 @@ public static boolean scaleCluster(String domainUid, String namespace, String cl\n     return Kubernetes.patchDomainCustomResource(domainUid, namespace, patch, V1Patch.PATCH_FORMAT_JSON_PATCH);\n   }\n \n+  /**\n+   * Scale the cluster of the domain in the specified namespace with REST API.\n+   *\n+   * @param domainUid domainUid of the domain to be scaled\n+   * @param clusterName name of the WebLogic cluster to be scaled in the domain\n+   * @param numOfServers number of servers to be scaled to\n+   * @param externalRestHttpsPort node port allocated for the external operator REST HTTPS interface\n+   * @param opNamespace namespace of WebLogic operator\n+   * @param opServiceAccount the service account for operator\n+   * @return true if REST call succeeds, false otherwise\n+   */\n+  public static boolean scaleClusterWithRestApi(String domainUid,\n+                                                String clusterName,\n+                                                int numOfServers,\n+                                                int externalRestHttpsPort,\n+                                                String opNamespace,\n+                                                String opServiceAccount) {\n+\n+    String secretName = Secret.getSecretFromServiceAccount(opNamespace, opServiceAccount);\n+    logger.info(\"Got secret {0} in operator namespace {1}\", secretName, opNamespace);\n+\n+    String secretToken = Secret.getSecretEncodedToken(opNamespace, secretName);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM2MTY1Nw=="}, "originalCommit": {"oid": "fc4421b0ccdea8527225c1f83db368c860654939"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMTkxMjc0OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/CommonTestUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTo1NzoxN1rOGfM4PQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxODowNDo0OVrOGfRrMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM3MDA0NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              /** Scale the WebLogic cluster to specified number of servers.\n          \n          \n            \n              /** \n          \n          \n            \n               * Scale the WebLogic cluster to specified number of servers.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1705#discussion_r435370045", "createdAt": "2020-06-04T15:57:17Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/CommonTestUtils.java", "diffHunk": "@@ -741,6 +775,42 @@ public static void scaleAndVerifyCluster(String clusterName,\n                                            String curlCmd,\n                                            List<String> expectedServerNames) {\n \n+    scaleAndVerifyCluster(clusterName, domainUid, domainNamespace, manageServerPodNamePrefix, replicasBeforeScale,\n+        replicasAfterScale, false, 0, \"\", \"\", curlCmd, expectedServerNames);\n+  }\n+\n+  /** Scale the WebLogic cluster to specified number of servers.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fc4421b0ccdea8527225c1f83db368c860654939"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQ0ODYyNw==", "bodyText": "fixed", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1705#discussion_r435448627", "createdAt": "2020-06-04T18:04:49Z", "author": {"login": "xiancao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/CommonTestUtils.java", "diffHunk": "@@ -741,6 +775,42 @@ public static void scaleAndVerifyCluster(String clusterName,\n                                            String curlCmd,\n                                            List<String> expectedServerNames) {\n \n+    scaleAndVerifyCluster(clusterName, domainUid, domainNamespace, manageServerPodNamePrefix, replicasBeforeScale,\n+        replicasAfterScale, false, 0, \"\", \"\", curlCmd, expectedServerNames);\n+  }\n+\n+  /** Scale the WebLogic cluster to specified number of servers.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM3MDA0NQ=="}, "originalCommit": {"oid": "fc4421b0ccdea8527225c1f83db368c860654939"}, "originalPosition": 92}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4300, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}