{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3MzE3NzUw", "number": 1752, "title": "Fix build application utility", "bodyText": "The fix involves\n\n\nRemoving the persistent volumes for mounting application source directory  to the pod , since PV_ROOT is shared only between the Kubernetes nodes. Jenkins client doesn't have access to the PV_ROOT  so its not working in Jenkins runs.\n\n\nInstead of a Kubernetes job the utility will create a WebLogic pod and copies the source application folder to the pod and builds the application.\n\n\nOnce built the archives directory is copied back to the local file system for use by the test code.\n\n\nResults\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-model-in-image-tests/1032\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/493/testReport/oracle.weblogic.kubernetes/", "createdAt": "2020-06-19T22:25:36Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1752", "merged": true, "mergeCommit": {"oid": "4d149250744a6813b2d956e6dc938f1083c61732"}, "closed": true, "closedAt": "2020-06-23T14:35:57Z", "author": {"login": "sankarpn"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcs588FAH2gAyNDM3MzE3NzUwOmMwNDE2MDg5NjI4ZWUyZjgyNGU0NjI3Y2QxZTI0N2JkODJlZDJhNzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABct4yAtgFqTQzNTMyMjU4NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c0416089628ee2f824e4627cd1e247bd82ed2a79", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c0416089628ee2f824e4627cd1e247bd82ed2a79", "committedDate": "2020-06-19T21:29:54Z", "message": "Fixed the build application utility\n\nThe fix involves\nRemoving the persistent volumes for mounting application source directory\nto the pod , since PV_ROOT is shared only between the Kubernetes nodes and\nJenkins client doesn't have access to the PV_ROOT\n\nInstead of a Kubernetes job the utility will create a WebLogic pod and copies\nthe source application folder to the pod and builds the application.\n\nOnce built the archives directory is copied back to the local file system\nfor use by the test code."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80674faa27b21f7fafb00055c4efba1af466c493", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/80674faa27b21f7fafb00055c4efba1af466c493", "committedDate": "2020-06-19T22:20:56Z", "message": "Fix javadoc and cleanup comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c694f0c4d7cb4361927debc852ec9c4cd964cc3b", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c694f0c4d7cb4361927debc852ec9c4cd964cc3b", "committedDate": "2020-06-20T01:01:45Z", "message": "Handle the javax.net.ssl.SSLProtocolException: Connection or outbound has\nbeen closed exception when copying files from/to pod."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MTk2MjUw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1752#pullrequestreview-435196250", "createdAt": "2020-06-22T19:03:10Z", "commit": {"oid": "c694f0c4d7cb4361927debc852ec9c4cd964cc3b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxOTowMzoxMFrOGnNUkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQxOTowMzoxMFrOGnNUkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc2NTkwNQ==", "bodyText": "Can we just copy the ear/war file to WORK_DIR/your_application_name? /u01 is generally in the pod for our weblogic servers. So, it is a bit confusing.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1752#discussion_r443765905", "createdAt": "2020-06-22T19:03:10Z", "author": {"login": "bhavaniravichandran"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -75,233 +52,176 @@\n \n   private static String image;\n   private static boolean isUseSecret;\n-  private static final String APPLICATIONS_MOUNT_PATH = \"/application\";\n-  private static final String SCRIPTS_MOUNT_PATH = \"/buildScripts\";\n+  private static final String APPLICATIONS_PATH = \"/u01/application\";\n   private static final String BUILD_SCRIPT = \"build_application.sh\";\n   private static final Path BUILD_SCRIPT_SOURCE_PATH = Paths.get(RESOURCE_DIR, \"bash-scripts\", BUILD_SCRIPT);\n \n-  private static final ConditionFactory withStandardRetryPolicy\n-      = with().pollDelay(2, SECONDS)\n-          .and().with().pollInterval(10, SECONDS)\n-          .atMost(5, MINUTES).await();\n-\n   /**\n    * Build application.\n    *\n-   * @param application path of the application source folder\n-   * @param parameters system properties for ant\n-   * @param targets ant targets to call\n-   * @param namespace name of the namespace to use for pvc\n+   * <p>The appSrcPath, your application source directory is zipped up and copied to a WebLogic server pod for building.\n+   * The application is built under /u01/application inside the pod. If your archives are placed under\n+   * /u01/application/build after building, use <b>build</b> as the archiveDistDir param value. This method copies the\n+   * folder /u01/application/<b>archiveDistDir</b> to local file system under\n+   * WORK_DIR/<b>your_application_name</b>/u01/application/<b>archiveDistDir</b>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c694f0c4d7cb4361927debc852ec9c4cd964cc3b"}, "originalPosition": 94}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16a22133c36c1433e845366b44aaa5afdab5a0c2", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/16a22133c36c1433e845366b44aaa5afdab5a0c2", "committedDate": "2020-06-22T19:50:28Z", "message": "Return the entire path instead of a partial path to the build directory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f0e4077738a6cde4223a02e8316e8a025349344", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3f0e4077738a6cde4223a02e8316e8a025349344", "committedDate": "2020-06-22T19:53:24Z", "message": "Fix the archive location of clusterview.war"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MjMwNjQ3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1752#pullrequestreview-435230647", "createdAt": "2020-06-22T19:58:54Z", "commit": {"oid": "3f0e4077738a6cde4223a02e8316e8a025349344"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MzIyNTg1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1752#pullrequestreview-435322585", "createdAt": "2020-06-22T22:41:59Z", "commit": {"oid": "3f0e4077738a6cde4223a02e8316e8a025349344"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4566, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}