{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NDM0NDUw", "number": 1636, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQyMjo0NzoyMFrOD7CC1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzoxOTowMVrOD7VPVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzMjI2MDY4OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/TestConstants.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQyMjo0NzoyMFrOGTIQsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNDo0NzoyNlrOGTfouA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxMTQ3Mg==", "bodyText": "The REPO_NAME will either be a value or empty, so please always add it.  We need this for the kind-based tests where there is no need for a REPO_USERNAME, but we do have a REPO_NAME.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r422711472", "createdAt": "2020-05-10T22:47:20Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/TestConstants.java", "diffHunk": "@@ -31,18 +33,34 @@\n       .orElse(REPO_DUMMY_VALUE);\n   public static final String REPO_EMAIL = Optional.ofNullable(System.getenv(\"REPO_EMAIL\"))\n       .orElse(REPO_DUMMY_VALUE);\n+\n+  // jenkins constants\n   public static final String BUILD_ID = Optional.ofNullable(System.getenv(\"BUILD_ID\"))\n       .orElse(\"\");\n   public static final String BRANCH_NAME_FROM_JENKINS = Optional.ofNullable(System.getenv(\"BRANCH\"))\n       .orElse(\"\");\n+\n   public static final String K8S_NODEPORT_HOST = Optional.ofNullable(System.getenv(\"K8S_NODEPORT_HOST\"))\n         .orElse(assertDoesNotThrow(() -> InetAddress.getLocalHost().getHostName()));\n   public static final String GOOGLE_REPO_URL = \"https://kubernetes-charts.storage.googleapis.com/\";\n   public static final String LOGS_DIR = System.getenv().getOrDefault(\"RESULT_ROOT\",\n       System.getProperty(\"java.io.tmpdir\")) + \"/diagnosticlogs\";\n   public static final String PV_ROOT = System.getenv().getOrDefault(\"PV_ROOT\",\n       System.getProperty(\"java.io.tmpdir\") + \"/ittestspvroot\");\n+\n+  // NGINX constants\n   public static final String NGINX_RELEASE_NAME = \"nginx-release\" + BUILD_ID;\n   public static final String STABLE_REPO_NAME = \"stable\";\n   public static final String NGINX_CHART_NAME = \"nginx-ingress\";\n+\n+  // MII image constants\n+  public static final String MII_BASIC_WDT_MODEL_FILE = \"model-basicdomain-singlecluster-sampleapp-wls.yaml\";\n+  public static final String MII_BASIC_IMAGE_NAME = REPO_USERNAME.equals(REPO_DUMMY_VALUE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "805ac92a37d0345716bc2605e47117d784db4873"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxMjM3NA==", "bodyText": "yes, I just noticed that...fixing and testing on kind jenkins job", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r422712374", "createdAt": "2020-05-10T22:55:46Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/TestConstants.java", "diffHunk": "@@ -31,18 +33,34 @@\n       .orElse(REPO_DUMMY_VALUE);\n   public static final String REPO_EMAIL = Optional.ofNullable(System.getenv(\"REPO_EMAIL\"))\n       .orElse(REPO_DUMMY_VALUE);\n+\n+  // jenkins constants\n   public static final String BUILD_ID = Optional.ofNullable(System.getenv(\"BUILD_ID\"))\n       .orElse(\"\");\n   public static final String BRANCH_NAME_FROM_JENKINS = Optional.ofNullable(System.getenv(\"BRANCH\"))\n       .orElse(\"\");\n+\n   public static final String K8S_NODEPORT_HOST = Optional.ofNullable(System.getenv(\"K8S_NODEPORT_HOST\"))\n         .orElse(assertDoesNotThrow(() -> InetAddress.getLocalHost().getHostName()));\n   public static final String GOOGLE_REPO_URL = \"https://kubernetes-charts.storage.googleapis.com/\";\n   public static final String LOGS_DIR = System.getenv().getOrDefault(\"RESULT_ROOT\",\n       System.getProperty(\"java.io.tmpdir\")) + \"/diagnosticlogs\";\n   public static final String PV_ROOT = System.getenv().getOrDefault(\"PV_ROOT\",\n       System.getProperty(\"java.io.tmpdir\") + \"/ittestspvroot\");\n+\n+  // NGINX constants\n   public static final String NGINX_RELEASE_NAME = \"nginx-release\" + BUILD_ID;\n   public static final String STABLE_REPO_NAME = \"stable\";\n   public static final String NGINX_CHART_NAME = \"nginx-ingress\";\n+\n+  // MII image constants\n+  public static final String MII_BASIC_WDT_MODEL_FILE = \"model-basicdomain-singlecluster-sampleapp-wls.yaml\";\n+  public static final String MII_BASIC_IMAGE_NAME = REPO_USERNAME.equals(REPO_DUMMY_VALUE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxMTQ3Mg=="}, "originalCommit": {"oid": "805ac92a37d0345716bc2605e47117d784db4873"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzA5NDQ1Ng==", "bodyText": "done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r423094456", "createdAt": "2020-05-11T14:47:26Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/TestConstants.java", "diffHunk": "@@ -31,18 +33,34 @@\n       .orElse(REPO_DUMMY_VALUE);\n   public static final String REPO_EMAIL = Optional.ofNullable(System.getenv(\"REPO_EMAIL\"))\n       .orElse(REPO_DUMMY_VALUE);\n+\n+  // jenkins constants\n   public static final String BUILD_ID = Optional.ofNullable(System.getenv(\"BUILD_ID\"))\n       .orElse(\"\");\n   public static final String BRANCH_NAME_FROM_JENKINS = Optional.ofNullable(System.getenv(\"BRANCH\"))\n       .orElse(\"\");\n+\n   public static final String K8S_NODEPORT_HOST = Optional.ofNullable(System.getenv(\"K8S_NODEPORT_HOST\"))\n         .orElse(assertDoesNotThrow(() -> InetAddress.getLocalHost().getHostName()));\n   public static final String GOOGLE_REPO_URL = \"https://kubernetes-charts.storage.googleapis.com/\";\n   public static final String LOGS_DIR = System.getenv().getOrDefault(\"RESULT_ROOT\",\n       System.getProperty(\"java.io.tmpdir\")) + \"/diagnosticlogs\";\n   public static final String PV_ROOT = System.getenv().getOrDefault(\"PV_ROOT\",\n       System.getProperty(\"java.io.tmpdir\") + \"/ittestspvroot\");\n+\n+  // NGINX constants\n   public static final String NGINX_RELEASE_NAME = \"nginx-release\" + BUILD_ID;\n   public static final String STABLE_REPO_NAME = \"stable\";\n   public static final String NGINX_CHART_NAME = \"nginx-ingress\";\n+\n+  // MII image constants\n+  public static final String MII_BASIC_WDT_MODEL_FILE = \"model-basicdomain-singlecluster-sampleapp-wls.yaml\";\n+  public static final String MII_BASIC_IMAGE_NAME = REPO_USERNAME.equals(REPO_DUMMY_VALUE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxMTQ3Mg=="}, "originalCommit": {"oid": "805ac92a37d0345716bc2605e47117d784db4873"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNTIyNDM0OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/ImageBuilders.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNjozMTozOFrOGTkCJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzoxMjozM1rOGTlk7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE2NjUwMw==", "bodyText": "@vanajamukkara Did you test this ? when does this method gets invoked, at the end of the first class that creates the image or at the end of the last class that executes ?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r423166503", "createdAt": "2020-05-11T16:31:38Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/ImageBuilders.java", "diffHunk": "@@ -84,5 +120,64 @@ public void beforeAll(ExtensionContext context) {\n   @Override\n   public void close() {\n     logger.info(\"Cleanup images after all test suites are run\");\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "originalPosition": 95}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE4MDM1Mg==", "bodyText": "yes, its getting executed at the very end of the last class. https://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-model-in-image-tests-10/50/consoleFull", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r423180352", "createdAt": "2020-05-11T16:54:05Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/ImageBuilders.java", "diffHunk": "@@ -84,5 +120,64 @@ public void beforeAll(ExtensionContext context) {\n   @Override\n   public void close() {\n     logger.info(\"Cleanup images after all test suites are run\");\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE2NjUwMw=="}, "originalCommit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "originalPosition": 95}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE5MTc5MA==", "bodyText": "Great", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r423191790", "createdAt": "2020-05-11T17:12:33Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/ImageBuilders.java", "diffHunk": "@@ -84,5 +120,64 @@ public void beforeAll(ExtensionContext context) {\n   @Override\n   public void close() {\n     logger.info(\"Cleanup images after all test suites are run\");\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE2NjUwMw=="}, "originalCommit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "originalPosition": 95}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYzNTQwNTY2OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/ImageBuilders.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzoxOTowMVrOGTl0xQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxOTowMToxOVrOGTpWog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE5NTg0NQ==", "bodyText": "can you log this as a message?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r423195845", "createdAt": "2020-05-11T17:19:01Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/ImageBuilders.java", "diffHunk": "@@ -84,5 +120,64 @@ public void beforeAll(ExtensionContext context) {\n   @Override\n   public void close() {\n     logger.info(\"Cleanup images after all test suites are run\");\n+\n+    // delete mii basic image\n+    if (miiBasicImage != null) {\n+      deleteImage(miiBasicImage);\n+    }\n+\n+    // delete operator image\n+    if (operatorImage != null) {\n+      deleteImage(operatorImage);\n+    }\n+\n+  }\n+\n+  /**\n+   * Create image with basic domain model yaml and sample app.\n+   * @param imageName name of the image\n+   * @param imageTag tag of the image\n+   * @return true if image is created successfully\n+   */\n+  private boolean createMiiBasicImage(String imageName, String imageTag) {\n+\n+    final String image = imageName + \":\" + imageTag;\n+\n+    // build the model file list\n+    final List<String> modelList = Collections.singletonList(MODEL_DIR + \"/\" + MII_BASIC_WDT_MODEL_FILE);\n+\n+    // build an application archive using what is in resources/apps/APP_NAME", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzI1MzY2Ng==", "bodyText": "done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r423253666", "createdAt": "2020-05-11T19:01:19Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/ImageBuilders.java", "diffHunk": "@@ -84,5 +120,64 @@ public void beforeAll(ExtensionContext context) {\n   @Override\n   public void close() {\n     logger.info(\"Cleanup images after all test suites are run\");\n+\n+    // delete mii basic image\n+    if (miiBasicImage != null) {\n+      deleteImage(miiBasicImage);\n+    }\n+\n+    // delete operator image\n+    if (operatorImage != null) {\n+      deleteImage(operatorImage);\n+    }\n+\n+  }\n+\n+  /**\n+   * Create image with basic domain model yaml and sample app.\n+   * @param imageName name of the image\n+   * @param imageTag tag of the image\n+   * @return true if image is created successfully\n+   */\n+  private boolean createMiiBasicImage(String imageName, String imageTag) {\n+\n+    final String image = imageName + \":\" + imageTag;\n+\n+    // build the model file list\n+    final List<String> modelList = Collections.singletonList(MODEL_DIR + \"/\" + MII_BASIC_WDT_MODEL_FILE);\n+\n+    // build an application archive using what is in resources/apps/APP_NAME", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE5NTg0NQ=="}, "originalCommit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "originalPosition": 121}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4535, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}