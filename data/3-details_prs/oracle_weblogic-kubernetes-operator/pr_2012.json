{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEwNzE5MDkx", "number": 2012, "title": "OWLS85461 add introspect version to server pod label", "bodyText": "Add a new label to server pods with unit test cases.\nUpdate the public doc.\nsome cleanup.\n\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/2691/\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/2693/", "createdAt": "2020-10-27T12:33:01Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012", "merged": true, "mergeCommit": {"oid": "f940ac6ed95956b1538f1ea312b37efa9312ac40"}, "closed": true, "closedAt": "2020-10-27T21:45:03Z", "author": {"login": "doxiao"}, "timelineItems": {"totalCount": 31, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVWy4eAH2gAyNTEwNzE5MDkxOmQ4ZGMxYTdiN2IwYTc3YWEwZGE5YmZhOTUwOTJkMDc2YzgyYjJhNzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWwBKegH2gAyNTEwNzE5MDkxOmUyYmQ4ZmE3YWU3OTQ1OTg4Njc5ZTQ0NWQ2YjI4MzA4OWJkMmZkNDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d8dc1a7b7b0a77aa0da9bfa95092d076c82b2a74", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d8dc1a7b7b0a77aa0da9bfa95092d076c82b2a74", "committedDate": "2020-10-23T13:43:08Z", "message": "initial changes to add introspect version to pod labels"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46bb990ba30944301cf553b43e090faa21a3b07d", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/46bb990ba30944301cf553b43e090faa21a3b07d", "committedDate": "2020-10-23T17:53:53Z", "message": "work in progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a900afafcbe52ec912887214141859a6dfe6e593", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a900afafcbe52ec912887214141859a6dfe6e593", "committedDate": "2020-10-26T02:24:37Z", "message": "work in progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad4be5622e4f6f0d4602fb10cc30403b3e353c49", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ad4be5622e4f6f0d4602fb10cc30403b3e353c49", "committedDate": "2020-10-26T14:08:26Z", "message": "cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d7ce38c0c4ac946af45553d7c504c7e59821c51", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4d7ce38c0c4ac946af45553d7c504c7e59821c51", "committedDate": "2020-10-26T14:12:22Z", "message": "fix unit test failure in PodWatcherTest not related to this PR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d9bb16c1fdbbef3ba6751ad38b6556516fc10ef", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6d9bb16c1fdbbef3ba6751ad38b6556516fc10ef", "committedDate": "2020-10-26T20:38:23Z", "message": "minor changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5501a1b7f54ca640e3810d979b93d09be2aecb66", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5501a1b7f54ca640e3810d979b93d09be2aecb66", "committedDate": "2020-10-26T20:53:17Z", "message": "doc changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc78fc7d9cfd325080f458b28698ed58f347d57c", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/cc78fc7d9cfd325080f458b28698ed58f347d57c", "committedDate": "2020-10-26T21:28:26Z", "message": "add an example in the doc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9d3c1d0a917f86aa0407a3cddb8be5038125f924", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/9d3c1d0a917f86aa0407a3cddb8be5038125f924", "committedDate": "2020-10-27T12:30:37Z", "message": "Merge remote-tracking branch 'origin/develop' into add-introspect-version-label"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NjY5NTI4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-517669528", "createdAt": "2020-10-27T12:55:17Z", "commit": {"oid": "9d3c1d0a917f86aa0407a3cddb8be5038125f924"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMjo1NToxN1rOHo6vJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxMzoyMzoyMVrOHo75qA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY2NzQyOA==", "bodyText": "Starting from operator 3.1.0 -> Beginning with operator 3.1.0\nthat the pod is running at -> at which the pod is running", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512667428", "createdAt": "2020-10-27T12:55:17Z", "author": {"login": "rosemarymarano"}, "path": "docs-source/content/userguide/managing-domains/domain-lifecycle/introspection.md", "diffHunk": "@@ -44,6 +44,21 @@ Set `introspectVersion` to a new value.\n \n As with `restartVersion`, the `introspectVersion` field has no required format; however, we recommend using a value likely to be unique such as a continually increasing number or a timestamp.\n \n+Starting from operator 3.1.0, if a domain resource's `spec.introspectVersion` is set, each of the domain's WebLogic Server pods will have a label with the key `weblogic.IntrospectVersion` to indicate the `introspectVersion` that the pod is running at.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d3c1d0a917f86aa0407a3cddb8be5038125f924"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY3MzA0OQ==", "bodyText": "value either -> value, either (comma here)\nthe pod, or when -> the pod or when (no comma here)", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512673049", "createdAt": "2020-10-27T13:03:52Z", "author": {"login": "rosemarymarano"}, "path": "docs-source/content/userguide/managing-domains/domain-lifecycle/introspection.md", "diffHunk": "@@ -44,6 +44,21 @@ Set `introspectVersion` to a new value.\n \n As with `restartVersion`, the `introspectVersion` field has no required format; however, we recommend using a value likely to be unique such as a continually increasing number or a timestamp.\n \n+Starting from operator 3.1.0, if a domain resource's `spec.introspectVersion` is set, each of the domain's WebLogic Server pods will have a label with the key `weblogic.IntrospectVersion` to indicate the `introspectVersion` that the pod is running at.\n+\n+```\n+Name:           domain1-admin-server\n+Namespace:      domain1-ns\n+Priority:       0\n+Labels:         weblogic.createdByOperator=true\n+                weblogic.domainName=domain1\n+                weblogic.domainUID=domain1\n+                weblogic.introspectVersion=12345\n+                weblogic.serverName=admin-server\n+```\n+\n+When a domain's `spec.intrsopectVersion` is changed, the `weblogic.introspectVersion` label of each WebLogic Server pod is updated to the new `introspectVersion` value either when the operator restarts the pod, or when the operator determines that the pod does not need to be restarted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d3c1d0a917f86aa0407a3cddb8be5038125f924"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjY4NjUwNA==", "bodyText": "[initiate introspection] ->[Initiating introspection]\nSee also overridesConfigurationStrategy. -> I do not see overridesConfigurationStrategy on this page.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512686504", "createdAt": "2020-10-27T13:23:21Z", "author": {"login": "rosemarymarano"}, "path": "docs-source/content/userguide/managing-domains/domain-resource.md", "diffHunk": "@@ -161,7 +161,7 @@ Elements related to domain [startup and shutdown]({{< relref \"/userguide/managin\n * `replicas`: The default number of cluster member Managed Server instances to start for each WebLogic cluster in the domain configuration, unless `replicas` is specified for that cluster under the `clusters` field. For each cluster, the operator will sort cluster member Managed Server names from the WebLogic domain configuration by normalizing any numbers in the Managed Server name and then sorting alphabetically. This is done so that server names such as \"managed-server10\" come after \"managed-server9\". The operator will then start Managed Servers from the sorted list, up to the `replicas` count, unless specific Managed Servers are specified as starting in their entry under the `managedServers` field. In that case, the specified Managed Servers will be started and then additional cluster members will be started, up to the `replicas` count, by finding further cluster members in the sorted list that are not already started. If cluster members are started because of their entries under `managedServers`, then a cluster may have more cluster members running than its `replicas` count. Defaults to 0.\n * `maxClusterConcurrentStartup`: The maximum number of cluster member Managed Server instances that the operator will start in parallel for a given cluster, if `maxConcurrentStartup` is not specified for a specific cluster under the `clusters` field. A value of 0 means there is no configured limit. Defaults to 0.\n * `allowReplicasBelowMinDynClusterSize`: Whether to allow the number of running cluster member Managed Server instances to drop below the minimum dynamic cluster size configured in the WebLogic domain configuration, if this is not specified for a specific cluster under the `clusters` field. Defaults to true.\n-* `introspectVersion`: Changes to this field cause the operator to repeat its introspection of the WebLogic domain configuration. Repeating introspection is required for the operator to recognize changes to the domain configuration, such as adding a new WebLogic cluster or Managed Server instance, to regenerate configuration overrides, or to regenerate the WebLogic domain home when the `domainHomeSourceType` is FromModel. Introspection occurs automatically, without requiring change to this field, when servers are first started or restarted after a full domain shut down. For the FromModel `domainHomeSourceType`, introspection also occurs when a running server must be restarted because of changes to any of the fields [listed here]({{< relref \"/userguide/managing-domains/domain-lifecycle/startup#fields-that-cause-servers-to-be-restarted\" >}}). See also `overridesConfigurationStrategy`.\n+* `introspectVersion`: Changes to this field cause the operator to repeat its introspection of the WebLogic domain configuration (see [initiate introspection]({{< relref \"/userguide/managing-domains/domain-lifecycle/introspection/_index.md#initiating-introspection\" >}})). Repeating introspection is required for the operator to recognize changes to the domain configuration, such as adding a new WebLogic cluster or Managed Server instance, to regenerate configuration overrides, or to regenerate the WebLogic domain home when the `domainHomeSourceType` is FromModel. Introspection occurs automatically, without requiring change to this field, when servers are first started or restarted after a full domain shut down. For the FromModel `domainHomeSourceType`, introspection also occurs when a running server must be restarted because of changes to any of the fields [listed here]({{< relref \"/userguide/managing-domains/domain-lifecycle/startup#fields-that-cause-servers-to-be-restarted\" >}}). See also `overridesConfigurationStrategy`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d3c1d0a917f86aa0407a3cddb8be5038125f924"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eef06c56df8c07216148bcde5b2e3053fb33c874", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/eef06c56df8c07216148bcde5b2e3053fb33c874", "committedDate": "2020-10-27T14:28:17Z", "message": "doc edits to address review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f65501687cd567c1bf099e3cb6dd043aa0a541de", "committedDate": "2020-10-27T14:47:50Z", "message": "Merge remote-tracking branch 'origin/develop' into add-introspect-version-label"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3NzkyODU0", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-517792854", "createdAt": "2020-10-27T14:50:33Z", "commit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNDo1MDozM1rOHpAUYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNDo1MDozM1rOHpAUYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc1ODg4Mw==", "bodyText": "intrsopectVersion --> introspectVersion", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512758883", "createdAt": "2020-10-27T14:50:33Z", "author": {"login": "tbarnes-us"}, "path": "docs-source/content/userguide/managing-domains/domain-lifecycle/introspection.md", "diffHunk": "@@ -57,7 +57,7 @@ Labels:         weblogic.createdByOperator=true\n                 weblogic.serverName=admin-server\n ```\n \n-When a domain's `spec.intrsopectVersion` is changed, the `weblogic.introspectVersion` label of each WebLogic Server pod is updated to the new `introspectVersion` value either when the operator restarts the pod, or when the operator determines that the pod does not need to be restarted.\n+When a domain's `spec.intrsopectVersion` is changed, the `weblogic.introspectVersion` label of each WebLogic Server pod is updated to the new `introspectVersion` value, either when the operator restarts the pod or when the operator determines that the pod does not need to be restarted.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3ODAzMzI2", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-517803326", "createdAt": "2020-10-27T14:59:35Z", "commit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNDo1OTozNVrOHpAymg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNDo1OTozNVrOHpAymg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc2NjYxOA==", "bodyText": "Please reference the exact name/location of the namespace strategy setting and expand the CRD acronym to something like - Custom Resource for Domains (CRD)", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512766618", "createdAt": "2020-10-27T14:59:35Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/Operator.properties", "diffHunk": "@@ -189,6 +189,7 @@ WLSKO-0176=Job {1} in namespace {0} failed, job details are {2}\n WLSKO-0177=Pod {0} in namespace {1} failed, the pod status is {2}\n WLSKO-0178=Patching administration server Pod labels with ''weblogic.introspectVersion'' {2} for WebLogic domain with UID: {0}. Administration server name: {1}.\n WLSKO-0179=Patching managed server Pod labels with ''weblogic.introspectVersion'' {2} for WebLogic domain with UID: {0}. Managed server name: {1}.\n+WLSKO-0180=Operator cannot start. 'Dedicated' namespace strategy selected, but the CRD is not installed", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3ODA1OTI1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-517805925", "createdAt": "2020-10-27T15:01:49Z", "commit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTowMTo0OVrOHpA6ZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTowMTo0OVrOHpA6ZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc2ODYxMw==", "bodyText": "restartVersion?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512768613", "createdAt": "2020-10-27T15:01:49Z", "author": {"login": "tbarnes-us"}, "path": "docs-source/content/userguide/managing-domains/domain-lifecycle/introspection.md", "diffHunk": "@@ -44,6 +44,21 @@ Set `introspectVersion` to a new value.\n \n As with `restartVersion`, the `introspectVersion` field has no required format; however, we recommend using a value likely to be unique such as a continually increasing number or a timestamp.\n \n+Beginning with operator 3.1.0, if a domain resource's `spec.introspectVersion` is set, each of the domain's WebLogic Server pods will have a label with the key `weblogic.IntrospectVersion` to indicate the `introspectVersion` at which the pod is running.\n+\n+```\n+Name:           domain1-admin-server\n+Namespace:      domain1-ns\n+Priority:       0\n+Labels:         weblogic.createdByOperator=true\n+                weblogic.domainName=domain1\n+                weblogic.domainUID=domain1\n+                weblogic.introspectVersion=12345\n+                weblogic.serverName=admin-server", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3ODA2NjAy", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-517806602", "createdAt": "2020-10-27T15:02:25Z", "commit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTowMjoyNlrOHpA8Og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTowMjoyNlrOHpA8Og==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc2OTA4Mg==", "bodyText": "weblogic.IntrospectVersion --> weblogic.introspectVersion", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512769082", "createdAt": "2020-10-27T15:02:26Z", "author": {"login": "tbarnes-us"}, "path": "docs-source/content/userguide/managing-domains/domain-lifecycle/introspection.md", "diffHunk": "@@ -44,6 +44,21 @@ Set `introspectVersion` to a new value.\n \n As with `restartVersion`, the `introspectVersion` field has no required format; however, we recommend using a value likely to be unique such as a continually increasing number or a timestamp.\n \n+Beginning with operator 3.1.0, if a domain resource's `spec.introspectVersion` is set, each of the domain's WebLogic Server pods will have a label with the key `weblogic.IntrospectVersion` to indicate the `introspectVersion` at which the pod is running.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3ODExMzk5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-517811399", "createdAt": "2020-10-27T15:06:41Z", "commit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTowNjo0MVrOHpBKOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTowNjo0MVrOHpBKOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc3MjY2NA==", "bodyText": "Minor minor nit: combine repeated patch string concatenation code into a single local variable...", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512772664", "createdAt": "2020-10-27T15:06:41Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -364,6 +366,24 @@ protected Step patchPod(V1Pod currentPod, Step next) {\n             new V1Patch(patchBuilder.build().toString()), patchResponse(next));\n   }\n \n+  private Step updateCurrentPod(V1Pod currentPod, Step next) {\n+    return createProgressingStep(updatePod(currentPod, next));\n+  }\n+\n+  protected Step updatePod(V1Pod currentPod, Step next) {\n+    JsonPatchBuilder patchBuilder = Json.createPatchBuilder();\n+    String baseName = \"/metadata/labels/\";\n+    if (!getPodLabels().containsKey(INTROSPECTION_STATE_LABEL)) {\n+      patchBuilder.add(baseName + INTROSPECTION_STATE_LABEL, getDomain().getSpec().getIntrospectVersion());\n+    } else {\n+      patchBuilder.replace(baseName + INTROSPECTION_STATE_LABEL, getDomain().getSpec().getIntrospectVersion());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3ODYwMjUw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-517860250", "createdAt": "2020-10-27T15:48:12Z", "commit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTo0ODoxMlrOHpDYjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNTo0ODoxMlrOHpDYjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgwOTEwMw==", "bodyText": "There's a lot of overlap between the MANAGED/ADMIN _ POD_ PATCHED/CREATED/REPLACED/EXISTS log messages at KO-0120/0121/0041/0042/0043/0050/0051/0052.\nIMO, they should be aligned since that would simplify tracing pod transitions.  Something like:\nAction on pod ''{0}'' of type ''managed server/adminstration server'', operation ''patched/created/replaced/exists'', domain UID ''{1}'', label ''weblogic.introspectVersion''=''{2}'', label ''weblogic.restartVersion''=''{3}''.\n\nThey could remain separate log messages, or combined into a single log message that parameterizes the operation and server type.\nAlso, I suspect 'domain UID' is no longer needed since it's probably always reported in the log message's domain UID field...", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512809103", "createdAt": "2020-10-27T15:48:12Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/Operator.properties", "diffHunk": "@@ -187,6 +187,8 @@ WLSKO-0175=Job {0} in namespace {1} failed with status {2}. Check log messages \\\n   copied from the introspector pod {3} log for additional information.\n WLSKO-0176=Job {1} in namespace {0} failed, job details are {2}\n WLSKO-0177=Pod {0} in namespace {1} failed, the pod status is {2}\n+WLSKO-0178=Patching administration server Pod labels with ''weblogic.introspectVersion'' {2} for WebLogic domain with UID: {0}. Administration server name: {1}.\n+WLSKO-0179=Patching managed server Pod labels with ''weblogic.introspectVersion'' {2} for WebLogic domain with UID: {0}. Managed server name: {1}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f65501687cd567c1bf099e3cb6dd043aa0a541de"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "965b0935b45e994651f1da566b7bb82c12502a75", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/965b0935b45e994651f1da566b7bb82c12502a75", "committedDate": "2020-10-27T16:08:07Z", "message": "address review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dc1af7050c5e8b0a7311faf0f18940d455b3bcb", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0dc1af7050c5e8b0a7311faf0f18940d455b3bcb", "committedDate": "2020-10-27T16:16:16Z", "message": "cleanup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3OTIxNDQz", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-517921443", "createdAt": "2020-10-27T16:45:53Z", "commit": {"oid": "eef06c56df8c07216148bcde5b2e3053fb33c874"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNjo0NTo1NFrOHpGP5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNjo0NTo1NFrOHpGP5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjg1NjAzOA==", "bodyText": "[initiating introspection] -> [Initiating introspection] (capital \"I\" as in the section title.)", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512856038", "createdAt": "2020-10-27T16:45:54Z", "author": {"login": "rosemarymarano"}, "path": "docs-source/content/userguide/managing-domains/domain-resource.md", "diffHunk": "@@ -161,14 +161,14 @@ Elements related to domain [startup and shutdown]({{< relref \"/userguide/managin\n * `replicas`: The default number of cluster member Managed Server instances to start for each WebLogic cluster in the domain configuration, unless `replicas` is specified for that cluster under the `clusters` field. For each cluster, the operator will sort cluster member Managed Server names from the WebLogic domain configuration by normalizing any numbers in the Managed Server name and then sorting alphabetically. This is done so that server names such as \"managed-server10\" come after \"managed-server9\". The operator will then start Managed Servers from the sorted list, up to the `replicas` count, unless specific Managed Servers are specified as starting in their entry under the `managedServers` field. In that case, the specified Managed Servers will be started and then additional cluster members will be started, up to the `replicas` count, by finding further cluster members in the sorted list that are not already started. If cluster members are started because of their entries under `managedServers`, then a cluster may have more cluster members running than its `replicas` count. Defaults to 0.\n * `maxClusterConcurrentStartup`: The maximum number of cluster member Managed Server instances that the operator will start in parallel for a given cluster, if `maxConcurrentStartup` is not specified for a specific cluster under the `clusters` field. A value of 0 means there is no configured limit. Defaults to 0.\n * `allowReplicasBelowMinDynClusterSize`: Whether to allow the number of running cluster member Managed Server instances to drop below the minimum dynamic cluster size configured in the WebLogic domain configuration, if this is not specified for a specific cluster under the `clusters` field. Defaults to true.\n-* `introspectVersion`: Changes to this field cause the operator to repeat its introspection of the WebLogic domain configuration (see [initiate introspection]({{< relref \"/userguide/managing-domains/domain-lifecycle/introspection/_index.md#initiating-introspection\" >}})). Repeating introspection is required for the operator to recognize changes to the domain configuration, such as adding a new WebLogic cluster or Managed Server instance, to regenerate configuration overrides, or to regenerate the WebLogic domain home when the `domainHomeSourceType` is FromModel. Introspection occurs automatically, without requiring change to this field, when servers are first started or restarted after a full domain shut down. For the FromModel `domainHomeSourceType`, introspection also occurs when a running server must be restarted because of changes to any of the fields [listed here]({{< relref \"/userguide/managing-domains/domain-lifecycle/startup#fields-that-cause-servers-to-be-restarted\" >}}). See also `overridesConfigurationStrategy`.\n+* `introspectVersion`: Changes to this field cause the operator to repeat its introspection of the WebLogic domain configuration (see [initiating introspection]({{< relref \"/userguide/managing-domains/domain-lifecycle/introspection/_index.md#initiating-introspection\" >}})). Repeating introspection is required for the operator to recognize changes to the domain configuration, such as adding a new WebLogic cluster or Managed Server instance, to regenerate configuration overrides, or to regenerate the WebLogic domain home when the `domainHomeSourceType` is FromModel. Introspection occurs automatically, without requiring change to this field, when servers are first started or restarted after a full domain shut down. For the FromModel `domainHomeSourceType`, introspection also occurs when a running server must be restarted because of changes to any of the fields [listed here]({{< relref \"/userguide/managing-domains/domain-lifecycle/startup#fields-that-cause-servers-to-be-restarted\" >}}). See also `overridesConfigurationStrategy`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eef06c56df8c07216148bcde5b2e3053fb33c874"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3OTQ0ODIy", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-517944822", "createdAt": "2020-10-27T17:10:07Z", "commit": {"oid": "0dc1af7050c5e8b0a7311faf0f18940d455b3bcb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af1ad2e17636538236d43e842eb2e66b3691b420", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/af1ad2e17636538236d43e842eb2e66b3691b420", "committedDate": "2020-10-27T18:10:06Z", "message": "add domainRestartVersion to the example"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6f05b94cc67ed4af38ce7b4df245dce7231c9bf", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a6f05b94cc67ed4af38ce7b4df245dce7231c9bf", "committedDate": "2020-10-27T18:17:27Z", "message": "move the patch part into the existing patch step and remove log messages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5516e66c657461d7035a231453c31fb4bb8fb06", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d5516e66c657461d7035a231453c31fb4bb8fb06", "committedDate": "2020-10-27T18:23:22Z", "message": "minor doc edit"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4MDM5MDkz", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-518039093", "createdAt": "2020-10-27T18:54:00Z", "commit": {"oid": "d5516e66c657461d7035a231453c31fb4bb8fb06"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4MDUyODk4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-518052898", "createdAt": "2020-10-27T19:12:26Z", "commit": {"oid": "d5516e66c657461d7035a231453c31fb4bb8fb06"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxOToxMjoyNlrOHpMhKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxOToxMzo1M1rOHpMkRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjk1ODc2MA==", "bodyText": "This is still much more complex than is needed. Look at PodStepContext.createMetadata(). This is where we define the labels and annotations for server pods. To add a new label, all you need to do is define it there. The rest of the code will automatically handle detection of differences between what is supposed to be and what we find.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512958760", "createdAt": "2020-10-27T19:12:26Z", "author": {"login": "russgold"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/PodStepContext.java", "diffHunk": "@@ -359,6 +361,15 @@ protected Step patchPod(V1Pod currentPod, Step next) {\n     KubernetesUtils.addPatches(\n         patchBuilder, \"/metadata/annotations/\", getAnnotations(currentPod), getPodAnnotations());\n \n+    if (introspectVersionChanged(currentPod)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5516e66c657461d7035a231453c31fb4bb8fb06"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjk1OTU1Nw==", "bodyText": "Is there a particular reason to renumber this? I deliberately skipped some numbers to allow 178 and 179 for messages that seemed logically connected to the previous ones. Do we have a rule banning skipped numbers?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#discussion_r512959557", "createdAt": "2020-10-27T19:13:53Z", "author": {"login": "russgold"}, "path": "operator/src/main/resources/Operator.properties", "diffHunk": "@@ -187,7 +187,7 @@ WLSKO-0175=Job {0} in namespace {1} failed with status {2}. Check log messages \\\n   copied from the introspector pod {3} log for additional information.\n WLSKO-0176=Job {1} in namespace {0} failed, job details are {2}\n WLSKO-0177=Pod {0} in namespace {1} failed, the pod status is {2}\n-WLSKO-0180=Operator cannot start. 'Dedicated' namespace strategy selected, but the CRD is not installed\n+WLSKO-0178=Operator cannot start. Operator 'domainNamespaceSelectionStrategy' is set to 'Dedicated', but the Custom Resource Definition for ''domains.weblogic.oracle'' is not installed.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5516e66c657461d7035a231453c31fb4bb8fb06"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1d316c38a23d755aa6fc0d09ae629d4b3f6aa34", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f1d316c38a23d755aa6fc0d09ae629d4b3f6aa34", "committedDate": "2020-10-27T20:41:15Z", "message": "refactored a little"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4MTQ0OTg3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2012#pullrequestreview-518144987", "createdAt": "2020-10-27T20:57:57Z", "commit": {"oid": "f1d316c38a23d755aa6fc0d09ae629d4b3f6aa34"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca7d8c0b3f9423e08945469b4e675d8af11be05b", "author": {"user": {"login": "rjeberhard", "name": "Ryan Eberhard"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ca7d8c0b3f9423e08945469b4e675d8af11be05b", "committedDate": "2020-10-27T21:25:38Z", "message": "Correct overrideDistributionStrategy other places"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2bd8fa7ae7945988679e445d6b283089bd2fd46", "author": {"user": {"login": "rjeberhard", "name": "Ryan Eberhard"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e2bd8fa7ae7945988679e445d6b283089bd2fd46", "committedDate": "2020-10-27T21:40:17Z", "message": "Add correct the other misspelled field name"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4049, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}