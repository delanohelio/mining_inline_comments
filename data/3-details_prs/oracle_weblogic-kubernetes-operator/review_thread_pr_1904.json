{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc5ODE1Mjc3", "number": 1904, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNjowNDoyMVrOEgcXjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNjowNToxOVrOEgcY3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyNDU0NjcwOnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "isResolved": true, "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNjowNDoyMVrOHNTpWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNzo1NTowNFrOHNXFag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTQxOA==", "bodyText": "why can't the check be done in this method instead of changing all the calling It test classes?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483715418", "createdAt": "2020-09-04T16:04:21Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc0MjkxMw==", "bodyText": "The source application might build more than 1 archive and we don't know what file name it will be, so it is better to leave it to the It class to do that.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483742913", "createdAt": "2020-09-04T16:48:23Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTQxOA=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc1MDQ1NQ==", "bodyText": "what is the stderr when it returns non-zero on success?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483750455", "createdAt": "2020-09-04T17:05:16Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTQxOA=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc1MzU0OA==", "bodyText": "I see the stderr is empty when it returns non-zero code on success, how about checking for 0 exit value or (non-zero and stderr is empty) for success? on failure, stderr is not empty, is that correct?\nhttps://build.weblogick8s.org:8443/job/wko-kind-nightly/95/artifact/logdir/jenkins-wko-kind-nightly-95/wl_k8s_test_results/diagnosticlogs/ItCrossDomainTransaction/ItCrossDomainTransaction.out/*view*/", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483753548", "createdAt": "2020-09-04T17:12:30Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTQxOA=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc1OTI4Nw==", "bodyText": "I don't know if we can rely on that logic. IMO a simple assertion in the It class would be sufficient. Like this\nassertTrue(clusterViewAppPath.toFile().exists(), \"Application archive is not available\");", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483759287", "createdAt": "2020-09-04T17:26:01Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTQxOA=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc2MzA2MA==", "bodyText": "Is that check done in all the existing it classes which calls this method? If not, that needs to be done in the It classes as part of this PR as this assertion is removed here, otherwise tests will proceed even if the application build fails.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483763060", "createdAt": "2020-09-04T17:34:47Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTQxOA=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc3MTc1NA==", "bodyText": "Only 1 class was missing the assert. Added the assertion in ItManagedCoherence.java", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483771754", "createdAt": "2020-09-04T17:55:04Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTQxOA=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyNDU1MDA2OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNjowNToxOVrOHNTrRw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxNzoyODo1NFrOHNWZgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTkxMQ==", "bodyText": "doesn't the copy files/dir from pod fail if the build is not successful?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483715911", "createdAt": "2020-09-04T16:05:19Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.\n+\n+      //assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n+      //    + \" to build an application failed with exit value \" + exec.exitValue());\n \n       Kubernetes.copyDirectoryFromPod(webLogicPod,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc0NDE1Mw==", "bodyText": "Yes, but that is what we expect right?. Most of  the time what we  see is exit code issue even though build is successful.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483744153", "createdAt": "2020-09-04T16:51:05Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.\n+\n+      //assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n+      //    + \" to build an application failed with exit value \" + exec.exitValue());\n \n       Kubernetes.copyDirectoryFromPod(webLogicPod,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTkxMQ=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc0OTcxMA==", "bodyText": "Yes, we expect it to fail. So, if the build is not successful, will it fail at this point?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483749710", "createdAt": "2020-09-04T17:03:33Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.\n+\n+      //assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n+      //    + \" to build an application failed with exit value \" + exec.exitValue());\n \n       Kubernetes.copyDirectoryFromPod(webLogicPod,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTkxMQ=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc0OTk3NA==", "bodyText": "if it fails here, we don't need to add any additional checks in It class", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483749974", "createdAt": "2020-09-04T17:04:12Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.\n+\n+      //assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n+      //    + \" to build an application failed with exit value \" + exec.exitValue());\n \n       Kubernetes.copyDirectoryFromPod(webLogicPod,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTkxMQ=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc2MDUxMg==", "bodyText": "Depends on the source app. If the build failed but created a empty distDir this copy command may not fail. It will simply copy the empty directory to local file system.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1904#discussion_r483760512", "createdAt": "2020-09-04T17:28:54Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/BuildApplication.java", "diffHunk": "@@ -174,8 +175,14 @@ public static Path buildApplication(Path appSrcPath, Map<String, String> antPara\n       if (exec.stderr() != null) {\n         logger.info(\"Exec stderr {0}\", exec.stderr());\n       }\n-      assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n-          + \" to build an application failed with exit value \" + exec.exitValue());\n+\n+      // Exec returns a non-zero return code intermittently even when the application builds\n+      // successfully. This seems to be an issue with io.kubernetes.client.Exec.java. So, Commenting\n+      // this assertion for now. it is now the responsibility of the It test class\n+      // to assert the application exists before continuing with the test.\n+\n+      //assertEquals(0, exec.exitValue(), \"Exec into \" + webLogicPod.getMetadata().getName()\n+      //    + \" to build an application failed with exit value \" + exec.exitValue());\n \n       Kubernetes.copyDirectoryFromPod(webLogicPod,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzcxNTkxMQ=="}, "originalCommit": {"oid": "ed9424bb270e6fb58eecd199237f7305f59cdb0c"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3938, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}