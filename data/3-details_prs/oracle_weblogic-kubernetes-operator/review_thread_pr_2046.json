{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4NzY3NzI4", "number": 2046, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNzoyOTozNFrOE4RQTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNzoyOTozNFrOE4RQTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3NDM4NDE0OnYy", "diffSide": "RIGHT", "path": "operator/src/main/resources/scripts/startServer.sh", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNzoyOTozNFrOHyFx7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMlQxNzo1NjoxOFrOHyG5hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI4NTU0OQ==", "bodyText": "What file isn't owned?  Note that there is similar logic in the liveness probe script.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2046#discussion_r522285549", "createdAt": "2020-11-12T17:29:34Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/scripts/startServer.sh", "diffHunk": "@@ -34,15 +34,17 @@ function copyIfChanged() {\n     trace \"Copying '$1' to '$2'.\"\n     cp $1 $2\n     [ $? -ne 0 ] && trace SEVERE \"failed cp $1 $2\" && exitOrLoop\n-    chmod 750 $2 \n-    [ $? -ne 0 ] && trace SEVERE \"failed chmod 750 $2\" && exitOrLoop\n+    if [ -O \"$2\" ]; then\n+      chmod 770 $2\n+      [ $? -ne 0 ] && trace SEVERE \"failed chmod 770 $2\" && exitOrLoop\n+    fi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6cbe0aedb61877dc650ac08c596bce8d9949b27c"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI4ODU4Ng==", "bodyText": "On OpenShift, the containers will not be run as the \"oracle\" user, but instead will be run as a new user (large UID), but that is part of the \"root\" group. In the case of the boot.properties, or any file that already exists and is being copied over, the file will still be owned by \"oracle\" and so the script cannot chmod the file.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2046#discussion_r522288586", "createdAt": "2020-11-12T17:33:20Z", "author": {"login": "rjeberhard"}, "path": "operator/src/main/resources/scripts/startServer.sh", "diffHunk": "@@ -34,15 +34,17 @@ function copyIfChanged() {\n     trace \"Copying '$1' to '$2'.\"\n     cp $1 $2\n     [ $? -ne 0 ] && trace SEVERE \"failed cp $1 $2\" && exitOrLoop\n-    chmod 750 $2 \n-    [ $? -ne 0 ] && trace SEVERE \"failed chmod 750 $2\" && exitOrLoop\n+    if [ -O \"$2\" ]; then\n+      chmod 770 $2\n+      [ $? -ne 0 ] && trace SEVERE \"failed chmod 770 $2\" && exitOrLoop\n+    fi", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI4NTU0OQ=="}, "originalCommit": {"oid": "6cbe0aedb61877dc650ac08c596bce8d9949b27c"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI4OTEyNA==", "bodyText": "Yes, I'll change the liveness probe too", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2046#discussion_r522289124", "createdAt": "2020-11-12T17:34:11Z", "author": {"login": "rjeberhard"}, "path": "operator/src/main/resources/scripts/startServer.sh", "diffHunk": "@@ -34,15 +34,17 @@ function copyIfChanged() {\n     trace \"Copying '$1' to '$2'.\"\n     cp $1 $2\n     [ $? -ne 0 ] && trace SEVERE \"failed cp $1 $2\" && exitOrLoop\n-    chmod 750 $2 \n-    [ $? -ne 0 ] && trace SEVERE \"failed chmod 750 $2\" && exitOrLoop\n+    if [ -O \"$2\" ]; then\n+      chmod 770 $2\n+      [ $? -ne 0 ] && trace SEVERE \"failed chmod 770 $2\" && exitOrLoop\n+    fi", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI4NTU0OQ=="}, "originalCommit": {"oid": "6cbe0aedb61877dc650ac08c596bce8d9949b27c"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI5MTQzNA==", "bodyText": "It's interesting that boot.properties is created and copied over by the operator at runtime (contains the WL credentials), but it still needs an unknown check and a chmod...", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2046#discussion_r522291434", "createdAt": "2020-11-12T17:37:29Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/scripts/startServer.sh", "diffHunk": "@@ -34,15 +34,17 @@ function copyIfChanged() {\n     trace \"Copying '$1' to '$2'.\"\n     cp $1 $2\n     [ $? -ne 0 ] && trace SEVERE \"failed cp $1 $2\" && exitOrLoop\n-    chmod 750 $2 \n-    [ $? -ne 0 ] && trace SEVERE \"failed chmod 750 $2\" && exitOrLoop\n+    if [ -O \"$2\" ]; then\n+      chmod 770 $2\n+      [ $? -ne 0 ] && trace SEVERE \"failed chmod 770 $2\" && exitOrLoop\n+    fi", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI4NTU0OQ=="}, "originalCommit": {"oid": "6cbe0aedb61877dc650ac08c596bce8d9949b27c"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjMwMzg3OA==", "bodyText": "It's not copied by the \"operator\". It's copied by the user principal inside the server instance running a script injected by the operator.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2046#discussion_r522303878", "createdAt": "2020-11-12T17:56:18Z", "author": {"login": "rjeberhard"}, "path": "operator/src/main/resources/scripts/startServer.sh", "diffHunk": "@@ -34,15 +34,17 @@ function copyIfChanged() {\n     trace \"Copying '$1' to '$2'.\"\n     cp $1 $2\n     [ $? -ne 0 ] && trace SEVERE \"failed cp $1 $2\" && exitOrLoop\n-    chmod 750 $2 \n-    [ $? -ne 0 ] && trace SEVERE \"failed chmod 750 $2\" && exitOrLoop\n+    if [ -O \"$2\" ]; then\n+      chmod 770 $2\n+      [ $? -ne 0 ] && trace SEVERE \"failed chmod 770 $2\" && exitOrLoop\n+    fi", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI4NTU0OQ=="}, "originalCommit": {"oid": "6cbe0aedb61877dc650ac08c596bce8d9949b27c"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3738, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}