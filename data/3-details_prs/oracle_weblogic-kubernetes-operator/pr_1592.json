{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4NjI2MzA0", "number": 1592, "title": "Check fileext wdt", "bodyText": "This PR provides two additional checks\n\nMinimum WDT version 1.7.3\nCheck and fail if user put unsupported file extension in the model directories, supported are .yaml, .properties, or .zip (only in the image)", "createdAt": "2020-04-24T15:43:27Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592", "merged": true, "mergeCommit": {"oid": "3ac21f7735f434846d742370b38610f103784fea"}, "closed": true, "closedAt": "2020-05-01T19:46:37Z", "author": {"login": "jshum2479"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcaTYe1gH2gAyNDA4NjI2MzA0OjU2YzI4NTVlNTM2MjYyYzg4ZTExYzg2Njc0MjlmYzhhYmI5MDg0MzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcdF92VAFqTQwNDMyMTQ0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "56c2855e536262c88e11c8667429fc8abb908436", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/56c2855e536262c88e11c8667429fc8abb908436", "committedDate": "2020-04-23T02:23:03Z", "message": "add check for wdt version and file extensions in model directories"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "641d907871f4f3efb921fabc2875fbf85d455b85", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/641d907871f4f3efb921fabc2875fbf85d455b85", "committedDate": "2020-04-23T16:00:58Z", "message": "fix script errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b95e00018c671906be2c1f09e9cdbf26b2def2c2", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b95e00018c671906be2c1f09e9cdbf26b2def2c2", "committedDate": "2020-04-23T16:33:14Z", "message": "fix script error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7608f0a6fca37bce9c39804e6fd49f8417d5464", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a7608f0a6fca37bce9c39804e6fd49f8417d5464", "committedDate": "2020-04-23T17:14:42Z", "message": "update error wordings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "107be1f9f5037ea0adef2868f1977fb9994b2eae", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/107be1f9f5037ea0adef2868f1977fb9994b2eae", "committedDate": "2020-04-24T14:11:38Z", "message": "fix wordings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f22b9b852d6cbbe5a08c7e2041a9bd71253e4091", "committedDate": "2020-04-24T15:34:13Z", "message": "update check extension for wdt configmap"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMDY2MjU5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#pullrequestreview-400066259", "createdAt": "2020-04-24T15:48:59Z", "commit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNTo0ODo1OVrOGLeBwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNTo0ODo1OVrOGLeBwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY3OTQ4OQ==", "bodyText": "extension -> extensions", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#discussion_r414679489", "createdAt": "2020-04-24T15:48:59Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/scripts/modelInImage.sh", "diffHunk": "@@ -384,6 +387,55 @@ function checkDirNotExistsOrEmpty() {\n   trace \"Exiting checkDirNotExistsOrEmpty\"\n }\n \n+# limit the file extensions in the model directories\n+\n+function checkModelDirectoryExtensions() {\n+  trace \"Entering checkModelDirectoryExtensions\"\n+\n+  cd ${IMG_MODELS_HOME}\n+  counter=$(ls  -I  *.yaml -I *.zip -I *.properties | wc -l)\n+  if [ $counter -ne 0 ] ; then\n+        trace SEVERE \"Directory ${IMG_MODELS_HOME} contains files with unsupported extension. Extension must be\" \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMDY4NDcx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#pullrequestreview-400068471", "createdAt": "2020-04-24T15:51:45Z", "commit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNTo1MTo0NVrOGLeJOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNTo1MTo0NVrOGLeJOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY4MTQwMQ==", "bodyText": "How about:\n\"Model files with unsupported extensions: '$(ls -I  *.yaml -I *.zip -I *.properties)'\"", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#discussion_r414681401", "createdAt": "2020-04-24T15:51:45Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/scripts/modelInImage.sh", "diffHunk": "@@ -384,6 +387,55 @@ function checkDirNotExistsOrEmpty() {\n   trace \"Exiting checkDirNotExistsOrEmpty\"\n }\n \n+# limit the file extensions in the model directories\n+\n+function checkModelDirectoryExtensions() {\n+  trace \"Entering checkModelDirectoryExtensions\"\n+\n+  cd ${IMG_MODELS_HOME}\n+  counter=$(ls  -I  *.yaml -I *.zip -I *.properties | wc -l)\n+  if [ $counter -ne 0 ] ; then\n+        trace SEVERE \"Directory ${IMG_MODELS_HOME} contains files with unsupported extension. Extension must be\" \\\n+          \".yaml, .properties, or .zip\"\n+        trace SEVERE $(ls -I  *.yaml -I *.zip -I *.properties)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMDY5NDI3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#pullrequestreview-400069427", "createdAt": "2020-04-24T15:52:51Z", "commit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNTo1Mjo1MVrOGLeMXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNTo1Mjo1MVrOGLeMXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY4MjIwNg==", "bodyText": "extension -> extensions\nExtension must be -> Expected extensions", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#discussion_r414682206", "createdAt": "2020-04-24T15:52:51Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/scripts/modelInImage.sh", "diffHunk": "@@ -384,6 +387,55 @@ function checkDirNotExistsOrEmpty() {\n   trace \"Exiting checkDirNotExistsOrEmpty\"\n }\n \n+# limit the file extensions in the model directories\n+\n+function checkModelDirectoryExtensions() {\n+  trace \"Entering checkModelDirectoryExtensions\"\n+\n+  cd ${IMG_MODELS_HOME}\n+  counter=$(ls  -I  *.yaml -I *.zip -I *.properties | wc -l)\n+  if [ $counter -ne 0 ] ; then\n+        trace SEVERE \"Directory ${IMG_MODELS_HOME} contains files with unsupported extension. Extension must be\" \\\n+          \".yaml, .properties, or .zip\"\n+        trace SEVERE $(ls -I  *.yaml -I *.zip -I *.properties)\n+        exitOrLoop\n+  fi\n+  if [ -d ${WDT_CONFIGMAP_ROOT} ] ; then\n+    cd ${WDT_CONFIGMAP_ROOT}\n+    counter=$(ls  -I  *.yaml -I *.properties | wc -l)\n+    if [ $counter -ne 0 ] ; then\n+          trace SEVERE \"Directory ${WDT_CONFIGMAP_ROOT} contains files with unsupported extension. Extension must be\" \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMDczMTI4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#pullrequestreview-400073128", "createdAt": "2020-04-24T15:57:25Z", "commit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNTo1NzoyNlrOGLeY2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNTo1NzoyNlrOGLeY2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY4NTQwMQ==", "bodyText": "Just in case the version format changes, or there's some other bug, please provide an environment variable to bypass the check, and also print an informative message if the bypass is in effect.\nAnd add to each trace above.  \". To bypass this check, set environment variable 'WDT_BYPASS_WDT_VERSION_CHECK' to 'true'.\"", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#discussion_r414685401", "createdAt": "2020-04-24T15:57:26Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/scripts/modelInImage.sh", "diffHunk": "@@ -384,6 +387,55 @@ function checkDirNotExistsOrEmpty() {\n   trace \"Exiting checkDirNotExistsOrEmpty\"\n }\n \n+# limit the file extensions in the model directories\n+\n+function checkModelDirectoryExtensions() {\n+  trace \"Entering checkModelDirectoryExtensions\"\n+\n+  cd ${IMG_MODELS_HOME}\n+  counter=$(ls  -I  *.yaml -I *.zip -I *.properties | wc -l)\n+  if [ $counter -ne 0 ] ; then\n+        trace SEVERE \"Directory ${IMG_MODELS_HOME} contains files with unsupported extension. Extension must be\" \\\n+          \".yaml, .properties, or .zip\"\n+        trace SEVERE $(ls -I  *.yaml -I *.zip -I *.properties)\n+        exitOrLoop\n+  fi\n+  if [ -d ${WDT_CONFIGMAP_ROOT} ] ; then\n+    cd ${WDT_CONFIGMAP_ROOT}\n+    counter=$(ls  -I  *.yaml -I *.properties | wc -l)\n+    if [ $counter -ne 0 ] ; then\n+          trace SEVERE \"Directory ${WDT_CONFIGMAP_ROOT} contains files with unsupported extension. Extension must be\" \\\n+            \".yaml or .properties\"\n+          trace SEVERE $(ls -I  *.yaml -I *.properties)\n+          exitOrLoop\n+    fi\n+  fi\n+\n+  trace \"Exiting checkModelDirectoryExtensions\"\n+}\n+\n+# Check for WDT version\n+\n+function checkWDTVersion() {\n+  trace \"Entering checkWDTVersion\"\n+  unzip -c ${WDT_ROOT}/lib/weblogic-deploy-core.jar META-INF/MANIFEST.MF > /tmp/wdtversion.txt || exitOrLoop\n+  local wdt_version=\"$(grep \"Implementation-Version\" /tmp/wdtversion.txt | cut -f2 -d' ' | tr -d '\\r' )\" || exitOrLoop\n+  if  [ ! -z ${wdt_version} ]; then\n+    versionGE ${wdt_version} ${WDT_MINIMUM_VERSION}\n+    if [ $? != \"0\" ] ; then\n+      trace SEVERE \"Model in Image domain requires Weblogic Deploy Tool minimum version ${WDT_MINIMUM_VERSION}. \" \\\n+      \"The version in the image is ${wdt_version}, you need to update the Weblogic Deploy Tool version in the image.\"\n+      exitOrLoop\n+    fi\n+  else\n+    trace SEVERE \"Unknown Weblogic Deploy Tool version. Model in Image domain requires Weblogic Deploy Tool \" \\\n+      \"minimum version ${WDT_MINIMUM_VERSION}\"\n+    exitOrLoop\n+  fi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "originalPosition": 67}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMDc2MjY3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#pullrequestreview-400076267", "createdAt": "2020-04-24T16:01:16Z", "commit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNjowMToxNlrOGLejlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxNjowMToxNlrOGLejlg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY4ODE1MA==", "bodyText": "How about:\ntrace SEVERE \"Model configmap directory files with unsupported extensions: '$(ls -I  *.yaml -I *.properties)'.\"", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#discussion_r414688150", "createdAt": "2020-04-24T16:01:16Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/scripts/modelInImage.sh", "diffHunk": "@@ -384,6 +387,55 @@ function checkDirNotExistsOrEmpty() {\n   trace \"Exiting checkDirNotExistsOrEmpty\"\n }\n \n+# limit the file extensions in the model directories\n+\n+function checkModelDirectoryExtensions() {\n+  trace \"Entering checkModelDirectoryExtensions\"\n+\n+  cd ${IMG_MODELS_HOME}\n+  counter=$(ls  -I  *.yaml -I *.zip -I *.properties | wc -l)\n+  if [ $counter -ne 0 ] ; then\n+        trace SEVERE \"Directory ${IMG_MODELS_HOME} contains files with unsupported extension. Extension must be\" \\\n+          \".yaml, .properties, or .zip\"\n+        trace SEVERE $(ls -I  *.yaml -I *.zip -I *.properties)\n+        exitOrLoop\n+  fi\n+  if [ -d ${WDT_CONFIGMAP_ROOT} ] ; then\n+    cd ${WDT_CONFIGMAP_ROOT}\n+    counter=$(ls  -I  *.yaml -I *.properties | wc -l)\n+    if [ $counter -ne 0 ] ; then\n+          trace SEVERE \"Directory ${WDT_CONFIGMAP_ROOT} contains files with unsupported extension. Extension must be\" \\\n+            \".yaml or .properties\"\n+          trace SEVERE $(ls -I  *.yaml -I *.properties)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f22b9b852d6cbbe5a08c7e2041a9bd71253e4091"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44150a03c9fa08daa511a97307a8a4a66b2cd53b", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/44150a03c9fa08daa511a97307a8a4a66b2cd53b", "committedDate": "2020-04-24T16:20:42Z", "message": "PR fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4210a04851127079d4938701d90ea5c4c6bf6882", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4210a04851127079d4938701d90ea5c4c6bf6882", "committedDate": "2020-04-24T16:36:33Z", "message": "add bypass option for wdt version check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2407215c5e0ecc701365caecde3e9acbf92b370a", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/2407215c5e0ecc701365caecde3e9acbf92b370a", "committedDate": "2020-04-24T18:59:57Z", "message": "update script for checkDirectoryExtension"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f9f944b67d4772ce698e578b19c304fc0615ab6", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1f9f944b67d4772ce698e578b19c304fc0615ab6", "committedDate": "2020-04-24T19:17:32Z", "message": "update wordings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwMjIyNzEy", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#pullrequestreview-400222712", "createdAt": "2020-04-24T19:41:21Z", "commit": {"oid": "1f9f944b67d4772ce698e578b19c304fc0615ab6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxOTo0MToyMVrOGLmibQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNFQxOTo0MTozMlrOGLmi2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDgxODkyNQ==", "bodyText": "spelling", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#discussion_r414818925", "createdAt": "2020-04-24T19:41:21Z", "author": {"login": "markxnelson"}, "path": "operator/src/main/resources/scripts/modelInImage.sh", "diffHunk": "@@ -384,6 +389,57 @@ function checkDirNotExistsOrEmpty() {\n   trace \"Exiting checkDirNotExistsOrEmpty\"\n }\n \n+# limit the file extensions in the model directories\n+\n+function checkModelDirectoryExtensions() {\n+  trace \"Entering checkModelDirectoryExtensions\"\n+\n+  cd ${IMG_MODELS_HOME}\n+  counter=$(ls  -I  \"*.yaml\" -I \"*.zip\" -I \"*.properties\" | wc -l)\n+  if [ $counter -ne 0 ] ; then\n+    trace SEVERE \"Model image directory ${IMG_MODELS_HOME} contains files with unsupported extensions. \" \\\n+      \"Expected extensions: .yaml, .properties, or .zip\"\n+    trace SEVERE \"Model image directory files with unsupported extensions: \" \\\n+      \"'$(ls -I \"*.yaml\" -I \"*.zip\" -I \"*.properties\")'\"\n+    exitOrLoop\n+  fi\n+  if [ -d ${WDT_CONFIGMAP_ROOT} ] ; then\n+    cd ${WDT_CONFIGMAP_ROOT}\n+    counter=$(ls  -I  \"*.yaml\" -I \"*.properties\" | wc -l)\n+    if [ $counter -ne 0 ] ; then\n+      trace SEVERE \"Model configmap directory ${WDT_CONFIGMAP_ROOT} contains files with unsupported extensions. \" \\\n+      \"Expected extensions: .yaml or .properties\"\n+      trace SEVERE \"Model configmap directory files with unsupported extensions: \" \\\n+        \"'$(ls -I \"*.yaml\" -I \"*.properties\")'\"\n+      exitOrLoop\n+    fi\n+  fi\n+\n+  trace \"Exiting checkModelDirectoryExtensions\"\n+}\n+\n+# Check for WDT version\n+\n+function checkWDTVersion() {\n+  trace \"Entering checkWDTVersion\"\n+  unzip -c ${WDT_ROOT}/lib/weblogic-deploy-core.jar META-INF/MANIFEST.MF > /tmp/wdtversion.txt || exitOrLoop\n+  local wdt_version=\"$(grep \"Implementation-Version\" /tmp/wdtversion.txt | cut -f2 -d' ' | tr -d '\\r' )\" || exitOrLoop\n+  if  [ ! -z ${wdt_version} ]; then\n+    versionGE ${wdt_version} ${WDT_MINIMUM_VERSION}\n+    if [ $? != \"0\" ] ; then\n+      trace SEVERE \"Model in Image domain requires Weblogic Deploy Tool minimum version ${WDT_MINIMUM_VERSION}. \" \\\n+      \"The version in the image is ${wdt_version}, you need to update the Weblogic Deploy Tool version in the image.\"\n+      exitOrLoop\n+    fi\n+  else\n+    trace SEVERE \"Unknown Weblogic Deploy Tool version. Model in Image domain requires Weblogic Deploy Tool \" \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f9f944b67d4772ce698e578b19c304fc0615ab6"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDgxODk4Mg==", "bodyText": "spelling", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#discussion_r414818982", "createdAt": "2020-04-24T19:41:27Z", "author": {"login": "markxnelson"}, "path": "operator/src/main/resources/scripts/modelInImage.sh", "diffHunk": "@@ -384,6 +389,57 @@ function checkDirNotExistsOrEmpty() {\n   trace \"Exiting checkDirNotExistsOrEmpty\"\n }\n \n+# limit the file extensions in the model directories\n+\n+function checkModelDirectoryExtensions() {\n+  trace \"Entering checkModelDirectoryExtensions\"\n+\n+  cd ${IMG_MODELS_HOME}\n+  counter=$(ls  -I  \"*.yaml\" -I \"*.zip\" -I \"*.properties\" | wc -l)\n+  if [ $counter -ne 0 ] ; then\n+    trace SEVERE \"Model image directory ${IMG_MODELS_HOME} contains files with unsupported extensions. \" \\\n+      \"Expected extensions: .yaml, .properties, or .zip\"\n+    trace SEVERE \"Model image directory files with unsupported extensions: \" \\\n+      \"'$(ls -I \"*.yaml\" -I \"*.zip\" -I \"*.properties\")'\"\n+    exitOrLoop\n+  fi\n+  if [ -d ${WDT_CONFIGMAP_ROOT} ] ; then\n+    cd ${WDT_CONFIGMAP_ROOT}\n+    counter=$(ls  -I  \"*.yaml\" -I \"*.properties\" | wc -l)\n+    if [ $counter -ne 0 ] ; then\n+      trace SEVERE \"Model configmap directory ${WDT_CONFIGMAP_ROOT} contains files with unsupported extensions. \" \\\n+      \"Expected extensions: .yaml or .properties\"\n+      trace SEVERE \"Model configmap directory files with unsupported extensions: \" \\\n+        \"'$(ls -I \"*.yaml\" -I \"*.properties\")'\"\n+      exitOrLoop\n+    fi\n+  fi\n+\n+  trace \"Exiting checkModelDirectoryExtensions\"\n+}\n+\n+# Check for WDT version\n+\n+function checkWDTVersion() {\n+  trace \"Entering checkWDTVersion\"\n+  unzip -c ${WDT_ROOT}/lib/weblogic-deploy-core.jar META-INF/MANIFEST.MF > /tmp/wdtversion.txt || exitOrLoop\n+  local wdt_version=\"$(grep \"Implementation-Version\" /tmp/wdtversion.txt | cut -f2 -d' ' | tr -d '\\r' )\" || exitOrLoop\n+  if  [ ! -z ${wdt_version} ]; then\n+    versionGE ${wdt_version} ${WDT_MINIMUM_VERSION}\n+    if [ $? != \"0\" ] ; then\n+      trace SEVERE \"Model in Image domain requires Weblogic Deploy Tool minimum version ${WDT_MINIMUM_VERSION}. \" \\\n+      \"The version in the image is ${wdt_version}, you need to update the Weblogic Deploy Tool version in the image.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f9f944b67d4772ce698e578b19c304fc0615ab6"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDgxOTAzMw==", "bodyText": "spelling", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#discussion_r414819033", "createdAt": "2020-04-24T19:41:32Z", "author": {"login": "markxnelson"}, "path": "operator/src/main/resources/scripts/modelInImage.sh", "diffHunk": "@@ -384,6 +389,57 @@ function checkDirNotExistsOrEmpty() {\n   trace \"Exiting checkDirNotExistsOrEmpty\"\n }\n \n+# limit the file extensions in the model directories\n+\n+function checkModelDirectoryExtensions() {\n+  trace \"Entering checkModelDirectoryExtensions\"\n+\n+  cd ${IMG_MODELS_HOME}\n+  counter=$(ls  -I  \"*.yaml\" -I \"*.zip\" -I \"*.properties\" | wc -l)\n+  if [ $counter -ne 0 ] ; then\n+    trace SEVERE \"Model image directory ${IMG_MODELS_HOME} contains files with unsupported extensions. \" \\\n+      \"Expected extensions: .yaml, .properties, or .zip\"\n+    trace SEVERE \"Model image directory files with unsupported extensions: \" \\\n+      \"'$(ls -I \"*.yaml\" -I \"*.zip\" -I \"*.properties\")'\"\n+    exitOrLoop\n+  fi\n+  if [ -d ${WDT_CONFIGMAP_ROOT} ] ; then\n+    cd ${WDT_CONFIGMAP_ROOT}\n+    counter=$(ls  -I  \"*.yaml\" -I \"*.properties\" | wc -l)\n+    if [ $counter -ne 0 ] ; then\n+      trace SEVERE \"Model configmap directory ${WDT_CONFIGMAP_ROOT} contains files with unsupported extensions. \" \\\n+      \"Expected extensions: .yaml or .properties\"\n+      trace SEVERE \"Model configmap directory files with unsupported extensions: \" \\\n+        \"'$(ls -I \"*.yaml\" -I \"*.properties\")'\"\n+      exitOrLoop\n+    fi\n+  fi\n+\n+  trace \"Exiting checkModelDirectoryExtensions\"\n+}\n+\n+# Check for WDT version\n+\n+function checkWDTVersion() {\n+  trace \"Entering checkWDTVersion\"\n+  unzip -c ${WDT_ROOT}/lib/weblogic-deploy-core.jar META-INF/MANIFEST.MF > /tmp/wdtversion.txt || exitOrLoop\n+  local wdt_version=\"$(grep \"Implementation-Version\" /tmp/wdtversion.txt | cut -f2 -d' ' | tr -d '\\r' )\" || exitOrLoop\n+  if  [ ! -z ${wdt_version} ]; then\n+    versionGE ${wdt_version} ${WDT_MINIMUM_VERSION}\n+    if [ $? != \"0\" ] ; then\n+      trace SEVERE \"Model in Image domain requires Weblogic Deploy Tool minimum version ${WDT_MINIMUM_VERSION}. \" \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f9f944b67d4772ce698e578b19c304fc0615ab6"}, "originalPosition": 63}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c35272efd03ef31158eeb33a37ad4d8cf1765a3", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1c35272efd03ef31158eeb33a37ad4d8cf1765a3", "committedDate": "2020-04-24T21:09:05Z", "message": "update wordings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2cf1ddafbbbde284b3606a573e528213ad8c5254", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/2cf1ddafbbbde284b3606a573e528213ad8c5254", "committedDate": "2020-05-01T15:57:10Z", "message": "Correct spelling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MjQxMjk2", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#pullrequestreview-404241296", "createdAt": "2020-05-01T16:00:38Z", "commit": {"oid": "2cf1ddafbbbde284b3606a573e528213ad8c5254"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MjkyMjA5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#pullrequestreview-404292209", "createdAt": "2020-05-01T17:34:21Z", "commit": {"oid": "2cf1ddafbbbde284b3606a573e528213ad8c5254"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxNzozNDoyMlrOGPQThA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxNzozNDoyMlrOGPQThA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY0ODk2NA==", "bodyText": "Would it be OK to secretly allow a '.zip'?  A 'small' app could fit in the cm.  Or do we specifically want to disallow this?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#discussion_r418648964", "createdAt": "2020-05-01T17:34:22Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/scripts/modelInImage.sh", "diffHunk": "@@ -384,6 +389,61 @@ function checkDirNotExistsOrEmpty() {\n   trace \"Exiting checkDirNotExistsOrEmpty\"\n }\n \n+# limit the file extensions in the model directories\n+\n+function checkModelDirectoryExtensions() {\n+  trace \"Entering checkModelDirectoryExtensions\"\n+\n+  cd ${IMG_MODELS_HOME}\n+  counter=$(ls  -I  \"*.yaml\" -I \"*.zip\" -I \"*.properties\" | wc -l)\n+  if [ $counter -ne 0 ] ; then\n+    trace SEVERE \"Model image directory ${IMG_MODELS_HOME} contains files with unsupported extensions. \" \\\n+      \"Expected extensions: .yaml, .properties, or .zip\"\n+    trace SEVERE \"Model image directory files with unsupported extensions: \" \\\n+      \"'$(ls -I \"*.yaml\" -I \"*.zip\" -I \"*.properties\")'\"\n+    exitOrLoop\n+  fi\n+  if [ -d ${WDT_CONFIGMAP_ROOT} ] ; then\n+    cd ${WDT_CONFIGMAP_ROOT}\n+    counter=$(ls  -I  \"*.yaml\" -I \"*.properties\" | wc -l)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2cf1ddafbbbde284b3606a573e528213ad8c5254"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3d811e86c5dc2bfb5e4f36a2a2522ed9db39e03c", "author": {"user": null}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3d811e86c5dc2bfb5e4f36a2a2522ed9db39e03c", "committedDate": "2020-05-01T18:17:19Z", "message": "add bypsss wdt version check wordings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MzIxNDQz", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1592#pullrequestreview-404321443", "createdAt": "2020-05-01T18:26:58Z", "commit": {"oid": "3d811e86c5dc2bfb5e4f36a2a2522ed9db39e03c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4696, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}