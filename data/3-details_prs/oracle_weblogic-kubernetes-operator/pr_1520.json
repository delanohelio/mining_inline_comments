{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2NTY0Mjg2", "number": 1520, "title": "Wit action impl", "bodyText": "The initial impl of the WIT and Installer actions.", "createdAt": "2020-03-31T19:55:14Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520", "merged": true, "mergeCommit": {"oid": "0817e924090fb1bdf1fbdbab859d73cac61e3210"}, "closed": true, "closedAt": "2020-04-02T19:49:39Z", "author": {"login": "doxiao"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcR4wZ8gH2gAyMzk2NTY0Mjg2OjY1YWIzYzg4MGM2MmEyZmFkOGNkZjMxNTkwNmUwZGMxZjI1MDExNzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTxul8gFqTM4Njc0MzM0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "65ab3c880c62a2fad8cdf315906e0dc1f2501177", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/65ab3c880c62a2fad8cdf315906e0dc1f2501177", "committedDate": "2020-03-27T22:50:21Z", "message": "Add actions for download and WIT\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "366b647339557c3a9bbe35448ac6899e85964f8a", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/366b647339557c3a9bbe35448ac6899e85964f8a", "committedDate": "2020-03-27T22:56:59Z", "message": "Minor fix\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90813e4ad1ea2396a45bfa3f864d15217223225f", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/90813e4ad1ea2396a45bfa3f864d15217223225f", "committedDate": "2020-03-30T03:26:03Z", "message": "Minor fix of the formating\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8693494ab40a0d757e4fd6392f8c1dfe2962b545", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8693494ab40a0d757e4fd6392f8c1dfe2962b545", "committedDate": "2020-03-30T07:51:28Z", "message": "Address review comment\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f43bd30b1457581236d307791dbea32885f50f1", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5f43bd30b1457581236d307791dbea32885f50f1", "committedDate": "2020-03-30T17:15:59Z", "message": "WIT impl\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b26787dfe747a94f16082a580d77ca7d85b96bff", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b26787dfe747a94f16082a580d77ca7d85b96bff", "committedDate": "2020-03-30T19:18:31Z", "message": "Add execcommand\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "001dadd9990c4261427bf2d73372e7e5effaa6f4", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/001dadd9990c4261427bf2d73372e7e5effaa6f4", "committedDate": "2020-03-30T22:52:32Z", "message": "Use tmpDir as the root of the work dir\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3a53772269bdd2323640dd26f54be98cb9e85ec", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e3a53772269bdd2323640dd26f54be98cb9e85ec", "committedDate": "2020-03-30T23:45:58Z", "message": "Minor fixes\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5190d0bcf79722ba6c8de06789b6672326d1bef", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a5190d0bcf79722ba6c8de06789b6672326d1bef", "committedDate": "2020-03-31T02:58:37Z", "message": "Support unzip WIT\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7e74b05719954f7980f57a5f6c6243571f08b43", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b7e74b05719954f7980f57a5f6c6243571f08b43", "committedDate": "2020-03-31T14:25:29Z", "message": "More impl\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "031f1bddd6b1ce4f126ea3d0c3e230e7ba362ab5", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/031f1bddd6b1ce4f126ea3d0c3e230e7ba362ab5", "committedDate": "2020-03-31T16:25:45Z", "message": "Merge remote-tracking branch 'origin/mii-new-integration-tests' into WIT-action-impl\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>\n\nConflicts:\n\tnew-integration-tests/pom.xml\n\tnew-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/TestActions.java\n\tnew-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/InstallParams.java\n\tnew-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Installer.java\n\tnew-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/WITParams.java\n\tnew-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/WebLogicImageTool.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "806aa7aa51eb30f4a82380dfd4683ff3c68bcd61", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/806aa7aa51eb30f4a82380dfd4683ff3c68bcd61", "committedDate": "2020-03-31T16:32:03Z", "message": "Rename a class\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5567b19f5e085c01676f28d9b044d3b028b19e9", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b5567b19f5e085c01676f28d9b044d3b028b19e9", "committedDate": "2020-03-31T19:39:23Z", "message": "Add ProcessBuilder code commented out\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/03472bf656ae95d3974184d1131be46c686cfc0e", "committedDate": "2020-03-31T19:57:41Z", "message": "Minor fix\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NTA1MTc1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#pullrequestreview-385505175", "createdAt": "2020-04-01T11:43:56Z", "commit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMTo0Mzo1NlrOF-80-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMTo0Mzo1NlrOF-80-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU1MjYzMg==", "bodyText": "This method can be used outside of installer. For helm, I need to execute a command. Can you move these methods to a common class.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r401552632", "createdAt": "2020-04-01T11:43:56Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/InstallWITCommon.java", "diffHunk": "@@ -0,0 +1,81 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.actions.impl.primitive;\n+\n+// import java.io.BufferedReader;\n+import java.io.File;\n+import java.io.IOException;\n+// import java.io.InputStreamReader;\n+// import java.util.Map;\n+\n+import oracle.weblogic.kubernetes.utils.ExecCommand;\n+import oracle.weblogic.kubernetes.utils.ExecResult;\n+\n+import static oracle.weblogic.kubernetes.extensions.LoggedTest.logger;\n+\n+/**\n+ * The common fuctionality of Installer and WebLogicImageTool\n+ */\n+public class InstallWITCommon {\n+\n+  protected static final String WORK_DIR \n+      = System.getProperty(\"java.io.tmpdir\") + \"/it-results\";\n+\n+  /* Use ProcessBuilder\n+  protected boolean executeAndVerify(String command, boolean redirectOutput) {\n+    ProcessBuilder builder = new ProcessBuilder();\n+    builder.command(command);\n+    logger.info(\"Executing command = \" + command + \"\\n env = \" + builder.environment());\n+    try {\n+      Process process = builder.start();\n+\n+      // if (redirectOutput) {\n+      StringBuilder output = new StringBuilder();\n+\n+      BufferedReader reader = new BufferedReader(\n+          new InputStreamReader(process.getInputStream()));\n+      String line;\n+      while ((line = reader.readLine()) != null) {\n+        output.append(line + \"\\n\");\n+      }\n+      int exitCode = process.waitFor();\n+      return exitCode == 0;\n+    } catch (IOException ioe) {\n+      ioe.printStackTrace();\n+      return false;\n+    } catch (InterruptedException ie) {\n+      ie.printStackTrace();\n+      return false;\n+    }\n+  }\n+  */\n+  \n+  protected boolean executeAndVerify(String command, boolean redirectOutput) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NTI1MjEw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#pullrequestreview-385525210", "createdAt": "2020-04-01T12:14:47Z", "commit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "state": "COMMENTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMjoxNDo0N1rOF-9yhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMjoyMjo1MVrOF--Edw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU2ODM4OQ==", "bodyText": "include messages on asserts, so if they fail we get a descriptive message", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r401568389", "createdAt": "2020-04-01T12:14:47Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItWITValidation.java", "diffHunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.WITParams;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.WebLogicImageTool;\n+import oracle.weblogic.kubernetes.extensions.LoggedTest;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+@DisplayName(\"Simple validation of basic WIT functions\")\n+class ItWITValidation implements LoggedTest {\n+  @Test\n+  @DisplayName(\"Create a MII image\")\n+  public void testCreatingMIIImage() {\n+\n+    // install WIT using the default version and location\n+    boolean downloadWIT = TestActions.installWIT(\n+        null /* version */, \n+        null /* location */,\n+        false /* do not redirect output */);\n+   \n+    assertEquals(true, downloadWIT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU2ODg5NQ==", "bodyText": "maybe these should just be defaults?\nwe could have a defaults() method on WITParams to set these? @rjeberhard what do you think?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r401568895", "createdAt": "2020-04-01T12:15:38Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItWITValidation.java", "diffHunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.WITParams;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.WebLogicImageTool;\n+import oracle.weblogic.kubernetes.extensions.LoggedTest;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+@DisplayName(\"Simple validation of basic WIT functions\")\n+class ItWITValidation implements LoggedTest {\n+  @Test\n+  @DisplayName(\"Create a MII image\")\n+  public void testCreatingMIIImage() {\n+\n+    // install WIT using the default version and location\n+    boolean downloadWIT = TestActions.installWIT(\n+        null /* version */, \n+        null /* location */,\n+        false /* do not redirect output */);\n+   \n+    assertEquals(true, downloadWIT);\n+    \n+    // install WDT using the default version and location\n+    boolean downloadWDT = TestActions.installWDT(\n+        null /* version */, \n+        null /* location */,\n+        false /* do not redirect output */);\n+\n+    assertEquals(true, downloadWDT);\n+\n+    // create the MII image\n+    // TODO add model files and other contents to the image once we have those resources\n+    WITParams params = new WITParams()\n+        .baseImageName(WebLogicImageTool.WLS_BASE_IMAGE_NAME)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU2OTg0OA==", "bodyText": "fluent api's do not use the prefix get\npublic String thing() {\n  return thing;\n}\n\npublic Whatever thing(String newThing) {\n  this.thing = newThing;\n  return this;\n}", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r401569848", "createdAt": "2020-04-01T12:17:19Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/InstallParams.java", "diffHunk": "@@ -3,27 +3,100 @@\n \n package oracle.weblogic.kubernetes.actions.impl.primitive;\n \n-// Presents all parameters that the test InstallParams needs.\n+/**\n+ * Presents all parameters for downloading a tool.\n+ */\n \n public class InstallParams {\n+  public static final String WIT_TYPE = \"WIT\";\n+  public static final String WDT_TYPE = \"WDT\";\n \n-  private String type;\n+  public static final String DEFAULT_WIT_DOWNLOAD_URL = \"https://github.com//oracle/weblogic-image-tool\";\n+  public static final String DEFAULT_WIT_VERSION    = \"release-1.8.3\";\n+  public static final String WIT_FILE_NAME  = \"imagetool.zip\";\n+\n+  public static final String DEFAULT_WDT_DOWNLOAD_URL = \"https://github.com//oracle/weblogic-deploy-tooling\";\n+  public static final String DEFAULT_WDT_VERSION    = \"weblogic-deploy-tooling-1.7.2\";\n+  public static final String WDT_FILE_NAME  = \"weblogic-deploy.zip\";\n+\n+  // WIT or WDT\n+  private String type = \"WIT\";\n+  // The version of the tool\n   private String version;\n+  // The download site location\n   private String location;\n+  // Whether verify before download\n+  private boolean verify = true;\n+  // Whether the download zip file needs to be unziped\n+  private boolean unzip = false;\n+  // Whether the output of the command is redirected to system out\n+  private boolean redirect = true;\n \n   public InstallParams type(String type) {\n     this.type = type;\n     return this;\n   }\n \n+  public String getType() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3MDg1NQ==", "bodyText": "don't just swallow the exception.\nat least log it", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r401570855", "createdAt": "2020-04-01T12:19:08Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/InstallWITCommon.java", "diffHunk": "@@ -0,0 +1,81 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.actions.impl.primitive;\n+\n+// import java.io.BufferedReader;\n+import java.io.File;\n+import java.io.IOException;\n+// import java.io.InputStreamReader;\n+// import java.util.Map;\n+\n+import oracle.weblogic.kubernetes.utils.ExecCommand;\n+import oracle.weblogic.kubernetes.utils.ExecResult;\n+\n+import static oracle.weblogic.kubernetes.extensions.LoggedTest.logger;\n+\n+/**\n+ * The common fuctionality of Installer and WebLogicImageTool\n+ */\n+public class InstallWITCommon {\n+\n+  protected static final String WORK_DIR \n+      = System.getProperty(\"java.io.tmpdir\") + \"/it-results\";\n+\n+  /* Use ProcessBuilder\n+  protected boolean executeAndVerify(String command, boolean redirectOutput) {\n+    ProcessBuilder builder = new ProcessBuilder();\n+    builder.command(command);\n+    logger.info(\"Executing command = \" + command + \"\\n env = \" + builder.environment());\n+    try {\n+      Process process = builder.start();\n+\n+      // if (redirectOutput) {\n+      StringBuilder output = new StringBuilder();\n+\n+      BufferedReader reader = new BufferedReader(\n+          new InputStreamReader(process.getInputStream()));\n+      String line;\n+      while ((line = reader.readLine()) != null) {\n+        output.append(line + \"\\n\");\n+      }\n+      int exitCode = process.waitFor();\n+      return exitCode == 0;\n+    } catch (IOException ioe) {\n+      ioe.printStackTrace();\n+      return false;\n+    } catch (InterruptedException ie) {\n+      ie.printStackTrace();\n+      return false;\n+    }\n+  }\n+  */\n+  \n+  protected boolean executeAndVerify(String command, boolean redirectOutput) {\n+    logger.info(\"Executing command = \" + command);\n+    try {\n+      checkDirectory(WORK_DIR);\n+      ExecResult result = ExecCommand.exec(command, redirectOutput);\n+      return result.exitValue() == 0;\n+    } catch (IOException ioe) {\n+      return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3MTQwNw==", "bodyText": "improve doc", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r401571407", "createdAt": "2020-04-01T12:20:09Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/WITParams.java", "diffHunk": "@@ -5,52 +5,119 @@\n \n import java.util.List;\n \n-// Presents all parameters for WIT commands\n+/**\n+ * Presents all parameters for downloading a tool.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3MTk0MQ==", "bodyText": "put each param on a new line please", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r401571941", "createdAt": "2020-04-01T12:21:05Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/ExecCommand.java", "diffHunk": "@@ -0,0 +1,146 @@\n+// Copyright (c) 2018, 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.io.BufferedReader;\n+import java.io.ByteArrayInputStream;\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.io.OutputStream;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.stream.Collectors;\n+\n+import com.google.common.io.ByteStreams;\n+\n+/** \n+ * Class for executing shell commands from java. \n+ */\n+public class ExecCommand {\n+\n+  public static ExecResult exec(String command) throws IOException, InterruptedException {\n+    return exec(command, false, null);\n+  }\n+\n+  public static ExecResult exec(String command, boolean isRedirectToOut) \n+      throws IOException, InterruptedException {\n+    return exec(command, isRedirectToOut, null);\n+  }\n+\n+  /**\n+   * execute command.\n+   * @param command command\n+   * @param isRedirectToOut redirect to out flag\n+   * @param additionalEnvMap additional environment map\n+   * @return result\n+   * @throws IOException if the command failed to execute\n+   * @throws InterruptedException if the process was interrupted\n+   */\n+  public static ExecResult exec(\n+      String command, boolean isRedirectToOut, Map<String, String> additionalEnvMap)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3Mjk4Mw==", "bodyText": "did you copy this from somewhere else? the copyright dates look wrong", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r401572983", "createdAt": "2020-04-01T12:22:51Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/ExecCommand.java", "diffHunk": "@@ -0,0 +1,146 @@\n+// Copyright (c) 2018, 2020, Oracle Corporation and/or its affiliates.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03472bf656ae95d3974184d1131be46c686cfc0e"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63d2e2919869b2514788a6a4c044e874b2b6236a", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/63d2e2919869b2514788a6a4c044e874b2b6236a", "committedDate": "2020-04-01T12:25:07Z", "message": "Setup WIT list parameters\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13d41fc2aa1457459d5e9139f514a51db35d595c", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/13d41fc2aa1457459d5e9139f514a51db35d595c", "committedDate": "2020-04-01T17:44:50Z", "message": "Address review comments\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "369e74d0817958982814bcff9d4ead839a9d99c5", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/369e74d0817958982814bcff9d4ead839a9d99c5", "committedDate": "2020-04-01T18:56:07Z", "message": "Merge remote-tracking branch 'origin/mii-new-integration-tests' into WIT-action-impl"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "535e26e990b64e9fa57ed0ab4c95330388b8c15f", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/535e26e990b64e9fa57ed0ab4c95330388b8c15f", "committedDate": "2020-04-01T19:19:53Z", "message": "More review change\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NTQ5ODk1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#pullrequestreview-386549895", "createdAt": "2020-04-02T15:37:45Z", "commit": {"oid": "535e26e990b64e9fa57ed0ab4c95330388b8c15f"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNTozNzo0NVrOF_xO6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxNTo0MjowM1rOF_xa7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxMTI0MA==", "bodyText": "i would prefer that tests just assume it is there and use it -- let the impl worry about whether or not it needs to download it under the covers", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r402411240", "createdAt": "2020-04-02T15:37:45Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItWITValidation.java", "diffHunk": "@@ -0,0 +1,42 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.extensions.LoggedTest;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static oracle.weblogic.kubernetes.actions.TestActions.withWITParams;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+@DisplayName(\"Simple validation of basic WIT functions\")\n+class ItWITValidation implements LoggedTest {\n+  @Test\n+  @DisplayName(\"Create a MII image\")\n+  public void testCreatingMIIImage() {\n+\n+    // install WIT using the default version and location", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "535e26e990b64e9fa57ed0ab4c95330388b8c15f"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxMjQwMA==", "bodyText": "use //", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r402412400", "createdAt": "2020-04-02T15:39:24Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItWITValidation.java", "diffHunk": "@@ -0,0 +1,42 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.extensions.LoggedTest;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static oracle.weblogic.kubernetes.actions.TestActions.withWITParams;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+@DisplayName(\"Simple validation of basic WIT functions\")\n+class ItWITValidation implements LoggedTest {\n+  @Test\n+  @DisplayName(\"Create a MII image\")\n+  public void testCreatingMIIImage() {\n+\n+    // install WIT using the default version and location\n+    boolean downloadWIT = TestActions.installWIT(\n+        null /* version */, ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "535e26e990b64e9fa57ed0ab4c95330388b8c15f"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxMzEwNw==", "bodyText": "is this unfinished? does not seem to do anything", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r402413107", "createdAt": "2020-04-02T15:40:22Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItWITValidation.java", "diffHunk": "@@ -0,0 +1,42 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.extensions.LoggedTest;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static oracle.weblogic.kubernetes.actions.TestActions.withWITParams;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+@DisplayName(\"Simple validation of basic WIT functions\")\n+class ItWITValidation implements LoggedTest {\n+  @Test\n+  @DisplayName(\"Create a MII image\")\n+  public void testCreatingMIIImage() {\n+\n+    // install WIT using the default version and location\n+    boolean downloadWIT = TestActions.installWIT(\n+        null /* version */, \n+        null /* location */,\n+        false /* do not redirect output */);\n+   \n+    assertEquals(true, downloadWIT, \"Failed to download or unzip WebLogic Image Tool\");\n+    \n+    // install WDT using the default version and location\n+    boolean downloadWDT = TestActions.installWDT(\n+        null /* version */, \n+        null /* location */,\n+        false /* do not redirect output */);\n+\n+    assertEquals(true, downloadWDT, \"Failed to download WebLogic Deploy Tool\");\n+\n+    // create the MII image\n+    // TODO add model files and other contents to the image once we have those resources\n+    boolean success = TestActions.createMIIImage(withWITParams());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "535e26e990b64e9fa57ed0ab4c95330388b8c15f"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxNDMxOA==", "bodyText": "don't think we need javadoc for the constructor, it's pretty clear what it does", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r402414318", "createdAt": "2020-04-02T15:42:03Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/ExecResult.java", "diffHunk": "@@ -0,0 +1,44 @@\n+// Copyright (c) 2018, 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.io.IOException;\n+\n+/**\n+ * Class that holds the results of using java to exec a command (i.e. exit value, stdout and stderr)\n+ */\n+public class ExecResult {\n+  private int exitValue;\n+  private String stdout;\n+  private String stderr;\n+\n+  /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "535e26e990b64e9fa57ed0ab4c95330388b8c15f"}, "originalPosition": 16}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2dc2c18a3ecb3212a2b39002b3cf8d3c9a04fcb", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f2dc2c18a3ecb3212a2b39002b3cf8d3c9a04fcb", "committedDate": "2020-04-02T16:46:06Z", "message": "More review comments\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "339ff3bce47fac6dada5dfe921b1d93048a5b222", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/339ff3bce47fac6dada5dfe921b1d93048a5b222", "committedDate": "2020-04-02T16:51:06Z", "message": "Minor style fix\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NzA4Njcw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#pullrequestreview-386708670", "createdAt": "2020-04-02T18:55:33Z", "commit": {"oid": "339ff3bce47fac6dada5dfe921b1d93048a5b222"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxODo1NTozM1rOF_5HzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQxODo1NTozM1rOF_5HzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjU0MDQ5Mg==", "bodyText": "directories", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#discussion_r402540492", "createdAt": "2020-04-02T18:55:33Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/InstallWITCommon.java", "diffHunk": "@@ -0,0 +1,58 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.actions.impl.primitive;\n+\n+import java.io.File;\n+import java.io.FileNotFoundException;\n+\n+import oracle.weblogic.kubernetes.actions.impl.ActionImplCommon;\n+\n+import static oracle.weblogic.kubernetes.extensions.LoggedTest.logger;\n+\n+/**\n+ * The common functionality of Installer and WebLogicImageTool\n+ */\n+public class InstallWITCommon extends ActionImplCommon {\n+\n+  protected static final String WORK_DIR \n+      = System.getProperty(\"java.io.tmpdir\") + \"/it-results\";\n+  protected static final String IMAGE_TOOL \n+      = WORK_DIR + \"/imagetool/bin/imagetool.sh\";\n+\n+\n+  /**\n+   * Check if the required directoies exist.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "339ff3bce47fac6dada5dfe921b1d93048a5b222"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NzEwMjMz", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#pullrequestreview-386710233", "createdAt": "2020-04-02T18:57:40Z", "commit": {"oid": "339ff3bce47fac6dada5dfe921b1d93048a5b222"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "093a7e6e14854df6907b67ca3d995205eacb370d", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/093a7e6e14854df6907b67ca3d995205eacb370d", "committedDate": "2020-04-02T19:01:54Z", "message": "Move download WIT/WDT code into the impl\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bba920221123a12f77233a72a2437032423f139", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3bba920221123a12f77233a72a2437032423f139", "committedDate": "2020-04-02T19:05:02Z", "message": "Merge remote-tracking branch 'origin/mii-new-integration-tests' into WIT-action-impl\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>\n\nConflicts:\n\tnew-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/TestActions.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e79cc33d3636d9f17936db1880d0e07c472e84e3", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e79cc33d3636d9f17936db1880d0e07c472e84e3", "committedDate": "2020-04-02T19:09:53Z", "message": "Fix a typo\n\nSigned-off-by: doxiao <dongbo.xiao@oracle.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NzQzMzQ3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1520#pullrequestreview-386743347", "createdAt": "2020-04-02T19:46:53Z", "commit": {"oid": "e79cc33d3636d9f17936db1880d0e07c472e84e3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4947, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}