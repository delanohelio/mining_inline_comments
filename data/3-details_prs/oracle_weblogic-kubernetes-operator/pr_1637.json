{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NDQ0NDcx", "number": 1637, "title": "retry for app deployment and other fixes", "bodyText": "add checks to resolve the managed server service names from admin pod\nprint cluster status in py script before deploy\nretry for app deployment\nfixed managed coherence and multiple cluster tests for pods ready check and services created check.\n\nWith all these changes, I see good results on cluster-10. On cluster-1(quicktest) there are still ~15 failures on this branch vs ~30 failures on develop branch.\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-quicktest/1464/\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-quicktest/1460/\nOnly two failures on cluster-10 - https://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-quicktest-10/74/", "createdAt": "2020-05-08T21:36:54Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1637", "merged": true, "mergeCommit": {"oid": "eb1e234bc728c142cc26fcfa6f75656e26959e89"}, "closed": true, "closedAt": "2020-05-14T16:23:28Z", "author": {"login": "vanajamukkara"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcdKiFdAH2gAyNDE1NDQ0NDcxOjNiZDgxZDMzNGZmMDhiZGZlZWZjMzc5ZTc2NTM4ODBhYzM2MmI4NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchTzgJAH2gAyNDE1NDQ0NDcxOmEyZWI2NTlhMTY5MTcwNDcwNzczZjAyNjAyMWM4N2ZjMzhmNmY1YWU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3bd81d334ff08bdfeefc379e7653880ac362b854", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3bd81d334ff08bdfeefc379e7653880ac362b854", "committedDate": "2020-05-01T23:46:10Z", "message": "adding check to resolve service name from admin pod, fixing tests to verify the servers/services are created"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b59f2d38cf4a57b6caf8b7b196e022f4d0c73f6", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3b59f2d38cf4a57b6caf8b7b196e022f4d0c73f6", "committedDate": "2020-05-03T23:38:57Z", "message": "try with precreate service"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "052fb85c04d994708b7fced6d277790b3b3555b5", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/052fb85c04d994708b7fced6d277790b3b3555b5", "committedDate": "2020-05-04T09:15:40Z", "message": "increasing timeout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ecab18fbe2c4c9eaf99e9ab1ae901239f637448", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0ecab18fbe2c4c9eaf99e9ab1ae901239f637448", "committedDate": "2020-05-04T10:16:03Z", "message": "fix cluster size properties based on model yaml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "086cd4988b5e1ecca743186fd99237fe307d1db9", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/086cd4988b5e1ecca743186fd99237fe307d1db9", "committedDate": "2020-05-06T03:16:17Z", "message": "adding retry for app deployment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e31f84935d505cdbfac3c1583e1f11d819916895", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e31f84935d505cdbfac3c1583e1f11d819916895", "committedDate": "2020-05-06T23:24:01Z", "message": "get events for ns"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f7bb6a8cefa643698cd4046b08d7056a8e0a77d", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7f7bb6a8cefa643698cd4046b08d7056a8e0a77d", "committedDate": "2020-05-07T02:27:25Z", "message": "fix events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb0e3f6e35c1a7e06b21374f3cf5bb69392baeb8", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/cb0e3f6e35c1a7e06b21374f3cf5bb69392baeb8", "committedDate": "2020-05-07T05:12:49Z", "message": "add break to loop if app depolyed"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52aec8bebbcc57596570d34864fa4cd089901575", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/52aec8bebbcc57596570d34864fa4cd089901575", "committedDate": "2020-05-07T06:10:27Z", "message": "fix multi cluster test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7234d86322d727d9c6ba47a378c8e94c704c7db", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e7234d86322d727d9c6ba47a378c8e94c704c7db", "committedDate": "2020-05-09T00:49:58Z", "message": "adding retry parameter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMzU0MjA3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1637#pullrequestreview-410354207", "createdAt": "2020-05-12T19:25:59Z", "commit": {"oid": "e7234d86322d727d9c6ba47a378c8e94c704c7db"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxOToyNTo1OVrOGUVnBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQxOToyNTo1OVrOGUVnBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk3ODc1OQ==", "bodyText": "Resole -> Resolve", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1637#discussion_r423978759", "createdAt": "2020-05-12T19:25:59Z", "author": {"login": "rjeberhard"}, "path": "integration-tests/src/test/java/oracle/kubernetes/operator/utils/TestUtils.java", "diffHunk": "@@ -228,6 +228,51 @@ public static void checkServiceCreated(String serviceName, String domainNS, int\n     }\n   }\n \n+  /**\n+   * Resole a servive name inside a pod.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7234d86322d727d9c6ba47a378c8e94c704c7db"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMzk5Mzc1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1637#pullrequestreview-410399375", "createdAt": "2020-05-12T20:32:08Z", "commit": {"oid": "e7234d86322d727d9c6ba47a378c8e94c704c7db"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDozMjowOFrOGUX2TA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQyMDozMjowOFrOGUX2TA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDAxNTQzNg==", "bodyText": "Surprisingly, this will break on k8s 1.16.  The kubectl exec command has always optionally taken a \"--\" as the separator between the kubectl arguments and the command that you want to run, but in 1.16 the parsing changes so that if you have this value it is taken as the beginning of the command.  We could fix this by always adding a \"--\" before the command on the kubectl exec command line.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1637#discussion_r424015436", "createdAt": "2020-05-12T20:32:08Z", "author": {"login": "rjeberhard"}, "path": "integration-tests/src/test/java/oracle/kubernetes/operator/utils/TestUtils.java", "diffHunk": "@@ -228,6 +228,51 @@ public static void checkServiceCreated(String serviceName, String domainNS, int\n     }\n   }\n \n+  /**\n+   * Resole a servive name inside a pod.\n+   * @param serviceName service name to resolve\n+   * @param podName name of the pod\n+   * @param namespace namespace of the pod\n+   * @throws Exception if a service name can not be resolved\n+   */\n+  public static void resolveServiceName(\n+      String serviceName, String podName, String namespace, int numberOfRetries)\n+      throws Exception {\n+\n+    String appLocationInPod = BaseTest.getAppLocationInPod();\n+    String scriptLocationInPod = appLocationInPod + \"/resolveServiceName.py\";\n+\n+    // copy py script to check if managed service name can be resolved in admin pod\n+    TestUtils.kubectlexec(podName, namespace,\" -- mkdir -p \" + appLocationInPod);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7234d86322d727d9c6ba47a378c8e94c704c7db"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMzk5NzY0", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1637#pullrequestreview-410399764", "createdAt": "2020-05-12T20:32:46Z", "commit": {"oid": "e7234d86322d727d9c6ba47a378c8e94c704c7db"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTQxMDI4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1637#pullrequestreview-411941028", "createdAt": "2020-05-14T15:48:25Z", "commit": {"oid": "a2eb659a169170470773f026021c87fc38f6f5ae"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTQxNDIy", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1637#pullrequestreview-411941422", "createdAt": "2020-05-14T15:48:49Z", "commit": {"oid": "a2eb659a169170470773f026021c87fc38f6f5ae"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2eb659a169170470773f026021c87fc38f6f5ae", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a2eb659a169170470773f026021c87fc38f6f5ae", "committedDate": "2020-05-14T20:50:02Z", "message": "fix typo"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4771, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}