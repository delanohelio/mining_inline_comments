{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1NDM0NDUw", "number": 1636, "title": "Create image with basic domain model in extension class", "bodyText": "Create image with basic domain model in ImageBuilders.java extension class and push to registry.\nModified ItMiiDomain.java to use the basic mii image\ndelete the operator and domain image in extension class\n\nJenkins results are clean on cluster-10 -\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-model-in-image-tests-10/50/\nand on kind cluster -\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/39/", "createdAt": "2020-05-08T21:08:05Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636", "merged": true, "mergeCommit": {"oid": "1b885832b1f9219bd3b20a6224e9dd652e54a74c"}, "closed": true, "closedAt": "2020-05-12T16:31:03Z", "author": {"login": "vanajamukkara"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfduV8AH2gAyNDE1NDM0NDUwOjU4MmYyOGFiZDIzZjBlZDhhYWYwZjk5OGU1MWY1YTlkZjRjNzlkNGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgtSiVAH2gAyNDE1NDM0NDUwOmJhMDBhNmE0NmIwZDdjOGNmOTU3NTVmNGJkMzE4OTI3ZTZmYzA2OGE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "582f28abd23f0ed8aaf0f998e51f5a9df4c79d4e", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/582f28abd23f0ed8aaf0f998e51f5a9df4c79d4e", "committedDate": "2020-05-09T03:15:36Z", "message": "creating mii basic image in extension class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdbc62816528c61d02894ce77dc62fa9bdab9c10", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/bdbc62816528c61d02894ce77dc62fa9bdab9c10", "committedDate": "2020-05-09T05:18:12Z", "message": "adding javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a7b4a24029f964cf4985ba1ba27d84ff68bad157", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a7b4a24029f964cf4985ba1ba27d84ff68bad157", "committedDate": "2020-05-09T06:11:28Z", "message": "delete images in close()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4Nzg4ODcy", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#pullrequestreview-408788872", "createdAt": "2020-05-10T22:47:20Z", "commit": {"oid": "805ac92a37d0345716bc2605e47117d784db4873"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQyMjo0NzoyMFrOGTIQsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMFQyMjo0NzoyMFrOGTIQsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjcxMTQ3Mg==", "bodyText": "The REPO_NAME will either be a value or empty, so please always add it.  We need this for the kind-based tests where there is no need for a REPO_USERNAME, but we do have a REPO_NAME.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r422711472", "createdAt": "2020-05-10T22:47:20Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/TestConstants.java", "diffHunk": "@@ -31,18 +33,34 @@\n       .orElse(REPO_DUMMY_VALUE);\n   public static final String REPO_EMAIL = Optional.ofNullable(System.getenv(\"REPO_EMAIL\"))\n       .orElse(REPO_DUMMY_VALUE);\n+\n+  // jenkins constants\n   public static final String BUILD_ID = Optional.ofNullable(System.getenv(\"BUILD_ID\"))\n       .orElse(\"\");\n   public static final String BRANCH_NAME_FROM_JENKINS = Optional.ofNullable(System.getenv(\"BRANCH\"))\n       .orElse(\"\");\n+\n   public static final String K8S_NODEPORT_HOST = Optional.ofNullable(System.getenv(\"K8S_NODEPORT_HOST\"))\n         .orElse(assertDoesNotThrow(() -> InetAddress.getLocalHost().getHostName()));\n   public static final String GOOGLE_REPO_URL = \"https://kubernetes-charts.storage.googleapis.com/\";\n   public static final String LOGS_DIR = System.getenv().getOrDefault(\"RESULT_ROOT\",\n       System.getProperty(\"java.io.tmpdir\")) + \"/diagnosticlogs\";\n   public static final String PV_ROOT = System.getenv().getOrDefault(\"PV_ROOT\",\n       System.getProperty(\"java.io.tmpdir\") + \"/ittestspvroot\");\n+\n+  // NGINX constants\n   public static final String NGINX_RELEASE_NAME = \"nginx-release\" + BUILD_ID;\n   public static final String STABLE_REPO_NAME = \"stable\";\n   public static final String NGINX_CHART_NAME = \"nginx-ingress\";\n+\n+  // MII image constants\n+  public static final String MII_BASIC_WDT_MODEL_FILE = \"model-basicdomain-singlecluster-sampleapp-wls.yaml\";\n+  public static final String MII_BASIC_IMAGE_NAME = REPO_USERNAME.equals(REPO_DUMMY_VALUE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "805ac92a37d0345716bc2605e47117d784db4873"}, "originalPosition": 35}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "683b535bec846ef101f03937bfed314c12ae6de6", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/683b535bec846ef101f03937bfed314c12ae6de6", "committedDate": "2020-05-11T04:52:11Z", "message": "move few constants from ItMiiDomain to TestConstants.java and renamed model yaml filename"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "805ac92a37d0345716bc2605e47117d784db4873", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/805ac92a37d0345716bc2605e47117d784db4873", "committedDate": "2020-05-11T06:19:54Z", "message": "sync with latest develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47665813b51f1a80870918e580b797c7916a6ed9", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/47665813b51f1a80870918e580b797c7916a6ed9", "committedDate": "2020-05-11T06:53:02Z", "message": "fix image name for kind cluster"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1f8f82cf6db481735bb9aac7aa3deb7752955438", "committedDate": "2020-05-11T06:57:59Z", "message": "fix image name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MzM2Mjc3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#pullrequestreview-409336277", "createdAt": "2020-05-11T16:31:37Z", "commit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNjozMTozOFrOGTkCJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNjozMTozOFrOGTkCJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE2NjUwMw==", "bodyText": "@vanajamukkara Did you test this ? when does this method gets invoked, at the end of the first class that creates the image or at the end of the last class that executes ?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r423166503", "createdAt": "2020-05-11T16:31:38Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/ImageBuilders.java", "diffHunk": "@@ -84,5 +120,64 @@ public void beforeAll(ExtensionContext context) {\n   @Override\n   public void close() {\n     logger.info(\"Cleanup images after all test suites are run\");\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "originalPosition": 95}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MzcyNDQ3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#pullrequestreview-409372447", "createdAt": "2020-05-11T17:19:01Z", "commit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzoxOTowMVrOGTl0xQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMVQxNzoxOTowMVrOGTl0xQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzE5NTg0NQ==", "bodyText": "can you log this as a message?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#discussion_r423195845", "createdAt": "2020-05-11T17:19:01Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/ImageBuilders.java", "diffHunk": "@@ -84,5 +120,64 @@ public void beforeAll(ExtensionContext context) {\n   @Override\n   public void close() {\n     logger.info(\"Cleanup images after all test suites are run\");\n+\n+    // delete mii basic image\n+    if (miiBasicImage != null) {\n+      deleteImage(miiBasicImage);\n+    }\n+\n+    // delete operator image\n+    if (operatorImage != null) {\n+      deleteImage(operatorImage);\n+    }\n+\n+  }\n+\n+  /**\n+   * Create image with basic domain model yaml and sample app.\n+   * @param imageName name of the image\n+   * @param imageTag tag of the image\n+   * @return true if image is created successfully\n+   */\n+  private boolean createMiiBasicImage(String imageName, String imageTag) {\n+\n+    final String image = imageName + \":\" + imageTag;\n+\n+    // build the model file list\n+    final List<String> modelList = Collections.singletonList(MODEL_DIR + \"/\" + MII_BASIC_WDT_MODEL_FILE);\n+\n+    // build an application archive using what is in resources/apps/APP_NAME", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "originalPosition": 121}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5MzcyNzQ0", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#pullrequestreview-409372744", "createdAt": "2020-05-11T17:19:24Z", "commit": {"oid": "1f8f82cf6db481735bb9aac7aa3deb7752955438"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49b10a122ea7855d2bb39902147ab22c18d20135", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/49b10a122ea7855d2bb39902147ab22c18d20135", "committedDate": "2020-05-12T02:49:53Z", "message": "adding log message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwMTM0MDgx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1636#pullrequestreview-410134081", "createdAt": "2020-05-12T15:00:56Z", "commit": {"oid": "49b10a122ea7855d2bb39902147ab22c18d20135"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba00a6a46b0d7c8cf95755f4bd318927e6fc068a", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ba00a6a46b0d7c8cf95755f4bd318927e6fc068a", "committedDate": "2020-05-12T23:57:38Z", "message": "merge with latest develop"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4768, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}