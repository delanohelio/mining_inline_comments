{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyNzE3NzEz", "number": 1951, "title": "Adding flexibility to integration tests to pull the base images from OCIR or OCR and more", "bodyText": "Integration tests can now pull the base images from OCIR or OCR, default is OCIR.\nRemoving the hard coded base image names.\nbase image(WLS, FWMINFRA, DB) names can now be set using env variables before running the tests, default values are image names on OCIR.\nSome refactoring to remove duplicate code from test classes.\nJenkins results\nhttps://build.weblogick8s.org:8443/job/wko-tmp/48/\nhttps://build.weblogick8s.org:8443/job/wko-tmp/49/\nhttps://build.weblogick8s.org:8443/job/wko-tmp/47/\nhttps://build.weblogick8s.org:8443/job/wko-tmp/46/", "createdAt": "2020-09-24T21:49:30Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1951", "merged": true, "mergeCommit": {"oid": "c55e13299025e27352962b7e9f967548179091d0"}, "closed": true, "closedAt": "2020-10-01T20:17:16Z", "author": {"login": "vanajamukkara"}, "timelineItems": {"totalCount": 28, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLG9fmAH2gAyNDkyNzE3NzEzOjU3MzlmMDUwNzU4NDBiNjM0YjQwYjc4ZDY0MWMzZmIxNGJlNDZlYTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdOXEglgFqTUwMDY3ODI2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5739f05075840b634b40b78d641c3fb14be46ea4", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5739f05075840b634b40b78d641c3fb14be46ea4", "committedDate": "2020-09-21T17:37:00Z", "message": "use secret based on base images repo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed798cf93f82ca562cb9d2206297bea704eb3c27", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ed798cf93f82ca562cb9d2206297bea704eb3c27", "committedDate": "2020-09-22T16:25:18Z", "message": "fix secrets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1704599b64cd79639edcbb9bf11bd7d323bcc889", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1704599b64cd79639edcbb9bf11bd7d323bcc889", "committedDate": "2020-09-22T16:26:16Z", "message": "fix secrets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad6fd809daf3f5930b030e3c02f8047497fc0733", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ad6fd809daf3f5930b030e3c02f8047497fc0733", "committedDate": "2020-09-22T20:37:47Z", "message": "fix more secrets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f6f8368c6b7c8b87795623c49f8c2b3988688cf7", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f6f8368c6b7c8b87795623c49f8c2b3988688cf7", "committedDate": "2020-09-22T21:52:40Z", "message": "more secret fixes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cddb92e0a66ac4a8026e183d420ca4f135c82044", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/cddb92e0a66ac4a8026e183d420ca4f135c82044", "committedDate": "2020-09-23T20:44:06Z", "message": "fixing image name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdcc75222d13af8c0490fcdaed64d5db54161a39", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/cdcc75222d13af8c0490fcdaed64d5db54161a39", "committedDate": "2020-09-24T02:43:50Z", "message": "sync to latest develop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca6ea99aad4ed71b665d7897f9ea8df7dc024ce7", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ca6ea99aad4ed71b665d7897f9ea8df7dc024ce7", "committedDate": "2020-09-24T02:59:58Z", "message": "fix compilation errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff5871e34372936265d14ac95275edad113ff598", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ff5871e34372936265d14ac95275edad113ff598", "committedDate": "2020-09-24T17:00:47Z", "message": "fix condition for exec"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "573208b616b1e966cb9c4fad8229ddc827c0cf63", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/573208b616b1e966cb9c4fad8229ddc827c0cf63", "committedDate": "2020-09-24T17:06:48Z", "message": "fix conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cfba3bbfa5dccc5edee799aa1fdf19b1c9b6745", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4cfba3bbfa5dccc5edee799aa1fdf19b1c9b6745", "committedDate": "2020-09-24T17:30:38Z", "message": "fix merge conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2ace72eb0b0a40b7b4ef7c5f9d6097d83a0c213", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a2ace72eb0b0a40b7b4ef7c5f9d6097d83a0c213", "committedDate": "2020-09-25T16:41:47Z", "message": "fix log messages in ItServerStartPolicy"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d93b804facb3eb49c8d3bf05009b377fe1376fd3", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d93b804facb3eb49c8d3bf05009b377fe1376fd3", "committedDate": "2020-09-25T16:46:44Z", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into owls65389"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07f78a8150c121b9f2db26ab59d0612f9cb2ecea", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/07f78a8150c121b9f2db26ab59d0612f9cb2ecea", "committedDate": "2020-09-28T16:20:48Z", "message": "some more refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "088b6af5bc76d4cdbbb12bda269c123c4510d133", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/088b6af5bc76d4cdbbb12bda269c123c4510d133", "committedDate": "2020-09-28T20:28:46Z", "message": "refactoring -move useSecret and deriving base image name logic to TestConstants"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce28cead05e1c3103713db8b6a09255c5e1a280d", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ce28cead05e1c3103713db8b6a09255c5e1a280d", "committedDate": "2020-09-28T20:33:53Z", "message": "fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fed199a1abb272904161dacf56293b14cfeaa0cf", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fed199a1abb272904161dacf56293b14cfeaa0cf", "committedDate": "2020-09-29T16:36:58Z", "message": "fix merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80d0835a3cff0e142162b07cda8a1fa7364b2286", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/80d0835a3cff0e142162b07cda8a1fa7364b2286", "committedDate": "2020-09-29T16:37:21Z", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into owls65389"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c9e495c292a9c071d364e7927d12b2c4848fbf0", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3c9e495c292a9c071d364e7927d12b2c4848fbf0", "committedDate": "2020-09-29T21:31:29Z", "message": "fix domain images repo for multi node cluster"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7b893cd1813a296716e9543a33b43ad80306c5c", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f7b893cd1813a296716e9543a33b43ad80306c5c", "committedDate": "2020-09-29T21:40:51Z", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into owls65389"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc92dd4eeac4e46b5303eb0fa6dbd26c28c069d4", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/bc92dd4eeac4e46b5303eb0fa6dbd26c28c069d4", "committedDate": "2020-09-30T20:31:42Z", "message": "set image pull secret always"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c097350e0132301ab4bee48beefe0bae1d988c5e", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c097350e0132301ab4bee48beefe0bae1d988c5e", "committedDate": "2020-09-30T20:55:50Z", "message": "fix domain images repo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "959fe8431ca73b7cc0bbb834569b951c100c5ef3", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/959fe8431ca73b7cc0bbb834569b951c100c5ef3", "committedDate": "2020-09-30T21:08:36Z", "message": "fix indentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e42ee99cacbca28139f298d1b0ab5016201bbbf", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6e42ee99cacbca28139f298d1b0ab5016201bbbf", "committedDate": "2020-09-30T21:57:33Z", "message": "change REPO env var to OCIR"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b06d74b61334be811a40f3e8ba8c75228b8e8622", "author": {"user": {"login": "vanajamukkara", "name": "Vanajakshi Mukkara"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b06d74b61334be811a40f3e8ba8c75228b8e8622", "committedDate": "2020-10-01T16:45:54Z", "message": "sync to latest develop and resolve conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNjUyODk5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1951#pullrequestreview-500652899", "createdAt": "2020-10-01T19:26:41Z", "commit": {"oid": "b06d74b61334be811a40f3e8ba8c75228b8e8622"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxOToyNjo0MVrOHbYBdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wMVQxOToyNjo0MVrOHbYBdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ2NzE5MA==", "bodyText": "Can you change this to WEBLOGIC_IMAGE_LOCAL as we discussed yesterday.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1951#discussion_r498467190", "createdAt": "2020-10-01T19:26:41Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/TestConstants.java", "diffHunk": "@@ -58,6 +75,63 @@\n   public static final String OCR_EMAIL = Optional.ofNullable(System.getenv(\"OCR_EMAIL\"))\n       .orElse(REPO_DUMMY_VALUE);\n \n+  // OCR default image values, these values will be used while running locally\n+  public static final String OCR_WEBLOGIC_IMAGE_NAME = \"weblogick8s/weblogic\";\n+  public static final String OCR_WEBLOGIC_IMAGE_TAG = \"12.2.1.4\";\n+  public static final String OCR_FMWINFRA_IMAGE_NAME = \"weblogick8s/fmw-infrastructure\";\n+  public static final String OCR_FMWINFRA_IMAGE_TAG = \"12.2.1.4\";\n+  public static final String OCR_DB_IMAGE_NAME = \"database/enterprise\";\n+  public static final String OCR_DB_IMAGE_TAG = \"12.2.0.1-slim\";\n+\n+  // ----------------------------- base images constants ---------------------\n+  // Get BASE_IMAGES_REPO from env var, if its not provided use OCIR as default to pull base images\n+  public static final String BASE_IMAGES_REPO = Optional.ofNullable(System.getenv(\"BASE_IMAGES_REPO\"))\n+      .orElse(OCIR_DEFAULT);\n+  // Use OCR secret name if OCR is used for base images, if not use OCIR secret name\n+  public static final String BASE_IMAGES_REPO_SECRET =\n+      BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_SECRET_NAME : OCIR_SECRET_NAME;\n+\n+  // Get WEBLOGIC_IMAGE_NAME/WEBLOGIC_IMAGE_TAG from env var, if its not provided and\n+  // if base images repo is OCR use OCR default image values\n+  // or if base images repo is OCIR use OCIR default image values\n+  public static final String WEBLOGIC_IMAGE_NAME\n+          = BASE_IMAGES_REPO + \"/\" + Optional.ofNullable(System.getenv(\"WEBLOGIC_IMAGE_NAME\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_WEBLOGIC_IMAGE_NAME : OCIR_WEBLOGIC_IMAGE_NAME);\n+  public static final String WEBLOGIC_IMAGE_TAG = Optional.ofNullable(System.getenv(\"WEBLOGIC_IMAGE_TAG\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_WEBLOGIC_IMAGE_TAG : OCIR_WEBLOGIC_IMAGE_TAG);\n+  public static final String WLS_UPDATE_IMAGE_TAG = \"14.1.1.0-11\";\n+\n+  // Get FMWINFRA_IMAGE_NAME/FMWINFRA_IMAGE_TAG from env var, if its not provided and\n+  // if base images repo is OCR use OCR default image values\n+  // or if base images repo is OCIR use OCIR default image values\n+  public static final String FMWINFRA_IMAGE_NAME\n+      = BASE_IMAGES_REPO + \"/\" + Optional.ofNullable(System.getenv(\"FMWINFRA_IMAGE_NAME\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_FMWINFRA_IMAGE_NAME : OCIR_FMWINFRA_IMAGE_NAME);\n+  public static final String FMWINFRA_IMAGE_TAG = Optional.ofNullable(System.getenv(\"FMWINFRA_IMAGE_TAG\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_FMWINFRA_IMAGE_TAG : OCIR_FMWINFRA_IMAGE_TAG);\n+\n+  // Get DB_IMAGE_NAME/DB_IMAGE_TAG from env var, if its not provided and\n+  // if base images repo is OCR use OCR default image values\n+  // or if base images repo is OCIR use OCIR default image values\n+  public static final String DB_IMAGE_NAME\n+      = BASE_IMAGES_REPO + \"/\" + Optional.ofNullable(System.getenv(\"DB_IMAGE_NAME\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_DB_IMAGE_NAME : OCIR_DB_IMAGE_NAME);\n+  public static final String DB_IMAGE_TAG = Optional.ofNullable(System.getenv(\"DB_IMAGE_TAG\"))\n+      .orElse(BASE_IMAGES_REPO.equals(OCR_REGISTRY) ? OCR_DB_IMAGE_TAG : OCIR_DB_IMAGE_TAG);\n+\n+  // For kind, replace repo name in image name with KIND_REPO, otherwise use the actual image name\n+  // For example, image container-registry.oracle.com/middleware/weblogic:12.2.1.4 will be pushed/used as\n+  // localhost:5000/middleware/weblogic:12.2.1.4 in kind and in non-kind cluster it will be used as is.\n+  public static final String WEBLOGIC_IMAGE_TO_USE_IN_SPEC = KIND_REPO != null ? KIND_REPO", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b06d74b61334be811a40f3e8ba8c75228b8e8622"}, "originalPosition": 115}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNjczNTc3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1951#pullrequestreview-500673577", "createdAt": "2020-10-01T19:57:54Z", "commit": {"oid": "b06d74b61334be811a40f3e8ba8c75228b8e8622"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAwNjc4MjYy", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1951#pullrequestreview-500678262", "createdAt": "2020-10-01T20:04:55Z", "commit": {"oid": "b06d74b61334be811a40f3e8ba8c75228b8e8622"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4189, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}