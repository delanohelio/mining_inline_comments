{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0ODg0NjE4", "number": 2065, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQyMDo1Mjo0N1rOE7tTPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQyMDo1OTowMFrOE7taOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDQzNjQ2OnYy", "diffSide": "RIGHT", "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQyMDo1Mjo0N1rOH3gXWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNzoxMToyMVrOH4XWXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2Mzk5Mg==", "bodyText": "This should be:\nif [ \"$(helm list --namespace $NSPACE| grep $NNAME |  wc -l)\" = 0 ]; then", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r527963992", "createdAt": "2020-11-20T20:52:47Z", "author": {"login": "xiancao"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -216,7 +245,8 @@ function createNginx() {\n \n   if [ \"$(helm list --namespace $NNAME | grep $NNAME |  wc -l)\" = 0 ]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 109}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg2NDg2Mw==", "bodyText": "done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r528864863", "createdAt": "2020-11-23T17:11:21Z", "author": {"login": "anpanigr"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -216,7 +245,8 @@ function createNginx() {\n \n   if [ \"$(helm list --namespace $NNAME | grep $NNAME |  wc -l)\" = 0 ]; then", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2Mzk5Mg=="}, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 109}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDQzOTI1OnYy", "diffSide": "RIGHT", "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQyMDo1Mzo0OFrOH3gZBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozMDo1M1rOH4Vokg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NDQyMQ==", "bodyText": "You can put these in one line", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r527964421", "createdAt": "2020-11-20T20:53:48Z", "author": {"login": "xiancao"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -228,7 +258,9 @@ function createNginx() {\n   count=0\n   tpod=$(kubectl get po -n ${NSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${NSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${NSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODgzNjc1NA==", "bodyText": "done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r528836754", "createdAt": "2020-11-23T16:30:53Z", "author": {"login": "anpanigr"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -228,7 +258,9 @@ function createNginx() {\n   count=0\n   tpod=$(kubectl get po -n ${NSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${NSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${NSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NDQyMQ=="}, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 123}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDQ0MTY5OnYy", "diffSide": "RIGHT", "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQyMDo1NDozN1rOH3gabQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozMTowOVrOH4Vpbw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NDc4MQ==", "bodyText": "typo here:\ninginx -> nginx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r527964781", "createdAt": "2020-11-20T20:54:37Z", "author": {"login": "xiancao"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -264,7 +296,7 @@ function main() {\n     usage\n   fi\n   if [ \"$2\" != traefik ] && [ \"$2\" != voyager ] && [ \"$2\" != nginx ]; then\n-    echo \"[ERROR] The second  parameter MUST be either traefik or voyager or inginx \"\n+    echo \"[ERROR] The second parameter MUST be either traefik, voyager or inginx \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 133}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODgzNjk3NQ==", "bodyText": "fixed the typo", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r528836975", "createdAt": "2020-11-23T16:31:09Z", "author": {"login": "anpanigr"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -264,7 +296,7 @@ function main() {\n     usage\n   fi\n   if [ \"$2\" != traefik ] && [ \"$2\" != voyager ] && [ \"$2\" != nginx ]; then\n-    echo \"[ERROR] The second  parameter MUST be either traefik or voyager or inginx \"\n+    echo \"[ERROR] The second parameter MUST be either traefik, voyager or inginx \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NDc4MQ=="}, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 133}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDQ0Mzg2OnYy", "diffSide": "RIGHT", "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQyMDo1NToxNFrOH3gbpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozMDozMFrOH4Vncg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NTA5NA==", "bodyText": "You can put these in one line", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r527965094", "createdAt": "2020-11-20T20:55:14Z", "author": {"login": "xiancao"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -71,17 +72,43 @@ function createVoyager() {\n   count=0\n   vpod=$(kubectl get po -n ${VSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${VSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${VSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODgzNjQ2Ng==", "bodyText": "done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r528836466", "createdAt": "2020-11-23T16:30:30Z", "author": {"login": "anpanigr"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -71,17 +72,43 @@ function createVoyager() {\n   count=0\n   vpod=$(kubectl get po -n ${VSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${VSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${VSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NTA5NA=="}, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDQ0OTMyOnYy", "diffSide": "RIGHT", "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQyMDo1NzowOFrOH3ge9Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozMDozNVrOH4VnrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NTk0MQ==", "bodyText": "You can put these in one line", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r527965941", "createdAt": "2020-11-20T20:57:08Z", "author": {"login": "xiancao"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -71,17 +72,43 @@ function createVoyager() {\n   count=0\n   vpod=$(kubectl get po -n ${VSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${VSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${VSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')\n+    if [ ${status} == \"1/1\" ]; then\n       echo \"Voyager operator pod is running now.\"\n       kubectl get pod/${vpod} -n ${VSPACE}\n-      exit 0;\n+      break;\n     fi\n     count=`expr $count + 1`\n     sleep 2\n   done\n-  echo \"ERROR: Voyager operator pod failed to start.\"\n-  kubectl describe pod/${vpod}  -n ${VSPACE}\n-  exit 1\n+  if test $count -eq $max; then\n+    echo \"ERROR: Voyager operator pod failed to start.\"\n+    exit 1\n+  fi\n+  kubectl describe pod/${vpod} -n ${VSPACE}\n+  helm list -n ${VSPACE}\n+  \n+  max=20\n+  count=0\n+  crd=\"ingresses.voyager.appscode.com\"\n+  echo \"Checking availability of Custom Resource Definition [${crd}]\"\n+  while test $count -lt $max; do\n+   obj=$(kubectl get crd ${crd} -n ${VSPACE} \\\n+          --no-headers 2>/dev/null | awk '{print $1}')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODgzNjUyNA==", "bodyText": "done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r528836524", "createdAt": "2020-11-23T16:30:35Z", "author": {"login": "anpanigr"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -71,17 +72,43 @@ function createVoyager() {\n   count=0\n   vpod=$(kubectl get po -n ${VSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${VSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${VSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')\n+    if [ ${status} == \"1/1\" ]; then\n       echo \"Voyager operator pod is running now.\"\n       kubectl get pod/${vpod} -n ${VSPACE}\n-      exit 0;\n+      break;\n     fi\n     count=`expr $count + 1`\n     sleep 2\n   done\n-  echo \"ERROR: Voyager operator pod failed to start.\"\n-  kubectl describe pod/${vpod}  -n ${VSPACE}\n-  exit 1\n+  if test $count -eq $max; then\n+    echo \"ERROR: Voyager operator pod failed to start.\"\n+    exit 1\n+  fi\n+  kubectl describe pod/${vpod} -n ${VSPACE}\n+  helm list -n ${VSPACE}\n+  \n+  max=20\n+  count=0\n+  crd=\"ingresses.voyager.appscode.com\"\n+  echo \"Checking availability of Custom Resource Definition [${crd}]\"\n+  while test $count -lt $max; do\n+   obj=$(kubectl get crd ${crd} -n ${VSPACE} \\\n+          --no-headers 2>/dev/null | awk '{print $1}')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NTk0MQ=="}, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 79}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDQ1MDY4OnYy", "diffSide": "RIGHT", "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQyMDo1NzozN1rOH3gfxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozMDo0MVrOH4Vn-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NjE1MA==", "bodyText": "you can put these in one line", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r527966150", "createdAt": "2020-11-20T20:57:37Z", "author": {"login": "xiancao"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -115,7 +142,9 @@ function createTraefik() {\n   count=0\n   tpod=$(kubectl get po -n ${TSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${TSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${TSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 102}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODgzNjYwMQ==", "bodyText": "done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r528836601", "createdAt": "2020-11-23T16:30:41Z", "author": {"login": "anpanigr"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -115,7 +142,9 @@ function createTraefik() {\n   count=0\n   tpod=$(kubectl get po -n ${TSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${TSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${TSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2NjE1MA=="}, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 102}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMDQ1NDM1OnYy", "diffSide": "RIGHT", "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQyMDo1OTowMFrOH3giHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjozMDo1OFrOH4Vo2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2Njc0OQ==", "bodyText": "change this to:\nkubectl exec -it $tpod -n ${NSPACE} -- /nginx-ingress-controller --version``", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r527966749", "createdAt": "2020-11-20T20:59:00Z", "author": {"login": "xiancao"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -228,7 +258,9 @@ function createNginx() {\n   count=0\n   tpod=$(kubectl get po -n ${NSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${NSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${NSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')\n+    if [ ${status} == \"1/1\" ]; then\n       echo \"Nginx operator pod is running now.\"\n       kubectl get pod/${tpod} -n ${NSPACE}\n       kubectl exec -it $tpod -n nginx -- /nginx-ingress-controller --version``", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 127}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODgzNjgyNA==", "bodyText": "done", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2065#discussion_r528836824", "createdAt": "2020-11-23T16:30:58Z", "author": {"login": "anpanigr"}, "path": "kubernetes/samples/charts/util/setupLoadBalancer.sh", "diffHunk": "@@ -228,7 +258,9 @@ function createNginx() {\n   count=0\n   tpod=$(kubectl get po -n ${NSPACE} --no-headers | awk '{print $1}')\n   while test $count -lt $max; do\n-    if test \"$(kubectl get po -n ${NSPACE} --no-headers | awk '{print $2}')\" = 1/1; then\n+    status=$(kubectl get po -n ${NSPACE} --no-headers 2> /dev/null \\\n+                | awk '{print $2}')\n+    if [ ${status} == \"1/1\" ]; then\n       echo \"Nginx operator pod is running now.\"\n       kubectl get pod/${tpod} -n ${NSPACE}\n       kubectl exec -it $tpod -n nginx -- /nginx-ingress-controller --version``", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzk2Njc0OQ=="}, "originalCommit": {"oid": "d1079c16d4f7efd23c18e08eb81df201b1005745"}, "originalPosition": 127}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3767, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}