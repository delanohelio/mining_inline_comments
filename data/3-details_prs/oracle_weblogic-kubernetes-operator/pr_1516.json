{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1ODI5NTgy", "number": 1516, "title": "Adding test assertions to new integration tests", "bodyText": "Adding test assertions", "createdAt": "2020-03-30T18:43:18Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1516", "merged": true, "mergeCommit": {"oid": "3ce9b4c62e5329868b65770dbfb725693248c527"}, "closed": true, "closedAt": "2020-03-31T16:28:36Z", "author": {"login": "sankarpn"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcSy-8-AH2gAyMzk1ODI5NTgyOmIyZTc5YmM1MDY1MTQ3MmFhZTk2NmQyNTM0ODExZDQyN2Q3OTEyYzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTFjafgH2gAyMzk1ODI5NTgyOjVlMzkyMTgxNWRkZTU1OGRjMWZmMTMwZWI3NWQxOGFmYzdkOWMwOWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b2e79bc50651472aae966d2534811d427d7912c8", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b2e79bc50651472aae966d2534811d427d7912c8", "committedDate": "2020-03-30T18:40:44Z", "message": "Adding test assertions to new integration tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2d38f54af81707806b5e62223ba5c75ae4081c1", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e2d38f54af81707806b5e62223ba5c75ae4081c1", "committedDate": "2020-03-30T18:44:42Z", "message": "fix copyright header"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MTMyODAz", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1516#pullrequestreview-384132803", "createdAt": "2020-03-30T18:45:12Z", "commit": {"oid": "b2e79bc50651472aae966d2534811d427d7912c8"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxODo0NToxM1rOF93WLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxODo0NjoxNlrOF93YgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxNDI1NA==", "bodyText": "Sentences start with a capital letter and end with a period.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1516#discussion_r400414254", "createdAt": "2020-03-30T18:45:13Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/assertions/TestAssertions.java", "diffHunk": "@@ -7,17 +7,109 @@\n import oracle.weblogic.kubernetes.assertions.impl.Operator;\n \n import java.util.concurrent.Callable;\n+import oracle.weblogic.kubernetes.assertions.impl.Kubernetes;\n \n // as in the actions, it is intended tests only use these assertaions and do\n // not go direct to the impl classes\n public class TestAssertions {\n \n-    public static Callable<Boolean> operatorIsRunning() {\n-        return Operator.isRunning();\n-    }\n+  /**\n+   * Check if Operator is running\n+   * @param namespace in which is operator is running\n+   * @return true if running false otherwise\n+   */\n+  public static Callable<Boolean> operatorIsRunning(String namespace) {\n+    return Operator.isRunning(namespace);\n+  }\n \n-    public static Callable<Boolean> domainExists(String domainUID, String namespace) {\n-        return Domain.exists(domainUID, namespace);\n-    }\n+  /**\n+   * check if operator Rest service is running\n+   * @param namespace the operator rest service exists\n+   * @return true if rest service is running otherwise false\n+   */\n+  public static boolean operatorRestServiceRunning(String namespace) {\n+    return Operator.isRestServiceCreated(namespace);\n+  }\n+\n+  /**\n+   * check if a weblogic custom resource domain exists in specified namespace and all its pods are running\n+   * @param domainUID ID of the domain\n+   * @param namespace in which the domain custom resource exists\n+   * @return true if domain exists and pods running otherwise false\n+   */\n+  public static Callable<Boolean> domainExists(String domainUID, String namespace) {\n+    return Domain.exists(domainUID, namespace);\n+  }\n+\n+  /**\n+   * check if a kubernetes pod is in running/ready state\n+   * @param podName name of the pod to check for\n+   * @param domainUID weblogic domain uid in which the pod belongs\n+   * @param namespace in which the pod is running\n+   * @return true if the pod is running otherwise false\n+   */\n+  public static Callable<Boolean> podReady(String podName, String domainUID, String namespace) {\n+    return Kubernetes.podRunning(podName, domainUID, namespace);\n+  }\n+\n+  /**\n+   * check if a pod given by the podName is in Terminating state\n+   * @param podName name of the pod to check for Terminating status\n+   * @param domainUID weblogic domain uid in which the pod belongs\n+   * @param namespace in which the pod is running\n+   * @return true if the pod is terminating otherwise false\n+   */\n+  public static Callable<Boolean> podTerminating(String podName, String domainUID, String namespace) {\n+    return Kubernetes.podTerminating(podName, domainUID, namespace);\n+  }\n+\n+  /**\n+   * check is a service exists in given namespace\n+   * @param serviceName  the name of the service to check for\n+   * @param namespace in which the service is running\n+   * @return true if the service exists otherwise false\n+   */\n+  public static boolean serviceReady(String serviceName, String namespace) {\n+    return Kubernetes.serviceCreated(serviceName, namespace);\n+  }\n+\n+  /**\n+   * check if a loadbalancer pod is ready", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2e79bc50651472aae966d2534811d427d7912c8"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxNDcyMw==", "bodyText": "is this a copy/paste error?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1516#discussion_r400414723", "createdAt": "2020-03-30T18:46:02Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/assertions/impl/Domain.java", "diffHunk": "@@ -1,26 +1,35 @@\n-// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Copyright 2020, Oracle Corporation and/or its affiliates.\n // Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n \n package oracle.weblogic.kubernetes.assertions.impl;\n \n-import java.util.Random;\n import java.util.concurrent.Callable;\n \n-import static oracle.weblogic.kubernetes.extensions.LoggedTest.logger;\n-\n public class Domain {\n \n-    public static Callable<Boolean> exists(String domainUID, String namespace) {\n-        return () -> {\n-            int outcome = new Random(System.currentTimeMillis()).nextInt(3);\n-            if (outcome == 1) {\n-                logger.info(String.format(\"Domain %s exists in namespace %s\", domainUID, namespace));\n-                return true;\n-            } else {\n-                logger.info(String.format(\"Domain %s does not exist in namespace %s\", domainUID, namespace));\n-                return false;\n-            }\n-        };\n-    }\n+  public static Callable<Boolean> exists(String domainUID, String namespace) {\n+    return () -> {\n+      String pods[] = {};\n+      for (String pod : pods) {\n+        if (!Kubernetes.podExists(pod, domainUID, namespace).call().booleanValue()) {\n+          return false;\n+        }\n+      }\n+      for (String pod : pods) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2e79bc50651472aae966d2534811d427d7912c8"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxNDc4MA==", "bodyText": "fix", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1516#discussion_r400414780", "createdAt": "2020-03-30T18:46:10Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/assertions/impl/Kubernetes.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * To change this license header, choose License Headers in Project Properties.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2e79bc50651472aae966d2534811d427d7912c8"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQxNDg0OA==", "bodyText": "fix", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1516#discussion_r400414848", "createdAt": "2020-03-30T18:46:16Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/assertions/impl/Kubernetes.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * To change this license header, choose License Headers in Project Properties.\n+ * To change this template file, choose Tools | Templates\n+ * and open the template in the editor.\n+ */\n+\n+package oracle.weblogic.kubernetes.assertions.impl;\n+\n+import java.util.concurrent.Callable;\n+\n+/**\n+ *", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2e79bc50651472aae966d2534811d427d7912c8"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce25e95f26b6c8a97e4d8e5999f540fdb30f0259", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ce25e95f26b6c8a97e4d8e5999f540fdb30f0259", "committedDate": "2020-03-30T18:55:59Z", "message": "fix namespace"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df97ffee8ca4718708ef88b84c8694856075b504", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/df97ffee8ca4718708ef88b84c8694856075b504", "committedDate": "2020-03-30T18:59:52Z", "message": "fix javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25dc752aa371a4860ea79057a48a217a151154a4", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/25dc752aa371a4860ea79057a48a217a151154a4", "committedDate": "2020-03-30T19:18:46Z", "message": "remove podExists check"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0MTY0MTQ4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1516#pullrequestreview-384164148", "createdAt": "2020-03-30T19:29:19Z", "commit": {"oid": "25dc752aa371a4860ea79057a48a217a151154a4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3644145b231ce1c1885e4e8ee76f1d98afe1ea5", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d3644145b231ce1c1885e4e8ee76f1d98afe1ea5", "committedDate": "2020-03-30T20:06:11Z", "message": "change weblogic to WebLogic and kubernetes to Kubernetes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0Mjg4NjIy", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1516#pullrequestreview-384288622", "createdAt": "2020-03-30T22:52:37Z", "commit": {"oid": "d3644145b231ce1c1885e4e8ee76f1d98afe1ea5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2ab963098b26a5b0d47d1943056ddc11e5d04cb", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a2ab963098b26a5b0d47d1943056ddc11e5d04cb", "committedDate": "2020-03-31T15:34:24Z", "message": "Merge branch 'mii-new-integration-tests' into mii-junit-sankar"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b20377bf8a0a28b7a263b60a91b53acd058be24d", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b20377bf8a0a28b7a263b60a91b53acd058be24d", "committedDate": "2020-03-31T15:56:18Z", "message": "fix formatting"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "636c5f17837309804773ec5609321d31447ae51a", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/636c5f17837309804773ec5609321d31447ae51a", "committedDate": "2020-03-31T16:16:53Z", "message": "order import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e3921815dde558dc1ff130eb75d18afc7d9c09b", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5e3921815dde558dc1ff130eb75d18afc7d9c09b", "committedDate": "2020-03-31T16:18:51Z", "message": "fix formatting"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4938, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}