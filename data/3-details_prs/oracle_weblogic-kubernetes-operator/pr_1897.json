{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4MTM0NDM4", "number": 1897, "title": "Change REST API query to handle hyphen, WebLogic Logging Exporter", "bodyText": "Issue: after upgrading to ELK Stack v7, the query using REST API that contains \"managed-server\" doesn't work properly and return all data from Elasticsearch repository that contain the word \"managed\". e.g. a REST API query requesting all data that contains \"serverName = managed-server1:\ncurl --connect-timeout 5 --max-time 5 -X GET http://elasticsearch.default.svc.cluster.local:9200/wls/_count?q=serverName:managed-server1\n\nIt actually returns all data that contain \"serverName = managed\"\n\n\nThe issue appears since ELK Stack version 7.0.0\n\n\nCause: per the doc https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html, hyphen/dash is a reserved characters since ELK Stack 7 and later\n\n\nThere are several ways to escape the reserved char like hyphen. This test chooses to use the query below\n\n\ncurl --connect-timeout 5 --max-time 5 -X GET  \"http://elasticsearch.default.svc.cluster.local:9200/wls/doc/_count?pretty\" -H 'Content-Type: application/json' -d '\n{\n\"query\" : {\n\"query_string\" :\n{ \"query\" : \"managed-server1\",\n\"fields\" : [\"serverName\"],\n\"default_operator\": \"AND\" }\n}\n}'\nJenkins job passed:\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/1963/\nand ItElsaticTest passed by itself\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/1810/", "createdAt": "2020-09-02T20:01:44Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1897", "merged": true, "mergeCommit": {"oid": "4d6617e4b9291cd31d0c91323f7267ec96a5078c"}, "closed": true, "closedAt": "2020-09-17T14:54:47Z", "author": {"login": "hzhao-github"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFAnPVgH2gAyNDc4MTM0NDM4OjFjODQ3YmJhZDAzNmI4YjBkOWIyZjJkZDY0YjNjNGU2MmE3Zjg3NWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdJyPJUgH2gAyNDc4MTM0NDM4OmU5NTdlODZiZTExYmRhYjMzMTNmM2YzYjQ4MjMxMGE2NjQ0NWNmMWM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1c847bbad036b8b0d9b2f2dd64b3c4e62a7f875a", "author": {"user": {"login": "hzhao-github", "name": "Huiling Zhao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1c847bbad036b8b0d9b2f2dd64b3c4e62a7f875a", "committedDate": "2020-09-02T18:49:43Z", "message": "Change REST API query to handle hyphen, WebLogic Logging Exporter jenkins-ignore"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0MzA3NTE5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1897#pullrequestreview-484307519", "createdAt": "2020-09-08T16:28:10Z", "commit": {"oid": "1c847bbad036b8b0d9b2f2dd64b3c4e62a7f875a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNjoyODoxMFrOHOlDVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOFQxNjoyODoxMFrOHOlDVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTA0OTE3Mg==", "bodyText": "Remove commented code", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1897#discussion_r485049172", "createdAt": "2020-09-08T16:28:10Z", "author": {"login": "anpanigr"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItElasticLogging.java", "diffHunk": "@@ -302,9 +302,14 @@ public void testWlsLoggingExporter() throws Exception {\n     // curl -X GET http://elasticsearch.default.svc.cluster.local:9200/wls/_count?q=serverName:managed-server1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c847bbad036b8b0d9b2f2dd64b3c4e62a7f875a"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaabc7a852e1cd9162cf8b56eccd3316bd4ed0a7", "author": {"user": {"login": "hzhao-github", "name": "Huiling Zhao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/aaabc7a852e1cd9162cf8b56eccd3316bd4ed0a7", "committedDate": "2020-09-09T00:09:07Z", "message": "Removed some comments jenkins-ignore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d116521e40ea5083912e6e92b9cd28de6a4ecfb", "author": {"user": {"login": "hzhao-github", "name": "Huiling Zhao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1d116521e40ea5083912e6e92b9cd28de6a4ecfb", "committedDate": "2020-09-15T19:00:58Z", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into junit5-wlslogging-tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bdacdc888c41cb5fa126d87c147f474c5529c10", "author": {"user": {"login": "hzhao-github", "name": "Huiling Zhao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1bdacdc888c41cb5fa126d87c147f474c5529c10", "committedDate": "2020-09-15T19:30:30Z", "message": "Syncup with latest develop branch jenkins-ignore"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5OTM0NTU2", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1897#pullrequestreview-489934556", "createdAt": "2020-09-16T18:56:40Z", "commit": {"oid": "1bdacdc888c41cb5fa126d87c147f474c5529c10"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkwMDEzMjI1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1897#pullrequestreview-490013225", "createdAt": "2020-09-16T20:54:47Z", "commit": {"oid": "1bdacdc888c41cb5fa126d87c147f474c5529c10"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e957e86be11bdab3313f3f3b482310a66445cf1c", "author": {"user": {"login": "rjeberhard", "name": "Ryan Eberhard"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e957e86be11bdab3313f3f3b482310a66445cf1c", "committedDate": "2020-09-17T14:54:21Z", "message": "Merge with develop"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4106, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}