{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzNDA3NzIw", "number": 1562, "title": "Adding diagnostic log collection feature to integration tests", "bodyText": "The feature automatically enables all the integration to collect logs when it fails.", "createdAt": "2020-04-14T20:51:13Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562", "merged": true, "mergeCommit": {"oid": "5e6db78b2e8f304a1dad20f5e232d164e19dbba5"}, "closed": true, "closedAt": "2020-04-22T20:06:40Z", "author": {"login": "sankarpn"}, "timelineItems": {"totalCount": 70, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcXa68JgH2gAyNDAzNDA3NzIwOjQ3OTM4NmVjMGM0OTYyNjBkNjQ2ODE4YmQwZTRhNWIxNTQyNjkxMzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaN470AFqTM5ODUzNjk5MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "479386ec0c496260d646818bd0e4a5b154269134", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/479386ec0c496260d646818bd0e4a5b154269134", "committedDate": "2020-04-14T03:28:15Z", "message": "Adding diagnostic features to integration test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbaf7a22a84af5603b29a1f106674fa548ffcacf", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/bbaf7a22a84af5603b29a1f106674fa548ffcacf", "committedDate": "2020-04-14T03:57:57Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "982f386db010bb9d920d76ebdb40d7ce531cb3ca", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/982f386db010bb9d920d76ebdb40d7ce531cb3ca", "committedDate": "2020-04-14T04:03:55Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f90145459fd402bf983824b8e4f188a44a30bc86", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f90145459fd402bf983824b8e4f188a44a30bc86", "committedDate": "2020-04-14T04:05:27Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bd0f84fc36adaff6900223dca211d2aa0f1bbfe", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6bd0f84fc36adaff6900223dca211d2aa0f1bbfe", "committedDate": "2020-04-14T04:23:49Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b3e2381bbedcb1cc00845ae0eb57e20cb979aa44", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b3e2381bbedcb1cc00845ae0eb57e20cb979aa44", "committedDate": "2020-04-14T06:49:10Z", "message": "initial implementation of diagnostic logging"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "792ca7f29f6c85c426e4fc15f9df0ced53a2255f", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/792ca7f29f6c85c426e4fc15f9df0ced53a2255f", "committedDate": "2020-04-14T17:59:21Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd639a4988a3cbfe55f23d96746543230893c8a4", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/cd639a4988a3cbfe55f23d96746543230893c8a4", "committedDate": "2020-04-14T18:47:04Z", "message": "changed the implementation to use LifecycleMethodExecutionExceptionHandler"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf4687aa59af17c94b5b8297be83dd8bad172d52", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/bf4687aa59af17c94b5b8297be83dd8bad172d52", "committedDate": "2020-04-14T20:45:56Z", "message": "Added javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41ac7400ade6fb0324c2fe2c0843d84931196041", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/41ac7400ade6fb0324c2fe2c0843d84931196041", "committedDate": "2020-04-14T21:00:35Z", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into tests-diagnostics2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMjk1MDU5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-393295059", "createdAt": "2020-04-14T21:05:24Z", "commit": {"oid": "41ac7400ade6fb0324c2fe2c0843d84931196041"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQyMTowNToyNFrOGFg4dQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQyMTowNToyNFrOGFg4dQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODQzNDgwNQ==", "bodyText": "The above tagging won't be necessary if the decision is to use LogginUtil.getNSListIntersecting( )\nPlease add your review comments as to which way to use to get the namespace list.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r408434805", "createdAt": "2020-04-14T21:05:24Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItSimpleOperatorValidation.java", "diffHunk": "@@ -56,12 +58,16 @@\n @ExtendWith(Timing.class)\n // by implementing the LoggedTest, we will automatically get a logger injected and it\n // will also automatically log entry/exit messages for each test method.\n+@ExtendWith(IntegrationTestWatcher.class)\n class ItSimpleOperatorValidation implements LoggedTest {\n \n   private HelmParams opHelmParams = null;\n   private V1ServiceAccount serviceAccount = null;\n+  @NamespaceList\n   private String opNamespace = null;\n+  @NamespaceList\n   private String domainNamespace1 = null;\n+  @NamespaceList", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41ac7400ade6fb0324c2fe2c0843d84931196041"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7205e091ea1a6559c7ac01af786524e2c4fcb2e", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b7205e091ea1a6559c7ac01af786524e2c4fcb2e", "committedDate": "2020-04-14T21:07:12Z", "message": "fix newline"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMzAwNzI1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-393300725", "createdAt": "2020-04-14T21:14:31Z", "commit": {"oid": "b7205e091ea1a6559c7ac01af786524e2c4fcb2e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQyMToxNDozMVrOGFhLbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQyMToxNjoxM1rOGFhOng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODQzOTY2MA==", "bodyText": "this is not what i was looking for, let's discuss at the daily meeting", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r408439660", "createdAt": "2020-04-14T21:14:31Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItSimpleOperatorValidation.java", "diffHunk": "@@ -56,12 +58,16 @@\n @ExtendWith(Timing.class)\n // by implementing the LoggedTest, we will automatically get a logger injected and it\n // will also automatically log entry/exit messages for each test method.\n+@ExtendWith(IntegrationTestWatcher.class)\n class ItSimpleOperatorValidation implements LoggedTest {\n \n   private HelmParams opHelmParams = null;\n   private V1ServiceAccount serviceAccount = null;\n+  @NamespaceList\n   private String opNamespace = null;\n+  @NamespaceList\n   private String domainNamespace1 = null;\n+  @NamespaceList", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODQzNDgwNQ=="}, "originalCommit": {"oid": "41ac7400ade6fb0324c2fe2c0843d84931196041"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODQzOTg4NQ==", "bodyText": "fix javadoc", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r408439885", "createdAt": "2020-04-14T21:15:00Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -191,8 +228,18 @@ public static List listDeployments() {\n     return new ArrayList();\n   }\n \n-  // --------------------------- pods -----------------------------------------\n+  /**\n+   * List all deployments in a given namespace", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7205e091ea1a6559c7ac01af786524e2c4fcb2e"}, "originalPosition": 100}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODQ0MDMyMg==", "bodyText": "fix", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r408440322", "createdAt": "2020-04-14T21:15:52Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -621,19 +775,27 @@ public static boolean deleteSecret(String name, String namespace) throws ApiExce\n     if (response.getObject() != null) {\n       logger.info(\n           \"Received after-deletion status of the requested object, will be deleting \"\n-              + \"secret in background!\");\n+          + \"secret in background!\");\n     }\n \n     return true;\n   }\n \n-  // --------------------------- pv/pvc ---------------------------\n+  /**\n+   * List secrets in a given namespace", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7205e091ea1a6559c7ac01af786524e2c4fcb2e"}, "originalPosition": 536}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODQ0MDQ3OA==", "bodyText": "fix", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r408440478", "createdAt": "2020-04-14T21:16:13Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -733,21 +906,40 @@ public static boolean deletePvc(String name, String namespace)\n     if (!response.isSuccess()) {\n       logger.warning(\n           \"Failed to delete persistent volume claim '\" + name + \"' from namespace: \"\n-              + namespace + \" with HTTP status code: \" + response.getHttpStatusCode());\n+          + namespace + \" with HTTP status code: \" + response.getHttpStatusCode());\n       return false;\n     }\n \n     if (response.getObject() != null) {\n       logger.info(\n           \"Received after-deletion status of the requested object, will be deleting \"\n-              + \"persistent volume claim in background!\");\n+          + \"persistent volume claim in background!\");\n     }\n \n     return true;\n   }\n \n-  // --------------------------- service account ---------------------------\n+  /**\n+   * List all persistent volumes", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b7205e091ea1a6559c7ac01af786524e2c4fcb2e"}, "originalPosition": 653}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "097c03845a5208be14f945917e217971e7d22e8a", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/097c03845a5208be14f945917e217971e7d22e8a", "committedDate": "2020-04-14T21:55:50Z", "message": "fixed javadocs in Kubernetes.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b35df6ec3b32accebd456716f6ff42c9c44813a5", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b35df6ec3b32accebd456716f6ff42c9c44813a5", "committedDate": "2020-04-14T23:29:57Z", "message": "debuggging"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzNDMxNTcw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-393431570", "createdAt": "2020-04-15T03:24:04Z", "commit": {"oid": "b35df6ec3b32accebd456716f6ff42c9c44813a5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwMzoyNDowNFrOGFoblQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwMzoyNDowNFrOGFoblQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODU1ODQ4NQ==", "bodyText": "What should be log directory I should be using here ?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r408558485", "createdAt": "2020-04-15T03:24:04Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/IntegrationTestWatcher.java", "diffHunk": "@@ -0,0 +1,266 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.extensions;\n+\n+import java.io.IOException;\n+import java.lang.reflect.Method;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import oracle.weblogic.kubernetes.utils.LoggingUtil;\n+import org.junit.jupiter.api.extension.AfterAllCallback;\n+import org.junit.jupiter.api.extension.AfterEachCallback;\n+import org.junit.jupiter.api.extension.BeforeAllCallback;\n+import org.junit.jupiter.api.extension.BeforeEachCallback;\n+import org.junit.jupiter.api.extension.BeforeTestExecutionCallback;\n+import org.junit.jupiter.api.extension.ExtensionContext;\n+import org.junit.jupiter.api.extension.InvocationInterceptor;\n+import org.junit.jupiter.api.extension.LifecycleMethodExecutionExceptionHandler;\n+import org.junit.jupiter.api.extension.ReflectiveInvocationContext;\n+import org.junit.jupiter.api.extension.TestExecutionExceptionHandler;\n+import org.junit.jupiter.api.extension.TestWatcher;\n+\n+import static oracle.weblogic.kubernetes.extensions.LoggedTest.logger;\n+\n+/**\n+ * JUnit5 extension class to intercept test execution at various\n+ * levels and collect logs in Kubernetes cluster for all artifacts\n+ * in the namespace used by the tests. The tests has to tag their classes\n+ * with @ExtendWith(IntegrationTestWatcher.class) for the automatic log\n+ * collection to work.\n+ */\n+public class IntegrationTestWatcher implements\n+    AfterAllCallback,\n+    AfterEachCallback,\n+    BeforeAllCallback,\n+    BeforeEachCallback,\n+    BeforeTestExecutionCallback,\n+    InvocationInterceptor,\n+    LifecycleMethodExecutionExceptionHandler,\n+    TestExecutionExceptionHandler,\n+    TestWatcher {\n+\n+  private String className;\n+  private String methodName;\n+  private static final String LOGS_DIR = System.getProperty(\"java.io.tmpdir\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b35df6ec3b32accebd456716f6ff42c9c44813a5"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzNDM0MTAx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-393434101", "createdAt": "2020-04-15T03:33:55Z", "commit": {"oid": "b35df6ec3b32accebd456716f6ff42c9c44813a5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwMzozMzo1NVrOGFok4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQwMzozMzo1NVrOGFok4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODU2MDg2Nw==", "bodyText": "what should be property I should be using here ?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r408560867", "createdAt": "2020-04-15T03:33:55Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/LoggingUtil.java", "diffHunk": "@@ -0,0 +1,197 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.io.IOException;\n+import java.lang.reflect.Field;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.text.SimpleDateFormat;\n+import java.util.Date;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import io.kubernetes.client.openapi.models.V1Pod;\n+import io.kubernetes.client.openapi.models.V1PodList;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+import oracle.weblogic.kubernetes.annotations.NamespaceList;\n+\n+import static io.kubernetes.client.util.Yaml.dump;\n+import static oracle.weblogic.kubernetes.extensions.LoggedTest.logger;\n+\n+/**\n+ * A utility class to collect log messages from Kubernetes cluster.\n+ */\n+public class LoggingUtil {\n+\n+  private static final String LOGS_DIR = System.getProperty(\"java.io.tmpdir\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b35df6ec3b32accebd456716f6ff42c9c44813a5"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "622175e10a1333878489eeb782f9b6be55d93776", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/622175e10a1333878489eeb782f9b6be55d93776", "committedDate": "2020-04-15T04:17:04Z", "message": "fix javadocs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0065c45ce50474d7a7d7e33a97563bcb002355c", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c0065c45ce50474d7a7d7e33a97563bcb002355c", "committedDate": "2020-04-16T15:35:02Z", "message": "Merge branch 'develop' into tests-diagnostics2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c74956828ce8383c8f85e544426240c9bb58030", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/9c74956828ce8383c8f85e544426240c9bb58030", "committedDate": "2020-04-17T01:10:26Z", "message": "changed the implmentation for namespace collectioin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "921ae914edd3bd7f57b64ab316a6c8a75034de2c", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/921ae914edd3bd7f57b64ab316a6c8a75034de2c", "committedDate": "2020-04-17T01:11:40Z", "message": "Merge branch 'develop' into tests-diagnostics2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81b824c7baed769decdc111f6edec4d0e23e8943", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/81b824c7baed769decdc111f6edec4d0e23e8943", "committedDate": "2020-04-17T01:32:09Z", "message": "added test status overrides"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea9174a3067ea042de8c26fe20659aa1416479aa", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ea9174a3067ea042de8c26fe20659aa1416479aa", "committedDate": "2020-04-17T02:30:03Z", "message": "Fix javadocs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c738420969a164df7aeac011cbe060f3bd42c01", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5c738420969a164df7aeac011cbe060f3bd42c01", "committedDate": "2020-04-17T02:54:00Z", "message": "Fix for the empty namespace list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f637150a0cc781af3181dcc93f978328b6eba1d1", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f637150a0cc781af3181dcc93f978328b6eba1d1", "committedDate": "2020-04-17T02:55:25Z", "message": "remove debug code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "04fad989601658544a886ee2ef522310329978fc", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/04fad989601658544a886ee2ef522310329978fc", "committedDate": "2020-04-17T20:46:27Z", "message": "Get domain object lists using CustomObjectsApi"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1Nzc5NDY3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-395779467", "createdAt": "2020-04-17T21:19:57Z", "commit": {"oid": "04fad989601658544a886ee2ef522310329978fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMToxOTo1N1rOGHdblQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMToxOTo1N1rOGHdblQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ3NTQxMw==", "bodyText": "numofns is kind of cryptic.  Is there a reason not to make this more verbose?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r410475413", "createdAt": "2020-04-17T21:19:57Z", "author": {"login": "ddsharpe"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiDomain.java", "diffHunk": "@@ -83,6 +84,8 @@\n @TestMethodOrder(MethodOrderer.OrderAnnotation.class)\n @DisplayName(\"Test to create model in image domain and start the domain\")\n @ExtendWith(Timing.class)\n+@ExtendWith(IntegrationTestWatcher.class)\n+@ITNamespaces(numofns = 2)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "04fad989601658544a886ee2ef522310329978fc"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be1cebc1f0447b1ee6ad1f6673375696a24a76fe", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/be1cebc1f0447b1ee6ad1f6673375696a24a76fe", "committedDate": "2020-04-17T22:01:28Z", "message": "Catch the exception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f795f98f6a1eb5440a30ef5cdf795a05f0acd7d0", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f795f98f6a1eb5440a30ef5cdf795a05f0acd7d0", "committedDate": "2020-04-17T22:01:42Z", "message": "Merge branch 'develop' into tests-diagnostics2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1ODAyODM0", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-395802834", "createdAt": "2020-04-17T22:13:23Z", "commit": {"oid": "04fad989601658544a886ee2ef522310329978fc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMjoxMzo0M1rOGHeoIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QyMjoxMzo0M1rOGHeoIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ5NTAxMQ==", "bodyText": "Wouldn't this annotation be better on the method using it?\nLike:\npublic void testCreatingDomain(@ITNamespaces(numofns = 1) List namespaces)", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r410495011", "createdAt": "2020-04-17T22:13:43Z", "author": {"login": "ddsharpe"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItSimpleDomainValidation.java", "diffHunk": "@@ -34,19 +39,23 @@\n \n @DisplayName(\"Simple validation of basic domain functions\")\n @IntegrationTest\n+//Every test class needs to tagged with this annotation for log collection and namespace creation.\n+@ExtendWith(IntegrationTestWatcher.class)\n+// The ITNamespaces numofns value is used to create the number of unique namespaces needed by the test.\n+// The namespace list is available for use by all methods in the test class.\n+@ITNamespaces(numofns = 1) //", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f795f98f6a1eb5440a30ef5cdf795a05f0acd7d0"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/43e86cf288fce78a347e854a338c8120d0e67d3f", "committedDate": "2020-04-17T22:16:56Z", "message": "Remove double message logging"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2NjAyNzU3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-396602757", "createdAt": "2020-04-20T16:11:12Z", "commit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNjoxMToxMlrOGIcVAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQxNjoyNDoyOVrOGIc7YQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUwNTkyMA==", "bodyText": "maybe we should just have a single extension - are there example of when we would would want one of these but not the other @ddsharpe @rjeberhard? i can't think of any", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411505920", "createdAt": "2020-04-20T16:11:12Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiDomain.java", "diffHunk": "@@ -83,6 +84,8 @@\n @TestMethodOrder(MethodOrderer.OrderAnnotation.class)\n @DisplayName(\"Test to create model in image domain and start the domain\")\n @ExtendWith(Timing.class)\n+@ExtendWith(IntegrationTestWatcher.class)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUwNjI5MQ==", "bodyText": "can't it just be Namespaces(2) ?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411506291", "createdAt": "2020-04-20T16:11:41Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiDomain.java", "diffHunk": "@@ -83,6 +84,8 @@\n @TestMethodOrder(MethodOrderer.OrderAnnotation.class)\n @DisplayName(\"Test to create model in image domain and start the domain\")\n @ExtendWith(Timing.class)\n+@ExtendWith(IntegrationTestWatcher.class)\n+@ITNamespaces(numofns = 2)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ3NTQxMw=="}, "originalCommit": {"oid": "04fad989601658544a886ee2ef522310329978fc"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUwNjcwMQ==", "bodyText": "can you change the initAll method signature?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411506701", "createdAt": "2020-04-20T16:12:12Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiDomain.java", "diffHunk": "@@ -120,22 +123,18 @@\n    * Install Operator.\n    */\n   @BeforeAll\n-  public static void initAll() {\n+  public static void initAll(List namespaces) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUwNzI1Nw==", "bodyText": "needs null check", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411507257", "createdAt": "2020-04-20T16:12:59Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiDomain.java", "diffHunk": "@@ -120,22 +123,18 @@\n    * Install Operator.\n    */\n   @BeforeAll\n-  public static void initAll() {\n+  public static void initAll(List namespaces) {\n     // create standard, reusbale retry/backoff policy\n     withStandardRetryPolicy = with().pollDelay(2, SECONDS)\n         .and().with().pollInterval(10, SECONDS)\n         .atMost(5, MINUTES).await();\n \n     // get a new unique opNamespace\n     logger.info(\"Creating unique namespace for Operator\");\n-    opNamespace = assertDoesNotThrow(() -> createUniqueNamespace(),\n-        \"Failed to create unique namespace due to ApiException\");\n-    logger.info(\"Created a new namespace called {0}\", opNamespace);\n+    opNamespace = (String)namespaces.get(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUxMzU5NA==", "bodyText": "if it is true/false, then why is it null?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411513594", "createdAt": "2020-04-20T16:21:33Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -216,18 +258,24 @@ public static String getPodLog(String name, String namespace) throws ApiExceptio\n    */\n   public static String getPodLog(String name, String namespace, String container)\n       throws ApiException {\n-    String log = coreV1Api.readNamespacedPodLog(\n-        name, // name of the Pod\n-        namespace, // name of the Namespace\n-        container, // container for which to stream logs\n-        null, //  true/false Follow the log stream of the pod\n-        null, // number of bytes to read from the server before terminating the log output\n-        PRETTY, // pretty print output\n-        null, // true/false, Return previous terminated container logs\n-        null, // relative time (seconds) before the current time from which to show logs\n-        null, // number of lines from the end of the logs to show\n-        null // true/false, add timestamp at the beginning of every line of log output\n-    );\n+    String log = null;\n+    try {\n+      log = coreV1Api.readNamespacedPodLog(\n+          name, // name of the Pod\n+          namespace, // name of the Namespace\n+          container, // container for which to stream logs\n+          null, //  true/false Follow the log stream of the pod\n+          null, // number of bytes to read from the server before terminating the log output\n+          PRETTY, // pretty print output\n+          null, // true/false, Return previous terminated container logs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "originalPosition": 138}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUxMzkyMA==", "bodyText": "missing @returns", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411513920", "createdAt": "2020-04-20T16:22:01Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -257,8 +304,37 @@ public static boolean deletePod(String name, String namespace) throws ApiExcepti\n     return true;\n   }\n \n-  // --------------------------- namespaces -----------------------------------\n+  /**\n+   * List all pods in given namespace.\n+   *\n+   * @param namespace Namespace in which to list all pods\n+   * @param labelSelectors with which the pods are decorated\n+   * @throws ApiException when there is error in querying the cluster", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "originalPosition": 171}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUxNDU3NQ==", "bodyText": "don't swallow the stack trace", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411514575", "createdAt": "2020-04-20T16:22:56Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -468,12 +598,73 @@ public static Domain getDomainCustomResource(String domainUID, String namespace)\n    * @return List of Domain Custom Resources\n    */\n   public static DomainList listDomains(String namespace) {\n-    KubernetesApiResponse<DomainList> response = crdClient.list(namespace);\n+    KubernetesApiResponse<DomainList> response = null;\n+    try {\n+      response = crdClient.list(namespace);\n+    } catch (Exception ex) {\n+      logger.warning(ex.getMessage());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "originalPosition": 415}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUxNTc0NQ==", "bodyText": "does this handle all namespaces?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411515745", "createdAt": "2020-04-20T16:24:29Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -733,21 +960,38 @@ public static boolean deletePvc(String name, String namespace)\n     if (!response.isSuccess()) {\n       logger.warning(\n           \"Failed to delete persistent volume claim '\" + name + \"' from namespace: \"\n-              + namespace + \" with HTTP status code: \" + response.getHttpStatusCode());\n+          + namespace + \" with HTTP status code: \" + response.getHttpStatusCode());\n       return false;\n     }\n \n     if (response.getObject() != null) {\n       logger.info(\n           \"Received after-deletion status of the requested object, will be deleting \"\n-              + \"persistent volume claim in background!\");\n+          + \"persistent volume claim in background!\");\n     }\n \n     return true;\n   }\n \n-  // --------------------------- service account ---------------------------\n+  /**\n+   * List all persistent volumes in the Kubernetes cluster.\n+   * @return V1PersistentVolumeList of Persistent Volumes in Kubernetes cluster\n+   */\n+  public static V1PersistentVolumeList listPersistenVolumes() {\n+    KubernetesApiResponse<V1PersistentVolumeList> list = pvClient.list();\n+    return list.getObject();\n+  }\n \n+  /**\n+   * List all persistent volume claims in the Kubernetes cluster.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "originalPosition": 737}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6891b97de91530307c81dfb4f83d0d6156503217", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6891b97de91530307c81dfb4f83d0d6156503217", "committedDate": "2020-04-20T17:53:48Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dfa599d17d6c389145a3bb16da7a12045a03d99d", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/dfa599d17d6c389145a3bb16da7a12045a03d99d", "committedDate": "2020-04-20T18:01:09Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bf9a0efcb8ebaeb62621bc26887cd069cda1096", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/9bf9a0efcb8ebaeb62621bc26887cd069cda1096", "committedDate": "2020-04-20T18:06:14Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "822577620703fcf203bcde4c2d5ebffe7a43a575", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/822577620703fcf203bcde4c2d5ebffe7a43a575", "committedDate": "2020-04-20T18:19:04Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b359dd2557e9f15e92dd36903ff43bab45dd5acd", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b359dd2557e9f15e92dd36903ff43bab45dd5acd", "committedDate": "2020-04-20T18:19:58Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "924d87c26c07e2584fd88dd27e44cdda34a810c4", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/924d87c26c07e2584fd88dd27e44cdda34a810c4", "committedDate": "2020-04-20T18:28:46Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fc7b76483ca820ec0cf39c12fa44b8cd156e16d", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8fc7b76483ca820ec0cf39c12fa44b8cd156e16d", "committedDate": "2020-04-20T18:49:16Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dee091e7a7b153c087a24970f9d51e68bdb7f4e", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3dee091e7a7b153c087a24970f9d51e68bdb7f4e", "committedDate": "2020-04-20T18:59:20Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23086cb9d6e137ce0318ea3300995989462708dc", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/23086cb9d6e137ce0318ea3300995989462708dc", "committedDate": "2020-04-20T19:05:51Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df817e6c032505fd8aa2ddf0420b2ae3933b27a8", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/df817e6c032505fd8aa2ddf0420b2ae3933b27a8", "committedDate": "2020-04-20T19:07:17Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc88af28fd4734289e1541d4ca1805c7ebdb57f8", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/dc88af28fd4734289e1541d4ca1805c7ebdb57f8", "committedDate": "2020-04-20T19:08:52Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48bf46d455393f63ba461b5a2ce3b0858f6009c9", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/48bf46d455393f63ba461b5a2ce3b0858f6009c9", "committedDate": "2020-04-20T19:14:21Z", "message": "wip"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afe9a5379eb7419bcfa16ad40782c55fb82183f3", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/afe9a5379eb7419bcfa16ad40782c55fb82183f3", "committedDate": "2020-04-20T19:33:02Z", "message": "fix javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "003cc75548b7d6b251aa5a0fb2d80366b14c512b", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/003cc75548b7d6b251aa5a0fb2d80366b14c512b", "committedDate": "2020-04-20T19:42:07Z", "message": "fixed pvc list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "abd6d7a2bf397cb23722e0508dafc57eff72300f", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/abd6d7a2bf397cb23722e0508dafc57eff72300f", "committedDate": "2020-04-20T20:38:19Z", "message": "use RESULT_ROOT in Jenkins or tmp dir for local runs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c6a6b456d4847587c1eeb2ebc9c57c166db21be", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6c6a6b456d4847587c1eeb2ebc9c57c166db21be", "committedDate": "2020-04-20T20:50:39Z", "message": "Merge branch 'develop' into tests-diagnostics2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83590f09c398e5b8b38fa192d8111a4929f33fa3", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/83590f09c398e5b8b38fa192d8111a4929f33fa3", "committedDate": "2020-04-20T20:56:21Z", "message": "fix comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODI0MTkw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-396824190", "createdAt": "2020-04-20T21:25:10Z", "commit": {"oid": "83590f09c398e5b8b38fa192d8111a4929f33fa3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMToyNToxMVrOGIoVPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMToyNToxMVrOGIoVPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcwMjU4OQ==", "bodyText": "Shouldn't be this be checking if the call was successful?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411702589", "createdAt": "2020-04-20T21:25:11Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -198,18 +236,22 @@ private static void initializeGenericKubernetesApiClients() {\n   }\n \n   // ------------------------  deployments -----------------------------------\n-\n   public static boolean createDeployment(String deploymentYaml) {\n     // do something with the command!!!\n     return true;\n   }\n \n-  public static List listDeployments() {\n-    return new ArrayList();\n+  /**\n+   * List all deployments in a given namespace.\n+   * @param namespace Namespace in which to list the deployments\n+   * @return V1DeploymentList of deployments in the Kubernetes cluster\n+   */\n+  public static V1DeploymentList listDeployments(String namespace) {\n+    KubernetesApiResponse<V1DeploymentList> list = deploymentClient.list(namespace);\n+    return list.getObject();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83590f09c398e5b8b38fa192d8111a4929f33fa3"}, "originalPosition": 109}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODI0OTIx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-396824921", "createdAt": "2020-04-20T21:26:19Z", "commit": {"oid": "83590f09c398e5b8b38fa192d8111a4929f33fa3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMToyNjoxOVrOGIoX5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMToyNjoxOVrOGIoX5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcwMzI3MQ==", "bodyText": "Just curious, why are we using GenericKubernetesApi for everything except Pod?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411703271", "createdAt": "2020-04-20T21:26:19Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -233,18 +275,24 @@ public static String getPodLog(String name, String namespace) throws ApiExceptio\n    */\n   public static String getPodLog(String name, String namespace, String container)\n       throws ApiException {\n-    String log = coreV1Api.readNamespacedPodLog(\n-        name, // name of the Pod\n-        namespace, // name of the Namespace\n-        container, // container for which to stream logs\n-        null, //  true/false Follow the log stream of the pod\n-        null, // number of bytes to read from the server before terminating the log output\n-        PRETTY, // pretty print output\n-        null, // true/false, Return previous terminated container logs\n-        null, // relative time (seconds) before the current time from which to show logs\n-        null, // number of lines from the end of the logs to show\n-        null // true/false, add timestamp at the beginning of every line of log output\n-    );\n+    String log = null;\n+    try {\n+      log = coreV1Api.readNamespacedPodLog(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83590f09c398e5b8b38fa192d8111a4929f33fa3"}, "originalPosition": 135}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODI2NzY2", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-396826766", "createdAt": "2020-04-20T21:29:24Z", "commit": {"oid": "83590f09c398e5b8b38fa192d8111a4929f33fa3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMToyOToyNFrOGIoeYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMToyOToyNFrOGIoeYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcwNDkyOQ==", "bodyText": "Why default to 0 instead of 1?  Wouldn't zero be when the annotation is not used.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411704929", "createdAt": "2020-04-20T21:29:24Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/annotations/Namespaces.java", "diffHunk": "@@ -0,0 +1,18 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.annotations;\n+\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+\n+/**\n+ * Annotation interface to define the number of namespaces needed by the test.\n+ */\n+@Target({ElementType.PARAMETER})\n+@Retention(RetentionPolicy.RUNTIME)\n+public @interface Namespaces {\n+  int value() default 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83590f09c398e5b8b38fa192d8111a4929f33fa3"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk2ODI3NzM4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-396827738", "createdAt": "2020-04-20T21:31:02Z", "commit": {"oid": "83590f09c398e5b8b38fa192d8111a4929f33fa3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMTozMTowM1rOGIoh8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMFQyMTozMTowM1rOGIoh8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTcwNTg0Mw==", "bodyText": "We need some way to label PV's.  This will generate a lot of data since it will grab all PV's, including those associated with domains from other tests.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r411705843", "createdAt": "2020-04-20T21:31:03Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/LoggingUtil.java", "diffHunk": "@@ -0,0 +1,119 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.io.IOException;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.text.SimpleDateFormat;\n+import java.util.Date;\n+import java.util.List;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+\n+import static io.kubernetes.client.util.Yaml.dump;\n+import static oracle.weblogic.kubernetes.extensions.LoggedTest.logger;\n+\n+/**\n+ * A utility class to collect logs for artifacts in Kubernetes cluster.\n+ */\n+public class LoggingUtil {\n+\n+  /**\n+   * Directory to store logs.\n+   */\n+  private static final String LOGS_DIR = System.getProperty(\"RESULT_ROOT\",\n+        System.getProperty(\"java.io.tmpdir\"));\n+\n+  /**\n+   * Collect logs for artifacts in Kubernetes cluster for current running test object. This method can be called\n+   * anywhere in the test by passing the test instance object and list namespaces.\n+   * <p>\n+   * The collected logs are written in the LOGS_DIR/IT_TEST_CLASSNAME/CURRENT_TIMESTAMP directory.\n+   *\n+   * @param itInstance the integration test instance\n+   * @param namespaces list of namespaces used by the test instance\n+   */\n+  public static void collectLogs(Object itInstance, List namespaces) {\n+    logger.info(\"Collecting logs...\");\n+    String resultDirExt = new SimpleDateFormat(\"yyyyMMddHHmmss\").format(new Date());\n+    try {\n+      Path resultDir = Files.createDirectories(\n+          Paths.get(LOGS_DIR, itInstance.getClass().getSimpleName(),\n+              resultDirExt));\n+      for (var namespace : namespaces) {\n+        LoggingUtil.generateLog((String) namespace, resultDir);\n+      }\n+    } catch (IOException ex) {\n+      logger.warning(ex.getMessage());\n+    } catch (ApiException ex) {\n+      logger.warning(ex.getResponseBody());\n+    }\n+  }\n+\n+  /**\n+   * Queries the Kubernetes cluster to get the logs for various artifacts and writes it to the resultDir.\n+   *\n+   * @param namespace in which to query cluster for artifacts\n+   * @param resultDir existing directory to write log files\n+   * @throws IOException when writing to log files fail\n+   * @throws ApiException when Kubernetes cluster query fails\n+   */\n+  public static void generateLog(String namespace, Path resultDir) throws IOException, ApiException {\n+    logger.info(\"Collecting logs in namespace : {0}\", namespace);\n+    // get service accounts\n+    writeToFile(Kubernetes.listServiceAccounts(namespace), resultDir.toString(), namespace + \"_sa.log\");\n+    // get namespaces\n+    writeToFile(Kubernetes.listNamespacesAsObjects(), resultDir.toString(), namespace + \"_ns.log\");\n+    // get pv\n+    writeToFile(Kubernetes.listPersistenVolumes(), resultDir.toString(), namespace + \"_pv.log\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83590f09c398e5b8b38fa192d8111a4929f33fa3"}, "originalPosition": 73}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47fbecb9de66f6004687cc00d8ab9324590535c9", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/47fbecb9de66f6004687cc00d8ab9324590535c9", "committedDate": "2020-04-20T23:05:39Z", "message": "changes as per Ryan's comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca282b99ab3c2059354ee4a62e3c3846f42f73c2", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ca282b99ab3c2059354ee4a62e3c3846f42f73c2", "committedDate": "2020-04-20T23:16:45Z", "message": "fix pv location"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NjM5NzQ1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-397639745", "createdAt": "2020-04-21T20:12:16Z", "commit": {"oid": "ca282b99ab3c2059354ee4a62e3c3846f42f73c2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDoxMjoxN1rOGJWgxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDoxMjoxN1rOGJWgxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjQ1OTIwNA==", "bodyText": "I'm confused.  Why do we still have these methods?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r412459204", "createdAt": "2020-04-21T20:12:17Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -579,12 +716,74 @@ public static boolean patchDomainCustomResource(String domainUID, String namespa\n    * @return List of Domain Custom Resources\n    */\n   public static DomainList listDomains(String namespace) {\n-    KubernetesApiResponse<DomainList> response = crdClient.list(namespace);\n+    KubernetesApiResponse<DomainList> response = null;\n+    try {\n+      response = crdClient.list(namespace);\n+    } catch (Exception ex) {\n+      logger.warning(ex.getMessage());\n+      throw ex;\n+    }\n     return response != null ? response.getObject() : new DomainList();\n   }\n \n-  // --------------------------- config map ---------------------------\n \n+  /**\n+   * Get Domain Custom Resource objects in all namespaces.\n+   *\n+   * @return Object Domain Custom Resources object\n+   */\n+  public static Object getDomainObjects() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca282b99ab3c2059354ee4a62e3c3846f42f73c2"}, "originalPosition": 427}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NjQzNjc1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-397643675", "createdAt": "2020-04-21T20:18:08Z", "commit": {"oid": "ca282b99ab3c2059354ee4a62e3c3846f42f73c2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDoxODowOFrOGJWuKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMDoxODowOFrOGJWuKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjQ2MjYzNA==", "bodyText": "I only want details for the named namespace", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r412462634", "createdAt": "2020-04-21T20:18:08Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/LoggingUtil.java", "diffHunk": "@@ -0,0 +1,127 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.io.IOException;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.text.SimpleDateFormat;\n+import java.util.Date;\n+import java.util.List;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+\n+import static io.kubernetes.client.util.Yaml.dump;\n+import static oracle.weblogic.kubernetes.extensions.LoggedTest.logger;\n+\n+/**\n+ * A utility class to collect logs for artifacts in Kubernetes cluster.\n+ */\n+public class LoggingUtil {\n+\n+  /**\n+   * Directory to store logs.\n+   */\n+  private static final String LOGS_DIR = System.getProperty(\"RESULT_ROOT\",\n+        System.getProperty(\"java.io.tmpdir\"));\n+\n+  /**\n+   * Collect logs for artifacts in Kubernetes cluster for current running test object. This method can be called\n+   * anywhere in the test by passing the test instance object and list namespaces.\n+   * <p>\n+   * The collected logs are written in the LOGS_DIR/IT_TEST_CLASSNAME/CURRENT_TIMESTAMP directory.\n+   *\n+   * @param itInstance the integration test instance\n+   * @param namespaces list of namespaces used by the test instance\n+   */\n+  public static void collectLogs(Object itInstance, List namespaces) {\n+    logger.info(\"Collecting logs...\");\n+    String resultDirExt = new SimpleDateFormat(\"yyyyMMddHHmmss\").format(new Date());\n+    try {\n+      Path resultDir = Files.createDirectories(\n+          Paths.get(LOGS_DIR, itInstance.getClass().getSimpleName(),\n+              resultDirExt));\n+      for (var namespace : namespaces) {\n+        LoggingUtil.generateLog((String) namespace, resultDir);\n+      }\n+    } catch (IOException ex) {\n+      logger.warning(ex.getMessage());\n+    } catch (ApiException ex) {\n+      logger.warning(ex.getResponseBody());\n+    }\n+  }\n+\n+  /**\n+   * Queries the Kubernetes cluster to get the logs for various artifacts and writes it to the resultDir.\n+   *\n+   * @param namespace in which to query cluster for artifacts\n+   * @param resultDir existing directory to write log files\n+   * @throws IOException when writing to log files fail\n+   * @throws ApiException when Kubernetes cluster query fails\n+   */\n+  public static void generateLog(String namespace, Path resultDir) throws IOException, ApiException {\n+    logger.info(\"Collecting logs in namespace : {0}\", namespace);\n+    // get service accounts\n+    writeToFile(Kubernetes.listServiceAccounts(namespace), resultDir.toString(), namespace + \"_sa.log\");\n+    // get namespaces\n+    writeToFile(Kubernetes.listNamespacesAsObjects(), resultDir.toString(), namespace + \"_ns.log\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca282b99ab3c2059354ee4a62e3c3846f42f73c2"}, "originalPosition": 71}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfc62f94a608a77f36b9b965e3b888330361380a", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/cfc62f94a608a77f36b9b965e3b888330361380a", "committedDate": "2020-04-21T20:36:26Z", "message": "Changes as per Ryan's comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0b232167ad73991c6a2c3959592226967c143fd1", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0b232167ad73991c6a2c3959592226967c143fd1", "committedDate": "2020-04-21T20:58:57Z", "message": "remove getting logs for all domains"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2f6db5dc0dda6c32d91cb482f301bcdcb3b34ef", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d2f6db5dc0dda6c32d91cb482f301bcdcb3b34ef", "committedDate": "2020-04-21T21:10:15Z", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into tests-diagnostics2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NzA2MDc1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-397706075", "createdAt": "2020-04-21T21:58:31Z", "commit": {"oid": "d2f6db5dc0dda6c32d91cb482f301bcdcb3b34ef"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMTo1ODozMVrOGJaPlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQyMjoxMTowNFrOGJaogQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyMDM0MA==", "bodyText": "fix", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r412520340", "createdAt": "2020-04-21T21:58:31Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiDomain.java", "diffHunk": "@@ -122,20 +119,24 @@\n \n   /**\n    * Install Operator.\n+   * @param namespaces listof namespaces created by the IntegrationTestWatcher by the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2f6db5dc0dda6c32d91cb482f301bcdcb3b34ef"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyMTAwNw==", "bodyText": "use for x : namespaces instead -- less brittle", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r412521007", "createdAt": "2020-04-21T21:59:49Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItSimpleOperatorValidation.java", "diffHunk": "@@ -77,17 +71,20 @@\n   // like these two:\n   @Slow\n   @MustNotRunInParallel\n-  public void testInstallingOperator(List namespaces) {\n+  public void testInstallingOperator(@Namespaces(3) List<String> namespaces) {\n     // this first example is an operation that we wait for.\n     // installOperator() is one of our custom, reusable actions.\n     // imagine that installOperator() will try to install the operator, by creating\n     // the kubernetes deployment.  this will complete quickly, and will either be\n     // successful or not.\n \n     // get unique namespaces for operator and domains\n-    opNamespace = (String)namespaces.get(0);\n-    domainNamespace1 = (String)namespaces.get(1);\n-    domainNamespace2 = (String)namespaces.get(2);\n+    for (int i = 0; i < 3; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2f6db5dc0dda6c32d91cb482f301bcdcb3b34ef"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyMjY5Mw==", "bodyText": "i don't see the fix", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r412522693", "createdAt": "2020-04-21T22:03:03Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -468,12 +598,73 @@ public static Domain getDomainCustomResource(String domainUID, String namespace)\n    * @return List of Domain Custom Resources\n    */\n   public static DomainList listDomains(String namespace) {\n-    KubernetesApiResponse<DomainList> response = crdClient.list(namespace);\n+    KubernetesApiResponse<DomainList> response = null;\n+    try {\n+      response = crdClient.list(namespace);\n+    } catch (Exception ex) {\n+      logger.warning(ex.getMessage());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUxNDU3NQ=="}, "originalCommit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "originalPosition": 415}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyNjM3OA==", "bodyText": "where do we need this?  as opposed to just looking in a single namespace?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r412526378", "createdAt": "2020-04-21T22:10:23Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -733,21 +960,38 @@ public static boolean deletePvc(String name, String namespace)\n     if (!response.isSuccess()) {\n       logger.warning(\n           \"Failed to delete persistent volume claim '\" + name + \"' from namespace: \"\n-              + namespace + \" with HTTP status code: \" + response.getHttpStatusCode());\n+          + namespace + \" with HTTP status code: \" + response.getHttpStatusCode());\n       return false;\n     }\n \n     if (response.getObject() != null) {\n       logger.info(\n           \"Received after-deletion status of the requested object, will be deleting \"\n-              + \"persistent volume claim in background!\");\n+          + \"persistent volume claim in background!\");\n     }\n \n     return true;\n   }\n \n-  // --------------------------- service account ---------------------------\n+  /**\n+   * List all persistent volumes in the Kubernetes cluster.\n+   * @return V1PersistentVolumeList of Persistent Volumes in Kubernetes cluster\n+   */\n+  public static V1PersistentVolumeList listPersistenVolumes() {\n+    KubernetesApiResponse<V1PersistentVolumeList> list = pvClient.list();\n+    return list.getObject();\n+  }\n \n+  /**\n+   * List all persistent volume claims in the Kubernetes cluster.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTUxNTc0NQ=="}, "originalCommit": {"oid": "43e86cf288fce78a347e854a338c8120d0e67d3f"}, "originalPosition": 737}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUyNjcyMQ==", "bodyText": "use for over collection", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r412526721", "createdAt": "2020-04-21T22:11:04Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/extensions/IntegrationTestWatcher.java", "diffHunk": "@@ -85,21 +89,20 @@ public boolean supportsParameter(ParameterContext parameterContext,\n   @Override\n   public Object resolveParameter(ParameterContext parameterContext,\n       ExtensionContext extensionContext) throws ParameterResolutionException {\n-    Object requiredTestInstance = extensionContext.getRequiredTestInstance();\n-    List<String> namespaces = null;\n-\n-    if (requiredTestInstance.getClass().isAnnotationPresent(ITNamespaces.class)) {\n-      ITNamespaces itNsTag = requiredTestInstance.getClass().getAnnotation(ITNamespaces.class);\n-      logger.info(\"Creating {0} unique namespaces for the test\", itNsTag.numofns());\n-      namespaces = new ArrayList();\n-      for (int i = 1; i <= itNsTag.numofns(); i++) {\n-        String namespace = assertDoesNotThrow(() -> createUniqueNamespace(),\n-            \"Failed to create unique namespace due to ApiException\");\n-        namespaces.add(namespace);\n-        logger.info(\"Created a new namespace called {0}\", namespace);\n-      }\n+    Namespaces ns = parameterContext.findAnnotation(Namespaces.class).get();\n+    List<String> namespaces = new ArrayList();\n+    for (int i = 1; i <= ns.value(); i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d2f6db5dc0dda6c32d91cb482f301bcdcb3b34ef"}, "originalPosition": 55}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d583a8c74d4591fc4a6415359d4efe95ce57d730", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d583a8c74d4591fc4a6415359d4efe95ce57d730", "committedDate": "2020-04-21T22:35:39Z", "message": "Address Mark comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d66d998594e21e098e75b7cbc90057bfb314106", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6d66d998594e21e098e75b7cbc90057bfb314106", "committedDate": "2020-04-21T22:49:57Z", "message": "address mark's review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1eca58126d744529ca18235b9257e01b8452f77a", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1eca58126d744529ca18235b9257e01b8452f77a", "committedDate": "2020-04-22T17:09:21Z", "message": "Merge branch 'develop' into tests-diagnostics2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NDg4NDUz", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-398488453", "createdAt": "2020-04-22T19:00:00Z", "commit": {"oid": "1eca58126d744529ca18235b9257e01b8452f77a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxOTowMDowMVrOGKGQ2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxOTowMDowMVrOGKGQ2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI0MTU2MA==", "bodyText": "It's a small point, but you changed \"reusable\" from the correct spelling to an incorrect one.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r413241560", "createdAt": "2020-04-22T19:00:01Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiDomain.java", "diffHunk": "@@ -119,24 +119,24 @@\n \n   /**\n    * Install Operator.\n+   * @param namespaces list of namespaces created by the IntegrationTestWatcher by the\n+   JUnit engine parameter resolution mechanism\n    */\n   @BeforeAll\n-  public static void initAll() {\n-    // create standard, reusable retry/backoff policy\n+  public static void initAll(@Namespaces(2) List<String> namespaces) {\n+    // create standard, reusbale retry/backoff policy", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eca58126d744529ca18235b9257e01b8452f77a"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NDkwNTc3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-398490577", "createdAt": "2020-04-22T19:02:54Z", "commit": {"oid": "1eca58126d744529ca18235b9257e01b8452f77a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxOTowMjo1NVrOGKGYdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxOTowMjo1NVrOGKGYdQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI0MzUwOQ==", "bodyText": "replica sets", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r413243509", "createdAt": "2020-04-22T19:02:55Z", "author": {"login": "rjeberhard"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/actions/impl/primitive/Kubernetes.java", "diffHunk": "@@ -975,12 +1239,46 @@ public static boolean deleteService(String name, String namespace) {\n     if (response.getObject() != null) {\n       logger.info(\n           \"Received after-deletion status of the requested object, will be deleting \"\n-              + \"service in background!\");\n+          + \"service in background!\");\n     }\n \n     return true;\n   }\n \n+  // --------------------------- jobs ---------------------------\n+  /**\n+   * Get a list of all jobs in the given namespace.\n+   *\n+   * @param namespace in which to list the jobs\n+   * @return V1JobList of jobs from Kubernetes cluster\n+   */\n+  public static V1JobList listJobs(String namespace) {\n+    KubernetesApiResponse<V1JobList> list = jobClient.list(namespace);\n+    if (list.isSuccess()) {\n+      return list.getObject();\n+    } else {\n+      logger.warning(\"Failed to list jobs, status code {0}\", list.getHttpStatusCode());\n+      return null;\n+    }\n+  }\n+\n+  // --------------------------- resplica sets ---------------------------", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1eca58126d744529ca18235b9257e01b8452f77a"}, "originalPosition": 895}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NDkxMDI2", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-398491026", "createdAt": "2020-04-22T19:03:30Z", "commit": {"oid": "1eca58126d744529ca18235b9257e01b8452f77a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc14c0a91bbd396f89cb567bd51424dd271d2fd4", "author": {"user": {"login": "sankarpn", "name": "Sankar Periyathambi Neelakandan"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/cc14c0a91bbd396f89cb567bd51424dd271d2fd4", "committedDate": "2020-04-22T19:13:41Z", "message": "correct the typos"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NTE0MzM2", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-398514336", "createdAt": "2020-04-22T19:35:19Z", "commit": {"oid": "cc14c0a91bbd396f89cb567bd51424dd271d2fd4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxOTozNToyMFrOGKHtnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxOTozNToyMFrOGKHtnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzI2NTMxMQ==", "bodyText": "i would be find to say @param namespaces injected by JUnit extension", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#discussion_r413265311", "createdAt": "2020-04-22T19:35:20Z", "author": {"login": "markxnelson"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiDomain.java", "diffHunk": "@@ -119,24 +119,24 @@\n \n   /**\n    * Install Operator.\n+   * @param namespaces list of namespaces created by the IntegrationTestWatcher by the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc14c0a91bbd396f89cb567bd51424dd271d2fd4"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NTM2OTkx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1562#pullrequestreview-398536991", "createdAt": "2020-04-22T19:59:04Z", "commit": {"oid": "cc14c0a91bbd396f89cb567bd51424dd271d2fd4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 36, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}