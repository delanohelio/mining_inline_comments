{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5NjY0NzQ5", "number": 2097, "title": "OWLS-72816 Generate event and status when operator can't scale cluster past maximum", "bodyText": "When a replicas value is below the configured min cluster size, or above the configured max cluster size, generate events such as:\nEvents:\n\n5s          Warning   DomainValidationError       domain/domain1   Validation error in domain resource domain1: Replica request of 2,020 exceeds the maximum dynamic server count of 2 configured for cluster cluster-1\n\n9s          Warning   DomainValidationError       domain/domain1   Validation error in domain resource domain1: Replica request of 0 less than the minimum dynamic server count of 1 configured for cluster cluster-1\n\nAlso update status.message of the domain resource to:\n\"Replica request of 2,020 exceeds the maximum dynamic server count of 2 configured for cluster cluster-1\"\n\n\"Replica request of 0 less than the minimum dynamic server count of 1 configured for cluster cluster-1\"\n\n\nAlso include in the PR a fix for a bug that was found in validation of serverName of specified in managedServer, in that a validation warning message such as the following is added even though the server name exists in a dynamic cluster:\n\"Managed Server 'managed-server1' specified in the domain resource does not exist in the WebLogic domain home configuration.\"\nhttps://build.weblogick8s.org:8443/job/weblogic-kubernetes-operator-kind-new/3334/", "createdAt": "2020-12-14T16:59:33Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097", "merged": true, "mergeCommit": {"oid": "31e7ec9072809d9c70810139d8cb3e61e178db52"}, "closed": true, "closedAt": "2020-12-18T21:35:21Z", "author": {"login": "alai8"}, "timelineItems": {"totalCount": 17, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdk7Wj4gH2gAyNTM5NjY0NzQ5OmJlMzBiNzI2OTgwNjA0N2NiODY3YWY0Yjk2ODQ5ZjZiMWIxOWQwM2I=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdnZ17qgFqTU1NTU4NjEwOA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "be30b7269806047cb867af4b96849f6b1b19d03b", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/be30b7269806047cb867af4b96849f6b1b19d03b", "committedDate": "2020-12-10T22:47:33Z", "message": "create event and update domain status condition when replicas value is not valid for the weblogic cluster"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e594ab64aa5c668981cde07f2b51193a126752d2", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e594ab64aa5c668981cde07f2b51193a126752d2", "committedDate": "2020-12-10T22:52:40Z", "message": "update domain events doc with InvalidReplicasValue event"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64ca6f80fb64690280264b68b9bf38a7f0bc4738", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/64ca6f80fb64690280264b68b9bf38a7f0bc4738", "committedDate": "2020-12-11T17:29:59Z", "message": "containsServer in WlsDomainConfig should return true for clustered servers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c15bff678e82d38071fe645c88e9411fc825cd27", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c15bff678e82d38071fe645c88e9411fc825cd27", "committedDate": "2020-12-11T18:14:29Z", "message": "misc code/test cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1584a9dcae3fa5f07740a9540b66596f4bc9204", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e1584a9dcae3fa5f07740a9540b66596f4bc9204", "committedDate": "2020-12-11T18:43:37Z", "message": "Merge branch 'develop' into owls72816"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7b84da5b8c9f1bad1e29342d0330a2c2c11362b6", "committedDate": "2020-12-11T19:00:02Z", "message": "fix failing test after merge from develop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUxNjQ0MDYw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#pullrequestreview-551644060", "createdAt": "2020-12-14T17:12:25Z", "commit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNzoxMjoyNlrOIFbBkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNzoxMjoyNlrOIFbBkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU1NjU2MQ==", "bodyText": "Maybe this is a naive comment but it looks like this change is special case handling a particular validation warning. Would it be possible and sensible to treat all validation warnings using the same event instead of having a special event for this particular validation?  E.g. have a generic 'validation' event and generic validation warning handling that handles all validation failures...", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r542556561", "createdAt": "2020-12-14T17:12:26Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "diffHunk": "@@ -286,13 +300,26 @@ private void logIfReplicasLessThanClusterServersMin(WlsClusterConfig clusterConf\n                 domain.getReplicaCount(clusterName),\n                 clusterConfig.getMinDynamicClusterSize(),\n                 clusterName);\n+        String message = LOGGER.formatMessage(MessageKeys.REPLICAS_LESS_THAN_TOTAL_CLUSTER_SERVER_COUNT,\n+            domain.getReplicaCount(clusterName),\n+            clusterConfig.getMinDynamicClusterSize(),\n+            clusterName);\n+        addInvalidReplicasValueEventAndWarning(message);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "originalPosition": 92}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ee212dd24186ade3870263bb74a9c4b57083baa", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3ee212dd24186ade3870263bb74a9c4b57083baa", "committedDate": "2020-12-15T00:19:50Z", "message": "Merge branch 'develop' into owls72816"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f62cb71326a1280020dade1f99311c5efc0df97", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7f62cb71326a1280020dade1f99311c5efc0df97", "committedDate": "2020-12-16T16:32:57Z", "message": "Merge branch 'develop' into owls72816"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "690c36f7d0e1f29301bde29dce7ffa578db9d13d", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/690c36f7d0e1f29301bde29dce7ffa578db9d13d", "committedDate": "2020-12-16T18:12:23Z", "message": "rename InvalidReplicasValue event to DomainValidationError event"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0OTkzMTQx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#pullrequestreview-554993141", "createdAt": "2020-12-17T21:14:50Z", "commit": {"oid": "690c36f7d0e1f29301bde29dce7ffa578db9d13d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MDIyMjcw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#pullrequestreview-555022270", "createdAt": "2020-12-17T22:00:10Z", "commit": {"oid": "690c36f7d0e1f29301bde29dce7ffa578db9d13d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMjowMDoxMFrOIIKdjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMjowMDoxMFrOIIKdjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTQzMDkyNg==", "bodyText": "change InvalidReplicasValue to DomainValidationError?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r545430926", "createdAt": "2020-12-17T22:00:10Z", "author": {"login": "doxiao"}, "path": "docs-source/content/userguide/managing-domains/domain-events.md", "diffHunk": "@@ -242,6 +243,39 @@ Source:\n Type:    Warning\n Events:  <none>\n \n+```\n+Example of a `InvalidReplicasValue` event:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "690c36f7d0e1f29301bde29dce7ffa578db9d13d"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c8ad48f7ea2cfc5526c3505960a417e9fd5a5a0", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1c8ad48f7ea2cfc5526c3505960a417e9fd5a5a0", "committedDate": "2020-12-18T00:05:23Z", "message": "create event for validation warnings in ValidateDomainTopologyStep."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6db8a4a765da6f40644a41d1cff1c7242fd3f41", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b6db8a4a765da6f40644a41d1cff1c7242fd3f41", "committedDate": "2020-12-18T00:06:09Z", "message": "update with example of new DomainValidationError event"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "372b0fcb45c2822f3a52425fbdf908a9fbf7fdd2", "author": {"user": {"login": "alai8", "name": "Anthony Lai"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/372b0fcb45c2822f3a52425fbdf908a9fbf7fdd2", "committedDate": "2020-12-18T00:07:00Z", "message": "Merge branch 'develop' into owls72816"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1MDk1MjYw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#pullrequestreview-555095260", "createdAt": "2020-12-18T00:37:44Z", "commit": {"oid": "372b0fcb45c2822f3a52425fbdf908a9fbf7fdd2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU1NTg2MTA4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#pullrequestreview-555586108", "createdAt": "2020-12-18T15:26:49Z", "commit": {"oid": "372b0fcb45c2822f3a52425fbdf908a9fbf7fdd2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3984, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}