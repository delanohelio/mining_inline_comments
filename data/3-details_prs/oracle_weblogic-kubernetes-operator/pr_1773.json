{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNjA0MzA2", "number": 1773, "title": "Log introspector job info on failure", "bodyText": "Add one INFO and one FINE log messages on introspector failures. Those log messages will be generated at the first failure of each introspector job, and when the job is considered done and deleted by the operator.\nWrite two unit tests for the changes in this PR.", "createdAt": "2020-06-29T19:25:53Z", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1773", "merged": true, "mergeCommit": {"oid": "ab3764fa442d05a281192410d7f7831bb1f05590"}, "closed": true, "closedAt": "2020-06-30T18:06:48Z", "author": {"login": "doxiao"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuw7xsAH2gAyNDQxNjA0MzA2OmJiNzMzYzFkYjE1OGFiODY5OTJhYzU5ZDQ0ZDNhZjVlN2UzM2Y4Nzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwX8dVAH2gAyNDQxNjA0MzA2OmU5NmZiZGIzYTJhYzI2ZjIyOGM3ZDQ5MmNhMGFiYjU2N2JlNzA5MzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bb733c1db158ab86992ac59d44d3af5e7e33f879", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/bb733c1db158ab86992ac59d44d3af5e7e33f879", "committedDate": "2020-06-25T16:07:20Z", "message": "Initial change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b40fe6dd68e75ebb3425150424ca8f1f332ce669", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b40fe6dd68e75ebb3425150424ca8f1f332ce669", "committedDate": "2020-06-25T19:54:43Z", "message": "Complete the first unit test case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ebf37b908913379683c6ffeb3d9fdba60e852d2", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0ebf37b908913379683c6ffeb3d9fdba60e852d2", "committedDate": "2020-06-25T21:15:51Z", "message": "work in progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dbaccdc7bf568e23178262d66f5b6e5c9a33a6a", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/9dbaccdc7bf568e23178262d66f5b6e5c9a33a6a", "committedDate": "2020-06-26T13:10:33Z", "message": "Work in progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d612d5ed54a3b20d8e6d64770a36fd669745173", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8d612d5ed54a3b20d8e6d64770a36fd669745173", "committedDate": "2020-06-29T01:17:45Z", "message": "Work in progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f647261a224adef6e7e35b7a942bb7404bb79fa", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5f647261a224adef6e7e35b7a942bb7404bb79fa", "committedDate": "2020-06-29T16:13:24Z", "message": "Minor changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d3d77706ce8b732af16c24af32238e18c8f3668", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0d3d77706ce8b732af16c24af32238e18c8f3668", "committedDate": "2020-06-29T18:22:39Z", "message": "Merge remote-tracking branch 'origin/develop' into log-job-info-on-failure\n\nConflicts:\n\toperator/src/main/java/oracle/kubernetes/operator/ProcessingConstants.java\n\toperator/src/main/java/oracle/kubernetes/operator/logging/MessageKeys.java\n\toperator/src/main/resources/Operator.properties"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDY4NTkx", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1773#pullrequestreview-439468591", "createdAt": "2020-06-29T20:17:40Z", "commit": {"oid": "0d3d77706ce8b732af16c24af32238e18c8f3668"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMDoxNzo0MFrOGqgpXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMDoxNzo0MFrOGqgpXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIyODI1NQ==", "bodyText": "There won't always be SEVERE log messages copied from the introspector pod - for example on an image pull failure.  I'm not sure what's logged in that case...", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1773#discussion_r447228255", "createdAt": "2020-06-29T20:17:40Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/resources/Operator.properties", "diffHunk": "@@ -183,6 +183,9 @@ WLSKO-0170=HTTP timeout: exception {0}.\n WLSKO-0171=Namespace {0} is in operator's target namespaces list but doesn't exist\n WLSKO-0173=Replace custom resource definition failed: {0}\n WLSKO-0174=Create custom resource definition failed: {0}\n+WLSKO-0175=Job {1} in namespace {0} failed, job pod name is {2}, and job status is {3}. Check SEVERE log \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d3d77706ce8b732af16c24af32238e18c8f3668"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDcyMjk4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1773#pullrequestreview-439472298", "createdAt": "2020-06-29T20:23:26Z", "commit": {"oid": "0d3d77706ce8b732af16c24af32238e18c8f3668"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMDoyMzoyNlrOGqg1HQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQyMDoyMzoyNlrOGqg1HQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzIzMTI2MQ==", "bodyText": "could you give an example of what is being logged in this message? Thanks", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1773#discussion_r447231261", "createdAt": "2020-06-29T20:23:26Z", "author": {"login": "alai8"}, "path": "operator/src/main/java/oracle/kubernetes/operator/helpers/JobHelper.java", "diffHunk": "@@ -533,6 +547,23 @@ private String onSeparateLines(List<String> lines) {\n     }\n   }\n \n+  private static void logIntrospectorFailure(Packet packet, V1Job domainIntrospectorJob) {\n+    Boolean logged = (Boolean) packet.get(ProcessingConstants.INTROSPECTOR_JOB_FAILURE_LOGGED);\n+    String jobPodName = (String) packet.get(ProcessingConstants.JOB_POD_NAME);\n+    if (logged == null || !logged.booleanValue()) {\n+      packet.put(ProcessingConstants.INTROSPECTOR_JOB_FAILURE_LOGGED, Boolean.valueOf(true));\n+      LOGGER.info(INTROSPECTOR_JOB_FAILED,\n+          domainIntrospectorJob.getMetadata().getNamespace(),\n+          domainIntrospectorJob.getMetadata().getName(),\n+          jobPodName,\n+          domainIntrospectorJob.getStatus());\n+      LOGGER.fine(INTROSPECTOR_JOB_FAILED_DETAIL,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d3d77706ce8b732af16c24af32238e18c8f3668"}, "originalPosition": 74}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e0f862f37275da9bb5bd25ebef45087ee250dd9", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4e0f862f37275da9bb5bd25ebef45087ee250dd9", "committedDate": "2020-06-30T01:23:07Z", "message": "Fine tune log message"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMTEwMTA3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1773#pullrequestreview-440110107", "createdAt": "2020-06-30T15:04:01Z", "commit": {"oid": "4e0f862f37275da9bb5bd25ebef45087ee250dd9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMTUwNzcw", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1773#pullrequestreview-440150770", "createdAt": "2020-06-30T15:46:23Z", "commit": {"oid": "4e0f862f37275da9bb5bd25ebef45087ee250dd9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e96fbdb3a2ac26f228c7d492ca0abb567be70935", "author": {"user": {"login": "doxiao", "name": "Dongbo Xiao"}}, "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e96fbdb3a2ac26f228c7d492ca0abb567be70935", "committedDate": "2020-06-30T16:08:18Z", "message": "Fine tune the info message"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4615, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}