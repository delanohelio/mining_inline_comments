{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0NzQ5MDgy", "number": 1687, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxODoyMjoyMFrOEA_kwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxODoyMjoyMFrOEA_kwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5NDc3MDU3OnYy", "diffSide": "RIGHT", "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "isResolved": false, "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxODoyMjoyMFrOGcnfbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQyMTo1MjoyNlrOGctUvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MDMzMw==", "bodyText": "will this work if the domains are running?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1687#discussion_r432660333", "createdAt": "2020-05-29T18:22:20Z", "author": {"login": "sankarpn"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "diffHunk": "@@ -193,23 +404,14 @@ public void testCreateMiiDomainWithMultiModeCM() {\n       checkServiceExists(managedServerPrefix + i, domainNamespace);\n     }\n \n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName);\n-    String maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName);\n-    assertEquals(\"40\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName, maxCapacityValue, \"40\"));\n-\n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName, \"40\"));\n-\n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName3);\n-    maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName3);\n-    assertEquals(\"5\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName3, maxCapacityValue, \"5\"));\n+  }\n \n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName3, \"5\"));\n+  @AfterAll\n+  public void tearDownAll() {\n+    // delete the domain image created in the test class\n+    if (miiImageMultiModel != null) {\n+      deleteImage(miiImageMultiModel);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "80e5ee3d06159717ca193f18649d965d6a3d70d1"}, "originalPosition": 446}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2NTQ4Mg==", "bodyText": "Probably not. Let me check. If not, I'll delete the domains first.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1687#discussion_r432665482", "createdAt": "2020-05-29T18:32:59Z", "author": {"login": "doxiao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "diffHunk": "@@ -193,23 +404,14 @@ public void testCreateMiiDomainWithMultiModeCM() {\n       checkServiceExists(managedServerPrefix + i, domainNamespace);\n     }\n \n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName);\n-    String maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName);\n-    assertEquals(\"40\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName, maxCapacityValue, \"40\"));\n-\n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName, \"40\"));\n-\n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName3);\n-    maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName3);\n-    assertEquals(\"5\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName3, maxCapacityValue, \"5\"));\n+  }\n \n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName3, \"5\"));\n+  @AfterAll\n+  public void tearDownAll() {\n+    // delete the domain image created in the test class\n+    if (miiImageMultiModel != null) {\n+      deleteImage(miiImageMultiModel);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MDMzMw=="}, "originalCommit": {"oid": "80e5ee3d06159717ca193f18649d965d6a3d70d1"}, "originalPosition": 446}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY5NjA3OA==", "bodyText": "Added deletion of domains before deleting the image.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1687#discussion_r432696078", "createdAt": "2020-05-29T19:39:42Z", "author": {"login": "doxiao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "diffHunk": "@@ -193,23 +404,14 @@ public void testCreateMiiDomainWithMultiModeCM() {\n       checkServiceExists(managedServerPrefix + i, domainNamespace);\n     }\n \n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName);\n-    String maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName);\n-    assertEquals(\"40\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName, maxCapacityValue, \"40\"));\n-\n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName, \"40\"));\n-\n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName3);\n-    maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName3);\n-    assertEquals(\"5\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName3, maxCapacityValue, \"5\"));\n+  }\n \n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName3, \"5\"));\n+  @AfterAll\n+  public void tearDownAll() {\n+    // delete the domain image created in the test class\n+    if (miiImageMultiModel != null) {\n+      deleteImage(miiImageMultiModel);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MDMzMw=="}, "originalCommit": {"oid": "80e5ee3d06159717ca193f18649d965d6a3d70d1"}, "originalPosition": 446}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjczMDA2OQ==", "bodyText": "I see deleting image works before deleting the domain..", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1687#discussion_r432730069", "createdAt": "2020-05-29T20:53:57Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "diffHunk": "@@ -193,23 +404,14 @@ public void testCreateMiiDomainWithMultiModeCM() {\n       checkServiceExists(managedServerPrefix + i, domainNamespace);\n     }\n \n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName);\n-    String maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName);\n-    assertEquals(\"40\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName, maxCapacityValue, \"40\"));\n-\n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName, \"40\"));\n-\n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName3);\n-    maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName3);\n-    assertEquals(\"5\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName3, maxCapacityValue, \"5\"));\n+  }\n \n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName3, \"5\"));\n+  @AfterAll\n+  public void tearDownAll() {\n+    // delete the domain image created in the test class\n+    if (miiImageMultiModel != null) {\n+      deleteImage(miiImageMultiModel);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MDMzMw=="}, "originalCommit": {"oid": "80e5ee3d06159717ca193f18649d965d6a3d70d1"}, "originalPosition": 446}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjczMDQ0NQ==", "bodyText": "not sure if domain deletion will have issues though", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1687#discussion_r432730445", "createdAt": "2020-05-29T20:54:51Z", "author": {"login": "vanajamukkara"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "diffHunk": "@@ -193,23 +404,14 @@ public void testCreateMiiDomainWithMultiModeCM() {\n       checkServiceExists(managedServerPrefix + i, domainNamespace);\n     }\n \n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName);\n-    String maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName);\n-    assertEquals(\"40\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName, maxCapacityValue, \"40\"));\n-\n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName, \"40\"));\n-\n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName3);\n-    maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName3);\n-    assertEquals(\"5\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName3, maxCapacityValue, \"5\"));\n+  }\n \n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName3, \"5\"));\n+  @AfterAll\n+  public void tearDownAll() {\n+    // delete the domain image created in the test class\n+    if (miiImageMultiModel != null) {\n+      deleteImage(miiImageMultiModel);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MDMzMw=="}, "originalCommit": {"oid": "80e5ee3d06159717ca193f18649d965d6a3d70d1"}, "originalPosition": 446}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjczMzYyNw==", "bodyText": "With the change, we are doing what we do in ItMiiDomain.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1687#discussion_r432733627", "createdAt": "2020-05-29T21:02:18Z", "author": {"login": "doxiao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "diffHunk": "@@ -193,23 +404,14 @@ public void testCreateMiiDomainWithMultiModeCM() {\n       checkServiceExists(managedServerPrefix + i, domainNamespace);\n     }\n \n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName);\n-    String maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName);\n-    assertEquals(\"40\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName, maxCapacityValue, \"40\"));\n-\n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName, \"40\"));\n-\n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName3);\n-    maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName3);\n-    assertEquals(\"5\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName3, maxCapacityValue, \"5\"));\n+  }\n \n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName3, \"5\"));\n+  @AfterAll\n+  public void tearDownAll() {\n+    // delete the domain image created in the test class\n+    if (miiImageMultiModel != null) {\n+      deleteImage(miiImageMultiModel);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MDMzMw=="}, "originalCommit": {"oid": "80e5ee3d06159717ca193f18649d965d6a3d70d1"}, "originalPosition": 446}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjczNzg0OQ==", "bodyText": "In addition, I tested the current version and found no problem and the image was removed.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1687#discussion_r432737849", "createdAt": "2020-05-29T21:12:36Z", "author": {"login": "doxiao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "diffHunk": "@@ -193,23 +404,14 @@ public void testCreateMiiDomainWithMultiModeCM() {\n       checkServiceExists(managedServerPrefix + i, domainNamespace);\n     }\n \n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName);\n-    String maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName);\n-    assertEquals(\"40\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName, maxCapacityValue, \"40\"));\n-\n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName, \"40\"));\n-\n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName3);\n-    maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName3);\n-    assertEquals(\"5\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName3, maxCapacityValue, \"5\"));\n+  }\n \n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName3, \"5\"));\n+  @AfterAll\n+  public void tearDownAll() {\n+    // delete the domain image created in the test class\n+    if (miiImageMultiModel != null) {\n+      deleteImage(miiImageMultiModel);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MDMzMw=="}, "originalCommit": {"oid": "80e5ee3d06159717ca193f18649d965d6a3d70d1"}, "originalPosition": 446}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc0MDE5OQ==", "bodyText": "I re-tested both cases, and either way worked without problem:).", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1687#discussion_r432740199", "createdAt": "2020-05-29T21:18:45Z", "author": {"login": "doxiao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "diffHunk": "@@ -193,23 +404,14 @@ public void testCreateMiiDomainWithMultiModeCM() {\n       checkServiceExists(managedServerPrefix + i, domainNamespace);\n     }\n \n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName);\n-    String maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName);\n-    assertEquals(\"40\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName, maxCapacityValue, \"40\"));\n-\n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName, \"40\"));\n-\n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName3);\n-    maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName3);\n-    assertEquals(\"5\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName3, maxCapacityValue, \"5\"));\n+  }\n \n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName3, \"5\"));\n+  @AfterAll\n+  public void tearDownAll() {\n+    // delete the domain image created in the test class\n+    if (miiImageMultiModel != null) {\n+      deleteImage(miiImageMultiModel);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MDMzMw=="}, "originalCommit": {"oid": "80e5ee3d06159717ca193f18649d965d6a3d70d1"}, "originalPosition": 446}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc1NTkwMA==", "bodyText": "I recall that a Docker image cannot be deleted if there are containers using it. The containers have to be stopped first. So I think it is probably safer to delete the domain before deleting the image. This is also what we have been doing in ItMiiDomain.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1687#discussion_r432755900", "createdAt": "2020-05-29T21:52:26Z", "author": {"login": "doxiao"}, "path": "new-integration-tests/src/test/java/oracle/weblogic/kubernetes/ItMiiMultiModel.java", "diffHunk": "@@ -193,23 +404,14 @@ public void testCreateMiiDomainWithMultiModeCM() {\n       checkServiceExists(managedServerPrefix + i, domainNamespace);\n     }\n \n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName);\n-    String maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName);\n-    assertEquals(\"40\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName, maxCapacityValue, \"40\"));\n-\n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName, \"40\"));\n-\n-    logger.info(\"Check the MaxCapacity setting of DataSource {0}\", dsName3);\n-    maxCapacityValue = getDSMaxCapacity(adminServerPodName, domainNamespace, dsName3);\n-    assertEquals(\"5\", maxCapacityValue, \n-        String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, instead of %s\",\n-            domainUid, domainNamespace, dsName3, maxCapacityValue, \"5\"));\n+  }\n \n-    logger.info(String.format(\"Domain %s in namespace %s DataSource %s MaxCapacity is %s, as expected\",\n-            domainUid, domainNamespace, dsName3, \"5\"));\n+  @AfterAll\n+  public void tearDownAll() {\n+    // delete the domain image created in the test class\n+    if (miiImageMultiModel != null) {\n+      deleteImage(miiImageMultiModel);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY2MDMzMw=="}, "originalCommit": {"oid": "80e5ee3d06159717ca193f18649d965d6a3d70d1"}, "originalPosition": 446}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4271, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}