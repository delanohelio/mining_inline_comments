{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzNzg0MzM1", "number": 2115, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxOTowNDozNVrOFIsRyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QyMDo1MzoxN1rOFIvPyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0NjU4Mzc3OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxOTowNDozNVrOIKwQNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QyMToyMDoxMVrOIK2Z9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE0NzI1Mg==", "bodyText": "I'm concerned about having the integration test look for a specific message text. This seems too tightly coupled. What do others think? Would it be enough to have the test look for a reason code?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548147252", "createdAt": "2020-12-23T19:04:35Z", "author": {"login": "rjeberhard"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "diffHunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.Callable;\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import io.kubernetes.client.openapi.models.V1Event;\n+import io.kubernetes.client.util.Yaml;\n+import oracle.weblogic.kubernetes.ItKubernetesEvents;\n+import oracle.weblogic.kubernetes.TestConstants;\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.joda.time.DateTime;\n+\n+import static oracle.weblogic.kubernetes.TestConstants.OPERATOR_RELEASE_NAME;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Helper class for Kubernetes Events checking.\n+ */\n+public class K8sEvents {\n+\n+  private static final LoggingFacade logger = getLogger();\n+\n+  /**\n+   * Check if a given event is logged by the operator.\n+   *\n+   * @param opNamespace namespace in which the operator is running\n+   * @param domainNamespace namespace in which the domain exists\n+   * @param domainUid UID of the domain\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param type type of event, Normal of Warning\n+   * @param timestamp the timestamp after which to see events\n+   */\n+  public static Callable<Boolean> checkDomainEvent(\n+      String opNamespace, String domainNamespace, String domainUid, String reason, String type, DateTime timestamp) {\n+    return () -> {\n+      logger.info(\"Verifying {0} event is logged by the operator in domain namespace {1}\", reason, domainNamespace);\n+      try {\n+        List<V1Event> events = Kubernetes.listNamespacedEvents(domainNamespace);\n+        for (V1Event event : events) {\n+          if (event.getReason().contains(reason)\n+              && event.getMetadata().getCreationTimestamp().isAfter(timestamp.getMillis())) {\n+            logger.info(Yaml.dump(event));\n+            verifyOperatorDetails(event, opNamespace, domainUid);\n+            //verify reason\n+            logger.info(\"Verifying domain event {0}\", reason);\n+            assertTrue(event.getReason().equals(reason));\n+            //verify messages\n+            logger.info(\"Verifying domain event message {0}\", getDomainEventMessage(reason, domainUid));\n+            assertTrue(event.getMessage().contains(getDomainEventMessage(reason, domainUid)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "12df03b1349af0b7acf2379da651bcd9884c6e56"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE2NTUxNA==", "bodyText": "I am okay with just checking the reason code; the unit tests check the messages (and other fields) already.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548165514", "createdAt": "2020-12-23T19:29:06Z", "author": {"login": "doxiao"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "diffHunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.Callable;\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import io.kubernetes.client.openapi.models.V1Event;\n+import io.kubernetes.client.util.Yaml;\n+import oracle.weblogic.kubernetes.ItKubernetesEvents;\n+import oracle.weblogic.kubernetes.TestConstants;\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.joda.time.DateTime;\n+\n+import static oracle.weblogic.kubernetes.TestConstants.OPERATOR_RELEASE_NAME;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Helper class for Kubernetes Events checking.\n+ */\n+public class K8sEvents {\n+\n+  private static final LoggingFacade logger = getLogger();\n+\n+  /**\n+   * Check if a given event is logged by the operator.\n+   *\n+   * @param opNamespace namespace in which the operator is running\n+   * @param domainNamespace namespace in which the domain exists\n+   * @param domainUid UID of the domain\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param type type of event, Normal of Warning\n+   * @param timestamp the timestamp after which to see events\n+   */\n+  public static Callable<Boolean> checkDomainEvent(\n+      String opNamespace, String domainNamespace, String domainUid, String reason, String type, DateTime timestamp) {\n+    return () -> {\n+      logger.info(\"Verifying {0} event is logged by the operator in domain namespace {1}\", reason, domainNamespace);\n+      try {\n+        List<V1Event> events = Kubernetes.listNamespacedEvents(domainNamespace);\n+        for (V1Event event : events) {\n+          if (event.getReason().contains(reason)\n+              && event.getMetadata().getCreationTimestamp().isAfter(timestamp.getMillis())) {\n+            logger.info(Yaml.dump(event));\n+            verifyOperatorDetails(event, opNamespace, domainUid);\n+            //verify reason\n+            logger.info(\"Verifying domain event {0}\", reason);\n+            assertTrue(event.getReason().equals(reason));\n+            //verify messages\n+            logger.info(\"Verifying domain event message {0}\", getDomainEventMessage(reason, domainUid));\n+            assertTrue(event.getMessage().contains(getDomainEventMessage(reason, domainUid)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE0NzI1Mg=="}, "originalCommit": {"oid": "12df03b1349af0b7acf2379da651bcd9884c6e56"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODI0ODA1NA==", "bodyText": "removed the message checking", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548248054", "createdAt": "2020-12-23T21:20:11Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "diffHunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.Callable;\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import io.kubernetes.client.openapi.models.V1Event;\n+import io.kubernetes.client.util.Yaml;\n+import oracle.weblogic.kubernetes.ItKubernetesEvents;\n+import oracle.weblogic.kubernetes.TestConstants;\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.joda.time.DateTime;\n+\n+import static oracle.weblogic.kubernetes.TestConstants.OPERATOR_RELEASE_NAME;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Helper class for Kubernetes Events checking.\n+ */\n+public class K8sEvents {\n+\n+  private static final LoggingFacade logger = getLogger();\n+\n+  /**\n+   * Check if a given event is logged by the operator.\n+   *\n+   * @param opNamespace namespace in which the operator is running\n+   * @param domainNamespace namespace in which the domain exists\n+   * @param domainUid UID of the domain\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param type type of event, Normal of Warning\n+   * @param timestamp the timestamp after which to see events\n+   */\n+  public static Callable<Boolean> checkDomainEvent(\n+      String opNamespace, String domainNamespace, String domainUid, String reason, String type, DateTime timestamp) {\n+    return () -> {\n+      logger.info(\"Verifying {0} event is logged by the operator in domain namespace {1}\", reason, domainNamespace);\n+      try {\n+        List<V1Event> events = Kubernetes.listNamespacedEvents(domainNamespace);\n+        for (V1Event event : events) {\n+          if (event.getReason().contains(reason)\n+              && event.getMetadata().getCreationTimestamp().isAfter(timestamp.getMillis())) {\n+            logger.info(Yaml.dump(event));\n+            verifyOperatorDetails(event, opNamespace, domainUid);\n+            //verify reason\n+            logger.info(\"Verifying domain event {0}\", reason);\n+            assertTrue(event.getReason().equals(reason));\n+            //verify messages\n+            logger.info(\"Verifying domain event message {0}\", getDomainEventMessage(reason, domainUid));\n+            assertTrue(event.getMessage().contains(getDomainEventMessage(reason, domainUid)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE0NzI1Mg=="}, "originalCommit": {"oid": "12df03b1349af0b7acf2379da651bcd9884c6e56"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0NjU4NTY2OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/ItKubernetesEvents.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxOTowNDo0N1rOIKwRZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QyMToxNzowNVrOIK2Q0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE0NzU1Ng==", "bodyText": "We need to test DomainProcessingFailed event as well.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548147556", "createdAt": "2020-12-23T19:04:47Z", "author": {"login": "doxiao"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/ItKubernetesEvents.java", "diffHunk": "@@ -0,0 +1,385 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import java.io.File;\n+import java.io.FileOutputStream;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.Properties;\n+\n+import io.kubernetes.client.custom.V1Patch;\n+import io.kubernetes.client.openapi.models.V1Container;\n+import io.kubernetes.client.openapi.models.V1EnvVar;\n+import io.kubernetes.client.openapi.models.V1LocalObjectReference;\n+import io.kubernetes.client.openapi.models.V1ObjectMeta;\n+import io.kubernetes.client.openapi.models.V1PersistentVolumeClaimVolumeSource;\n+import io.kubernetes.client.openapi.models.V1SecretReference;\n+import io.kubernetes.client.openapi.models.V1Volume;\n+import io.kubernetes.client.openapi.models.V1VolumeMount;\n+import oracle.weblogic.domain.AdminServer;\n+import oracle.weblogic.domain.AdminService;\n+import oracle.weblogic.domain.Channel;\n+import oracle.weblogic.domain.Cluster;\n+import oracle.weblogic.domain.Domain;\n+import oracle.weblogic.domain.DomainSpec;\n+import oracle.weblogic.domain.ServerPod;\n+import oracle.weblogic.kubernetes.annotations.IntegrationTest;\n+import oracle.weblogic.kubernetes.annotations.Namespaces;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.awaitility.core.ConditionFactory;\n+import org.joda.time.DateTime;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static java.util.concurrent.TimeUnit.MINUTES;\n+import static java.util.concurrent.TimeUnit.SECONDS;\n+import static oracle.weblogic.kubernetes.TestConstants.ADMIN_PASSWORD_DEFAULT;\n+import static oracle.weblogic.kubernetes.TestConstants.ADMIN_USERNAME_DEFAULT;\n+import static oracle.weblogic.kubernetes.TestConstants.BASE_IMAGES_REPO_SECRET;\n+import static oracle.weblogic.kubernetes.TestConstants.DOMAIN_API_VERSION;\n+import static oracle.weblogic.kubernetes.TestConstants.K8S_NODEPORT_HOST;\n+import static oracle.weblogic.kubernetes.TestConstants.WEBLOGIC_IMAGE_TO_USE_IN_SPEC;\n+import static oracle.weblogic.kubernetes.actions.ActionConstants.RESOURCE_DIR;\n+import static oracle.weblogic.kubernetes.actions.TestActions.deleteDomainCustomResource;\n+import static oracle.weblogic.kubernetes.actions.impl.Domain.patchDomainCustomResource;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkPodDoesNotExist;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkPodReadyAndServiceExists;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createConfigMapForDomainCreation;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDomainAndVerify;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDomainJob;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createPV;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createPVC;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createSecretForBaseImages;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createSecretWithUsernamePassword;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.installAndVerifyOperator;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.setPodAntiAffinity;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_CHANGED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_CREATED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_DELETED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_ABORTED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_COMPLETED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_RETRYING;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_STARTING;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.checkDomainEvent;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.awaitility.Awaitility.with;\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Tests related to Domain events logged by operator.\n+ */\n+@DisplayName(\"Verify the Kubernetes events for domain lifecycle\")\n+@IntegrationTest\n+public class ItKubernetesEvents {\n+\n+  private static String opNamespace = null;\n+  private static String domainNamespace = null;\n+\n+  final String clusterName = \"mycluster\";\n+  final String adminServerName = \"admin-server\";\n+  final String adminServerPodName = domainUid + \"-\" + adminServerName;\n+  final String managedServerNameBase = \"ms-\";\n+  String managedServerPodNamePrefix = domainUid + \"-\" + managedServerNameBase;\n+  final int managedServerPort = 8001;\n+  int replicaCount = 2;\n+\n+  private static final String domainUid = \"k8seventsdomain\";\n+  private final String wlSecretName = \"weblogic-credentials\";\n+\n+  // create standard, reusable retry/backoff policy\n+  private static final ConditionFactory withStandardRetryPolicy\n+      = with().pollDelay(2, SECONDS)\n+          .and().with().pollInterval(10, SECONDS)\n+          .atMost(10, MINUTES).await();\n+\n+  private static LoggingFacade logger = null;\n+\n+  /**\n+   * Assigns unique namespaces for operator and domains. Pull WebLogic image if running tests in Kind cluster. Installs\n+   * operator.\n+   *\n+   * @param namespaces injected by JUnit\n+   */\n+  @BeforeAll\n+  public static void initAll(@Namespaces(2) List<String> namespaces) {\n+    logger = getLogger();\n+    logger.info(\"Assign a unique namespace for operator\");\n+    assertNotNull(namespaces.get(0), \"Namespace is null\");\n+    opNamespace = namespaces.get(0);\n+    logger.info(\"Assign a unique namespace for WebLogic domain\");\n+    assertNotNull(namespaces.get(1), \"Namespace is null\");\n+    domainNamespace = namespaces.get(1);\n+\n+    // install operator and verify its running in ready state\n+    installAndVerifyOperator(opNamespace, domainNamespace);\n+    // create pull secrets for WebLogic image when running in non Kind Kubernetes cluster\n+    // this secret is used only for non-kind cluster\n+    createSecretForBaseImages(domainNamespace);\n+\n+  }\n+\n+  /**\n+   * Test domain events are logged when domain resource goes through various life cycle stages.\n+   * Verifies DomainCreated is logged when domain resource is created.\n+   * Verifies DomainProcessingStarting is logged when operator processes the domain resource.\n+   * Verifies DomainProcessingCompleted is logged when operator done processes the domain resource.\n+   * Verifies DomainChanged is logged when operator processes the domain resource changes.\n+   * Verifies DomainProcessingRetrying is logged when operator retries the failed domain resource changes.\n+   * Verifies DomainProcessingAborted is logged when operator exceeds the maximum retries.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "12df03b1349af0b7acf2379da651bcd9884c6e56"}, "originalPosition": 136}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE2MjQ0Ng==", "bodyText": "I will cover the DomainProcessingFailed  event when I work on the unhappy path usecases.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548162446", "createdAt": "2020-12-23T19:25:21Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/ItKubernetesEvents.java", "diffHunk": "@@ -0,0 +1,385 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import java.io.File;\n+import java.io.FileOutputStream;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.Properties;\n+\n+import io.kubernetes.client.custom.V1Patch;\n+import io.kubernetes.client.openapi.models.V1Container;\n+import io.kubernetes.client.openapi.models.V1EnvVar;\n+import io.kubernetes.client.openapi.models.V1LocalObjectReference;\n+import io.kubernetes.client.openapi.models.V1ObjectMeta;\n+import io.kubernetes.client.openapi.models.V1PersistentVolumeClaimVolumeSource;\n+import io.kubernetes.client.openapi.models.V1SecretReference;\n+import io.kubernetes.client.openapi.models.V1Volume;\n+import io.kubernetes.client.openapi.models.V1VolumeMount;\n+import oracle.weblogic.domain.AdminServer;\n+import oracle.weblogic.domain.AdminService;\n+import oracle.weblogic.domain.Channel;\n+import oracle.weblogic.domain.Cluster;\n+import oracle.weblogic.domain.Domain;\n+import oracle.weblogic.domain.DomainSpec;\n+import oracle.weblogic.domain.ServerPod;\n+import oracle.weblogic.kubernetes.annotations.IntegrationTest;\n+import oracle.weblogic.kubernetes.annotations.Namespaces;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.awaitility.core.ConditionFactory;\n+import org.joda.time.DateTime;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static java.util.concurrent.TimeUnit.MINUTES;\n+import static java.util.concurrent.TimeUnit.SECONDS;\n+import static oracle.weblogic.kubernetes.TestConstants.ADMIN_PASSWORD_DEFAULT;\n+import static oracle.weblogic.kubernetes.TestConstants.ADMIN_USERNAME_DEFAULT;\n+import static oracle.weblogic.kubernetes.TestConstants.BASE_IMAGES_REPO_SECRET;\n+import static oracle.weblogic.kubernetes.TestConstants.DOMAIN_API_VERSION;\n+import static oracle.weblogic.kubernetes.TestConstants.K8S_NODEPORT_HOST;\n+import static oracle.weblogic.kubernetes.TestConstants.WEBLOGIC_IMAGE_TO_USE_IN_SPEC;\n+import static oracle.weblogic.kubernetes.actions.ActionConstants.RESOURCE_DIR;\n+import static oracle.weblogic.kubernetes.actions.TestActions.deleteDomainCustomResource;\n+import static oracle.weblogic.kubernetes.actions.impl.Domain.patchDomainCustomResource;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkPodDoesNotExist;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkPodReadyAndServiceExists;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createConfigMapForDomainCreation;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDomainAndVerify;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDomainJob;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createPV;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createPVC;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createSecretForBaseImages;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createSecretWithUsernamePassword;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.installAndVerifyOperator;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.setPodAntiAffinity;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_CHANGED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_CREATED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_DELETED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_ABORTED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_COMPLETED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_RETRYING;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_STARTING;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.checkDomainEvent;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.awaitility.Awaitility.with;\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Tests related to Domain events logged by operator.\n+ */\n+@DisplayName(\"Verify the Kubernetes events for domain lifecycle\")\n+@IntegrationTest\n+public class ItKubernetesEvents {\n+\n+  private static String opNamespace = null;\n+  private static String domainNamespace = null;\n+\n+  final String clusterName = \"mycluster\";\n+  final String adminServerName = \"admin-server\";\n+  final String adminServerPodName = domainUid + \"-\" + adminServerName;\n+  final String managedServerNameBase = \"ms-\";\n+  String managedServerPodNamePrefix = domainUid + \"-\" + managedServerNameBase;\n+  final int managedServerPort = 8001;\n+  int replicaCount = 2;\n+\n+  private static final String domainUid = \"k8seventsdomain\";\n+  private final String wlSecretName = \"weblogic-credentials\";\n+\n+  // create standard, reusable retry/backoff policy\n+  private static final ConditionFactory withStandardRetryPolicy\n+      = with().pollDelay(2, SECONDS)\n+          .and().with().pollInterval(10, SECONDS)\n+          .atMost(10, MINUTES).await();\n+\n+  private static LoggingFacade logger = null;\n+\n+  /**\n+   * Assigns unique namespaces for operator and domains. Pull WebLogic image if running tests in Kind cluster. Installs\n+   * operator.\n+   *\n+   * @param namespaces injected by JUnit\n+   */\n+  @BeforeAll\n+  public static void initAll(@Namespaces(2) List<String> namespaces) {\n+    logger = getLogger();\n+    logger.info(\"Assign a unique namespace for operator\");\n+    assertNotNull(namespaces.get(0), \"Namespace is null\");\n+    opNamespace = namespaces.get(0);\n+    logger.info(\"Assign a unique namespace for WebLogic domain\");\n+    assertNotNull(namespaces.get(1), \"Namespace is null\");\n+    domainNamespace = namespaces.get(1);\n+\n+    // install operator and verify its running in ready state\n+    installAndVerifyOperator(opNamespace, domainNamespace);\n+    // create pull secrets for WebLogic image when running in non Kind Kubernetes cluster\n+    // this secret is used only for non-kind cluster\n+    createSecretForBaseImages(domainNamespace);\n+\n+  }\n+\n+  /**\n+   * Test domain events are logged when domain resource goes through various life cycle stages.\n+   * Verifies DomainCreated is logged when domain resource is created.\n+   * Verifies DomainProcessingStarting is logged when operator processes the domain resource.\n+   * Verifies DomainProcessingCompleted is logged when operator done processes the domain resource.\n+   * Verifies DomainChanged is logged when operator processes the domain resource changes.\n+   * Verifies DomainProcessingRetrying is logged when operator retries the failed domain resource changes.\n+   * Verifies DomainProcessingAborted is logged when operator exceeds the maximum retries.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE0NzU1Ng=="}, "originalCommit": {"oid": "12df03b1349af0b7acf2379da651bcd9884c6e56"}, "originalPosition": 136}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE3MDU3NA==", "bodyText": "In addition, owls-72816 added another event - DomainValidationError. We need integration tests to cover that event as well, but it does not have to be part of this PR.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548170574", "createdAt": "2020-12-23T19:35:35Z", "author": {"login": "doxiao"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/ItKubernetesEvents.java", "diffHunk": "@@ -0,0 +1,385 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import java.io.File;\n+import java.io.FileOutputStream;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.Properties;\n+\n+import io.kubernetes.client.custom.V1Patch;\n+import io.kubernetes.client.openapi.models.V1Container;\n+import io.kubernetes.client.openapi.models.V1EnvVar;\n+import io.kubernetes.client.openapi.models.V1LocalObjectReference;\n+import io.kubernetes.client.openapi.models.V1ObjectMeta;\n+import io.kubernetes.client.openapi.models.V1PersistentVolumeClaimVolumeSource;\n+import io.kubernetes.client.openapi.models.V1SecretReference;\n+import io.kubernetes.client.openapi.models.V1Volume;\n+import io.kubernetes.client.openapi.models.V1VolumeMount;\n+import oracle.weblogic.domain.AdminServer;\n+import oracle.weblogic.domain.AdminService;\n+import oracle.weblogic.domain.Channel;\n+import oracle.weblogic.domain.Cluster;\n+import oracle.weblogic.domain.Domain;\n+import oracle.weblogic.domain.DomainSpec;\n+import oracle.weblogic.domain.ServerPod;\n+import oracle.weblogic.kubernetes.annotations.IntegrationTest;\n+import oracle.weblogic.kubernetes.annotations.Namespaces;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.awaitility.core.ConditionFactory;\n+import org.joda.time.DateTime;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static java.util.concurrent.TimeUnit.MINUTES;\n+import static java.util.concurrent.TimeUnit.SECONDS;\n+import static oracle.weblogic.kubernetes.TestConstants.ADMIN_PASSWORD_DEFAULT;\n+import static oracle.weblogic.kubernetes.TestConstants.ADMIN_USERNAME_DEFAULT;\n+import static oracle.weblogic.kubernetes.TestConstants.BASE_IMAGES_REPO_SECRET;\n+import static oracle.weblogic.kubernetes.TestConstants.DOMAIN_API_VERSION;\n+import static oracle.weblogic.kubernetes.TestConstants.K8S_NODEPORT_HOST;\n+import static oracle.weblogic.kubernetes.TestConstants.WEBLOGIC_IMAGE_TO_USE_IN_SPEC;\n+import static oracle.weblogic.kubernetes.actions.ActionConstants.RESOURCE_DIR;\n+import static oracle.weblogic.kubernetes.actions.TestActions.deleteDomainCustomResource;\n+import static oracle.weblogic.kubernetes.actions.impl.Domain.patchDomainCustomResource;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkPodDoesNotExist;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkPodReadyAndServiceExists;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createConfigMapForDomainCreation;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDomainAndVerify;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDomainJob;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createPV;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createPVC;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createSecretForBaseImages;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createSecretWithUsernamePassword;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.installAndVerifyOperator;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.setPodAntiAffinity;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_CHANGED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_CREATED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_DELETED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_ABORTED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_COMPLETED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_RETRYING;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_STARTING;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.checkDomainEvent;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.awaitility.Awaitility.with;\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Tests related to Domain events logged by operator.\n+ */\n+@DisplayName(\"Verify the Kubernetes events for domain lifecycle\")\n+@IntegrationTest\n+public class ItKubernetesEvents {\n+\n+  private static String opNamespace = null;\n+  private static String domainNamespace = null;\n+\n+  final String clusterName = \"mycluster\";\n+  final String adminServerName = \"admin-server\";\n+  final String adminServerPodName = domainUid + \"-\" + adminServerName;\n+  final String managedServerNameBase = \"ms-\";\n+  String managedServerPodNamePrefix = domainUid + \"-\" + managedServerNameBase;\n+  final int managedServerPort = 8001;\n+  int replicaCount = 2;\n+\n+  private static final String domainUid = \"k8seventsdomain\";\n+  private final String wlSecretName = \"weblogic-credentials\";\n+\n+  // create standard, reusable retry/backoff policy\n+  private static final ConditionFactory withStandardRetryPolicy\n+      = with().pollDelay(2, SECONDS)\n+          .and().with().pollInterval(10, SECONDS)\n+          .atMost(10, MINUTES).await();\n+\n+  private static LoggingFacade logger = null;\n+\n+  /**\n+   * Assigns unique namespaces for operator and domains. Pull WebLogic image if running tests in Kind cluster. Installs\n+   * operator.\n+   *\n+   * @param namespaces injected by JUnit\n+   */\n+  @BeforeAll\n+  public static void initAll(@Namespaces(2) List<String> namespaces) {\n+    logger = getLogger();\n+    logger.info(\"Assign a unique namespace for operator\");\n+    assertNotNull(namespaces.get(0), \"Namespace is null\");\n+    opNamespace = namespaces.get(0);\n+    logger.info(\"Assign a unique namespace for WebLogic domain\");\n+    assertNotNull(namespaces.get(1), \"Namespace is null\");\n+    domainNamespace = namespaces.get(1);\n+\n+    // install operator and verify its running in ready state\n+    installAndVerifyOperator(opNamespace, domainNamespace);\n+    // create pull secrets for WebLogic image when running in non Kind Kubernetes cluster\n+    // this secret is used only for non-kind cluster\n+    createSecretForBaseImages(domainNamespace);\n+\n+  }\n+\n+  /**\n+   * Test domain events are logged when domain resource goes through various life cycle stages.\n+   * Verifies DomainCreated is logged when domain resource is created.\n+   * Verifies DomainProcessingStarting is logged when operator processes the domain resource.\n+   * Verifies DomainProcessingCompleted is logged when operator done processes the domain resource.\n+   * Verifies DomainChanged is logged when operator processes the domain resource changes.\n+   * Verifies DomainProcessingRetrying is logged when operator retries the failed domain resource changes.\n+   * Verifies DomainProcessingAborted is logged when operator exceeds the maximum retries.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE0NzU1Ng=="}, "originalCommit": {"oid": "12df03b1349af0b7acf2379da651bcd9884c6e56"}, "originalPosition": 136}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODI0NTcxMg==", "bodyText": "I will add it part of another PR", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548245712", "createdAt": "2020-12-23T21:17:05Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/ItKubernetesEvents.java", "diffHunk": "@@ -0,0 +1,385 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes;\n+\n+import java.io.File;\n+import java.io.FileOutputStream;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.Properties;\n+\n+import io.kubernetes.client.custom.V1Patch;\n+import io.kubernetes.client.openapi.models.V1Container;\n+import io.kubernetes.client.openapi.models.V1EnvVar;\n+import io.kubernetes.client.openapi.models.V1LocalObjectReference;\n+import io.kubernetes.client.openapi.models.V1ObjectMeta;\n+import io.kubernetes.client.openapi.models.V1PersistentVolumeClaimVolumeSource;\n+import io.kubernetes.client.openapi.models.V1SecretReference;\n+import io.kubernetes.client.openapi.models.V1Volume;\n+import io.kubernetes.client.openapi.models.V1VolumeMount;\n+import oracle.weblogic.domain.AdminServer;\n+import oracle.weblogic.domain.AdminService;\n+import oracle.weblogic.domain.Channel;\n+import oracle.weblogic.domain.Cluster;\n+import oracle.weblogic.domain.Domain;\n+import oracle.weblogic.domain.DomainSpec;\n+import oracle.weblogic.domain.ServerPod;\n+import oracle.weblogic.kubernetes.annotations.IntegrationTest;\n+import oracle.weblogic.kubernetes.annotations.Namespaces;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.awaitility.core.ConditionFactory;\n+import org.joda.time.DateTime;\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.api.DisplayName;\n+import org.junit.jupiter.api.Test;\n+\n+import static java.util.concurrent.TimeUnit.MINUTES;\n+import static java.util.concurrent.TimeUnit.SECONDS;\n+import static oracle.weblogic.kubernetes.TestConstants.ADMIN_PASSWORD_DEFAULT;\n+import static oracle.weblogic.kubernetes.TestConstants.ADMIN_USERNAME_DEFAULT;\n+import static oracle.weblogic.kubernetes.TestConstants.BASE_IMAGES_REPO_SECRET;\n+import static oracle.weblogic.kubernetes.TestConstants.DOMAIN_API_VERSION;\n+import static oracle.weblogic.kubernetes.TestConstants.K8S_NODEPORT_HOST;\n+import static oracle.weblogic.kubernetes.TestConstants.WEBLOGIC_IMAGE_TO_USE_IN_SPEC;\n+import static oracle.weblogic.kubernetes.actions.ActionConstants.RESOURCE_DIR;\n+import static oracle.weblogic.kubernetes.actions.TestActions.deleteDomainCustomResource;\n+import static oracle.weblogic.kubernetes.actions.impl.Domain.patchDomainCustomResource;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkPodDoesNotExist;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.checkPodReadyAndServiceExists;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createConfigMapForDomainCreation;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDomainAndVerify;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createDomainJob;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createPV;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createPVC;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createSecretForBaseImages;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.createSecretWithUsernamePassword;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.installAndVerifyOperator;\n+import static oracle.weblogic.kubernetes.utils.CommonTestUtils.setPodAntiAffinity;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_CHANGED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_CREATED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_DELETED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_ABORTED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_COMPLETED;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_RETRYING;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.DOMAIN_PROCESSING_STARTING;\n+import static oracle.weblogic.kubernetes.utils.K8sEvents.checkDomainEvent;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.awaitility.Awaitility.with;\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Tests related to Domain events logged by operator.\n+ */\n+@DisplayName(\"Verify the Kubernetes events for domain lifecycle\")\n+@IntegrationTest\n+public class ItKubernetesEvents {\n+\n+  private static String opNamespace = null;\n+  private static String domainNamespace = null;\n+\n+  final String clusterName = \"mycluster\";\n+  final String adminServerName = \"admin-server\";\n+  final String adminServerPodName = domainUid + \"-\" + adminServerName;\n+  final String managedServerNameBase = \"ms-\";\n+  String managedServerPodNamePrefix = domainUid + \"-\" + managedServerNameBase;\n+  final int managedServerPort = 8001;\n+  int replicaCount = 2;\n+\n+  private static final String domainUid = \"k8seventsdomain\";\n+  private final String wlSecretName = \"weblogic-credentials\";\n+\n+  // create standard, reusable retry/backoff policy\n+  private static final ConditionFactory withStandardRetryPolicy\n+      = with().pollDelay(2, SECONDS)\n+          .and().with().pollInterval(10, SECONDS)\n+          .atMost(10, MINUTES).await();\n+\n+  private static LoggingFacade logger = null;\n+\n+  /**\n+   * Assigns unique namespaces for operator and domains. Pull WebLogic image if running tests in Kind cluster. Installs\n+   * operator.\n+   *\n+   * @param namespaces injected by JUnit\n+   */\n+  @BeforeAll\n+  public static void initAll(@Namespaces(2) List<String> namespaces) {\n+    logger = getLogger();\n+    logger.info(\"Assign a unique namespace for operator\");\n+    assertNotNull(namespaces.get(0), \"Namespace is null\");\n+    opNamespace = namespaces.get(0);\n+    logger.info(\"Assign a unique namespace for WebLogic domain\");\n+    assertNotNull(namespaces.get(1), \"Namespace is null\");\n+    domainNamespace = namespaces.get(1);\n+\n+    // install operator and verify its running in ready state\n+    installAndVerifyOperator(opNamespace, domainNamespace);\n+    // create pull secrets for WebLogic image when running in non Kind Kubernetes cluster\n+    // this secret is used only for non-kind cluster\n+    createSecretForBaseImages(domainNamespace);\n+\n+  }\n+\n+  /**\n+   * Test domain events are logged when domain resource goes through various life cycle stages.\n+   * Verifies DomainCreated is logged when domain resource is created.\n+   * Verifies DomainProcessingStarting is logged when operator processes the domain resource.\n+   * Verifies DomainProcessingCompleted is logged when operator done processes the domain resource.\n+   * Verifies DomainChanged is logged when operator processes the domain resource changes.\n+   * Verifies DomainProcessingRetrying is logged when operator retries the failed domain resource changes.\n+   * Verifies DomainProcessingAborted is logged when operator exceeds the maximum retries.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE0NzU1Ng=="}, "originalCommit": {"oid": "12df03b1349af0b7acf2379da651bcd9884c6e56"}, "originalPosition": 136}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0NjU5MDg5OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxOTowNTozM1rOIKwUvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QyMToxOToyMlrOIK2X2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE0ODQxMg==", "bodyText": "The xxxx in the message needs to be replace with the real error message.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548148412", "createdAt": "2020-12-23T19:05:33Z", "author": {"login": "doxiao"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "diffHunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.Callable;\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import io.kubernetes.client.openapi.models.V1Event;\n+import io.kubernetes.client.util.Yaml;\n+import oracle.weblogic.kubernetes.ItKubernetesEvents;\n+import oracle.weblogic.kubernetes.TestConstants;\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.joda.time.DateTime;\n+\n+import static oracle.weblogic.kubernetes.TestConstants.OPERATOR_RELEASE_NAME;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Helper class for Kubernetes Events checking.\n+ */\n+public class K8sEvents {\n+\n+  private static final LoggingFacade logger = getLogger();\n+\n+  /**\n+   * Check if a given event is logged by the operator.\n+   *\n+   * @param opNamespace namespace in which the operator is running\n+   * @param domainNamespace namespace in which the domain exists\n+   * @param domainUid UID of the domain\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param type type of event, Normal of Warning\n+   * @param timestamp the timestamp after which to see events\n+   */\n+  public static Callable<Boolean> checkDomainEvent(\n+      String opNamespace, String domainNamespace, String domainUid, String reason, String type, DateTime timestamp) {\n+    return () -> {\n+      logger.info(\"Verifying {0} event is logged by the operator in domain namespace {1}\", reason, domainNamespace);\n+      try {\n+        List<V1Event> events = Kubernetes.listNamespacedEvents(domainNamespace);\n+        for (V1Event event : events) {\n+          if (event.getReason().contains(reason)\n+              && event.getMetadata().getCreationTimestamp().isAfter(timestamp.getMillis())) {\n+            logger.info(Yaml.dump(event));\n+            verifyOperatorDetails(event, opNamespace, domainUid);\n+            //verify reason\n+            logger.info(\"Verifying domain event {0}\", reason);\n+            assertTrue(event.getReason().equals(reason));\n+            //verify messages\n+            logger.info(\"Verifying domain event message {0}\", getDomainEventMessage(reason, domainUid));\n+            assertTrue(event.getMessage().contains(getDomainEventMessage(reason, domainUid)));\n+            //verify type\n+            logger.info(\"Verifying domain event type {0}\", type);\n+            assertTrue(event.getType().equals(type));\n+            return true;\n+          }\n+        }\n+      } catch (ApiException ex) {\n+        Logger.getLogger(ItKubernetesEvents.class.getName()).log(Level.SEVERE, null, ex);\n+      }\n+      return false;\n+    };\n+  }\n+\n+  // Verify the operator instance details are correct\n+  private static void verifyOperatorDetails(V1Event event, String opNamespace, String domainUid) throws ApiException {\n+    logger.info(\"Verifying operator details\");\n+    String operatorPodName = TestActions.getOperatorPodName(OPERATOR_RELEASE_NAME, opNamespace);\n+    //verify DOMAIN_API_VERSION\n+    assertTrue(event.getInvolvedObject().getApiVersion().equals(TestConstants.DOMAIN_API_VERSION),\n+        \"Expected \" + TestConstants.DOMAIN_API_VERSION + \" ,Got \" + event.getInvolvedObject().getApiVersion());\n+    //verify reporting component to be operator release\n+    assertTrue(event.getReportingComponent().equals(\"weblogic.operator\"),\n+        \"Didn't get reporting component as \" + \"weblogic.operator\");\n+    //verify reporting instance to be operator instance\n+    assertTrue(event.getReportingInstance().equals(operatorPodName),\n+        \"Didn't get reporting instance as \" + operatorPodName);\n+    //verify the event was created by operator\n+    Map<String, String> labels = event.getMetadata().getLabels();\n+    assertTrue(labels.containsKey(\"weblogic.createdByOperator\")\n+        && labels.get(\"weblogic.createdByOperator\").equals(\"true\"));\n+    //verify the domainUID matches\n+    assertTrue(labels.containsKey(\"weblogic.domainUID\")\n+        && labels.get(\"weblogic.domainUID\").equals(domainUid));\n+  }\n+\n+  /**\n+   * Returns the description for different event types.\n+   *\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param domainUid UID of the domain\n+   * @return String containing the complete description\n+   */\n+  public static String getDomainEventMessage(String reason, String domainUid) {\n+    String message = \"\";\n+    switch (reason) {\n+      case DOMAIN_CREATED:\n+        message = \"Domain resource \" + domainUid + \" was created\";\n+        break;\n+      case DOMAIN_DELETED:\n+        message = \"Domain resource \" + domainUid + \" was deleted\";\n+        break;\n+      case DOMAIN_CHANGED:\n+        message = \"Domain resource \" + domainUid + \" was changed\";\n+        break;\n+      case DOMAIN_PROCESSING_STARTING:\n+        message = \"Creating or updating Kubernetes presence for WebLogic Domain with UID \" + domainUid;\n+        break;\n+      case DOMAIN_PROCESSING_COMPLETED:\n+        message = \"Successfully completed processing domain resource \" + domainUid;\n+        break;\n+      case DOMAIN_PROCESSING_FAILED:\n+        message = \"Failed to process domain resource \" + domainUid\n+            + \" due to xxxx, the processing  will be retried if required\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "12df03b1349af0b7acf2379da651bcd9884c6e56"}, "originalPosition": 122}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODI0NzUxNA==", "bodyText": "removed", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548247514", "createdAt": "2020-12-23T21:19:22Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "diffHunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.Callable;\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import io.kubernetes.client.openapi.models.V1Event;\n+import io.kubernetes.client.util.Yaml;\n+import oracle.weblogic.kubernetes.ItKubernetesEvents;\n+import oracle.weblogic.kubernetes.TestConstants;\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.joda.time.DateTime;\n+\n+import static oracle.weblogic.kubernetes.TestConstants.OPERATOR_RELEASE_NAME;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Helper class for Kubernetes Events checking.\n+ */\n+public class K8sEvents {\n+\n+  private static final LoggingFacade logger = getLogger();\n+\n+  /**\n+   * Check if a given event is logged by the operator.\n+   *\n+   * @param opNamespace namespace in which the operator is running\n+   * @param domainNamespace namespace in which the domain exists\n+   * @param domainUid UID of the domain\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param type type of event, Normal of Warning\n+   * @param timestamp the timestamp after which to see events\n+   */\n+  public static Callable<Boolean> checkDomainEvent(\n+      String opNamespace, String domainNamespace, String domainUid, String reason, String type, DateTime timestamp) {\n+    return () -> {\n+      logger.info(\"Verifying {0} event is logged by the operator in domain namespace {1}\", reason, domainNamespace);\n+      try {\n+        List<V1Event> events = Kubernetes.listNamespacedEvents(domainNamespace);\n+        for (V1Event event : events) {\n+          if (event.getReason().contains(reason)\n+              && event.getMetadata().getCreationTimestamp().isAfter(timestamp.getMillis())) {\n+            logger.info(Yaml.dump(event));\n+            verifyOperatorDetails(event, opNamespace, domainUid);\n+            //verify reason\n+            logger.info(\"Verifying domain event {0}\", reason);\n+            assertTrue(event.getReason().equals(reason));\n+            //verify messages\n+            logger.info(\"Verifying domain event message {0}\", getDomainEventMessage(reason, domainUid));\n+            assertTrue(event.getMessage().contains(getDomainEventMessage(reason, domainUid)));\n+            //verify type\n+            logger.info(\"Verifying domain event type {0}\", type);\n+            assertTrue(event.getType().equals(type));\n+            return true;\n+          }\n+        }\n+      } catch (ApiException ex) {\n+        Logger.getLogger(ItKubernetesEvents.class.getName()).log(Level.SEVERE, null, ex);\n+      }\n+      return false;\n+    };\n+  }\n+\n+  // Verify the operator instance details are correct\n+  private static void verifyOperatorDetails(V1Event event, String opNamespace, String domainUid) throws ApiException {\n+    logger.info(\"Verifying operator details\");\n+    String operatorPodName = TestActions.getOperatorPodName(OPERATOR_RELEASE_NAME, opNamespace);\n+    //verify DOMAIN_API_VERSION\n+    assertTrue(event.getInvolvedObject().getApiVersion().equals(TestConstants.DOMAIN_API_VERSION),\n+        \"Expected \" + TestConstants.DOMAIN_API_VERSION + \" ,Got \" + event.getInvolvedObject().getApiVersion());\n+    //verify reporting component to be operator release\n+    assertTrue(event.getReportingComponent().equals(\"weblogic.operator\"),\n+        \"Didn't get reporting component as \" + \"weblogic.operator\");\n+    //verify reporting instance to be operator instance\n+    assertTrue(event.getReportingInstance().equals(operatorPodName),\n+        \"Didn't get reporting instance as \" + operatorPodName);\n+    //verify the event was created by operator\n+    Map<String, String> labels = event.getMetadata().getLabels();\n+    assertTrue(labels.containsKey(\"weblogic.createdByOperator\")\n+        && labels.get(\"weblogic.createdByOperator\").equals(\"true\"));\n+    //verify the domainUID matches\n+    assertTrue(labels.containsKey(\"weblogic.domainUID\")\n+        && labels.get(\"weblogic.domainUID\").equals(domainUid));\n+  }\n+\n+  /**\n+   * Returns the description for different event types.\n+   *\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param domainUid UID of the domain\n+   * @return String containing the complete description\n+   */\n+  public static String getDomainEventMessage(String reason, String domainUid) {\n+    String message = \"\";\n+    switch (reason) {\n+      case DOMAIN_CREATED:\n+        message = \"Domain resource \" + domainUid + \" was created\";\n+        break;\n+      case DOMAIN_DELETED:\n+        message = \"Domain resource \" + domainUid + \" was deleted\";\n+        break;\n+      case DOMAIN_CHANGED:\n+        message = \"Domain resource \" + domainUid + \" was changed\";\n+        break;\n+      case DOMAIN_PROCESSING_STARTING:\n+        message = \"Creating or updating Kubernetes presence for WebLogic Domain with UID \" + domainUid;\n+        break;\n+      case DOMAIN_PROCESSING_COMPLETED:\n+        message = \"Successfully completed processing domain resource \" + domainUid;\n+        break;\n+      case DOMAIN_PROCESSING_FAILED:\n+        message = \"Failed to process domain resource \" + domainUid\n+            + \" due to xxxx, the processing  will be retried if required\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODE0ODQxMg=="}, "originalCommit": {"oid": "12df03b1349af0b7acf2379da651bcd9884c6e56"}, "originalPosition": 122}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ0NzA3MDE3OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QyMDo1MzoxN1rOIK1MZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QyMToxOToyOVrOIK2YKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODIyODE5Ng==", "bodyText": "now that we don't check event messages anymore, do we still need this method?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548228196", "createdAt": "2020-12-23T20:53:17Z", "author": {"login": "doxiao"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "diffHunk": "@@ -0,0 +1,142 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.Callable;\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import io.kubernetes.client.openapi.models.V1Event;\n+import io.kubernetes.client.util.Yaml;\n+import oracle.weblogic.kubernetes.ItKubernetesEvents;\n+import oracle.weblogic.kubernetes.TestConstants;\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.joda.time.DateTime;\n+\n+import static oracle.weblogic.kubernetes.TestConstants.OPERATOR_RELEASE_NAME;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Helper class for Kubernetes Events checking.\n+ */\n+public class K8sEvents {\n+\n+  private static final LoggingFacade logger = getLogger();\n+\n+  /**\n+   * Check if a given event is logged by the operator.\n+   *\n+   * @param opNamespace namespace in which the operator is running\n+   * @param domainNamespace namespace in which the domain exists\n+   * @param domainUid UID of the domain\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param type type of event, Normal of Warning\n+   * @param timestamp the timestamp after which to see events\n+   */\n+  public static Callable<Boolean> checkDomainEvent(\n+      String opNamespace, String domainNamespace, String domainUid, String reason, String type, DateTime timestamp) {\n+    return () -> {\n+      logger.info(\"Verifying {0} event is logged by the operator in domain namespace {1}\", reason, domainNamespace);\n+      try {\n+        List<V1Event> events = Kubernetes.listNamespacedEvents(domainNamespace);\n+        for (V1Event event : events) {\n+          if (event.getReason().contains(reason)\n+              && event.getMetadata().getCreationTimestamp().isAfter(timestamp.getMillis())) {\n+            logger.info(Yaml.dump(event));\n+            verifyOperatorDetails(event, opNamespace, domainUid);\n+            //verify reason\n+            logger.info(\"Verifying domain event {0}\", reason);\n+            assertTrue(event.getReason().equals(reason));\n+            //verify type\n+            logger.info(\"Verifying domain event type {0}\", type);\n+            assertTrue(event.getType().equals(type));\n+            return true;\n+          }\n+        }\n+      } catch (ApiException ex) {\n+        Logger.getLogger(ItKubernetesEvents.class.getName()).log(Level.SEVERE, null, ex);\n+      }\n+      return false;\n+    };\n+  }\n+\n+  // Verify the operator instance details are correct\n+  private static void verifyOperatorDetails(V1Event event, String opNamespace, String domainUid) throws ApiException {\n+    logger.info(\"Verifying operator details\");\n+    String operatorPodName = TestActions.getOperatorPodName(OPERATOR_RELEASE_NAME, opNamespace);\n+    //verify DOMAIN_API_VERSION\n+    assertTrue(event.getInvolvedObject().getApiVersion().equals(TestConstants.DOMAIN_API_VERSION),\n+        \"Expected \" + TestConstants.DOMAIN_API_VERSION + \" ,Got \" + event.getInvolvedObject().getApiVersion());\n+    //verify reporting component to be operator release\n+    assertTrue(event.getReportingComponent().equals(\"weblogic.operator\"),\n+        \"Didn't get reporting component as \" + \"weblogic.operator\");\n+    //verify reporting instance to be operator instance\n+    assertTrue(event.getReportingInstance().equals(operatorPodName),\n+        \"Didn't get reporting instance as \" + operatorPodName);\n+    //verify the event was created by operator\n+    Map<String, String> labels = event.getMetadata().getLabels();\n+    assertTrue(labels.containsKey(\"weblogic.createdByOperator\")\n+        && labels.get(\"weblogic.createdByOperator\").equals(\"true\"));\n+    //verify the domainUID matches\n+    assertTrue(labels.containsKey(\"weblogic.domainUID\")\n+        && labels.get(\"weblogic.domainUID\").equals(domainUid));\n+  }\n+\n+  /**\n+   * Returns the description for different event types.\n+   *\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param domainUid UID of the domain\n+   * @return String containing the complete description\n+   */\n+  public static String getDomainEventMessage(String reason, String domainUid) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ee73cf363635a3424df44b92e32e24cf65cf78a"}, "originalPosition": 99}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODI0NzU5Mw==", "bodyText": "removed", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2115#discussion_r548247593", "createdAt": "2020-12-23T21:19:29Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/weblogic/kubernetes/utils/K8sEvents.java", "diffHunk": "@@ -0,0 +1,142 @@\n+// Copyright (c) 2020, Oracle Corporation and/or its affiliates.\n+// Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n+\n+package oracle.weblogic.kubernetes.utils;\n+\n+import java.util.List;\n+import java.util.Map;\n+import java.util.concurrent.Callable;\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n+\n+import io.kubernetes.client.openapi.ApiException;\n+import io.kubernetes.client.openapi.models.V1Event;\n+import io.kubernetes.client.util.Yaml;\n+import oracle.weblogic.kubernetes.ItKubernetesEvents;\n+import oracle.weblogic.kubernetes.TestConstants;\n+import oracle.weblogic.kubernetes.actions.TestActions;\n+import oracle.weblogic.kubernetes.actions.impl.primitive.Kubernetes;\n+import oracle.weblogic.kubernetes.logging.LoggingFacade;\n+import org.joda.time.DateTime;\n+\n+import static oracle.weblogic.kubernetes.TestConstants.OPERATOR_RELEASE_NAME;\n+import static oracle.weblogic.kubernetes.utils.ThreadSafeLogger.getLogger;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+/**\n+ * Helper class for Kubernetes Events checking.\n+ */\n+public class K8sEvents {\n+\n+  private static final LoggingFacade logger = getLogger();\n+\n+  /**\n+   * Check if a given event is logged by the operator.\n+   *\n+   * @param opNamespace namespace in which the operator is running\n+   * @param domainNamespace namespace in which the domain exists\n+   * @param domainUid UID of the domain\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param type type of event, Normal of Warning\n+   * @param timestamp the timestamp after which to see events\n+   */\n+  public static Callable<Boolean> checkDomainEvent(\n+      String opNamespace, String domainNamespace, String domainUid, String reason, String type, DateTime timestamp) {\n+    return () -> {\n+      logger.info(\"Verifying {0} event is logged by the operator in domain namespace {1}\", reason, domainNamespace);\n+      try {\n+        List<V1Event> events = Kubernetes.listNamespacedEvents(domainNamespace);\n+        for (V1Event event : events) {\n+          if (event.getReason().contains(reason)\n+              && event.getMetadata().getCreationTimestamp().isAfter(timestamp.getMillis())) {\n+            logger.info(Yaml.dump(event));\n+            verifyOperatorDetails(event, opNamespace, domainUid);\n+            //verify reason\n+            logger.info(\"Verifying domain event {0}\", reason);\n+            assertTrue(event.getReason().equals(reason));\n+            //verify type\n+            logger.info(\"Verifying domain event type {0}\", type);\n+            assertTrue(event.getType().equals(type));\n+            return true;\n+          }\n+        }\n+      } catch (ApiException ex) {\n+        Logger.getLogger(ItKubernetesEvents.class.getName()).log(Level.SEVERE, null, ex);\n+      }\n+      return false;\n+    };\n+  }\n+\n+  // Verify the operator instance details are correct\n+  private static void verifyOperatorDetails(V1Event event, String opNamespace, String domainUid) throws ApiException {\n+    logger.info(\"Verifying operator details\");\n+    String operatorPodName = TestActions.getOperatorPodName(OPERATOR_RELEASE_NAME, opNamespace);\n+    //verify DOMAIN_API_VERSION\n+    assertTrue(event.getInvolvedObject().getApiVersion().equals(TestConstants.DOMAIN_API_VERSION),\n+        \"Expected \" + TestConstants.DOMAIN_API_VERSION + \" ,Got \" + event.getInvolvedObject().getApiVersion());\n+    //verify reporting component to be operator release\n+    assertTrue(event.getReportingComponent().equals(\"weblogic.operator\"),\n+        \"Didn't get reporting component as \" + \"weblogic.operator\");\n+    //verify reporting instance to be operator instance\n+    assertTrue(event.getReportingInstance().equals(operatorPodName),\n+        \"Didn't get reporting instance as \" + operatorPodName);\n+    //verify the event was created by operator\n+    Map<String, String> labels = event.getMetadata().getLabels();\n+    assertTrue(labels.containsKey(\"weblogic.createdByOperator\")\n+        && labels.get(\"weblogic.createdByOperator\").equals(\"true\"));\n+    //verify the domainUID matches\n+    assertTrue(labels.containsKey(\"weblogic.domainUID\")\n+        && labels.get(\"weblogic.domainUID\").equals(domainUid));\n+  }\n+\n+  /**\n+   * Returns the description for different event types.\n+   *\n+   * @param reason event to check for Created, Changed, deleted, processing etc\n+   * @param domainUid UID of the domain\n+   * @return String containing the complete description\n+   */\n+  public static String getDomainEventMessage(String reason, String domainUid) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODIyODE5Ng=="}, "originalCommit": {"oid": "8ee73cf363635a3424df44b92e32e24cf65cf78a"}, "originalPosition": 99}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3842, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}