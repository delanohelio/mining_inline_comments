{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNjM1MjM2", "number": 1623, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjo1OToxNlrOD5fqZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxOTo0ODozOFrOD5jdAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNjE0MTgxOnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNjo1OToxNlrOGQy5JQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzowNzowNFrOGQzMeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI2NDIyOQ==", "bodyText": "FULLTEST or QUICKTEST ?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420264229", "createdAt": "2020-05-05T16:59:16Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "diffHunk": "@@ -179,35 +173,35 @@ public void prepare() throws Exception {\n    */\n   @AfterAll\n   public static void staticUnPrepare() throws Exception {\n-    if (FULLTEST) {\n-      if (domain != null) {\n-        domain.destroy();\n-        TestUtils.deleteWeblogicDomainResources(domainNS1);\n-        if (BaseTest.SHARED_CLUSTER) {\n-\n-          String image = System.getenv(\"REPO_REGISTRY\")\n-              + \"/weblogick8s/\"\n-              + domainNS2\n-              + \"-image:\" + currentDateTime;\n-          String cmd = \"docker rmi -f \" + image;\n-          TestUtils.execOrAbortProcess(cmd, true);\n-        }\n-        String cmd = \"docker rmi -f \" + domainNS2 + \"-image:\" + currentDateTime;\n+    Assumptions.assumeTrue(QUICKTEST);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65e5632eda54167249a4b995aa204691b396294e"}, "originalPosition": 179}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI2OTE3Ng==", "bodyText": "fixed , thank you", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420269176", "createdAt": "2020-05-05T17:07:04Z", "author": {"login": "marinakog"}, "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "diffHunk": "@@ -179,35 +173,35 @@ public void prepare() throws Exception {\n    */\n   @AfterAll\n   public static void staticUnPrepare() throws Exception {\n-    if (FULLTEST) {\n-      if (domain != null) {\n-        domain.destroy();\n-        TestUtils.deleteWeblogicDomainResources(domainNS1);\n-        if (BaseTest.SHARED_CLUSTER) {\n-\n-          String image = System.getenv(\"REPO_REGISTRY\")\n-              + \"/weblogick8s/\"\n-              + domainNS2\n-              + \"-image:\" + currentDateTime;\n-          String cmd = \"docker rmi -f \" + image;\n-          TestUtils.execOrAbortProcess(cmd, true);\n-        }\n-        String cmd = \"docker rmi -f \" + domainNS2 + \"-image:\" + currentDateTime;\n+    Assumptions.assumeTrue(QUICKTEST);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI2NDIyOQ=="}, "originalCommit": {"oid": "65e5632eda54167249a4b995aa204691b396294e"}, "originalPosition": 179}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNjI2NDg0OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzozMDo0N1rOGQ0Hrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzozNTowN1rOGQ0SBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI4NDMzNQ==", "bodyText": "If its a SHARED_CLUSTER both docker rmi -f commands get executed or line # 189 is supposed to be in a else block?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420284335", "createdAt": "2020-05-05T17:30:47Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "diffHunk": "@@ -179,35 +173,35 @@ public void prepare() throws Exception {\n    */\n   @AfterAll\n   public static void staticUnPrepare() throws Exception {\n-    if (FULLTEST) {\n-      if (domain != null) {\n-        domain.destroy();\n-        TestUtils.deleteWeblogicDomainResources(domainNS1);\n-        if (BaseTest.SHARED_CLUSTER) {\n-\n-          String image = System.getenv(\"REPO_REGISTRY\")\n-              + \"/weblogick8s/\"\n-              + domainNS2\n-              + \"-image:\" + currentDateTime;\n-          String cmd = \"docker rmi -f \" + image;\n-          TestUtils.execOrAbortProcess(cmd, true);\n-        }\n-        String cmd = \"docker rmi -f \" + domainNS2 + \"-image:\" + currentDateTime;\n+    Assumptions.assumeTrue(FULLTEST);\n+    if (domain != null) {\n+      domain.destroy();\n+      TestUtils.deleteWeblogicDomainResources(domainNS1);\n+      if (BaseTest.SHARED_CLUSTER) {\n+\n+        String image = System.getenv(\"REPO_REGISTRY\")\n+            + \"/weblogick8s/\"\n+            + domainNS2\n+            + \"-image:\" + currentDateTime;\n+        String cmd = \"docker rmi -f \" + image;\n         TestUtils.execOrAbortProcess(cmd, true);\n       }\n-      if (operator != null) {\n-        operator.destroy();\n-      }\n-      try {\n-        uninstallWebHookPrometheusGrafanaMySql();\n-      } catch (Exception ex) {\n-        LoggerHelper.getLocal().log(Level.INFO,\n-            \"Exception caught while uninstalling webhook/prometheus/Grafana/Mysql \" + ex.getMessage());\n-      }\n-\n-      tearDown(new Object() {}.getClass().getEnclosingClass().getSimpleName(), namespaceList.toString());\n-      LoggerHelper.getLocal().log(Level.INFO,\"SUCCESS\");\n+      String cmd = \"docker rmi -f \" + domainNS2 + \"-image:\" + currentDateTime;\n+      TestUtils.execOrAbortProcess(cmd, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 205}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI4Njk4MA==", "bodyText": "yes, if shared cluster it also tags image to [ocipath]/imagename as well, so need to delete both images [ocipath]/imagename in else block for shared cluster and \"imagename\" in general", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420286980", "createdAt": "2020-05-05T17:35:07Z", "author": {"login": "marinakog"}, "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "diffHunk": "@@ -179,35 +173,35 @@ public void prepare() throws Exception {\n    */\n   @AfterAll\n   public static void staticUnPrepare() throws Exception {\n-    if (FULLTEST) {\n-      if (domain != null) {\n-        domain.destroy();\n-        TestUtils.deleteWeblogicDomainResources(domainNS1);\n-        if (BaseTest.SHARED_CLUSTER) {\n-\n-          String image = System.getenv(\"REPO_REGISTRY\")\n-              + \"/weblogick8s/\"\n-              + domainNS2\n-              + \"-image:\" + currentDateTime;\n-          String cmd = \"docker rmi -f \" + image;\n-          TestUtils.execOrAbortProcess(cmd, true);\n-        }\n-        String cmd = \"docker rmi -f \" + domainNS2 + \"-image:\" + currentDateTime;\n+    Assumptions.assumeTrue(FULLTEST);\n+    if (domain != null) {\n+      domain.destroy();\n+      TestUtils.deleteWeblogicDomainResources(domainNS1);\n+      if (BaseTest.SHARED_CLUSTER) {\n+\n+        String image = System.getenv(\"REPO_REGISTRY\")\n+            + \"/weblogick8s/\"\n+            + domainNS2\n+            + \"-image:\" + currentDateTime;\n+        String cmd = \"docker rmi -f \" + image;\n         TestUtils.execOrAbortProcess(cmd, true);\n       }\n-      if (operator != null) {\n-        operator.destroy();\n-      }\n-      try {\n-        uninstallWebHookPrometheusGrafanaMySql();\n-      } catch (Exception ex) {\n-        LoggerHelper.getLocal().log(Level.INFO,\n-            \"Exception caught while uninstalling webhook/prometheus/Grafana/Mysql \" + ex.getMessage());\n-      }\n-\n-      tearDown(new Object() {}.getClass().getEnclosingClass().getSimpleName(), namespaceList.toString());\n-      LoggerHelper.getLocal().log(Level.INFO,\"SUCCESS\");\n+      String cmd = \"docker rmi -f \" + domainNS2 + \"-image:\" + currentDateTime;\n+      TestUtils.execOrAbortProcess(cmd, true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI4NDMzNQ=="}, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 205}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNjMwMjA1OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/resources/deploywebapp.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzo0MDo0N1rOGQ0fBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxODozMjozOVrOGQ2aLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI5MDMwOQ==", "bodyText": "is the check is only for debugging purposes? or deploy needs to be aborted when cluster state is not in the expected state.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420290309", "createdAt": "2020-05-05T17:40:47Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/resources/deploywebapp.py", "diffHunk": "@@ -1,22 +1,12 @@\n # Copyright (c) 2018, 2020, Oracle Corporation and/or its affiliates.\n # Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n-\n-import time as systime\n-\n connect(sys.argv[1],sys.argv[2],sys.argv[3])\n-deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n-#systime.sleep(15)\n-\n-#cd ('AppDeployments')\n-#myapps=cmo.getAppDeployments()\n- \n-#for appName in myapps:\n-#       domainConfig()\n-#       cd ('/AppDeployments/'+appName.getName()+'/Targets')\n-#       mytargets = ls(returnMap='true')\n-#       domainRuntime()\n-#       cd('AppRuntimeStateRuntime')\n-#       cd('AppRuntimeStateRuntime')\n-#       for targetinst in mytargets:\n-#             curstate4=cmo.getCurrentState(appName.getName(),targetinst)\n-#             print '-----------', curstate4, '-----------', appName.getName()\n\\ No newline at end of file\n+appName=sys.argv[4]\n+appPath=sys.argv[5]\n+clusterName=sys.argv[6]\n+print 'Deploying application[%s] to the Cluster[%s] located @ [%s] ' %(appName,clusterName,appPath)\n+print 'Checking the server status on the Cluster[%s] ' %(clusterName)\n+domainRuntime()\n+state(clusterName,'Cluster')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMyMTgzOA==", "bodyText": "it is just for debugging purpose, I used code from Vanaja, she is investigating the deploy issue", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420321838", "createdAt": "2020-05-05T18:32:39Z", "author": {"login": "marinakog"}, "path": "integration-tests/src/test/resources/deploywebapp.py", "diffHunk": "@@ -1,22 +1,12 @@\n # Copyright (c) 2018, 2020, Oracle Corporation and/or its affiliates.\n # Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n-\n-import time as systime\n-\n connect(sys.argv[1],sys.argv[2],sys.argv[3])\n-deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n-#systime.sleep(15)\n-\n-#cd ('AppDeployments')\n-#myapps=cmo.getAppDeployments()\n- \n-#for appName in myapps:\n-#       domainConfig()\n-#       cd ('/AppDeployments/'+appName.getName()+'/Targets')\n-#       mytargets = ls(returnMap='true')\n-#       domainRuntime()\n-#       cd('AppRuntimeStateRuntime')\n-#       cd('AppRuntimeStateRuntime')\n-#       for targetinst in mytargets:\n-#             curstate4=cmo.getCurrentState(appName.getName(),targetinst)\n-#             print '-----------', curstate4, '-----------', appName.getName()\n\\ No newline at end of file\n+appName=sys.argv[4]\n+appPath=sys.argv[5]\n+clusterName=sys.argv[6]\n+print 'Deploying application[%s] to the Cluster[%s] located @ [%s] ' %(appName,clusterName,appPath)\n+print 'Checking the server status on the Cluster[%s] ' %(clusterName)\n+domainRuntime()\n+state(clusterName,'Cluster')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI5MDMwOQ=="}, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNjMxMjI1OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/resources/deploywebapp.py", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzo0MzoyMlrOGQ0lMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxODozMzoyOVrOGQ2cGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI5MTg5MA==", "bodyText": "deploy works even when in domainRuntime? or you have to be in config tree. Just want to make sure.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420291890", "createdAt": "2020-05-05T17:43:22Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/resources/deploywebapp.py", "diffHunk": "@@ -1,22 +1,12 @@\n # Copyright (c) 2018, 2020, Oracle Corporation and/or its affiliates.\n # Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n-\n-import time as systime\n-\n connect(sys.argv[1],sys.argv[2],sys.argv[3])\n-deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n-#systime.sleep(15)\n-\n-#cd ('AppDeployments')\n-#myapps=cmo.getAppDeployments()\n- \n-#for appName in myapps:\n-#       domainConfig()\n-#       cd ('/AppDeployments/'+appName.getName()+'/Targets')\n-#       mytargets = ls(returnMap='true')\n-#       domainRuntime()\n-#       cd('AppRuntimeStateRuntime')\n-#       cd('AppRuntimeStateRuntime')\n-#       for targetinst in mytargets:\n-#             curstate4=cmo.getCurrentState(appName.getName(),targetinst)\n-#             print '-----------', curstate4, '-----------', appName.getName()\n\\ No newline at end of file\n+appName=sys.argv[4]\n+appPath=sys.argv[5]\n+clusterName=sys.argv[6]\n+print 'Deploying application[%s] to the Cluster[%s] located @ [%s] ' %(appName,clusterName,appPath)\n+print 'Checking the server status on the Cluster[%s] ' %(clusterName)\n+domainRuntime()\n+state(clusterName,'Cluster')\n+#deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n+deploy(appName=appName, path=appPath, targets=clusterName)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMyMjMzMA==", "bodyText": "yes it is existed code I just modified for debug purposes", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420322330", "createdAt": "2020-05-05T18:33:29Z", "author": {"login": "marinakog"}, "path": "integration-tests/src/test/resources/deploywebapp.py", "diffHunk": "@@ -1,22 +1,12 @@\n # Copyright (c) 2018, 2020, Oracle Corporation and/or its affiliates.\n # Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n-\n-import time as systime\n-\n connect(sys.argv[1],sys.argv[2],sys.argv[3])\n-deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n-#systime.sleep(15)\n-\n-#cd ('AppDeployments')\n-#myapps=cmo.getAppDeployments()\n- \n-#for appName in myapps:\n-#       domainConfig()\n-#       cd ('/AppDeployments/'+appName.getName()+'/Targets')\n-#       mytargets = ls(returnMap='true')\n-#       domainRuntime()\n-#       cd('AppRuntimeStateRuntime')\n-#       cd('AppRuntimeStateRuntime')\n-#       for targetinst in mytargets:\n-#             curstate4=cmo.getCurrentState(appName.getName(),targetinst)\n-#             print '-----------', curstate4, '-----------', appName.getName()\n\\ No newline at end of file\n+appName=sys.argv[4]\n+appPath=sys.argv[5]\n+clusterName=sys.argv[6]\n+print 'Deploying application[%s] to the Cluster[%s] located @ [%s] ' %(appName,clusterName,appPath)\n+print 'Checking the server status on the Cluster[%s] ' %(clusterName)\n+domainRuntime()\n+state(clusterName,'Cluster')\n+#deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n+deploy(appName=appName, path=appPath, targets=clusterName)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI5MTg5MA=="}, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNjMyNDM4OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/resources/exporter/createGrafana.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzo0NjozMlrOGQ0siQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxODozNjo0MVrOGQ2jrQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI5Mzc2OQ==", "bodyText": "At this point you are sure that the grafana pod at least created ?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420293769", "createdAt": "2020-05-05T17:46:32Z", "author": {"login": "sankarpn"}, "path": "integration-tests/src/test/resources/exporter/createGrafana.sh", "diffHunk": "@@ -5,23 +5,57 @@ monitoringExporterDir=$1\n resourceExporterDir=$2\n grafanaVersionArgs=$3\n monitoringExporterEndToEndDir=${monitoringExporterDir}/src/samples/kubernetes/end2end\n-\n+CHARTNS=monitortestns\n+CHARTNAME=grafana\n HELM_VERSION=$(helm version --short --client)\n \n+function checkPod() {\n+  max=20\n+  count=0\n+  echo \"Checking pods $CHARTNAME\"\n+  grafanapod=$(kubectl get po -n $CHARTNS | grep $CHARTNAME | awk '{print $1 }')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMyNDI2OQ==", "bodyText": "the grafanapod value is used only for debugging of failure. There is another check for helm install success before calling this code. So at this point pod is created but might has failures", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420324269", "createdAt": "2020-05-05T18:36:41Z", "author": {"login": "marinakog"}, "path": "integration-tests/src/test/resources/exporter/createGrafana.sh", "diffHunk": "@@ -5,23 +5,57 @@ monitoringExporterDir=$1\n resourceExporterDir=$2\n grafanaVersionArgs=$3\n monitoringExporterEndToEndDir=${monitoringExporterDir}/src/samples/kubernetes/end2end\n-\n+CHARTNS=monitortestns\n+CHARTNAME=grafana\n HELM_VERSION=$(helm version --short --client)\n \n+function checkPod() {\n+  max=20\n+  count=0\n+  echo \"Checking pods $CHARTNAME\"\n+  grafanapod=$(kubectl get po -n $CHARTNS | grep $CHARTNAME | awk '{print $1 }')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI5Mzc2OQ=="}, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNjc1NTc0OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxOTo0NjoyM1rOGQ48wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxODozODowNlrOGRgVwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM2MzQ1OA==", "bodyText": "if the exit value was not zero, you will never get to this line.\nif you need the result, you have to use ExecCommand.exec() instead", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420363458", "createdAt": "2020-05-05T19:46:23Z", "author": {"login": "markxnelson"}, "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "diffHunk": "@@ -260,12 +254,19 @@ private static void executeShelScript(String srcLoc, String destLoc, String file\n             + args\n             + \" | tee \"\n             + outLogFile;\n-    TestUtils.execOrAbortProcess(crdCmd, true);\n-    crdCmd = \" cat \" + destLoc + \"/\" + outLogFile;\n-    ExecResult result = ExecCommand.exec(crdCmd);\n-    assertFalse(\n-        result.stdout().contains(\"BUILD FAILURE\"), \"Shell script failed: \" + result.stdout());\n+    ExecResult result = TestUtils.execOrAbortProcess(crdCmd, true);\n+    if (result.exitValue() != 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 233}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTAwODgzMw==", "bodyText": "replaced with execCommand.exec()", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r421008833", "createdAt": "2020-05-06T18:38:06Z", "author": {"login": "marinakog"}, "path": "integration-tests/src/test/java/oracle/kubernetes/operator/ItMonitoringExporter.java", "diffHunk": "@@ -260,12 +254,19 @@ private static void executeShelScript(String srcLoc, String destLoc, String file\n             + args\n             + \" | tee \"\n             + outLogFile;\n-    TestUtils.execOrAbortProcess(crdCmd, true);\n-    crdCmd = \" cat \" + destLoc + \"/\" + outLogFile;\n-    ExecResult result = ExecCommand.exec(crdCmd);\n-    assertFalse(\n-        result.stdout().contains(\"BUILD FAILURE\"), \"Shell script failed: \" + result.stdout());\n+    ExecResult result = TestUtils.execOrAbortProcess(crdCmd, true);\n+    if (result.exitValue() != 0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM2MzQ1OA=="}, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 233}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxNjc2Mjg4OnYy", "diffSide": "RIGHT", "path": "integration-tests/src/test/resources/deploywebapp.py", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxOTo0ODozOVrOGQ5BQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxODozOTowMFrOGRgXww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM2NDYwOA==", "bodyText": "@ddsharpe @rjeberhard do we need some kind of write() or something at the end of this script?  or at least a disconnect() or whatever??", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r420364608", "createdAt": "2020-05-05T19:48:39Z", "author": {"login": "markxnelson"}, "path": "integration-tests/src/test/resources/deploywebapp.py", "diffHunk": "@@ -1,22 +1,12 @@\n # Copyright (c) 2018, 2020, Oracle Corporation and/or its affiliates.\n # Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n-\n-import time as systime\n-\n connect(sys.argv[1],sys.argv[2],sys.argv[3])\n-deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n-#systime.sleep(15)\n-\n-#cd ('AppDeployments')\n-#myapps=cmo.getAppDeployments()\n- \n-#for appName in myapps:\n-#       domainConfig()\n-#       cd ('/AppDeployments/'+appName.getName()+'/Targets')\n-#       mytargets = ls(returnMap='true')\n-#       domainRuntime()\n-#       cd('AppRuntimeStateRuntime')\n-#       cd('AppRuntimeStateRuntime')\n-#       for targetinst in mytargets:\n-#             curstate4=cmo.getCurrentState(appName.getName(),targetinst)\n-#             print '-----------', curstate4, '-----------', appName.getName()\n\\ No newline at end of file\n+appName=sys.argv[4]\n+appPath=sys.argv[5]\n+clusterName=sys.argv[6]\n+print 'Deploying application[%s] to the Cluster[%s] located @ [%s] ' %(appName,clusterName,appPath)\n+print 'Checking the server status on the Cluster[%s] ' %(clusterName)\n+domainRuntime()\n+state(clusterName,'Cluster')\n+#deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n+deploy(appName=appName, path=appPath, targets=clusterName)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTAwOTM0Nw==", "bodyText": "reverted this file to original, it was added only for debugging", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1623#discussion_r421009347", "createdAt": "2020-05-06T18:39:00Z", "author": {"login": "marinakog"}, "path": "integration-tests/src/test/resources/deploywebapp.py", "diffHunk": "@@ -1,22 +1,12 @@\n # Copyright (c) 2018, 2020, Oracle Corporation and/or its affiliates.\n # Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.\n-\n-import time as systime\n-\n connect(sys.argv[1],sys.argv[2],sys.argv[3])\n-deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n-#systime.sleep(15)\n-\n-#cd ('AppDeployments')\n-#myapps=cmo.getAppDeployments()\n- \n-#for appName in myapps:\n-#       domainConfig()\n-#       cd ('/AppDeployments/'+appName.getName()+'/Targets')\n-#       mytargets = ls(returnMap='true')\n-#       domainRuntime()\n-#       cd('AppRuntimeStateRuntime')\n-#       cd('AppRuntimeStateRuntime')\n-#       for targetinst in mytargets:\n-#             curstate4=cmo.getCurrentState(appName.getName(),targetinst)\n-#             print '-----------', curstate4, '-----------', appName.getName()\n\\ No newline at end of file\n+appName=sys.argv[4]\n+appPath=sys.argv[5]\n+clusterName=sys.argv[6]\n+print 'Deploying application[%s] to the Cluster[%s] located @ [%s] ' %(appName,clusterName,appPath)\n+print 'Checking the server status on the Cluster[%s] ' %(clusterName)\n+domainRuntime()\n+state(clusterName,'Cluster')\n+#deploy(sys.argv[4],sys.argv[5],sys.argv[6],upload='false',remote='false')\n+deploy(appName=appName, path=appPath, targets=clusterName)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDM2NDYwOA=="}, "originalCommit": {"oid": "c7b589b1db902abe331f09326490a532e87fe3bb"}, "originalPosition": 32}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4514, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}