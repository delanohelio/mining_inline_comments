{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5NjY0NzQ5", "number": 2097, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNzoxMjoyNlrOFFF6yQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMjowMDoxMFrOFG7FjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQwODg0MTY5OnYy", "diffSide": "RIGHT", "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "isResolved": true, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNFQxNzoxMjoyNlrOIFbBkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNToyNjowM1rOIInj8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU1NjU2MQ==", "bodyText": "Maybe this is a naive comment but it looks like this change is special case handling a particular validation warning. Would it be possible and sensible to treat all validation warnings using the same event instead of having a special event for this particular validation?  E.g. have a generic 'validation' event and generic validation warning handling that handles all validation failures...", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r542556561", "createdAt": "2020-12-14T17:12:26Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "diffHunk": "@@ -286,13 +300,26 @@ private void logIfReplicasLessThanClusterServersMin(WlsClusterConfig clusterConf\n                 domain.getReplicaCount(clusterName),\n                 clusterConfig.getMinDynamicClusterSize(),\n                 clusterName);\n+        String message = LOGGER.formatMessage(MessageKeys.REPLICAS_LESS_THAN_TOTAL_CLUSTER_SERVER_COUNT,\n+            domain.getReplicaCount(clusterName),\n+            clusterConfig.getMinDynamicClusterSize(),\n+            clusterName);\n+        addInvalidReplicasValueEventAndWarning(message);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU2NDMxNA==", "bodyText": "Good suggestion. Can we get more feedback from other reviewers?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r542564314", "createdAt": "2020-12-14T17:22:52Z", "author": {"login": "alai8"}, "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "diffHunk": "@@ -286,13 +300,26 @@ private void logIfReplicasLessThanClusterServersMin(WlsClusterConfig clusterConf\n                 domain.getReplicaCount(clusterName),\n                 clusterConfig.getMinDynamicClusterSize(),\n                 clusterName);\n+        String message = LOGGER.formatMessage(MessageKeys.REPLICAS_LESS_THAN_TOTAL_CLUSTER_SERVER_COUNT,\n+            domain.getReplicaCount(clusterName),\n+            clusterConfig.getMinDynamicClusterSize(),\n+            clusterName);\n+        addInvalidReplicasValueEventAndWarning(message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU1NjU2MQ=="}, "originalCommit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU3MDExOQ==", "bodyText": "@rjeberhard @doxiao ^^^", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r542570119", "createdAt": "2020-12-14T17:30:28Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "diffHunk": "@@ -286,13 +300,26 @@ private void logIfReplicasLessThanClusterServersMin(WlsClusterConfig clusterConf\n                 domain.getReplicaCount(clusterName),\n                 clusterConfig.getMinDynamicClusterSize(),\n                 clusterName);\n+        String message = LOGGER.formatMessage(MessageKeys.REPLICAS_LESS_THAN_TOTAL_CLUSTER_SERVER_COUNT,\n+            domain.getReplicaCount(clusterName),\n+            clusterConfig.getMinDynamicClusterSize(),\n+            clusterName);\n+        addInvalidReplicasValueEventAndWarning(message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU1NjU2MQ=="}, "originalCommit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDQ0MTQ0NA==", "bodyText": "To follow the existing pattern, I think it is better to have a generic event reason, say DomainValidationError, for all the events related to validation issues, and put the details in the event message (as this PR has already done).", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r544441444", "createdAt": "2020-12-16T16:29:30Z", "author": {"login": "doxiao"}, "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "diffHunk": "@@ -286,13 +300,26 @@ private void logIfReplicasLessThanClusterServersMin(WlsClusterConfig clusterConf\n                 domain.getReplicaCount(clusterName),\n                 clusterConfig.getMinDynamicClusterSize(),\n                 clusterName);\n+        String message = LOGGER.formatMessage(MessageKeys.REPLICAS_LESS_THAN_TOTAL_CLUSTER_SERVER_COUNT,\n+            domain.getReplicaCount(clusterName),\n+            clusterConfig.getMinDynamicClusterSize(),\n+            clusterName);\n+        addInvalidReplicasValueEventAndWarning(message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU1NjU2MQ=="}, "originalCommit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDUyMDYxNw==", "bodyText": "Thanks for the feedback. I have replaced InvalidReplicasValueError with DomainValidationError. and events would look like:\n5s          Warning   DomainValidationError       domain/domain1   Validation error in domain resource domain1: Replica request of 2,020 exceeds the maximum dynamic server count of 2 configured for cluster cluster-1\n\n9s          Warning   DomainValidationError       domain/domain1   Validation error in domain resource domain1: Replica request of 0 less than the minimum dynamic server count of 1 configured for cluster cluster-1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r544520617", "createdAt": "2020-12-16T18:19:25Z", "author": {"login": "alai8"}, "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "diffHunk": "@@ -286,13 +300,26 @@ private void logIfReplicasLessThanClusterServersMin(WlsClusterConfig clusterConf\n                 domain.getReplicaCount(clusterName),\n                 clusterConfig.getMinDynamicClusterSize(),\n                 clusterName);\n+        String message = LOGGER.formatMessage(MessageKeys.REPLICAS_LESS_THAN_TOTAL_CLUSTER_SERVER_COUNT,\n+            domain.getReplicaCount(clusterName),\n+            clusterConfig.getMinDynamicClusterSize(),\n+            clusterName);\n+        addInvalidReplicasValueEventAndWarning(message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU1NjU2MQ=="}, "originalCommit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDUzNTI1Nw==", "bodyText": "Does this pull cover all validation errors now? Have you tested this out?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r544535257", "createdAt": "2020-12-16T18:41:44Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "diffHunk": "@@ -286,13 +300,26 @@ private void logIfReplicasLessThanClusterServersMin(WlsClusterConfig clusterConf\n                 domain.getReplicaCount(clusterName),\n                 clusterConfig.getMinDynamicClusterSize(),\n                 clusterName);\n+        String message = LOGGER.formatMessage(MessageKeys.REPLICAS_LESS_THAN_TOTAL_CLUSTER_SERVER_COUNT,\n+            domain.getReplicaCount(clusterName),\n+            clusterConfig.getMinDynamicClusterSize(),\n+            clusterName);\n+        addInvalidReplicasValueEventAndWarning(message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU1NjU2MQ=="}, "originalCommit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTQ5MDA4MQ==", "bodyText": "I updated ValidateDomainTopologyStep and create event for validation warnings from that class in the latest change, such as:\n 9s          Warning   DomainValidationError       domain/domain1   Validation error in domain resource domain1: Managed Server 'managed-server1234' specified in the domain resource does not exist in the WebLogic domain home configuration.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r545490081", "createdAt": "2020-12-18T00:16:09Z", "author": {"login": "alai8"}, "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "diffHunk": "@@ -286,13 +300,26 @@ private void logIfReplicasLessThanClusterServersMin(WlsClusterConfig clusterConf\n                 domain.getReplicaCount(clusterName),\n                 clusterConfig.getMinDynamicClusterSize(),\n                 clusterName);\n+        String message = LOGGER.formatMessage(MessageKeys.REPLICAS_LESS_THAN_TOTAL_CLUSTER_SERVER_COUNT,\n+            domain.getReplicaCount(clusterName),\n+            clusterConfig.getMinDynamicClusterSize(),\n+            clusterName);\n+        addInvalidReplicasValueEventAndWarning(message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU1NjU2MQ=="}, "originalCommit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTkwNzY5OQ==", "bodyText": "Great!", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r545907699", "createdAt": "2020-12-18T15:26:03Z", "author": {"login": "tbarnes-us"}, "path": "operator/src/main/java/oracle/kubernetes/operator/steps/ManagedServersUpStep.java", "diffHunk": "@@ -286,13 +300,26 @@ private void logIfReplicasLessThanClusterServersMin(WlsClusterConfig clusterConf\n                 domain.getReplicaCount(clusterName),\n                 clusterConfig.getMinDynamicClusterSize(),\n                 clusterName);\n+        String message = LOGGER.formatMessage(MessageKeys.REPLICAS_LESS_THAN_TOTAL_CLUSTER_SERVER_COUNT,\n+            domain.getReplicaCount(clusterName),\n+            clusterConfig.getMinDynamicClusterSize(),\n+            clusterName);\n+        addInvalidReplicasValueEventAndWarning(message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjU1NjU2MQ=="}, "originalCommit": {"oid": "7b84da5b8c9f1bad1e29342d0330a2c2c11362b6"}, "originalPosition": 92}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyODAzODUyOnYy", "diffSide": "RIGHT", "path": "docs-source/content/userguide/managing-domains/domain-events.md", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QyMjowMDoxMFrOIIKdjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwMDoxNjozMFrOIIOFFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTQzMDkyNg==", "bodyText": "change InvalidReplicasValue to DomainValidationError?", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r545430926", "createdAt": "2020-12-17T22:00:10Z", "author": {"login": "doxiao"}, "path": "docs-source/content/userguide/managing-domains/domain-events.md", "diffHunk": "@@ -242,6 +243,39 @@ Source:\n Type:    Warning\n Events:  <none>\n \n+```\n+Example of a `InvalidReplicasValue` event:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "690c36f7d0e1f29301bde29dce7ffa578db9d13d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTQ5MDE5Ng==", "bodyText": "thanks. updated with example of DomainValidationError.", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/2097#discussion_r545490196", "createdAt": "2020-12-18T00:16:30Z", "author": {"login": "alai8"}, "path": "docs-source/content/userguide/managing-domains/domain-events.md", "diffHunk": "@@ -242,6 +243,39 @@ Source:\n Type:    Warning\n Events:  <none>\n \n+```\n+Example of a `InvalidReplicasValue` event:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTQzMDkyNg=="}, "originalCommit": {"oid": "690c36f7d0e1f29301bde29dce7ffa578db9d13d"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3818, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}