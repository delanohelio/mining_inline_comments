{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3MjQ2MTc0", "number": 3005, "title": "feat: Use util function for hostname building", "bodyText": "Signed-off-by: Samuel Hawker samuel.hawker@ibm.com\nType of change\nSelect the type of your PR\n\nBugfix\nEnhancement / new feature\nRefactoring\nDocumentation\n\nDescription\nPlease describe your pull request\nChecklist\nPlease go through this checklist and make sure all applicable tasks have been done\n\n Update/write design documentation in ./design\n Write tests\n Make sure all tests pass\n Update documentation\n Check RBAC rights for Kubernetes / OpenShift roles\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging\n Update CHANGELOG.md", "createdAt": "2020-05-13T09:45:16Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005", "merged": true, "mergeCommit": {"oid": "5f0bc11037c56a84fe421ccb60156443663c9213"}, "closed": true, "closedAt": "2020-05-14T20:18:05Z", "author": {"login": "samuel-hawker"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcg1o4kgH2gAyNDE3MjQ2MTc0OmFjNzhhNzc3NjQwNjkzYzVkMDczMzQ0ZDY4ODllYWI2NzJmZDA3Nzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcg4rgoAFqTQxMDkwOTgzNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ac78a777640693c5d073344d6889eab672fd0777", "author": {"user": {"login": "samuel-hawker", "name": "Samuel Hawker"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ac78a777640693c5d073344d6889eab672fd0777", "committedDate": "2020-05-13T09:41:17Z", "message": "feat: Use util function for hostname building\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwODAzMjU2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005#pullrequestreview-410803256", "createdAt": "2020-05-13T10:44:14Z", "commit": {"oid": "ac78a777640693c5d073344d6889eab672fd0777"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxMDo0NDoxNFrOGUr29w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxMDo0NjozOFrOGUr7cg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM0MzI4Nw==", "bodyText": "Should this be podDnsNameWithoutClusterDomain?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005#discussion_r424343287", "createdAt": "2020-05-13T10:44:14Z", "author": {"login": "scholzj"}, "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/KafkaBrokerConfigurationBuilder.java", "diffHunk": "@@ -136,7 +136,12 @@ public KafkaBrokerConfigurationBuilder withListeners(String clusterName, String\n \n         // Replication listener\n         listeners.add(\"REPLICATION-9091://0.0.0.0:9091\");\n-        advertisedListeners.add(String.format(\"REPLICATION-9091://%s-${STRIMZI_BROKER_ID}.%s-brokers.%s.svc:9091\", KafkaResources.kafkaStatefulSetName(clusterName), KafkaResources.kafkaStatefulSetName(clusterName), namespace));\n+        advertisedListeners.add(String.format(\"REPLICATION-9091://%s:9091\",\n+                ModelUtils.podDnsName(namespace,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac78a777640693c5d073344d6889eab672fd0777"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM0MzQ2NA==", "bodyText": "Same as above - should this be podDnsNameWithoutClusterDomain?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005#discussion_r424343464", "createdAt": "2020-05-13T10:44:39Z", "author": {"login": "scholzj"}, "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/KafkaBrokerConfigurationBuilder.java", "diffHunk": "@@ -273,7 +278,13 @@ private void configureReplicationListener() {\n      * @return  String with advertised listener configuration\n      */\n     private String getAdvertisedListener(String clusterName, String namespace, String listenerName, int port)    {\n-        return String.format(\"%s://%s-${STRIMZI_BROKER_ID}.%s-brokers.%s.svc:%d\", listenerName, KafkaResources.kafkaStatefulSetName(clusterName), KafkaResources.kafkaStatefulSetName(clusterName), namespace, port);\n+        return String.format(\"%s://%s:%d\",\n+                listenerName,\n+                ModelUtils.podDnsName(namespace,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac78a777640693c5d073344d6889eab672fd0777"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDM0NDQzNA==", "bodyText": "Same as above - should this be podDnsNameWithoutClusterDomain?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005#discussion_r424344434", "createdAt": "2020-05-13T10:46:38Z", "author": {"login": "scholzj"}, "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/operator/assembly/KafkaAssemblyOperator.java", "diffHunk": "@@ -1478,10 +1478,10 @@ String zkConnectionString(int connectToReplicas, Function<Integer, String> zkNod\n                             return Future.failedFuture(Util.missingSecretException(namespace, ClusterOperator.secretName(name)));\n                         }\n \n-                        Function<Integer, String> zkNodeAddress = (Integer i) -> String.format(\"%s.%s.%s.svc\",\n-                                zkCluster.getPodName(i),\n+                        Function<Integer, String> zkNodeAddress = (Integer i) -> ModelUtils.podDnsName(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac78a777640693c5d073344d6889eab672fd0777"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e895ddedf5d10c27ae6d2c6471474ddb2a772185", "author": {"user": {"login": "samuel-hawker", "name": "Samuel Hawker"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e895ddedf5d10c27ae6d2c6471474ddb2a772185", "committedDate": "2020-05-13T10:51:09Z", "message": "fix: Use without cluster domain\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "119f5e7887a7d7af543324acbf60a3173c6962ac", "author": {"user": {"login": "samuel-hawker", "name": "Samuel Hawker"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/119f5e7887a7d7af543324acbf60a3173c6962ac", "committedDate": "2020-05-13T11:13:13Z", "message": "feat: Replace calls in cert\n\nSigned-off-by: Samuel Hawker <samuel.hawker@ibm.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwOTA5ODM0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3005#pullrequestreview-410909834", "createdAt": "2020-05-13T13:13:52Z", "commit": {"oid": "119f5e7887a7d7af543324acbf60a3173c6962ac"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1699, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}