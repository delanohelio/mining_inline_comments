{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM3NjI1ODk5", "number": 4096, "title": "Kafka connect: add jmxOptions", "bodyText": "Type of change\n\nEnhancement / new feature\n\nDescription\nadd jmxOptions to KafkaConnect\nChecklist\n\n Write tests\n Make sure all tests pass\n Update documentation\n Check RBAC rights for Kubernetes / OpenShift roles\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging\n Update CHANGELOG.md\n Supply screenshots for visual changes, such as Grafana dashboards", "createdAt": "2020-12-12T01:18:16Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096", "merged": true, "mergeCommit": {"oid": "d484d4486ef8091f2c0b39f2a3d3ef036fd997b9"}, "closed": true, "closedAt": "2021-01-14T23:58:03Z", "author": {"login": "mgarmes"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdlk1i1AFqTU1MDg2NjYwMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdwDMmugH2gAyNTM3NjI1ODk5OjJhZTUyOGVkNzY5ZTA3MTVlMTQ0ZGEyZTYwNDY3YzUyYjg4OGMxZmI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUwODY2NjAy", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#pullrequestreview-550866602", "createdAt": "2020-12-12T22:19:42Z", "commit": {"oid": "022f482a2c1fbe0cc53f1737fb90198255d01ca8"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMlQyMjoxOTo0M1rOIEsV0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMlQyMjozODozOFrOIEsgwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTc5MTY5Nw==", "bodyText": "Why do we need this import when we did not changed anything?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#discussion_r541791697", "createdAt": "2020-12-12T22:19:43Z", "author": {"login": "scholzj"}, "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/operator/assembly/KafkaMirrorMakerAssemblyOperator.java", "diffHunk": "@@ -5,6 +5,7 @@\n package io.strimzi.operator.cluster.operator.assembly;\n \n import io.fabric8.kubernetes.api.model.ConfigMap;\n+import io.fabric8.kubernetes.api.model.Secret;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "022f482a2c1fbe0cc53f1737fb90198255d01ca8"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTc5MTcxNg==", "bodyText": "Same as above.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#discussion_r541791716", "createdAt": "2020-12-12T22:19:50Z", "author": {"login": "scholzj"}, "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/operator/assembly/KafkaMirrorMakerAssemblyOperator.java", "diffHunk": "@@ -20,6 +21,7 @@\n import io.strimzi.operator.cluster.ClusterOperatorConfig;\n import io.strimzi.operator.PlatformFeaturesAvailability;\n import io.strimzi.operator.cluster.model.InvalidResourceException;\n+import io.strimzi.operator.cluster.model.KafkaConnectCluster;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "022f482a2c1fbe0cc53f1737fb90198255d01ca8"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTc5NDQ5Ng==", "bodyText": "Could you please not group the imports? (Not just here but in all the files)", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#discussion_r541794496", "createdAt": "2020-12-12T22:38:38Z", "author": {"login": "scholzj"}, "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/model/KafkaConnectCluster.java", "diffHunk": "@@ -4,31 +4,7 @@\n  */\n package io.strimzi.operator.cluster.model;\n \n-import io.fabric8.kubernetes.api.model.Affinity;\n-import io.fabric8.kubernetes.api.model.AffinityBuilder;\n-import io.fabric8.kubernetes.api.model.ConfigMapVolumeSource;\n-import io.fabric8.kubernetes.api.model.Container;\n-import io.fabric8.kubernetes.api.model.ContainerBuilder;\n-import io.fabric8.kubernetes.api.model.ContainerPort;\n-import io.fabric8.kubernetes.api.model.EnvVar;\n-import io.fabric8.kubernetes.api.model.EnvVarBuilder;\n-import io.fabric8.kubernetes.api.model.EnvVarSource;\n-import io.fabric8.kubernetes.api.model.EnvVarSourceBuilder;\n-import io.fabric8.kubernetes.api.model.HasMetadata;\n-import io.fabric8.kubernetes.api.model.IntOrString;\n-import io.fabric8.kubernetes.api.model.LocalObjectReference;\n-import io.fabric8.kubernetes.api.model.Quantity;\n-import io.fabric8.kubernetes.api.model.ResourceRequirements;\n-import io.fabric8.kubernetes.api.model.ResourceRequirementsBuilder;\n-import io.fabric8.kubernetes.api.model.SecretVolumeSource;\n-import io.fabric8.kubernetes.api.model.SecurityContext;\n-import io.fabric8.kubernetes.api.model.Service;\n-import io.fabric8.kubernetes.api.model.ServicePort;\n-import io.fabric8.kubernetes.api.model.Toleration;\n-import io.fabric8.kubernetes.api.model.Volume;\n-import io.fabric8.kubernetes.api.model.VolumeBuilder;\n-import io.fabric8.kubernetes.api.model.VolumeMount;\n-import io.fabric8.kubernetes.api.model.VolumeMountBuilder;\n+import io.fabric8.kubernetes.api.model.*;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "022f482a2c1fbe0cc53f1737fb90198255d01ca8"}, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b923b97c69c485515f628a32e124e18216cb71e0", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b923b97c69c485515f628a32e124e18216cb71e0", "committedDate": "2020-12-16T15:23:28Z", "message": "fix test"}, "afterCommit": {"oid": "6901a340c1f5f95072c44a67681ab11e5f2d462e", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/6901a340c1f5f95072c44a67681ab11e5f2d462e", "committedDate": "2020-12-16T19:12:03Z", "message": "fix test\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0MDQ1MTEz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#pullrequestreview-554045113", "createdAt": "2020-12-16T20:09:46Z", "commit": {"oid": "6901a340c1f5f95072c44a67681ab11e5f2d462e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQyMDowOTo0NlrOIHXJZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQyMDowOTo0NlrOIHXJZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDU5MDE4Mw==", "bodyText": "Could you add this test also for the KafkaConnectAssemblyOperatorTest and for KAfkaMirrorMaker2AssemblyOperatorTest? That would help to have it tested for all of them.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#discussion_r544590183", "createdAt": "2020-12-16T20:09:46Z", "author": {"login": "scholzj"}, "path": "cluster-operator/src/test/java/io/strimzi/operator/cluster/operator/assembly/KafkaConnectS2IAssemblyOperatorTest.java", "diffHunk": "@@ -1073,4 +1099,15 @@ public void testCreateClusterWithSameNameAsConnectFails(VertxTestContext context\n             })));\n     }\n \n+    @Test\n+    public void testCreateClusterWithJmxEnabled(VertxTestContext context) {\n+        String kcs2iName = \"foo\";\n+        String kcs2iNamespace = \"test\";\n+        KafkaConnectS2I kcs2i = ResourceUtils.createEmptyKafkaConnectS2I(kcs2iNamespace, kcs2iName);\n+        kcs2i.getSpec().setJmxOptions(new KafkaJmxOptionsBuilder()\n+                .withAuthentication(new KafkaJmxAuthenticationPasswordBuilder().build())\n+                .build());\n+\n+        createCluster(context, kcs2i, false);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6901a340c1f5f95072c44a67681ab11e5f2d462e"}, "originalPosition": 166}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU0OTI0MDU5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#pullrequestreview-554924059", "createdAt": "2020-12-17T19:33:43Z", "commit": {"oid": "c6accd46e26f600053a5c03251b8fcede140ed3d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2MjQ1NzM2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#pullrequestreview-556245736", "createdAt": "2020-12-21T09:35:44Z", "commit": {"oid": "c6accd46e26f600053a5c03251b8fcede140ed3d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQwOTozNTo0NVrOIJR66g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMVQwOTozNTo0NVrOIJR66g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjYwMTcwNg==", "bodyText": "This is almost exactly the same code as we have in kafka_run.sh (the only difference I can see is in the KAFKA_CONNECT_JMX_ENABLED vs KAFKA_JMX_ENABLED). I think it would be good to factor out some common script that we could source from both, rather than duplicating.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#discussion_r546601706", "createdAt": "2020-12-21T09:35:45Z", "author": {"login": "tombentley"}, "path": "docker-images/kafka/scripts/kafka_connect_run.sh", "diffHunk": "@@ -45,6 +45,29 @@ if [ \"$KAFKA_CONNECT_METRICS_ENABLED\" = \"true\" ]; then\n     export KAFKA_OPTS\n fi\n \n+if [ \"$KAFKA_CONNECT_JMX_ENABLED\" = \"true\" ]; then\n+  KAFKA_JMX_OPTS=\"-Dcom.sun.management.jmxremote.port=9999 -Dcom.sun.management.jmxremote.rmi.port=9999 -Dcom.sun.management.jmxremote=true -Djava.rmi.server.hostname=$(hostname -i) -Djava.net.preferIPv4Stack=true\"\n+\n+  if [ -n \"$KAFKA_CONNECT_JMX_USERNAME\" ]; then\n+    # Secure JMX port on 9999 with username and password\n+    JMX_ACCESS_FILE=\"/tmp/access.file\"\n+    JMX_PASSWORD_FILE=\"/tmp/password.file\"\n+\n+    cat << EOF > \"${JMX_ACCESS_FILE}\"\n+${KAFKA_CONNECT_JMX_USERNAME} readonly\n+EOF\n+\n+    cat << EOF > \"${JMX_PASSWORD_FILE}\"\n+$KAFKA_CONNECT_JMX_USERNAME $KAFKA_CONNECT_JMX_PASSWORD\n+EOF\n+    chmod 400 \"${JMX_PASSWORD_FILE}\"\n+    KAFKA_JMX_OPTS=\"${KAFKA_JMX_OPTS} -Dcom.sun.management.jmxremote.access.file=${JMX_ACCESS_FILE} -Dcom.sun.management.jmxremote.password.file=${JMX_PASSWORD_FILE}  -Dcom.sun.management.jmxremote.authenticate=true\"\n+  else\n+    # expose the port insecurely\n+    KAFKA_JMX_OPTS=\"${KAFKA_JMX_OPTS} -Dcom.sun.management.jmxremote.authenticate=false\"\n+  fi\n+fi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6accd46e26f600053a5c03251b8fcede140ed3d"}, "originalPosition": 25}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "80908a6b66137b89198abdbf1ac5692242a329b3", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/80908a6b66137b89198abdbf1ac5692242a329b3", "committedDate": "2021-01-13T14:19:05Z", "message": "refactor jmx for kafka_*_run"}, "afterCommit": {"oid": "448aead679cd6f9b60d2c6dd8d68585ab80648c9", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/448aead679cd6f9b60d2c6dd8d68585ab80648c9", "committedDate": "2021-01-13T16:02:59Z", "message": "refactor jmx for kafka_*_run"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "af605747cba55d0b7c5e9d2873603ffa1e22e927", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/af605747cba55d0b7c5e9d2873603ffa1e22e927", "committedDate": "2021-01-13T17:31:28Z", "message": "merge"}, "afterCommit": {"oid": "00efb68d67932bf0e72553fd2e28b25784aeb201", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/00efb68d67932bf0e72553fd2e28b25784aeb201", "committedDate": "2021-01-13T17:32:22Z", "message": "merge\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0d648c4d6f043e0b5409b20d887e56475968ba0", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a0d648c4d6f043e0b5409b20d887e56475968ba0", "committedDate": "2021-01-13T17:36:58Z", "message": "Kafka connect: add jmxOptions\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79ce975024a8d5b01245d41f5e98ccebf61bf9b1", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/79ce975024a8d5b01245d41f5e98ccebf61bf9b1", "committedDate": "2021-01-13T17:36:58Z", "message": "fix imports + add kafka-connect jmx port as  ContainerPort\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afffe7d670f41e5b7d687f2afd1c6409669cb762", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/afffe7d670f41e5b7d687f2afd1c6409669cb762", "committedDate": "2021-01-13T17:36:58Z", "message": "fix imports + add kafka-connect jmx port as  ContainerPort\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a0bc93c6f6e7b4265a0f6897dd0f01b7bf75d21", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/9a0bc93c6f6e7b4265a0f6897dd0f01b7bf75d21", "committedDate": "2021-01-13T17:43:08Z", "message": "update tests & doc & crd\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "60400c5db6338edf8a2b052a556231463bf91dfb", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/60400c5db6338edf8a2b052a556231463bf91dfb", "committedDate": "2021-01-13T17:43:08Z", "message": "fix style\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c788888866a334587df52322bd805669b26b7e57", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/c788888866a334587df52322bd805669b26b7e57", "committedDate": "2021-01-13T17:43:08Z", "message": "fix test\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06d44def5596cd3fd483774d69bb4eab9464f5d9", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/06d44def5596cd3fd483774d69bb4eab9464f5d9", "committedDate": "2021-01-13T17:43:08Z", "message": "add tests\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cb4c9f502ed81139c6fc7f39ef89727a9431653", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/5cb4c9f502ed81139c6fc7f39ef89727a9431653", "committedDate": "2021-01-13T17:43:08Z", "message": "add change log\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af06cfd4dc948f0ad45241fdb8235c1d1284b456", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/af06cfd4dc948f0ad45241fdb8235c1d1284b456", "committedDate": "2021-01-13T17:43:08Z", "message": "refactor jmx for kafka_*_run\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8bba662aedb2c01d604d396c80d076a861a0edc6", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8bba662aedb2c01d604d396c80d076a861a0edc6", "committedDate": "2021-01-13T17:43:08Z", "message": "merge\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "00efb68d67932bf0e72553fd2e28b25784aeb201", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/00efb68d67932bf0e72553fd2e28b25784aeb201", "committedDate": "2021-01-13T17:32:22Z", "message": "merge\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}, "afterCommit": {"oid": "8bba662aedb2c01d604d396c80d076a861a0edc6", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8bba662aedb2c01d604d396c80d076a861a0edc6", "committedDate": "2021-01-13T17:43:08Z", "message": "merge\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89227d790e75491a77f760d5128669c33284f1f1", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/89227d790e75491a77f760d5128669c33284f1f1", "committedDate": "2021-01-13T17:47:40Z", "message": "update changelog\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "03b25c2d2bbe82588cfc3174147886df852b4eaf", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/03b25c2d2bbe82588cfc3174147886df852b4eaf", "committedDate": "2021-01-13T17:45:51Z", "message": "update changelog"}, "afterCommit": {"oid": "89227d790e75491a77f760d5128669c33284f1f1", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/89227d790e75491a77f760d5128669c33284f1f1", "committedDate": "2021-01-13T17:47:40Z", "message": "update changelog\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY3NzI3NzQ0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#pullrequestreview-567727744", "createdAt": "2021-01-13T22:59:44Z", "commit": {"oid": "89227d790e75491a77f760d5128669c33284f1f1"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xM1QyMjo1OTo0NFrOITIjWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xM1QyMjo1OTo0NlrOITIjgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjkzMzk3OQ==", "bodyText": "Do we really want to echo this? won't it print the password into STDOUT?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#discussion_r556933979", "createdAt": "2021-01-13T22:59:44Z", "author": {"login": "scholzj"}, "path": "docker-images/kafka/scripts/set_kafka_jmx_options.sh", "diffHunk": "@@ -0,0 +1,31 @@\n+#!/usr/bin/env bash\n+set -e\n+\n+JMX_ENABLED=\"$1\"\n+JMX_USERNAME=\"$2\"\n+JMX_PASSWORD=\"$3\"\n+\n+echo \"${JMX_ENABLED}, ${JMX_USERNAME}, ${JMX_PASSWORD}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89227d790e75491a77f760d5128669c33284f1f1"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjkzNDAxOA==", "bodyText": "This seems to break the shellcheck validation ... I think you need to put these into double quotes.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4096#discussion_r556934018", "createdAt": "2021-01-13T22:59:46Z", "author": {"login": "scholzj"}, "path": "docker-images/kafka/scripts/kafka_run.sh", "diffHunk": "@@ -17,28 +17,7 @@ rm -f /var/opt/kafka/kafka-ready /var/opt/kafka/zk-connected 2> /dev/null\n KAFKA_OPTS=\"$KAFKA_OPTS -javaagent:$(ls \"$KAFKA_HOME\"/libs/kafka-agent*.jar)=/var/opt/kafka/kafka-ready:/var/opt/kafka/zk-connected\"\n export KAFKA_OPTS\n \n-if [ \"$KAFKA_JMX_ENABLED\" = \"true\" ]; then\n-  KAFKA_JMX_OPTS=\"-Dcom.sun.management.jmxremote.port=9999 -Dcom.sun.management.jmxremote.rmi.port=9999 -Dcom.sun.management.jmxremote=true -Djava.rmi.server.hostname=$(hostname -i) -Djava.net.preferIPv4Stack=true\"\n-\n-  if [ -n \"$KAFKA_JMX_USERNAME\" ]; then\n-    # Secure JMX port on 9999 with username and password\n-    JMX_ACCESS_FILE=\"/tmp/access.file\"\n-    JMX_PASSWORD_FILE=\"/tmp/password.file\"\n-\n-    cat << EOF > \"${JMX_ACCESS_FILE}\"\n-${KAFKA_JMX_USERNAME} readonly\n-EOF\n-\n-    cat << EOF > \"${JMX_PASSWORD_FILE}\"\n-$KAFKA_JMX_USERNAME $KAFKA_JMX_PASSWORD\n-EOF\n-    chmod 400 \"${JMX_PASSWORD_FILE}\"\n-    KAFKA_JMX_OPTS=\"${KAFKA_JMX_OPTS} -Dcom.sun.management.jmxremote.access.file=${JMX_ACCESS_FILE} -Dcom.sun.management.jmxremote.password.file=${JMX_PASSWORD_FILE}  -Dcom.sun.management.jmxremote.authenticate=true\"\n-  else\n-    # expose the port insecurely\n-    KAFKA_JMX_OPTS=\"${KAFKA_JMX_OPTS} -Dcom.sun.management.jmxremote.authenticate=false\"\n-  fi\n-fi\n+. ./set_kafka_jmx_options.sh ${KAFKA_JMX_ENABLED} ${KAFKA_JMX_USERNAME} ${KAFKA_JMX_PASSWORD}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89227d790e75491a77f760d5128669c33284f1f1"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b04dc88e2e50e51244047056135a72835658397", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/6b04dc88e2e50e51244047056135a72835658397", "committedDate": "2021-01-14T08:52:10Z", "message": "fix style\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91b37e96443f1f1ba6f16fbe94371e5481b6dade", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/91b37e96443f1f1ba6f16fbe94371e5481b6dade", "committedDate": "2021-01-14T09:58:55Z", "message": "fix tests\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ae528ed769e0715e144da2e60467c52b888c1fb", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2ae528ed769e0715e144da2e60467c52b888c1fb", "committedDate": "2021-01-14T12:09:05Z", "message": "fix tests\n\nSigned-off-by: Mohammed Amine GARMES <mohammed-amine.garmes@amadeus.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 743, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}