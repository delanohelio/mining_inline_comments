{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NTk3NTY5", "number": 3490, "title": "Remove Kafka TLS sidecar for Zookeeper communication", "bodyText": "Type of change\n\nEnhancement / new feature\n\nDescription\nAfter dropping support for Kafka 2.4, all our supported Kafka versions now natively support TLS for Zookeeper communication. The TLS sidecar is thanks to that not needed anymore and this PR removes it.\nRemoving the PR makes it easier to deal with startups / shutdowns, where the Kafka container required the sidecar to be ready etc. It also simplifies the resource management (resources are defined per container) and other things.\nFor the record: the sidecar still remains in use in Cruise Control and in Entity Operator pods.\nChecklist\n\n Write tests\n Make sure all tests pass\n Update documentation\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Update CHANGELOG.md", "createdAt": "2020-08-10T16:12:52Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3490", "merged": true, "mergeCommit": {"oid": "62ba24f264d3f56457b3fc51052dbbb7efb9ed37"}, "closed": true, "closedAt": "2020-08-11T14:09:27Z", "author": {"login": "scholzj"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9kNLFAH2gAyNDY1NTk3NTY5OmVlOWI1MTgzMTRiODVjMWQ1NzI1ZmUwY2VmNTg3ZDBmMTM2ZmExNmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc91X4dgH2gAyNDY1NTk3NTY5OjZjYzVmOTgwN2Y0NzY3MzJjYWIyM2QwZjliMDY1NjBkZTE2YjU5Mzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ee9b518314b85c1d5725fe0cef587d0f136fa16b", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ee9b518314b85c1d5725fe0cef587d0f136fa16b", "committedDate": "2020-08-10T15:46:26Z", "message": "Remove Kafka TLS sidecar for Zookeeper communication\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15fd516c02a0905ccbcd36bd10f3cc06a4ee61a7", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/15fd516c02a0905ccbcd36bd10f3cc06a4ee61a7", "committedDate": "2020-08-10T16:12:38Z", "message": "Fix tests and system tests\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NDA1ODAz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3490#pullrequestreview-464405803", "createdAt": "2020-08-10T16:52:48Z", "commit": {"oid": "15fd516c02a0905ccbcd36bd10f3cc06a4ee61a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e5ce30bd8fe6145f4625318b4e20fb3a3bdc4a8", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3e5ce30bd8fe6145f4625318b4e20fb3a3bdc4a8", "committedDate": "2020-08-10T17:46:56Z", "message": "Add warning about unused environment variable\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0ODU2NjAz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3490#pullrequestreview-464856603", "createdAt": "2020-08-11T08:30:54Z", "commit": {"oid": "3e5ce30bd8fe6145f4625318b4e20fb3a3bdc4a8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0OTM5MzYx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3490#pullrequestreview-464939361", "createdAt": "2020-08-11T10:26:42Z", "commit": {"oid": "3e5ce30bd8fe6145f4625318b4e20fb3a3bdc4a8"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxMDoyNjo0MlrOG-xwWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxMDoyNjo0MlrOG-xwWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODQ4MDA4OA==", "bodyText": "just map.containsKey? or any specific reason for getting the value and see if it's null?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3490#discussion_r468480088", "createdAt": "2020-08-11T10:26:42Z", "author": {"login": "ppatierno"}, "path": "cluster-operator/src/main/java/io/strimzi/operator/cluster/ClusterOperatorConfig.java", "diffHunk": "@@ -92,10 +96,23 @@ public ClusterOperatorConfig(Set<String> namespaces, long reconciliationInterval\n      * @return  Cluster Operator configuration instance\n      */\n     public static ClusterOperatorConfig fromMap(Map<String, String> map) {\n+        warningsForRemovedEndVars(map);\n         KafkaVersion.Lookup lookup = parseKafkaVersions(map.get(STRIMZI_KAFKA_IMAGES), map.get(STRIMZI_KAFKA_CONNECT_IMAGES), map.get(STRIMZI_KAFKA_CONNECT_S2I_IMAGES), map.get(STRIMZI_KAFKA_MIRROR_MAKER_IMAGES), map.get(STRIMZI_KAFKA_MIRROR_MAKER_2_IMAGES));\n         return fromMap(map, lookup);\n     }\n \n+    /**\n+     * Logs warnings for removed / deprecated environment variables\n+     *\n+     * @param map   map from which loading configuration parameters\n+     */\n+    private static void warningsForRemovedEndVars(Map<String, String> map) {\n+        if (map.get(STRIMZI_DEFAULT_TLS_SIDECAR_KAFKA_IMAGE) != null)    {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e5ce30bd8fe6145f4625318b4e20fb3a3bdc4a8"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cc5f9807f476732cab23d0f9b06560de16b5937", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/6cc5f9807f476732cab23d0f9b06560de16b5937", "committedDate": "2020-08-11T11:46:31Z", "message": "Review comments\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1127, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}