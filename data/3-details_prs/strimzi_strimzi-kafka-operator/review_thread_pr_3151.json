{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3NDM5NjI5", "number": 3151, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxOTowMzoyOVrOEEbKCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxOTowMjo0OVrOEZnTCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMDc0Njk3OnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/resources/keycloak/sso_instance.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxOTowMzoyOVrOGiCgZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxOTowMzoyOVrOGiCgZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM0NTgzMQ==", "bodyText": "What does this profile mean?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r438345831", "createdAt": "2020-06-10T19:03:29Z", "author": {"login": "scholzj"}, "path": "systemtest/src/main/resources/keycloak/sso_instance.yaml", "diffHunk": "@@ -0,0 +1,13 @@\n+apiVersion: keycloak.org/v1alpha1\n+kind: Keycloak\n+metadata:\n+  name: example-keycloak\n+  labels:\n+    app: sso\n+spec:\n+  instances: 1\n+  extensions:\n+    - https://github.com/aerogear/keycloak-metrics-spi/releases/download/1.0.4/keycloak-metrics-spi-1.0.4.jar\n+  externalAccess:\n+    enabled: True\n+  profile: RHSSO", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75d729293b99077480db45dc3879dfcc8c55ace0"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczMDc0OTkwOnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxOTowNDoyOFrOGiCiPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoxODo0MFrOHCcELw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM0NjMwMw==", "bodyText": "Why are we having some files locally and some files remotely? Wouldn't it be better to use just one?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r438346303", "createdAt": "2020-06-10T19:04:28Z", "author": {"login": "scholzj"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.resources;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.utils.FileUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.controllers.DeploymentUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.objects.PodUtils;\n+import io.strimzi.systemtest.utils.specific.KeycloakUtils;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import java.io.IOException;\n+\n+public class KeycloakResource {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakResource.class);\n+\n+    private static final String KEYCLOAK_OPERATOR_DEPLOYMENT_NAME = \"keycloak-operator\";\n+    private static final String KEYCLOAK_CUSTOM_RESOURCE_NAME = \"keycloak\";\n+    private static final String KEYCLOAK_POD_NAME = \"keycloak-0\";\n+\n+    public static void keycloakOperator(String namespace) {\n+\n+        LOGGER.info(\"Deploying CRDs for Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        try {\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakbackups.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakclients.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakrealms.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloaks.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakusers.keycloak.org.crd.yaml\"));\n+        } catch (IOException e) {\n+            e.printStackTrace();\n+        }\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/role.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/role_binding.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/service_account.yaml\").getFile());\n+\n+        LOGGER.info(\"Deploying Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/operator.yaml\").getFile());\n+\n+        TestUtils.waitFor(\"Keycloak Operator deployment creation\", Constants.GLOBAL_POLL_INTERVAL, Constants.TIMEOUT_FOR_RESOURCE_CREATION,\n+            () -> ResourceManager.kubeClient().getDeployment(KEYCLOAK_OPERATOR_DEPLOYMENT_NAME) != null);\n+        String deploymentName = ResourceManager.kubeClient().getDeployment(KEYCLOAK_OPERATOR_DEPLOYMENT_NAME).getMetadata().getName();\n+\n+        // schedule deletion after teardown\n+        ResourceManager.getPointerResources().push(() -> deleteKeycloakOperator(deploymentName, namespace));\n+        // Wait for operator creation\n+        waitForKeycloakOperator(deploymentName, namespace, 1);\n+    }\n+\n+    public static void deployKeycloak(String namespace) {\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/keycloak_instance.yaml\").getFile());\n+        waitForKeycloak(namespace);\n+\n+        // schedule deletion after teardown\n+        ResourceManager.getPointerResources().push(() -> deleteKeycloak(namespace));\n+    }\n+\n+    private static void deleteKeycloakOperator(String deploymentName, String namespace) {\n+\n+        try {\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakbackups.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakclients.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakrealms.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloaks.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakusers.keycloak.org.crd.yaml\"));\n+        } catch (IOException e) {\n+            e.printStackTrace();\n+        }\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/role.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/role_binding.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/service_account.yaml\").getFile());\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/operator.yaml\").getFile());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "75d729293b99077480db45dc3879dfcc8c55ace0"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDEzMDE2Mw==", "bodyText": "Hmmm, I think that I decided to this way because we are using a specific version of KO - olm-catalog/keycloak-operator/9.0.2. In that repository, they  have all these files for all versions and there could arise some inconsistency", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r454130163", "createdAt": "2020-07-14T06:26:00Z", "author": {"login": "see-quick"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.resources;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.utils.FileUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.controllers.DeploymentUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.objects.PodUtils;\n+import io.strimzi.systemtest.utils.specific.KeycloakUtils;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import java.io.IOException;\n+\n+public class KeycloakResource {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakResource.class);\n+\n+    private static final String KEYCLOAK_OPERATOR_DEPLOYMENT_NAME = \"keycloak-operator\";\n+    private static final String KEYCLOAK_CUSTOM_RESOURCE_NAME = \"keycloak\";\n+    private static final String KEYCLOAK_POD_NAME = \"keycloak-0\";\n+\n+    public static void keycloakOperator(String namespace) {\n+\n+        LOGGER.info(\"Deploying CRDs for Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        try {\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakbackups.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakclients.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakrealms.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloaks.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakusers.keycloak.org.crd.yaml\"));\n+        } catch (IOException e) {\n+            e.printStackTrace();\n+        }\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/role.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/role_binding.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/service_account.yaml\").getFile());\n+\n+        LOGGER.info(\"Deploying Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/operator.yaml\").getFile());\n+\n+        TestUtils.waitFor(\"Keycloak Operator deployment creation\", Constants.GLOBAL_POLL_INTERVAL, Constants.TIMEOUT_FOR_RESOURCE_CREATION,\n+            () -> ResourceManager.kubeClient().getDeployment(KEYCLOAK_OPERATOR_DEPLOYMENT_NAME) != null);\n+        String deploymentName = ResourceManager.kubeClient().getDeployment(KEYCLOAK_OPERATOR_DEPLOYMENT_NAME).getMetadata().getName();\n+\n+        // schedule deletion after teardown\n+        ResourceManager.getPointerResources().push(() -> deleteKeycloakOperator(deploymentName, namespace));\n+        // Wait for operator creation\n+        waitForKeycloakOperator(deploymentName, namespace, 1);\n+    }\n+\n+    public static void deployKeycloak(String namespace) {\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/keycloak_instance.yaml\").getFile());\n+        waitForKeycloak(namespace);\n+\n+        // schedule deletion after teardown\n+        ResourceManager.getPointerResources().push(() -> deleteKeycloak(namespace));\n+    }\n+\n+    private static void deleteKeycloakOperator(String deploymentName, String namespace) {\n+\n+        try {\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakbackups.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakclients.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakrealms.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloaks.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakusers.keycloak.org.crd.yaml\"));\n+        } catch (IOException e) {\n+            e.printStackTrace();\n+        }\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/role.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/role_binding.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/service_account.yaml\").getFile());\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/operator.yaml\").getFile());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM0NjMwMw=="}, "originalCommit": {"oid": "75d729293b99077480db45dc3879dfcc8c55ace0"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMxOTAyMw==", "bodyText": "https://github.com/keycloak/keycloak-operator/blob/9.0.2/deploy/operator.yaml  hm?  You use 9.0.2 for all files, but master image in \"local\" operator data. I think we should use files from github if you don't need to change anything special here.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472319023", "createdAt": "2020-08-18T16:18:40Z", "author": {"login": "Frawless"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "diffHunk": "@@ -0,0 +1,108 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.resources;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.utils.FileUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.controllers.DeploymentUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.objects.PodUtils;\n+import io.strimzi.systemtest.utils.specific.KeycloakUtils;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import java.io.IOException;\n+\n+public class KeycloakResource {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakResource.class);\n+\n+    private static final String KEYCLOAK_OPERATOR_DEPLOYMENT_NAME = \"keycloak-operator\";\n+    private static final String KEYCLOAK_CUSTOM_RESOURCE_NAME = \"keycloak\";\n+    private static final String KEYCLOAK_POD_NAME = \"keycloak-0\";\n+\n+    public static void keycloakOperator(String namespace) {\n+\n+        LOGGER.info(\"Deploying CRDs for Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        try {\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakbackups.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakclients.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakrealms.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloaks.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakusers.keycloak.org.crd.yaml\"));\n+        } catch (IOException e) {\n+            e.printStackTrace();\n+        }\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/role.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/role_binding.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/service_account.yaml\").getFile());\n+\n+        LOGGER.info(\"Deploying Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/operator.yaml\").getFile());\n+\n+        TestUtils.waitFor(\"Keycloak Operator deployment creation\", Constants.GLOBAL_POLL_INTERVAL, Constants.TIMEOUT_FOR_RESOURCE_CREATION,\n+            () -> ResourceManager.kubeClient().getDeployment(KEYCLOAK_OPERATOR_DEPLOYMENT_NAME) != null);\n+        String deploymentName = ResourceManager.kubeClient().getDeployment(KEYCLOAK_OPERATOR_DEPLOYMENT_NAME).getMetadata().getName();\n+\n+        // schedule deletion after teardown\n+        ResourceManager.getPointerResources().push(() -> deleteKeycloakOperator(deploymentName, namespace));\n+        // Wait for operator creation\n+        waitForKeycloakOperator(deploymentName, namespace, 1);\n+    }\n+\n+    public static void deployKeycloak(String namespace) {\n+        ResourceManager.cmdKubeClient().namespace(namespace).apply(KeycloakResource.class.getResource(\"/keycloak/keycloak_instance.yaml\").getFile());\n+        waitForKeycloak(namespace);\n+\n+        // schedule deletion after teardown\n+        ResourceManager.getPointerResources().push(() -> deleteKeycloak(namespace));\n+    }\n+\n+    private static void deleteKeycloakOperator(String deploymentName, String namespace) {\n+\n+        try {\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakbackups.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakclients.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakrealms.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloaks.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().delete(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakusers.keycloak.org.crd.yaml\"));\n+        } catch (IOException e) {\n+            e.printStackTrace();\n+        }\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/role.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/role_binding.yaml\").getFile());\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/service_account.yaml\").getFile());\n+\n+        ResourceManager.cmdKubeClient().namespace(namespace).delete(KeycloakResource.class.getResource(\"/keycloak/operator.yaml\").getFile());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODM0NjMwMw=="}, "originalCommit": {"oid": "75d729293b99077480db45dc3879dfcc8c55ace0"}, "originalPosition": 84}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MjMyNDQ2OnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoxNjowNFrOHCb9mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjo0NjoxNlrOHCdJcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMxNzMzOQ==", "bodyText": "We should keep those URLs in some constants, since it's used on multiple places.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472317339", "createdAt": "2020-08-18T16:16:04Z", "author": {"login": "Frawless"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.resources;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.utils.FileUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.controllers.DeploymentUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.objects.PodUtils;\n+import io.strimzi.systemtest.utils.specific.KeycloakUtils;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import java.io.IOException;\n+\n+import static io.strimzi.systemtest.resources.ResourceManager.CR_CREATION_TIMEOUT;\n+\n+public class KeycloakResource {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakResource.class);\n+\n+    private static final String KEYCLOAK_OPERATOR_DEPLOYMENT_NAME = \"keycloak-operator\";\n+    private static final String KEYCLOAK_CUSTOM_RESOURCE_NAME = \"keycloak\";\n+    private static final String KEYCLOAK_POD_NAME = \"keycloak-0\";\n+\n+    public static void keycloakOperator(String namespace) {\n+\n+        LOGGER.info(\"Deploying CRDs for Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        try {\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMzNjc1Mg==", "bodyText": "and why we need CSV?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472336752", "createdAt": "2020-08-18T16:46:16Z", "author": {"login": "Frawless"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.resources;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.utils.FileUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.controllers.DeploymentUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.objects.PodUtils;\n+import io.strimzi.systemtest.utils.specific.KeycloakUtils;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import java.io.IOException;\n+\n+import static io.strimzi.systemtest.resources.ResourceManager.CR_CREATION_TIMEOUT;\n+\n+public class KeycloakResource {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakResource.class);\n+\n+    private static final String KEYCLOAK_OPERATOR_DEPLOYMENT_NAME = \"keycloak-operator\";\n+    private static final String KEYCLOAK_CUSTOM_RESOURCE_NAME = \"keycloak\";\n+    private static final String KEYCLOAK_POD_NAME = \"keycloak-0\";\n+\n+    public static void keycloakOperator(String namespace) {\n+\n+        LOGGER.info(\"Deploying CRDs for Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        try {\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMxNzMzOQ=="}, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MjM0MDg5OnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/resources/keycloak/keycloak_instance.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMDoxMFrOHCcH7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMDoxMFrOHCcH7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMxOTk4MQ==", "bodyText": "https://github.com/keycloak/keycloak-operator/blob/9.0.2/deploy/examples/keycloak/keycloak.yaml", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472319981", "createdAt": "2020-08-18T16:20:10Z", "author": {"login": "Frawless"}, "path": "systemtest/src/main/resources/keycloak/keycloak_instance.yaml", "diffHunk": "@@ -0,0 +1,14 @@\n+apiVersion: keycloak.org/v1alpha1\n+kind: Keycloak\n+metadata:\n+  name: example-keycloak\n+  labels:\n+    app: keycloak-instance\n+spec:\n+  instances: 1\n+  extensions:\n+    - https://github.com/aerogear/keycloak-metrics-spi/releases/download/1.0.4/keycloak-metrics-spi-1.0.4.jar\n+  externalAccess:\n+    enabled: True\n+  podDisruptionBudget:\n+    enabled: True", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MjM0OTM3OnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/resources/keycloak/operator.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjoxOFrOHCcNUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjoxOFrOHCcNUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyMTM2Mw==", "bodyText": "https://github.com/keycloak/keycloak-operator/blob/9.0.2/deploy/operator.yaml", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472321363", "createdAt": "2020-08-18T16:22:18Z", "author": {"login": "Frawless"}, "path": "systemtest/src/main/resources/keycloak/operator.yaml", "diffHunk": "@@ -0,0 +1,33 @@\n+apiVersion: apps/v1\n+kind: Deployment\n+metadata:\n+  name: keycloak-operator\n+spec:\n+  replicas: 1\n+  selector:\n+    matchLabels:\n+      name: keycloak-operator\n+  template:\n+    metadata:\n+      labels:\n+        name: keycloak-operator\n+    spec:\n+      serviceAccountName: keycloak-operator\n+      containers:\n+        - name: keycloak-operator\n+          # Replace this with the built image name\n+          image: quay.io/keycloak/keycloak-operator:master\n+          command:\n+          - keycloak-operator\n+          imagePullPolicy: Always\n+          env:\n+            - name: WATCH_NAMESPACE\n+              valueFrom:\n+                fieldRef:\n+                  fieldPath: metadata.namespace\n+            - name: POD_NAME\n+              valueFrom:\n+                fieldRef:\n+                  fieldPath: metadata.name\n+            - name: OPERATOR_NAME\n+              value: \"keycloak-operator\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MjM1MDIwOnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/resources/keycloak/role.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjozMVrOHCcN5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjozMVrOHCcN5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyMTUwOQ==", "bodyText": "Same as above", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472321509", "createdAt": "2020-08-18T16:22:31Z", "author": {"login": "Frawless"}, "path": "systemtest/src/main/resources/keycloak/role.yaml", "diffHunk": "@@ -0,0 +1,132 @@\n+apiVersion: rbac.authorization.k8s.io/v1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MjM1MDY2OnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/resources/keycloak/role_binding.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjozOVrOHCcOQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjozOVrOHCcOQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyMTYwMg==", "bodyText": "Same as above", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472321602", "createdAt": "2020-08-18T16:22:39Z", "author": {"login": "Frawless"}, "path": "systemtest/src/main/resources/keycloak/role_binding.yaml", "diffHunk": "@@ -0,0 +1,11 @@\n+kind: RoleBinding", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MjM1MTI5OnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/resources/keycloak/service_account.yaml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjo0OFrOHCcOqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNjoyMjo0OFrOHCcOqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMyMTcwNg==", "bodyText": "Same as above", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472321706", "createdAt": "2020-08-18T16:22:48Z", "author": {"login": "Frawless"}, "path": "systemtest/src/main/resources/keycloak/service_account.yaml", "diffHunk": "@@ -0,0 +1,4 @@\n+apiVersion: v1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MjkwMDY4OnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxODo1MjowOFrOHChpDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxMzozNzo0NlrOHDHzfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxMDM4Mg==", "bodyText": "Why are we using OLM for this instead of regular installation files? It seems like that could only bring complications down the road. We should also not rely on master files but at least pull it from some tag or copy it locally to make sure it is stable.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472410382", "createdAt": "2020-08-18T18:52:08Z", "author": {"login": "scholzj"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.resources;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.utils.FileUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.controllers.DeploymentUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.objects.PodUtils;\n+import io.strimzi.systemtest.utils.specific.KeycloakUtils;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import java.io.IOException;\n+\n+import static io.strimzi.systemtest.resources.ResourceManager.CR_CREATION_TIMEOUT;\n+\n+public class KeycloakResource {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakResource.class);\n+\n+    private static final String KEYCLOAK_OPERATOR_DEPLOYMENT_NAME = \"keycloak-operator\";\n+    private static final String KEYCLOAK_CUSTOM_RESOURCE_NAME = \"keycloak\";\n+    private static final String KEYCLOAK_POD_NAME = \"keycloak-0\";\n+\n+    public static void keycloakOperator(String namespace) {\n+\n+        LOGGER.info(\"Deploying CRDs for Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        try {\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakbackups.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakclients.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakrealms.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloaks.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakusers.keycloak.org.crd.yaml\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzAzNTY0NA==", "bodyText": "I have to change it to the 11 tag and normal instalation.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r473035644", "createdAt": "2020-08-19T13:37:46Z", "author": {"login": "see-quick"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/resources/KeycloakResource.java", "diffHunk": "@@ -0,0 +1,110 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.resources;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.utils.FileUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.controllers.DeploymentUtils;\n+import io.strimzi.systemtest.utils.kubeUtils.objects.PodUtils;\n+import io.strimzi.systemtest.utils.specific.KeycloakUtils;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import java.io.IOException;\n+\n+import static io.strimzi.systemtest.resources.ResourceManager.CR_CREATION_TIMEOUT;\n+\n+public class KeycloakResource {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakResource.class);\n+\n+    private static final String KEYCLOAK_OPERATOR_DEPLOYMENT_NAME = \"keycloak-operator\";\n+    private static final String KEYCLOAK_CUSTOM_RESOURCE_NAME = \"keycloak\";\n+    private static final String KEYCLOAK_POD_NAME = \"keycloak-0\";\n+\n+    public static void keycloakOperator(String namespace) {\n+\n+        LOGGER.info(\"Deploying CRDs for Keycloak Operator in {} namespace\", ResourceManager.cmdKubeClient().namespace());\n+\n+        try {\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloak-operator.v9.0.2.clusterserviceversion.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakbackups.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakclients.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakrealms.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloaks.keycloak.org.crd.yaml\"));\n+            ResourceManager.cmdKubeClient().apply(FileUtils.downloadAndUnzip(\"https://raw.githubusercontent.com/keycloak/keycloak-operator/master/deploy/olm-catalog/keycloak-operator/9.0.2/keycloakusers.keycloak.org.crd.yaml\"));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxMDM4Mg=="}, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1MjkzNzA2OnYy", "diffSide": "RIGHT", "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/specific/KeycloakUtils.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxOTowMjo0OVrOHCh_gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwODoyODoyMFrOHC8xxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxNjEzMA==", "bodyText": "Do we really need this?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472416130", "createdAt": "2020-08-18T19:02:49Z", "author": {"login": "scholzj"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/specific/KeycloakUtils.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.utils.specific;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.resources.ResourceManager;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class KeycloakUtils {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakUtils.class);\n+\n+    private KeycloakUtils() {}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjgxNDcxMg==", "bodyText": "Yes, I am ensuring that object can not be created outside of class because it will be useless to just create object which has only static methods for my point of view.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472814712", "createdAt": "2020-08-19T07:41:11Z", "author": {"login": "see-quick"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/specific/KeycloakUtils.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.utils.specific;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.resources.ResourceManager;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class KeycloakUtils {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakUtils.class);\n+\n+    private KeycloakUtils() {}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxNjEzMA=="}, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjg1NDk4Mg==", "bodyText": "I agree it is useless to instantiate this class. But not sure we really need the constructor. I think that we have a lot of *Utils classes in the code with static methods which don't do this.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3151#discussion_r472854982", "createdAt": "2020-08-19T08:28:20Z", "author": {"login": "scholzj"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/specific/KeycloakUtils.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.systemtest.utils.specific;\n+\n+import io.strimzi.systemtest.Constants;\n+import io.strimzi.systemtest.resources.ResourceManager;\n+import io.strimzi.test.TestUtils;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+public class KeycloakUtils {\n+\n+    private static final Logger LOGGER = LogManager.getLogger(KeycloakUtils.class);\n+\n+    private KeycloakUtils() {}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQxNjEzMA=="}, "originalCommit": {"oid": "2500ba128c62b4c2696217a8031e96bb517f7398"}, "originalPosition": 17}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1619, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}