{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1ODI2MzA5", "number": 4157, "title": "Add support for Pod Topology Spread Constraints", "bodyText": "Type of change\n\nEnhancement / new feature\n\nDescription\nNode Affinity can be used for a basic scheduling of pods to nodes or zones. But once you have more then one pod per zone, it does not necessarily guarantee equal spread of pods across the nodes or zones. That is something where TopologySpreadConstraints can help (https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/). This PR adds support for TopologySpreadConstraints to the pod templates and allows users to specify them in our custom resources.\nThis PR closes #4136\nChecklist\n\n Write tests\n Make sure all tests pass\n Update documentation\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging\n Update CHANGELOG.md", "createdAt": "2020-12-27T16:07:34Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4157", "merged": true, "mergeCommit": {"oid": "78ab228eba3746a81d1bfd00b17c6f7824082d1f"}, "closed": true, "closedAt": "2021-01-04T15:41:43Z", "author": {"login": "scholzj"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdqTw43gH2gAyNTQ1ODI2MzA5OmNmMDQ3MTM5Mjc3NTRjYmViZmFhMDE3YzVlMzViZGRlN2JkNjYyNjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdszHPNAH2gAyNTQ1ODI2MzA5OmYyN2I0OGViNTFiOTQ0MzUxYWMwYWQ3ZWFjZDMwMTBiNDk0YjQ5NzM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cf04713927754cbebfaa017c5e35bdde7bd66264", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/cf04713927754cbebfaa017c5e35bdde7bd66264", "committedDate": "2020-12-27T16:03:39Z", "message": "Add support for Pod Topology Spread Constraints - Closes #4136\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwODQxMjc2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4157#pullrequestreview-560841276", "createdAt": "2021-01-04T08:16:08Z", "commit": {"oid": "cf04713927754cbebfaa017c5e35bdde7bd66264"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQwODoxNjowOVrOINorAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQwODoxNjowOVrOINorAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTE2ODc3MQ==", "bodyText": "typo the", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/4157#discussion_r551168771", "createdAt": "2021-01-04T08:16:09Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/configuring/ref-affinity.adoc", "diffHunk": "@@ -3,28 +3,34 @@\n // assembly-scheduling.adoc\n \n [id='affinity-{context}']\n-= Specifying affinity and tolerations\n+= Specifying affinity, tolerations, and topology spread constraints\n \n-Use affinity and tolerations to schedule the pods of kafka resources onto nodes.\n-Affinity and tolerations are configured using the `affinity` and `tolerations` properties in following resources:\n+Use affinity, tolerations and topology spread constraints to schedule the pods of kafka resources onto nodes.\n+Affinity, tolerations and topology spread constraints are configured using the `affinity`, `tolerations`, and `topologySpreadConstraint` properties in following resources:\n \n * `Kafka.spec.kafka.template.pod`\n * `Kafka.spec.zookeeper.template.pod`\n * `Kafka.spec.entityOperator.template.pod`\n * `KafkaConnect.spec.template.pod`\n * `KafkaConnectS2I.spec.template.pod`\n * `KafkaBridge.spec.template.pod`\n+* `KafkaMirrorMaker.spec.template.pod`\n+* `KafkaMirrorMaker2.spec.template.pod`\n \n-The format of the `affinity` and `tolerations` properties follows the Kubernetes specification.\n+The format of the `affinity`, `tolerations`, and `topologySpreadConstraint` properties follows the Kubernetes specification.\n The affinity configuration can include different types of affinity:\n \n * Pod affinity and anti-affinity\n * Node affinity\n \n+NOTE: On Kubernetes 1.16 and 1.17, teh support for `topologySpreadConstraint` is disabled by default.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf04713927754cbebfaa017c5e35bdde7bd66264"}, "originalPosition": 28}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f27b48eb51b944351ac0ad7eacd3010b494b4973", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/f27b48eb51b944351ac0ad7eacd3010b494b4973", "committedDate": "2021-01-04T09:42:58Z", "message": "Fix typo\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 646, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}