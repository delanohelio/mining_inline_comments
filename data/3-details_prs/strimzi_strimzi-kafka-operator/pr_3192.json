{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzODcxNDY3", "number": 3192, "title": "Add support for Open Policy Agent authorization", "bodyText": "Type of change\n\nEnhancement / new feature\n\nDescription\nThis PR adds support for authorization using Open Policy Agent. Open Policy Agent (OPA) is a project which provides policy based control for cloud native environments. It is basically able to do a very flexible and fine grained access control. It is not bound to a single specific application. Instead it can be plugged into many different projects. It has wide support for projects like Kubernetes, Envoy, HTTP APIs, Terraform, Docker etc. One for the projects it can integrate with is Kafka.\nOPA is a CNCF project, which gives us several motivations why to support it:\n\nPlay nicely and integrate with another CNCF projects\nIt is often used to secure Kubernetes which is our runtime environment\nIt seems to be very powerful and should be able to cover many custom scenarios\n\nThis PR is using the OPA Kafka Authorizer from Bisnode: https://github.com/Bisnode/opa-kafka-plugin where I in the past contributed some enhancements needed for integration with Strimzi.\nChecklist\n\n Write tests\n Make sure all tests pass\n Update documentation\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Update CHANGELOG.md", "createdAt": "2020-06-12T20:28:18Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192", "merged": true, "mergeCommit": {"oid": "74317a71472d7806d4e25b6c4459bf02efc23f8a"}, "closed": true, "closedAt": "2020-06-15T19:21:41Z", "author": {"login": "scholzj"}, "timelineItems": {"totalCount": 56, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcq6CRygFqTQzMDE1MDEwMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcrd-rYAH2gAyNDMzODcxNDY3OmZkNDI0YmQ1MTlkZjJjZmNjYTI3MzYzYTI4YTlmMmQxOTdjMDNjOTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTUwMTAz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430150103", "createdAt": "2020-06-13T16:27:53Z", "commit": {"oid": "9295c17e2ab248239ba3a9f8d038a0f4c00721a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QxNjoyNzo1M1rOGjYRwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QxNjoyNzo1M1rOGjYRwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc1MTEwNg==", "bodyText": "Maybe change this comment to mention OPA, what it is and a link to the docs?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439751106", "createdAt": "2020-06-13T16:27:53Z", "author": {"login": "samuel-hawker"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9295c17e2ab248239ba3a9f8d038a0f4c00721a7"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTUwMjIz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430150223", "createdAt": "2020-06-13T16:29:43Z", "commit": {"oid": "9295c17e2ab248239ba3a9f8d038a0f4c00721a7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QxNjoyOTo0M1rOGjYSHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QxNjoyOTo0M1rOGjYSHA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc1MTE5Ng==", "bodyText": "Did you mean to check in docker-images/kafka/opa-authorizer-0.3.0-all.jar", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439751196", "createdAt": "2020-06-13T16:29:43Z", "author": {"login": "samuel-hawker"}, "path": "docker-images/kafka/kafka-thirdparty-libs/2.5.x/pom.xml", "diffHunk": "@@ -181,5 +182,25 @@\n                 </exclusion>\n             </exclusions>\n         </dependency>\n+        <!-- Open Policy Authorization plugin -->\n+        <dependency>\n+            <groupId>com.bisnode.kafka.authorization</groupId>\n+            <artifactId>opa-authorizer</artifactId>\n+            <version>${opa-authorizer.version}</version>\n+            <exclusions>\n+                <exclusion>\n+                    <groupId>com.fasterxml.jackson.module</groupId>\n+                    <artifactId>jackson-module-scala_2.12</artifactId>\n+                </exclusion>\n+                <exclusion>\n+                    <groupId>org.apache.kafka</groupId>\n+                    <artifactId>kafka_2.12</artifactId>\n+                </exclusion>\n+                <exclusion>\n+                    <groupId>com.google.code.findbugs</groupId>\n+                    <artifactId>jsr305</artifactId>\n+                </exclusion>\n+            </exclusions>\n+        </dependency>\n     </dependencies>\n </project>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9295c17e2ab248239ba3a9f8d038a0f4c00721a7"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTYzMDUy", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430163052", "createdAt": "2020-06-13T20:09:58Z", "commit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTk4NTU1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430198555", "createdAt": "2020-06-14T08:30:03Z", "commit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "state": "COMMENTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQwODozMDowM1rOGjbk4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNFQwODo0MDowMFrOGjbn7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwNTE1Mw==", "bodyText": "is \"token\" a leftover, OPA doesn't work with tokens, right?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439805153", "createdAt": "2020-06-14T08:30:03Z", "author": {"login": "ppatierno"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"token\", \"superUsers\"})", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwNTMwNA==", "bodyText": "maybe adding more explicitly something like \"allowing access even on failure\"", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439805304", "createdAt": "2020-06-14T08:31:41Z", "author": {"login": "ppatierno"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"token\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"URL of the OPA server with the policy name which should be queried. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines the authorizer behaviour when the OPA calls fail. \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwNTQxMw==", "bodyText": "out of curiosity ... so the address is not just the OPA server address but a specific endpoint where the Kafka related authz policy is \"exposed\"?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439805413", "createdAt": "2020-06-14T08:33:01Z", "author": {"login": "ppatierno"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"token\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"URL of the OPA server with the policy name which should be queried. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwNTQ1Ng==", "bodyText": "Maybe we could add more about the authorizer caching and this property defines the capacity, something like \"Initial capacity of the OPA authorizer decision cache to avoid querying the OPA server policy endpoint every time\"", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439805456", "createdAt": "2020-06-14T08:33:36Z", "author": {"login": "ppatierno"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"token\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"URL of the OPA server with the policy name which should be queried. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines the authorizer behaviour when the OPA calls fail. \" +\n+            \"Defaults to `false`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public boolean isAllowOnError() {\n+        return allowOnError;\n+    }\n+\n+    public void setAllowOnError(boolean allowOnError) {\n+        this.allowOnError = allowOnError;\n+    }\n+\n+    @Description(\"Initial capacity of the decision cache. \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwNTU0Ng==", "bodyText": "something like the previous one related to the initial capacity cache?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439805546", "createdAt": "2020-06-14T08:34:54Z", "author": {"login": "ppatierno"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"token\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"URL of the OPA server with the policy name which should be queried. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines the authorizer behaviour when the OPA calls fail. \" +\n+            \"Defaults to `false`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public boolean isAllowOnError() {\n+        return allowOnError;\n+    }\n+\n+    public void setAllowOnError(boolean allowOnError) {\n+        this.allowOnError = allowOnError;\n+    }\n+\n+    @Description(\"Initial capacity of the decision cache. \" +\n+            \"Defaults to `5000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getInitialCacheCapacity() {\n+        return initialCacheCapacity;\n+    }\n+\n+    public void setInitialCacheCapacity(int initialCacheCapacity) {\n+        this.initialCacheCapacity = initialCacheCapacity;\n+    }\n+\n+    @Description(\"Maximum capacity of the decision cache. \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "originalPosition": 94}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwNTU4NQ==", "bodyText": "ditto as above", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439805585", "createdAt": "2020-06-14T08:35:18Z", "author": {"login": "ppatierno"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"token\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"URL of the OPA server with the policy name which should be queried. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines the authorizer behaviour when the OPA calls fail. \" +\n+            \"Defaults to `false`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public boolean isAllowOnError() {\n+        return allowOnError;\n+    }\n+\n+    public void setAllowOnError(boolean allowOnError) {\n+        this.allowOnError = allowOnError;\n+    }\n+\n+    @Description(\"Initial capacity of the decision cache. \" +\n+            \"Defaults to `5000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getInitialCacheCapacity() {\n+        return initialCacheCapacity;\n+    }\n+\n+    public void setInitialCacheCapacity(int initialCacheCapacity) {\n+        this.initialCacheCapacity = initialCacheCapacity;\n+    }\n+\n+    @Description(\"Maximum capacity of the decision cache. \" +\n+            \"Defaults to `50000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getMaximumCacheSize() {\n+        return maximumCacheSize;\n+    }\n+\n+    public void setMaximumCacheSize(int maximumCacheSize) {\n+        this.maximumCacheSize = maximumCacheSize;\n+    }\n+\n+    @Description(\"Decision cache expiry in milliseconds. \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwNTc3OA==", "bodyText": "is the name of this adoc file like the FQDN of OPA authorization model purpose? it's io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc which sounds weird to me.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439805778", "createdAt": "2020-06-14T08:37:57Z", "author": {"login": "ppatierno"}, "path": "documentation/api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc", "diffHunk": "@@ -0,0 +1,44 @@\n+To use link:https://www.openpolicyagent.org/[Open Policy Agent^] authorization, set the `type` property in the `authorization` section to the value `opa`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwNTg0NQ==", "bodyText": "maybe this above definitions could be used to enrich the descriptions in the model as I raised before.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439805845", "createdAt": "2020-06-14T08:38:55Z", "author": {"login": "ppatierno"}, "path": "documentation/api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc", "diffHunk": "@@ -0,0 +1,44 @@\n+To use link:https://www.openpolicyagent.org/[Open Policy Agent^] authorization, set the `type` property in the `authorization` section to the value `opa`.\n+The Open Policy Agent authorizer has several configuration options:\n+\n+`url`::\n+The URL used to connect to the Open Policy Agent server.\n+The URL has to include the policy which will be queried by the authorizer.\n+**Required.**\n+\n+`allowOnError`::\n+Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable).\n+Defaults to `false` - all actions will be denied.\n+\n+`initialCacheCapacity`::\n+Initial capacity of the local cache used by the authorizer.\n+Defaults to `5000`.\n+\n+`maximumCacheSize`::\n+Maximum capacity of the local cache used by the authorizer.\n+Defaults to `50000`.\n+\n+`expireAfterMs`::\n+The expiration of the records kept in the local cache.\n+In milliseconds.\n+Defaults to `3600000` milliseconds (1 hour).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgwNTkzNA==", "bodyText": "is there a way for disabling cache? Setting max cache size to 0?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r439805934", "createdAt": "2020-06-14T08:40:00Z", "author": {"login": "ppatierno"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,115 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"token\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"URL of the OPA server with the policy name which should be queried. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines the authorizer behaviour when the OPA calls fail. \" +\n+            \"Defaults to `false`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public boolean isAllowOnError() {\n+        return allowOnError;\n+    }\n+\n+    public void setAllowOnError(boolean allowOnError) {\n+        this.allowOnError = allowOnError;\n+    }\n+\n+    @Description(\"Initial capacity of the decision cache. \" +\n+            \"Defaults to `5000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getInitialCacheCapacity() {\n+        return initialCacheCapacity;\n+    }\n+\n+    public void setInitialCacheCapacity(int initialCacheCapacity) {\n+        this.initialCacheCapacity = initialCacheCapacity;\n+    }\n+\n+    @Description(\"Maximum capacity of the decision cache. \" +\n+            \"Defaults to `50000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getMaximumCacheSize() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0ca0207ccb454d65387499878370c1504820a512"}, "originalPosition": 97}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMjQ3NTE2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430247516", "createdAt": "2020-06-14T20:09:28Z", "commit": {"oid": "355adffdde820f872be0da25b3a4f1a7e76fdeaf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDM0MjE5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430434219", "createdAt": "2020-06-15T08:38:32Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODozODozM1rOGjohPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODozODozM1rOGjohPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAxNzIxNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"`opa` is using Open Policy Agent based authorization.\")\n          \n          \n            \n                        \"`opa` authorization type uses Open Policy Agent based authorization.\")", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440017214", "createdAt": "2020-06-15T08:38:33Z", "author": {"login": "PaulRMellor"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorization.java", "diffHunk": "@@ -32,8 +33,10 @@\n     private Map<String, Object> additionalProperties;\n \n     @Description(\"Authorization type. \" +\n-            \"Currently the only supported type is `simple`. \" +\n-            \"`simple` authorization type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\")\n+            \"Currently the supported types are `simple`, `keycloak`, and `opa`. \" +\n+            \"`simple` authorization type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer` class for authorization. \" +\n+            \"`keycloak` authorization type uses Keycloak Authorization Services for authorization. \" +\n+            \"`opa` is using Open Policy Agent based authorization.\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3467481f1f84ecf4cd226bccd502748bebf29723", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3467481f1f84ecf4cd226bccd502748bebf29723", "committedDate": "2020-06-15T08:40:47Z", "message": "OPA PoC using the Kafka Authorizer from OPA Contrib repo\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e903b455514a60400addf6fe5b156ebcfdf844b9", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e903b455514a60400addf6fe5b156ebcfdf844b9", "committedDate": "2020-06-15T08:40:47Z", "message": "OPA PoC with the Bisnode opa-kafka-plugin\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "947b46fb3d7752eed0dd9f3d1728e599dfcedf83", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/947b46fb3d7752eed0dd9f3d1728e599dfcedf83", "committedDate": "2020-06-15T08:40:47Z", "message": "Rebase the OPA PoC and make it up to date with docs etc.\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e62f2b5741ce3a1d5167eb7c8a8fd103c961b18", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/9e62f2b5741ce3a1d5167eb7c8a8fd103c961b18", "committedDate": "2020-06-15T08:40:47Z", "message": "Add system test\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2556f464d5a216b1eae056abef5f422bddb6f0eb", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2556f464d5a216b1eae056abef5f422bddb6f0eb", "committedDate": "2020-06-15T08:40:47Z", "message": "Review comments\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d62c0d26bff07f49eb5ee4043e6b34e140a4c2d", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7d62c0d26bff07f49eb5ee4043e6b34e140a4c2d", "committedDate": "2020-06-15T08:40:47Z", "message": "Review comments II\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c710cbf06cda1e8f15dc9178675c8b8d526343e", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/9c710cbf06cda1e8f15dc9178675c8b8d526343e", "committedDate": "2020-06-15T08:40:47Z", "message": "Regen the docs \ud83d\ude44\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDM1OTQ5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430435949", "createdAt": "2020-06-15T08:40:52Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0MDo1MlrOGjomJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0MDo1MlrOGjomJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAxODQ2OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n          \n          \n            \n                @Description(\"List of super users, which is specifically a list of user principals that have unlimited access rights.\")", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440018468", "createdAt": "2020-06-15T08:40:52Z", "author": {"login": "PaulRMellor"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDM3NjMy", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430437632", "createdAt": "2020-06-15T08:43:05Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0MzowNVrOGjordQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0MzowNVrOGjordQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAxOTgyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @Description(\"Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). \" +\n          \n          \n            \n                @Description(\"Defines whether a Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent, for example, when it is temporarily unavailable). \" +", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440019829", "createdAt": "2020-06-15T08:43:05Z", "author": {"login": "PaulRMellor"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"The URL used to connect to the Open Policy Agent server. \" +\n+            \"The URL has to include the policy which will be queried by the authorizer. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 73}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDM3OTA1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430437905", "createdAt": "2020-06-15T08:43:23Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0MzoyNFrOGjosQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0MzoyNFrOGjosQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyMDAzMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @Description(\"Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request \" +\n          \n          \n            \n                @Description(\"Initial capacity of the local cache used by the authorizer to avoid querying the Open Policy Agent for every request \" +", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440020032", "createdAt": "2020-06-15T08:43:24Z", "author": {"login": "PaulRMellor"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"The URL used to connect to the Open Policy Agent server. \" +\n+            \"The URL has to include the policy which will be queried by the authorizer. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). \" +\n+            \"Defaults to `false` - all actions will be denied.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public boolean isAllowOnError() {\n+        return allowOnError;\n+    }\n+\n+    public void setAllowOnError(boolean allowOnError) {\n+        this.allowOnError = allowOnError;\n+    }\n+\n+    @Description(\"Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 84}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDM4MDk3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430438097", "createdAt": "2020-06-15T08:43:39Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0MzozOVrOGjos2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0MzozOVrOGjos2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyMDE4Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @Description(\"Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request. \" +\n          \n          \n            \n                @Description(\"Maximum capacity of the local cache used by the authorizer to avoid querying the Open Policy Agent for every request. \" +", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440020187", "createdAt": "2020-06-15T08:43:39Z", "author": {"login": "PaulRMellor"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"The URL used to connect to the Open Policy Agent server. \" +\n+            \"The URL has to include the policy which will be queried by the authorizer. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). \" +\n+            \"Defaults to `false` - all actions will be denied.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public boolean isAllowOnError() {\n+        return allowOnError;\n+    }\n+\n+    public void setAllowOnError(boolean allowOnError) {\n+        this.allowOnError = allowOnError;\n+    }\n+\n+    @Description(\"Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request \" +\n+            \"Defaults to `5000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getInitialCacheCapacity() {\n+        return initialCacheCapacity;\n+    }\n+\n+    public void setInitialCacheCapacity(int initialCacheCapacity) {\n+        this.initialCacheCapacity = initialCacheCapacity;\n+    }\n+\n+    @Description(\"Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request. \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 95}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDM4MzM1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430438335", "createdAt": "2020-06-15T08:43:56Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0Mzo1NlrOGjotgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0Mzo1NlrOGjotgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyMDM1Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @Description(\"The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request. \" +\n          \n          \n            \n                @Description(\"The expiration of the records kept in the local cache to avoid querying the Open Policy Agent for every request. \" +", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440020353", "createdAt": "2020-06-15T08:43:56Z", "author": {"login": "PaulRMellor"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"The URL used to connect to the Open Policy Agent server. \" +\n+            \"The URL has to include the policy which will be queried by the authorizer. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). \" +\n+            \"Defaults to `false` - all actions will be denied.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public boolean isAllowOnError() {\n+        return allowOnError;\n+    }\n+\n+    public void setAllowOnError(boolean allowOnError) {\n+        this.allowOnError = allowOnError;\n+    }\n+\n+    @Description(\"Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request \" +\n+            \"Defaults to `5000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getInitialCacheCapacity() {\n+        return initialCacheCapacity;\n+    }\n+\n+    public void setInitialCacheCapacity(int initialCacheCapacity) {\n+        this.initialCacheCapacity = initialCacheCapacity;\n+    }\n+\n+    @Description(\"Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request. \" +\n+            \"Defaults to `50000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getMaximumCacheSize() {\n+        return maximumCacheSize;\n+    }\n+\n+    public void setMaximumCacheSize(int maximumCacheSize) {\n+        this.maximumCacheSize = maximumCacheSize;\n+    }\n+\n+    @Description(\"The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request. \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 106}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQwNDk2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430440496", "createdAt": "2020-06-15T08:46:42Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0Njo0MlrOGjoz4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0Njo0MlrOGjoz4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyMTk4NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable).\n          \n          \n            \n            Defines whether a Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent, for example, when it is temporarily unavailable.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440021985", "createdAt": "2020-06-15T08:46:42Z", "author": {"login": "PaulRMellor"}, "path": "documentation/api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc", "diffHunk": "@@ -0,0 +1,45 @@\n+To use link:https://www.openpolicyagent.org/[Open Policy Agent^] authorization, set the `type` property in the `authorization` section to the value `opa`.\n+The Open Policy Agent authorizer has several configuration options:\n+\n+`url`::\n+The URL used to connect to the Open Policy Agent server.\n+The URL has to include the policy which will be queried by the authorizer.\n+**Required.**\n+\n+`allowOnError`::\n+Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQwNzUz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430440753", "createdAt": "2020-06-15T08:47:01Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0NzowMVrOGjo0pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0NzowMVrOGjo0pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyMjE4Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.\n          \n          \n            \n            Initial capacity of the local cache used by the authorizer to avoid querying the Open Policy Agent for every request.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440022182", "createdAt": "2020-06-15T08:47:01Z", "author": {"login": "PaulRMellor"}, "path": "documentation/api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc", "diffHunk": "@@ -0,0 +1,45 @@\n+To use link:https://www.openpolicyagent.org/[Open Policy Agent^] authorization, set the `type` property in the `authorization` section to the value `opa`.\n+The Open Policy Agent authorizer has several configuration options:\n+\n+`url`::\n+The URL used to connect to the Open Policy Agent server.\n+The URL has to include the policy which will be queried by the authorizer.\n+**Required.**\n+\n+`allowOnError`::\n+Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable).\n+Defaults to `false` - all actions will be denied.\n+\n+`initialCacheCapacity`::\n+Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQwOTM1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430440935", "createdAt": "2020-06-15T08:47:14Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0NzoxNVrOGjo1QA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0NzoxNVrOGjo1QA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyMjMzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.\n          \n          \n            \n            Maximum capacity of the local cache used by the authorizer to avoid querying the Open Policy Agent for every request.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440022336", "createdAt": "2020-06-15T08:47:15Z", "author": {"login": "PaulRMellor"}, "path": "documentation/api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc", "diffHunk": "@@ -0,0 +1,45 @@\n+To use link:https://www.openpolicyagent.org/[Open Policy Agent^] authorization, set the `type` property in the `authorization` section to the value `opa`.\n+The Open Policy Agent authorizer has several configuration options:\n+\n+`url`::\n+The URL used to connect to the Open Policy Agent server.\n+The URL has to include the policy which will be queried by the authorizer.\n+**Required.**\n+\n+`allowOnError`::\n+Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable).\n+Defaults to `false` - all actions will be denied.\n+\n+`initialCacheCapacity`::\n+Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.\n+Defaults to `5000`.\n+\n+`maximumCacheSize`::\n+Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQxMTA0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430441104", "createdAt": "2020-06-15T08:47:29Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0NzoyOVrOGjo1wQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo0NzoyOVrOGjo1wQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyMjQ2NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request.\n          \n          \n            \n            The expiration of the records kept in the local cache to avoid querying the Open Policy Agent for every request.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440022465", "createdAt": "2020-06-15T08:47:29Z", "author": {"login": "PaulRMellor"}, "path": "documentation/api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc", "diffHunk": "@@ -0,0 +1,45 @@\n+To use link:https://www.openpolicyagent.org/[Open Policy Agent^] authorization, set the `type` property in the `authorization` section to the value `opa`.\n+The Open Policy Agent authorizer has several configuration options:\n+\n+`url`::\n+The URL used to connect to the Open Policy Agent server.\n+The URL has to include the policy which will be queried by the authorizer.\n+**Required.**\n+\n+`allowOnError`::\n+Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable).\n+Defaults to `false` - all actions will be denied.\n+\n+`initialCacheCapacity`::\n+Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.\n+Defaults to `5000`.\n+\n+`maximumCacheSize`::\n+Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.\n+Defaults to `50000`.\n+\n+`expireAfterMs`::\n+The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQzMDEz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430443013", "createdAt": "2020-06-15T08:50:04Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1MDowNFrOGjo7cA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1MDowNFrOGjo7cA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyMzkyMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Defines how often will the cached authorization decisions will expire and be reloaded from the Open Policy Agent server.\n          \n          \n            \n            Defines how often the cached authorization decisions are reloaded from the Open Policy Agent server.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440023920", "createdAt": "2020-06-15T08:50:04Z", "author": {"login": "PaulRMellor"}, "path": "documentation/api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc", "diffHunk": "@@ -0,0 +1,45 @@\n+To use link:https://www.openpolicyagent.org/[Open Policy Agent^] authorization, set the `type` property in the `authorization` section to the value `opa`.\n+The Open Policy Agent authorizer has several configuration options:\n+\n+`url`::\n+The URL used to connect to the Open Policy Agent server.\n+The URL has to include the policy which will be queried by the authorizer.\n+**Required.**\n+\n+`allowOnError`::\n+Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable).\n+Defaults to `false` - all actions will be denied.\n+\n+`initialCacheCapacity`::\n+Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.\n+Defaults to `5000`.\n+\n+`maximumCacheSize`::\n+Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.\n+Defaults to `50000`.\n+\n+`expireAfterMs`::\n+The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request.\n+Defines how often will the cached authorization decisions will expire and be reloaded from the Open Policy Agent server.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ0MzIw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430444320", "createdAt": "2020-06-15T08:51:47Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1MTo0N1rOGjo_sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1MTo0N1rOGjo_sA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyNTAwOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            A list of user principals which will be treated as super users and will be always allowed without querying the open Policy Agent policy.\n          \n          \n            \n            A list of user principals treated as super users, so that they are always allowed without querying the open Policy Agent policy.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440025008", "createdAt": "2020-06-15T08:51:47Z", "author": {"login": "PaulRMellor"}, "path": "documentation/api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc", "diffHunk": "@@ -0,0 +1,45 @@\n+To use link:https://www.openpolicyagent.org/[Open Policy Agent^] authorization, set the `type` property in the `authorization` section to the value `opa`.\n+The Open Policy Agent authorizer has several configuration options:\n+\n+`url`::\n+The URL used to connect to the Open Policy Agent server.\n+The URL has to include the policy which will be queried by the authorizer.\n+**Required.**\n+\n+`allowOnError`::\n+Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable).\n+Defaults to `false` - all actions will be denied.\n+\n+`initialCacheCapacity`::\n+Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.\n+Defaults to `5000`.\n+\n+`maximumCacheSize`::\n+Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request.\n+Defaults to `50000`.\n+\n+`expireAfterMs`::\n+The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request.\n+Defines how often will the cached authorization decisions will expire and be reloaded from the Open Policy Agent server.\n+In milliseconds.\n+Defaults to `3600000` milliseconds (1 hour).\n+\n+`superUsers`::\n+A list of user principals which will be treated as super users and will be always allowed without querying the open Policy Agent policy.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ1NDI3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430445427", "createdAt": "2020-06-15T08:53:10Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1MzoxMFrOGjpDKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1MzoxMFrOGjpDKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyNTg5OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |url                   1.2+<.<|The URL used to connect to the Open Policy Agent server. The URL has to include the policy which will be queried by the authorizer. This option is required.\n          \n          \n            \n            |url                   1.2+<.<|(Required) The URL used to connect to the Open Policy Agent server. The URL has to include the policy which will be queried by the authorizer.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440025899", "createdAt": "2020-06-15T08:53:10Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/appendix_crds.adoc", "diffHunk": "@@ -740,13 +740,41 @@ It must have the value `simple` for the type `KafkaAuthorizationSimple`.\n |string array\n |====\n \n+[id='type-KafkaAuthorizationOpa-{context}']\n+### `KafkaAuthorizationOpa` schema reference\n+\n+Used in: xref:type-KafkaClusterSpec-{context}[`KafkaClusterSpec`]\n+\n+include::../api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc[leveloffset=+1]\n+\n+The `type` property is a discriminator that distinguishes the use of the type `KafkaAuthorizationOpa` from xref:type-KafkaAuthorizationSimple-{context}[`KafkaAuthorizationSimple`], xref:type-KafkaAuthorizationKeycloak-{context}[`KafkaAuthorizationKeycloak`].\n+It must have the value `opa` for the type `KafkaAuthorizationOpa`.\n+[options=\"header\"]\n+|====\n+|Property                     |Description\n+|type                  1.2+<.<|Must be `opa`.\n+|string\n+|url                   1.2+<.<|The URL used to connect to the Open Policy Agent server. The URL has to include the policy which will be queried by the authorizer. This option is required.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ2MDA0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430446004", "createdAt": "2020-06-15T08:53:58Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1Mzo1OFrOGjpE2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1Mzo1OFrOGjpE2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyNjMzMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |allowOnError          1.2+<.<|Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). Defaults to `false` - all actions will be denied.\n          \n          \n            \n            |allowOnError          1.2+<.<|Defines whether a Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent, for example, when it is temporarily unavailable. Defaults to `false` - all actions will be denied.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440026331", "createdAt": "2020-06-15T08:53:58Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/appendix_crds.adoc", "diffHunk": "@@ -740,13 +740,41 @@ It must have the value `simple` for the type `KafkaAuthorizationSimple`.\n |string array\n |====\n \n+[id='type-KafkaAuthorizationOpa-{context}']\n+### `KafkaAuthorizationOpa` schema reference\n+\n+Used in: xref:type-KafkaClusterSpec-{context}[`KafkaClusterSpec`]\n+\n+include::../api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc[leveloffset=+1]\n+\n+The `type` property is a discriminator that distinguishes the use of the type `KafkaAuthorizationOpa` from xref:type-KafkaAuthorizationSimple-{context}[`KafkaAuthorizationSimple`], xref:type-KafkaAuthorizationKeycloak-{context}[`KafkaAuthorizationKeycloak`].\n+It must have the value `opa` for the type `KafkaAuthorizationOpa`.\n+[options=\"header\"]\n+|====\n+|Property                     |Description\n+|type                  1.2+<.<|Must be `opa`.\n+|string\n+|url                   1.2+<.<|The URL used to connect to the Open Policy Agent server. The URL has to include the policy which will be queried by the authorizer. This option is required.\n+|string\n+|allowOnError          1.2+<.<|Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). Defaults to `false` - all actions will be denied.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 40}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ2MTg5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430446189", "createdAt": "2020-06-15T08:54:14Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NDoxNFrOGjpFXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NDoxNFrOGjpFXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyNjQ2Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |initialCacheCapacity  1.2+<.<|Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request Defaults to `5000`.\n          \n          \n            \n            |initialCacheCapacity  1.2+<.<|Initial capacity of the local cache used by the authorizer to avoid querying the Open Policy Agent for every request. Defaults to `5000`.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440026463", "createdAt": "2020-06-15T08:54:14Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/appendix_crds.adoc", "diffHunk": "@@ -740,13 +740,41 @@ It must have the value `simple` for the type `KafkaAuthorizationSimple`.\n |string array\n |====\n \n+[id='type-KafkaAuthorizationOpa-{context}']\n+### `KafkaAuthorizationOpa` schema reference\n+\n+Used in: xref:type-KafkaClusterSpec-{context}[`KafkaClusterSpec`]\n+\n+include::../api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc[leveloffset=+1]\n+\n+The `type` property is a discriminator that distinguishes the use of the type `KafkaAuthorizationOpa` from xref:type-KafkaAuthorizationSimple-{context}[`KafkaAuthorizationSimple`], xref:type-KafkaAuthorizationKeycloak-{context}[`KafkaAuthorizationKeycloak`].\n+It must have the value `opa` for the type `KafkaAuthorizationOpa`.\n+[options=\"header\"]\n+|====\n+|Property                     |Description\n+|type                  1.2+<.<|Must be `opa`.\n+|string\n+|url                   1.2+<.<|The URL used to connect to the Open Policy Agent server. The URL has to include the policy which will be queried by the authorizer. This option is required.\n+|string\n+|allowOnError          1.2+<.<|Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). Defaults to `false` - all actions will be denied.\n+|boolean\n+|initialCacheCapacity  1.2+<.<|Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request Defaults to `5000`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ2NjA4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430446608", "createdAt": "2020-06-15T08:54:46Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NDo0NlrOGjpGmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NDo0NlrOGjpGmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyNjc3OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |maximumCacheSize      1.2+<.<|Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request. Defaults to `50000`.\n          \n          \n            \n            |maximumCacheSize      1.2+<.<|Maximum capacity of the local cache used by the authorizer to avoid querying the Open Policy Agent for every request. Defaults to `50000`.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440026778", "createdAt": "2020-06-15T08:54:46Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/appendix_crds.adoc", "diffHunk": "@@ -740,13 +740,41 @@ It must have the value `simple` for the type `KafkaAuthorizationSimple`.\n |string array\n |====\n \n+[id='type-KafkaAuthorizationOpa-{context}']\n+### `KafkaAuthorizationOpa` schema reference\n+\n+Used in: xref:type-KafkaClusterSpec-{context}[`KafkaClusterSpec`]\n+\n+include::../api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc[leveloffset=+1]\n+\n+The `type` property is a discriminator that distinguishes the use of the type `KafkaAuthorizationOpa` from xref:type-KafkaAuthorizationSimple-{context}[`KafkaAuthorizationSimple`], xref:type-KafkaAuthorizationKeycloak-{context}[`KafkaAuthorizationKeycloak`].\n+It must have the value `opa` for the type `KafkaAuthorizationOpa`.\n+[options=\"header\"]\n+|====\n+|Property                     |Description\n+|type                  1.2+<.<|Must be `opa`.\n+|string\n+|url                   1.2+<.<|The URL used to connect to the Open Policy Agent server. The URL has to include the policy which will be queried by the authorizer. This option is required.\n+|string\n+|allowOnError          1.2+<.<|Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). Defaults to `false` - all actions will be denied.\n+|boolean\n+|initialCacheCapacity  1.2+<.<|Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request Defaults to `5000`.\n+|integer\n+|maximumCacheSize      1.2+<.<|Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request. Defaults to `50000`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ3MTQ2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430447146", "createdAt": "2020-06-15T08:55:27Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NToyN1rOGjpIPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NToyN1rOGjpIPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyNzE5OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |expireAfterMs         1.2+<.<|The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request. Defines how often will the cached authorization decisions will expire and be reloaded from the Open Policy Agent server. In milliseconds. Defaults to `3600000`.\n          \n          \n            \n            |expireAfterMs         1.2+<.<|The expiration of the records kept in the local cache to avoid querying the Open Policy Agent for every request. Defines how often the cached authorization decisions are reloaded from the Open Policy Agent server. In milliseconds. Defaults to `3600000`.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440027199", "createdAt": "2020-06-15T08:55:27Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/appendix_crds.adoc", "diffHunk": "@@ -740,13 +740,41 @@ It must have the value `simple` for the type `KafkaAuthorizationSimple`.\n |string array\n |====\n \n+[id='type-KafkaAuthorizationOpa-{context}']\n+### `KafkaAuthorizationOpa` schema reference\n+\n+Used in: xref:type-KafkaClusterSpec-{context}[`KafkaClusterSpec`]\n+\n+include::../api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc[leveloffset=+1]\n+\n+The `type` property is a discriminator that distinguishes the use of the type `KafkaAuthorizationOpa` from xref:type-KafkaAuthorizationSimple-{context}[`KafkaAuthorizationSimple`], xref:type-KafkaAuthorizationKeycloak-{context}[`KafkaAuthorizationKeycloak`].\n+It must have the value `opa` for the type `KafkaAuthorizationOpa`.\n+[options=\"header\"]\n+|====\n+|Property                     |Description\n+|type                  1.2+<.<|Must be `opa`.\n+|string\n+|url                   1.2+<.<|The URL used to connect to the Open Policy Agent server. The URL has to include the policy which will be queried by the authorizer. This option is required.\n+|string\n+|allowOnError          1.2+<.<|Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). Defaults to `false` - all actions will be denied.\n+|boolean\n+|initialCacheCapacity  1.2+<.<|Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request Defaults to `5000`.\n+|integer\n+|maximumCacheSize      1.2+<.<|Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request. Defaults to `50000`.\n+|integer\n+|expireAfterMs         1.2+<.<|The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request. Defines how often will the cached authorization decisions will expire and be reloaded from the Open Policy Agent server. In milliseconds. Defaults to `3600000`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ4NTQ3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430448547", "createdAt": "2020-06-15T08:57:10Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NzoxMFrOGjpMdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1NzoxMFrOGjpMdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyODI3OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            |superUsers            1.2+<.<|List of super users. Should contain list of user principals which should get unlimited access rights.\n          \n          \n            \n            |superUsers            1.2+<.<|List of super users, which is specifically a list of user principals that have unlimited access rights.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440028278", "createdAt": "2020-06-15T08:57:10Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/appendix_crds.adoc", "diffHunk": "@@ -740,13 +740,41 @@ It must have the value `simple` for the type `KafkaAuthorizationSimple`.\n |string array\n |====\n \n+[id='type-KafkaAuthorizationOpa-{context}']\n+### `KafkaAuthorizationOpa` schema reference\n+\n+Used in: xref:type-KafkaClusterSpec-{context}[`KafkaClusterSpec`]\n+\n+include::../api/io.strimzi.api.kafka.model.KafkaAuthorizationOpa.adoc[leveloffset=+1]\n+\n+The `type` property is a discriminator that distinguishes the use of the type `KafkaAuthorizationOpa` from xref:type-KafkaAuthorizationSimple-{context}[`KafkaAuthorizationSimple`], xref:type-KafkaAuthorizationKeycloak-{context}[`KafkaAuthorizationKeycloak`].\n+It must have the value `opa` for the type `KafkaAuthorizationOpa`.\n+[options=\"header\"]\n+|====\n+|Property                     |Description\n+|type                  1.2+<.<|Must be `opa`.\n+|string\n+|url                   1.2+<.<|The URL used to connect to the Open Policy Agent server. The URL has to include the policy which will be queried by the authorizer. This option is required.\n+|string\n+|allowOnError          1.2+<.<|Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). Defaults to `false` - all actions will be denied.\n+|boolean\n+|initialCacheCapacity  1.2+<.<|Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request Defaults to `5000`.\n+|integer\n+|maximumCacheSize      1.2+<.<|Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request. Defaults to `50000`.\n+|integer\n+|expireAfterMs         1.2+<.<|The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request. Defines how often will the cached authorization decisions will expire and be reloaded from the Open Policy Agent server. In milliseconds. Defaults to `3600000`.\n+|integer\n+|superUsers            1.2+<.<|List of super users. Should contain list of user principals which should get unlimited access rights.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDQ5NjI2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430449626", "createdAt": "2020-06-15T08:58:29Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1ODoyOVrOGjpPyQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1ODoyOVrOGjpPyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyOTEyOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                  description: Defines whether Kafka client should be allowed\n          \n          \n            \n                                  description: Defines whether a Kafka client should be allowed", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440029129", "createdAt": "2020-06-15T08:58:29Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -963,6 +963,12 @@ spec:\n                 authorization:\n                   type: object\n                   properties:\n+                    allowOnError:\n+                      type: boolean\n+                      description: Defines whether Kafka client should be allowed", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDUwMDY4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430450068", "createdAt": "2020-06-15T08:59:02Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1OTowM1rOGjpRJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1OTowM1rOGjpRJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyOTQ3Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    Open Policy Agent (for example because it is temporarily unavailable).\n          \n          \n            \n                                    Open Policy Agent, for example, when it is temporarily unavailable.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440029476", "createdAt": "2020-06-15T08:59:03Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -963,6 +963,12 @@ spec:\n                 authorization:\n                   type: object\n                   properties:\n+                    allowOnError:\n+                      type: boolean\n+                      description: Defines whether Kafka client should be allowed\n+                        or denied by default when the authorizer fails to query the\n+                        Open Policy Agent (for example because it is temporarily unavailable).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDUwMzg0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430450384", "createdAt": "2020-06-15T08:59:24Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1OToyNVrOGjpSBw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwODo1OToyNVrOGjpSBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAyOTcwMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    cache to avoid querying Open Policy Agent for every request.\n          \n          \n            \n                                    cache to avoid querying the Open Policy Agent for every request.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440029703", "createdAt": "2020-06-15T08:59:25Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -977,6 +983,23 @@ spec:\n                       type: boolean\n                       description: Enable or disable TLS hostname verification. Default\n                         value is `false`.\n+                    expireAfterMs:\n+                      type: integer\n+                      description: The expiration of the records kept in the local\n+                        cache to avoid querying Open Policy Agent for every request.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDUxMjM0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430451234", "createdAt": "2020-06-15T09:00:33Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMDozM1rOGjpUrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMDozM1rOGjpUrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMDM4Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"Defines how often will the cached authorization decisions will expire and be reloaded from the Open Policy Agent server. \" +\n          \n          \n            \n                        \"Defines how often the cached authorization decisions are reloaded from the Open Policy Agent server. \" +", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440030383", "createdAt": "2020-06-15T09:00:33Z", "author": {"login": "PaulRMellor"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorizationOpa.java", "diffHunk": "@@ -0,0 +1,118 @@\n+/*\n+ * Copyright Strimzi authors.\n+ * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n+ */\n+package io.strimzi.api.kafka.model;\n+\n+import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import io.strimzi.crdgenerator.annotations.Description;\n+import io.strimzi.crdgenerator.annotations.DescriptionFile;\n+import io.strimzi.crdgenerator.annotations.Example;\n+import io.sundr.builder.annotations.Buildable;\n+import lombok.EqualsAndHashCode;\n+\n+import java.util.List;\n+\n+/**\n+ * Configures the broker authorization to use Open Policy Agent as an authorization and policy server.\n+ */\n+@DescriptionFile\n+@Buildable(\n+        editableEnabled = false,\n+        builderPackage = Constants.FABRIC8_KUBERNETES_API\n+)\n+@JsonInclude(JsonInclude.Include.NON_NULL)\n+@JsonPropertyOrder({\"type\", \"url\", \"allowOnError\", \"initialCacheCapacity\", \"maximumCacheSize\", \"expireAfterMs\", \"superUsers\"})\n+@EqualsAndHashCode\n+public class KafkaAuthorizationOpa extends KafkaAuthorization {\n+    private static final long serialVersionUID = 1L;\n+\n+    public static final String TYPE_OPA = \"opa\";\n+\n+    public static final String AUTHORIZER_CLASS_NAME = \"com.bisnode.kafka.authorization.OpaAuthorizer\";\n+\n+    private List<String> superUsers;\n+    private String url;\n+    private boolean allowOnError = false;\n+    private int initialCacheCapacity = 5000;\n+    private int maximumCacheSize = 50000;\n+    private long expireAfterMs = 3600000;\n+\n+    @Description(\"Must be `\" + TYPE_OPA + \"`\")\n+    @Override\n+    public String getType() {\n+        return TYPE_OPA;\n+    }\n+\n+    @Description(\"List of super users. Should contain list of user principals which should get unlimited access rights.\")\n+    @Example(\"- CN=my-user\\n\" +\n+             \"- CN=my-other-user\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public List<String> getSuperUsers() {\n+        return superUsers;\n+    }\n+\n+    public void setSuperUsers(List<String> superUsers) {\n+        this.superUsers = superUsers;\n+    }\n+\n+    @Description(\"The URL used to connect to the Open Policy Agent server. \" +\n+            \"The URL has to include the policy which will be queried by the authorizer. \" +\n+            \"This option is required.\")\n+    @Example(\"http://opa:8181/v1/data/kafka/authz/allow\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public String getUrl() {\n+        return url;\n+    }\n+\n+    public void setUrl(String url) {\n+        this.url = url;\n+    }\n+\n+    @Description(\"Defines whether Kafka client should be allowed or denied by default when the authorizer fails to query the Open Policy Agent (for example because it is temporarily unavailable). \" +\n+            \"Defaults to `false` - all actions will be denied.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public boolean isAllowOnError() {\n+        return allowOnError;\n+    }\n+\n+    public void setAllowOnError(boolean allowOnError) {\n+        this.allowOnError = allowOnError;\n+    }\n+\n+    @Description(\"Initial capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request \" +\n+            \"Defaults to `5000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getInitialCacheCapacity() {\n+        return initialCacheCapacity;\n+    }\n+\n+    public void setInitialCacheCapacity(int initialCacheCapacity) {\n+        this.initialCacheCapacity = initialCacheCapacity;\n+    }\n+\n+    @Description(\"Maximum capacity of the local cache used by the authorizer to avoid querying Open Policy Agent for every request. \" +\n+            \"Defaults to `50000`.\")\n+    @JsonInclude(JsonInclude.Include.NON_NULL)\n+    public int getMaximumCacheSize() {\n+        return maximumCacheSize;\n+    }\n+\n+    public void setMaximumCacheSize(int maximumCacheSize) {\n+        this.maximumCacheSize = maximumCacheSize;\n+    }\n+\n+    @Description(\"The expiration of the records kept in the local cache to avoid querying Open Policy Agent for every request. \" +\n+            \"Defines how often will the cached authorization decisions will expire and be reloaded from the Open Policy Agent server. \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 107}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDUxNjky", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430451692", "createdAt": "2020-06-15T09:01:09Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMTowOVrOGjpWQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMTowOVrOGjpWQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMDc4NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    will expire and be reloaded from the Open Policy Agent server.\n          \n          \n            \n                                    are reloaded from the Open Policy Agent server.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440030784", "createdAt": "2020-06-15T09:01:09Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -977,6 +983,23 @@ spec:\n                       type: boolean\n                       description: Enable or disable TLS hostname verification. Default\n                         value is `false`.\n+                    expireAfterMs:\n+                      type: integer\n+                      description: The expiration of the records kept in the local\n+                        cache to avoid querying Open Policy Agent for every request.\n+                        Defines how often will the cached authorization decisions\n+                        will expire and be reloaded from the Open Policy Agent server.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDUxOTA3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430451907", "createdAt": "2020-06-15T09:01:26Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMToyN1rOGjpW8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMToyN1rOGjpW8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMDk2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    authorizer to avoid querying Open Policy Agent for every request\n          \n          \n            \n                                    authorizer to avoid querying the Open Policy Agent for every request.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440030960", "createdAt": "2020-06-15T09:01:27Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -977,6 +983,23 @@ spec:\n                       type: boolean\n                       description: Enable or disable TLS hostname verification. Default\n                         value is `false`.\n+                    expireAfterMs:\n+                      type: integer\n+                      description: The expiration of the records kept in the local\n+                        cache to avoid querying Open Policy Agent for every request.\n+                        Defines how often will the cached authorization decisions\n+                        will expire and be reloaded from the Open Policy Agent server.\n+                        In milliseconds. Defaults to `3600000`.\n+                    initialCacheCapacity:\n+                      type: integer\n+                      description: Initial capacity of the local cache used by the\n+                        authorizer to avoid querying Open Policy Agent for every request", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDUyNTMx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430452531", "createdAt": "2020-06-15T09:02:13Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMjoxNFrOGjpYuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMjoxNFrOGjpYuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMTQxNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    authorizer to avoid querying Open Policy Agent for every request.\n          \n          \n            \n                                    authorizer to avoid querying the Open Policy Agent for every request.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440031416", "createdAt": "2020-06-15T09:02:14Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -977,6 +983,23 @@ spec:\n                       type: boolean\n                       description: Enable or disable TLS hostname verification. Default\n                         value is `false`.\n+                    expireAfterMs:\n+                      type: integer\n+                      description: The expiration of the records kept in the local\n+                        cache to avoid querying Open Policy Agent for every request.\n+                        Defines how often will the cached authorization decisions\n+                        will expire and be reloaded from the Open Policy Agent server.\n+                        In milliseconds. Defaults to `3600000`.\n+                    initialCacheCapacity:\n+                      type: integer\n+                      description: Initial capacity of the local cache used by the\n+                        authorizer to avoid querying Open Policy Agent for every request\n+                        Defaults to `5000`.\n+                    maximumCacheSize:\n+                      type: integer\n+                      description: Maximum capacity of the local cache used by the\n+                        authorizer to avoid querying Open Policy Agent for every request.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDUzMDQ0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430453044", "createdAt": "2020-06-15T09:02:52Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMjo1MlrOGjpaTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowMjo1MlrOGjpaTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMTgyMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    Keycloak Authorization Services for authorization. `opa` is\n          \n          \n            \n                                    using Open Policy Agent based authorization.\n          \n          \n            \n                                    Keycloak Authorization Services for authorization. `opa`\n          \n          \n            \n                                    uses Open Policy Agent based authorization.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440031823", "createdAt": "2020-06-15T09:02:52Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -1006,10 +1029,20 @@ spec:\n                       type: string\n                       enum:\n                       - simple\n+                      - opa\n                       - keycloak\n-                      description: Authorization type. Currently the only supported\n-                        type is `simple`. `simple` authorization type uses Kafka's\n-                        `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\n+                      description: Authorization type. Currently the supported types\n+                        are `simple`, `keycloak`, and `opa`. `simple` authorization\n+                        type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer`\n+                        class for authorization. `keycloak` authorization type uses\n+                        Keycloak Authorization Services for authorization. `opa` is\n+                        using Open Policy Agent based authorization.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDU0Mzgy", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430454382", "createdAt": "2020-06-15T09:04:36Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNDozN1rOGjpeMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNDozN1rOGjpeMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMjgxNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                  description: The URL used to connect to the Open Policy Agent\n          \n          \n            \n                                  description: (Required) The URL used to connect to the Open Policy Agent", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440032816", "createdAt": "2020-06-15T09:04:37Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -1006,10 +1029,20 @@ spec:\n                       type: string\n                       enum:\n                       - simple\n+                      - opa\n                       - keycloak\n-                      description: Authorization type. Currently the only supported\n-                        type is `simple`. `simple` authorization type uses Kafka's\n-                        `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\n+                      description: Authorization type. Currently the supported types\n+                        are `simple`, `keycloak`, and `opa`. `simple` authorization\n+                        type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer`\n+                        class for authorization. `keycloak` authorization type uses\n+                        Keycloak Authorization Services for authorization. `opa` is\n+                        using Open Policy Agent based authorization.\n+                    url:\n+                      type: string\n+                      example: http://opa:8181/v1/data/kafka/authz/allow\n+                      description: The URL used to connect to the Open Policy Agent", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDU0NjM5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430454639", "createdAt": "2020-06-15T09:04:58Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNDo1OFrOGjpe4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNDo1OFrOGjpe4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMjk5NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    by the authorizer. This option is required.\n          \n          \n            \n                                    by the authorizer.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440032994", "createdAt": "2020-06-15T09:04:58Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -1006,10 +1029,20 @@ spec:\n                       type: string\n                       enum:\n                       - simple\n+                      - opa\n                       - keycloak\n-                      description: Authorization type. Currently the only supported\n-                        type is `simple`. `simple` authorization type uses Kafka's\n-                        `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\n+                      description: Authorization type. Currently the supported types\n+                        are `simple`, `keycloak`, and `opa`. `simple` authorization\n+                        type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer`\n+                        class for authorization. `keycloak` authorization type uses\n+                        Keycloak Authorization Services for authorization. `opa` is\n+                        using Open Policy Agent based authorization.\n+                    url:\n+                      type: string\n+                      example: http://opa:8181/v1/data/kafka/authz/allow\n+                      description: The URL used to connect to the Open Policy Agent\n+                        server. The URL has to include the policy which will be queried\n+                        by the authorizer. This option is required.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDU1MDA0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430455004", "createdAt": "2020-06-15T09:05:26Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNToyNlrOGjpf-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNToyNlrOGjpf-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMzI3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    Open Policy Agent (for example because it is temporarily unavailable).\n          \n          \n            \n                                    Open Policy Agent, for example, when it is temporarily unavailable.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440033275", "createdAt": "2020-06-15T09:05:26Z", "author": {"login": "PaulRMellor"}, "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -958,6 +958,12 @@ spec:\n                 authorization:\n                   type: object\n                   properties:\n+                    allowOnError:\n+                      type: boolean\n+                      description: Defines whether Kafka client should be allowed\n+                        or denied by default when the authorizer fails to query the\n+                        Open Policy Agent (for example because it is temporarily unavailable).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDU1NjEy", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430455612", "createdAt": "2020-06-15T09:06:10Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNjoxMFrOGjphzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNjoxMFrOGjphzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMzc0MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    Defines how often will the cached authorization decisions\n          \n          \n            \n                                    will expire and be reloaded from the Open Policy Agent server.\n          \n          \n            \n                                    Defines how often the cached authorization decisions\n          \n          \n            \n                                    are reloaded from the Open Policy Agent server.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440033741", "createdAt": "2020-06-15T09:06:10Z", "author": {"login": "PaulRMellor"}, "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -972,6 +978,23 @@ spec:\n                       type: boolean\n                       description: Enable or disable TLS hostname verification. Default\n                         value is `false`.\n+                    expireAfterMs:\n+                      type: integer\n+                      description: The expiration of the records kept in the local\n+                        cache to avoid querying Open Policy Agent for every request.\n+                        Defines how often will the cached authorization decisions\n+                        will expire and be reloaded from the Open Policy Agent server.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDU1Nzk2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430455796", "createdAt": "2020-06-15T09:06:26Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNjoyNlrOGjpiVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNjoyNlrOGjpiVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzMzg3Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    authorizer to avoid querying Open Policy Agent for every request\n          \n          \n            \n                                    authorizer to avoid querying the Open Policy Agent for every request", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440033877", "createdAt": "2020-06-15T09:06:26Z", "author": {"login": "PaulRMellor"}, "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -972,6 +978,23 @@ spec:\n                       type: boolean\n                       description: Enable or disable TLS hostname verification. Default\n                         value is `false`.\n+                    expireAfterMs:\n+                      type: integer\n+                      description: The expiration of the records kept in the local\n+                        cache to avoid querying Open Policy Agent for every request.\n+                        Defines how often will the cached authorization decisions\n+                        will expire and be reloaded from the Open Policy Agent server.\n+                        In milliseconds. Defaults to `3600000`.\n+                    initialCacheCapacity:\n+                      type: integer\n+                      description: Initial capacity of the local cache used by the\n+                        authorizer to avoid querying Open Policy Agent for every request", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDU2MDMy", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430456032", "createdAt": "2020-06-15T09:06:46Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNjo0NlrOGjpjDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNjo0NlrOGjpjDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzNDA2Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    authorizer to avoid querying Open Policy Agent for every request.\n          \n          \n            \n                                    authorizer to avoid querying the Open Policy Agent for every request.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440034063", "createdAt": "2020-06-15T09:06:46Z", "author": {"login": "PaulRMellor"}, "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -972,6 +978,23 @@ spec:\n                       type: boolean\n                       description: Enable or disable TLS hostname verification. Default\n                         value is `false`.\n+                    expireAfterMs:\n+                      type: integer\n+                      description: The expiration of the records kept in the local\n+                        cache to avoid querying Open Policy Agent for every request.\n+                        Defines how often will the cached authorization decisions\n+                        will expire and be reloaded from the Open Policy Agent server.\n+                        In milliseconds. Defaults to `3600000`.\n+                    initialCacheCapacity:\n+                      type: integer\n+                      description: Initial capacity of the local cache used by the\n+                        authorizer to avoid querying Open Policy Agent for every request\n+                        Defaults to `5000`.\n+                    maximumCacheSize:\n+                      type: integer\n+                      description: Maximum capacity of the local cache used by the\n+                        authorizer to avoid querying Open Policy Agent for every request.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 32}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDU2Mzc3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430456377", "createdAt": "2020-06-15T09:07:14Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNzoxNFrOGjpkIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNzoxNFrOGjpkIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzNDMzNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        \"Currently the supported types are `simple`, `keycloak`, and `opa`. \" +\n          \n          \n            \n                        \"Currently, the supported types are `simple`, `keycloak`, and `opa`. \" +", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440034336", "createdAt": "2020-06-15T09:07:14Z", "author": {"login": "PaulRMellor"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaAuthorization.java", "diffHunk": "@@ -32,8 +33,10 @@\n     private Map<String, Object> additionalProperties;\n \n     @Description(\"Authorization type. \" +\n-            \"Currently the only supported type is `simple`. \" +\n-            \"`simple` authorization type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\")\n+            \"Currently the supported types are `simple`, `keycloak`, and `opa`. \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDU2NTY1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430456565", "createdAt": "2020-06-15T09:07:29Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNzozMFrOGjpkpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowNzozMFrOGjpkpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzNDQ3MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                  description: Authorization type. Currently the supported types\n          \n          \n            \n                                  description: Authorization type. Currently, the supported types", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440034470", "createdAt": "2020-06-15T09:07:30Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -1006,10 +1029,20 @@ spec:\n                       type: string\n                       enum:\n                       - simple\n+                      - opa\n                       - keycloak\n-                      description: Authorization type. Currently the only supported\n-                        type is `simple`. `simple` authorization type uses Kafka's\n-                        `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\n+                      description: Authorization type. Currently the supported types", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDU3MTEx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430457111", "createdAt": "2020-06-15T09:08:13Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowODoxNFrOGjpmTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOTowODoxNFrOGjpmTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzNDg5NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                  description: Authorization type. Currently the supported types\n          \n          \n            \n                                  description: Authorization type. Currently, the supported types", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440034894", "createdAt": "2020-06-15T09:08:14Z", "author": {"login": "PaulRMellor"}, "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -1001,10 +1024,20 @@ spec:\n                       type: string\n                       enum:\n                       - simple\n+                      - opa\n                       - keycloak\n-                      description: Authorization type. Currently the only supported\n-                        type is `simple`. `simple` authorization type uses Kafka's\n-                        `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\n+                      description: Authorization type. Currently the supported types", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 46}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDYxMTAw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430461100", "createdAt": "2020-06-15T09:13:40Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToxMzo0MFrOGjpywg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToxMzo0MFrOGjpywg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzODA4Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    Keycloak Authorization Services for authorization. `opa` is\n          \n          \n            \n                                    using Open Policy Agent based authorization.\n          \n          \n            \n                                    Keycloak Authorization Services for authorization. `opa` \n          \n          \n            \n                                    authorization type uses Open Policy Agent authorization.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440038082", "createdAt": "2020-06-15T09:13:40Z", "author": {"login": "PaulRMellor"}, "path": "helm-charts/strimzi-kafka-operator/templates/040-Crd-kafka.yaml", "diffHunk": "@@ -1006,10 +1029,20 @@ spec:\n                       type: string\n                       enum:\n                       - simple\n+                      - opa\n                       - keycloak\n-                      description: Authorization type. Currently the only supported\n-                        type is `simple`. `simple` authorization type uses Kafka's\n-                        `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\n+                      description: Authorization type. Currently the supported types\n+                        are `simple`, `keycloak`, and `opa`. `simple` authorization\n+                        type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer`\n+                        class for authorization. `keycloak` authorization type uses\n+                        Keycloak Authorization Services for authorization. `opa` is\n+                        using Open Policy Agent based authorization.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDYxNjQ3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430461647", "createdAt": "2020-06-15T09:14:26Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToxNDoyN1rOGjp0dA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToxNDoyN1rOGjp0dA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzODUxNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    Keycloak Authorization Services for authorization. `opa` is\n          \n          \n            \n                                    using Open Policy Agent based authorization.\n          \n          \n            \n                                    Keycloak Authorization Services for authorization. `opa`\n          \n          \n            \n                                    authorization type uses Open Policy Agent authorization.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440038516", "createdAt": "2020-06-15T09:14:27Z", "author": {"login": "PaulRMellor"}, "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -1001,10 +1024,20 @@ spec:\n                       type: string\n                       enum:\n                       - simple\n+                      - opa\n                       - keycloak\n-                      description: Authorization type. Currently the only supported\n-                        type is `simple`. `simple` authorization type uses Kafka's\n-                        `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\n+                      description: Authorization type. Currently the supported types\n+                        are `simple`, `keycloak`, and `opa`. `simple` authorization\n+                        type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer`\n+                        class for authorization. `keycloak` authorization type uses\n+                        Keycloak Authorization Services for authorization. `opa` is\n+                        using Open Policy Agent based authorization.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDYxOTM5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430461939", "createdAt": "2020-06-15T09:14:49Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToxNDo0OVrOGjp1VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToxNDo0OVrOGjp1VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDAzODc0MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                  description: The URL used to connect to the Open Policy Agent\n          \n          \n            \n                                  description: (Required) The URL used to connect to the Open Policy Agent", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440038741", "createdAt": "2020-06-15T09:14:49Z", "author": {"login": "PaulRMellor"}, "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -1001,10 +1024,20 @@ spec:\n                       type: string\n                       enum:\n                       - simple\n+                      - opa\n                       - keycloak\n-                      description: Authorization type. Currently the only supported\n-                        type is `simple`. `simple` authorization type uses Kafka's\n-                        `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\n+                      description: Authorization type. Currently the supported types\n+                        are `simple`, `keycloak`, and `opa`. `simple` authorization\n+                        type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer`\n+                        class for authorization. `keycloak` authorization type uses\n+                        Keycloak Authorization Services for authorization. `opa` is\n+                        using Open Policy Agent based authorization.\n+                    url:\n+                      type: string\n+                      example: http://opa:8181/v1/data/kafka/authz/allow\n+                      description: The URL used to connect to the Open Policy Agent", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 55}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDY2MDEw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430466010", "createdAt": "2020-06-15T09:20:07Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToyMDowN1rOGjqBlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQwOToyMDowN1rOGjqBlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDA0MTg3Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    by the authorizer. This option is required.\n          \n          \n            \n                                    by the authorizer.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#discussion_r440041876", "createdAt": "2020-06-15T09:20:07Z", "author": {"login": "PaulRMellor"}, "path": "install/cluster-operator/040-Crd-kafka.yaml", "diffHunk": "@@ -1001,10 +1024,20 @@ spec:\n                       type: string\n                       enum:\n                       - simple\n+                      - opa\n                       - keycloak\n-                      description: Authorization type. Currently the only supported\n-                        type is `simple`. `simple` authorization type uses Kafka's\n-                        `kafka.security.auth.SimpleAclAuthorizer` class for authorization.\n+                      description: Authorization type. Currently the supported types\n+                        are `simple`, `keycloak`, and `opa`. `simple` authorization\n+                        type uses Kafka's `kafka.security.auth.SimpleAclAuthorizer`\n+                        class for authorization. `keycloak` authorization type uses\n+                        Keycloak Authorization Services for authorization. `opa` is\n+                        using Open Policy Agent based authorization.\n+                    url:\n+                      type: string\n+                      example: http://opa:8181/v1/data/kafka/authz/allow\n+                      description: The URL used to connect to the Open Policy Agent\n+                        server. The URL has to include the policy which will be queried\n+                        by the authorizer. This option is required.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNDY2NjU0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3192#pullrequestreview-430466654", "createdAt": "2020-06-15T09:20:59Z", "commit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dfe31e05b6d365c802c3cb7f1ae1ffcae6eb833", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/0dfe31e05b6d365c802c3cb7f1ae1ffcae6eb833", "committedDate": "2020-06-15T10:12:38Z", "message": "Rebase to Helm3\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c65a17f52322eb4eddf29f6b88134a6e915ac79c", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/c65a17f52322eb4eddf29f6b88134a6e915ac79c", "committedDate": "2020-06-15T08:33:44Z", "message": "Regen the docs \ud83d\ude44\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}, "afterCommit": {"oid": "0dfe31e05b6d365c802c3cb7f1ae1ffcae6eb833", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/0dfe31e05b6d365c802c3cb7f1ae1ffcae6eb833", "committedDate": "2020-06-15T10:12:38Z", "message": "Rebase to Helm3\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20ff87af05a36be7468055d66004216832d5d4f9", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/20ff87af05a36be7468055d66004216832d5d4f9", "committedDate": "2020-06-15T10:17:00Z", "message": "Apply suggestions from code review\r\n\r\nSigned-off-by: Jakub Scholz <www@scholzj.com>\r\n\r\nCo-authored-by: prmellor <pmellor@redhat.com>\n\nCo-authored-by: PaulRMellor <47596553+PaulRMellor@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd424bd519df2cfcca27363a28a9f2d197c03c93", "author": {"user": {"login": "scholzj", "name": "Jakub Scholz"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/fd424bd519df2cfcca27363a28a9f2d197c03c93", "committedDate": "2020-06-15T10:20:32Z", "message": "Refresh generated files after suggestions\n\nSigned-off-by: Jakub Scholz <www@scholzj.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1544, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}