{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1Mzg0NTU2", "number": 3486, "title": "[DOC] Remove the old certificates after a renewal of Cluster CA", "bodyText": "Signed-off-by: prmellor pmellor@redhat.com\nDocumentation\nAdd a note to delete old certificates when manually renewing certificates.\nUpdate to the Renewing CA certificates manually procedure in the Using Guide\nChecklist\nPlease go through this checklist and make sure all applicable tasks have been done\n\n Write tests\n Make sure all tests pass\n Update documentation\n Check RBAC rights for Kubernetes / OpenShift roles\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging\n Update CHANGELOG.md\n Supply screenshots for visual changes, such as Grafana dashboards", "createdAt": "2020-08-10T09:27:49Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3486", "merged": true, "mergeCommit": {"oid": "f9e37701f97d7489e9f2f9b5fb022b3a213b2b76"}, "closed": true, "closedAt": "2020-08-14T11:40:59Z", "author": {"login": "PaulRMellor"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9ev9eAH2gAyNDY1Mzg0NTU2OjMzYzg3MjQ0MmZmMzBjZDMwYjQ1MWRhNDZkMWU5NWIzYzczODgyZDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-uXFXAFqTQ2NzMyODM5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "33c872442ff30cd30b451da46d1e95b3c73882d3", "author": {"user": {"login": "PaulRMellor", "name": null}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/33c872442ff30cd30b451da46d1e95b3c73882d3", "committedDate": "2020-08-10T09:25:00Z", "message": "[DOC] Remove the old certificates after a renewal of Cluster CA\n\nSigned-off-by: prmellor <pmellor@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0MDc5NDg0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3486#pullrequestreview-464079484", "createdAt": "2020-08-10T09:29:50Z", "commit": {"oid": "33c872442ff30cd30b451da46d1e95b3c73882d3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwOToyOTo1MFrOG-Hbrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwOToyOTo1MFrOG-Hbrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzc4NjY3MA==", "bodyText": "Do we want a command here?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3486#discussion_r467786670", "createdAt": "2020-08-10T09:29:50Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/security/proc-renewing-ca-certs-manually.adoc", "diffHunk": "@@ -27,16 +30,21 @@ A renewed certificate uses the same private key as the old certificate.\n \u00a6Annotate command\n \n \u00a6Cluster CA\n-\u00a6_<cluster-name>_-cluster-ca-cert\n-m\u00a6kubectl annotate secret _<cluster-name>_-cluster-ca-cert strimzi.io/force-renew=true\n+\u00a6_KAFKA-CLUSTER-NAME_-cluster-ca-cert\n+m\u00a6kubectl annotate secret _KAFKA-CLUSTER-NAME_-cluster-ca-cert strimzi.io/force-renew=true\n \n \u00a6Clients CA\n-\u00a6_<cluster-name>_-clients-ca-cert\n-m\u00a6kubectl annotate secret _<cluster-name>_-clients-ca-cert strimzi.io/force-renew=true\n+\u00a6_KAFKA-CLUSTER-NAME_-clients-ca-cert\n+m\u00a6kubectl annotate secret _KAFKA-CLUSTER-NAME_-clients-ca-cert strimzi.io/force-renew=true\n \n |===\n \n-At the next reconciliation the Cluster Operator will generate a new CA certificate for the `Secret` that you annotated. \n+. Delete old certificates from the Secret.\n++\n+When components are using the new certificates, older certificates might still be active.\n+Delete the old certificates to remove any potential security risk.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33c872442ff30cd30b451da46d1e95b3c73882d3"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NTgzMzI1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3486#pullrequestreview-464583325", "createdAt": "2020-08-10T20:58:26Z", "commit": {"oid": "33c872442ff30cd30b451da46d1e95b3c73882d3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMDo1ODoyN1rOG-fkVg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMDo1ODoyN1rOG-fkVg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE4MjEwMg==", "bodyText": "I think this should only at the end of the file: before additional resources. Or it should be embedded as a NOTE: or something. Because this should be done only after the renewal etc.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3486#discussion_r468182102", "createdAt": "2020-08-10T20:58:27Z", "author": {"login": "scholzj"}, "path": "documentation/modules/security/proc-renewing-ca-certs-manually.adoc", "diffHunk": "@@ -27,16 +30,21 @@ A renewed certificate uses the same private key as the old certificate.\n \u00a6Annotate command\n \n \u00a6Cluster CA\n-\u00a6_<cluster-name>_-cluster-ca-cert\n-m\u00a6kubectl annotate secret _<cluster-name>_-cluster-ca-cert strimzi.io/force-renew=true\n+\u00a6_KAFKA-CLUSTER-NAME_-cluster-ca-cert\n+m\u00a6kubectl annotate secret _KAFKA-CLUSTER-NAME_-cluster-ca-cert strimzi.io/force-renew=true\n \n \u00a6Clients CA\n-\u00a6_<cluster-name>_-clients-ca-cert\n-m\u00a6kubectl annotate secret _<cluster-name>_-clients-ca-cert strimzi.io/force-renew=true\n+\u00a6_KAFKA-CLUSTER-NAME_-clients-ca-cert\n+m\u00a6kubectl annotate secret _KAFKA-CLUSTER-NAME_-clients-ca-cert strimzi.io/force-renew=true\n \n |===\n \n-At the next reconciliation the Cluster Operator will generate a new CA certificate for the `Secret` that you annotated. \n+. Delete old certificates from the Secret.\n++\n+When components are using the new certificates, older certificates might still be active.\n+Delete the old certificates to remove any potential security risk.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33c872442ff30cd30b451da46d1e95b3c73882d3"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0OTA4Njg2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3486#pullrequestreview-464908686", "createdAt": "2020-08-11T09:41:41Z", "commit": {"oid": "33c872442ff30cd30b451da46d1e95b3c73882d3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5da6598dffac14c338161c2ac90490688f3bec29", "author": {"user": {"login": "PaulRMellor", "name": null}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/5da6598dffac14c338161c2ac90490688f3bec29", "committedDate": "2020-08-13T10:57:16Z", "message": "review edits JS\n\nSigned-off-by: prmellor <pmellor@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3MTQxODY0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3486#pullrequestreview-467141864", "createdAt": "2020-08-13T21:25:39Z", "commit": {"oid": "5da6598dffac14c338161c2ac90490688f3bec29"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3MzI4Mzk1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3486#pullrequestreview-467328395", "createdAt": "2020-08-14T06:10:14Z", "commit": {"oid": "5da6598dffac14c338161c2ac90490688f3bec29"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1119, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}