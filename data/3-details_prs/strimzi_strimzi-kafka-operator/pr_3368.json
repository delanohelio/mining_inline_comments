{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NjE2NTEx", "number": 3368, "title": "Add option to select replica movement strategy for rebalances", "bodyText": "Type of change\nEnhancement\nDescription\nThis adds the option to specify the replicaMovementStrategies for a cluster rebalance. By default BaseReplicaMovementStrategy is used, which randomly sorts the replica movements but other strategies are available. The strategies can be specified in a comma separated list to form a priority chain. If a strategy earlier in the list finds two replica movements equivalent then these can be passed to the next strategy down to determine an order.\nChecklist\n\n Make sure all tests pass\n Update documentation\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Update CHANGELOG.md", "createdAt": "2020-07-23T10:28:16Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368", "merged": true, "mergeCommit": {"oid": "85aa74e75f701ff2f24d12a95913d731d1a70b33"}, "closed": true, "closedAt": "2020-08-01T09:49:02Z", "author": {"login": "tomncooper"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc3uRjDgFqTQ1NDA2NTA0NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6WLhPgFqTQ1OTI3NTU0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MDY1MDQ1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#pullrequestreview-454065045", "createdAt": "2020-07-23T12:06:36Z", "commit": {"oid": "b3cc8a836ff4d67c1a599ac980ca55aa295c70ed"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxMjowNjozNlrOG2Hh1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxMjowNjozNlrOG2Hh1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTM5OTYzNg==", "bodyText": "do you think we could use a List<String> ? the order should be preserved when serialized/deserialized right? or am I wrong?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r459399636", "createdAt": "2020-07-23T12:06:36Z", "author": {"login": "ppatierno"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaRebalanceSpec.java", "diffHunk": "@@ -41,6 +41,7 @@\n     private int concurrentIntraBrokerPartitionMovements;\n     private int concurrentLeaderMovements;\n     private long replicationThrottle;\n+    private String replicaMovementStrategies;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3cc8a836ff4d67c1a599ac980ca55aa295c70ed"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b3cc8a836ff4d67c1a599ac980ca55aa295c70ed", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b3cc8a836ff4d67c1a599ac980ca55aa295c70ed", "committedDate": "2020-07-23T10:27:54Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}, "afterCommit": {"oid": "1878bb85d9927fe3d205c2d73480e6f0168d75d8", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1878bb85d9927fe3d205c2d73480e6f0168d75d8", "committedDate": "2020-07-23T16:11:08Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MzA1MjA4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#pullrequestreview-454305208", "createdAt": "2020-07-23T16:31:19Z", "commit": {"oid": "1878bb85d9927fe3d205c2d73480e6f0168d75d8"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MzA5OTM0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#pullrequestreview-454309934", "createdAt": "2020-07-23T16:37:35Z", "commit": {"oid": "1878bb85d9927fe3d205c2d73480e6f0168d75d8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MzYzMzM0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#pullrequestreview-454363334", "createdAt": "2020-07-23T17:49:04Z", "commit": {"oid": "1878bb85d9927fe3d205c2d73480e6f0168d75d8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNzo0OTowNFrOG2VNVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QxNzo0OTowNFrOG2VNVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTYyMzc2NA==", "bodyText": "Not a native speaker ... but totally random sounds very informal for documentation. I also doubt it is really random - i.e. randomizing the list of movements ... I guess it might be just as it is generated by some algo or something like that I guess. Wouldn't something like By default BaseReplicaMovementStrategy is used, which moves the replicas without any specific order. be a bit better?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r459623764", "createdAt": "2020-07-23T17:49:04Z", "author": {"login": "scholzj"}, "path": "api/src/main/java/io/strimzi/api/kafka/model/KafkaRebalanceSpec.java", "diffHunk": "@@ -118,6 +119,15 @@ public void setReplicationThrottle(long bandwidth) {\n         this.replicationThrottle = bandwidth;\n     }\n \n+    @Description(\"A list of strategies used to determine the execution order for the generated optimization proposal. By default BaseReplicaMovementStrategy is used, which is totally random.\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1878bb85d9927fe3d205c2d73480e6f0168d75d8"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1878bb85d9927fe3d205c2d73480e6f0168d75d8", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1878bb85d9927fe3d205c2d73480e6f0168d75d8", "committedDate": "2020-07-23T16:11:08Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}, "afterCommit": {"oid": "a742c5e8dc84e50c5e8fd10ebbab66a2f16e3c12", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a742c5e8dc84e50c5e8fd10ebbab66a2f16e3c12", "committedDate": "2020-07-24T09:10:44Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a742c5e8dc84e50c5e8fd10ebbab66a2f16e3c12", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a742c5e8dc84e50c5e8fd10ebbab66a2f16e3c12", "committedDate": "2020-07-24T09:10:44Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}, "afterCommit": {"oid": "3f4b2da05024220ed30e64b3bb8ed0f6986046fd", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3f4b2da05024220ed30e64b3bb8ed0f6986046fd", "committedDate": "2020-07-24T09:41:59Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2NzgyMjYx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#pullrequestreview-456782261", "createdAt": "2020-07-28T16:00:09Z", "commit": {"oid": "3f4b2da05024220ed30e64b3bb8ed0f6986046fd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f4b2da05024220ed30e64b3bb8ed0f6986046fd", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3f4b2da05024220ed30e64b3bb8ed0f6986046fd", "committedDate": "2020-07-24T09:41:59Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}, "afterCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/82635e5bcc77c670fb19b51e7864140be6dc1326", "committedDate": "2020-07-29T11:17:29Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4NTQzMzQw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#pullrequestreview-458543340", "createdAt": "2020-07-30T16:00:51Z", "commit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMFQxNjowMDo1MlrOG5pnzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxMzo0ODozMFrOG6JN7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzEwMzk1MA==", "bodyText": "Add an introduction to the module:\nYou can adjust several performance tuning options for cluster rebalances. These options control how partition and leadership movements in a rebalance are executed, as well as the bandwidth that is allocated to a rebalance operation.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463103950", "createdAt": "2020-07-30T16:00:52Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -6,6 +6,8 @@\n \n = Rebalance performance tuning overview \n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzU1MTA0MA==", "bodyText": "Please can you rephrase this paragraph as follows\nOptimization proposals are comprised of separate partition reassignment commands. When you approve a proposal, the Cruise Control server applies these commands to the Kafka cluster.\nA partition reassignment command consists of either of the following types of operations:", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463551040", "createdAt": "2020-07-31T11:13:23Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -6,6 +6,8 @@\n \n = Rebalance performance tuning overview \n \n+== Partition reassignment commands\n+\n When an xref:con-optimization-proposals-{context}[optimization proposal] is xref:proc-approving-optimization-proposal-{context}[approved], the partition reassignment commands that comprise the proposal are applied to the Kafka cluster by the Cruise Control server. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzU1NjYzMA==", "bodyText": "Please rephrase the first sentence:\nCruise Control issues partition reassignment commands to the Kafka cluster in batches.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463556630", "createdAt": "2020-07-31T11:28:28Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxNTUxOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            == Rebalance tuning options\n          \n          \n            \n            [discrete]\n          \n          \n            \n            == Rebalance tuning options", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463615519", "createdAt": "2020-07-31T13:37:38Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.\n+Cruise Control provides several other replica movement strategies that can be applied to the optimization proposals:\n+\n+* `PrioritizeSmallReplicaMovementStrategy`: Order reassignments in order of ascending size.\n+* `PrioritizeLargeReplicaMovementStrategy`: Order reassignments in order of descending size. \n+* `PostponeUrpReplicaMovementStrategy`: Prioritise reassignments for replicas whose partition have no out-of-sync replicas.\n+\n+Cruise Control can apply these strategies in a chain. \n+The strategy at the top of the chain will attempt to compare two reassignments using its internal logic, if it finds them equivalent then it will pass them onto to the next strategy in the chain for it to decide the order and so on. \n+\n+== Rebalance tuning options", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxNTY2Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            == Replica movement strategies\n          \n          \n            \n            [discrete]\n          \n          \n            \n            == Replica movement strategies", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463615666", "createdAt": "2020-07-31T13:37:55Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxNzk2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n          \n          \n            \n            Cluster rebalance performance is also influenced by the _replica movement strategy_ that is applied to the batches of partition reassignment commands.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463617961", "createdAt": "2020-07-31T13:41:57Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxODIxMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n          \n          \n            \n            By default, Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463618210", "createdAt": "2020-07-31T13:42:25Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxODQ1MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.\n          \n          \n            \n            However, if there are some very large partition reassignments early in the proposal, this strategy can slow down the application of the other reassignments.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463618451", "createdAt": "2020-07-31T13:42:53Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxODYyNw==", "bodyText": "New paragraph", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463618627", "createdAt": "2020-07-31T13:43:11Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxODQ1MQ=="}, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxODgwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Cruise Control provides several other replica movement strategies that can be applied to the optimization proposals:\n          \n          \n            \n            Cruise Control provides three alternative replica movement strategies that can be applied to optimization proposals:", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463618806", "createdAt": "2020-07-31T13:43:29Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.\n+Cruise Control provides several other replica movement strategies that can be applied to the optimization proposals:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxOTA5Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * `PostponeUrpReplicaMovementStrategy`: Prioritise reassignments for replicas whose partition have no out-of-sync replicas.\n          \n          \n            \n            * `PostponeUrpReplicaMovementStrategy`: Prioritize reassignments for replicas whose partitions have no out-of-sync replicas.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463619097", "createdAt": "2020-07-31T13:44:02Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.\n+Cruise Control provides several other replica movement strategies that can be applied to the optimization proposals:\n+\n+* `PrioritizeSmallReplicaMovementStrategy`: Order reassignments in order of ascending size.\n+* `PrioritizeLargeReplicaMovementStrategy`: Order reassignments in order of descending size. \n+* `PostponeUrpReplicaMovementStrategy`: Prioritise reassignments for replicas whose partition have no out-of-sync replicas.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxOTMyOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Cruise Control can apply these strategies in a chain. \n          \n          \n            \n            These strategies can be configured as a sequence.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463619328", "createdAt": "2020-07-31T13:44:27Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.\n+Cruise Control provides several other replica movement strategies that can be applied to the optimization proposals:\n+\n+* `PrioritizeSmallReplicaMovementStrategy`: Order reassignments in order of ascending size.\n+* `PrioritizeLargeReplicaMovementStrategy`: Order reassignments in order of descending size. \n+* `PostponeUrpReplicaMovementStrategy`: Prioritise reassignments for replicas whose partition have no out-of-sync replicas.\n+\n+Cruise Control can apply these strategies in a chain. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYxOTk0OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            The strategy at the top of the chain will attempt to compare two reassignments using its internal logic, if it finds them equivalent then it will pass them onto to the next strategy in the chain for it to decide the order and so on. \n          \n          \n            \n            The first strategy attempts to compare two partition reassignments using its internal logic. \n          \n          \n            \n            If the reassignments are equivalent, then it passes them to the next strategy to decide the order, and so on.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463619948", "createdAt": "2020-07-31T13:45:33Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.\n+Cruise Control provides several other replica movement strategies that can be applied to the optimization proposals:\n+\n+* `PrioritizeSmallReplicaMovementStrategy`: Order reassignments in order of ascending size.\n+* `PrioritizeLargeReplicaMovementStrategy`: Order reassignments in order of descending size. \n+* `PostponeUrpReplicaMovementStrategy`: Prioritise reassignments for replicas whose partition have no out-of-sync replicas.\n+\n+Cruise Control can apply these strategies in a chain. \n+The strategy at the top of the chain will attempt to compare two reassignments using its internal logic, if it finds them equivalent then it will pass them onto to the next strategy in the chain for it to decide the order and so on. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYyMDYyNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            You can set these _tuning_ options at either the xref:ref-cruise-control-configuration-{context}[Cruise Control server] or xref:proc-generating-optimization-proposals-{context}[optimization proposal] levels:\n          \n          \n            \n            You can set these tuning options at either the xref:ref-cruise-control-configuration-{context}[Cruise Control server] or xref:proc-generating-optimization-proposals-{context}[optimization proposal] levels:", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463620624", "createdAt": "2020-07-31T13:46:46Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.\n+Cruise Control provides several other replica movement strategies that can be applied to the optimization proposals:\n+\n+* `PrioritizeSmallReplicaMovementStrategy`: Order reassignments in order of ascending size.\n+* `PrioritizeLargeReplicaMovementStrategy`: Order reassignments in order of descending size. \n+* `PostponeUrpReplicaMovementStrategy`: Prioritise reassignments for replicas whose partition have no out-of-sync replicas.\n+\n+Cruise Control can apply these strategies in a chain. \n+The strategy at the top of the chain will attempt to compare two reassignments using its internal logic, if it finds them equivalent then it will pass them onto to the next strategy in the chain for it to decide the order and so on. \n+\n+== Rebalance tuning options\n+\n+Cruise Control provides several configuration options for tuning the rebalance parameters discussed above.\n You can set these _tuning_ options at either the xref:ref-cruise-control-configuration-{context}[Cruise Control server] or xref:proc-generating-optimization-proposals-{context}[optimization proposal] levels:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYyMTMxMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             The list of strategies (in priority order) used to determine the execution order for generated proposals. A comma separated string for server and a YAML array for KafkaRebalance. \n          \n          \n            \n             The list of strategies (in priority order) used to determine the order in which partition reassignment commands are executed for generated proposals. Use a comma separated string for server and a YAML array for `KafkaRebalance` resources.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463621313", "createdAt": "2020-07-31T13:48:01Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.\n+Cruise Control provides several other replica movement strategies that can be applied to the optimization proposals:\n+\n+* `PrioritizeSmallReplicaMovementStrategy`: Order reassignments in order of ascending size.\n+* `PrioritizeLargeReplicaMovementStrategy`: Order reassignments in order of descending size. \n+* `PostponeUrpReplicaMovementStrategy`: Prioritise reassignments for replicas whose partition have no out-of-sync replicas.\n+\n+Cruise Control can apply these strategies in a chain. \n+The strategy at the top of the chain will attempt to compare two reassignments using its internal logic, if it finds them equivalent then it will pass them onto to the next strategy in the chain for it to decide the order and so on. \n+\n+== Rebalance tuning options\n+\n+Cruise Control provides several configuration options for tuning the rebalance parameters discussed above.\n You can set these _tuning_ options at either the xref:ref-cruise-control-configuration-{context}[Cruise Control server] or xref:proc-generating-optimization-proposals-{context}[optimization proposal] levels:\n \n * The Cruise Control server setting can be set in the Kafka custom resource under `Kafka.spec.kafka.spec.cruiseControl.spec`. \n * The individual rebalance performance configurations can be set under `KafkaRebalance.spec`. \n \n The relevant configurations are summarised below:\n \n-|==========================================================================================================================\n-| Server Configuration                              | KafkaRebalance Configuration            | Description | Default Value \n+|============================================================================================================================\n+| Server / KafkaRebalance Configuration                | Description                                          | Default Value\n \n-| `num.concurrent.partition.movements.per.broker`   | `concurrentPartitionMovementsPerBroker` | \n-  The maximum number of inter-broker partition movements in each partition reassignment batch | 5\n+| `num.concurrent.partition.movements.per.broker`   .2+| \n+  The maximum number of inter-broker partition movements in each partition reassignment batch              .2+| 5 \n+| `concurrentPartitionMovementsPerBroker` \n \n-| `num.concurrent.intra.broker.partition.movements` | `concurrentIntraBrokerPartitionMovements`     | \n-  The maximum number of intra-broker partition movements in each partition reassignment batch | 2\n+| `num.concurrent.intra.broker.partition.movements` .2+| \n+  The maximum number of intra-broker partition movements in each partition reassignment batch              .2+| 2\n+| `concurrentIntraBrokerPartitionMovements`\n \n+| `num.concurrent.leader.movements`                 .2+| \n+  The maximum number of partition leadership changes in each partition reassignment batch                  .2+| 1000        \n+| `concurrentLeaderMovements`              \n \n-| `num.concurrent.leader.movements`                 | `concurrentLeaderMovements`             | \n-  The maximum number of partition leadership changes in each partition reassignment batch     | 1000        \n+| `default.replication.throttle`                    .2+|\n+  The bandwidth (in bytes per second) to be assigned to the reassigning of partitions                      .2+| No Limit    \n+| `replicationThrottle`\n \n+| `default.replica.movement.strategies`             .2+| \n+ The list of strategies (in priority order) used to determine the execution order for generated proposals. A comma separated string for server and a YAML array for KafkaRebalance. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzYyMTYxNA==", "bodyText": "It might be best to list all the strategies here and mark one as the default.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#discussion_r463621614", "createdAt": "2020-07-31T13:48:30Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-rebalance-performance.adoc", "diffHunk": "@@ -17,32 +19,56 @@ These commands consist of two types of operations:\n \n Cruise Control batches up these reassignment commands and issues them to the Kafka cluster. \n The performance of the cluster during the rebalance is affected by the number of each type of movement contained in each batch.\n-Cruise Control provides several configuration options for tuning a cluster rebalance for optimal performance. \n \n+== Replica movement strategies\n+\n+Another factor that influences the rebalance performance is the _replica movement strategy_ applied to the batches of partition reassignment commands. \n+By default Cruise Control uses the `BaseReplicaMovementStrategy`, which simply applies the commands in the order they were generated.\n+However, if there are some very large reassignments early on in the proposal, then this could slow down the application of the other reassignments.\n+Cruise Control provides several other replica movement strategies that can be applied to the optimization proposals:\n+\n+* `PrioritizeSmallReplicaMovementStrategy`: Order reassignments in order of ascending size.\n+* `PrioritizeLargeReplicaMovementStrategy`: Order reassignments in order of descending size. \n+* `PostponeUrpReplicaMovementStrategy`: Prioritise reassignments for replicas whose partition have no out-of-sync replicas.\n+\n+Cruise Control can apply these strategies in a chain. \n+The strategy at the top of the chain will attempt to compare two reassignments using its internal logic, if it finds them equivalent then it will pass them onto to the next strategy in the chain for it to decide the order and so on. \n+\n+== Rebalance tuning options\n+\n+Cruise Control provides several configuration options for tuning the rebalance parameters discussed above.\n You can set these _tuning_ options at either the xref:ref-cruise-control-configuration-{context}[Cruise Control server] or xref:proc-generating-optimization-proposals-{context}[optimization proposal] levels:\n \n * The Cruise Control server setting can be set in the Kafka custom resource under `Kafka.spec.kafka.spec.cruiseControl.spec`. \n * The individual rebalance performance configurations can be set under `KafkaRebalance.spec`. \n \n The relevant configurations are summarised below:\n \n-|==========================================================================================================================\n-| Server Configuration                              | KafkaRebalance Configuration            | Description | Default Value \n+|============================================================================================================================\n+| Server / KafkaRebalance Configuration                | Description                                          | Default Value\n \n-| `num.concurrent.partition.movements.per.broker`   | `concurrentPartitionMovementsPerBroker` | \n-  The maximum number of inter-broker partition movements in each partition reassignment batch | 5\n+| `num.concurrent.partition.movements.per.broker`   .2+| \n+  The maximum number of inter-broker partition movements in each partition reassignment batch              .2+| 5 \n+| `concurrentPartitionMovementsPerBroker` \n \n-| `num.concurrent.intra.broker.partition.movements` | `concurrentIntraBrokerPartitionMovements`     | \n-  The maximum number of intra-broker partition movements in each partition reassignment batch | 2\n+| `num.concurrent.intra.broker.partition.movements` .2+| \n+  The maximum number of intra-broker partition movements in each partition reassignment batch              .2+| 2\n+| `concurrentIntraBrokerPartitionMovements`\n \n+| `num.concurrent.leader.movements`                 .2+| \n+  The maximum number of partition leadership changes in each partition reassignment batch                  .2+| 1000        \n+| `concurrentLeaderMovements`              \n \n-| `num.concurrent.leader.movements`                 | `concurrentLeaderMovements`             | \n-  The maximum number of partition leadership changes in each partition reassignment batch     | 1000        \n+| `default.replication.throttle`                    .2+|\n+  The bandwidth (in bytes per second) to be assigned to the reassigning of partitions                      .2+| No Limit    \n+| `replicationThrottle`\n \n+| `default.replica.movement.strategies`             .2+| \n+ The list of strategies (in priority order) used to determine the execution order for generated proposals. A comma separated string for server and a YAML array for KafkaRebalance. \n+.2+| `BaseReplicaMovementStrategy`\n+| `replicaMovementStrategies`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326"}, "originalPosition": 69}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa3dec825953413d4c55dfbedfde192dae8cb40a", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/fa3dec825953413d4c55dfbedfde192dae8cb40a", "committedDate": "2020-07-31T15:28:23Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "82635e5bcc77c670fb19b51e7864140be6dc1326", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/82635e5bcc77c670fb19b51e7864140be6dc1326", "committedDate": "2020-07-29T11:17:29Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}, "afterCommit": {"oid": "fa3dec825953413d4c55dfbedfde192dae8cb40a", "author": {"user": {"login": "tomncooper", "name": "Thomas Cooper"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/fa3dec825953413d4c55dfbedfde192dae8cb40a", "committedDate": "2020-07-31T15:28:23Z", "message": "Added option to select replica movement strategy\n\nSigned-off-by: Thomas Cooper <tcooper@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MjcwMjcz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#pullrequestreview-459270273", "createdAt": "2020-07-31T15:36:33Z", "commit": {"oid": "fa3dec825953413d4c55dfbedfde192dae8cb40a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5Mjc1NTQw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3368#pullrequestreview-459275540", "createdAt": "2020-07-31T15:44:11Z", "commit": {"oid": "fa3dec825953413d4c55dfbedfde192dae8cb40a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1372, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}