{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyNjg2MjI5", "number": 3897, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwODo1MToxMFrOEzszcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMTowMzoxN1rOE0jJkg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNjQ2ODk5OnYy", "diffSide": "RIGHT", "path": "examples/metrics/prometheus-install/strimzi-pod-monitor.yaml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwODo1MToxMFrOHrF_Hw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxODoyODo0NFrOHsQyOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk0ODg5NQ==", "bodyText": "I'm not sure if this change was intended or not - but all the other example files use myproject. So I think we should try to keep it.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3897#discussion_r514948895", "createdAt": "2020-10-30T08:51:10Z", "author": {"login": "scholzj"}, "path": "examples/metrics/prometheus-install/strimzi-pod-monitor.yaml", "diffHunk": "@@ -10,7 +10,7 @@ spec:\n       strimzi.io/kind: cluster-operator\n   namespaceSelector:\n     matchNames:\n-      - myproject\n+      - my-project", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8045546b5a4f5937968ec958070e13685c67b152"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE3NDM5NQ==", "bodyText": "gah this was my mistake. I'll correct it. and update the regex matching as requested below.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3897#discussion_r516174395", "createdAt": "2020-11-02T18:28:44Z", "author": {"login": "brokenjacobs"}, "path": "examples/metrics/prometheus-install/strimzi-pod-monitor.yaml", "diffHunk": "@@ -10,7 +10,7 @@ spec:\n       strimzi.io/kind: cluster-operator\n   namespaceSelector:\n     matchNames:\n-      - myproject\n+      - my-project", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk0ODg5NQ=="}, "originalCommit": {"oid": "8045546b5a4f5937968ec958070e13685c67b152"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNjUyNDA1OnYy", "diffSide": "RIGHT", "path": "examples/metrics/prometheus-install/strimzi-pod-monitor.yaml", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQwOTowNzo1NlrOHrGgbg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNTo1ODowMlrOHvI6Hw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk1NzQyMg==", "bodyText": "why adding the strimzi_ prefix? the strimzi label matched by the regex should already have it. Doesn't it add the prefix twice? I haven't an installation with Prometheus handy, can you verify?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3897#discussion_r514957422", "createdAt": "2020-10-30T09:07:56Z", "author": {"login": "ppatierno"}, "path": "examples/metrics/prometheus-install/strimzi-pod-monitor.yaml", "diffHunk": "@@ -63,14 +63,14 @@ spec:\n         values: [\"Kafka\", \"KafkaConnect\"]\n   namespaceSelector:\n     matchNames:\n-      - myproject\n+      - my-project\n   podMetricsEndpoints:\n   - path: /metrics\n     port: tcp-prometheus\n     relabelings:\n     - separator: ;\n-      regex: __meta_kubernetes_pod_label_(.+)\n-      replacement: $1\n+      regex: __meta_kubernetes_pod_label_strimzi_(.+)\n+      replacement: strimzi_$1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8045546b5a4f5937968ec958070e13685c67b152"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjE3MzkxNg==", "bodyText": "without that the regex matches everything after strimzi_ and your metrics labels all begin with io_ instead of strimzi_io_... $1 references the capture group in the regex between the (). This could be cleaned up by just moving the matching group left parenthesis. I can do that if you think it is necessary.\nEDIT: Did that.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3897#discussion_r516173916", "createdAt": "2020-11-02T18:27:54Z", "author": {"login": "brokenjacobs"}, "path": "examples/metrics/prometheus-install/strimzi-pod-monitor.yaml", "diffHunk": "@@ -63,14 +63,14 @@ spec:\n         values: [\"Kafka\", \"KafkaConnect\"]\n   namespaceSelector:\n     matchNames:\n-      - myproject\n+      - my-project\n   podMetricsEndpoints:\n   - path: /metrics\n     port: tcp-prometheus\n     relabelings:\n     - separator: ;\n-      regex: __meta_kubernetes_pod_label_(.+)\n-      replacement: $1\n+      regex: __meta_kubernetes_pod_label_strimzi_(.+)\n+      replacement: strimzi_$1", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk1NzQyMg=="}, "originalCommit": {"oid": "8045546b5a4f5937968ec958070e13685c67b152"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE5MTA3MQ==", "bodyText": "@brokenjacobs any update on this?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3897#discussion_r519191071", "createdAt": "2020-11-07T15:58:02Z", "author": {"login": "ppatierno"}, "path": "examples/metrics/prometheus-install/strimzi-pod-monitor.yaml", "diffHunk": "@@ -63,14 +63,14 @@ spec:\n         values: [\"Kafka\", \"KafkaConnect\"]\n   namespaceSelector:\n     matchNames:\n-      - myproject\n+      - my-project\n   podMetricsEndpoints:\n   - path: /metrics\n     port: tcp-prometheus\n     relabelings:\n     - separator: ;\n-      regex: __meta_kubernetes_pod_label_(.+)\n-      replacement: $1\n+      regex: __meta_kubernetes_pod_label_strimzi_(.+)\n+      replacement: strimzi_$1", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk1NzQyMg=="}, "originalCommit": {"oid": "8045546b5a4f5937968ec958070e13685c67b152"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNTM3Mjk4OnYy", "diffSide": "RIGHT", "path": "examples/metrics/prometheus-install/strimzi-pod-monitor.yaml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMTowMzoxN1rOHsVizw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQyMTowMzoxN1rOHsVizw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjI1MjM2Nw==", "bodyText": "at this point I would match strimzi_io_.+", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3897#discussion_r516252367", "createdAt": "2020-11-02T21:03:17Z", "author": {"login": "ppatierno"}, "path": "examples/metrics/prometheus-install/strimzi-pod-monitor.yaml", "diffHunk": "@@ -69,7 +69,7 @@ spec:\n     port: tcp-prometheus\n     relabelings:\n     - separator: ;\n-      regex: __meta_kubernetes_pod_label_(.+)\n+      regex: __meta_kubernetes_pod_label_(strimzi_.+)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35d0d92e1ab81c6b27c71406dca06613b6198831"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 991, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}