{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA2MjU3Mjg2", "number": 2865, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwNjoyOTo0NVrOD0EXwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwNjoyOTo0NVrOD0EXwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1OTI0MTYxOnYy", "diffSide": "RIGHT", "path": "systemtest/src/test/java/io/strimzi/systemtest/RollingUpdateST.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwNjoyOTo0NVrOGI0vhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQwOTowNTozOVrOGI7DRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTkwNTkyNw==", "bodyText": "Just a philosophical question. Is not waiting for rolling of Kafka sufficient? Kafka starts rolling only if the ZK finishes RU, or?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2865#discussion_r411905927", "createdAt": "2020-04-21T06:29:45Z", "author": {"login": "sknot-rh"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/RollingUpdateST.java", "diffHunk": "@@ -867,6 +867,7 @@ void testClusterCaRemovedTriggersRollingUpdate() {\n \n         // some kind of accident happened and the CA secret has been deleted\n         kubeClient().deleteSecret(KafkaResources.clusterCaKeySecretName(CLUSTER_NAME));\n+        StatefulSetUtils.waitTillSsHasRolled(KafkaResources.zookeeperStatefulSetName(CLUSTER_NAME), 3, zkPods);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "45b0ea7d0ae6c55d91bdb0d43fc18c09ef026cc0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAwNzc3Nw==", "bodyText": "I thought this too in this case, we have 14mins timeout set for rolling update of component - but if we run the test, it takes some time to roll ZK and when Kafka pods is rolling, sometimes it will not make it to that 14mins. But this is only case when you run tests on Openstack machines - as all tests are running on it. I think if you run it locally without wait for ZK rolling update, it will be successful. But - maybe I'm wrong.\nWhat do you think @Frawless?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2865#discussion_r412007777", "createdAt": "2020-04-21T09:03:36Z", "author": {"login": "im-konge"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/RollingUpdateST.java", "diffHunk": "@@ -867,6 +867,7 @@ void testClusterCaRemovedTriggersRollingUpdate() {\n \n         // some kind of accident happened and the CA secret has been deleted\n         kubeClient().deleteSecret(KafkaResources.clusterCaKeySecretName(CLUSTER_NAME));\n+        StatefulSetUtils.waitTillSsHasRolled(KafkaResources.zookeeperStatefulSetName(CLUSTER_NAME), 3, zkPods);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTkwNTkyNw=="}, "originalCommit": {"oid": "45b0ea7d0ae6c55d91bdb0d43fc18c09ef026cc0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAwOTIxNw==", "bodyText": "yes, it's connected to env issues. And now will be more clear of what should happen.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2865#discussion_r412009217", "createdAt": "2020-04-21T09:05:33Z", "author": {"login": "Frawless"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/RollingUpdateST.java", "diffHunk": "@@ -867,6 +867,7 @@ void testClusterCaRemovedTriggersRollingUpdate() {\n \n         // some kind of accident happened and the CA secret has been deleted\n         kubeClient().deleteSecret(KafkaResources.clusterCaKeySecretName(CLUSTER_NAME));\n+        StatefulSetUtils.waitTillSsHasRolled(KafkaResources.zookeeperStatefulSetName(CLUSTER_NAME), 3, zkPods);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTkwNTkyNw=="}, "originalCommit": {"oid": "45b0ea7d0ae6c55d91bdb0d43fc18c09ef026cc0"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjAwOTI4Nw==", "bodyText": "Ah, yes. You are right it is better to use granularity because of timeouts. Thank you! LGTM", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2865#discussion_r412009287", "createdAt": "2020-04-21T09:05:39Z", "author": {"login": "sknot-rh"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/RollingUpdateST.java", "diffHunk": "@@ -867,6 +867,7 @@ void testClusterCaRemovedTriggersRollingUpdate() {\n \n         // some kind of accident happened and the CA secret has been deleted\n         kubeClient().deleteSecret(KafkaResources.clusterCaKeySecretName(CLUSTER_NAME));\n+        StatefulSetUtils.waitTillSsHasRolled(KafkaResources.zookeeperStatefulSetName(CLUSTER_NAME), 3, zkPods);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTkwNTkyNw=="}, "originalCommit": {"oid": "45b0ea7d0ae6c55d91bdb0d43fc18c09ef026cc0"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 200, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}