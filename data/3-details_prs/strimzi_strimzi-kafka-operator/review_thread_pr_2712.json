{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwMzI1Nzcz", "number": 2712, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwOTo1ODozMFrODpzw4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwOTo1ODozMFrODpzw4A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1MTY2MzA0OnYy", "diffSide": "RIGHT", "path": "systemtest/src/test/java/io/strimzi/systemtest/ConnectS2IST.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQwOTo1ODozMVrOF5NhjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMDozNzoyNFrOF5_iPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTUzNDczMw==", "bodyText": "Isn't this line useless ?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2712#discussion_r395534733", "createdAt": "2020-03-20T09:58:31Z", "author": {"login": "Frawless"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/ConnectS2IST.java", "diffHunk": "@@ -89,17 +90,19 @@ void testDeployS2IWithMongoDBPlugin() throws InterruptedException, IOException {\n \n         KafkaConnectS2IUtils.waitForConnectS2IStatus(kafkaConnectS2IName, \"Ready\");\n \n-        // Make sure that Connenct API is ready\n-        KafkaConnectS2IUtils.waitForRebalancingDone(kafkaConnectS2IName);\n-\n-        String createConnectorOutput = cmdKubeClient().execInPod(kafkaClientsPodName, \"curl\", \"-X\", \"POST\", \"-H\", \"Accept:application/json\", \"-H\", \"Content-Type:application/json\",\n-                \"http://\" + KafkaConnectS2IResources.serviceName(kafkaConnectS2IName) + \":8083/connectors/\", \"-d\", mongoDbConfig).out();\n-        LOGGER.info(\"Create Connector result: {}\", createConnectorOutput);\n+        TestUtils.waitFor(\"ConnectS2I will be ready and POST will be executed\", Constants.GLOBAL_POLL_INTERVAL, Constants.TIMEOUT_FOR_RESOURCE_CREATION, () -> {\n+            String createConnectorOutput = cmdKubeClient().execInPod(kafkaClientsPodName, \"curl\", \"-X\", \"POST\", \"-H\", \"Accept:application/json\", \"-H\", \"Content-Type:application/json\",\n+                    \"http://\" + KafkaConnectS2IResources.serviceName(kafkaConnectS2IName) + \":8083/connectors/\", \"-d\", mongoDbConfig).out();\n+            LOGGER.info(\"Create Connector result: {}\", createConnectorOutput);\n+            return !createConnectorOutput.contains(\"error_code\");\n+        });\n \n         // Make sure that connector is really created\n         Thread.sleep(10_000);\n \n         String connectorStatus = cmdKubeClient().execInPod(kafkaClientsPodName, \"curl\", \"-X\", \"GET\", \"http://\" + KafkaConnectS2IResources.serviceName(kafkaConnectS2IName) + \":8083/connectors/\" + kafkaConnectS2IName + \"/status\").out();\n+\n+        KafkaConnectS2IUtils.waitForConnectS2IStatus(kafkaConnectS2IName, \"Ready\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5506d55f85a8249fd942e05dfd679b69958ee050"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjM1NDExMA==", "bodyText": "Removed :)", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2712#discussion_r396354110", "createdAt": "2020-03-23T10:37:24Z", "author": {"login": "im-konge"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/ConnectS2IST.java", "diffHunk": "@@ -89,17 +90,19 @@ void testDeployS2IWithMongoDBPlugin() throws InterruptedException, IOException {\n \n         KafkaConnectS2IUtils.waitForConnectS2IStatus(kafkaConnectS2IName, \"Ready\");\n \n-        // Make sure that Connenct API is ready\n-        KafkaConnectS2IUtils.waitForRebalancingDone(kafkaConnectS2IName);\n-\n-        String createConnectorOutput = cmdKubeClient().execInPod(kafkaClientsPodName, \"curl\", \"-X\", \"POST\", \"-H\", \"Accept:application/json\", \"-H\", \"Content-Type:application/json\",\n-                \"http://\" + KafkaConnectS2IResources.serviceName(kafkaConnectS2IName) + \":8083/connectors/\", \"-d\", mongoDbConfig).out();\n-        LOGGER.info(\"Create Connector result: {}\", createConnectorOutput);\n+        TestUtils.waitFor(\"ConnectS2I will be ready and POST will be executed\", Constants.GLOBAL_POLL_INTERVAL, Constants.TIMEOUT_FOR_RESOURCE_CREATION, () -> {\n+            String createConnectorOutput = cmdKubeClient().execInPod(kafkaClientsPodName, \"curl\", \"-X\", \"POST\", \"-H\", \"Accept:application/json\", \"-H\", \"Content-Type:application/json\",\n+                    \"http://\" + KafkaConnectS2IResources.serviceName(kafkaConnectS2IName) + \":8083/connectors/\", \"-d\", mongoDbConfig).out();\n+            LOGGER.info(\"Create Connector result: {}\", createConnectorOutput);\n+            return !createConnectorOutput.contains(\"error_code\");\n+        });\n \n         // Make sure that connector is really created\n         Thread.sleep(10_000);\n \n         String connectorStatus = cmdKubeClient().execInPod(kafkaClientsPodName, \"curl\", \"-X\", \"GET\", \"http://\" + KafkaConnectS2IResources.serviceName(kafkaConnectS2IName) + \":8083/connectors/\" + kafkaConnectS2IName + \"/status\").out();\n+\n+        KafkaConnectS2IUtils.waitForConnectS2IStatus(kafkaConnectS2IName, \"Ready\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTUzNDczMw=="}, "originalCommit": {"oid": "5506d55f85a8249fd942e05dfd679b69958ee050"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 318, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}