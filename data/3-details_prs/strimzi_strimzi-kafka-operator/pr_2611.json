{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwODk4MTYz", "number": 2611, "title": "Changed the AdminClientProvider to use keystore and password in theSecrets", "bodyText": "Type of change\n\nRefactoring\n\nDescription\nEach Secret containing certificates and keys has now the corresponding store as well (with related password).\nThis PR refactors the AdminClientProvider and the default implementation in order to leverage them instead of recreating needed stores from certificate and key and generating a new password.\nIt also allows specifying which store \"key\" to be used in order to allow not only the CO using it (with its cluster operator Secret) but even UO (with entity operator Secret).\nChecklist\nPlease go through this checklist and make sure all applicable tasks have been done\n\n Update/write design documentation in ./design\n Write tests\n Make sure all tests pass\n Update documentation\n Check RBAC rights for Kubernetes / OpenShift roles\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging\n Update CHANGELOG.md", "createdAt": "2020-02-27T15:02:42Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2611", "merged": true, "mergeCommit": {"oid": "4e9d5e8377932bd21240ed2643215ba21768a596"}, "closed": true, "closedAt": "2020-02-28T08:24:53Z", "author": {"login": "ppatierno"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIcjebAH2gAyMzgwODk4MTYzOmNjMTU3ZDdhY2FmY2RkOTQxYjhjYmMwZDE2NTZlNmU1YjE4ODJkODY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIrlX8gFqTM2NjIyNTE5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cc157d7acafcdd941b8cbc0d1656e6e5b1882d86", "author": {"user": {"login": "ppatierno", "name": "Paolo Patierno"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/cc157d7acafcdd941b8cbc0d1656e6e5b1882d86", "committedDate": "2020-02-27T14:53:34Z", "message": "Changed the AdminClientProvider to use keystore and password in the\nSecrets instead of recreating it\nMaking AdminClientProvider generic for being used not only by CO but\neven UO, TO\n\nSigned-off-by: Paolo Patierno <ppatierno@live.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "627464123992c7712a8896af353b0aa088d0f6ee", "author": {"user": {"login": "ppatierno", "name": "Paolo Patierno"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/627464123992c7712a8896af353b0aa088d0f6ee", "committedDate": "2020-02-27T15:36:58Z", "message": "Moved AdminClientProvider and default implementation in operator common\npackage\n\nSigned-off-by: Paolo Patierno <ppatierno@live.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1ODg1NTc3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2611#pullrequestreview-365885577", "createdAt": "2020-02-27T18:12:14Z", "commit": {"oid": "627464123992c7712a8896af353b0aa088d0f6ee"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxODoxMjoxNVrOFvbz7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxODoxNzowMlrOFvb9mA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI4MzA1NA==", "bodyText": "Can we javadoc it, now that it's going to be used in more places?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2611#discussion_r385283054", "createdAt": "2020-02-27T18:12:15Z", "author": {"login": "tombentley"}, "path": "operator-common/src/main/java/io/strimzi/operator/common/AdminClientProvider.java", "diffHunk": "@@ -2,11 +2,11 @@\n  * Copyright Strimzi authors.\n  * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n  */\n-package io.strimzi.operator.cluster.operator.resource;\n+package io.strimzi.operator.common;\n \n import io.fabric8.kubernetes.api.model.Secret;\n import org.apache.kafka.clients.admin.AdminClient;\n \n public interface AdminClientProvider {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "627464123992c7712a8896af353b0aa088d0f6ee"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI4NTUyOA==", "bodyText": "KIP-476 added a superinterface called Admin for the AdminClient class, so I think we should make this interface return an Admin.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2611#discussion_r385285528", "createdAt": "2020-02-27T18:17:02Z", "author": {"login": "tombentley"}, "path": "operator-common/src/main/java/io/strimzi/operator/common/AdminClientProvider.java", "diffHunk": "@@ -2,11 +2,11 @@\n  * Copyright Strimzi authors.\n  * License: Apache License 2.0 (see the file LICENSE or http://apache.org/licenses/LICENSE-2.0.html).\n  */\n-package io.strimzi.operator.cluster.operator.resource;\n+package io.strimzi.operator.common;\n \n import io.fabric8.kubernetes.api.model.Secret;\n import org.apache.kafka.clients.admin.AdminClient;\n \n public interface AdminClientProvider {\n-    AdminClient createAdminClient(String hostname, Secret clusterCaCertSecret, Secret coKeySecret);\n+    AdminClient createAdminClient(String hostname, Secret clusterCaCertSecret, Secret keyCertSecret, String keyCertName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "627464123992c7712a8896af353b0aa088d0f6ee"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46e13f3ef3443d0cc6a4ac8cc19e608d7c78f465", "author": {"user": {"login": "ppatierno", "name": "Paolo Patierno"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/46e13f3ef3443d0cc6a4ac8cc19e608d7c78f465", "committedDate": "2020-02-27T20:21:33Z", "message": "Used Admin interface as per KIP-476\n\nSigned-off-by: Paolo Patierno <ppatierno@live.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e8a94e3c0d048e55405ffdb559060ada69b9335", "author": {"user": {"login": "ppatierno", "name": "Paolo Patierno"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/0e8a94e3c0d048e55405ffdb559060ada69b9335", "committedDate": "2020-02-27T20:40:33Z", "message": "Replaced a few missing Admin interface\n\nSigned-off-by: Paolo Patierno <ppatierno@live.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MDcyNDUy", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2611#pullrequestreview-366072452", "createdAt": "2020-02-27T23:30:51Z", "commit": {"oid": "0e8a94e3c0d048e55405ffdb559060ada69b9335"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2MjI1MTky", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2611#pullrequestreview-366225192", "createdAt": "2020-02-28T08:24:13Z", "commit": {"oid": "0e8a94e3c0d048e55405ffdb559060ada69b9335"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1738, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}