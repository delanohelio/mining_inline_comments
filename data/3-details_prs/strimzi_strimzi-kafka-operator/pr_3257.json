{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNDcxOTU1", "number": 3257, "title": "ST: Add k8s version to environment data for upgrade tests", "bodyText": "Signed-off-by: Jakub Stejskal xstejs24@gmail.com\nType of change\n\nEnhancement / new feature\n\nDescription\nFor some environments, which contain kubernetes with version 1.16+, we are not able to deploy Strimzi from shipped examples. With version 1.16, there were a change in kubernetes API which moved Deployment from extensions to apps.  Changes in this PR adds check for kubernetes version and skip tests if it's higher than the highest allowed.\nFor example, several upgrade tests will be skipped in OCP4.3+, but all remain same on 3.11\nChecklist\n\n Make sure all tests pass", "createdAt": "2020-06-29T14:57:45Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257", "merged": true, "mergeCommit": {"oid": "601fa9998fc9956bc0783a6e001a9567a5ef4c3e"}, "closed": true, "closedAt": "2020-07-08T11:39:44Z", "author": {"login": "Frawless"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwqOSeABqjM1MDI0NTA3Nzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcy27-ugFqTQ0NDU2NTUwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e42c8475cec496064a6ac4fb844d7401183dc905", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e42c8475cec496064a6ac4fb844d7401183dc905", "committedDate": "2020-06-29T14:39:32Z", "message": "Add k8s version to environment data to select few upgrades on latest kube versions\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}, "afterCommit": {"oid": "72ab4f0c449000613257ee934d5c6a14f725972d", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/72ab4f0c449000613257ee934d5c6a14f725972d", "committedDate": "2020-07-01T13:25:25Z", "message": "fixup! Fix timeout\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNjg0Nzc0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257#pullrequestreview-442684774", "createdAt": "2020-07-05T15:03:38Z", "commit": {"oid": "72ab4f0c449000613257ee934d5c6a14f725972d"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNVQxNTowMzozOFrOGtC9AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNVQxNToxMjozNVrOGtDAGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTg4NzQ4OQ==", "bodyText": "I think this is confusing ... is this minimum or maximum version? I think it would be better to name this maxK8sVersion.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257#discussion_r449887489", "createdAt": "2020-07-05T15:03:38Z", "author": {"login": "scholzj"}, "path": "systemtest/src/main/resources/StrimziUpgradeST.json", "diffHunk": "@@ -111,9 +113,10 @@\n       \"continuousClientsMessages\": 0\n     },\n     \"environmentInfo\": {\n+      \"k8sVersion\": \"1.15\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72ab4f0c449000613257ee934d5c6a14f725972d"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTg4ODA2MA==", "bodyText": "Looks like the Javadoc comment start is there twice.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257#discussion_r449888060", "createdAt": "2020-07-05T15:10:19Z", "author": {"login": "scholzj"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/StUtils.java", "diffHunk": "@@ -240,4 +240,17 @@ public static boolean checkLogForJSONFormat(Map<String, String> pods, String con\n         }\n         return isJSON;\n     }\n-}\n\\ No newline at end of file\n+\n+    /**\n+     /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72ab4f0c449000613257ee934d5c6a14f725972d"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTg4ODI4MQ==", "bodyText": "I would probably call the paramater again maxKubernetesVersion or something like that to make it more clear what it does and how it works.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257#discussion_r449888281", "createdAt": "2020-07-05T15:12:35Z", "author": {"login": "scholzj"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/StUtils.java", "diffHunk": "@@ -240,4 +240,17 @@ public static boolean checkLogForJSONFormat(Map<String, String> pods, String con\n         }\n         return isJSON;\n     }\n-}\n\\ No newline at end of file\n+\n+    /**\n+     /**\n+     * Method for check if test is allowed on current Kubernetes version\n+     * @param desiredKubernetesVersion kubernetes version which test needs\n+     * @return true if test is allowed, false if not\n+     */\n+    public static boolean isAllowedOnCurrentK8sVersion(String desiredKubernetesVersion) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72ab4f0c449000613257ee934d5c6a14f725972d"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzODI3Mjcx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257#pullrequestreview-443827271", "createdAt": "2020-07-07T12:09:08Z", "commit": {"oid": "7a16344bd25d1ae69f5a22fcbd63a0e838f51870"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzODI3NDY5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257#pullrequestreview-443827469", "createdAt": "2020-07-07T12:09:26Z", "commit": {"oid": "7a16344bd25d1ae69f5a22fcbd63a0e838f51870"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzODI4Mjk1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257#pullrequestreview-443828295", "createdAt": "2020-07-07T12:10:39Z", "commit": {"oid": "7a16344bd25d1ae69f5a22fcbd63a0e838f51870"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDozOVrOGt7o-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxMjoxMDozOVrOGt7o-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjI0OA==", "bodyText": "Maybe here will be conflict with #3278 -> but I will resolve it in my PR", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257#discussion_r450816248", "createdAt": "2020-07-07T12:10:39Z", "author": {"login": "im-konge"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/kubeUtils/objects/PodUtils.java", "diffHunk": "@@ -63,7 +63,7 @@ public static void waitForPodsReady(LabelSelector selector, int expectPods, bool\n         int[] counter = {0};\n \n         TestUtils.waitFor(\"All pods matching \" + selector + \"to be ready\",\n-            Constants.POLL_INTERVAL_FOR_RESOURCE_READINESS, Duration.ofMinutes(6).toMillis(),\n+            Constants.POLL_INTERVAL_FOR_RESOURCE_READINESS, ResourceOperation.rollingUpdateTimeout(expectPods),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7a16344bd25d1ae69f5a22fcbd63a0e838f51870"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "265547d13a029bfbad1918ab72e01406a74c4a4d", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/265547d13a029bfbad1918ab72e01406a74c4a4d", "committedDate": "2020-07-08T06:03:42Z", "message": "Update surefire version to 3.0.0-M5 (#3234)\n\n* WIP: migration to surefire 3\r\n\r\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>\r\n\r\n* fixup! WIP: migration to surefire 3\r\n\r\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>\r\n\r\n* Make it working and update azure and travis and pr\r\n\r\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>\r\n\r\n* fixup! Make it working and update azure and travis and pr\r\n\r\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>\r\n\r\n* Workaround SUREFIRE-1809 and set rerun properly\r\n\r\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>\r\n\r\n* fixup! Workaround SUREFIRE-1809 and set rerun properly\r\n\r\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ef4c77dc9c7132bce2e255ca7f57b21d7e5ca9a", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3ef4c77dc9c7132bce2e255ca7f57b21d7e5ca9a", "committedDate": "2020-07-08T06:03:42Z", "message": "Add k8s version to environment data to select few upgrades on latest kube versions\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3400c5379e94842c9cd74441fde498bb063d0cb7", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3400c5379e94842c9cd74441fde498bb063d0cb7", "committedDate": "2020-07-08T06:03:42Z", "message": "Fix timeout\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d70a22ffbc801cb61072d298473a9e82ea2aca20", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d70a22ffbc801cb61072d298473a9e82ea2aca20", "committedDate": "2020-07-08T06:03:42Z", "message": "fixup! Fix timeout\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd304b1d5026373b57b9b39c03b9ce3fa87d2b99", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/cd304b1d5026373b57b9b39c03b9ce3fa87d2b99", "committedDate": "2020-07-08T06:03:42Z", "message": "Work in comments\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8de11c072d21577cbe4adc0f3d0ed2b40c5f3a79", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8de11c072d21577cbe4adc0f3d0ed2b40c5f3a79", "committedDate": "2020-07-08T06:03:43Z", "message": "fixup! Work in comments\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7a16344bd25d1ae69f5a22fcbd63a0e838f51870", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7a16344bd25d1ae69f5a22fcbd63a0e838f51870", "committedDate": "2020-07-07T11:20:03Z", "message": "fixup! Work in comments\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}, "afterCommit": {"oid": "8de11c072d21577cbe4adc0f3d0ed2b40c5f3a79", "author": {"user": {"login": "Frawless", "name": "Jakub Stejskal"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8de11c072d21577cbe4adc0f3d0ed2b40c5f3a79", "committedDate": "2020-07-08T06:03:43Z", "message": "fixup! Work in comments\n\nSigned-off-by: Jakub Stejskal <xstejs24@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NTY1NTAx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3257#pullrequestreview-444565501", "createdAt": "2020-07-08T09:22:41Z", "commit": {"oid": "8de11c072d21577cbe4adc0f3d0ed2b40c5f3a79"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1254, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}