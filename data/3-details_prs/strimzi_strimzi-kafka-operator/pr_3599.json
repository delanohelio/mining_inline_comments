{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4NjE3ODA1", "number": 3599, "title": "[systemtest] Implementation of job methods to the kubeClient()", "bodyText": "Type of change\n\nEnhancement / new feature\n\nDescription\nIn this PR I'm gonna add implementation of jobClient() to the code, so we don't have to do the kubeClient().getClient().batch().jobs() all the time. I also added some methods for current namespace, so we don't need  to always specify it in inNamespace() method.\nChecklist\n\n Make sure all tests pass", "createdAt": "2020-09-03T13:04:37Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3599", "merged": true, "mergeCommit": {"oid": "5a9b632a078dc3c0b2a31d22016456c24e80c2ca"}, "closed": true, "closedAt": "2020-09-04T21:12:30Z", "author": {"login": "im-konge"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdFQU7mABqjM3MjQ2MzIxMDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFnorRgFqTQ4Mjc4NTQ3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "78536a7d4c471f5b3346b686fb91f7d2d8456c2c", "author": {"user": {"login": "im-konge", "name": "Luk\u00e1\u0161 Kr\u00e1l"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/78536a7d4c471f5b3346b686fb91f7d2d8456c2c", "committedDate": "2020-09-03T12:59:50Z", "message": "add implementation of jobClient\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>"}, "afterCommit": {"oid": "b2bbbce3e16f700d15f0a286af34ed6348d74417", "author": {"user": {"login": "im-konge", "name": "Luk\u00e1\u0161 Kr\u00e1l"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b2bbbce3e16f700d15f0a286af34ed6348d74417", "committedDate": "2020-09-03T13:08:03Z", "message": "add implementation of jobClient\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b2bbbce3e16f700d15f0a286af34ed6348d74417", "author": {"user": {"login": "im-konge", "name": "Luk\u00e1\u0161 Kr\u00e1l"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b2bbbce3e16f700d15f0a286af34ed6348d74417", "committedDate": "2020-09-03T13:08:03Z", "message": "add implementation of jobClient\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>"}, "afterCommit": {"oid": "9af32547e2799f8284627a5b37a2ae387bf5fd2f", "author": {"user": {"login": "im-konge", "name": "Luk\u00e1\u0161 Kr\u00e1l"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/9af32547e2799f8284627a5b37a2ae387bf5fd2f", "committedDate": "2020-09-03T14:16:58Z", "message": "frawless comment\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4183d57d1825aaad6d3f3bef815a67c2fd684cdf", "author": {"user": {"login": "im-konge", "name": "Luk\u00e1\u0161 Kr\u00e1l"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/4183d57d1825aaad6d3f3bef815a67c2fd684cdf", "committedDate": "2020-09-03T15:34:13Z", "message": "frawless comment\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9af32547e2799f8284627a5b37a2ae387bf5fd2f", "author": {"user": {"login": "im-konge", "name": "Luk\u00e1\u0161 Kr\u00e1l"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/9af32547e2799f8284627a5b37a2ae387bf5fd2f", "committedDate": "2020-09-03T14:16:58Z", "message": "frawless comment\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>"}, "afterCommit": {"oid": "4183d57d1825aaad6d3f3bef815a67c2fd684cdf", "author": {"user": {"login": "im-konge", "name": "Luk\u00e1\u0161 Kr\u00e1l"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/4183d57d1825aaad6d3f3bef815a67c2fd684cdf", "committedDate": "2020-09-03T15:34:13Z", "message": "frawless comment\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyMzkxMzY1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3599#pullrequestreview-482391365", "createdAt": "2020-09-04T06:31:37Z", "commit": {"oid": "4183d57d1825aaad6d3f3bef815a67c2fd684cdf"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNjQ2NzI5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3599#pullrequestreview-482646729", "createdAt": "2020-09-04T13:22:00Z", "commit": {"oid": "4183d57d1825aaad6d3f3bef815a67c2fd684cdf"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMzoyMjowMFrOHNNT2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxMzoyMjowMFrOHNNT2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzYxMTYxMQ==", "bodyText": "I would prepare to use the same approach as we have for deployment. Use current namespace if not specified and in case it's specified, use different.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3599#discussion_r483611611", "createdAt": "2020-09-04T13:22:00Z", "author": {"login": "Frawless"}, "path": "systemtest/src/main/java/io/strimzi/systemtest/utils/ClientUtils.java", "diffHunk": "@@ -50,14 +50,13 @@ public static void waitUntilClientReceivedMessagesTls(KafkaClientOperations kafk\n     public static void waitTillContinuousClientsFinish(String producerName, String consumerName, String namespace, int messageCount) {\n         LOGGER.info(\"Waiting till producer {} and consumer {} finish\", producerName, consumerName);\n         TestUtils.waitFor(\"continuous clients finished\", Constants.GLOBAL_POLL_INTERVAL, timeoutForClientFinishJob(messageCount),\n-            () -> kubeClient().getClient().batch().jobs().inNamespace(namespace).withName(producerName).get().getStatus().getSucceeded().equals(1) &&\n-                    kubeClient().getClient().batch().jobs().inNamespace(namespace).withName(consumerName).get().getStatus().getSucceeded().equals(1));\n+            () -> kubeClient().getJobStatus(producerName, namespace) && kubeClient().getJobStatus(consumerName, namespace));\n     }\n \n     public static void waitForClientSuccess(String jobName, String namespace, int messageCount) {\n         LOGGER.info(\"Waiting for producer/consumer:{} will be finished\", jobName);\n         TestUtils.waitFor(\"job finished\", Constants.GLOBAL_POLL_INTERVAL, timeoutForClientFinishJob(messageCount),\n-            () -> kubeClient().getClient().batch().jobs().inNamespace(namespace).withName(jobName).get().getStatus().getSucceeded().equals(1));\n+            () -> kubeClient().getJobStatus(jobName, namespace));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4183d57d1825aaad6d3f3bef815a67c2fd684cdf"}, "originalPosition": 22}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "181f136700d4ff5f450d0ed91ba153254137e997", "author": {"user": {"login": "im-konge", "name": "Luk\u00e1\u0161 Kr\u00e1l"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/181f136700d4ff5f450d0ed91ba153254137e997", "committedDate": "2020-09-04T15:03:19Z", "message": "fixup! frawless comment\n\nSigned-off-by: Lukas Kral <lukywill16@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNzc1NjAx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3599#pullrequestreview-482775601", "createdAt": "2020-09-04T16:01:59Z", "commit": {"oid": "181f136700d4ff5f450d0ed91ba153254137e997"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgyNzg1NDc4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3599#pullrequestreview-482785478", "createdAt": "2020-09-04T16:17:35Z", "commit": {"oid": "181f136700d4ff5f450d0ed91ba153254137e997"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 937, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}