{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4NTkyNzAy", "number": 3031, "title": "Build Strimzi with Java11", "bodyText": "Signed-off-by: Stanislav Knot sknot@redhat.com\nType of change\n\nBuild Strimzi with java11\n\nDescription\nSetting JAVA_VERSION before build does build java with appropriate Java version (8 or 11).\nThis change is done in Travis, Azure and Jenkins pipelines.\nDue to spotbugs/spotbugs#811 we need to disable this spotbugs warning.\nChecklist\n\n Update/write design documentation in ./design\n Write tests\n Make sure all tests pass\n Update documentation\n Check RBAC rights for Kubernetes / OpenShift roles\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging\n Update CHANGELOG.md", "createdAt": "2020-05-15T13:27:34Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031", "merged": true, "mergeCommit": {"oid": "6aea8d2a75539129f5516d912658c6bb612a7d48"}, "closed": true, "closedAt": "2020-06-02T13:54:10Z", "author": {"login": "sknot-rh"}, "timelineItems": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchip5VgBqjMzNDEwODIyOTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnUMDsAFqTQyMjYzMzY1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "62920cedf8180f3df43d01f6433f773b98b61b86", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/62920cedf8180f3df43d01f6433f773b98b61b86", "committedDate": "2020-05-15T13:18:36Z", "message": "Build Strimzi with Java11\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}, "afterCommit": {"oid": "41d32c768eef69703e428b2c58bf4aed4fb18907", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/41d32c768eef69703e428b2c58bf4aed4fb18907", "committedDate": "2020-05-15T14:07:54Z", "message": "Build Strimzi with Java11\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMTU3MzMz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#pullrequestreview-413157333", "createdAt": "2020-05-17T12:24:46Z", "commit": {"oid": "41d32c768eef69703e428b2c58bf4aed4fb18907"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NDY5MTU1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#pullrequestreview-416469155", "createdAt": "2020-05-21T20:30:07Z", "commit": {"oid": "41d32c768eef69703e428b2c58bf4aed4fb18907"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDozMDowN1rOGZByNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMVQyMDozMDowN1rOGZByNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg5NjgyMw==", "bodyText": "Isn't this a setKafkaTopics?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#discussion_r428896823", "createdAt": "2020-05-21T20:30:07Z", "author": {"login": "samuel-hawker"}, "path": "topic-operator/src/main/java/io/strimzi/operator/topic/TopicOperator.java", "diffHunk": "@@ -1202,6 +1203,7 @@ public ReconcileState(Set<TopicName> succeeded, Set<TopicName> undetermined, Map\n             this.succeeded = succeeded;\n             this.undetermined = undetermined;\n             this.failed = failed;\n+            this.ktList = emptyList();\n         }\n \n         public void addKafkaTopics(List<KafkaTopic> ktList) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41d32c768eef69703e428b2c58bf4aed4fb18907"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NTA5Njg3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#pullrequestreview-416509687", "createdAt": "2020-05-21T21:34:25Z", "commit": {"oid": "41d32c768eef69703e428b2c58bf4aed4fb18907"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE2NzA1OTY4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#pullrequestreview-416705968", "createdAt": "2020-05-22T07:33:57Z", "commit": {"oid": "41d32c768eef69703e428b2c58bf4aed4fb18907"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwNzozMzo1OFrOGZNgxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMlQwNzozMzo1OFrOGZNgxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTA4ODk2NA==", "bodyText": "shouldn't we keep this on version 1.8 until the migration to java11 ?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#discussion_r429088964", "createdAt": "2020-05-22T07:33:58Z", "author": {"login": "Frawless"}, "path": "Jenkinsfile-pr", "diffHunk": "@@ -37,6 +37,7 @@ pipeline {\n         TEST_CLUSTER_ADMIN = \"admin\"\n         OPERATOR_IMAGE_PULL_POLICY = \"IfNotPresent\"\n         COMPONENTS_IMAGE_PULL_POLICY = \"IfNotPresent\"\n+        JAVA_VERSION = \"11\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "41d32c768eef69703e428b2c58bf4aed4fb18907"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1b30dd61f7df467e6906f8a691618171ac082987", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1b30dd61f7df467e6906f8a691618171ac082987", "committedDate": "2020-05-26T12:28:11Z", "message": "patch\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}, "afterCommit": {"oid": "bb5484c253981c7fa31863a868a2f1970a402ffa", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/bb5484c253981c7fa31863a868a2f1970a402ffa", "committedDate": "2020-05-26T12:45:13Z", "message": "patch\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3857fbbdcbe68f0bbcd116deb339c3d92bc81c3b", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3857fbbdcbe68f0bbcd116deb339c3d92bc81c3b", "committedDate": "2020-05-26T13:46:19Z", "message": "Build Strimzi with Java11\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ba6ec577b9722cd98b677f44f2f7d826d4ee48c", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/5ba6ec577b9722cd98b677f44f2f7d826d4ee48c", "committedDate": "2020-05-26T13:46:19Z", "message": "revert jenkins\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e61c212fcd55bb23f1cf6d07b4b7a89e17c40f7", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/5e61c212fcd55bb23f1cf6d07b4b7a89e17c40f7", "committedDate": "2020-05-26T13:46:19Z", "message": "revert me later: debug j11 build\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "361873ca93d2f1ec6a03009a81b3a569effaaf77", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/361873ca93d2f1ec6a03009a81b3a569effaaf77", "committedDate": "2020-05-26T13:46:19Z", "message": "patch\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MjM4NjA1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#pullrequestreview-419238605", "createdAt": "2020-05-27T14:00:45Z", "commit": {"oid": "bb5484c253981c7fa31863a868a2f1970a402ffa"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxNDowMDo0NVrOGbLmPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QxNDowNjowN1rOGbL1wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE1NDc1MQ==", "bodyText": "Is this still necessary?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#discussion_r431154751", "createdAt": "2020-05-27T14:00:45Z", "author": {"login": "tombentley"}, "path": ".azure/build-pipeline.yaml", "diffHunk": "@@ -64,7 +64,7 @@ jobs:\n         env:\n           DOCKER_USER: $(DOCKER_USER)\n           DOCKER_PASS: $(DOCKER_PASS_SECRET)\n-          MVN_ARGS: '-B'\n+          MVN_ARGS: '-B -X -e'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb5484c253981c7fa31863a868a2f1970a402ffa"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE1Njk0MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        log.warn(\"Failed to close vertx instance. \", e);\n          \n          \n            \n                        log.warn(\"Failed to close vertx instance.\", e);", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#discussion_r431156940", "createdAt": "2020-05-27T14:03:44Z", "author": {"login": "tombentley"}, "path": "cluster-operator/src/test/java/io/strimzi/operator/cluster/ClusterOperatorTest.java", "diffHunk": "@@ -76,7 +79,11 @@ public static void before() {\n \n     @AfterAll\n     public static void after() {\n-        vertx.close();\n+        try {\n+            vertx.close();\n+        } catch (Exception e) {\n+            log.warn(\"Failed to close vertx instance. \", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb5484c253981c7fa31863a868a2f1970a402ffa"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE1NzkwOA==", "bodyText": "Why this this needed?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#discussion_r431157908", "createdAt": "2020-05-27T14:04:58Z", "author": {"login": "tombentley"}, "path": "pom.xml", "diffHunk": "@@ -784,6 +784,8 @@\n                         <ENV_VAR_EXISTS_BOOLEAN>true</ENV_VAR_EXISTS_BOOLEAN>\n                     </environmentVariables>\n                     <trimStackTrace>false</trimStackTrace>\n+                    <argLine>-Xmx1024m</argLine>\n+                    <forkedProcessExitTimeoutInSeconds>120</forkedProcessExitTimeoutInSeconds>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb5484c253981c7fa31863a868a2f1970a402ffa"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE1ODcyMg==", "bodyText": "He's asking why the method is called addKafkaTopics and not setKafkaTopics().", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#discussion_r431158722", "createdAt": "2020-05-27T14:06:07Z", "author": {"login": "tombentley"}, "path": "topic-operator/src/main/java/io/strimzi/operator/topic/TopicOperator.java", "diffHunk": "@@ -1202,6 +1203,7 @@ public ReconcileState(Set<TopicName> succeeded, Set<TopicName> undetermined, Map\n             this.succeeded = succeeded;\n             this.undetermined = undetermined;\n             this.failed = failed;\n+            this.ktList = emptyList();\n         }\n \n         public void addKafkaTopics(List<KafkaTopic> ktList) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg5NjgyMw=="}, "originalCommit": {"oid": "41d32c768eef69703e428b2c58bf4aed4fb18907"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75f4d41c175a7fd37b58e44e7d16b49cd669525d", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/75f4d41c175a7fd37b58e44e7d16b49cd669525d", "committedDate": "2020-05-28T05:00:04Z", "message": "comments\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb5484c253981c7fa31863a868a2f1970a402ffa", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/bb5484c253981c7fa31863a868a2f1970a402ffa", "committedDate": "2020-05-26T12:45:13Z", "message": "patch\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}, "afterCommit": {"oid": "75f4d41c175a7fd37b58e44e7d16b49cd669525d", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/75f4d41c175a7fd37b58e44e7d16b49cd669525d", "committedDate": "2020-05-28T05:00:04Z", "message": "comments\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d0a26d01b0c82708cbb05e9e363080c11469f4c7", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d0a26d01b0c82708cbb05e9e363080c11469f4c7", "committedDate": "2020-05-29T10:45:31Z", "message": "test closing\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}, "afterCommit": {"oid": "8d08e72f546b4c7537ea815d4645b8f25bcbbcf2", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8d08e72f546b4c7537ea815d4645b8f25bcbbcf2", "committedDate": "2020-05-29T11:03:07Z", "message": "test closing\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d08e72f546b4c7537ea815d4645b8f25bcbbcf2", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8d08e72f546b4c7537ea815d4645b8f25bcbbcf2", "committedDate": "2020-05-29T11:03:07Z", "message": "test closing\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}, "afterCommit": {"oid": "cb544bdbc5000dce003ac0f8b9753db6a5e7f4c2", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/cb544bdbc5000dce003ac0f8b9753db6a5e7f4c2", "committedDate": "2020-05-29T12:54:01Z", "message": "test closing\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cb544bdbc5000dce003ac0f8b9753db6a5e7f4c2", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/cb544bdbc5000dce003ac0f8b9753db6a5e7f4c2", "committedDate": "2020-05-29T12:54:01Z", "message": "test closing\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}, "afterCommit": {"oid": "219b8cd0a5ae7e3069492fa49906d5aaee49a203", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/219b8cd0a5ae7e3069492fa49906d5aaee49a203", "committedDate": "2020-05-29T13:03:09Z", "message": "test closing\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c80b0ecab4ee52aed99ce3740de76c9a7c8e9e6a", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/c80b0ecab4ee52aed99ce3740de76c9a7c8e9e6a", "committedDate": "2020-05-29T13:33:37Z", "message": "test closing\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "219b8cd0a5ae7e3069492fa49906d5aaee49a203", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/219b8cd0a5ae7e3069492fa49906d5aaee49a203", "committedDate": "2020-05-29T13:03:09Z", "message": "test closing\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}, "afterCommit": {"oid": "c80b0ecab4ee52aed99ce3740de76c9a7c8e9e6a", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/c80b0ecab4ee52aed99ce3740de76c9a7c8e9e6a", "committedDate": "2020-05-29T13:33:37Z", "message": "test closing\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "51a6bcdac29b831efce9f92e0783f4094eb6060d", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/51a6bcdac29b831efce9f92e0783f4094eb6060d", "committedDate": "2020-06-01T07:24:06Z", "message": "another try\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNDM3ODM3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#pullrequestreview-422437837", "createdAt": "2020-06-02T08:07:31Z", "commit": {"oid": "51a6bcdac29b831efce9f92e0783f4094eb6060d"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwODowNzozMVrOGdmpWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwODoyNjowOVrOGdnTww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzY5NTA2Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private static final Logger log = LogManager.getLogger(ClusterOperatorTest.class.getName());\n          \n          \n            \n                private static final Logger log = LogManager.getLogger(ClusterOperatorTest.class);", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#discussion_r433695067", "createdAt": "2020-06-02T08:07:31Z", "author": {"login": "tombentley"}, "path": "cluster-operator/src/test/java/io/strimzi/operator/cluster/ClusterOperatorTest.java", "diffHunk": "@@ -52,6 +55,7 @@\n @ExtendWith(VertxExtension.class)\n public class ClusterOperatorTest {\n     private static Vertx vertx;\n+    private static final Logger log = LogManager.getLogger(ClusterOperatorTest.class.getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51a6bcdac29b831efce9f92e0783f4094eb6060d"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzcwMzg2NA==", "bodyText": "I don't really understand why this had to change due to a simple change in JDK. If this is just trying to remove a flaky test perhaps that should be done in a separate PR, or at least the PR description should mention that you've fixed a flaky test in addition to changing the JDK.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#discussion_r433703864", "createdAt": "2020-06-02T08:22:42Z", "author": {"login": "tombentley"}, "path": "cluster-operator/src/test/java/io/strimzi/operator/cluster/ClusterOperatorTest.java", "diffHunk": "@@ -165,29 +169,37 @@ private void startStop(VertxTestContext context, String namespaces, boolean open\n \n         Map<String, String> env = buildEnv(namespaces);\n \n-        Checkpoint async = context.checkpoint();\n+        CountDownLatch latch = new CountDownLatch(namespaceList.size() + 1);\n+\n         Main.run(vertx, client, new PlatformFeaturesAvailability(openShift, KubernetesVersion.V1_9),\n                     ClusterOperatorConfig.fromMap(env, KafkaVersionTestUtils.getKafkaVersionLookup()))\n             .onComplete(context.succeeding(v -> context.verify(() -> {\n                 assertThat(\"A verticle per namespace\", vertx.deploymentIDs(), hasSize(namespaceList.size()));\n-\n                 for (String deploymentId: vertx.deploymentIDs()) {\n-                    vertx.undeploy(deploymentId, context.succeeding());\n+                    vertx.undeploy(deploymentId, asyncResult -> {\n+                        if (asyncResult.failed()) {\n+                            log.error(\"Failed to undeploy {}\", deploymentId);\n+                            context.failNow(asyncResult.cause());\n+                        }\n+                        latch.countDown();\n+                    });\n                 }\n \n                 int maximumExpectedNumberOfWatchers = (openShift ? 9 : 7) * namespaceList.size(); // we do not have connectS2I on k8s\n                 assertThat(\"Looks like there were more watchers than namespaces\",\n                         numWatchers.get(), lessThanOrEqualTo(maximumExpectedNumberOfWatchers));\n-                async.flag();\n+                latch.countDown();\n             })));\n+        latch.await(10, TimeUnit.SECONDS);\n+        context.completeNow();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51a6bcdac29b831efce9f92e0783f4094eb6060d"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzcwNTkyMw==", "bodyText": "Again, I don't understand why this needed to change. Presumably because you saw an NPE, right? But the question is not \"How do I get rid of the NPE as quickly as possible\" it's \"what race means we're not seeing this NPE, and was that an NPE the original author thought could never happen?\" The answer to that question might reveal some defect in the logic which using an emptyList() is just hiding.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#discussion_r433705923", "createdAt": "2020-06-02T08:26:09Z", "author": {"login": "tombentley"}, "path": "topic-operator/src/main/java/io/strimzi/operator/topic/TopicOperator.java", "diffHunk": "@@ -1202,9 +1203,10 @@ public ReconcileState(Set<TopicName> succeeded, Set<TopicName> undetermined, Map\n             this.succeeded = succeeded;\n             this.undetermined = undetermined;\n             this.failed = failed;\n+            this.ktList = emptyList();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51a6bcdac29b831efce9f92e0783f4094eb6060d"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNTY0MjUz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#pullrequestreview-422564253", "createdAt": "2020-06-02T10:57:27Z", "commit": {"oid": "51a6bcdac29b831efce9f92e0783f4094eb6060d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "124333b607ac556d8cd1d19d0784b9b9d270bc77", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/124333b607ac556d8cd1d19d0784b9b9d270bc77", "committedDate": "2020-06-02T11:16:07Z", "message": "comment\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNjMzNjU0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3031#pullrequestreview-422633654", "createdAt": "2020-06-02T12:40:24Z", "commit": {"oid": "124333b607ac556d8cd1d19d0784b9b9d270bc77"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1738, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}