{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1NTczMzkz", "number": 2857, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxMDo0Njo1MlrODzXxmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDo1NjowNVrOD0LjBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU1MTkzNDk2OnYy", "diffSide": "RIGHT", "path": "operator-common/src/main/java/io/strimzi/operator/common/operator/resource/DeploymentConfigOperator.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxMDo0Njo1MlrOGH14KQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xOVQxOToxNjoyMlrOGH7tHg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3NTk0NQ==", "bodyText": "Just to avoid confusion around double negatives, might it be worth changing this to\nrollOutStarted = true\n\nAs we assume it has started unless the condition states otherwise", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2857#discussion_r410875945", "createdAt": "2020-04-19T10:46:52Z", "author": {"login": "samuel-hawker"}, "path": "operator-common/src/main/java/io/strimzi/operator/common/operator/resource/DeploymentConfigOperator.java", "diffHunk": "@@ -72,9 +73,35 @@ protected Integer currentScale(String namespace, String name) {\n     private boolean isObserved(String namespace, String name) {\n         DeploymentConfig dep = get(namespace, name);\n         if (dep != null)   {\n-            return dep.getMetadata().getGeneration().equals(dep.getStatus().getObservedGeneration());\n+            // Get the roll out status\n+            //     => Sometimes it takes OCP some time before the generations are updated.\n+            //        So we need to check the conditions in addition to detect such situation.\n+            boolean rollOutNotStartedYet = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "876f4d3fa1709b0b01bc58ecff3106ca42cd5abe"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDk3MTQyMg==", "bodyText": "I changed it to not use the double negative.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2857#discussion_r410971422", "createdAt": "2020-04-19T19:16:22Z", "author": {"login": "scholzj"}, "path": "operator-common/src/main/java/io/strimzi/operator/common/operator/resource/DeploymentConfigOperator.java", "diffHunk": "@@ -72,9 +73,35 @@ protected Integer currentScale(String namespace, String name) {\n     private boolean isObserved(String namespace, String name) {\n         DeploymentConfig dep = get(namespace, name);\n         if (dep != null)   {\n-            return dep.getMetadata().getGeneration().equals(dep.getStatus().getObservedGeneration());\n+            // Get the roll out status\n+            //     => Sometimes it takes OCP some time before the generations are updated.\n+            //        So we need to check the conditions in addition to detect such situation.\n+            boolean rollOutNotStartedYet = false;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3NTk0NQ=="}, "originalCommit": {"oid": "876f4d3fa1709b0b01bc58ecff3106ca42cd5abe"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MDQxNzM0OnYy", "diffSide": "RIGHT", "path": "operator-common/src/main/java/io/strimzi/operator/common/operator/resource/DeploymentConfigOperator.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMDo1NjowNVrOGI_inw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxMTowMjozMFrOGI_x_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA4Mjg0Nw==", "bodyText": "should it be valid just for \"Ready\". Is it possible that the status is \"NotReady\" so anyway different from \"Unkown\"?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2857#discussion_r412082847", "createdAt": "2020-04-21T10:56:05Z", "author": {"login": "ppatierno"}, "path": "operator-common/src/main/java/io/strimzi/operator/common/operator/resource/DeploymentConfigOperator.java", "diffHunk": "@@ -72,9 +73,35 @@ protected Integer currentScale(String namespace, String name) {\n     private boolean isObserved(String namespace, String name) {\n         DeploymentConfig dep = get(namespace, name);\n         if (dep != null)   {\n-            return dep.getMetadata().getGeneration().equals(dep.getStatus().getObservedGeneration());\n+            // Get the roll out status\n+            //     => Sometimes it takes OCP some time before the generations are updated.\n+            //        So we need to check the conditions in addition to detect such situation.\n+            boolean rollOutNotStarting = true;\n+            DeploymentCondition progressing = getProgressingCondition(dep);\n+\n+            if (progressing != null)    {\n+                rollOutNotStarting = progressing.getReason() != null && !\"Unknown\".equals(progressing.getStatus());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9ae06720e2bab4706f0ddac2bbf155c0f64615a"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA4NDEzOQ==", "bodyText": "Not sure I understand the question. When the Reason is null and Status is Unknown, the generation has not been updated yet.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2857#discussion_r412084139", "createdAt": "2020-04-21T10:58:08Z", "author": {"login": "scholzj"}, "path": "operator-common/src/main/java/io/strimzi/operator/common/operator/resource/DeploymentConfigOperator.java", "diffHunk": "@@ -72,9 +73,35 @@ protected Integer currentScale(String namespace, String name) {\n     private boolean isObserved(String namespace, String name) {\n         DeploymentConfig dep = get(namespace, name);\n         if (dep != null)   {\n-            return dep.getMetadata().getGeneration().equals(dep.getStatus().getObservedGeneration());\n+            // Get the roll out status\n+            //     => Sometimes it takes OCP some time before the generations are updated.\n+            //        So we need to check the conditions in addition to detect such situation.\n+            boolean rollOutNotStarting = true;\n+            DeploymentCondition progressing = getProgressingCondition(dep);\n+\n+            if (progressing != null)    {\n+                rollOutNotStarting = progressing.getReason() != null && !\"Unknown\".equals(progressing.getStatus());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA4Mjg0Nw=="}, "originalCommit": {"oid": "a9ae06720e2bab4706f0ddac2bbf155c0f64615a"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA4NDQwMA==", "bodyText": "So the state is netiehr Ready nor NotReady, but Unknown.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2857#discussion_r412084400", "createdAt": "2020-04-21T10:58:34Z", "author": {"login": "scholzj"}, "path": "operator-common/src/main/java/io/strimzi/operator/common/operator/resource/DeploymentConfigOperator.java", "diffHunk": "@@ -72,9 +73,35 @@ protected Integer currentScale(String namespace, String name) {\n     private boolean isObserved(String namespace, String name) {\n         DeploymentConfig dep = get(namespace, name);\n         if (dep != null)   {\n-            return dep.getMetadata().getGeneration().equals(dep.getStatus().getObservedGeneration());\n+            // Get the roll out status\n+            //     => Sometimes it takes OCP some time before the generations are updated.\n+            //        So we need to check the conditions in addition to detect such situation.\n+            boolean rollOutNotStarting = true;\n+            DeploymentCondition progressing = getProgressingCondition(dep);\n+\n+            if (progressing != null)    {\n+                rollOutNotStarting = progressing.getReason() != null && !\"Unknown\".equals(progressing.getStatus());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA4Mjg0Nw=="}, "originalCommit": {"oid": "a9ae06720e2bab4706f0ddac2bbf155c0f64615a"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA4Njc4Mw==", "bodyText": "Right.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2857#discussion_r412086783", "createdAt": "2020-04-21T11:02:30Z", "author": {"login": "ppatierno"}, "path": "operator-common/src/main/java/io/strimzi/operator/common/operator/resource/DeploymentConfigOperator.java", "diffHunk": "@@ -72,9 +73,35 @@ protected Integer currentScale(String namespace, String name) {\n     private boolean isObserved(String namespace, String name) {\n         DeploymentConfig dep = get(namespace, name);\n         if (dep != null)   {\n-            return dep.getMetadata().getGeneration().equals(dep.getStatus().getObservedGeneration());\n+            // Get the roll out status\n+            //     => Sometimes it takes OCP some time before the generations are updated.\n+            //        So we need to check the conditions in addition to detect such situation.\n+            boolean rollOutNotStarting = true;\n+            DeploymentCondition progressing = getProgressingCondition(dep);\n+\n+            if (progressing != null)    {\n+                rollOutNotStarting = progressing.getReason() != null && !\"Unknown\".equals(progressing.getStatus());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjA4Mjg0Nw=="}, "originalCommit": {"oid": "a9ae06720e2bab4706f0ddac2bbf155c0f64615a"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 193, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}