{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA0MTAzNTY2", "number": 3819, "title": "[DOC] Kafka Bridge - document message format including Kafka headers ", "bodyText": "Signed-off-by: Daniel Laing dlaing@redhat.com\nType of change\n\nDocumentation\n\nDescription\nGuides affected:\nUsing Strimzi\n\nKafka Bridge\n\nKafka Bridge overview\n\n\n\nAdds a new sub-section on the format of messages sent using the topics endpoint. It includes details on the headers field that was added in #413.\nAlso adds a one-line change describing the method to retrieve all partitions on a topic. This method was added in #427.\nAlso makes a few unrelated changes:\n\nTrying to simplify the explanation of the embedded data format for consumers\nImprove the signposting at the start of the chapter by adding cross-references to other locations\n\nChecklist\nPlease go through this checklist and make sure all applicable tasks have been done\n\n Write tests\n Make sure all tests pass\n Update documentation\n Check RBAC rights for Kubernetes / OpenShift roles\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging\n Update CHANGELOG.md\n Supply screenshots for visual changes, such as Grafana dashboards", "createdAt": "2020-10-15T13:26:09Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819", "merged": true, "mergeCommit": {"oid": "8c45331beb2ff5363f651055ae704cfd9d7eea6f"}, "closed": true, "closedAt": "2020-10-26T19:12:14Z", "author": {"login": "laidan6000"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdSxnPggH2gAyNTA0MTAzNTY2OjFkOTU3MDBkYjAyNDQ2NjNiYmMwZDlkNmNkMWIwYTM3Njg1NTM1MjQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdWZJ6CgFqTUxNzA4OTA3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1d95700db0244663bbc0d9d6cd1b0a3768553524", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1d95700db0244663bbc0d9d6cd1b0a3768553524", "committedDate": "2020-10-15T13:16:05Z", "message": "updates for kafka headers, message format\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NDA1MTE2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#pullrequestreview-509405116", "createdAt": "2020-10-15T13:54:32Z", "commit": {"oid": "1d95700db0244663bbc0d9d6cd1b0a3768553524"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMzo1NDozMlrOHiJCWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxMzo1NDozMlrOHiJCWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTU2MTY5MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            * When performing producer operations, `POST` requests must provide `Content-Type` headers specifying the desired _embedded data format_ of the messages produced. This can be either `json` or `binary`.\n          \n          \n            \n            * When performing producer operations, `POST` requests must provide `Content-Type` headers specifying the  _embedded data format_ of the messages produced. This can be either `json` or `binary`.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#discussion_r505561690", "createdAt": "2020-10-15T13:54:32Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/con-requests-kafka-bridge.adoc", "diffHunk": "@@ -18,9 +18,9 @@ API request and response bodies are always encoded as JSON.\n Content-Type: application/vnd.kafka.v2+json\n ----\n \n-* When performing producer operations, `POST` requests must provide `Content-Type` headers specifying the desired _embedded data format_, either `json` or `binary`, as shown in the following table.\n+* When performing producer operations, `POST` requests must provide `Content-Type` headers specifying the desired _embedded data format_ of the messages produced. This can be either `json` or `binary`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d95700db0244663bbc0d9d6cd1b0a3768553524"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NDA4MDQ1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#pullrequestreview-509408045", "createdAt": "2020-10-15T13:57:05Z", "commit": {"oid": "1d95700db0244663bbc0d9d6cd1b0a3768553524"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0c31f60465548dcbfd8156a1447373d0fb33eb9", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/e0c31f60465548dcbfd8156a1447373d0fb33eb9", "committedDate": "2020-10-15T14:02:28Z", "message": "review comment PM\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA5NTAyNzgz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#pullrequestreview-509502783", "createdAt": "2020-10-15T15:25:20Z", "commit": {"oid": "e0c31f60465548dcbfd8156a1447373d0fb33eb9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNToyNToyMFrOHiNdxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNVQxNToyNToyMFrOHiNdxA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTYzNDI0NA==", "bodyText": "@ppatierno Was the value not supposed to be base64 encoded?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#discussion_r505634244", "createdAt": "2020-10-15T15:25:20Z", "author": {"login": "scholzj"}, "path": "documentation/modules/con-requests-kafka-bridge.adoc", "diffHunk": "@@ -74,16 +74,50 @@ If you choose to specify a binary embedded data format, subsequent producer requ\n \n Producer requests must also provide a `Content-Type` header that corresponds to the embedded data format, for example, `Content-Type: application/vnd.kafka.binary.v2+json`.\n \n+== Message format\n+\n+When sending messages using the `/topics/` endpoint, you enter the message payload in the `records` parameter in the request body.\n+\n+The `records` parameter can contain any of these optional fields:\n+\n+* Message `headers`\n+* Message `key`\n+* Message `value`\n+* Destination `partition`\n+\n+.Example `POST` request\n+[source,curl,subs=attributes+]\n+----\n+curl -X POST \\\n+  http://localhost:8080/topics/my-topic \\\n+  -H 'content-type: application/vnd.kafka.json.v2+json' \\\n+  -d '{\n+    \"records\": [\n+        {\n+            \"key\": \"my-key\",\n+            \"value\": \"sales-lead-0001\"\n+            \"partition\": 2\n+            \"headers\": [\n+              {\n+                \"key\": \"key1\",\n+                \"value\": \"value1\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0c31f60465548dcbfd8156a1447373d0fb33eb9"}, "originalPosition": 54}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "689d330145299506f3e553716a59fe3a72db81f3", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/689d330145299506f3e553716a59fe3a72db81f3", "committedDate": "2020-10-26T15:54:18Z", "message": "review comments\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE2OTI1NjQ2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#pullrequestreview-516925646", "createdAt": "2020-10-26T15:55:45Z", "commit": {"oid": "689d330145299506f3e553716a59fe3a72db81f3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3MDg5MDc5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3819#pullrequestreview-517089079", "createdAt": "2020-10-26T19:02:01Z", "commit": {"oid": "689d330145299506f3e553716a59fe3a72db81f3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 814, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}