{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNDM4NjAy", "number": 2956, "title": "[DOC] Cruise Control: rebalance procedures and overview of goals and proposals", "bodyText": "Type of change\n\nDocumentation\n\nDescription\nAdded three new modules to the existing Cruise Control section of the Using Strimzi guide.\n\n\"Rebalance goals and proposals\" (concept)\n\"Generating rebalance proposals\" (procedure)\n\"Implementing a rebalance proposal\" (procedure)\n\nTo make the content easier to review, I recommend using the Asciidoctor.js Live Preview extension for Chrome or Firefox. You can simply open the raw file in a new browser tab and the extension will render the markup for you.\nAlso reordered the include statements in the assembly. Hopefully the information is introduced in a logical order!\nMade some minor edits to the existing Cruise Control documentation. However, future PRs will need to make further edits to align the terminology, e.g. \"rebalance proposals\" instead of \"optimization proposals\".\nChecklist\nPlease go through this checklist and make sure all applicable tasks have been done\n\n Update/write design documentation in ./design\n Write tests\n Make sure all tests pass\n Update documentation\n Check RBAC rights for Kubernetes / OpenShift roles\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging - NO ISSUES FOUND\n Update CHANGELOG.md", "createdAt": "2020-05-05T10:45:55Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956", "merged": true, "mergeCommit": {"oid": "183d3ce6d1b4661cc30797fdf5939d0e2552b003"}, "closed": true, "closedAt": "2020-05-20T14:51:15Z", "author": {"login": "laidan6000"}, "timelineItems": {"totalCount": 102, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcjJKjLAH2gAyNDEzNDM4NjAyOmViODg1MzVkMWQ5NmVhMzQyZjMxOGJmY2I5YjI0NDk2NjEzMmRkY2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjJTfcAFqTQxNTM0ODgzMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "eb88535d1d96ea342f318bfcb9b244966132ddcf", "author": {"user": {"login": "ppatierno", "name": "Paolo Patierno"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/eb88535d1d96ea342f318bfcb9b244966132ddcf", "committedDate": "2020-05-20T13:34:06Z", "message": "Update documentation/modules/cruise-control/proc-fixing-problems-with-kafkarebalance.adoc\n\nCo-authored-by: Tom Bentley <tombentley@users.noreply.github.com>\nSigned-off-by: Paolo Patierno <ppatierno@live.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MzQ4ODMw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-415348830", "createdAt": "2020-05-20T13:43:52Z", "commit": {"oid": "7137a5d635b92b0729a74041a02f5d2e7b50a061"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3395ac2256a5a7c6b9be54c61de77a2b1ada130", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/a3395ac2256a5a7c6b9be54c61de77a2b1ada130", "committedDate": "2020-04-30T13:35:54Z", "message": "Deleted the two empty procedures\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "14e83eb50f65428196cb3196e770b44bf1ac9ed7", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/14e83eb50f65428196cb3196e770b44bf1ac9ed7", "committedDate": "2020-04-30T14:07:53Z", "message": "Added goals concept and 2 procedures\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ff558c9b1035d1bfe2bf66a36f71e089ff2a8e5d", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ff558c9b1035d1bfe2bf66a36f71e089ff2a8e5d", "committedDate": "2020-05-01T12:58:19Z", "message": "Goals overview content\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11e2d1d22e929b1e603358c8455d13c70982709a", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/11e2d1d22e929b1e603358c8455d13c70982709a", "committedDate": "2020-05-01T16:56:13Z", "message": "More content\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d0a63f1a27e007ac57b12b2114900e91581fbb60", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d0a63f1a27e007ac57b12b2114900e91581fbb60", "committedDate": "2020-05-04T10:15:00Z", "message": "Further edits\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b94a02f0e4d7c4d467cfc3c13321a4f6b79fd8b", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/6b94a02f0e4d7c4d467cfc3c13321a4f6b79fd8b", "committedDate": "2020-05-04T14:32:12Z", "message": "Content on rebalance proposals\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e3bd839e4914296d112c0ca76a239f706b1b9d6", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3e3bd839e4914296d112c0ca76a239f706b1b9d6", "committedDate": "2020-05-04T17:03:21Z", "message": "Further edits\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/5053b8124da124a19a976f79126a8ce070bcb49c", "committedDate": "2020-05-05T10:06:17Z", "message": "Changes to existing CC docs\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MzIzMzQw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406323340", "createdAt": "2020-05-06T06:07:11Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 30, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwNjowNzoxMVrOGRFIhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwNjoyMTowNlrOGRFZSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2MzA3OA==", "bodyText": "What does it mean \"...supports the same goals as the Kafka Cruise Control\"? Strimzi is using Kafka Cruise Control! Thinking on this, if the CC community names them \"optimization goals\" why we should change to \"rebalance goals\"? Isn't it better having consistency?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420563078", "createdAt": "2020-05-06T06:07:11Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2MzU4NA==", "bodyText": "I would swap the order between this line and the NOTE above.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420563584", "createdAt": "2020-05-06T06:08:57Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NDAxMw==", "bodyText": "because we are talking about soft goals, can we swap the order in this sentence, something like ...\" A rebalance proposal that violates one or more soft goals but satisfies all hard goals is valid\"", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420564013", "createdAt": "2020-05-06T06:10:23Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NDM5OQ==", "bodyText": "even if in a rebalance proposal request you can set a flag like \"skip hard goals check\" and in this case, should we mention it here? wdyt @tomncooper @kyguy ?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420564399", "createdAt": "2020-05-06T06:11:39Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NDU0Ng==", "bodyText": "\"are defined in the cruise control deployment configuration\"", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420564546", "createdAt": "2020-05-06T06:12:12Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NDk0OQ==", "bodyText": "now the resource is KafkaRebalance. Didn't we decide to not use the word \"custom\" here because it conflicts with the custom goal classes that a developer can write by himself?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420564949", "createdAt": "2020-05-06T06:13:35Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  \n+\n+*Default rebalance goals and cached proposal*\n+\n+The default rebalance goals are set in the `Kafka` custom resource. \n+You specify a list of goals in `spec.cruiseControl.config.default.goals`.\n+\n+Unless you set custom rebalance goals, the default rebalance goals are used by Cruise Control to return a _cached rebalance proposal_. \n+The cached proposal reflects the current state of the Kafka cluster and is updated every 15 minutes by default. \n+\n+To review the list of default goals, see link:https://github.com/linkedin/cruise-control/wiki/Configurations#analyzer-configurations[Analyzer Configurations^] in the Cruise Control Wiki.\n+\n+For more information on setting the default rebalance goals, see xref:ref-cruise-control-configuration-{context}[]. \n+\n+*Custom rebalance goals* \n+\n+Custom rebalance goals are set in the `spec.goals` section of a `KafkaClusterRebalance` resource and override the default rebalance goals. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 99}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NTA1Mw==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420565053", "createdAt": "2020-05-06T06:13:54Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  \n+\n+*Default rebalance goals and cached proposal*\n+\n+The default rebalance goals are set in the `Kafka` custom resource. \n+You specify a list of goals in `spec.cruiseControl.config.default.goals`.\n+\n+Unless you set custom rebalance goals, the default rebalance goals are used by Cruise Control to return a _cached rebalance proposal_. \n+The cached proposal reflects the current state of the Kafka cluster and is updated every 15 minutes by default. \n+\n+To review the list of default goals, see link:https://github.com/linkedin/cruise-control/wiki/Configurations#analyzer-configurations[Analyzer Configurations^] in the Cruise Control Wiki.\n+\n+For more information on setting the default rebalance goals, see xref:ref-cruise-control-configuration-{context}[]. \n+\n+*Custom rebalance goals* \n+\n+Custom rebalance goals are set in the `spec.goals` section of a `KafkaClusterRebalance` resource and override the default rebalance goals. \n+If no custom rebalance goals are set, the default rebalance goals are used.\n+\n+Use custom rebalance goals to generate a rebalance proposal that addresses a particular optimization scenario. \n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering other goals, such as disk or CPU usage. \n+So, you create a `KafkaClusterRebalance` resource containing a custom rebalance goal for leader replica distribution only.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 104}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NTI4MA==", "bodyText": "Again you can set a skip hard goals check flag in the KafkaRebalace custom resource.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420565280", "createdAt": "2020-05-06T06:14:36Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  \n+\n+*Default rebalance goals and cached proposal*\n+\n+The default rebalance goals are set in the `Kafka` custom resource. \n+You specify a list of goals in `spec.cruiseControl.config.default.goals`.\n+\n+Unless you set custom rebalance goals, the default rebalance goals are used by Cruise Control to return a _cached rebalance proposal_. \n+The cached proposal reflects the current state of the Kafka cluster and is updated every 15 minutes by default. \n+\n+To review the list of default goals, see link:https://github.com/linkedin/cruise-control/wiki/Configurations#analyzer-configurations[Analyzer Configurations^] in the Cruise Control Wiki.\n+\n+For more information on setting the default rebalance goals, see xref:ref-cruise-control-configuration-{context}[]. \n+\n+*Custom rebalance goals* \n+\n+Custom rebalance goals are set in the `spec.goals` section of a `KafkaClusterRebalance` resource and override the default rebalance goals. \n+If no custom rebalance goals are set, the default rebalance goals are used.\n+\n+Use custom rebalance goals to generate a rebalance proposal that addresses a particular optimization scenario. \n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering other goals, such as disk or CPU usage. \n+So, you create a `KafkaClusterRebalance` resource containing a custom rebalance goal for leader replica distribution only.\n+\n+Using custom rebalance goals often returns a rebalance proposal faster than the default rebalance goals. \n+They must always be a subset of the default rebalance goals.\n+\n+For more information on setting custom rebalance goals, see xref:proc-generating-rebalance-proposals-{context}[].\n+\n+[discrete]\n+== Rebalance proposals\n+\n+A _rebalance proposal_ is a summary of proposed changes from Cruise Control that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly across the brokers. \n+Each rebalance proposal is based on the set of rebalance goals (either default goals or custom goals) that were used to generate it.\n+\n+Rebalance proposals always satisfy all the supplied hard goals, though not necessarily all the supplied soft goals.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 117}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NTQ4Mg==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420565482", "createdAt": "2020-05-06T06:15:15Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NTUzOA==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420565538", "createdAt": "2020-05-06T06:15:29Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.\n+This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.\n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+.Procedure\n+\n+. Create a `KafkaClusterRebalance` resource:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NTU4Mg==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420565582", "createdAt": "2020-05-06T06:15:38Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.\n+This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.\n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+.Procedure\n+\n+. Create a `KafkaClusterRebalance` resource:\n+\n+.. To use the default rebalance goals defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NTY2Mw==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420565663", "createdAt": "2020-05-06T06:15:55Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.\n+This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.\n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+.Procedure\n+\n+. Create a `KafkaClusterRebalance` resource:\n+\n+.. To use the default rebalance goals defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+.. To use one or more custom rebalance goals instead of the default goals, edit the `spec.goals` property.\n+In the following example, rack awareness and replica capacity are set as custom goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NTcyNQ==", "bodyText": "The FQDN is not needed, just the classes names.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420565725", "createdAt": "2020-05-06T06:16:08Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.\n+This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.\n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+.Procedure\n+\n+. Create a `KafkaClusterRebalance` resource:\n+\n+.. To use the default rebalance goals defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+.. To use one or more custom rebalance goals instead of the default goals, edit the `spec.goals` property.\n+In the following example, rack awareness and replica capacity are set as custom goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+    goals: >\n+      com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n+      com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NTgzMA==", "bodyText": "kafkarebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420565830", "createdAt": "2020-05-06T06:16:24Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.\n+This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.\n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+.Procedure\n+\n+. Create a `KafkaClusterRebalance` resource:\n+\n+.. To use the default rebalance goals defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+.. To use one or more custom rebalance goals instead of the default goals, edit the `spec.goals` property.\n+In the following example, rack awareness and replica capacity are set as custom goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+    goals: >\n+      com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n+      com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+oc apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the rebalance proposal from the Cruise Control server.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NjAzNQ==", "bodyText": "no, there is no action to take by the user in a few minutes. The rebalance operator is polling the cruise control API to check when the proposal is ready.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420566035", "createdAt": "2020-05-06T06:17:04Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.\n+This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.\n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+.Procedure\n+\n+. Create a `KafkaClusterRebalance` resource:\n+\n+.. To use the default rebalance goals defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+.. To use one or more custom rebalance goals instead of the default goals, edit the `spec.goals` property.\n+In the following example, rack awareness and replica capacity are set as custom goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+    goals: >\n+      com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n+      com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+oc apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the rebalance proposal from the Cruise Control server.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'\n+----\n+Cruise Control returns one of two statuses:\n+\n+** `PendingProposal`: The rebalance proposal is not yet ready; try again after a few minutes.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NjIwNA==", "bodyText": "we should be clear where this summary here, providing a full example of the status in the ``KafkaRebalance` resource.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420566204", "createdAt": "2020-05-06T06:17:36Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.\n+This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.\n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+.Procedure\n+\n+. Create a `KafkaClusterRebalance` resource:\n+\n+.. To use the default rebalance goals defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+.. To use one or more custom rebalance goals instead of the default goals, edit the `spec.goals` property.\n+In the following example, rack awareness and replica capacity are set as custom goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaClusterRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+    goals: >\n+      com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n+      com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+oc apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the rebalance proposal from the Cruise Control server.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'\n+----\n+Cruise Control returns one of two statuses:\n+\n+** `PendingProposal`: The rebalance proposal is not yet ready; try again after a few minutes.\n+\n+** `ProposalReady`: The rebalance proposal is ready for you to review and implement, if desired.\n+The status is followed by the JSON rebalance proposal.\n+\n+. Review the rebalance proposal. \n+For example:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+\"summary\": {\n+  \"numIntraBrokerReplicaMovements\":0,\n+  \"excludedBrokersForLeadership\":[],\n+  \"numReplicaMovements\":31,\n+  \"onDemandBalancednessScoreAfter\":84.08179174145127,\n+  \"onDemandBalancednessScoreBefore\":79.74705957325753,\n+  \"intraBrokerDataToMoveMB\":0,\n+  \"recentWindows\":1,\n+  \"dataToMoveMB\":0,\n+  \"monitoredPartitionsPercentage\":100.0,\n+  \"excludedTopics\":[],\n+  \"numLeaderMovements\":12,\n+  \"excludedBrokersForReplicaMove\":[]\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NjI1Ng==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420566256", "createdAt": "2020-05-06T06:17:45Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NjU4NA==", "bodyText": "no. when the proposal is in ProposalReady state, the user has to apply strimzi.io/rebalance=approve annotation to trigger the actual rebalancing.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420566584", "createdAt": "2020-05-06T06:18:42Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NjY1OA==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420566658", "createdAt": "2020-05-06T06:18:53Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2Njg4OA==", "bodyText": "we should be clear why the user should refresh so if after having the proposal ready, he doesn't execute it for long time and it becomes stale.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420566888", "createdAt": "2020-05-06T06:19:35Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NjkxNg==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420566916", "createdAt": "2020-05-06T06:19:39Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2Njk3Mw==", "bodyText": "kafkarebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420566973", "createdAt": "2020-05-06T06:19:49Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=refresh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NzAwOA==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420567008", "createdAt": "2020-05-06T06:19:56Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaClusterRebalance` resource:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NzA1OQ==", "bodyText": "kafkarebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420567059", "createdAt": "2020-05-06T06:20:04Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NzA5Mg==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420567092", "createdAt": "2020-05-06T06:20:11Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the rebalance proposal that you want to implement.\n++\n+Annotate the `KafkaClusterRebalance` resource in Kubernetes:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NzEzNQ==", "bodyText": "kafkarebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420567135", "createdAt": "2020-05-06T06:20:19Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the rebalance proposal that you want to implement.\n++\n+Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=approved", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NzIzNA==", "bodyText": "no. the rebalancing process starts immediately when the \"approve\" annotation is applied.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420567234", "createdAt": "2020-05-06T06:20:39Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the rebalance proposal that you want to implement.\n++\n+Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=approved\n+----\n+\n+. Wait for the next reconciliation to occur (every two minutes by default).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NzMwOQ==", "bodyText": "no. see above.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420567309", "createdAt": "2020-05-06T06:20:54Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the rebalance proposal that you want to implement.\n++\n+Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=approved\n+----\n+\n+. Wait for the next reconciliation to occur (every two minutes by default).\n++\n+At the next reconciliation, the Cluster Operator detects the annotated resource and instructs Cruise Control to rebalance the Kafka cluster.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NzMyMw==", "bodyText": "KafkaRebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420567323", "createdAt": "2020-05-06T06:20:57Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the rebalance proposal that you want to implement.\n++\n+Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=approved\n+----\n+\n+. Wait for the next reconciliation to occur (every two minutes by default).\n++\n+At the next reconciliation, the Cluster Operator detects the annotated resource and instructs Cruise Control to rebalance the Kafka cluster.\n+\n+. Check the status of the `KafkaClusterRebalance` resource:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDU2NzM2OA==", "bodyText": "kafkarebalance", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420567368", "createdAt": "2020-05-06T06:21:06Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. \n+Review the rebalance proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-rebalance-proposals-{context}[generated a rebalance proposal].\n+\n+* The rebalance proposal is ready to implement (the `KafkaClusterRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+. (Optional) Refresh the rebalance proposal that you want to implement:\n+\n+.. Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the rebalance proposal that you want to implement.\n++\n+Annotate the `KafkaClusterRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkaclusterrebalance _cluster-name_-kafka strimzi.io/rebalance=approved\n+----\n+\n+. Wait for the next reconciliation to occur (every two minutes by default).\n++\n+At the next reconciliation, the Cluster Operator detects the annotated resource and instructs Cruise Control to rebalance the Kafka cluster.\n+\n+. Check the status of the `KafkaClusterRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkaclusterrebalance -o jsonpath='{.status}'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 59}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDMxNTQz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406431543", "createdAt": "2020-05-06T09:11:12Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToxMToxMlrOGRKVTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToxMToxMlrOGRKVTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY0ODI2OA==", "bodyText": "So this is a nit, but the goals are not strictly \"rebalance\" goals, they are \"optimization\" goals.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420648268", "createdAt": "2020-05-06T09:11:12Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDMyNDIy", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406432422", "createdAt": "2020-05-06T09:12:26Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToxMjoyNlrOGRKYBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToxMjoyNlrOGRKYBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY0ODk2NQ==", "bodyText": "Optimization Goals would be a better (more accurate) name", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420648965", "createdAt": "2020-05-06T09:12:26Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDMyOTY1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406432965", "createdAt": "2020-05-06T09:13:12Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToxMzoxMlrOGRKZqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToxMzoxMlrOGRKZqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY0OTM4Ng==", "bodyText": "We are not redistributing resources (we are not moving CPUs and RAM) we are redistributing load.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420649386", "createdAt": "2020-05-06T09:13:12Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDM5NjA4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406439608", "createdAt": "2020-05-06T09:22:27Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToyMjoyN1rOGRKtng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToyMjoyN1rOGRKtng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1NDQ5NA==", "bodyText": "Can we call them optimization proposals rather than rebalance proposals.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420654494", "createdAt": "2020-05-06T09:22:27Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 82}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDQxMDIx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406441021", "createdAt": "2020-05-06T09:24:24Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToyNDoyNVrOGRKx6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToyNDoyNVrOGRKx6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1NTU5NQ==", "bodyText": "Well, you can have as many soft goals as you like but you must include all the configured hard.goals or include skip_hard_goal_check=true. Else the rebalance request will fail.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420655595", "createdAt": "2020-05-06T09:24:25Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 83}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDQxNjk5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406441699", "createdAt": "2020-05-06T09:25:21Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToyNToyMlrOGRK0IQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToyNToyMlrOGRK0IQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1NjE2MQ==", "bodyText": "Unless you set custom rebalance goals, in the KafakRebalance custom resource,...", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420656161", "createdAt": "2020-05-06T09:25:22Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  \n+\n+*Default rebalance goals and cached proposal*\n+\n+The default rebalance goals are set in the `Kafka` custom resource. \n+You specify a list of goals in `spec.cruiseControl.config.default.goals`.\n+\n+Unless you set custom rebalance goals, the default rebalance goals are used by Cruise Control to return a _cached rebalance proposal_. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 90}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDQzMTEz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406443113", "createdAt": "2020-05-06T09:27:18Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToyNzoxOFrOGRK4eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOToyNzoxOFrOGRK4eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1NzI3NA==", "bodyText": "The cached proposal is generated every 15 min by default using the default.goals specified in Kafka spec. If no default goals are specified in the Kafka spec then the default.goals=goals.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420657274", "createdAt": "2020-05-06T09:27:18Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  \n+\n+*Default rebalance goals and cached proposal*\n+\n+The default rebalance goals are set in the `Kafka` custom resource. \n+You specify a list of goals in `spec.cruiseControl.config.default.goals`.\n+\n+Unless you set custom rebalance goals, the default rebalance goals are used by Cruise Control to return a _cached rebalance proposal_. \n+The cached proposal reflects the current state of the Kafka cluster and is updated every 15 minutes by default. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 91}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDQ1MDg2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406445086", "createdAt": "2020-05-06T09:30:02Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozMDowMlrOGRK-mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozMDowMlrOGRK-mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1ODg0Mg==", "bodyText": "We do need to clearly document that if they specify a list of goals in the KafkaRebalance resource that does not include all the configured hard.goals they will get an error. In that case they need to set skiphardgoalscheck: true in the resource.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420658842", "createdAt": "2020-05-06T09:30:02Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  \n+\n+*Default rebalance goals and cached proposal*\n+\n+The default rebalance goals are set in the `Kafka` custom resource. \n+You specify a list of goals in `spec.cruiseControl.config.default.goals`.\n+\n+Unless you set custom rebalance goals, the default rebalance goals are used by Cruise Control to return a _cached rebalance proposal_. \n+The cached proposal reflects the current state of the Kafka cluster and is updated every 15 minutes by default. \n+\n+To review the list of default goals, see link:https://github.com/linkedin/cruise-control/wiki/Configurations#analyzer-configurations[Analyzer Configurations^] in the Cruise Control Wiki.\n+\n+For more information on setting the default rebalance goals, see xref:ref-cruise-control-configuration-{context}[]. \n+\n+*Custom rebalance goals* \n+\n+Custom rebalance goals are set in the `spec.goals` section of a `KafkaClusterRebalance` resource and override the default rebalance goals. \n+If no custom rebalance goals are set, the default rebalance goals are used.\n+\n+Use custom rebalance goals to generate a rebalance proposal that addresses a particular optimization scenario. \n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering other goals, such as disk or CPU usage. \n+So, you create a `KafkaClusterRebalance` resource containing a custom rebalance goal for leader replica distribution only.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 104}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDQ2MDA2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406446006", "createdAt": "2020-05-06T09:31:20Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozMToyMVrOGRLBgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozMToyMVrOGRLBgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1OTU4Nw==", "bodyText": "I don't know where you got that idea but it is not true.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420659587", "createdAt": "2020-05-06T09:31:21Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  \n+\n+*Default rebalance goals and cached proposal*\n+\n+The default rebalance goals are set in the `Kafka` custom resource. \n+You specify a list of goals in `spec.cruiseControl.config.default.goals`.\n+\n+Unless you set custom rebalance goals, the default rebalance goals are used by Cruise Control to return a _cached rebalance proposal_. \n+The cached proposal reflects the current state of the Kafka cluster and is updated every 15 minutes by default. \n+\n+To review the list of default goals, see link:https://github.com/linkedin/cruise-control/wiki/Configurations#analyzer-configurations[Analyzer Configurations^] in the Cruise Control Wiki.\n+\n+For more information on setting the default rebalance goals, see xref:ref-cruise-control-configuration-{context}[]. \n+\n+*Custom rebalance goals* \n+\n+Custom rebalance goals are set in the `spec.goals` section of a `KafkaClusterRebalance` resource and override the default rebalance goals. \n+If no custom rebalance goals are set, the default rebalance goals are used.\n+\n+Use custom rebalance goals to generate a rebalance proposal that addresses a particular optimization scenario. \n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering other goals, such as disk or CPU usage. \n+So, you create a `KafkaClusterRebalance` resource containing a custom rebalance goal for leader replica distribution only.\n+\n+Using custom rebalance goals often returns a rebalance proposal faster than the default rebalance goals. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 106}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDQ2MzU1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406446355", "createdAt": "2020-05-06T09:31:49Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozMTo0OVrOGRLChw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozMTo0OVrOGRLChw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1OTg0Nw==", "bodyText": "This is kinda true, they must be a subset of the goals list.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420659847", "createdAt": "2020-05-06T09:31:49Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  \n+\n+*Default rebalance goals and cached proposal*\n+\n+The default rebalance goals are set in the `Kafka` custom resource. \n+You specify a list of goals in `spec.cruiseControl.config.default.goals`.\n+\n+Unless you set custom rebalance goals, the default rebalance goals are used by Cruise Control to return a _cached rebalance proposal_. \n+The cached proposal reflects the current state of the Kafka cluster and is updated every 15 minutes by default. \n+\n+To review the list of default goals, see link:https://github.com/linkedin/cruise-control/wiki/Configurations#analyzer-configurations[Analyzer Configurations^] in the Cruise Control Wiki.\n+\n+For more information on setting the default rebalance goals, see xref:ref-cruise-control-configuration-{context}[]. \n+\n+*Custom rebalance goals* \n+\n+Custom rebalance goals are set in the `spec.goals` section of a `KafkaClusterRebalance` resource and override the default rebalance goals. \n+If no custom rebalance goals are set, the default rebalance goals are used.\n+\n+Use custom rebalance goals to generate a rebalance proposal that addresses a particular optimization scenario. \n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering other goals, such as disk or CPU usage. \n+So, you create a `KafkaClusterRebalance` resource containing a custom rebalance goal for leader replica distribution only.\n+\n+Using custom rebalance goals often returns a rebalance proposal faster than the default rebalance goals. \n+They must always be a subset of the default rebalance goals.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 107}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDQ3NzI3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406447727", "createdAt": "2020-05-06T09:33:44Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozMzo0NFrOGRLGiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozMzo0NFrOGRLGiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY2MDg3Mg==", "bodyText": "I will find some time to update the explainer docs with definitions of what the terms mean.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420660872", "createdAt": "2020-05-06T09:33:44Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. \n+Both types of rebalance goal can be configured to include hard goals as well as soft goals.  \n+\n+*Default rebalance goals and cached proposal*\n+\n+The default rebalance goals are set in the `Kafka` custom resource. \n+You specify a list of goals in `spec.cruiseControl.config.default.goals`.\n+\n+Unless you set custom rebalance goals, the default rebalance goals are used by Cruise Control to return a _cached rebalance proposal_. \n+The cached proposal reflects the current state of the Kafka cluster and is updated every 15 minutes by default. \n+\n+To review the list of default goals, see link:https://github.com/linkedin/cruise-control/wiki/Configurations#analyzer-configurations[Analyzer Configurations^] in the Cruise Control Wiki.\n+\n+For more information on setting the default rebalance goals, see xref:ref-cruise-control-configuration-{context}[]. \n+\n+*Custom rebalance goals* \n+\n+Custom rebalance goals are set in the `spec.goals` section of a `KafkaClusterRebalance` resource and override the default rebalance goals. \n+If no custom rebalance goals are set, the default rebalance goals are used.\n+\n+Use custom rebalance goals to generate a rebalance proposal that addresses a particular optimization scenario. \n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering other goals, such as disk or CPU usage. \n+So, you create a `KafkaClusterRebalance` resource containing a custom rebalance goal for leader replica distribution only.\n+\n+Using custom rebalance goals often returns a rebalance proposal faster than the default rebalance goals. \n+They must always be a subset of the default rebalance goals.\n+\n+For more information on setting custom rebalance goals, see xref:proc-generating-rebalance-proposals-{context}[].\n+\n+[discrete]\n+== Rebalance proposals\n+\n+A _rebalance proposal_ is a summary of proposed changes from Cruise Control that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly across the brokers. \n+Each rebalance proposal is based on the set of rebalance goals (either default goals or custom goals) that were used to generate it.\n+\n+Rebalance proposals always satisfy all the supplied hard goals, though not necessarily all the supplied soft goals.\n+\n+A rebalance proposal provides the following information in JSON:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the rebalance goals. \n+\n+All rebalance proposals are dry runs. You cannot implement a cluster rebalance without first generating a rebalance proposal. \n+There is no limit to the number of rebalance proposals that can be generated.\n+\n+The following table lists the properties contained in a rebalance proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 136}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NDQ5MTk5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406449199", "createdAt": "2020-05-06T09:35:49Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozNTo0OVrOGRLLVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQwOTozNTo0OVrOGRLLVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY2MjEwMw==", "bodyText": "So it is not just partitions to brokers, it also proposes changes to partition replica leaders.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420662103", "createdAt": "2020-05-06T09:35:49Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.\n+This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20d4df5aea4f3ce383a45f1c8fb2e8274e5d6b6f", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/20d4df5aea4f3ce383a45f1c8fb2e8274e5d6b6f", "committedDate": "2020-05-06T13:23:32Z", "message": "Review comments PP round one\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2NjYyOTc3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406662977", "createdAt": "2020-05-06T14:22:04Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNDoyMjowNFrOGRVfUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNDoyMjowNFrOGRVfUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDgzMTA1OA==", "bodyText": "There is still some outstanding work needed to support the CPU capacity,  CPU utilization distribution,  Intra-broker disk capacity, and Intra-broker disk usage distribution goals, so those can be removed from this list", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420831058", "createdAt": "2020-05-06T14:22:04Z", "author": {"login": "kyguy"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2Njc2MTMz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-406676133", "createdAt": "2020-05-06T14:35:09Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNDozNTowOVrOGRWHMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNDozNTowOVrOGRWHMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg0MTI2NA==", "bodyText": "Should we be mentioning custom goals when we don't support the addition of them?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r420841264", "createdAt": "2020-05-06T14:35:09Z", "author": {"login": "kyguy"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. \n+However, they are included in rebalance calculations. \n+A rebalance proposal that satisfies _all_ hard goals but violates one or more soft goals is valid.\n+\n+Rebalance goals are treated as soft goals, unless designated as hard goals\n+\n+\u00a6Attempt to distribute a topic's replicas evenly across the cluster (topic replica distribution goal). \n+Ignore this goal if doing so will enable all hard goals to be met.\n+\n+\u00a6Hard goals\n+\n+\u00a6Hard goals _must_ be satisfied in rebalance proposals. \n+In other words, a rebalance proposal that does _not_ satisfy all the designated hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Designating hard goals is optional.\n+\u00a6All brokers in the cluster must have fewer than 3 replicas (replica capacity goal).\n+\n+|===\n+\n+[discrete]\n+=== Default and custom rebalance goals\n+\n+When interacting with Cruise Control to generate rebalance proposals, you can use the _default rebalance goals_, which are defined on deployment, or set ad hoc _custom rebalance goals_. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 82}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3Mjk4MzEx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-407298311", "createdAt": "2020-05-07T09:24:02Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToyNDowM1rOGR2D2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToyNDowM1rOGR2D2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM2NDY5OQ==", "bodyText": "alongside? In the same Kubernetes cluster?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r421364699", "createdAt": "2020-05-07T09:24:03Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/cruise-control/con-cruise-control-overview.adoc", "diffHunk": "@@ -11,12 +11,19 @@\n \n Brokers in a Kafka cluster can become unevenly loaded for many reasons.\n For example, partitions that handle large amounts of message traffic can be unevenly distributed across the available brokers.\n-Monitoring broker load and reassigning busy partitions to brokers with spare capacity is time consuming and adds to the overhead of managing a Kafka cluster.\n-Cruise Control is a tool for automating the monitoring and rebalancing of partitions across a Kafka cluster.\n+Monitoring this broker load and reassigning busy partitions to brokers with spare capacity is time consuming and adds to the overhead of managing a Kafka cluster.\n+\n+Cruise Control helps to automate the monitoring and rebalancing of partitions across a Kafka cluster.\n When deployed alongside a Kafka cluster, Cruise Control can perform the following cluster balancing tasks:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MzAwNDY4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-407300468", "createdAt": "2020-05-07T09:26:55Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToyNjo1NlrOGR2LAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOToyNjo1NlrOGR2LAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM2NjUyOA==", "bodyText": "can perform? Or performs? Is this by default, automatic or depending on how its configured?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r421366528", "createdAt": "2020-05-07T09:26:56Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/cruise-control/con-cruise-control-overview.adoc", "diffHunk": "@@ -11,12 +11,19 @@\n \n Brokers in a Kafka cluster can become unevenly loaded for many reasons.\n For example, partitions that handle large amounts of message traffic can be unevenly distributed across the available brokers.\n-Monitoring broker load and reassigning busy partitions to brokers with spare capacity is time consuming and adds to the overhead of managing a Kafka cluster.\n-Cruise Control is a tool for automating the monitoring and rebalancing of partitions across a Kafka cluster.\n+Monitoring this broker load and reassigning busy partitions to brokers with spare capacity is time consuming and adds to the overhead of managing a Kafka cluster.\n+\n+Cruise Control helps to automate the monitoring and rebalancing of partitions across a Kafka cluster.\n When deployed alongside a Kafka cluster, Cruise Control can perform the following cluster balancing tasks:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MzAzMzQ2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-407303346", "createdAt": "2020-05-07T09:30:50Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOTozMDo1MFrOGR2USQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOTozMDo1MFrOGR2USQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM2ODkwNQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Following are the supported goals, which you can reorder in priority, enable, or disable:\n          \n          \n            \n            Following are the supported goals, which you can reorder in terms of priority, and enable or disable:", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r421368905", "createdAt": "2020-05-07T09:30:50Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MzA2MzYw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-407306360", "createdAt": "2020-05-07T09:34:52Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOTozNDo1MlrOGR2eUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QwOTozNDo1MlrOGR2eUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM3MTQ3NA==", "bodyText": "\"best effort\" -- I tend to only italics (best effort) to emphasize terms", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r421371474", "createdAt": "2020-05-07T09:34:52Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/cruise-control/con-rebalance-goals-proposals.adoc", "diffHunk": "@@ -0,0 +1,180 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-rebalance-goals-proposals-{context}']\n+= Rebalance goals and proposals\n+\n+To rebalance a Kafka cluster, Cruise Control uses _rebalance goals_ to generate _rebalance proposals_. \n+\n+[discrete]\n+== Rebalance goals\n+\n+Rebalance goals specify targets for resource distribution and utilization across a Kafka cluster. \n+They are organized in a customizable hierarchy, from high priority goals to low priority goals. \n+You can designate certain rebalance goals as _hard goals_ that must be satisfied--for more information, see link:#soft-hard-goals[Soft goals and hard goals].\n+\n+With a few exceptions, cluster rebalancing in {ProductName} supports the same goals as the Kafka Cruise Control project (where the term \"optimization goals\" is used). \n+Following are the supported goals, which you can reorder in priority, enable, or disable:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity\n+.. Disk capacity\n+.. Network inbound capacity\n+.. Network outbound capacity\n+.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution\n+.. Disk utilization distribution\n+.. Network inbound utilization distribution\n+.. Network outbound utilization distribution\n+.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+. Intra-broker disk capacity\n+. Intra-broker disk usage distribution    \n+\n+NOTE: \"Write your own\" goals, Kafka assigner goals, and Anomaly Detector are not supported in {ProductName}.\n+\n+For detailed information on each rebalance goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki. \n+\n+[id=\"soft-hard-goals\"]\n+[discrete]\n+=== Soft goals and hard goals\n+\n+The following table explains the differences between soft and hard goals in cluster rebalance calculations:\n+\n+[cols=\"3*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+\u00a6Rebalance goal type\n+\u00a6Description\n+\u00a6Example\n+\n+\u00a6Soft goals\n+\n+\u00a6Also known as \"best effort\" goals, soft goals do _not_ need to be satisfied in rebalance proposals. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MzI3NzI0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-407327724", "createdAt": "2020-05-07T10:03:37Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDowMzozN1rOGR3h0w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDowMzozN1rOGR3h0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM4ODc1NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.\n          \n          \n            \n            This summarizes an optimal mapping of partitions to brokers for the Kafka cluster, based on the rebalance goals that were used, along with statistics on the cluster rebalance.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r421388755", "createdAt": "2020-05-07T10:03:37Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,98 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-rebalance-proposals-{context}']\n+= Generating rebalance proposals \n+\n+When you create or update a `KafkaClusterRebalance` resource, Cruise Control generates a _rebalance proposal_ in JSON.\n+This summarizes an optimal mapping of partitions to brokers for the Kafka cluster based on the rebalance goals that were used along with statistics on the cluster rebalance.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecfa072eb7f1d6cc72dd3aea3bf06278e8d15a47", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ecfa072eb7f1d6cc72dd3aea3bf06278e8d15a47", "committedDate": "2020-05-07T10:07:01Z", "message": "rebalance goals to optimization goals\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MzM2MDU3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-407336057", "createdAt": "2020-05-07T10:15:46Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoxNTo0NlrOGR38rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QxMDoxNTo0NlrOGR38rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTM5NTYzMA==", "bodyText": "Is dry run universally understood?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r421395630", "createdAt": "2020-05-07T10:15:46Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,74 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-rebalance-proposal-{context}']\n+= Implementing a rebalance proposal\n+\n+If you are satisfied with a rebalance proposal, you can implement it by annotating the corresponding `KafkaClusterRebalance` resource. \n+\n+At the next reconciliation, the Cluster Operator will instruct Cruise Control to rebalance the Kafka cluster. \n+Cruise Control then reassigns partitions to brokers as summarized in the rebalance proposal.\n+\n+WARNING: This is not a dry run. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3MzM4MjM3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-407338237", "createdAt": "2020-05-07T10:18:56Z", "commit": {"oid": "5053b8124da124a19a976f79126a8ce070bcb49c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d2d711c633488c9f1f6727f1044959420de8a7c", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/8d2d711c633488c9f1f6727f1044959420de8a7c", "committedDate": "2020-05-07T15:20:43Z", "message": "Review edits PP, PM, KL\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba2a1256c4ddc54c4a5b33c8a3f749df253ba834", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/ba2a1256c4ddc54c4a5b33c8a3f749df253ba834", "committedDate": "2020-05-08T11:07:43Z", "message": "Review edits TC, round one\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3adceb814a1bce9faf40a4032dd9879a694d1149", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3adceb814a1bce9faf40a4032dd9879a694d1149", "committedDate": "2020-05-11T16:18:52Z", "message": "Further edits\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2735071386662e99ddfe58fd316e212a126cc3a", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/d2735071386662e99ddfe58fd316e212a126cc3a", "committedDate": "2020-05-12T14:05:46Z", "message": "File renaming\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f4f3309595697ac1f54ee29a0400f9f617f7250", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/0f4f3309595697ac1f54ee29a0400f9f617f7250", "committedDate": "2020-05-12T15:18:28Z", "message": "Edits from eng docs sync\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "449e197f4929fb091266022e98c58b1ded018e98", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/449e197f4929fb091266022e98c58b1ded018e98", "committedDate": "2020-05-13T16:22:32Z", "message": "Completed edits from TC\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/70aa2d9d9fc22e530783df0072882645e464234a", "committedDate": "2020-05-14T10:33:01Z", "message": "Edits for consistency\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNjk0MTIw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411694120", "createdAt": "2020-05-14T11:01:43Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxMTowMTo0NFrOGVXHSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxMTowMTo0NFrOGVXHSg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTA1MTk3OA==", "bodyText": "This is contradicted in the \"Deploying Cruise Control\" procedure, which has a list of goals in the CC deployment configuration.\nconfig: (2)\n      default.goals: >\n         com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n         com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal\n         # ...\n      goals: >\n         com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n         com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal\n         # ...\n\nShould I change it to an empty value in that procedure?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425051978", "createdAt": "2020-05-14T11:01:44Z", "author": {"login": "laidan6000"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the default optimization goals (see below).\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, specify an empty value for the `goals` configuration option:\n++\n+[source=yaml]\n+----\n+goals: {}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTM2MTY4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411936168", "createdAt": "2020-05-14T15:43:02Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNTo0MzowM1rOGVidIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNTo0MzowM1rOGVidIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTIzNzc5NQ==", "bodyText": "Not sure I would be as definitive as \"we recommend\". I would approach this like the master goals above. By default the default.goal list will = the goals list. If however you are only concerned with a certain set of optimization goals then set them here.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425237795", "createdAt": "2020-05-14T15:43:03Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the default optimization goals (see below).\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, specify an empty value for the `goals` configuration option:\n++\n+[source=yaml]\n+----\n+goals: {}\n+----\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+We recommend that you always set _default optimization goals_ for the Kafka cluster.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 69}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTQ2MzA5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411946309", "createdAt": "2020-05-14T15:54:11Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNTo1NDoxMVrOGVi88g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNTo1NDoxMVrOGVi88g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI0NTkzOA==", "bodyText": "Dunno if it is worth mentioning that this can be altered by setting the proposal.expiration.ms setting in the Kafka CR CC config? More often is better for fast changing clusters but will put more load on CC server.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425245938", "createdAt": "2020-05-14T15:54:11Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the default optimization goals (see below).\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, specify an empty value for the `goals` configuration option:\n++\n+[source=yaml]\n+----\n+goals: {}\n+----\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+We recommend that you always set _default optimization goals_ for the Kafka cluster.\n+You can include any or all of the master optimization goals in the default optimization goals.\n+\n+Default optimization goals are set in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.default.goals`\n+\n+The default optimization goals generate the _cached optimization proposal_ from the workload model (unless you set user-provided optimization goals in a `KafkaRebalance` custom resource). \n+This is updated to reflect the current state of the Kafka cluster every 15 minutes by default. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 75}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTUwNzk0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411950794", "createdAt": "2020-05-14T15:58:05Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNTo1ODowNVrOGVjIHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNTo1ODowNVrOGVjIHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI0ODc5Nw==", "bodyText": "So that option will not exclude the hard.goal, it will just mean that CC does not complain if you miss any of the hard goals out of the user supplied rebalance goals.\nThis should probably read something like: \"If, for some reason, you want to rebalance based on a list of goals that do not include all the configured hard.goals then add the skiphardgoalscheck: true....\"", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425248797", "createdAt": "2020-05-14T15:58:05Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the default optimization goals (see below).\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, specify an empty value for the `goals` configuration option:\n++\n+[source=yaml]\n+----\n+goals: {}\n+----\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+We recommend that you always set _default optimization goals_ for the Kafka cluster.\n+You can include any or all of the master optimization goals in the default optimization goals.\n+\n+Default optimization goals are set in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.default.goals`\n+\n+The default optimization goals generate the _cached optimization proposal_ from the workload model (unless you set user-provided optimization goals in a `KafkaRebalance` custom resource). \n+This is updated to reflect the current state of the Kafka cluster every 15 minutes by default. \n+If no default optimization goals are specified, the cached proposal is generated using the master optimization goals.\n+\n+[id=\"user-provided-goals\"]\n+[discrete]\n+=== User-provided optimization goals\n+\n+_User-provided optimization goals_ narrow down the default goals.\n+You can set them, if required, in the `KafkaRebalance` custom resource for a particular optimization proposal: `KafkaRebalance.spec.goals`\n+\n+They are useful for generating an optimization proposal that addresses a particular scenario.\n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering goals for disk capacity or disk utilization. \n+So, you create a `KafkaRebalance` custom resource containing a user-provided goal for leader replica distribution only.\n+\n+User-provided optimization goals must:\n+\n+* Include all configured hard goals, or an error will occur\n+* Be a subset of the master optimization goals\n+\n+To exclude the configured hard goals from an optimization proposal, add the `skiphardgoalscheck: true` option to the `KafkaRebalance` custom resource.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 94}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTUzMzE5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411953319", "createdAt": "2020-05-14T16:00:46Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjowMDo0NlrOGVjQmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjowMDo0NlrOGVjQmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1MDk3MA==", "bodyText": "Again, as with goals and default.goals you can just leave them out of the config altogether.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425250970", "createdAt": "2020-05-14T16:00:46Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the default optimization goals (see below).\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, specify an empty value for the `goals` configuration option:\n++\n+[source=yaml]\n+----\n+goals: {}\n+----\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+We recommend that you always set _default optimization goals_ for the Kafka cluster.\n+You can include any or all of the master optimization goals in the default optimization goals.\n+\n+Default optimization goals are set in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.default.goals`\n+\n+The default optimization goals generate the _cached optimization proposal_ from the workload model (unless you set user-provided optimization goals in a `KafkaRebalance` custom resource). \n+This is updated to reflect the current state of the Kafka cluster every 15 minutes by default. \n+If no default optimization goals are specified, the cached proposal is generated using the master optimization goals.\n+\n+[id=\"user-provided-goals\"]\n+[discrete]\n+=== User-provided optimization goals\n+\n+_User-provided optimization goals_ narrow down the default goals.\n+You can set them, if required, in the `KafkaRebalance` custom resource for a particular optimization proposal: `KafkaRebalance.spec.goals`\n+\n+They are useful for generating an optimization proposal that addresses a particular scenario.\n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering goals for disk capacity or disk utilization. \n+So, you create a `KafkaRebalance` custom resource containing a user-provided goal for leader replica distribution only.\n+\n+User-provided optimization goals must:\n+\n+* Include all configured hard goals, or an error will occur\n+* Be a subset of the master optimization goals\n+\n+To exclude the configured hard goals from an optimization proposal, add the `skiphardgoalscheck: true` option to the `KafkaRebalance` custom resource.\n+\n+[id=\"hard-soft-goals\"]\n+[discrete]\n+=== Hard goals and soft goals\n+\n+In Cruise Control, six of the master optimization goals are preset as _hard goals_:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal\n+\n+All configured hard goals _must_ be satisfied in optimization proposals (unless `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource).\n+In other words, an optimization proposal that does _not_ satisfy all the hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Hard goals are controlled in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.hard.goals`\n+\n+* To inherit the six preset hard goals from Cruise Control, specify an empty value for the `hard.goals` configuration option.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 110}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTU2OTcx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411956971", "createdAt": "2020-05-14T16:04:53Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjowNDo1M1rOGVjbiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjowNDo1M1rOGVjbiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1Mzc3MQ==", "bodyText": "This number indicates how many partitions will have their leader switched to another replica from the current one. This is a \"cheap\" operation (a config change in Zookeeper).", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425253771", "createdAt": "2020-05-14T16:04:53Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreAfter\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreBefore\n+\u00a6Description\n+\n+m\u00a6intraBrokerDataToMoveMB\n+\u00a6Description\n+\n+m\u00a6recentWindows\n+\u00a6Description\n+\n+m\u00a6dataToMoveMB\n+\u00a6Description\n+\n+m\u00a6monitoredPartitionsPercentage\n+\u00a6Description\n+\n+m\u00a6excludedTopics\n+\u00a6Description\n+\n+m\u00a6numLeaderMovements\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 69}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTU4MTk4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411958198", "createdAt": "2020-05-14T16:06:15Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjowNjoxNVrOGVjffA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjowNjoxNVrOGVjffA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1NDc4MA==", "bodyText": "This is a list of topics that will be excluded for partition reassignments. Topic exclusion is not yet supported so this list will be empty.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425254780", "createdAt": "2020-05-14T16:06:15Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreAfter\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreBefore\n+\u00a6Description\n+\n+m\u00a6intraBrokerDataToMoveMB\n+\u00a6Description\n+\n+m\u00a6recentWindows\n+\u00a6Description\n+\n+m\u00a6dataToMoveMB\n+\u00a6Description\n+\n+m\u00a6monitoredPartitionsPercentage\n+\u00a6Description\n+\n+m\u00a6excludedTopics\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTYxNDcy", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411961472", "createdAt": "2020-05-14T16:09:59Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjowOTo1OVrOGVjpZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjowOTo1OVrOGVjpZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1NzMxNg==", "bodyText": "Some CC rebalance options allow for brokers to be excluded from the optimization proposals. These options are not currently supported so this list will be empty.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425257316", "createdAt": "2020-05-14T16:09:59Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreAfter\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreBefore\n+\u00a6Description\n+\n+m\u00a6intraBrokerDataToMoveMB\n+\u00a6Description\n+\n+m\u00a6recentWindows\n+\u00a6Description\n+\n+m\u00a6dataToMoveMB\n+\u00a6Description\n+\n+m\u00a6monitoredPartitionsPercentage\n+\u00a6Description\n+\n+m\u00a6excludedTopics\n+\u00a6Description\n+\n+m\u00a6numLeaderMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForReplicaMove\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 72}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTYyMjk0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411962294", "createdAt": "2020-05-14T16:10:55Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxMDo1NVrOGVjr_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxMDo1NVrOGVjr_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1Nzk4Mw==", "bodyText": "This indicates how many partition replicas in total will be transferred between the brokers in the Kafka Cluster.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425257983", "createdAt": "2020-05-14T16:10:55Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTYzMzg1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411963385", "createdAt": "2020-05-14T16:12:13Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxMjoxM1rOGVjvcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxMjoxM1rOGVjvcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1ODg2NA==", "bodyText": "Some CC rebalance options allow brokers to be excluded from hosting partition leaders. These options are not currently supported so this list will be empty.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425258864", "createdAt": "2020-05-14T16:12:13Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTY0MTEz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411964113", "createdAt": "2020-05-14T16:13:05Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxMzowNVrOGVjxsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxMzowNVrOGVjxsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI1OTQ0Mw==", "bodyText": "This number indicates how many partition replicas will be moved, including possibly between disks within the same broker.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425259443", "createdAt": "2020-05-14T16:13:05Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTY1MTcw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411965170", "createdAt": "2020-05-14T16:14:17Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxNDoxN1rOGVj1Cw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxNDoxN1rOGVj1Cw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MDI5OQ==", "bodyText": "This value is derived by summing the size of each partition replica to be moved to a separate broker (see numIntraBrokerReplicaMovements).", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425260299", "createdAt": "2020-05-14T16:14:17Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreAfter\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreBefore\n+\u00a6Description\n+\n+m\u00a6intraBrokerDataToMoveMB\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTY1OTQz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411965943", "createdAt": "2020-05-14T16:15:13Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxNToxM1rOGVj3lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxNToxM1rOGVj3lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MDk1MQ==", "bodyText": "This value is derived by summing the size of each partition replica to be moved including, possibly, between disks on the same broker (see numReplicaMovements).", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425260951", "createdAt": "2020-05-14T16:15:13Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreAfter\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreBefore\n+\u00a6Description\n+\n+m\u00a6intraBrokerDataToMoveMB\n+\u00a6Description\n+\n+m\u00a6recentWindows\n+\u00a6Description\n+\n+m\u00a6dataToMoveMB\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTY3Mjg4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411967288", "createdAt": "2020-05-14T16:16:47Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxNjo0N1rOGVj8WA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoxNjo0N1rOGVj8WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MjE2OA==", "bodyText": "The % of partitions across the whole monitored cluster that this proposal covers (this will be effected by the number of excludedTopics).", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425262168", "createdAt": "2020-05-14T16:16:47Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreAfter\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreBefore\n+\u00a6Description\n+\n+m\u00a6intraBrokerDataToMoveMB\n+\u00a6Description\n+\n+m\u00a6recentWindows\n+\u00a6Description\n+\n+m\u00a6dataToMoveMB\n+\u00a6Description\n+\n+m\u00a6monitoredPartitionsPercentage\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTc1MzUw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411975350", "createdAt": "2020-05-14T16:23:17Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyMzoxOFrOGVkOqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyMzoxOFrOGVkOqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2Njg1OA==", "bodyText": "The onDemandBalancednessScore is CC's measure of the overall \"balancedness\" of a Kafka Cluster. It is equal to 100 minus the sum of the Balancedness Score of each violated (soft) goal. The Balancedness Score of a goal is based on several factors including its prioirty (position in the default.goals or custom goals list).\nFor the after score this is based on the optimization proposal.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425266858", "createdAt": "2020-05-14T16:23:18Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreAfter\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTc1Njc4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411975678", "createdAt": "2020-05-14T16:23:42Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyMzo0MlrOGVkQWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyMzo0MlrOGVkQWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2NzI5MQ==", "bodyText": "The onDemandBalancednessScore is CC's measure of the overall \"balancedness\" of a Kafka Cluster. It is equal to 100 minus the sum of the Balancedness Score of each violated (soft) goal. The Balancedness Score of a goal is based on several factors including its prioirty (position in the default.goals or custom goals list).\nFor the before score this is based on the current cluster configuration.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425267291", "createdAt": "2020-05-14T16:23:42Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreAfter\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreBefore\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTgwMDg2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411980086", "createdAt": "2020-05-14T16:28:57Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyODo1OFrOGVkixg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjoyODo1OFrOGVkixg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3MjAwNg==", "bodyText": "The number of metrics windows that this proposal is based on.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425272006", "createdAt": "2020-05-14T16:28:58Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,82 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers, generated by the Analyzer component of Cruise Control\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+You can use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6Description\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Description\n+\n+m\u00a6numReplicaMovements\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreAfter\n+\u00a6Description\n+\n+m\u00a6onDemandBalancednessScoreBefore\n+\u00a6Description\n+\n+m\u00a6intraBrokerDataToMoveMB\n+\u00a6Description\n+\n+m\u00a6recentWindows\n+\u00a6Description", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 57}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTgxOTQ0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411981944", "createdAt": "2020-05-14T16:31:06Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjozMTowN1rOGVkokg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjozMTowN1rOGVkokg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3MzQ5MA==", "bodyText": "The KafkaRebalance CR contains the optimization proposal", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425273490", "createdAt": "2020-05-14T16:31:07Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,119 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-optimization-proposals-{context}']\n+= Generating optimization proposals \n+\n+When you create or update a `KafkaRebalance` resource, Cruise Control generates an xref:con-optimization-proposals-{context}[optimization proposal] for the Kafka cluster based on the configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+You can then analyze the summary information in the optimization proposal and decide whether to implement it. \n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+* You have configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+.Procedure\n+\n+. Create a `KafkaRebalance` resource:\n+\n+.. To use the _default optimization goals_ defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+\n+.. To set _user-provided optimization goals_ instead of using the default goals, edit the `spec.goals` property and enter one or more goals.\n++\n+In the following example, rack awareness and replica capacity are user-provided optimization goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+    goals: >\n+      RackAwareGoal,\n+      ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+oc apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the optimization proposal from Cruise Control.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n++\n+Cruise Control returns one of two statuses:\n+\n+** `PendingProposal`: The rebalance operator is polling the Cruise Control API to check if the optimization proposal is ready.\n+\n+** `ProposalReady`: The optimization proposal is ready for you to review and implement, if desired.\n+The status is followed by the JSON optimization proposal.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 75}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTg1MDQ1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411985045", "createdAt": "2020-05-14T16:34:59Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjozNDo1OVrOGVkyPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjozNDo1OVrOGVkyPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3NTk2Nw==", "bodyText": "@laidan6000 It might be worth you running this proceedure yourself on minikube/minishift etc. Just to get a feel for it and to add an example output which has changed slightly from above. For example the condition type and status fields have swapped. Also the docs refer to the OpProp summary as \"JSON format\" when the above is yaml fromat. I am not sure if K8s (or some client) is converting the JSON we give it to YAML so you should double check.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425275967", "createdAt": "2020-05-14T16:34:59Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,119 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-optimization-proposals-{context}']\n+= Generating optimization proposals \n+\n+When you create or update a `KafkaRebalance` resource, Cruise Control generates an xref:con-optimization-proposals-{context}[optimization proposal] for the Kafka cluster based on the configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+You can then analyze the summary information in the optimization proposal and decide whether to implement it. \n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+* You have configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+.Procedure\n+\n+. Create a `KafkaRebalance` resource:\n+\n+.. To use the _default optimization goals_ defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+\n+.. To set _user-provided optimization goals_ instead of using the default goals, edit the `spec.goals` property and enter one or more goals.\n++\n+In the following example, rack awareness and replica capacity are user-provided optimization goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+    goals: >\n+      RackAwareGoal,\n+      ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+oc apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the optimization proposal from Cruise Control.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n++\n+Cruise Control returns one of two statuses:\n+\n+** `PendingProposal`: The rebalance operator is polling the Cruise Control API to check if the optimization proposal is ready.\n+\n+** `ProposalReady`: The optimization proposal is ready for you to review and implement, if desired.\n+The status is followed by the JSON optimization proposal.\n+\n+. Review the JSON optimization proposal in the `status.summary` property of the `KafkaRebalance` resource.\n++\n+Here is an example proposal:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+apiVersion: kafka.strimzi.io/v1beta1\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:\n+  # ...\n+status:\n+  conditions:\n+  - lastTransitionTime: 2020-05-23T23:46:57+0000\n+    status: \"True\"\n+    type: Ready\n+  observedGeneration: 4\n+  summary: CHECK THE FORMATTING IS CORRECT\n+  - numIntraBrokerReplicaMovements:0,\n+  - excludedBrokersForLeadership:[],\n+  - numReplicaMovements:31,\n+  - onDemandBalancednessScoreAfter:84.08179174145127,\n+  - onDemandBalancednessScoreBefore:79.74705957325753,\n+  - intraBrokerDataToMoveMB:0,\n+  - recentWindows:1,\n+  - dataToMoveMB:0,\n+  - monitoredPartitionsPercentage:100.0,\n+  - excludedTopics:[],\n+  - numLeaderMovements:12,\n+  - excludedBrokersForReplicaMove:[]\n+# ...", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 110}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTg1ODU0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411985854", "createdAt": "2020-05-14T16:36:00Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjozNjowMFrOGVk0uA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjozNjowMFrOGVk0uA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3NjYwMA==", "bodyText": "Should we add the command to do this in here?\nkubectl describe kafkarebalance.kafka.strimzi.io -n <namespace> <rebalance-cr-name>", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425276600", "createdAt": "2020-05-14T16:36:00Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,119 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-optimization-proposals-{context}']\n+= Generating optimization proposals \n+\n+When you create or update a `KafkaRebalance` resource, Cruise Control generates an xref:con-optimization-proposals-{context}[optimization proposal] for the Kafka cluster based on the configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+You can then analyze the summary information in the optimization proposal and decide whether to implement it. \n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+* You have configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+.Procedure\n+\n+. Create a `KafkaRebalance` resource:\n+\n+.. To use the _default optimization goals_ defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+\n+.. To set _user-provided optimization goals_ instead of using the default goals, edit the `spec.goals` property and enter one or more goals.\n++\n+In the following example, rack awareness and replica capacity are user-provided optimization goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+    goals: >\n+      RackAwareGoal,\n+      ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+oc apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the optimization proposal from Cruise Control.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n++\n+Cruise Control returns one of two statuses:\n+\n+** `PendingProposal`: The rebalance operator is polling the Cruise Control API to check if the optimization proposal is ready.\n+\n+** `ProposalReady`: The optimization proposal is ready for you to review and implement, if desired.\n+The status is followed by the JSON optimization proposal.\n+\n+. Review the JSON optimization proposal in the `status.summary` property of the `KafkaRebalance` resource.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTg4MjU4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411988258", "createdAt": "2020-05-14T16:39:05Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjozOTowNlrOGVk8Ug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjozOTowNlrOGVk8Ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3ODU0Ng==", "bodyText": "We should add a prominent NOTE: to this with some more explanation:\nNOTE: If the KafkaRebalance status has been in the ProposalReady state for some time, then that proposal may no longer be applicable to the current state of the Kafka Cluster. In this case you can refresh the optimization proposal to make sure it uses the latest cluster metrics.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425278546", "createdAt": "2020-05-14T16:39:06Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,73 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an optimization proposal with a status of `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers as summarized in the optimization proposal.\n+\n+WARNING: This is not a dry run. \n+Review the optimization proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. If the `KafkaRebalance` status has been `ProposalReady` for some time, refresh the optimization proposal in case it has become out of date:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTg5NzA4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411989708", "createdAt": "2020-05-14T16:40:47Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjo0MDo0N1rOGVlAuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjo0MDo0N1rOGVlAuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3OTY3Mw==", "bodyText": "Well you can ask for a new optimization proposal which should contain little or no changes? There is no direct way to check though.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425279673", "createdAt": "2020-05-14T16:40:47Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,73 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an optimization proposal with a status of `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers as summarized in the optimization proposal.\n+\n+WARNING: This is not a dry run. \n+Review the optimization proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. If the `KafkaRebalance` status has been `ProposalReady` for some time, refresh the optimization proposal in case it has become out of date:\n+\n+.. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the optimization proposal that you want to implement.\n++\n+Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-name_-kafka strimzi.io/rebalance=approved\n+----\n+\n+. The Cluster Operator detects the annotated resource and instructs Cruise Control to rebalance the Kafka cluster.\n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n+\n+. Cruise Control returns one of three statuses:\n+\n+** Rebalancing: The cluster rebalance operation is in progress. \n+\n+** Ready: The cluster rebalancing operation completed successfully.\n+\n+** NotReady: An error occurred. \n+\n+//Is there a way to verify the rebalance?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 69}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExOTkwNDQ3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-411990447", "createdAt": "2020-05-14T16:41:38Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjo0MTozOVrOGVlC_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQxNjo0MTozOVrOGVlC_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI4MDI1Mg==", "bodyText": "I may have missed it, but where is the procedure for stopping an ongoing rebalance?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425280252", "createdAt": "2020-05-14T16:41:39Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,73 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an optimization proposal with a status of `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers as summarized in the optimization proposal.\n+\n+WARNING: This is not a dry run. \n+Review the optimization proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. If the `KafkaRebalance` status has been `ProposalReady` for some time, refresh the optimization proposal in case it has become out of date:\n+\n+.. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the optimization proposal that you want to implement.\n++\n+Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-name_-kafka strimzi.io/rebalance=approved\n+----\n+\n+. The Cluster Operator detects the annotated resource and instructs Cruise Control to rebalance the Kafka cluster.\n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n+\n+. Cruise Control returns one of three statuses:\n+\n+** Rebalancing: The cluster rebalance operation is in progress. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyMzY4ODY3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-412368867", "createdAt": "2020-05-15T06:04:17Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwNjowNDoxN1rOGV3mMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwNjoxODoxNlrOGV34Bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4NDE3Nw==", "bodyText": "what are this line witn \"//\" ? this list is not clear to me. Are there titles and topics?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425584177", "createdAt": "2020-05-15T06:04:17Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4NDc3OA==", "bodyText": "from where \"Master\" comes from?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425584778", "createdAt": "2020-05-15T06:06:11Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4NTY1Mg==", "bodyText": "I think that this notation in this case is confusing. As we are using this notation it means:\nspec:\n  cruiseControl:\n     config:\n        default:\n            goals:\nwhich is of course wrong because the right field is default.goals (so it's a field as a whole not goals under default).\nFor this reason I would say default.goals under Kafka.spec.cruiseControl.config.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425585652", "createdAt": "2020-05-15T06:08:47Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the default optimization goals (see below).\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, specify an empty value for the `goals` configuration option:\n++\n+[source=yaml]\n+----\n+goals: {}\n+----\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+We recommend that you always set _default optimization goals_ for the Kafka cluster.\n+You can include any or all of the master optimization goals in the default optimization goals.\n+\n+Default optimization goals are set in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.default.goals`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4NjEzNQ==", "bodyText": "the field is skipHardGoalCheck", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425586135", "createdAt": "2020-05-15T06:10:16Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the default optimization goals (see below).\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, specify an empty value for the `goals` configuration option:\n++\n+[source=yaml]\n+----\n+goals: {}\n+----\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+We recommend that you always set _default optimization goals_ for the Kafka cluster.\n+You can include any or all of the master optimization goals in the default optimization goals.\n+\n+Default optimization goals are set in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.default.goals`\n+\n+The default optimization goals generate the _cached optimization proposal_ from the workload model (unless you set user-provided optimization goals in a `KafkaRebalance` custom resource). \n+This is updated to reflect the current state of the Kafka cluster every 15 minutes by default. \n+If no default optimization goals are specified, the cached proposal is generated using the master optimization goals.\n+\n+[id=\"user-provided-goals\"]\n+[discrete]\n+=== User-provided optimization goals\n+\n+_User-provided optimization goals_ narrow down the default goals.\n+You can set them, if required, in the `KafkaRebalance` custom resource for a particular optimization proposal: `KafkaRebalance.spec.goals`\n+\n+They are useful for generating an optimization proposal that addresses a particular scenario.\n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering goals for disk capacity or disk utilization. \n+So, you create a `KafkaRebalance` custom resource containing a user-provided goal for leader replica distribution only.\n+\n+User-provided optimization goals must:\n+\n+* Include all configured hard goals, or an error will occur\n+* Be a subset of the master optimization goals\n+\n+To exclude the configured hard goals from an optimization proposal, add the `skiphardgoalscheck: true` option to the `KafkaRebalance` custom resource.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI0ODc5Nw=="}, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 94}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4NjQ0NA==", "bodyText": "skipHardGoalCheck", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425586444", "createdAt": "2020-05-15T06:11:20Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the default optimization goals (see below).\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, specify an empty value for the `goals` configuration option:\n++\n+[source=yaml]\n+----\n+goals: {}\n+----\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+We recommend that you always set _default optimization goals_ for the Kafka cluster.\n+You can include any or all of the master optimization goals in the default optimization goals.\n+\n+Default optimization goals are set in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.default.goals`\n+\n+The default optimization goals generate the _cached optimization proposal_ from the workload model (unless you set user-provided optimization goals in a `KafkaRebalance` custom resource). \n+This is updated to reflect the current state of the Kafka cluster every 15 minutes by default. \n+If no default optimization goals are specified, the cached proposal is generated using the master optimization goals.\n+\n+[id=\"user-provided-goals\"]\n+[discrete]\n+=== User-provided optimization goals\n+\n+_User-provided optimization goals_ narrow down the default goals.\n+You can set them, if required, in the `KafkaRebalance` custom resource for a particular optimization proposal: `KafkaRebalance.spec.goals`\n+\n+They are useful for generating an optimization proposal that addresses a particular scenario.\n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering goals for disk capacity or disk utilization. \n+So, you create a `KafkaRebalance` custom resource containing a user-provided goal for leader replica distribution only.\n+\n+User-provided optimization goals must:\n+\n+* Include all configured hard goals, or an error will occur\n+* Be a subset of the master optimization goals\n+\n+To exclude the configured hard goals from an optimization proposal, add the `skiphardgoalscheck: true` option to the `KafkaRebalance` custom resource.\n+\n+[id=\"hard-soft-goals\"]\n+[discrete]\n+=== Hard goals and soft goals\n+\n+In Cruise Control, six of the master optimization goals are preset as _hard goals_:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal\n+\n+All configured hard goals _must_ be satisfied in optimization proposals (unless `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4NjY1MQ==", "bodyText": "the same as before, hard.goals is a property as a whole, we should clarify as I already mentioned for default.goals", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425586651", "createdAt": "2020-05-15T06:12:02Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,133 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the default optimization goals (see below).\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, specify an empty value for the `goals` configuration option:\n++\n+[source=yaml]\n+----\n+goals: {}\n+----\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+We recommend that you always set _default optimization goals_ for the Kafka cluster.\n+You can include any or all of the master optimization goals in the default optimization goals.\n+\n+Default optimization goals are set in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.default.goals`\n+\n+The default optimization goals generate the _cached optimization proposal_ from the workload model (unless you set user-provided optimization goals in a `KafkaRebalance` custom resource). \n+This is updated to reflect the current state of the Kafka cluster every 15 minutes by default. \n+If no default optimization goals are specified, the cached proposal is generated using the master optimization goals.\n+\n+[id=\"user-provided-goals\"]\n+[discrete]\n+=== User-provided optimization goals\n+\n+_User-provided optimization goals_ narrow down the default goals.\n+You can set them, if required, in the `KafkaRebalance` custom resource for a particular optimization proposal: `KafkaRebalance.spec.goals`\n+\n+They are useful for generating an optimization proposal that addresses a particular scenario.\n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering goals for disk capacity or disk utilization. \n+So, you create a `KafkaRebalance` custom resource containing a user-provided goal for leader replica distribution only.\n+\n+User-provided optimization goals must:\n+\n+* Include all configured hard goals, or an error will occur\n+* Be a subset of the master optimization goals\n+\n+To exclude the configured hard goals from an optimization proposal, add the `skiphardgoalscheck: true` option to the `KafkaRebalance` custom resource.\n+\n+[id=\"hard-soft-goals\"]\n+[discrete]\n+=== Hard goals and soft goals\n+\n+In Cruise Control, six of the master optimization goals are preset as _hard goals_:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal\n+\n+All configured hard goals _must_ be satisfied in optimization proposals (unless `skip_hard_goal_check: true` is specified in the `KafkaRebalance` custom resource).\n+In other words, an optimization proposal that does _not_ satisfy all the hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Hard goals are controlled in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.hard.goals`", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 108}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4NzgwNw==", "bodyText": "kubectl", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425587807", "createdAt": "2020-05-15T06:15:28Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,119 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-optimization-proposals-{context}']\n+= Generating optimization proposals \n+\n+When you create or update a `KafkaRebalance` resource, Cruise Control generates an xref:con-optimization-proposals-{context}[optimization proposal] for the Kafka cluster based on the configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+You can then analyze the summary information in the optimization proposal and decide whether to implement it. \n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+* You have configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+.Procedure\n+\n+. Create a `KafkaRebalance` resource:\n+\n+.. To use the _default optimization goals_ defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+\n+.. To set _user-provided optimization goals_ instead of using the default goals, edit the `spec.goals` property and enter one or more goals.\n++\n+In the following example, rack awareness and replica capacity are user-provided optimization goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+    goals: >\n+      RackAwareGoal,\n+      ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+oc apply -f _your-file_", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4ODE0Ng==", "bodyText": "it's changed, now type: State (is always in this way) and status: Ready", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425588146", "createdAt": "2020-05-15T06:16:24Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,119 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-optimization-proposals-{context}']\n+= Generating optimization proposals \n+\n+When you create or update a `KafkaRebalance` resource, Cruise Control generates an xref:con-optimization-proposals-{context}[optimization proposal] for the Kafka cluster based on the configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+You can then analyze the summary information in the optimization proposal and decide whether to implement it. \n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+* You have configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+.Procedure\n+\n+. Create a `KafkaRebalance` resource:\n+\n+.. To use the _default optimization goals_ defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+\n+.. To set _user-provided optimization goals_ instead of using the default goals, edit the `spec.goals` property and enter one or more goals.\n++\n+In the following example, rack awareness and replica capacity are user-provided optimization goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+    goals: >\n+      RackAwareGoal,\n+      ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+oc apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the optimization proposal from Cruise Control.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n++\n+Cruise Control returns one of two statuses:\n+\n+** `PendingProposal`: The rebalance operator is polling the Cruise Control API to check if the optimization proposal is ready.\n+\n+** `ProposalReady`: The optimization proposal is ready for you to review and implement, if desired.\n+The status is followed by the JSON optimization proposal.\n+\n+. Review the JSON optimization proposal in the `status.summary` property of the `KafkaRebalance` resource.\n++\n+Here is an example proposal:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+apiVersion: kafka.strimzi.io/v1beta1\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:\n+  # ...\n+status:\n+  conditions:\n+  - lastTransitionTime: 2020-05-23T23:46:57+0000\n+    status: \"True\"\n+    type: Ready", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 95}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU4ODc0Mg==", "bodyText": "I think we should also explain how to \"fix\" a KafkaRebalance when an error occurs and how to move it from NotReady to ask for a new proposal.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r425588742", "createdAt": "2020-05-15T06:18:16Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,73 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an optimization proposal with a status of `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers as summarized in the optimization proposal.\n+\n+WARNING: This is not a dry run. \n+Review the optimization proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. If the `KafkaRebalance` status has been `ProposalReady` for some time, refresh the optimization proposal in case it has become out of date:\n+\n+.. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the optimization proposal that you want to implement.\n++\n+Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-name_-kafka strimzi.io/rebalance=approved\n+----\n+\n+. The Cluster Operator detects the annotated resource and instructs Cruise Control to rebalance the Kafka cluster.\n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n+\n+. Cruise Control returns one of three statuses:\n+\n+** Rebalancing: The cluster rebalance operation is in progress. \n+\n+** Ready: The cluster rebalancing operation completed successfully.\n+\n+** NotReady: An error occurred. \n+\n+//Is there a way to verify the rebalance?", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3OTY3Mw=="}, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 69}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edf3a4c07840e21ce8e79a3d5bfed716ef486750", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/edf3a4c07840e21ce8e79a3d5bfed716ef486750", "committedDate": "2020-05-15T14:54:19Z", "message": "TC edits 15 May\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMTEyNjAz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-413112603", "createdAt": "2020-05-16T22:23:36Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQyMjoyMzozNlrOGWc9wA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQyMjoyMzozNlrOGWc9wA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjE5NjQxNg==", "bodyText": "The name of the KafkaRebalance resources AFAIU can be anything. So the example commands like this should not use the _cluster-name_-kafka as a name. They should use something generic like _kafka-rebalance-name_ instead. Otherwise this would be misleading given the other namesfor example in example do not follow this pattern anyway. (this is not just here but on more places)", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r426196416", "createdAt": "2020-05-16T22:23:36Z", "author": {"login": "scholzj"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,73 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an optimization proposal with a status of `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers as summarized in the optimization proposal.\n+\n+WARNING: This is not a dry run. \n+Review the optimization proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. If the `KafkaRebalance` status has been `ProposalReady` for some time, refresh the optimization proposal in case it has become out of date:\n+\n+.. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-name_-kafka strimzi.io/rebalance=refresh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7d1cac6649b5003b8075d8e77752131f716e35ca", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7d1cac6649b5003b8075d8e77752131f716e35ca", "committedDate": "2020-05-18T16:36:46Z", "message": "Review comments 18 May\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42324060dd42928c84279216329d0ed8608c3964", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/42324060dd42928c84279216329d0ed8608c3964", "committedDate": "2020-05-19T08:04:58Z", "message": "Fixed unrelated error in docs\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0Mjg0Mzk1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414284395", "createdAt": "2020-05-19T09:52:14Z", "commit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOTo1MjoxNFrOGXYvXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwOTo1MjoxNFrOGXYvXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE3NTc3Mw==", "bodyText": "it's approve not approved", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427175773", "createdAt": "2020-05-19T09:52:14Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,73 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an optimization proposal with a status of `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers as summarized in the optimization proposal.\n+\n+WARNING: This is not a dry run. \n+Review the optimization proposal before you implement it.\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. If the `KafkaRebalance` status has been `ProposalReady` for some time, refresh the optimization proposal in case it has become out of date:\n+\n+.. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-name_-kafka strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the optimization proposal that you want to implement.\n++\n+Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-name_-kafka strimzi.io/rebalance=approved", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70aa2d9d9fc22e530783df0072882645e464234a"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/b9066e39850c9b66fc2211d3f21726d4b8117ead", "committedDate": "2020-05-19T12:13:09Z", "message": "Last comments from reviewers\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDE3MDI2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414417026", "createdAt": "2020-05-19T12:57:49Z", "commit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMjo1Nzo0OVrOGXfJag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMjo1Nzo0OVrOGXfJag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI4MDc0Ng==", "bodyText": "Why is this here?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427280746", "createdAt": "2020-05-19T12:57:49Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/con-configuring-user-operator.adoc", "diffHunk": "@@ -9,7 +9,7 @@ User Operator deployment can be configured using additional options inside the `\n The following properties are supported:\n \n `watchedNamespace`::\n-The Kubernetes namespace in which the topic operator watches for `KafkaUsers`.\n+The Kubernetes namespace in which the user operator watches for `KafkaUsers`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDMwNTE5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414430519", "createdAt": "2020-05-19T13:13:28Z", "commit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzoxMzoyOFrOGXfxpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzoxMzoyOFrOGXfxpA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5MTA0NA==", "bodyText": "This statement is not correct. The skipHardGoalCheck: true only applies to the check that is done for the user defined goals and weather they contain all the specified hard.goals. If a user sets skipHardGoalCheck: true all the user defined goals that are in the hard.goals list will be treated as hard goals.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427291044", "createdAt": "2020-05-19T13:13:28Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,94 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skipHardGoalCheck: true` is specified in the `KafkaRebalance` custom resource.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDM3NzM0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414437734", "createdAt": "2020-05-19T13:21:18Z", "commit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzoyMToxOFrOGXgHEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzoyMToxOFrOGXgHEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5NjUyOQ==", "bodyText": "So an optimization proposal does contain the information in the bullet points below but we don't currently show this information to a user. This requires the --verbose flag which we currently don't support. We may add this in future but there is currently no way to show this information to the user.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427296529", "createdAt": "2020-05-19T13:21:18Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,94 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skipHardGoalCheck: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDQ4OTEw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414448910", "createdAt": "2020-05-19T13:33:01Z", "commit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzozMzowMVrOGXgoRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzozMzowMVrOGXgoRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMwNTAyOA==", "bodyText": "\"The total number of partition replicas that will be transferred between the disks of the cluster's brokers.\"", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427305028", "createdAt": "2020-05-19T13:33:01Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,94 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Optimization proposals always satisfy all the configured hard goals, although not necessarily all the soft goals. Hard goals are ignored if `skipHardGoalCheck: true` is specified in the `KafkaRebalance` custom resource.\n+\n+An optimization proposal contains the following information, in JSON, about the pending cluster rebalance:\n+\n+* An optimal mapping of partitions to brokers\n+\n+* Changes to the partition leaders\n+\n+* Statistics on the cluster rebalance (before and after)\n+\n+Use the information to decide whether to implement the cluster rebalance, or change the optimization goals. \n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Cached optimization proposal\n+\n+Cruise Control maintains a _cached optimization proposal_ based on the configured default optimization goals.\n+Generated from the workload model, the cached optimization proposal is updated every 15 minutes to reflect the current state of the Kafka cluster.\n+If you generate an optimization proposal using the default optimization goals, Cruise Control returns the most recent cached proposal.\n+\n+To change the cached optimization proposal refresh interval, edit the `proposal.expiration.ms` setting in the Cruise Control deployment configuration.\n+Consider a shorter interval for fast changing clusters, although this increases the load on the Cruise Control server.\n+\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6The total number of partition replicas that will be transferred between the disks of an individual broker.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDUxMzU5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414451359", "createdAt": "2020-05-19T13:35:38Z", "commit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzozNTozOFrOGXgvYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzozNTozOFrOGXgvYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMwNjg1MA==", "bodyText": "Do we need a \",\" at the end of these names? @kyguy does this YAML list get parsed into a Java list and the \",\" added?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427306850", "createdAt": "2020-05-19T13:35:38Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,124 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-optimization-proposals-{context}']\n+= Generating optimization proposals \n+\n+When you create or update a `KafkaRebalance` resource, Cruise Control generates an xref:con-optimization-proposals-{context}[optimization proposal] for the Kafka cluster based on the configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+You can then analyze the summary information in the optimization proposal and decide whether to implement it. \n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+* You have configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+.Procedure\n+\n+. Create a `KafkaRebalance` resource:\n+\n+.. To use the _default optimization goals_ defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+\n+.. To set _user-provided optimization goals_ instead of using the default goals, edit the `goals` property and enter one or more goals.\n++\n+In the following example, rack awareness and replica capacity are user-provided optimization goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+  goals:\n+    - RackAwareGoal,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 49}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDY3OTQz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414467943", "createdAt": "2020-05-19T13:53:25Z", "commit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzo1MzoyNVrOGXhgvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzo1MzoyNVrOGXhgvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxOTQ4NQ==", "bodyText": "This command is wrong. It should be kubectl get kafkarebalance <rebalance-name> -o jsonpath='{.status}'", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427319485", "createdAt": "2020-05-19T13:53:25Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,124 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-optimization-proposals-{context}']\n+= Generating optimization proposals \n+\n+When you create or update a `KafkaRebalance` resource, Cruise Control generates an xref:con-optimization-proposals-{context}[optimization proposal] for the Kafka cluster based on the configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+You can then analyze the summary information in the optimization proposal and decide whether to implement it. \n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+* You have configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+.Procedure\n+\n+. Create a `KafkaRebalance` resource:\n+\n+.. To use the _default optimization goals_ defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+\n+.. To set _user-provided optimization goals_ instead of using the default goals, edit the `goals` property and enter one or more goals.\n++\n+In the following example, rack awareness and replica capacity are user-provided optimization goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+  goals:\n+    - RackAwareGoal,\n+    - ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the optimization proposal from Cruise Control.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 67}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDczMDc3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414473077", "createdAt": "2020-05-19T13:59:20Z", "commit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzo1OToyMFrOGXhwtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzo1OToyMFrOGXhwtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyMzU3Mw==", "bodyText": "It is not JSON formatted if you use the kubectl describe command", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427323573", "createdAt": "2020-05-19T13:59:20Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,124 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-optimization-proposals-{context}']\n+= Generating optimization proposals \n+\n+When you create or update a `KafkaRebalance` resource, Cruise Control generates an xref:con-optimization-proposals-{context}[optimization proposal] for the Kafka cluster based on the configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+You can then analyze the summary information in the optimization proposal and decide whether to implement it. \n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+* You have configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+.Procedure\n+\n+. Create a `KafkaRebalance` resource:\n+\n+.. To use the _default optimization goals_ defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+\n+.. To set _user-provided optimization goals_ instead of using the default goals, edit the `goals` property and enter one or more goals.\n++\n+In the following example, rack awareness and replica capacity are user-provided optimization goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+  goals:\n+    - RackAwareGoal,\n+    - ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the optimization proposal from Cruise Control.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n++\n+Cruise Control returns one of two statuses:\n+\n+** `PendingProposal`: The rebalance operator is polling the Cruise Control API to check if the optimization proposal is ready.\n+\n+** `ProposalReady`: The optimization proposal is ready for review and, if desired, implementation.\n+The status contains the optimization proposal as JSON, in the `status.summary` property of the `KafkaRebalance` resource.\n+\n+. Review the JSON optimization proposal.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 77}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NDI4NzY3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414428767", "createdAt": "2020-05-19T13:11:35Z", "commit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "state": "COMMENTED", "comments": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzoxMTozNVrOGXfsag==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzo1NTozMFrOGXhmgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI4OTcwNg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Example YAML files for deploying Cruise Control and setting optimization goals are provided in `examples/kafka/`.\n          \n          \n            \n            Example YAML files for deploying Cruise Control and setting optimization goals are provided in `examples/cruise-control/`.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427289706", "createdAt": "2020-05-19T13:11:35Z", "author": {"login": "tombentley"}, "path": "documentation/assemblies/cruise-control/assembly-cruise-control-concepts.adoc", "diffHunk": "@@ -5,14 +5,22 @@\n [id='cruise-control-concepts-{context}']\n = Cruise Control\n \n-This chapter provides an overview of the Kafka cluster rebalancing features provided by the {CruiseControlProject} open source project and helps you get started using Cruise Control with {ProductName}.\n+You can deploy {CruiseControlProject} and access a subset of its features through {ProductName} custom resources.\n+\n+Example YAML files for deploying Cruise Control and setting optimization goals are provided in `examples/kafka/`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5MTMzMQ==", "bodyText": "In any realistic scenario there's never a true balance (in the sense that every broker has the same load), so can we add 'more'\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            It constructs a _workload model_ of resource utilization for the cluster--based on CPU, disk, and network load--and generates _optimization proposals_ for balanced partition assignments. A set of configurable _optimization goals_ is used to calculate these proposals.\n          \n          \n            \n            It constructs a _workload model_ of resource utilization for the cluster--based on CPU, disk, and network load--and generates _optimization proposals_ for more balanced partition assignments. A set of configurable _optimization goals_ is used to calculate these proposals.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427291331", "createdAt": "2020-05-19T13:13:57Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-cruise-control-overview.adoc", "diffHunk": "@@ -7,16 +7,19 @@\n // See also the complementary step on the last line of this file.\n \n [id='con-cruise-control-overview-{context}']\n-= Cruise Control overview\n+= Why use Cruise Control?\n \n-Brokers in a Kafka cluster can become unevenly loaded for many reasons.\n-For example, partitions that handle large amounts of message traffic can be unevenly distributed across the available brokers.\n-Monitoring broker load and reassigning busy partitions to brokers with spare capacity is time consuming and adds to the overhead of managing a Kafka cluster.\n-Cruise Control is a tool for automating the monitoring and rebalancing of partitions across a Kafka cluster.\n-When deployed alongside a Kafka cluster, Cruise Control can perform the following cluster balancing tasks:\n+Cruise Control reduces the time and effort involved in running an efficient and balanced Kafka cluster.\n \n-* Monitoring the CPU, disk, and network load of Kafka brokers.\n-* Making optimization proposals: balanced partition assignments based on configurable optimization goals.\n-* Executing partition reassignments based on optimization proposals.\n+A typical cluster can become unevenly loaded over time.\n+Partitions that handle large amounts of message traffic might be unevenly distributed across the available brokers.\n+To rebalance the cluster, administrators must monitor the load on brokers and manually reassign busy partitions to brokers with spare capacity.\n \n-The following sections explain how to xref:proc-deploying-cruise-control-{context}[deploy Cruise Control] and xref:ref-cruise-control-configuration-{context}[set configuration options].\n\\ No newline at end of file\n+Cruise Control automates the cluster rebalancing process.\n+It constructs a _workload model_ of resource utilization for the cluster--based on CPU, disk, and network load--and generates _optimization proposals_ for balanced partition assignments. A set of configurable _optimization goals_ is used to calculate these proposals.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5Mjk1NA==", "bodyText": "I found \"implement\" a slightly curious choice of word here, but you've used it throughout these docs. Without the extra bit at the end I don't think it's completely clear that the effect of \"implementing\" is that the cluster ends up more balanced.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            You can choose to implement optimization proposals to achieve a more balanced Kafka cluster.  \n          \n          \n            \n            You can choose to apply those optimization proposals to your Kafka cluster so the broker pods are used most effectively.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427292954", "createdAt": "2020-05-19T13:16:19Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-cruise-control-overview.adoc", "diffHunk": "@@ -7,16 +7,19 @@\n // See also the complementary step on the last line of this file.\n \n [id='con-cruise-control-overview-{context}']\n-= Cruise Control overview\n+= Why use Cruise Control?\n \n-Brokers in a Kafka cluster can become unevenly loaded for many reasons.\n-For example, partitions that handle large amounts of message traffic can be unevenly distributed across the available brokers.\n-Monitoring broker load and reassigning busy partitions to brokers with spare capacity is time consuming and adds to the overhead of managing a Kafka cluster.\n-Cruise Control is a tool for automating the monitoring and rebalancing of partitions across a Kafka cluster.\n-When deployed alongside a Kafka cluster, Cruise Control can perform the following cluster balancing tasks:\n+Cruise Control reduces the time and effort involved in running an efficient and balanced Kafka cluster.\n \n-* Monitoring the CPU, disk, and network load of Kafka brokers.\n-* Making optimization proposals: balanced partition assignments based on configurable optimization goals.\n-* Executing partition reassignments based on optimization proposals.\n+A typical cluster can become unevenly loaded over time.\n+Partitions that handle large amounts of message traffic might be unevenly distributed across the available brokers.\n+To rebalance the cluster, administrators must monitor the load on brokers and manually reassign busy partitions to brokers with spare capacity.\n \n-The following sections explain how to xref:proc-deploying-cruise-control-{context}[deploy Cruise Control] and xref:ref-cruise-control-configuration-{context}[set configuration options].\n\\ No newline at end of file\n+Cruise Control automates the cluster rebalancing process.\n+It constructs a _workload model_ of resource utilization for the cluster--based on CPU, disk, and network load--and generates _optimization proposals_ for balanced partition assignments. A set of configurable _optimization goals_ is used to calculate these proposals.\n+\n+You can choose to implement optimization proposals to achieve a more balanced Kafka cluster.  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5MzkzMg==", "bodyText": "Personally I prefer the word \"constraint\" rather than \"target\".", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427293932", "createdAt": "2020-05-19T13:17:39Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,161 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5NjcyMg==", "bodyText": "Will it be clear to readers what \"users\" means here?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the link:#default-goals[default optimization goals].\n          \n          \n            \n            To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from use in `KafkaRebalance` resources. The priority order of the master optimization goals can be modified, if desired, in the link:#default-goals[default optimization goals].", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427296722", "createdAt": "2020-05-19T13:21:36Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,161 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Goals that are not listed in the master optimization goals are not available to use for Cruise Control operations.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+Six of these goals are preset as link:#hard-soft-goals[hard goals].\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the link:#default-goals[default optimization goals].", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMwMDg4NQ==", "bodyText": "Because a couple of the preceding sections about goals mention hard goals why not explain this first?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427300885", "createdAt": "2020-05-19T13:27:28Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,161 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Goals that are not listed in the master optimization goals are not available to use for Cruise Control operations.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+Six of these goals are preset as link:#hard-soft-goals[hard goals].\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the link:#default-goals[default optimization goals].\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, do not specify the `goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+Cruise Control uses the _default optimization goals_ to generate the _cached optimization proposal_.\n+For more information about the cached optimization proposal, see xref:con-optimization-proposals-{context}[]. \n+\n+You can override the default optimization goals by setting link:#user-provided-goals[user-provided optimization goals] in a `KafkaRebalance` custom resource.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], the default optimization goals are the same as the master optimization goals.\n+\n+* To use the master optimization goals as the default goals, do not specify the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* To modify the default optimization goals, edit the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+You must use a subset of the master optimization goals.\n+ \n+.Example `Kafka` configuration for default optimization goals\n+\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: Kafka\n+metadata:\n+  name: my-cluster\n+spec:\n+  kafka:\n+    # ...\n+  zookeeper:\n+    # ...\n+  entityOperator:\n+    topicOperator: {}\n+    userOperator: {}\n+  cruiseControl: {}\n+    capacity:\n+      networkIn: 10000KB/s\n+      networkOut: 10000KB/s\n+    config:\n+      default.goals: >\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.DiskCapacityGoal\n+      # ...         \n+----\n+\n+NOTE: For an example of the complete deployment configuration, see xref:proc-deploying-cruise-control-{context}[]. \n+\n+If no default optimization goals are specified, the cached proposal is generated using the master optimization goals.\n+\n+[id=\"user-provided-goals\"]\n+[discrete]\n+=== User-provided optimization goals\n+\n+_User-provided optimization goals_ narrow down the default goals.\n+You can set them, if required, in the `KafkaRebalance` custom resource for a particular optimization proposal: `KafkaRebalance.spec.goals`\n+\n+They are useful for generating an optimization proposal that addresses a particular scenario.\n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering goals for disk capacity or disk utilization. \n+So, you create a `KafkaRebalance` custom resource containing a user-provided goal for leader replica distribution only.\n+\n+User-provided optimization goals must:\n+\n+* Include all configured link:#hard-soft-goals[hard goals], or an error occurs\n+* Be a subset of the master optimization goals\n+\n+To ignore the configured hard goals in an optimization proposal, add the `skipHardGoalCheck: true` option to the `KafkaRebalance` custom resource.\n+\n+[id=\"hard-soft-goals\"]\n+[discrete]\n+=== Hard goals and soft goals\n+\n+In Cruise Control, six of the master optimization goals are preset as _hard goals_:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal\n+\n+Unless `skipHardGoalCheck: true` is specified in the `KafkaRebalance` custom resource, all configured hard goals _must_ be satisfied in optimization proposals.\n+In other words, an optimization proposal that does _not_ satisfy all the hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Hard goals are controlled in the Cruise Control deployment configuration, by editing the `hard.goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* To inherit the six preset hard goals from Cruise Control, do not specify the `hard.goals` property in `Kafka.spec.cruiseControl.config`\n+\n+* To change the preset hard goals, specify the desired goals in the `hard.goals` configuration option.\n+\n+Increasing the number of hard goals will reduce the likelihood of Cruise Control generating valid optimization proposals.\n+\n+Goals not designated as hard goals are treated as _soft goals_.\n+Also known as _best effort_ goals, soft goals do _not_ need to be satisfied in optimization proposals, but are included in optimization calculations.\n+An optimization proposal that violates one or more soft goals, but satisfies all hard goals, is valid.\n+\n+NOTE: For example, you might have a soft goal to distribute a topic's replicas evenly across the cluster (the topic replica distribution goal). \n+Cruise Control will ignore this goal if doing so enables all the configured hard goals to be met.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 155}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMwNDY1MA==", "bodyText": "This section should define what a hard goal is as the very first thing. Otherwise a reader might not understand the rest of the content.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            In Cruise Control, six of the master optimization goals are preset as _hard goals_:\n          \n          \n            \n            _Hard goals_ are goals that _must_ be satisfied in optimization proposals. Goals which are not hard goals are known as soft goals, and might not be satisfied by an optimization proposals. Cruise control will find proposals which satisfy all the hard goals and as many soft goals as possible (in their priority order).\n          \n          \n            \n            \n          \n          \n            \n            In Cruise Control, six of the master optimization goals are preset as hard goals:", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427304650", "createdAt": "2020-05-19T13:32:27Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,161 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Goals that are not listed in the master optimization goals are not available to use for Cruise Control operations.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+Six of these goals are preset as link:#hard-soft-goals[hard goals].\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the link:#default-goals[default optimization goals].\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, do not specify the `goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+Cruise Control uses the _default optimization goals_ to generate the _cached optimization proposal_.\n+For more information about the cached optimization proposal, see xref:con-optimization-proposals-{context}[]. \n+\n+You can override the default optimization goals by setting link:#user-provided-goals[user-provided optimization goals] in a `KafkaRebalance` custom resource.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], the default optimization goals are the same as the master optimization goals.\n+\n+* To use the master optimization goals as the default goals, do not specify the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* To modify the default optimization goals, edit the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+You must use a subset of the master optimization goals.\n+ \n+.Example `Kafka` configuration for default optimization goals\n+\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: Kafka\n+metadata:\n+  name: my-cluster\n+spec:\n+  kafka:\n+    # ...\n+  zookeeper:\n+    # ...\n+  entityOperator:\n+    topicOperator: {}\n+    userOperator: {}\n+  cruiseControl: {}\n+    capacity:\n+      networkIn: 10000KB/s\n+      networkOut: 10000KB/s\n+    config:\n+      default.goals: >\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.DiskCapacityGoal\n+      # ...         \n+----\n+\n+NOTE: For an example of the complete deployment configuration, see xref:proc-deploying-cruise-control-{context}[]. \n+\n+If no default optimization goals are specified, the cached proposal is generated using the master optimization goals.\n+\n+[id=\"user-provided-goals\"]\n+[discrete]\n+=== User-provided optimization goals\n+\n+_User-provided optimization goals_ narrow down the default goals.\n+You can set them, if required, in the `KafkaRebalance` custom resource for a particular optimization proposal: `KafkaRebalance.spec.goals`\n+\n+They are useful for generating an optimization proposal that addresses a particular scenario.\n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering goals for disk capacity or disk utilization. \n+So, you create a `KafkaRebalance` custom resource containing a user-provided goal for leader replica distribution only.\n+\n+User-provided optimization goals must:\n+\n+* Include all configured link:#hard-soft-goals[hard goals], or an error occurs\n+* Be a subset of the master optimization goals\n+\n+To ignore the configured hard goals in an optimization proposal, add the `skipHardGoalCheck: true` option to the `KafkaRebalance` custom resource.\n+\n+[id=\"hard-soft-goals\"]\n+[discrete]\n+=== Hard goals and soft goals\n+\n+In Cruise Control, six of the master optimization goals are preset as _hard goals_:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 134}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMwNjY3MQ==", "bodyText": "If you accept the above suggestion when we should reword this bit too. How about:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Unless `skipHardGoalCheck: true` is specified in the `KafkaRebalance` custom resource, all configured hard goals _must_ be satisfied in optimization proposals.\n          \n          \n            \n            In other words, an optimization proposal that does _not_ satisfy all the hard goals is rejected by Cruise Control and not sent to the user.\n          \n          \n            \n            Setting `skipHardGoalCheck: true` in the `KafkaRebalance` custom resource, provides a way to treat hard goals as if they were soft goals.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427306671", "createdAt": "2020-05-19T13:35:23Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,161 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Goals that are not listed in the master optimization goals are not available to use for Cruise Control operations.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+Six of these goals are preset as link:#hard-soft-goals[hard goals].\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the link:#default-goals[default optimization goals].\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, do not specify the `goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+Cruise Control uses the _default optimization goals_ to generate the _cached optimization proposal_.\n+For more information about the cached optimization proposal, see xref:con-optimization-proposals-{context}[]. \n+\n+You can override the default optimization goals by setting link:#user-provided-goals[user-provided optimization goals] in a `KafkaRebalance` custom resource.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], the default optimization goals are the same as the master optimization goals.\n+\n+* To use the master optimization goals as the default goals, do not specify the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* To modify the default optimization goals, edit the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+You must use a subset of the master optimization goals.\n+ \n+.Example `Kafka` configuration for default optimization goals\n+\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: Kafka\n+metadata:\n+  name: my-cluster\n+spec:\n+  kafka:\n+    # ...\n+  zookeeper:\n+    # ...\n+  entityOperator:\n+    topicOperator: {}\n+    userOperator: {}\n+  cruiseControl: {}\n+    capacity:\n+      networkIn: 10000KB/s\n+      networkOut: 10000KB/s\n+    config:\n+      default.goals: >\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.DiskCapacityGoal\n+      # ...         \n+----\n+\n+NOTE: For an example of the complete deployment configuration, see xref:proc-deploying-cruise-control-{context}[]. \n+\n+If no default optimization goals are specified, the cached proposal is generated using the master optimization goals.\n+\n+[id=\"user-provided-goals\"]\n+[discrete]\n+=== User-provided optimization goals\n+\n+_User-provided optimization goals_ narrow down the default goals.\n+You can set them, if required, in the `KafkaRebalance` custom resource for a particular optimization proposal: `KafkaRebalance.spec.goals`\n+\n+They are useful for generating an optimization proposal that addresses a particular scenario.\n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering goals for disk capacity or disk utilization. \n+So, you create a `KafkaRebalance` custom resource containing a user-provided goal for leader replica distribution only.\n+\n+User-provided optimization goals must:\n+\n+* Include all configured link:#hard-soft-goals[hard goals], or an error occurs\n+* Be a subset of the master optimization goals\n+\n+To ignore the configured hard goals in an optimization proposal, add the `skipHardGoalCheck: true` option to the `KafkaRebalance` custom resource.\n+\n+[id=\"hard-soft-goals\"]\n+[discrete]\n+=== Hard goals and soft goals\n+\n+In Cruise Control, six of the master optimization goals are preset as _hard goals_:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal\n+\n+Unless `skipHardGoalCheck: true` is specified in the `KafkaRebalance` custom resource, all configured hard goals _must_ be satisfied in optimization proposals.\n+In other words, an optimization proposal that does _not_ satisfy all the hard goals is rejected by Cruise Control and not sent to the user.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMwNzc3Nw==", "bodyText": "I guess this could be worked into the first para in this section, if it's not already covered by my suggestion.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427307777", "createdAt": "2020-05-19T13:36:58Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,161 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are targets for workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals, as well as link:#hard-soft-goals[hard] optimization goals that must be satisfied.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Goals that are not listed in the master optimization goals are not available to use for Cruise Control operations.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+Six of these goals are preset as link:#hard-soft-goals[hard goals].\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from users. The priority order of the master optimization goals can be modified, if desired, in the link:#default-goals[default optimization goals].\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, do not specify the `goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+Cruise Control uses the _default optimization goals_ to generate the _cached optimization proposal_.\n+For more information about the cached optimization proposal, see xref:con-optimization-proposals-{context}[]. \n+\n+You can override the default optimization goals by setting link:#user-provided-goals[user-provided optimization goals] in a `KafkaRebalance` custom resource.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], the default optimization goals are the same as the master optimization goals.\n+\n+* To use the master optimization goals as the default goals, do not specify the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* To modify the default optimization goals, edit the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+You must use a subset of the master optimization goals.\n+ \n+.Example `Kafka` configuration for default optimization goals\n+\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: Kafka\n+metadata:\n+  name: my-cluster\n+spec:\n+  kafka:\n+    # ...\n+  zookeeper:\n+    # ...\n+  entityOperator:\n+    topicOperator: {}\n+    userOperator: {}\n+  cruiseControl: {}\n+    capacity:\n+      networkIn: 10000KB/s\n+      networkOut: 10000KB/s\n+    config:\n+      default.goals: >\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.DiskCapacityGoal\n+      # ...         \n+----\n+\n+NOTE: For an example of the complete deployment configuration, see xref:proc-deploying-cruise-control-{context}[]. \n+\n+If no default optimization goals are specified, the cached proposal is generated using the master optimization goals.\n+\n+[id=\"user-provided-goals\"]\n+[discrete]\n+=== User-provided optimization goals\n+\n+_User-provided optimization goals_ narrow down the default goals.\n+You can set them, if required, in the `KafkaRebalance` custom resource for a particular optimization proposal: `KafkaRebalance.spec.goals`\n+\n+They are useful for generating an optimization proposal that addresses a particular scenario.\n+For example, you might want to optimize leader replica distribution across the Kafka cluster without considering goals for disk capacity or disk utilization. \n+So, you create a `KafkaRebalance` custom resource containing a user-provided goal for leader replica distribution only.\n+\n+User-provided optimization goals must:\n+\n+* Include all configured link:#hard-soft-goals[hard goals], or an error occurs\n+* Be a subset of the master optimization goals\n+\n+To ignore the configured hard goals in an optimization proposal, add the `skipHardGoalCheck: true` option to the `KafkaRebalance` custom resource.\n+\n+[id=\"hard-soft-goals\"]\n+[discrete]\n+=== Hard goals and soft goals\n+\n+In Cruise Control, six of the master optimization goals are preset as _hard goals_:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal\n+\n+Unless `skipHardGoalCheck: true` is specified in the `KafkaRebalance` custom resource, all configured hard goals _must_ be satisfied in optimization proposals.\n+In other words, an optimization proposal that does _not_ satisfy all the hard goals is rejected by Cruise Control and not sent to the user.\n+\n+Hard goals are controlled in the Cruise Control deployment configuration, by editing the `hard.goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* To inherit the six preset hard goals from Cruise Control, do not specify the `hard.goals` property in `Kafka.spec.cruiseControl.config`\n+\n+* To change the preset hard goals, specify the desired goals in the `hard.goals` configuration option.\n+\n+Increasing the number of hard goals will reduce the likelihood of Cruise Control generating valid optimization proposals.\n+\n+Goals not designated as hard goals are treated as _soft goals_.\n+Also known as _best effort_ goals, soft goals do _not_ need to be satisfied in optimization proposals, but are included in optimization calculations.\n+An optimization proposal that violates one or more soft goals, but satisfies all hard goals, is valid.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 152}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxMTM3Mg==", "bodyText": "Maybe not in this PR, but this example is practically begging for a few callouts to explain what some of these things mean.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427311372", "createdAt": "2020-05-19T13:41:49Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/proc-generating-rebalance-proposals.adoc", "diffHunk": "@@ -0,0 +1,124 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-generating-optimization-proposals-{context}']\n+= Generating optimization proposals \n+\n+When you create or update a `KafkaRebalance` resource, Cruise Control generates an xref:con-optimization-proposals-{context}[optimization proposal] for the Kafka cluster based on the configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+You can then analyze the summary information in the optimization proposal and decide whether to implement it. \n+\n+.Prerequisites\n+\n+* You have xref:proc-deploying-cruise-control-{context}[deployed Cruise Control] to your {ProductName} cluster.\n+\n+* You have configured xref:con-optimization-goals-{context}[optimization goals].\n+\n+.Procedure\n+\n+. Create a `KafkaRebalance` resource:\n+\n+.. To use the _default optimization goals_ defined in the `Kafka` resource, leave the `spec` property empty:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec: {}\n+----\n+\n+.. To set _user-provided optimization goals_ instead of using the default goals, edit the `goals` property and enter one or more goals.\n++\n+In the following example, rack awareness and replica capacity are user-provided optimization goals:\n++\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: KafkaRebalance\n+metadata:\n+  name: my-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:    \n+  goals:\n+    - RackAwareGoal,\n+    - ReplicaCapacityGoal\n+----\n+\n+. Create or update the resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl apply -f _your-file_\n+----\n++\n+The Cluster Operator requests the optimization proposal from Cruise Control.\n+This might take a few minutes depending on the size of the Kafka cluster. \n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'\n+----\n++\n+Cruise Control returns one of two statuses:\n+\n+** `PendingProposal`: The rebalance operator is polling the Cruise Control API to check if the optimization proposal is ready.\n+\n+** `ProposalReady`: The optimization proposal is ready for review and, if desired, implementation.\n+The status contains the optimization proposal as JSON, in the `status.summary` property of the `KafkaRebalance` resource.\n+\n+. Review the JSON optimization proposal.\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl describe kafkarebalance.kafka.strimzi.io -n <namespace> <rebalance-cr-name>\n+----\n++\n+Here is an example proposal:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+apiVersion: kafka.strimzi.io/v1beta1\n+kind: KafkaRebalance\n+metadata:\n+  name: my-cluster-rebalance\n+  labels: \n+    strimzi.io/cluster: my-cluster\n+spec:\n+  # ...\n+status:\n+  conditions:\n+  - lastTransitionTime: 2020-05-23T23:46:57+0000\n+    status: \"Ready\"\n+    type: State\n+  observedGeneration: 4\n+  summary:\n+  - numIntraBrokerReplicaMovements:0,\n+  - excludedBrokersForLeadership:[],\n+  - numReplicaMovements:31,\n+  - onDemandBalancednessScoreAfter:84.08179174145127,\n+  - onDemandBalancednessScoreBefore:79.74705957325753,\n+  - intraBrokerDataToMoveMB:0,\n+  - recentWindows:1,\n+  - dataToMoveMB:0,\n+  - monitoredPartitionsPercentage:100.0,\n+  - excludedTopics:[],\n+  - numLeaderMovements:12,\n+  - excludedBrokersForReplicaMove:[]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxMTgzMg==", "bodyText": "Again, I think \"apply\" is a better term than \"implement\".", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427311832", "createdAt": "2020-05-19T13:42:24Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,78 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an xref:con-optimization-proposals-{context}[optimization proposal] if its status is `ProposalReady`.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxMzQ3MA==", "bodyText": "But we've not explained the anatomy of a proposal, so the reader is able to review it in any meaningful sense. Presumably by suggested they \"review\" a proposal there is the possibility that they might want to reject the proposal (and generate another), but we need to explain why they might want to do that.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427313470", "createdAt": "2020-05-19T13:44:38Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,78 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an xref:con-optimization-proposals-{context}[optimization proposal] if its status is `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers and change partition leadership, as summarized in the optimization proposal.\n+\n+[CAUTION]\n+====\n+*This is not a dry run.* Before you implement an optimization proposal, you must:\n+\n+* Refresh the proposal in case it has become out of date.\n+* Carefully review the contents of the proposal.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxNzY3Mg==", "bodyText": "Define \"some time\". If 5 minutes too long? Or a hour? Or a day? I know, we can't because it depends on how dynamic their cluster is, but this advice is not really very helpful in its current form. How about \"Unless the proposal has just been generated, it is recommended to validate that it's based on current information about the state of the cluster\"", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427317672", "createdAt": "2020-05-19T13:50:32Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,78 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an xref:con-optimization-proposals-{context}[optimization proposal] if its status is `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers and change partition leadership, as summarized in the optimization proposal.\n+\n+[CAUTION]\n+====\n+*This is not a dry run.* Before you implement an optimization proposal, you must:\n+\n+* Refresh the proposal in case it has become out of date.\n+* Carefully review the contents of the proposal.\n+====\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. If the `KafkaRebalance` status has been `ProposalReady` for some time, it might no longer apply to the current state of the Kafka cluster. In this case, you must refresh the optimization proposal to make sure it uses the latest cluster metrics:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyMDY3Mg==", "bodyText": "We should explain how/why the perf might be affected. People reading this might be put off from using rebalacing, or not know what they should be monitoring during a rebalance. Above all we need to explain the difference between changing leadership of replicas (cheap) and, moving replicas between log dirs on a single broker (expensiveish) reassigning replicas between brokers (expensive).", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427320672", "createdAt": "2020-05-19T13:55:07Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/proc-stopping-cluster-rebalance.adoc", "diffHunk": "@@ -0,0 +1,43 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-stopping-cluster-rebalance-{context}']\n+\n+= Stopping a cluster rebalance\n+\n+Once started, a cluster rebalance operation might take some time to complete and affect the overall performance of the Kafka cluster.  ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMyMDk2MA==", "bodyText": "We should note that this intermediate state might be worse than the initial state.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427320960", "createdAt": "2020-05-19T13:55:30Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/proc-stopping-cluster-rebalance.adoc", "diffHunk": "@@ -0,0 +1,43 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-stopping-cluster-rebalance-{context}']\n+\n+= Stopping a cluster rebalance\n+\n+Once started, a cluster rebalance operation might take some time to complete and affect the overall performance of the Kafka cluster.  \n+\n+If you want to stop a cluster rebalance operation that is in progress, apply a `stop` annotation to the `KafkaRebalance` custom resource. \n+This causes Cruise Control to stop rebalancing after the current batch of partition reassignments has completed. \n+Any partition reassignments before this point will have been successfully applied, so the Kafka cluster will be in a different state compared to before the rebalance operation started.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9066e39850c9b66fc2211d3f21726d4b8117ead"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a70203d2b008cab538fa8b6dc1eb01dce7d117b", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1a70203d2b008cab538fa8b6dc1eb01dce7d117b", "committedDate": "2020-05-19T15:53:52Z", "message": "Added fix rebalance procedure plus review edits\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d84716d33f2a06b588b976f13d980375054eb02", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2d84716d33f2a06b588b976f13d980375054eb02", "committedDate": "2020-05-19T16:06:02Z", "message": "Fixed the status example\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NjAxOTQ2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414601946", "createdAt": "2020-05-19T16:06:49Z", "commit": {"oid": "1a70203d2b008cab538fa8b6dc1eb01dce7d117b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjowNjo0OVrOGXnvUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjowNjo0OVrOGXnvUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQyMTUyMw==", "bodyText": "do you mean \"more\" effectively?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427421523", "createdAt": "2020-05-19T16:06:49Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-cruise-control-overview.adoc", "diffHunk": "@@ -7,16 +7,19 @@\n // See also the complementary step on the last line of this file.\n \n [id='con-cruise-control-overview-{context}']\n-= Cruise Control overview\n+= Why use Cruise Control?\n \n-Brokers in a Kafka cluster can become unevenly loaded for many reasons.\n-For example, partitions that handle large amounts of message traffic can be unevenly distributed across the available brokers.\n-Monitoring broker load and reassigning busy partitions to brokers with spare capacity is time consuming and adds to the overhead of managing a Kafka cluster.\n-Cruise Control is a tool for automating the monitoring and rebalancing of partitions across a Kafka cluster.\n-When deployed alongside a Kafka cluster, Cruise Control can perform the following cluster balancing tasks:\n+Cruise Control reduces the time and effort involved in running an efficient and balanced Kafka cluster.\n \n-* Monitoring the CPU, disk, and network load of Kafka brokers.\n-* Making optimization proposals: balanced partition assignments based on configurable optimization goals.\n-* Executing partition reassignments based on optimization proposals.\n+A typical cluster can become unevenly loaded over time.\n+Partitions that handle large amounts of message traffic might be unevenly distributed across the available brokers.\n+To rebalance the cluster, administrators must monitor the load on brokers and manually reassign busy partitions to brokers with spare capacity.\n \n-The following sections explain how to xref:proc-deploying-cruise-control-{context}[deploy Cruise Control] and xref:ref-cruise-control-configuration-{context}[set configuration options].\n\\ No newline at end of file\n+Cruise Control automates the cluster rebalancing process.\n+It constructs a _workload model_ of resource utilization for the cluster--based on CPU, disk, and network load--and generates _optimization proposals_ for more balanced partition assignments. A set of configurable _optimization goals_ is used to calculate these proposals.\n+\n+You can choose to apply those optimization proposals to your Kafka cluster so the broker pods are used most effectively, leading to a more balanced cluster.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a70203d2b008cab538fa8b6dc1eb01dce7d117b"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NjA0MTU5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414604159", "createdAt": "2020-05-19T16:09:22Z", "commit": {"oid": "2d84716d33f2a06b588b976f13d980375054eb02"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjowOToyMlrOGXn2TQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjowOToyMlrOGXn2TQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQyMzMwOQ==", "bodyText": "\"Use the summary (shown in the Status of the KafkaRebalance resource).....\"", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427423309", "createdAt": "2020-05-19T16:09:22Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,85 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Use the summary to decide whether to implement the cluster rebalance, or change the optimization goals. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d84716d33f2a06b588b976f13d980375054eb02"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NjA1OTE4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414605918", "createdAt": "2020-05-19T16:11:15Z", "commit": {"oid": "2d84716d33f2a06b588b976f13d980375054eb02"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjoxMToxNlrOGXn7pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjoxMToxNlrOGXn7pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQyNDY3OA==", "bodyText": "We should be consistent and use just kafkarebalance here", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427424678", "createdAt": "2020-05-19T16:11:16Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-fixing-problems-with-kafkarebalance.adoc", "diffHunk": "@@ -0,0 +1,49 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-fixing-problems-with-kafkarebalance-{context}']\n+\n+= Fixing problems with a `KafkaRebalance` resource\n+\n+If an issue occurs in the process of creating a `KafkaRebalance` resource, or when interacting with Cruise Control, the error is reported in the resource status, along with details of how to fix it. \n+The resource also moves to the `NotReady` state.\n+\n+To continue with the cluster rebalance operation, you must fix the problem on the `KafkaRebalance` resource itself. \n+Problems can include the following:\n+\n+* A misconfigured parameter.\n+* The Cruise Control server is not reachable. \n+\n+When you believe that you have fixed the issue, you need to add the `refresh` annotation to the resource.\n+During a \u201crefresh\u201d, a new optimization proposal is requested from the Cruise Control server.\n+\n+.Prerequisites\n+\n+* You have xref:proc-implementing-optimization-proposal-{context}[implemented an optimization proposal].\n+\n+* The status of the `KafkaRebalance` custom resource for the rebalance operation is `NotReady`.\n+\n+.Procedure\n+\n+. Get information about the error from the `KafkaRebalance` status and resolve the issue if possible.\n+\n+. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-rebalance-name_ strimzi.io/rebalance=refresh\n+----\n+\n+. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl describe kafkarebalance.kafka.strimzi.io -n <namespace> <rebalance-cr-name>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d84716d33f2a06b588b976f13d980375054eb02"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0NjEwMjky", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-414610292", "createdAt": "2020-05-19T16:16:10Z", "commit": {"oid": "2d84716d33f2a06b588b976f13d980375054eb02"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjoxNjoxMVrOGXoJMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNjoxNjoxMVrOGXoJMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzQyODE0Nw==", "bodyText": "You should make all the \"Check the status of the resource\" command consistent. You uses kubectl describe in others?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427428147", "createdAt": "2020-05-19T16:16:11Z", "author": {"login": "tomncooper"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,78 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an xref:con-optimization-proposals-{context}[optimization proposal] if its status is `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers and change partition leadership, as summarized in the optimization proposal.\n+\n+[CAUTION]\n+====\n+*This is not a dry run.* Before you implement an optimization proposal, you must:\n+\n+* Refresh the proposal in case it has become out of date.\n+* Carefully review the link:#contents-optimization-proposals[contents of the proposal].\n+====\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. If the `KafkaRebalance` status has been `ProposalReady` for some time, it might no longer apply to the current state of the Kafka cluster. In this case, you must refresh the optimization proposal to make sure it uses the latest cluster metrics:\n+\n+.. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-rebalance-name_ strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl get kafka kafkarebalance -o jsonpath='{.status}'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d84716d33f2a06b588b976f13d980375054eb02"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fda12c17fd17b9d8c674d137c18c1daa07a78d51", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/fda12c17fd17b9d8c674d137c18c1daa07a78d51", "committedDate": "2020-05-20T08:52:29Z", "message": "TC comments - part one\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ab13e47cb1f3ab2bbc0321e473aac229b96aa4d", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/3ab13e47cb1f3ab2bbc0321e473aac229b96aa4d", "committedDate": "2020-05-20T09:04:00Z", "message": "Change check status cmds to kubectl describe\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7041e100340f953bdeeecc755983bef20ee4b590", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/7041e100340f953bdeeecc755983bef20ee4b590", "committedDate": "2020-05-20T09:24:03Z", "message": "Added note on intermediate state\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fda4f80919144c80ab80a4dd8f4206dee5a6d8a", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/1fda4f80919144c80ab80a4dd8f4206dee5a6d8a", "committedDate": "2020-05-20T09:31:44Z", "message": "Removed \"some time\" from implement proposals proc\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/49338188e25bee21d724a4ea7e92e48e65f3dacb", "committedDate": "2020-05-20T09:48:56Z", "message": "Added performance impacts to op prop table TB\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MTc0NzE5", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-415174719", "createdAt": "2020-05-20T09:54:38Z", "commit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOTo1NDozOFrOGYEFPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOTo1NDozOFrOGYEFPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg4NTg4NA==", "bodyText": "@tomncooper are we confident that this is interbroker movement, and not the sum of interbroker and intrabroker?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427885884", "createdAt": "2020-05-20T09:54:38Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,91 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Use the summary (shown in the `Status` of the `KafkaRebalance` resource) to decide whether to implement the cluster rebalance, or change the optimization goals.\n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Cached optimization proposal\n+\n+Cruise Control maintains a _cached optimization proposal_ based on the configured default optimization goals.\n+Generated from the workload model, the cached optimization proposal is updated every 15 minutes to reflect the current state of the Kafka cluster.\n+If you generate an optimization proposal using the default optimization goals, Cruise Control returns the most recent cached proposal.\n+\n+To change the cached optimization proposal refresh interval, edit the `proposal.expiration.ms` setting in the Cruise Control deployment configuration.\n+Consider a shorter interval for fast changing clusters, although this increases the load on the Cruise Control server.\n+\n+[id=\"contents-optimization-proposals\"]\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6The total number of partition replicas that will be transferred between the disks of the cluster's brokers.\n+\n+*Performance impact during rebalance operation*: Relatively high, but lower than `numReplicaMovements`.\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Not yet supported. An empty list is returned.\n+\n+m\u00a6numReplicaMovements\n+\u00a6The number of partition replicas that will be moved between separate brokers.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MTc2MTQ0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-415176144", "createdAt": "2020-05-20T09:56:30Z", "commit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOTo1NjozMVrOGYEJjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwOTo1NjozMVrOGYEJjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg4Njk5MA==", "bodyText": "I guess it might be worth calling out that is (and to a lesser extent intraBrokerDataToMoveMB) also provide a guide about how costly the balancing is going to be.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427886990", "createdAt": "2020-05-20T09:56:31Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,91 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Use the summary (shown in the `Status` of the `KafkaRebalance` resource) to decide whether to implement the cluster rebalance, or change the optimization goals.\n+\n+NOTE: All optimization proposals are dry runs: you cannot implement a cluster rebalance without first generating an optimization proposal. \n+There is no limit to the number of optimization proposals that can be generated.\n+\n+[discrete]\n+== Cached optimization proposal\n+\n+Cruise Control maintains a _cached optimization proposal_ based on the configured default optimization goals.\n+Generated from the workload model, the cached optimization proposal is updated every 15 minutes to reflect the current state of the Kafka cluster.\n+If you generate an optimization proposal using the default optimization goals, Cruise Control returns the most recent cached proposal.\n+\n+To change the cached optimization proposal refresh interval, edit the `proposal.expiration.ms` setting in the Cruise Control deployment configuration.\n+Consider a shorter interval for fast changing clusters, although this increases the load on the Cruise Control server.\n+\n+[id=\"contents-optimization-proposals\"]\n+[discrete]\n+== Contents of optimization proposals\n+\n+The following table explains the properties contained in an optimization proposal:\n+\n+[cols=\"2*\",options=\"header\",stripes=\"none\",separator=\u00a6]\n+|===\n+\n+m\u00a6JSON property\n+\u00a6Description\n+\n+m\u00a6numIntraBrokerReplicaMovements\n+\u00a6The total number of partition replicas that will be transferred between the disks of the cluster's brokers.\n+\n+*Performance impact during rebalance operation*: Relatively high, but lower than `numReplicaMovements`.\n+\n+m\u00a6excludedBrokersForLeadership\n+\u00a6Not yet supported. An empty list is returned.\n+\n+m\u00a6numReplicaMovements\n+\u00a6The number of partition replicas that will be moved between separate brokers.\n+\n+*Performance impact during rebalance operation*: Relatively high.\n+\n+m\u00a6onDemandBalancednessScoreBefore, onDemandBalancednessScoreAfter\n+\u00a6A measurement of the overall _balancedness_ of a Kafka Cluster, before and after the optimization proposal was generated.\n+\n+The calculation is 100 minus the sum of the `BalancednessScore` of each violated soft goal. Cruise Control assigns a `BalancednessScore` to every optimization goal based on several factors, including priority (the goal's position in the list of `default.goals` or user-provided goals).\n+\n+The `Before` score is based on the current configuration of the Kafka cluster.\n+The `After` score is based on the generated optimization proposal.\n+\n+m\u00a6intraBrokerDataToMoveMB\n+\u00a6The sum of the size of each partition replica that will be moved between disks on the same broker (see also `numIntraBrokerReplicaMovements`).\n+\n+m\u00a6recentWindows\n+\u00a6The number of metrics windows upon which the optimization proposal is based.\n+\n+m\u00a6dataToMoveMB\n+\u00a6The sum of the size of each partition replica that will be moved to a separate broker (see also `numReplicaMovements`).", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "originalPosition": 67}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MTg0ODI2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-415184826", "createdAt": "2020-05-20T10:07:52Z", "commit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMDowNzo1MlrOGYEkgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMDoxMzozOVrOGYEw0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg5Mzg4OQ==", "bodyText": "comma missing at the end", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427893889", "createdAt": "2020-05-20T10:07:52Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-optimization-goals.adoc", "diffHunk": "@@ -0,0 +1,164 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-goals-{context}']\n+= Optimization goals overview\n+\n+To rebalance a Kafka cluster, Cruise Control uses optimization goals to generate xref:con-optimization-proposals-{context}[optimization proposals].  \n+\n+Optimization goals are constraints on workload redistribution and resource utilization across a Kafka cluster.\n+With a few exceptions, {ProductName} supports all the optimization goals developed in the Cruise Control project.\n+These are as follows, in descending priority order:\n+\n+. Rack-awareness\n+. Replica capacity\n+. Capacity: Disk capacity, Network inbound capacity, Network outbound capacity\n+//.. CPU capacity\n+. Replica distribution\n+. Potential network output\n+. Resource distribution: Disk utilization distribution, Network inbound utilization distribution, Network outbound utilization distribution\n+//.. CPU utilization distribution\n+. Leader bytes-in rate distribution\n+. Topic replica distribution\n+. Leader replica distribution\n+. Preferred leader election\n+//. Intra-broker disk capacity\n+//. Intra-broker disk usage distribution   \n+\n+For more information on each optimization goal, see link:https://github.com/linkedin/cruise-control/wiki/Pluggable-Components#goals[Goals^] in the Cruise Control Wiki.\n+\n+NOTE: CPU goals, intra-broker disk goals, \"Write your own\" goals, and Kafka assigner goals are not yet supported.\n+\n+As described in the following sections, you can customize the supported optimization goals by reordering them in terms of priority, and disabling goals to exclude from optimization proposal calculations.\n+\n+[discrete]\n+== Goals configuration in {ProductName}\n+\n+You configure optimization goals in the `Kafka` and `KafkaRebalance` custom resources. Cruise Control has configurations for link:#hard-soft-goals[hard] optimization goals that must be satisfied, as well as link:#master-goals[master], link:#default-goals[default], and link:#user-provided-goals[user-provided] optimization goals.\n+\n+The following sections describe each goal configuration in more detail.\n+\n+[id=\"hard-soft-goals\"]\n+[discrete]\n+=== Hard goals and soft goals\n+\n+_Hard goals_ are goals that _must_ be satisfied in optimization proposals. \n+Goals that are not hard goals are known as _soft goals_, and might not be satisfied by optimization proposals. \n+You can think of soft goals as _best effort_ goals: they do _not_ need to be satisfied in optimization proposals, but are included in optimization calculations.\n+An optimization proposal that violates one or more soft goals, but satisfies all hard goals, is valid.\n+\n+Cruise control will calculate optimization proposals that satisfy all the hard goals and as many soft goals as possible (in their priority order). \n+An optimization proposal that does _not_ satisfy all the hard goals is rejected by Cruise Control and not sent to the user.\n+\n+NOTE: For example, you might have a soft goal to distribute a topic's replicas evenly across the cluster (the topic replica distribution goal). \n+Cruise Control will ignore this goal if doing so enables all the configured hard goals to be met.\n+\n+In Cruise Control, six of the link:#master-goals[master optimization goals] are preset as hard goals:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal\n+\n+Hard goals are controlled in the Cruise Control deployment configuration, by editing the `hard.goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* To inherit the six preset hard goals from Cruise Control, do not specify the `hard.goals` property in `Kafka.spec.cruiseControl.config`\n+\n+* To change the preset hard goals, specify the desired goals in the `hard.goals` configuration option.\n+\n+Increasing the number of hard goals will reduce the likelihood of Cruise Control generating valid optimization proposals.\n+\n+NOTE: If `skipHardGoalCheck: true` is specified in the `KafkaRebalance` custom resource, Cruise Control does not check that the list of user-provided optimization goals (`goals`) contains _all_ the configured hard goals (`hard.goals`). Therefore, if some, but not all, of the user-provided optimization goals are in the `hard.goals` list, Cruise Control will still treat them as hard goals even if `skipHardGoalCheck: true` is specified.\n+\n+[id=\"master-goals\"]\n+[discrete]\n+=== Master optimization goals\n+\n+The _master optimization goals_ are available to all users.\n+Goals that are not listed in the master optimization goals are not available to use for Cruise Control operations.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], {ProductName} will inherit the following master optimization goals from Cruise Control, in descending priority order:\n+\n+[source]\n+RackAwareGoal; ReplicaCapacityGoal; DiskCapacityGoal; NetworkInboundCapacityGoal; NetworkOutboundCapacityGoal; CpuCapacityGoal; ReplicaDistributionGoal; PotentialNwOutGoal; DiskUsageDistributionGoal; NetworkInboundUsageDistributionGoal; NetworkOutboundUsageDistributionGoal; CpuUsageDistributionGoal; TopicReplicaDistributionGoal; LeaderReplicaDistributionGoal; LeaderBytesInDistributionGoal; PreferredLeaderElectionGoal\n+\n+Six of these goals are preset as link:#hard-soft-goals[hard goals].\n+\n+To reduce complexity, we recommend that you use the inherited master optimization goals, unless you need to _completely_ exclude one or more goals from use in `KafkaRebalance` resources. The priority order of the master optimization goals can be modified, if desired, in the link:#default-goals[default optimization goals].\n+\n+Master optimization goals are controlled, if needed, in the Cruise Control deployment configuration: `Kafka.spec.cruiseControl.config.goals`\n+\n+* To accept the inherited master optimization goals, do not specify the `goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* If you need to modify the inherited master optimization goals, specify a list of goals in the `goals` configuration option.\n+\n+[id=\"default-goals\"]\n+[discrete]\n+=== Default optimization goals\n+\n+Cruise Control uses the _default optimization goals_ to generate the _cached optimization proposal_.\n+For more information about the cached optimization proposal, see xref:con-optimization-proposals-{context}[]. \n+\n+You can override the default optimization goals by setting link:#user-provided-goals[user-provided optimization goals] in a `KafkaRebalance` custom resource.\n+\n+Unless you change the Cruise Control xref:proc-deploying-cruise-control-{context}[deployment configuration], the default optimization goals are the same as the master optimization goals.\n+\n+* To use the master optimization goals as the default goals, do not specify the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+\n+* To modify the default optimization goals, edit the `default.goals` property in `Kafka.spec.cruiseControl.config`.\n+You must use a subset of the master optimization goals.\n+ \n+.Example `Kafka` configuration for default optimization goals\n+\n+[source,yaml,subs=\"attributes+\"]\n+----\n+apiVersion: {KafkaApiVersion}\n+kind: Kafka\n+metadata:\n+  name: my-cluster\n+spec:\n+  kafka:\n+    # ...\n+  zookeeper:\n+    # ...\n+  entityOperator:\n+    topicOperator: {}\n+    userOperator: {}\n+  cruiseControl: {}\n+    capacity:\n+      networkIn: 10000KB/s\n+      networkOut: 10000KB/s\n+    config:\n+      default.goals: >\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.RackAwareGoal,\n+         com.linkedin.kafka.cruisecontrol.analyzer.goals.ReplicaCapacityGoal", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "originalPosition": 133}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg5NDM5NA==", "bodyText": "status", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427894394", "createdAt": "2020-05-20T10:08:47Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/con-optimization-proposals.adoc", "diffHunk": "@@ -0,0 +1,91 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='con-optimization-proposals-{context}']\n+\n+= Optimization proposals overview\n+\n+An _optimization proposal_ is a summary of proposed changes that would produce a more balanced Kafka cluster, with partition workloads distributed more evenly among the brokers. \n+Each optimization proposal is based on the set of xref:con-optimization-goals-{context}[optimization goals] that were used to generate it.\n+\n+Use the summary (shown in the `Status` of the `KafkaRebalance` resource) to decide whether to implement the cluster rebalance, or change the optimization goals.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg5NjMyOQ==", "bodyText": "_cluster-rebalance-name_ should be _rebalance-cr-name_ as other commands.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427896329", "createdAt": "2020-05-20T10:12:21Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,79 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an xref:con-optimization-proposals-{context}[optimization proposal] if its status is `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers and change partition leadership, as summarized in the optimization proposal.\n+\n+[CAUTION]\n+====\n+*This is not a dry run.* Before you implement an optimization proposal, you must:\n+\n+* Refresh the proposal in case it has become out of date.\n+* Carefully review the link:#contents-optimization-proposals[contents of the proposal].\n+====\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. Unless the optimization proposal is newly generated, we recommend you validate that it is based on current information about the state of the Kafka cluster.\n+To do so, refresh the optimization proposal to make sure it uses the latest cluster metrics:\n+\n+.. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-rebalance-name_ strimzi.io/rebalance=refresh", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg5NjUyNQ==", "bodyText": "ditto as above, use _rebalance-cr-name_", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427896525", "createdAt": "2020-05-20T10:12:42Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-implementing-rebalance-proposal.adoc", "diffHunk": "@@ -0,0 +1,79 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-implementing-optimization-proposal-{context}']\n+\n+= Implementing an optimization proposal\n+\n+You can implement an xref:con-optimization-proposals-{context}[optimization proposal] if its status is `ProposalReady`.\n+Cruise Control will then reassign partitions to brokers and change partition leadership, as summarized in the optimization proposal.\n+\n+[CAUTION]\n+====\n+*This is not a dry run.* Before you implement an optimization proposal, you must:\n+\n+* Refresh the proposal in case it has become out of date.\n+* Carefully review the link:#contents-optimization-proposals[contents of the proposal].\n+====\n+\n+.Prerequisites\n+\n+* You have xref:proc-generating-optimization-proposals-{context}[generated an optimization proposal].\n+\n+* The optimization proposal is ready to implement (the `KafkaRebalance` custom resource status is `ProposalReady`).\n+\n+.Procedure\n+\n+Perform these steps for the optimization proposal that you want to implement:\n+\n+. Unless the optimization proposal is newly generated, we recommend you validate that it is based on current information about the state of the Kafka cluster.\n+To do so, refresh the optimization proposal to make sure it uses the latest cluster metrics:\n+\n+.. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-rebalance-name_ strimzi.io/rebalance=refresh\n+----\n+\n+.. Check the status of the `KafkaRebalance` resource:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl describe kafkarebalance _rebalance-cr-name_\n+----\n+\n+.. Wait until the status changes to `ProposalReady`.\n+\n+. Approve the optimization proposal that you want to implement.\n++\n+Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-rebalance-name_ strimzi.io/rebalance=approve", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg5NzA0Mw==", "bodyText": "ditto as above, use _rebalance-cr-name_", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427897043", "createdAt": "2020-05-20T10:13:39Z", "author": {"login": "ppatierno"}, "path": "documentation/modules/cruise-control/proc-stopping-cluster-rebalance.adoc", "diffHunk": "@@ -0,0 +1,45 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-stopping-cluster-rebalance-{context}']\n+\n+= Stopping a cluster rebalance\n+\n+Once started, a cluster rebalance operation might take some time to complete and affect the overall performance of the Kafka cluster.  \n+\n+If you want to stop a cluster rebalance operation that is in progress, apply a `stop` annotation to the `KafkaRebalance` custom resource. \n+This causes Cruise Control to finish the current batch of partition reassignments and then stop the rebalance.\n+Any partition reassignments before this point will have been successfully applied, so the Kafka cluster will be in a different state compared to before the rebalance operation started.\n+Therefore, if further rebalancing is required, you should generate a new optimization proposal. \n+\n+NOTE: The performance of the Kafka cluster in the intermediate (stopped) state might be worse than in the initial state.\n+\n+.Prerequisites\n+\n+* You have xref:proc-implementing-optimization-proposal-{context}[implemented the optimization proposal] by annotating the `KafkaRebalance` custom resource with `approve`. \n+\n+* The status of the `KafkaRebalance` custom resource is `Rebalancing`.\n+\n+.Procedure\n+\n+. Annotate the `KafkaRebalance` resource in Kubernetes:\n++\n+[source,shell,subs=\"+quotes\"]\n+----\n+kubectl annotate kafkarebalance _cluster-rebalance-name_ strimzi.io/rebalance=stop", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49338188e25bee21d724a4ea7e92e48e65f3dacb"}, "originalPosition": 30}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af247fba6efed8161818937f395354508d089c4f", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/af247fba6efed8161818937f395354508d089c4f", "committedDate": "2020-05-20T10:18:02Z", "message": "Fixed Anchors that caused Trais build to fail\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cc36df6f3d5284f27722ec66fc0d51b441bccf0", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/9cc36df6f3d5284f27722ec66fc0d51b441bccf0", "committedDate": "2020-05-20T11:10:04Z", "message": "Changed to Approving an optimization proposal\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20da1339cc1e691f479b680667aad6fcf038acda", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/20da1339cc1e691f479b680667aad6fcf038acda", "committedDate": "2020-05-20T11:23:55Z", "message": "Impact of dataToMoveMB, intraBrokerDataToMoveMB\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2359c3848afdf837918396d226e6e5e270157a47", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/2359c3848afdf837918396d226e6e5e270157a47", "committedDate": "2020-05-20T11:28:00Z", "message": "Use rebalance-cr-name consistently in commands\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "21e8c92bdae8cb7bdce4ced425ae2715a5ace6bd", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/21e8c92bdae8cb7bdce4ced425ae2715a5ace6bd", "committedDate": "2020-05-20T11:33:42Z", "message": "Renamed two modules - no content changes\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "349fb8e532a257d506d62d7fb2b4ab409d05caa6", "author": {"user": null}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/349fb8e532a257d506d62d7fb2b4ab409d05caa6", "committedDate": "2020-05-20T11:37:39Z", "message": "Added percentage widths to op_prop table\n\nSigned-off-by: Daniel Laing <dlaing@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MjUxNTcx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-415251571", "createdAt": "2020-05-20T11:48:14Z", "commit": {"oid": "349fb8e532a257d506d62d7fb2b4ab409d05caa6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1Mjg1NjQ1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-415285645", "createdAt": "2020-05-20T12:34:30Z", "commit": {"oid": "349fb8e532a257d506d62d7fb2b4ab409d05caa6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE1MzA1OTcz", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#pullrequestreview-415305973", "createdAt": "2020-05-20T12:59:52Z", "commit": {"oid": "349fb8e532a257d506d62d7fb2b4ab409d05caa6"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMjo1OTo1MlrOGYKXGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQxMjo1OTo1MlrOGYKXGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzk4ODc2MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            To continue with the cluster rebalance operation, you must fix the problem on the `KafkaRebalance` resource itself. \n          \n          \n            \n            To continue with the cluster rebalance operation, you must fix the problem in the `KafkaRebalance` resource itself.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2956#discussion_r427988760", "createdAt": "2020-05-20T12:59:52Z", "author": {"login": "tombentley"}, "path": "documentation/modules/cruise-control/proc-fixing-problems-with-kafkarebalance.adoc", "diffHunk": "@@ -0,0 +1,49 @@\n+// Module included in the following assemblies:\n+//\n+// assembly-cruise-control-concepts.adoc\n+\n+[id='proc-fixing-problems-with-kafkarebalance-{context}']\n+\n+= Fixing problems with a `KafkaRebalance` resource\n+\n+If an issue occurs in the process of creating a `KafkaRebalance` resource, or when interacting with Cruise Control, the error is reported in the resource status, along with details of how to fix it. \n+The resource also moves to the `NotReady` state.\n+\n+To continue with the cluster rebalance operation, you must fix the problem on the `KafkaRebalance` resource itself. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "349fb8e532a257d506d62d7fb2b4ab409d05caa6"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1610, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}