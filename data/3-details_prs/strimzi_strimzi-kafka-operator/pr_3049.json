{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5Mjk3MzAz", "number": 3049, "title": "Fix Prometheus operator installation", "bodyText": "Signed-off-by: Paolo Patierno ppatierno@live.com\nType of change\n\nDocumentation\n\nDescription\nTrivial PR to fix the installation steps order for the Prometheus installation.\nI think it makes more doing service account, cluster role, binding, and finally the deployment (and not applying this one as the first one).\n[Updated]\nThe CoreOS team changed the way to install it, so now the best way is to use the bundle.yaml file. The new commit reflects this.\nChecklist\nPlease go through this checklist and make sure all applicable tasks have been done\n\n Update/write design documentation in ./design\n Write tests\n Make sure all tests pass\n Update documentation\n Check RBAC rights for Kubernetes / OpenShift roles\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging\n Update CHANGELOG.md", "createdAt": "2020-05-18T06:55:48Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3049", "merged": true, "mergeCommit": {"oid": "19b694f31184671ea62faa3084f6eba591db61c0"}, "closed": true, "closedAt": "2020-05-18T16:53:30Z", "author": {"login": "ppatierno"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABciaPUJAH2gAyNDE5Mjk3MzAzOjE3YTlhNzNhOTBmOTBmNmY3NzQxYzZhNDMxMjIyZDUwYWNmOTkxYjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcihC9AAH2gAyNDE5Mjk3MzAzOjgwOGFkZTE2YWZkOGVjNTViMTJlZWU5ZmNiZTU5MTM4M2JjMGY1ODc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "17a9a73a90f90f6f7741c6a431222d50acf991b3", "author": {"user": {"login": "ppatierno", "name": "Paolo Patierno"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/17a9a73a90f90f6f7741c6a431222d50acf991b3", "committedDate": "2020-05-18T06:53:46Z", "message": "Fix Prometheus operator installation order\n\nSigned-off-by: Paolo Patierno <ppatierno@live.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMzE1OTQ0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3049#pullrequestreview-413315944", "createdAt": "2020-05-18T06:57:54Z", "commit": {"oid": "17a9a73a90f90f6f7741c6a431222d50acf991b3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzMzIzOTY0", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3049#pullrequestreview-413323964", "createdAt": "2020-05-18T07:12:29Z", "commit": {"oid": "17a9a73a90f90f6f7741c6a431222d50acf991b3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91e48d5f217cb212d0cd9b13fbd9c58646b188f5", "author": {"user": {"login": "ppatierno", "name": "Paolo Patierno"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/91e48d5f217cb212d0cd9b13fbd9c58646b188f5", "committedDate": "2020-05-18T09:59:15Z", "message": "Updated doc to use Prometheus Operator bundle for its installation\n\nSigned-off-by: Paolo Patierno <ppatierno@live.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzNTE0MzIw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3049#pullrequestreview-413514320", "createdAt": "2020-05-18T11:43:01Z", "commit": {"oid": "91e48d5f217cb212d0cd9b13fbd9c58646b188f5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzNTMzNjk1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3049#pullrequestreview-413533695", "createdAt": "2020-05-18T12:12:19Z", "commit": {"oid": "91e48d5f217cb212d0cd9b13fbd9c58646b188f5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzNjYyNTU4", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3049#pullrequestreview-413662558", "createdAt": "2020-05-18T14:43:27Z", "commit": {"oid": "91e48d5f217cb212d0cd9b13fbd9c58646b188f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNDo0MzoyN1rOGW6X2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNDo0MzoyN1rOGW6X2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY3ODIzMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            NOTE: the latest Prometheus Operator installation works fine with Kubernetes 1.18+. For checking which version to use with a different Kubernetes, see this https://github.com/coreos/kube-prometheus#kubernetes-compatibility-matrix[compatibility matrix]\n          \n          \n            \n            NOTE: The Prometheus Operator installation works with Kubernetes 1.18+. To check which version to use with a different Kubernetes version, refer to the https://github.com/coreos/kube-prometheus#kubernetes-compatibility-matrix[Kubernetes compatibility matrix].", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3049#discussion_r426678233", "createdAt": "2020-05-18T14:43:27Z", "author": {"login": "PaulRMellor"}, "path": "documentation/modules/metrics/proc_metrics-deploying-prometheus-operator.adoc", "diffHunk": "@@ -6,46 +6,27 @@\n \n = Deploying the Prometheus Operator\n \n-To deploy the Prometheus Operator to your Kafka cluster, apply the YAML resource files from the https://github.com/coreos/prometheus-operator/tree/master/example/rbac/prometheus-operator[Prometheus CoreOS repository].\n+To deploy the Prometheus Operator to your Kafka cluster, apply the YAML bundle resources file from the https://github.com/coreos/prometheus-operator[Prometheus CoreOS repository].\n \n .Procedure\n \n-. Download the resource files from the repository and replace the example `namespace` with your own:\n+. Download the resource file from the repository and replace the example `namespace` with your own:\n +\n On Linux, use:\n +\n [source,shell,subs=+quotes]\n-curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/example/rbac/prometheus-operator/prometheus-operator-deployment.yaml | sed -e 's/namespace: .\\*/namespace: _my-namespace_/' > prometheus-operator-deployment.yaml\n-+\n-[source,shell,subs=+quotes]\n-curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/example/rbac/prometheus-operator/prometheus-operator-cluster-role.yaml > prometheus-operator-cluster-role.yaml\n-+\n-[source,shell,subs=+quotes]\n-curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/example/rbac/prometheus-operator/prometheus-operator-cluster-role-binding.yaml | sed -e 's/namespace: .*/namespace: _my-namespace_/' > prometheus-operator-cluster-role-binding.yaml\n-+\n-[source,shell,subs=+quotes]\n-curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/example/rbac/prometheus-operator/prometheus-operator-service-account.yaml | sed -e 's/namespace: .*/namespace: _my-namespace_/' > prometheus-operator-service-account.yaml\n+curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/bundle.yaml | sed -e 's/namespace: .*/namespace: _my-namespace_/' > prometheus-operator-deployment.yaml\n +\n On MacOS, use:\n +\n [source,shell,subs=+quotes]\n-curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/example/rbac/prometheus-operator/prometheus-operator-deployment.yaml | sed -e '' 's/namespace: .\\*/namespace: _my-namespace_/' > prometheus-operator-deployment.yaml\n-+\n-[source,shell,subs=+quotes]\n-curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/example/rbac/prometheus-operator/prometheus-operator-cluster-role.yaml > prometheus-operator-cluster-role.yaml\n-+\n-[source,shell,subs=+quotes]\n-curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/example/rbac/prometheus-operator/prometheus-operator-cluster-role-binding.yaml | sed -e '' 's/namespace: .*/namespace: _my-namespace_/' > prometheus-operator-cluster-role-binding.yaml\n-+\n-[source,shell,subs=+quotes]\n-curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/example/rbac/prometheus-operator/prometheus-operator-service-account.yaml | sed -e '' 's/namespace: .*/namespace: _my-namespace_/' > prometheus-operator-service-account.yaml\n+curl -s https://raw.githubusercontent.com/coreos/prometheus-operator/master/bundle.yaml | sed -e '' 's/namespace: .*/namespace: _my-namespace_/' > prometheus-operator-deployment.yaml\n +\n NOTE: If it is not required, you can manually remove the `spec.template.spec.securityContext` property from the `prometheus-operator-deployment.yaml` file.\n \n . Deploy the Prometheus Operator:\n +\n [source,shell,subs=\"+attributes\"]\n kubectl apply -f prometheus-operator-deployment.yaml\n-kubectl apply -f prometheus-operator-cluster-role.yaml\n-kubectl apply -f prometheus-operator-cluster-role-binding.yaml\n-kubectl apply -f prometheus-operator-service-account.yaml\n++\n+NOTE: the latest Prometheus Operator installation works fine with Kubernetes 1.18+. For checking which version to use with a different Kubernetes, see this https://github.com/coreos/kube-prometheus#kubernetes-compatibility-matrix[compatibility matrix]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91e48d5f217cb212d0cd9b13fbd9c58646b188f5"}, "originalPosition": 52}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEzNjYzNjMw", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/3049#pullrequestreview-413663630", "createdAt": "2020-05-18T14:44:37Z", "commit": {"oid": "91e48d5f217cb212d0cd9b13fbd9c58646b188f5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "808ade16afd8ec55b12eee9fcbe591383bc0f587", "author": {"user": {"login": "ppatierno", "name": "Paolo Patierno"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/808ade16afd8ec55b12eee9fcbe591383bc0f587", "committedDate": "2020-05-18T14:49:36Z", "message": "Fixed comment\n\nSigned-off-by: Paolo Patierno <ppatierno@live.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1748, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}