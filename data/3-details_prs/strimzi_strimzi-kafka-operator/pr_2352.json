{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4NTk1OTAy", "number": 2352, "title": "Fix user quotas", "bodyText": "Signed-off-by: Stanislav Knot sknot@redhat.com\nType of change\n\nBugfix\n\nDescription\nThe user was created with string quotas. It needs to be created with json formated string.\nChecklist\nPlease go through this checklist and make sure all applicable tasks have been done\n\n Update/write design documentation in ./design\n Write tests\n Make sure all tests pass\n Update documentation\n Check RBAC rights for Kubernetes / OpenShift roles\n Try your changes from Pod inside your Kubernetes and OpenShift cluster, not just locally\n Reference relevant issue(s) and close them after merging\n Update CHANGELOG.md", "createdAt": "2020-01-02T09:22:07Z", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2352", "merged": true, "mergeCommit": {"oid": "f17b360735602dc1c5a56db7a757993e829b97c0"}, "closed": true, "closedAt": "2020-01-06T09:48:14Z", "author": {"login": "sknot-rh"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb2WOQDgH2gAyMzU4NTk1OTAyOjE5OTIzOTM2MWQ1NWZiMWMwMzc1M2UwNDNhY2Q0N2UwOTAzMzlhYmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb2dr_QAFqTMzNzc4MDQwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "199239361d55fb1c03753e043acd47e090339abc", "author": {"user": {"login": "sknot-rh", "name": "Stanislav Knot"}}, "url": "https://github.com/strimzi/strimzi-kafka-operator/commit/199239361d55fb1c03753e043acd47e090339abc", "committedDate": "2020-01-02T09:20:19Z", "message": "Fix user quotas\n\nSigned-off-by: Stanislav Knot <sknot@redhat.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NTgxNTY3", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2352#pullrequestreview-337581567", "createdAt": "2020-01-02T09:31:27Z", "commit": {"oid": "199239361d55fb1c03753e043acd47e090339abc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NTg3MjIx", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2352#pullrequestreview-337587221", "createdAt": "2020-01-02T09:48:33Z", "commit": {"oid": "199239361d55fb1c03753e043acd47e090339abc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQwOTo0ODozM1rOFZoHjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wMlQwOTo0ODozM1rOFZoHjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQxNjAxMg==", "bodyText": "createUserJson() constructs some JsonNode and then serializes it to a String, which you're passing to readTree. I think you should instead factor a method out of createUserJson() which will return the JsonNode, and call that method directly here, avoiding the need to use readTree().", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2352#discussion_r362416012", "createdAt": "2020-01-02T09:48:33Z", "author": {"login": "tombentley"}, "path": "user-operator/src/main/java/io/strimzi/operator/user/operator/KafkaUserQuotasOperator.java", "diffHunk": "@@ -77,7 +77,7 @@ public void createOrUpdate(String username, KafkaUserQuotas quotas) {\n             JsonNode diff = null;\n             try {\n                 ObjectMapper objectMapper = new ObjectMapper();\n-                diff = JsonDiff.asJson(objectMapper.readTree(data), objectMapper.readTree(quotas.toString()));\n+                diff = JsonDiff.asJson(objectMapper.readTree(data), objectMapper.readTree(createUserJson(quotas)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "199239361d55fb1c03753e043acd47e090339abc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NjE5MDY1", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2352#pullrequestreview-337619065", "createdAt": "2020-01-02T11:22:53Z", "commit": {"oid": "199239361d55fb1c03753e043acd47e090339abc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM3NzgwNDA2", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2352#pullrequestreview-337780406", "createdAt": "2020-01-02T18:02:08Z", "commit": {"oid": "199239361d55fb1c03753e043acd47e090339abc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1760, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}