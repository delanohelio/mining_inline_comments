{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY2Mzk4MTU0", "number": 2446, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQyMzo1MzozMVrODccNUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0ODozNVrODc-5FA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxMTQ4ODgzOnYy", "diffSide": "RIGHT", "path": "systemtest/src/test/java/io/strimzi/systemtest/AllNamespaceST.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMVQyMzo1MzozMVrOFkfgWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wMlQwMjowNDowOFrOFkfxlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwOTI0MQ==", "bodyText": "Do we need the two empty lines?", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2446#discussion_r373809241", "createdAt": "2020-02-01T23:53:31Z", "author": {"login": "scholzj"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/AllNamespaceST.java", "diffHunk": "@@ -41,6 +44,7 @@\n     private static final String THIRD_NAMESPACE = \"third-namespace-test\";\n     private static final String SECOND_CLUSTER_NAME = CLUSTER_NAME + \"-second\";\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "529fece172197bb2c8285388fb3de2bbd4061863"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgxMzY1Mw==", "bodyText": "Deleted, sorry about that.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2446#discussion_r373813653", "createdAt": "2020-02-02T02:04:08Z", "author": {"login": "im-konge"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/AllNamespaceST.java", "diffHunk": "@@ -41,6 +44,7 @@\n     private static final String THIRD_NAMESPACE = \"third-namespace-test\";\n     private static final String SECOND_CLUSTER_NAME = CLUSTER_NAME + \"-second\";\n \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwOTI0MQ=="}, "originalCommit": {"oid": "529fece172197bb2c8285388fb3de2bbd4061863"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzE2NTk1OnYy", "diffSide": "RIGHT", "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0Njo1OVrOFlUiZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0Njo1OVrOFlUiZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY3ODExOA==", "bodyText": "same as above", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2446#discussion_r374678118", "createdAt": "2020-02-04T13:46:59Z", "author": {"login": "Frawless"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "diffHunk": "@@ -771,7 +773,7 @@ void testForTopicOperator() throws InterruptedException {\n         KafkaUtils.waitUntilKafkaCRIsReady(CLUSTER_NAME);\n \n         assertThat(KafkaCmdClient.describeTopicUsingPodCli(CLUSTER_NAME, 0, \"topic-from-cli\"),\n-                hasItems(\"PartitionCount:2\"));\n+                hasItems(\"PartitionCount:\", \"2\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "750f165236f721a50aa258f846bebb5d3613b875"}, "originalPosition": 45}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzE2NjE2OnYy", "diffSide": "RIGHT", "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0NzowM1rOFlUiiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0NzowM1rOFlUiiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY3ODE1NQ==", "bodyText": "You should check only for one item PartitionsCount:2, I removed the whitespace in one of my recent PRs so it should work now.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2446#discussion_r374678155", "createdAt": "2020-02-04T13:47:03Z", "author": {"login": "Frawless"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "diffHunk": "@@ -757,7 +759,7 @@ void testForTopicOperator() throws InterruptedException {\n         KafkaUtils.waitUntilKafkaCRIsReady(CLUSTER_NAME);\n \n         assertThat(KafkaCmdClient.describeTopicUsingPodCli(CLUSTER_NAME, 0, \"my-topic\"),\n-                hasItems(\"PartitionCount:2\"));\n+                hasItems(\"PartitionCount:\", \"2\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "750f165236f721a50aa258f846bebb5d3613b875"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzE2OTExOnYy", "diffSide": "RIGHT", "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0Nzo1NFrOFlUkTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0Nzo1NFrOFlUkTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY3ODYwNA==", "bodyText": "Are you sure this is sufficient ? I think we can hit there race-condition where pods will be in terminating, same for PVC but Kafka CR will be deleted.", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2446#discussion_r374678604", "createdAt": "2020-02-04T13:47:54Z", "author": {"login": "Frawless"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "diffHunk": "@@ -1169,7 +1171,7 @@ void testKafkaJBODDeleteClaimsTrueFalse() {\n         // kafka cluster already deployed\n         verifyVolumeNamesAndLabels(2, 2, 10);\n         LOGGER.info(\"Deleting cluster\");\n-        cmdKubeClient().deleteByName(\"kafka\", CLUSTER_NAME).waitForResourceDeletion(\"pod\", KafkaResources.kafkaPodName(CLUSTER_NAME, 0));\n+        cmdKubeClient().deleteByName(\"kafka\", CLUSTER_NAME).waitForResourceDeletion(\"Kafka\", CLUSTER_NAME);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "750f165236f721a50aa258f846bebb5d3613b875"}, "originalPosition": 54}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzE3MDgyOnYy", "diffSide": "RIGHT", "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0ODoyNVrOFlUlWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0ODoyNVrOFlUlWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY3ODg3Mg==", "bodyText": "You can use CLUSTER_NAME instead of my-cluster", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2446#discussion_r374678872", "createdAt": "2020-02-04T13:48:25Z", "author": {"login": "Frawless"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "diffHunk": "@@ -1645,22 +1652,19 @@ void testUOListeningOnlyUsersInSameCluster() {\n \n     @Test\n     void testMessagesAreStoredInDisk() throws Exception {\n-        KafkaResource.kafkaEphemeral(CLUSTER_NAME, 1, 1)\n-            .editSpec()\n-                .editKafka()\n-                    .editListeners()\n-                        .withNewKafkaListenerExternalNodePort()\n-                            .withTls(false)\n-                        .endKafkaListenerExternalNodePort()\n-                    .endListeners()\n-                .endKafka()\n-            .endSpec()\n-            .done();\n+        KafkaResource.kafkaEphemeral(CLUSTER_NAME, 1, 1).done();\n \n         Map<String, String> kafkaPodsSnapshot = StatefulSetUtils.ssSnapshot(kafkaStatefulSetName(CLUSTER_NAME));\n \n         KafkaTopicResource.topic(CLUSTER_NAME, TEST_TOPIC_NAME, 1, 1).done();\n \n+        KafkaClientsResource.deployKafkaClients(false, CLUSTER_NAME + \"-\" + Constants.KAFKA_CLIENTS).done();\n+\n+        final String kafkaClientsPodName =\n+                ResourceManager.kubeClient().listPodsByPrefixInName(\"my-cluster\" + \"-\" + Constants.KAFKA_CLIENTS).get(0).getMetadata().getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "750f165236f721a50aa258f846bebb5d3613b875"}, "originalPosition": 236}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNzE3MTQwOnYy", "diffSide": "RIGHT", "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0ODozNVrOFlUlvA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQxMzo0ODozNVrOFlUlvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY3ODk3Mg==", "bodyText": "same as above", "url": "https://github.com/strimzi/strimzi-kafka-operator/pull/2446#discussion_r374678972", "createdAt": "2020-02-04T13:48:35Z", "author": {"login": "Frawless"}, "path": "systemtest/src/test/java/io/strimzi/systemtest/KafkaST.java", "diffHunk": "@@ -1714,18 +1721,20 @@ void testConsumerOffsetFiles() throws Exception {\n         KafkaResource.kafkaEphemeral(CLUSTER_NAME, 3, 1)\n             .editSpec()\n                 .editKafka()\n-                    .editListeners()\n-                        .withNewKafkaListenerExternalNodePort()\n-                            .withTls(false)\n-                        .endKafkaListenerExternalNodePort()\n-                    .endListeners()\n                     .withConfig(kafkaConfig)\n                 .endKafka()\n             .endSpec()\n             .done();\n \n         KafkaTopicResource.topic(CLUSTER_NAME, TEST_TOPIC_NAME, 3, 1).done();\n \n+        KafkaClientsResource.deployKafkaClients(false, CLUSTER_NAME + \"-\" + Constants.KAFKA_CLIENTS).done();\n+\n+        final String kafkaClientsPodName =\n+                ResourceManager.kubeClient().listPodsByPrefixInName(\"my-cluster\" + \"-\" + Constants.KAFKA_CLIENTS).get(0).getMetadata().getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "750f165236f721a50aa258f846bebb5d3613b875"}, "originalPosition": 274}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 658, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}