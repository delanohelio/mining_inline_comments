{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkzMDYwMTkx", "number": 9065, "title": "fix #8897 and #4023: provide direct log link ability for gc.com/oc.x/gc.su, use in GPX export", "bodyText": "fix #8897 and fix #4023: provide direct log link ability for gc.com/oc.x/gc.su, use in GPX export\nThis PR creates new DB version 87", "createdAt": "2020-09-25T13:08:46Z", "url": "https://github.com/cgeo/cgeo/pull/9065", "merged": true, "mergeCommit": {"oid": "dd7fac824a8a42e47b7063ce77dea757ba947ae2"}, "closed": true, "closedAt": "2020-09-30T20:01:38Z", "author": {"login": "eddiemuc"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdMVrQlgBqjM4MDc2NjgwMTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNZeggABqjM4MTYzMDc2ODg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c5ca6519b9624d3d9d63b0a8759ab8f290af0401", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/c5ca6519b9624d3d9d63b0a8759ab8f290af0401", "committedDate": "2020-09-25T13:07:51Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}, "afterCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985", "committedDate": "2020-09-25T13:18:59Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk2NDU0MjEz", "url": "https://github.com/cgeo/cgeo/pull/9065#pullrequestreview-496454213", "createdAt": "2020-09-25T14:06:37Z", "commit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxNDowNjozN1rOHYFIHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNVQxNDoyNDo1OVrOHYF6QQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAxMTg2OA==", "bodyText": "Typo aravilable", "url": "https://github.com/cgeo/cgeo/pull/9065#discussion_r495011868", "createdAt": "2020-09-25T14:06:37Z", "author": {"login": "okainov"}, "path": "main/src/cgeo/geocaching/connector/IConnector.java", "diffHunk": "@@ -52,6 +53,21 @@\n     @Nullable\n     String getLongCacheUrl(@NonNull Geocache cache);\n \n+    /**\n+     * Get the browser URL for the given LogEntry. May return null if no url aravilable or identifiable.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAxMjY2Nw==", "bodyText": "Why would you need to display log ID to the user at all?", "url": "https://github.com/cgeo/cgeo/pull/9065#discussion_r495012667", "createdAt": "2020-09-25T14:07:51Z", "author": {"login": "okainov"}, "path": "main/src/cgeo/geocaching/connector/IConnector.java", "diffHunk": "@@ -52,6 +53,21 @@\n     @Nullable\n     String getLongCacheUrl(@NonNull Geocache cache);\n \n+    /**\n+     * Get the browser URL for the given LogEntry. May return null if no url aravilable or identifiable.\n+     */\n+    @Nullable\n+    String getCacheLogUrl(@NonNull Geocache cache, @NonNull LogEntry logEntry);\n+\n+    /**\n+     * For a given service-log-id (as assigned by this IConnector and stored as service log id in log entries),\n+     * returns a logid ready for display to the user (e.g. in the GUI)\n+     * May return null if there is no displayable log id.\n+     */\n+    @Nullable\n+    String getDisplayableLogId(@Nullable String serviceLogId);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAxNjU0MQ==", "bodyText": "Just wonder, why do you discard usage of method and use member instead?", "url": "https://github.com/cgeo/cgeo/pull/9065#discussion_r495016541", "createdAt": "2020-09-25T14:12:51Z", "author": {"login": "okainov"}, "path": "main/src/cgeo/geocaching/log/LogsViewCreator.java", "diffHunk": "@@ -96,13 +107,13 @@ protected void fillViewHolder(@SuppressWarnings(\"unused\") final View convertView\n         if (log.hasLogImages()) {\n             holder.images.setText(log.getImageTitles());\n             holder.images.setVisibility(View.VISIBLE);\n-            holder.images.setOnClickListener(v -> ImagesActivity.startActivity(activity, getGeocode(), new ArrayList<>(log.getLogImages())));\n+            holder.images.setOnClickListener(v -> ImagesActivity.startActivity(activity, getGeocode(), new ArrayList<>(log.logImages)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAxNjY4Mg==", "bodyText": "same here", "url": "https://github.com/cgeo/cgeo/pull/9065#discussion_r495016682", "createdAt": "2020-09-25T14:13:02Z", "author": {"login": "okainov"}, "path": "main/src/cgeo/geocaching/log/LogsViewCreator.java", "diffHunk": "@@ -96,13 +107,13 @@ protected void fillViewHolder(@SuppressWarnings(\"unused\") final View convertView\n         if (log.hasLogImages()) {\n             holder.images.setText(log.getImageTitles());\n             holder.images.setVisibility(View.VISIBLE);\n-            holder.images.setOnClickListener(v -> ImagesActivity.startActivity(activity, getGeocode(), new ArrayList<>(log.getLogImages())));\n+            holder.images.setOnClickListener(v -> ImagesActivity.startActivity(activity, getGeocode(), new ArrayList<>(log.logImages)));\n         } else {\n             holder.images.setVisibility(View.GONE);\n         }\n \n         // colored marker\n-        final int marker = log.getType().markerId;\n+        final int marker = log.logType.markerId;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAxODM0NA==", "bodyText": "Typo", "url": "https://github.com/cgeo/cgeo/pull/9065#discussion_r495018344", "createdAt": "2020-09-25T14:15:26Z", "author": {"login": "okainov"}, "path": "main/src/cgeo/geocaching/ui/dialog/ContextMenuDialog.java", "diffHunk": "@@ -0,0 +1,148 @@\n+package cgeo.geocaching.ui.dialog;\n+\n+import cgeo.geocaching.utils.CollectionStream;\n+import cgeo.geocaching.utils.functions.Action1;\n+\n+import android.app.AlertDialog;\n+import android.content.Context;\n+import android.content.DialogInterface;\n+import android.graphics.Rect;\n+import android.graphics.drawable.Drawable;\n+import android.view.View;\n+import android.view.ViewGroup;\n+import android.widget.ArrayAdapter;\n+import android.widget.ListAdapter;\n+import android.widget.TextView;\n+\n+import androidx.annotation.DrawableRes;\n+import androidx.annotation.StringRes;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+/**\n+ * Represents a dlaig usable as a context menu for various elements.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAyMTc4Mg==", "bodyText": "Seems like it was done, is todo still valid?", "url": "https://github.com/cgeo/cgeo/pull/9065#discussion_r495021782", "createdAt": "2020-09-25T14:20:40Z", "author": {"login": "okainov"}, "path": "tests/src-android/cgeo/geocaching/storage/DataStoreTest.java", "diffHunk": "@@ -178,6 +181,22 @@ public static void testLoadLogsFromEmptyGeocode() {\n         assertThat(logs).as(\"Logs for empty geocode\").isEmpty();\n     }\n \n+    public static void testLog() {\n+        //ensure that we don't overwrite anything in database before starting this test\n+        DataStore.removeCache(ARTIFICIAL_GEOCODE, REMOVE_ALL);\n+        assertThat(DataStore.loadLogs(ARTIFICIAL_GEOCODE)).isEmpty();\n+\n+        //TODO: create some logs, try to reload them", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAyMjU1Mg==", "bodyText": "typo, same in other places", "url": "https://github.com/cgeo/cgeo/pull/9065#discussion_r495022552", "createdAt": "2020-09-25T14:21:45Z", "author": {"login": "okainov"}, "path": "tests/src/cgeo/geocaching/connector/gc/GCUtilsTest.java", "diffHunk": "@@ -0,0 +1,85 @@\n+package cgeo.geocaching.connector.gc;\n+\n+import org.junit.Test;\n+import static org.assertj.core.api.Java6Assertions.assertThat;\n+\n+public class GCUtilsTest {\n+\n+    @Test\n+    public void gcCodesNormal() {\n+        testGcCodeRoundtrip(\"GC2MEGA\", 2045702);\n+        testGcCodeRoundtrip(\"GC1PKK9\", 1186660);\n+        testGcCodeRoundtrip(\"GC1234\", 4660);\n+        testGcCodeRoundtrip(\"GCF123\", 61731);\n+\n+        //following line is of no use, simply to pass Codacy (which requires an assert per unit test DIRECLTY in test method...)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTAyNDcwNQ==", "bodyText": "What about simple test for it?", "url": "https://github.com/cgeo/cgeo/pull/9065#discussion_r495024705", "createdAt": "2020-09-25T14:24:59Z", "author": {"login": "okainov"}, "path": "main/src/cgeo/geocaching/connector/su/SuParser.java", "diffHunk": "@@ -260,6 +261,7 @@ private static void parseDescription(final StringBuilder descriptionBuilder, fin\n             final boolean isOwnLog = logResponse.has(LOG_OWN) && logResponse.get(LOG_OWN).asInt() == 1;\n \n             final LogEntry log = new LogEntry.Builder()\n+                    .setServiceLogId(logResponse.get(LOG_ID).asText().trim())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985"}, "originalPosition": 12}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/6e8e79aa12df3b9c12d9c3e5a1c2dbb5fff70985", "committedDate": "2020-09-25T13:18:59Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}, "afterCommit": {"oid": "b90b1dbed234d49c17285cc394638dcbd2a3d915", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/b90b1dbed234d49c17285cc394638dcbd2a3d915", "committedDate": "2020-09-25T14:59:00Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b90b1dbed234d49c17285cc394638dcbd2a3d915", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/b90b1dbed234d49c17285cc394638dcbd2a3d915", "committedDate": "2020-09-25T14:59:00Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}, "afterCommit": {"oid": "8667a116754c857f4218db72fd86de446bef1d0b", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/8667a116754c857f4218db72fd86de446bef1d0b", "committedDate": "2020-09-25T15:15:42Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8667a116754c857f4218db72fd86de446bef1d0b", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/8667a116754c857f4218db72fd86de446bef1d0b", "committedDate": "2020-09-25T15:15:42Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}, "afterCommit": {"oid": "3f9423f7272dcdc5404e68a2dfc5e121c0a66396", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/3f9423f7272dcdc5404e68a2dfc5e121c0a66396", "committedDate": "2020-09-25T22:10:01Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f9423f7272dcdc5404e68a2dfc5e121c0a66396", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/3f9423f7272dcdc5404e68a2dfc5e121c0a66396", "committedDate": "2020-09-25T22:10:01Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}, "afterCommit": {"oid": "47871982275095715e5527dcaf3a660afc574695", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/47871982275095715e5527dcaf3a660afc574695", "committedDate": "2020-09-26T09:24:50Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "47871982275095715e5527dcaf3a660afc574695", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/47871982275095715e5527dcaf3a660afc574695", "committedDate": "2020-09-26T09:24:50Z", "message": "fix #8897: provide direct log link ability for gc.com/oc.x/gc.su"}, "afterCommit": {"oid": "91b7428c50b81be9e298d3f33976763a1ed3e685", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/91b7428c50b81be9e298d3f33976763a1ed3e685", "committedDate": "2020-09-26T22:23:22Z", "message": "fix #8897 and #4032: provide direct log link ability for gc.com/oc.x/gc.su, use in GPX export"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91b7428c50b81be9e298d3f33976763a1ed3e685", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/91b7428c50b81be9e298d3f33976763a1ed3e685", "committedDate": "2020-09-26T22:23:22Z", "message": "fix #8897 and #4032: provide direct log link ability for gc.com/oc.x/gc.su, use in GPX export"}, "afterCommit": {"oid": "091fa3d694cb5e95780a5b0c6fab4dc11d71f99e", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/091fa3d694cb5e95780a5b0c6fab4dc11d71f99e", "committedDate": "2020-09-27T10:24:03Z", "message": "fix #8897 and #4032: provide direct log link ability for gc.com/oc.x/gc.su, use in GPX export"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3MTE0Mjgx", "url": "https://github.com/cgeo/cgeo/pull/9065#pullrequestreview-497114281", "createdAt": "2020-09-27T21:56:47Z", "commit": {"oid": "091fa3d694cb5e95780a5b0c6fab4dc11d71f99e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fbf0f91c6ff2ae05f1a51365643fa20211d998d9", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/fbf0f91c6ff2ae05f1a51365643fa20211d998d9", "committedDate": "2020-09-28T20:18:35Z", "message": "fix #8897 and #4032: provide direct log link ability for gc.com/oc.x/gc.su, use in GPX export"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "091fa3d694cb5e95780a5b0c6fab4dc11d71f99e", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/091fa3d694cb5e95780a5b0c6fab4dc11d71f99e", "committedDate": "2020-09-27T10:24:03Z", "message": "fix #8897 and #4032: provide direct log link ability for gc.com/oc.x/gc.su, use in GPX export"}, "afterCommit": {"oid": "fbf0f91c6ff2ae05f1a51365643fa20211d998d9", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/fbf0f91c6ff2ae05f1a51365643fa20211d998d9", "committedDate": "2020-09-28T20:18:35Z", "message": "fix #8897 and #4032: provide direct log link ability for gc.com/oc.x/gc.su, use in GPX export"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1593, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}