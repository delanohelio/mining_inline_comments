{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3NDA3NTMw", "number": 9138, "title": "related to #8978: fixing non-GUI-parts (img delete, remove exif, move img fct to helper)", "bodyText": "Contains the NON-GUI-parts for #8978 :\n\nmoves image select functionality in separate helper class ImageActivityHelper so it can be used elsewhere too\nensures that EXIF information in images is ALWAYS removed\nadds delete-logic to ensure that no non-used image data is kept on users device\nsome minor fixes (load image thumbnals asynchronously, ensure image default caption is correct on image deletion, center image view in image select activity)", "createdAt": "2020-10-04T10:04:29Z", "url": "https://github.com/cgeo/cgeo/pull/9138", "merged": true, "mergeCommit": {"oid": "bcc3c510ed6204dc5f9e803842a99c354d57d3b7"}, "closed": true, "closedAt": "2020-10-05T19:58:10Z", "author": {"login": "eddiemuc"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPMfMfABqjM4Mzc0MTk3MDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdPcRLKABqjM4Mzg0NzAwNjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f16ecfbb3217dd5f2393e891dc2dec94ed3adabf", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/f16ecfbb3217dd5f2393e891dc2dec94ed3adabf", "committedDate": "2020-10-04T10:00:42Z", "message": "related to #8978: fixing non-GUI-parts (img delete, remove exif, move img fct to helper)"}, "afterCommit": {"oid": "594f8faddeecba1814565a5e3bcff916a699819e", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/594f8faddeecba1814565a5e3bcff916a699819e", "committedDate": "2020-10-04T10:18:25Z", "message": "related to #8978: fixing non-GUI-parts (img delete, remove exif, move img fct to helper)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "594f8faddeecba1814565a5e3bcff916a699819e", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/594f8faddeecba1814565a5e3bcff916a699819e", "committedDate": "2020-10-04T10:18:25Z", "message": "related to #8978: fixing non-GUI-parts (img delete, remove exif, move img fct to helper)"}, "afterCommit": {"oid": "58ad3633cce54fe2d31e3aae979ac796932c5e11", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/58ad3633cce54fe2d31e3aae979ac796932c5e11", "committedDate": "2020-10-04T10:45:25Z", "message": "related to #8978: fixing non-GUI-parts (img delete, remove exif, move img fct to helper)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAxNjQ4NjMw", "url": "https://github.com/cgeo/cgeo/pull/9138#pullrequestreview-501648630", "createdAt": "2020-10-04T18:42:12Z", "commit": {"oid": "58ad3633cce54fe2d31e3aae979ac796932c5e11"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQxODo0MjoxMlrOHcJYuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQxODo0MjoxMlrOHcJYuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3NTk2Mw==", "bodyText": "something yet to be done, or an outdated comment?", "url": "https://github.com/cgeo/cgeo/pull/9138#discussion_r499275963", "createdAt": "2020-10-04T18:42:12Z", "author": {"login": "moving-bits"}, "path": "main/src/cgeo/geocaching/ImageSelectActivity.java", "diffHunk": "@@ -196,129 +196,38 @@ private void syncEditTexts() {\n     }\n \n     private void selectImageFromCamera() {\n-        final File file = ImageUtils.getOutputImageFile();\n-        if (file == null) {\n-            showFailure();\n-            return;\n-        }\n-\n-        image = new Image.Builder().setUrl(Uri.fromFile(file)).build();\n-        if (image.isEmpty()) {\n-            showFailure();\n-            return;\n-        }\n \n-        // create Intent to take a picture and return control to the calling application\n-        final Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\n-        final Context context = getApplicationContext();\n-        final Uri uri = FileProvider.getUriForFile(\n-                context,\n-                context.getString(R.string.file_provider_authority),\n-                file);\n-        intent.putExtra(MediaStore.EXTRA_OUTPUT, uri); // set the image file name\n-\n-        // start the image capture Intent\n-        startActivityForResult(intent, SELECT_NEW_IMAGE);\n+        imageActivityHelper.getImageFromCamera(-1, false, false, img -> {\n+            deleteImageFromDeviceIfNotOriginal(image);\n+            image = img;\n+            loadImagePreview();\n+        });\n     }\n \n     private void selectImageFromStorage() {\n-        final Intent intent = new Intent(Intent.ACTION_GET_CONTENT);\n-        intent.setType(\"image/*\");\n \n-        startActivityForResult(Intent.createChooser(intent, \"Select Image\"), SELECT_STORED_IMAGE);\n+        //TODO: revert to single", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58ad3633cce54fe2d31e3aae979ac796932c5e11"}, "originalPosition": 162}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "387a99a0e88303e581e7080a0f30fdf027af8e5e", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/387a99a0e88303e581e7080a0f30fdf027af8e5e", "committedDate": "2020-10-05T04:41:23Z", "message": "related to #8978: fixing non-GUI-parts (img delete, remove exif, move img fct to helper)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "58ad3633cce54fe2d31e3aae979ac796932c5e11", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/58ad3633cce54fe2d31e3aae979ac796932c5e11", "committedDate": "2020-10-04T10:45:25Z", "message": "related to #8978: fixing non-GUI-parts (img delete, remove exif, move img fct to helper)"}, "afterCommit": {"oid": "387a99a0e88303e581e7080a0f30fdf027af8e5e", "author": {"user": {"login": "eddiemuc", "name": "Eddie"}}, "url": "https://github.com/cgeo/cgeo/commit/387a99a0e88303e581e7080a0f30fdf027af8e5e", "committedDate": "2020-10-05T04:41:23Z", "message": "related to #8978: fixing non-GUI-parts (img delete, remove exif, move img fct to helper)"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1605, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}