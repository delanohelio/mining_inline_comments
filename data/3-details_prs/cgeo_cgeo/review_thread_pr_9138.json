{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3NDA3NTMw", "number": 9138, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQxODo0MjoxMlrOEqHPUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQxODo0MjoxMlrOEqHPUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzEyNTk0MjU3OnYy", "diffSide": "RIGHT", "path": "main/src/cgeo/geocaching/ImageSelectActivity.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNFQxODo0MjoxMlrOHcJYuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxOTo1Nzo1MFrOHcrqUA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3NTk2Mw==", "bodyText": "something yet to be done, or an outdated comment?", "url": "https://github.com/cgeo/cgeo/pull/9138#discussion_r499275963", "createdAt": "2020-10-04T18:42:12Z", "author": {"login": "moving-bits"}, "path": "main/src/cgeo/geocaching/ImageSelectActivity.java", "diffHunk": "@@ -196,129 +196,38 @@ private void syncEditTexts() {\n     }\n \n     private void selectImageFromCamera() {\n-        final File file = ImageUtils.getOutputImageFile();\n-        if (file == null) {\n-            showFailure();\n-            return;\n-        }\n-\n-        image = new Image.Builder().setUrl(Uri.fromFile(file)).build();\n-        if (image.isEmpty()) {\n-            showFailure();\n-            return;\n-        }\n \n-        // create Intent to take a picture and return control to the calling application\n-        final Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\n-        final Context context = getApplicationContext();\n-        final Uri uri = FileProvider.getUriForFile(\n-                context,\n-                context.getString(R.string.file_provider_authority),\n-                file);\n-        intent.putExtra(MediaStore.EXTRA_OUTPUT, uri); // set the image file name\n-\n-        // start the image capture Intent\n-        startActivityForResult(intent, SELECT_NEW_IMAGE);\n+        imageActivityHelper.getImageFromCamera(-1, false, false, img -> {\n+            deleteImageFromDeviceIfNotOriginal(image);\n+            image = img;\n+            loadImagePreview();\n+        });\n     }\n \n     private void selectImageFromStorage() {\n-        final Intent intent = new Intent(Intent.ACTION_GET_CONTENT);\n-        intent.setType(\"image/*\");\n \n-        startActivityForResult(Intent.createChooser(intent, \"Select Image\"), SELECT_STORED_IMAGE);\n+        //TODO: revert to single", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58ad3633cce54fe2d31e3aae979ac796932c5e11"}, "originalPosition": 162}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3OTAwMw==", "bodyText": "Danm, I forgot to remove the TODO tag. But the change itself was done. I can remove the false comment tomorrow (don't have access to source right now)", "url": "https://github.com/cgeo/cgeo/pull/9138#discussion_r499279003", "createdAt": "2020-10-04T19:14:24Z", "author": {"login": "eddiemuc"}, "path": "main/src/cgeo/geocaching/ImageSelectActivity.java", "diffHunk": "@@ -196,129 +196,38 @@ private void syncEditTexts() {\n     }\n \n     private void selectImageFromCamera() {\n-        final File file = ImageUtils.getOutputImageFile();\n-        if (file == null) {\n-            showFailure();\n-            return;\n-        }\n-\n-        image = new Image.Builder().setUrl(Uri.fromFile(file)).build();\n-        if (image.isEmpty()) {\n-            showFailure();\n-            return;\n-        }\n \n-        // create Intent to take a picture and return control to the calling application\n-        final Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\n-        final Context context = getApplicationContext();\n-        final Uri uri = FileProvider.getUriForFile(\n-                context,\n-                context.getString(R.string.file_provider_authority),\n-                file);\n-        intent.putExtra(MediaStore.EXTRA_OUTPUT, uri); // set the image file name\n-\n-        // start the image capture Intent\n-        startActivityForResult(intent, SELECT_NEW_IMAGE);\n+        imageActivityHelper.getImageFromCamera(-1, false, false, img -> {\n+            deleteImageFromDeviceIfNotOriginal(image);\n+            image = img;\n+            loadImagePreview();\n+        });\n     }\n \n     private void selectImageFromStorage() {\n-        final Intent intent = new Intent(Intent.ACTION_GET_CONTENT);\n-        intent.setType(\"image/*\");\n \n-        startActivityForResult(Intent.createChooser(intent, \"Select Image\"), SELECT_STORED_IMAGE);\n+        //TODO: revert to single", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3NTk2Mw=="}, "originalCommit": {"oid": "58ad3633cce54fe2d31e3aae979ac796932c5e11"}, "originalPosition": 162}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTM0NzYzMA==", "bodyText": "something yet to be done, or an outdated comment?\n\nTodo is now removed", "url": "https://github.com/cgeo/cgeo/pull/9138#discussion_r499347630", "createdAt": "2020-10-05T05:05:45Z", "author": {"login": "eddiemuc"}, "path": "main/src/cgeo/geocaching/ImageSelectActivity.java", "diffHunk": "@@ -196,129 +196,38 @@ private void syncEditTexts() {\n     }\n \n     private void selectImageFromCamera() {\n-        final File file = ImageUtils.getOutputImageFile();\n-        if (file == null) {\n-            showFailure();\n-            return;\n-        }\n-\n-        image = new Image.Builder().setUrl(Uri.fromFile(file)).build();\n-        if (image.isEmpty()) {\n-            showFailure();\n-            return;\n-        }\n \n-        // create Intent to take a picture and return control to the calling application\n-        final Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\n-        final Context context = getApplicationContext();\n-        final Uri uri = FileProvider.getUriForFile(\n-                context,\n-                context.getString(R.string.file_provider_authority),\n-                file);\n-        intent.putExtra(MediaStore.EXTRA_OUTPUT, uri); // set the image file name\n-\n-        // start the image capture Intent\n-        startActivityForResult(intent, SELECT_NEW_IMAGE);\n+        imageActivityHelper.getImageFromCamera(-1, false, false, img -> {\n+            deleteImageFromDeviceIfNotOriginal(image);\n+            image = img;\n+            loadImagePreview();\n+        });\n     }\n \n     private void selectImageFromStorage() {\n-        final Intent intent = new Intent(Intent.ACTION_GET_CONTENT);\n-        intent.setType(\"image/*\");\n \n-        startActivityForResult(Intent.createChooser(intent, \"Select Image\"), SELECT_STORED_IMAGE);\n+        //TODO: revert to single", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3NTk2Mw=="}, "originalCommit": {"oid": "58ad3633cce54fe2d31e3aae979ac796932c5e11"}, "originalPosition": 162}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTgzNzUyMA==", "bodyText": "thanks", "url": "https://github.com/cgeo/cgeo/pull/9138#discussion_r499837520", "createdAt": "2020-10-05T19:57:50Z", "author": {"login": "moving-bits"}, "path": "main/src/cgeo/geocaching/ImageSelectActivity.java", "diffHunk": "@@ -196,129 +196,38 @@ private void syncEditTexts() {\n     }\n \n     private void selectImageFromCamera() {\n-        final File file = ImageUtils.getOutputImageFile();\n-        if (file == null) {\n-            showFailure();\n-            return;\n-        }\n-\n-        image = new Image.Builder().setUrl(Uri.fromFile(file)).build();\n-        if (image.isEmpty()) {\n-            showFailure();\n-            return;\n-        }\n \n-        // create Intent to take a picture and return control to the calling application\n-        final Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);\n-        final Context context = getApplicationContext();\n-        final Uri uri = FileProvider.getUriForFile(\n-                context,\n-                context.getString(R.string.file_provider_authority),\n-                file);\n-        intent.putExtra(MediaStore.EXTRA_OUTPUT, uri); // set the image file name\n-\n-        // start the image capture Intent\n-        startActivityForResult(intent, SELECT_NEW_IMAGE);\n+        imageActivityHelper.getImageFromCamera(-1, false, false, img -> {\n+            deleteImageFromDeviceIfNotOriginal(image);\n+            image = img;\n+            loadImagePreview();\n+        });\n     }\n \n     private void selectImageFromStorage() {\n-        final Intent intent = new Intent(Intent.ACTION_GET_CONTENT);\n-        intent.setType(\"image/*\");\n \n-        startActivityForResult(Intent.createChooser(intent, \"Select Image\"), SELECT_STORED_IMAGE);\n+        //TODO: revert to single", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTI3NTk2Mw=="}, "originalCommit": {"oid": "58ad3633cce54fe2d31e3aae979ac796932c5e11"}, "originalPosition": 162}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1790, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}