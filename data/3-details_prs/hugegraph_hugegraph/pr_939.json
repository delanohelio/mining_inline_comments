{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNzg0ODMx", "number": 939, "title": "fix ring assert error and handle two A->B not ring", "bodyText": "Change-Id: Iaff8c4f16e34eb12f0fed2b33487735f783ae0ec", "createdAt": "2020-04-10T06:57:41Z", "url": "https://github.com/hugegraph/hugegraph/pull/939", "merged": true, "mergeCommit": {"oid": "2ac0702b9d7c5b94a27fe95dd85d4cb30fb497b3"}, "closed": true, "closedAt": "2020-04-10T09:02:55Z", "author": {"login": "zhoney"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWLfz1gH2gAyNDAxNzg0ODMxOjRhNDJkZGU4ZDU1ZTBjYjdhMWNiNmM1YTI0YzYzY2IwNDZjNDI4Njk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWNTtzgFqTM5MTM0NDQ1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4a42dde8d55e0cb7a1cb6c5a24c63cb046c42869", "author": {"user": {"login": "zhoney", "name": null}}, "url": "https://github.com/hugegraph/hugegraph/commit/4a42dde8d55e0cb7a1cb6c5a24c63cb046c42869", "committedDate": "2020-04-10T06:56:07Z", "message": "fix ring assert error and handle two A->B not ring\n\nChange-Id: Iaff8c4f16e34eb12f0fed2b33487735f783ae0ec"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzEyMjc5", "url": "https://github.com/hugegraph/hugegraph/pull/939#pullrequestreview-391312279", "createdAt": "2020-04-10T07:43:55Z", "commit": {"oid": "4a42dde8d55e0cb7a1cb6c5a24c63cb046c42869"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzEzNDY1", "url": "https://github.com/hugegraph/hugegraph/pull/939#pullrequestreview-391313465", "createdAt": "2020-04-10T07:46:39Z", "commit": {"oid": "4a42dde8d55e0cb7a1cb6c5a24c63cb046c42869"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzMwNTEz", "url": "https://github.com/hugegraph/hugegraph/pull/939#pullrequestreview-391330513", "createdAt": "2020-04-10T08:29:01Z", "commit": {"oid": "4a42dde8d55e0cb7a1cb6c5a24c63cb046c42869"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODoyOTowMVrOGD0kiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODoyOTowMVrOGD0kiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY2MDIzMw==", "bodyText": "still returned 3 vertices", "url": "https://github.com/hugegraph/hugegraph/pull/939#discussion_r406660233", "createdAt": "2020-04-10T08:29:01Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/traversal/algorithm/SubGraphTraverser.java", "diffHunk": "@@ -82,15 +82,20 @@ private PathSet subGraphPaths(Id sourceV, Directions dir, String label,\n     }\n \n     private static boolean hasMultiEdges(List<Edge> edges, Id target) {\n-        int count = 0;\n+        boolean hasOutEdge = false;\n+        boolean hasInEdge = false;\n         for (Edge edge : edges) {\n             if (((HugeEdge) edge).id().otherVertexId().equals(target)) {\n-                if (++count > 1) {\n+                if (((HugeEdge) edge).direction() == Directions.OUT) {\n+                    hasOutEdge = true;\n+                } else {\n+                    hasInEdge = true;\n+                }\n+                if (hasOutEdge && hasInEdge) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a42dde8d55e0cb7a1cb6c5a24c63cb046c42869"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzQyNDg2", "url": "https://github.com/hugegraph/hugegraph/pull/939#pullrequestreview-391342486", "createdAt": "2020-04-10T08:58:21Z", "commit": {"oid": "4a42dde8d55e0cb7a1cb6c5a24c63cb046c42869"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODo1ODoyMVrOGD1MLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQwODo1ODoyMVrOGD1MLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY3MDM4MA==", "bodyText": "oh seems the graph itself exist both direction edges between tow vertices", "url": "https://github.com/hugegraph/hugegraph/pull/939#discussion_r406670380", "createdAt": "2020-04-10T08:58:21Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/traversal/algorithm/SubGraphTraverser.java", "diffHunk": "@@ -82,15 +82,20 @@ private PathSet subGraphPaths(Id sourceV, Directions dir, String label,\n     }\n \n     private static boolean hasMultiEdges(List<Edge> edges, Id target) {\n-        int count = 0;\n+        boolean hasOutEdge = false;\n+        boolean hasInEdge = false;\n         for (Edge edge : edges) {\n             if (((HugeEdge) edge).id().otherVertexId().equals(target)) {\n-                if (++count > 1) {\n+                if (((HugeEdge) edge).direction() == Directions.OUT) {\n+                    hasOutEdge = true;\n+                } else {\n+                    hasInEdge = true;\n+                }\n+                if (hasOutEdge && hasInEdge) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjY2MDIzMw=="}, "originalCommit": {"oid": "4a42dde8d55e0cb7a1cb6c5a24c63cb046c42869"}, "originalPosition": 15}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxMzQ0NDU0", "url": "https://github.com/hugegraph/hugegraph/pull/939#pullrequestreview-391344454", "createdAt": "2020-04-10T09:02:44Z", "commit": {"oid": "4a42dde8d55e0cb7a1cb6c5a24c63cb046c42869"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2420, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}