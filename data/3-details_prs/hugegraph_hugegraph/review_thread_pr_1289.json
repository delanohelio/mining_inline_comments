{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzNTIwNjAy", "number": 1289, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwNTo1MzowNVrOFCvung==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwNjowNDowOVrOFCv6cQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NDIzNDU0OnYy", "diffSide": "RIGHT", "path": "hugegraph-dist/src/assembly/static/conf/gremlin-server.yaml", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwNTo1MzowNVrOICDvQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwNzoyNTo0MFrOICGD_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTAyOTMxMw==", "bodyText": "export EdgeStep", "url": "https://github.com/hugegraph/hugegraph/pull/1289#discussion_r539029313", "createdAt": "2020-12-09T05:53:05Z", "author": {"login": "javeme"}, "path": "hugegraph-dist/src/assembly/static/conf/gremlin-server.yaml", "diffHunk": "@@ -20,15 +20,27 @@ scriptEngines: {\n           com.baidu.hugegraph.backend.id.IdGenerator,\n           com.baidu.hugegraph.type.define.Directions,\n           com.baidu.hugegraph.type.define.NodeRole,\n-          com.baidu.hugegraph.traversal.algorithm.CustomizePathsTraverser,\n+          com.baidu.hugegraph.traversal.algorithm.CollectionPathsTraverser,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7837241ca702b4667e512eac38ec6feaaf0e6bb9"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTA2NzM4OA==", "bodyText": "already export", "url": "https://github.com/hugegraph/hugegraph/pull/1289#discussion_r539067388", "createdAt": "2020-12-09T07:25:40Z", "author": {"login": "zhoney"}, "path": "hugegraph-dist/src/assembly/static/conf/gremlin-server.yaml", "diffHunk": "@@ -20,15 +20,27 @@ scriptEngines: {\n           com.baidu.hugegraph.backend.id.IdGenerator,\n           com.baidu.hugegraph.type.define.Directions,\n           com.baidu.hugegraph.type.define.NodeRole,\n-          com.baidu.hugegraph.traversal.algorithm.CustomizePathsTraverser,\n+          com.baidu.hugegraph.traversal.algorithm.CollectionPathsTraverser,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTAyOTMxMw=="}, "originalCommit": {"oid": "7837241ca702b4667e512eac38ec6feaaf0e6bb9"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NDI0NjU1OnYy", "diffSide": "RIGHT", "path": "hugegraph-api/src/main/java/com/baidu/hugegraph/api/traversers/TraverserAPI.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwNTo1NzozMVrOICD1rg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwNTo1NzozMVrOICD1rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTAzMDk1OA==", "bodyText": "move to TemplatePathsAPI", "url": "https://github.com/hugegraph/hugegraph/pull/1289#discussion_r539030958", "createdAt": "2020-12-09T05:57:31Z", "author": {"login": "javeme"}, "path": "hugegraph-api/src/main/java/com/baidu/hugegraph/api/traversers/TraverserAPI.java", "diffHunk": "@@ -38,14 +38,11 @@ protected static EdgeStep step(HugeGraph graph, Step step) {\n                             step.degree, step.skipDegree);\n     }\n \n-    protected static TemplatePathsTraverser.RepeatEdgeStep repeatEdgeStep(\n-              HugeGraph graph, TemplatePathsAPI.RepeatEdgeStep step) {\n-        return new TemplatePathsTraverser.RepeatEdgeStep(graph, step.direction,\n-                                                         step.labels,\n-                                                         step.properties,\n-                                                         step.degree,\n-                                                         step.skipDegree,\n-                                                         step.maxTimes);\n+    protected static RepeatEdgeStep repeatEdgeStep(\n+              HugeGraph graph, TemplatePathsAPI.TemplatePathStep step) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "806f2db74038dfbfc266127aca0d23c1d68c1565"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM4NDI2NDgxOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/traversal/algorithm/CountTraverser.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwNjowNDowOVrOICD_pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOVQwNjowNDowOVrOICD_pw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTAzMzUxMQ==", "bodyText": "edgesOfVertexWithCount", "url": "https://github.com/hugegraph/hugegraph/pull/1289#discussion_r539033511", "createdAt": "2020-12-09T06:04:09Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/traversal/algorithm/CountTraverser.java", "diffHunk": "@@ -63,45 +62,45 @@ public long count(Id source, List<Step> steps,\n         }\n \n         int stepNum = steps.size();\n-        Step firstStep = steps.get(0);\n+        EdgeStep firstStep = steps.get(0);\n         if (stepNum == 1) {\n             // Just one step, query count and return\n-            long edgesCount = this.edgesCount(source, firstStep.edgeStep);\n+            long edgesCount = this.edgesCount(source, firstStep);\n             this.count.add(edgesCount);\n             return this.count.longValue();\n         }\n \n         // Multiple steps, construct first step to iterator\n-        Iterator<Edge> edges = this.edgesOfVertex(source, firstStep);\n+        Iterator<Edge> edges = this.edgesOfVertexWithDedup(source, firstStep);\n         // Wrap steps to Iterator except last step\n         for (int i = 1; i < stepNum - 1; i++) {\n-            Step currentStep = steps.get(i);\n+            EdgeStep currentStep = steps.get(i);\n             edges = new FlatMapperIterator<>(edges, (edge) -> {\n                 Id target = ((HugeEdge) edge).id().otherVertexId();\n-                return this.edgesOfVertex(target, currentStep);\n+                return this.edgesOfVertexWithDedup(target, currentStep);\n             });\n         }\n \n         // The last step, just query count\n-        Step lastStep = steps.get(stepNum - 1);\n+        EdgeStep lastStep = steps.get(stepNum - 1);\n         while (edges.hasNext()) {\n             Id target = ((HugeEdge) edges.next()).id().otherVertexId();\n             if (this.dedup(target)) {\n                 continue;\n             }\n             // Count last layer vertices(without dedup size)\n-            long edgesCount = this.edgesCount(target, lastStep.edgeStep);\n+            long edgesCount = this.edgesCount(target, lastStep);\n             this.count.add(edgesCount);\n         }\n \n         return this.count.longValue();\n     }\n \n-    private Iterator<Edge> edgesOfVertex(Id source, Step step) {\n+    private Iterator<Edge> edgesOfVertexWithDedup(Id source, EdgeStep step) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "806f2db74038dfbfc266127aca0d23c1d68c1565"}, "originalPosition": 72}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1537, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}