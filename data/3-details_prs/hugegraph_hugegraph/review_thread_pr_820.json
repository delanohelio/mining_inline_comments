{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwNDQ5MjYz", "number": 820, "reviewThreads": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjowOTo1MFrODXIqqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjozNjowOVrODc3s2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NTg1ODMzOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjowOTo1MFrOFcSXgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjowOTo1MFrOFcSXgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIwNTM3OA==", "bodyText": "don't append VALUE_SPLITOR for the first property", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r365205378", "createdAt": "2020-01-10T12:09:50Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "diffHunk": "@@ -116,6 +116,22 @@ private String formatPropertyValue(HugeProperty<?> prop) {\n         return JsonUtil.toJson(prop.value());\n     }\n \n+    private String formatPropertyName() {\n+        return HugeType.PROPERTY.string();\n+    }\n+\n+    private String formatPropertyValues(HugeVertex vertex) {\n+        StringBuilder sb = new StringBuilder(256 * vertex.getProperties().size());\n+        // Vertex properties\n+        for (HugeProperty<?> property : vertex.getProperties().values()) {\n+            sb.append(VALUE_SPLITOR);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e180cd17e6e4168a187de3a7465835c0fb52d73e"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NTg1OTAxOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjoxMDoxM1rOFcSX8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjoxMDoxM1rOFcSX8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIwNTQ4OA==", "bodyText": "i + 1 may be out of bound", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r365205488", "createdAt": "2020-01-10T12:10:13Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "diffHunk": "@@ -142,6 +158,14 @@ private void parseProperty(String colName, String colValue,\n         }\n     }\n \n+    private void parseProperties(String colValue, HugeVertex vertex) {\n+        String[] valParts = colValue.split(VALUE_SPLITOR);\n+        // Edge properties\n+        for (int i = 1; i < valParts.length; i += 2) {\n+            this.parseProperty(valParts[i], valParts[i + 1], vertex);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e180cd17e6e4168a187de3a7465835c0fb52d73e"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NTg1OTkyOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjoxMDozNVrOFcSYcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjoxMDozNVrOFcSYcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIwNTYxNg==", "bodyText": "remove it", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r365205616", "createdAt": "2020-01-10T12:10:35Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "diffHunk": "@@ -244,29 +268,27 @@ public BackendEntry writeVertex(HugeVertex vertex) {\n         }\n \n         // Add all properties of a Vertex\n-        for (HugeProperty<?> prop : vertex.getProperties().values()) {\n-            entry.column(this.formatPropertyName(prop),\n-                         this.formatPropertyValue(prop));\n-        }\n-\n+        entry.column(this.formatPropertyName(),\n+                     this.formatPropertyValues(vertex));\n         return entry;\n     }\n \n     @Override\n     public BackendEntry writeVertexProperty(HugeVertexProperty<?> prop) {\n-        HugeVertex vertex = prop.element();\n-        TextBackendEntry entry = newBackendEntry(vertex);\n-        entry.subId(IdGenerator.of(prop.key()));\n-\n-        // Write label (NOTE: maybe just with edges if label is null)\n-        if (vertex.schemaLabel() != null) {\n-            entry.column(this.formatSyspropName(HugeKeys.LABEL),\n-                         writeId(vertex.schemaLabel().id()));\n-        }\n-\n-        entry.column(this.formatPropertyName(prop),\n-                     this.formatPropertyValue(prop));\n-        return entry;\n+        throw new NotImplementedException(\"Unsupported writeVertexProperty()\");\n+//        HugeVertex vertex = prop.element();\n+//        TextBackendEntry entry = newBackendEntry(vertex);\n+//        entry.subId(IdGenerator.of(prop.key()));\n+//\n+//        // Write label (NOTE: maybe just with edges if label is null)\n+//        if (vertex.schemaLabel() != null) {\n+//            entry.column(this.formatSyspropName(HugeKeys.LABEL),\n+//                         writeId(vertex.schemaLabel().id()));\n+//        }\n+//\n+//        entry.column(this.formatPropertyName(prop),\n+//                     this.formatPropertyValue(prop));\n+//        return entry;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e180cd17e6e4168a187de3a7465835c0fb52d73e"}, "originalPosition": 94}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NTg2NTc1OnYy", "diffSide": "RIGHT", "path": "hugegraph-test/src/main/java/com/baidu/hugegraph/unit/serializer/BinarySerializerTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjoxMzozM1rOFcScCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQxMjoxMzozM1rOFcScCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTIwNjUzOQ==", "bodyText": "also add BinaryScatterSerializerTest", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r365206539", "createdAt": "2020-01-10T12:13:33Z", "author": {"login": "javeme"}, "path": "hugegraph-test/src/main/java/com/baidu/hugegraph/unit/serializer/BinarySerializerTest.java", "diffHunk": "@@ -30,11 +30,11 @@\n import com.baidu.hugegraph.unit.BaseUnitTest;\n import com.baidu.hugegraph.unit.FakeObjects;\n \n-public class BinaryInlineSerializerTest extends BaseUnitTest {\n+public class BinarySerializerTest extends BaseUnitTest {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e180cd17e6e4168a187de3a7465835c0fb52d73e"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2MjAwMDMwOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinarySerializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMzowNDoyNVrOFdLB-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMzowNDoyNVrOFdLB-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEzMzc1Mw==", "bodyText": "update vertex.get()", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r366133753", "createdAt": "2020-01-14T03:04:25Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinarySerializer.java", "diffHunk": "@@ -367,23 +367,34 @@ public BackendEntry writeVertex(HugeVertex vertex) {\n             return entry;\n         }\n \n+        int propsCount = vertex.getProperties().size();\n+        BytesBuffer buffer = BytesBuffer.allocate(8 + 16 * propsCount);\n+\n         // Write vertex label\n-        entry.column(this.formatLabel(vertex));\n+        buffer.writeId(vertex.schemaLabel().id());\n \n-        // Write all properties of a Vertex\n-        for (HugeProperty<?> prop : vertex.getProperties().values()) {\n-            entry.column(this.formatProperty(prop));\n-        }\n+        // Write all properties of the vertex\n+        this.formatProperties(vertex.getProperties().values(), buffer);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ea3ffaeec1b3e81f57050c61cfd03321e5a6eb7"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI4ODE3NzY0OnYy", "diffSide": "RIGHT", "path": "hugegraph-rocksdb/src/main/java/com/baidu/hugegraph/backend/store/rocksdb/RocksDBTables.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yM1QxNTo0MzoyNFrOFhC8uQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjoxNTozM1rOFlJFqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE5NTY0MQ==", "bodyText": "prefer to add a protected method getById() to super class, and just call super.getById() here, also call it from EdgeTable.queryById().", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r370195641", "createdAt": "2020-01-23T15:43:24Z", "author": {"login": "javeme"}, "path": "hugegraph-rocksdb/src/main/java/com/baidu/hugegraph/backend/store/rocksdb/RocksDBTables.java", "diffHunk": "@@ -120,6 +120,16 @@ public IndexLabel(String database) {\n         public Vertex(String database) {\n             super(database, TABLE);\n         }\n+\n+        @Override\n+        protected BackendColumnIterator queryById(Session session, Id id) {\n+            byte[] value = session.get(this.table(), id.asBytes());\n+            if (value == null) {\n+                return BackendColumnIterator.empty();\n+            }\n+            BackendColumn col = BackendColumn.of(id.asBytes(), value);\n+            return new BackendColumnIteratorWrapper(col);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79d079a61e939842e05196c16697e88a22a3fb83"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5MDUzOQ==", "bodyText": "prefer to add a protected method getById() to super class, and just call super.getById() here, also call it from EdgeTable.queryById().", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r374490539", "createdAt": "2020-02-04T06:15:33Z", "author": {"login": "javeme"}, "path": "hugegraph-rocksdb/src/main/java/com/baidu/hugegraph/backend/store/rocksdb/RocksDBTables.java", "diffHunk": "@@ -120,6 +120,16 @@ public IndexLabel(String database) {\n         public Vertex(String database) {\n             super(database, TABLE);\n         }\n+\n+        @Override\n+        protected BackendColumnIterator queryById(Session session, Id id) {\n+            byte[] value = session.get(this.table(), id.asBytes());\n+            if (value == null) {\n+                return BackendColumnIterator.empty();\n+            }\n+            BackendColumn col = BackendColumn.of(id.asBytes(), value);\n+            return new BackendColumnIteratorWrapper(col);\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDE5NTY0MQ=="}, "originalCommit": {"oid": "79d079a61e939842e05196c16697e88a22a3fb83"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjQ0NTMwOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinarySerializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNTozNzoxOFrOFjvgDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNTozNzoxOFrOFjvgDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzAyMjczNQ==", "bodyText": "diff --git a/hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinaryInlineSerializer.java b/hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinaryInlineSerializer.java\nindex b94d0608..b2481aa6 100644\n--- a/hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinaryInlineSerializer.java\n+++ b/hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinaryInlineSerializer.java\n@@ -72,11 +72,13 @@ public class BinaryInlineSerializer extends BinarySerializer {\n \n         // Parse all properties and edges of a Vertex\n         for (BackendColumn col : entry.columns()) {\n-            if (id.edge()) {\n+            // NOTE: the entry id type is vertex even if entry type is edge\n+            if (entry.type().isEdge()) {\n                 // Parse vertex edges\n                 this.parseColumn(col, vertex);\n             } else {\n                 // Parse vertex properties\n+                assert entry.type().isVertex();\n                 assert entry.columnsSize() == 1 : entry.columnsSize();\n                 this.parseVertex(col.value, vertex);\n             }", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r373022735", "createdAt": "2020-01-30T15:37:18Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinarySerializer.java", "diffHunk": "@@ -393,21 +404,22 @@ public HugeVertex readVertex(HugeGraph graph, BackendEntry bytesEntry) {\n         }\n         BinaryBackendEntry entry = this.convertEntry(bytesEntry);\n \n-        // Parse label\n-        final byte[] VL = this.formatSyspropName(entry.id(), HugeKeys.LABEL);\n-        BackendColumn vl = entry.column(VL);\n-        VertexLabel label = VertexLabel.NONE;\n-        if (vl != null) {\n-            label = graph.vertexLabel(BytesBuffer.wrap(vl.value).readId());\n-        }\n-\n         // Parse id\n         Id id = entry.id().origin();\n-        HugeVertex vertex = new HugeVertex(graph, id, label);\n+        Id vid = id.edge() ? ((EdgeId) id).ownerVertexId() : id;\n+        HugeVertex vertex = new HugeVertex(graph, vid, VertexLabel.NONE);\n \n         // Parse all properties and edges of a Vertex\n         for (BackendColumn col : entry.columns()) {\n-            this.parseColumn(col, vertex);\n+            if (entry.type().isEdge()) {\n+                // NOTE: the id is vertex type even if query edge\n+                // Parse vertex edges\n+                this.parseColumn(col, vertex);\n+            } else {\n+                // Parse vertex properties\n+                assert entry.columnsSize() == 1 : entry.columnsSize();\n+                this.parseVertex(col.value, vertex);\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79d079a61e939842e05196c16697e88a22a3fb83"}, "originalPosition": 73}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMwNjU1MzA1OnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinarySerializer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0zMFQxNjowNDo1M1rOFjwj5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjowOToxM1rOFlJAng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA0MDEwMw==", "bodyText": "This bug was introduced from https://github.com/hugegraph/hugegraph/pull/680/files#diff-e46dfe3b041d128cc0a4657fe901a3b7R75", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r373040103", "createdAt": "2020-01-30T16:04:53Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinarySerializer.java", "diffHunk": "@@ -393,21 +404,22 @@ public HugeVertex readVertex(HugeGraph graph, BackendEntry bytesEntry) {\n         }\n         BinaryBackendEntry entry = this.convertEntry(bytesEntry);\n \n-        // Parse label\n-        final byte[] VL = this.formatSyspropName(entry.id(), HugeKeys.LABEL);\n-        BackendColumn vl = entry.column(VL);\n-        VertexLabel label = VertexLabel.NONE;\n-        if (vl != null) {\n-            label = graph.vertexLabel(BytesBuffer.wrap(vl.value).readId());\n-        }\n-\n         // Parse id\n         Id id = entry.id().origin();\n-        HugeVertex vertex = new HugeVertex(graph, id, label);\n+        Id vid = id.edge() ? ((EdgeId) id).ownerVertexId() : id;\n+        HugeVertex vertex = new HugeVertex(graph, vid, VertexLabel.NONE);\n \n         // Parse all properties and edges of a Vertex\n         for (BackendColumn col : entry.columns()) {\n-            this.parseColumn(col, vertex);\n+            if (entry.type().isEdge()) {\n+                // NOTE: the id is vertex type even if query edge", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "79d079a61e939842e05196c16697e88a22a3fb83"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ4OTI0Ng==", "bodyText": "// NOTE: the entry id type is vertex even if entry type is edge", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r374489246", "createdAt": "2020-02-04T06:09:13Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinarySerializer.java", "diffHunk": "@@ -393,21 +404,22 @@ public HugeVertex readVertex(HugeGraph graph, BackendEntry bytesEntry) {\n         }\n         BinaryBackendEntry entry = this.convertEntry(bytesEntry);\n \n-        // Parse label\n-        final byte[] VL = this.formatSyspropName(entry.id(), HugeKeys.LABEL);\n-        BackendColumn vl = entry.column(VL);\n-        VertexLabel label = VertexLabel.NONE;\n-        if (vl != null) {\n-            label = graph.vertexLabel(BytesBuffer.wrap(vl.value).readId());\n-        }\n-\n         // Parse id\n         Id id = entry.id().origin();\n-        HugeVertex vertex = new HugeVertex(graph, id, label);\n+        Id vid = id.edge() ? ((EdgeId) id).ownerVertexId() : id;\n+        HugeVertex vertex = new HugeVertex(graph, vid, VertexLabel.NONE);\n \n         // Parse all properties and edges of a Vertex\n         for (BackendColumn col : entry.columns()) {\n-            this.parseColumn(col, vertex);\n+            if (entry.type().isEdge()) {\n+                // NOTE: the id is vertex type even if query edge", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzA0MDEwMw=="}, "originalCommit": {"oid": "79d079a61e939842e05196c16697e88a22a3fb83"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTk1MzUxOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinarySerializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjowODozNFrOFlJAIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjowODozNFrOFlJAIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ4OTEyMA==", "bodyText": "assert entry.type().isVertex();", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r374489120", "createdAt": "2020-02-04T06:08:34Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/BinarySerializer.java", "diffHunk": "@@ -393,21 +404,22 @@ public HugeVertex readVertex(HugeGraph graph, BackendEntry bytesEntry) {\n         }\n         BinaryBackendEntry entry = this.convertEntry(bytesEntry);\n \n-        // Parse label\n-        final byte[] VL = this.formatSyspropName(entry.id(), HugeKeys.LABEL);\n-        BackendColumn vl = entry.column(VL);\n-        VertexLabel label = VertexLabel.NONE;\n-        if (vl != null) {\n-            label = graph.vertexLabel(BytesBuffer.wrap(vl.value).readId());\n-        }\n-\n         // Parse id\n         Id id = entry.id().origin();\n-        HugeVertex vertex = new HugeVertex(graph, id, label);\n+        Id vid = id.edge() ? ((EdgeId) id).ownerVertexId() : id;\n+        HugeVertex vertex = new HugeVertex(graph, vid, VertexLabel.NONE);\n \n         // Parse all properties and edges of a Vertex\n         for (BackendColumn col : entry.columns()) {\n-            this.parseColumn(col, vertex);\n+            if (entry.type().isEdge()) {\n+                // NOTE: the id is vertex type even if query edge\n+                // Parse vertex edges\n+                this.parseColumn(col, vertex);\n+            } else {\n+                // Parse vertex properties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c08d929a4c945f9b9dd4321bf0b8d986b78cb0d"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTk3NjYzOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjoyNTo0NlrOFlJOZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjoyNTo0NlrOFlJOZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5Mjc3Mg==", "bodyText": "remove the catch after check valParts.length % 2 == 0", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r374492772", "createdAt": "2020-02-04T06:25:46Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "diffHunk": "@@ -142,6 +162,21 @@ private void parseProperty(String colName, String colValue,\n         }\n     }\n \n+    private void parseProperties(String colValue, HugeVertex vertex) {\n+        if (colValue == null || colValue.isEmpty()) {\n+            return;\n+        }\n+        String[] valParts = colValue.split(VALUE_SPLITOR);\n+        // Edge properties\n+        for (int i = 0; i < valParts.length; i += 2) {\n+            try {\n+                this.parseProperty(valParts[i], valParts[i + 1], vertex);\n+            } catch (ArrayIndexOutOfBoundsException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c08d929a4c945f9b9dd4321bf0b8d986b78cb0d"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTk4MDUyOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjoyODowMlrOFlJQpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjoyODowMlrOFlJQpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5MzM1MA==", "bodyText": "E.checkState(valParts.length % 2 == 0)", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r374493350", "createdAt": "2020-02-04T06:28:02Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "diffHunk": "@@ -142,6 +162,21 @@ private void parseProperty(String colName, String colValue,\n         }\n     }\n \n+    private void parseProperties(String colValue, HugeVertex vertex) {\n+        if (colValue == null || colValue.isEmpty()) {\n+            return;\n+        }\n+        String[] valParts = colValue.split(VALUE_SPLITOR);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c08d929a4c945f9b9dd4321bf0b8d986b78cb0d"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTk5MTIwOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjozNTowMVrOFlJXJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjozNTowMVrOFlJXJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5NTAxMw==", "bodyText": "assert i + 1 < valParts.length", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r374495013", "createdAt": "2020-02-04T06:35:01Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "diffHunk": "@@ -142,6 +162,21 @@ private void parseProperty(String colName, String colValue,\n         }\n     }\n \n+    private void parseProperties(String colValue, HugeVertex vertex) {\n+        if (colValue == null || colValue.isEmpty()) {\n+            return;\n+        }\n+        String[] valParts = colValue.split(VALUE_SPLITOR);\n+        // Edge properties\n+        for (int i = 0; i < valParts.length; i += 2) {\n+            try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c08d929a4c945f9b9dd4321bf0b8d986b78cb0d"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMxNTk5MzIzOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjozNjowOVrOFlJYVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNFQwNjozNjowOVrOFlJYVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDQ5NTMxNg==", "bodyText": "64 * size is ok", "url": "https://github.com/hugegraph/hugegraph/pull/820#discussion_r374495316", "createdAt": "2020-02-04T06:36:09Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/backend/serializer/TextSerializer.java", "diffHunk": "@@ -116,6 +116,26 @@ private String formatPropertyValue(HugeProperty<?> prop) {\n         return JsonUtil.toJson(prop.value());\n     }\n \n+    private String formatPropertyName() {\n+        return HugeType.PROPERTY.string();\n+    }\n+\n+    private String formatPropertyValues(HugeVertex vertex) {\n+        int size = vertex.getProperties().size();\n+        StringBuilder sb = new StringBuilder(256 * size);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c08d929a4c945f9b9dd4321bf0b8d986b78cb0d"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1559, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}