{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MTYyMTEw", "number": 1134, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMzo0Njo1NVrOEWEW0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMzo0ODoxN1rOEWEXqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNTc1NTA0OnYy", "diffSide": "RIGHT", "path": "hugegraph-api/src/main/java/com/baidu/hugegraph/auth/HugeGraphAuthProxy.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMzo0Njo1NVrOG9LgLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwNjowNTozNlrOG9NmIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjgwNDc4Mw==", "bodyText": "olap task may run not in grizzly-http-server thread", "url": "https://github.com/hugegraph/hugegraph/pull/1134#discussion_r466804783", "createdAt": "2020-08-07T03:46:55Z", "author": {"login": "zhoney"}, "path": "hugegraph-api/src/main/java/com/baidu/hugegraph/auth/HugeGraphAuthProxy.java", "diffHunk": "@@ -1372,8 +1389,21 @@ public void applyStrategies(Admin<?, ?> traversal) {\n                 script = translator.translate(traversal.getBytecode());\n             }\n \n-            verifyNamePermission(HugePermission.EXECUTE,\n-                                 ResourceType.GREMLIN, script);\n+            /*\n+             * Verify gremlin-execute permission for user gremlin(in gremlin-\n+             * server-exec worker) and gremlin job(in task worker).\n+             * But don't check permission in rest worker, because the following\n+             * places need to call traversal():\n+             *  1.vertices/edges rest api\n+             *  2.oltp rest api (like crosspointpath/neighborrank)\n+             *  3.olap rest api (like centrality/lpa/louvain/subgraph)\n+             */\n+            String caller = Thread.currentThread().getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjgzOTA3NQ==", "bodyText": "yes olap may run in task worker or olap thread, but currently we can't distinguish gremlin job and olap job", "url": "https://github.com/hugegraph/hugegraph/pull/1134#discussion_r466839075", "createdAt": "2020-08-07T06:05:36Z", "author": {"login": "javeme"}, "path": "hugegraph-api/src/main/java/com/baidu/hugegraph/auth/HugeGraphAuthProxy.java", "diffHunk": "@@ -1372,8 +1389,21 @@ public void applyStrategies(Admin<?, ?> traversal) {\n                 script = translator.translate(traversal.getBytecode());\n             }\n \n-            verifyNamePermission(HugePermission.EXECUTE,\n-                                 ResourceType.GREMLIN, script);\n+            /*\n+             * Verify gremlin-execute permission for user gremlin(in gremlin-\n+             * server-exec worker) and gremlin job(in task worker).\n+             * But don't check permission in rest worker, because the following\n+             * places need to call traversal():\n+             *  1.vertices/edges rest api\n+             *  2.oltp rest api (like crosspointpath/neighborrank)\n+             *  3.olap rest api (like centrality/lpa/louvain/subgraph)\n+             */\n+            String caller = Thread.currentThread().getName();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjgwNDc4Mw=="}, "originalCommit": {"oid": "591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc"}, "originalPosition": 83}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNTc1Njk1OnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/StandardHugeGraph.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMzo0ODowN1rOG9LhPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMzo0ODowN1rOG9LhPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjgwNTA1Mg==", "bodyText": "object", "url": "https://github.com/hugegraph/hugegraph/pull/1134#discussion_r466805052", "createdAt": "2020-08-07T03:48:07Z", "author": {"login": "zhoney"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/StandardHugeGraph.java", "diffHunk": "@@ -467,6 +462,11 @@ public void removeEdge(Edge edge) {\n         this.graphTransaction().removeEdgeProperty((HugeEdgeProperty<V>) p);\n     }\n \n+    @Override\n+    public Vertex vertex(Object objects) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNTc1NzIzOnYy", "diffSide": "RIGHT", "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/StandardHugeGraph.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMzo0ODoxN1rOG9LhYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMzo0ODoxN1rOG9LhYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjgwNTA5MA==", "bodyText": "ditto", "url": "https://github.com/hugegraph/hugegraph/pull/1134#discussion_r466805090", "createdAt": "2020-08-07T03:48:17Z", "author": {"login": "zhoney"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/StandardHugeGraph.java", "diffHunk": "@@ -490,6 +490,11 @@ public boolean checkAdjacentVertexExist() {\n         return this.graphTransaction().checkAdjacentVertexExist();\n     }\n \n+    @Override\n+    public Edge edge(Object objects) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1472, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}