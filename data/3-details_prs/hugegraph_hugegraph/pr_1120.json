{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4Mzg2MTY2", "number": 1120, "title": "fix bug execute computer job", "bodyText": "Change-Id: I50c8830c3536c0a3f73004e7568902579a09025b", "createdAt": "2020-07-29T11:47:15Z", "url": "https://github.com/hugegraph/hugegraph/pull/1120", "merged": true, "mergeCommit": {"oid": "69f2e1516977b52433a6b921ecc2151474e298d2"}, "closed": true, "closedAt": "2020-07-30T11:05:05Z", "author": {"login": "zhoney"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5plKiAH2gAyNDU4Mzg2MTY2OjcxNWQ4Y2I5ZGQzYTY2OTY2OTQ0YmEwMWM3NmY4MjcxMjE4MjkyMzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc59jfCAFqTQ1ODI5ODk4NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "715d8cb9dd3a66966944ba01c76f827121829235", "author": {"user": {"login": "zhoney", "name": null}}, "url": "https://github.com/hugegraph/hugegraph/commit/715d8cb9dd3a66966944ba01c76f827121829235", "committedDate": "2020-07-29T11:46:28Z", "message": "fix bug execute computer job\n\nChange-Id: I50c8830c3536c0a3f73004e7568902579a09025b"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d67772c7d14d7c2a1a56ee4138ad00aa5182ade", "author": {"user": {"login": "zhoney", "name": null}}, "url": "https://github.com/hugegraph/hugegraph/commit/2d67772c7d14d7c2a1a56ee4138ad00aa5182ade", "committedDate": "2020-07-29T13:23:51Z", "message": "improve\n\nChange-Id: If1abac13df0e041e24289a2bec8f032a1ca42c70"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d291a42f27c47866ffa0a4385802f1b8b3e64110", "author": {"user": {"login": "zhoney", "name": null}}, "url": "https://github.com/hugegraph/hugegraph/commit/d291a42f27c47866ffa0a4385802f1b8b3e64110", "committedDate": "2020-07-29T13:30:43Z", "message": "improve\n\nChange-Id: I64123152b553523af3c50499050d7eb29762c3d9"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "878abee05f070ef09e30fb812a576c95579b5602", "author": {"user": {"login": "zhoney", "name": null}}, "url": "https://github.com/hugegraph/hugegraph/commit/878abee05f070ef09e30fb812a576c95579b5602", "committedDate": "2020-07-29T13:43:41Z", "message": "add computer home env\n\nChange-Id: I2fc5abbab34f188527e2daf277e3c9a69efe29a2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3NTYxOTM0", "url": "https://github.com/hugegraph/hugegraph/pull/1120#pullrequestreview-457561934", "createdAt": "2020-07-29T14:11:44Z", "commit": {"oid": "878abee05f070ef09e30fb812a576c95579b5602"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNDoxMTo0NFrOG46Xpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQxNDoxNDozMVrOG46gGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMyOTc2Ng==", "bodyText": "move to line 131", "url": "https://github.com/hugegraph/hugegraph/pull/1120#discussion_r462329766", "createdAt": "2020-07-29T14:11:44Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/job/computer/AbstractComputer.java", "diffHunk": "@@ -166,4 +202,11 @@ protected static double precision(Map<String, Object> parameters) {\n                         PRECISION, precision);\n         return precision;\n     }\n+\n+    private String executeDir() {\n+        Map<String, Object> envs = this.readEnvConfig();\n+        E.checkState(envs.containsKey(COMPUTER_HOME),\n+                     \"Expect '%s' in '%s' section\", COMPUTER_HOME, ENV);\n+        return (String) envs.get(COMPUTER_HOME);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "878abee05f070ef09e30fb812a576c95579b5602"}, "originalPosition": 150}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjMzMTkyOQ==", "bodyText": "move to line 50", "url": "https://github.com/hugegraph/hugegraph/pull/1120#discussion_r462331929", "createdAt": "2020-07-29T14:14:31Z", "author": {"login": "javeme"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/job/computer/AbstractComputer.java", "diffHunk": "@@ -19,32 +19,43 @@\n \n package com.baidu.hugegraph.job.computer;\n \n+import java.io.File;\n+import java.io.InputStreamReader;\n+import java.io.LineNumberReader;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n import java.util.HashMap;\n import java.util.List;\n import java.util.Map;\n \n import org.apache.commons.configuration.tree.ConfigurationNode;\n import org.apache.tinkerpop.gremlin.util.config.YamlConfiguration;\n+import org.slf4j.Logger;\n \n import com.baidu.hugegraph.HugeException;\n import com.baidu.hugegraph.job.ComputerJob;\n import com.baidu.hugegraph.job.Job;\n import com.baidu.hugegraph.util.E;\n+import com.baidu.hugegraph.util.Log;\n import com.baidu.hugegraph.util.ParameterUtil;\n \n public abstract class AbstractComputer implements Computer {\n \n-    private static final String COMMAND_PREFIX =\n-            \"cd $COMPUTER_HOME;\" +\n-            \"hadoop jar hugegraph-computer.jar com.baidu.hugegraph.Computer \" +\n-            \"-D libjars=./hugegraph-computer-core.jar\";\n+    private static final Logger LOG = Log.logger(Computer.class);\n \n+    private static final String HADOOP_HOME = \"HADOOP_HOME\";\n+    private static final String COMPUTER_HOME = \"computer_home\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "878abee05f070ef09e30fb812a576c95579b5602"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68ab7fa386f773a35c6c986b84ad850c757022aa", "author": {"user": {"login": "zhoney", "name": null}}, "url": "https://github.com/hugegraph/hugegraph/commit/68ab7fa386f773a35c6c986b84ad850c757022aa", "committedDate": "2020-07-30T02:41:50Z", "message": "improve\n\nChange-Id: Iddbcb765cd7a3bef44c7ff9a4a4c3066fc4244da"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4MjY2OTQ5", "url": "https://github.com/hugegraph/hugegraph/pull/1120#pullrequestreview-458266949", "createdAt": "2020-07-30T10:10:53Z", "commit": {"oid": "68ab7fa386f773a35c6c986b84ad850c757022aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4Mjk4OTg1", "url": "https://github.com/hugegraph/hugegraph/pull/1120#pullrequestreview-458298985", "createdAt": "2020-07-30T11:02:44Z", "commit": {"oid": "68ab7fa386f773a35c6c986b84ad850c757022aa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2247, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}