{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MTYyMTEw", "number": 1134, "title": "fix delete/read without READ permission throw 'no such id' ", "bodyText": "fix delete/read without READ permission throw 'no such id'\nthis patch define delete/update requires read permission, an ForbiddenException\nis thrown when there is no read permission instead 'No such vertex with id: xx'.\nfix rest api depend on gremlin permission, updated to not depend on gremlin.\nfix expired time is inaccurate due to call now() before tx open()\nrefactor edgesOfVertex() to unified entrance with EdgeStep\n\nChange-Id: I0d8cfd3d4b7d8ccaf10721249f8d9f86b53b442e\nfix: hugegraph-test-811, hugegraph-test-837, hugegraph-test-846", "createdAt": "2020-08-06T17:16:36Z", "url": "https://github.com/hugegraph/hugegraph/pull/1134", "merged": true, "mergeCommit": {"oid": "92617ca2eddebd9202fad77bdd32d2f791a33cfb"}, "closed": true, "closedAt": "2020-08-07T11:54:59Z", "author": {"login": "javeme"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8TB2GgH2gAyNDY0MTYyMTEwOmY5Y2ZkMGNhNmFjYjRlZTUzMDg3ODE1Nzc0YTcyNzYxZWU0NGFmYzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8eygBgFqTQ2MzA3NTE3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f9cfd0ca6acb4ee53087815774a72761ee44afc6", "author": {"user": {"login": "javeme", "name": "Jermy Li"}}, "url": "https://github.com/hugegraph/hugegraph/commit/f9cfd0ca6acb4ee53087815774a72761ee44afc6", "committedDate": "2020-08-06T17:11:45Z", "message": "fix delete/read without READ permission throw 'no such id'\n\nthis patch define delete/update requires read permission, an ForbiddenException\nis thrown when there is no read permission instead 'No such vertex with id: xx'.\n\nalso fix rest api depend on gremlin permission, updated to not depend on gremlin.\n\nChange-Id: I0d8cfd3d4b7d8ccaf10721249f8d9f86b53b442e"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "502cb7b10b816552b1aa4a63e16a3160c8eedd59", "author": {"user": {"login": "javeme", "name": "Jermy Li"}}, "url": "https://github.com/hugegraph/hugegraph/commit/502cb7b10b816552b1aa4a63e16a3160c8eedd59", "committedDate": "2020-08-06T17:11:45Z", "message": "unify exception message\n\nChange-Id: Ia30ff97b073bd2b15599cc4e1cbac5ed7b651063"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a04c020adcef48847d3b9470f807027ac63300f", "author": {"user": {"login": "javeme", "name": "Jermy Li"}}, "url": "https://github.com/hugegraph/hugegraph/commit/2a04c020adcef48847d3b9470f807027ac63300f", "committedDate": "2020-08-06T17:11:45Z", "message": "fix unit test\n\nChange-Id: I1adf25c68bd0eb2157b17fd9466171ec9e237de7"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a3edcdc2784fd453d305d49dc6a4012f1dcf716", "author": {"user": {"login": "javeme", "name": "Jermy Li"}}, "url": "https://github.com/hugegraph/hugegraph/commit/6a3edcdc2784fd453d305d49dc6a4012f1dcf716", "committedDate": "2020-08-06T17:11:46Z", "message": "fix expired time is inaccurate due to call now before tx begin\n\nChange-Id: I08f536b75228c44a1af1c588336df9a1ceea8406"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc", "author": {"user": {"login": "javeme", "name": "Jermy Li"}}, "url": "https://github.com/hugegraph/hugegraph/commit/591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc", "committedDate": "2020-08-06T17:11:46Z", "message": "refactor edgesOfVertex() to unified entrance with EdgeStep\n\nChange-Id: If55f532fb2c08b664e3ea816832741096fb767c4"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMDE1OTUz", "url": "https://github.com/hugegraph/hugegraph/pull/1134#pullrequestreview-463015953", "createdAt": "2020-08-07T03:46:54Z", "commit": {"oid": "591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMzo0Njo1NVrOG9LgLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wN1QwMzo0ODoxN1rOG9LhYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjgwNDc4Mw==", "bodyText": "olap task may run not in grizzly-http-server thread", "url": "https://github.com/hugegraph/hugegraph/pull/1134#discussion_r466804783", "createdAt": "2020-08-07T03:46:55Z", "author": {"login": "zhoney"}, "path": "hugegraph-api/src/main/java/com/baidu/hugegraph/auth/HugeGraphAuthProxy.java", "diffHunk": "@@ -1372,8 +1389,21 @@ public void applyStrategies(Admin<?, ?> traversal) {\n                 script = translator.translate(traversal.getBytecode());\n             }\n \n-            verifyNamePermission(HugePermission.EXECUTE,\n-                                 ResourceType.GREMLIN, script);\n+            /*\n+             * Verify gremlin-execute permission for user gremlin(in gremlin-\n+             * server-exec worker) and gremlin job(in task worker).\n+             * But don't check permission in rest worker, because the following\n+             * places need to call traversal():\n+             *  1.vertices/edges rest api\n+             *  2.oltp rest api (like crosspointpath/neighborrank)\n+             *  3.olap rest api (like centrality/lpa/louvain/subgraph)\n+             */\n+            String caller = Thread.currentThread().getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjgwNTA1Mg==", "bodyText": "object", "url": "https://github.com/hugegraph/hugegraph/pull/1134#discussion_r466805052", "createdAt": "2020-08-07T03:48:07Z", "author": {"login": "zhoney"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/StandardHugeGraph.java", "diffHunk": "@@ -467,6 +462,11 @@ public void removeEdge(Edge edge) {\n         this.graphTransaction().removeEdgeProperty((HugeEdgeProperty<V>) p);\n     }\n \n+    @Override\n+    public Vertex vertex(Object objects) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjgwNTA5MA==", "bodyText": "ditto", "url": "https://github.com/hugegraph/hugegraph/pull/1134#discussion_r466805090", "createdAt": "2020-08-07T03:48:17Z", "author": {"login": "zhoney"}, "path": "hugegraph-core/src/main/java/com/baidu/hugegraph/StandardHugeGraph.java", "diffHunk": "@@ -490,6 +490,11 @@ public boolean checkAdjacentVertexExist() {\n         return this.graphTransaction().checkAdjacentVertexExist();\n     }\n \n+    @Override\n+    public Edge edge(Object objects) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "591e22f6f1dbb3fa0f703efe5c4e210e0549f7cc"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c9872cb3b0e1f9af614f4a155673b65d8237f0b", "author": {"user": {"login": "javeme", "name": "Jermy Li"}}, "url": "https://github.com/hugegraph/hugegraph/commit/8c9872cb3b0e1f9af614f4a155673b65d8237f0b", "committedDate": "2020-08-07T06:00:57Z", "message": "fix test sameAs() mock\n\nChange-Id: I303482a631e25834f7e56d2d44248f9097eec778"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMDY5ODg0", "url": "https://github.com/hugegraph/hugegraph/pull/1134#pullrequestreview-463069884", "createdAt": "2020-08-07T06:42:17Z", "commit": {"oid": "8c9872cb3b0e1f9af614f4a155673b65d8237f0b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMDc0NzAz", "url": "https://github.com/hugegraph/hugegraph/pull/1134#pullrequestreview-463074703", "createdAt": "2020-08-07T06:52:56Z", "commit": {"oid": "8c9872cb3b0e1f9af614f4a155673b65d8237f0b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzMDc1MTcx", "url": "https://github.com/hugegraph/hugegraph/pull/1134#pullrequestreview-463075171", "createdAt": "2020-08-07T06:53:52Z", "commit": {"oid": "8c9872cb3b0e1f9af614f4a155673b65d8237f0b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2254, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}