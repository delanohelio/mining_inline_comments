{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczNzg3Mjcw", "number": 1505, "title": "Optimize Tablet volume replacement", "bodyText": "Stop Tablet constructor from checking every file for volume\nreplacements when feature not used", "createdAt": "2020-02-11T17:28:20Z", "url": "https://github.com/apache/accumulo/pull/1505", "merged": true, "mergeCommit": {"oid": "7513626cc504e5d93760c4218868dcb2dd6d49a5"}, "closed": true, "closedAt": "2020-02-12T13:28:03Z", "author": {"login": "milleruntime"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDVGYhAH2gAyMzczNzg3MjcwOjI5YmRiNzAyNGEyY2E0OGE0MzgyOGIyNmUyZTBjNWUyOGVmMjFjNGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcDZHDRgFqTM1NzAzMDExMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "29bdb7024a2ca48a43828b26e2e0c5e28ef21c4e", "author": {"user": {"login": "milleruntime", "name": "Mike Miller"}}, "url": "https://github.com/apache/accumulo/commit/29bdb7024a2ca48a43828b26e2e0c5e28ef21c4e", "committedDate": "2020-02-11T17:22:50Z", "message": "Optimize Tablet volume replacement\n\n* Stop Tablet constructor from checking every file for volume\nreplacements when feature not used"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2ODczODUz", "url": "https://github.com/apache/accumulo/pull/1505#pullrequestreview-356873853", "createdAt": "2020-02-11T18:01:48Z", "commit": {"oid": "29bdb7024a2ca48a43828b26e2e0c5e28ef21c4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxODowMTo0OFrOFoTSng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxODowMTo0OFrOFoTSng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgwMzQyMg==", "bodyText": "Would it make more sense to keep the replacements assignment in this method, but short-circuit the method with a if (replacements.isEmpty()) { return; } line?\nIt seems like this is a smaller change and would keep the logic all together that handles the updates, rather than place the special case of no replacements outside the method.", "url": "https://github.com/apache/accumulo/pull/1505#discussion_r377803422", "createdAt": "2020-02-11T18:01:48Z", "author": {"login": "ctubbsii"}, "path": "server/base/src/main/java/org/apache/accumulo/server/fs/VolumeUtil.java", "diffHunk": "@@ -184,9 +184,8 @@ public static String switchRootTableVolume(String location) throws IOException {\n    * for use it chooses a new tablet directory.\n    */\n   public static TabletFiles updateTabletVolumes(AccumuloServerContext context, ZooLock zooLock,\n-      VolumeManager vm, KeyExtent extent, TabletFiles tabletFiles, boolean replicate)\n-      throws IOException {\n-    List<Pair<Path,Path>> replacements = ServerConstants.getVolumeReplacements();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29bdb7024a2ca48a43828b26e2e0c5e28ef21c4e"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2OTA5MzA4", "url": "https://github.com/apache/accumulo/pull/1505#pullrequestreview-356909308", "createdAt": "2020-02-11T18:55:12Z", "commit": {"oid": "29bdb7024a2ca48a43828b26e2e0c5e28ef21c4e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxODo1NToxMlrOFoVBhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMVQxODo1NToxMlrOFoVBhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzgzMTgxMg==", "bodyText": "Should the log statement be using parameter substitution?\nlog.trace(\"Using volume replacements: {}\" + replacements);", "url": "https://github.com/apache/accumulo/pull/1505#discussion_r377831812", "createdAt": "2020-02-11T18:55:12Z", "author": {"login": "EdColeman"}, "path": "server/base/src/main/java/org/apache/accumulo/server/fs/VolumeUtil.java", "diffHunk": "@@ -184,9 +184,8 @@ public static String switchRootTableVolume(String location) throws IOException {\n    * for use it chooses a new tablet directory.\n    */\n   public static TabletFiles updateTabletVolumes(AccumuloServerContext context, ZooLock zooLock,\n-      VolumeManager vm, KeyExtent extent, TabletFiles tabletFiles, boolean replicate)\n-      throws IOException {\n-    List<Pair<Path,Path>> replacements = ServerConstants.getVolumeReplacements();\n+      VolumeManager vm, KeyExtent extent, TabletFiles tabletFiles, boolean replicate,\n+      List<Pair<Path,Path>> replacements) throws IOException {\n     log.trace(\"Using volume replacements: \" + replacements);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "29bdb7024a2ca48a43828b26e2e0c5e28ef21c4e"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ddd792f022b665cdee83fded2fc2b3dec146b673", "author": {"user": {"login": "milleruntime", "name": "Mike Miller"}}, "url": "https://github.com/apache/accumulo/commit/ddd792f022b665cdee83fded2fc2b3dec146b673", "committedDate": "2020-02-11T18:58:34Z", "message": "PR updates"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU2OTE2ODk5", "url": "https://github.com/apache/accumulo/pull/1505#pullrequestreview-356916899", "createdAt": "2020-02-11T19:06:10Z", "commit": {"oid": "ddd792f022b665cdee83fded2fc2b3dec146b673"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU3MDMwMTEw", "url": "https://github.com/apache/accumulo/pull/1505#pullrequestreview-357030110", "createdAt": "2020-02-11T22:03:11Z", "commit": {"oid": "ddd792f022b665cdee83fded2fc2b3dec146b673"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1837, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}