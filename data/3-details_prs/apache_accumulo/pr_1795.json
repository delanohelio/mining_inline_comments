{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0MTM5MDEz", "number": 1795, "title": "Read/Write config files consistently", "bodyText": "Use UTF-8 for all FileReaders and FileWriters\nUse an InputStreamReader instead of a FileReader for reading class\npath resources identified with a URL rather than a file name\nThis fixes a failure in some ITs, including VolumeIT, which reads a\nclass path resource, rather than a file\nEnsure PropertiesConfigurations use read() and write() instead of\nless convenient getlayout() methods to load/save", "createdAt": "2020-11-19T18:09:07Z", "url": "https://github.com/apache/accumulo/pull/1795", "merged": true, "mergeCommit": {"oid": "42395a00cd1f442008734ca1d770260666422778"}, "closed": true, "closedAt": "2020-11-19T22:09:29Z", "author": {"login": "ctubbsii"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdeGthdgH2gAyNTI0MTM5MDEzOmUzMTY1MTgxYzVlYjM4Mjc4MzRjY2FkOTE0MmQzN2U3NzY1MmYxOWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdeJ3RkgH2gAyNTI0MTM5MDEzOmM5NGM5Nzk0YjJiY2YzZTE3MGI3YTdhODY1ZTI3OWQ0NTU3ZTBmYjA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e3165181c5eb3827834ccad9142d37e77652f19d", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/e3165181c5eb3827834ccad9142d37e77652f19d", "committedDate": "2020-11-19T18:04:07Z", "message": "Read/Write config files consistently\n\n* Use UTF-8 for all FileReaders and FileWriters\n* Use an InputStreamReader instead of a FileReader for reading class\n  path resources identified with a URL rather than a file name\n* This fixes a failure in some ITs, including VolumeIT, which reads a\n  class path resource, rather than a file\n* Ensure PropertiesConfigurations use read() and write() instead of\n  less convenient getlayout() methods to load/save"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NzI4MTA4", "url": "https://github.com/apache/accumulo/pull/1795#pullrequestreview-534728108", "createdAt": "2020-11-19T18:22:00Z", "commit": {"oid": "e3165181c5eb3827834ccad9142d37e77652f19d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM0NzUzNjky", "url": "https://github.com/apache/accumulo/pull/1795#pullrequestreview-534753692", "createdAt": "2020-11-19T18:54:36Z", "commit": {"oid": "e3165181c5eb3827834ccad9142d37e77652f19d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxODo1NDozNlrOH2tBGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOVQxODo1NTo0OVrOH2tEDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzEyMjcxNQ==", "bodyText": "It's odd that this constructor throws a more general exception, I would think it would have been the other way around.", "url": "https://github.com/apache/accumulo/pull/1795#discussion_r527122715", "createdAt": "2020-11-19T18:54:36Z", "author": {"login": "milleruntime"}, "path": "minicluster/src/main/java/org/apache/accumulo/cluster/RemoteShellOptions.java", "diffHunk": "@@ -69,8 +70,8 @@ public RemoteShellOptions() {\n       if (f.exists() && f.isFile() && f.canRead()) {\n         FileReader reader = null;\n         try {\n-          reader = new FileReader(f);\n-        } catch (FileNotFoundException e) {\n+          reader = new FileReader(f, UTF_8);\n+        } catch (IOException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3165181c5eb3827834ccad9142d37e77652f19d"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzEyMzQ3MQ==", "bodyText": "Looks like this changed got dinged by Sec bugs.  Should triage this before committing.", "url": "https://github.com/apache/accumulo/pull/1795#discussion_r527123471", "createdAt": "2020-11-19T18:55:49Z", "author": {"login": "milleruntime"}, "path": "start/src/main/java/org/apache/accumulo/start/classloader/AccumuloClassLoader.java", "diffHunk": "@@ -87,7 +89,7 @@ public static String getAccumuloProperty(String propertyName, String defaultValu\n     }\n     try {\n       var config = new PropertiesConfiguration();\n-      try (var reader = new FileReader(accumuloConfigUrl.getFile())) {\n+      try (var reader = new InputStreamReader(accumuloConfigUrl.openStream(), UTF_8)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3165181c5eb3827834ccad9142d37e77652f19d"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c94c9794b2bcf3e170b7a7a865e279d4557e0fb0", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/c94c9794b2bcf3e170b7a7a865e279d4557e0fb0", "committedDate": "2020-11-19T21:44:29Z", "message": "Fix VolumeIT and sec-bugs\n\n* Fix VolumeIT\n* Fix spotbugs -P sec-bugs\n* Reorder PropertiesConfiguration Reader/Writer pattern so body of\n  try-with-resources is as small as possible (only when actually\n  reading/writing the file)\n* Make MetricsFileTailer use URL.openStream() rather than try to convert\n  to a File"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1807, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}