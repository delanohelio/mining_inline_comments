{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2NjM5NDgx", "number": 1518, "title": "Fix #1430 Enforce table name limit for new tables", "bodyText": "Created new validator method for CREATE_TABLE w/ Exception\nAdded log warning re: name length to CLONE and RENAME\nCreated test under TableOperationsIT (createTableWithTableNameLengthLimit)\nImplemented client fast-failure under TableOperationsImpl via new checkArg statement", "createdAt": "2020-02-18T14:12:01Z", "url": "https://github.com/apache/accumulo/pull/1518", "merged": true, "mergeCommit": {"oid": "88fa927a789f73ca063f63c95883273da60eddd4"}, "closed": true, "closedAt": "2020-03-17T06:15:58Z", "author": {"login": "cradal"}, "timelineItems": {"totalCount": 51, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcDV23DgH2gAyMzc2NjM5NDgxOjQxMGRhYjU0OTc0M2Q0ZTU1ZDJlNzg2ODI2NTczZWIxMmZjM2U1MDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOcadiAFqTM3NTc2MDMzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "410dab549743d4e55d2e786826573eb12fc3e500", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/410dab549743d4e55d2e786826573eb12fc3e500", "committedDate": "2020-02-11T18:15:47Z", "message": "Master - Changed text in Monitor template to test that build was working"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d2ba479b58ee0a6894ccf3fd870eecda35036f9", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/0d2ba479b58ee0a6894ccf3fd870eecda35036f9", "committedDate": "2020-02-11T18:26:55Z", "message": "Revert \"Master - Changed text in Monitor template to test that build was working\"\n\nThis reverts commit 410dab549743d4e55d2e786826573eb12fc3e500."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c481e3a2f210e29b2aba44b2f7f94f572beef6f", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/3c481e3a2f210e29b2aba44b2f7f94f572beef6f", "committedDate": "2020-02-11T18:49:07Z", "message": "Master - Changed Monitor template slightly to test build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94b7adf17f3a85ee4de6c15be816474313325808", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/94b7adf17f3a85ee4de6c15be816474313325808", "committedDate": "2020-02-11T19:00:00Z", "message": "Revert \"Master - Changed Monitor template slightly to test build\"\n\nThis reverts commit 3c481e3a2f210e29b2aba44b2f7f94f572beef6f."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46be7b4a1999d91179c18bf6b3f253be62c1159b", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/46be7b4a1999d91179c18bf6b3f253be62c1159b", "committedDate": "2020-02-11T20:13:33Z", "message": "Fixes #1430 - Added log for InitalTableState under TABLE_CREATE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e527d5cbd7a668577c5420dae160cecbe07da6df", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/e527d5cbd7a668577c5420dae160cecbe07da6df", "committedDate": "2020-02-13T15:34:32Z", "message": "Fixes #1430 - Updated validateTableNameArgument method in FateServiceHandler class. New method throws exception for table names > 1024 chars."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73768f5b7111da364d1ab76e5d88421b28c32c11", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/73768f5b7111da364d1ab76e5d88421b28c32c11", "committedDate": "2020-02-13T16:13:03Z", "message": "Fixes #1430 - Added log warning to validateTableNameArgument about 1024 char limit. validateTableNameArgument is called for TABLE_RENAME and TABLE_CLONE. validateNewTableNameArgument is called for TABLE_CREATE"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb6fb8541f2218acfd0a52f5c5e9d23662d865d3", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/cb6fb8541f2218acfd0a52f5c5e9d23662d865d3", "committedDate": "2020-02-13T16:45:54Z", "message": "Fixes #1430 - In TableOperationsImpl, create(tableName, NewTableCOnfig), added checkArgument for length > 1024."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3967ccb0fb9b1a2121d147703a3cef522efd27ca", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/3967ccb0fb9b1a2121d147703a3cef522efd27ca", "committedDate": "2020-02-13T18:06:17Z", "message": "Fixes #1430 - Added new checkArgument under TableOperationsImpl->create(table name, tableconfig). This is to implement fast-failure on the client  side for table names > 1024 chars."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1035b0deb0f69f839c6dc56378d85106742e8662", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/1035b0deb0f69f839c6dc56378d85106742e8662", "committedDate": "2020-02-18T12:33:04Z", "message": "Fixes #1430 - Created test for new table name limit 'createTableWithTableNameLengthLimit' in TableOperationsIT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "22216e92ec54655f6e33ba298a9afe12a75c9b19", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/22216e92ec54655f6e33ba298a9afe12a75c9b19", "committedDate": "2020-02-18T13:12:28Z", "message": "Fixes #1430 - Fixed possible null pointer in validateTableName methods in FateServiceHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNDA1MjAx", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-360405201", "createdAt": "2020-02-18T14:56:53Z", "commit": {"oid": "22216e92ec54655f6e33ba298a9afe12a75c9b19"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNDo1Njo1M1rOFrFiRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxNTowMToxNlrOFrFt8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDcyMzc4MA==", "bodyText": "Would be nice to place the table length in a constant and use that constant everywhere.  Could put he constant in ./core/src/main/java/org/apache/accumulo/core/Constants.java.  Maybe name it MAX_TABLE_NAME_LEN.", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r380723780", "createdAt": "2020-02-18T14:56:53Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java", "diffHunk": "@@ -216,6 +216,7 @@ public void create(String tableName, NewTableConfiguration ntc)\n       throws AccumuloException, AccumuloSecurityException, TableExistsException {\n     checkArgument(tableName != null, \"tableName is null\");\n     checkArgument(ntc != null, \"ntc is null\");\n+    checkArgument(tableName.length() < 1025, \"tableName is longer than 1024 characters\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22216e92ec54655f6e33ba298a9afe12a75c9b19"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDcyNTM3NQ==", "bodyText": "If there were constant, then 1026 could be replaced with the constant + 2.", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r380725375", "createdAt": "2020-02-18T14:59:15Z", "author": {"login": "keith-turner"}, "path": "test/src/main/java/org/apache/accumulo/test/TableOperationsIT.java", "diffHunk": "@@ -189,6 +189,18 @@ public void createTable() throws TableExistsException, AccumuloException,\n     accumuloClient.tableOperations().delete(tableName);\n   }\n \n+  @Test\n+  public void createTableWithTableNameLengthLimit()\n+      throws AccumuloException, AccumuloSecurityException, TableExistsException {\n+    StringBuilder tableNameBuilder = new StringBuilder();\n+    for (int i = 0; i < 1026; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22216e92ec54655f6e33ba298a9afe12a75c9b19"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDcyNTgyMw==", "bodyText": "Does this throw an exception?", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r380725823", "createdAt": "2020-02-18T14:59:55Z", "author": {"login": "keith-turner"}, "path": "test/src/main/java/org/apache/accumulo/test/TableOperationsIT.java", "diffHunk": "@@ -189,6 +189,18 @@ public void createTable() throws TableExistsException, AccumuloException,\n     accumuloClient.tableOperations().delete(tableName);\n   }\n \n+  @Test\n+  public void createTableWithTableNameLengthLimit()\n+      throws AccumuloException, AccumuloSecurityException, TableExistsException {\n+    StringBuilder tableNameBuilder = new StringBuilder();\n+    for (int i = 0; i < 1026; i++) {\n+      tableNameBuilder.append('a');\n+    }\n+    String tableName = tableNameBuilder.toString();\n+    accumuloClient.tableOperations().create(tableName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22216e92ec54655f6e33ba298a9afe12a75c9b19"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDcyNjc3MA==", "bodyText": "Was this added for debugging?", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r380726770", "createdAt": "2020-02-18T15:01:16Z", "author": {"login": "keith-turner"}, "path": "server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java", "diffHunk": "@@ -162,10 +162,11 @@ public void executeFateOperation(TInfo tinfo, TCredentials c, long opid, FateOpe\n               TableOperationExceptionType.OTHER,\n               \"Expected at least \" + SPLIT_OFFSET + \" arguments, saw :\" + arguments.size());\n         }\n-        String tableName = validateTableNameArgument(arguments.get(0), tableOp, NOT_SYSTEM);\n+        String tableName = validateNewTableNameArgument(arguments.get(0), tableOp, NOT_SYSTEM);\n         TimeType timeType = TimeType.valueOf(ByteBufferUtil.toString(arguments.get(1)));\n         InitialTableState initialTableState =\n             InitialTableState.valueOf(ByteBufferUtil.toString(arguments.get(2)));\n+        log.info(\"Init Table State: \" + ByteBufferUtil.toString(arguments.get(2)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22216e92ec54655f6e33ba298a9afe12a75c9b19"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1397436eab508117572c384fecf0f2f3bb520bc8", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/1397436eab508117572c384fecf0f2f3bb520bc8", "committedDate": "2020-02-18T15:23:13Z", "message": "Fixes #1430 - Removed log of IntialTableState, no longer needed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a91b0842a8eaf2c0e724083a471b3b43831eebea", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/a91b0842a8eaf2c0e724083a471b3b43831eebea", "committedDate": "2020-02-18T15:44:27Z", "message": "Fixes #1430 - Created CONSTANT fro max table length"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c3245a1cc038ba2dcb3fdae9e26a086169e4e6e", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/8c3245a1cc038ba2dcb3fdae9e26a086169e4e6e", "committedDate": "2020-02-18T19:14:35Z", "message": "Fixes #1430 - Corrected createTableWithTableNameLengthLimit test to expect IllegalArgumentException"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNjczNTE1", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-360673515", "createdAt": "2020-02-18T21:08:28Z", "commit": {"oid": "8c3245a1cc038ba2dcb3fdae9e26a086169e4e6e"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQyMTowODoyOVrOFrSdXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQyMTowODo1MlrOFrSeNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkzNTUxNw==", "bodyText": "Could use constant in this message", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r380935517", "createdAt": "2020-02-18T21:08:29Z", "author": {"login": "keith-turner"}, "path": "server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java", "diffHunk": "@@ -701,6 +702,24 @@ private TableId validateTableIdArgument(ByteBuffer tableIdArg, TableOperation op\n   private String validateTableNameArgument(ByteBuffer tableNameArg, TableOperation op,\n       Validator<String> userValidator) throws ThriftTableOperationException {\n     String tableName = tableNameArg == null ? null : ByteBufferUtil.toString(tableNameArg);\n+    if ((tableName != null) && (tableName.length() > MAX_TABLE_NAME_LEN)) {\n+      log.warn(\n+          \"Table names greater than 1024 characters should be renamed to conform to a 1024 character limit. \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c3245a1cc038ba2dcb3fdae9e26a086169e4e6e"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDkzNTczNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                checkArgument(tableName.length() < MAX_TABLE_NAME_LEN + 1, \"tableName is longer than 1024 characters\");\n          \n          \n            \n                checkArgument(tableName.length() <= MAX_TABLE_NAME_LEN, \"tableName is longer than %s characters\", MAX_TABLE_NAME_LEN);", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r380935734", "createdAt": "2020-02-18T21:08:52Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java", "diffHunk": "@@ -216,6 +217,7 @@ public void create(String tableName, NewTableConfiguration ntc)\n       throws AccumuloException, AccumuloSecurityException, TableExistsException {\n     checkArgument(tableName != null, \"tableName is null\");\n     checkArgument(ntc != null, \"ntc is null\");\n+    checkArgument(tableName.length() < MAX_TABLE_NAME_LEN + 1, \"tableName is longer than 1024 characters\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8c3245a1cc038ba2dcb3fdae9e26a086169e4e6e"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNzQyOTcw", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-360742970", "createdAt": "2020-02-18T23:15:51Z", "commit": {"oid": "8c3245a1cc038ba2dcb3fdae9e26a086169e4e6e"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec52800fa77f750e2d96ec1709cbffd52a01860e", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/ec52800fa77f750e2d96ec1709cbffd52a01860e", "committedDate": "2020-02-19T12:57:49Z", "message": "Fixes #1430 - Added new validator to TABLE_CLONE, TABLE_IMPORT, TABLE_BULK_IMPORT, and TABLE_RENAME. FOr RENAME, previous names are validated with original validator"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9971610f4b68e32b8489aa397292b5cb7ff0a22f", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/9971610f4b68e32b8489aa397292b5cb7ff0a22f", "committedDate": "2020-02-19T13:55:41Z", "message": "Fixes #1430 - Implemented client fast-falure for CLONE, RENAME, and IMPORT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea98ca41d8ae35d89b92269afb5d0d6938dcd60c", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/ea98ca41d8ae35d89b92269afb5d0d6938dcd60c", "committedDate": "2020-02-19T14:24:11Z", "message": "Fixes #1430 - Implemented 1024 char limit for namespace CREATE and RENAME. Implemented client fast-failure for same."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aab64029eed4eb8965c93971f05bce1c1391c0bc", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/aab64029eed4eb8965c93971f05bce1c1391c0bc", "committedDate": "2020-02-19T15:31:05Z", "message": "Fixes #1430 - Created test under NamespacesIT->createNamespaceWithNamespaceLengthLimit"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/58535cf287106e14209fbf2597fcf92e89c9fca6", "committedDate": "2020-02-20T13:35:26Z", "message": "Fixes #1430 - Attempt recommit of clone, import, and rename validator for tables and namespaces, fast-fail for the same, and updated NamespaceIT"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0ODkxMTIy", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-364891122", "createdAt": "2020-02-26T13:22:19Z", "commit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "state": "COMMENTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzoyMjoyMFrOFurPpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzoyODozM1rOFurcww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4NzMzMg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"Namespace is longer than 1024 characters\");\n          \n          \n            \n                    \"Namespace is longer than \"+MAX_NAMESPACE_LEN+\" characters\");", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r384487332", "createdAt": "2020-02-26T13:22:20Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/NamespaceOperationsImpl.java", "diffHunk": "@@ -119,7 +121,8 @@ public boolean exists(String namespace) {\n   public void create(String namespace)\n       throws AccumuloException, AccumuloSecurityException, NamespaceExistsException {\n     checkArgument(namespace != null, \"namespace is null\");\n-\n+    checkArgument(namespace.length() <= MAX_NAMESPACE_LEN,\n+        \"Namespace is longer than 1024 characters\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4NzU4Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"Namespace is longer than 1024 characters\");\n          \n          \n            \n                    \"Namespace is longer than \"+MAX_NAMESPACE_LEN+\" characters\");", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r384487582", "createdAt": "2020-02-26T13:22:49Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/NamespaceOperationsImpl.java", "diffHunk": "@@ -163,7 +166,11 @@ public void delete(String namespace) throws AccumuloException, AccumuloSecurityE\n   public void rename(String oldNamespaceName, String newNamespaceName)\n       throws AccumuloSecurityException, NamespaceNotFoundException, AccumuloException,\n       NamespaceExistsException {\n-\n+    checkArgument(oldNamespaceName.length() <= MAX_NAMESPACE_LEN,\n+        \"Namespaces longer than 1024 characters\"\n+            + \"are no longer supported and may result in unexpected behavior\");\n+    checkArgument(newNamespaceName.length() <= MAX_TABLE_NAME_LEN,\n+        \"Namespace is longer than 1024 characters\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4NzcxNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"Table name is longer than 1024 characters\");\n          \n          \n            \n                    \"Table name is longer than \"+ MAX_TABLE_NAME_LEN +\" characters\");", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r384487714", "createdAt": "2020-02-26T13:23:07Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java", "diffHunk": "@@ -217,7 +217,8 @@ public void create(String tableName, NewTableConfiguration ntc)\n       throws AccumuloException, AccumuloSecurityException, TableExistsException {\n     checkArgument(tableName != null, \"tableName is null\");\n     checkArgument(ntc != null, \"ntc is null\");\n-    checkArgument(tableName.length() < MAX_TABLE_NAME_LEN + 1, \"tableName is longer than 1024 characters\");\n+    checkArgument(tableName.length() <= MAX_TABLE_NAME_LEN,\n+        \"Table name is longer than 1024 characters\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4Nzg5NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"Table name is longer than 1024 characters\");\n          \n          \n            \n                    \"Table name is longer than \"+ MAX_TABLE_NAME_LEN +\" characters\");", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r384487894", "createdAt": "2020-02-26T13:23:26Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java", "diffHunk": "@@ -753,6 +754,8 @@ public void clone(String srcTableName, String newTableName, CloneConfiguration c\n \n     checkArgument(srcTableName != null, \"srcTableName is null\");\n     checkArgument(newTableName != null, \"newTableName is null\");\n+    checkArgument(newTableName.length() <= MAX_TABLE_NAME_LEN,\n+        \"Table name is longer than 1024 characters\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4ODA0NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"Table name is longer than 1024 characters\");\n          \n          \n            \n                    \"Table name is longer than \"+ MAX_TABLE_NAME_LEN +\" characters\");", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r384488045", "createdAt": "2020-02-26T13:23:42Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java", "diffHunk": "@@ -788,7 +791,11 @@ public void clone(String srcTableName, String newTableName, CloneConfiguration c\n   @Override\n   public void rename(String oldTableName, String newTableName) throws AccumuloSecurityException,\n       TableNotFoundException, AccumuloException, TableExistsException {\n-\n+    checkArgument(oldTableName.length() <= MAX_TABLE_NAME_LEN,\n+        \"Table names longer than 1024 characters\"\n+            + \"are no longer supported and may result in unexpected behavior\");\n+    checkArgument(newTableName.length() <= MAX_TABLE_NAME_LEN,\n+        \"Table name is longer than 1024 characters\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4ODEzOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    \"Table name is longer than 1024 characters\");\n          \n          \n            \n                    \"Table name is longer than \"+ MAX_TABLE_NAME_LEN +\" characters\");", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r384488138", "createdAt": "2020-02-26T13:23:51Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java", "diffHunk": "@@ -1499,6 +1506,8 @@ public void importTable(String tableName, String importDir)\n       throws TableExistsException, AccumuloException, AccumuloSecurityException {\n     checkArgument(tableName != null, \"tableName is null\");\n     checkArgument(importDir != null, \"importDir is null\");\n+    checkArgument(tableName.length() <= MAX_TABLE_NAME_LEN,\n+        \"Table name is longer than 1024 characters\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4OTQ2MQ==", "bodyText": "Why does the old namespace need to be less than the len?  If the old namespace was created in an older version of Accumulo then it could be over the limit.", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r384489461", "createdAt": "2020-02-26T13:26:24Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/NamespaceOperationsImpl.java", "diffHunk": "@@ -163,7 +166,11 @@ public void delete(String namespace) throws AccumuloException, AccumuloSecurityE\n   public void rename(String oldNamespaceName, String newNamespaceName)\n       throws AccumuloSecurityException, NamespaceNotFoundException, AccumuloException,\n       NamespaceExistsException {\n-\n+    checkArgument(oldNamespaceName.length() <= MAX_NAMESPACE_LEN,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ4OTk2Mw==", "bodyText": "Why does the old table need to be below limit?", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r384489963", "createdAt": "2020-02-26T13:27:21Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java", "diffHunk": "@@ -788,7 +791,11 @@ public void clone(String srcTableName, String newTableName, CloneConfiguration c\n   @Override\n   public void rename(String oldTableName, String newTableName) throws AccumuloSecurityException,\n       TableNotFoundException, AccumuloException, TableExistsException {\n-\n+    checkArgument(oldTableName.length() <= MAX_TABLE_NAME_LEN,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ5MDY5MQ==", "bodyText": "This operation is not creating a new table, so it should not do this check.", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r384490691", "createdAt": "2020-02-26T13:28:33Z", "author": {"login": "keith-turner"}, "path": "server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java", "diffHunk": "@@ -434,7 +435,7 @@ public String invalidMessage(String argument) {\n       case TABLE_BULK_IMPORT: {\n         TableOperation tableOp = TableOperation.BULK_IMPORT;\n         validateArgumentCount(arguments, tableOp, 4);\n-        String tableName = validateTableNameArgument(arguments.get(0), tableOp, NOT_SYSTEM);\n+        String tableName = validateNewTableNameArgument(arguments.get(0), tableOp, NOT_SYSTEM);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58535cf287106e14209fbf2597fcf92e89c9fca6"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29af44bc3442ea7a0b0f56f38f6928033d458967", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/29af44bc3442ea7a0b0f56f38f6928033d458967", "committedDate": "2020-02-26T16:10:04Z", "message": "Fixes #1430 - Removed checkArgument for old table names and namespaces from client impl. Removed new validator from BULK_IMPORT."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fd3fa2bc5b1e75642ace244e6956ef6b65071ab", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/3fd3fa2bc5b1e75642ace244e6956ef6b65071ab", "committedDate": "2020-02-26T16:23:41Z", "message": "Fixes #1430 - Added warning log about old namespace and table name length to client impl"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76ad03a083b5802946490c6826581c96ee3a55f5", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/76ad03a083b5802946490c6826581c96ee3a55f5", "committedDate": "2020-02-26T16:39:04Z", "message": "Revert \"Fixes #1430 - Added warning log about old namespace and table name length to client impl\"\n\nThis reverts commit 3fd3fa2bc5b1e75642ace244e6956ef6b65071ab."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTQyMjAx", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-365942201", "createdAt": "2020-02-27T19:36:06Z", "commit": {"oid": "76ad03a083b5802946490c6826581c96ee3a55f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOTozNjowNlrOFvei7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOTozNjowNlrOFvei7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMyNzg1Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      + \" characters should be renamed to conform to a 1024 character limit. \"\n          \n          \n            \n                      + \" characters should be renamed to conform to a \"+MAX_TABLE_NAME_LEN+\" character limit. \"", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r385327853", "createdAt": "2020-02-27T19:36:06Z", "author": {"login": "lbschanno"}, "path": "server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java", "diffHunk": "@@ -697,10 +699,28 @@ private TableId validateTableIdArgument(ByteBuffer tableIdArg, TableOperation op\n     }\n   }\n \n-  // Verify table name arguments are valid, and match any additional restrictions\n+  // Verify older table name arguments are valid, and match any additional restrictions\n   private String validateTableNameArgument(ByteBuffer tableNameArg, TableOperation op,\n       Validator<String> userValidator) throws ThriftTableOperationException {\n     String tableName = tableNameArg == null ? null : ByteBufferUtil.toString(tableNameArg);\n+    if ((tableName != null) && (tableName.length() > MAX_TABLE_NAME_LEN)) {\n+      log.warn(\"Table names greater than \" + MAX_TABLE_NAME_LEN\n+          + \" characters should be renamed to conform to a 1024 character limit. \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76ad03a083b5802946490c6826581c96ee3a55f5"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTQyNjk3", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-365942697", "createdAt": "2020-02-27T19:36:53Z", "commit": {"oid": "76ad03a083b5802946490c6826581c96ee3a55f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOTozNjo1M1rOFvekrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOTozNjo1M1rOFvekrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMyODMwMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      + \" characters should be renamed to conform to a 1024 character limit. \"\n          \n          \n            \n                      + \" characters should be renamed to conform to a \"+MAX_NAMESPACE_LEN+\" character limit. \"", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r385328300", "createdAt": "2020-02-27T19:36:53Z", "author": {"login": "lbschanno"}, "path": "server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java", "diffHunk": "@@ -716,6 +736,24 @@ private void validateArgumentCount(List<ByteBuffer> arguments, TableOperation op\n   private String validateNamespaceArgument(ByteBuffer namespaceArg, TableOperation op,\n       Validator<String> userValidator) throws ThriftTableOperationException {\n     String namespace = namespaceArg == null ? null : ByteBufferUtil.toString(namespaceArg);\n+    if ((namespace != null) && (namespace.length() > MAX_NAMESPACE_LEN)) {\n+      log.warn(\"Namespaces greater than \" + MAX_NAMESPACE_LEN\n+          + \" characters should be renamed to conform to a 1024 character limit. \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76ad03a083b5802946490c6826581c96ee3a55f5"}, "originalPosition": 99}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTQ0Mjkx", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-365944291", "createdAt": "2020-02-27T19:39:19Z", "commit": {"oid": "76ad03a083b5802946490c6826581c96ee3a55f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOTozOToxOVrOFvepeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOTozOToxOVrOFvepeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMyOTUzMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                assertTrue(!c.namespaceOperations().exists(namespace));\n          \n          \n            \n                assertFalse(c.namespaceOperations().exists(namespace));", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r385329530", "createdAt": "2020-02-27T19:39:19Z", "author": {"login": "lbschanno"}, "path": "test/src/main/java/org/apache/accumulo/test/NamespacesIT.java", "diffHunk": "@@ -191,6 +192,18 @@ public void createTableInMissingNamespace() throws Exception {\n     }\n   }\n \n+  @Test(expected = IllegalArgumentException.class)\n+  public void createNamespaceWithNamespaceLengthLimit()\n+      throws AccumuloException, AccumuloSecurityException, NamespaceExistsException {\n+    StringBuilder namespaceBuilder = new StringBuilder();\n+    for (int i = 0; i <= MAX_NAMESPACE_LEN; i++) {\n+      namespaceBuilder.append('a');\n+    }\n+    String namespace = namespaceBuilder.toString();\n+    c.namespaceOperations().create(namespace);\n+    assertTrue(!c.namespaceOperations().exists(namespace));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76ad03a083b5802946490c6826581c96ee3a55f5"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTQ0NTE5", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-365944519", "createdAt": "2020-02-27T19:39:36Z", "commit": {"oid": "76ad03a083b5802946490c6826581c96ee3a55f5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOTozOTozN1rOFveqFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOTozOTozN1rOFveqFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMyOTY4Nw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                assertTrue(!accumuloClient.tableOperations().exists(tableName));\n          \n          \n            \n                assertFalse(accumuloClient.tableOperations().exists(tableName));", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r385329687", "createdAt": "2020-02-27T19:39:37Z", "author": {"login": "lbschanno"}, "path": "test/src/main/java/org/apache/accumulo/test/TableOperationsIT.java", "diffHunk": "@@ -189,6 +190,18 @@ public void createTable() throws TableExistsException, AccumuloException,\n     accumuloClient.tableOperations().delete(tableName);\n   }\n \n+  @Test(expected = IllegalArgumentException.class)\n+  public void createTableWithTableNameLengthLimit()\n+      throws AccumuloException, AccumuloSecurityException, TableExistsException {\n+    StringBuilder tableNameBuilder = new StringBuilder();\n+    for (int i = 0; i <= MAX_TABLE_NAME_LEN; i++) {\n+      tableNameBuilder.append('a');\n+    }\n+    String tableName = tableNameBuilder.toString();\n+    accumuloClient.tableOperations().create(tableName);\n+    assertTrue(!accumuloClient.tableOperations().exists(tableName));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "76ad03a083b5802946490c6826581c96ee3a55f5"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d50e8af31e74a3a9c571f5eedb88f81a42830f8f", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/d50e8af31e74a3a9c571f5eedb88f81a42830f8f", "committedDate": "2020-02-28T15:05:41Z", "message": "Update server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java\n\nCo-Authored-By: Laura Schanno <lbschanno@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd6118ab0d1a8649c2c44faea13eb880a6c39b2b", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/cd6118ab0d1a8649c2c44faea13eb880a6c39b2b", "committedDate": "2020-02-28T15:05:55Z", "message": "Update server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java\n\nCo-Authored-By: Laura Schanno <lbschanno@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7aa00765c97985c28133c452a957ea850afbefd", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/c7aa00765c97985c28133c452a957ea850afbefd", "committedDate": "2020-02-28T15:06:33Z", "message": "Update test/src/main/java/org/apache/accumulo/test/NamespacesIT.java\n\nCo-Authored-By: Laura Schanno <lbschanno@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77460d6abffc675cd901c9836e5ae7479fb2427d", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/77460d6abffc675cd901c9836e5ae7479fb2427d", "committedDate": "2020-02-28T15:06:47Z", "message": "Update test/src/main/java/org/apache/accumulo/test/TableOperationsIT.java\n\nCo-Authored-By: Laura Schanno <lbschanno@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db8cc0263aefeada0e15b1c5c870315ff0b3255f", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/db8cc0263aefeada0e15b1c5c870315ff0b3255f", "committedDate": "2020-02-28T16:59:37Z", "message": "Update FateServiceHandler.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28ee6fbd1ed85891a601e2b442b37da946592840", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/28ee6fbd1ed85891a601e2b442b37da946592840", "committedDate": "2020-02-28T18:40:53Z", "message": "Update NamespacesIT.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ced80042945c143fb97dc1b55ada282bbb920f3c", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/ced80042945c143fb97dc1b55ada282bbb920f3c", "committedDate": "2020-02-28T18:42:15Z", "message": "Update TableOperationsIT.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94855f111b450bfe3664b5a6cf4e060921eb03ac", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/94855f111b450bfe3664b5a6cf4e060921eb03ac", "committedDate": "2020-03-02T17:01:19Z", "message": "Update core/src/main/java/org/apache/accumulo/core/clientImpl/TableOperationsImpl.java\n\nCo-Authored-By: Keith Turner <kturner@apache.org>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4ed306cce38372a0fd885423cdae32e3e8a335c", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/c4ed306cce38372a0fd885423cdae32e3e8a335c", "committedDate": "2020-03-02T17:34:58Z", "message": "Fixes #1430 - Replaced text '1024' with table name and namespace name constants."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4OTQxMDM1", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-368941035", "createdAt": "2020-03-04T16:41:55Z", "commit": {"oid": "c4ed306cce38372a0fd885423cdae32e3e8a335c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNjo0MTo1NVrOFx09NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNjo0Mjo1MFrOFx0_aQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc5MjE4MQ==", "bodyText": "This code will never execute when the previous line throws an exception.", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r387792181", "createdAt": "2020-03-04T16:41:55Z", "author": {"login": "keith-turner"}, "path": "test/src/main/java/org/apache/accumulo/test/NamespacesIT.java", "diffHunk": "@@ -191,6 +192,18 @@ public void createTableInMissingNamespace() throws Exception {\n     }\n   }\n \n+  @Test(expected = IllegalArgumentException.class)\n+  public void createNamespaceWithNamespaceLengthLimit()\n+      throws AccumuloException, AccumuloSecurityException, NamespaceExistsException {\n+    StringBuilder namespaceBuilder = new StringBuilder();\n+    for (int i = 0; i <= MAX_NAMESPACE_LEN; i++) {\n+      namespaceBuilder.append('a');\n+    }\n+    String namespace = namespaceBuilder.toString();\n+    c.namespaceOperations().create(namespace);\n+    assertTrue(!c.namespaceOperations().exists(namespace));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4ed306cce38372a0fd885423cdae32e3e8a335c"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc5Mjc0NQ==", "bodyText": "When the previous line throws an exception, this line will not execute.", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r387792745", "createdAt": "2020-03-04T16:42:50Z", "author": {"login": "keith-turner"}, "path": "test/src/main/java/org/apache/accumulo/test/TableOperationsIT.java", "diffHunk": "@@ -189,6 +190,18 @@ public void createTable() throws TableExistsException, AccumuloException,\n     accumuloClient.tableOperations().delete(tableName);\n   }\n \n+  @Test(expected = IllegalArgumentException.class)\n+  public void createTableWithTableNameLengthLimit()\n+      throws AccumuloException, AccumuloSecurityException, TableExistsException {\n+    StringBuilder tableNameBuilder = new StringBuilder();\n+    for (int i = 0; i <= MAX_TABLE_NAME_LEN; i++) {\n+      tableNameBuilder.append('a');\n+    }\n+    String tableName = tableNameBuilder.toString();\n+    accumuloClient.tableOperations().create(tableName);\n+    assertTrue(!accumuloClient.tableOperations().exists(tableName));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4ed306cce38372a0fd885423cdae32e3e8a335c"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5ce1b8e6697bdd4a82b9bd87e2c6b083a997f7a", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/e5ce1b8e6697bdd4a82b9bd87e2c6b083a997f7a", "committedDate": "2020-03-04T20:00:32Z", "message": "Fixes #1430 - Removed @Test(expected...) notation. Added try-catch block to handle IllegalArgExc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3e93c7990cf5bd7ca1eecffa1c0062356dd3e35e", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/3e93c7990cf5bd7ca1eecffa1c0062356dd3e35e", "committedDate": "2020-03-05T18:20:16Z", "message": "Fixes #1430 - Added fail() for create operation in TableOps and NamespaceOps ITs.\n\nls\ngit commit -m Fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5OTAxNTE5", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-369901519", "createdAt": "2020-03-05T20:46:19Z", "commit": {"oid": "3e93c7990cf5bd7ca1eecffa1c0062356dd3e35e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "01c6b4458d3fbac0eadf98cb3777b61b02224a14", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/01c6b4458d3fbac0eadf98cb3777b61b02224a14", "committedDate": "2020-03-06T12:58:41Z", "message": "Merge branch 'master' into accumulo-1430"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NjQ1MTQ4", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-374645148", "createdAt": "2020-03-13T22:08:13Z", "commit": {"oid": "01c6b4458d3fbac0eadf98cb3777b61b02224a14"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QyMjowODoxM1rOF2UyHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QyMjoyMzowNVrOF2VB7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUwNzkzNQ==", "bodyText": "These can be simplified like:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                try {\n          \n          \n            \n                  accumuloClient.tableOperations().create(tableName);\n          \n          \n            \n                  fail(\"IllegalArgumentException was not thrown\");\n          \n          \n            \n                } catch (IllegalArgumentException exc) {\n          \n          \n            \n                  assertTrue(!accumuloClient.tableOperations().exists(tableName));\n          \n          \n            \n                }\n          \n          \n            \n                assertThrows(IllegalArgumentException.class, () -> accumuloClient.tableOperations().create(tableName));\n          \n          \n            \n                assertFalse(accumuloClient.tableOperations().exists(tableName));\n          \n      \n    \n    \n  \n\nThe Assert.assertThrows also returns the exception, so you can do additional checks to check the exception's getMessage() and, if you wish, the getCause().\nYou can also create the name using commons-lang3's String tableName = StringUtils.repeat('a', MAX_TABLE_NAME_LEN);\nYou can also verify the length of the string in an assert statement. Additional checks would include max length plus and minus one.\nThese comments also apply to the namespace checks.", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r392507935", "createdAt": "2020-03-13T22:08:13Z", "author": {"login": "ctubbsii"}, "path": "test/src/main/java/org/apache/accumulo/test/TableOperationsIT.java", "diffHunk": "@@ -189,6 +190,22 @@ public void createTable() throws TableExistsException, AccumuloException,\n     accumuloClient.tableOperations().delete(tableName);\n   }\n \n+  @Test\n+  public void createTableWithTableNameLengthLimit()\n+      throws AccumuloException, AccumuloSecurityException, TableExistsException {\n+    StringBuilder tableNameBuilder = new StringBuilder();\n+    for (int i = 0; i <= MAX_TABLE_NAME_LEN; i++) {\n+      tableNameBuilder.append('a');\n+    }\n+    String tableName = tableNameBuilder.toString();\n+    try {\n+      accumuloClient.tableOperations().create(tableName);\n+      fail(\"IllegalArgumentException was not thrown\");\n+    } catch (IllegalArgumentException exc) {\n+      assertTrue(!accumuloClient.tableOperations().exists(tableName));\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01c6b4458d3fbac0eadf98cb3777b61b02224a14"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUwOTg2MA==", "bodyText": "There is an INVALID_NAME type you can use instead of OTHER. (Same for the NAMESPACE validation method).", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r392509860", "createdAt": "2020-03-13T22:15:29Z", "author": {"login": "ctubbsii"}, "path": "server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java", "diffHunk": "@@ -716,6 +738,25 @@ private void validateArgumentCount(List<ByteBuffer> arguments, TableOperation op\n   private String validateNamespaceArgument(ByteBuffer namespaceArg, TableOperation op,\n       Validator<String> userValidator) throws ThriftTableOperationException {\n     String namespace = namespaceArg == null ? null : ByteBufferUtil.toString(namespaceArg);\n+    if ((namespace != null) && (namespace.length() > MAX_NAMESPACE_LEN)) {\n+      log.warn(\"Namespaces greater than \" + MAX_NAMESPACE_LEN\n+          + \" characters should be renamed to conform to a \" + MAX_NAMESPACE_LEN\n+          + \" character limit. \"\n+          + \"Longer namespaces are no longer supported and may result in unexpected behavior.\");\n+    }\n+    return _validateArgument(namespace, op, Namespaces.VALID_NAME.and(userValidator));\n+  }\n+\n+  // Verify namespace arguments are valid, and match any additional restrictions\n+  private String validateNewNamespaceArgument(ByteBuffer namespaceArg, TableOperation op,\n+      Validator<String> userValidator) throws ThriftTableOperationException {\n+    String namespace = namespaceArg == null ? null : ByteBufferUtil.toString(namespaceArg);\n+    if ((namespace != null) && (namespace.length() > MAX_NAMESPACE_LEN)) {\n+      throw new ThriftTableOperationException(null, namespace, op,\n+          TableOperationExceptionType.OTHER,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01c6b4458d3fbac0eadf98cb3777b61b02224a14"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUxMDYwOQ==", "bodyText": "As follow-on, it might be useful to create a cache of recent warnings, so tables which aren't immediately renamed, but are relatively active, don't spam the logs too much.", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r392510609", "createdAt": "2020-03-13T22:18:08Z", "author": {"login": "ctubbsii"}, "path": "server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java", "diffHunk": "@@ -697,10 +700,29 @@ private TableId validateTableIdArgument(ByteBuffer tableIdArg, TableOperation op\n     }\n   }\n \n-  // Verify table name arguments are valid, and match any additional restrictions\n+  // Verify older table name arguments are valid, and match any additional restrictions\n   private String validateTableNameArgument(ByteBuffer tableNameArg, TableOperation op,\n       Validator<String> userValidator) throws ThriftTableOperationException {\n     String tableName = tableNameArg == null ? null : ByteBufferUtil.toString(tableNameArg);\n+    if ((tableName != null) && (tableName.length() > MAX_TABLE_NAME_LEN)) {\n+      log.warn(\"Table names greater than \" + MAX_TABLE_NAME_LEN\n+          + \" characters should be renamed to conform to a \" + MAX_TABLE_NAME_LEN\n+          + \" character limit. Longer table names are no longer supported and may result in \"\n+          + \" unexpected behavior.\");\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01c6b4458d3fbac0eadf98cb3777b61b02224a14"}, "originalPosition": 78}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUxMDk0NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        validateNewTableNameArgument(arguments.get(1), tableOp, new Validator<String>() {\n          \n          \n            \n                        validateNewTableNameArgument(arguments.get(1), tableOp, new Validator<>() {", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r392510944", "createdAt": "2020-03-13T22:19:21Z", "author": {"login": "ctubbsii"}, "path": "server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java", "diffHunk": "@@ -206,7 +208,8 @@ public void executeFateOperation(TInfo tinfo, TCredentials c, long opid, FateOpe\n         final String oldTableName =\n             validateTableNameArgument(arguments.get(0), tableOp, NOT_SYSTEM);\n         String newTableName =\n-            validateTableNameArgument(arguments.get(1), tableOp, new Validator<>() {\n+\n+            validateNewTableNameArgument(arguments.get(1), tableOp, new Validator<String>() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01c6b4458d3fbac0eadf98cb3777b61b02224a14"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUxMTk4MA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              // Verify older table name arguments are valid, and match any additional restrictions\n          \n          \n            \n              // Verify existing table's name argument is valid, and match any additional restrictions", "url": "https://github.com/apache/accumulo/pull/1518#discussion_r392511980", "createdAt": "2020-03-13T22:23:05Z", "author": {"login": "ctubbsii"}, "path": "server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java", "diffHunk": "@@ -697,10 +700,29 @@ private TableId validateTableIdArgument(ByteBuffer tableIdArg, TableOperation op\n     }\n   }\n \n-  // Verify table name arguments are valid, and match any additional restrictions\n+  // Verify older table name arguments are valid, and match any additional restrictions", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "01c6b4458d3fbac0eadf98cb3777b61b02224a14"}, "originalPosition": 69}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3c979d28be45a1fee8a803a3d1fcdb915a00d4d", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/e3c979d28be45a1fee8a803a3d1fcdb915a00d4d", "committedDate": "2020-03-16T14:43:26Z", "message": "Update server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java\n\nCo-Authored-By: Christopher Tubbs <ctubbsii@apache.org>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "49db591a8b218fa3055c9f7beb410af0f0be42db", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/49db591a8b218fa3055c9f7beb410af0f0be42db", "committedDate": "2020-03-16T14:43:39Z", "message": "Update server/master/src/main/java/org/apache/accumulo/master/FateServiceHandler.java\n\nCo-Authored-By: Christopher Tubbs <ctubbsii@apache.org>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ad5582b8cdabfed188f4be0ec49d5868c2f53fe", "author": {"user": {"login": "cradal", "name": null}}, "url": "https://github.com/apache/accumulo/commit/0ad5582b8cdabfed188f4be0ec49d5868c2f53fe", "committedDate": "2020-03-16T17:02:19Z", "message": "Update test/src/main/java/org/apache/accumulo/test/TableOperationsIT.java\n\nCo-Authored-By: Christopher Tubbs <ctubbsii@apache.org>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "885dec1f2e235f97d353c72ad725908c016d565f", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/885dec1f2e235f97d353c72ad725908c016d565f", "committedDate": "2020-03-17T04:14:45Z", "message": "Merge branch 'master' into accumulo-1430"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c85d62d1c480e191f852f164a056ddb1fb17ae0", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/1c85d62d1c480e191f852f164a056ddb1fb17ae0", "committedDate": "2020-03-17T04:46:26Z", "message": "Use INVALID_NAME type and assertThrows in IT"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NzYwMzMx", "url": "https://github.com/apache/accumulo/pull/1518#pullrequestreview-375760331", "createdAt": "2020-03-17T06:07:16Z", "commit": {"oid": "1c85d62d1c480e191f852f164a056ddb1fb17ae0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1844, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}