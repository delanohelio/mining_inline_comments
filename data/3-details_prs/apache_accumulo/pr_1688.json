{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5MTg5MDYw", "number": 1688, "title": "Fix issues in prep for 1.10 release", "bodyText": "Fix quality issues in prep for 1.10 release\n\nConverge the Hadoop 2 and Hadoop 3 assemblies, so only one is\nnecessary (tested both on Hadoop 2.6.5, 3.0.3, and 3.3.0 using\nfluo-uno)\nBumped plugin versions and added timestamp flag for increased build\nreproducibility; timestamp should automatically update during release\nprocess; verified the built jars differ only in the contents of the\ngenerated META-INF/DEPENDENCIES file when building with the Hadoop2\nvs. the Hadoop3 profiles, and since this file doesn't matter, they are\nnow provably equivalent builds\nFixed some Hadoop profile issues, and updated Hadoop versions to\nlatest patch version in the minor release lines we had previously been\nbuilding with as our minimum supported versions\nBump Guava, and related code to work with both Hadoop 2 and 3;\nsuppress warnings or migrate code to avoid code paths that won't work\nacross Guava versions, for fewer class path surprises related to\nGuava\nUpdate asciidoc plugin, and fix various doc build issues warned about\nby the plugin\n\nBump snapshot versions to 1.10.0-SNAPSHOT", "createdAt": "2020-08-18T04:14:48Z", "url": "https://github.com/apache/accumulo/pull/1688", "merged": true, "mergeCommit": {"oid": "dab5b80155835d2793b542aa4fcc382c189f9fbe"}, "closed": true, "closedAt": "2020-08-20T19:47:20Z", "author": {"login": "ctubbsii"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc_28ZKgH2gAyNDY5MTg5MDYwOjkyMWMxMTE3MjE0YjgxOGFhYTZiYTM3MDgwZjk2MDc2MWE1Y2M5MTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdA1QSwAFqTQ3MTkxMTczOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "921c1117214b818aaa6ba37080f960761a5cc915", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/921c1117214b818aaa6ba37080f960761a5cc915", "committedDate": "2020-08-17T18:44:09Z", "message": "Bump snapshot versions to 1.10.0-SNAPSHOT"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7fa4d7d738da78592287041c11f1a6445a06c006", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/7fa4d7d738da78592287041c11f1a6445a06c006", "committedDate": "2020-08-18T04:02:20Z", "message": "Fix quality issues in prep for 1.10 release\n\n* Converge the Hadoop 2 and Hadoop 3 assemblies, so only one is\n  necessary (tested both on Hadoop 2.6.5, 3.0.3, and 3.3.0 using\n  fluo-uno)\n* Bumped plugin versions and added timestamp flag for increased build\n  reproducibility; timestamp should automatically update during release\n  process; verified the built jars differ only in the contents of the\n  generated META-INF/DEPENDENCIES file when building with the Hadoop2\n  vs. the Hadoop3 profiles, and since this file doesn't matter, they are\n  now provably equivalent builds\n* Fixed some Hadoop profile issues, and updated Hadoop versions to\n  latest patch version in the minor release lines we had previously been\n  building with as our minimum supported versions\n* Bump Guava, and related code to work with both Hadoop 2 and 3;\n  suppress warnings or migrate code to avoid code paths that won't work\n  across Guava versions, for fewer class path surprises related to\n  Guava\n* Update asciidoc plugin, and fix various doc build issues warned about\n  by the plugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72bd9dd46dd3b46bfbf508da9838a86b0a121198", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/72bd9dd46dd3b46bfbf508da9838a86b0a121198", "committedDate": "2020-08-18T16:50:46Z", "message": "Go back to Guava 14, for vfs2 on Hadoop 2\n\nMake assembly build with different bundled Guava and commons-vfs2, based\non whether it is intended for Hadoop 2 or 3.\n\nMake Accumulo code work with either version of Guava."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70b2bf960a6194b358a566b1c65f2ef32e086bf8", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/70b2bf960a6194b358a566b1c65f2ef32e086bf8", "committedDate": "2020-08-18T19:33:46Z", "message": "Undo dependency updates that break the build"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2eec612863e78114c41c48457afeb6074d5b3b3e", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/2eec612863e78114c41c48457afeb6074d5b3b3e", "committedDate": "2020-08-18T19:40:21Z", "message": "Use last commons-io that doesn't break vfs2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwOTQxNDEz", "url": "https://github.com/apache/accumulo/pull/1688#pullrequestreview-470941413", "createdAt": "2020-08-19T20:53:47Z", "commit": {"oid": "2eec612863e78114c41c48457afeb6074d5b3b3e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMDo1Mzo0N1rOHDYsNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMDo1Mzo0N1rOHDYsNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMxMjMwOQ==", "bodyText": "Is this an artifact of release testing?", "url": "https://github.com/apache/accumulo/pull/1688#discussion_r473312309", "createdAt": "2020-08-19T20:53:47Z", "author": {"login": "keith-turner"}, "path": "pom.xml", "diffHunk": "@@ -136,10 +136,12 @@\n     <maven.compiler.release>8</maven.compiler.release>\n     <maven.compiler.source>1.8</maven.compiler.source>\n     <maven.compiler.target>1.8</maven.compiler.target>\n-    <maven.plugin-version>3.0.5</maven.plugin-version>\n+    <maven.plugin-version>3.5.0</maven.plugin-version>\n     <!-- surefire/failsafe plugin option -->\n     <maven.test.redirectTestOutputToFile>true</maven.test.redirectTestOutputToFile>\n     <powermock.version>2.0.2</powermock.version>\n+    <!-- timestamp for reproducible outputs, updated on release by the release plugin -->\n+    <project.build.outputTimestamp>2020-08-18T00:00:00Z</project.build.outputTimestamp>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2eec612863e78114c41c48457afeb6074d5b3b3e"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa5a19260685905e843703f5fbd651407426cd6d", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/fa5a19260685905e843703f5fbd651407426cd6d", "committedDate": "2020-08-20T15:30:44Z", "message": "Make Guava version configurable at build time"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxODQ4NjUz", "url": "https://github.com/apache/accumulo/pull/1688#pullrequestreview-471848653", "createdAt": "2020-08-20T17:48:32Z", "commit": {"oid": "fa5a19260685905e843703f5fbd651407426cd6d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxODcxMzMy", "url": "https://github.com/apache/accumulo/pull/1688#pullrequestreview-471871332", "createdAt": "2020-08-20T18:20:59Z", "commit": {"oid": "fa5a19260685905e843703f5fbd651407426cd6d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxODoyMDo1OVrOHEN3mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxODoyMDo1OVrOHEN3mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4MzU3Nw==", "bodyText": "Probably just a nit, but does changing the output format matter?  Duration will print out like: PT0.021850552S , Stopwatch is more \"user\" friendly with \"333.2 ms\"\nAlso, maybe unrelated by anything other than name, but there is a StopWatch class in org.apache.accumulo.core.util - it seems to be referenced only in org.apache.accumulo.server.client.BulkImporter.", "url": "https://github.com/apache/accumulo/pull/1688#discussion_r474183577", "createdAt": "2020-08-20T18:20:59Z", "author": {"login": "EdColeman"}, "path": "server/gc/src/main/java/org/apache/accumulo/gc/replication/CloseWriteAheadLogReferences.java", "diffHunk": "@@ -104,28 +105,27 @@ public void run() {\n     Span findWalsSpan = Trace.start(\"findReferencedWals\");\n     HashSet<String> closed = null;\n     try {\n-      sw.start();\n+      startTime = System.nanoTime();\n       closed = getClosedLogs(conn);\n+      duration = Duration.ofNanos(System.nanoTime() - startTime);\n     } finally {\n-      sw.stop();\n       findWalsSpan.stop();\n     }\n \n-    log.info(\"Found \" + closed.size() + \" WALs referenced in metadata in \" + sw.toString());\n-    sw.reset();\n+    log.info(\"Found \" + closed.size() + \" WALs referenced in metadata in \" + duration);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa5a19260685905e843703f5fbd651407426cd6d"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcxOTExNzM5", "url": "https://github.com/apache/accumulo/pull/1688#pullrequestreview-471911739", "createdAt": "2020-08-20T19:20:00Z", "commit": {"oid": "fa5a19260685905e843703f5fbd651407426cd6d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1702, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}