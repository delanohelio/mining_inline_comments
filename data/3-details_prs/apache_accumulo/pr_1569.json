{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyNjk1Njcz", "number": 1569, "title": "Fixes #1464 - SimpleThreadPool for importtable", "bodyText": "Improves performance as calls to fs.rename are now made in parallel\nfrom multiple threads within a SimpleThreadPool. Thread pool size is\ncontrolled by new property master.importtable.rename.threadpool.size", "createdAt": "2020-03-23T23:36:07Z", "url": "https://github.com/apache/accumulo/pull/1569", "merged": true, "mergeCommit": {"oid": "994f1e1e473f5b005d5720bb640620c1bde7dc9e"}, "closed": true, "closedAt": "2020-03-26T17:34:48Z", "author": {"login": "arvindshmicrosoft"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQnCtwAH2gAyMzkyNjk1NjczOmVmYjVhZWRjZGE2MjFiMmMxMzY1ODQwMjU3YTk1Njg0ZTBlMjc0YTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRe88lgFqTM4MjIwMjg1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "efb5aedcda621b2c1365840257a95684e0e274a0", "author": {"user": {"login": "arvindshmicrosoft", "name": "Arvind Shyamsundar"}}, "url": "https://github.com/apache/accumulo/commit/efb5aedcda621b2c1365840257a95684e0e274a0", "committedDate": "2020-03-23T23:38:08Z", "message": "Use SimpleThreadPool for importtable file renames\n\nFixes #1464 - importtable improved with parallel calls to fs.rename\nfrom multiple threads within a SimpleThreadPool. Thread pool size is\ncontrolled by new property master.importtable.rename.threadpool.size"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "532491f7ea20f42acf530f0510055b8c4ae43fee", "author": {"user": {"login": "arvindshmicrosoft", "name": "Arvind Shyamsundar"}}, "url": "https://github.com/apache/accumulo/commit/532491f7ea20f42acf530f0510055b8c4ae43fee", "committedDate": "2020-03-23T23:31:36Z", "message": "Use SimpleThreadPool for importtable file renames\n\nImproves performance as calls to fs.rename are now made in parallel\nfrom multiple threads within a SimpleThreadPool. Thread pool size is\ncontrolled by new property master.importtable.rename.threadpool.size"}, "afterCommit": {"oid": "efb5aedcda621b2c1365840257a95684e0e274a0", "author": {"user": {"login": "arvindshmicrosoft", "name": "Arvind Shyamsundar"}}, "url": "https://github.com/apache/accumulo/commit/efb5aedcda621b2c1365840257a95684e0e274a0", "committedDate": "2020-03-23T23:38:08Z", "message": "Use SimpleThreadPool for importtable file renames\n\nFixes #1464 - importtable improved with parallel calls to fs.rename\nfrom multiple threads within a SimpleThreadPool. Thread pool size is\ncontrolled by new property master.importtable.rename.threadpool.size"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwMjgyMDQ1", "url": "https://github.com/apache/accumulo/pull/1569#pullrequestreview-380282045", "createdAt": "2020-03-24T12:58:41Z", "commit": {"oid": "efb5aedcda621b2c1365840257a95684e0e274a0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxMjo1ODo0MVrOF6vAdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQxMjo1ODo0MVrOF6vAdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzEzMTg5NQ==", "bodyText": "I wonder if we can combine this with MASTER_BULK_RENAME_THREADS and just have one common value for renames in the Master.", "url": "https://github.com/apache/accumulo/pull/1569#discussion_r397131895", "createdAt": "2020-03-24T12:58:41Z", "author": {"login": "milleruntime"}, "path": "core/src/main/java/org/apache/accumulo/core/conf/Property.java", "diffHunk": "@@ -251,6 +251,9 @@\n   MASTER_BULK_RENAME_THREADS(\"master.bulk.rename.threadpool.size\", \"20\", PropertyType.COUNT,\n       \"The number of threads to use when moving user files to bulk ingest \"\n           + \"directories under accumulo control\"),\n+  MASTER_IMPORTTABLE_RENAME_THREADS(\"master.importtable.rename.threadpool.size\", \"20\",\n+      PropertyType.COUNT,\n+      \"The number of threads to use when renaming user files when importing a table.\"),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efb5aedcda621b2c1365840257a95684e0e274a0"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b530e0598f9831b8e343c7a7f56703ffc45bd92", "author": {"user": {"login": "arvindshmicrosoft", "name": "Arvind Shyamsundar"}}, "url": "https://github.com/apache/accumulo/commit/8b530e0598f9831b8e343c7a7f56703ffc45bd92", "committedDate": "2020-03-25T05:35:25Z", "message": "Usee common property for file rename threadpools\n\n* deprecates master.bulk.rename.threadpool.size\n* master.rename.threadpool.size is a new common property shared across\n  import and bulk ingest\n* update importdirectory (bulk ingest) code to leverage new property"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMjA1OTUy", "url": "https://github.com/apache/accumulo/pull/1569#pullrequestreview-381205952", "createdAt": "2020-03-25T14:33:20Z", "commit": {"oid": "8b530e0598f9831b8e343c7a7f56703ffc45bd92"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNDozMzoyMFrOF7d_NA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxNDozNTozOVrOF7eGvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzkwMTYyMA==", "bodyText": "Can this be removed?", "url": "https://github.com/apache/accumulo/pull/1569#discussion_r397901620", "createdAt": "2020-03-25T14:33:20Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/conf/Property.java", "diffHunk": "@@ -248,9 +248,16 @@\n       \"The number of threads to use when coordinating a bulk import.\"),\n   MASTER_BULK_TIMEOUT(\"master.bulk.timeout\", \"5m\", PropertyType.TIMEDURATION,\n       \"The time to wait for a tablet server to process a bulk import request\"),\n+  MASTER_RENAME_THREADS(\"master.rename.threadpool.size\", \"20\", PropertyType.COUNT,\n+      \"The number of threads to use when renaming user files during table import or bulk ingest.\"),\n+  @Deprecated\n+  @ReplacedBy(property = MASTER_RENAME_THREADS)\n   MASTER_BULK_RENAME_THREADS(\"master.bulk.rename.threadpool.size\", \"20\", PropertyType.COUNT,\n       \"The number of threads to use when moving user files to bulk ingest \"\n           + \"directories under accumulo control\"),\n+  MASTER_IMPORTTABLE_RENAME_THREADS(\"master.importtable.rename.threadpool.size\", \"20\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b530e0598f9831b8e343c7a7f56703ffc45bd92"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzkwMzU0OA==", "bodyText": "Some of the deprecated properties have the following in their description.  I think this is nice for the generated documentation.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  \"The number of threads to use when moving user files to bulk ingest \"\n          \n          \n            \n                  \"This property is deprecated since 2.1.0. The number of threads to use when moving user files to bulk ingest \"", "url": "https://github.com/apache/accumulo/pull/1569#discussion_r397903548", "createdAt": "2020-03-25T14:35:39Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/conf/Property.java", "diffHunk": "@@ -248,9 +248,16 @@\n       \"The number of threads to use when coordinating a bulk import.\"),\n   MASTER_BULK_TIMEOUT(\"master.bulk.timeout\", \"5m\", PropertyType.TIMEDURATION,\n       \"The time to wait for a tablet server to process a bulk import request\"),\n+  MASTER_RENAME_THREADS(\"master.rename.threadpool.size\", \"20\", PropertyType.COUNT,\n+      \"The number of threads to use when renaming user files during table import or bulk ingest.\"),\n+  @Deprecated\n+  @ReplacedBy(property = MASTER_RENAME_THREADS)\n   MASTER_BULK_RENAME_THREADS(\"master.bulk.rename.threadpool.size\", \"20\", PropertyType.COUNT,\n       \"The number of threads to use when moving user files to bulk ingest \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b530e0598f9831b8e343c7a7f56703ffc45bd92"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "595e735a074f6c05ddc4a4b8e969dd4702206572", "author": {"user": {"login": "arvindshmicrosoft", "name": "Arvind Shyamsundar"}}, "url": "https://github.com/apache/accumulo/commit/595e735a074f6c05ddc4a4b8e969dd4702206572", "committedDate": "2020-03-25T16:20:33Z", "message": "Remove unused property and add deprecation note"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzk0OTE0", "url": "https://github.com/apache/accumulo/pull/1569#pullrequestreview-381394914", "createdAt": "2020-03-25T17:51:31Z", "commit": {"oid": "595e735a074f6c05ddc4a4b8e969dd4702206572"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyMjAyODU5", "url": "https://github.com/apache/accumulo/pull/1569#pullrequestreview-382202859", "createdAt": "2020-03-26T16:46:31Z", "commit": {"oid": "595e735a074f6c05ddc4a4b8e969dd4702206572"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1906, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}