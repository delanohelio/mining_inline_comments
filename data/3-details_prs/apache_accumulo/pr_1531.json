{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5MzE1NjA2", "number": 1531, "title": "Bump ZooKeeper dependency to 3.5.7", "bodyText": "This change bumps our ZooKeeper minimum version to the latest patch release of 3.5, which eliminates our last log4j 1.2 transitive dependency.\nThis work was previously stalled due to https://issues.apache.org/jira/browse/ZOOKEEPER-3737, but the workaround suggested there to disable log4j jmx for minicluster works fine.", "createdAt": "2020-02-25T01:24:52Z", "url": "https://github.com/apache/accumulo/pull/1531", "merged": true, "mergeCommit": {"oid": "2f28816d40778df60508e5ed9c3f0f496173b997"}, "closed": true, "closedAt": "2020-02-26T22:26:31Z", "author": {"login": "ctubbsii"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHnv-VgH2gAyMzc5MzE1NjA2OjY1YjQ3NTc5OTJiMzgyMzIwN2E2YzFhZDg1ZDY0NjQ0ZmVmMzRjMDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcINFFqAFqTM2NTIzMjQ1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "65b4757992b3823207a6c1ad85d64644fef34c00", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/65b4757992b3823207a6c1ad85d64644fef34c00", "committedDate": "2020-02-25T01:22:15Z", "message": "WIP - bump to ZK 3.5.7\n\nThis work is stalled due to https://issues.apache.org/jira/browse/ZOOKEEPER-3737\nIt is possible to do this, but one of the benefits of this was to try to\neliminate the transitive dependency on log4j 1.2. ZOOKEEPER-3737 seems\nto prohibit that, at least for now."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7ff218e2b234d2904a3b0c822ef24e80cbfda52", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/b7ff218e2b234d2904a3b0c822ef24e80cbfda52", "committedDate": "2020-02-26T03:40:40Z", "message": "Make minicluster/zookeeper work without log4j 1.2\n\n* Disable log4j 1.2 jmx support in ZooKeeper when minicluster runs it\n* Whitelist 'ruok' 4lw in minicluster zoo.cfg\n* Add missing case statements for new ZK event types in\n  DistributedWorkQueue\n* Close unclosed ZooKeeper instances in test code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48e239b63895ce24c99d5d6609401a55e95af71c", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/48e239b63895ce24c99d5d6609401a55e95af71c", "committedDate": "2020-02-26T04:45:11Z", "message": "Disable ZK admin server in minicluster"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0OTAzMTg3", "url": "https://github.com/apache/accumulo/pull/1531#pullrequestreview-364903187", "createdAt": "2020-02-26T13:39:23Z", "commit": {"oid": "48e239b63895ce24c99d5d6609401a55e95af71c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzozOToyNFrOFurzww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxMzozOToyNFrOFurzww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDQ5NjU3OQ==", "bodyText": "Does disabling this avoid executing the code that calls log4j v1?", "url": "https://github.com/apache/accumulo/pull/1531#discussion_r384496579", "createdAt": "2020-02-26T13:39:24Z", "author": {"login": "keith-turner"}, "path": "minicluster/src/main/java/org/apache/accumulo/miniclusterImpl/MiniAccumuloClusterImpl.java", "diffHunk": "@@ -404,6 +404,7 @@ public MiniAccumuloClusterImpl(MiniAccumuloConfigImpl config) throws IOException\n       zooCfg.setProperty(\"maxClientCnxns\", \"1000\");\n       zooCfg.setProperty(\"dataDir\", config.getZooKeeperDir().getAbsolutePath());\n       zooCfg.setProperty(\"4lw.commands.whitelist\", \"ruok\");\n+      zooCfg.setProperty(\"admin.enableServer\", \"false\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48e239b63895ce24c99d5d6609401a55e95af71c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed459cd77cba482b2c970afc231ec532dc5f7633", "author": {"user": {"login": "ctubbsii", "name": "Christopher Tubbs"}}, "url": "https://github.com/apache/accumulo/commit/ed459cd77cba482b2c970afc231ec532dc5f7633", "committedDate": "2020-02-26T15:17:04Z", "message": "Enable another 4lw for WatchTheWatchCountIT"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MjMxODQ2", "url": "https://github.com/apache/accumulo/pull/1531#pullrequestreview-365231846", "createdAt": "2020-02-26T20:50:55Z", "commit": {"oid": "ed459cd77cba482b2c970afc231ec532dc5f7633"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMDo1MDo1NVrOFu7ulg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMDo1MDo1NVrOFu7ulg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc1NzM5OA==", "bodyText": "Would be good to make more use of this being autoclosable but that could be a follow on ticket.", "url": "https://github.com/apache/accumulo/pull/1531#discussion_r384757398", "createdAt": "2020-02-26T20:50:55Z", "author": {"login": "milleruntime"}, "path": "test/src/test/java/org/apache/accumulo/test/fate/zookeeper/ZooLockTest.java", "diffHunk": "@@ -274,42 +274,43 @@ public void testUnexpectedEvent() throws Exception {\n     String parent = \"/zltest-\" + this.hashCode() + \"-l\" + pdCount.incrementAndGet();\n \n     ConnectedWatcher watcher = new ConnectedWatcher();\n-    ZooKeeper zk = new ZooKeeper(accumulo.getZooKeepers(), 30000, watcher);\n-    zk.addAuthInfo(\"digest\", \"accumulo:secret\".getBytes(UTF_8));\n+    try (ZooKeeper zk = new ZooKeeper(accumulo.getZooKeepers(), 30000, watcher)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ed459cd77cba482b2c970afc231ec532dc5f7633"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MjMyNDU3", "url": "https://github.com/apache/accumulo/pull/1531#pullrequestreview-365232457", "createdAt": "2020-02-26T20:51:48Z", "commit": {"oid": "ed459cd77cba482b2c970afc231ec532dc5f7633"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1854, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}