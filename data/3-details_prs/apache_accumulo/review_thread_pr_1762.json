{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMzI2MzE3", "number": 1762, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMzoyMjo1MVrOEz_L6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNTo1MjoyN1rOE0b9yg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyOTQ4MDc0OnYy", "diffSide": "RIGHT", "path": "server/base/src/main/java/org/apache/accumulo/server/metadata/ServerAmpleImpl.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQyMzoyMjo1MVrOHri1Kw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwMDo0NjozNlrOHscntg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQyMTQ4Mw==", "bodyText": "Can you use Java built in Stream to map to StoredTableFile, instead of adding the Guava usage?\nSomething like:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      rgcc -> rgcc.add(Collections2.transform(candidates, StoredTabletFile::new)));\n          \n          \n            \n                      rgcc -> rgcc.add(Collections2.transform(candidates, StoredTabletFile::new)));\n          \n          \n            \n                      rgcc -> rgcc.add(candidates.stream().map(StoredTabletFile::new).collect(toList())));\n          \n      \n    \n    \n  \n\nI know it's slightly longer, but I think it's generally safer to use built-ins than to rely on Guava.", "url": "https://github.com/apache/accumulo/pull/1762#discussion_r515421483", "createdAt": "2020-10-30T23:22:51Z", "author": {"login": "ctubbsii"}, "path": "server/base/src/main/java/org/apache/accumulo/server/metadata/ServerAmpleImpl.java", "diffHunk": "@@ -126,6 +127,25 @@ public void putGcCandidates(TableId tableId, Collection<StoredTabletFile> candid\n     }\n   }\n \n+  @Override\n+  public void putGcFdCandidates(TableId tableId, Collection<String> candidates) {\n+\n+    if (RootTable.ID.equals(tableId)) {\n+      // Directories are unexpected for the root tablet, so convert to stored tablet file\n+      mutateRootGcCandidates(\n+          rgcc -> rgcc.add(Collections2.transform(candidates, StoredTabletFile::new)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02a6edb3446324c5e1a9f57bdc2f612e7da9392c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM2MjE5OA==", "bodyText": "I changed this in d259836 to use streams.  Made the method take an iterator instead of a collection. This allowed streams to be used w/o copying to a new collection like the Guava code and its still short.", "url": "https://github.com/apache/accumulo/pull/1762#discussion_r516362198", "createdAt": "2020-11-03T00:33:54Z", "author": {"login": "keith-turner"}, "path": "server/base/src/main/java/org/apache/accumulo/server/metadata/ServerAmpleImpl.java", "diffHunk": "@@ -126,6 +127,25 @@ public void putGcCandidates(TableId tableId, Collection<StoredTabletFile> candid\n     }\n   }\n \n+  @Override\n+  public void putGcFdCandidates(TableId tableId, Collection<String> candidates) {\n+\n+    if (RootTable.ID.equals(tableId)) {\n+      // Directories are unexpected for the root tablet, so convert to stored tablet file\n+      mutateRootGcCandidates(\n+          rgcc -> rgcc.add(Collections2.transform(candidates, StoredTabletFile::new)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQyMTQ4Mw=="}, "originalCommit": {"oid": "02a6edb3446324c5e1a9f57bdc2f612e7da9392c"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM2ODMxMA==", "bodyText": "That works. \ud83d\ude3a", "url": "https://github.com/apache/accumulo/pull/1762#discussion_r516368310", "createdAt": "2020-11-03T00:46:36Z", "author": {"login": "ctubbsii"}, "path": "server/base/src/main/java/org/apache/accumulo/server/metadata/ServerAmpleImpl.java", "diffHunk": "@@ -126,6 +127,25 @@ public void putGcCandidates(TableId tableId, Collection<StoredTabletFile> candid\n     }\n   }\n \n+  @Override\n+  public void putGcFdCandidates(TableId tableId, Collection<String> candidates) {\n+\n+    if (RootTable.ID.equals(tableId)) {\n+      // Directories are unexpected for the root tablet, so convert to stored tablet file\n+      mutateRootGcCandidates(\n+          rgcc -> rgcc.add(Collections2.transform(candidates, StoredTabletFile::new)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQyMTQ4Mw=="}, "originalCommit": {"oid": "02a6edb3446324c5e1a9f57bdc2f612e7da9392c"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzNDE5NTk0OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/apache/accumulo/core/metadata/schema/Ample.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNTo1MjoyN1rOHsKVTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwMDozNDoxMFrOHscQSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA2ODY4NQ==", "bodyText": "What is \"Fd\" short for? Should comment what the \"Fd\" in the method name means.", "url": "https://github.com/apache/accumulo/pull/1762#discussion_r516068685", "createdAt": "2020-11-02T15:52:27Z", "author": {"login": "milleruntime"}, "path": "core/src/main/java/org/apache/accumulo/core/metadata/schema/Ample.java", "diffHunk": "@@ -144,6 +144,13 @@ default void putGcCandidates(TableId tableId, Collection<StoredTabletFile> candi\n     throw new UnsupportedOperationException();\n   }\n \n+  /**\n+   * Unlike {@link #putGcCandidates(TableId, Collection)} this takes file and dir GC candidates.\n+   */\n+  default void putGcFdCandidates(TableId tableId, Collection<String> candidates) {\n+    throw new UnsupportedOperationException();\n+  }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02a6edb3446324c5e1a9f57bdc2f612e7da9392c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA3NDA2NQ==", "bodyText": "If \"Fd\" means \"file and Directories\"  you could just put that explicitly in the name like putGcFileCandidates or putGcFileDirectories", "url": "https://github.com/apache/accumulo/pull/1762#discussion_r516074065", "createdAt": "2020-11-02T15:59:42Z", "author": {"login": "milleruntime"}, "path": "core/src/main/java/org/apache/accumulo/core/metadata/schema/Ample.java", "diffHunk": "@@ -144,6 +144,13 @@ default void putGcCandidates(TableId tableId, Collection<StoredTabletFile> candi\n     throw new UnsupportedOperationException();\n   }\n \n+  /**\n+   * Unlike {@link #putGcCandidates(TableId, Collection)} this takes file and dir GC candidates.\n+   */\n+  default void putGcFdCandidates(TableId tableId, Collection<String> candidates) {\n+    throw new UnsupportedOperationException();\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA2ODY4NQ=="}, "originalCommit": {"oid": "02a6edb3446324c5e1a9f57bdc2f612e7da9392c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM1NDk5OA==", "bodyText": "Yeah Fd meant file and dirs.  I can change it to FileOrDirs.  The existing method is more strongly typed, so it probably does not need File in the name.", "url": "https://github.com/apache/accumulo/pull/1762#discussion_r516354998", "createdAt": "2020-11-03T00:18:04Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/metadata/schema/Ample.java", "diffHunk": "@@ -144,6 +144,13 @@ default void putGcCandidates(TableId tableId, Collection<StoredTabletFile> candi\n     throw new UnsupportedOperationException();\n   }\n \n+  /**\n+   * Unlike {@link #putGcCandidates(TableId, Collection)} this takes file and dir GC candidates.\n+   */\n+  default void putGcFdCandidates(TableId tableId, Collection<String> candidates) {\n+    throw new UnsupportedOperationException();\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA2ODY4NQ=="}, "originalCommit": {"oid": "02a6edb3446324c5e1a9f57bdc2f612e7da9392c"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjM2MjMxMw==", "bodyText": "I changed the name in d259836", "url": "https://github.com/apache/accumulo/pull/1762#discussion_r516362313", "createdAt": "2020-11-03T00:34:10Z", "author": {"login": "keith-turner"}, "path": "core/src/main/java/org/apache/accumulo/core/metadata/schema/Ample.java", "diffHunk": "@@ -144,6 +144,13 @@ default void putGcCandidates(TableId tableId, Collection<StoredTabletFile> candi\n     throw new UnsupportedOperationException();\n   }\n \n+  /**\n+   * Unlike {@link #putGcCandidates(TableId, Collection)} this takes file and dir GC candidates.\n+   */\n+  default void putGcFdCandidates(TableId tableId, Collection<String> candidates) {\n+    throw new UnsupportedOperationException();\n+  }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA2ODY4NQ=="}, "originalCommit": {"oid": "02a6edb3446324c5e1a9f57bdc2f612e7da9392c"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4090, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}