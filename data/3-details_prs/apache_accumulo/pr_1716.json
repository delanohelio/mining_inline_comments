{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0MzIxNzQw", "number": 1716, "title": "Update tool.sh to set correct ZOOKEEPER_CMD.", "bodyText": "ZooKeeper changed directory structure between versions 3.4 and 3.5. This update corrects tool.sh script to set the correct ZooKeeper command depending upon version used.", "createdAt": "2020-09-28T18:21:23Z", "url": "https://github.com/apache/accumulo/pull/1716", "merged": true, "mergeCommit": {"oid": "c21396d8226ca5d0ab5af96a9703e4b5bfdd44cc"}, "closed": true, "closedAt": "2020-09-28T19:44:14Z", "author": {"login": "jmark99"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNW4_ugH2gAyNDk0MzIxNzQwOmIyYjIyOWNjZTcxNjI0MjQ0ZWRmOTg1MGM5ZTI5ODdiMzcxYjhiMTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNY6f0AFqTQ5NzgzOTAzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b2b229cce71624244edf9850c9e2987b371b8b14", "author": {"user": {"login": "jmark99", "name": "Mark Owens"}}, "url": "https://github.com/apache/accumulo/commit/b2b229cce71624244edf9850c9e2987b371b8b14", "committedDate": "2020-09-28T17:18:25Z", "message": "Update tool.sh to set correct ZOOKEEPER_CMD.\n\nZooKeeper changed directory structure between versions 3.4 and 3.5. This\nupdate sets the correct ZooKeeper depending upon version used."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b755611f3afc9b706dae3147af9c40b1b3dbad5", "author": {"user": {"login": "jmark99", "name": "Mark Owens"}}, "url": "https://github.com/apache/accumulo/commit/7b755611f3afc9b706dae3147af9c40b1b3dbad5", "committedDate": "2020-09-28T18:18:51Z", "message": "Update tool.sh to set correct ZOOKEEPER_CMD.\n\nRemoved duplicate export line."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3ODE0MzM3", "url": "https://github.com/apache/accumulo/pull/1716#pullrequestreview-497814337", "createdAt": "2020-09-28T19:02:11Z", "commit": {"oid": "7b755611f3afc9b706dae3147af9c40b1b3dbad5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxOTowMjoxMlrOHZLv9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yOFQxOTowMjoxMlrOHZLv9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjE2ODk1MQ==", "bodyText": "I find the regex pattern matching feature of bash to be more reliable than the glob equality feature. Also, the quotes and braces on the left side aren't neeeded.\nHowever, a more fundamental problem: where is ZOOKEEPER_VERSION defined? There is no guarantee it is defined anywhere by anything that calls this script. It should probably do something like what assemble/bin/start-all.sh does.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            if [[ \"${ZOOKEEPER_VERSION}\" = 3.[01234].* ]]; then\n          \n          \n            \n            ZOOKEEPER_VERSION=$(find -L \"$ZOOKEEPER_HOME\" -maxdepth 2 -name \"zookeeper-[0-9]*.jar\" | head -1)\n          \n          \n            \n            if [[ $ZOOKEEPER_VERSION =~ ^3[.][01234].*$ ]]; then", "url": "https://github.com/apache/accumulo/pull/1716#discussion_r496168951", "createdAt": "2020-09-28T19:02:12Z", "author": {"login": "ctubbsii"}, "path": "assemble/bin/tool.sh", "diffHunk": "@@ -36,7 +36,10 @@ if [[ -z \"$ZOOKEEPER_HOME\" ]] ; then\n    exit 1\n fi\n \n-ZOOKEEPER_CMD='ls -1 $ZOOKEEPER_HOME/zookeeper-[0-9]*[^csn].jar '\n+ZOOKEEPER_CMD='ls -1 $ZOOKEEPER_HOME/lib/zookeeper-[0-9]*[^csn].jar '\n+if [[ \"${ZOOKEEPER_VERSION}\" = 3.[01234].* ]]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b755611f3afc9b706dae3147af9c40b1b3dbad5"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b7209f34a02553da5de8f427e0ea1da6056ea527", "author": {"user": {"login": "jmark99", "name": "Mark Owens"}}, "url": "https://github.com/apache/accumulo/commit/b7209f34a02553da5de8f427e0ea1da6056ea527", "committedDate": "2020-09-28T19:23:14Z", "message": "Update assemble/bin/tool.sh\r\n\r\nAdd suggested change to guarantee ZOOKEEPER_VERSION is defined. Also update to use regex pattern checking for version.\n\nCo-authored-by: Christopher Tubbs <ctubbsii@apache.org>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk3ODM5MDMy", "url": "https://github.com/apache/accumulo/pull/1716#pullrequestreview-497839032", "createdAt": "2020-09-28T19:39:52Z", "commit": {"oid": "b7209f34a02553da5de8f427e0ea1da6056ea527"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1727, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}