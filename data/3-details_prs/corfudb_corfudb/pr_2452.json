{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxNTk0MjYw", "number": 2452, "title": "Thread Clean Up", "bodyText": "Overview\nDescription:\nWhy should this be merged:\nRelated issue(s) (if applicable): #\nChecklist (Definition of Done):\n\n There are no TODOs left in the code\n Coding conventions (e.g. for logging, unit tests) have been followed\n Change is covered by automated tests\n Public API has Javadoc", "createdAt": "2020-02-28T21:04:11Z", "url": "https://github.com/CorfuDB/CorfuDB/pull/2452", "merged": true, "mergeCommit": {"oid": "2ddd7a54e847c135bd4b867596c389aca92c3d1f"}, "closed": true, "closedAt": "2020-02-29T02:22:56Z", "author": {"login": "Maithem"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcI3GPIAH2gAyMzgxNTk0MjYwOjY0Zjg0ZGQxMGI5YjMyNzdjOWJhZDNiM2VlZWU4ZTBjNjEzZDI2NmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcI6nIrgFqTM2Njc2NzY5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "64f84dd10b9b3277c9bad3b3eeee8e0c613d266c", "author": {"user": {"login": "Maithem", "name": "Maithem"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/64f84dd10b9b3277c9bad3b3eeee8e0c613d266c", "committedDate": "2020-02-28T21:49:04Z", "message": "Netty EventLoopGroup Memory Leak\n\nShutdown netty thread pool after its no longed needed."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5e6a9678d1b6d8e1d6cf48d65585e7c3f36621e1", "author": {"user": {"login": "Maithem", "name": "Maithem"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/5e6a9678d1b6d8e1d6cf48d65585e7c3f36621e1", "committedDate": "2020-02-28T21:03:40Z", "message": "Thread Clean Up"}, "afterCommit": {"oid": "64f84dd10b9b3277c9bad3b3eeee8e0c613d266c", "author": {"user": {"login": "Maithem", "name": "Maithem"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/64f84dd10b9b3277c9bad3b3eeee8e0c613d266c", "committedDate": "2020-02-28T21:49:04Z", "message": "Netty EventLoopGroup Memory Leak\n\nShutdown netty thread pool after its no longed needed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NzYxNDIz", "url": "https://github.com/CorfuDB/CorfuDB/pull/2452#pullrequestreview-366761423", "createdAt": "2020-02-29T00:59:13Z", "commit": {"oid": "64f84dd10b9b3277c9bad3b3eeee8e0c613d266c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQwMDo1OToxM1rOFwGoBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQwMDo1OToxM1rOFwGoBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk4NDUxNg==", "bodyText": "Can we remove the manageEventLoop flag, and set the eventLoopGroup field in this contructor only? Then in close() we can simply check if eventLoopGroup is null and close it it not null.", "url": "https://github.com/CorfuDB/CorfuDB/pull/2452#discussion_r385984516", "createdAt": "2020-02-29T00:59:13Z", "author": {"login": "WenbinZhu"}, "path": "runtime/src/main/java/org/corfudb/runtime/clients/NettyClientRouter.java", "diffHunk": "@@ -672,11 +680,11 @@ public NettyClientRouter(String host, Integer port, Boolean tls,\n     public NettyClientRouter(@Nonnull NodeLocator node,\n         @Nonnull CorfuRuntimeParameters parameters) {\n         this(node, parameters.getSocketType()\n-            .getGenerator().generate(Runtime.getRuntime().availableProcessors() * 2,\n+            .getGenerator().generate(parameters.getNettyEventLoopThreads(),\n                 new ThreadFactoryBuilder()\n                     .setDaemon(true)\n                     .setNameFormat(parameters.getNettyEventLoopThreadFormat())\n-                    .build()), parameters);\n+                    .build()), parameters, true);\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64f84dd10b9b3277c9bad3b3eeee8e0c613d266c"}, "originalPosition": 92}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NzY3Njk0", "url": "https://github.com/CorfuDB/CorfuDB/pull/2452#pullrequestreview-366767694", "createdAt": "2020-02-29T01:54:43Z", "commit": {"oid": "64f84dd10b9b3277c9bad3b3eeee8e0c613d266c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3352, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}