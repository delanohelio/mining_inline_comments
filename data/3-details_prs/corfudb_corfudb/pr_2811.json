{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0NDI3MTMz", "number": 2811, "title": "CICD workflow: fix flaky CorfuStoreShimTest#checkRevisionValidation", "bodyText": "Overview\nDescription:\nfix flaky CorfuStoreShimTest#checkRevisionValidation\nWhy should this be merged:\nRelated issue(s) (if applicable): #\nChecklist (Definition of Done):\n\n There are no TODOs left in the code\n Coding conventions (e.g. for logging, unit tests) have been followed\n Change is covered by automated tests\n Public API has Javadoc", "createdAt": "2020-11-03T01:29:36Z", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811", "merged": true, "mergeCommit": {"oid": "afb518b586fd8d4a336a800e6edd48c291ea761a"}, "closed": true, "closedAt": "2020-11-05T20:46:53Z", "author": {"login": "xnull"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYu4HwgH2gAyNTE0NDI3MTMzOmFlZTE3ZGEzZjQxN2EzMThiYTE1ZmI4OGJhY2RlYmZhYTU5ZDg3NTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZn8V8gFqTUyNDYxOTI3Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "aee17da3f417a318ba15fb88bacdebfaa59d8751", "author": {"user": {"login": "xnull", "name": "Viacheslav"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/aee17da3f417a318ba15fb88bacdebfaa59d8751", "committedDate": "2020-11-03T01:28:21Z", "message": "CICD workflow: fix flaky CorfuStoreShimTest#checkRevisionValidation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f56a318601302defe4dd2985214d3a9cfeb3724", "author": {"user": {"login": "xnull", "name": "Viacheslav"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/2f56a318601302defe4dd2985214d3a9cfeb3724", "committedDate": "2020-11-03T02:13:27Z", "message": "Merge branch 'master' into cicd-corfu-store-shim-test-flakyness"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMTcxNzAx", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#pullrequestreview-522171701", "createdAt": "2020-11-03T03:33:04Z", "commit": {"oid": "2f56a318601302defe4dd2985214d3a9cfeb3724"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwMzozMzowNFrOHsfPhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwMzozMzowNFrOHsfPhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQxMTI3MA==", "bodyText": "Maybe consider using .isLessThanOrEqualTo() instead?", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#discussion_r516411270", "createdAt": "2020-11-03T03:33:04Z", "author": {"login": "zfrenette"}, "path": "test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java", "diffHunk": "@@ -248,7 +249,7 @@ public void checkRevisionValidation() throws Exception {\n         }\n         assertThat(entry.getMetadata().getRevision()).isEqualTo(2L);\n         assertThat(entry.getMetadata().getCreateUser()).isEqualTo(\"user_1\");\n-        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis());\n+        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis() + 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f56a318601302defe4dd2985214d3a9cfeb3724"}, "originalPosition": 78}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMTk0ODc3", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#pullrequestreview-522194877", "createdAt": "2020-11-03T05:19:28Z", "commit": {"oid": "2f56a318601302defe4dd2985214d3a9cfeb3724"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwNToxOToyOFrOHsgjiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QwNToxOToyOFrOHsgjiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQzMjc3Nw==", "bodyText": "Please add a comment on why you are comparing with a future timestamp. I believe you did it to avoid having to sleep() which I think is a great idea, but would be good to document.", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#discussion_r516432777", "createdAt": "2020-11-03T05:19:28Z", "author": {"login": "hisundar"}, "path": "test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java", "diffHunk": "@@ -248,7 +249,7 @@ public void checkRevisionValidation() throws Exception {\n         }\n         assertThat(entry.getMetadata().getRevision()).isEqualTo(2L);\n         assertThat(entry.getMetadata().getCreateUser()).isEqualTo(\"user_1\");\n-        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis());\n+        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis() + 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f56a318601302defe4dd2985214d3a9cfeb3724"}, "originalPosition": 78}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyMTk0OTM5", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#pullrequestreview-522194939", "createdAt": "2020-11-03T05:19:42Z", "commit": {"oid": "2f56a318601302defe4dd2985214d3a9cfeb3724"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7194e72aeb0ed7f1126742f415c730459eb9ea6", "author": {"user": {"login": "xnull", "name": "Viacheslav"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/c7194e72aeb0ed7f1126742f415c730459eb9ea6", "committedDate": "2020-11-04T20:39:52Z", "message": "Merge branch 'master' into cicd-corfu-store-shim-test-flakyness"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NjE3ODA2", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#pullrequestreview-524617806", "createdAt": "2020-11-05T19:55:22Z", "commit": {"oid": "c7194e72aeb0ed7f1126742f415c730459eb9ea6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NjE5Mjc2", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#pullrequestreview-524619276", "createdAt": "2020-11-05T19:57:21Z", "commit": {"oid": "c7194e72aeb0ed7f1126742f415c730459eb9ea6"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxOTo1NzoyMVrOHuUOkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxOTo1NzoyMVrOHuUOkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODMyNzk1Mg==", "bodyText": "@xnull The change to isLessThanOrEqualTo() did not take effect in the patch", "url": "https://github.com/CorfuDB/CorfuDB/pull/2811#discussion_r518327952", "createdAt": "2020-11-05T19:57:21Z", "author": {"login": "WenbinZhu"}, "path": "test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java", "diffHunk": "@@ -248,7 +249,7 @@ public void checkRevisionValidation() throws Exception {\n         }\n         assertThat(entry.getMetadata().getRevision()).isEqualTo(2L);\n         assertThat(entry.getMetadata().getCreateUser()).isEqualTo(\"user_1\");\n-        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis());\n+        assertThat(entry.getMetadata().getLastModifiedTime()).isLessThan(System.currentTimeMillis() + 1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjQxMTI3MA=="}, "originalCommit": {"oid": "2f56a318601302defe4dd2985214d3a9cfeb3724"}, "originalPosition": 78}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4125, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}