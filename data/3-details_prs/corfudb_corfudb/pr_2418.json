{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2ODk2NjM4", "number": 2418, "title": "Runtime: exit systemDownHandler on WrongClusterException", "bodyText": "Overview\nDescription:\nUnblock systemDownHandler if WrongClusterException\nWhy should this be merged:\nIf a node has been added to a cluster the existing\nclients should exit early so they can be restarted.\nCurrently they just spin in systemDownHandler.\nRelated issue(s) (if applicable): #2409\nChecklist (Definition of Done):\n\n There are no TODOs left in the code\n Coding conventions (e.g. for logging, unit tests) have been followed\n Change is covered by automated tests\n Public API has Javadoc", "createdAt": "2020-02-19T00:01:38Z", "url": "https://github.com/CorfuDB/CorfuDB/pull/2418", "merged": true, "mergeCommit": {"oid": "3ffa73637c6a7233b4139e8699c9ec6718bfe78a"}, "closed": true, "closedAt": "2020-03-04T22:21:16Z", "author": {"login": "hisundar"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcFrCVJABqjMwNDk1NjI5MTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKcX9NAH2gAyMzc2ODk2NjM4OjNiMTVlMjQzNDVjOTEzOWU4NDlmYmMwOGU3ODIyNjAyMTA2NzViODY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d894e38ca944961b9be2cc2eebb68518bdc2a6e5", "author": {"user": {"login": "hisundar", "name": "Sundar Sridharan"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/d894e38ca944961b9be2cc2eebb68518bdc2a6e5", "committedDate": "2020-02-19T00:00:20Z", "message": "Runtime: exit systemDownHandler on WrongEpochException"}, "afterCommit": {"oid": "f3a3b3ed470e2ee274631182aa2bc320374270fb", "author": {"user": {"login": "hisundar", "name": "Sundar Sridharan"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/f3a3b3ed470e2ee274631182aa2bc320374270fb", "committedDate": "2020-02-19T00:02:32Z", "message": "Runtime: exit systemDownHandler on WrongClusterException\n\nIf a node has been added to a cluster the existing\nclients should exit early so they can be restarted.\nCurrently they just spin in systemDownHandler."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNzYyMTc0", "url": "https://github.com/CorfuDB/CorfuDB/pull/2418#pullrequestreview-360762174", "createdAt": "2020-02-19T00:07:10Z", "commit": {"oid": "f3a3b3ed470e2ee274631182aa2bc320374270fb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNzYzODM4", "url": "https://github.com/CorfuDB/CorfuDB/pull/2418#pullrequestreview-360763838", "createdAt": "2020-02-19T00:12:13Z", "commit": {"oid": "f3a3b3ed470e2ee274631182aa2bc320374270fb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQwMDoxMjoxM1rOFrXADw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQwMDoxMjoxM1rOFrXADw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTAwOTkzNQ==", "bodyText": "Doesn't AbstractView have the same issue ?", "url": "https://github.com/CorfuDB/CorfuDB/pull/2418#discussion_r381009935", "createdAt": "2020-02-19T00:12:13Z", "author": {"login": "Maithem"}, "path": "runtime/src/main/java/org/corfudb/runtime/CorfuRuntime.java", "diffHunk": "@@ -982,6 +982,9 @@ private void pruneRemovedRouters(@Nonnull Layout layout) {\n                     } catch (InterruptedException ie) {\n                         throw new UnrecoverableCorfuInterruptedError(\n                                 \"Interrupted during layout fetch\", ie);\n+                    } catch (WrongClusterException we) {\n+                        // It is futile trying to re-connect to the wrong cluster\n+                        throw new UnrecoverableCorfuError(\"WrongClusterException:\", we);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3a3b3ed470e2ee274631182aa2bc320374270fb"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYwNzY0MjIz", "url": "https://github.com/CorfuDB/CorfuDB/pull/2418#pullrequestreview-360764223", "createdAt": "2020-02-19T00:13:22Z", "commit": {"oid": "f3a3b3ed470e2ee274631182aa2bc320374270fb"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "338cea7217fef7fe66951f5966b51db5b0e3ecaf", "author": {"user": {"login": "hisundar", "name": "Sundar Sridharan"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/338cea7217fef7fe66951f5966b51db5b0e3ecaf", "committedDate": "2020-02-21T21:08:30Z", "message": "Runtime: exit systemDownHandler on WrongClusterException\n\nIf a node has been added to a cluster the existing\nclients should exit early so they can be restarted.\nCurrently they just spin in systemDownHandler.\nReduce the ignoreTrimmedException to debug level."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f3a3b3ed470e2ee274631182aa2bc320374270fb", "author": {"user": {"login": "hisundar", "name": "Sundar Sridharan"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/f3a3b3ed470e2ee274631182aa2bc320374270fb", "committedDate": "2020-02-19T00:02:32Z", "message": "Runtime: exit systemDownHandler on WrongClusterException\n\nIf a node has been added to a cluster the existing\nclients should exit early so they can be restarted.\nCurrently they just spin in systemDownHandler."}, "afterCommit": {"oid": "338cea7217fef7fe66951f5966b51db5b0e3ecaf", "author": {"user": {"login": "hisundar", "name": "Sundar Sridharan"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/338cea7217fef7fe66951f5966b51db5b0e3ecaf", "committedDate": "2020-02-21T21:08:30Z", "message": "Runtime: exit systemDownHandler on WrongClusterException\n\nIf a node has been added to a cluster the existing\nclients should exit early so they can be restarted.\nCurrently they just spin in systemDownHandler.\nReduce the ignoreTrimmedException to debug level."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2bd3e93e690d6e76c748b3f5c70b9f71a8a9dedc", "author": {"user": {"login": "Maithem", "name": "Maithem"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/2bd3e93e690d6e76c748b3f5c70b9f71a8a9dedc", "committedDate": "2020-02-25T22:02:59Z", "message": "Merge branch 'master' into exitOnWrongEpoch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5594f87f2db06e8b459b8271d734d1e3b09365e", "author": {"user": {"login": "hisundar", "name": "Sundar Sridharan"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/d5594f87f2db06e8b459b8271d734d1e3b09365e", "committedDate": "2020-03-02T19:41:34Z", "message": "Merge branch 'master' into exitOnWrongEpoch"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY3NTA3NjAy", "url": "https://github.com/CorfuDB/CorfuDB/pull/2418#pullrequestreview-367507602", "createdAt": "2020-03-02T20:34:42Z", "commit": {"oid": "d5594f87f2db06e8b459b8271d734d1e3b09365e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a213aa9ec6cc0cbcd981b418f102bdc95ee1a02e", "author": {"user": {"login": "hisundar", "name": "Sundar Sridharan"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/a213aa9ec6cc0cbcd981b418f102bdc95ee1a02e", "committedDate": "2020-03-04T00:59:48Z", "message": "Merge branch 'master' into exitOnWrongEpoch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b15e24345c9139e849fbc08e782260210675b86", "author": {"user": {"login": "hisundar", "name": "Sundar Sridharan"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/3b15e24345c9139e849fbc08e782260210675b86", "committedDate": "2020-03-04T19:48:50Z", "message": "Merge branch 'master' into exitOnWrongEpoch"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3345, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}