{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3MDI4OTM4", "number": 2820, "title": "CorfuStore streaming redesign part 2 - txn stream tagging support.", "bodyText": "Overview\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\nCo-authored-by: pankti-m pmajmudar@vmware.com\nRelated issue(s) (if applicable): #\nChecklist (Definition of Done):\n\n There are no TODOs left in the code\n Coding conventions (e.g. for logging, unit tests) have been followed\n Change is covered by automated tests\n Public API has Javadoc", "createdAt": "2020-11-06T23:36:45Z", "url": "https://github.com/CorfuDB/CorfuDB/pull/2820", "merged": true, "mergeCommit": {"oid": "a60fcaeadc115cf4cd0826a5262514bff93a6a29"}, "closed": true, "closedAt": "2020-11-19T05:32:14Z", "author": {"login": "WenbinZhu"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdawe68gBqjM5NzI0NjQ4NDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddhLcEABqjQwMDc3OTQ5NzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4d3e38f873c61453ea72e0bbfe9582023b396fae", "author": {"user": {"login": "WenbinZhu", "name": "Wenbin Zhu"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/4d3e38f873c61453ea72e0bbfe9582023b396fae", "committedDate": "2020-11-06T23:35:36Z", "message": "CorfuStore streaming redesign part 2 - txn stream tagging support.\n\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\n\nCo-authored-by: pankti-m <pmajmudar@vmware.com>"}, "afterCommit": {"oid": "4af3ba32f22b27142f8b46667e42bd599e891a4f", "author": {"user": {"login": "WenbinZhu", "name": "Wenbin Zhu"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/4af3ba32f22b27142f8b46667e42bd599e891a4f", "committedDate": "2020-11-09T08:28:11Z", "message": "CorfuStore streaming redesign part 2 - txn stream tagging support.\n\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\n\nCo-authored-by: pankti-m <pmajmudar@vmware.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI2NzQyODI2", "url": "https://github.com/CorfuDB/CorfuDB/pull/2820#pullrequestreview-526742826", "createdAt": "2020-11-09T23:42:44Z", "commit": {"oid": "4af3ba32f22b27142f8b46667e42bd599e891a4f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQyMzo0Mjo0NFrOHwF_lg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQyMzo1NDoyOVrOHwGQqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDE5MTg5NA==", "bodyText": "why do we add the stream tags only if transaction logging is enabled?", "url": "https://github.com/CorfuDB/CorfuDB/pull/2820#discussion_r520191894", "createdAt": "2020-11-09T23:42:44Z", "author": {"login": "pankti-m"}, "path": "runtime/src/main/java/org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.java", "diffHunk": "@@ -244,10 +236,13 @@ public long getConflictSetAndCommit(ConflictSetInfo conflictSet) {\n             return NOWRITE_ADDRESS;\n         }\n \n-        // Write to the transaction stream if transaction logging is enabled\n-        Set<UUID> affectedStreamsIds = new HashSet<>(getWriteSetInfo().getWriteSet().getEntryMap().keySet());\n+        Set<UUID> affectedStreamsIds = new HashSet<>(getWriteSetInfo()\n+                .getWriteSet().getEntryMap().keySet());\n \n-        if (this.transaction.isLoggingEnabled()) {\n+        // Write to transaction streams if transaction logging is enabled.\n+        if (transaction.isLoggingEnabled()) {\n+            affectedStreamsIds.addAll(getWriteSetInfo().getStreamTags());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4af3ba32f22b27142f8b46667e42bd599e891a4f"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDE5NjI2NA==", "bodyText": "do we need to provide both this and the below interface?", "url": "https://github.com/CorfuDB/CorfuDB/pull/2820#discussion_r520196264", "createdAt": "2020-11-09T23:54:29Z", "author": {"login": "pankti-m"}, "path": "runtime/src/main/java/org/corfudb/runtime/view/SMRObject.java", "diffHunk": "@@ -107,13 +114,23 @@ private void verify() {\n             return this;\n         }\n \n+        public SMRObject.Builder<T> setStreamTags(Set<UUID> tags) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4af3ba32f22b27142f8b46667e42bd599e891a4f"}, "originalPosition": 32}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4af3ba32f22b27142f8b46667e42bd599e891a4f", "author": {"user": {"login": "WenbinZhu", "name": "Wenbin Zhu"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/4af3ba32f22b27142f8b46667e42bd599e891a4f", "committedDate": "2020-11-09T08:28:11Z", "message": "CorfuStore streaming redesign part 2 - txn stream tagging support.\n\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\n\nCo-authored-by: pankti-m <pmajmudar@vmware.com>"}, "afterCommit": {"oid": "817e8054434fe69692abb7591e5784d6a5948714", "author": {"user": {"login": "WenbinZhu", "name": "Wenbin Zhu"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/817e8054434fe69692abb7591e5784d6a5948714", "committedDate": "2020-11-10T02:51:58Z", "message": "CorfuStore streaming redesign part 2 - txn stream tagging support.\n\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\n\nCo-authored-by: pankti-m <pmajmudar@vmware.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "817e8054434fe69692abb7591e5784d6a5948714", "author": {"user": {"login": "WenbinZhu", "name": "Wenbin Zhu"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/817e8054434fe69692abb7591e5784d6a5948714", "committedDate": "2020-11-10T02:51:58Z", "message": "CorfuStore streaming redesign part 2 - txn stream tagging support.\n\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\n\nCo-authored-by: pankti-m <pmajmudar@vmware.com>"}, "afterCommit": {"oid": "72d22d984afd32b55cb85cbe237d17ee74b51653", "author": {"user": {"login": "WenbinZhu", "name": "Wenbin Zhu"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/72d22d984afd32b55cb85cbe237d17ee74b51653", "committedDate": "2020-11-10T22:33:28Z", "message": "CorfuStore streaming redesign part 2 - txn stream tagging support.\n\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\n\nCo-authored-by: pankti-m <pmajmudar@vmware.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5ODM1MjI1", "url": "https://github.com/CorfuDB/CorfuDB/pull/2820#pullrequestreview-529835225", "createdAt": "2020-11-13T07:49:07Z", "commit": {"oid": "72d22d984afd32b55cb85cbe237d17ee74b51653"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMwNTU0NTIz", "url": "https://github.com/CorfuDB/CorfuDB/pull/2820#pullrequestreview-530554523", "createdAt": "2020-11-14T04:51:15Z", "commit": {"oid": "72d22d984afd32b55cb85cbe237d17ee74b51653"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNzc3MjYz", "url": "https://github.com/CorfuDB/CorfuDB/pull/2820#pullrequestreview-532777263", "createdAt": "2020-11-17T20:19:29Z", "commit": {"oid": "72d22d984afd32b55cb85cbe237d17ee74b51653"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fa42e6f1eefbc68f92cc76abb5eacadedc40aa97", "author": {"user": {"login": "WenbinZhu", "name": "Wenbin Zhu"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/fa42e6f1eefbc68f92cc76abb5eacadedc40aa97", "committedDate": "2020-11-17T22:20:07Z", "message": "CorfuStore streaming redesign part 2 - txn stream tagging support.\n\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\n\nCo-authored-by: pankti-m <pmajmudar@vmware.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "72d22d984afd32b55cb85cbe237d17ee74b51653", "author": {"user": {"login": "WenbinZhu", "name": "Wenbin Zhu"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/72d22d984afd32b55cb85cbe237d17ee74b51653", "committedDate": "2020-11-10T22:33:28Z", "message": "CorfuStore streaming redesign part 2 - txn stream tagging support.\n\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\n\nCo-authored-by: pankti-m <pmajmudar@vmware.com>"}, "afterCommit": {"oid": "fa42e6f1eefbc68f92cc76abb5eacadedc40aa97", "author": {"user": {"login": "WenbinZhu", "name": "Wenbin Zhu"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/fa42e6f1eefbc68f92cc76abb5eacadedc40aa97", "committedDate": "2020-11-17T22:20:07Z", "message": "CorfuStore streaming redesign part 2 - txn stream tagging support.\n\nIntroducing transaction stream tagging that adds a stream tag option\nwhen opening corfu obejcts, which will later be used to send\ntransactional updates to crresponding transaction streams when\ntransactions commit.\n\nCo-authored-by: pankti-m <pmajmudar@vmware.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4137, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}