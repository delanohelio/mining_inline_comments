{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1NjExMTk0", "number": 2842, "title": "Use Writer Thread for Cache Eviction", "bodyText": "Overview\nIf unspecified Caffeine will use the common thread pool to execute\nits cache eviction logic, this can be confusing when debugging\nand it causes multiple threads to \"spin up\" since it uses a\nforkjoin pool. This patch makes the writing thread do the eviction.\nWhy should this be merged: Reduces the number of threads\nRelated issue(s) (if applicable): clone of #2460\nChecklist (Definition of Done):\n\n There are no TODOs left in the code\n Coding conventions (e.g. for logging, unit tests) have been followed\n Change is covered by automated tests\n Public API has Javadoc", "createdAt": "2020-12-10T03:30:29Z", "url": "https://github.com/CorfuDB/CorfuDB/pull/2842", "merged": true, "mergeCommit": {"oid": "400caaf9cab44bbf7821b791b88f274498aff708"}, "closed": true, "closedAt": "2020-12-10T22:27:06Z", "author": {"login": "Maithem"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkq3dhAH2gAyNTM1NjExMTk0OmQ2M2IzYzZlMTA5ODQzMDVjZTI2OGQ1ZWQxYjYxMTlmOTgwNjU5MDk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdk69qIgFqTU0OTY1MTA1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d63b3c6e10984305ce268d5ed1b6119f98065909", "author": {"user": {"login": "Maithem", "name": "Maithem"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/d63b3c6e10984305ce268d5ed1b6119f98065909", "committedDate": "2020-12-10T03:35:06Z", "message": "Use Writer Thread For Eviction\n\nIf unspecified Caffeine will use the common thread pool to execute\nits cache eviction logic, this can be confusing when debugging\nand it causes multiple threads to \"spin up\" since it uses a\nforkjoin pool. This patch makes the writing thread do the eviction."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b1e10d78cfd7dd8fd05591b33fdc407d3a972206", "author": {"user": {"login": "Maithem", "name": "Maithem"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/b1e10d78cfd7dd8fd05591b33fdc407d3a972206", "committedDate": "2020-12-10T03:29:05Z", "message": "Use Writer Thread for Cache Eviction\n\nIf unspecified Caffeine will use the common thread pool to execute\nits cache eviction logic, this can be confusing when debugging\nand it causes multiple threads to \"spin up\" since it uses a\nforkjoin pool. This patch makes the writing thread do the eviction."}, "afterCommit": {"oid": "d63b3c6e10984305ce268d5ed1b6119f98065909", "author": {"user": {"login": "Maithem", "name": "Maithem"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/d63b3c6e10984305ce268d5ed1b6119f98065909", "committedDate": "2020-12-10T03:35:06Z", "message": "Use Writer Thread For Eviction\n\nIf unspecified Caffeine will use the common thread pool to execute\nits cache eviction logic, this can be confusing when debugging\nand it causes multiple threads to \"spin up\" since it uses a\nforkjoin pool. This patch makes the writing thread do the eviction."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4df1a85005420b328ff58b94afd6b3a58f5a53e9", "author": {"user": {"login": "Maithem", "name": "Maithem"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/4df1a85005420b328ff58b94afd6b3a58f5a53e9", "committedDate": "2020-12-10T05:07:34Z", "message": "Merge branch 'master' into moveExecutor2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4ODg4MTQ4", "url": "https://github.com/CorfuDB/CorfuDB/pull/2842#pullrequestreview-548888148", "createdAt": "2020-12-10T06:30:04Z", "commit": {"oid": "4df1a85005420b328ff58b94afd6b3a58f5a53e9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NjQyOTk0", "url": "https://github.com/CorfuDB/CorfuDB/pull/2842#pullrequestreview-549642994", "createdAt": "2020-12-10T22:07:39Z", "commit": {"oid": "4df1a85005420b328ff58b94afd6b3a58f5a53e9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NjUxMDUz", "url": "https://github.com/CorfuDB/CorfuDB/pull/2842#pullrequestreview-549651053", "createdAt": "2020-12-10T22:20:21Z", "commit": {"oid": "4df1a85005420b328ff58b94afd6b3a58f5a53e9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMjoyMDoyMVrOIDf6XQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQyMjoyMDoyMVrOIDf6XQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDUzOTQ4NQ==", "bodyText": "Noteworthy : #2460 (comment)", "url": "https://github.com/CorfuDB/CorfuDB/pull/2842#discussion_r540539485", "createdAt": "2020-12-10T22:20:21Z", "author": {"login": "Maithem"}, "path": "infrastructure/src/main/java/org/corfudb/infrastructure/LogUnitServerCache.java", "diffHunk": "@@ -55,6 +55,7 @@ public LogUnitServerCache(LogUnitServerConfig config, StreamLog streamLog) {\n                 .<Long, ILogData>weigher((addr, logData) -> getLogDataTotalSize(logData))\n                 .maximumWeight(config.getMaxCacheSize())\n                 .recordStats()\n+                .executor(Runnable::run)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4df1a85005420b328ff58b94afd6b3a58f5a53e9"}, "originalPosition": 34}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3980, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}