{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMxOTc4NTk2", "number": 2838, "title": "Shorten the logging of Protobuf Messages", "bodyText": "It produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines.\nOverview\nDescription:\nWhy should this be merged:\nRelated issue(s) (if applicable): #\nChecklist (Definition of Done):\n\n There are no TODOs left in the code\n Coding conventions (e.g. for logging, unit tests) have been followed\n Change is covered by automated tests\n Public API has Javadoc", "createdAt": "2020-12-03T18:09:36Z", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838", "merged": true, "mergeCommit": {"oid": "106c423146fb853e354961690fefe5df4357e74b"}, "closed": true, "closedAt": "2020-12-15T03:47:51Z", "author": {"login": "xcchang"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdinvR6ABqjQwNjkxMjMyMjg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdmPDESgBqjQxMTE5NDkxNjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e8158f7f205d5a735a5c13cbbc43f2be10df3009", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/e8158f7f205d5a735a5c13cbbc43f2be10df3009", "committedDate": "2020-12-03T18:06:10Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}, "afterCommit": {"oid": "d1f284fe56bca5c4d3e8f79509d923bb2ed0bf9a", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/d1f284fe56bca5c4d3e8f79509d923bb2ed0bf9a", "committedDate": "2020-12-03T18:48:25Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0Mjk4MjI1", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#pullrequestreview-544298225", "createdAt": "2020-12-03T19:16:16Z", "commit": {"oid": "d1f284fe56bca5c4d3e8f79509d923bb2ed0bf9a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOToxNjoxNlrOH-s_9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOToxNjoxNlrOH-s_9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUxMTAzMQ==", "bodyText": "There's also an instance in validateClientId.", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#discussion_r535511031", "createdAt": "2020-12-03T19:16:16Z", "author": {"login": "zfrenette"}, "path": "runtime/src/main/java/org/corfudb/runtime/clients/NettyClientRouter.java", "diffHunk": "@@ -662,7 +663,7 @@ public void sendRequest(CorfuMessage.RequestPayloadMsg payload, long epoch,\n \n         // Write this message out on the channel\n         channel.writeAndFlush(request, channel.voidPromise());\n-        log.trace(\"Sent one-way request message: {}\", request.getHeader());\n+        log.trace(\"Sent one-way request message: {}\", TextFormat.shortDebugString(request.getHeader()));\n     }\n \n     /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1f284fe56bca5c4d3e8f79509d923bb2ed0bf9a"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MzA3NzM0", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#pullrequestreview-544307734", "createdAt": "2020-12-03T19:26:54Z", "commit": {"oid": "d1f284fe56bca5c4d3e8f79509d923bb2ed0bf9a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOToyNjo1NVrOH-tiaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wM1QxOToyNjo1NVrOH-tiaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUxOTg0OQ==", "bodyText": "There's a couple of instances in NettyCorfuMsgEncoder as well.", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#discussion_r535519849", "createdAt": "2020-12-03T19:26:55Z", "author": {"login": "zfrenette"}, "path": "runtime/src/main/java/org/corfudb/protocols/wireprotocol/ClientHandshakeHandler.java", "diffHunk": "@@ -1,5 +1,6 @@\n package org.corfudb.protocols.wireprotocol;\n \n+import com.google.protobuf.TextFormat;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d1f284fe56bca5c4d3e8f79509d923bb2ed0bf9a"}, "originalPosition": 3}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d1f284fe56bca5c4d3e8f79509d923bb2ed0bf9a", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/d1f284fe56bca5c4d3e8f79509d923bb2ed0bf9a", "committedDate": "2020-12-03T18:48:25Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}, "afterCommit": {"oid": "8dec4640f176933a18d38ff7fc59665fb6dad7ca", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/8dec4640f176933a18d38ff7fc59665fb6dad7ca", "committedDate": "2020-12-03T19:46:56Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MzQyMzY1", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#pullrequestreview-544342365", "createdAt": "2020-12-03T19:49:36Z", "commit": {"oid": "8dec4640f176933a18d38ff7fc59665fb6dad7ca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NDgyNjcy", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#pullrequestreview-544482672", "createdAt": "2020-12-03T21:50:57Z", "commit": {"oid": "8dec4640f176933a18d38ff7fc59665fb6dad7ca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NDgzNDI1", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#pullrequestreview-544483425", "createdAt": "2020-12-03T21:52:09Z", "commit": {"oid": "8dec4640f176933a18d38ff7fc59665fb6dad7ca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "95f836e68f1977b1d105276a7e6ad6e900b876e9", "author": {"user": {"login": "hisundar", "name": "Sundar Sridharan"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/95f836e68f1977b1d105276a7e6ad6e900b876e9", "committedDate": "2020-12-03T21:52:15Z", "message": "Merge branch 'master' into proto-fixlog"}, "afterCommit": {"oid": "833ea5f3ace2c09c4ad16b4debf7116c9f98b926", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/833ea5f3ace2c09c4ad16b4debf7116c9f98b926", "committedDate": "2020-12-07T19:48:10Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "833ea5f3ace2c09c4ad16b4debf7116c9f98b926", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/833ea5f3ace2c09c4ad16b4debf7116c9f98b926", "committedDate": "2020-12-07T19:48:10Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}, "afterCommit": {"oid": "8ed51693566fe9d3733a47599815713a3ecd22b8", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/8ed51693566fe9d3733a47599815713a3ecd22b8", "committedDate": "2020-12-14T23:05:54Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMDA1NzAy", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#pullrequestreview-552005702", "createdAt": "2020-12-15T00:08:42Z", "commit": {"oid": "8ed51693566fe9d3733a47599815713a3ecd22b8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMDowODo0MlrOIFyq2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMDowODo0MlrOIFyq2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjk0Mzk2MA==", "bodyText": "can you wrap this with a if (log.isTraceEnabled())", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#discussion_r542943960", "createdAt": "2020-12-15T00:08:42Z", "author": {"login": "Maithem"}, "path": "infrastructure/src/main/java/org/corfudb/infrastructure/IServerRouter.java", "diffHunk": "@@ -210,7 +211,8 @@ default void sendWrongEpochError(HeaderMsg requestHeader, ChannelHandlerContext\n         sendResponse(response, ctx);\n \n         log.trace(\"sendWrongEpochError[{}]: Incoming request received with wrong epoch, got {}, expected {}, \" +\n-                \"request was {}\", requestHeader.getRequestId(), requestHeader.getEpoch(), correctEpoch, requestHeader);\n+                \"request was {}\", requestHeader.getRequestId(), requestHeader.getEpoch(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ed51693566fe9d3733a47599815713a3ecd22b8"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMDA1Nzk2", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#pullrequestreview-552005796", "createdAt": "2020-12-15T00:08:58Z", "commit": {"oid": "8ed51693566fe9d3733a47599815713a3ecd22b8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMDowODo1OFrOIFyr8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMDowODo1OFrOIFyr8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjk0NDI0Mw==", "bodyText": "Here too.", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#discussion_r542944243", "createdAt": "2020-12-15T00:08:58Z", "author": {"login": "Maithem"}, "path": "infrastructure/src/main/java/org/corfudb/infrastructure/IServerRouter.java", "diffHunk": "@@ -225,7 +227,7 @@ default void sendNoBootstrapError(HeaderMsg requestHeader, ChannelHandlerContext\n         sendResponse(response, ctx);\n \n         log.trace(\"sendNoBootstrapError[{}]: Received request but not bootstrapped! Request was {}\",\n-                requestHeader.getRequestId(), requestHeader);\n+                requestHeader.getRequestId(), TextFormat.shortDebugString(requestHeader));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ed51693566fe9d3733a47599815713a3ecd22b8"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMDA2NDA0", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#pullrequestreview-552006404", "createdAt": "2020-12-15T00:10:33Z", "commit": {"oid": "8ed51693566fe9d3733a47599815713a3ecd22b8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMDoxMDozM1rOIFywfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNVQwMDoxMDozM1rOIFywfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjk0NTQwNQ==", "bodyText": "This will be computed even if it wont be logged. I think its better shorten the string if trace is enabled.", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#discussion_r542945405", "createdAt": "2020-12-15T00:10:33Z", "author": {"login": "Maithem"}, "path": "runtime/src/main/java/org/corfudb/runtime/clients/NettyClientRouter.java", "diffHunk": "@@ -593,7 +594,7 @@ public void stop() {\n \n         // Write this message out on the channel\n         channel.writeAndFlush(request, channel.voidPromise());\n-        log.trace(\"Sent request message: {}\", request.getHeader());\n+        log.trace(\"Sent request message: {}\", TextFormat.shortDebugString(request.getHeader()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ed51693566fe9d3733a47599815713a3ecd22b8"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUyMDA2NjQ1", "url": "https://github.com/CorfuDB/CorfuDB/pull/2838#pullrequestreview-552006645", "createdAt": "2020-12-15T00:11:06Z", "commit": {"oid": "8ed51693566fe9d3733a47599815713a3ecd22b8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3b7b5759da8d35621005e1250f0d5755702029d", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/a3b7b5759da8d35621005e1250f0d5755702029d", "committedDate": "2020-12-15T00:18:06Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8ed51693566fe9d3733a47599815713a3ecd22b8", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/8ed51693566fe9d3733a47599815713a3ecd22b8", "committedDate": "2020-12-14T23:05:54Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}, "afterCommit": {"oid": "a3b7b5759da8d35621005e1250f0d5755702029d", "author": {"user": {"login": "xcchang", "name": "Xinyu (Chris) Chang"}}, "url": "https://github.com/CorfuDB/CorfuDB/commit/a3b7b5759da8d35621005e1250f0d5755702029d", "committedDate": "2020-12-15T00:18:06Z", "message": "Shorten the logging of Protobuf Messages\n\nIt produces lots of new lines when logging the Protobuf\nMessages. This modification helps to make things logged in a\ncleaner way without new lines."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4184, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}