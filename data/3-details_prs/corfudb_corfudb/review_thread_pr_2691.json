{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1NjU0ODY1", "number": 2691, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxODoxOTozMFrOEW6D6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxODoyNzo0NVrOEW6O1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyNDU1NDAwOnYy", "diffSide": "RIGHT", "path": "infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/infrastructure/CorfuInterClusterReplicationServer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxODoxOTozMFrOG-aEug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMTowMTozMVrOG-fqNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA5MjA5MA==", "bodyText": "can we move this to a flushAsyncAppender() function?", "url": "https://github.com/CorfuDB/CorfuDB/pull/2691#discussion_r468092090", "createdAt": "2020-08-10T18:19:30Z", "author": {"login": "annym"}, "path": "infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/infrastructure/CorfuInterClusterReplicationServer.java", "diffHunk": "@@ -271,6 +272,9 @@ private void startServer() {\n         }\n \n         log.info(\"main: Server exiting due to shutdown\");\n+        // Flush the async appender before exiting to prevent the loss of logs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa011a6f95c1bf586d9f8f22509e312fa3bd52bf"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE4MzYwNQ==", "bodyText": "sure. done", "url": "https://github.com/CorfuDB/CorfuDB/pull/2691#discussion_r468183605", "createdAt": "2020-08-10T21:01:31Z", "author": {"login": "hisundar"}, "path": "infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/infrastructure/CorfuInterClusterReplicationServer.java", "diffHunk": "@@ -271,6 +272,9 @@ private void startServer() {\n         }\n \n         log.info(\"main: Server exiting due to shutdown\");\n+        // Flush the async appender before exiting to prevent the loss of logs", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA5MjA5MA=="}, "originalCommit": {"oid": "fa011a6f95c1bf586d9f8f22509e312fa3bd52bf"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkyNDU4MTk5OnYy", "diffSide": "RIGHT", "path": "infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/infrastructure/CorfuInterClusterReplicationServer.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQxODoyNzo0NVrOG-aVtw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMTowMTo0OVrOG-fqzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA5NjQzOQ==", "bodyText": "Should we add a check to see if the activeServer is null?\nIf startDiscoveryService throws an exception, activeServer will be null and the shutdown hook hit NPE. Logger flush will be skipped.\n\n  \n    \n      CorfuDB/infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/infrastructure/CorfuInterClusterReplicationServer.java\n    \n    \n         Line 344\n      in\n      fa011a6\n    \n    \n    \n    \n\n        \n          \n           activeServer.close();", "url": "https://github.com/CorfuDB/CorfuDB/pull/2691#discussion_r468096439", "createdAt": "2020-08-10T18:27:45Z", "author": {"login": "zhangn49"}, "path": "infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/infrastructure/CorfuInterClusterReplicationServer.java", "diffHunk": "@@ -341,6 +345,9 @@ public void cleanShutdown() {\n         if (replicationDiscoveryService != null) {\n             replicationDiscoveryService.shutdown();\n         }\n+        // Flush the async appender before exiting to prevent the loss of logs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa011a6f95c1bf586d9f8f22509e312fa3bd52bf"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE4Mzc1Nw==", "bodyText": "done. thanks", "url": "https://github.com/CorfuDB/CorfuDB/pull/2691#discussion_r468183757", "createdAt": "2020-08-10T21:01:49Z", "author": {"login": "hisundar"}, "path": "infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/infrastructure/CorfuInterClusterReplicationServer.java", "diffHunk": "@@ -341,6 +345,9 @@ public void cleanShutdown() {\n         if (replicationDiscoveryService != null) {\n             replicationDiscoveryService.shutdown();\n         }\n+        // Flush the async appender before exiting to prevent the loss of logs", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODA5NjQzOQ=="}, "originalCommit": {"oid": "fa011a6f95c1bf586d9f8f22509e312fa3bd52bf"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1903, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}