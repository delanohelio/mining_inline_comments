{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MTUzNjcz", "number": 2301, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxOTo1MTo1OFrODWEd-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxOTo1MTo1OFrODWEd-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI0NDY4NDc1OnYy", "diffSide": "RIGHT", "path": "runtime/src/main/java/org/corfudb/runtime/collections/Table.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxOTo1MTo1OFrOFaniAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQxOTo1MTo1OFrOFaniAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzQ1NDk3Ng==", "bodyText": "Can we make 0L a static final variable?", "url": "https://github.com/CorfuDB/CorfuDB/pull/2301#discussion_r363454976", "createdAt": "2020-01-06T19:51:58Z", "author": {"login": "annym"}, "path": "runtime/src/main/java/org/corfudb/runtime/collections/Table.java", "diffHunk": "@@ -300,15 +305,16 @@ int count() {\n             Descriptors.FieldDescriptor.Type.SFIXED64\n     ));\n \n-    private M getNewMetadata(@Nonnull M previousMetadata,\n-                             @Nullable M userMetadata) {\n+    private M mergeOldAndNewMetadata(@Nonnull M previousMetadata,\n+                                     @Nullable M userMetadata, boolean isCreate) {\n         M.Builder builder = previousMetadata.toBuilder();\n         for (Descriptors.FieldDescriptor fieldDescriptor : previousMetadata.getDescriptorForType().getFields()) {\n             if (fieldDescriptor.getOptions().getExtension(CorfuOptions.schema).getVersion()) {\n+                // If an object is just being created, explicitly set its version field to 0\n                 builder.setField(\n                         fieldDescriptor,\n                         Optional.ofNullable(previousMetadata.getField(fieldDescriptor))\n-                                .map(previousVersion -> ((Long) previousVersion) + 1)\n+                                .map(previousVersion -> (isCreate ? 0L : ((Long) previousVersion) + 1))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac2f772eedda55ca730e48a5032a86956509da47"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2032, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}