{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0OTM0NDg4", "number": 14302, "title": "Add ST_Centroid for points, multi-points on a sphere", "bodyText": "== RELEASE NOTES ==\nGeospatial computation changes\n* Add support for :func:`ST_AsText` to accept Spherical Geographies.\n* Add support for :func:`ST_Centroid` to accept Spherical Geography Points and MultiPoints.", "createdAt": "2020-03-27T19:32:05Z", "url": "https://github.com/prestodb/presto/pull/14302", "merged": true, "mergeCommit": {"oid": "cf42f75855174b26fd5199b683de3ddee1ad59f0"}, "closed": true, "closedAt": "2020-04-13T16:56:38Z", "author": {"login": "DTAIEB"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVE9zWgFqTM4ODUwNDk4OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXQJwugFqTM5MjE5NjU4Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NTA0OTg4", "url": "https://github.com/prestodb/presto/pull/14302#pullrequestreview-388504988", "createdAt": "2020-04-06T18:20:53Z", "commit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxODoyMDo1NFrOGBkR8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMDo0MTo1NFrOGBpGVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI5NjE3OA==", "bodyText": "Prefer checking for OGCPoint explicitly, to be defensive against allowing more types later.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r404296178", "createdAt": "2020-04-06T18:20:54Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java", "diffHunk": "@@ -378,6 +388,100 @@ public static Slice stCentroid(@SqlType(GEOMETRY_TYPE_NAME) Slice input)\n         return serialize(geometry.getCentroid());\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return null;\n+        }\n+        // TODO: add support for other types e.g. POLYGON\n+        validateSphericalType(\"ST_Centroid\", geometry, EnumSet.of(POINT, MULTI_POINT));\n+        if (! (geometry instanceof OGCGeometryCollection)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI5NjMyNg==", "bodyText": "I would separate out this change into a separate commit.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r404296326", "createdAt": "2020-04-06T18:21:07Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java", "diffHunk": "@@ -322,6 +324,14 @@ public static Slice stAsText(@SqlType(GEOMETRY_TYPE_NAME) Slice input)\n         return utf8Slice(wktFromJtsGeometry(deserialize(input)));\n     }\n \n+    @Description(\"Returns the Well-Known Text (WKT) representation of the geometry\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI5NzQxNA==", "bodyText": "When the geography is a MultiPoint with a single point, this will return a MultiPoint (with one constituent), which is against the contract of returning a Point.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r404297414", "createdAt": "2020-04-06T18:22:57Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java", "diffHunk": "@@ -378,6 +388,100 @@ public static Slice stCentroid(@SqlType(GEOMETRY_TYPE_NAME) Slice input)\n         return serialize(geometry.getCentroid());\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return null;\n+        }\n+        // TODO: add support for other types e.g. POLYGON\n+        validateSphericalType(\"ST_Centroid\", geometry, EnumSet.of(POINT, MULTI_POINT));\n+        if (! (geometry instanceof OGCGeometryCollection)) {\n+            return input;\n+        }\n+\n+        OGCGeometryCollection geometryCollection = (OGCGeometryCollection)geometry;\n+        for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+            OGCGeometry g = geometryCollection.geometryN(i);\n+            validateSphericalType(\"ST_Centroid\", g, EnumSet.of(POINT));\n+            Point p = (Point) g.getEsriGeometry();\n+            checkLatitude(p.getX());\n+            checkLongitude(p.getY());\n+        }\n+\n+        Point centroid = null;\n+        if (geometryCollection.numGeometries() == 1) {\n+            return input;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2NTAyMg==", "bodyText": "Please add tests for 'POINT EMPTY', 'MULTIPOINT EMPTY', the 0-entry 'MULTIPOINT()' (maybe that's a syntax error),  and the single entry 'MULTIPOINT (30, 30)'.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r404365022", "createdAt": "2020-04-06T20:23:49Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/test/java/com/facebook/presto/plugin/geospatial/TestGeoFunctions.java", "diffHunk": "@@ -242,13 +242,26 @@ public void testSTCentroid()\n         assertApproximateCentroid(\n                 \"POLYGON ((-81.0387349 29.20822, -81.039974 29.210597, -81.0410331 29.2101579, -81.0404758 29.2090879, -81.0404618 29.2090609, -81.040433 29.209005, -81.0404269 29.208993, -81.0404161 29.2089729, -81.0398001 29.20779, -81.0387349 29.20822), (-81.0404229 29.208986, -81.04042 29.2089809, -81.0404269 29.208993, -81.0404229 29.208986))\",\n                 new Point(-81.039885, 29.209191), 1e-6);\n+\n+        // Spherical centroid testing", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2NTg2MQ==", "bodyText": "p.getX() will return the x-coordinate, or longitude.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r404365861", "createdAt": "2020-04-06T20:25:19Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java", "diffHunk": "@@ -1681,4 +1785,41 @@ public OGCGeometry next()\n             return geometriesDeque.pop();\n         }\n     }\n+\n+    private static class CartesianPoint\n+    {\n+        public double x;\n+        public double y;\n+        public double z;\n+\n+        public CartesianPoint(Point p) {\n+            // Angle from North Pole down to Latitude, in Radians\n+            double phi = toRadians(90 - p.getX());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "originalPosition": 145}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2NjA4MA==", "bodyText": "p.getY() will return the y-coordinate, or latitude.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r404366080", "createdAt": "2020-04-06T20:25:42Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java", "diffHunk": "@@ -1681,4 +1785,41 @@ public OGCGeometry next()\n             return geometriesDeque.pop();\n         }\n     }\n+\n+    private static class CartesianPoint\n+    {\n+        public double x;\n+        public double y;\n+        public double z;\n+\n+        public CartesianPoint(Point p) {\n+            // Angle from North Pole down to Latitude, in Radians\n+            double phi = toRadians(90 - p.getX());\n+            double sinPhi = Math.sin(phi);\n+            // Angle from Greenwich to Longitude, in Radians\n+            double theta = toRadians(p.getY());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "originalPosition": 148}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2NzAyNQ==", "bodyText": "This will generally be on the chord between cp1 and cp2, which won't be on the sphere.  I think you need to normalize here?", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r404367025", "createdAt": "2020-04-06T20:27:26Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java", "diffHunk": "@@ -378,6 +388,100 @@ public static Slice stCentroid(@SqlType(GEOMETRY_TYPE_NAME) Slice input)\n         return serialize(geometry.getCentroid());\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return null;\n+        }\n+        // TODO: add support for other types e.g. POLYGON\n+        validateSphericalType(\"ST_Centroid\", geometry, EnumSet.of(POINT, MULTI_POINT));\n+        if (! (geometry instanceof OGCGeometryCollection)) {\n+            return input;\n+        }\n+\n+        OGCGeometryCollection geometryCollection = (OGCGeometryCollection)geometry;\n+        for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+            OGCGeometry g = geometryCollection.geometryN(i);\n+            validateSphericalType(\"ST_Centroid\", g, EnumSet.of(POINT));\n+            Point p = (Point) g.getEsriGeometry();\n+            checkLatitude(p.getX());\n+            checkLongitude(p.getY());\n+        }\n+\n+        Point centroid = null;\n+        if (geometryCollection.numGeometries() == 1) {\n+            return input;\n+        }else if(geometryCollection.numGeometries() == 2) {\n+            // 2 points\n+            CartesianPoint cp1 = new CartesianPoint((Point)geometryCollection.geometryN(0).getEsriGeometry());\n+            CartesianPoint cp2 = new CartesianPoint((Point)geometryCollection.geometryN(1).getEsriGeometry());\n+            centroid = CartesianPoint.convertToLatLong(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "originalPosition": 66}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM2NzI1OA==", "bodyText": "This seems like a good method on CartesianPoint, or even a normalized function that returns a unit vector in the same direction as CartesianPoint.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r404367258", "createdAt": "2020-04-06T20:27:47Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java", "diffHunk": "@@ -378,6 +388,100 @@ public static Slice stCentroid(@SqlType(GEOMETRY_TYPE_NAME) Slice input)\n         return serialize(geometry.getCentroid());\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return null;\n+        }\n+        // TODO: add support for other types e.g. POLYGON\n+        validateSphericalType(\"ST_Centroid\", geometry, EnumSet.of(POINT, MULTI_POINT));\n+        if (! (geometry instanceof OGCGeometryCollection)) {\n+            return input;\n+        }\n+\n+        OGCGeometryCollection geometryCollection = (OGCGeometryCollection)geometry;\n+        for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+            OGCGeometry g = geometryCollection.geometryN(i);\n+            validateSphericalType(\"ST_Centroid\", g, EnumSet.of(POINT));\n+            Point p = (Point) g.getEsriGeometry();\n+            checkLatitude(p.getX());\n+            checkLongitude(p.getY());\n+        }\n+\n+        Point centroid = null;\n+        if (geometryCollection.numGeometries() == 1) {\n+            return input;\n+        }else if(geometryCollection.numGeometries() == 2) {\n+            // 2 points\n+            CartesianPoint cp1 = new CartesianPoint((Point)geometryCollection.geometryN(0).getEsriGeometry());\n+            CartesianPoint cp2 = new CartesianPoint((Point)geometryCollection.geometryN(1).getEsriGeometry());\n+            centroid = CartesianPoint.convertToLatLong(\n+                    (cp1.x + cp2.x)/2,\n+                    (cp1.y + cp2.y)/2,\n+                    (cp1.z + cp2.z)/2\n+            );\n+        }else if(geometryCollection.numGeometries() == 3) {\n+            // Triangle\n+            CartesianPoint cp1 = new CartesianPoint((Point)geometryCollection.geometryN(0).getEsriGeometry());\n+            CartesianPoint cp2 = new CartesianPoint((Point)geometryCollection.geometryN(1).getEsriGeometry());\n+            CartesianPoint cp3 = new CartesianPoint((Point)geometryCollection.geometryN(2).getEsriGeometry());\n+            double x3D = (cp1.x + cp2.x + cp3.x)/3;\n+            double y3D = (cp1.y + cp2.y + cp3.y)/3;\n+            double z3D = (cp1.z + cp2.z + cp3.z)/3;\n+            double centroidVectorLength = Math.sqrt(x3D*x3D + y3D*y3D + z3D*z3D);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM3NTEyNA==", "bodyText": "Honest question here:  Why use the centroids of our spherical triangles, rather than just taking the average of the points?", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r404375124", "createdAt": "2020-04-06T20:41:54Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java", "diffHunk": "@@ -378,6 +388,100 @@ public static Slice stCentroid(@SqlType(GEOMETRY_TYPE_NAME) Slice input)\n         return serialize(geometry.getCentroid());\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return null;\n+        }\n+        // TODO: add support for other types e.g. POLYGON\n+        validateSphericalType(\"ST_Centroid\", geometry, EnumSet.of(POINT, MULTI_POINT));\n+        if (! (geometry instanceof OGCGeometryCollection)) {\n+            return input;\n+        }\n+\n+        OGCGeometryCollection geometryCollection = (OGCGeometryCollection)geometry;\n+        for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+            OGCGeometry g = geometryCollection.geometryN(i);\n+            validateSphericalType(\"ST_Centroid\", g, EnumSet.of(POINT));\n+            Point p = (Point) g.getEsriGeometry();\n+            checkLatitude(p.getX());\n+            checkLongitude(p.getY());\n+        }\n+\n+        Point centroid = null;\n+        if (geometryCollection.numGeometries() == 1) {\n+            return input;\n+        }else if(geometryCollection.numGeometries() == 2) {\n+            // 2 points\n+            CartesianPoint cp1 = new CartesianPoint((Point)geometryCollection.geometryN(0).getEsriGeometry());\n+            CartesianPoint cp2 = new CartesianPoint((Point)geometryCollection.geometryN(1).getEsriGeometry());\n+            centroid = CartesianPoint.convertToLatLong(\n+                    (cp1.x + cp2.x)/2,\n+                    (cp1.y + cp2.y)/2,\n+                    (cp1.z + cp2.z)/2\n+            );\n+        }else if(geometryCollection.numGeometries() == 3) {\n+            // Triangle\n+            CartesianPoint cp1 = new CartesianPoint((Point)geometryCollection.geometryN(0).getEsriGeometry());\n+            CartesianPoint cp2 = new CartesianPoint((Point)geometryCollection.geometryN(1).getEsriGeometry());\n+            CartesianPoint cp3 = new CartesianPoint((Point)geometryCollection.geometryN(2).getEsriGeometry());\n+            double x3D = (cp1.x + cp2.x + cp3.x)/3;\n+            double y3D = (cp1.y + cp2.y + cp3.y)/3;\n+            double z3D = (cp1.z + cp2.z + cp3.z)/3;\n+            double centroidVectorLength = Math.sqrt(x3D*x3D + y3D*y3D + z3D*z3D);\n+            centroid = CartesianPoint.convertToLatLong(\n+                    x3D / centroidVectorLength,\n+                    y3D / centroidVectorLength,\n+                    z3D / centroidVectorLength\n+            );\n+        }else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81655c453e212dcb8977cc62434abc460e23b687"}, "originalPosition": 85}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "47908dfdba8545ac16844147e8f4b175ad1d6fb9", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/47908dfdba8545ac16844147e8f4b175ad1d6fb9", "committedDate": "2020-04-07T19:40:21Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}, "afterCommit": {"oid": "30f8ad0d0bc29a49bb496347b9c436b1d81c9299", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/30f8ad0d0bc29a49bb496347b9c436b1d81c9299", "committedDate": "2020-04-07T21:12:26Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NTQzNzMx", "url": "https://github.com/prestodb/presto/pull/14302#pullrequestreview-389543731", "createdAt": "2020-04-07T22:50:14Z", "commit": {"oid": "30b1d32f8cd12b74dc411e71b560b1a6fdc9d009"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMjo1MDoxNFrOGCY8Aw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMjo1OTo1M1rOGCZKYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE1ODkxNQ==", "bodyText": "It supports Points and MultiPoints (also, prefer that spelling to multi-points).\nAlso, \"Point representing the average\" is a bit vague.  Perhaps something that mentions is the three-dimensional centroid projected onto the surface of the (spherical) Earth.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405158915", "createdAt": "2020-04-07T22:50:14Z", "author": {"login": "jagill"}, "path": "presto-docs/src/main/sphinx/functions/geospatial.rst", "diffHunk": "@@ -253,6 +253,16 @@ Accessors\n \n     Returns the point value that is the mathematical centroid of a geometry.\n \n+.. function:: ST_Centroid(SphericalGeography) -> Point\n+\n+    Returns the point value that is the mathematical centroid of a spherical geometry.\n+\n+    This method currently supports only a multi-points as input and returns the Point representing the", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30b1d32f8cd12b74dc411e71b560b1a6fdc9d009"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE1OTk4OA==", "bodyText": "Maybe something like, \"In the case that the three-dimensional centroid is at (0, 0, 0), the spherical centroid is undefined and arbitrary point will be returned.\"", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405159988", "createdAt": "2020-04-07T22:53:12Z", "author": {"login": "jagill"}, "path": "presto-docs/src/main/sphinx/functions/geospatial.rst", "diffHunk": "@@ -253,6 +253,16 @@ Accessors\n \n     Returns the point value that is the mathematical centroid of a geometry.\n \n+.. function:: ST_Centroid(SphericalGeography) -> Point\n+\n+    Returns the point value that is the mathematical centroid of a spherical geometry.\n+\n+    This method currently supports only a multi-points as input and returns the Point representing the\n+    average of the cartesian coordinates of the input points\n+    e.g. MULTIPOINT (0 -45, 0 45, 30 0, -30 0) returns Point(0, 0))\n+    Note: It is possible that the average of the cartesian coordinates adds up to 0, in which case the\n+    results is undefined. For example: 2 diametrically opposed points like MULTIPOINT (0 0, -180 0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30b1d32f8cd12b74dc411e71b560b1a6fdc9d009"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE2MTA4OQ==", "bodyText": "Why return an EMPTY_SLICE here and not null?", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405161089", "createdAt": "2020-04-07T22:56:04Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/SphericalGeoFunctions.java", "diffHunk": "@@ -236,6 +256,55 @@ public static Double stSphericalLength(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) S\n         return sum * 1000;\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return Slices.EMPTY_SLICE;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30f8ad0d0bc29a49bb496347b9c436b1d81c9299"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE2MTMwMw==", "bodyText": "Make these private and final with getters (but no setters).", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405161303", "createdAt": "2020-04-07T22:56:39Z", "author": {"login": "jagill"}, "path": "presto-geospatial-toolkit/src/main/java/com/facebook/presto/geospatial/SphericalGeographyUtils.java", "diffHunk": "@@ -113,4 +114,35 @@ public static void validateSphericalType(String function, OGCGeometry geometry,\n             throw new PrestoException(INVALID_FUNCTION_ARGUMENT, format(\"When applied to SphericalGeography inputs, %s only supports %s. Input type is: %s\", function, OR_JOINER.join(validTypes), type));\n         }\n     }\n+\n+    public static class CartesianPoint\n+    {\n+        public double x;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30f8ad0d0bc29a49bb496347b9c436b1d81c9299"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE2MjI3NQ==", "bodyText": "I think either we should:\n\nHave CartesianPoint have two constructors (Point, and (x, y, z)), and an asPoint() method that returns a point, or\njust have two static helper methods in SphericalGeographyUtils (no CartesianPoint) that convert between cartesian (x, y, z) and Point.\n\n2 seems like the right solution, since we're never using the class as such, but I think either way would work.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405162275", "createdAt": "2020-04-07T22:59:06Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/SphericalGeoFunctions.java", "diffHunk": "@@ -236,6 +256,55 @@ public static Double stSphericalLength(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) S\n         return sum * 1000;\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return Slices.EMPTY_SLICE;\n+        }\n+        // TODO: add support for other types e.g. POLYGON\n+        validateSphericalType(\"ST_Centroid\", geometry, EnumSet.of(POINT, MULTI_POINT));\n+        if (geometry instanceof OGCPoint) {\n+            return input;\n+        }\n+\n+        OGCGeometryCollection geometryCollection = (OGCGeometryCollection) geometry;\n+        for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+            OGCGeometry g = geometryCollection.geometryN(i);\n+            validateSphericalType(\"ST_Centroid\", g, EnumSet.of(POINT));\n+            Point p = (Point) g.getEsriGeometry();\n+            checkLongitude(p.getX());\n+            checkLatitude(p.getY());\n+        }\n+\n+        Point centroid;\n+        if (geometryCollection.numGeometries() == 1) {\n+            centroid = (Point) geometryCollection.geometryN(0).getEsriGeometry();\n+        }\n+        else {\n+            double x3DTotal = 0;\n+            double y3DTotal = 0;\n+            double z3DTotal = 0;\n+\n+            for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+                SphericalGeographyUtils.CartesianPoint cp = new SphericalGeographyUtils.CartesianPoint((Point) geometryCollection.geometryN(i).getEsriGeometry());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30f8ad0d0bc29a49bb496347b9c436b1d81c9299"}, "originalPosition": 97}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE2MjU5NA==", "bodyText": "Also, prefer static imports such that CartesianPoint (or the static helper methods) are imported at top level.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405162594", "createdAt": "2020-04-07T22:59:53Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/SphericalGeoFunctions.java", "diffHunk": "@@ -236,6 +256,55 @@ public static Double stSphericalLength(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) S\n         return sum * 1000;\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return Slices.EMPTY_SLICE;\n+        }\n+        // TODO: add support for other types e.g. POLYGON\n+        validateSphericalType(\"ST_Centroid\", geometry, EnumSet.of(POINT, MULTI_POINT));\n+        if (geometry instanceof OGCPoint) {\n+            return input;\n+        }\n+\n+        OGCGeometryCollection geometryCollection = (OGCGeometryCollection) geometry;\n+        for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+            OGCGeometry g = geometryCollection.geometryN(i);\n+            validateSphericalType(\"ST_Centroid\", g, EnumSet.of(POINT));\n+            Point p = (Point) g.getEsriGeometry();\n+            checkLongitude(p.getX());\n+            checkLatitude(p.getY());\n+        }\n+\n+        Point centroid;\n+        if (geometryCollection.numGeometries() == 1) {\n+            centroid = (Point) geometryCollection.geometryN(0).getEsriGeometry();\n+        }\n+        else {\n+            double x3DTotal = 0;\n+            double y3DTotal = 0;\n+            double z3DTotal = 0;\n+\n+            for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+                SphericalGeographyUtils.CartesianPoint cp = new SphericalGeographyUtils.CartesianPoint((Point) geometryCollection.geometryN(i).getEsriGeometry());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30f8ad0d0bc29a49bb496347b9c436b1d81c9299"}, "originalPosition": 97}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "30b1d32f8cd12b74dc411e71b560b1a6fdc9d009", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/30b1d32f8cd12b74dc411e71b560b1a6fdc9d009", "committedDate": "2020-04-07T22:43:53Z", "message": "doc update"}, "afterCommit": {"oid": "fdd924abeaec9ea514e403b8c9dfa50cb1d376b3", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/fdd924abeaec9ea514e403b8c9dfa50cb1d376b3", "committedDate": "2020-04-08T04:34:18Z", "message": "Add ST_Centroid for points and multipoints on a sphere\n\ndoc update\n\nminor refactor"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fdd924abeaec9ea514e403b8c9dfa50cb1d376b3", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/fdd924abeaec9ea514e403b8c9dfa50cb1d376b3", "committedDate": "2020-04-08T04:34:18Z", "message": "Add ST_Centroid for points and multipoints on a sphere\n\ndoc update\n\nminor refactor"}, "afterCommit": {"oid": "fd31854a52615e36f6ffc39ece5cc237931eea5e", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/fd31854a52615e36f6ffc39ece5cc237931eea5e", "committedDate": "2020-04-08T04:54:46Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMDEwNjU2", "url": "https://github.com/prestodb/presto/pull/14302#pullrequestreview-390010656", "createdAt": "2020-04-08T14:08:40Z", "commit": {"oid": "fd31854a52615e36f6ffc39ece5cc237931eea5e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNDowODo0MFrOGCxB4A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNDo0MjowNVrOGCyggQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU1MzYzMg==", "bodyText": "This is missing the example return value?", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405553632", "createdAt": "2020-04-08T14:08:40Z", "author": {"login": "jagill"}, "path": "presto-docs/src/main/sphinx/functions/geospatial.rst", "diffHunk": "@@ -253,6 +253,16 @@ Accessors\n \n     Returns the point value that is the mathematical centroid of a geometry.\n \n+.. function:: ST_Centroid(SphericalGeography) -> Point\n+\n+    Returns the point value that is the mathematical centroid of a spherical geometry.\n+\n+    It supports Points and MultiPoints as input and returns the three-dimensional centroid\n+    projected onto the surface of the (spherical) Earth\n+    e.g. MULTIPOINT (0 -45, 0 45, 30 0, -30 0) returns Point(0, 0))\n+    Note: In the case that the three-dimensional centroid is at (0, 0, 0), the spherical centroid\n+    is undefined and an arbitrary point will be returned e.g. MULTIPOINT (0 0, -180 0)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd31854a52615e36f6ffc39ece5cc237931eea5e"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU1NDA4MQ==", "bodyText": "Make these final.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405554081", "createdAt": "2020-04-08T14:09:13Z", "author": {"login": "jagill"}, "path": "presto-geospatial-toolkit/src/main/java/com/facebook/presto/geospatial/SphericalGeographyUtils.java", "diffHunk": "@@ -113,4 +114,66 @@ public static void validateSphericalType(String function, OGCGeometry geometry,\n             throw new PrestoException(INVALID_FUNCTION_ARGUMENT, format(\"When applied to SphericalGeography inputs, %s only supports %s. Input type is: %s\", function, OR_JOINER.join(validTypes), type));\n         }\n     }\n+\n+    public static final class CartesianPoint\n+    {\n+        private double x;\n+        private double y;\n+        private double z;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd31854a52615e36f6ffc39ece5cc237931eea5e"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU1NTc0Mg==", "bodyText": "If the input is null, the output should be null.  ScalarFunctions do this automatically, unless you use the @SqlNullable annotation.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405555742", "createdAt": "2020-04-08T14:11:41Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/SphericalGeoFunctions.java", "diffHunk": "@@ -105,6 +115,17 @@ public static Slice toGeometry(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice inp\n         return input;\n     }\n \n+    @Description(\"Returns the Well-Known Text (WKT) representation of the geometry\")\n+    @ScalarFunction(\"ST_AsText\")\n+    @SqlType(VARCHAR)\n+    public static Slice stSphericalAsText(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        if (input == null) {\n+            return utf8Slice(\"POINT EMPTY\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd31854a52615e36f6ffc39ece5cc237931eea5e"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU3NTU4MA==", "bodyText": "You can use @SqlNullable to allow a null return value.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405575580", "createdAt": "2020-04-08T14:38:48Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/SphericalGeoFunctions.java", "diffHunk": "@@ -236,6 +256,55 @@ public static Double stSphericalLength(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) S\n         return sum * 1000;\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return Slices.EMPTY_SLICE;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE2MTA4OQ=="}, "originalCommit": {"oid": "30f8ad0d0bc29a49bb496347b9c436b1d81c9299"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU3NjEzNg==", "bodyText": "Remove this by returning null above.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405576136", "createdAt": "2020-04-08T14:39:37Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/SphericalGeographyType.java", "diffHunk": "@@ -75,6 +76,9 @@ public Object getObjectValue(ConnectorSession session, Block block, int position\n             return null;\n         }\n         Slice slice = block.getSlice(position, 0, block.getSliceLength(position));\n+        if (slice == Slices.EMPTY_SLICE) {\n+            return null;\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd31854a52615e36f6ffc39ece5cc237931eea5e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU3Nzg1Nw==", "bodyText": "Let's explicitly check for centroidVectorLength == 0.0 here; I'm worried that some float precision is hiding a possible div-by-0 bug.", "url": "https://github.com/prestodb/presto/pull/14302#discussion_r405577857", "createdAt": "2020-04-08T14:42:05Z", "author": {"login": "jagill"}, "path": "presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/SphericalGeoFunctions.java", "diffHunk": "@@ -236,6 +257,55 @@ public static Double stSphericalLength(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) S\n         return sum * 1000;\n     }\n \n+    @Description(\"Returns the Point value that is the mathematical centroid of a Spherical Geography\")\n+    @ScalarFunction(\"ST_Centroid\")\n+    @SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME)\n+    public static Slice stSphericalCentroid(@SqlType(SPHERICAL_GEOGRAPHY_TYPE_NAME) Slice input)\n+    {\n+        OGCGeometry geometry = EsriGeometrySerde.deserialize(input);\n+        if (geometry.isEmpty()) {\n+            return Slices.EMPTY_SLICE;\n+        }\n+        // TODO: add support for other types e.g. POLYGON\n+        validateSphericalType(\"ST_Centroid\", geometry, EnumSet.of(POINT, MULTI_POINT));\n+        if (geometry instanceof OGCPoint) {\n+            return input;\n+        }\n+\n+        OGCGeometryCollection geometryCollection = (OGCGeometryCollection) geometry;\n+        for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+            OGCGeometry g = geometryCollection.geometryN(i);\n+            validateSphericalType(\"ST_Centroid\", g, EnumSet.of(POINT));\n+            Point p = (Point) g.getEsriGeometry();\n+            checkLongitude(p.getX());\n+            checkLatitude(p.getY());\n+        }\n+\n+        Point centroid;\n+        if (geometryCollection.numGeometries() == 1) {\n+            centroid = (Point) geometryCollection.geometryN(0).getEsriGeometry();\n+        }\n+        else {\n+            double x3DTotal = 0;\n+            double y3DTotal = 0;\n+            double z3DTotal = 0;\n+\n+            for (int i = 0; i < geometryCollection.numGeometries(); i++) {\n+                CartesianPoint cp = new CartesianPoint((Point) geometryCollection.geometryN(i).getEsriGeometry());\n+                x3DTotal += cp.getX();\n+                y3DTotal += cp.getY();\n+                z3DTotal += cp.getZ();\n+            }\n+\n+            double centroidVectorLength = Math.sqrt(x3DTotal * x3DTotal + y3DTotal * y3DTotal + z3DTotal * z3DTotal);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd31854a52615e36f6ffc39ece5cc237931eea5e"}, "originalPosition": 104}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd31854a52615e36f6ffc39ece5cc237931eea5e", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/fd31854a52615e36f6ffc39ece5cc237931eea5e", "committedDate": "2020-04-08T04:54:46Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}, "afterCommit": {"oid": "723e9d8a329a507de6849bd3c3192e35204b0196", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/723e9d8a329a507de6849bd3c3192e35204b0196", "committedDate": "2020-04-08T15:24:50Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "723e9d8a329a507de6849bd3c3192e35204b0196", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/723e9d8a329a507de6849bd3c3192e35204b0196", "committedDate": "2020-04-08T15:24:50Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}, "afterCommit": {"oid": "957ca54284285678130c518b036bfeba8fb189bc", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/957ca54284285678130c518b036bfeba8fb189bc", "committedDate": "2020-04-08T15:28:54Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "957ca54284285678130c518b036bfeba8fb189bc", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/957ca54284285678130c518b036bfeba8fb189bc", "committedDate": "2020-04-08T15:28:54Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}, "afterCommit": {"oid": "1bc7af46d823df28f19937fe0c590bba6d5bdb32", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/1bc7af46d823df28f19937fe0c590bba6d5bdb32", "committedDate": "2020-04-08T16:37:29Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34e79e5bf342ef2e02629d2d8a33b62e425a51d3", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/34e79e5bf342ef2e02629d2d8a33b62e425a51d3", "committedDate": "2020-04-08T16:39:21Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1bc7af46d823df28f19937fe0c590bba6d5bdb32", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/1bc7af46d823df28f19937fe0c590bba6d5bdb32", "committedDate": "2020-04-08T16:37:29Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}, "afterCommit": {"oid": "34e79e5bf342ef2e02629d2d8a33b62e425a51d3", "author": {"user": {"login": "DTAIEB", "name": "David Taieb"}}, "url": "https://github.com/prestodb/presto/commit/34e79e5bf342ef2e02629d2d8a33b62e425a51d3", "committedDate": "2020-04-08T16:39:21Z", "message": "Add ST_Centroid for points and multipoints on a sphere"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMTk2NTgy", "url": "https://github.com/prestodb/presto/pull/14302#pullrequestreview-392196582", "createdAt": "2020-04-13T14:55:29Z", "commit": {"oid": "34e79e5bf342ef2e02629d2d8a33b62e425a51d3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2114, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}