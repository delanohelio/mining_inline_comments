{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMTI1MDgy", "number": 14195, "title": "Wait for final task info on abort", "bodyText": "== NO RELEASE NOTE ==", "createdAt": "2020-03-03T19:11:20Z", "url": "https://github.com/prestodb/presto/pull/14195", "merged": true, "mergeCommit": {"oid": "b429ddb4eabd15ab1f7c06242b0ef39ab5bf0534"}, "closed": true, "closedAt": "2020-03-04T15:24:55Z", "author": {"login": "arhimondr"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKHA3EAH2gAyMzgzMTI1MDgyOjVlM2RlYzM5MmQxNDY5MjVjNGRlOWJlMGJiZTQ3YmVkNDUwMjBhMjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcKPteHAFqTM2ODUwNjE1Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5e3dec392d146925c4de9be0bbe47bed45020a22", "author": {"user": {"login": "arhimondr", "name": "Andrii Rosa"}}, "url": "https://github.com/prestodb/presto/commit/5e3dec392d146925c4de9be0bbe47bed45020a22", "committedDate": "2020-03-03T18:55:36Z", "message": "Wait for final task info on abort\n\nWait for final task info on abort to avoid missing task statistics in\ncase when query finishes before the final task info is received by the\nTaskInfoFetcher."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MjUyNDMx", "url": "https://github.com/prestodb/presto/pull/14195#pullrequestreview-368252431", "createdAt": "2020-03-03T19:15:45Z", "commit": {"oid": "5e3dec392d146925c4de9be0bbe47bed45020a22"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MjUzOTMz", "url": "https://github.com/prestodb/presto/pull/14195#pullrequestreview-368253933", "createdAt": "2020-03-03T19:17:56Z", "commit": {"oid": "5e3dec392d146925c4de9be0bbe47bed45020a22"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxOToxNzo1N1rOFxTH0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxOToxNzo1N1rOFxTH0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzIzNzg0Mg==", "bodyText": "Curious why issue get raised by recoverable grouped execution? :)", "url": "https://github.com/prestodb/presto/pull/14195#discussion_r387237842", "createdAt": "2020-03-03T19:17:57Z", "author": {"login": "wenleix"}, "path": "presto-main/src/main/java/com/facebook/presto/server/remotetask/HttpRemoteTask.java", "diffHunk": "@@ -880,7 +876,15 @@ private void failTask(Throwable cause)\n             log.debug(cause, \"Remote task %s failed with %s\", taskStatus.getSelf(), cause);\n         }\n \n-        abort(failWith(getTaskStatus(), FAILED, ImmutableList.of(toFailure(cause))));\n+        TaskStatus failedTaskStatus = failWith(getTaskStatus(), FAILED, ImmutableList.of(toFailure(cause)));\n+        // Transition task to failed state without waiting for the final task info returned by the abort request.\n+        // The abort request is very likely not to succeed, leaving the task and the stage in the limbo state for", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e3dec392d146925c4de9be0bbe47bed45020a22"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MzU1OTc3", "url": "https://github.com/prestodb/presto/pull/14195#pullrequestreview-368355977", "createdAt": "2020-03-03T21:58:13Z", "commit": {"oid": "5e3dec392d146925c4de9be0bbe47bed45020a22"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4Mzk1MjQz", "url": "https://github.com/prestodb/presto/pull/14195#pullrequestreview-368395243", "createdAt": "2020-03-03T23:13:50Z", "commit": {"oid": "5e3dec392d146925c4de9be0bbe47bed45020a22"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NTA2MTUz", "url": "https://github.com/prestodb/presto/pull/14195#pullrequestreview-368506153", "createdAt": "2020-03-04T05:03:34Z", "commit": {"oid": "5e3dec392d146925c4de9be0bbe47bed45020a22"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1950, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}