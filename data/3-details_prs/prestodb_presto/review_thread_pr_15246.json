{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk1MTA5OTEx", "number": 15246, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwNDo0NTo1NVrOEo3hxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwNDo0NTo1NVrOEo3hxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzExMjg4MjYyOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/type/TypeRegistry.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwNDo0NTo1NVrOHaNI6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxNjo1MDo1MVrOHampfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI0MDI5OQ==", "bodyText": "What if map is a subtype of some other types. For example Array<Map<...>>. createType should be recursive.", "url": "https://github.com/prestodb/presto/pull/15246#discussion_r497240299", "createdAt": "2020-09-30T04:45:55Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/type/TypeRegistry.java", "diffHunk": "@@ -213,8 +210,11 @@ private Type instantiateParametricType(TypeSignature signature)\n         if (parametricType == null) {\n             throw new IllegalArgumentException(\"Unknown type \" + signature);\n         }\n+        else if (parametricType instanceof MapParametricType) {\n+            return ((MapParametricType) parametricType).createType(functionManager, parameters);\n+        }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d686255bcc25b11a6280ba89fe92e75698b8d9cc"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzY1ODIzNw==", "bodyText": "The interesting (or surprising part) is TypeParameter already contains Type. So it's not recursive.\n\n  \n    \n      presto/presto-main/src/main/java/com/facebook/presto/type/ArrayParametricType.java\n    \n    \n        Lines 44 to 52\n      in\n      e6ad497\n    \n    \n    \n    \n\n        \n          \n           public Type createType(TypeManager typeManager, List<TypeParameter> parameters) \n        \n\n        \n          \n           { \n        \n\n        \n          \n               checkArgument(parameters.size() == 1, \"Array type expects exactly one type as a parameter, got %s\", parameters); \n        \n\n        \n          \n               checkArgument( \n        \n\n        \n          \n                       parameters.get(0).getKind() == ParameterKind.TYPE, \n        \n\n        \n          \n                       \"Array expects type as a parameter, got %s\", \n        \n\n        \n          \n                       parameters); \n        \n\n        \n          \n               return new ArrayType(parameters.get(0).getType()); \n        \n\n        \n          \n           }", "url": "https://github.com/prestodb/presto/pull/15246#discussion_r497658237", "createdAt": "2020-09-30T16:50:51Z", "author": {"login": "wenleix"}, "path": "presto-main/src/main/java/com/facebook/presto/type/TypeRegistry.java", "diffHunk": "@@ -213,8 +210,11 @@ private Type instantiateParametricType(TypeSignature signature)\n         if (parametricType == null) {\n             throw new IllegalArgumentException(\"Unknown type \" + signature);\n         }\n+        else if (parametricType instanceof MapParametricType) {\n+            return ((MapParametricType) parametricType).createType(functionManager, parameters);\n+        }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzI0MDI5OQ=="}, "originalCommit": {"oid": "d686255bcc25b11a6280ba89fe92e75698b8d9cc"}, "originalPosition": 30}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3453, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}