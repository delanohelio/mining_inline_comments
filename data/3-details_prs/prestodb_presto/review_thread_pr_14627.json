{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyMDcyNTg3", "number": 14627, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToyMzoxNlrOEENtzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToyMzoxNlrOEENtzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcyODU0NDc2OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHivePushdownFilterQueries.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQwOToyMzoxNlrOGhsfbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQxNzowOTo0NVrOGh-j8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk4NTEzMw==", "bodyText": "@bhhari Thanks for adding a test. A few nits:\n\nname the table test_xxx for consistency, e.g. test_struct_with_uppercase_fields\nadd .dwrf extension to the file name for clarify, e.g. struct_with_uppercase_fields.dwrf\nadd space after // in comments for readability, e.g. // path to vs. //path to\nfileWrittenBySpark -> sparkFile and oldFilePath -> prestoFile for clarity\nmove sparkFile variable closer to where it is used\nrun the same set of queries with presto and spark files\nFiles.copy statement can be shortened to Files.copy(sparkFile, prestoPath);\ndelete the test table when done\n\n    @Test\n    public void testUpperCaseStructFields()\n            throws Exception\n    {\n        assertUpdate(\"CREATE TABLE test_struct_with_uppercase_field(field0) WITH (FORMAT = 'DWRF') AS \" +\n                \"SELECT CAST((1, 1) AS ROW(SUBFIELDCAP BIGINT, subfieldsmall BIGINT))\", 1);\n\n        try {\n            assertQuery(\"SELECT * FROM test_struct_with_uppercase_field\", \"SELECT (CAST(1 AS BIGINT), CAST(1 AS BIGINT))\");\n            assertQuery(\"SELECT field0.SUBFIELDCAP FROM test_struct_with_uppercase_field\", \"SELECT CAST(1 AS BIGINT)\");\n            assertQuery(\"SELECT field0.subfieldcap FROM test_struct_with_uppercase_field\", \"SELECT CAST(1 AS BIGINT)\");\n\n            // delete the file written by Presto and corresponding crc file\n            Path prestoPath = getOnlyPath(\"test_struct_with_uppercase_field\");\n            Files.delete(prestoPath);\n            Files.deleteIfExists(prestoPath.getParent().resolve(\".\" + prestoPath.getFileName() + \".crc\"));\n\n            // copy the file written by Spark\n            Path sparkFile = Paths.get(this.getClass().getClassLoader().getResource(\"struct_with_uppercase_field.dwrf\").toURI());\n            Files.copy(sparkFile, prestoPath);\n\n            assertQuery(\"SELECT * FROM test_struct_with_uppercase_field\", \"SELECT (CAST(1 AS BIGINT), CAST(1 AS BIGINT))\");\n            assertQuery(\"SELECT field0.SUBFIELDCAP FROM test_struct_with_uppercase_field\", \"SELECT CAST(1 AS BIGINT)\");\n            assertQuery(\"SELECT field0.subfieldcap FROM test_struct_with_uppercase_field\", \"SELECT CAST(1 AS BIGINT)\");\n        } finally {\n            assertUpdate(\"DROP TABLE test_struct_with_uppercase_field\");\n        }\n    }", "url": "https://github.com/prestodb/presto/pull/14627#discussion_r437985133", "createdAt": "2020-06-10T09:23:16Z", "author": {"login": "mbasmanova"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHivePushdownFilterQueries.java", "diffHunk": "@@ -895,6 +895,25 @@ public void testStructSchemaEvolution()\n         assertQuery(\"SELECT count(*) FROM test_struct_add_column where x.c = 1\", \"SELECT 0\");\n     }\n \n+    @Test\n+    public void testStructFieldsIgnoreCase()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "503260d63f4f3212bd119c5f638b1604babbdb52"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODI4MTIwMA==", "bodyText": "thanks @mbasmanova, will update the test", "url": "https://github.com/prestodb/presto/pull/14627#discussion_r438281200", "createdAt": "2020-06-10T17:09:45Z", "author": {"login": "bhhari"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHivePushdownFilterQueries.java", "diffHunk": "@@ -895,6 +895,25 @@ public void testStructSchemaEvolution()\n         assertQuery(\"SELECT count(*) FROM test_struct_add_column where x.c = 1\", \"SELECT 0\");\n     }\n \n+    @Test\n+    public void testStructFieldsIgnoreCase()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzk4NTEzMw=="}, "originalCommit": {"oid": "503260d63f4f3212bd119c5f638b1604babbdb52"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2407, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}