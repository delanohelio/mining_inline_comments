{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MjkxMjcz", "number": 14997, "title": "Dynamic filtering for semi join", "bodyText": "== NO RELEASE NOTE ==", "createdAt": "2020-08-10T05:57:00Z", "url": "https://github.com/prestodb/presto/pull/14997", "merged": true, "mergeCommit": {"oid": "ec5b590d15c244fdf565805dc51c1ebf7e61935e"}, "closed": true, "closedAt": "2020-08-12T06:19:37Z", "author": {"login": "kewang1024"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9cIwTABqjM2MzczNzIwMDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9-8uJABqjM2NDUzMTc5Nzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7cf63fa76ce1e4b5ee47aa2bee65985d6f1bba9b", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/7cf63fa76ce1e4b5ee47aa2bee65985d6f1bba9b", "committedDate": "2020-08-10T05:52:03Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}, "afterCommit": {"oid": "51c68635db9c7257787b3177118d1fe1e6ba1639", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/51c68635db9c7257787b3177118d1fe1e6ba1639", "committedDate": "2020-08-10T06:08:12Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTc5OTc4", "url": "https://github.com/prestodb/presto/pull/14997#pullrequestreview-463979978", "createdAt": "2020-08-10T06:26:35Z", "commit": {"oid": "03e17f712729c8a827faa3c20331816362d16dea"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNjoyNjo1NlrOG-CnDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQwNjo0NDoyM1rOG-C8Kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwNzY2MQ==", "bodyText": "This can be merged with visitJoin's common part just like how you did for the impl part.", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r467707661", "createdAt": "2020-08-10T06:26:56Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/iterative/rule/RemoveUnsupportedDynamicFilters.java", "diffHunk": "@@ -144,6 +145,45 @@ public PlanWithConsumedDynamicFilters visitJoin(JoinNode node, Set<String> allow\n             return new PlanWithConsumedDynamicFilters(node, ImmutableSet.copyOf(consumed));\n         }\n \n+        @Override\n+        public PlanWithConsumedDynamicFilters visitSemiJoin(SemiJoinNode node, Set<String> allowedDynamicFilterIds)\n+        {\n+            ImmutableSet<String> allowedDynamicFilterIdsProbeSide = ImmutableSet.<String>builder()\n+                    .addAll(node.getDynamicFilters().keySet())\n+                    .addAll(allowedDynamicFilterIds)\n+                    .build();\n+\n+            PlanWithConsumedDynamicFilters leftResult = node.getSource().accept(this, allowedDynamicFilterIdsProbeSide);\n+            Set<String> consumedProbeSide = leftResult.getConsumedDynamicFilterIds();\n+            Map<String, VariableReferenceExpression> dynamicFilters = node.getDynamicFilters().entrySet().stream()\n+                    .filter(entry -> consumedProbeSide.contains(entry.getKey()))\n+                    .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue));\n+\n+            PlanWithConsumedDynamicFilters rightResult = node.getFilteringSource().accept(this, allowedDynamicFilterIds);\n+            Set<String> consumed = new HashSet<>(rightResult.getConsumedDynamicFilterIds());\n+            consumed.addAll(consumedProbeSide);\n+            consumed.removeAll(dynamicFilters.keySet());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b74d4edf8b455aba3a8edaf54edee3a6b8100f6e"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcwOTQ1OA==", "bodyText": "Same, you can merge them with visitJoin with a common helper", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r467709458", "createdAt": "2020-08-10T06:32:43Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/sanity/DynamicFiltersChecker.java", "diffHunk": "@@ -82,6 +83,24 @@ public void validate(PlanNode plan, Session session, Metadata metadata, SqlParse\n                 return ImmutableSet.copyOf(unmatched);\n             }\n \n+            @Override\n+            public Set<String> visitSemiJoin(SemiJoinNode node, Void context)\n+            {\n+                Set<String> currentJoinDynamicFilters = node.getDynamicFilters().keySet();\n+                Set<String> consumedProbeSide = node.getSource().accept(this, context);\n+                verify(\n+                        difference(currentJoinDynamicFilters, consumedProbeSide).isEmpty(),\n+                        \"Dynamic filters present in join were not fully consumed by it's probe side.\");\n+\n+                Set<String> consumedBuildSide = node.getFilteringSource().accept(this, context);\n+                verify(intersection(currentJoinDynamicFilters, consumedBuildSide).isEmpty());\n+\n+                Set<String> unmatched = new HashSet<>(consumedBuildSide);\n+                unmatched.addAll(consumedProbeSide);\n+                unmatched.removeAll(currentJoinDynamicFilters);\n+                return ImmutableSet.copyOf(unmatched);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b74d4edf8b455aba3a8edaf54edee3a6b8100f6e"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcxMjkxMg==", "bodyText": "You should have all XXXJoinNode to inherit this including spatial, index, etc.\npublic abstract class AbstractJoinNode\n        extends PlanNode\n{\n    protected AbstractJoinNode(PlanNodeId id)\n    {\n        super(id);\n    }\n\n    public abstract Map<String, VariableReferenceExpression> getDynamicFilters();\n\n    public abstract PlanNode getLeft();\n\n    public abstract PlanNode getRight();\n}", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r467712912", "createdAt": "2020-08-10T06:43:49Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/plan/NodeWithDynamicFilter.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.sql.planner.plan;\n+\n+import com.facebook.presto.spi.plan.PlanNode;\n+import com.facebook.presto.spi.relation.VariableReferenceExpression;\n+\n+import java.util.Map;\n+\n+public interface NodeWithDynamicFilter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51c68635db9c7257787b3177118d1fe1e6ba1639"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcxMzAzMA==", "bodyText": "extends AbstractJoinNode", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r467713030", "createdAt": "2020-08-10T06:44:13Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/plan/SemiJoinNode.java", "diffHunk": "@@ -32,6 +32,7 @@\n @Immutable\n public class SemiJoinNode\n         extends InternalPlanNode\n+        implements NodeWithDynamicFilter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51c68635db9c7257787b3177118d1fe1e6ba1639"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzcxMzA2Ng==", "bodyText": "extends AbstractJoinNode", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r467713066", "createdAt": "2020-08-10T06:44:23Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/plan/JoinNode.java", "diffHunk": "@@ -50,6 +50,7 @@\n @Immutable\n public class JoinNode\n         extends InternalPlanNode\n+        implements NodeWithDynamicFilter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "51c68635db9c7257787b3177118d1fe1e6ba1639"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "51c68635db9c7257787b3177118d1fe1e6ba1639", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/51c68635db9c7257787b3177118d1fe1e6ba1639", "committedDate": "2020-08-10T06:08:12Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}, "afterCommit": {"oid": "dc798e1332bf8da92841e73029ae22e9d9254f9e", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/dc798e1332bf8da92841e73029ae22e9d9254f9e", "committedDate": "2020-08-10T18:03:35Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "473e1bb4c79408e98c23743ca6724a00535d0bd5", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/473e1bb4c79408e98c23743ca6724a00535d0bd5", "committedDate": "2020-08-10T18:17:27Z", "message": "2\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}, "afterCommit": {"oid": "2eed7a0d32d3f24f299f5e79720f7701b9cf1fe6", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/2eed7a0d32d3f24f299f5e79720f7701b9cf1fe6", "committedDate": "2020-08-10T19:40:41Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NTkyODI1", "url": "https://github.com/prestodb/presto/pull/14997#pullrequestreview-464592825", "createdAt": "2020-08-10T21:14:28Z", "commit": {"oid": "2eed7a0d32d3f24f299f5e79720f7701b9cf1fe6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMToxNDoyOVrOG-gBzg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMToxNDoyOVrOG-gBzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE4OTY0Ng==", "bodyText": "Remove Side. A single word is good enough.", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r468189646", "createdAt": "2020-08-10T21:14:29Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/plan/JoinNodeInterface.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.sql.planner.plan;\n+\n+import com.facebook.presto.spi.plan.PlanNode;\n+import com.facebook.presto.spi.relation.VariableReferenceExpression;\n+\n+import java.util.Map;\n+\n+public interface JoinNodeInterface\n+{\n+    Map<String, VariableReferenceExpression> getDynamicFilters();\n+\n+    PlanNode getProbeSide();\n+\n+    PlanNode getBuildSide();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2eed7a0d32d3f24f299f5e79720f7701b9cf1fe6"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NTkzMzM2", "url": "https://github.com/prestodb/presto/pull/14997#pullrequestreview-464593336", "createdAt": "2020-08-10T21:15:17Z", "commit": {"oid": "2eed7a0d32d3f24f299f5e79720f7701b9cf1fe6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMToxNToxN1rOG-gDbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMToxNToxN1rOG-gDbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5MDA2MQ==", "bodyText": "This should inherit InternalPlanNode rather than being a new interface.", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r468190061", "createdAt": "2020-08-10T21:15:17Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/plan/JoinNodeInterface.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.sql.planner.plan;\n+\n+import com.facebook.presto.spi.plan.PlanNode;\n+import com.facebook.presto.spi.relation.VariableReferenceExpression;\n+\n+import java.util.Map;\n+\n+public interface JoinNodeInterface", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2eed7a0d32d3f24f299f5e79720f7701b9cf1fe6"}, "originalPosition": 21}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2eed7a0d32d3f24f299f5e79720f7701b9cf1fe6", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/2eed7a0d32d3f24f299f5e79720f7701b9cf1fe6", "committedDate": "2020-08-10T19:40:41Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}, "afterCommit": {"oid": "beb9536e6bd986bd1038adcd8a5e5b4f36be4c7f", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/beb9536e6bd986bd1038adcd8a5e5b4f36be4c7f", "committedDate": "2020-08-11T17:25:36Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "beb9536e6bd986bd1038adcd8a5e5b4f36be4c7f", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/beb9536e6bd986bd1038adcd8a5e5b4f36be4c7f", "committedDate": "2020-08-11T17:25:36Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}, "afterCommit": {"oid": "271b16e4a505626d90857ad98295d5e660d020b9", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/271b16e4a505626d90857ad98295d5e660d020b9", "committedDate": "2020-08-11T20:39:06Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NDE2MTg5", "url": "https://github.com/prestodb/presto/pull/14997#pullrequestreview-465416189", "createdAt": "2020-08-11T20:46:26Z", "commit": {"oid": "9991a46d701a242ef2d023213a8f545f9853888d"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQyMDo0NjoyNlrOG_Inmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQyMDo1MDoyNFrOG_Iv3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODg1NDY4Mg==", "bodyText": "extractDynamicFilterFromJoin", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r468854682", "createdAt": "2020-08-11T20:46:26Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/iterative/rule/RemoveUnsupportedDynamicFilters.java", "diffHunk": "@@ -106,42 +109,72 @@ public PlanWithConsumedDynamicFilters visitPlan(PlanNode node, Set<String> allow\n \n         @Override\n         public PlanWithConsumedDynamicFilters visitJoin(JoinNode node, Set<String> allowedDynamicFilterIds)\n+        {\n+            JoinDynamicFilterResult joinDynamicFilterResult = visitJoinUtil(node, allowedDynamicFilterIds);\n+            if (!joinDynamicFilterResult.getProbe().equals(node.getLeft()) || !joinDynamicFilterResult.getBuild().equals(node.getRight()) || !joinDynamicFilterResult.getDynamicFilters().equals(node.getDynamicFilters())) {\n+                return new PlanWithConsumedDynamicFilters(\n+                        new JoinNode(\n+                            node.getId(),\n+                            node.getType(),\n+                                joinDynamicFilterResult.getProbe(),\n+                                joinDynamicFilterResult.getBuild(),\n+                            node.getCriteria(),\n+                            node.getOutputVariables(),\n+                            node.getFilter(),\n+                            node.getLeftHashVariable(),\n+                            node.getRightHashVariable(),\n+                            node.getDistributionType(),\n+                                joinDynamicFilterResult.getDynamicFilters()),\n+                        ImmutableSet.copyOf(joinDynamicFilterResult.getConsumed()));\n+            }\n+            return new PlanWithConsumedDynamicFilters(node, ImmutableSet.copyOf(joinDynamicFilterResult.getConsumed()));\n+        }\n+\n+        @Override\n+        public PlanWithConsumedDynamicFilters visitSemiJoin(SemiJoinNode node, Set<String> allowedDynamicFilterIds)\n+        {\n+            JoinDynamicFilterResult joinDynamicFilterResult = visitJoinUtil(node, allowedDynamicFilterIds);\n+            if (!joinDynamicFilterResult.getProbe().equals(node.getSource())\n+                    || !joinDynamicFilterResult.getBuild().equals(node.getFilteringSource())\n+                    || !joinDynamicFilterResult.getDynamicFilters().equals(node.getDynamicFilters())) {\n+                return new PlanWithConsumedDynamicFilters(\n+                        new SemiJoinNode(\n+                                node.getId(),\n+                                joinDynamicFilterResult.getProbe(),\n+                                joinDynamicFilterResult.getBuild(),\n+                                node.getSourceJoinVariable(),\n+                                node.getFilteringSourceJoinVariable(),\n+                                node.getSemiJoinOutput(),\n+                                node.getSourceHashVariable(),\n+                                node.getFilteringSourceHashVariable(),\n+                                node.getDistributionType(),\n+                                joinDynamicFilterResult.getDynamicFilters()),\n+                        ImmutableSet.copyOf(joinDynamicFilterResult.getConsumed()));\n+            }\n+            return new PlanWithConsumedDynamicFilters(node, ImmutableSet.copyOf(joinDynamicFilterResult.getConsumed()));\n+        }\n+\n+        private JoinDynamicFilterResult visitJoinUtil(AbstractJoinNode node, Set<String> allowedDynamicFilterIds)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9991a46d701a242ef2d023213a8f545f9853888d"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODg1NTY4Mw==", "bodyText": "This is not a JsonProperty. It's an Override. Same for the one below", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r468855683", "createdAt": "2020-08-11T20:48:22Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/plan/JoinNode.java", "diffHunk": "@@ -231,12 +231,24 @@ public PlanNode getLeft()\n         return left;\n     }\n \n+    @JsonProperty", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9991a46d701a242ef2d023213a8f545f9853888d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODg1NTk1OA==", "bodyText": "same", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r468855958", "createdAt": "2020-08-11T20:48:55Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/plan/SemiJoinNode.java", "diffHunk": "@@ -78,12 +82,24 @@ public PlanNode getSource()\n         return source;\n     }\n \n+    @JsonProperty", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9991a46d701a242ef2d023213a8f545f9853888d"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODg1NTk5Mw==", "bodyText": "same", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r468855993", "createdAt": "2020-08-11T20:48:59Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/plan/SemiJoinNode.java", "diffHunk": "@@ -78,12 +82,24 @@ public PlanNode getSource()\n         return source;\n     }\n \n+    @JsonProperty\n+    public PlanNode getProbe()\n+    {\n+        return source;\n+    }\n+\n     @JsonProperty\n     public PlanNode getFilteringSource()\n     {\n         return filteringSource;\n     }\n \n+    @JsonProperty", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9991a46d701a242ef2d023213a8f545f9853888d"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODg1Njc5OA==", "bodyText": "extractUnmatchedDynamicFIlters\nprivate", "url": "https://github.com/prestodb/presto/pull/14997#discussion_r468856798", "createdAt": "2020-08-11T20:50:24Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/sanity/DynamicFiltersChecker.java", "diffHunk": "@@ -66,14 +68,25 @@ public void validate(PlanNode plan, Session session, Metadata metadata, SqlParse\n \n             @Override\n             public Set<String> visitJoin(JoinNode node, Void context)\n+            {\n+                return visitJoinUtil(node, context);\n+            }\n+\n+            @Override\n+            public Set<String> visitSemiJoin(SemiJoinNode node, Void context)\n+            {\n+                return visitJoinUtil(node, context);\n+            }\n+\n+            public Set<String> visitJoinUtil(AbstractJoinNode node, Void context)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9991a46d701a242ef2d023213a8f545f9853888d"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NDE5NTc5", "url": "https://github.com/prestodb/presto/pull/14997#pullrequestreview-465419579", "createdAt": "2020-08-11T20:51:41Z", "commit": {"oid": "271b16e4a505626d90857ad98295d5e660d020b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de0aa66ef86a80c4e2342764490b767a5dce8786", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/de0aa66ef86a80c4e2342764490b767a5dce8786", "committedDate": "2020-08-11T22:55:39Z", "message": "Add semi join dynamic filter placeholder\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f93705e1330daa4a5835efe608f3cee7ac42dd46", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/f93705e1330daa4a5835efe608f3cee7ac42dd46", "committedDate": "2020-08-11T22:55:39Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "271b16e4a505626d90857ad98295d5e660d020b9", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/271b16e4a505626d90857ad98295d5e660d020b9", "committedDate": "2020-08-11T20:39:06Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}, "afterCommit": {"oid": "f93705e1330daa4a5835efe608f3cee7ac42dd46", "author": {"user": {"login": "kewang1024", "name": "Ke"}}, "url": "https://github.com/prestodb/presto/commit/f93705e1330daa4a5835efe608f3cee7ac42dd46", "committedDate": "2020-08-11T22:55:39Z", "message": "Implement dynamic filtering collection for semi join\n\nCo-Authored-By: James Sun <jamessun@fb.com>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1133, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}