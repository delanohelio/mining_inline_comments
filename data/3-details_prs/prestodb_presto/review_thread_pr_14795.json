{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1MTAzOTI5", "number": 14795, "reviewThreads": {"totalCount": 23, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1MTowMFrOERSTdQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNzoyN1rOEScZCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYxMTQxOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveSplit.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1MTowMFrOG16qMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1MTowMFrOG16qMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE4ODc4NQ==", "bodyText": "nit: this.customSplitInfo = ImmutableMap.copyOf(requireNonNull(customSplitInfo, \"customSplitInfo is null\"));", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459188785", "createdAt": "2020-07-23T02:51:00Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveSplit.java", "diffHunk": "@@ -122,6 +124,7 @@ public HiveSplit(\n         this.extraFileInfo = extraFileInfo;\n         this.cacheQuotaRequirement = cacheQuotaRequirement;\n         this.encryptionInformation = encryptionInformation;\n+        this.customSplitInfo = customSplitInfo;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYxMTkwOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/InternalHiveSplit.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1MToyM1rOG16qdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1MToyM1rOG16qdw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE4ODg1NQ==", "bodyText": "ditto", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459188855", "createdAt": "2020-07-23T02:51:23Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/InternalHiveSplit.java", "diffHunk": "@@ -106,6 +108,7 @@ public InternalHiveSplit(\n         this.s3SelectPushdownEnabled = s3SelectPushdownEnabled;\n         this.partitionInfo = partitionInfo;\n         this.extraFileInfo = extraFileInfo;\n+        this.customSplitInfo = customSplitInfo;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYxNDc1OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveFileFormats.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1MzoyNVrOG16sHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1MzoyNVrOG16sHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE4OTI3OQ==", "bodyText": "We usually don't pass null neither return null. Pass ImmutableMap.of(). Same for other similar call sites.", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459189279", "createdAt": "2020-07-23T02:53:25Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveFileFormats.java", "diffHunk": "@@ -905,7 +905,8 @@ private void testCursorProvider(HiveRecordCursorProvider cursorProvider,\n                 TRUE_CONSTANT,\n                 false,\n                 ROW_EXPRESSION_SERVICE,\n-                Optional.empty());\n+                Optional.empty(),\n+                null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYxNTI4OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveSplit.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1Mzo1MFrOG16sbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1Mzo1MFrOG16sbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE4OTM1Ng==", "bodyText": "ImmutableMap.of()", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459189356", "createdAt": "2020-07-23T02:53:50Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveSplit.java", "diffHunk": "@@ -63,6 +65,8 @@ public void testJsonRoundTrip()\n     {\n         ImmutableList<HivePartitionKey> partitionKeys = ImmutableList.of(new HivePartitionKey(\"a\", \"apple\"), new HivePartitionKey(\"b\", \"42\"));\n         ImmutableList<HostAddress> addresses = ImmutableList.of(HostAddress.fromParts(\"127.0.0.1\", 44), HostAddress.fromParts(\"127.0.0.1\", 45));\n+        Map<String, String> customSplitInfo = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYxNzc5OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveUtil.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1NTowMlrOG16tow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1NTowMlrOG16tow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE4OTY2Nw==", "bodyText": "Don't check for null. The general assumption is that the method parameters are never null.", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459189667", "createdAt": "2020-07-23T02:55:02Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveUtil.java", "diffHunk": "@@ -211,14 +217,26 @@ private HiveUtil()\n         // Tell hive the columns we would like to read, this lets hive optimize reading column oriented files\n         setReadColumns(configuration, readHiveColumnIndexes);\n \n+        // Only propagate serialization schema configs by default\n+        Predicate<String> schemaFilter = schemaProperty -> schemaProperty.startsWith(\"serialization.\");\n+\n         InputFormat<?, ?> inputFormat = getInputFormat(configuration, getInputFormatName(schema), true);\n         JobConf jobConf = toJobConf(configuration);\n         FileSplit fileSplit = new FileSplit(path, start, length, (String[]) null);\n+        if (customSplitInfo != null && !customSplitInfo.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYyNDU0OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1OTozMVrOG16xNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1OTozMVrOG16xNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MDU4Mg==", "bodyText": "nit: how about simply extractCustomSplitInfo?", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459190582", "createdAt": "2020-07-23T02:59:31Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.facebook.presto.spi.PrestoException;\n+import com.google.common.collect.ImmutableList;\n+import org.apache.hadoop.mapred.FileSplit;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static com.facebook.presto.hive.HiveErrorCode.HIVE_UNSUPPORTED_FORMAT;\n+\n+/**\n+ * Utility class for both extracting customSplitInfo Map from a custom FileSplit and transforming the customSplitInfo back into a FileSplit.\n+ */\n+public class CustomSplitConversionUtils\n+{\n+    private static final List<CustomSplitConverter> converters = ImmutableList.of(new HudiRealtimeSplitConverter());\n+\n+    private CustomSplitConversionUtils()\n+    {\n+    }\n+\n+    public static Map<String, String> extractAnyCustomSplitInfo(FileSplit split)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYyNDY1OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1OTo0MVrOG16xSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMjo1OTo0MVrOG16xSQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MDYwMQ==", "bodyText": "Inline this", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459190601", "createdAt": "2020-07-23T02:59:41Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.facebook.presto.spi.PrestoException;\n+import com.google.common.collect.ImmutableList;\n+import org.apache.hadoop.mapred.FileSplit;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static com.facebook.presto.hive.HiveErrorCode.HIVE_UNSUPPORTED_FORMAT;\n+\n+/**\n+ * Utility class for both extracting customSplitInfo Map from a custom FileSplit and transforming the customSplitInfo back into a FileSplit.\n+ */\n+public class CustomSplitConversionUtils\n+{\n+    private static final List<CustomSplitConverter> converters = ImmutableList.of(new HudiRealtimeSplitConverter());\n+\n+    private CustomSplitConversionUtils()\n+    {\n+    }\n+\n+    public static Map<String, String> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        Optional<Map<String, String>> customSplitData;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYyNTUyOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMDowOVrOG16xsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMDowOVrOG16xsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MDcwNQ==", "bodyText": "ditto about method name (extractCustomSplitInfo )", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459190705", "createdAt": "2020-07-23T03:00:09Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.facebook.presto.spi.PrestoException;\n+import com.google.common.collect.ImmutableList;\n+import org.apache.hadoop.mapred.FileSplit;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static com.facebook.presto.hive.HiveErrorCode.HIVE_UNSUPPORTED_FORMAT;\n+\n+/**\n+ * Utility class for both extracting customSplitInfo Map from a custom FileSplit and transforming the customSplitInfo back into a FileSplit.\n+ */\n+public class CustomSplitConversionUtils\n+{\n+    private static final List<CustomSplitConverter> converters = ImmutableList.of(new HudiRealtimeSplitConverter());\n+\n+    private CustomSplitConversionUtils()\n+    {\n+    }\n+\n+    public static Map<String, String> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        Optional<Map<String, String>> customSplitData;\n+        for (CustomSplitConverter converter : converters) {\n+            customSplitData = converter.extractAnyCustomSplitInfo(split);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYyNTgzOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMDoyNVrOG16x4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMDoyNVrOG16x4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MDc1Mw==", "bodyText": "move it under the loop", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459190753", "createdAt": "2020-07-23T03:00:25Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.facebook.presto.spi.PrestoException;\n+import com.google.common.collect.ImmutableList;\n+import org.apache.hadoop.mapred.FileSplit;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static com.facebook.presto.hive.HiveErrorCode.HIVE_UNSUPPORTED_FORMAT;\n+\n+/**\n+ * Utility class for both extracting customSplitInfo Map from a custom FileSplit and transforming the customSplitInfo back into a FileSplit.\n+ */\n+public class CustomSplitConversionUtils\n+{\n+    private static final List<CustomSplitConverter> converters = ImmutableList.of(new HudiRealtimeSplitConverter());\n+\n+    private CustomSplitConversionUtils()\n+    {\n+    }\n+\n+    public static Map<String, String> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        Optional<Map<String, String>> customSplitData;\n+        for (CustomSplitConverter converter : converters) {\n+            customSplitData = converter.extractAnyCustomSplitInfo(split);\n+            if (customSplitData.isPresent()) {\n+                return customSplitData.get();\n+            }\n+        }\n+        return Collections.emptyMap();\n+    }\n+\n+    public static FileSplit recreateSplitWithCustomInfo(FileSplit split, Map<String, String> customSplitInfo)\n+    {\n+        Optional<FileSplit> fileSplit;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 53}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYyNjgzOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMTowOFrOG16yZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMTowOFrOG16yZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MDg4NQ==", "bodyText": "...format(\"Split converted %s failed to create FileSplit\", converter.getClass()), e", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459190885", "createdAt": "2020-07-23T03:01:08Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.facebook.presto.spi.PrestoException;\n+import com.google.common.collect.ImmutableList;\n+import org.apache.hadoop.mapred.FileSplit;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static com.facebook.presto.hive.HiveErrorCode.HIVE_UNSUPPORTED_FORMAT;\n+\n+/**\n+ * Utility class for both extracting customSplitInfo Map from a custom FileSplit and transforming the customSplitInfo back into a FileSplit.\n+ */\n+public class CustomSplitConversionUtils\n+{\n+    private static final List<CustomSplitConverter> converters = ImmutableList.of(new HudiRealtimeSplitConverter());\n+\n+    private CustomSplitConversionUtils()\n+    {\n+    }\n+\n+    public static Map<String, String> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        Optional<Map<String, String>> customSplitData;\n+        for (CustomSplitConverter converter : converters) {\n+            customSplitData = converter.extractAnyCustomSplitInfo(split);\n+            if (customSplitData.isPresent()) {\n+                return customSplitData.get();\n+            }\n+        }\n+        return Collections.emptyMap();\n+    }\n+\n+    public static FileSplit recreateSplitWithCustomInfo(FileSplit split, Map<String, String> customSplitInfo)\n+    {\n+        Optional<FileSplit> fileSplit;\n+        for (CustomSplitConverter converter : converters) {\n+            try {\n+                fileSplit = converter.recreateSplitWithCustomInfo(split, customSplitInfo);\n+            }\n+            catch (IOException e) {\n+                throw new PrestoException(HIVE_UNSUPPORTED_FORMAT, \"Split converter : \" + converter.getClass() + \" failed to create fileSplit.\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYyNzk2OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMTo1MVrOG16y-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMTo1MVrOG16y-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MTAzMw==", "bodyText": "Use ImmutableMap.builder()", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459191033", "createdAt": "2020-07-23T03:01:51Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.google.common.base.Strings;\n+import org.apache.hadoop.mapred.FileSplit;\n+import org.apache.hudi.hadoop.realtime.HoodieRealtimeFileSplit;\n+\n+import java.io.IOException;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+/**\n+ * HoodieRealtimeFileSplit specific implementation of CustomSplitConverter.\n+ * Extracts customSplitInfo from HoodieRealtimeFileSplit and reconstructs HoodieRealtimeFileSplit from Map.\n+ */\n+public class HudiRealtimeSplitConverter\n+        implements CustomSplitConverter\n+{\n+    private static final String CUSTOM_SPLIT_CLASS_KEY = \"custom_split_class\";\n+    private static final String HUDI_DELTA_FILEPATHS_KEY = \"hudi_delta_filepaths\";\n+    private static final String HUDI_BASEPATH_KEY = \"hudi_basepath\";\n+    private static final String HUDI_MAX_COMMIT_TIME_KEY = \"hudi_max_commit_time\";\n+\n+    @Override\n+    public Optional<Map<String, String>> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        if (split instanceof HoodieRealtimeFileSplit) {\n+            Map<String, String> customSplitInfo = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYyODc3OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMjozOVrOG16zeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMjozOVrOG16zeg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MTE2Mg==", "bodyText": "Remove this, parameters is not null by default", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459191162", "createdAt": "2020-07-23T03:02:39Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.google.common.base.Strings;\n+import org.apache.hadoop.mapred.FileSplit;\n+import org.apache.hudi.hadoop.realtime.HoodieRealtimeFileSplit;\n+\n+import java.io.IOException;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+/**\n+ * HoodieRealtimeFileSplit specific implementation of CustomSplitConverter.\n+ * Extracts customSplitInfo from HoodieRealtimeFileSplit and reconstructs HoodieRealtimeFileSplit from Map.\n+ */\n+public class HudiRealtimeSplitConverter\n+        implements CustomSplitConverter\n+{\n+    private static final String CUSTOM_SPLIT_CLASS_KEY = \"custom_split_class\";\n+    private static final String HUDI_DELTA_FILEPATHS_KEY = \"hudi_delta_filepaths\";\n+    private static final String HUDI_BASEPATH_KEY = \"hudi_basepath\";\n+    private static final String HUDI_MAX_COMMIT_TIME_KEY = \"hudi_max_commit_time\";\n+\n+    @Override\n+    public Optional<Map<String, String>> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        if (split instanceof HoodieRealtimeFileSplit) {\n+            Map<String, String> customSplitInfo = new HashMap<>();\n+            HoodieRealtimeFileSplit hudiSplit = (HoodieRealtimeFileSplit) split;\n+            customSplitInfo.put(CUSTOM_SPLIT_CLASS_KEY, HoodieRealtimeFileSplit.class.getName());\n+            customSplitInfo.put(HUDI_DELTA_FILEPATHS_KEY, String.join(\",\", hudiSplit.getDeltaLogPaths()));\n+            customSplitInfo.put(HUDI_BASEPATH_KEY, hudiSplit.getBasePath());\n+            customSplitInfo.put(HUDI_MAX_COMMIT_TIME_KEY, hudiSplit.getMaxCommitTime());\n+            return Optional.of(customSplitInfo);\n+        }\n+        return Optional.empty();\n+    }\n+\n+    @Override\n+    public Optional<FileSplit> recreateSplitWithCustomInfo(FileSplit split, Map<String, String> customSplitInfo) throws IOException\n+    {\n+        requireNonNull(customSplitInfo);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYyOTk0OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMzozMlrOG160JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowMzozMlrOG160JA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MTMzMg==", "bodyText": "How about\nString customSplitClass = customSplitInfo.get(CUSTOM_SPLIT_CLASS_KEY);\nif(HoodieRealtimeFileSplit.class.getName().equals(customSplitClass)){\n...\n}", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459191332", "createdAt": "2020-07-23T03:03:32Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.google.common.base.Strings;\n+import org.apache.hadoop.mapred.FileSplit;\n+import org.apache.hudi.hadoop.realtime.HoodieRealtimeFileSplit;\n+\n+import java.io.IOException;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+/**\n+ * HoodieRealtimeFileSplit specific implementation of CustomSplitConverter.\n+ * Extracts customSplitInfo from HoodieRealtimeFileSplit and reconstructs HoodieRealtimeFileSplit from Map.\n+ */\n+public class HudiRealtimeSplitConverter\n+        implements CustomSplitConverter\n+{\n+    private static final String CUSTOM_SPLIT_CLASS_KEY = \"custom_split_class\";\n+    private static final String HUDI_DELTA_FILEPATHS_KEY = \"hudi_delta_filepaths\";\n+    private static final String HUDI_BASEPATH_KEY = \"hudi_basepath\";\n+    private static final String HUDI_MAX_COMMIT_TIME_KEY = \"hudi_max_commit_time\";\n+\n+    @Override\n+    public Optional<Map<String, String>> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        if (split instanceof HoodieRealtimeFileSplit) {\n+            Map<String, String> customSplitInfo = new HashMap<>();\n+            HoodieRealtimeFileSplit hudiSplit = (HoodieRealtimeFileSplit) split;\n+            customSplitInfo.put(CUSTOM_SPLIT_CLASS_KEY, HoodieRealtimeFileSplit.class.getName());\n+            customSplitInfo.put(HUDI_DELTA_FILEPATHS_KEY, String.join(\",\", hudiSplit.getDeltaLogPaths()));\n+            customSplitInfo.put(HUDI_BASEPATH_KEY, hudiSplit.getBasePath());\n+            customSplitInfo.put(HUDI_MAX_COMMIT_TIME_KEY, hudiSplit.getMaxCommitTime());\n+            return Optional.of(customSplitInfo);\n+        }\n+        return Optional.empty();\n+    }\n+\n+    @Override\n+    public Optional<FileSplit> recreateSplitWithCustomInfo(FileSplit split, Map<String, String> customSplitInfo) throws IOException\n+    {\n+        requireNonNull(customSplitInfo);\n+        if (customSplitInfo.containsKey(CUSTOM_SPLIT_CLASS_KEY) && customSplitInfo.get(CUSTOM_SPLIT_CLASS_KEY).equals(HoodieRealtimeFileSplit.class.getName())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 61}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYzMzE4OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowNTozMlrOG1611g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowNjoxNVrOG162dA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MTc2Ng==", "bodyText": "customSplitInfo.get(HUDI_DELTA_FILEPATHS_KEY) should never be null, right? If it is - it is a programming error.\nSo, simply\nList<String> deltaLogPaths = Splitter.on(',').splitToList(customSplitInfo.get(HUDI_DELTA_FILEPATHS_KEY))", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459191766", "createdAt": "2020-07-23T03:05:32Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.google.common.base.Strings;\n+import org.apache.hadoop.mapred.FileSplit;\n+import org.apache.hudi.hadoop.realtime.HoodieRealtimeFileSplit;\n+\n+import java.io.IOException;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+/**\n+ * HoodieRealtimeFileSplit specific implementation of CustomSplitConverter.\n+ * Extracts customSplitInfo from HoodieRealtimeFileSplit and reconstructs HoodieRealtimeFileSplit from Map.\n+ */\n+public class HudiRealtimeSplitConverter\n+        implements CustomSplitConverter\n+{\n+    private static final String CUSTOM_SPLIT_CLASS_KEY = \"custom_split_class\";\n+    private static final String HUDI_DELTA_FILEPATHS_KEY = \"hudi_delta_filepaths\";\n+    private static final String HUDI_BASEPATH_KEY = \"hudi_basepath\";\n+    private static final String HUDI_MAX_COMMIT_TIME_KEY = \"hudi_max_commit_time\";\n+\n+    @Override\n+    public Optional<Map<String, String>> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        if (split instanceof HoodieRealtimeFileSplit) {\n+            Map<String, String> customSplitInfo = new HashMap<>();\n+            HoodieRealtimeFileSplit hudiSplit = (HoodieRealtimeFileSplit) split;\n+            customSplitInfo.put(CUSTOM_SPLIT_CLASS_KEY, HoodieRealtimeFileSplit.class.getName());\n+            customSplitInfo.put(HUDI_DELTA_FILEPATHS_KEY, String.join(\",\", hudiSplit.getDeltaLogPaths()));\n+            customSplitInfo.put(HUDI_BASEPATH_KEY, hudiSplit.getBasePath());\n+            customSplitInfo.put(HUDI_MAX_COMMIT_TIME_KEY, hudiSplit.getMaxCommitTime());\n+            return Optional.of(customSplitInfo);\n+        }\n+        return Optional.empty();\n+    }\n+\n+    @Override\n+    public Optional<FileSplit> recreateSplitWithCustomInfo(FileSplit split, Map<String, String> customSplitInfo) throws IOException\n+    {\n+        requireNonNull(customSplitInfo);\n+        if (customSplitInfo.containsKey(CUSTOM_SPLIT_CLASS_KEY) && customSplitInfo.get(CUSTOM_SPLIT_CLASS_KEY).equals(HoodieRealtimeFileSplit.class.getName())) {\n+            List<String> deltaLogPaths = Strings.isNullOrEmpty(customSplitInfo.get(HUDI_DELTA_FILEPATHS_KEY)) ? Collections.emptyList() :", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MTkyNA==", "bodyText": "Just in case you can check it for null (requireNonNull(customSplitInfo.get(HUDI_DELTA_FILEPATHS_KEY), \"HUDI_DELTA_FILEPATHS_KEY is missing\"))", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459191924", "createdAt": "2020-07-23T03:06:15Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.google.common.base.Strings;\n+import org.apache.hadoop.mapred.FileSplit;\n+import org.apache.hudi.hadoop.realtime.HoodieRealtimeFileSplit;\n+\n+import java.io.IOException;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+/**\n+ * HoodieRealtimeFileSplit specific implementation of CustomSplitConverter.\n+ * Extracts customSplitInfo from HoodieRealtimeFileSplit and reconstructs HoodieRealtimeFileSplit from Map.\n+ */\n+public class HudiRealtimeSplitConverter\n+        implements CustomSplitConverter\n+{\n+    private static final String CUSTOM_SPLIT_CLASS_KEY = \"custom_split_class\";\n+    private static final String HUDI_DELTA_FILEPATHS_KEY = \"hudi_delta_filepaths\";\n+    private static final String HUDI_BASEPATH_KEY = \"hudi_basepath\";\n+    private static final String HUDI_MAX_COMMIT_TIME_KEY = \"hudi_max_commit_time\";\n+\n+    @Override\n+    public Optional<Map<String, String>> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        if (split instanceof HoodieRealtimeFileSplit) {\n+            Map<String, String> customSplitInfo = new HashMap<>();\n+            HoodieRealtimeFileSplit hudiSplit = (HoodieRealtimeFileSplit) split;\n+            customSplitInfo.put(CUSTOM_SPLIT_CLASS_KEY, HoodieRealtimeFileSplit.class.getName());\n+            customSplitInfo.put(HUDI_DELTA_FILEPATHS_KEY, String.join(\",\", hudiSplit.getDeltaLogPaths()));\n+            customSplitInfo.put(HUDI_BASEPATH_KEY, hudiSplit.getBasePath());\n+            customSplitInfo.put(HUDI_MAX_COMMIT_TIME_KEY, hudiSplit.getMaxCommitTime());\n+            return Optional.of(customSplitInfo);\n+        }\n+        return Optional.empty();\n+    }\n+\n+    @Override\n+    public Optional<FileSplit> recreateSplitWithCustomInfo(FileSplit split, Map<String, String> customSplitInfo) throws IOException\n+    {\n+        requireNonNull(customSplitInfo);\n+        if (customSplitInfo.containsKey(CUSTOM_SPLIT_CLASS_KEY) && customSplitInfo.get(CUSTOM_SPLIT_CLASS_KEY).equals(HoodieRealtimeFileSplit.class.getName())) {\n+            List<String> deltaLogPaths = Strings.isNullOrEmpty(customSplitInfo.get(HUDI_DELTA_FILEPATHS_KEY)) ? Collections.emptyList() :", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MTc2Ng=="}, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 62}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYzNjU1OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowNzo1N1rOG163tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowNzo1N1rOG163tQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MjI0NQ==", "bodyText": "I would recommend checking the customSplitInfo.get(HUDI_BASEPATH_KEY), customSplitInfo.get(HUDI_MAX_COMMIT_TIME_KEY) for null\nAlso let's go with the one parameter at a line style\nreturn Optional.of(new HoodieRealtimeFileSplit(\n  split, \n  requireNonNull(customSplitInfo.get(HUDI_BASEPATH_KEY), \"HUDI_BASEPATH_KEY is missing\"), \n  deltaLogPaths, \n  requireNonNull(customSplitInfo.get(HUDI_MAX_COMMIT_TIME_KEY), \"HUDI_MAX_COMMIT_TIME_KEY is missing\")))", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459192245", "createdAt": "2020-07-23T03:07:57Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.google.common.base.Strings;\n+import org.apache.hadoop.mapred.FileSplit;\n+import org.apache.hudi.hadoop.realtime.HoodieRealtimeFileSplit;\n+\n+import java.io.IOException;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+/**\n+ * HoodieRealtimeFileSplit specific implementation of CustomSplitConverter.\n+ * Extracts customSplitInfo from HoodieRealtimeFileSplit and reconstructs HoodieRealtimeFileSplit from Map.\n+ */\n+public class HudiRealtimeSplitConverter\n+        implements CustomSplitConverter\n+{\n+    private static final String CUSTOM_SPLIT_CLASS_KEY = \"custom_split_class\";\n+    private static final String HUDI_DELTA_FILEPATHS_KEY = \"hudi_delta_filepaths\";\n+    private static final String HUDI_BASEPATH_KEY = \"hudi_basepath\";\n+    private static final String HUDI_MAX_COMMIT_TIME_KEY = \"hudi_max_commit_time\";\n+\n+    @Override\n+    public Optional<Map<String, String>> extractAnyCustomSplitInfo(FileSplit split)\n+    {\n+        if (split instanceof HoodieRealtimeFileSplit) {\n+            Map<String, String> customSplitInfo = new HashMap<>();\n+            HoodieRealtimeFileSplit hudiSplit = (HoodieRealtimeFileSplit) split;\n+            customSplitInfo.put(CUSTOM_SPLIT_CLASS_KEY, HoodieRealtimeFileSplit.class.getName());\n+            customSplitInfo.put(HUDI_DELTA_FILEPATHS_KEY, String.join(\",\", hudiSplit.getDeltaLogPaths()));\n+            customSplitInfo.put(HUDI_BASEPATH_KEY, hudiSplit.getBasePath());\n+            customSplitInfo.put(HUDI_MAX_COMMIT_TIME_KEY, hudiSplit.getMaxCommitTime());\n+            return Optional.of(customSplitInfo);\n+        }\n+        return Optional.empty();\n+    }\n+\n+    @Override\n+    public Optional<FileSplit> recreateSplitWithCustomInfo(FileSplit split, Map<String, String> customSplitInfo) throws IOException\n+    {\n+        requireNonNull(customSplitInfo);\n+        if (customSplitInfo.containsKey(CUSTOM_SPLIT_CLASS_KEY) && customSplitInfo.get(CUSTOM_SPLIT_CLASS_KEY).equals(HoodieRealtimeFileSplit.class.getName())) {\n+            List<String> deltaLogPaths = Strings.isNullOrEmpty(customSplitInfo.get(HUDI_DELTA_FILEPATHS_KEY)) ? Collections.emptyList() :\n+                    Arrays.asList(customSplitInfo.get(HUDI_DELTA_FILEPATHS_KEY).split(\",\"));\n+            split = new HoodieRealtimeFileSplit(split, customSplitInfo.get(HUDI_BASEPATH_KEY), deltaLogPaths, customSplitInfo.get(HUDI_MAX_COMMIT_TIME_KEY));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 64}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTYzNzU2OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConverter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowODoyOVrOG164KQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzowODoyOVrOG164KQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MjM2MQ==", "bodyText": "Maybe recreateFileSplitFromCustomInfo?", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459192361", "createdAt": "2020-07-23T03:08:29Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConverter.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import org.apache.hadoop.mapred.FileSplit;\n+\n+import java.io.IOException;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+/**\n+ * Interface for Split specific implementation of conversion from Split -> customSplitInfo Map and back.\n+ */\n+public interface CustomSplitConverter\n+{\n+    /**\n+     * This method is expected to return optional.empty() if the FileSplit does not match the split converter.\n+     */\n+    Optional<Map<String, String>> extractAnyCustomSplitInfo(FileSplit split);\n+\n+    /**\n+     * This method is expected to merge the customSplitInfo with split to recreate the custom FileSplit.\n+     * It is expected to return optional.empty() if the customSplitInfo does not match the split converter.\n+     */\n+    Optional<FileSplit> recreateSplitWithCustomInfo(FileSplit split, Map<String, String> customSplitInfo) throws IOException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTY0MzEwOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveUtil.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoxMjowOFrOG167LA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoxMjowOFrOG167LA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MzEzMg==", "bodyText": "Let's merge it into a one test case method. It generally verifies the same thing, but just different return", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459193132", "createdAt": "2020-07-23T03:12:08Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveUtil.java", "diffHunk": "@@ -87,6 +94,20 @@ public void testToPartitionValues()\n         assertToPartitionValues(\"pk=__HIVE_DEFAULT_PARTITION__\");\n     }\n \n+    @Test\n+    public void testShouldUseRecordReaderFromInputFormatTrue()\n+    {\n+        StorageFormat storageFormat = StorageFormat.create(\"parquet.hive.serde.ParquetHiveSerDe\", \"org.apache.hudi.hadoop.realtime.HoodieParquetRealtimeInputFormat\", \"\");\n+        assertTrue(shouldUseRecordReaderFromInputFormat(new Configuration(), new Storage(storageFormat, \"test\", Optional.empty(), true, Collections.emptyMap(), Collections.emptyMap())));\n+    }\n+\n+    @Test\n+    public void testShouldUseRecordReaderFromInputFormatFalse()\n+    {\n+        StorageFormat storageFormat = StorageFormat.create(\"parquet.hive.serde.ParquetHiveSerDe\", \"org.apache.hudi.hadoop.HoodieParquetInputFormat\", \"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTY0NTIyOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/com/facebook/presto/hive/parquet/TestParquetPageSourceFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoxMjo1OVrOG168OQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoxMjo1OVrOG168OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5MzQwMQ==", "bodyText": "Let's initialize it in @BeforeClass. Also please add the @AfterClass(alwaysRun=true) method and nullify the field there", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459193401", "createdAt": "2020-07-23T03:12:59Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/parquet/TestParquetPageSourceFactory.java", "diffHunk": "@@ -0,0 +1,69 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.parquet;\n+\n+import com.facebook.presto.common.type.TestingTypeManager;\n+import com.facebook.presto.hive.FileFormatDataSourceStats;\n+import com.facebook.presto.hive.HdfsConfigurationInitializer;\n+import com.facebook.presto.hive.HdfsEnvironment;\n+import com.facebook.presto.hive.HiveClientConfig;\n+import com.facebook.presto.hive.HiveHdfsConfiguration;\n+import com.facebook.presto.hive.MetastoreClientConfig;\n+import com.facebook.presto.hive.authentication.NoHdfsAuthentication;\n+import com.facebook.presto.hive.metastore.Storage;\n+import com.facebook.presto.hive.metastore.StorageFormat;\n+import com.facebook.presto.spi.ConnectorPageSource;\n+import com.google.common.collect.ImmutableSet;\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hudi.hadoop.realtime.HoodieParquetRealtimeInputFormat;\n+import org.testng.annotations.BeforeTest;\n+import org.testng.annotations.Test;\n+\n+import java.util.Collections;\n+import java.util.Optional;\n+\n+import static org.testng.Assert.assertFalse;\n+\n+public class TestParquetPageSourceFactory\n+{\n+    private static final String PARQUET_HIVE_SERDE = \"parquet.hive.serde.ParquetHiveSerDe\";\n+\n+    private ParquetPageSourceFactory parquetPageSourceFactory;\n+\n+    @BeforeTest", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg2NTY0NzcxOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveUtil.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoxNDo1OVrOG169nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yM1QwMzoxNDo1OVrOG169nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTE5Mzc1Nw==", "bodyText": "It feels like this branch is too generic. Let's add this special extra logic only if the split is the HoodieRealtimeFileSplit", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r459193757", "createdAt": "2020-07-23T03:14:59Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveUtil.java", "diffHunk": "@@ -211,14 +217,26 @@ private HiveUtil()\n         // Tell hive the columns we would like to read, this lets hive optimize reading column oriented files\n         setReadColumns(configuration, readHiveColumnIndexes);\n \n+        // Only propagate serialization schema configs by default\n+        Predicate<String> schemaFilter = schemaProperty -> schemaProperty.startsWith(\"serialization.\");\n+\n         InputFormat<?, ?> inputFormat = getInputFormat(configuration, getInputFormatName(schema), true);\n         JobConf jobConf = toJobConf(configuration);\n         FileSplit fileSplit = new FileSplit(path, start, length, (String[]) null);\n+        if (customSplitInfo != null && !customSplitInfo.isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4831a4b860495aee23a8f85cc753ada74588353e"}, "originalPosition": 65}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Nzc0MTU3OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNTozMFrOG3oCDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNTozMFrOG3oCDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4MDc1MA==", "bodyText": "nit: prefer ImmutableMap.of", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r460980750", "createdAt": "2020-07-27T15:35:30Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/CustomSplitConversionUtils.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.facebook.presto.spi.PrestoException;\n+import com.google.common.collect.ImmutableList;\n+import org.apache.hadoop.mapred.FileSplit;\n+\n+import java.io.IOException;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static com.facebook.presto.hive.HiveErrorCode.HIVE_UNSUPPORTED_FORMAT;\n+\n+/**\n+ * Utility class for both extracting customSplitInfo Map from a custom FileSplit and transforming the customSplitInfo back into a FileSplit.\n+ */\n+public class CustomSplitConversionUtils\n+{\n+    private static final List<CustomSplitConverter> converters = ImmutableList.of(new HudiRealtimeSplitConverter());\n+\n+    private CustomSplitConversionUtils()\n+    {\n+    }\n+\n+    public static Map<String, String> extractCustomSplitInfo(FileSplit split)\n+    {\n+        for (CustomSplitConverter converter : converters) {\n+            Optional<Map<String, String>> customSplitData = converter.extractCustomSplitInfo(split);\n+            if (customSplitData.isPresent()) {\n+                return customSplitData.get();\n+            }\n+        }\n+        return Collections.emptyMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aabdf3ed1399afdc2189f9c0865f69bf9564617e"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Nzc0NjUyOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNjozOVrOG3oFGA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNjozOVrOG3oFGA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4MTUyOA==", "bodyText": "Why the HoodieRealtimeFileSplit  is created twice?", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r460981528", "createdAt": "2020-07-27T15:36:39Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/HudiRealtimeSplitConverter.java", "diffHunk": "@@ -0,0 +1,72 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive.util;\n+\n+import com.google.common.collect.ImmutableMap;\n+import org.apache.hadoop.mapred.FileSplit;\n+import org.apache.hudi.hadoop.realtime.HoodieRealtimeFileSplit;\n+\n+import java.io.IOException;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+/**\n+ * HoodieRealtimeFileSplit specific implementation of CustomSplitConverter.\n+ * Extracts customSplitInfo from HoodieRealtimeFileSplit and reconstructs HoodieRealtimeFileSplit from Map.\n+ */\n+public class HudiRealtimeSplitConverter\n+        implements CustomSplitConverter\n+{\n+    public static final String CUSTOM_SPLIT_CLASS_KEY = \"custom_split_class\";\n+    private static final String HUDI_DELTA_FILEPATHS_KEY = \"hudi_delta_filepaths\";\n+    private static final String HUDI_BASEPATH_KEY = \"hudi_basepath\";\n+    private static final String HUDI_MAX_COMMIT_TIME_KEY = \"hudi_max_commit_time\";\n+\n+    @Override\n+    public Optional<Map<String, String>> extractCustomSplitInfo(FileSplit split)\n+    {\n+        if (split instanceof HoodieRealtimeFileSplit) {\n+            HoodieRealtimeFileSplit hudiSplit = (HoodieRealtimeFileSplit) split;\n+            Map<String, String> customSplitInfo = ImmutableMap.<String, String>builder()\n+                    .put(CUSTOM_SPLIT_CLASS_KEY, HoodieRealtimeFileSplit.class.getName())\n+                    .put(HUDI_DELTA_FILEPATHS_KEY, String.join(\",\", hudiSplit.getDeltaLogPaths()))\n+                    .put(HUDI_BASEPATH_KEY, hudiSplit.getBasePath())\n+                    .put(HUDI_MAX_COMMIT_TIME_KEY, hudiSplit.getMaxCommitTime())\n+                    .build();\n+            return Optional.of(customSplitInfo);\n+        }\n+        return Optional.empty();\n+    }\n+\n+    @Override\n+    public Optional<FileSplit> recreateFileSplitWithCustomInfo(FileSplit split, Map<String, String> customSplitInfo) throws IOException\n+    {\n+        String customSplitClass = customSplitInfo.get(CUSTOM_SPLIT_CLASS_KEY);\n+        if (HoodieRealtimeFileSplit.class.getName().equals(customSplitClass)) {\n+            requireNonNull(customSplitInfo.get(HUDI_DELTA_FILEPATHS_KEY), \"HUDI_DELTA_FILEPATHS_KEY is missing\");\n+            List<String> deltaLogPaths = Arrays.asList(customSplitInfo.get(HUDI_DELTA_FILEPATHS_KEY).split(\",\"));\n+            split = new HoodieRealtimeFileSplit(split, customSplitInfo.get(HUDI_BASEPATH_KEY), deltaLogPaths, customSplitInfo.get(HUDI_MAX_COMMIT_TIME_KEY));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aabdf3ed1399afdc2189f9c0865f69bf9564617e"}, "originalPosition": 63}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Nzc0ODg1OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/InternalHiveSplitFactory.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNzoxMVrOG3oGgg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNzoxMVrOG3oGgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4MTg5MA==", "bodyText": "nit: prefer ImmutableMap.of (here and in other similar places)", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r460981890", "createdAt": "2020-07-27T15:37:11Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/util/InternalHiveSplitFactory.java", "diffHunk": "@@ -98,13 +101,15 @@ public InternalHiveSplitFactory(\n                 readBucketNumber,\n                 tableBucketNumber,\n                 splittable,\n-                fileInfo.getExtraFileInfo());\n+                fileInfo.getExtraFileInfo(),\n+                Collections.emptyMap());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aabdf3ed1399afdc2189f9c0865f69bf9564617e"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3Nzc0OTg3OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveFileFormats.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNzoyN1rOG3oHLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozNzoyN1rOG3oHLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk4MjA2MA==", "bodyText": "ImmutableMap.of()", "url": "https://github.com/prestodb/presto/pull/14795#discussion_r460982060", "createdAt": "2020-07-27T15:37:27Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveFileFormats.java", "diffHunk": "@@ -968,7 +969,8 @@ private void testPageSourceFactory(HiveBatchPageSourceFactory sourceFactory,\n                 TRUE_CONSTANT,\n                 false,\n                 ROW_EXPRESSION_SERVICE,\n-                Optional.empty());\n+                Optional.empty(),\n+                null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aabdf3ed1399afdc2189f9c0865f69bf9564617e"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2324, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}