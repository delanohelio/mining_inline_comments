{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0MjM4OTIy", "number": 14985, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDoxMjo1OFrOEV-hHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTowMDozMVrOEV_b2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNDc5ODM5OnYy", "diffSide": "RIGHT", "path": "presto-thrift-api/src/main/java/com/facebook/presto/thrift/api/udf/PrestoThriftUdfService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDoxMjo1OFrOG9CqaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDoxMjo1OFrOG9CqaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY1OTk0NA==", "bodyText": "Why not just @ThriftMethod without (\"prestoInvokeUdf\")", "url": "https://github.com/prestodb/presto/pull/14985#discussion_r466659944", "createdAt": "2020-08-06T20:12:58Z", "author": {"login": "caithagoras"}, "path": "presto-thrift-api/src/main/java/com/facebook/presto/thrift/api/udf/PrestoThriftUdfService.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.thrift.api.udf;\n+\n+import com.facebook.drift.TException;\n+import com.facebook.drift.annotations.ThriftField;\n+import com.facebook.drift.annotations.ThriftMethod;\n+import com.facebook.drift.annotations.ThriftService;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+@ThriftService(value = \"presto-udf\", idlName = \"PrestoThriftUdfService\")\n+public interface PrestoThriftUdfService\n+{\n+    @ThriftMethod(\"prestoInvokeUdf\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a8e66fb6eb7da4c36f717690fe39a0b478cfac7"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNDc5OTI0OnYy", "diffSide": "RIGHT", "path": "presto-thrift-api/src/main/java/com/facebook/presto/thrift/api/udf/PrestoThriftUdfService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDoxMzoxNlrOG9CrAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDoxMzoxNlrOG9CrAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY2MDA5Nw==", "bodyText": "(name = ) is unnecessary IIUC.", "url": "https://github.com/prestodb/presto/pull/14985#discussion_r466660097", "createdAt": "2020-08-06T20:13:16Z", "author": {"login": "caithagoras"}, "path": "presto-thrift-api/src/main/java/com/facebook/presto/thrift/api/udf/PrestoThriftUdfService.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.thrift.api.udf;\n+\n+import com.facebook.drift.TException;\n+import com.facebook.drift.annotations.ThriftField;\n+import com.facebook.drift.annotations.ThriftMethod;\n+import com.facebook.drift.annotations.ThriftService;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+@ThriftService(value = \"presto-udf\", idlName = \"PrestoThriftUdfService\")\n+public interface PrestoThriftUdfService\n+{\n+    @ThriftMethod(\"prestoInvokeUdf\")\n+    ListenableFuture<PrestoThriftUdfResult> invokeUdf(\n+            @ThriftField(name = \"functionHandle\") PrestoThriftFunctionHandle functionHandle,\n+            @ThriftField(name = \"inputs\") PrestoThriftUdfPage inputs)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a8e66fb6eb7da4c36f717690fe39a0b478cfac7"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNDgwMjAyOnYy", "diffSide": "RIGHT", "path": "presto-thrift-api/src/main/java/com/facebook/presto/thrift/api/udf/PrestoThriftUdfService.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDoxNDoxMVrOG9Csvw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMDoxNDoxMVrOG9Csvw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY2MDU0Mw==", "bodyText": "Usually we do\nthrows TException,\n@ThriftId(1) PrestoThriftUdfServiceException;", "url": "https://github.com/prestodb/presto/pull/14985#discussion_r466660543", "createdAt": "2020-08-06T20:14:11Z", "author": {"login": "caithagoras"}, "path": "presto-thrift-api/src/main/java/com/facebook/presto/thrift/api/udf/PrestoThriftUdfService.java", "diffHunk": "@@ -0,0 +1,30 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.thrift.api.udf;\n+\n+import com.facebook.drift.TException;\n+import com.facebook.drift.annotations.ThriftField;\n+import com.facebook.drift.annotations.ThriftMethod;\n+import com.facebook.drift.annotations.ThriftService;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+@ThriftService(value = \"presto-udf\", idlName = \"PrestoThriftUdfService\")\n+public interface PrestoThriftUdfService\n+{\n+    @ThriftMethod(\"prestoInvokeUdf\")\n+    ListenableFuture<PrestoThriftUdfResult> invokeUdf(\n+            @ThriftField(name = \"functionHandle\") PrestoThriftFunctionHandle functionHandle,\n+            @ThriftField(name = \"inputs\") PrestoThriftUdfPage inputs)\n+            throws PrestoThriftUdfServiceException, TException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4a8e66fb6eb7da4c36f717690fe39a0b478cfac7"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxNDk0ODc0OnYy", "diffSide": "RIGHT", "path": "presto-thrift-api/src/main/java/com/facebook/presto/thrift/api/udf/ThriftUdfPage.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTowMDozMVrOG9EGvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMjoxNDowMlrOG9F_Eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4MzU4MQ==", "bodyText": "Let's use Optional instead of @Nullable.", "url": "https://github.com/prestodb/presto/pull/14985#discussion_r466683581", "createdAt": "2020-08-06T21:00:31Z", "author": {"login": "caithagoras"}, "path": "presto-thrift-api/src/main/java/com/facebook/presto/thrift/api/udf/ThriftUdfPage.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.thrift.api.udf;\n+\n+import com.facebook.drift.annotations.ThriftConstructor;\n+import com.facebook.drift.annotations.ThriftField;\n+import com.facebook.drift.annotations.ThriftStruct;\n+import com.facebook.presto.thrift.api.datatypes.PrestoThriftBlock;\n+\n+import javax.annotation.Nullable;\n+\n+import java.util.List;\n+import java.util.Objects;\n+\n+import static com.facebook.drift.annotations.ThriftField.Requiredness.OPTIONAL;\n+import static com.facebook.presto.thrift.api.udf.ThriftUdfPageFormat.PRESTO_THRIFT;\n+\n+@ThriftStruct(\"UdfPage\")\n+public class ThriftUdfPage\n+{\n+    private final ThriftUdfPageFormat pageFormat;\n+    private final List<PrestoThriftBlock> thriftBlocks;\n+\n+    @ThriftConstructor\n+    public ThriftUdfPage(\n+            ThriftUdfPageFormat pageFormat,\n+            @Nullable List<PrestoThriftBlock> thriftBlocks)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a3efad9f03b24e66e50049a1cce55c3160adb392"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjcxNDM4Ng==", "bodyText": "Are they going to be translated to the same thrift idl?", "url": "https://github.com/prestodb/presto/pull/14985#discussion_r466714386", "createdAt": "2020-08-06T22:14:02Z", "author": {"login": "rongrong"}, "path": "presto-thrift-api/src/main/java/com/facebook/presto/thrift/api/udf/ThriftUdfPage.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.thrift.api.udf;\n+\n+import com.facebook.drift.annotations.ThriftConstructor;\n+import com.facebook.drift.annotations.ThriftField;\n+import com.facebook.drift.annotations.ThriftStruct;\n+import com.facebook.presto.thrift.api.datatypes.PrestoThriftBlock;\n+\n+import javax.annotation.Nullable;\n+\n+import java.util.List;\n+import java.util.Objects;\n+\n+import static com.facebook.drift.annotations.ThriftField.Requiredness.OPTIONAL;\n+import static com.facebook.presto.thrift.api.udf.ThriftUdfPageFormat.PRESTO_THRIFT;\n+\n+@ThriftStruct(\"UdfPage\")\n+public class ThriftUdfPage\n+{\n+    private final ThriftUdfPageFormat pageFormat;\n+    private final List<PrestoThriftBlock> thriftBlocks;\n+\n+    @ThriftConstructor\n+    public ThriftUdfPage(\n+            ThriftUdfPageFormat pageFormat,\n+            @Nullable List<PrestoThriftBlock> thriftBlocks)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjY4MzU4MQ=="}, "originalCommit": {"oid": "a3efad9f03b24e66e50049a1cce55c3160adb392"}, "originalPosition": 38}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2269, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}