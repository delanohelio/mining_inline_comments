{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA5MjA0NTkx", "number": 15350, "title": "Add Thrift transport support for TaskStatus", "bodyText": "depended by facebookexternal/presto-facebook#1260\nTest plan - Verifier testing\nhttps://www.internalfb.com/intern/presto/verifier/results/?test_id=47005\nhttps://www.internalfb.com/intern/presto/verifier/results/?test_id=47196\n== RELEASE NOTES ==\n\nGeneral Changes\n* Add thrift transport support for TaskStatus which can be enabled using config property ``experimental.internal-communication.thrift-transport-enabled``", "createdAt": "2020-10-23T20:35:14Z", "url": "https://github.com/prestodb/presto/pull/15350", "merged": true, "mergeCommit": {"oid": "fc947199a6493f88e54ffcabf174cc5d5a3f9cbb"}, "closed": true, "closedAt": "2020-10-29T19:06:02Z", "author": {"login": "ajaygeorge"}, "timelineItems": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdVdtuRABqjM5MTU4NjA3Mzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdXWQL2gFqTUxOTk0NzA3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0899a4f50977ccd5b454b70db378e10c5f223ecf", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/0899a4f50977ccd5b454b70db378e10c5f223ecf", "committedDate": "2020-10-23T18:04:09Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "88c3001a602297d8ecdee5670f8e6c83a1d9816b", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/88c3001a602297d8ecdee5670f8e6c83a1d9816b", "committedDate": "2020-10-23T21:46:35Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88c3001a602297d8ecdee5670f8e6c83a1d9816b", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/88c3001a602297d8ecdee5670f8e6c83a1d9816b", "committedDate": "2020-10-23T21:46:35Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "56e7e201dc4da30a988e1bcaccb658c50a5c958c", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/56e7e201dc4da30a988e1bcaccb658c50a5c958c", "committedDate": "2020-10-25T22:18:11Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "56e7e201dc4da30a988e1bcaccb658c50a5c958c", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/56e7e201dc4da30a988e1bcaccb658c50a5c958c", "committedDate": "2020-10-25T22:18:11Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "4cbdff24fafc6b97a28d068726029af0bb9905c8", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/4cbdff24fafc6b97a28d068726029af0bb9905c8", "committedDate": "2020-10-26T00:31:15Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4cbdff24fafc6b97a28d068726029af0bb9905c8", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/4cbdff24fafc6b97a28d068726029af0bb9905c8", "committedDate": "2020-10-26T00:31:15Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "b289818275d6ad83622ec830ede1924ad9228d45", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/b289818275d6ad83622ec830ede1924ad9228d45", "committedDate": "2020-10-26T00:35:48Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b289818275d6ad83622ec830ede1924ad9228d45", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/b289818275d6ad83622ec830ede1924ad9228d45", "committedDate": "2020-10-26T00:35:48Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "5351a34c0c9db556a1b809fa0e6b94cd97ec7f54", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/5351a34c0c9db556a1b809fa0e6b94cd97ec7f54", "committedDate": "2020-10-26T01:31:45Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5351a34c0c9db556a1b809fa0e6b94cd97ec7f54", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/5351a34c0c9db556a1b809fa0e6b94cd97ec7f54", "committedDate": "2020-10-26T01:31:45Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "d2e3fa5a8b7ded718cb13bb9437d2d4078819dd1", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/d2e3fa5a8b7ded718cb13bb9437d2d4078819dd1", "committedDate": "2020-10-26T01:36:17Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d2e3fa5a8b7ded718cb13bb9437d2d4078819dd1", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/d2e3fa5a8b7ded718cb13bb9437d2d4078819dd1", "committedDate": "2020-10-26T01:36:17Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "4d42231a895ca0d7204e8e5da5d4181f870e579a", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/4d42231a895ca0d7204e8e5da5d4181f870e579a", "committedDate": "2020-10-26T05:08:10Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4d42231a895ca0d7204e8e5da5d4181f870e579a", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/4d42231a895ca0d7204e8e5da5d4181f870e579a", "committedDate": "2020-10-26T05:08:10Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "027ed2cfe22510c7fec36a72a15a66eb77b98bd9", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/027ed2cfe22510c7fec36a72a15a66eb77b98bd9", "committedDate": "2020-10-27T06:28:32Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE3OTkwNTA1", "url": "https://github.com/prestodb/presto/pull/15350#pullrequestreview-517990505", "createdAt": "2020-10-27T17:53:39Z", "commit": {"oid": "027ed2cfe22510c7fec36a72a15a66eb77b98bd9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzo1MzozOVrOHpJYQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yN1QxNzo1MzozOVrOHpJYQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkwNzMyOA==", "bodyText": "wait for airlift release cut", "url": "https://github.com/prestodb/presto/pull/15350#discussion_r512907328", "createdAt": "2020-10-27T17:53:39Z", "author": {"login": "ajaygeorge"}, "path": "pom.xml", "diffHunk": "@@ -45,23 +45,23 @@\n         <air.maven.version>3.3.9</air.maven.version>\n \n         <dep.antlr.version>4.7.1</dep.antlr.version>\n-        <dep.airlift.version>0.195</dep.airlift.version>\n+        <dep.airlift.version>0.197-SNAPSHOT</dep.airlift.version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "027ed2cfe22510c7fec36a72a15a66eb77b98bd9"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "027ed2cfe22510c7fec36a72a15a66eb77b98bd9", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/027ed2cfe22510c7fec36a72a15a66eb77b98bd9", "committedDate": "2020-10-27T06:28:32Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/72b53ebd93f5ddf6912334e6bc0f6e28ef88d274", "committedDate": "2020-10-28T01:30:24Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4OTQ0MTcz", "url": "https://github.com/prestodb/presto/pull/15350#pullrequestreview-518944173", "createdAt": "2020-10-28T17:59:44Z", "commit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxNzo1OTo0NFrOHp26Kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxODowOToxNlrOHp3S_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY1MzI5MA==", "bodyText": "I am wondering if we can use SimpleHttpResponseHandler here instead of creating ThriftHttpResponseHandler. We can maybe wrap ThriftResponse to BaseResponse and keep using  SimpleHttpResponseHandler.", "url": "https://github.com/prestodb/presto/pull/15350#discussion_r513653290", "createdAt": "2020-10-28T17:59:44Z", "author": {"login": "cemcayiroglu"}, "path": "presto-main/src/main/java/com/facebook/presto/server/remotetask/ContinuousTaskStatusFetcher.java", "diffHunk": "@@ -154,26 +167,40 @@ private synchronized void scheduleNextRequest()\n             return;\n         }\n \n-        Request request = setContentTypeHeaders(isBinaryTransportEnabled, prepareGet())\n-                .setUri(uriBuilderFrom(taskStatus.getSelf()).appendPath(\"status\").build())\n-                .setHeader(PRESTO_CURRENT_STATE, taskStatus.getState().toString())\n-                .setHeader(PRESTO_MAX_WAIT, refreshMaxWait.toString())\n-                .build();\n-\n+        Request.Builder requestBuilder;\n         ResponseHandler responseHandler;\n-        if (isBinaryTransportEnabled) {\n+        if (thriftTransportEnabled) {\n+            requestBuilder = ThriftRequestUtils.prepareThriftGet(thriftProtocol);\n+            responseHandler = new ThriftResponseHandler(unwrapThriftCodec(taskStatusCodec));\n+        }\n+        else if (binaryTransportEnabled) {\n+            requestBuilder = getBinaryTransportBuilder(prepareGet());\n             responseHandler = createFullSmileResponseHandler((SmileCodec<TaskStatus>) taskStatusCodec);\n         }\n         else {\n+            requestBuilder = getJsonTransportBuilder(prepareGet());\n             responseHandler = createAdaptingJsonResponseHandler(unwrapJsonCodec(taskStatusCodec));\n         }\n \n+        Request request = requestBuilder.setUri(uriBuilderFrom(taskStatus.getSelf()).appendPath(\"status\").build())\n+                .setHeader(PRESTO_CURRENT_STATE, taskStatus.getState().toString())\n+                .setHeader(PRESTO_MAX_WAIT, refreshMaxWait.toString())\n+                .build();\n+\n         errorTracker.startRequest();\n         future = httpClient.executeAsync(request, responseHandler);\n         currentRequestStartNanos.set(System.nanoTime());\n+        FutureCallback callback;\n+        if (thriftTransportEnabled) {\n+            callback = new ThriftHttpResponseHandler(this, request.getUri(), stats.getHttpResponseStats(), REMOTE_TASK_ERROR);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "originalPosition": 108}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY1NjU5NQ==", "bodyText": "Should we move codec and response handler to a class (TaskStatusRequest?) and pass it to  ContinuousTaskStatusFetcher? We can get rid of these if checks and casts.", "url": "https://github.com/prestodb/presto/pull/15350#discussion_r513656595", "createdAt": "2020-10-28T18:04:31Z", "author": {"login": "cemcayiroglu"}, "path": "presto-main/src/main/java/com/facebook/presto/server/remotetask/ContinuousTaskStatusFetcher.java", "diffHunk": "@@ -93,7 +102,9 @@ public ContinuousTaskStatusFetcher(\n             Duration maxErrorDuration,\n             ScheduledExecutorService errorScheduledExecutor,\n             RemoteTaskStats stats,\n-            boolean isBinaryTransportEnabled)\n+            boolean binaryTransportEnabled,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "originalPosition": 55}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY1OTY0Ng==", "bodyText": "I am not sure if we need this wrapper anymore if we move codec and response handler to a class.", "url": "https://github.com/prestodb/presto/pull/15350#discussion_r513659646", "createdAt": "2020-10-28T18:09:16Z", "author": {"login": "cemcayiroglu"}, "path": "presto-main/src/main/java/com/facebook/presto/server/thrift/ThriftCodecWrapper.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.server.thrift;\n+\n+import com.facebook.drift.codec.ThriftCodec;\n+import com.facebook.presto.server.codec.Codec;\n+\n+import static com.google.common.base.Verify.verify;\n+import static java.util.Objects.requireNonNull;\n+\n+public class ThriftCodecWrapper<T>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE4OTU3OTU2", "url": "https://github.com/prestodb/presto/pull/15350#pullrequestreview-518957956", "createdAt": "2020-10-28T18:16:02Z", "commit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxODoxNjowMlrOHp3jbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOFQxODo0MToxOVrOHp4fgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY2Mzg1Mw==", "bodyText": "Why do we need this?", "url": "https://github.com/prestodb/presto/pull/15350#discussion_r513663853", "createdAt": "2020-10-28T18:16:02Z", "author": {"login": "tdcmeehan"}, "path": "presto-bytecode/src/test/java/com/facebook/presto/bytecode/TestClassGenerator.java", "diffHunk": "@@ -77,7 +77,7 @@ public void testGenerator()\n             assertThat(writer.toString())\n                     .contains(\"00002 I I  : I I  :     IADD\")\n                     .contains(\"public final class test/Example {\")\n-                    .contains(\"// declaration: int (int, int)\")\n+                    .contains(\"// declaration: int add(int, int)\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY2NTQ3Mw==", "bodyText": "Nit: better to move this and associated changes to their own commit", "url": "https://github.com/prestodb/presto/pull/15350#discussion_r513665473", "createdAt": "2020-10-28T18:18:43Z", "author": {"login": "tdcmeehan"}, "path": "presto-main/src/main/java/com/facebook/presto/server/codec/Codec.java", "diffHunk": "@@ -11,7 +11,7 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-package com.facebook.presto.server.smile;\n+package com.facebook.presto.server.codec;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzY3OTIzNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                @ConfigDescription(\"Enables thrift encoding support for coordinator-to-worker communication\")\n          \n          \n            \n                @ConfigDescription(\"Enables thrift encoding support for internal task communication\")", "url": "https://github.com/prestodb/presto/pull/15350#discussion_r513679234", "createdAt": "2020-10-28T18:41:19Z", "author": {"login": "tdcmeehan"}, "path": "presto-main/src/main/java/com/facebook/presto/server/InternalCommunicationConfig.java", "diffHunk": "@@ -149,6 +152,32 @@ public InternalCommunicationConfig setBinaryTransportEnabled(boolean binaryTrans\n         return this;\n     }\n \n+    public boolean isThriftTransportEnabled()\n+    {\n+        return thriftTransportEnabled;\n+    }\n+\n+    @Config(\"experimental.internal-communication.thrift-transport-enabled\")\n+    @ConfigDescription(\"Enables thrift encoding support for coordinator-to-worker communication\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5MjcwODMx", "url": "https://github.com/prestodb/presto/pull/15350#pullrequestreview-519270831", "createdAt": "2020-10-29T01:35:34Z", "commit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMTozNTozNFrOHqDzYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMTozODo1NFrOHqD5Dw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg2NDU0NQ==", "bodyText": "Why do we need this library in the SPI?", "url": "https://github.com/prestodb/presto/pull/15350#discussion_r513864545", "createdAt": "2020-10-29T01:35:34Z", "author": {"login": "arhimondr"}, "path": "presto-main/src/main/java/com/facebook/presto/server/PluginManager.java", "diffHunk": "@@ -83,6 +83,7 @@\n             .add(\"com.facebook.drift.annotations.\")\n             .add(\"com.facebook.drift.TException\")\n             .add(\"com.facebook.drift.TApplicationException\")\n+            .add(\"org.objectweb.asm.\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg2NTk5OQ==", "bodyText": "I assume that this is just an almost verbatim copy of the SimpleHttpResponseHandler. I wonder if the SimpleHttpResponseHandler can be reused to avoid copy-paste?", "url": "https://github.com/prestodb/presto/pull/15350#discussion_r513865999", "createdAt": "2020-10-29T01:38:54Z", "author": {"login": "arhimondr"}, "path": "presto-main/src/main/java/com/facebook/presto/server/thrift/ThriftHttpResponseHandler.java", "diffHunk": "@@ -0,0 +1,100 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.server.thrift;\n+\n+import com.facebook.airlift.http.client.HttpStatus;\n+import com.facebook.airlift.http.client.thrift.ThriftResponse;\n+import com.facebook.presto.server.ServiceUnavailableException;\n+import com.facebook.presto.server.SimpleHttpResponseCallback;\n+import com.facebook.presto.server.SimpleHttpResponseHandlerStats;\n+import com.facebook.presto.spi.ErrorCodeSupplier;\n+import com.facebook.presto.spi.PrestoException;\n+import com.google.common.util.concurrent.FutureCallback;\n+\n+import java.net.URI;\n+\n+import static com.facebook.airlift.http.client.HttpStatus.OK;\n+import static java.lang.String.format;\n+import static java.util.Objects.requireNonNull;\n+\n+public class ThriftHttpResponseHandler<T>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274"}, "originalPosition": 31}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "72b53ebd93f5ddf6912334e6bc0f6e28ef88d274", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/72b53ebd93f5ddf6912334e6bc0f6e28ef88d274", "committedDate": "2020-10-28T01:30:24Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "40dc166056b1b370b3fd384da3e7a280b72c8ad5", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/40dc166056b1b370b3fd384da3e7a280b72c8ad5", "committedDate": "2020-10-29T06:00:44Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9cfb8978a604062dff36500aaa164b21e099c98", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/b9cfb8978a604062dff36500aaa164b21e099c98", "committedDate": "2020-10-29T06:58:42Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "40dc166056b1b370b3fd384da3e7a280b72c8ad5", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/40dc166056b1b370b3fd384da3e7a280b72c8ad5", "committedDate": "2020-10-29T06:00:44Z", "message": "Add Thrift transport support for TaskStatus"}, "afterCommit": {"oid": "b9cfb8978a604062dff36500aaa164b21e099c98", "author": {"user": {"login": "ajaygeorge", "name": "Ajay George"}}, "url": "https://github.com/prestodb/presto/commit/b9cfb8978a604062dff36500aaa164b21e099c98", "committedDate": "2020-10-29T06:58:42Z", "message": "Add Thrift transport support for TaskStatus"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5OTE4OTc0", "url": "https://github.com/prestodb/presto/pull/15350#pullrequestreview-519918974", "createdAt": "2020-10-29T17:39:48Z", "commit": {"oid": "b9cfb8978a604062dff36500aaa164b21e099c98"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5OTIwMjA2", "url": "https://github.com/prestodb/presto/pull/15350#pullrequestreview-519920206", "createdAt": "2020-10-29T17:41:12Z", "commit": {"oid": "b9cfb8978a604062dff36500aaa164b21e099c98"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE5OTQ3MDcw", "url": "https://github.com/prestodb/presto/pull/15350#pullrequestreview-519947070", "createdAt": "2020-10-29T18:13:05Z", "commit": {"oid": "b9cfb8978a604062dff36500aaa164b21e099c98"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4620, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}