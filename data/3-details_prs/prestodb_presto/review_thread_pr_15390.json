{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0ODcwODY4", "number": 15390, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxODoxMjowM1rOE07LAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMTozNTo1NFrOE0_Ulg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzOTMwODgyOnYy", "diffSide": "RIGHT", "path": "presto-session-property-managers/src/main/java/com/facebook/presto/session/SessionMatchSpec.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxODoxMjowM1rOHs62zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMToyMjo0MVrOHtA7CQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg2MzY5NQ==", "bodyText": "It looks like it should be something like\nif (resourceGroupRegex.isPresent() && (!context.getResourceGroupId().isPresent() || !resourceGroupRegex.get().matcher(context.getResourceGroupId().get().toString()).matches()))", "url": "https://github.com/prestodb/presto/pull/15390#discussion_r516863695", "createdAt": "2020-11-03T18:12:03Z", "author": {"login": "arhimondr"}, "path": "presto-session-property-managers/src/main/java/com/facebook/presto/session/SessionMatchSpec.java", "diffHunk": "@@ -78,7 +78,9 @@ public SessionMatchSpec(\n             }\n         }\n \n-        if (resourceGroupRegex.isPresent() && !resourceGroupRegex.get().matcher(context.getResourceGroupId().toString()).matches()) {\n+        if (resourceGroupRegex.isPresent() &&\n+                context.getResourceGroupId().isPresent() &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb05e244a0c924e96c65d23c27617d1dc8bb263e"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk2MzA4MQ==", "bodyText": "Thank you for pointing out this. Other rules inside this function use empty string when it is an empty optional object. PR is updated with the same logics.", "url": "https://github.com/prestodb/presto/pull/15390#discussion_r516963081", "createdAt": "2020-11-03T21:22:41Z", "author": {"login": "viczhang861"}, "path": "presto-session-property-managers/src/main/java/com/facebook/presto/session/SessionMatchSpec.java", "diffHunk": "@@ -78,7 +78,9 @@ public SessionMatchSpec(\n             }\n         }\n \n-        if (resourceGroupRegex.isPresent() && !resourceGroupRegex.get().matcher(context.getResourceGroupId().toString()).matches()) {\n+        if (resourceGroupRegex.isPresent() &&\n+                context.getResourceGroupId().isPresent() &&", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg2MzY5NQ=="}, "originalCommit": {"oid": "bb05e244a0c924e96c65d23c27617d1dc8bb263e"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIzOTk4ODcwOnYy", "diffSide": "RIGHT", "path": "presto-session-property-managers/src/main/java/com/facebook/presto/session/SessionMatchSpec.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMTozNTo1NFrOHtBTPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMTo0NTozMVrOHtBkBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk2OTI3Nw==", "bodyText": "nit: context.getResourceGroupId().orElse(\"\")", "url": "https://github.com/prestodb/presto/pull/15390#discussion_r516969277", "createdAt": "2020-11-03T21:35:54Z", "author": {"login": "arhimondr"}, "path": "presto-session-property-managers/src/main/java/com/facebook/presto/session/SessionMatchSpec.java", "diffHunk": "@@ -78,8 +78,14 @@ public SessionMatchSpec(\n             }\n         }\n \n-        if (resourceGroupRegex.isPresent() && !resourceGroupRegex.get().matcher(context.getResourceGroupId().toString()).matches()) {\n-            return ImmutableMap.of();\n+        if (resourceGroupRegex.isPresent()) {\n+            String resourceGroupId = \"\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a033c681260b9c762f6320565dcb17a477987a1"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk3MzU3NA==", "bodyText": "You meant context.getResourceGroupId().orElse(new ResourceGroupId(\"\")) ?  This will fail as we cannot use empty string to construct ResourceGroupId", "url": "https://github.com/prestodb/presto/pull/15390#discussion_r516973574", "createdAt": "2020-11-03T21:45:31Z", "author": {"login": "viczhang861"}, "path": "presto-session-property-managers/src/main/java/com/facebook/presto/session/SessionMatchSpec.java", "diffHunk": "@@ -78,8 +78,14 @@ public SessionMatchSpec(\n             }\n         }\n \n-        if (resourceGroupRegex.isPresent() && !resourceGroupRegex.get().matcher(context.getResourceGroupId().toString()).matches()) {\n-            return ImmutableMap.of();\n+        if (resourceGroupRegex.isPresent()) {\n+            String resourceGroupId = \"\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk2OTI3Nw=="}, "originalCommit": {"oid": "6a033c681260b9c762f6320565dcb17a477987a1"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3363, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}