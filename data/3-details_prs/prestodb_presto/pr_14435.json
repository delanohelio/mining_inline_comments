{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4ODE0MTM1", "number": 14435, "title": "Add session property for druid connector", "bodyText": "== RELEASE NOTES ==\n\nDruid Changes\n* session property, druid.pushdown, it added, to control whether to pushdown all query processing to druid", "createdAt": "2020-04-25T00:04:25Z", "url": "https://github.com/prestodb/presto/pull/14435", "merged": true, "mergeCommit": {"oid": "34b3f6a75b333d5c072bd81e0638ee7711bb68a1"}, "closed": true, "closedAt": "2020-04-26T23:30:25Z", "author": {"login": "zhenxiao"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABca7JTAABqjMyNzE0MTQ5NDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcbjRmGAFqTQwMDU2MTY1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bfda2a2c17574afc52862d0ac8f6bf889d7c2607", "author": {"user": {"login": "zhenxiao", "name": "Zhenxiao Luo"}}, "url": "https://github.com/prestodb/presto/commit/bfda2a2c17574afc52862d0ac8f6bf889d7c2607", "committedDate": "2020-04-25T00:02:37Z", "message": "Add session property for druid connector"}, "afterCommit": {"oid": "e56fe8a2a73b2a28aca63e19a8f319b8b912593c", "author": {"user": {"login": "zhenxiao", "name": "Zhenxiao Luo"}}, "url": "https://github.com/prestodb/presto/commit/e56fe8a2a73b2a28aca63e19a8f319b8b912593c", "committedDate": "2020-04-25T00:42:20Z", "message": "Add session property for druid connector"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNTQyMTY1", "url": "https://github.com/prestodb/presto/pull/14435#pullrequestreview-400542165", "createdAt": "2020-04-26T19:48:07Z", "commit": {"oid": "e56fe8a2a73b2a28aca63e19a8f319b8b912593c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxOTo0ODowN1rOGMJKEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQxOTo0OTowMlrOGMJKuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM4NjEzMQ==", "bodyText": "compute_pushdown_enabled", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415386131", "createdAt": "2020-04-26T19:48:07Z", "author": {"login": "highker"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.facebook.presto.druid;\n+\n+import com.facebook.presto.spi.ConnectorSession;\n+import com.facebook.presto.spi.session.PropertyMetadata;\n+import com.google.common.collect.ImmutableList;\n+\n+import javax.inject.Inject;\n+\n+import java.util.List;\n+\n+import static com.facebook.presto.spi.session.PropertyMetadata.booleanProperty;\n+\n+public class DruidSessionProperties\n+{\n+    private static final String PUSHDOWN = \"pushdown\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e56fe8a2a73b2a28aca63e19a8f319b8b912593c"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTM4NjI5Ng==", "bodyText": "druid.compute-pushdown-enabled", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415386296", "createdAt": "2020-04-26T19:49:02Z", "author": {"login": "highker"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java", "diffHunk": "@@ -65,4 +66,17 @@ public DruidConfig setDruidSchema(String schema)\n         this.schema = schema;\n         return this;\n     }\n+\n+    public boolean getPushdown()\n+    {\n+        return pushdown;\n+    }\n+\n+    @Config(\"druid.pushdown\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e56fe8a2a73b2a28aca63e19a8f319b8b912593c"}, "originalPosition": 18}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e56fe8a2a73b2a28aca63e19a8f319b8b912593c", "author": {"user": {"login": "zhenxiao", "name": "Zhenxiao Luo"}}, "url": "https://github.com/prestodb/presto/commit/e56fe8a2a73b2a28aca63e19a8f319b8b912593c", "committedDate": "2020-04-25T00:42:20Z", "message": "Add session property for druid connector"}, "afterCommit": {"oid": "d99e4e57830451ee7968b061373299dcc7d24356", "author": {"user": {"login": "zhenxiao", "name": "Zhenxiao Luo"}}, "url": "https://github.com/prestodb/presto/commit/d99e4e57830451ee7968b061373299dcc7d24356", "committedDate": "2020-04-26T21:12:30Z", "message": "Add session property for druid connector"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNTUyNDQy", "url": "https://github.com/prestodb/presto/pull/14435#pullrequestreview-400552442", "createdAt": "2020-04-26T21:43:43Z", "commit": {"oid": "d99e4e57830451ee7968b061373299dcc7d24356"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMTo0Mzo0M1rOGMKejA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMTo0NDozN1rOGMKfPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwNzc1Ng==", "bodyText": "isComputePushdownEnabled", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415407756", "createdAt": "2020-04-26T21:43:43Z", "author": {"login": "highker"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java", "diffHunk": "@@ -65,4 +66,17 @@ public DruidConfig setDruidSchema(String schema)\n         this.schema = schema;\n         return this;\n     }\n+\n+    public boolean getPushdown()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d99e4e57830451ee7968b061373299dcc7d24356"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwNzc5MQ==", "bodyText": "setComputePushdownEnabled", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415407791", "createdAt": "2020-04-26T21:43:50Z", "author": {"login": "highker"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java", "diffHunk": "@@ -65,4 +66,17 @@ public DruidConfig setDruidSchema(String schema)\n         this.schema = schema;\n         return this;\n     }\n+\n+    public boolean getPushdown()\n+    {\n+        return pushdown;\n+    }\n+\n+    @Config(\"druid.compute-pushdown-enabled\")\n+    @ConfigDescription(\"pushdown query processing to druid\")\n+    public DruidConfig setPushdown(boolean pushdown)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d99e4e57830451ee7968b061373299dcc7d24356"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwNzg2Ng==", "bodyText": "same", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415407866", "createdAt": "2020-04-26T21:44:18Z", "author": {"login": "highker"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidSessionProperties.java", "diffHunk": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.facebook.presto.druid;\n+\n+import com.facebook.presto.spi.ConnectorSession;\n+import com.facebook.presto.spi.session.PropertyMetadata;\n+import com.google.common.collect.ImmutableList;\n+\n+import javax.inject.Inject;\n+\n+import java.util.List;\n+\n+import static com.facebook.presto.spi.session.PropertyMetadata.booleanProperty;\n+\n+public class DruidSessionProperties\n+{\n+    private static final String COMPUTE_PUSHDOWN = \"compute_pushdown_enabled\";\n+\n+    private final List<PropertyMetadata<?>> sessionProperties;\n+\n+    public static boolean isPushdown(ConnectorSession session)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d99e4e57830451ee7968b061373299dcc7d24356"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwNzkzMw==", "bodyText": "need to change as well", "url": "https://github.com/prestodb/presto/pull/14435#discussion_r415407933", "createdAt": "2020-04-26T21:44:37Z", "author": {"login": "highker"}, "path": "presto-druid/src/test/java/com/facebook/presto/druid/TestDruidConfig.java", "diffHunk": "@@ -40,12 +41,14 @@ public void testExplicitPropertyMappings()\n                 .put(\"druid.broker-url\", \"http://druid.broker:1234\")\n                 .put(\"druid.coordinator-url\", \"http://druid.coordinator:4321\")\n                 .put(\"druid.schema-name\", \"test\")\n+                .put(\"druid.pushdown\", \"true\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d99e4e57830451ee7968b061373299dcc7d24356"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c458389246663d553eb1b154bd46e10bfa6218d", "author": {"user": {"login": "zhenxiao", "name": "Zhenxiao Luo"}}, "url": "https://github.com/prestodb/presto/commit/7c458389246663d553eb1b154bd46e10bfa6218d", "committedDate": "2020-04-26T21:50:48Z", "message": "Add session property for druid connector"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d99e4e57830451ee7968b061373299dcc7d24356", "author": {"user": {"login": "zhenxiao", "name": "Zhenxiao Luo"}}, "url": "https://github.com/prestodb/presto/commit/d99e4e57830451ee7968b061373299dcc7d24356", "committedDate": "2020-04-26T21:12:30Z", "message": "Add session property for druid connector"}, "afterCommit": {"oid": "7c458389246663d553eb1b154bd46e10bfa6218d", "author": {"user": {"login": "zhenxiao", "name": "Zhenxiao Luo"}}, "url": "https://github.com/prestodb/presto/commit/7c458389246663d553eb1b154bd46e10bfa6218d", "committedDate": "2020-04-26T21:50:48Z", "message": "Add session property for druid connector"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAwNTYxNjU5", "url": "https://github.com/prestodb/presto/pull/14435#pullrequestreview-400561659", "createdAt": "2020-04-26T23:27:56Z", "commit": {"oid": "7c458389246663d553eb1b154bd46e10bfa6218d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1905, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}