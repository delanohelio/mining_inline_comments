{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0MzA2MzM3", "number": 14650, "title": "Fix header handling in Presto Proxy", "bodyText": "Currently, Presto headers returned from the coordinator are corrupted by the Proxy, which is surrounding the values in [...].\n== NO RELEASE NOTE ==", "createdAt": "2020-06-15T05:54:56Z", "url": "https://github.com/prestodb/presto/pull/14650", "merged": true, "mergeCommit": {"oid": "00c3dfcf8bc40cbd02ccd88f36ec8f08fd978d8b"}, "closed": true, "closedAt": "2020-06-25T03:33:39Z", "author": {"login": "tdcmeehan"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcrisgwgFqTQzMDc3NDE1OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcudQWLAFqTQzNjg0NjQwMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwNzc0MTU4", "url": "https://github.com/prestodb/presto/pull/14650#pullrequestreview-430774158", "createdAt": "2020-06-15T15:49:50Z", "commit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0OTo1MVrOGj4OfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0OTo1MVrOGj4OfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3NDU1Nw==", "bodyText": "Can you explain how this test verifies the header changes?", "url": "https://github.com/prestodb/presto/pull/14650#discussion_r440274557", "createdAt": "2020-06-15T15:49:51Z", "author": {"login": "swapsmagic"}, "path": "presto-proxy/src/test/java/com/facebook/presto/proxy/TestProxyServer.java", "diffHunk": "@@ -142,6 +142,26 @@ public void testQuery()\n         }\n     }\n \n+    @Test\n+    public void testSetSession()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxMDcxMDIy", "url": "https://github.com/prestodb/presto/pull/14650#pullrequestreview-431071022", "createdAt": "2020-06-16T00:02:24Z", "commit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMDQwODU0", "url": "https://github.com/prestodb/presto/pull/14650#pullrequestreview-432040854", "createdAt": "2020-06-17T03:56:26Z", "commit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMDU1NjE5", "url": "https://github.com/prestodb/presto/pull/14650#pullrequestreview-432055619", "createdAt": "2020-06-17T04:48:16Z", "commit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNDo0ODoxNlrOGk1e3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNDo0ODoxNlrOGk1e3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI3ODE3NQ==", "bodyText": "Would  response.getHeaders().forEach((headerName, value) work? Just remove asMap().", "url": "https://github.com/prestodb/presto/pull/14650#discussion_r441278175", "createdAt": "2020-06-17T04:48:16Z", "author": {"login": "cemcayiroglu"}, "path": "presto-proxy/src/main/java/com/facebook/presto/proxy/ProxyResource.java", "diffHunk": "@@ -296,10 +296,10 @@ private static boolean isPrestoHeader(String name)\n \n     private static Response responseWithHeaders(ResponseBuilder builder, ProxyResponse response)\n     {\n-        response.getHeaders().asMap().forEach((headerName, value) -> {\n+        response.getHeaders().asMap().forEach((headerName, values) -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyMDU1NzUz", "url": "https://github.com/prestodb/presto/pull/14650#pullrequestreview-432055753", "createdAt": "2020-06-17T04:48:39Z", "commit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af2ac73b4ab16e35d704372c4b34015e950b9110", "author": {"user": {"login": "tdcmeehan", "name": "Timothy Meehan"}}, "url": "https://github.com/prestodb/presto/commit/af2ac73b4ab16e35d704372c4b34015e950b9110", "committedDate": "2020-06-17T16:55:06Z", "message": "Fix header handling in Presto Proxy"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3", "author": {"user": {"login": "tdcmeehan", "name": "Timothy Meehan"}}, "url": "https://github.com/prestodb/presto/commit/1461913ec01992044ec56250b982bf86476dbfb3", "committedDate": "2020-06-15T05:53:12Z", "message": "Fix header handling in Presto Proxy"}, "afterCommit": {"oid": "af2ac73b4ab16e35d704372c4b34015e950b9110", "author": {"user": {"login": "tdcmeehan", "name": "Timothy Meehan"}}, "url": "https://github.com/prestodb/presto/commit/af2ac73b4ab16e35d704372c4b34015e950b9110", "committedDate": "2020-06-17T16:55:06Z", "message": "Fix header handling in Presto Proxy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2ODQ2NDAw", "url": "https://github.com/prestodb/presto/pull/14650#pullrequestreview-436846400", "createdAt": "2020-06-24T17:11:42Z", "commit": {"oid": "af2ac73b4ab16e35d704372c4b34015e950b9110"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1381, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}