{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0ODcwODY4", "number": 15390, "title": "Add session property configuration manager for Presto-on-Spark", "bodyText": "Depended by facebookexternal/presto-facebook#1294\nGoal\n\nSupport session property override\nPresto on Spark doesn't have resource group, make regex matching rule for resource group optional\n\nTest\n\nEnd to end test done. See details in facebookexternal/presto-facebook#1294\n\n== NO RELEASE NOTE ==", "createdAt": "2020-11-03T16:58:31Z", "url": "https://github.com/prestodb/presto/pull/15390", "merged": true, "mergeCommit": {"oid": "673cb90df3debd52aadfd2060254a14e09ce9e97"}, "closed": true, "closedAt": "2020-11-04T20:00:26Z", "author": {"login": "viczhang861"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYrsQ4gH2gAyNTE0ODcwODY4OjM1ZTViMzM3MWMzMmEzYjBmY2QxZWQzYzJjMGEzZjA2YTU4M2QyNzg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZDst5ABqjM5NTU0NTkzMDQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "35e5b3371c32a3b0fcd1ed3c2c0a3f06a583d278", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/35e5b3371c32a3b0fcd1ed3c2c0a3f06a583d278", "committedDate": "2020-11-02T21:45:41Z", "message": "Refactor SessionPropertyDefaults to load properties map"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNzU1MjU0", "url": "https://github.com/prestodb/presto/pull/15390#pullrequestreview-522755254", "createdAt": "2020-11-03T18:07:34Z", "commit": {"oid": "bb05e244a0c924e96c65d23c27617d1dc8bb263e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyNzU4NTU1", "url": "https://github.com/prestodb/presto/pull/15390#pullrequestreview-522758555", "createdAt": "2020-11-03T18:12:03Z", "commit": {"oid": "bb05e244a0c924e96c65d23c27617d1dc8bb263e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxODoxMjowM1rOHs62zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QxODoxMjowM1rOHs62zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjg2MzY5NQ==", "bodyText": "It looks like it should be something like\nif (resourceGroupRegex.isPresent() && (!context.getResourceGroupId().isPresent() || !resourceGroupRegex.get().matcher(context.getResourceGroupId().get().toString()).matches()))", "url": "https://github.com/prestodb/presto/pull/15390#discussion_r516863695", "createdAt": "2020-11-03T18:12:03Z", "author": {"login": "arhimondr"}, "path": "presto-session-property-managers/src/main/java/com/facebook/presto/session/SessionMatchSpec.java", "diffHunk": "@@ -78,7 +78,9 @@ public SessionMatchSpec(\n             }\n         }\n \n-        if (resourceGroupRegex.isPresent() && !resourceGroupRegex.get().matcher(context.getResourceGroupId().toString()).matches()) {\n+        if (resourceGroupRegex.isPresent() &&\n+                context.getResourceGroupId().isPresent() &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb05e244a0c924e96c65d23c27617d1dc8bb263e"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb05e244a0c924e96c65d23c27617d1dc8bb263e", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/bb05e244a0c924e96c65d23c27617d1dc8bb263e", "committedDate": "2020-11-03T07:50:19Z", "message": "Add session property configuraiton manager for Presto-on-Spark"}, "afterCommit": {"oid": "6a033c681260b9c762f6320565dcb17a477987a1", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/6a033c681260b9c762f6320565dcb17a477987a1", "committedDate": "2020-11-03T20:50:22Z", "message": "Add session property configuraiton manager for Presto-on-Spark"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIyODkxNDU0", "url": "https://github.com/prestodb/presto/pull/15390#pullrequestreview-522891454", "createdAt": "2020-11-03T21:35:54Z", "commit": {"oid": "6a033c681260b9c762f6320565dcb17a477987a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMTozNTo1NFrOHtBTPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wM1QyMTozNTo1NFrOHtBTPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjk2OTI3Nw==", "bodyText": "nit: context.getResourceGroupId().orElse(\"\")", "url": "https://github.com/prestodb/presto/pull/15390#discussion_r516969277", "createdAt": "2020-11-03T21:35:54Z", "author": {"login": "arhimondr"}, "path": "presto-session-property-managers/src/main/java/com/facebook/presto/session/SessionMatchSpec.java", "diffHunk": "@@ -78,8 +78,14 @@ public SessionMatchSpec(\n             }\n         }\n \n-        if (resourceGroupRegex.isPresent() && !resourceGroupRegex.get().matcher(context.getResourceGroupId().toString()).matches()) {\n-            return ImmutableMap.of();\n+        if (resourceGroupRegex.isPresent()) {\n+            String resourceGroupId = \"\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a033c681260b9c762f6320565dcb17a477987a1"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f5eaa66140b4a6783978563a0843aef10da3c86", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/9f5eaa66140b4a6783978563a0843aef10da3c86", "committedDate": "2020-11-04T01:41:29Z", "message": "Make ResourceGroupId optional in SessionConfigurationContext\n\nFor Presto-on-Spark, it doesn't need ResourceGroupId."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b94a92ba43ba73ebe465dac711399ad75c7e77e6", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/b94a92ba43ba73ebe465dac711399ad75c7e77e6", "committedDate": "2020-11-04T01:41:34Z", "message": "Add session property configuraiton manager for Presto-on-Spark"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6a033c681260b9c762f6320565dcb17a477987a1", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/6a033c681260b9c762f6320565dcb17a477987a1", "committedDate": "2020-11-03T20:50:22Z", "message": "Add session property configuraiton manager for Presto-on-Spark"}, "afterCommit": {"oid": "b94a92ba43ba73ebe465dac711399ad75c7e77e6", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/b94a92ba43ba73ebe465dac711399ad75c7e77e6", "committedDate": "2020-11-04T01:41:34Z", "message": "Add session property configuraiton manager for Presto-on-Spark"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4668, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}