{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4Mjg3NTUz", "number": 14535, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxOTo1Nzo1OVrOD8_7Gg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMDo0NDoyOVrOD-Yo0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1Mjg4NDc0OnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/NoOpStatusDetector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxOTo1Nzo1OVrOGWSGmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMTowNzoyOVrOGXyqaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxODQ1Ng==", "bodyText": "Generally we don't use camelCase in package names. Lets change this to statusdetector. Also statusdetector is a very vague term - it doesn't clarify whose status is being detected.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426018456", "createdAt": "2020-05-15T19:57:59Z", "author": {"login": "mayankgarg1990"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/NoOpStatusDetector.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYwMDQ5MQ==", "bodyText": "updated and changed it to statuservice", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r427600491", "createdAt": "2020-05-19T21:07:29Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/NoOpStatusDetector.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxODQ1Ng=="}, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1Mjg4NTkwOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxOTo1ODozM1rOGWSHZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxOTo1ODozM1rOGWSHZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxODY2Mg==", "bodyText": "Generally we don't use camelCase in package names. Lets change this to statusdetector. Also statusdetector is a very vague term - it doesn't clarify whose status is being detected.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426018662", "createdAt": "2020-05-15T19:58:33Z", "author": {"login": "mayankgarg1990"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1Mjg4Njg5OnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxOTo1OTowMVrOGWSIGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQyMzo0NzowMVrOGWWhSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxODg0Mw==", "bodyText": "is this being used?", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426018843", "createdAt": "2020-05-15T19:59:01Z", "author": {"login": "mayankgarg1990"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;\n+\n+import java.util.List;\n+\n+public interface StatusDetector\n+{\n+    List<String> getDisabled();\n+\n+    enum State\n+    {\n+        ENABLE,\n+        DISABLE\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA5MDgyNA==", "bodyText": "nope, removing.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426090824", "createdAt": "2020-05-15T23:47:01Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;\n+\n+import java.util.List;\n+\n+public interface StatusDetector\n+{\n+    List<String> getDisabled();\n+\n+    enum State\n+    {\n+        ENABLE,\n+        DISABLE\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxODg0Mw=="}, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1Mjg5MjM0OnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQyMDowMTowMFrOGWSLiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMTowNzo1MFrOGXyrEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxOTcyMA==", "bodyText": "Currently this class only allows for support of disabled or blocked nodes. We should allow for someone to also specify the allowed nodes - if any node other than the allowed list tries to connect then it should fail.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426019720", "createdAt": "2020-05-15T20:01:00Z", "author": {"login": "mayankgarg1990"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;\n+\n+import java.util.List;\n+\n+public interface StatusDetector\n+{\n+    List<String> getDisabled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA5MDc3Ng==", "bodyText": "Yes going to introduce that once this flow looks good.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426090776", "createdAt": "2020-05-15T23:46:44Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;\n+\n+import java.util.List;\n+\n+public interface StatusDetector\n+{\n+    List<String> getDisabled();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxOTcyMA=="}, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc1NDcyMw==", "bodyText": "While I was initially thinking of getting this in Discovery service - seeing its complexity and this being the only use case - being here makes sense.\nI feel that this PR only should address this change. If we change the interface to isAllowed(String host) then we can just have the implementation take care of all the details - return true (for not care), return false (for disabled or if not in list) - just makes it a lot more flexible. What the proposed API prevents us from doing is to say give me a list of all the hosts that are disabled - but does it matter?", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426754723", "createdAt": "2020-05-18T16:34:28Z", "author": {"login": "mayankgarg1990"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;\n+\n+import java.util.List;\n+\n+public interface StatusDetector\n+{\n+    List<String> getDisabled();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxOTcyMA=="}, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYwMDY1OA==", "bodyText": "added isAllowed instead.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r427600658", "createdAt": "2020-05-19T21:07:50Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetector.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;\n+\n+import java.util.List;\n+\n+public interface StatusDetector\n+{\n+    List<String> getDisabled();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxOTcyMA=="}, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1Mjg5NzYzOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetectorConfig.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQyMDowMzowNVrOGWSO1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMTowOToyMVrOGXyt7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAyMDU2Ng==", "bodyText": "Given that we have the no-op implementation - do we need the enabled flag?", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426020566", "createdAt": "2020-05-15T20:03:05Z", "author": {"login": "mayankgarg1990"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetectorConfig.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;\n+\n+import com.facebook.airlift.configuration.Config;\n+\n+public class StatusDetectorConfig\n+{\n+    private boolean enabled;\n+\n+    public boolean isEnabled()\n+    {\n+        return enabled;\n+    }\n+\n+    @Config(\"status-detector.enabled\")\n+    public StatusDetectorConfig setEnabled(boolean enabled)\n+    {\n+        this.enabled = enabled;\n+        return this;\n+    }\n+}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA5MTIzNA==", "bodyText": "Having a config is good, so if we want to disable it without code change, we can do it quickly.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426091234", "createdAt": "2020-05-15T23:49:10Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetectorConfig.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;\n+\n+import com.facebook.airlift.configuration.Config;\n+\n+public class StatusDetectorConfig\n+{\n+    private boolean enabled;\n+\n+    public boolean isEnabled()\n+    {\n+        return enabled;\n+    }\n+\n+    @Config(\"status-detector.enabled\")\n+    public StatusDetectorConfig setEnabled(boolean enabled)\n+    {\n+        this.enabled = enabled;\n+        return this;\n+    }\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAyMDU2Ng=="}, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYwMTM4OQ==", "bodyText": "using it in DiscoveryNodeManager to decide if to call the NodeStatusService or not. Can be useful in case we want to disable the feature without deployment.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r427601389", "createdAt": "2020-05-19T21:09:21Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/statusDetector/StatusDetectorConfig.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusDetector;\n+\n+import com.facebook.airlift.configuration.Config;\n+\n+public class StatusDetectorConfig\n+{\n+    private boolean enabled;\n+\n+    public boolean isEnabled()\n+    {\n+        return enabled;\n+    }\n+\n+    @Config(\"status-detector.enabled\")\n+    public StatusDetectorConfig setEnabled(boolean enabled)\n+    {\n+        this.enabled = enabled;\n+        return this;\n+    }\n+}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAyMDU2Ng=="}, "originalCommit": {"oid": "d97052dec75783fa9bbf4b1416d899bd9cbf6e1d"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MzQzNjg0OnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NodeStatusDetector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMTozMTowNFrOGWXVWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMDo1NjowOFrOGXyT3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEwNDE1NA==", "bodyText": "just thinking about the name NodeStatusDetector, I think detector feels like it detects when the node is up/down/disabled etc.\nI feel like this is more of a NodeStatusService which provides a list of disabled servers.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426104154", "createdAt": "2020-05-16T01:31:04Z", "author": {"login": "ajaygeorge"}, "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NodeStatusDetector.java", "diffHunk": "@@ -0,0 +1,21 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusdetector;\n+\n+import java.util.List;\n+\n+public interface NodeStatusDetector", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "021395f8b5f225bddfd3f28eedade95fa2a42e87"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU5NDcxOA==", "bodyText": "done.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r427594718", "createdAt": "2020-05-19T20:56:08Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NodeStatusDetector.java", "diffHunk": "@@ -0,0 +1,21 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusdetector;\n+\n+import java.util.List;\n+\n+public interface NodeStatusDetector", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEwNDE1NA=="}, "originalCommit": {"oid": "021395f8b5f225bddfd3f28eedade95fa2a42e87"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MzQ0MDg4OnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NodeStatusDetector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMTozNzoxMVrOGWXXiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMDo1NTo1N1rOGXyTdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEwNDcxMg==", "bodyText": "How about Set<ServiceDescriptor> instead of List<String> since I think there cannot be duplicates and ServiceDescriptor captures the idea of node better than String", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426104712", "createdAt": "2020-05-16T01:37:11Z", "author": {"login": "ajaygeorge"}, "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NodeStatusDetector.java", "diffHunk": "@@ -0,0 +1,21 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusdetector;\n+\n+import java.util.List;\n+\n+public interface NodeStatusDetector\n+{\n+    List<String> getDisabled();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "021395f8b5f225bddfd3f28eedade95fa2a42e87"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU5NDYxNA==", "bodyText": "change the interface as per Mayank's suggestion and so no longer need getDisabled method.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r427594614", "createdAt": "2020-05-19T20:55:57Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NodeStatusDetector.java", "diffHunk": "@@ -0,0 +1,21 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusdetector;\n+\n+import java.util.List;\n+\n+public interface NodeStatusDetector\n+{\n+    List<String> getDisabled();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEwNDcxMg=="}, "originalCommit": {"oid": "021395f8b5f225bddfd3f28eedade95fa2a42e87"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MzQ0MjAyOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NodeStatusDetectorConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNlQwMTozODo0MVrOGWXYGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMDo1NTozNFrOGXySqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEwNDg1Nw==", "bodyText": "Are we using this anywhere. ?\nShouldn't the filtering logic in DiscoveryNodeManager.java respect this flag?", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426104857", "createdAt": "2020-05-16T01:38:41Z", "author": {"login": "ajaygeorge"}, "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NodeStatusDetectorConfig.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusdetector;\n+\n+import com.facebook.airlift.configuration.Config;\n+\n+public class NodeStatusDetectorConfig\n+{\n+    private boolean enabled;\n+\n+    public boolean isEnabled()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "021395f8b5f225bddfd3f28eedade95fa2a42e87"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU5NDQxMQ==", "bodyText": "made changes, please have a look at it again.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r427594411", "createdAt": "2020-05-19T20:55:34Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NodeStatusDetectorConfig.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusdetector;\n+\n+import com.facebook.airlift.configuration.Config;\n+\n+public class NodeStatusDetectorConfig\n+{\n+    private boolean enabled;\n+\n+    public boolean isEnabled()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEwNDg1Nw=="}, "originalCommit": {"oid": "021395f8b5f225bddfd3f28eedade95fa2a42e87"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1Nzg1MzczOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NoOpNodeStatusDetector.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNjo0MDo0NVrOGW_Q0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNjo0MToyOFrOGW_SgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc1ODM1NA==", "bodyText": "Can we define a lambda function instead?", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426758354", "createdAt": "2020-05-18T16:40:45Z", "author": {"login": "cemcayiroglu"}, "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NoOpNodeStatusDetector.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusdetector;\n+\n+import com.google.common.collect.ImmutableList;\n+\n+import java.util.List;\n+\n+public class NoOpNodeStatusDetector", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "021395f8b5f225bddfd3f28eedade95fa2a42e87"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc1ODc4NA==", "bodyText": "Sorry I think it is not possible because of the injection.", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r426758784", "createdAt": "2020-05-18T16:41:28Z", "author": {"login": "cemcayiroglu"}, "path": "presto-main/src/main/java/com/facebook/presto/statusdetector/NoOpNodeStatusDetector.java", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusdetector;\n+\n+import com.google.common.collect.ImmutableList;\n+\n+import java.util.List;\n+\n+public class NoOpNodeStatusDetector", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc1ODM1NA=="}, "originalCommit": {"oid": "021395f8b5f225bddfd3f28eedade95fa2a42e87"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MzA2NjgwOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/statusservice/NoOpNodeStatusService.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMDo1NzoxM1rOGXyV5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMDo1NzoxM1rOGXyV5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU5NTIzNw==", "bodyText": "Call this AllowAllStatusService?", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r427595237", "createdAt": "2020-05-19T20:57:13Z", "author": {"login": "tdcmeehan"}, "path": "presto-main/src/main/java/com/facebook/presto/statusservice/NoOpNodeStatusService.java", "diffHunk": "@@ -0,0 +1,24 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.statusservice;\n+\n+public class NoOpNodeStatusService", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dac5eaeb6ce11b75eaff8def9b05a610638707a0"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2NzQxOTY4OnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/server/ServerMainModule.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMDo0NDoyOVrOGYdI3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQyMzoxNDoyNFrOGYg_Sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODI5NjQxNQ==", "bodyText": "change this to configBinder(binder).bindConfig(NodeStatusServiceConfig.class) - this will make it actually read configuration properties. As of now the class will be initialized like any other class", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r428296415", "createdAt": "2020-05-20T20:44:29Z", "author": {"login": "mayankgarg1990"}, "path": "presto-main/src/main/java/com/facebook/presto/server/ServerMainModule.java", "diffHunk": "@@ -260,6 +263,8 @@ protected void setup(Binder binder)\n         // analyze properties\n         binder.bind(AnalyzePropertyManager.class).in(Scopes.SINGLETON);\n \n+        binder.bind(NodeStatusServiceConfig.class).in(Scopes.SINGLETON);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "33d02008c982e109db4ae35cea456624056b8bdb"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODM1OTQ5OA==", "bodyText": "done", "url": "https://github.com/prestodb/presto/pull/14535#discussion_r428359498", "createdAt": "2020-05-20T23:14:24Z", "author": {"login": "swapsmagic"}, "path": "presto-main/src/main/java/com/facebook/presto/server/ServerMainModule.java", "diffHunk": "@@ -260,6 +263,8 @@ protected void setup(Binder binder)\n         // analyze properties\n         binder.bind(AnalyzePropertyManager.class).in(Scopes.SINGLETON);\n \n+        binder.bind(NodeStatusServiceConfig.class).in(Scopes.SINGLETON);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODI5NjQxNQ=="}, "originalCommit": {"oid": "33d02008c982e109db4ae35cea456624056b8bdb"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2642, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}