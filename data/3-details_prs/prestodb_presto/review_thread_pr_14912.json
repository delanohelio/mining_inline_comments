{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4MDI4OTUx", "number": 14912, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDoyODoxN1rOES-t6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDoyODoxN1rOES-t6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg4MzM3Mzg1OnYy", "diffSide": "RIGHT", "path": "presto-spi/src/main/java/com/facebook/presto/spi/relation/LambdaDefinitionExpression.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDoyODoxN1rOG4dmIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwMDo1NDowOFrOG4kw3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg1ODMzOQ==", "bodyText": "Probably better to do it only for CAST so we don't accidentally cause other issues?", "url": "https://github.com/prestodb/presto/pull/14912#discussion_r461858339", "createdAt": "2020-07-28T20:28:17Z", "author": {"login": "kaikalur"}, "path": "presto-spi/src/main/java/com/facebook/presto/spi/relation/LambdaDefinitionExpression.java", "diffHunk": "@@ -133,7 +133,7 @@ public CanonicalizeExpression(List<String> arguments, List<Type> argumentTypes)\n         @Override\n         public String visitCall(CallExpression call, Void context)\n         {\n-            return format(\"%s.%s(%s)\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())));\n+            return format(\"%s.%s(%s):%s\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())), call.getType());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg2MjkxOA==", "bodyText": "For all other functions, return type should be the same if name and input type is the same. So this is just adding a little overhead. However, in any case that return type is different, it would be wrong to canonicalize them. So I think it's safe to keep it for all functions. Also not all cast functions are just called \"cast\". We don't really have an error prone way to identify all cast functions...", "url": "https://github.com/prestodb/presto/pull/14912#discussion_r461862918", "createdAt": "2020-07-28T20:37:04Z", "author": {"login": "rongrong"}, "path": "presto-spi/src/main/java/com/facebook/presto/spi/relation/LambdaDefinitionExpression.java", "diffHunk": "@@ -133,7 +133,7 @@ public CanonicalizeExpression(List<String> arguments, List<Type> argumentTypes)\n         @Override\n         public String visitCall(CallExpression call, Void context)\n         {\n-            return format(\"%s.%s(%s)\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())));\n+            return format(\"%s.%s(%s):%s\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())), call.getType());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg1ODMzOQ=="}, "originalCommit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk0NjYyMw==", "bodyText": "LGTM", "url": "https://github.com/prestodb/presto/pull/14912#discussion_r461946623", "createdAt": "2020-07-28T23:16:41Z", "author": {"login": "kaikalur"}, "path": "presto-spi/src/main/java/com/facebook/presto/spi/relation/LambdaDefinitionExpression.java", "diffHunk": "@@ -133,7 +133,7 @@ public CanonicalizeExpression(List<String> arguments, List<Type> argumentTypes)\n         @Override\n         public String visitCall(CallExpression call, Void context)\n         {\n-            return format(\"%s.%s(%s)\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())));\n+            return format(\"%s.%s(%s):%s\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())), call.getType());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg1ODMzOQ=="}, "originalCommit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk3NTc3Mw==", "bodyText": "probably good to have one parameter per line now? \ud83d\ude04", "url": "https://github.com/prestodb/presto/pull/14912#discussion_r461975773", "createdAt": "2020-07-29T00:54:08Z", "author": {"login": "wenleix"}, "path": "presto-spi/src/main/java/com/facebook/presto/spi/relation/LambdaDefinitionExpression.java", "diffHunk": "@@ -133,7 +133,7 @@ public CanonicalizeExpression(List<String> arguments, List<Type> argumentTypes)\n         @Override\n         public String visitCall(CallExpression call, Void context)\n         {\n-            return format(\"%s.%s(%s)\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())));\n+            return format(\"%s.%s(%s):%s\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())), call.getType());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg1ODMzOQ=="}, "originalCommit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2197, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}