{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMzA4MDA0", "number": 14204, "title": "Compare type by (name,type) pair rather than (index,type) pair during Parquet's schema mismatch checking", "bodyText": "Regarding parquet's schema mismatch checking, the existing implementation is selecting each sub-field by its index, which might cause fake alert of mismatching. e.g.\nstruct<a bigint, b string>. might mismatch parquet's group type {b binary, a int64}, but actually they are the same type.\nSo we add a map of <name, type> to compare each sub-field by name->type pair rather than index->type pair.\n== NO RELEASE NOTE ==", "createdAt": "2020-03-04T02:45:58Z", "url": "https://github.com/prestodb/presto/pull/14204", "merged": true, "mergeCommit": {"oid": "7a01f2be75286cc3ba2cfe15939f5d5773d95822"}, "closed": true, "closedAt": "2020-04-21T23:10:12Z", "author": {"login": "beinan"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKRPkbgFqTM2ODUzNzYwMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZ6RgKABqjMyNTc5MDkzNTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NTM3NjAz", "url": "https://github.com/prestodb/presto/pull/14204#pullrequestreview-368537603", "createdAt": "2020-03-04T06:49:14Z", "commit": {"oid": "2e2526cd3ed7fb860e8852c7f599df2b6dffc810"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwNjo0OToxNFrOFxhqqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQwNjo1MDowM1rOFxhrhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ3NjEzNw==", "bodyText": "use checkArgument", "url": "https://github.com/prestodb/presto/pull/14204#discussion_r387476137", "createdAt": "2020-03-04T06:49:14Z", "author": {"login": "zhenxiao"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/parquet/ParquetPageSourceFactory.java", "diffHunk": "@@ -322,8 +325,19 @@ private static boolean checkSchemaMatch(org.apache.parquet.schema.Type parquetTy\n             switch (prestoType) {\n                 case ROW:\n                     if (groupType.getFields().size() == type.getTypeParameters().size()) {\n+                        checkState(type instanceof RowType, \"It must be a RowType here.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e2526cd3ed7fb860e8852c7f599df2b6dffc810"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ3NjE5OA==", "bodyText": "s/f/field/g", "url": "https://github.com/prestodb/presto/pull/14204#discussion_r387476198", "createdAt": "2020-03-04T06:49:28Z", "author": {"login": "zhenxiao"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/parquet/ParquetPageSourceFactory.java", "diffHunk": "@@ -322,8 +325,19 @@ private static boolean checkSchemaMatch(org.apache.parquet.schema.Type parquetTy\n             switch (prestoType) {\n                 case ROW:\n                     if (groupType.getFields().size() == type.getTypeParameters().size()) {\n+                        checkState(type instanceof RowType, \"It must be a RowType here.\");\n+                        RowType rowType = (RowType) type;\n+                        Map<String, Type> prestoFieldMap = rowType.getFields().stream().collect(\n+                                Collectors.toMap(\n+                                        f -> f.getName().get(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e2526cd3ed7fb860e8852c7f599df2b6dffc810"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzQ3NjM1OQ==", "bodyText": "why use parquetFieldType.getName() + \"_\"?\nif prestoFieldType == null, we should return false?", "url": "https://github.com/prestodb/presto/pull/14204#discussion_r387476359", "createdAt": "2020-03-04T06:50:03Z", "author": {"login": "zhenxiao"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/parquet/ParquetPageSourceFactory.java", "diffHunk": "@@ -322,8 +325,19 @@ private static boolean checkSchemaMatch(org.apache.parquet.schema.Type parquetTy\n             switch (prestoType) {\n                 case ROW:\n                     if (groupType.getFields().size() == type.getTypeParameters().size()) {\n+                        checkState(type instanceof RowType, \"It must be a RowType here.\");\n+                        RowType rowType = (RowType) type;\n+                        Map<String, Type> prestoFieldMap = rowType.getFields().stream().collect(\n+                                Collectors.toMap(\n+                                        f -> f.getName().get(),\n+                                        f -> f.getType()));\n                         for (int i = 0; i < groupType.getFields().size(); i++) {\n-                            if (!checkSchemaMatch(groupType.getFields().get(i), type.getTypeParameters().get(i))) {\n+                            org.apache.parquet.schema.Type parquetFieldType = groupType.getFields().get(i);\n+                            Type prestoFieldType = prestoFieldMap.get(parquetFieldType.getName());\n+                            if (prestoFieldType == null) {\n+                                prestoFieldType = prestoFieldMap.get(parquetFieldType.getName() + \"_\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2e2526cd3ed7fb860e8852c7f599df2b6dffc810"}, "originalPosition": 39}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e2526cd3ed7fb860e8852c7f599df2b6dffc810", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/2e2526cd3ed7fb860e8852c7f599df2b6dffc810", "committedDate": "2020-03-04T02:43:13Z", "message": "Compare type by (name,type) pair rather than (index,type) pair during Parquet schema mismatch checking"}, "afterCommit": {"oid": "e94443fccefa8e3c2a78a54bb6875e8d9dbebba3", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/e94443fccefa8e3c2a78a54bb6875e8d9dbebba3", "committedDate": "2020-03-26T06:40:23Z", "message": "add unit test for parquet schema mismatch checker\n\nfix code review issues"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e94443fccefa8e3c2a78a54bb6875e8d9dbebba3", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/e94443fccefa8e3c2a78a54bb6875e8d9dbebba3", "committedDate": "2020-03-26T06:40:23Z", "message": "add unit test for parquet schema mismatch checker\n\nfix code review issues"}, "afterCommit": {"oid": "dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43", "committedDate": "2020-03-26T19:30:44Z", "message": "add unit test for parquet schema mismatch checker\n\nfix code review issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDg2NTky", "url": "https://github.com/prestodb/presto/pull/14204#pullrequestreview-382486592", "createdAt": "2020-03-26T23:23:12Z", "commit": {"oid": "dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMzoyMzoxM1rOF8d9XQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMzozMjoxMVrOF8eJNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk0OTcyNQ==", "bodyText": "do we need to check type here? prestoType is from type, which is ROW. I think we do not need this line", "url": "https://github.com/prestodb/presto/pull/14204#discussion_r398949725", "createdAt": "2020-03-26T23:23:13Z", "author": {"login": "zhenxiao"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/parquet/ParquetPageSourceFactory.java", "diffHunk": "@@ -322,8 +325,17 @@ private static boolean checkSchemaMatch(org.apache.parquet.schema.Type parquetTy\n             switch (prestoType) {\n                 case ROW:\n                     if (groupType.getFields().size() == type.getTypeParameters().size()) {\n+                        checkArgument(type instanceof RowType, \"It must be a RowType here.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk1MDgwNw==", "bodyText": "test out of order fields in nested Row type", "url": "https://github.com/prestodb/presto/pull/14204#discussion_r398950807", "createdAt": "2020-03-26T23:26:20Z", "author": {"login": "zhenxiao"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveFileFormats.java", "diffHunk": "@@ -722,6 +723,90 @@ public void testSchemaMismatch()\n                 .isFailingForPageSource(new ParquetPageSourceFactory(TYPE_MANAGER, HDFS_ENVIRONMENT, STATS, new HadoopFileOpener()), expectedErrorCode, expectedMessageRowLongNest);\n     }\n \n+    @Test\n+    public void testSchemaMismatchOnNestedStruct()\n+            throws Exception\n+    {\n+        //testing fields order does NOT matter", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk1MTkyMA==", "bodyText": "test field name case sensitivity in nested Row type", "url": "https://github.com/prestodb/presto/pull/14204#discussion_r398951920", "createdAt": "2020-03-26T23:29:39Z", "author": {"login": "zhenxiao"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveFileFormats.java", "diffHunk": "@@ -722,6 +723,90 @@ public void testSchemaMismatch()\n                 .isFailingForPageSource(new ParquetPageSourceFactory(TYPE_MANAGER, HDFS_ENVIRONMENT, STATS, new HadoopFileOpener()), expectedErrorCode, expectedMessageRowLongNest);\n     }\n \n+    @Test\n+    public void testSchemaMismatchOnNestedStruct()\n+            throws Exception\n+    {\n+        //testing fields order does NOT matter\n+        TestColumn writeColumn = new TestColumn(\"column_name\",\n+                getStandardMapObjectInspector(\n+                        javaStringObjectInspector,\n+                        getStandardListObjectInspector(\n+                                getStandardStructObjectInspector(\n+                                        ImmutableList.of(\"s_int\", \"s_double\"),\n+                                        ImmutableList.of(javaIntObjectInspector, javaDoubleObjectInspector)))),\n+                ImmutableMap.of(\"test\", ImmutableList.<Object>of(Arrays.asList(1, 5.0))),\n+                mapBlockOf(createUnboundedVarcharType(), new ArrayType(RowType.anonymous(ImmutableList.of(INTEGER, DOUBLE))),\n+                        \"test\", arrayBlockOf(RowType.anonymous(ImmutableList.of(INTEGER, DOUBLE)), rowBlockOf(ImmutableList.of(INTEGER, DOUBLE), 1L, 5.0))));\n+        TestColumn readColumn = new TestColumn(\"column_name\",\n+                getStandardMapObjectInspector(\n+                        javaStringObjectInspector,\n+                        getStandardListObjectInspector(\n+                                getStandardStructObjectInspector(\n+                                        ImmutableList.of(\"s_double\", \"s_int\"),  //out of order\n+                                        ImmutableList.of(javaDoubleObjectInspector, javaIntObjectInspector)))),\n+                ImmutableMap.of(\"test\", ImmutableList.<Object>of(Arrays.asList(5.0, 1))),\n+                mapBlockOf(createUnboundedVarcharType(), new ArrayType(RowType.anonymous(ImmutableList.of(DOUBLE, INTEGER))),\n+                        \"test\", arrayBlockOf(RowType.anonymous(ImmutableList.of(DOUBLE, INTEGER)), rowBlockOf(ImmutableList.of(DOUBLE, INTEGER), 5.0, 1L))));\n+        assertThatFileFormat(PARQUET)\n+                .withWriteColumns(ImmutableList.of(writeColumn))\n+                .withReadColumns(ImmutableList.of(readColumn))\n+                .withRowsCount(1)\n+                .withSession(parquetPageSourceSession)\n+                .isReadableByPageSource(new ParquetPageSourceFactory(TYPE_MANAGER, HDFS_ENVIRONMENT, STATS, new HadoopFileOpener()));\n+\n+        //testing field name case insensitive.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk1MjE4Nw==", "bodyText": "test field name mismatch in nested Row type", "url": "https://github.com/prestodb/presto/pull/14204#discussion_r398952187", "createdAt": "2020-03-26T23:30:28Z", "author": {"login": "zhenxiao"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveFileFormats.java", "diffHunk": "@@ -722,6 +723,90 @@ public void testSchemaMismatch()\n                 .isFailingForPageSource(new ParquetPageSourceFactory(TYPE_MANAGER, HDFS_ENVIRONMENT, STATS, new HadoopFileOpener()), expectedErrorCode, expectedMessageRowLongNest);\n     }\n \n+    @Test\n+    public void testSchemaMismatchOnNestedStruct()\n+            throws Exception\n+    {\n+        //testing fields order does NOT matter\n+        TestColumn writeColumn = new TestColumn(\"column_name\",\n+                getStandardMapObjectInspector(\n+                        javaStringObjectInspector,\n+                        getStandardListObjectInspector(\n+                                getStandardStructObjectInspector(\n+                                        ImmutableList.of(\"s_int\", \"s_double\"),\n+                                        ImmutableList.of(javaIntObjectInspector, javaDoubleObjectInspector)))),\n+                ImmutableMap.of(\"test\", ImmutableList.<Object>of(Arrays.asList(1, 5.0))),\n+                mapBlockOf(createUnboundedVarcharType(), new ArrayType(RowType.anonymous(ImmutableList.of(INTEGER, DOUBLE))),\n+                        \"test\", arrayBlockOf(RowType.anonymous(ImmutableList.of(INTEGER, DOUBLE)), rowBlockOf(ImmutableList.of(INTEGER, DOUBLE), 1L, 5.0))));\n+        TestColumn readColumn = new TestColumn(\"column_name\",\n+                getStandardMapObjectInspector(\n+                        javaStringObjectInspector,\n+                        getStandardListObjectInspector(\n+                                getStandardStructObjectInspector(\n+                                        ImmutableList.of(\"s_double\", \"s_int\"),  //out of order\n+                                        ImmutableList.of(javaDoubleObjectInspector, javaIntObjectInspector)))),\n+                ImmutableMap.of(\"test\", ImmutableList.<Object>of(Arrays.asList(5.0, 1))),\n+                mapBlockOf(createUnboundedVarcharType(), new ArrayType(RowType.anonymous(ImmutableList.of(DOUBLE, INTEGER))),\n+                        \"test\", arrayBlockOf(RowType.anonymous(ImmutableList.of(DOUBLE, INTEGER)), rowBlockOf(ImmutableList.of(DOUBLE, INTEGER), 5.0, 1L))));\n+        assertThatFileFormat(PARQUET)\n+                .withWriteColumns(ImmutableList.of(writeColumn))\n+                .withReadColumns(ImmutableList.of(readColumn))\n+                .withRowsCount(1)\n+                .withSession(parquetPageSourceSession)\n+                .isReadableByPageSource(new ParquetPageSourceFactory(TYPE_MANAGER, HDFS_ENVIRONMENT, STATS, new HadoopFileOpener()));\n+\n+        //testing field name case insensitive.\n+        readColumn = new TestColumn(\"column_name\",\n+                getStandardMapObjectInspector(\n+                        javaStringObjectInspector,\n+                        getStandardListObjectInspector(\n+                                getStandardStructObjectInspector(\n+                                        ImmutableList.of(\"s_DOUBLE\", \"s_INT\"),  //out of order\n+                                        ImmutableList.of(javaDoubleObjectInspector, javaIntObjectInspector)))),\n+                ImmutableMap.of(\"test\", ImmutableList.<Object>of(Arrays.asList(5.0, 1))),\n+                mapBlockOf(createUnboundedVarcharType(), new ArrayType(RowType.anonymous(ImmutableList.of(DOUBLE, INTEGER))),\n+                        \"test\", arrayBlockOf(RowType.anonymous(ImmutableList.of(DOUBLE, INTEGER)), rowBlockOf(ImmutableList.of(DOUBLE, INTEGER), 5.0, 1L))));\n+        assertThatFileFormat(PARQUET)\n+                .withWriteColumns(ImmutableList.of(writeColumn))\n+                .withReadColumns(ImmutableList.of(readColumn))\n+                .withRowsCount(1)\n+                .withSession(parquetPageSourceSession)\n+                .isReadableByPageSource(new ParquetPageSourceFactory(TYPE_MANAGER, HDFS_ENVIRONMENT, STATS, new HadoopFileOpener()));\n+\n+        //testing rename a sub-field would cause a failure.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk1Mjc1OA==", "bodyText": "do we need to error out when prestoFieldType == null? If parquet file has a field not exist in Presto metastore, it is OK we just leave it there. What do you think?", "url": "https://github.com/prestodb/presto/pull/14204#discussion_r398952758", "createdAt": "2020-03-26T23:32:11Z", "author": {"login": "zhenxiao"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/parquet/ParquetPageSourceFactory.java", "diffHunk": "@@ -322,8 +325,17 @@ private static boolean checkSchemaMatch(org.apache.parquet.schema.Type parquetTy\n             switch (prestoType) {\n                 case ROW:\n                     if (groupType.getFields().size() == type.getTypeParameters().size()) {\n+                        checkArgument(type instanceof RowType, \"It must be a RowType here.\");\n+                        RowType rowType = (RowType) type;\n+                        Map<String, Type> prestoFieldMap = rowType.getFields().stream().collect(\n+                                Collectors.toMap(\n+                                        field -> field.getName().get().toLowerCase(Locale.ENGLISH),\n+                                        field -> field.getType()));\n                         for (int i = 0; i < groupType.getFields().size(); i++) {\n-                            if (!checkSchemaMatch(groupType.getFields().get(i), type.getTypeParameters().get(i))) {\n+                            org.apache.parquet.schema.Type parquetFieldType = groupType.getFields().get(i);\n+                            String fieldName = parquetFieldType.getName().toLowerCase(Locale.ENGLISH);\n+                            Type prestoFieldType = prestoFieldMap.get(fieldName);\n+                            if (prestoFieldType == null || !checkSchemaMatch(parquetFieldType, prestoFieldType)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43"}, "originalPosition": 36}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/dbb3cb744bb0cbaf064c2ac43003c0cdeec85b43", "committedDate": "2020-03-26T19:30:44Z", "message": "add unit test for parquet schema mismatch checker\n\nfix code review issues"}, "afterCommit": {"oid": "6d450fab37c8cf38b740c286d9fda2268fe37444", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/6d450fab37c8cf38b740c286d9fda2268fe37444", "committedDate": "2020-04-15T06:10:16Z", "message": "add unit test for parquet schema mismatch checker\n\nfix code review issues"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d450fab37c8cf38b740c286d9fda2268fe37444", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/6d450fab37c8cf38b740c286d9fda2268fe37444", "committedDate": "2020-04-15T06:10:16Z", "message": "add unit test for parquet schema mismatch checker\n\nfix code review issues"}, "afterCommit": {"oid": "d27f94784f0b982a7d4ee18dc375911c42ce5487", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/d27f94784f0b982a7d4ee18dc375911c42ce5487", "committedDate": "2020-04-15T06:18:57Z", "message": "add unit test for parquet schema mismatch checker and fix code review issues"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d27f94784f0b982a7d4ee18dc375911c42ce5487", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/d27f94784f0b982a7d4ee18dc375911c42ce5487", "committedDate": "2020-04-15T06:18:57Z", "message": "add unit test for parquet schema mismatch checker and fix code review issues"}, "afterCommit": {"oid": "924069731feb29ecf843668b19c277351cccc183", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/924069731feb29ecf843668b19c277351cccc183", "committedDate": "2020-04-15T18:08:42Z", "message": "add unit test for parquet schema mismatch checker and fix code review issues"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "924069731feb29ecf843668b19c277351cccc183", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/924069731feb29ecf843668b19c277351cccc183", "committedDate": "2020-04-15T18:08:42Z", "message": "add unit test for parquet schema mismatch checker and fix code review issues"}, "afterCommit": {"oid": "4a30dee9d3206014685f89b039ba3df61d298b0d", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/4a30dee9d3206014685f89b039ba3df61d298b0d", "committedDate": "2020-04-21T08:03:17Z", "message": "Make parquet's schema checking more tolerant for adding/removing sub-field in struct"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ed33b474a3cd7127e52b3d2f3698338a4c5b411", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/8ed33b474a3cd7127e52b3d2f3698338a4c5b411", "committedDate": "2020-04-21T16:55:13Z", "message": "Use field name for Parquet schema mismatch checking"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3d71609a8064ec73fa6734a7043cc9436400a5e", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/f3d71609a8064ec73fa6734a7043cc9436400a5e", "committedDate": "2020-04-21T16:55:13Z", "message": "add unit test for parquet schema mismatch checker and fix code review issues"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a30dee9d3206014685f89b039ba3df61d298b0d", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/4a30dee9d3206014685f89b039ba3df61d298b0d", "committedDate": "2020-04-21T08:03:17Z", "message": "Make parquet's schema checking more tolerant for adding/removing sub-field in struct"}, "afterCommit": {"oid": "62963c921cb74eb3f7e4482e5250afa7a85b5459", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/62963c921cb74eb3f7e4482e5250afa7a85b5459", "committedDate": "2020-04-21T16:55:14Z", "message": "Make parquet's schema checking more tolerant for adding/removing sub-field in struct"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "62963c921cb74eb3f7e4482e5250afa7a85b5459", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/62963c921cb74eb3f7e4482e5250afa7a85b5459", "committedDate": "2020-04-21T16:55:14Z", "message": "Make parquet's schema checking more tolerant for adding/removing sub-field in struct"}, "afterCommit": {"oid": "1bba388c67fd250f395af107cdb999690b06e8e3", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/1bba388c67fd250f395af107cdb999690b06e8e3", "committedDate": "2020-04-21T18:18:03Z", "message": "Make parquet's schema checking more tolerant for adding and removing sub-field in struct"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57b0eb8b8542523c27c17d8722e144b48b553e0e", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/57b0eb8b8542523c27c17d8722e144b48b553e0e", "committedDate": "2020-04-21T21:07:10Z", "message": "Make parquet's schema check more tolerant for adding and removing sub-field in struct"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1bba388c67fd250f395af107cdb999690b06e8e3", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/1bba388c67fd250f395af107cdb999690b06e8e3", "committedDate": "2020-04-21T18:18:03Z", "message": "Make parquet's schema checking more tolerant for adding and removing sub-field in struct"}, "afterCommit": {"oid": "57b0eb8b8542523c27c17d8722e144b48b553e0e", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/57b0eb8b8542523c27c17d8722e144b48b553e0e", "committedDate": "2020-04-21T21:07:10Z", "message": "Make parquet's schema check more tolerant for adding and removing sub-field in struct"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1969, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}