{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk4MzkxMjIz", "number": 15272, "title": "Improve identity projection when the selectedPositions is a list", "bodyText": "This PR optimizes identity projection with two ways:\n\nCreate DictionaryBlock when the selectedPositions is a list;\nUse a faster and more memory efficient block size calculation.\n\nBenchmarkPageProcessor shows 21x improvement in throughput, 46x reduction in gc.alloc.rate.norm, and 9x reduction in\nGC count and time:\nBefore\n    Benchmark                                                                    Mode  Cnt       Score      Error   Units\n    BenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\n    Benchmark                                                                    Mode  Cnt        Score        Error   Units\n    BenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\n    BenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms\n\n== NO RELEASE NOTE ==", "createdAt": "2020-10-06T09:16:23Z", "url": "https://github.com/prestodb/presto/pull/15272", "merged": true, "mergeCommit": {"oid": "ee74e4bdcdb13ef0414506dccee058d4f1e2bbc9"}, "closed": true, "closedAt": "2020-10-14T14:14:46Z", "author": {"login": "yingsu00"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQG3boABqjM4NDg3NDkxMDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSd2hIAFqTUwODM5MzI5Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9731a12b7819e5015f384efc7af3dbed49f08999", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/9731a12b7819e5015f384efc7af3dbed49f08999", "committedDate": "2020-10-06T09:11:38Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}, "afterCommit": {"oid": "9b937f7a30cb4afa1a42b6d74ab0ecd7a057c79f", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/9b937f7a30cb4afa1a42b6d74ab0ecd7a057c79f", "committedDate": "2020-10-07T06:19:25Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7a667e9e4bbc264fb5ad53faeda6d9fe1a1b275", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/c7a667e9e4bbc264fb5ad53faeda6d9fe1a1b275", "committedDate": "2020-10-07T22:42:23Z", "message": "Create DictionaryBlock for identity projections"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b937f7a30cb4afa1a42b6d74ab0ecd7a057c79f", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/9b937f7a30cb4afa1a42b6d74ab0ecd7a057c79f", "committedDate": "2020-10-07T06:19:25Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}, "afterCommit": {"oid": "8d6a7cc4cdb64d98248b4cc7d76a525699975c5d", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/8d6a7cc4cdb64d98248b4cc7d76a525699975c5d", "committedDate": "2020-10-07T22:42:23Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d6a7cc4cdb64d98248b4cc7d76a525699975c5d", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/8d6a7cc4cdb64d98248b4cc7d76a525699975c5d", "committedDate": "2020-10-07T22:42:23Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}, "afterCommit": {"oid": "930c2294b8a9aba14d397920eca3c107c2099e88", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/930c2294b8a9aba14d397920eca3c107c2099e88", "committedDate": "2020-10-07T23:01:05Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "930c2294b8a9aba14d397920eca3c107c2099e88", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/930c2294b8a9aba14d397920eca3c107c2099e88", "committedDate": "2020-10-07T23:01:05Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}, "afterCommit": {"oid": "90ca8e5981dbbd10f81b433695597fbfeaa3678e", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/90ca8e5981dbbd10f81b433695597fbfeaa3678e", "committedDate": "2020-10-08T00:45:39Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "90ca8e5981dbbd10f81b433695597fbfeaa3678e", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/90ca8e5981dbbd10f81b433695597fbfeaa3678e", "committedDate": "2020-10-08T00:45:39Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}, "afterCommit": {"oid": "2f49a9018d4e5dfbc104b14f56f40962b536e64e", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/2f49a9018d4e5dfbc104b14f56f40962b536e64e", "committedDate": "2020-10-09T06:33:40Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1NjcwODE4", "url": "https://github.com/prestodb/presto/pull/15272#pullrequestreview-505670818", "createdAt": "2020-10-09T13:26:47Z", "commit": {"oid": "e90e1c4ae6f6d8b65be227e06fb43993f5bd7342"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMzoyNjo0N1rOHfJpLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOVQxMzoyOTowMVrOHfJuuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQyNTkwMw==", "bodyText": "positionCount -> entryCount or length?", "url": "https://github.com/prestodb/presto/pull/15272#discussion_r502425903", "createdAt": "2020-10-09T13:26:47Z", "author": {"login": "mbasmanova"}, "path": "presto-common/src/main/java/com/facebook/presto/common/block/AbstractMapBlock.java", "diffHunk": "@@ -194,6 +194,22 @@ public long getRegionLogicalSizeInBytes(int position, int length)\n                 Integer.BYTES * HASH_MULTIPLIER * entryCount;\n     }\n \n+    @Override\n+    public long getApproximateRegionLogicalSizeInBytes(int position, int length)\n+    {\n+        int positionCount = getPositionCount();\n+        checkValidRegion(positionCount, position, length);\n+\n+        int entriesStart = getOffset(position);\n+        int entriesEnd = getOffset(position + length);\n+        int entryCount = entriesEnd - entriesStart;\n+\n+        return getRawKeyBlock().getApproximateRegionLogicalSizeInBytes(entriesStart, entryCount) +\n+                getRawValueBlock().getApproximateRegionLogicalSizeInBytes(entriesStart, entryCount) +\n+                (Integer.BYTES + Byte.BYTES) * positionCount +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e90e1c4ae6f6d8b65be227e06fb43993f5bd7342"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQyNjg1Mg==", "bodyText": "positionCount -> length?", "url": "https://github.com/prestodb/presto/pull/15272#discussion_r502426852", "createdAt": "2020-10-09T13:28:13Z", "author": {"login": "mbasmanova"}, "path": "presto-common/src/main/java/com/facebook/presto/common/block/AbstractRowBlock.java", "diffHunk": "@@ -130,6 +129,24 @@ public long getRegionLogicalSizeInBytes(int position, int length)\n         return regionLogicalSizeInBytes;\n     }\n \n+    @Override\n+    public long getApproximateRegionLogicalSizeInBytes(int position, int length)\n+    {\n+        int positionCount = getPositionCount();\n+        checkValidRegion(positionCount, position, length);\n+\n+        int startFieldBlockOffset = getFieldBlockOffset(position);\n+        int endFieldBlockOffset = getFieldBlockOffset(position + length);\n+        int fieldBlockLength = endFieldBlockOffset - startFieldBlockOffset;\n+\n+        long approximateLogicalSizeInBytes = (Integer.BYTES + Byte.BYTES) * positionCount;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e90e1c4ae6f6d8b65be227e06fb43993f5bd7342"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQyNzMyMw==", "bodyText": "what's the reason for * 1.0f ?", "url": "https://github.com/prestodb/presto/pull/15272#discussion_r502427323", "createdAt": "2020-10-09T13:29:01Z", "author": {"login": "mbasmanova"}, "path": "presto-common/src/main/java/com/facebook/presto/common/block/DictionaryBlock.java", "diffHunk": "@@ -280,6 +280,12 @@ public long getRegionLogicalSizeInBytes(int positionOffset, int length)\n         return sizeInBytes;\n     }\n \n+    @Override\n+    public long getApproximateRegionLogicalSizeInBytes(int position, int length)\n+    {\n+        return (long) (dictionary.getApproximateRegionLogicalSizeInBytes(0, dictionary.getPositionCount()) * 1.0f * length / positionCount);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e90e1c4ae6f6d8b65be227e06fb43993f5bd7342"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68a4f5f9d66b07ccb4c6da74e335bdaf72651ce8", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/68a4f5f9d66b07ccb4c6da74e335bdaf72651ce8", "committedDate": "2020-10-10T01:03:43Z", "message": "Add getApproximateRegionLogicalSizeInBytes() to Block\n\ngetApproximateRegionLogicalSizeInBytes provides a faster implementation\nto get approximate logical sizes of the blocks."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9868a3c7e4d601ba44af4d17b90215ddb7b2a9ea", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/9868a3c7e4d601ba44af4d17b90215ddb7b2a9ea", "committedDate": "2020-10-10T01:03:43Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2f49a9018d4e5dfbc104b14f56f40962b536e64e", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/2f49a9018d4e5dfbc104b14f56f40962b536e64e", "committedDate": "2020-10-09T06:33:40Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}, "afterCommit": {"oid": "9868a3c7e4d601ba44af4d17b90215ddb7b2a9ea", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/9868a3c7e4d601ba44af4d17b90215ddb7b2a9ea", "committedDate": "2020-10-10T01:03:43Z", "message": "Use getApproximateLogicalSizeInBytes() in PageProcessor\n\nBenchmarkPageProcessor shows 21x improvment in throughput and 10x reduction in\nmemory allocation and GC:\n\nBefore\nBenchmark                                                                    Mode  Cnt       Score      Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   50  125261.816 \u00b1 5342.200   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   50    2439.004 \u00b1  103.990  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   50   40832.029 \u00b1    0.033    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   50    2461.428 \u00b1  364.315  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   50   41439.660 \u00b1 6521.978    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   50       0.016 \u00b1    0.016  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   50       0.257 \u00b1    0.267    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   50      46.000             counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   50     181.000                 ms\n\nAfter\nBenchmark                                                                    Mode  Cnt        Score        Error   Units\nBenchmarkPageProcessor.identityProjection                                   thrpt   10  2687127.250 \u00b1 337956.918   ops/s\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate                    thrpt   10     1118.285 \u00b1    141.900  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.alloc.rate.norm               thrpt   10      872.001 \u00b1      0.005    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space           thrpt   10     1050.013 \u00b1   1683.604  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Eden_Space.norm      thrpt   10      827.947 \u00b1   1329.288    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space       thrpt   10        0.012 \u00b1      0.040  MB/sec\nBenchmarkPageProcessor.identityProjection:\u00b7gc.churn.PS_Survivor_Space.norm  thrpt   10        0.011 \u00b1      0.034    B/op\nBenchmarkPageProcessor.identityProjection:\u00b7gc.count                         thrpt   10        5.000               counts\nBenchmarkPageProcessor.identityProjection:\u00b7gc.time                          thrpt   10       21.000                   ms"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MzkzMjkz", "url": "https://github.com/prestodb/presto/pull/15272#pullrequestreview-508393293", "createdAt": "2020-10-14T14:14:40Z", "commit": {"oid": "9868a3c7e4d601ba44af4d17b90215ddb7b2a9ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4851, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}