{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzNjY2NDc5", "number": 15550, "title": "Support driver level plan in fragment result caching", "bodyText": "Test plan - Added unit test. Will also do verifier correctness test\n== RELEASE NOTES ==\n\nGeneral Changes\n* Support fragment result caching for queries with local exchange (e.g. intermediate aggregation).", "createdAt": "2020-12-21T18:57:17Z", "url": "https://github.com/prestodb/presto/pull/15550", "merged": true, "mergeCommit": {"oid": "b1846c1bae374a0bc70675166fa1903b2b1ddd83"}, "closed": true, "closedAt": "2020-12-23T21:57:08Z", "author": {"login": "shixuan-fan"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdoc2AMABqjQxMzc2OTYxNzk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpD1HsABqjQxNDUyMDg0NDI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a2a94362cf7b3d56eb954d6ad6637c6111f35e86", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/a2a94362cf7b3d56eb954d6ad6637c6111f35e86", "committedDate": "2020-12-21T18:53:22Z", "message": "Support driver level plan in fragment result caching\n\nThis would enable fragment result caching on the leaf driver when\nthere are multiple drivers in the lifespan introduced by local\nexchange, for example, intermediate aggregation"}, "afterCommit": {"oid": "cb062fbbabd87a7437deea5e9c88d6fb0d341937", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/cb062fbbabd87a7437deea5e9c88d6fb0d341937", "committedDate": "2020-12-21T21:30:15Z", "message": "Support driver level plan in fragment result caching\n\nThis would enable fragment result caching on the leaf driver when\nthere are multiple drivers in the lifespan introduced by local\nexchange, for example, intermediate aggregation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU2Nzc5NDQ1", "url": "https://github.com/prestodb/presto/pull/15550#pullrequestreview-556779445", "createdAt": "2020-12-22T02:28:03Z", "commit": {"oid": "cb062fbbabd87a7437deea5e9c88d6fb0d341937"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQwMjoyODowM1rOIJsKRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQwMjozMzo0OFrOIJsP-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzAzMTYyMg==", "bodyText": "Looking at visitFilter, do we need to handle DynamicFilterPlaceholderFunction in this case?", "url": "https://github.com/prestodb/presto/pull/15550#discussion_r547031622", "createdAt": "2020-12-22T02:28:03Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/CanonicalPlanGenerator.java", "diffHunk": "@@ -53,11 +52,15 @@\n     private final PlanNodeIdAllocator planNodeidAllocator = new PlanNodeIdAllocator();\n     private final PlanVariableAllocator variableAllocator = new PlanVariableAllocator();\n \n-    public static Optional<CanonicalPlanFragment> generateCanonicalPlan(PlanNode root, PartitioningScheme partitioningScheme)\n+    public static Optional<CanonicalPlanFragment> generateCanonicalPlan(PlanNode root, List<VariableReferenceExpression> outputLayout)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb062fbbabd87a7437deea5e9c88d6fb0d341937"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzAzMzA4Mg==", "bodyText": "Could you reminds me a bit on why we need partitioning scheme at the very first place? For outputLayout, would that be the same as canonicalPlan.get().getOutputVariables()?", "url": "https://github.com/prestodb/presto/pull/15550#discussion_r547033082", "createdAt": "2020-12-22T02:33:48Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/sql/planner/CanonicalPlanGenerator.java", "diffHunk": "@@ -53,11 +52,15 @@\n     private final PlanNodeIdAllocator planNodeidAllocator = new PlanNodeIdAllocator();\n     private final PlanVariableAllocator variableAllocator = new PlanVariableAllocator();\n \n-    public static Optional<CanonicalPlanFragment> generateCanonicalPlan(PlanNode root, PartitioningScheme partitioningScheme)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cb062fbbabd87a7437deea5e9c88d6fb0d341937"}, "originalPosition": 12}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cb062fbbabd87a7437deea5e9c88d6fb0d341937", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/cb062fbbabd87a7437deea5e9c88d6fb0d341937", "committedDate": "2020-12-21T21:30:15Z", "message": "Support driver level plan in fragment result caching\n\nThis would enable fragment result caching on the leaf driver when\nthere are multiple drivers in the lifespan introduced by local\nexchange, for example, intermediate aggregation"}, "afterCommit": {"oid": "ff2560073a6273f911f9e3600388ba7f5e8212d0", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/ff2560073a6273f911f9e3600388ba7f5e8212d0", "committedDate": "2020-12-22T18:44:59Z", "message": "Support driver level plan in fragment result caching\n\nThis would enable fragment result caching on the leaf driver when\nthere are multiple drivers in the lifespan introduced by local\nexchange, for example, intermediate aggregation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bac5d5b99517ff051f25177bec1df23ee2b71c8", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/5bac5d5b99517ff051f25177bec1df23ee2b71c8", "committedDate": "2020-12-22T19:10:38Z", "message": "Remove unused method in LocalExecutionPlanner"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3NjcxOTc2", "url": "https://github.com/prestodb/presto/pull/15550#pullrequestreview-557671976", "createdAt": "2020-12-23T06:46:08Z", "commit": {"oid": "ff2560073a6273f911f9e3600388ba7f5e8212d0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0262da33011ca48a8776b1415aebe753dcd0ca1c", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/0262da33011ca48a8776b1415aebe753dcd0ca1c", "committedDate": "2020-12-23T18:55:34Z", "message": "Support driver level plan in fragment result caching\n\nThis would enable fragment result caching on the leaf driver when\nthere are multiple drivers in the lifespan introduced by local\nexchange, for example, intermediate aggregation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ff2560073a6273f911f9e3600388ba7f5e8212d0", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/ff2560073a6273f911f9e3600388ba7f5e8212d0", "committedDate": "2020-12-22T18:44:59Z", "message": "Support driver level plan in fragment result caching\n\nThis would enable fragment result caching on the leaf driver when\nthere are multiple drivers in the lifespan introduced by local\nexchange, for example, intermediate aggregation"}, "afterCommit": {"oid": "0262da33011ca48a8776b1415aebe753dcd0ca1c", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/0262da33011ca48a8776b1415aebe753dcd0ca1c", "committedDate": "2020-12-23T18:55:34Z", "message": "Support driver level plan in fragment result caching\n\nThis would enable fragment result caching on the leaf driver when\nthere are multiple drivers in the lifespan introduced by local\nexchange, for example, intermediate aggregation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4591, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}