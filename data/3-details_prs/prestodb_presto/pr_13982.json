{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0MzQ4ODQ3", "number": 13982, "title": "Cache builtin function resolution result", "bodyText": "== RELEASE NOTES ==\n\nGeneral Changes\n* Improve built-in function resolution performance by caching function resolution results.", "createdAt": "2020-01-17T22:47:52Z", "url": "https://github.com/prestodb/presto/pull/13982", "merged": true, "mergeCommit": {"oid": "683474aaad754219fe59d85b81322d2fc54d72be"}, "closed": true, "closedAt": "2020-01-21T20:18:54Z", "author": {"login": "rongrong"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7W69HAH2gAyMzY0MzQ4ODQ3OjdlNzMxY2FhZGQzNTAzNzViYzc0OGJlMzViZmQ0YzdjNWZlMWRiODU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8mGv-gFqTM0NjEyMzIzMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7e731caadd350375bc748be35bfd4c7c5fe1db85", "author": {"user": {"login": "rongrong", "name": "Rongrong Zhong"}}, "url": "https://github.com/prestodb/presto/commit/7e731caadd350375bc748be35bfd4c7c5fe1db85", "committedDate": "2020-01-17T22:58:46Z", "message": "Cache builtin function resolution result"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "436bcffb1517ce4061f9c1e654934dbc570327de", "author": {"user": {"login": "rongrong", "name": "Rongrong Zhong"}}, "url": "https://github.com/prestodb/presto/commit/436bcffb1517ce4061f9c1e654934dbc570327de", "committedDate": "2020-01-17T22:45:35Z", "message": "Cache builtin function resolution result"}, "afterCommit": {"oid": "7e731caadd350375bc748be35bfd4c7c5fe1db85", "author": {"user": {"login": "rongrong", "name": "Rongrong Zhong"}}, "url": "https://github.com/prestodb/presto/commit/7e731caadd350375bc748be35bfd4c7c5fe1db85", "committedDate": "2020-01-17T22:58:46Z", "message": "Cache builtin function resolution result"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0OTE0Mjg5", "url": "https://github.com/prestodb/presto/pull/13982#pullrequestreview-344914289", "createdAt": "2020-01-18T01:21:00Z", "commit": {"oid": "7e731caadd350375bc748be35bfd4c7c5fe1db85"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MTIzMjMx", "url": "https://github.com/prestodb/presto/pull/13982#pullrequestreview-346123231", "createdAt": "2020-01-21T19:12:04Z", "commit": {"oid": "7e731caadd350375bc748be35bfd4c7c5fe1db85"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxOToxMjowNFrOFgFl2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMVQxOToxMjowNFrOFgFl2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTE5MDM2Mw==", "bodyText": "We have 500+ functions, with high chances of different parameterTypes resolving to the same function, the cache could easily exceeds 1k entries after a reasonable amount of queries are executable. What about giving it a more generous size, like 10k? Or even better, make else it configurable?", "url": "https://github.com/prestodb/presto/pull/13982#discussion_r369190363", "createdAt": "2020-01-21T19:12:04Z", "author": {"login": "caithagoras"}, "path": "presto-main/src/main/java/com/facebook/presto/metadata/FunctionManager.java", "diffHunk": "@@ -122,6 +132,11 @@ public FunctionManager(\n         }\n         // TODO: Provide a more encapsulated way for TransactionManager to register FunctionNamespaceManager\n         transactionManager.registerFunctionNamespaceManager(BuiltInFunctionNamespaceManager.ID, builtInFunctionNamespaceManager);\n+        this.functionCache = CacheBuilder.newBuilder()\n+                .recordStats()\n+                .maximumSize(1000)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7e731caadd350375bc748be35bfd4c7c5fe1db85"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2442, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}