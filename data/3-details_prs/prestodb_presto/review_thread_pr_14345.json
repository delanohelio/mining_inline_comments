{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5MzYwNTA3", "number": 14345, "reviewThreads": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNTo0MVrODvNiZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMjoyNDowMlrODvzxUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODMxNDYxOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNTo0MVrOGBgSKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNTo0MVrOGBgSKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzMDY5OA==", "bodyText": "private", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404230698", "createdAt": "2020-04-06T16:35:41Z", "author": {"login": "highker"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcAggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+\n+public class HiveOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    private AggregatedMemoryContext delegate;\n+\n+    public HiveOrcAggregatedMemoryContext()\n+    {\n+        this.delegate = newSimpleAggregatedMemoryContext();\n+    }\n+\n+    public HiveOrcAggregatedMemoryContext(AggregatedMemoryContext delegate)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 32}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODMxNTUyOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNTo1M1rOGBgSsQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNTo1M1rOGBgSsQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzMDgzMw==", "bodyText": "requireNonNull", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404230833", "createdAt": "2020-04-06T16:35:53Z", "author": {"login": "highker"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcAggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+\n+public class HiveOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    private AggregatedMemoryContext delegate;\n+\n+    public HiveOrcAggregatedMemoryContext()\n+    {\n+        this.delegate = newSimpleAggregatedMemoryContext();\n+    }\n+\n+    public HiveOrcAggregatedMemoryContext(AggregatedMemoryContext delegate)\n+    {\n+        this.delegate = delegate;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODMxNzIzOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNjoyNVrOGBgT7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNjoyNVrOGBgT7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzMTE0OQ==", "bodyText": "final", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404231149", "createdAt": "2020-04-06T16:36:25Z", "author": {"login": "highker"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,60 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcAggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+\n+public class HiveOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    private AggregatedMemoryContext delegate;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODMxNzU1OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcLocalMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNjozMFrOGBgUIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNjozMFrOGBgUIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzMTIwMg==", "bodyText": "final", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404231202", "createdAt": "2020-04-06T16:36:30Z", "author": {"login": "highker"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive;\n+\n+import com.facebook.presto.memory.context.LocalMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+public class HiveOrcLocalMemoryContext\n+        implements OrcLocalMemoryContext\n+{\n+    private LocalMemoryContext delegate;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODMxODQxOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcLocalMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNjo0MVrOGBgUow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNjo0MVrOGBgUow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzMTMzMQ==", "bodyText": "requireNonNull", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404231331", "createdAt": "2020-04-06T16:36:41Z", "author": {"login": "highker"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive;\n+\n+import com.facebook.presto.memory.context.LocalMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+public class HiveOrcLocalMemoryContext\n+        implements OrcLocalMemoryContext\n+{\n+    private LocalMemoryContext delegate;\n+\n+    public HiveOrcLocalMemoryContext(LocalMemoryContext delegate)\n+    {\n+        this.delegate = delegate;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODMyMDMzOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcLocalMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNzoxM1rOGBgV3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozNzoxM1rOGBgV3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzMTY0Ng==", "bodyText": "package-private", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404231646", "createdAt": "2020-04-06T16:37:13Z", "author": {"login": "highker"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive;\n+\n+import com.facebook.presto.memory.context.LocalMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+public class HiveOrcLocalMemoryContext\n+        implements OrcLocalMemoryContext\n+{\n+    private LocalMemoryContext delegate;\n+\n+    public HiveOrcLocalMemoryContext(LocalMemoryContext delegate)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 25}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODMyNDU5OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/orc/OrcBatchPageSourceFactory.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozODoxNFrOGBgYhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjozODoxNFrOGBgYhQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzMjMyNQ==", "bodyText": "nit: OrcAggregatedMemoryContext. Use interfaces whenever possible on declaration. Same for all other places.", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404232325", "createdAt": "2020-04-06T16:38:14Z", "author": {"login": "highker"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/orc/OrcBatchPageSourceFactory.java", "diffHunk": "@@ -236,9 +235,9 @@ public static OrcBatchPageSource createOrcPageSource(\n             throw new PrestoException(HIVE_CANNOT_OPEN_SPLIT, splitError(e, path, start, length), e);\n         }\n \n-        AggregatedMemoryContext systemMemoryUsage = newSimpleAggregatedMemoryContext();\n+        HiveOrcAggregatedMemoryContext systemMemoryUsage = new HiveOrcAggregatedMemoryContext();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODM0MDg5OnYy", "diffSide": "RIGHT", "path": "presto-orc/src/main/java/com/facebook/presto/orc/OrcReader.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjo0MjowMFrOGBgieQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjo0MjowMFrOGBgieQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzNDg3Mw==", "bodyText": "Move this above orcReaderOptions", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404234873", "createdAt": "2020-04-06T16:42:00Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/OrcReader.java", "diffHunk": "@@ -72,10 +70,11 @@ public OrcReader(\n             OrcFileTailSource orcFileTailSource,\n             StripeMetadataSource stripeMetadataSource,\n             OrcReaderOptions orcReaderOptions,\n-            boolean cacheable)\n+            boolean cacheable,\n+            OrcAggregatedMemoryContext aggregatedMemoryContext)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 22}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODM0ODYzOnYy", "diffSide": "RIGHT", "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjo0Mzo0OFrOGBgnPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjo0Mzo0OFrOGBgnPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzNjA5Mw==", "bodyText": "Nah, we cannot return null. We should return another no-op memory context.", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404236093", "createdAt": "2020-04-06T16:43:48Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+public class NoopOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    public OrcAggregatedMemoryContext newOrcAggregatedMemoryContext()\n+    {\n+        return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODM0OTQyOnYy", "diffSide": "RIGHT", "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjo0Mzo1OVrOGBgnwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjo0Mzo1OVrOGBgnwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzNjIyNQ==", "bodyText": "same", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404236225", "createdAt": "2020-04-06T16:43:59Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+public class NoopOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    public OrcAggregatedMemoryContext newOrcAggregatedMemoryContext()\n+    {\n+        return null;\n+    }\n+\n+    public OrcLocalMemoryContext newOrcLocalMemoryContext(String allocationTag)\n+    {\n+        return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODM1MzA0OnYy", "diffSide": "RIGHT", "path": "presto-orc/src/main/java/com/facebook/presto/orc/OrcReader.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNjo0NDo1NFrOGBgqNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOTozNjo0MlrOGBm7jQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzNjg1NA==", "bodyText": "make a static final variable in class NoopOrcAggregatedMemoryContext so we don't have to \"new\" it every time.", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404236854", "createdAt": "2020-04-06T16:44:54Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/OrcReader.java", "diffHunk": "@@ -285,12 +285,13 @@ static void validateFile(\n                     new StorageStripeMetadataSource(),\n                     Optional.of(writeValidation),\n                     orcReaderOptions,\n-                    false);\n+                    false,\n+                    new NoopOrcAggregatedMemoryContext());\n             try (OrcBatchRecordReader orcRecordReader = orcReader.createBatchRecordReader(\n                     readTypes.build(),\n                     OrcPredicate.TRUE,\n                     hiveStorageTimeZone,\n-                    newSimpleAggregatedMemoryContext(),\n+                    new NoopOrcAggregatedMemoryContext(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMxNTk0Mg==", "bodyText": "I am not sure if Noop is a valid argument here. Because its not equivalent of newSimpleAggregatedMemoryContext(). Should we instead use the OrcAggregatedMemoryContext  sent to OrcReader ?\nAlso looks like tests in TestOrcReaderMemoryUsage expect a valid memory context rather than a noop one as they assert on reader.getCurrentStripeRetainedSizeInBytes().  Let me know your comments.", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404315942", "createdAt": "2020-04-06T18:54:18Z", "author": {"login": "NikhilCollooru"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/OrcReader.java", "diffHunk": "@@ -285,12 +285,13 @@ static void validateFile(\n                     new StorageStripeMetadataSource(),\n                     Optional.of(writeValidation),\n                     orcReaderOptions,\n-                    false);\n+                    false,\n+                    new NoopOrcAggregatedMemoryContext());\n             try (OrcBatchRecordReader orcRecordReader = orcReader.createBatchRecordReader(\n                     readTypes.build(),\n                     OrcPredicate.TRUE,\n                     hiveStorageTimeZone,\n-                    newSimpleAggregatedMemoryContext(),\n+                    new NoopOrcAggregatedMemoryContext(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzNjg1NA=="}, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMyMTU4NQ==", "bodyText": "You need to pass the HiveOrc memory context rather than NOOP_ORC_AGGREGATED_MEMORY_CONTEXT in the test right?", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404321585", "createdAt": "2020-04-06T19:04:12Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/OrcReader.java", "diffHunk": "@@ -285,12 +285,13 @@ static void validateFile(\n                     new StorageStripeMetadataSource(),\n                     Optional.of(writeValidation),\n                     orcReaderOptions,\n-                    false);\n+                    false,\n+                    new NoopOrcAggregatedMemoryContext());\n             try (OrcBatchRecordReader orcRecordReader = orcReader.createBatchRecordReader(\n                     readTypes.build(),\n                     OrcPredicate.TRUE,\n                     hiveStorageTimeZone,\n-                    newSimpleAggregatedMemoryContext(),\n+                    new NoopOrcAggregatedMemoryContext(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzNjg1NA=="}, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMzNTUxNA==", "bodyText": "This test is in presto-orc module", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404335514", "createdAt": "2020-04-06T19:29:17Z", "author": {"login": "NikhilCollooru"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/OrcReader.java", "diffHunk": "@@ -285,12 +285,13 @@ static void validateFile(\n                     new StorageStripeMetadataSource(),\n                     Optional.of(writeValidation),\n                     orcReaderOptions,\n-                    false);\n+                    false,\n+                    new NoopOrcAggregatedMemoryContext());\n             try (OrcBatchRecordReader orcRecordReader = orcReader.createBatchRecordReader(\n                     readTypes.build(),\n                     OrcPredicate.TRUE,\n                     hiveStorageTimeZone,\n-                    newSimpleAggregatedMemoryContext(),\n+                    new NoopOrcAggregatedMemoryContext(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzNjg1NA=="}, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMzOTU5Nw==", "bodyText": "That is OK, presto-orc can depend on anything (e.g., presto-main) as long as they are in test scope. In this case, (I guess we cannot even depend on presto-hive for test scope because we will have circular dependency), we can either\n\nMove the test to presto-hive, or\n(1) copy HiveOrc..Context to presto-orc as TestingHiveOrc..Context and use that and (2) make presto-orc depending on presto-memory-context with test scope.", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404339597", "createdAt": "2020-04-06T19:36:42Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/OrcReader.java", "diffHunk": "@@ -285,12 +285,13 @@ static void validateFile(\n                     new StorageStripeMetadataSource(),\n                     Optional.of(writeValidation),\n                     orcReaderOptions,\n-                    false);\n+                    false,\n+                    new NoopOrcAggregatedMemoryContext());\n             try (OrcBatchRecordReader orcRecordReader = orcReader.createBatchRecordReader(\n                     readTypes.build(),\n                     OrcPredicate.TRUE,\n                     hiveStorageTimeZone,\n-                    newSimpleAggregatedMemoryContext(),\n+                    new NoopOrcAggregatedMemoryContext(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzNjg1NA=="}, "originalCommit": {"oid": "6fd87a84f33a0b67cee895dfe4498c75895775c1"}, "originalPosition": 114}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODg0MjU4OnYy", "diffSide": "RIGHT", "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcLocalMemoryContext.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxODo1NDoyM1rOGBlfTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxOTozMDo0OFrOGBmu5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMxNTk4MA==", "bodyText": "return a completed future; note that we almost never pass null objects in our codebase", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404315980", "createdAt": "2020-04-06T18:54:23Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+public class NoopOrcLocalMemoryContext\n+        implements OrcLocalMemoryContext\n+{\n+    @Override\n+    public ListenableFuture<?> setBytes(long bytes)\n+    {\n+        return null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ac95f81ddea2b48d46ae214bb2d99ce403e57de"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMzNjM1OA==", "bodyText": "Oh okay. will keep in mind.", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404336358", "createdAt": "2020-04-06T19:30:48Z", "author": {"login": "NikhilCollooru"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,31 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+public class NoopOrcLocalMemoryContext\n+        implements OrcLocalMemoryContext\n+{\n+    @Override\n+    public ListenableFuture<?> setBytes(long bytes)\n+    {\n+        return null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMxNTk4MA=="}, "originalCommit": {"oid": "8ac95f81ddea2b48d46ae214bb2d99ce403e57de"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzA4ODk3OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxNzozMDowMlrOGCOdRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMjo1ODo1M1rOGCZI5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk4NzIwNA==", "bodyText": "this(this.delegate = newSimpleAggregatedMemoryContext());", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r404987204", "createdAt": "2020-04-07T17:30:02Z", "author": {"login": "highker"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcAggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+import static java.util.Objects.requireNonNull;\n+\n+public class HiveOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    private final AggregatedMemoryContext delegate;\n+\n+    public HiveOrcAggregatedMemoryContext()\n+    {\n+        this.delegate = newSimpleAggregatedMemoryContext();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE2MjIxMw==", "bodyText": "i think you meant this(newSimpleAggregatedMemoryContext()). Done.", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405162213", "createdAt": "2020-04-07T22:58:53Z", "author": {"login": "NikhilCollooru"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.hive;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcAggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+import static java.util.Objects.requireNonNull;\n+\n+public class HiveOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    private final AggregatedMemoryContext delegate;\n+\n+    public HiveOrcAggregatedMemoryContext()\n+    {\n+        this.delegate = newSimpleAggregatedMemoryContext();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk4NzIwNA=="}, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQxOTMzOnYy", "diffSide": "RIGHT", "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODo1NjozOVrOGCRtcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODo1NjozOVrOGCRtcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0MDQ5Ng==", "bodyText": "return NOOP_ORC_AGGREGATED_MEMORY_CONTEXT", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405040496", "createdAt": "2020-04-07T18:56:39Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+public class NoopOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    public static final NoopOrcAggregatedMemoryContext NOOP_ORC_AGGREGATED_MEMORY_CONTEXT = new NoopOrcAggregatedMemoryContext();\n+\n+    public OrcAggregatedMemoryContext newOrcAggregatedMemoryContext()\n+    {\n+        return new NoopOrcAggregatedMemoryContext();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQyMDczOnYy", "diffSide": "RIGHT", "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcLocalMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODo1NzowMlrOGCRuUg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODo1NzowMlrOGCRuUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0MDcyMg==", "bodyText": "Make a public static const on NoopOrcLocalMemoryContext as well", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405040722", "createdAt": "2020-04-07T18:57:02Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,32 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.google.common.util.concurrent.Futures;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+public class NoopOrcLocalMemoryContext", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQyMTI4OnYy", "diffSide": "RIGHT", "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODo1NzoxMlrOGCRuqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODo1NzoxMlrOGCRuqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0MDgwOA==", "bodyText": "refer to the const.", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405040808", "createdAt": "2020-04-07T18:57:12Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+public class NoopOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    public static final NoopOrcAggregatedMemoryContext NOOP_ORC_AGGREGATED_MEMORY_CONTEXT = new NoopOrcAggregatedMemoryContext();\n+\n+    public OrcAggregatedMemoryContext newOrcAggregatedMemoryContext()\n+    {\n+        return new NoopOrcAggregatedMemoryContext();\n+    }\n+\n+    public OrcLocalMemoryContext newOrcLocalMemoryContext(String allocationTag)\n+    {\n+        return new NoopOrcLocalMemoryContext();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQyNTk3OnYy", "diffSide": "RIGHT", "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODo1ODoyN1rOGCRxpQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODo1ODoyN1rOGCRxpQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0MTU3Mw==", "bodyText": "Add @Override to all the methods in this class", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405041573", "createdAt": "2020-04-07T18:58:27Z", "author": {"login": "highker"}, "path": "presto-orc/src/main/java/com/facebook/presto/orc/NoopOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+public class NoopOrcAggregatedMemoryContext", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQzNDU0OnYy", "diffSide": "RIGHT", "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMDoyOFrOGCR20w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMDoyOFrOGCR20w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0Mjg5OQ==", "bodyText": "Use this(...)", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405042899", "createdAt": "2020-04-07T19:00:28Z", "author": {"login": "highker"}, "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+import static java.util.Objects.requireNonNull;\n+\n+public class TestingHiveOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    private final AggregatedMemoryContext delegate;\n+\n+    public TestingHiveOrcAggregatedMemoryContext()\n+    {\n+        this.delegate = newSimpleAggregatedMemoryContext();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQzNjA1OnYy", "diffSide": "RIGHT", "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMDo1NVrOGCR30g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMDo1NVrOGCR30g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0MzE1NA==", "bodyText": "Make a javadoc to explain this is copy of HiveOrc...", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405043154", "createdAt": "2020-04-07T19:00:55Z", "author": {"login": "highker"}, "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+import static java.util.Objects.requireNonNull;\n+\n+public class TestingHiveOrcAggregatedMemoryContext", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQ0MDIzOnYy", "diffSide": "RIGHT", "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcLocalMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMjoxM1rOGCR6rA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMjoxM1rOGCR6rA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0Mzg4NA==", "bodyText": "@Override", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405043884", "createdAt": "2020-04-07T19:02:13Z", "author": {"login": "highker"}, "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.facebook.presto.memory.context.LocalMemoryContext;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+public class TestingHiveOrcLocalMemoryContext\n+        implements OrcLocalMemoryContext\n+{\n+    private final LocalMemoryContext delegate;\n+\n+    TestingHiveOrcLocalMemoryContext(LocalMemoryContext delegate)\n+    {\n+        this.delegate = requireNonNull(delegate, \"delegate is null\");\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQ0MDQyOnYy", "diffSide": "RIGHT", "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcLocalMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMjoxNlrOGCR6zQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMjoxNlrOGCR6zQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0MzkxNw==", "bodyText": "@Override", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405043917", "createdAt": "2020-04-07T19:02:16Z", "author": {"login": "highker"}, "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.facebook.presto.memory.context.LocalMemoryContext;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+public class TestingHiveOrcLocalMemoryContext\n+        implements OrcLocalMemoryContext\n+{\n+    private final LocalMemoryContext delegate;\n+\n+    TestingHiveOrcLocalMemoryContext(LocalMemoryContext delegate)\n+    {\n+        this.delegate = requireNonNull(delegate, \"delegate is null\");\n+    }\n+\n+    public ListenableFuture<?> setBytes(long bytes)\n+    {\n+        return delegate.setBytes(bytes);\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQ0NTE3OnYy", "diffSide": "RIGHT", "path": "presto-raptor/src/main/java/com/facebook/presto/raptor/RaptorOrcAggregatedMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMzozNFrOGCR9xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMzozNFrOGCR9xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0NDY3OA==", "bodyText": "same", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405044678", "createdAt": "2020-04-07T19:03:34Z", "author": {"login": "highker"}, "path": "presto-raptor/src/main/java/com/facebook/presto/raptor/RaptorOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,61 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.raptor;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcAggregatedMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+import static java.util.Objects.requireNonNull;\n+\n+public class RaptorOrcAggregatedMemoryContext\n+        implements OrcAggregatedMemoryContext\n+{\n+    private final AggregatedMemoryContext delegate;\n+\n+    public RaptorOrcAggregatedMemoryContext()\n+    {\n+        this.delegate = newSimpleAggregatedMemoryContext();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzQ0NjQ1OnYy", "diffSide": "RIGHT", "path": "presto-raptor/src/main/java/com/facebook/presto/raptor/RaptorOrcLocalMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMzo1MlrOGCR-iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxOTowMzo1MlrOGCR-iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA0NDg3Mw==", "bodyText": "same", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405044873", "createdAt": "2020-04-07T19:03:52Z", "author": {"login": "highker"}, "path": "presto-raptor/src/main/java/com/facebook/presto/raptor/RaptorOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.raptor;\n+\n+import com.facebook.presto.memory.context.LocalMemoryContext;\n+import com.facebook.presto.orc.OrcLocalMemoryContext;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+public class RaptorOrcLocalMemoryContext\n+        implements OrcLocalMemoryContext\n+{\n+    private final LocalMemoryContext delegate;\n+\n+    RaptorOrcLocalMemoryContext(LocalMemoryContext delegate)\n+    {\n+        this.delegate = requireNonNull(delegate, \"delegate is null\");\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d036521b41d80c9adaf7f474055239a51c4c5ce7"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNDMwNTcxOnYy", "diffSide": "RIGHT", "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcLocalMemoryContext.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMzo1MjozOVrOGCaNrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QyMzo1MjozOVrOGCaNrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE3OTgyMw==", "bodyText": "javadoc (staring with /**) is usually place right before the class definition without a line break. e.g.\n/**\n * This class is a copy of HiveOrcLocalMemoryContext.\n * Any changes made to HiveOrcLocalMemoryContext should be made here as well\n */\npublic class TestingHiveOrcLocalMemoryContext\n...", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405179823", "createdAt": "2020-04-07T23:52:39Z", "author": {"login": "highker"}, "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcLocalMemoryContext.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.facebook.presto.memory.context.LocalMemoryContext;\n+import com.google.common.util.concurrent.ListenableFuture;\n+\n+import static java.util.Objects.requireNonNull;\n+\n+public class TestingHiveOrcLocalMemoryContext\n+        implements OrcLocalMemoryContext\n+{\n+    /*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b9e4849604ca9d50d74ef6d313723620c78f997b"}, "originalPosition": 24}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNDU3ODczOnYy", "diffSide": "RIGHT", "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcAggregatedMemoryContext.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMjoyNDowMlrOGCcwSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwMjo0MDowMFrOGCdABA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIyMTQ1MQ==", "bodyText": "Javadoc starts with /** rather than /*", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405221451", "createdAt": "2020-04-08T02:24:02Z", "author": {"login": "highker"}, "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+import static java.util.Objects.requireNonNull;\n+\n+/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "034e00ec15fdbb72c2ca103c1388c89522f1a07e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIyNTQ3Ng==", "bodyText": "Sorry missed that extra * :(", "url": "https://github.com/prestodb/presto/pull/14345#discussion_r405225476", "createdAt": "2020-04-08T02:40:00Z", "author": {"login": "NikhilCollooru"}, "path": "presto-orc/src/test/java/com/facebook/presto/orc/TestingHiveOrcAggregatedMemoryContext.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.orc;\n+\n+import com.facebook.presto.memory.context.AggregatedMemoryContext;\n+\n+import static com.facebook.presto.memory.context.AggregatedMemoryContext.newSimpleAggregatedMemoryContext;\n+import static java.util.Objects.requireNonNull;\n+\n+/*", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTIyMTQ1MQ=="}, "originalCommit": {"oid": "034e00ec15fdbb72c2ca103c1388c89522f1a07e"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2752, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}