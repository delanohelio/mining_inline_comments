{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwNjk3MTE1", "number": 14365, "title": "Disallow invoking SQL functions in SQL function body", "bodyText": "Current, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\nTherefore, we should disallow such function body meanwhile.\nDepended by https://github.com/facebookexternal/presto-facebook/pull/940\n== RELEASE NOTES ==\n\nGeneral Changes\n* Add check to disallow invoking SQL functions in SQL function body.", "createdAt": "2020-04-08T08:13:39Z", "url": "https://github.com/prestodb/presto/pull/14365", "merged": true, "mergeCommit": {"oid": "bcabbdf933076c5a82428d15a9792f10fcf337de"}, "closed": true, "closedAt": "2020-04-14T22:23:13Z", "author": {"login": "caithagoras"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVjcMjABqjMyMTMwMjI5OTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXqjjNgBqjMyMzMwMTM0MTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "365c90a4a6e1b7a9093c555ad57fc4922226a680", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/365c90a4a6e1b7a9093c555ad57fc4922226a680", "committedDate": "2020-04-08T08:07:29Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "1d36b74987527cf59aff202751e2e04505f0263d", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/1d36b74987527cf59aff202751e2e04505f0263d", "committedDate": "2020-04-08T08:15:47Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1d36b74987527cf59aff202751e2e04505f0263d", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/1d36b74987527cf59aff202751e2e04505f0263d", "committedDate": "2020-04-08T08:15:47Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "5b3277a3c1c3a55fc3b2b404a3aeb2b06715f489", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/5b3277a3c1c3a55fc3b2b404a3aeb2b06715f489", "committedDate": "2020-04-08T08:20:37Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b3277a3c1c3a55fc3b2b404a3aeb2b06715f489", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/5b3277a3c1c3a55fc3b2b404a3aeb2b06715f489", "committedDate": "2020-04-08T08:20:37Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "5b451d60cfa9e5f0401fd3906ebeba799610b6ae", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/5b451d60cfa9e5f0401fd3906ebeba799610b6ae", "committedDate": "2020-04-11T00:44:46Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b451d60cfa9e5f0401fd3906ebeba799610b6ae", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/5b451d60cfa9e5f0401fd3906ebeba799610b6ae", "committedDate": "2020-04-11T00:44:46Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "751a6b47b149619f857bbaa97ed2068c006d9113", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/751a6b47b149619f857bbaa97ed2068c006d9113", "committedDate": "2020-04-11T00:49:17Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "751a6b47b149619f857bbaa97ed2068c006d9113", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/751a6b47b149619f857bbaa97ed2068c006d9113", "committedDate": "2020-04-11T00:49:17Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "f096eebe32522a3cb9869bee2fd985c743fd697c", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/f096eebe32522a3cb9869bee2fd985c743fd697c", "committedDate": "2020-04-11T02:13:11Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f096eebe32522a3cb9869bee2fd985c743fd697c", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/f096eebe32522a3cb9869bee2fd985c743fd697c", "committedDate": "2020-04-11T02:13:11Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "37ca10b2b2c69e5ea169f72abde07d6eebf84c9b", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/37ca10b2b2c69e5ea169f72abde07d6eebf84c9b", "committedDate": "2020-04-11T02:50:23Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "37ca10b2b2c69e5ea169f72abde07d6eebf84c9b", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/37ca10b2b2c69e5ea169f72abde07d6eebf84c9b", "committedDate": "2020-04-11T02:50:23Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "770f164933f70ca2b361cf6d1645294f2dec9bc3", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/770f164933f70ca2b361cf6d1645294f2dec9bc3", "committedDate": "2020-04-11T08:17:14Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "770f164933f70ca2b361cf6d1645294f2dec9bc3", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/770f164933f70ca2b361cf6d1645294f2dec9bc3", "committedDate": "2020-04-11T08:17:14Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "d1dcea2f9650d08df1b8dd5035f132482e14f044", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/d1dcea2f9650d08df1b8dd5035f132482e14f044", "committedDate": "2020-04-12T03:47:34Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d1dcea2f9650d08df1b8dd5035f132482e14f044", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/d1dcea2f9650d08df1b8dd5035f132482e14f044", "committedDate": "2020-04-12T03:47:34Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "dbbd557e435f88388db43e5b278c7711fa985868", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/dbbd557e435f88388db43e5b278c7711fa985868", "committedDate": "2020-04-12T03:50:21Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dbbd557e435f88388db43e5b278c7711fa985868", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/dbbd557e435f88388db43e5b278c7711fa985868", "committedDate": "2020-04-12T03:50:21Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "ea07d5429a3731e0b594f0f463222dbfc04a4b76", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/ea07d5429a3731e0b594f0f463222dbfc04a4b76", "committedDate": "2020-04-12T07:26:54Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ea07d5429a3731e0b594f0f463222dbfc04a4b76", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/ea07d5429a3731e0b594f0f463222dbfc04a4b76", "committedDate": "2020-04-12T07:26:54Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "ae9f961a011ea31026f73a976a2352c2ced6b964", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/ae9f961a011ea31026f73a976a2352c2ced6b964", "committedDate": "2020-04-12T08:10:53Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ae9f961a011ea31026f73a976a2352c2ced6b964", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/ae9f961a011ea31026f73a976a2352c2ced6b964", "committedDate": "2020-04-12T08:10:53Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "486e8a1911dfb3d8a819ae80fd4666b479cb27de", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/486e8a1911dfb3d8a819ae80fd4666b479cb27de", "committedDate": "2020-04-12T09:15:36Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "486e8a1911dfb3d8a819ae80fd4666b479cb27de", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/486e8a1911dfb3d8a819ae80fd4666b479cb27de", "committedDate": "2020-04-12T09:15:36Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "967b53a1ed7cf760f2f2f87fadca5fbca8be94ef", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/967b53a1ed7cf760f2f2f87fadca5fbca8be94ef", "committedDate": "2020-04-12T09:17:05Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "967b53a1ed7cf760f2f2f87fadca5fbca8be94ef", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/967b53a1ed7cf760f2f2f87fadca5fbca8be94ef", "committedDate": "2020-04-12T09:17:05Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "2cd49b3a6282b185ad7526e032916ebe00f54449", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/2cd49b3a6282b185ad7526e032916ebe00f54449", "committedDate": "2020-04-12T09:23:01Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2cd49b3a6282b185ad7526e032916ebe00f54449", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/2cd49b3a6282b185ad7526e032916ebe00f54449", "committedDate": "2020-04-12T09:23:01Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "aaa1872b1d0c0a121cf95888c5be2a09e0e17991", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/aaa1872b1d0c0a121cf95888c5be2a09e0e17991", "committedDate": "2020-04-12T12:26:13Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "295bf088d74e89ffb5bce2a50ef544d64faffb40", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/295bf088d74e89ffb5bce2a50ef544d64faffb40", "committedDate": "2020-04-12T12:28:27Z", "message": "Update h2 to 1.4.199"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aaa1872b1d0c0a121cf95888c5be2a09e0e17991", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/aaa1872b1d0c0a121cf95888c5be2a09e0e17991", "committedDate": "2020-04-12T12:26:13Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "271dc86c51397a07ae10f231a33461038ff690bd", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/271dc86c51397a07ae10f231a33461038ff690bd", "committedDate": "2020-04-12T12:28:43Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyNTIwNjQ1", "url": "https://github.com/prestodb/presto/pull/14365#pullrequestreview-392520645", "createdAt": "2020-04-14T00:12:48Z", "commit": {"oid": "295bf088d74e89ffb5bce2a50ef544d64faffb40"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwMDoxMjo0OFrOGE5lMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwMDoxNzowMlrOGE5qTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc5MDg5Nw==", "bodyText": "What is this change about?", "url": "https://github.com/prestodb/presto/pull/14365#discussion_r407790897", "createdAt": "2020-04-14T00:12:48Z", "author": {"login": "rongrong"}, "path": "presto-tests/src/main/java/com/facebook/presto/tests/AbstractTestQueries.java", "diffHunk": "@@ -7043,9 +7043,9 @@ public void testArrayShuffle()\n     @Test\n     public void testNonReservedTimeWords()\n     {\n-        assertQuery(\"\" +\n-                \"SELECT TIME, TIMESTAMP, DATE, INTERVAL\\n\" +\n-                \"FROM (SELECT 1 TIME, 2 TIMESTAMP, 3 DATE, 4 INTERVAL)\");\n+        assertQuery(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "295bf088d74e89ffb5bce2a50ef544d64faffb40"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc5MTI0Mg==", "bodyText": "What is this change about? I don't think tuple and array has the same semantic meaning.", "url": "https://github.com/prestodb/presto/pull/14365#discussion_r407791242", "createdAt": "2020-04-14T00:13:53Z", "author": {"login": "rongrong"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHivePushdownFilterQueries.java", "diffHunk": "@@ -76,7 +76,7 @@\n             \"   CASE WHEN orderkey % 43 = 0 THEN null ELSE (CAST(discount AS DECIMAL(20, 8)), CAST(tax AS DECIMAL(20, 8))) END AS long_decimals, \" +\n             \"   CASE WHEN orderkey % 11 = 0 THEN null ELSE (orderkey, partkey, suppkey) END AS keys, \\n\" +\n             \"   CASE WHEN orderkey % 41 = 0 THEN null ELSE (extendedprice, discount, tax) END AS doubles, \\n\" +\n-            \"   CASE WHEN orderkey % 13 = 0 THEN null ELSE ((orderkey, partkey), (suppkey,), CASE WHEN orderkey % 17 = 0 THEN null ELSE (orderkey, partkey) END) END AS nested_keys, \\n\" +\n+            \"   CASE WHEN orderkey % 13 = 0 THEN null ELSE ARRAY[ARRAY[orderkey, partkey], ARRAY[suppkey], CASE WHEN orderkey % 17 = 0 THEN null ELSE ARRAY[orderkey, partkey] END] END AS nested_keys, \\n\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "295bf088d74e89ffb5bce2a50ef544d64faffb40"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzc5MjIwNw==", "bodyText": "Why it's not possible to \"create a function namespace from the query engine\"? What does this mean?", "url": "https://github.com/prestodb/presto/pull/14365#discussion_r407792207", "createdAt": "2020-04-14T00:17:02Z", "author": {"login": "rongrong"}, "path": "presto-tests/src/main/java/com/facebook/presto/tests/DistributedQueryRunner.java", "diffHunk": "@@ -335,13 +342,44 @@ public void createCatalog(String catalogName, String connectorName, Map<String,\n         log.info(\"Announced catalog %s (%s) in %s\", catalogName, connectorId, nanosSince(start));\n     }\n \n+    @Override\n     public void loadFunctionNamespaceManager(String functionNamespaceManagerName, String catalogName, Map<String, String> properties)\n     {\n         for (TestingPrestoServer server : servers) {\n             server.getMetadata().getFunctionManager().loadFunctionNamespaceManager(functionNamespaceManagerName, catalogName, properties);\n         }\n     }\n \n+    /**\n+     * This method exists only because it is currently impossible to create a function namespace from the query engine,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "891d20194902a7172a92175a80fc922590fbfed4"}, "originalPosition": 113}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "271dc86c51397a07ae10f231a33461038ff690bd", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/271dc86c51397a07ae10f231a33461038ff690bd", "committedDate": "2020-04-12T12:28:43Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "ce1aceefb956465d405a5484769fe8a81641e10c", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/ce1aceefb956465d405a5484769fe8a81641e10c", "committedDate": "2020-04-14T08:31:18Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ce1aceefb956465d405a5484769fe8a81641e10c", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/ce1aceefb956465d405a5484769fe8a81641e10c", "committedDate": "2020-04-14T08:31:18Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "27f67a1239c0861c59e7357f7d9f409e1433cc8f", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/27f67a1239c0861c59e7357f7d9f409e1433cc8f", "committedDate": "2020-04-14T08:36:39Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "27f67a1239c0861c59e7357f7d9f409e1433cc8f", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/27f67a1239c0861c59e7357f7d9f409e1433cc8f", "committedDate": "2020-04-14T08:36:39Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "d682a3ac896ceb183dea07b04d2cbee0dd37fc05", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/d682a3ac896ceb183dea07b04d2cbee0dd37fc05", "committedDate": "2020-04-14T09:19:35Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d682a3ac896ceb183dea07b04d2cbee0dd37fc05", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/d682a3ac896ceb183dea07b04d2cbee0dd37fc05", "committedDate": "2020-04-14T09:19:35Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "8a1c59415e43e3c1ee9f9befbcdf1f69af44b3be", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/8a1c59415e43e3c1ee9f9befbcdf1f69af44b3be", "committedDate": "2020-04-14T09:43:13Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f1beac687a5b4b9c8384b44e1a8015ceeae6099", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/2f1beac687a5b4b9c8384b44e1a8015ceeae6099", "committedDate": "2020-04-14T10:08:34Z", "message": "Support function namespace in integration tests\n\nAlso, remove unused line in MySqlFunctionNamespaceManagerModule."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8a1c59415e43e3c1ee9f9befbcdf1f69af44b3be", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/8a1c59415e43e3c1ee9f9befbcdf1f69af44b3be", "committedDate": "2020-04-14T09:43:13Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "a8a555540aec4df7ba95d2ec734755feed075da6", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/a8a555540aec4df7ba95d2ec734755feed075da6", "committedDate": "2020-04-14T10:08:36Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMTI2MzM0", "url": "https://github.com/prestodb/presto/pull/14365#pullrequestreview-393126334", "createdAt": "2020-04-14T17:05:22Z", "commit": {"oid": "a8a555540aec4df7ba95d2ec734755feed075da6"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMjM5NTc0", "url": "https://github.com/prestodb/presto/pull/14365#pullrequestreview-393239574", "createdAt": "2020-04-14T19:42:23Z", "commit": {"oid": "a8a555540aec4df7ba95d2ec734755feed075da6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxOTo0MjoyM1rOGFeHqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxOTo0MjoyM1rOGFeHqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM4OTU0Ng==", "bodyText": "Just say \"not supported\". The \"yet\" makes it sound like something coming in the near future. \ud83d\ude02", "url": "https://github.com/prestodb/presto/pull/14365#discussion_r408389546", "createdAt": "2020-04-14T19:42:23Z", "author": {"login": "rongrong"}, "path": "presto-main/src/main/java/com/facebook/presto/execution/CreateFunctionTask.java", "diffHunk": "@@ -66,7 +70,12 @@ public String explain(CreateFunction statement, List<Expression> parameters)\n     public ListenableFuture<?> execute(CreateFunction statement, TransactionManager transactionManager, Metadata metadata, AccessControl accessControl, QueryStateMachine stateMachine, List<Expression> parameters)\n     {\n         Analyzer analyzer = new Analyzer(stateMachine.getSession(), metadata, sqlParser, accessControl, Optional.empty(), parameters, stateMachine.getWarningCollector());\n-        analyzer.analyze(statement);\n+        Analysis analysis = analyzer.analyze(statement);\n+        if (analysis.getFunctionHandles().values().stream()\n+                .anyMatch(SqlFunctionHandle.class::isInstance)) {\n+            throw new PrestoException(NOT_SUPPORTED, \"Invoking a SQL function in SQL function body is not yet supported\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a8a555540aec4df7ba95d2ec734755feed075da6"}, "originalPosition": 31}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMjQxNjE0", "url": "https://github.com/prestodb/presto/pull/14365#pullrequestreview-393241614", "createdAt": "2020-04-14T19:45:28Z", "commit": {"oid": "a8a555540aec4df7ba95d2ec734755feed075da6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30fbc58fec26bac1dbaa558f9fd04c9123b4806f", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/30fbc58fec26bac1dbaa558f9fd04c9123b4806f", "committedDate": "2020-04-14T21:41:01Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a8a555540aec4df7ba95d2ec734755feed075da6", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/a8a555540aec4df7ba95d2ec734755feed075da6", "committedDate": "2020-04-14T10:08:36Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}, "afterCommit": {"oid": "30fbc58fec26bac1dbaa558f9fd04c9123b4806f", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/30fbc58fec26bac1dbaa558f9fd04c9123b4806f", "committedDate": "2020-04-14T21:41:01Z", "message": "Disallow invoking SQL functions in SQL function body\n\nCurrent, executing a SQL function that calls another SQL function\nthrows internal error with \"compiler failed\" error message.\n\nIf the fix the compiling issue, we'll then have to properly handle\npossible recursion.\n\nTherefore, we should disallow such function body meanwhile."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1814, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}