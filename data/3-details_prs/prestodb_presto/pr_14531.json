{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4MjE4Njgy", "number": 14531, "title": "Fix DruidRequestBody JSON serialization error and add unit test case", "bodyText": "The static inner class DruidRequestBody has to be public, otherwise we will get a json serialization exception when sending the request to druid.\n== NO RELEASE NOTE ==", "createdAt": "2020-05-14T20:04:19Z", "url": "https://github.com/prestodb/presto/pull/14531", "merged": true, "mergeCommit": {"oid": "e2a5010472caec495a893185f7ab6fdf653068c2"}, "closed": true, "closedAt": "2020-05-15T03:54:02Z", "author": {"login": "beinan"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABchTrqMAFqTQxMjE2ODIzNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABchYA4YABqjMzMzkwMjEwNTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyMTY4MjM3", "url": "https://github.com/prestodb/presto/pull/14531#pullrequestreview-412168237", "createdAt": "2020-05-14T20:41:23Z", "commit": {"oid": "da0a55430c445788c7ea7d0af11efe1353d2f873"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMDo0MToyNFrOGVtbZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMDo0MToyNFrOGVtbZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNzU3Mw==", "bodyText": "could we have better naming than:\ncolumn.1 and table-1\nmaybe column.field, table-name?", "url": "https://github.com/prestodb/presto/pull/14531#discussion_r425417573", "createdAt": "2020-05-14T20:41:24Z", "author": {"login": "zhenxiao"}, "path": "presto-druid/src/test/java/com/facebook/presto/druid/TestDruidClient.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.druid;\n+\n+import org.testng.annotations.Test;\n+\n+import static org.testng.Assert.assertEquals;\n+\n+public class TestDruidClient\n+{\n+    @Test\n+    public void testDruidRequestBodyToJson()\n+    {\n+        DruidClient.DruidRequestBody requestBody = new DruidClient.DruidRequestBody(\n+                \"select \\\"column.1\\\" from \\\"table-1\\\"\", \"arrayLines\", false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da0a55430c445788c7ea7d0af11efe1353d2f873"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyMTY4Nzg1", "url": "https://github.com/prestodb/presto/pull/14531#pullrequestreview-412168785", "createdAt": "2020-05-14T20:42:17Z", "commit": {"oid": "da0a55430c445788c7ea7d0af11efe1353d2f873"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMDo0MjoxN1rOGVtc9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQyMDo0Mjo1M1rOGVteNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNzk3NQ==", "bodyText": "format: each parameter in a separate line", "url": "https://github.com/prestodb/presto/pull/14531#discussion_r425417975", "createdAt": "2020-05-14T20:42:17Z", "author": {"login": "zhenxiao"}, "path": "presto-druid/src/test/java/com/facebook/presto/druid/TestDruidClient.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.druid;\n+\n+import org.testng.annotations.Test;\n+\n+import static org.testng.Assert.assertEquals;\n+\n+public class TestDruidClient\n+{\n+    @Test\n+    public void testDruidRequestBodyToJson()\n+    {\n+        DruidClient.DruidRequestBody requestBody = new DruidClient.DruidRequestBody(\n+                \"select \\\"column.1\\\" from \\\"table-1\\\"\", \"arrayLines\", false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNzU3Mw=="}, "originalCommit": {"oid": "da0a55430c445788c7ea7d0af11efe1353d2f873"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxODI5NQ==", "bodyText": "format: requestBody.toJson() in a separate line", "url": "https://github.com/prestodb/presto/pull/14531#discussion_r425418295", "createdAt": "2020-05-14T20:42:53Z", "author": {"login": "zhenxiao"}, "path": "presto-druid/src/test/java/com/facebook/presto/druid/TestDruidClient.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.druid;\n+\n+import org.testng.annotations.Test;\n+\n+import static org.testng.Assert.assertEquals;\n+\n+public class TestDruidClient\n+{\n+    @Test\n+    public void testDruidRequestBodyToJson()\n+    {\n+        DruidClient.DruidRequestBody requestBody = new DruidClient.DruidRequestBody(\n+                \"select \\\"column.1\\\" from \\\"table-1\\\"\", \"arrayLines\", false);\n+        assertEquals(\"{\\n\" +\n+                \"  \\\"query\\\" : \\\"select \\\\\\\"column.1\\\\\\\" from \\\\\\\"table-1\\\\\\\"\\\",\\n\" +\n+                \"  \\\"resultFormat\\\" : \\\"arrayLines\\\",\\n\" +\n+                \"  \\\"queryHeader\\\" : false\\n\" +\n+                \"}\", requestBody.toJson());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da0a55430c445788c7ea7d0af11efe1353d2f873"}, "originalPosition": 31}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "da0a55430c445788c7ea7d0af11efe1353d2f873", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/da0a55430c445788c7ea7d0af11efe1353d2f873", "committedDate": "2020-05-14T20:02:13Z", "message": "Fix DruidRequestBody JSON serialization error and add unit test case"}, "afterCommit": {"oid": "57f06af7005bc1945aef75be67f62c758a03f33c", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/57f06af7005bc1945aef75be67f62c758a03f33c", "committedDate": "2020-05-14T22:45:09Z", "message": "Fix DruidRequestBody JSON serialization error and add unit test case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyMjQxMjEz", "url": "https://github.com/prestodb/presto/pull/14531#pullrequestreview-412241213", "createdAt": "2020-05-14T22:58:51Z", "commit": {"oid": "57f06af7005bc1945aef75be67f62c758a03f33c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f688a9f35dad9f62a80db80a2a95c8c71f1d1d5", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/2f688a9f35dad9f62a80db80a2a95c8c71f1d1d5", "committedDate": "2020-05-15T01:43:37Z", "message": "Fix DruidRequestBody JSON serialization error and add unit test cases"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "57f06af7005bc1945aef75be67f62c758a03f33c", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/57f06af7005bc1945aef75be67f62c758a03f33c", "committedDate": "2020-05-14T22:45:09Z", "message": "Fix DruidRequestBody JSON serialization error and add unit test case"}, "afterCommit": {"oid": "2f688a9f35dad9f62a80db80a2a95c8c71f1d1d5", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/2f688a9f35dad9f62a80db80a2a95c8c71f1d1d5", "committedDate": "2020-05-15T01:43:37Z", "message": "Fix DruidRequestBody JSON serialization error and add unit test cases"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1646, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}