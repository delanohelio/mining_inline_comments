{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM0MzA2MzM3", "number": 14650, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0OTo1MVrOEFmEYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNDo0ODoxNlrOEGMR3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0MzAyMDUwOnYy", "diffSide": "RIGHT", "path": "presto-proxy/src/test/java/com/facebook/presto/proxy/TestProxyServer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNTo0OTo1MVrOGj4OfQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNVQxNjoxMjo0OVrOGj5JlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3NDU1Nw==", "bodyText": "Can you explain how this test verifies the header changes?", "url": "https://github.com/prestodb/presto/pull/14650#discussion_r440274557", "createdAt": "2020-06-15T15:49:51Z", "author": {"login": "swapsmagic"}, "path": "presto-proxy/src/test/java/com/facebook/presto/proxy/TestProxyServer.java", "diffHunk": "@@ -142,6 +142,26 @@ public void testQuery()\n         }\n     }\n \n+    @Test\n+    public void testSetSession()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI4OTY4NA==", "bodyText": "Headers are returned from the coordinator via the X-Presto-Set-Session header.  These headers are erroneously being serialized to String as Collection<String>, which caused them to be sent back from the coordinator as [query_max_stage_count=10] (singleton collection).  This test proves that the issue is fixed because we do not fail the query due to invalid session property name.", "url": "https://github.com/prestodb/presto/pull/14650#discussion_r440289684", "createdAt": "2020-06-15T16:12:49Z", "author": {"login": "tdcmeehan"}, "path": "presto-proxy/src/test/java/com/facebook/presto/proxy/TestProxyServer.java", "diffHunk": "@@ -142,6 +142,26 @@ public void testQuery()\n         }\n     }\n \n+    @Test\n+    public void testSetSession()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI3NDU1Nw=="}, "originalCommit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTI4MDk0OnYy", "diffSide": "RIGHT", "path": "presto-proxy/src/main/java/com/facebook/presto/proxy/ProxyResource.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwNDo0ODoxNlrOGk1e3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNjo1NjowOVrOGlOqtw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI3ODE3NQ==", "bodyText": "Would  response.getHeaders().forEach((headerName, value) work? Just remove asMap().", "url": "https://github.com/prestodb/presto/pull/14650#discussion_r441278175", "createdAt": "2020-06-17T04:48:16Z", "author": {"login": "cemcayiroglu"}, "path": "presto-proxy/src/main/java/com/facebook/presto/proxy/ProxyResource.java", "diffHunk": "@@ -296,10 +296,10 @@ private static boolean isPrestoHeader(String name)\n \n     private static Response responseWithHeaders(ResponseBuilder builder, ProxyResponse response)\n     {\n-        response.getHeaders().asMap().forEach((headerName, value) -> {\n+        response.getHeaders().asMap().forEach((headerName, values) -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY5MDgwNw==", "bodyText": "That works.", "url": "https://github.com/prestodb/presto/pull/14650#discussion_r441690807", "createdAt": "2020-06-17T16:56:09Z", "author": {"login": "tdcmeehan"}, "path": "presto-proxy/src/main/java/com/facebook/presto/proxy/ProxyResource.java", "diffHunk": "@@ -296,10 +296,10 @@ private static boolean isPrestoHeader(String name)\n \n     private static Response responseWithHeaders(ResponseBuilder builder, ProxyResponse response)\n     {\n-        response.getHeaders().asMap().forEach((headerName, value) -> {\n+        response.getHeaders().asMap().forEach((headerName, values) -> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTI3ODE3NQ=="}, "originalCommit": {"oid": "1461913ec01992044ec56250b982bf86476dbfb3"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2451, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}