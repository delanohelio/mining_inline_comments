{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4OTM1NTQ5", "number": 14713, "title": "Add session property to set bucket function type", "bodyText": "== RELEASE NOTES ==\n\nHive Changes\n*  Add support for exchange materialization of table bucketed by non-hive types. This can be enabled using value ``PRESTO_NATIVE`` for the ``bucket_function_type_for_exchange`` session property  or the ``hive.bucket-function-type-for-exchange `` configuration property.", "createdAt": "2020-06-24T03:20:55Z", "url": "https://github.com/prestodb/presto/pull/14713", "merged": true, "mergeCommit": {"oid": "cb69e899efbabf35a09003852194800309f53dad"}, "closed": true, "closedAt": "2020-06-24T20:55:17Z", "author": {"login": "viczhang861"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuebmlAFqTQzNjkwNTA5Mw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcufAviABqjM0Nzg5NDI1NzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2OTA1MDkz", "url": "https://github.com/prestodb/presto/pull/14713#pullrequestreview-436905093", "createdAt": "2020-06-24T18:32:50Z", "commit": {"oid": "18c5df5bcaf65b7c904f9ca318070cb3cc11d225"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxODozMjo1MFrOGoeP6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxODozMzozNVrOGoeRfg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA5MTgxOA==", "bodyText": "bucketFunctionType", "url": "https://github.com/prestodb/presto/pull/14713#discussion_r445091818", "createdAt": "2020-06-24T18:32:50Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveMetadata.java", "diffHunk": "@@ -2285,7 +2287,22 @@ public ConnectorTableLayoutHandle getAlternativeLayoutHandle(ConnectorSession se\n     @Override\n     public ConnectorPartitioningHandle getPartitioningHandleForExchange(ConnectorSession session, int partitionCount, List<Type> partitionTypes)\n     {\n-        return createPrestoNativePartitioningHandle(partitionCount, partitionTypes, OptionalInt.empty());\n+        BucketFunctionType bucketFunctionType = getBucketFunctionTypeForExchange(session);\n+        switch (getBucketFunctionTypeForExchange(session)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18c5df5bcaf65b7c904f9ca318070cb3cc11d225"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA5MjA1OQ==", "bodyText": "nit: Hash function type for exchange", "url": "https://github.com/prestodb/presto/pull/14713#discussion_r445092059", "createdAt": "2020-06-24T18:33:20Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveClientConfig.java", "diffHunk": "@@ -1082,6 +1085,19 @@ public HiveClientConfig setSortedWritingEnabled(boolean sortedWritingEnabled)\n         return this;\n     }\n \n+    @Config(\"hive.bucket-function-type-for-exchange\")\n+    @ConfigDescription(\"Experimental: hash function type for bucketed table exchange\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18c5df5bcaf65b7c904f9ca318070cb3cc11d225"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTA5MjIyMg==", "bodyText": "nit: unnecessary change", "url": "https://github.com/prestodb/presto/pull/14713#discussion_r445092222", "createdAt": "2020-06-24T18:33:35Z", "author": {"login": "arhimondr"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveClientConfig.java", "diffHunk": "@@ -129,7 +130,9 @@\n     private boolean skipTargetCleanupOnRollback;\n \n     private boolean bucketExecutionEnabled = true;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18c5df5bcaf65b7c904f9ca318070cb3cc11d225"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39b61eab58528fc8d0dfb46e04613e90002b01f8", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/39b61eab58528fc8d0dfb46e04613e90002b01f8", "committedDate": "2020-06-24T19:09:45Z", "message": "Add session property to set bucket function type\n\nTo control hash function type for exchange."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "18c5df5bcaf65b7c904f9ca318070cb3cc11d225", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/18c5df5bcaf65b7c904f9ca318070cb3cc11d225", "committedDate": "2020-06-24T03:16:51Z", "message": "Add session property to set bucket function type\n\nTo control hash function type for exchange."}, "afterCommit": {"oid": "39b61eab58528fc8d0dfb46e04613e90002b01f8", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/39b61eab58528fc8d0dfb46e04613e90002b01f8", "committedDate": "2020-06-24T19:09:45Z", "message": "Add session property to set bucket function type\n\nTo control hash function type for exchange."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1473, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}