{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4NTE3MTQz", "number": 14142, "title": "Fail task with large update size", "bodyText": "Fail the query when the task update size\nexceeds the limit set by the parameter\nexperimental.internal-communication.max-task-update-size.\nThis fixes issue #14129\n== NO RELEASE NOTE ==", "createdAt": "2020-02-21T23:41:08Z", "url": "https://github.com/prestodb/presto/pull/14142", "merged": true, "mergeCommit": {"oid": "697eaea344c736efc9ced695635c5f2b598554e9"}, "closed": true, "closedAt": "2020-02-23T00:21:03Z", "author": {"login": "NikhilCollooru"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcGqTncAFqTM2MzAwMDA3MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcG5sHQAFqTM2MzA0NzA0NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDAwMDcw", "url": "https://github.com/prestodb/presto/pull/14142#pullrequestreview-363000070", "createdAt": "2020-02-22T01:46:57Z", "commit": {"oid": "e7ab662e9dd05bf97f29cac0296f727dfd5f4e54"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQwMTo0Njo1N1rOFtI0kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQwMTo0Njo1N1rOFtI0kg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg3NDc3MA==", "bodyText": "The test does not pass locally. Can we make something more reliable?", "url": "https://github.com/prestodb/presto/pull/14142#discussion_r382874770", "createdAt": "2020-02-22T01:46:57Z", "author": {"login": "highker"}, "path": "presto-tests/src/test/java/com/facebook/presto/tests/TestTpchTaskUpdateSizeLimitIntegrationTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.tests;\n+\n+import com.facebook.presto.Session;\n+import com.google.common.collect.ImmutableMap;\n+import org.testng.annotations.Test;\n+\n+import static com.facebook.presto.tests.tpch.TpchQueryRunner.createQueryRunner;\n+\n+public class TestTpchTaskUpdateSizeLimitIntegrationTest\n+        extends AbstractTestQueryFramework\n+{\n+    @SuppressWarnings(\"unused\")\n+    public TestTpchTaskUpdateSizeLimitIntegrationTest()\n+    {\n+        this(() -> createQueryRunner(ImmutableMap.of(\"experimental.internal-communication.max-task-update-size\", \"10kB\")));\n+    }\n+\n+    protected TestTpchTaskUpdateSizeLimitIntegrationTest(QueryRunnerSupplier queryRunnerSupplier)\n+    {\n+        super(queryRunnerSupplier);\n+    }\n+\n+    @Test\n+    public void testTaskUpdateSizeLimit()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7ab662e9dd05bf97f29cac0296f727dfd5f4e54"}, "originalPosition": 37}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e7ab662e9dd05bf97f29cac0296f727dfd5f4e54", "author": {"user": {"login": "NikhilCollooru", "name": "Nikhil Collooru"}}, "url": "https://github.com/prestodb/presto/commit/e7ab662e9dd05bf97f29cac0296f727dfd5f4e54", "committedDate": "2020-02-21T23:34:45Z", "message": "Fail task with large update size\n\nFail the query when the task update size\nexceeds the limit set by the parameter\nexperimental.internal-communication.max-task-update-size."}, "afterCommit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef", "author": {"user": {"login": "NikhilCollooru", "name": "Nikhil Collooru"}}, "url": "https://github.com/prestodb/presto/commit/e6e393e025f588a31dfcc108618893e825a0ddef", "committedDate": "2020-02-22T03:14:38Z", "message": "Fail task with large update size\n\nFail the query when the task update size\nexceeds the limit set by the parameter\nexperimental.internal-communication.max-task-update-size."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDQ0MDU0", "url": "https://github.com/prestodb/presto/pull/14142#pullrequestreview-363044054", "createdAt": "2020-02-22T18:40:44Z", "commit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDQ1NjAz", "url": "https://github.com/prestodb/presto/pull/14142#pullrequestreview-363045603", "createdAt": "2020-02-22T19:13:01Z", "commit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef"}, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxOToxMzowMVrOFtMdhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxOToxOToyNlrOFtMfDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDQwNw==", "bodyText": "remove", "url": "https://github.com/prestodb/presto/pull/14142#discussion_r382934407", "createdAt": "2020-02-22T19:13:01Z", "author": {"login": "highker"}, "path": "presto-tests/src/test/java/com/facebook/presto/tests/TestTpchTaskUpdateSizeLimitIntegrationTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.tests;\n+\n+import com.facebook.presto.Session;\n+import com.google.common.collect.ImmutableMap;\n+import org.testng.annotations.Test;\n+\n+import static com.facebook.presto.tests.tpch.TpchQueryRunner.createQueryRunner;\n+\n+public class TestTpchTaskUpdateSizeLimitIntegrationTest\n+        extends AbstractTestQueryFramework\n+{\n+    @SuppressWarnings(\"unused\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDQxOA==", "bodyText": "remove", "url": "https://github.com/prestodb/presto/pull/14142#discussion_r382934418", "createdAt": "2020-02-22T19:13:07Z", "author": {"login": "highker"}, "path": "presto-tests/src/test/java/com/facebook/presto/tests/TestTpchTaskUpdateSizeLimitIntegrationTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.tests;\n+\n+import com.facebook.presto.Session;\n+import com.google.common.collect.ImmutableMap;\n+import org.testng.annotations.Test;\n+\n+import static com.facebook.presto.tests.tpch.TpchQueryRunner.createQueryRunner;\n+\n+public class TestTpchTaskUpdateSizeLimitIntegrationTest\n+        extends AbstractTestQueryFramework\n+{\n+    @SuppressWarnings(\"unused\")\n+    public TestTpchTaskUpdateSizeLimitIntegrationTest()\n+    {\n+        this(() -> createQueryRunner(ImmutableMap.of(\"experimental.internal-communication.max-task-update-size\", \"100B\")));\n+    }\n+\n+    protected TestTpchTaskUpdateSizeLimitIntegrationTest(QueryRunnerSupplier queryRunnerSupplier)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDQyNw==", "bodyText": "super(() -> createQueryRunner(ImmutableMap.of(\"experimental.internal-communication.max-task-update-size\", \"100B\")));", "url": "https://github.com/prestodb/presto/pull/14142#discussion_r382934427", "createdAt": "2020-02-22T19:13:17Z", "author": {"login": "highker"}, "path": "presto-tests/src/test/java/com/facebook/presto/tests/TestTpchTaskUpdateSizeLimitIntegrationTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.tests;\n+\n+import com.facebook.presto.Session;\n+import com.google.common.collect.ImmutableMap;\n+import org.testng.annotations.Test;\n+\n+import static com.facebook.presto.tests.tpch.TpchQueryRunner.createQueryRunner;\n+\n+public class TestTpchTaskUpdateSizeLimitIntegrationTest\n+        extends AbstractTestQueryFramework\n+{\n+    @SuppressWarnings(\"unused\")\n+    public TestTpchTaskUpdateSizeLimitIntegrationTest()\n+    {\n+        this(() -> createQueryRunner(ImmutableMap.of(\"experimental.internal-communication.max-task-update-size\", \"100B\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDcxOQ==", "bodyText": "one param per line; leave the first line empty", "url": "https://github.com/prestodb/presto/pull/14142#discussion_r382934719", "createdAt": "2020-02-22T19:18:03Z", "author": {"login": "highker"}, "path": "presto-tests/src/test/java/com/facebook/presto/tests/TestTpchTaskUpdateSizeLimitIntegrationTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.tests;\n+\n+import com.facebook.presto.Session;\n+import com.google.common.collect.ImmutableMap;\n+import org.testng.annotations.Test;\n+\n+import static com.facebook.presto.tests.tpch.TpchQueryRunner.createQueryRunner;\n+\n+public class TestTpchTaskUpdateSizeLimitIntegrationTest\n+        extends AbstractTestQueryFramework\n+{\n+    @SuppressWarnings(\"unused\")\n+    public TestTpchTaskUpdateSizeLimitIntegrationTest()\n+    {\n+        this(() -> createQueryRunner(ImmutableMap.of(\"experimental.internal-communication.max-task-update-size\", \"100B\")));\n+    }\n+\n+    protected TestTpchTaskUpdateSizeLimitIntegrationTest(QueryRunnerSupplier queryRunnerSupplier)\n+    {\n+        super(queryRunnerSupplier);\n+    }\n+\n+    @Test\n+    public void testTaskUpdateSizeLimit()\n+    {\n+        Session session = Session.builder(getSession()).build();\n+        assertQueryFails(session, \"SELECT * \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDc5Mg==", "bodyText": "Not need to have such complicated example. Just use SELECT * FROM ORDERS LIMIT 10", "url": "https://github.com/prestodb/presto/pull/14142#discussion_r382934792", "createdAt": "2020-02-22T19:19:14Z", "author": {"login": "highker"}, "path": "presto-tests/src/test/java/com/facebook/presto/tests/TestTpchTaskUpdateSizeLimitIntegrationTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.tests;\n+\n+import com.facebook.presto.Session;\n+import com.google.common.collect.ImmutableMap;\n+import org.testng.annotations.Test;\n+\n+import static com.facebook.presto.tests.tpch.TpchQueryRunner.createQueryRunner;\n+\n+public class TestTpchTaskUpdateSizeLimitIntegrationTest\n+        extends AbstractTestQueryFramework\n+{\n+    @SuppressWarnings(\"unused\")\n+    public TestTpchTaskUpdateSizeLimitIntegrationTest()\n+    {\n+        this(() -> createQueryRunner(ImmutableMap.of(\"experimental.internal-communication.max-task-update-size\", \"100B\")));\n+    }\n+\n+    protected TestTpchTaskUpdateSizeLimitIntegrationTest(QueryRunnerSupplier queryRunnerSupplier)\n+    {\n+        super(queryRunnerSupplier);\n+    }\n+\n+    @Test\n+    public void testTaskUpdateSizeLimit()\n+    {\n+        Session session = Session.builder(getSession()).build();\n+        assertQueryFails(session, \"SELECT * \" +\n+                        \"FROM ORDERS \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDc5OA==", "bodyText": "not useful, just use getSession() in place.", "url": "https://github.com/prestodb/presto/pull/14142#discussion_r382934798", "createdAt": "2020-02-22T19:19:26Z", "author": {"login": "highker"}, "path": "presto-tests/src/test/java/com/facebook/presto/tests/TestTpchTaskUpdateSizeLimitIntegrationTest.java", "diffHunk": "@@ -0,0 +1,55 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.tests;\n+\n+import com.facebook.presto.Session;\n+import com.google.common.collect.ImmutableMap;\n+import org.testng.annotations.Test;\n+\n+import static com.facebook.presto.tests.tpch.TpchQueryRunner.createQueryRunner;\n+\n+public class TestTpchTaskUpdateSizeLimitIntegrationTest\n+        extends AbstractTestQueryFramework\n+{\n+    @SuppressWarnings(\"unused\")\n+    public TestTpchTaskUpdateSizeLimitIntegrationTest()\n+    {\n+        this(() -> createQueryRunner(ImmutableMap.of(\"experimental.internal-communication.max-task-update-size\", \"100B\")));\n+    }\n+\n+    protected TestTpchTaskUpdateSizeLimitIntegrationTest(QueryRunnerSupplier queryRunnerSupplier)\n+    {\n+        super(queryRunnerSupplier);\n+    }\n+\n+    @Test\n+    public void testTaskUpdateSizeLimit()\n+    {\n+        Session session = Session.builder(getSession()).build();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f340a0d210a7eb63457598f5b61b6eba102a6083", "author": {"user": {"login": "NikhilCollooru", "name": "Nikhil Collooru"}}, "url": "https://github.com/prestodb/presto/commit/f340a0d210a7eb63457598f5b61b6eba102a6083", "committedDate": "2020-02-22T19:31:18Z", "message": "Fail task with large update size\n\nFail the query when the task update size\nexceeds the limit set by the parameter\nexperimental.internal-communication.max-task-update-size."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e6e393e025f588a31dfcc108618893e825a0ddef", "author": {"user": {"login": "NikhilCollooru", "name": "Nikhil Collooru"}}, "url": "https://github.com/prestodb/presto/commit/e6e393e025f588a31dfcc108618893e825a0ddef", "committedDate": "2020-02-22T03:14:38Z", "message": "Fail task with large update size\n\nFail the query when the task update size\nexceeds the limit set by the parameter\nexperimental.internal-communication.max-task-update-size."}, "afterCommit": {"oid": "f340a0d210a7eb63457598f5b61b6eba102a6083", "author": {"user": {"login": "NikhilCollooru", "name": "Nikhil Collooru"}}, "url": "https://github.com/prestodb/presto/commit/f340a0d210a7eb63457598f5b61b6eba102a6083", "committedDate": "2020-02-22T19:31:18Z", "message": "Fail task with large update size\n\nFail the query when the task update size\nexceeds the limit set by the parameter\nexperimental.internal-communication.max-task-update-size."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMDQ3MDQ1", "url": "https://github.com/prestodb/presto/pull/14142#pullrequestreview-363047045", "createdAt": "2020-02-22T19:42:24Z", "commit": {"oid": "f340a0d210a7eb63457598f5b61b6eba102a6083"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2299, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}