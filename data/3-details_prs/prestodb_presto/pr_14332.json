{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MzY3NTk4", "number": 14332, "title": "Make table properties a config property", "bodyText": "Depended by https://github.com/facebookexternal/presto-facebook/pull/936\nInstead of harding coding table properties, making it a configuration property.\n== RELEASE NOTES ==\n\nVerifier Changes\n* Add support for specifying table properties override for temporary Verifier tables, through configuration property ``control.table-properties`` and ``test.table-properties``.", "createdAt": "2020-04-03T20:19:59Z", "url": "https://github.com/prestodb/presto/pull/14332", "merged": true, "mergeCommit": {"oid": "b9eab4443caa0d2a5a1f09083f7cd4173e786862"}, "closed": true, "closedAt": "2020-04-05T01:16:43Z", "author": {"login": "caithagoras"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUHHD-gBqjMxOTc5Mzc0MTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcUeGhzgBqjMyMDA2NzQ0NTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "df48a892dd9d351250c48a64b4293945e9477ed7", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/df48a892dd9d351250c48a64b4293945e9477ed7", "committedDate": "2020-04-03T20:07:58Z", "message": "Make table properties a config property instead of hard-coded"}, "afterCommit": {"oid": "180a14c00838162978acfc0c23e7f872f8df37db", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/180a14c00838162978acfc0c23e7f872f8df37db", "committedDate": "2020-04-03T20:41:25Z", "message": "Make table properties a config property instead of hard-coded"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "180a14c00838162978acfc0c23e7f872f8df37db", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/180a14c00838162978acfc0c23e7f872f8df37db", "committedDate": "2020-04-03T20:41:25Z", "message": "Make table properties a config property instead of hard-coded"}, "afterCommit": {"oid": "fac6a290cdec84db5e707bdd2864ec4a3347899c", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/fac6a290cdec84db5e707bdd2864ec4a3347899c", "committedDate": "2020-04-03T21:02:36Z", "message": "Make table properties a config property instead of hard-coded"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NTk2MDUx", "url": "https://github.com/prestodb/presto/pull/14332#pullrequestreview-387596051", "createdAt": "2020-04-03T21:38:33Z", "commit": {"oid": "fac6a290cdec84db5e707bdd2864ec4a3347899c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMTozODozM1rOGAqedw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QyMTozODozM1rOGAqedw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0OTExMQ==", "bodyText": "I'm confused about the changes here as I lacked a lot of context. Why did we remove QueryRewriteConfig and use prefix?", "url": "https://github.com/prestodb/presto/pull/14332#discussion_r403349111", "createdAt": "2020-04-03T21:38:33Z", "author": {"login": "shixuan-fan"}, "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/rewrite/VerificationQueryRewriterFactory.java", "diffHunk": "@@ -15,42 +15,54 @@\n \n import com.facebook.presto.spi.type.TypeManager;\n import com.facebook.presto.sql.parser.SqlParser;\n+import com.facebook.presto.sql.tree.BooleanLiteral;\n+import com.facebook.presto.sql.tree.DoubleLiteral;\n+import com.facebook.presto.sql.tree.Identifier;\n+import com.facebook.presto.sql.tree.LongLiteral;\n import com.facebook.presto.sql.tree.Property;\n+import com.facebook.presto.sql.tree.QualifiedName;\n+import com.facebook.presto.sql.tree.StringLiteral;\n import com.facebook.presto.verifier.annotation.ForControl;\n import com.facebook.presto.verifier.annotation.ForTest;\n import com.facebook.presto.verifier.prestoaction.PrestoAction;\n+import com.google.common.collect.ImmutableList;\n import com.google.common.collect.ImmutableMap;\n \n import javax.inject.Inject;\n \n import java.util.List;\n+import java.util.Map;\n+import java.util.Map.Entry;\n \n+import static com.facebook.presto.sql.tree.BooleanLiteral.FALSE_LITERAL;\n import static com.facebook.presto.verifier.framework.ClusterType.CONTROL;\n import static com.facebook.presto.verifier.framework.ClusterType.TEST;\n+import static java.lang.String.format;\n import static java.util.Objects.requireNonNull;\n \n public class VerificationQueryRewriterFactory\n         implements QueryRewriterFactory\n {\n     private final SqlParser sqlParser;\n     private final TypeManager typeManager;\n-    private final List<Property> tablePropertyOverrides;\n-    private final QueryRewriteConfig controlConfig;\n-    private final QueryRewriteConfig testConfig;\n+    private final QualifiedName controlTablePrefix;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fac6a290cdec84db5e707bdd2864ec4a3347899c"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NjAzMDg5", "url": "https://github.com/prestodb/presto/pull/14332#pullrequestreview-387603089", "createdAt": "2020-04-03T21:55:19Z", "commit": {"oid": "fac6a290cdec84db5e707bdd2864ec4a3347899c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fac6a290cdec84db5e707bdd2864ec4a3347899c", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/fac6a290cdec84db5e707bdd2864ec4a3347899c", "committedDate": "2020-04-03T21:02:36Z", "message": "Make table properties a config property instead of hard-coded"}, "afterCommit": {"oid": "a823f477f09bd3d55f810579ae2551017b1a3963", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/a823f477f09bd3d55f810579ae2551017b1a3963", "committedDate": "2020-04-03T23:04:59Z", "message": "Make table properties a config property instead of hardcoded"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89566a8d38fb0b5ae642f2fbe0144dc5d545b765", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/89566a8d38fb0b5ae642f2fbe0144dc5d545b765", "committedDate": "2020-04-04T23:28:37Z", "message": "Make table properties a config property instead of hard-coded"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a823f477f09bd3d55f810579ae2551017b1a3963", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/a823f477f09bd3d55f810579ae2551017b1a3963", "committedDate": "2020-04-03T23:04:59Z", "message": "Make table properties a config property instead of hardcoded"}, "afterCommit": {"oid": "89566a8d38fb0b5ae642f2fbe0144dc5d545b765", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/89566a8d38fb0b5ae642f2fbe0144dc5d545b765", "committedDate": "2020-04-04T23:28:37Z", "message": "Make table properties a config property instead of hard-coded"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1775, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}