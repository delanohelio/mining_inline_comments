{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ2NjMxMzgw", "number": 14815, "title": "Skip isSplittable reflection for RCFileInputFormat ", "bodyText": "Currently, presto relies on the method reflection to find out if the input format is splittable for all input formats except OrcInputFormat. Using the method reflection is a costly operation, hence avoiding the method reflection for RCFileInputFormat as well.\n== NO RELEASE NOTE ==", "createdAt": "2020-07-09T05:42:26Z", "url": "https://github.com/prestodb/presto/pull/14815", "merged": true, "mergeCommit": {"oid": "3177a906b3adde0a6a5fa43a8f57c722ffccf1bb"}, "closed": true, "closedAt": "2020-07-13T19:55:06Z", "author": {"login": "jainxrohit"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABczItyEABqjM1MjgxMDYzNjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcznF80gBqjM1MzQ3ODQyODI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8e7c1de05f5cf4a21ba8012f92a658128ebb8d6f", "author": {"user": {"login": "jainxrohit", "name": "Rohit Jain"}}, "url": "https://github.com/prestodb/presto/commit/8e7c1de05f5cf4a21ba8012f92a658128ebb8d6f", "committedDate": "2020-07-09T05:41:59Z", "message": "Skip method reflection for isSplittable\n\nCurrently, presto relies on the method reflection to find out if the\ninput format is splittable for all input formats except OrcInputFormat.\nUsing the method reflection is a costly operation, hence avoiding the\nmethod reflection for most of the splittable input formats."}, "afterCommit": {"oid": "1ad4cdfc007cb5f469870747b8ab445b344f06ba", "author": {"user": {"login": "jainxrohit", "name": "Rohit Jain"}}, "url": "https://github.com/prestodb/presto/commit/1ad4cdfc007cb5f469870747b8ab445b344f06ba", "committedDate": "2020-07-09T06:05:20Z", "message": "Skip method reflection for isSplittable\n\nCurrently, presto relies on the method reflection to find out if the\ninput format is splittable for all input formats except OrcInputFormat.\nUsing the method reflection is a costly operation, hence avoiding the\nmethod reflection for most of the splittable input formats."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MDkwMjAy", "url": "https://github.com/prestodb/presto/pull/14815#pullrequestreview-446090202", "createdAt": "2020-07-10T02:52:12Z", "commit": {"oid": "1ad4cdfc007cb5f469870747b8ab445b344f06ba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwMjo1MjoxMlrOGvoMgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwMjo1MjoxMlrOGvoMgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU5NDgxNg==", "bodyText": "Seems EncryptedOrcInputFormat is the only inheritance of OrcInputFormat. So,\ninputFormat.getClass().getSimpleName().equals(\"OrcInputFormat\")\nis equivalent to\ninputFormat instance of OrcInputFormat && !(inputFormat instance of EncryptedOrcInputFormat))\nright?\nFor EncryptedOrcInputFormat, given we are not using the open-source encryption, so we can ignore that and just use inputFormat instance of OrcInputFormat.", "url": "https://github.com/prestodb/presto/pull/14815#discussion_r452594816", "createdAt": "2020-07-10T02:52:12Z", "author": {"login": "highker"}, "path": "presto-hive/src/main/java/com/facebook/presto/hive/HiveUtil.java", "diffHunk": "@@ -340,12 +342,14 @@ public static long parseHiveTimestamp(String value, DateTimeZone timeZone)\n \n     public static boolean isSplittable(InputFormat<?, ?> inputFormat, FileSystem fileSystem, Path path)\n     {\n-        // ORC uses a custom InputFormat but is always splittable\n-        if (inputFormat.getClass().getSimpleName().equals(\"OrcInputFormat\")) {\n+        //This check covers, ORC/DWRF/AVRO/RCBINARY/RCTEXT/SEQUENCEFILE/PAGEFILE storage formats.\n+        if (inputFormat instanceof FileInputFormat ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1ad4cdfc007cb5f469870747b8ab445b344f06ba"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ad4cdfc007cb5f469870747b8ab445b344f06ba", "author": {"user": {"login": "jainxrohit", "name": "Rohit Jain"}}, "url": "https://github.com/prestodb/presto/commit/1ad4cdfc007cb5f469870747b8ab445b344f06ba", "committedDate": "2020-07-09T06:05:20Z", "message": "Skip method reflection for isSplittable\n\nCurrently, presto relies on the method reflection to find out if the\ninput format is splittable for all input formats except OrcInputFormat.\nUsing the method reflection is a costly operation, hence avoiding the\nmethod reflection for most of the splittable input formats."}, "afterCommit": {"oid": "e68c0e3fa4e38a878c4d2f50260f5a5494490e65", "author": {"user": {"login": "jainxrohit", "name": "Rohit Jain"}}, "url": "https://github.com/prestodb/presto/commit/e68c0e3fa4e38a878c4d2f50260f5a5494490e65", "committedDate": "2020-07-10T04:15:55Z", "message": "Skip method reflection for isSplittable\n\nCurrently, presto relies on the method reflection to find out if the\ninput format is splittable for all input formats except OrcInputFormat.\nUsing the method reflection is a costly operation, hence avoiding the\nmethod reflection for most of the splittable input formats."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MTE3MzMw", "url": "https://github.com/prestodb/presto/pull/14815#pullrequestreview-446117330", "createdAt": "2020-07-10T04:41:11Z", "commit": {"oid": "e68c0e3fa4e38a878c4d2f50260f5a5494490e65"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94cf270cafc3082f218bd8c6c133d1427ba0e276", "author": {"user": {"login": "jainxrohit", "name": "Rohit Jain"}}, "url": "https://github.com/prestodb/presto/commit/94cf270cafc3082f218bd8c6c133d1427ba0e276", "committedDate": "2020-07-10T17:26:51Z", "message": "Skip isSplittable reflection for RCFileInputFormat\n\nCurrently, presto relies on the method reflection to find out if the\ninput format is splittable for all input formats except OrcInputFormat.\nUsing the method reflection is a costly operation, hence avoiding the\nmethod reflection for RCFileInputFormat as well."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e68c0e3fa4e38a878c4d2f50260f5a5494490e65", "author": {"user": {"login": "jainxrohit", "name": "Rohit Jain"}}, "url": "https://github.com/prestodb/presto/commit/e68c0e3fa4e38a878c4d2f50260f5a5494490e65", "committedDate": "2020-07-10T04:15:55Z", "message": "Skip method reflection for isSplittable\n\nCurrently, presto relies on the method reflection to find out if the\ninput format is splittable for all input formats except OrcInputFormat.\nUsing the method reflection is a costly operation, hence avoiding the\nmethod reflection for most of the splittable input formats."}, "afterCommit": {"oid": "94cf270cafc3082f218bd8c6c133d1427ba0e276", "author": {"user": {"login": "jainxrohit", "name": "Rohit Jain"}}, "url": "https://github.com/prestodb/presto/commit/94cf270cafc3082f218bd8c6c133d1427ba0e276", "committedDate": "2020-07-10T17:26:51Z", "message": "Skip isSplittable reflection for RCFileInputFormat\n\nCurrently, presto relies on the method reflection to find out if the\ninput format is splittable for all input formats except OrcInputFormat.\nUsing the method reflection is a costly operation, hence avoiding the\nmethod reflection for RCFileInputFormat as well."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1229, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}