{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYyNjAwMTE5", "number": 14952, "title": "Timestamp literal pushdown for Druid connector", "bodyText": "Push down the timestamp to druid\nselect * from druid.wikipedia where __time > timestamp '2016-06-26 18:00:00.000'\nor the timestamp with timezone:\nselect * from druid.wikipedia where __time > timestamp '2016-06-26 19:00:00.000 UTC';\nor cast:\nselect * from druid.wikipedia where __time > CAST('2016-06-26 18:00:00.000' as TIMESTAMP);\nIn this PR, I also added the druid connector to presto server's config (for devel only) and improved the error message handling.\n== NO RELEASE NOTE ==", "createdAt": "2020-08-04T08:02:36Z", "url": "https://github.com/prestodb/presto/pull/14952", "merged": true, "mergeCommit": {"oid": "b99054213edc4009304be4a2fd40cbc96d04433e"}, "closed": true, "closedAt": "2020-08-07T23:05:35Z", "author": {"login": "beinan"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc7yPwwgFqTQ2MTMwMTg0OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8p1rygBqjM2MzQ1NDc4MDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxMzAxODQ5", "url": "https://github.com/prestodb/presto/pull/14952#pullrequestreview-461301849", "createdAt": "2020-08-05T02:44:04Z", "commit": {"oid": "e82668661f332ab0bf62fa24c87fb6d730a4c549"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMjo0NDowNFrOG74J0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQwMjo1NzoyOFrOG74XVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQzOTE4NQ==", "bodyText": "I think it's fine to add extra configurations here for development purposes. We may also need to be careful not to let these configs become legacy code in the future.", "url": "https://github.com/prestodb/presto/pull/14952#discussion_r465439185", "createdAt": "2020-08-05T02:44:04Z", "author": {"login": "ChunxuTang"}, "path": "presto-main/etc/catalog/druid.properties", "diffHunk": "@@ -0,0 +1,3 @@\n+connector.name=druid\n+druid.coordinator-url=http://localhost:8081\n+druid.broker-url=http://localhost:8082", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e82668661f332ab0bf62fa24c87fb6d730a4c549"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ0MjY0NQ==", "bodyText": "Maybe we could remove this line or add some more explaination in the future as some changes have been done based on the prior code snippet.", "url": "https://github.com/prestodb/presto/pull/14952#discussion_r465442645", "createdAt": "2020-08-05T02:57:28Z", "author": {"login": "ChunxuTang"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidPushdownUtils.java", "diffHunk": "@@ -150,7 +155,7 @@ private static Number decodeDecimal(BigInteger unscaledValue, DecimalType type)\n     }\n \n     // Copied from com.facebook.presto.sql.planner.LiteralInterpreter.evaluate", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e82668661f332ab0bf62fa24c87fb6d730a4c549"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyMDU4NzM4", "url": "https://github.com/prestodb/presto/pull/14952#pullrequestreview-462058738", "createdAt": "2020-08-05T22:10:00Z", "commit": {"oid": "e82668661f332ab0bf62fa24c87fb6d730a4c549"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a12f6e6790ae4387d54e9843f7736f7b10ca39c6", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/a12f6e6790ae4387d54e9843f7736f7b10ca39c6", "committedDate": "2020-08-07T02:29:42Z", "message": "Add test for timestamp literal pushdown"}, "afterCommit": {"oid": "28695b8fb299664d672cc907a7afdf6d6d3ef7f3", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/28695b8fb299664d672cc907a7afdf6d6d3ef7f3", "committedDate": "2020-08-07T06:37:56Z", "message": "Add test for timestamp literal pushdown"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNDg2OTU2", "url": "https://github.com/prestodb/presto/pull/14952#pullrequestreview-463486956", "createdAt": "2020-08-07T17:35:07Z", "commit": {"oid": "28695b8fb299664d672cc907a7afdf6d6d3ef7f3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c94cff5991ce9d1edf7f962431a7b15fa74fc77e", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/c94cff5991ce9d1edf7f962431a7b15fa74fc77e", "committedDate": "2020-08-07T19:45:44Z", "message": "Add druid connector to devel configs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fcec163d2d1e7770046403f3a4bf5a50c5642f36", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/fcec163d2d1e7770046403f3a4bf5a50c5642f36", "committedDate": "2020-08-07T19:45:45Z", "message": "Handle the error message from Druid broker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92f2e40d2150126d519e41047f3643cd08c64b60", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/92f2e40d2150126d519e41047f3643cd08c64b60", "committedDate": "2020-08-07T19:45:45Z", "message": "Timestamp literal push down for Druid connector"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a1bf8a19e64a91422ead8676a35d030ce3fd9d8", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/5a1bf8a19e64a91422ead8676a35d030ce3fd9d8", "committedDate": "2020-08-07T19:45:45Z", "message": "Remove the unnecessary logic on time literal pushdown"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e7a64b6cfb16551b74f276515447991db0579bb", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/4e7a64b6cfb16551b74f276515447991db0579bb", "committedDate": "2020-08-07T19:45:45Z", "message": "Add test for timestamp literal pushdown"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28695b8fb299664d672cc907a7afdf6d6d3ef7f3", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/28695b8fb299664d672cc907a7afdf6d6d3ef7f3", "committedDate": "2020-08-07T06:37:56Z", "message": "Add test for timestamp literal pushdown"}, "afterCommit": {"oid": "4e7a64b6cfb16551b74f276515447991db0579bb", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/4e7a64b6cfb16551b74f276515447991db0579bb", "committedDate": "2020-08-07T19:45:45Z", "message": "Add test for timestamp literal pushdown"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 412, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}