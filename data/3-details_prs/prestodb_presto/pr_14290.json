{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzMzAwOTE0", "number": 14290, "title": "Move RemoteSplit URI construction from coordinator to worker", "bodyText": "Coordinator could spend ~200ms to construct the URIs in a single\nthread, which does not seem necessary and could be done in workers.\n== NO RELEASE NOTE ==", "createdAt": "2020-03-24T23:13:09Z", "url": "https://github.com/prestodb/presto/pull/14290", "merged": true, "mergeCommit": {"oid": "410dd0900390bf08f16a1a5030483c7d77cf1b0e"}, "closed": true, "closedAt": "2020-03-25T20:29:20Z", "author": {"login": "shixuan-fan"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQ7dtNgFqTM4MDc2NTYyMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRKX9egBqjMxNjQ4NDIzMDg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNzY1NjIz", "url": "https://github.com/prestodb/presto/pull/14290#pullrequestreview-380765623", "createdAt": "2020-03-24T23:25:26Z", "commit": {"oid": "e2d15f92364f09048e087ef76a4e2a90fe4a8484"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMzoyNToyNlrOF7GyTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMzoyNToyNlrOF7GyTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzUyMTQ4NA==", "bodyText": "what are other string options except ASCII String? :P", "url": "https://github.com/prestodb/presto/pull/14290#discussion_r397521484", "createdAt": "2020-03-24T23:25:26Z", "author": {"login": "wenleix"}, "path": "presto-main/src/main/java/com/facebook/presto/execution/SqlStageExecution.java", "diffHunk": "@@ -542,7 +541,7 @@ public void recordGetSplitTime(long start)\n     private static Split createRemoteSplitFor(TaskId taskId, URI remoteSourceTaskLocation, TaskId remoteSourceTaskId)\n     {\n         // Fetch the results from the buffer assigned to the task based on id\n-        URI splitLocation = uriBuilderFrom(remoteSourceTaskLocation).appendPath(\"results\").appendPath(String.valueOf(taskId.getId())).build();\n+        String splitLocation = remoteSourceTaskLocation.toASCIIString() + \"/results/\" + taskId.getId();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2d15f92364f09048e087ef76a4e2a90fe4a8484"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwNzY1NTA5", "url": "https://github.com/prestodb/presto/pull/14290#pullrequestreview-380765509", "createdAt": "2020-03-24T23:25:10Z", "commit": {"oid": "e2d15f92364f09048e087ef76a4e2a90fe4a8484"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMzoyNToxMVrOF7Gx7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNFQyMzoyNToxMVrOF7Gx7w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzUyMTM5MQ==", "bodyText": "Do we wanna create an abstraction called Location rather than using raw string? I'm thinking to replace the URI interfaces in LocationFactory all with Location.", "url": "https://github.com/prestodb/presto/pull/14290#discussion_r397521391", "createdAt": "2020-03-24T23:25:11Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/split/RemoteSplit.java", "diffHunk": "@@ -31,18 +30,18 @@\n public class RemoteSplit\n         implements ConnectorSplit\n {\n-    private final URI location;\n+    private final String location;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e2d15f92364f09048e087ef76a4e2a90fe4a8484"}, "originalPosition": 13}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2d15f92364f09048e087ef76a4e2a90fe4a8484", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/e2d15f92364f09048e087ef76a4e2a90fe4a8484", "committedDate": "2020-03-24T23:09:29Z", "message": "Move RemoteSplit URI construction from coordinator to worker\n\nCoordinator could spend ~200ms to construct the URIs in a single\nthread, which does not seem necessary and could be done in workers."}, "afterCommit": {"oid": "c9bc0595db616568199086bc0d2b15243d1f848d", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/c9bc0595db616568199086bc0d2b15243d1f848d", "committedDate": "2020-03-25T16:23:23Z", "message": "Move RemoteSplit URI construction from coordinator to worker\n\nCoordinator could spend ~200ms to construct the URIs in a single\nthread, which does not seem necessary and could be done in workers."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9bc0595db616568199086bc0d2b15243d1f848d", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/c9bc0595db616568199086bc0d2b15243d1f848d", "committedDate": "2020-03-25T16:23:23Z", "message": "Move RemoteSplit URI construction from coordinator to worker\n\nCoordinator could spend ~200ms to construct the URIs in a single\nthread, which does not seem necessary and could be done in workers."}, "afterCommit": {"oid": "c2a77d309cabadf16bc6e28d20452a1f1c4942e7", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/c2a77d309cabadf16bc6e28d20452a1f1c4942e7", "committedDate": "2020-03-25T16:25:38Z", "message": "Move RemoteSplit URI construction from coordinator to worker\n\nCoordinator could spend ~200ms to construct the URIs in a single\nthread, which does not seem necessary and could be done in workers."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "122c4c7a847964ffe8aee9bd2206322cd86c5008", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/122c4c7a847964ffe8aee9bd2206322cd86c5008", "committedDate": "2020-03-25T16:47:48Z", "message": "Move RemoteSplit URI construction from coordinator to worker\n\nCoordinator could spend ~200ms to construct the URIs in a single\nthread, which does not seem necessary and could be done in workers."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c2a77d309cabadf16bc6e28d20452a1f1c4942e7", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/c2a77d309cabadf16bc6e28d20452a1f1c4942e7", "committedDate": "2020-03-25T16:25:38Z", "message": "Move RemoteSplit URI construction from coordinator to worker\n\nCoordinator could spend ~200ms to construct the URIs in a single\nthread, which does not seem necessary and could be done in workers."}, "afterCommit": {"oid": "122c4c7a847964ffe8aee9bd2206322cd86c5008", "author": {"user": {"login": "shixuan-fan", "name": "Shixuan Fan"}}, "url": "https://github.com/prestodb/presto/commit/122c4c7a847964ffe8aee9bd2206322cd86c5008", "committedDate": "2020-03-25T16:47:48Z", "message": "Move RemoteSplit URI construction from coordinator to worker\n\nCoordinator could spend ~200ms to construct the URIs in a single\nthread, which does not seem necessary and could be done in workers."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2098, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}