{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NTY5ODk3", "number": 14221, "title": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed \u2026", "bodyText": "Add jsonproperty tag to ignoreNulls so it works in distributed execution as well.\n==  RELEASE NOTES ==\nFixes a bug in window functions with IGNORE NULLS not working properly in a distributed environment as the flag is not serialized propery.", "createdAt": "2020-03-06T00:32:07Z", "url": "https://github.com/prestodb/presto/pull/14221", "merged": true, "mergeCommit": {"oid": "39c43b66e1838090e278fd68e0eecc836c230bd3"}, "closed": true, "closedAt": "2020-03-12T23:32:51Z", "author": {"login": "kaikalur"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcK1WthAFqTM3MDAxMzY3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNAq1WgBqjMxMjQxNzQwNzQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMDEzNjc2", "url": "https://github.com/prestodb/presto/pull/14221#pullrequestreview-370013676", "createdAt": "2020-03-06T00:48:52Z", "commit": {"oid": "0c87a58246451874da1662ff06bf2be224cce349"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwMDo0ODo1MlrOFypUYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwMDo1NTowMFrOFypeIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODY1MDA4Mw==", "bodyText": "This is probably not needed?", "url": "https://github.com/prestodb/presto/pull/14221#discussion_r388650083", "createdAt": "2020-03-06T00:48:52Z", "author": {"login": "rongrong"}, "path": "presto-tests/src/main/java/com/facebook/presto/tests/AbstractTestQueries.java", "diffHunk": "@@ -41,6 +41,7 @@\n import io.airlift.tpch.TpchTable;\n import org.apache.commons.math3.stat.descriptive.DescriptiveStatistics;\n import org.intellij.lang.annotations.Language;\n+import org.testng.Assert;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c87a58246451874da1662ff06bf2be224cce349"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODY1MjU3OA==", "bodyText": "You can probably write it similar as other tests using assertQueryOrdered and provide expected results, rather than just checking for null (look at testValueWindowFunctions).", "url": "https://github.com/prestodb/presto/pull/14221#discussion_r388652578", "createdAt": "2020-03-06T00:55:00Z", "author": {"login": "rongrong"}, "path": "presto-tests/src/main/java/com/facebook/presto/tests/AbstractTestQueries.java", "diffHunk": "@@ -8272,6 +8273,34 @@ public void testRightJoinWithEmptyProbeSide()\n                 \"WITH small_part AS (SELECT * FROM part WHERE name = 'a') SELECT lineitem.orderkey FROM small_part RIGHT JOIN lineitem ON  small_part.partkey = lineitem.partkey\");\n     }\n \n+    @Test\n+    public void testLastValueIgnoreNulls()\n+    {\n+        String query = \"WITH T AS (\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0c87a58246451874da1662ff06bf2be224cce349"}, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0c87a58246451874da1662ff06bf2be224cce349", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/0c87a58246451874da1662ff06bf2be224cce349", "committedDate": "2020-03-06T00:27:58Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well."}, "afterCommit": {"oid": "747180002501efeaa5a7695462f25aaface11004", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/747180002501efeaa5a7695462f25aaface11004", "committedDate": "2020-03-08T04:34:37Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "747180002501efeaa5a7695462f25aaface11004", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/747180002501efeaa5a7695462f25aaface11004", "committedDate": "2020-03-08T04:34:37Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well."}, "afterCommit": {"oid": "6320e0c6bc95a110666d4fc44f5d4b1817dc8647", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/6320e0c6bc95a110666d4fc44f5d4b1817dc8647", "committedDate": "2020-03-08T16:58:27Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6320e0c6bc95a110666d4fc44f5d4b1817dc8647", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/6320e0c6bc95a110666d4fc44f5d4b1817dc8647", "committedDate": "2020-03-08T16:58:27Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well."}, "afterCommit": {"oid": "3f7277a479bae93cb5bed573a901b86fd2c5b3dc", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/3f7277a479bae93cb5bed573a901b86fd2c5b3dc", "committedDate": "2020-03-10T19:02:06Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well.\n\nSimplified the test."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNTE5MzE1", "url": "https://github.com/prestodb/presto/pull/14221#pullrequestreview-372519315", "createdAt": "2020-03-11T07:19:26Z", "commit": {"oid": "3f7277a479bae93cb5bed573a901b86fd2c5b3dc"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQwNzoxOToyN1rOF0rbGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQwNzoyMDowNFrOF0rbyQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDc4MTcyMg==", "bodyText": "Nits: separate line for new argument. And empty space between values.\n    \"FROM T\",\n    \"Values 1, 2, 2\");", "url": "https://github.com/prestodb/presto/pull/14221#discussion_r390781722", "createdAt": "2020-03-11T07:19:27Z", "author": {"login": "rongrong"}, "path": "presto-tests/src/main/java/com/facebook/presto/tests/AbstractTestQueries.java", "diffHunk": "@@ -8272,6 +8272,29 @@ public void testRightJoinWithEmptyProbeSide()\n                 \"WITH small_part AS (SELECT * FROM part WHERE name = 'a') SELECT lineitem.orderkey FROM small_part RIGHT JOIN lineitem ON  small_part.partkey = lineitem.partkey\");\n     }\n \n+    @Test\n+    public void testLastValueIgnoreNulls()\n+    {\n+        assertQuery(\"WITH T AS (\" +\n+                \"    SELECT\" +\n+                \"        p,\" +\n+                \"        v\" +\n+                \"    FROM (\" +\n+                \"        VALUES\" +\n+                \"            (2, 2),\" +\n+                \"            (1, 1),\" +\n+                \"            (3, NULL)\" +\n+                \"    ) T(p, v)\" +\n+                \")\" +\n+                \"SELECT\" +\n+                \"    LAST_VALUE(v) IGNORE NULLS OVER (\" +\n+                \"        PARTITION BY 1\" +\n+                \"        ORDER BY\" +\n+                \"            p ASC\" +\n+                \"    )\" +\n+                \"FROM T\", \"Values 1,2,2\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f7277a479bae93cb5bed573a901b86fd2c5b3dc"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDc4MTg5Nw==", "bodyText": "Nits: new line for argument.\n    assertQuery(\n        \"WITH T ...", "url": "https://github.com/prestodb/presto/pull/14221#discussion_r390781897", "createdAt": "2020-03-11T07:20:04Z", "author": {"login": "rongrong"}, "path": "presto-tests/src/main/java/com/facebook/presto/tests/AbstractTestQueries.java", "diffHunk": "@@ -8272,6 +8272,29 @@ public void testRightJoinWithEmptyProbeSide()\n                 \"WITH small_part AS (SELECT * FROM part WHERE name = 'a') SELECT lineitem.orderkey FROM small_part RIGHT JOIN lineitem ON  small_part.partkey = lineitem.partkey\");\n     }\n \n+    @Test\n+    public void testLastValueIgnoreNulls()\n+    {\n+        assertQuery(\"WITH T AS (\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3f7277a479bae93cb5bed573a901b86fd2c5b3dc"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f7277a479bae93cb5bed573a901b86fd2c5b3dc", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/3f7277a479bae93cb5bed573a901b86fd2c5b3dc", "committedDate": "2020-03-10T19:02:06Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well.\n\nSimplified the test."}, "afterCommit": {"oid": "7ce1e15b4649f6c2e1f67c045055b4ee9da82b1f", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/7ce1e15b4649f6c2e1f67c045055b4ee9da82b1f", "committedDate": "2020-03-12T04:25:59Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well.\n\nSimplified the test.\nFormatting."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7ce1e15b4649f6c2e1f67c045055b4ee9da82b1f", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/7ce1e15b4649f6c2e1f67c045055b4ee9da82b1f", "committedDate": "2020-03-12T04:25:59Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well.\n\nSimplified the test.\nFormatting."}, "afterCommit": {"oid": "ab76ffa0f205fbbdf411995422769f0f5a9add07", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/ab76ffa0f205fbbdf411995422769f0f5a9add07", "committedDate": "2020-03-12T04:31:00Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well.\n\nSimplified the test.\nFormatting."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bac00b32c32971eb31a71be5756a219fcee1bc0d", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/bac00b32c32971eb31a71be5756a219fcee1bc0d", "committedDate": "2020-03-12T19:13:39Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well.\n\nSimplified the test.\nFormatting."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab76ffa0f205fbbdf411995422769f0f5a9add07", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/ab76ffa0f205fbbdf411995422769f0f5a9add07", "committedDate": "2020-03-12T04:31:00Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well.\n\nSimplified the test.\nFormatting."}, "afterCommit": {"oid": "bac00b32c32971eb31a71be5756a219fcee1bc0d", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/bac00b32c32971eb31a71be5756a219fcee1bc0d", "committedDate": "2020-03-12T19:13:39Z", "message": "Add @JsonProperty tag to ignoreNulls flag so it works in distributed execution as well.\n\nSimplified the test.\nFormatting."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2005, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}