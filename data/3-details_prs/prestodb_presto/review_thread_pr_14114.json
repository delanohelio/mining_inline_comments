{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc2Nzc1ODk1", "number": 14114, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODo0OToxNFrODgz8mQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODo0OToxNFrODgz8mQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM1NzMyMTIxOnYy", "diffSide": "RIGHT", "path": "presto-main/src/main/java/com/facebook/presto/operator/exchange/LocalExchange.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxODo0OToxNFrOFrOMMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOFQxOTo0MzozOFrOFrP8Uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg2NTU4Ng==", "bodyText": "why the original code has null pointer issue? Maybe explain it a bit in commit message?", "url": "https://github.com/prestodb/presto/pull/14114#discussion_r380865586", "createdAt": "2020-02-18T18:49:14Z", "author": {"login": "wenleix"}, "path": "presto-main/src/main/java/com/facebook/presto/operator/exchange/LocalExchange.java", "diffHunk": "@@ -173,7 +173,7 @@ private static PartitionFunction createPartitionFunction(\n         ConnectorNodePartitioningProvider partitioningProvider = partitioningProviderManager.getPartitioningProvider(partitioning.getConnectorId().get());\n         ConnectorBucketNodeMap connectorBucketNodeMap = partitioningProvider.getBucketNodeMap(\n                 partitioning.getTransactionHandle().orElse(null),\n-                session.toConnectorSession(),\n+                session.toConnectorSession(partitioning.getConnectorId().get()),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af340316c5d646aae5237055516168cade28326f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg5NDI5MQ==", "bodyText": "toConnectorSession() will call\nnew FullConnectorSession(this, identity.toConnectorIdentity());\npublic FullConnectorSession(Session session, ConnectorIdentity identity)\n    {\n        this.session = requireNonNull(session, \"session is null\");\n        this.identity = requireNonNull(identity, \"identity is null\");\n        this.properties = null;\n        this.connectorId = null;\n        this.catalog = null;\n        this.sessionPropertyManager = null;\n        this.sqlFunctionProperties = session.getSqlFunctionProperties();\n    }\n\nhere will set properties/connecotId/catalog/sessionPropertyManager null\nhence we should call ConnectorSession toConnectorSession(ConnectorId connectorId)\npublic ConnectorSession toConnectorSession(ConnectorId connectorId)\n    {\n        requireNonNull(connectorId, \"connectorId is null\");\n\n        return new FullConnectorSession(\n                this,\n                identity.toConnectorIdentity(connectorId.getCatalogName()),\n                connectorProperties.getOrDefault(connectorId, ImmutableMap.of()),\n                connectorId,\n                connectorId.getCatalogName(),\n                sessionPropertyManager);\n    }", "url": "https://github.com/prestodb/presto/pull/14114#discussion_r380894291", "createdAt": "2020-02-18T19:43:38Z", "author": {"login": "kewang1024"}, "path": "presto-main/src/main/java/com/facebook/presto/operator/exchange/LocalExchange.java", "diffHunk": "@@ -173,7 +173,7 @@ private static PartitionFunction createPartitionFunction(\n         ConnectorNodePartitioningProvider partitioningProvider = partitioningProviderManager.getPartitioningProvider(partitioning.getConnectorId().get());\n         ConnectorBucketNodeMap connectorBucketNodeMap = partitioningProvider.getBucketNodeMap(\n                 partitioning.getTransactionHandle().orElse(null),\n-                session.toConnectorSession(),\n+                session.toConnectorSession(partitioning.getConnectorId().get()),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDg2NTU4Ng=="}, "originalCommit": {"oid": "af340316c5d646aae5237055516168cade28326f"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3033, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}