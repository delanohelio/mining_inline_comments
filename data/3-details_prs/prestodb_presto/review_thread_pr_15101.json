{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc2NzU1MjU0", "number": 15101, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQyMzoxNToyMlrOEh49og==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNjoyMjozNVrOEiMi-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzOTcxNzQ2OnYy", "diffSide": "RIGHT", "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/framework/DataVerificationConfig.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQyMzoxNToyMlrOHPdYxQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwMDo1MzozNVrOHPfFaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk3MjE2NQ==", "bodyText": "Curious why we are extracting this out to a separate config? Do we envision more such properties in the future?", "url": "https://github.com/prestodb/presto/pull/15101#discussion_r485972165", "createdAt": "2020-09-09T23:15:22Z", "author": {"login": "sujay-jain"}, "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/framework/DataVerificationConfig.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db81b61f623c81c63ed94a5f0bc75db362f5b1e0"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk5OTk3Ng==", "bodyText": "I was thinking that we're only support skip-control for DML verification, so put this as a separate config that are specific to DML verification. But you reminded me that we could also trivially support this config for explain as well.\nRemoved this config and added support for skip-control for explain in the last commit.", "url": "https://github.com/prestodb/presto/pull/15101#discussion_r485999976", "createdAt": "2020-09-10T00:53:35Z", "author": {"login": "caithagoras"}, "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/framework/DataVerificationConfig.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk3MjE2NQ=="}, "originalCommit": {"oid": "db81b61f623c81c63ed94a5f0bc75db362f5b1e0"}, "originalPosition": 1}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0MjcxNDY1OnYy", "diffSide": "RIGHT", "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/framework/AbstractVerification.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNTozNDowN1rOHP54_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNjo0MjozMVrOHP8v0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQzOTE2NQ==", "bodyText": "Should we change VerifierQueryEvent to just take determinismAnalysisDetails now that it contains the determinismAnalysis as well?", "url": "https://github.com/prestodb/presto/pull/15101#discussion_r486439165", "createdAt": "2020-09-10T15:34:07Z", "author": {"login": "sujay-jain"}, "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/framework/AbstractVerification.java", "diffHunk": "@@ -308,10 +303,8 @@ private VerificationResult concludeVerification(\n                 sourceQuery.getName(),\n                 partialResult.getStatus(),\n                 partialResult.getSkippedReason(),\n-                determinismAnalysis,\n-                determinismAnalysis.isPresent() ?\n-                        Optional.of(determinismAnalysisDetails) :\n-                        Optional.empty(),\n+                determinismAnalysisDetails.map(DeterminismAnalysisDetails::getAnalysis),\n+                determinismAnalysisDetails,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6105c5cdadd8fca72aa09a0e3ccc5e764aa05323"}, "originalPosition": 120}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ4NTk3MA==", "bodyText": "done, also removed deprecated field deterministic from VerifierQueryEvent.", "url": "https://github.com/prestodb/presto/pull/15101#discussion_r486485970", "createdAt": "2020-09-10T16:42:31Z", "author": {"login": "caithagoras"}, "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/framework/AbstractVerification.java", "diffHunk": "@@ -308,10 +303,8 @@ private VerificationResult concludeVerification(\n                 sourceQuery.getName(),\n                 partialResult.getStatus(),\n                 partialResult.getSkippedReason(),\n-                determinismAnalysis,\n-                determinismAnalysis.isPresent() ?\n-                        Optional.of(determinismAnalysisDetails) :\n-                        Optional.empty(),\n+                determinismAnalysisDetails.map(DeterminismAnalysisDetails::getAnalysis),\n+                determinismAnalysisDetails,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQzOTE2NQ=="}, "originalCommit": {"oid": "6105c5cdadd8fca72aa09a0e3ccc5e764aa05323"}, "originalPosition": 120}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA0MjkyNjAzOnYy", "diffSide": "RIGHT", "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/event/DeterminismAnalysisDetails.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNjoyMjozNVrOHP7-Zw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxNjo0MjoxM1rOHP8vLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ3MzMxOQ==", "bodyText": "nit: maybe determinismAnalysis?", "url": "https://github.com/prestodb/presto/pull/15101#discussion_r486473319", "createdAt": "2020-09-10T16:22:35Z", "author": {"login": "sujay-jain"}, "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/event/DeterminismAnalysisDetails.java", "diffHunk": "@@ -28,26 +29,41 @@\n import static com.facebook.presto.verifier.framework.LimitQueryDeterminismAnalysis.NOT_RUN;\n import static com.google.common.base.Preconditions.checkState;\n import static com.google.common.collect.ImmutableList.toImmutableList;\n+import static java.util.Objects.requireNonNull;\n \n @Immutable\n @EventType(\"DeterminismAnalysisDetails\")\n public class DeterminismAnalysisDetails\n {\n+    private final DeterminismAnalysis analysis;\n     private final List<DeterminismAnalysisRun> runs;\n     private final String limitQueryAnalysis;\n     private final String limitQueryAnalysisQueryId;\n \n     @JsonCreator\n     public DeterminismAnalysisDetails(\n+            DeterminismAnalysis analysis,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5dd8d162fb154167dcb6f692d84d7a57b40ba999"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ4NTgwNQ==", "bodyText": "done", "url": "https://github.com/prestodb/presto/pull/15101#discussion_r486485805", "createdAt": "2020-09-10T16:42:13Z", "author": {"login": "caithagoras"}, "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/event/DeterminismAnalysisDetails.java", "diffHunk": "@@ -28,26 +29,41 @@\n import static com.facebook.presto.verifier.framework.LimitQueryDeterminismAnalysis.NOT_RUN;\n import static com.google.common.base.Preconditions.checkState;\n import static com.google.common.collect.ImmutableList.toImmutableList;\n+import static java.util.Objects.requireNonNull;\n \n @Immutable\n @EventType(\"DeterminismAnalysisDetails\")\n public class DeterminismAnalysisDetails\n {\n+    private final DeterminismAnalysis analysis;\n     private final List<DeterminismAnalysisRun> runs;\n     private final String limitQueryAnalysis;\n     private final String limitQueryAnalysisQueryId;\n \n     @JsonCreator\n     public DeterminismAnalysisDetails(\n+            DeterminismAnalysis analysis,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ3MzMxOQ=="}, "originalCommit": {"oid": "5dd8d162fb154167dcb6f692d84d7a57b40ba999"}, "originalPosition": 25}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3603, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}