{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE1MzYzMzM0", "number": 14501, "title": "Beinan/druid hdfs bug fixing", "bodyText": "1 Add configuration for hdfs config resources.\n2 Add dependency of fastutil for Druid HDFS file parsing\n3 Support query columns with 'Other' type\n4 Add the problematical file path to the presto exception message\n5 Add presto-druid into presto-product-test config properties\n6 Exclude transitive dependency to fix build error\nTested on viewfs.\n== NO RELEASE NOTE ==", "createdAt": "2020-05-08T18:17:10Z", "url": "https://github.com/prestodb/presto/pull/14501", "merged": true, "mergeCommit": {"oid": "e5226228051da204ac5d8b62f11317d47dc898c8"}, "closed": true, "closedAt": "2020-05-12T22:24:55Z", "author": {"login": "beinan"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfYJYPABqjMzMTgzODU2Njc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgqshVAFqTQxMDQxNTUzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4bfe9902a6c1099a9c340cd4214b275983e912d6", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/4bfe9902a6c1099a9c340cd4214b275983e912d6", "committedDate": "2020-05-08T19:47:36Z", "message": "Add unit test case for druid.hadoop.config.resources"}, "afterCommit": {"oid": "43fbc514f4c9b0ae8d2bd54023697c542d5bb657", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/43fbc514f4c9b0ae8d2bd54023697c542d5bb657", "committedDate": "2020-05-08T20:44:52Z", "message": "Add unit test case for druid.hadoop.config.resources"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA4NjIzMTE5", "url": "https://github.com/prestodb/presto/pull/14501#pullrequestreview-408623119", "createdAt": "2020-05-09T07:39:40Z", "commit": {"oid": "d51ff3998c4a6d870b5ddfb29d06e3b14b6bb6a1"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQwNzozOTo0MVrOGS5NeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wOVQwNzo0NDowMFrOGS5O-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQ2NDg4OA==", "bodyText": "s/hadoopResourceConfigFiles/hadoopConfiguration/g", "url": "https://github.com/prestodb/presto/pull/14501#discussion_r422464888", "createdAt": "2020-05-09T07:39:41Z", "author": {"login": "zhenxiao"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java", "diffHunk": "@@ -15,15 +15,20 @@\n \n import com.facebook.airlift.configuration.Config;\n import com.facebook.airlift.configuration.ConfigDescription;\n+import com.google.common.base.Splitter;\n+import com.google.common.collect.ImmutableList;\n \n import javax.validation.constraints.NotNull;\n \n+import java.util.List;\n+\n public class DruidConfig\n {\n     private String coordinatorUrl;\n     private String brokerUrl;\n     private String schema = \"druid\";\n     private boolean pushdown;\n+    private List<String> hadoopResourceConfigFiles = ImmutableList.of();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d51ff3998c4a6d870b5ddfb29d06e3b14b6bb6a1"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQ2NTAwOQ==", "bodyText": "getHadoopConfiguration", "url": "https://github.com/prestodb/presto/pull/14501#discussion_r422465009", "createdAt": "2020-05-09T07:40:51Z", "author": {"login": "zhenxiao"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidConfig.java", "diffHunk": "@@ -79,4 +84,23 @@ public DruidConfig setComputePushdownEnabled(boolean pushdown)\n         this.pushdown = pushdown;\n         return this;\n     }\n+\n+    @NotNull\n+    public List<String> getHadoopResourceConfigFiles()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d51ff3998c4a6d870b5ddfb29d06e3b14b6bb6a1"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQ2NTExMQ==", "bodyText": "add a comment? what is OTHER?", "url": "https://github.com/prestodb/presto/pull/14501#discussion_r422465111", "createdAt": "2020-05-09T07:42:10Z", "author": {"login": "zhenxiao"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidMetadata.java", "diffHunk": "@@ -147,6 +147,7 @@ private static Type getType(String type)\n     {\n         switch (type.toUpperCase()) {\n             case \"VARCHAR\":\n+            case \"OTHER\":", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c107fce2eee3b71bdba3e158127ba17b807451ec"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQ2NTI3NA==", "bodyText": "why ((String) null)?", "url": "https://github.com/prestodb/presto/pull/14501#discussion_r422465274", "createdAt": "2020-05-09T07:44:00Z", "author": {"login": "zhenxiao"}, "path": "presto-druid/src/test/java/com/facebook/presto/druid/TestDruidConfig.java", "diffHunk": "@@ -28,10 +29,11 @@\n     public void testDefaults()\n     {\n         assertRecordedDefaults(recordDefaults(DruidConfig.class)\n-                    .setDruidBrokerUrl(null)\n-                    .setDruidCoordinatorUrl(null)\n-                    .setDruidSchema(\"druid\")\n-                    .setComputePushdownEnabled(false));\n+                .setDruidBrokerUrl(null)\n+                .setDruidCoordinatorUrl(null)\n+                .setDruidSchema(\"druid\")\n+                .setComputePushdownEnabled(false)\n+                .setHadoopResourceConfigFiles((String) null));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "43fbc514f4c9b0ae8d2bd54023697c542d5bb657"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA5NzQ0MTY3", "url": "https://github.com/prestodb/presto/pull/14501#pullrequestreview-409744167", "createdAt": "2020-05-12T06:49:24Z", "commit": {"oid": "a13b194bc6b0a15aef1209a8238d435762d2a3d0"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwNjo0OToyNVrOGT4WuA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xMlQwNzowMDoyOVrOGT4rDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ5OTQ0OA==", "bodyText": "comment in a new line:\n// hyperUnique, approxHistogram Druid column types", "url": "https://github.com/prestodb/presto/pull/14501#discussion_r423499448", "createdAt": "2020-05-12T06:49:25Z", "author": {"login": "zhenxiao"}, "path": "presto-druid/src/main/java/com/facebook/presto/druid/DruidMetadata.java", "diffHunk": "@@ -147,7 +147,7 @@ private static Type getType(String type)\n     {\n         switch (type.toUpperCase()) {\n             case \"VARCHAR\":\n-            case \"OTHER\":\n+            case \"OTHER\": //May represent various Druid column types such as hyperUnique, approxHistogram, etc", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a13b194bc6b0a15aef1209a8238d435762d2a3d0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzUwNDY1NQ==", "bodyText": "get it. could the following work?\nsetHadoopConfiguration(\"\")", "url": "https://github.com/prestodb/presto/pull/14501#discussion_r423504655", "createdAt": "2020-05-12T07:00:29Z", "author": {"login": "zhenxiao"}, "path": "presto-druid/src/test/java/com/facebook/presto/druid/TestDruidConfig.java", "diffHunk": "@@ -28,10 +29,11 @@\n     public void testDefaults()\n     {\n         assertRecordedDefaults(recordDefaults(DruidConfig.class)\n-                    .setDruidBrokerUrl(null)\n-                    .setDruidCoordinatorUrl(null)\n-                    .setDruidSchema(\"druid\")\n-                    .setComputePushdownEnabled(false));\n+                .setDruidBrokerUrl(null)\n+                .setDruidCoordinatorUrl(null)\n+                .setDruidSchema(\"druid\")\n+                .setComputePushdownEnabled(false)\n+                .setHadoopConfiguration((String) null));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a13b194bc6b0a15aef1209a8238d435762d2a3d0"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "835fa303365e7da065292217fac70eff07294cd9", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/835fa303365e7da065292217fac70eff07294cd9", "committedDate": "2020-05-12T20:51:28Z", "message": "Add configuration for hdfs config resources"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce8ea9c2cae62aaf00ef411981c7d817e5f84c32", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/ce8ea9c2cae62aaf00ef411981c7d817e5f84c32", "committedDate": "2020-05-12T20:51:28Z", "message": "Add dependency of fastutil for Druid HDFS file parsing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd535343b9d84cbe512b899971d0296c402b597e", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/cd535343b9d84cbe512b899971d0296c402b597e", "committedDate": "2020-05-12T20:51:29Z", "message": "Support query columns with 'Other' type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1334a916c2bae31f4626182473f4456159c72c13", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/1334a916c2bae31f4626182473f4456159c72c13", "committedDate": "2020-05-12T20:51:29Z", "message": "Add the problematical file path to the presto exception message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e5fe890db17868ae059fc6532cb7d6ea699ed29", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/8e5fe890db17868ae059fc6532cb7d6ea699ed29", "committedDate": "2020-05-12T20:51:29Z", "message": "Add presto-druid into presto-product-test config properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "40d04a9676da777ae47046c620608d0c4b7309e1", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/40d04a9676da777ae47046c620608d0c4b7309e1", "committedDate": "2020-05-12T20:51:30Z", "message": "Exclude transitive dependency to fix build error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8448d4b9da39713ab398aab613de4cc61f6da258", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/8448d4b9da39713ab398aab613de4cc61f6da258", "committedDate": "2020-05-12T20:51:30Z", "message": "Add unit test case for druid.hadoop.config.resources"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ba1e98309fa56c8bc9d0dfab6014c1b33f041fd", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/8ba1e98309fa56c8bc9d0dfab6014c1b33f041fd", "committedDate": "2020-05-12T20:51:30Z", "message": "Refactoring and fixing code review issues"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a13b194bc6b0a15aef1209a8238d435762d2a3d0", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/a13b194bc6b0a15aef1209a8238d435762d2a3d0", "committedDate": "2020-05-12T05:49:15Z", "message": "Refactoring and fixing code review issues"}, "afterCommit": {"oid": "8ba1e98309fa56c8bc9d0dfab6014c1b33f041fd", "author": {"user": {"login": "beinan", "name": "Beinan"}}, "url": "https://github.com/prestodb/presto/commit/8ba1e98309fa56c8bc9d0dfab6014c1b33f041fd", "committedDate": "2020-05-12T20:51:30Z", "message": "Refactoring and fixing code review issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwNDE1NTMy", "url": "https://github.com/prestodb/presto/pull/14501#pullrequestreview-410415532", "createdAt": "2020-05-12T20:56:18Z", "commit": {"oid": "8ba1e98309fa56c8bc9d0dfab6014c1b33f041fd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1604, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}