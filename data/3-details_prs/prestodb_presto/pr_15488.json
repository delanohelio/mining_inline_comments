{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwMzc4NzA3", "number": 15488, "title": "Load function managers for Presto-on-Spark driver only", "bodyText": "When inline sql function is enabled, no need to load\nfunction managers for executors.\nIssue\n\nLoading function managers for PoS executor is not free,  reliability issue such as transportation error is observed when fetching client certificate\n\nTest plan\n\nBuild a package and query succeeds 20201130_212659_00000_ts7k9 when inline sql function is enabled.\n\n== NO RELEASE NOTE ==", "createdAt": "2020-12-01T15:19:17Z", "url": "https://github.com/prestodb/presto/pull/15488", "merged": true, "mergeCommit": {"oid": "b2c7ab82fe10cf9103d7239897a448fada15f22a"}, "closed": true, "closedAt": "2020-12-04T00:41:54Z", "author": {"login": "viczhang861"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdh81XoABqjQwNTgyMDM1MzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdiFTZFABqjQwNjAxMzgxMDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e3bf1f60b89d12a3ed80f5cfdb70436fd857aa7", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/7e3bf1f60b89d12a3ed80f5cfdb70436fd857aa7", "committedDate": "2020-12-01T15:13:38Z", "message": "Load function managers for Presto-on-Spark driver only\n\nWhen inline sql function is enabled, no need to load\nfunction managers for executors."}, "afterCommit": {"oid": "c8a57542386a42e1d7ba73bda92d7e1abd8dd7aa", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/c8a57542386a42e1d7ba73bda92d7e1abd8dd7aa", "committedDate": "2020-12-01T16:49:02Z", "message": "Load function managers for Presto-on-Spark driver only\n\nWhen inline sql function is enabled, no need to load\nfunction managers for executors."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c8a57542386a42e1d7ba73bda92d7e1abd8dd7aa", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/c8a57542386a42e1d7ba73bda92d7e1abd8dd7aa", "committedDate": "2020-12-01T16:49:02Z", "message": "Load function managers for Presto-on-Spark driver only\n\nWhen inline sql function is enabled, no need to load\nfunction managers for executors."}, "afterCommit": {"oid": "65263e363422e5eb8e79ec8eec47732e0ad9c082", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/65263e363422e5eb8e79ec8eec47732e0ad9c082", "committedDate": "2020-12-01T17:09:15Z", "message": "Load function managers for Presto-on-Spark driver only\n\nWhen inline sql function is enabled, no need to load\nfunction managers for executors."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyMzU0MTk4", "url": "https://github.com/prestodb/presto/pull/15488#pullrequestreview-542354198", "createdAt": "2020-12-01T22:35:18Z", "commit": {"oid": "65263e363422e5eb8e79ec8eec47732e0ad9c082"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMjozNToxOFrOH9ClUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQyMjozNToxOFrOH9ClUQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzc2NzUwNQ==", "bodyText": "You can get an instance of a configuration class by using injector.getInstance(...)", "url": "https://github.com/prestodb/presto/pull/15488#discussion_r533767505", "createdAt": "2020-12-01T22:35:18Z", "author": {"login": "arhimondr"}, "path": "presto-spark-base/src/main/java/com/facebook/presto/spark/PrestoSparkInjectorFactory.java", "diffHunk": "@@ -189,6 +184,16 @@ public Injector create()\n                     injector.getInstance(SessionPropertyDefaults.class).loadConfigurationManager();\n                 }\n             }\n+\n+            if (sparkProcessType.equals(DRIVER) ||\n+                    configProperties.getOrDefault(INLINE_SQL_FUNCTIONS, \"true\").equals(\"false\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "65263e363422e5eb8e79ec8eec47732e0ad9c082"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1bb2e5ede48bfee7fe4cbae205e3c47d9f489107", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/1bb2e5ede48bfee7fe4cbae205e3c47d9f489107", "committedDate": "2020-12-02T02:39:33Z", "message": "Load function managers for Presto-on-Spark driver only\n\nWhen inline sql function is enabled, no need to load\nfunction managers for executors."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "65263e363422e5eb8e79ec8eec47732e0ad9c082", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/65263e363422e5eb8e79ec8eec47732e0ad9c082", "committedDate": "2020-12-01T17:09:15Z", "message": "Load function managers for Presto-on-Spark driver only\n\nWhen inline sql function is enabled, no need to load\nfunction managers for executors."}, "afterCommit": {"oid": "1bb2e5ede48bfee7fe4cbae205e3c47d9f489107", "author": {"user": {"login": "viczhang861", "name": "Vic Zhang"}}, "url": "https://github.com/prestodb/presto/commit/1bb2e5ede48bfee7fe4cbae205e3c47d9f489107", "committedDate": "2020-12-02T02:39:33Z", "message": "Load function managers for Presto-on-Spark driver only\n\nWhen inline sql function is enabled, no need to load\nfunction managers for executors."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4784, "cost": 1, "resetAt": "2021-10-28T20:13:43Z"}}}