{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3NTk4MTI0", "number": 14605, "title": "Export additional fields in VerifierQueryEvents", "bodyText": "== RELEASE NOTES ==\n\nVerifier Changes\n* Add control query IDs, test query IDs, and peak total memory to verification outputs.", "createdAt": "2020-06-04T05:28:15Z", "url": "https://github.com/prestodb/presto/pull/14605", "merged": true, "mergeCommit": {"oid": "4289044f3549569df42300fe5995501895e44d6e"}, "closed": true, "closedAt": "2020-06-05T20:02:41Z", "author": {"login": "caithagoras"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoCy89gBqjM0MDgyODYyNzc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoK_C9ABqjM0MDk2Mjk3Mzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "00f26b8765230aea676f284bb25e45f9764b47d3", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/00f26b8765230aea676f284bb25e45f9764b47d3", "committedDate": "2020-06-04T05:26:54Z", "message": "Collect and expose setup and teardown query IDs"}, "afterCommit": {"oid": "0407e4a72bd110f1e26771f571852fe700753028", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/0407e4a72bd110f1e26771f571852fe700753028", "committedDate": "2020-06-04T18:58:22Z", "message": "Collect and expose setup and teardown query IDs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0407e4a72bd110f1e26771f571852fe700753028", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/0407e4a72bd110f1e26771f571852fe700753028", "committedDate": "2020-06-04T18:58:22Z", "message": "Collect and expose setup and teardown query IDs"}, "afterCommit": {"oid": "2a9d5d51aefe2ed77c0ed0cce0394f0f8156f13b", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/2a9d5d51aefe2ed77c0ed0cce0394f0f8156f13b", "committedDate": "2020-06-04T19:45:07Z", "message": "Collect and expose setup and teardown query IDs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a9d5d51aefe2ed77c0ed0cce0394f0f8156f13b", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/2a9d5d51aefe2ed77c0ed0cce0394f0f8156f13b", "committedDate": "2020-06-04T19:45:07Z", "message": "Collect and expose setup and teardown query IDs"}, "afterCommit": {"oid": "b1a1bfaf3ac1413055b9b66476b1d9a3583526b5", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/b1a1bfaf3ac1413055b9b66476b1d9a3583526b5", "committedDate": "2020-06-04T23:19:21Z", "message": "Export peakTotalMemoryBytes in VerifierQueryEvent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b1a1bfaf3ac1413055b9b66476b1d9a3583526b5", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/b1a1bfaf3ac1413055b9b66476b1d9a3583526b5", "committedDate": "2020-06-04T23:19:21Z", "message": "Export peakTotalMemoryBytes in VerifierQueryEvent"}, "afterCommit": {"oid": "46d1ed9e765f5b01286d210608fa0140dfd19894", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/46d1ed9e765f5b01286d210608fa0140dfd19894", "committedDate": "2020-06-05T00:25:58Z", "message": "Export peakTotalMemoryBytes in VerifierQueryEvent"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0OTI1OTU3", "url": "https://github.com/prestodb/presto/pull/14605#pullrequestreview-424925957", "createdAt": "2020-06-05T00:40:12Z", "commit": {"oid": "fe71c1586a95493104b4886a8cff873d11300a47"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDo0MDoxMlrOGfcyjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNVQwMDo0MDoxMlrOGfcyjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTYzMDczNA==", "bodyText": "is this the right check?", "url": "https://github.com/prestodb/presto/pull/14605#discussion_r435630734", "createdAt": "2020-06-05T00:40:12Z", "author": {"login": "mbasmanova"}, "path": "presto-verifier/src/main/java/com/facebook/presto/verifier/event/DeterminismAnalysisRun.java", "diffHunk": "@@ -85,6 +107,20 @@ public Builder setQueryId(String queryId)\n             return this;\n         }\n \n+        public Builder addSetupQueryId(String queryId)\n+        {\n+            checkState(!this.queryId.isPresent(), \"queryId is already set\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe71c1586a95493104b4886a8cff873d11300a47"}, "originalPosition": 68}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46d1ed9e765f5b01286d210608fa0140dfd19894", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/46d1ed9e765f5b01286d210608fa0140dfd19894", "committedDate": "2020-06-05T00:25:58Z", "message": "Export peakTotalMemoryBytes in VerifierQueryEvent"}, "afterCommit": {"oid": "5961e7c089941233ce9f0d9ef33506ea12a863e4", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/5961e7c089941233ce9f0d9ef33506ea12a863e4", "committedDate": "2020-06-05T01:15:00Z", "message": "Export peakTotalMemoryBytes in VerifierQueryEvent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a1fa32b5322df92300fa5caec560472130b45e7", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/4a1fa32b5322df92300fa5caec560472130b45e7", "committedDate": "2020-06-05T04:30:50Z", "message": "Collect and export setup and teardown query IDs in VerifierQueryEvent\n\nThe query IDs are collected once a query ID is received by the JDBC\nclient, not matter if the query succeeds or fails.\n\nPreviously, we're running teardown queries in a finally block after\nVerifierQueryEvent is generated. We need to change that order in\norder to export the IDs in the event.\n\nAlso, export setup query IDs and teardown query IDs for determinism\nanalysis, in determinism_analysis_details."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c346a862ac172c5a3c135ddd1a084146ea7c1b95", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/c346a862ac172c5a3c135ddd1a084146ea7c1b95", "committedDate": "2020-06-05T04:30:50Z", "message": "Export peakTotalMemoryBytes in VerifierQueryEvent"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5961e7c089941233ce9f0d9ef33506ea12a863e4", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/5961e7c089941233ce9f0d9ef33506ea12a863e4", "committedDate": "2020-06-05T01:15:00Z", "message": "Export peakTotalMemoryBytes in VerifierQueryEvent"}, "afterCommit": {"oid": "c346a862ac172c5a3c135ddd1a084146ea7c1b95", "author": {"user": {"login": "caithagoras", "name": "Leiqing Cai"}}, "url": "https://github.com/prestodb/presto/commit/c346a862ac172c5a3c135ddd1a084146ea7c1b95", "committedDate": "2020-06-05T04:30:50Z", "message": "Export peakTotalMemoryBytes in VerifierQueryEvent"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1754, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}