{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyMTAxMDI3", "number": 15372, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMToyODozOFrOE1Z0oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMToyOTowOFrOE1Z1NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NDMzMDU3OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveDistributedJoinQueriesWithDynamicFilteringAndFilterPushdown.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMToyODozOFrOHtqViQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMToyODozOFrOHtqViQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY0MTYwOQ==", "bodyText": "Could you make the body of the SQL more readable?\nSELECT * FROM\nlineitem l1 LEFT OUTER JOIN part p1\nON l1.orderkey = p1.partkey AND p1.size = 47\nINNER JOIN orders o1 ON l1.orderkey = o1.orderkey\nAND o1.custkey = 397\nLEFT OUTER JOIN part p2\nON p1.name = p2.name AND p1.partkey = p2.partkey\nWHERE o1.shippriority = 0", "url": "https://github.com/prestodb/presto/pull/15372#discussion_r517641609", "createdAt": "2020-11-04T21:28:38Z", "author": {"login": "highker"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveDistributedJoinQueriesWithDynamicFilteringAndFilterPushdown.java", "diffHunk": "@@ -43,4 +44,35 @@ protected Session getSession()\n                 .setCatalogSessionProperty(HIVE_CATALOG, PUSHDOWN_FILTER_ENABLED, \"true\")\n                 .build();\n     }\n+\n+    @Test\n+    // Mixed join could produce conjunction dynamic filters, we should be able to extract them out when integrating with filter pushdown\n+    // In this query, it will produce:\n+    // AND (($internal$dynamic_filter_function(VARCHAR 263, partkey)) OR (IS_NULL(partkey))))\n+    public void testMixedJoin()\n+    {\n+        assertQuery(\"SELECT\\n\" +\n+                \"*\\n\" +\n+                \"FROM (\\n\" +\n+                \"(\\n\" +\n+                \"(\\n\" +\n+                \"lineitem l1\\n\" +\n+                \"LEFT OUTER JOIN part p1\\n\" +\n+                \"ON (\\n\" +\n+                \"l1.orderkey = p1.partkey AND p1.size = 47\\n\" +\n+                \")\\n\" +\n+                \")\\n\" +\n+                \"INNER JOIN orders o1\\n\" +\n+                \"ON (\\n\" +\n+                \"l1.orderkey = o1.orderkey AND o1.custkey = 397\\n\" +\n+                \")\\n\" +\n+                \")\\n\" +\n+                \"LEFT OUTER JOIN part p2\\n\" +\n+                \"ON (\\n\" +\n+                \"p1.name = p2.name AND p1.partkey = p2.partkey\\n\" +\n+                \")\\n\" +\n+                \")\\n\" +\n+                \"WHERE\\n\" +\n+                \"o1.shippriority = 0\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58d1ef99a044c7b176fa871529bb9650528f93db"}, "originalPosition": 41}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NDMzMTMxOnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveDistributedJoinQueriesWithDynamicFilteringAndFilterPushdown.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMToyODo1MVrOHtqWAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMToyODo1MVrOHtqWAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY0MTcyOA==", "bodyText": "remove these two lines", "url": "https://github.com/prestodb/presto/pull/15372#discussion_r517641728", "createdAt": "2020-11-04T21:28:51Z", "author": {"login": "highker"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveDistributedJoinQueriesWithDynamicFilteringAndFilterPushdown.java", "diffHunk": "@@ -43,4 +44,35 @@ protected Session getSession()\n                 .setCatalogSessionProperty(HIVE_CATALOG, PUSHDOWN_FILTER_ENABLED, \"true\")\n                 .build();\n     }\n+\n+    @Test\n+    // Mixed join could produce conjunction dynamic filters, we should be able to extract them out when integrating with filter pushdown\n+    // In this query, it will produce:\n+    // AND (($internal$dynamic_filter_function(VARCHAR 263, partkey)) OR (IS_NULL(partkey))))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58d1ef99a044c7b176fa871529bb9650528f93db"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI0NDMzMjA0OnYy", "diffSide": "RIGHT", "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveDistributedJoinQueriesWithDynamicFilteringAndFilterPushdown.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMToyOTowOFrOHtqWfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNFQyMToyOTowOFrOHtqWfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzY0MTg1Mg==", "bodyText": "move this comment to the body of the test", "url": "https://github.com/prestodb/presto/pull/15372#discussion_r517641852", "createdAt": "2020-11-04T21:29:08Z", "author": {"login": "highker"}, "path": "presto-hive/src/test/java/com/facebook/presto/hive/TestHiveDistributedJoinQueriesWithDynamicFilteringAndFilterPushdown.java", "diffHunk": "@@ -43,4 +44,35 @@ protected Session getSession()\n                 .setCatalogSessionProperty(HIVE_CATALOG, PUSHDOWN_FILTER_ENABLED, \"true\")\n                 .build();\n     }\n+\n+    @Test\n+    // Mixed join could produce conjunction dynamic filters, we should be able to extract them out when integrating with filter pushdown", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58d1ef99a044c7b176fa871529bb9650528f93db"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3349, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}