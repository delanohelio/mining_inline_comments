{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NTM2NTMx", "number": 14836, "title": "Implement ORDER BY spilling", "bodyText": "PrestoSQL PR trinodb/trino#228\nTODO\n\nAdd docs for ORDER BY spilling\n\n== RELEASE NOTES ==\n\nGeneral Changes\n* Add local disk spilling support for `ORDER BY` syntax.", "createdAt": "2020-07-13T22:39:07Z", "url": "https://github.com/prestodb/presto/pull/14836", "merged": true, "mergeCommit": {"oid": "392ec928df28d9a9122db4b2597234b1f1c051dc"}, "closed": true, "closedAt": "2020-07-24T08:04:35Z", "author": {"login": "sachdevs"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0qESBABqjM1NDE2Nzg1ODE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc32mRyAFqTQ1NDUxODk5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "498cf42d82f4949b1c36e13bf0c1c0fa1f7c785b", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/498cf42d82f4949b1c36e13bf0c1c0fa1f7c785b", "committedDate": "2020-07-13T22:37:44Z", "message": "Extract order by queries tests to separate class\nCherry-pick of https://github.com/prestosql/presto/commit/94b4d0a42f8c86b95b6c3664c5cd83b6eab7297a Co-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}, "afterCommit": {"oid": "b5ba14420f8299181c88925d5caf9465567ff99a", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/b5ba14420f8299181c88925d5caf9465567ff99a", "committedDate": "2020-07-13T23:30:31Z", "message": "Extract order by queries tests to separate class\nCherry-pick of https://github.com/prestosql/presto/commit/94b4d0a42f8c86b95b6c3664c5cd83b6eab7297a Co-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b5ba14420f8299181c88925d5caf9465567ff99a", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/b5ba14420f8299181c88925d5caf9465567ff99a", "committedDate": "2020-07-13T23:30:31Z", "message": "Extract order by queries tests to separate class\nCherry-pick of https://github.com/prestosql/presto/commit/94b4d0a42f8c86b95b6c3664c5cd83b6eab7297a Co-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}, "afterCommit": {"oid": "fbb49765c6ebb152726b14dffb7acaebfe5156a4", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/fbb49765c6ebb152726b14dffb7acaebfe5156a4", "committedDate": "2020-07-13T23:31:11Z", "message": "Extract order by queries tests to separate class\nCherry-pick of https://github.com/prestosql/presto/commit/94b4d0a42f8c86b95b6c3664c5cd83b6eab7297a Co-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxMDI1MzE4", "url": "https://github.com/prestodb/presto/pull/14836#pullrequestreview-451025318", "createdAt": "2020-07-18T02:49:39Z", "commit": {"oid": "2d0a5a40091558f28ccaf42304aeccf0cc88a342"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMjo0OTo0MFrOGzlLDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xOFQwMzowNDoyOFrOGzlPeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjczOTU5OA==", "bodyText": "The entire commit \"Add feature toggle for ORDER BY spill\" doesn't seem to be necessary given the existing join spilling is buggy. So the legacy spilling doesn't work anyway. No need to use another guard.", "url": "https://github.com/prestodb/presto/pull/14836#discussion_r456739598", "createdAt": "2020-07-18T02:49:40Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/SystemSessionProperties.java", "diffHunk": "@@ -113,6 +113,7 @@\n     public static final String FAST_INEQUALITY_JOINS = \"fast_inequality_joins\";\n     public static final String QUERY_PRIORITY = \"query_priority\";\n     public static final String SPILL_ENABLED = \"spill_enabled\";\n+    public static final String SPILL_ORDER_BY = \"spill_order_by\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2d0a5a40091558f28ccaf42304aeccf0cc88a342"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDcxMw==", "bodyText": "i++", "url": "https://github.com/prestodb/presto/pull/14836#discussion_r456740713", "createdAt": "2020-07-18T03:03:57Z", "author": {"login": "highker"}, "path": "presto-main/src/test/java/com/facebook/presto/operator/TestOrderByOperator.java", "diffHunk": "@@ -41,44 +43,91 @@\n import static com.facebook.presto.common.type.DoubleType.DOUBLE;\n import static com.facebook.presto.common.type.VarcharType.VARCHAR;\n import static com.facebook.presto.operator.OperatorAssertion.assertOperatorEquals;\n+import static com.facebook.presto.operator.OperatorAssertion.toMaterializedResult;\n import static com.facebook.presto.operator.OperatorAssertion.toPages;\n import static com.facebook.presto.testing.MaterializedResult.resultBuilder;\n import static com.facebook.presto.testing.TestingTaskContext.createTaskContext;\n+import static io.airlift.units.DataSize.succinctBytes;\n+import static java.lang.String.format;\n import static java.util.concurrent.Executors.newCachedThreadPool;\n import static java.util.concurrent.Executors.newScheduledThreadPool;\n+import static org.testng.Assert.assertEquals;\n+import static org.testng.Assert.assertTrue;\n \n @Test(singleThreaded = true)\n public class TestOrderByOperator\n {\n     private ExecutorService executor;\n     private ScheduledExecutorService scheduledExecutor;\n-    private DriverContext driverContext;\n+    private DummySpillerFactory spillerFactory;\n \n     @DataProvider\n     public static Object[][] spillEnabled()\n     {\n-        return new Object[][] {{false}, {true}};\n+        return new Object[][] {\n+                {false, false, 0},\n+                {true, false, 8},\n+                {true, true, 8},\n+                {true, false, 0},\n+                {true, true, 0}};\n     }\n \n     @BeforeMethod\n     public void setUp()\n     {\n         executor = newCachedThreadPool(daemonThreadsNamed(\"test-executor-%s\"));\n         scheduledExecutor = newScheduledThreadPool(2, daemonThreadsNamed(\"test-scheduledExecutor-%s\"));\n-        driverContext = createTaskContext(executor, scheduledExecutor, TEST_SESSION)\n-                .addPipelineContext(0, true, true, false)\n-                .addDriverContext();\n+        spillerFactory = new DummySpillerFactory();\n     }\n \n     @AfterMethod\n     public void tearDown()\n     {\n         executor.shutdownNow();\n         scheduledExecutor.shutdownNow();\n+        spillerFactory = null;\n     }\n \n     @Test(dataProvider = \"spillEnabled\")\n-    public void testSingleFieldKey(boolean spillEnabled)\n+    public void testMultipleOutputPages(boolean spillEnabled, boolean revokeMemoryWhenAddingPages, long memoryLimit)\n+    {\n+        // make operator produce multiple pages during finish phase\n+        int numberOfRows = 80_000;\n+        List<Page> input = rowPagesBuilder(BIGINT, DOUBLE)\n+                .addSequencePage(numberOfRows, 0, 0)\n+                .build();\n+\n+        OrderByOperatorFactory operatorFactory = new OrderByOperatorFactory(\n+                0,\n+                new PlanNodeId(\"test\"),\n+                ImmutableList.of(BIGINT, DOUBLE),\n+                ImmutableList.of(1),\n+                10,\n+                ImmutableList.of(0),\n+                ImmutableList.of(DESC_NULLS_LAST),\n+                new PagesIndex.TestingFactory(false),\n+                spillEnabled,\n+                Optional.of(spillerFactory),\n+                new OrderingCompiler());\n+\n+        DriverContext driverContext = createDriverContext(memoryLimit);\n+        MaterializedResult.Builder expectedBuilder = resultBuilder(driverContext.getSession(), DOUBLE);\n+        for (int i = 0; i < numberOfRows; ++i) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44e5153db0cb439a59bd483774022a418990fef8"}, "originalPosition": 95}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njc0MDcyOA==", "bodyText": "assertEquals", "url": "https://github.com/prestodb/presto/pull/14836#discussion_r456740728", "createdAt": "2020-07-18T03:04:28Z", "author": {"login": "highker"}, "path": "presto-main/src/test/java/com/facebook/presto/operator/TestOrderByOperator.java", "diffHunk": "@@ -41,44 +43,91 @@\n import static com.facebook.presto.common.type.DoubleType.DOUBLE;\n import static com.facebook.presto.common.type.VarcharType.VARCHAR;\n import static com.facebook.presto.operator.OperatorAssertion.assertOperatorEquals;\n+import static com.facebook.presto.operator.OperatorAssertion.toMaterializedResult;\n import static com.facebook.presto.operator.OperatorAssertion.toPages;\n import static com.facebook.presto.testing.MaterializedResult.resultBuilder;\n import static com.facebook.presto.testing.TestingTaskContext.createTaskContext;\n+import static io.airlift.units.DataSize.succinctBytes;\n+import static java.lang.String.format;\n import static java.util.concurrent.Executors.newCachedThreadPool;\n import static java.util.concurrent.Executors.newScheduledThreadPool;\n+import static org.testng.Assert.assertEquals;\n+import static org.testng.Assert.assertTrue;\n \n @Test(singleThreaded = true)\n public class TestOrderByOperator\n {\n     private ExecutorService executor;\n     private ScheduledExecutorService scheduledExecutor;\n-    private DriverContext driverContext;\n+    private DummySpillerFactory spillerFactory;\n \n     @DataProvider\n     public static Object[][] spillEnabled()\n     {\n-        return new Object[][] {{false}, {true}};\n+        return new Object[][] {\n+                {false, false, 0},\n+                {true, false, 8},\n+                {true, true, 8},\n+                {true, false, 0},\n+                {true, true, 0}};\n     }\n \n     @BeforeMethod\n     public void setUp()\n     {\n         executor = newCachedThreadPool(daemonThreadsNamed(\"test-executor-%s\"));\n         scheduledExecutor = newScheduledThreadPool(2, daemonThreadsNamed(\"test-scheduledExecutor-%s\"));\n-        driverContext = createTaskContext(executor, scheduledExecutor, TEST_SESSION)\n-                .addPipelineContext(0, true, true, false)\n-                .addDriverContext();\n+        spillerFactory = new DummySpillerFactory();\n     }\n \n     @AfterMethod\n     public void tearDown()\n     {\n         executor.shutdownNow();\n         scheduledExecutor.shutdownNow();\n+        spillerFactory = null;\n     }\n \n     @Test(dataProvider = \"spillEnabled\")\n-    public void testSingleFieldKey(boolean spillEnabled)\n+    public void testMultipleOutputPages(boolean spillEnabled, boolean revokeMemoryWhenAddingPages, long memoryLimit)\n+    {\n+        // make operator produce multiple pages during finish phase\n+        int numberOfRows = 80_000;\n+        List<Page> input = rowPagesBuilder(BIGINT, DOUBLE)\n+                .addSequencePage(numberOfRows, 0, 0)\n+                .build();\n+\n+        OrderByOperatorFactory operatorFactory = new OrderByOperatorFactory(\n+                0,\n+                new PlanNodeId(\"test\"),\n+                ImmutableList.of(BIGINT, DOUBLE),\n+                ImmutableList.of(1),\n+                10,\n+                ImmutableList.of(0),\n+                ImmutableList.of(DESC_NULLS_LAST),\n+                new PagesIndex.TestingFactory(false),\n+                spillEnabled,\n+                Optional.of(spillerFactory),\n+                new OrderingCompiler());\n+\n+        DriverContext driverContext = createDriverContext(memoryLimit);\n+        MaterializedResult.Builder expectedBuilder = resultBuilder(driverContext.getSession(), DOUBLE);\n+        for (int i = 0; i < numberOfRows; ++i) {\n+            expectedBuilder.row((double) numberOfRows - i - 1);\n+        }\n+        MaterializedResult expected = expectedBuilder.build();\n+\n+        List<Page> pages = toPages(operatorFactory, driverContext, input, revokeMemoryWhenAddingPages);\n+        assertGreaterThan(pages.size(), 1, \"Expected more than one output page\");\n+\n+        MaterializedResult actual = toMaterializedResult(driverContext.getSession(), expected.getTypes(), pages);\n+        assertEquals(actual.getMaterializedRows(), expected.getMaterializedRows());\n+\n+        assertTrue(spillEnabled == (spillerFactory.getSpillsCount() > 0), format(\"Spill state mismatch. Expected spill: %s, spill count: %s\", spillEnabled, spillerFactory.getSpillsCount()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44e5153db0cb439a59bd483774022a418990fef8"}, "originalPosition": 106}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fbb49765c6ebb152726b14dffb7acaebfe5156a4", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/fbb49765c6ebb152726b14dffb7acaebfe5156a4", "committedDate": "2020-07-13T23:31:11Z", "message": "Extract order by queries tests to separate class\nCherry-pick of https://github.com/prestosql/presto/commit/94b4d0a42f8c86b95b6c3664c5cd83b6eab7297a Co-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}, "afterCommit": {"oid": "155efc31477748123999c3f5ad261314ffce30e5", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/155efc31477748123999c3f5ad261314ffce30e5", "committedDate": "2020-07-22T21:32:42Z", "message": "Extract order by queries tests to separate class\nCherry-pick of https://github.com/prestosql/presto/commit/94b4d0a42f8c86b95b6c3664c5cd83b6eab7297a Co-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "155efc31477748123999c3f5ad261314ffce30e5", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/155efc31477748123999c3f5ad261314ffce30e5", "committedDate": "2020-07-22T21:32:42Z", "message": "Extract order by queries tests to separate class\nCherry-pick of https://github.com/prestosql/presto/commit/94b4d0a42f8c86b95b6c3664c5cd83b6eab7297a Co-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}, "afterCommit": {"oid": "11e84aeaead1aa8dff19b467deebe952cfdefdc5", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/11e84aeaead1aa8dff19b467deebe952cfdefdc5", "committedDate": "2020-07-22T21:38:57Z", "message": "Extract order by queries tests to separate class\n\nCherry-pick of https://github.com/prestosql/presto/commit/94b4d0a42f8c86b95b6c3664c5cd83b6eab7297a\n\nCo-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNzI0Mzg3", "url": "https://github.com/prestodb/presto/pull/14836#pullrequestreview-453724387", "createdAt": "2020-07-22T22:18:12Z", "commit": {"oid": "216455e336e1490d68346f58dc97dc0de8297acf"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMjoxODoxMlrOG12Lgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMlQyMjoyMTowOFrOG12Qhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTExNTM5NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    assertEquals(spillEnabled, spillerFactory.getSpillsCount() > 0, format(\"Spill state mismatch. Expected spill: %s, spill count: %s\", spillEnabled, spillerFactory.getSpillsCount()))\n          \n          \n            \n                    ;\n          \n          \n            \n                    assertEquals(spillEnabled, spillerFactory.getSpillsCount() > 0, format(\"Spill state mismatch. Expected spill: %s, spill count: %s\", spillEnabled, spillerFactory.getSpillsCount()));", "url": "https://github.com/prestodb/presto/pull/14836#discussion_r459115395", "createdAt": "2020-07-22T22:18:12Z", "author": {"login": "tdcmeehan"}, "path": "presto-main/src/test/java/com/facebook/presto/operator/TestOrderByOperator.java", "diffHunk": "@@ -41,44 +43,91 @@\n import static com.facebook.presto.common.type.DoubleType.DOUBLE;\n import static com.facebook.presto.common.type.VarcharType.VARCHAR;\n import static com.facebook.presto.operator.OperatorAssertion.assertOperatorEquals;\n+import static com.facebook.presto.operator.OperatorAssertion.toMaterializedResult;\n import static com.facebook.presto.operator.OperatorAssertion.toPages;\n import static com.facebook.presto.testing.MaterializedResult.resultBuilder;\n import static com.facebook.presto.testing.TestingTaskContext.createTaskContext;\n+import static io.airlift.units.DataSize.succinctBytes;\n+import static java.lang.String.format;\n import static java.util.concurrent.Executors.newCachedThreadPool;\n import static java.util.concurrent.Executors.newScheduledThreadPool;\n+import static org.testng.Assert.assertEquals;\n \n @Test(singleThreaded = true)\n public class TestOrderByOperator\n {\n     private ExecutorService executor;\n     private ScheduledExecutorService scheduledExecutor;\n-    private DriverContext driverContext;\n+    private DummySpillerFactory spillerFactory;\n \n     @DataProvider\n     public static Object[][] spillEnabled()\n     {\n-        return new Object[][] {{false}, {true}};\n+        return new Object[][] {\n+                {false, false, 0},\n+                {true, false, 8},\n+                {true, true, 8},\n+                {true, false, 0},\n+                {true, true, 0}};\n     }\n \n     @BeforeMethod\n     public void setUp()\n     {\n         executor = newCachedThreadPool(daemonThreadsNamed(\"test-executor-%s\"));\n         scheduledExecutor = newScheduledThreadPool(2, daemonThreadsNamed(\"test-scheduledExecutor-%s\"));\n-        driverContext = createTaskContext(executor, scheduledExecutor, TEST_SESSION)\n-                .addPipelineContext(0, true, true, false)\n-                .addDriverContext();\n+        spillerFactory = new DummySpillerFactory();\n     }\n \n     @AfterMethod\n     public void tearDown()\n     {\n         executor.shutdownNow();\n         scheduledExecutor.shutdownNow();\n+        spillerFactory = null;\n     }\n \n     @Test(dataProvider = \"spillEnabled\")\n-    public void testSingleFieldKey(boolean spillEnabled)\n+    public void testMultipleOutputPages(boolean spillEnabled, boolean revokeMemoryWhenAddingPages, long memoryLimit)\n+    {\n+        // make operator produce multiple pages during finish phase\n+        int numberOfRows = 80_000;\n+        List<Page> input = rowPagesBuilder(BIGINT, DOUBLE)\n+                .addSequencePage(numberOfRows, 0, 0)\n+                .build();\n+\n+        OrderByOperatorFactory operatorFactory = new OrderByOperatorFactory(\n+                0,\n+                new PlanNodeId(\"test\"),\n+                ImmutableList.of(BIGINT, DOUBLE),\n+                ImmutableList.of(1),\n+                10,\n+                ImmutableList.of(0),\n+                ImmutableList.of(DESC_NULLS_LAST),\n+                new PagesIndex.TestingFactory(false),\n+                spillEnabled,\n+                Optional.of(spillerFactory),\n+                new OrderingCompiler());\n+\n+        DriverContext driverContext = createDriverContext(memoryLimit);\n+        MaterializedResult.Builder expectedBuilder = resultBuilder(driverContext.getSession(), DOUBLE);\n+        for (int i = 0; i < numberOfRows; i++) {\n+            expectedBuilder.row((double) numberOfRows - i - 1);\n+        }\n+        MaterializedResult expected = expectedBuilder.build();\n+\n+        List<Page> pages = toPages(operatorFactory, driverContext, input, revokeMemoryWhenAddingPages);\n+        assertGreaterThan(pages.size(), 1, \"Expected more than one output page\");\n+\n+        MaterializedResult actual = toMaterializedResult(driverContext.getSession(), expected.getTypes(), pages);\n+        assertEquals(actual.getMaterializedRows(), expected.getMaterializedRows());\n+\n+        assertEquals(spillEnabled, spillerFactory.getSpillsCount() > 0, format(\"Spill state mismatch. Expected spill: %s, spill count: %s\", spillEnabled, spillerFactory.getSpillsCount()))\n+        ;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "216455e336e1490d68346f58dc97dc0de8297acf"}, "originalPosition": 106}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTExNjY3OQ==", "bodyText": "Should this be squashed with Add Spill To Disk for ORDER BY?", "url": "https://github.com/prestodb/presto/pull/14836#discussion_r459116679", "createdAt": "2020-07-22T22:21:08Z", "author": {"login": "tdcmeehan"}, "path": "presto-main/src/main/java/com/facebook/presto/operator/OrderByOperator.java", "diffHunk": "@@ -380,5 +380,6 @@ public void close()\n     {\n         pageIndex.clear();\n         sortedPages = null;\n+        spiller.ifPresent(Spiller::close);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3fff9b1e02e40327099ca1d4e6882870993218a7"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNzY0MTk2", "url": "https://github.com/prestodb/presto/pull/14836#pullrequestreview-453764196", "createdAt": "2020-07-23T00:05:28Z", "commit": {"oid": "3fff9b1e02e40327099ca1d4e6882870993218a7"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MzQxNzg5", "url": "https://github.com/prestodb/presto/pull/14836#pullrequestreview-454341789", "createdAt": "2020-07-23T17:19:30Z", "commit": {"oid": "3fff9b1e02e40327099ca1d4e6882870993218a7"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0MzQzOTQx", "url": "https://github.com/prestodb/presto/pull/14836#pullrequestreview-454343941", "createdAt": "2020-07-23T17:22:26Z", "commit": {"oid": "3fff9b1e02e40327099ca1d4e6882870993218a7"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3fff9b1e02e40327099ca1d4e6882870993218a7", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/3fff9b1e02e40327099ca1d4e6882870993218a7", "committedDate": "2020-07-22T21:41:57Z", "message": "Close spiller on Operator#close for ORDER BY spilling"}, "afterCommit": {"oid": "d46f4827e3557cd9c391387d3d3f973ed465d646", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/d46f4827e3557cd9c391387d3d3f973ed465d646", "committedDate": "2020-07-23T18:16:17Z", "message": "Close spiller on Operator#close for ORDER BY spilling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2e6a83f4829388609da69997a97065748f01819", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/f2e6a83f4829388609da69997a97065748f01819", "committedDate": "2020-07-23T20:24:47Z", "message": "Revoke memory after initial output page has been produced in tests\n\nCherry-pick of https://github.com/prestosql/presto/commit/0a9b8047f36fd22fd33193d1a9e3fea4e88efb4b\n\nCo-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "80890daea7f0528c99bc7e90bc31c0708eaa449d", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/80890daea7f0528c99bc7e90bc31c0708eaa449d", "committedDate": "2020-07-23T20:24:47Z", "message": "Allow memory revoke only during operator finish phase\n\nCherry-pick of https://github.com/prestosql/presto/commit/5fef5aa58626286d2952a2008ee8598232cd954c\n\nCo-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df4ae85b0dd0118713b7bf768efc26a5f2c58e28", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/df4ae85b0dd0118713b7bf768efc26a5f2c58e28", "committedDate": "2020-07-23T20:24:47Z", "message": "Produce more than single page in testHashAggregation\n\nCherry-pick of https://github.com/prestosql/presto/commit/e69b66863126e8a82c62f5538d12a032a66dd662\n\nCo-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9aa39fb4893a71c7ac2f2070e987d8f389918ee2", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/9aa39fb4893a71c7ac2f2070e987d8f389918ee2", "committedDate": "2020-07-23T20:24:47Z", "message": "Extract DummySpillerFactory from TestHashAggregationOperator\n\nCherry-pick of https://github.com/prestosql/presto/commit/f01067ba9dda7f4a1bbcabcaf901b3c008969207\n\nCo-authored-by: Atri Sharma <atri@linux.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3af951b6a96b219164f5b67aac1366d7615cb83e", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/3af951b6a96b219164f5b67aac1366d7615cb83e", "committedDate": "2020-07-23T20:24:47Z", "message": "Use WorkProcessor in OrderByOperator\n\nCherry-pick of https://github.com/prestosql/presto/commit/e7d8dd5e7035520d1dbb7990803b51383cc11aae\n\nCo-authored-by: Piotr Findeisen <piotr.findeisen@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e24359d19908df10d879164f4f64a3ee1e4a50ab", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/e24359d19908df10d879164f4f64a3ee1e4a50ab", "committedDate": "2020-07-23T20:24:47Z", "message": "Add Spill To Disk for ORDER BY\nORDER BY currently will error out if the data being processed exceeds\nquery memory limit. This commit introduces paging from disk and ensures\nthat ORDER BY is limited only by the amount of disk present.\n\nCherry-pick of https://github.com/prestosql/presto/commit/24868b3481a974f3e068197d9c432788de9ddacb\n\nCo-authored-by: Piotr Findeisen <piotr.findeisen@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "52adeba9d527dce64ceeabeac3e4ac1dc5c642d7", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/52adeba9d527dce64ceeabeac3e4ac1dc5c642d7", "committedDate": "2020-07-23T20:24:47Z", "message": "Use OrderingCompiler in OrderBy spilling\n\nCherry-pick of https://github.com/prestosql/presto/commit/472fb5ad36cb0e0fea0a2cf5f90e598b28ce01fe\n\nCo-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28962d5b23751ee4289698876c01c333fb5255e4", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/28962d5b23751ee4289698876c01c333fb5255e4", "committedDate": "2020-07-23T20:24:48Z", "message": "Convert revocable memory to user memory on OrderBy finish\n\nCherry-pick of https://github.com/prestosql/presto/commit/d35e5fb834ef93ccadea5bf76739ab9e814e5eac\n\nCo-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1dc65c617652f0fd9bd2cd101fbeafd4d63a097b", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/1dc65c617652f0fd9bd2cd101fbeafd4d63a097b", "committedDate": "2020-07-23T20:24:48Z", "message": "Extract order by queries tests to separate class\n\nCherry-pick of https://github.com/prestosql/presto/commit/94b4d0a42f8c86b95b6c3664c5cd83b6eab7297a\n\nCo-authored-by: Karol Sobczak <karol.sobczak@karolsobczak.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13db5e5b137e06d6bee7081b8bd760b02040381e", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/13db5e5b137e06d6bee7081b8bd760b02040381e", "committedDate": "2020-07-23T20:24:48Z", "message": "Close spiller on Operator#close for ORDER BY spilling"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d46f4827e3557cd9c391387d3d3f973ed465d646", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/d46f4827e3557cd9c391387d3d3f973ed465d646", "committedDate": "2020-07-23T18:16:17Z", "message": "Close spiller on Operator#close for ORDER BY spilling"}, "afterCommit": {"oid": "13db5e5b137e06d6bee7081b8bd760b02040381e", "author": {"user": {"login": "sachdevs", "name": "Saksham"}}, "url": "https://github.com/prestodb/presto/commit/13db5e5b137e06d6bee7081b8bd760b02040381e", "committedDate": "2020-07-23T20:24:48Z", "message": "Close spiller on Operator#close for ORDER BY spilling"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU0NTE4OTk0", "url": "https://github.com/prestodb/presto/pull/14836#pullrequestreview-454518994", "createdAt": "2020-07-23T21:48:36Z", "commit": {"oid": "13db5e5b137e06d6bee7081b8bd760b02040381e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1263, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}