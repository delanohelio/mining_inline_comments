{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM1MzQ2Mjg2", "number": 14657, "title": "Reduce redundant calls to setNull in DoubleSumAggregation", "bodyText": "Minor performance fix to avoid calling setNull on the state multiple times. I have seen CPU time for just the agg part go down from 6.1hrs to 5.8hrs for some queries - indicating a ~5% improvement.\n== NO RELEASE NOTE ==", "createdAt": "2020-06-16T16:52:54Z", "url": "https://github.com/prestodb/presto/pull/14657", "merged": true, "mergeCommit": {"oid": "942cd399b9adaa12b427bd743c1ac1fe154f1cc5"}, "closed": true, "closedAt": "2020-06-18T20:22:30Z", "author": {"login": "kaikalur"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcr9kb9AFqTQzMTk1MTg0Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcr9tcIABqjM0NTEyMDE4NTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMxOTUxODQy", "url": "https://github.com/prestodb/presto/pull/14657#pullrequestreview-431951842", "createdAt": "2020-06-16T23:08:20Z", "commit": {"oid": "64874cd5ba6c6cd8fe4d742197fa1f439395e8ec"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQyMzowODoyMFrOGkwKOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xNlQyMzowODoyMFrOGkwKOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTE5MDk3MQ==", "bodyText": "Is there a performance difference between this and original code?", "url": "https://github.com/prestodb/presto/pull/14657#discussion_r441190971", "createdAt": "2020-06-16T23:08:20Z", "author": {"login": "rongrong"}, "path": "presto-main/src/main/java/com/facebook/presto/operator/aggregation/DoubleSumAggregation.java", "diffHunk": "@@ -42,10 +47,10 @@ public static void combine(@AggregationState NullableDoubleState state, @Aggrega\n         if (state.isNull()) {\n             state.setNull(false);\n             state.setDouble(otherState.getDouble());\n-            return;\n         }\n-\n-        state.setDouble(state.getDouble() + otherState.getDouble());\n+        else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64874cd5ba6c6cd8fe4d742197fa1f439395e8ec"}, "originalPosition": 24}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "64874cd5ba6c6cd8fe4d742197fa1f439395e8ec", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/64874cd5ba6c6cd8fe4d742197fa1f439395e8ec", "committedDate": "2020-06-16T16:49:48Z", "message": "Reduce redundant calls to setNull in DoubleSumAggregation"}, "afterCommit": {"oid": "2ddd4fdfcf73ad507ff0e05699cdf1419ebfb0dc", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/2ddd4fdfcf73ad507ff0e05699cdf1419ebfb0dc", "committedDate": "2020-06-16T23:17:31Z", "message": "Reduce redundant calls to setNull in DoubleSumAggregation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9924c249a05f57e07515f913d100f144e2ebcc5", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/e9924c249a05f57e07515f913d100f144e2ebcc5", "committedDate": "2020-06-16T23:18:30Z", "message": "Reduce redundant calls to setNull in DoubleSumAggregation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ddd4fdfcf73ad507ff0e05699cdf1419ebfb0dc", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/2ddd4fdfcf73ad507ff0e05699cdf1419ebfb0dc", "committedDate": "2020-06-16T23:17:31Z", "message": "Reduce redundant calls to setNull in DoubleSumAggregation"}, "afterCommit": {"oid": "e9924c249a05f57e07515f913d100f144e2ebcc5", "author": {"user": {"login": "kaikalur", "name": "Sreeni Viswanadha"}}, "url": "https://github.com/prestodb/presto/commit/e9924c249a05f57e07515f913d100f144e2ebcc5", "committedDate": "2020-06-16T23:18:30Z", "message": "Reduce redundant calls to setNull in DoubleSumAggregation"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1388, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}