{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4MDI4OTUx", "number": 14912, "title": "Handle CAST in canonicalized LambdaDefinitionExpression", "bodyText": "Include CallExpression return type in canonicalized LambdaDefinitionExpression\nso CAST with same input type would not be mistakenly canonicalized.\n== RELEASE NOTES ==\n\nGeneral Changes\n* Fix LambdaDefinitionExpression canonicalization did not handle CAST", "createdAt": "2020-07-28T20:10:48Z", "url": "https://github.com/prestodb/presto/pull/14912", "merged": true, "mergeCommit": {"oid": "fa288b807416141287681d220c3e968aead544fc"}, "closed": true, "closedAt": "2020-07-29T01:28:15Z", "author": {"login": "rongrong"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5cInVgH2gAyNDU4MDI4OTUxOjk2N2QzNWQ1YzdhYjllM2RjYThiNDlkZDA4MTM2MzYyYzc5OTVkZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5gP-zgFqTQ1NzEyNDI3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc", "author": {"user": {"login": "rongrong", "name": "Rongrong Zhong"}}, "url": "https://github.com/prestodb/presto/commit/967d35d5c7ab9e3dca8b49dd08136362c7995dfc", "committedDate": "2020-07-28T20:06:31Z", "message": "Handle CAST in canonicalized LambdaDefinitionExpression\n\nInclude CallExpression return type in canonicalized LambdaDefinitionExpression\nso CAST with same input type would not be mistakenly canonicalized."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU2OTg2NDAw", "url": "https://github.com/prestodb/presto/pull/14912#pullrequestreview-456986400", "createdAt": "2020-07-28T20:28:16Z", "commit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDoyODoxN1rOG4dmIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMDoyODoxN1rOG4dmIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg1ODMzOQ==", "bodyText": "Probably better to do it only for CAST so we don't accidentally cause other issues?", "url": "https://github.com/prestodb/presto/pull/14912#discussion_r461858339", "createdAt": "2020-07-28T20:28:17Z", "author": {"login": "kaikalur"}, "path": "presto-spi/src/main/java/com/facebook/presto/spi/relation/LambdaDefinitionExpression.java", "diffHunk": "@@ -133,7 +133,7 @@ public CanonicalizeExpression(List<String> arguments, List<Type> argumentTypes)\n         @Override\n         public String visitCall(CallExpression call, Void context)\n         {\n-            return format(\"%s.%s(%s)\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())));\n+            return format(\"%s.%s(%s):%s\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())), call.getType());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MTEyMTEx", "url": "https://github.com/prestodb/presto/pull/14912#pullrequestreview-457112111", "createdAt": "2020-07-29T00:13:42Z", "commit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MTIwMjUy", "url": "https://github.com/prestodb/presto/pull/14912#pullrequestreview-457120252", "createdAt": "2020-07-29T00:40:32Z", "commit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MTI0Mjcy", "url": "https://github.com/prestodb/presto/pull/14912#pullrequestreview-457124272", "createdAt": "2020-07-29T00:54:08Z", "commit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwMDo1NDowOFrOG4kw3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOVQwMDo1NDowOFrOG4kw3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTk3NTc3Mw==", "bodyText": "probably good to have one parameter per line now? \ud83d\ude04", "url": "https://github.com/prestodb/presto/pull/14912#discussion_r461975773", "createdAt": "2020-07-29T00:54:08Z", "author": {"login": "wenleix"}, "path": "presto-spi/src/main/java/com/facebook/presto/spi/relation/LambdaDefinitionExpression.java", "diffHunk": "@@ -133,7 +133,7 @@ public CanonicalizeExpression(List<String> arguments, List<Type> argumentTypes)\n         @Override\n         public String visitCall(CallExpression call, Void context)\n         {\n-            return format(\"%s.%s(%s)\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())));\n+            return format(\"%s.%s(%s):%s\", call.getFunctionHandle().getFunctionNamespace(), call.getDisplayName(), String.join(\", \", call.getArguments().stream().map(e -> e.accept(this, null)).collect(Collectors.toList())), call.getType());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTg1ODMzOQ=="}, "originalCommit": {"oid": "967d35d5c7ab9e3dca8b49dd08136362c7995dfc"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 357, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}