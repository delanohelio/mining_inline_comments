{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0NjczODc2", "number": 14223, "title": "Harden blockEncodingBuffers in OptimizedPartitionedOutputOperator", "bodyText": "blockEncodingBuffers in OptimizedPartitionedOutputOperator#partitionBuffer is not supposed to be accessed by multiple threads, but it might be helpful to harden initializeBlockEncodingBuffers to make sure it never leaves blockEncodingBuffers partially initialized. This PR is to harden the blockEncodingBuffers when initializing them.\n== NO RELEASE NOTE ==", "createdAt": "2020-03-06T07:28:32Z", "url": "https://github.com/prestodb/presto/pull/14223", "merged": true, "mergeCommit": {"oid": "a902a34b9f066111deaa420c94d79f1f10d944ee"}, "closed": true, "closedAt": "2020-03-11T13:01:26Z", "author": {"login": "yingsu00"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcK7AY-gBqjMxMDQyNzUwNzE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMmvZQAFqTM3MjczNDU4MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "81fb50673c92c944f05d25fd5d9cd00bce7f2334", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/81fb50673c92c944f05d25fd5d9cd00bce7f2334", "committedDate": "2020-03-06T07:26:44Z", "message": "Verify the blockEncodingBuffers is not null"}, "afterCommit": {"oid": "c187aba30bf3ceeabe26eb05f0f44942abf0b201", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/c187aba30bf3ceeabe26eb05f0f44942abf0b201", "committedDate": "2020-03-06T07:29:54Z", "message": "Verify the blockEncodingBuffers is not null"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNDA5ODY1", "url": "https://github.com/prestodb/presto/pull/14223#pullrequestreview-370409865", "createdAt": "2020-03-06T15:30:09Z", "commit": {"oid": "c187aba30bf3ceeabe26eb05f0f44942abf0b201"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxNTozMDowOVrOFy82Fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxNTozMDowOVrOFy82Fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODk3MDAwNg==", "bodyText": "@yingsu00 These checks don't make sense to me.  Why do we need them?", "url": "https://github.com/prestodb/presto/pull/14223#discussion_r388970006", "createdAt": "2020-03-06T15:30:09Z", "author": {"login": "mbasmanova"}, "path": "presto-main/src/main/java/com/facebook/presto/operator/repartition/OptimizedPartitionedOutputOperator.java", "diffHunk": "@@ -586,6 +586,7 @@ private void appendData(DecodedBlockNode[] decodedBlocks, int fixedWidthRowSize,\n             }\n \n             initializeBlockEncodingBuffers(decodedBlocks);\n+            verify(blockEncodingBuffers != null, \"blockEncodingBuffers is null\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c187aba30bf3ceeabe26eb05f0f44942abf0b201"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7dcbe30a62d97074ab89c6881e75724ffa9e5f8", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/d7dcbe30a62d97074ab89c6881e75724ffa9e5f8", "committedDate": "2020-03-11T07:39:53Z", "message": "Harden blockEncodingBuffers in OptimizedPartitionedOutputOperator"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c187aba30bf3ceeabe26eb05f0f44942abf0b201", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/c187aba30bf3ceeabe26eb05f0f44942abf0b201", "committedDate": "2020-03-06T07:29:54Z", "message": "Verify the blockEncodingBuffers is not null"}, "afterCommit": {"oid": "d7dcbe30a62d97074ab89c6881e75724ffa9e5f8", "author": {"user": null}, "url": "https://github.com/prestodb/presto/commit/d7dcbe30a62d97074ab89c6881e75724ffa9e5f8", "committedDate": "2020-03-11T07:39:53Z", "message": "Harden blockEncodingBuffers in OptimizedPartitionedOutputOperator"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNzM0NTgx", "url": "https://github.com/prestodb/presto/pull/14223#pullrequestreview-372734581", "createdAt": "2020-03-11T13:01:20Z", "commit": {"oid": "d7dcbe30a62d97074ab89c6881e75724ffa9e5f8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2011, "cost": 1, "resetAt": "2021-10-28T19:08:13Z"}}}