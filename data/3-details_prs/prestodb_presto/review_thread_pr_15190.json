{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg5NDM4MjUx", "number": 15190, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwMzozMjo0MFrOElfeXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwMzozNTo0NlrOElff4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3NzQ4NDQ2OnYy", "diffSide": "RIGHT", "path": "presto-common/src/main/java/com/facebook/presto/common/Page.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwMzozMjo0MFrOHU_2YQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMjo0NzowN1rOHVOR0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc3OTY4MQ==", "bodyText": "Will this save CPU c.p. extractChannels(new int[]{channel});?", "url": "https://github.com/prestodb/presto/pull/15190#discussion_r491779681", "createdAt": "2020-09-21T03:32:40Z", "author": {"login": "highker"}, "path": "presto-common/src/main/java/com/facebook/presto/common/Page.java", "diffHunk": "@@ -329,6 +329,11 @@ public Page copyPositions(int[] retainedPositions, int offset, int length)\n         return wrapBlocksWithoutCopy(length, blocks);\n     }\n \n+    public Page extractChannel(int channel)\n+    {\n+        return wrapBlocksWithoutCopy(positionCount, new Block[]{this.blocks[channel]});", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "839edfcaa526e5817bbdbc420b9b19ec4bd12458"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjAxNjA4MQ==", "bodyText": "They should be the same IFF the method is fully inlined and the temporary int array becomes stack allocated, but that seemed more fragile to depend on compared to just providing the desired implementation directly.", "url": "https://github.com/prestodb/presto/pull/15190#discussion_r492016081", "createdAt": "2020-09-21T12:47:07Z", "author": {"login": "pettyjamesm"}, "path": "presto-common/src/main/java/com/facebook/presto/common/Page.java", "diffHunk": "@@ -329,6 +329,11 @@ public Page copyPositions(int[] retainedPositions, int offset, int length)\n         return wrapBlocksWithoutCopy(length, blocks);\n     }\n \n+    public Page extractChannel(int channel)\n+    {\n+        return wrapBlocksWithoutCopy(positionCount, new Block[]{this.blocks[channel]});", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc3OTY4MQ=="}, "originalCommit": {"oid": "839edfcaa526e5817bbdbc420b9b19ec4bd12458"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA3NzQ4ODMzOnYy", "diffSide": "LEFT", "path": "presto-main/src/main/java/com/facebook/presto/operator/aggregation/GenericAccumulatorFactory.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQwMzozNTo0NlrOHU_4eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yMVQxMjo1Njo1NFrOHVOrRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc4MDIxNw==", "bodyText": "keep this comment to the second to last line", "url": "https://github.com/prestodb/presto/pull/15190#discussion_r491780217", "createdAt": "2020-09-21T03:35:46Z", "author": {"login": "highker"}, "path": "presto-main/src/main/java/com/facebook/presto/operator/aggregation/GenericAccumulatorFactory.java", "diffHunk": "@@ -550,14 +550,8 @@ public Type getFinalType()\n         @Override\n         public void addInput(GroupByIdBlock groupIdsBlock, Page page)\n         {\n-            Block[] blocks = new Block[page.getChannelCount() + 1];\n-            for (int i = 0; i < page.getChannelCount(); i++) {\n-                blocks[i] = page.getBlock(i);\n-            }\n-            // Add group id block", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9bf4262fba5516ab2e0305801edfe3f6fab6aa65"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjAyMjU5Ng==", "bodyText": "Woops, good catch. Added it back.", "url": "https://github.com/prestodb/presto/pull/15190#discussion_r492022596", "createdAt": "2020-09-21T12:56:54Z", "author": {"login": "pettyjamesm"}, "path": "presto-main/src/main/java/com/facebook/presto/operator/aggregation/GenericAccumulatorFactory.java", "diffHunk": "@@ -550,14 +550,8 @@ public Type getFinalType()\n         @Override\n         public void addInput(GroupByIdBlock groupIdsBlock, Page page)\n         {\n-            Block[] blocks = new Block[page.getChannelCount() + 1];\n-            for (int i = 0; i < page.getChannelCount(); i++) {\n-                blocks[i] = page.getBlock(i);\n-            }\n-            // Add group id block", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTc4MDIxNw=="}, "originalCommit": {"oid": "9bf4262fba5516ab2e0305801edfe3f6fab6aa65"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3681, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}