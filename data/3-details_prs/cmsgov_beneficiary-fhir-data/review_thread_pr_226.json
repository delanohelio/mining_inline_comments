{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3ODk3OTM4", "number": 226, "reviewThreads": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoxODoyN1rODi4z6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxOToxMjozMlrODkY5Pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3OTA4OTcwOnYy", "diffSide": "RIGHT", "path": "ops/packer/build_bfd-pipeline.json", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoxODoyN1rOFuY10A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoxODoyN1rOFuY10A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE4NTgwOA==", "bodyText": "Unsure why bfd-pipeline did not require a vault_password_file definition previously.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r384185808", "createdAt": "2020-02-25T23:18:27Z", "author": {"login": "njdister"}, "path": "ops/packer/build_bfd-pipeline.json", "diffHunk": "@@ -2,7 +2,7 @@\n   \"variables\": {\n     \"source_ami\": \"\",\n     \"subnet_id\": \"\",\n-    \"env\": \"\"\n+    \"vault_password_file\": \"\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acb4265653b493d7fad2a529da61bd9aaba25708"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3OTEwMDg3OnYy", "diffSide": "LEFT", "path": "ops/ansible/roles/bfd-server/tasks/install.yml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoyMjo1MFrOFuY8UQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoyMjo1MFrOFuY8UQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE4NzQ3Mw==", "bodyText": "Removing as this should no longer be needed in CCS environment.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r384187473", "createdAt": "2020-02-25T23:22:50Z", "author": {"login": "njdister"}, "path": "ops/ansible/roles/bfd-server/tasks/install.yml", "diffHunk": "@@ -24,154 +24,17 @@\n     mode: u=rwx,g=rx,o=rx\n   become: true\n \n-# TODO: This can be removed once we've fully migrated away from JBoss.\n-# The first time we dpeloy the new Jetty-based server, we need to ensure that JBoss is stopped first (if it already exists).\n-- name: Stop Existing BFD Server Service\n-  service:\n-    name: \"{{ data_server_appserver_service }}\"\n-    state: stopped\n-  become: true\n-  ignore_errors: true\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acb4265653b493d7fad2a529da61bd9aaba25708"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3OTEwNzI4OnYy", "diffSide": "LEFT", "path": "ops/ansible/roles/bfd-server/tasks/install.yml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoyNDo1NFrOFuY_2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoyNDo1NFrOFuY_2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE4ODM3Nw==", "bodyText": "Removing as this shouldn't be needed in CCS, we just copy the keystore contained within the repo after this task anyway.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r384188377", "createdAt": "2020-02-25T23:24:54Z", "author": {"login": "njdister"}, "path": "ops/ansible/roles/bfd-server/tasks/install.yml", "diffHunk": "@@ -24,154 +24,17 @@\n     mode: u=rwx,g=rx,o=rx\n   become: true\n \n-# TODO: This can be removed once we've fully migrated away from JBoss.\n-# The first time we dpeloy the new Jetty-based server, we need to ensure that JBoss is stopped first (if it already exists).\n-- name: Stop Existing BFD Server Service\n-  service:\n-    name: \"{{ data_server_appserver_service }}\"\n-    state: stopped\n-  become: true\n-  ignore_errors: true\n-\n - name: Copy BFD Server Launcher\n   copy:\n     src: \"{{ data_server_launcher }}\"\n     dest: \"{{ data_server_dir }}/{{ data_server_launcher | basename }}\"\n   become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n \n - name: Copy BFD Server WAR\n   copy:\n     src: \"{{ data_server_war }}\"\n     dest: \"{{ data_server_dir }}/{{ data_server_war | basename }}\"\n   become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-- name: Copy App Server Launcher Script\n-  template:\n-    src: bfd-server.sh.j2\n-    dest: \"{{ data_server_dir }}/bfd-server.sh\"\n-    owner: \"{{ data_server_user }}\"\n-    group: \"{{ data_server_user }}\"\n-    mode: u=rwx,g=rwx,o=rx\n-  become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-- name: Create BFD Server Service Definition\n-  template:\n-    src: bluebutton-appserver.service.j2\n-    dest: \"/etc/systemd/system/{{ data_server_appserver_service }}.service\"\n-    owner: root\n-    group: root\n-    mode: u=rw,g=r,o=r\n-  become: true\n-  notify:\n-    - 'Enable BFD Server Service'\n-    - 'Restart BFD Server Service'\n-\n-- name: Check for BFD Server SSL Keystore\n-  stat:\n-    path: \"{{ data_server_dir }}/bluebutton-appserver-keystore.jks\"\n-  register: stat_appserver_keystore\n-  changed_when: false\n-  become: true\n-\n-- name: Create BFD Server SSL Keystore\n-  command: \"keytool -genkeypair -alias server {{ data_server_ssl_server_genkeypair_args }} -keystore {{ data_server_dir }}/bluebutton-appserver-keystore.jks -storepass changeit -keypass changeit\"\n-  when: stat_appserver_keystore.stat.isreg is not defined\n-  become: true\n-  become_user: \"{{ data_server_user }}\"\n-  no_log: true  # Ensure that the key args aren't logged if this command fails.\n-  notify:\n-    - 'Restart BFD Server Service'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acb4265653b493d7fad2a529da61bd9aaba25708"}, "originalPosition": 66}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3OTEwOTQ1OnYy", "diffSide": "LEFT", "path": "ops/ansible/roles/bfd-server/tasks/install.yml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoyNTozM1rOFuZBCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoyNTozM1rOFuZBCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE4ODY4Mg==", "bodyText": "Removed due to lack of use of data_server_ssl_client_cas in CCS.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r384188682", "createdAt": "2020-02-25T23:25:33Z", "author": {"login": "njdister"}, "path": "ops/ansible/roles/bfd-server/tasks/install.yml", "diffHunk": "@@ -24,154 +24,17 @@\n     mode: u=rwx,g=rx,o=rx\n   become: true\n \n-# TODO: This can be removed once we've fully migrated away from JBoss.\n-# The first time we dpeloy the new Jetty-based server, we need to ensure that JBoss is stopped first (if it already exists).\n-- name: Stop Existing BFD Server Service\n-  service:\n-    name: \"{{ data_server_appserver_service }}\"\n-    state: stopped\n-  become: true\n-  ignore_errors: true\n-\n - name: Copy BFD Server Launcher\n   copy:\n     src: \"{{ data_server_launcher }}\"\n     dest: \"{{ data_server_dir }}/{{ data_server_launcher | basename }}\"\n   become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n \n - name: Copy BFD Server WAR\n   copy:\n     src: \"{{ data_server_war }}\"\n     dest: \"{{ data_server_dir }}/{{ data_server_war | basename }}\"\n   become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-- name: Copy App Server Launcher Script\n-  template:\n-    src: bfd-server.sh.j2\n-    dest: \"{{ data_server_dir }}/bfd-server.sh\"\n-    owner: \"{{ data_server_user }}\"\n-    group: \"{{ data_server_user }}\"\n-    mode: u=rwx,g=rwx,o=rx\n-  become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-- name: Create BFD Server Service Definition\n-  template:\n-    src: bluebutton-appserver.service.j2\n-    dest: \"/etc/systemd/system/{{ data_server_appserver_service }}.service\"\n-    owner: root\n-    group: root\n-    mode: u=rw,g=r,o=r\n-  become: true\n-  notify:\n-    - 'Enable BFD Server Service'\n-    - 'Restart BFD Server Service'\n-\n-- name: Check for BFD Server SSL Keystore\n-  stat:\n-    path: \"{{ data_server_dir }}/bluebutton-appserver-keystore.jks\"\n-  register: stat_appserver_keystore\n-  changed_when: false\n-  become: true\n-\n-- name: Create BFD Server SSL Keystore\n-  command: \"keytool -genkeypair -alias server {{ data_server_ssl_server_genkeypair_args }} -keystore {{ data_server_dir }}/bluebutton-appserver-keystore.jks -storepass changeit -keypass changeit\"\n-  when: stat_appserver_keystore.stat.isreg is not defined\n-  become: true\n-  become_user: \"{{ data_server_user }}\"\n-  no_log: true  # Ensure that the key args aren't logged if this command fails.\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-# TODO: Export server's public cert and publish to S3 or somesuch (so the frontend and others can pick it up).\n-\n-- name: Secure BFD Server SSL Keystore\n-  file:\n-    path: \"{{ data_server_dir }}/bluebutton-appserver-keystore.jks\"\n-    owner: \"{{ data_server_user }}\"\n-    group: \"{{ data_server_user }}\"\n-    mode: u=rw,g=,o=\n-  become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-- name: Create BFD Server SSL Truststore Working Directory\n-  file:\n-    state: directory\n-    path: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work\"\n-    owner: \"{{ data_server_user }}\"\n-    group: \"{{ data_server_user }}\"\n-    mode: u=rwx,g=rwx,o=rx\n-  become: true\n-\n-- name: Delete Previous BFD Server SSL Truststore Working Copy\n-  file:\n-    state: absent\n-    path: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work/bluebutton-appserver-truststore.jks\"\n-  changed_when: false\n-  become: true\n-\n-- name: Create Empty App Server SSL Truststore Working Copy\n-  command: \"{{ item }}\"\n-  with_items:\n-    - \"keytool -genkeypair -alias fake -dname cn=fake -keypass changeit -keystore {{ data_server_dir }}/bluebutton-appserver-truststore-work/bluebutton-appserver-truststore.jks -storepass changeit\"\n-    - \"keytool -delete -alias fake -keystore {{ data_server_dir }}/bluebutton-appserver-truststore-work/bluebutton-appserver-truststore.jks -storepass changeit -keypass changeit\"\n-  changed_when: false\n-  become: true\n-  become_user: \"{{ data_server_user }}\"\n-\n-- name: Save App Server SSL Truststore Certificates\n-  copy:\n-    content: \"{{ item.certificate }}\"\n-    dest: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work/{{ item.alias }}.crt\"\n-  with_items: \"{{ data_server_ssl_client_certificates }}\"\n-  changed_when: false\n-  become: true\n-  become_user: \"{{ data_server_user }}\"\n-\n-- name: Save App Server SSL Truststore Certificate Authorities\n-  copy:\n-    content: \"{{ item.certificate }}\"\n-    dest: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work/{{ item.alias }}.crt\"\n-  with_items: \"{{ data_server_ssl_client_cas }}\"\n-  changed_when: false\n-  become: true\n-  become_user: \"{{ data_server_user }}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acb4265653b493d7fad2a529da61bd9aaba25708"}, "originalPosition": 121}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3OTExMDMzOnYy", "diffSide": "LEFT", "path": "ops/ansible/roles/bfd-server/tasks/install.yml", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoyNTo0NlrOFuZBdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoyNTo0NlrOFuZBdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE4ODc5MA==", "bodyText": "Removed due to lack of use of data_server_ssl_client_cas in CCS.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r384188790", "createdAt": "2020-02-25T23:25:46Z", "author": {"login": "njdister"}, "path": "ops/ansible/roles/bfd-server/tasks/install.yml", "diffHunk": "@@ -24,154 +24,17 @@\n     mode: u=rwx,g=rx,o=rx\n   become: true\n \n-# TODO: This can be removed once we've fully migrated away from JBoss.\n-# The first time we dpeloy the new Jetty-based server, we need to ensure that JBoss is stopped first (if it already exists).\n-- name: Stop Existing BFD Server Service\n-  service:\n-    name: \"{{ data_server_appserver_service }}\"\n-    state: stopped\n-  become: true\n-  ignore_errors: true\n-\n - name: Copy BFD Server Launcher\n   copy:\n     src: \"{{ data_server_launcher }}\"\n     dest: \"{{ data_server_dir }}/{{ data_server_launcher | basename }}\"\n   become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n \n - name: Copy BFD Server WAR\n   copy:\n     src: \"{{ data_server_war }}\"\n     dest: \"{{ data_server_dir }}/{{ data_server_war | basename }}\"\n   become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-- name: Copy App Server Launcher Script\n-  template:\n-    src: bfd-server.sh.j2\n-    dest: \"{{ data_server_dir }}/bfd-server.sh\"\n-    owner: \"{{ data_server_user }}\"\n-    group: \"{{ data_server_user }}\"\n-    mode: u=rwx,g=rwx,o=rx\n-  become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-- name: Create BFD Server Service Definition\n-  template:\n-    src: bluebutton-appserver.service.j2\n-    dest: \"/etc/systemd/system/{{ data_server_appserver_service }}.service\"\n-    owner: root\n-    group: root\n-    mode: u=rw,g=r,o=r\n-  become: true\n-  notify:\n-    - 'Enable BFD Server Service'\n-    - 'Restart BFD Server Service'\n-\n-- name: Check for BFD Server SSL Keystore\n-  stat:\n-    path: \"{{ data_server_dir }}/bluebutton-appserver-keystore.jks\"\n-  register: stat_appserver_keystore\n-  changed_when: false\n-  become: true\n-\n-- name: Create BFD Server SSL Keystore\n-  command: \"keytool -genkeypair -alias server {{ data_server_ssl_server_genkeypair_args }} -keystore {{ data_server_dir }}/bluebutton-appserver-keystore.jks -storepass changeit -keypass changeit\"\n-  when: stat_appserver_keystore.stat.isreg is not defined\n-  become: true\n-  become_user: \"{{ data_server_user }}\"\n-  no_log: true  # Ensure that the key args aren't logged if this command fails.\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-# TODO: Export server's public cert and publish to S3 or somesuch (so the frontend and others can pick it up).\n-\n-- name: Secure BFD Server SSL Keystore\n-  file:\n-    path: \"{{ data_server_dir }}/bluebutton-appserver-keystore.jks\"\n-    owner: \"{{ data_server_user }}\"\n-    group: \"{{ data_server_user }}\"\n-    mode: u=rw,g=,o=\n-  become: true\n-  notify:\n-    - 'Restart BFD Server Service'\n-\n-- name: Create BFD Server SSL Truststore Working Directory\n-  file:\n-    state: directory\n-    path: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work\"\n-    owner: \"{{ data_server_user }}\"\n-    group: \"{{ data_server_user }}\"\n-    mode: u=rwx,g=rwx,o=rx\n-  become: true\n-\n-- name: Delete Previous BFD Server SSL Truststore Working Copy\n-  file:\n-    state: absent\n-    path: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work/bluebutton-appserver-truststore.jks\"\n-  changed_when: false\n-  become: true\n-\n-- name: Create Empty App Server SSL Truststore Working Copy\n-  command: \"{{ item }}\"\n-  with_items:\n-    - \"keytool -genkeypair -alias fake -dname cn=fake -keypass changeit -keystore {{ data_server_dir }}/bluebutton-appserver-truststore-work/bluebutton-appserver-truststore.jks -storepass changeit\"\n-    - \"keytool -delete -alias fake -keystore {{ data_server_dir }}/bluebutton-appserver-truststore-work/bluebutton-appserver-truststore.jks -storepass changeit -keypass changeit\"\n-  changed_when: false\n-  become: true\n-  become_user: \"{{ data_server_user }}\"\n-\n-- name: Save App Server SSL Truststore Certificates\n-  copy:\n-    content: \"{{ item.certificate }}\"\n-    dest: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work/{{ item.alias }}.crt\"\n-  with_items: \"{{ data_server_ssl_client_certificates }}\"\n-  changed_when: false\n-  become: true\n-  become_user: \"{{ data_server_user }}\"\n-\n-- name: Save App Server SSL Truststore Certificate Authorities\n-  copy:\n-    content: \"{{ item.certificate }}\"\n-    dest: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work/{{ item.alias }}.crt\"\n-  with_items: \"{{ data_server_ssl_client_cas }}\"\n-  changed_when: false\n-  become: true\n-  become_user: \"{{ data_server_user }}\"\n-\n-- name: Import Certificates into App Server SSL Truststore Working Copy\n-  java_cert:\n-    cert_alias: \"{{ item.alias }}\"\n-    cert_path: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work/{{ item.alias }}.crt\"\n-    keystore_pass: changeit\n-    keystore_path: \"{{ data_server_dir }}/bluebutton-appserver-truststore-work/bluebutton-appserver-truststore.jks\"\n-  with_items: \"{{ data_server_ssl_client_certificates }}\"\n-  changed_when: false\n-  become: true\n-  become_user: \"{{ data_server_user }}\"\n-\n-- name: Import Certificate Authorities into App Server SSL Truststore Working Copy\n-  command: \"keytool -importcert -noprompt -trustcacerts -alias {{ item.alias }} -file {{ data_server_dir }}/bluebutton-appserver-truststore-work/{{ item.alias }}.crt -keypass changeit -keystore {{ data_server_dir }}/bluebutton-appserver-truststore-work/bluebutton-appserver-truststore.jks -storepass changeit\"\n-  with_items: \"{{ data_server_ssl_client_cas }}\"\n-  changed_when: false\n-  become: true\n-  become_user: \"{{ data_server_user }}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acb4265653b493d7fad2a529da61bd9aaba25708"}, "originalPosition": 139}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3OTExODY2OnYy", "diffSide": "LEFT", "path": "ops/ansible/playbooks-ccs/launch_bfd-pipeline.yml", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzoyOToxN1rOFuZGSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QyMjo0MDoyMVrOFxZQSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE5MDAyNw==", "bodyText": "I can't think of any reason to to have a default env, potential vector for misconfiguration with agnostic AMIs.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r384190027", "createdAt": "2020-02-25T23:29:17Z", "author": {"login": "njdister"}, "path": "ops/ansible/playbooks-ccs/launch_bfd-pipeline.yml", "diffHunk": "@@ -4,8 +4,6 @@\n ##\n - name: Configure ETL Server\n   hosts: localhost\n-  vars:\n-    env: \"test\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "acb4265653b493d7fad2a529da61bd9aaba25708"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU1NTE5MA==", "bodyText": "I feel like this was probably put in to avoid accidental deploys to other environments, but I have also have no issues with removing it.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r386555190", "createdAt": "2020-03-02T18:01:05Z", "author": {"login": "cthulhuplus"}, "path": "ops/ansible/playbooks-ccs/launch_bfd-pipeline.yml", "diffHunk": "@@ -4,8 +4,6 @@\n ##\n - name: Configure ETL Server\n   hosts: localhost\n-  vars:\n-    env: \"test\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE5MDAyNw=="}, "originalCommit": {"oid": "acb4265653b493d7fad2a529da61bd9aaba25708"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU1OTYzOA==", "bodyText": "The scenario I was thinking of here was, if for some reason terraform doesn't properly pass the env var, I'd rather the deployment break entirely rather than just defaulting to test.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r386559638", "createdAt": "2020-03-02T18:09:35Z", "author": {"login": "njdister"}, "path": "ops/ansible/playbooks-ccs/launch_bfd-pipeline.yml", "diffHunk": "@@ -4,8 +4,6 @@\n ##\n - name: Configure ETL Server\n   hosts: localhost\n-  vars:\n-    env: \"test\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE5MDAyNw=="}, "originalCommit": {"oid": "acb4265653b493d7fad2a529da61bd9aaba25708"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMzODMxMg==", "bodyText": "I like this.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r387338312", "createdAt": "2020-03-03T22:40:21Z", "author": {"login": "jzulim"}, "path": "ops/ansible/playbooks-ccs/launch_bfd-pipeline.yml", "diffHunk": "@@ -4,8 +4,6 @@\n ##\n - name: Configure ETL Server\n   hosts: localhost\n-  vars:\n-    env: \"test\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE5MDAyNw=="}, "originalCommit": {"oid": "acb4265653b493d7fad2a529da61bd9aaba25708"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDI2ODY3OnYy", "diffSide": "RIGHT", "path": "ops/terraform/modules/resources/asg/main.tf", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjozMjowNlrOFwmV1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjozMjowNlrOFwmV1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUwNDE0OA==", "bodyText": "It appears this was never working as intended, though if it was it would have broken due to the fact that the the commit ID is a unique merge commit that cannot be referenced from anywhere other than in that Jenkins build.  Fixing intended behavior here, but commenting out in the launch template.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r386504148", "createdAt": "2020-03-02T16:32:06Z", "author": {"login": "njdister"}, "path": "ops/terraform/modules/resources/asg/main.tf", "diffHunk": "@@ -127,7 +127,7 @@ resource \"aws_launch_template\" \"main\" {\n     port          = var.lb_config.port\n     accountId     = var.launch_config.account_id\n     gitBranchName = var.launch_config.git_branch\n-    gitCommitId   = var.launch_config.git_branch\n+    gitCommitId   = var.launch_config.git_commit", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b4e3b47ed5d0e2c1bba3a11f93dc7a59ff5b2b8"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDI3Mjc5OnYy", "diffSide": "RIGHT", "path": "ops/terraform/modules/resources/templates/fhir_server.tpl", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjozMzowMVrOFwmYXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjozMzowMVrOFwmYXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUwNDc5Nw==", "bodyText": "Disabling this feature here until it's refactored to work as intended.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r386504797", "createdAt": "2020-03-02T16:33:01Z", "author": {"login": "njdister"}, "path": "ops/terraform/modules/resources/templates/fhir_server.tpl", "diffHunk": "@@ -13,7 +13,9 @@ git clone https://github.com/CMSgov/beneficiary-fhir-data.git --branch ${gitBran\n \n cd beneficiary-fhir-data/ops/ansible/playbooks-ccs/\n \n-git checkout ${gitCommitId}\n+# At this time gitCommitId is a unique merge commit in Jenkins that cannot be properly\n+# checked out via GitHub, uncommenting this will break instance launch!\n+# git checkout ${gitCommitId}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b4e3b47ed5d0e2c1bba3a11f93dc7a59ff5b2b8"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDI3MzQ4OnYy", "diffSide": "RIGHT", "path": "ops/terraform/modules/resources/templates/pipeline_server.tpl", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNjozMzoxMVrOFwmY0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQyMDozNTowN1rOFwuU4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUwNDkxMg==", "bodyText": "Disabling this feature here until it's refactored to work as intended.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r386504912", "createdAt": "2020-03-02T16:33:11Z", "author": {"login": "njdister"}, "path": "ops/terraform/modules/resources/templates/pipeline_server.tpl", "diffHunk": "@@ -13,7 +13,9 @@ git clone https://github.com/CMSgov/beneficiary-fhir-data.git --branch ${gitBran\n \n cd beneficiary-fhir-data/ops/ansible/playbooks-ccs/\n \n-git checkout ${gitCommitId}\n+# At this time gitCommitId is a unique merge commit in Jenkins that cannot be properly\n+# checked out via GitHub, uncommenting this will break instance launch!\n+# git checkout ${gitCommitId}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b4e3b47ed5d0e2c1bba3a11f93dc7a59ff5b2b8"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU5MTM5NA==", "bodyText": "Is there a ticket to make something that works? The need to tie AMI to commit is still valid.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r386591394", "createdAt": "2020-03-02T19:09:32Z", "author": {"login": "RickHawesUSDS"}, "path": "ops/terraform/modules/resources/templates/pipeline_server.tpl", "diffHunk": "@@ -13,7 +13,9 @@ git clone https://github.com/CMSgov/beneficiary-fhir-data.git --branch ${gitBran\n \n cd beneficiary-fhir-data/ops/ansible/playbooks-ccs/\n \n-git checkout ${gitCommitId}\n+# At this time gitCommitId is a unique merge commit in Jenkins that cannot be properly\n+# checked out via GitHub, uncommenting this will break instance launch!\n+# git checkout ${gitCommitId}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUwNDkxMg=="}, "originalCommit": {"oid": "4b4e3b47ed5d0e2c1bba3a11f93dc7a59ff5b2b8"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjYzNDk3OQ==", "bodyText": "No, I'll go ahead and make one.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r386634979", "createdAt": "2020-03-02T20:35:07Z", "author": {"login": "njdister"}, "path": "ops/terraform/modules/resources/templates/pipeline_server.tpl", "diffHunk": "@@ -13,7 +13,9 @@ git clone https://github.com/CMSgov/beneficiary-fhir-data.git --branch ${gitBran\n \n cd beneficiary-fhir-data/ops/ansible/playbooks-ccs/\n \n-git checkout ${gitCommitId}\n+# At this time gitCommitId is a unique merge commit in Jenkins that cannot be properly\n+# checked out via GitHub, uncommenting this will break instance launch!\n+# git checkout ${gitCommitId}", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjUwNDkxMg=="}, "originalCommit": {"oid": "4b4e3b47ed5d0e2c1bba3a11f93dc7a59ff5b2b8"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NDgzMTk4OnYy", "diffSide": "RIGHT", "path": "apps/build.groovy", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxOToxMjozMlrOFwrxWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxOToxMjozMlrOFwrxWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU5MzExMw==", "bodyText": "I really love the fact that you are removing all of the healthapt cases.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/226#discussion_r386593113", "createdAt": "2020-03-02T19:12:32Z", "author": {"login": "RickHawesUSDS"}, "path": "apps/build.groovy", "diffHunk": "@@ -70,12 +49,9 @@ class AppBuildResults implements Serializable {\n  \n def build(String build_env) {\n \tdir ('apps') {\n-\t\tif (build_env == 'healthapt') {\n-\t\t\tmvn \"--update-snapshots -Dmaven.test.failure.ignore clean verify -Dhttp.nonProxyHosts=localhost\"\n-\t\t} else if (build_env == 'ccs') {\n-\t\t\tmvn \"--update-snapshots -Dmaven.test.failure.ignore clean verify\"\n-\t\t} else \n-\t\tUnsupportedOperationException(\"No Build Apps job available for ${params.dev_env} environment\")\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f917a2819fd5a41494c60e53e65f19f49aa9b9f5"}, "originalPosition": 60}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 309, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}