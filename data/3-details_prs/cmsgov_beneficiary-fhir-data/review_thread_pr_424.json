{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2MjE4OTAz", "number": 424, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMzozNDoyMFrOFJq59g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNDozMzoyNFrOFJrUPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1Njg0NDcwOnYy", "diffSide": "RIGHT", "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMzozNDoyMFrOIMGOjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMzo1MDo1OFrOIMGX3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NTg1Mw==", "bodyText": "Just curious: what is \"the column\"?", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549555853", "createdAt": "2020-12-29T03:34:20Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * The column doesn't have a default value to avoid updating the column on migration. The pipeline server", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66813c5326ad1f43fd91f0bac97b2c415eb57b7e"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1ODIzOQ==", "bodyText": "done", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549558239", "createdAt": "2020-12-29T03:50:58Z", "author": {"login": "cbrunefearless"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * The column doesn't have a default value to avoid updating the column on migration. The pipeline server", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NTg1Mw=="}, "originalCommit": {"oid": "66813c5326ad1f43fd91f0bac97b2c415eb57b7e"}, "originalPosition": 2}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1Njg0ODQzOnYy", "diffSide": "RIGHT", "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMzozNjo1OVrOIMGQVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMzo1MDo0N1rOIMGX0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NjMwOA==", "bodyText": "Did we ever get a final answer as to why we have all the null beneEnrollmentReferenceYear records? Regardless, I'd suggest adding a comment here explaining why we're leaving them out -- even if it's just \"we don't know why there are null values for this column, but we'll figure that out later in BFD-12345.\"", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549556308", "createdAt": "2020-12-29T03:36:59Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * The column doesn't have a default value to avoid updating the column on migration. The pipeline server\n+ * will populate the column as new beneficaries are added or existing beneficaries are updated. \n+ */\n+\n+${logic.tablespaces-escape} SET default_tablespace = fhirdb_ts2;\n+\n+create table \"BeneficiaryMonthly\" (\n+    \"parentBeneficiary\" varchar(255) not null,\n+    \"yearMonth\" date not null,\n+    \"fipsStateCntyCode\" varchar(5),\n+    \"medicareStatusCode\" varchar(2),\n+    \"entitlementBuyInInd\" char(1),\n+    \"hmoIndicatorInd\" char(1),\n+    \"partCContractNumberId\" varchar(5),\n+    \"partCPbpNumberId\" varchar(3),\n+    \"partCPlanTypeCode\" varchar(3),\n+    \"partDContractNumberId\" varchar(5),\n+    \"partDPbpNumberId\" varchar(3),\n+    \"partDSegmentNumberId\" varchar(3),\n+    \"partDRetireeDrugSubsidyInd\" char(1),\n+    \"medicaidDualEligibilityCode\" varchar(2),\n+    \"partDLowIncomeCostShareGroupCode\" varchar(2),\n+    constraint \"BeneficiaryMonthly_pkey\" primary key (\"parentBeneficiary\", \"yearMonth\")\n+)\n+${logic.tablespaces-escape} tablespace \"beneficiarymonthly_ts\"\n+;\n+\n+\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/01/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJanCode\",\n+    \"medicareStatusJanCode\", \"entitlementBuyInJanInd\", \"hmoIndicatorJanInd\",\n+    \"partCContractNumberJanId\", \"partCPbpNumberJanId\", \"partCPlanTypeJanCode\",\n+    \"partDContractNumberJanId\", \"partDPbpNumberJanId\", \"partDSegmentNumberJanId\",\n+    \"partDRetireeDrugSubsidyJanInd\", \"medicaidDualEligibilityJanCode\", \"partDLowIncomeCostShareGroupJanCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/02/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyFebCode\",\n+    \"medicareStatusFebCode\", \"entitlementBuyInFebInd\", \"hmoIndicatorFebInd\",\n+    \"partCContractNumberFebId\", \"partCPbpNumberFebId\", \"partCPlanTypeFebCode\",\n+    \"partDContractNumberFebId\", \"partDPbpNumberFebId\", \"partDSegmentNumberFebId\",\n+    \"partDRetireeDrugSubsidyFebInd\", \"medicaidDualEligibilityFebCode\", \"partDLowIncomeCostShareGroupFebCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/03/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMarCode\",\n+    \"medicareStatusMarCode\", \"entitlementBuyInMarInd\", \"hmoIndicatorMarInd\",\n+    \"partCContractNumberMarId\", \"partCPbpNumberMarId\", \"partCPlanTypeMarCode\",\n+    \"partDContractNumberMarId\", \"partDPbpNumberMarId\", \"partDSegmentNumberMarId\",\n+    \"partDRetireeDrugSubsidyMarInd\", \"medicaidDualEligibilityMarCode\", \"partDLowIncomeCostShareGroupMarCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/04/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAprCode\",\n+    \"medicareStatusAprCode\", \"entitlementBuyInAprInd\", \"hmoIndicatorAprInd\",\n+    \"partCContractNumberAprId\", \"partCPbpNumberAprId\", \"partCPlanTypeAprCode\",\n+    \"partDContractNumberAprId\", \"partDPbpNumberAprId\", \"partDSegmentNumberAprId\",\n+    \"partDRetireeDrugSubsidyAprInd\", \"medicaidDualEligibilityAprCode\", \"partDLowIncomeCostShareGroupAprCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/05/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMayCode\",\n+    \"medicareStatusMayCode\", \"entitlementBuyInMayInd\", \"hmoIndicatorMayInd\",\n+    \"partCContractNumberMayId\", \"partCPbpNumberMayId\", \"partCPlanTypeMayCode\",\n+    \"partDContractNumberMayId\", \"partDPbpNumberMayId\", \"partDSegmentNumberMayId\",\n+    \"partDRetireeDrugSubsidyMayInd\", \"medicaidDualEligibilityMayCode\", \"partDLowIncomeCostShareGroupMayCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/06/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJunCode\",\n+    \"medicareStatusJunCode\", \"entitlementBuyInJunInd\", \"hmoIndicatorJunInd\",\n+    \"partCContractNumberJunId\", \"partCPbpNumberJunId\", \"partCPlanTypeJunCode\",\n+    \"partDContractNumberJunId\", \"partDPbpNumberJunId\", \"partDSegmentNumberJunId\",\n+    \"partDRetireeDrugSubsidyJunInd\", \"medicaidDualEligibilityJunCode\", \"partDLowIncomeCostShareGroupJunCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/07/01'), 'YYYY/MM/DD')as \"yearMonth\", \"fipsStateCntyJulCode\",\n+    \"medicareStatusJulCode\", \"entitlementBuyInJulInd\", \"hmoIndicatorJulInd\",\n+    \"partCContractNumberJulId\", \"partCPbpNumberJulId\", \"partCPlanTypeJulCode\",\n+    \"partDContractNumberJulId\", \"partDPbpNumberJulId\", \"partDSegmentNumberJulId\",\n+    \"partDRetireeDrugSubsidyJulInd\", \"medicaidDualEligibilityJulCode\", \"partDLowIncomeCostShareGroupJulCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/08/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAugCode\",\n+    \"medicareStatusAugCode\", \"entitlementBuyInAugInd\", \"hmoIndicatorAugInd\",\n+    \"partCContractNumberAugId\", \"partCPbpNumberAugId\", \"partCPlanTypeAugCode\",\n+    \"partDContractNumberAugId\", \"partDPbpNumberAugId\", \"partDSegmentNumberAugId\",\n+    \"partDRetireeDrugSubsidyAugInd\", \"medicaidDualEligibilityAugCode\", \"partDLowIncomeCostShareGroupAugCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/09/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntySeptCode\",\n+    \"medicareStatusSeptCode\", \"entitlementBuyInSeptInd\", \"hmoIndicatorSeptInd\",\n+    \"partCContractNumberSeptId\", \"partCPbpNumberSeptId\", \"partCPlanTypeSeptCode\",\n+    \"partDContractNumberSeptId\", \"partDPbpNumberSeptId\", \"partDSegmentNumberSeptId\",\n+    \"partDRetireeDrugSubsidySeptInd\", \"medicaidDualEligibilitySeptCode\", \"partDLowIncomeCostShareGroupSeptCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+   SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/10/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyOctCode\",\n+    \"medicareStatusOctCode\", \"entitlementBuyInOctInd\", \"hmoIndicatorOctInd\",\n+    \"partCContractNumberOctId\", \"partCPbpNumberOctId\", \"partCPlanTypeOctCode\",\n+    \"partDContractNumberOctId\", \"partDPbpNumberOctId\", \"partDSegmentNumberOctId\",\n+    \"partDRetireeDrugSubsidyOctInd\", \"medicaidDualEligibilityOctCode\", \"partDLowIncomeCostShareGroupOctCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/11/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyNovCode\",\n+    \"medicareStatusNovCode\", \"entitlementBuyInNovInd\", \"hmoIndicatorNovInd\",\n+    \"partCContractNumberNovId\", \"partCPbpNumberNovId\", \"partCPlanTypeNovCode\",\n+    \"partDContractNumberNovId\", \"partDPbpNumberNovId\", \"partDSegmentNumberNovId\",\n+    \"partDRetireeDrugSubsidyNovInd\", \"medicaidDualEligibilityNovCode\", \"partDLowIncomeCostShareGroupNovCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/12/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyDecCode\",\n+    \"medicareStatusDecCode\", \"entitlementBuyInDecInd\", \"hmoIndicatorDecInd\",\n+    \"partCContractNumberDecId\", \"partCPbpNumberDecId\", \"partCPlanTypeDecCode\",\n+    \"partDContractNumberDecId\", \"partDPbpNumberDecId\", \"partDSegmentNumberDecId\",\n+    \"partDRetireeDrugSubsidyDecInd\", \"medicaidDualEligibilityDecCode\", \"partDLowIncomeCostShareGroupDecCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66813c5326ad1f43fd91f0bac97b2c415eb57b7e"}, "originalPosition": 137}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1Njc4OQ==", "bodyText": "Thinking about it a bit more, @jzulim, with all the records you found that had a null beneEnrollmentReferenceYear, did any of them have non-null values for the other columns here?", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549556789", "createdAt": "2020-12-29T03:40:26Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * The column doesn't have a default value to avoid updating the column on migration. The pipeline server\n+ * will populate the column as new beneficaries are added or existing beneficaries are updated. \n+ */\n+\n+${logic.tablespaces-escape} SET default_tablespace = fhirdb_ts2;\n+\n+create table \"BeneficiaryMonthly\" (\n+    \"parentBeneficiary\" varchar(255) not null,\n+    \"yearMonth\" date not null,\n+    \"fipsStateCntyCode\" varchar(5),\n+    \"medicareStatusCode\" varchar(2),\n+    \"entitlementBuyInInd\" char(1),\n+    \"hmoIndicatorInd\" char(1),\n+    \"partCContractNumberId\" varchar(5),\n+    \"partCPbpNumberId\" varchar(3),\n+    \"partCPlanTypeCode\" varchar(3),\n+    \"partDContractNumberId\" varchar(5),\n+    \"partDPbpNumberId\" varchar(3),\n+    \"partDSegmentNumberId\" varchar(3),\n+    \"partDRetireeDrugSubsidyInd\" char(1),\n+    \"medicaidDualEligibilityCode\" varchar(2),\n+    \"partDLowIncomeCostShareGroupCode\" varchar(2),\n+    constraint \"BeneficiaryMonthly_pkey\" primary key (\"parentBeneficiary\", \"yearMonth\")\n+)\n+${logic.tablespaces-escape} tablespace \"beneficiarymonthly_ts\"\n+;\n+\n+\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/01/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJanCode\",\n+    \"medicareStatusJanCode\", \"entitlementBuyInJanInd\", \"hmoIndicatorJanInd\",\n+    \"partCContractNumberJanId\", \"partCPbpNumberJanId\", \"partCPlanTypeJanCode\",\n+    \"partDContractNumberJanId\", \"partDPbpNumberJanId\", \"partDSegmentNumberJanId\",\n+    \"partDRetireeDrugSubsidyJanInd\", \"medicaidDualEligibilityJanCode\", \"partDLowIncomeCostShareGroupJanCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/02/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyFebCode\",\n+    \"medicareStatusFebCode\", \"entitlementBuyInFebInd\", \"hmoIndicatorFebInd\",\n+    \"partCContractNumberFebId\", \"partCPbpNumberFebId\", \"partCPlanTypeFebCode\",\n+    \"partDContractNumberFebId\", \"partDPbpNumberFebId\", \"partDSegmentNumberFebId\",\n+    \"partDRetireeDrugSubsidyFebInd\", \"medicaidDualEligibilityFebCode\", \"partDLowIncomeCostShareGroupFebCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/03/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMarCode\",\n+    \"medicareStatusMarCode\", \"entitlementBuyInMarInd\", \"hmoIndicatorMarInd\",\n+    \"partCContractNumberMarId\", \"partCPbpNumberMarId\", \"partCPlanTypeMarCode\",\n+    \"partDContractNumberMarId\", \"partDPbpNumberMarId\", \"partDSegmentNumberMarId\",\n+    \"partDRetireeDrugSubsidyMarInd\", \"medicaidDualEligibilityMarCode\", \"partDLowIncomeCostShareGroupMarCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/04/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAprCode\",\n+    \"medicareStatusAprCode\", \"entitlementBuyInAprInd\", \"hmoIndicatorAprInd\",\n+    \"partCContractNumberAprId\", \"partCPbpNumberAprId\", \"partCPlanTypeAprCode\",\n+    \"partDContractNumberAprId\", \"partDPbpNumberAprId\", \"partDSegmentNumberAprId\",\n+    \"partDRetireeDrugSubsidyAprInd\", \"medicaidDualEligibilityAprCode\", \"partDLowIncomeCostShareGroupAprCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/05/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMayCode\",\n+    \"medicareStatusMayCode\", \"entitlementBuyInMayInd\", \"hmoIndicatorMayInd\",\n+    \"partCContractNumberMayId\", \"partCPbpNumberMayId\", \"partCPlanTypeMayCode\",\n+    \"partDContractNumberMayId\", \"partDPbpNumberMayId\", \"partDSegmentNumberMayId\",\n+    \"partDRetireeDrugSubsidyMayInd\", \"medicaidDualEligibilityMayCode\", \"partDLowIncomeCostShareGroupMayCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/06/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJunCode\",\n+    \"medicareStatusJunCode\", \"entitlementBuyInJunInd\", \"hmoIndicatorJunInd\",\n+    \"partCContractNumberJunId\", \"partCPbpNumberJunId\", \"partCPlanTypeJunCode\",\n+    \"partDContractNumberJunId\", \"partDPbpNumberJunId\", \"partDSegmentNumberJunId\",\n+    \"partDRetireeDrugSubsidyJunInd\", \"medicaidDualEligibilityJunCode\", \"partDLowIncomeCostShareGroupJunCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/07/01'), 'YYYY/MM/DD')as \"yearMonth\", \"fipsStateCntyJulCode\",\n+    \"medicareStatusJulCode\", \"entitlementBuyInJulInd\", \"hmoIndicatorJulInd\",\n+    \"partCContractNumberJulId\", \"partCPbpNumberJulId\", \"partCPlanTypeJulCode\",\n+    \"partDContractNumberJulId\", \"partDPbpNumberJulId\", \"partDSegmentNumberJulId\",\n+    \"partDRetireeDrugSubsidyJulInd\", \"medicaidDualEligibilityJulCode\", \"partDLowIncomeCostShareGroupJulCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/08/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAugCode\",\n+    \"medicareStatusAugCode\", \"entitlementBuyInAugInd\", \"hmoIndicatorAugInd\",\n+    \"partCContractNumberAugId\", \"partCPbpNumberAugId\", \"partCPlanTypeAugCode\",\n+    \"partDContractNumberAugId\", \"partDPbpNumberAugId\", \"partDSegmentNumberAugId\",\n+    \"partDRetireeDrugSubsidyAugInd\", \"medicaidDualEligibilityAugCode\", \"partDLowIncomeCostShareGroupAugCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/09/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntySeptCode\",\n+    \"medicareStatusSeptCode\", \"entitlementBuyInSeptInd\", \"hmoIndicatorSeptInd\",\n+    \"partCContractNumberSeptId\", \"partCPbpNumberSeptId\", \"partCPlanTypeSeptCode\",\n+    \"partDContractNumberSeptId\", \"partDPbpNumberSeptId\", \"partDSegmentNumberSeptId\",\n+    \"partDRetireeDrugSubsidySeptInd\", \"medicaidDualEligibilitySeptCode\", \"partDLowIncomeCostShareGroupSeptCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+   SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/10/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyOctCode\",\n+    \"medicareStatusOctCode\", \"entitlementBuyInOctInd\", \"hmoIndicatorOctInd\",\n+    \"partCContractNumberOctId\", \"partCPbpNumberOctId\", \"partCPlanTypeOctCode\",\n+    \"partDContractNumberOctId\", \"partDPbpNumberOctId\", \"partDSegmentNumberOctId\",\n+    \"partDRetireeDrugSubsidyOctInd\", \"medicaidDualEligibilityOctCode\", \"partDLowIncomeCostShareGroupOctCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/11/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyNovCode\",\n+    \"medicareStatusNovCode\", \"entitlementBuyInNovInd\", \"hmoIndicatorNovInd\",\n+    \"partCContractNumberNovId\", \"partCPbpNumberNovId\", \"partCPlanTypeNovCode\",\n+    \"partDContractNumberNovId\", \"partDPbpNumberNovId\", \"partDSegmentNumberNovId\",\n+    \"partDRetireeDrugSubsidyNovInd\", \"medicaidDualEligibilityNovCode\", \"partDLowIncomeCostShareGroupNovCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/12/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyDecCode\",\n+    \"medicareStatusDecCode\", \"entitlementBuyInDecInd\", \"hmoIndicatorDecInd\",\n+    \"partCContractNumberDecId\", \"partCPbpNumberDecId\", \"partCPlanTypeDecCode\",\n+    \"partDContractNumberDecId\", \"partDPbpNumberDecId\", \"partDSegmentNumberDecId\",\n+    \"partDRetireeDrugSubsidyDecInd\", \"medicaidDualEligibilityDecCode\", \"partDLowIncomeCostShareGroupDecCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NjMwOA=="}, "originalCommit": {"oid": "66813c5326ad1f43fd91f0bac97b2c415eb57b7e"}, "originalPosition": 137}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1ODIyNQ==", "bodyText": "Added comment", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549558225", "createdAt": "2020-12-29T03:50:47Z", "author": {"login": "cbrunefearless"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * The column doesn't have a default value to avoid updating the column on migration. The pipeline server\n+ * will populate the column as new beneficaries are added or existing beneficaries are updated. \n+ */\n+\n+${logic.tablespaces-escape} SET default_tablespace = fhirdb_ts2;\n+\n+create table \"BeneficiaryMonthly\" (\n+    \"parentBeneficiary\" varchar(255) not null,\n+    \"yearMonth\" date not null,\n+    \"fipsStateCntyCode\" varchar(5),\n+    \"medicareStatusCode\" varchar(2),\n+    \"entitlementBuyInInd\" char(1),\n+    \"hmoIndicatorInd\" char(1),\n+    \"partCContractNumberId\" varchar(5),\n+    \"partCPbpNumberId\" varchar(3),\n+    \"partCPlanTypeCode\" varchar(3),\n+    \"partDContractNumberId\" varchar(5),\n+    \"partDPbpNumberId\" varchar(3),\n+    \"partDSegmentNumberId\" varchar(3),\n+    \"partDRetireeDrugSubsidyInd\" char(1),\n+    \"medicaidDualEligibilityCode\" varchar(2),\n+    \"partDLowIncomeCostShareGroupCode\" varchar(2),\n+    constraint \"BeneficiaryMonthly_pkey\" primary key (\"parentBeneficiary\", \"yearMonth\")\n+)\n+${logic.tablespaces-escape} tablespace \"beneficiarymonthly_ts\"\n+;\n+\n+\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/01/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJanCode\",\n+    \"medicareStatusJanCode\", \"entitlementBuyInJanInd\", \"hmoIndicatorJanInd\",\n+    \"partCContractNumberJanId\", \"partCPbpNumberJanId\", \"partCPlanTypeJanCode\",\n+    \"partDContractNumberJanId\", \"partDPbpNumberJanId\", \"partDSegmentNumberJanId\",\n+    \"partDRetireeDrugSubsidyJanInd\", \"medicaidDualEligibilityJanCode\", \"partDLowIncomeCostShareGroupJanCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/02/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyFebCode\",\n+    \"medicareStatusFebCode\", \"entitlementBuyInFebInd\", \"hmoIndicatorFebInd\",\n+    \"partCContractNumberFebId\", \"partCPbpNumberFebId\", \"partCPlanTypeFebCode\",\n+    \"partDContractNumberFebId\", \"partDPbpNumberFebId\", \"partDSegmentNumberFebId\",\n+    \"partDRetireeDrugSubsidyFebInd\", \"medicaidDualEligibilityFebCode\", \"partDLowIncomeCostShareGroupFebCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/03/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMarCode\",\n+    \"medicareStatusMarCode\", \"entitlementBuyInMarInd\", \"hmoIndicatorMarInd\",\n+    \"partCContractNumberMarId\", \"partCPbpNumberMarId\", \"partCPlanTypeMarCode\",\n+    \"partDContractNumberMarId\", \"partDPbpNumberMarId\", \"partDSegmentNumberMarId\",\n+    \"partDRetireeDrugSubsidyMarInd\", \"medicaidDualEligibilityMarCode\", \"partDLowIncomeCostShareGroupMarCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/04/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAprCode\",\n+    \"medicareStatusAprCode\", \"entitlementBuyInAprInd\", \"hmoIndicatorAprInd\",\n+    \"partCContractNumberAprId\", \"partCPbpNumberAprId\", \"partCPlanTypeAprCode\",\n+    \"partDContractNumberAprId\", \"partDPbpNumberAprId\", \"partDSegmentNumberAprId\",\n+    \"partDRetireeDrugSubsidyAprInd\", \"medicaidDualEligibilityAprCode\", \"partDLowIncomeCostShareGroupAprCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/05/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMayCode\",\n+    \"medicareStatusMayCode\", \"entitlementBuyInMayInd\", \"hmoIndicatorMayInd\",\n+    \"partCContractNumberMayId\", \"partCPbpNumberMayId\", \"partCPlanTypeMayCode\",\n+    \"partDContractNumberMayId\", \"partDPbpNumberMayId\", \"partDSegmentNumberMayId\",\n+    \"partDRetireeDrugSubsidyMayInd\", \"medicaidDualEligibilityMayCode\", \"partDLowIncomeCostShareGroupMayCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/06/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJunCode\",\n+    \"medicareStatusJunCode\", \"entitlementBuyInJunInd\", \"hmoIndicatorJunInd\",\n+    \"partCContractNumberJunId\", \"partCPbpNumberJunId\", \"partCPlanTypeJunCode\",\n+    \"partDContractNumberJunId\", \"partDPbpNumberJunId\", \"partDSegmentNumberJunId\",\n+    \"partDRetireeDrugSubsidyJunInd\", \"medicaidDualEligibilityJunCode\", \"partDLowIncomeCostShareGroupJunCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/07/01'), 'YYYY/MM/DD')as \"yearMonth\", \"fipsStateCntyJulCode\",\n+    \"medicareStatusJulCode\", \"entitlementBuyInJulInd\", \"hmoIndicatorJulInd\",\n+    \"partCContractNumberJulId\", \"partCPbpNumberJulId\", \"partCPlanTypeJulCode\",\n+    \"partDContractNumberJulId\", \"partDPbpNumberJulId\", \"partDSegmentNumberJulId\",\n+    \"partDRetireeDrugSubsidyJulInd\", \"medicaidDualEligibilityJulCode\", \"partDLowIncomeCostShareGroupJulCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/08/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAugCode\",\n+    \"medicareStatusAugCode\", \"entitlementBuyInAugInd\", \"hmoIndicatorAugInd\",\n+    \"partCContractNumberAugId\", \"partCPbpNumberAugId\", \"partCPlanTypeAugCode\",\n+    \"partDContractNumberAugId\", \"partDPbpNumberAugId\", \"partDSegmentNumberAugId\",\n+    \"partDRetireeDrugSubsidyAugInd\", \"medicaidDualEligibilityAugCode\", \"partDLowIncomeCostShareGroupAugCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/09/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntySeptCode\",\n+    \"medicareStatusSeptCode\", \"entitlementBuyInSeptInd\", \"hmoIndicatorSeptInd\",\n+    \"partCContractNumberSeptId\", \"partCPbpNumberSeptId\", \"partCPlanTypeSeptCode\",\n+    \"partDContractNumberSeptId\", \"partDPbpNumberSeptId\", \"partDSegmentNumberSeptId\",\n+    \"partDRetireeDrugSubsidySeptInd\", \"medicaidDualEligibilitySeptCode\", \"partDLowIncomeCostShareGroupSeptCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+   SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/10/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyOctCode\",\n+    \"medicareStatusOctCode\", \"entitlementBuyInOctInd\", \"hmoIndicatorOctInd\",\n+    \"partCContractNumberOctId\", \"partCPbpNumberOctId\", \"partCPlanTypeOctCode\",\n+    \"partDContractNumberOctId\", \"partDPbpNumberOctId\", \"partDSegmentNumberOctId\",\n+    \"partDRetireeDrugSubsidyOctInd\", \"medicaidDualEligibilityOctCode\", \"partDLowIncomeCostShareGroupOctCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/11/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyNovCode\",\n+    \"medicareStatusNovCode\", \"entitlementBuyInNovInd\", \"hmoIndicatorNovInd\",\n+    \"partCContractNumberNovId\", \"partCPbpNumberNovId\", \"partCPlanTypeNovCode\",\n+    \"partDContractNumberNovId\", \"partDPbpNumberNovId\", \"partDSegmentNumberNovId\",\n+    \"partDRetireeDrugSubsidyNovInd\", \"medicaidDualEligibilityNovCode\", \"partDLowIncomeCostShareGroupNovCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/12/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyDecCode\",\n+    \"medicareStatusDecCode\", \"entitlementBuyInDecInd\", \"hmoIndicatorDecInd\",\n+    \"partCContractNumberDecId\", \"partCPbpNumberDecId\", \"partCPlanTypeDecCode\",\n+    \"partDContractNumberDecId\", \"partDPbpNumberDecId\", \"partDSegmentNumberDecId\",\n+    \"partDRetireeDrugSubsidyDecInd\", \"medicaidDualEligibilityDecCode\", \"partDLowIncomeCostShareGroupDecCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NjMwOA=="}, "originalCommit": {"oid": "66813c5326ad1f43fd91f0bac97b2c415eb57b7e"}, "originalPosition": 137}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1Njg0ODk5OnYy", "diffSide": "RIGHT", "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwMzozNzo0M1rOIMGQmA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNDoyNzoxN1rOIMGsqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NjM3Ng==", "bodyText": "You have a copy-paste error here to fix:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              add constraint \"BeneficiaryMonthly_parentClaim_to_Beneficiary\" foreign key (\"parentBeneficiary\") \n          \n          \n            \n              add constraint \"BeneficiaryMonthly_parentBeneficiary_to_Beneficiary\" foreign key (\"parentBeneficiary\")", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549556376", "createdAt": "2020-12-29T03:37:43Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * The column doesn't have a default value to avoid updating the column on migration. The pipeline server\n+ * will populate the column as new beneficaries are added or existing beneficaries are updated. \n+ */\n+\n+${logic.tablespaces-escape} SET default_tablespace = fhirdb_ts2;\n+\n+create table \"BeneficiaryMonthly\" (\n+    \"parentBeneficiary\" varchar(255) not null,\n+    \"yearMonth\" date not null,\n+    \"fipsStateCntyCode\" varchar(5),\n+    \"medicareStatusCode\" varchar(2),\n+    \"entitlementBuyInInd\" char(1),\n+    \"hmoIndicatorInd\" char(1),\n+    \"partCContractNumberId\" varchar(5),\n+    \"partCPbpNumberId\" varchar(3),\n+    \"partCPlanTypeCode\" varchar(3),\n+    \"partDContractNumberId\" varchar(5),\n+    \"partDPbpNumberId\" varchar(3),\n+    \"partDSegmentNumberId\" varchar(3),\n+    \"partDRetireeDrugSubsidyInd\" char(1),\n+    \"medicaidDualEligibilityCode\" varchar(2),\n+    \"partDLowIncomeCostShareGroupCode\" varchar(2),\n+    constraint \"BeneficiaryMonthly_pkey\" primary key (\"parentBeneficiary\", \"yearMonth\")\n+)\n+${logic.tablespaces-escape} tablespace \"beneficiarymonthly_ts\"\n+;\n+\n+\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/01/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJanCode\",\n+    \"medicareStatusJanCode\", \"entitlementBuyInJanInd\", \"hmoIndicatorJanInd\",\n+    \"partCContractNumberJanId\", \"partCPbpNumberJanId\", \"partCPlanTypeJanCode\",\n+    \"partDContractNumberJanId\", \"partDPbpNumberJanId\", \"partDSegmentNumberJanId\",\n+    \"partDRetireeDrugSubsidyJanInd\", \"medicaidDualEligibilityJanCode\", \"partDLowIncomeCostShareGroupJanCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/02/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyFebCode\",\n+    \"medicareStatusFebCode\", \"entitlementBuyInFebInd\", \"hmoIndicatorFebInd\",\n+    \"partCContractNumberFebId\", \"partCPbpNumberFebId\", \"partCPlanTypeFebCode\",\n+    \"partDContractNumberFebId\", \"partDPbpNumberFebId\", \"partDSegmentNumberFebId\",\n+    \"partDRetireeDrugSubsidyFebInd\", \"medicaidDualEligibilityFebCode\", \"partDLowIncomeCostShareGroupFebCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/03/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMarCode\",\n+    \"medicareStatusMarCode\", \"entitlementBuyInMarInd\", \"hmoIndicatorMarInd\",\n+    \"partCContractNumberMarId\", \"partCPbpNumberMarId\", \"partCPlanTypeMarCode\",\n+    \"partDContractNumberMarId\", \"partDPbpNumberMarId\", \"partDSegmentNumberMarId\",\n+    \"partDRetireeDrugSubsidyMarInd\", \"medicaidDualEligibilityMarCode\", \"partDLowIncomeCostShareGroupMarCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/04/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAprCode\",\n+    \"medicareStatusAprCode\", \"entitlementBuyInAprInd\", \"hmoIndicatorAprInd\",\n+    \"partCContractNumberAprId\", \"partCPbpNumberAprId\", \"partCPlanTypeAprCode\",\n+    \"partDContractNumberAprId\", \"partDPbpNumberAprId\", \"partDSegmentNumberAprId\",\n+    \"partDRetireeDrugSubsidyAprInd\", \"medicaidDualEligibilityAprCode\", \"partDLowIncomeCostShareGroupAprCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/05/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMayCode\",\n+    \"medicareStatusMayCode\", \"entitlementBuyInMayInd\", \"hmoIndicatorMayInd\",\n+    \"partCContractNumberMayId\", \"partCPbpNumberMayId\", \"partCPlanTypeMayCode\",\n+    \"partDContractNumberMayId\", \"partDPbpNumberMayId\", \"partDSegmentNumberMayId\",\n+    \"partDRetireeDrugSubsidyMayInd\", \"medicaidDualEligibilityMayCode\", \"partDLowIncomeCostShareGroupMayCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/06/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJunCode\",\n+    \"medicareStatusJunCode\", \"entitlementBuyInJunInd\", \"hmoIndicatorJunInd\",\n+    \"partCContractNumberJunId\", \"partCPbpNumberJunId\", \"partCPlanTypeJunCode\",\n+    \"partDContractNumberJunId\", \"partDPbpNumberJunId\", \"partDSegmentNumberJunId\",\n+    \"partDRetireeDrugSubsidyJunInd\", \"medicaidDualEligibilityJunCode\", \"partDLowIncomeCostShareGroupJunCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/07/01'), 'YYYY/MM/DD')as \"yearMonth\", \"fipsStateCntyJulCode\",\n+    \"medicareStatusJulCode\", \"entitlementBuyInJulInd\", \"hmoIndicatorJulInd\",\n+    \"partCContractNumberJulId\", \"partCPbpNumberJulId\", \"partCPlanTypeJulCode\",\n+    \"partDContractNumberJulId\", \"partDPbpNumberJulId\", \"partDSegmentNumberJulId\",\n+    \"partDRetireeDrugSubsidyJulInd\", \"medicaidDualEligibilityJulCode\", \"partDLowIncomeCostShareGroupJulCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/08/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAugCode\",\n+    \"medicareStatusAugCode\", \"entitlementBuyInAugInd\", \"hmoIndicatorAugInd\",\n+    \"partCContractNumberAugId\", \"partCPbpNumberAugId\", \"partCPlanTypeAugCode\",\n+    \"partDContractNumberAugId\", \"partDPbpNumberAugId\", \"partDSegmentNumberAugId\",\n+    \"partDRetireeDrugSubsidyAugInd\", \"medicaidDualEligibilityAugCode\", \"partDLowIncomeCostShareGroupAugCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/09/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntySeptCode\",\n+    \"medicareStatusSeptCode\", \"entitlementBuyInSeptInd\", \"hmoIndicatorSeptInd\",\n+    \"partCContractNumberSeptId\", \"partCPbpNumberSeptId\", \"partCPlanTypeSeptCode\",\n+    \"partDContractNumberSeptId\", \"partDPbpNumberSeptId\", \"partDSegmentNumberSeptId\",\n+    \"partDRetireeDrugSubsidySeptInd\", \"medicaidDualEligibilitySeptCode\", \"partDLowIncomeCostShareGroupSeptCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+   SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/10/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyOctCode\",\n+    \"medicareStatusOctCode\", \"entitlementBuyInOctInd\", \"hmoIndicatorOctInd\",\n+    \"partCContractNumberOctId\", \"partCPbpNumberOctId\", \"partCPlanTypeOctCode\",\n+    \"partDContractNumberOctId\", \"partDPbpNumberOctId\", \"partDSegmentNumberOctId\",\n+    \"partDRetireeDrugSubsidyOctInd\", \"medicaidDualEligibilityOctCode\", \"partDLowIncomeCostShareGroupOctCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/11/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyNovCode\",\n+    \"medicareStatusNovCode\", \"entitlementBuyInNovInd\", \"hmoIndicatorNovInd\",\n+    \"partCContractNumberNovId\", \"partCPbpNumberNovId\", \"partCPlanTypeNovCode\",\n+    \"partDContractNumberNovId\", \"partDPbpNumberNovId\", \"partDSegmentNumberNovId\",\n+    \"partDRetireeDrugSubsidyNovInd\", \"medicaidDualEligibilityNovCode\", \"partDLowIncomeCostShareGroupNovCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/12/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyDecCode\",\n+    \"medicareStatusDecCode\", \"entitlementBuyInDecInd\", \"hmoIndicatorDecInd\",\n+    \"partCContractNumberDecId\", \"partCPbpNumberDecId\", \"partCPlanTypeDecCode\",\n+    \"partDContractNumberDecId\", \"partDPbpNumberDecId\", \"partDSegmentNumberDecId\",\n+    \"partDRetireeDrugSubsidyDecInd\", \"medicaidDualEligibilityDecCode\", \"partDLowIncomeCostShareGroupDecCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+alter table \"BeneficiaryMonthly\" \n+  add constraint \"BeneficiaryMonthly_parentClaim_to_Beneficiary\" foreign key (\"parentBeneficiary\") ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "66813c5326ad1f43fd91f0bac97b2c415eb57b7e"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1ODIwNg==", "bodyText": "Changed", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549558206", "createdAt": "2020-12-29T03:50:39Z", "author": {"login": "cbrunefearless"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * The column doesn't have a default value to avoid updating the column on migration. The pipeline server\n+ * will populate the column as new beneficaries are added or existing beneficaries are updated. \n+ */\n+\n+${logic.tablespaces-escape} SET default_tablespace = fhirdb_ts2;\n+\n+create table \"BeneficiaryMonthly\" (\n+    \"parentBeneficiary\" varchar(255) not null,\n+    \"yearMonth\" date not null,\n+    \"fipsStateCntyCode\" varchar(5),\n+    \"medicareStatusCode\" varchar(2),\n+    \"entitlementBuyInInd\" char(1),\n+    \"hmoIndicatorInd\" char(1),\n+    \"partCContractNumberId\" varchar(5),\n+    \"partCPbpNumberId\" varchar(3),\n+    \"partCPlanTypeCode\" varchar(3),\n+    \"partDContractNumberId\" varchar(5),\n+    \"partDPbpNumberId\" varchar(3),\n+    \"partDSegmentNumberId\" varchar(3),\n+    \"partDRetireeDrugSubsidyInd\" char(1),\n+    \"medicaidDualEligibilityCode\" varchar(2),\n+    \"partDLowIncomeCostShareGroupCode\" varchar(2),\n+    constraint \"BeneficiaryMonthly_pkey\" primary key (\"parentBeneficiary\", \"yearMonth\")\n+)\n+${logic.tablespaces-escape} tablespace \"beneficiarymonthly_ts\"\n+;\n+\n+\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/01/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJanCode\",\n+    \"medicareStatusJanCode\", \"entitlementBuyInJanInd\", \"hmoIndicatorJanInd\",\n+    \"partCContractNumberJanId\", \"partCPbpNumberJanId\", \"partCPlanTypeJanCode\",\n+    \"partDContractNumberJanId\", \"partDPbpNumberJanId\", \"partDSegmentNumberJanId\",\n+    \"partDRetireeDrugSubsidyJanInd\", \"medicaidDualEligibilityJanCode\", \"partDLowIncomeCostShareGroupJanCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/02/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyFebCode\",\n+    \"medicareStatusFebCode\", \"entitlementBuyInFebInd\", \"hmoIndicatorFebInd\",\n+    \"partCContractNumberFebId\", \"partCPbpNumberFebId\", \"partCPlanTypeFebCode\",\n+    \"partDContractNumberFebId\", \"partDPbpNumberFebId\", \"partDSegmentNumberFebId\",\n+    \"partDRetireeDrugSubsidyFebInd\", \"medicaidDualEligibilityFebCode\", \"partDLowIncomeCostShareGroupFebCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/03/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMarCode\",\n+    \"medicareStatusMarCode\", \"entitlementBuyInMarInd\", \"hmoIndicatorMarInd\",\n+    \"partCContractNumberMarId\", \"partCPbpNumberMarId\", \"partCPlanTypeMarCode\",\n+    \"partDContractNumberMarId\", \"partDPbpNumberMarId\", \"partDSegmentNumberMarId\",\n+    \"partDRetireeDrugSubsidyMarInd\", \"medicaidDualEligibilityMarCode\", \"partDLowIncomeCostShareGroupMarCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/04/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAprCode\",\n+    \"medicareStatusAprCode\", \"entitlementBuyInAprInd\", \"hmoIndicatorAprInd\",\n+    \"partCContractNumberAprId\", \"partCPbpNumberAprId\", \"partCPlanTypeAprCode\",\n+    \"partDContractNumberAprId\", \"partDPbpNumberAprId\", \"partDSegmentNumberAprId\",\n+    \"partDRetireeDrugSubsidyAprInd\", \"medicaidDualEligibilityAprCode\", \"partDLowIncomeCostShareGroupAprCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/05/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMayCode\",\n+    \"medicareStatusMayCode\", \"entitlementBuyInMayInd\", \"hmoIndicatorMayInd\",\n+    \"partCContractNumberMayId\", \"partCPbpNumberMayId\", \"partCPlanTypeMayCode\",\n+    \"partDContractNumberMayId\", \"partDPbpNumberMayId\", \"partDSegmentNumberMayId\",\n+    \"partDRetireeDrugSubsidyMayInd\", \"medicaidDualEligibilityMayCode\", \"partDLowIncomeCostShareGroupMayCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/06/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJunCode\",\n+    \"medicareStatusJunCode\", \"entitlementBuyInJunInd\", \"hmoIndicatorJunInd\",\n+    \"partCContractNumberJunId\", \"partCPbpNumberJunId\", \"partCPlanTypeJunCode\",\n+    \"partDContractNumberJunId\", \"partDPbpNumberJunId\", \"partDSegmentNumberJunId\",\n+    \"partDRetireeDrugSubsidyJunInd\", \"medicaidDualEligibilityJunCode\", \"partDLowIncomeCostShareGroupJunCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/07/01'), 'YYYY/MM/DD')as \"yearMonth\", \"fipsStateCntyJulCode\",\n+    \"medicareStatusJulCode\", \"entitlementBuyInJulInd\", \"hmoIndicatorJulInd\",\n+    \"partCContractNumberJulId\", \"partCPbpNumberJulId\", \"partCPlanTypeJulCode\",\n+    \"partDContractNumberJulId\", \"partDPbpNumberJulId\", \"partDSegmentNumberJulId\",\n+    \"partDRetireeDrugSubsidyJulInd\", \"medicaidDualEligibilityJulCode\", \"partDLowIncomeCostShareGroupJulCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/08/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAugCode\",\n+    \"medicareStatusAugCode\", \"entitlementBuyInAugInd\", \"hmoIndicatorAugInd\",\n+    \"partCContractNumberAugId\", \"partCPbpNumberAugId\", \"partCPlanTypeAugCode\",\n+    \"partDContractNumberAugId\", \"partDPbpNumberAugId\", \"partDSegmentNumberAugId\",\n+    \"partDRetireeDrugSubsidyAugInd\", \"medicaidDualEligibilityAugCode\", \"partDLowIncomeCostShareGroupAugCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/09/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntySeptCode\",\n+    \"medicareStatusSeptCode\", \"entitlementBuyInSeptInd\", \"hmoIndicatorSeptInd\",\n+    \"partCContractNumberSeptId\", \"partCPbpNumberSeptId\", \"partCPlanTypeSeptCode\",\n+    \"partDContractNumberSeptId\", \"partDPbpNumberSeptId\", \"partDSegmentNumberSeptId\",\n+    \"partDRetireeDrugSubsidySeptInd\", \"medicaidDualEligibilitySeptCode\", \"partDLowIncomeCostShareGroupSeptCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+   SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/10/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyOctCode\",\n+    \"medicareStatusOctCode\", \"entitlementBuyInOctInd\", \"hmoIndicatorOctInd\",\n+    \"partCContractNumberOctId\", \"partCPbpNumberOctId\", \"partCPlanTypeOctCode\",\n+    \"partDContractNumberOctId\", \"partDPbpNumberOctId\", \"partDSegmentNumberOctId\",\n+    \"partDRetireeDrugSubsidyOctInd\", \"medicaidDualEligibilityOctCode\", \"partDLowIncomeCostShareGroupOctCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/11/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyNovCode\",\n+    \"medicareStatusNovCode\", \"entitlementBuyInNovInd\", \"hmoIndicatorNovInd\",\n+    \"partCContractNumberNovId\", \"partCPbpNumberNovId\", \"partCPlanTypeNovCode\",\n+    \"partDContractNumberNovId\", \"partDPbpNumberNovId\", \"partDSegmentNumberNovId\",\n+    \"partDRetireeDrugSubsidyNovInd\", \"medicaidDualEligibilityNovCode\", \"partDLowIncomeCostShareGroupNovCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/12/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyDecCode\",\n+    \"medicareStatusDecCode\", \"entitlementBuyInDecInd\", \"hmoIndicatorDecInd\",\n+    \"partCContractNumberDecId\", \"partCPbpNumberDecId\", \"partCPlanTypeDecCode\",\n+    \"partDContractNumberDecId\", \"partDPbpNumberDecId\", \"partDSegmentNumberDecId\",\n+    \"partDRetireeDrugSubsidyDecInd\", \"medicaidDualEligibilityDecCode\", \"partDLowIncomeCostShareGroupDecCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+alter table \"BeneficiaryMonthly\" \n+  add constraint \"BeneficiaryMonthly_parentClaim_to_Beneficiary\" foreign key (\"parentBeneficiary\") ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NjM3Ng=="}, "originalCommit": {"oid": "66813c5326ad1f43fd91f0bac97b2c415eb57b7e"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1ODY1Nw==", "bodyText": "Nice eyes. Upset I didnt catch that. TY.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549558657", "createdAt": "2020-12-29T03:54:00Z", "author": {"login": "jzulim"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * The column doesn't have a default value to avoid updating the column on migration. The pipeline server\n+ * will populate the column as new beneficaries are added or existing beneficaries are updated. \n+ */\n+\n+${logic.tablespaces-escape} SET default_tablespace = fhirdb_ts2;\n+\n+create table \"BeneficiaryMonthly\" (\n+    \"parentBeneficiary\" varchar(255) not null,\n+    \"yearMonth\" date not null,\n+    \"fipsStateCntyCode\" varchar(5),\n+    \"medicareStatusCode\" varchar(2),\n+    \"entitlementBuyInInd\" char(1),\n+    \"hmoIndicatorInd\" char(1),\n+    \"partCContractNumberId\" varchar(5),\n+    \"partCPbpNumberId\" varchar(3),\n+    \"partCPlanTypeCode\" varchar(3),\n+    \"partDContractNumberId\" varchar(5),\n+    \"partDPbpNumberId\" varchar(3),\n+    \"partDSegmentNumberId\" varchar(3),\n+    \"partDRetireeDrugSubsidyInd\" char(1),\n+    \"medicaidDualEligibilityCode\" varchar(2),\n+    \"partDLowIncomeCostShareGroupCode\" varchar(2),\n+    constraint \"BeneficiaryMonthly_pkey\" primary key (\"parentBeneficiary\", \"yearMonth\")\n+)\n+${logic.tablespaces-escape} tablespace \"beneficiarymonthly_ts\"\n+;\n+\n+\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/01/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJanCode\",\n+    \"medicareStatusJanCode\", \"entitlementBuyInJanInd\", \"hmoIndicatorJanInd\",\n+    \"partCContractNumberJanId\", \"partCPbpNumberJanId\", \"partCPlanTypeJanCode\",\n+    \"partDContractNumberJanId\", \"partDPbpNumberJanId\", \"partDSegmentNumberJanId\",\n+    \"partDRetireeDrugSubsidyJanInd\", \"medicaidDualEligibilityJanCode\", \"partDLowIncomeCostShareGroupJanCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/02/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyFebCode\",\n+    \"medicareStatusFebCode\", \"entitlementBuyInFebInd\", \"hmoIndicatorFebInd\",\n+    \"partCContractNumberFebId\", \"partCPbpNumberFebId\", \"partCPlanTypeFebCode\",\n+    \"partDContractNumberFebId\", \"partDPbpNumberFebId\", \"partDSegmentNumberFebId\",\n+    \"partDRetireeDrugSubsidyFebInd\", \"medicaidDualEligibilityFebCode\", \"partDLowIncomeCostShareGroupFebCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/03/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMarCode\",\n+    \"medicareStatusMarCode\", \"entitlementBuyInMarInd\", \"hmoIndicatorMarInd\",\n+    \"partCContractNumberMarId\", \"partCPbpNumberMarId\", \"partCPlanTypeMarCode\",\n+    \"partDContractNumberMarId\", \"partDPbpNumberMarId\", \"partDSegmentNumberMarId\",\n+    \"partDRetireeDrugSubsidyMarInd\", \"medicaidDualEligibilityMarCode\", \"partDLowIncomeCostShareGroupMarCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/04/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAprCode\",\n+    \"medicareStatusAprCode\", \"entitlementBuyInAprInd\", \"hmoIndicatorAprInd\",\n+    \"partCContractNumberAprId\", \"partCPbpNumberAprId\", \"partCPlanTypeAprCode\",\n+    \"partDContractNumberAprId\", \"partDPbpNumberAprId\", \"partDSegmentNumberAprId\",\n+    \"partDRetireeDrugSubsidyAprInd\", \"medicaidDualEligibilityAprCode\", \"partDLowIncomeCostShareGroupAprCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/05/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMayCode\",\n+    \"medicareStatusMayCode\", \"entitlementBuyInMayInd\", \"hmoIndicatorMayInd\",\n+    \"partCContractNumberMayId\", \"partCPbpNumberMayId\", \"partCPlanTypeMayCode\",\n+    \"partDContractNumberMayId\", \"partDPbpNumberMayId\", \"partDSegmentNumberMayId\",\n+    \"partDRetireeDrugSubsidyMayInd\", \"medicaidDualEligibilityMayCode\", \"partDLowIncomeCostShareGroupMayCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/06/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJunCode\",\n+    \"medicareStatusJunCode\", \"entitlementBuyInJunInd\", \"hmoIndicatorJunInd\",\n+    \"partCContractNumberJunId\", \"partCPbpNumberJunId\", \"partCPlanTypeJunCode\",\n+    \"partDContractNumberJunId\", \"partDPbpNumberJunId\", \"partDSegmentNumberJunId\",\n+    \"partDRetireeDrugSubsidyJunInd\", \"medicaidDualEligibilityJunCode\", \"partDLowIncomeCostShareGroupJunCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/07/01'), 'YYYY/MM/DD')as \"yearMonth\", \"fipsStateCntyJulCode\",\n+    \"medicareStatusJulCode\", \"entitlementBuyInJulInd\", \"hmoIndicatorJulInd\",\n+    \"partCContractNumberJulId\", \"partCPbpNumberJulId\", \"partCPlanTypeJulCode\",\n+    \"partDContractNumberJulId\", \"partDPbpNumberJulId\", \"partDSegmentNumberJulId\",\n+    \"partDRetireeDrugSubsidyJulInd\", \"medicaidDualEligibilityJulCode\", \"partDLowIncomeCostShareGroupJulCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/08/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAugCode\",\n+    \"medicareStatusAugCode\", \"entitlementBuyInAugInd\", \"hmoIndicatorAugInd\",\n+    \"partCContractNumberAugId\", \"partCPbpNumberAugId\", \"partCPlanTypeAugCode\",\n+    \"partDContractNumberAugId\", \"partDPbpNumberAugId\", \"partDSegmentNumberAugId\",\n+    \"partDRetireeDrugSubsidyAugInd\", \"medicaidDualEligibilityAugCode\", \"partDLowIncomeCostShareGroupAugCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/09/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntySeptCode\",\n+    \"medicareStatusSeptCode\", \"entitlementBuyInSeptInd\", \"hmoIndicatorSeptInd\",\n+    \"partCContractNumberSeptId\", \"partCPbpNumberSeptId\", \"partCPlanTypeSeptCode\",\n+    \"partDContractNumberSeptId\", \"partDPbpNumberSeptId\", \"partDSegmentNumberSeptId\",\n+    \"partDRetireeDrugSubsidySeptInd\", \"medicaidDualEligibilitySeptCode\", \"partDLowIncomeCostShareGroupSeptCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+   SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/10/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyOctCode\",\n+    \"medicareStatusOctCode\", \"entitlementBuyInOctInd\", \"hmoIndicatorOctInd\",\n+    \"partCContractNumberOctId\", \"partCPbpNumberOctId\", \"partCPlanTypeOctCode\",\n+    \"partDContractNumberOctId\", \"partDPbpNumberOctId\", \"partDSegmentNumberOctId\",\n+    \"partDRetireeDrugSubsidyOctInd\", \"medicaidDualEligibilityOctCode\", \"partDLowIncomeCostShareGroupOctCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/11/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyNovCode\",\n+    \"medicareStatusNovCode\", \"entitlementBuyInNovInd\", \"hmoIndicatorNovInd\",\n+    \"partCContractNumberNovId\", \"partCPbpNumberNovId\", \"partCPlanTypeNovCode\",\n+    \"partDContractNumberNovId\", \"partDPbpNumberNovId\", \"partDSegmentNumberNovId\",\n+    \"partDRetireeDrugSubsidyNovInd\", \"medicaidDualEligibilityNovCode\", \"partDLowIncomeCostShareGroupNovCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/12/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyDecCode\",\n+    \"medicareStatusDecCode\", \"entitlementBuyInDecInd\", \"hmoIndicatorDecInd\",\n+    \"partCContractNumberDecId\", \"partCPbpNumberDecId\", \"partCPlanTypeDecCode\",\n+    \"partDContractNumberDecId\", \"partDPbpNumberDecId\", \"partDSegmentNumberDecId\",\n+    \"partDRetireeDrugSubsidyDecInd\", \"medicaidDualEligibilityDecCode\", \"partDLowIncomeCostShareGroupDecCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+alter table \"BeneficiaryMonthly\" \n+  add constraint \"BeneficiaryMonthly_parentClaim_to_Beneficiary\" foreign key (\"parentBeneficiary\") ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NjM3Ng=="}, "originalCommit": {"oid": "66813c5326ad1f43fd91f0bac97b2c415eb57b7e"}, "originalPosition": 140}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2MzU2MA==", "bodyText": "@jzulim I've looked at this... five times or so now, and it's the first time I noticed it, so... \ud83e\udd37.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549563560", "createdAt": "2020-12-29T04:27:17Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,142 @@\n+/*\n+ * The column doesn't have a default value to avoid updating the column on migration. The pipeline server\n+ * will populate the column as new beneficaries are added or existing beneficaries are updated. \n+ */\n+\n+${logic.tablespaces-escape} SET default_tablespace = fhirdb_ts2;\n+\n+create table \"BeneficiaryMonthly\" (\n+    \"parentBeneficiary\" varchar(255) not null,\n+    \"yearMonth\" date not null,\n+    \"fipsStateCntyCode\" varchar(5),\n+    \"medicareStatusCode\" varchar(2),\n+    \"entitlementBuyInInd\" char(1),\n+    \"hmoIndicatorInd\" char(1),\n+    \"partCContractNumberId\" varchar(5),\n+    \"partCPbpNumberId\" varchar(3),\n+    \"partCPlanTypeCode\" varchar(3),\n+    \"partDContractNumberId\" varchar(5),\n+    \"partDPbpNumberId\" varchar(3),\n+    \"partDSegmentNumberId\" varchar(3),\n+    \"partDRetireeDrugSubsidyInd\" char(1),\n+    \"medicaidDualEligibilityCode\" varchar(2),\n+    \"partDLowIncomeCostShareGroupCode\" varchar(2),\n+    constraint \"BeneficiaryMonthly_pkey\" primary key (\"parentBeneficiary\", \"yearMonth\")\n+)\n+${logic.tablespaces-escape} tablespace \"beneficiarymonthly_ts\"\n+;\n+\n+\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/01/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJanCode\",\n+    \"medicareStatusJanCode\", \"entitlementBuyInJanInd\", \"hmoIndicatorJanInd\",\n+    \"partCContractNumberJanId\", \"partCPbpNumberJanId\", \"partCPlanTypeJanCode\",\n+    \"partDContractNumberJanId\", \"partDPbpNumberJanId\", \"partDSegmentNumberJanId\",\n+    \"partDRetireeDrugSubsidyJanInd\", \"medicaidDualEligibilityJanCode\", \"partDLowIncomeCostShareGroupJanCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/02/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyFebCode\",\n+    \"medicareStatusFebCode\", \"entitlementBuyInFebInd\", \"hmoIndicatorFebInd\",\n+    \"partCContractNumberFebId\", \"partCPbpNumberFebId\", \"partCPlanTypeFebCode\",\n+    \"partDContractNumberFebId\", \"partDPbpNumberFebId\", \"partDSegmentNumberFebId\",\n+    \"partDRetireeDrugSubsidyFebInd\", \"medicaidDualEligibilityFebCode\", \"partDLowIncomeCostShareGroupFebCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/03/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMarCode\",\n+    \"medicareStatusMarCode\", \"entitlementBuyInMarInd\", \"hmoIndicatorMarInd\",\n+    \"partCContractNumberMarId\", \"partCPbpNumberMarId\", \"partCPlanTypeMarCode\",\n+    \"partDContractNumberMarId\", \"partDPbpNumberMarId\", \"partDSegmentNumberMarId\",\n+    \"partDRetireeDrugSubsidyMarInd\", \"medicaidDualEligibilityMarCode\", \"partDLowIncomeCostShareGroupMarCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/04/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAprCode\",\n+    \"medicareStatusAprCode\", \"entitlementBuyInAprInd\", \"hmoIndicatorAprInd\",\n+    \"partCContractNumberAprId\", \"partCPbpNumberAprId\", \"partCPlanTypeAprCode\",\n+    \"partDContractNumberAprId\", \"partDPbpNumberAprId\", \"partDSegmentNumberAprId\",\n+    \"partDRetireeDrugSubsidyAprInd\", \"medicaidDualEligibilityAprCode\", \"partDLowIncomeCostShareGroupAprCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/05/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyMayCode\",\n+    \"medicareStatusMayCode\", \"entitlementBuyInMayInd\", \"hmoIndicatorMayInd\",\n+    \"partCContractNumberMayId\", \"partCPbpNumberMayId\", \"partCPlanTypeMayCode\",\n+    \"partDContractNumberMayId\", \"partDPbpNumberMayId\", \"partDSegmentNumberMayId\",\n+    \"partDRetireeDrugSubsidyMayInd\", \"medicaidDualEligibilityMayCode\", \"partDLowIncomeCostShareGroupMayCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/06/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyJunCode\",\n+    \"medicareStatusJunCode\", \"entitlementBuyInJunInd\", \"hmoIndicatorJunInd\",\n+    \"partCContractNumberJunId\", \"partCPbpNumberJunId\", \"partCPlanTypeJunCode\",\n+    \"partDContractNumberJunId\", \"partDPbpNumberJunId\", \"partDSegmentNumberJunId\",\n+    \"partDRetireeDrugSubsidyJunInd\", \"medicaidDualEligibilityJunCode\", \"partDLowIncomeCostShareGroupJunCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/07/01'), 'YYYY/MM/DD')as \"yearMonth\", \"fipsStateCntyJulCode\",\n+    \"medicareStatusJulCode\", \"entitlementBuyInJulInd\", \"hmoIndicatorJulInd\",\n+    \"partCContractNumberJulId\", \"partCPbpNumberJulId\", \"partCPlanTypeJulCode\",\n+    \"partDContractNumberJulId\", \"partDPbpNumberJulId\", \"partDSegmentNumberJulId\",\n+    \"partDRetireeDrugSubsidyJulInd\", \"medicaidDualEligibilityJulCode\", \"partDLowIncomeCostShareGroupJulCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/08/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyAugCode\",\n+    \"medicareStatusAugCode\", \"entitlementBuyInAugInd\", \"hmoIndicatorAugInd\",\n+    \"partCContractNumberAugId\", \"partCPbpNumberAugId\", \"partCPlanTypeAugCode\",\n+    \"partDContractNumberAugId\", \"partDPbpNumberAugId\", \"partDSegmentNumberAugId\",\n+    \"partDRetireeDrugSubsidyAugInd\", \"medicaidDualEligibilityAugCode\", \"partDLowIncomeCostShareGroupAugCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/09/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntySeptCode\",\n+    \"medicareStatusSeptCode\", \"entitlementBuyInSeptInd\", \"hmoIndicatorSeptInd\",\n+    \"partCContractNumberSeptId\", \"partCPbpNumberSeptId\", \"partCPlanTypeSeptCode\",\n+    \"partDContractNumberSeptId\", \"partDPbpNumberSeptId\", \"partDSegmentNumberSeptId\",\n+    \"partDRetireeDrugSubsidySeptInd\", \"medicaidDualEligibilitySeptCode\", \"partDLowIncomeCostShareGroupSeptCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+   SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/10/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyOctCode\",\n+    \"medicareStatusOctCode\", \"entitlementBuyInOctInd\", \"hmoIndicatorOctInd\",\n+    \"partCContractNumberOctId\", \"partCPbpNumberOctId\", \"partCPlanTypeOctCode\",\n+    \"partDContractNumberOctId\", \"partDPbpNumberOctId\", \"partDSegmentNumberOctId\",\n+    \"partDRetireeDrugSubsidyOctInd\", \"medicaidDualEligibilityOctCode\", \"partDLowIncomeCostShareGroupOctCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/11/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyNovCode\",\n+    \"medicareStatusNovCode\", \"entitlementBuyInNovInd\", \"hmoIndicatorNovInd\",\n+    \"partCContractNumberNovId\", \"partCPbpNumberNovId\", \"partCPlanTypeNovCode\",\n+    \"partDContractNumberNovId\", \"partDPbpNumberNovId\", \"partDSegmentNumberNovId\",\n+    \"partDRetireeDrugSubsidyNovInd\", \"medicaidDualEligibilityNovCode\", \"partDLowIncomeCostShareGroupNovCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;  \n+\n+INSERT INTO \"BeneficiaryMonthly\" \n+    SELECT  \"beneficiaryId\", TO_DATE(CONCAT(\"beneEnrollmentReferenceYear\", '/12/01'), 'YYYY/MM/DD') as \"yearMonth\", \"fipsStateCntyDecCode\",\n+    \"medicareStatusDecCode\", \"entitlementBuyInDecInd\", \"hmoIndicatorDecInd\",\n+    \"partCContractNumberDecId\", \"partCPbpNumberDecId\", \"partCPlanTypeDecCode\",\n+    \"partDContractNumberDecId\", \"partDPbpNumberDecId\", \"partDSegmentNumberDecId\",\n+    \"partDRetireeDrugSubsidyDecInd\", \"medicaidDualEligibilityDecCode\", \"partDLowIncomeCostShareGroupDecCode\"\n+    FROM \"Beneficiaries\"\n+    WHERE \"beneEnrollmentReferenceYear\" is not null;\n+\n+alter table \"BeneficiaryMonthly\" \n+  add constraint \"BeneficiaryMonthly_parentClaim_to_Beneficiary\" foreign key (\"parentBeneficiary\") ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1NjM3Ng=="}, "originalCommit": {"oid": "66813c5326ad1f43fd91f0bac97b2c415eb57b7e"}, "originalPosition": 140}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NjkxMDgwOnYy", "diffSide": "RIGHT", "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNDozMjoyM1rOIMGvNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNDo1MTo0NVrOIMG6hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2NDIxNA==", "bodyText": "Apologies, I'd probably explain a bit more here (folks tend to look at the DB migrations when onboarding, so it's good to explain ourselves in them).\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            /* we don't know why there are null values for this column, but we'll figure that out later in a different story.\" */\n          \n          \n            \n            /*\n          \n          \n            \n             * Per the CCW folks, the beneEnrollmentReferenceYear column is null for newer bene records that\n          \n          \n            \n             * haven't received data from all sources yet. There are over a million such records, which is a bit concerning,\n          \n          \n            \n             * but that will be addressed in a separate ticket, if needed.\n          \n          \n            \n             */", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549564214", "createdAt": "2020-12-29T04:32:23Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,141 @@\n+/*\n+ * The pipeline server will populate the table as new beneficaries are added or existing beneficaries are updated. \n+ */\n+\n+${logic.tablespaces-escape} SET default_tablespace = fhirdb_ts2;\n+\n+create table \"BeneficiaryMonthly\" (\n+    \"parentBeneficiary\" varchar(255) not null,\n+    \"yearMonth\" date not null,\n+    \"fipsStateCntyCode\" varchar(5),\n+    \"medicareStatusCode\" varchar(2),\n+    \"entitlementBuyInInd\" char(1),\n+    \"hmoIndicatorInd\" char(1),\n+    \"partCContractNumberId\" varchar(5),\n+    \"partCPbpNumberId\" varchar(3),\n+    \"partCPlanTypeCode\" varchar(3),\n+    \"partDContractNumberId\" varchar(5),\n+    \"partDPbpNumberId\" varchar(3),\n+    \"partDSegmentNumberId\" varchar(3),\n+    \"partDRetireeDrugSubsidyInd\" char(1),\n+    \"medicaidDualEligibilityCode\" varchar(2),\n+    \"partDLowIncomeCostShareGroupCode\" varchar(2),\n+    constraint \"BeneficiaryMonthly_pkey\" primary key (\"parentBeneficiary\", \"yearMonth\")\n+)\n+${logic.tablespaces-escape} tablespace \"beneficiarymonthly_ts\"\n+;\n+\n+/* we don't know why there are null values for this column, but we'll figure that out later in a different story.\" */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a615efd548e886e5d7d55d186766246a1f19c068"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2NzExMA==", "bodyText": "changed the comment", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549567110", "createdAt": "2020-12-29T04:51:45Z", "author": {"login": "cbrunefearless"}, "path": "apps/bfd-model/bfd-model-rif/src/main/resources/db/migration/V27__Create_BeneficiaryMonthlytable.sql", "diffHunk": "@@ -0,0 +1,141 @@\n+/*\n+ * The pipeline server will populate the table as new beneficaries are added or existing beneficaries are updated. \n+ */\n+\n+${logic.tablespaces-escape} SET default_tablespace = fhirdb_ts2;\n+\n+create table \"BeneficiaryMonthly\" (\n+    \"parentBeneficiary\" varchar(255) not null,\n+    \"yearMonth\" date not null,\n+    \"fipsStateCntyCode\" varchar(5),\n+    \"medicareStatusCode\" varchar(2),\n+    \"entitlementBuyInInd\" char(1),\n+    \"hmoIndicatorInd\" char(1),\n+    \"partCContractNumberId\" varchar(5),\n+    \"partCPbpNumberId\" varchar(3),\n+    \"partCPlanTypeCode\" varchar(3),\n+    \"partDContractNumberId\" varchar(5),\n+    \"partDPbpNumberId\" varchar(3),\n+    \"partDSegmentNumberId\" varchar(3),\n+    \"partDRetireeDrugSubsidyInd\" char(1),\n+    \"medicaidDualEligibilityCode\" varchar(2),\n+    \"partDLowIncomeCostShareGroupCode\" varchar(2),\n+    constraint \"BeneficiaryMonthly_pkey\" primary key (\"parentBeneficiary\", \"yearMonth\")\n+)\n+${logic.tablespaces-escape} tablespace \"beneficiarymonthly_ts\"\n+;\n+\n+/* we don't know why there are null values for this column, but we'll figure that out later in a different story.\" */", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2NDIxNA=="}, "originalCommit": {"oid": "a615efd548e886e5d7d55d186766246a1f19c068"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NjkxMTc1OnYy", "diffSide": "RIGHT", "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/SpringConfiguration.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNDozMzoxOFrOIMGvqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNDo0OTo1OFrOIMG5vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2NDMzMQ==", "bodyText": "Won't having this same change give you a merge conflict? Or is Git / GitHub smart enough to avoid that?", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549564331", "createdAt": "2020-12-29T04:33:18Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/SpringConfiguration.java", "diffHunk": "@@ -271,7 +271,7 @@ public LocalContainerEntityManagerFactoryBean entityManagerFactory(DataSource da\n   /** @return the {@link Properties} to configure Hibernate and JPA with */\n   private Properties jpaProperties() {\n     Properties extraProperties = new Properties();\n-    extraProperties.put(AvailableSettings.HBM2DDL_AUTO, Action.VALIDATE);\n+    extraProperties.put(AvailableSettings.HBM2DDL_AUTO, Action.NONE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a615efd548e886e5d7d55d186766246a1f19c068"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2NjkxMA==", "bodyText": "I believe GItHub will be smart enough after we rebase.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549566910", "createdAt": "2020-12-29T04:49:58Z", "author": {"login": "cbrunefearless"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/SpringConfiguration.java", "diffHunk": "@@ -271,7 +271,7 @@ public LocalContainerEntityManagerFactoryBean entityManagerFactory(DataSource da\n   /** @return the {@link Properties} to configure Hibernate and JPA with */\n   private Properties jpaProperties() {\n     Properties extraProperties = new Properties();\n-    extraProperties.put(AvailableSettings.HBM2DDL_AUTO, Action.VALIDATE);\n+    extraProperties.put(AvailableSettings.HBM2DDL_AUTO, Action.NONE);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2NDMzMQ=="}, "originalCommit": {"oid": "a615efd548e886e5d7d55d186766246a1f19c068"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NjkxMTk3OnYy", "diffSide": "RIGHT", "path": "apps/bfd-pipeline/bfd-pipeline-rif-load/src/main/java/gov/cms/bfd/pipeline/rif/load/RifLoader.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNDozMzoyNFrOIMGvxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNDo0OTo1NVrOIMG5vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2NDM1OQ==", "bodyText": "Won't having this same change give you a merge conflict? Or is Git / GitHub smart enough to avoid that?", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549564359", "createdAt": "2020-12-29T04:33:24Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-pipeline/bfd-pipeline-rif-load/src/main/java/gov/cms/bfd/pipeline/rif/load/RifLoader.java", "diffHunk": "@@ -174,7 +174,7 @@ public static EntityManagerFactory createEntityManagerFactory(DataSource jdbcDat\n \n     Map<String, Object> hibernateProperties = new HashMap<>();\n     hibernateProperties.put(org.hibernate.cfg.AvailableSettings.DATASOURCE, jdbcDataSource);\n-    hibernateProperties.put(org.hibernate.cfg.AvailableSettings.HBM2DDL_AUTO, Action.VALIDATE);\n+    hibernateProperties.put(org.hibernate.cfg.AvailableSettings.HBM2DDL_AUTO, Action.NONE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a615efd548e886e5d7d55d186766246a1f19c068"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2NjkwOA==", "bodyText": "I believe GItHub will be smart enough after we rebase.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/424#discussion_r549566908", "createdAt": "2020-12-29T04:49:55Z", "author": {"login": "cbrunefearless"}, "path": "apps/bfd-pipeline/bfd-pipeline-rif-load/src/main/java/gov/cms/bfd/pipeline/rif/load/RifLoader.java", "diffHunk": "@@ -174,7 +174,7 @@ public static EntityManagerFactory createEntityManagerFactory(DataSource jdbcDat\n \n     Map<String, Object> hibernateProperties = new HashMap<>();\n     hibernateProperties.put(org.hibernate.cfg.AvailableSettings.DATASOURCE, jdbcDataSource);\n-    hibernateProperties.put(org.hibernate.cfg.AvailableSettings.HBM2DDL_AUTO, Action.VALIDATE);\n+    hibernateProperties.put(org.hibernate.cfg.AvailableSettings.HBM2DDL_AUTO, Action.NONE);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2NDM1OQ=="}, "originalCommit": {"oid": "a615efd548e886e5d7d55d186766246a1f19c068"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 203, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}