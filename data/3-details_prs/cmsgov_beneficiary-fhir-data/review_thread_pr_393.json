{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5MjY5MjYw", "number": 393, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxNjoyOTo0OVrOE4u-3w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMDo0NTowMVrOE407Lg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3OTI1NDcxOnYy", "diffSide": "RIGHT", "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/r4/providers/R4PatientResourceProvider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxNjoyOTo0OVrOHy1M8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxNzoyMDo1NlrOHy3q4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzA2MjUxMw==", "bodyText": "Definitely looks broken, and doesn't match the V1 logic.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                boolean hasAnotherPage = matchingBeneficiaries.size() == paging.getPageSize();\n          \n          \n            \n                boolean hasAnotherPage = matchingBeneficiaries.size() > paging.getPageSize();", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r523062513", "createdAt": "2020-11-13T16:29:49Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/r4/providers/R4PatientResourceProvider.java", "diffHunk": "@@ -269,6 +269,13 @@ public Bundle searchByCoverageContract(\n     List<Beneficiary> matchingBeneficiaries =\n         fetchBeneficiaries(coverageId, includeIdentifiersValues, paging);\n \n+    // Insures backwards compatability\n+    boolean hasAnotherPage = matchingBeneficiaries.size() == paging.getPageSize();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9aa32d5fb490f2b4cd3d037468af1e104cbdf21"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzEwMjk0Nw==", "bodyText": "fix that", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r523102947", "createdAt": "2020-11-13T17:20:56Z", "author": {"login": "cbrunefearless"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/r4/providers/R4PatientResourceProvider.java", "diffHunk": "@@ -269,6 +269,13 @@ public Bundle searchByCoverageContract(\n     List<Beneficiary> matchingBeneficiaries =\n         fetchBeneficiaries(coverageId, includeIdentifiersValues, paging);\n \n+    // Insures backwards compatability\n+    boolean hasAnotherPage = matchingBeneficiaries.size() == paging.getPageSize();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzA2MjUxMw=="}, "originalCommit": {"oid": "a9aa32d5fb490f2b4cd3d037468af1e104cbdf21"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3OTI3NTgxOnYy", "diffSide": "RIGHT", "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxNjozNToxMFrOHy1aHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxODowMDowMVrOHy5QgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzA2NTg4Nw==", "bodyText": "Just a note: I haven't tested this at all, so please make sure you do.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r523065887", "createdAt": "2020-11-13T16:35:10Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java", "diffHunk": "@@ -454,7 +459,7 @@ private String partDFieldFor(CcwCodebookVariable month) {\n     if (hasHICN(identifiers)) joinsClause += \"left join fetch b.beneficiaryHistories \";\n \n     String query =\n-        \"select b from Beneficiary b \"\n+        \"select distinct b from Beneficiary b \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9aa32d5fb490f2b4cd3d037468af1e104cbdf21"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzEwMzAwNg==", "bodyText": "fix that", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r523103006", "createdAt": "2020-11-13T17:21:02Z", "author": {"login": "cbrunefearless"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java", "diffHunk": "@@ -454,7 +459,7 @@ private String partDFieldFor(CcwCodebookVariable month) {\n     if (hasHICN(identifiers)) joinsClause += \"left join fetch b.beneficiaryHistories \";\n \n     String query =\n-        \"select b from Beneficiary b \"\n+        \"select distinct b from Beneficiary b \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzA2NTg4Nw=="}, "originalCommit": {"oid": "a9aa32d5fb490f2b4cd3d037468af1e104cbdf21"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzEyODk2MQ==", "bodyText": "?", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r523128961", "createdAt": "2020-11-13T18:00:01Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java", "diffHunk": "@@ -454,7 +459,7 @@ private String partDFieldFor(CcwCodebookVariable month) {\n     if (hasHICN(identifiers)) joinsClause += \"left join fetch b.beneficiaryHistories \";\n \n     String query =\n-        \"select b from Beneficiary b \"\n+        \"select distinct b from Beneficiary b \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzA2NTg4Nw=="}, "originalCommit": {"oid": "a9aa32d5fb490f2b4cd3d037468af1e104cbdf21"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3OTI4MjI2OnYy", "diffSide": "RIGHT", "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxNjozNjo0M1rOHy1ePQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxNzoyMToxMVrOHy3rhA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzA2Njk0MQ==", "bodyText": "This same change would also be needed in the V2 resource provider.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r523066941", "createdAt": "2020-11-13T16:36:43Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java", "diffHunk": "@@ -454,7 +459,7 @@ private String partDFieldFor(CcwCodebookVariable month) {\n     if (hasHICN(identifiers)) joinsClause += \"left join fetch b.beneficiaryHistories \";\n \n     String query =\n-        \"select b from Beneficiary b \"\n+        \"select distinct b from Beneficiary b \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9aa32d5fb490f2b4cd3d037468af1e104cbdf21"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzEwMzEwOA==", "bodyText": "fix that", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r523103108", "createdAt": "2020-11-13T17:21:11Z", "author": {"login": "cbrunefearless"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java", "diffHunk": "@@ -454,7 +459,7 @@ private String partDFieldFor(CcwCodebookVariable month) {\n     if (hasHICN(identifiers)) joinsClause += \"left join fetch b.beneficiaryHistories \";\n \n     String query =\n-        \"select b from Beneficiary b \"\n+        \"select distinct b from Beneficiary b \"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzA2Njk0MQ=="}, "originalCommit": {"oid": "a9aa32d5fb490f2b4cd3d037468af1e104cbdf21"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI3OTY3MjIzOnYy", "diffSide": "RIGHT", "path": "apps/bfd-server/bfd-server-war/src/test/java/gov/cms/bfd/server/war/stu3/providers/PatientLinkBuilderTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QxODowMTo1NFrOHy5UXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xNlQxNTozOTo0NVrOH0EevA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzEyOTk0OA==", "bodyText": "I think you should consider adding a unit test for the distinct issue, if you can. Not a hard requirement; just a suggestion.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r523129948", "createdAt": "2020-11-13T18:01:54Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-server/bfd-server-war/src/test/java/gov/cms/bfd/server/war/stu3/providers/PatientLinkBuilderTest.java", "diffHunk": "@@ -103,6 +103,28 @@ public void fullPageTest() {\n     Assert.assertTrue(bundle.getLink().isEmpty());\n     paging.addLinks(bundle);\n \n+    Assert.assertNotNull(bundle.getLink(Constants.LINK_SELF));\n+    Assert.assertNotNull(bundle.getLink(Constants.LINK_FIRST));\n+    Assert.assertNull(bundle.getLink(Constants.LINK_NEXT));\n+  }\n+\n+  @Test\n+  public void fullPageTestWithPaging() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3095919d32c7038fc4be8103152cada307c50145"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDM2MTQwNA==", "bodyText": "FYI: We took care of this on Zoom last Friday.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r524361404", "createdAt": "2020-11-16T15:39:45Z", "author": {"login": "karlmdavis"}, "path": "apps/bfd-server/bfd-server-war/src/test/java/gov/cms/bfd/server/war/stu3/providers/PatientLinkBuilderTest.java", "diffHunk": "@@ -103,6 +103,28 @@ public void fullPageTest() {\n     Assert.assertTrue(bundle.getLink().isEmpty());\n     paging.addLinks(bundle);\n \n+    Assert.assertNotNull(bundle.getLink(Constants.LINK_SELF));\n+    Assert.assertNotNull(bundle.getLink(Constants.LINK_FIRST));\n+    Assert.assertNull(bundle.getLink(Constants.LINK_NEXT));\n+  }\n+\n+  @Test\n+  public void fullPageTestWithPaging() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzEyOTk0OA=="}, "originalCommit": {"oid": "3095919d32c7038fc4be8103152cada307c50145"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI4MDIyODMwOnYy", "diffSide": "RIGHT", "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/r4/providers/R4PatientResourceProvider.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMDo0NTowMVrOHy-pbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QyMDo0NTowMVrOHy-pbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzIxNzI2MA==", "bodyText": "Delete this comment as when we originally modified this file, we did not apply the +1 fix.  Now that the fix has been applied, this comment no longer applies.", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/393#discussion_r523217260", "createdAt": "2020-11-13T20:45:01Z", "author": {"login": "nflearl"}, "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/r4/providers/R4PatientResourceProvider.java", "diffHunk": "@@ -269,6 +269,13 @@ public Bundle searchByCoverageContract(\n     List<Beneficiary> matchingBeneficiaries =\n         fetchBeneficiaries(coverageId, includeIdentifiersValues, paging);\n \n+    // Insures backwards compatability", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a7000431ec769cc9ed8e83e0b774db3f51750194"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 187, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}