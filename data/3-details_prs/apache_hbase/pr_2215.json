{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY0ODkwNjg1", "number": 2215, "title": "HBASE-24627 Normalize one table at a time", "bodyText": "Introduce an additional method to our Admin interface that allow an\noperator to selectivly run the normalizer. The IPC protocol supports\ngeneral table name select via compound filter.", "createdAt": "2020-08-07T23:54:00Z", "url": "https://github.com/apache/hbase/pull/2215", "merged": true, "mergeCommit": {"oid": "ecc0c6707784da442d22b92569308240c6cc1723"}, "closed": true, "closedAt": "2020-08-18T16:46:30Z", "author": {"login": "ndimiduk"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8uUiMAFqTQ2MzcwMTE1NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAJ2sJgBqjM2NjcyMzQwNTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzNzAxMTU1", "url": "https://github.com/apache/hbase/pull/2215#pullrequestreview-463701155", "createdAt": "2020-08-08T00:45:39Z", "commit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwMDo0NTozOVrOG9sIiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQwMDo1NzowOVrOG9sOZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMzOTQwMQ==", "bodyText": "This constructor should either not be public or should have a IA marker that it isn't public", "url": "https://github.com/apache/hbase/pull/2215#discussion_r467339401", "createdAt": "2020-08-08T00:45:39Z", "author": {"login": "busbey"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/NormalizeTableFilterParams.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.client;\n+\n+import java.util.List;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.yetus.audience.InterfaceAudience;\n+import org.apache.yetus.audience.InterfaceStability;\n+\n+/**\n+ * A collection of criteria used for table selection.\n+ */\n+@InterfaceAudience.Public\n+@InterfaceStability.Evolving\n+public class NormalizeTableFilterParams {\n+  private final List<TableName> tableNames;\n+  private final String regex;\n+  private final String namespace;\n+\n+  public NormalizeTableFilterParams(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0MDM5NA==", "bodyText": "What does it mean if these are all empty?\nHow are they handled if multiple are set?", "url": "https://github.com/apache/hbase/pull/2215#discussion_r467340394", "createdAt": "2020-08-08T00:53:12Z", "author": {"login": "busbey"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/NormalizeTableFilterParams.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.client;\n+\n+import java.util.List;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.yetus.audience.InterfaceAudience;\n+import org.apache.yetus.audience.InterfaceStability;\n+\n+/**\n+ * A collection of criteria used for table selection.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0MDkwMA==", "bodyText": "Please do this sorting in a different jira", "url": "https://github.com/apache/hbase/pull/2215#discussion_r467340900", "createdAt": "2020-08-08T00:57:09Z", "author": {"login": "busbey"}, "path": "hbase-shell/src/main/ruby/hbase_constants.rb", "diffHunk": "@@ -32,75 +32,79 @@\n java_import('java.lang.Boolean') { |_package, name| \"J#{name}\" }\n \n module HBaseConstants\n+  ALLOW_PARTIAL_RESULTS = 'ALLOW_PARTIAL_RESULTS'.freeze", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzODExODUz", "url": "https://github.com/apache/hbase/pull/2215#pullrequestreview-463811853", "createdAt": "2020-08-08T16:05:33Z", "commit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQxNjowNTozM1rOG90p-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOFQxNzoxMTo0OFrOG91BLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ3OTAzMw==", "bodyText": "Better to make it private only I believe.", "url": "https://github.com/apache/hbase/pull/2215#discussion_r467479033", "createdAt": "2020-08-08T16:05:33Z", "author": {"login": "virajjasani"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/NormalizeTableFilterParams.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.client;\n+\n+import java.util.List;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.yetus.audience.InterfaceAudience;\n+import org.apache.yetus.audience.InterfaceStability;\n+\n+/**\n+ * A collection of criteria used for table selection.\n+ */\n+@InterfaceAudience.Public\n+@InterfaceStability.Evolving\n+public class NormalizeTableFilterParams {\n+  private final List<TableName> tableNames;\n+  private final String regex;\n+  private final String namespace;\n+\n+  public NormalizeTableFilterParams(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMzOTQwMQ=="}, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4NDMzNg==", "bodyText": "nit: we can remove type arg <>", "url": "https://github.com/apache/hbase/pull/2215#discussion_r467484336", "createdAt": "2020-08-08T17:04:44Z", "author": {"login": "virajjasani"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/RawAsyncHBaseAdmin.java", "diffHunk": "@@ -3279,13 +3279,22 @@ private void getProcedureResult(long procId, CompletableFuture<Void> future, int\n \n   @Override\n   public CompletableFuture<Boolean> normalize() {\n+    return normalize(RequestConverter.buildNormalizeRequest());\n+  }\n+\n+  @Override\n+  public CompletableFuture<Boolean> normalize(NormalizeTableFilterParams ntfp) {\n+    return normalize(RequestConverter.buildNormalizeRequest(ntfp));\n+  }\n+\n+  private CompletableFuture<Boolean> normalize(NormalizeRequest request) {\n     return this\n-        .<Boolean> newMasterCaller()\n-        .action(\n-          (controller, stub) -> this.<NormalizeRequest, NormalizeResponse, Boolean> call(\n-            controller, stub, RequestConverter.buildNormalizeRequest(),\n-            (s, c, req, done) -> s.normalize(c, req, done), (resp) -> resp.getNormalizerRan()))\n-        .call();\n+      .<Boolean> newMasterCaller()\n+      .action(\n+        (controller, stub) -> this.<NormalizeRequest, NormalizeResponse, Boolean> call(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4NDQ4Ng==", "bodyText": "nit: Collections.emptyList() ?", "url": "https://github.com/apache/hbase/pull/2215#discussion_r467484486", "createdAt": "2020-08-08T17:06:31Z", "author": {"login": "virajjasani"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/shaded/protobuf/ProtobufUtil.java", "diffHunk": "@@ -2293,6 +2293,13 @@ public static TableName toTableName(HBaseProtos.TableName tableNamePB) {\n         .setQualifier(UnsafeByteOperations.unsafeWrap(tableName.getQualifier())).build();\n   }\n \n+  public static List<HBaseProtos.TableName> toProtoTableNameList(List<TableName> tableNameList) {\n+    if (tableNameList == null) {\n+      return new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4NDk3NA==", "bodyText": "Since this is being called by chore continuously, maybe we can create a constant and use it?", "url": "https://github.com/apache/hbase/pull/2215#discussion_r467484974", "createdAt": "2020-08-08T17:11:48Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -1908,14 +1907,18 @@ public RegionNormalizer getRegionNormalizer() {\n     return this.normalizer;\n   }\n \n+  public boolean normalizeRegions() throws IOException {\n+    return normalizeRegions(new NormalizeTableFilterParams.Builder().build());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 48}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0OTk0Mzg0", "url": "https://github.com/apache/hbase/pull/2215#pullrequestreview-464994384", "createdAt": "2020-08-11T11:57:32Z", "commit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxMTo1NzozMlrOG-0gJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxMjoxMTowN1rOG-08vA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODUyNTA5Mg==", "bodyText": "Usually don't we want to provide only one way of creating objects? Exposing both doesn't harm anyway but I have hardly seen any class exposing both: constructor and builder class. Or do we follow this in HBase somewhere?", "url": "https://github.com/apache/hbase/pull/2215#discussion_r468525092", "createdAt": "2020-08-11T11:57:32Z", "author": {"login": "virajjasani"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/NormalizeTableFilterParams.java", "diffHunk": "@@ -0,0 +1,91 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.client;\n+\n+import java.util.List;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.yetus.audience.InterfaceAudience;\n+import org.apache.yetus.audience.InterfaceStability;\n+\n+/**\n+ * A collection of criteria used for table selection.\n+ */\n+@InterfaceAudience.Public\n+@InterfaceStability.Evolving\n+public class NormalizeTableFilterParams {\n+  private final List<TableName> tableNames;\n+  private final String regex;\n+  private final String namespace;\n+\n+  public NormalizeTableFilterParams(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzMzOTQwMQ=="}, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODUyNjc0Ng==", "bodyText": "Yeah you are right, GC'ing sounds better. Thanks.", "url": "https://github.com/apache/hbase/pull/2215#discussion_r468526746", "createdAt": "2020-08-11T12:00:41Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -1908,14 +1907,18 @@ public RegionNormalizer getRegionNormalizer() {\n     return this.normalizer;\n   }\n \n+  public boolean normalizeRegions() throws IOException {\n+    return normalizeRegions(new NormalizeTableFilterParams.Builder().build());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4NDk3NA=="}, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODUzMjQxMg==", "bodyText": "For the purpose of this PR, if we return non-modifiable collection, getTableDescriptors in HMaster will interpret it as expected: if (tableNameList == null || tableNameList.isEmpty()) {, however since this is generic method and we are following the same approach for majority of util methods on this class, we can keep it same way.\nAll good here.\n\nEven if not, probably these ArrayLists should be replaced with LinkedList.\n\nYou meant as separate task right? +1", "url": "https://github.com/apache/hbase/pull/2215#discussion_r468532412", "createdAt": "2020-08-11T12:11:07Z", "author": {"login": "virajjasani"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/shaded/protobuf/ProtobufUtil.java", "diffHunk": "@@ -2293,6 +2293,13 @@ public static TableName toTableName(HBaseProtos.TableName tableNamePB) {\n         .setQualifier(UnsafeByteOperations.unsafeWrap(tableName.getQualifier())).build();\n   }\n \n+  public static List<HBaseProtos.TableName> toProtoTableNameList(List<TableName> tableNameList) {\n+    if (tableNameList == null) {\n+      return new ArrayList<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzQ4NDQ4Ng=="}, "originalCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e415f721ab98e4ee72dc8aaf00ddcbd7b07da429", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/e415f721ab98e4ee72dc8aaf00ddcbd7b07da429", "committedDate": "2020-08-07T23:51:12Z", "message": "HBASE-24627 Normalize one table at a time\n\nIntroduce an additional method to our Admin interface that allow an\noperator to selectivly run the normalizer. The IPC protocol supports\ngeneral table name select via compound filter."}, "afterCommit": {"oid": "0335733e4ce0420288f60c05e3269805783afda4", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/0335733e4ce0420288f60c05e3269805783afda4", "committedDate": "2020-08-11T23:22:23Z", "message": "HBASE-24627 Normalize one table at a time\n\nIntroduce an additional method to our Admin interface that allow an\noperator to selectivly run the normalizer. The IPC protocol supports\ngeneral table name select via compound filter."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0335733e4ce0420288f60c05e3269805783afda4", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/0335733e4ce0420288f60c05e3269805783afda4", "committedDate": "2020-08-11T23:22:23Z", "message": "HBASE-24627 Normalize one table at a time\n\nIntroduce an additional method to our Admin interface that allow an\noperator to selectivly run the normalizer. The IPC protocol supports\ngeneral table name select via compound filter."}, "afterCommit": {"oid": "111552c554b4418621e677faff87f2e248736e46", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/111552c554b4418621e677faff87f2e248736e46", "committedDate": "2020-08-11T23:59:18Z", "message": "HBASE-24627 Normalize one table at a time\n\nIntroduce an additional method to our Admin interface that allow an\noperator to selectivly run the normalizer. The IPC protocol supports\ngeneral table name select via compound filter."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NjgwNjM1", "url": "https://github.com/apache/hbase/pull/2215#pullrequestreview-465680635", "createdAt": "2020-08-12T08:03:45Z", "commit": {"oid": "111552c554b4418621e677faff87f2e248736e46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "111552c554b4418621e677faff87f2e248736e46", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/111552c554b4418621e677faff87f2e248736e46", "committedDate": "2020-08-11T23:59:18Z", "message": "HBASE-24627 Normalize one table at a time\n\nIntroduce an additional method to our Admin interface that allow an\noperator to selectivly run the normalizer. The IPC protocol supports\ngeneral table name select via compound filter."}, "afterCommit": {"oid": "d6d1a0999b2e0bed0e183b5d544469f375e333ae", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/d6d1a0999b2e0bed0e183b5d544469f375e333ae", "committedDate": "2020-08-13T21:53:29Z", "message": "address checkstyle and some rubocop warnings"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3MzAxNzQw", "url": "https://github.com/apache/hbase/pull/2215#pullrequestreview-467301740", "createdAt": "2020-08-14T04:36:27Z", "commit": {"oid": "d6d1a0999b2e0bed0e183b5d544469f375e333ae"}, "state": "APPROVED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQwNDozNjoyN1rOHAnRAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xNFQwNDo0OTozNVrOHAnczA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQwNTM3OA==", "bodyText": "excellent summary!", "url": "https://github.com/apache/hbase/pull/2215#discussion_r470405378", "createdAt": "2020-08-14T04:36:27Z", "author": {"login": "busbey"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/NormalizeTableFilterParams.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.client;\n+\n+import java.util.List;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.yetus.audience.InterfaceAudience;\n+import org.apache.yetus.audience.InterfaceStability;\n+\n+/**\n+ * A collection of criteria used for table selection. The logic of table selection is as follows:\n+ * <ul>\n+ *   <li>\n+ *     When no parameter values are provided, an unfiltered list of all user tables is returned.\n+ *   </li>\n+ *   <li>\n+ *     When a list of {@link TableName TableNames} are provided, the filter starts with any of\n+ *     these tables that exist.\n+ *   </li>\n+ *   <li>\n+ *     When a {@code namespace} name is provided, the filter starts with all the tables present in\n+ *     that namespace.\n+ *   </li>\n+ *   <li>\n+ *     If both a list of {@link TableName TableNames} and a {@code namespace} name are provided,\n+ *     the {@link TableName} list is honored and the {@code namespace} name is ignored.\n+ *   </li>\n+ *   <li>\n+ *     If a {@code regex} is provided, this subset of {@link TableName TableNames} is further\n+ *     reduced to those that match the provided regular expression.\n+ *   </li>\n+ * </ul>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6d1a0999b2e0bed0e183b5d544469f375e333ae"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQwNTc5MQ==", "bodyText": "nit: our API surface docs say that anything labeled IA.Public is inherently IS.Stable and shouldn't carry a label.", "url": "https://github.com/apache/hbase/pull/2215#discussion_r470405791", "createdAt": "2020-08-14T04:38:20Z", "author": {"login": "busbey"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/NormalizeTableFilterParams.java", "diffHunk": "@@ -0,0 +1,109 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.client;\n+\n+import java.util.List;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.yetus.audience.InterfaceAudience;\n+import org.apache.yetus.audience.InterfaceStability;\n+\n+/**\n+ * A collection of criteria used for table selection. The logic of table selection is as follows:\n+ * <ul>\n+ *   <li>\n+ *     When no parameter values are provided, an unfiltered list of all user tables is returned.\n+ *   </li>\n+ *   <li>\n+ *     When a list of {@link TableName TableNames} are provided, the filter starts with any of\n+ *     these tables that exist.\n+ *   </li>\n+ *   <li>\n+ *     When a {@code namespace} name is provided, the filter starts with all the tables present in\n+ *     that namespace.\n+ *   </li>\n+ *   <li>\n+ *     If both a list of {@link TableName TableNames} and a {@code namespace} name are provided,\n+ *     the {@link TableName} list is honored and the {@code namespace} name is ignored.\n+ *   </li>\n+ *   <li>\n+ *     If a {@code regex} is provided, this subset of {@link TableName TableNames} is further\n+ *     reduced to those that match the provided regular expression.\n+ *   </li>\n+ * </ul>\n+ */\n+@InterfaceAudience.Public\n+@InterfaceStability.Evolving", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6d1a0999b2e0bed0e183b5d544469f375e333ae"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQwODM0NA==", "bodyText": "nit: could we add a default method here that calls normalize(NormalizeTableFilterParams) with an empty set of NTFparams? seems like we could clean up some stuff in the various *Admin implementations and RequestConverter", "url": "https://github.com/apache/hbase/pull/2215#discussion_r470408344", "createdAt": "2020-08-14T04:49:16Z", "author": {"login": "busbey"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/Admin.java", "diffHunk": "@@ -856,11 +856,23 @@ void unassign(byte[] regionName, boolean force)\n    * the request was submitted successfully. We need to check logs for the details of which regions\n    * were split/merged.\n    *\n-   * @return <code>true</code> if region normalizer ran, <code>false</code> otherwise.\n+   * @return {@code true} if region normalizer ran, {@code false} otherwise.\n    * @throws IOException if a remote or network exception occurs\n    */\n   boolean normalize() throws IOException;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6d1a0999b2e0bed0e183b5d544469f375e333ae"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQwODM5Ng==", "bodyText": "nit: could we add a default method here that calls normalize(NormalizeTableFilterParams) with an empty set of NTFparams? seems like we could clean up some stuff in the various *Admin implementations and RequestConverter", "url": "https://github.com/apache/hbase/pull/2215#discussion_r470408396", "createdAt": "2020-08-14T04:49:35Z", "author": {"login": "busbey"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/AsyncAdmin.java", "diffHunk": "@@ -1281,6 +1281,14 @@\n    */\n   CompletableFuture<Boolean> normalize();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d6d1a0999b2e0bed0e183b5d544469f375e333ae"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6d1a0999b2e0bed0e183b5d544469f375e333ae", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/d6d1a0999b2e0bed0e183b5d544469f375e333ae", "committedDate": "2020-08-13T21:53:29Z", "message": "address checkstyle and some rubocop warnings"}, "afterCommit": {"oid": "ac0a4b6e2453cb8b1aeeb26e2d79a0c9cf392c04", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/ac0a4b6e2453cb8b1aeeb26e2d79a0c9cf392c04", "committedDate": "2020-08-17T22:11:33Z", "message": "address Busbey nits and more rubocop issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2eb3c7ac434b7ce968ed6479c471dc93dc695d8f", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/2eb3c7ac434b7ce968ed6479c471dc93dc695d8f", "committedDate": "2020-08-18T16:42:33Z", "message": "HBASE-24627 Normalize one table at a time\n\nIntroduce an additional method to our Admin interface that allow an\noperator to selectivly run the normalizer. The IPC protocol supports\ngeneral table name select via compound filter.\n\nSigned-off-by: Sean Busbey <busbey@apache.org>\nSigned-off-by: Viraj Jasani <vjasani@apache.org>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac0a4b6e2453cb8b1aeeb26e2d79a0c9cf392c04", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/ac0a4b6e2453cb8b1aeeb26e2d79a0c9cf392c04", "committedDate": "2020-08-17T22:11:33Z", "message": "address Busbey nits and more rubocop issues"}, "afterCommit": {"oid": "2eb3c7ac434b7ce968ed6479c471dc93dc695d8f", "author": {"user": {"login": "ndimiduk", "name": "Nick Dimiduk"}}, "url": "https://github.com/apache/hbase/commit/2eb3c7ac434b7ce968ed6479c471dc93dc695d8f", "committedDate": "2020-08-18T16:42:33Z", "message": "HBASE-24627 Normalize one table at a time\n\nIntroduce an additional method to our Admin interface that allow an\noperator to selectivly run the normalizer. The IPC protocol supports\ngeneral table name select via compound filter.\n\nSigned-off-by: Sean Busbey <busbey@apache.org>\nSigned-off-by: Viraj Jasani <vjasani@apache.org>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4824, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}