{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMTc3ODcz", "number": 1012, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwMzowNzowN1rODXCrXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwMzowODoxMVrODXCr4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NDg3NzEwOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwMzowNzowN1rOFcJQeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwNzozMjo0MFrOFcMHCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA1NjEyMA==", "bodyText": "Do we need the ROW_INDEX_V1 encoding on all CFs?", "url": "https://github.com/apache/hbase/pull/1012#discussion_r365056120", "createdAt": "2020-01-10T03:07:07Z", "author": {"login": "anoopsjohn"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java", "diffHunk": "@@ -158,25 +158,22 @@ public static TableDescriptorBuilder createMetaTableDescriptorBuilder(final Conf\n         .setBlocksize(conf.getInt(HConstants.HBASE_META_BLOCK_SIZE,\n                 HConstants.DEFAULT_HBASE_META_BLOCK_SIZE))\n         .setScope(HConstants.REPLICATION_SCOPE_LOCAL)\n-        // Disable blooms for meta.  Needs work.  Seems to mess w/ getClosestOrBefore.\n-        .setBloomFilterType(BloomType.NONE)\n+        .setDataBlockEncoding(org.apache.hadoop.hbase.io.encoding.DataBlockEncoding.ROW_INDEX_V1)\n         .build())\n       .setColumnFamily(ColumnFamilyDescriptorBuilder.newBuilder(HConstants.TABLE_FAMILY)\n         .setMaxVersions(conf.getInt(HConstants.HBASE_META_VERSIONS,\n             HConstants.DEFAULT_HBASE_META_VERSIONS))\n         .setInMemory(true)\n         .setBlocksize(8 * 1024)\n         .setScope(HConstants.REPLICATION_SCOPE_LOCAL)\n-        // Disable blooms for meta.  Needs work.  Seems to mess w/ getClosestOrBefore.\n-        .setBloomFilterType(BloomType.NONE)\n+        .setDataBlockEncoding(org.apache.hadoop.hbase.io.encoding.DataBlockEncoding.ROW_INDEX_V1)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "228b6d2364a4183922fc5d9218a7db6bb9c374c5"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTEwMjg1OA==", "bodyText": "Dunno. Figured they all mostly random lookups so thought they'd all benefit.", "url": "https://github.com/apache/hbase/pull/1012#discussion_r365102858", "createdAt": "2020-01-10T07:32:40Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java", "diffHunk": "@@ -158,25 +158,22 @@ public static TableDescriptorBuilder createMetaTableDescriptorBuilder(final Conf\n         .setBlocksize(conf.getInt(HConstants.HBASE_META_BLOCK_SIZE,\n                 HConstants.DEFAULT_HBASE_META_BLOCK_SIZE))\n         .setScope(HConstants.REPLICATION_SCOPE_LOCAL)\n-        // Disable blooms for meta.  Needs work.  Seems to mess w/ getClosestOrBefore.\n-        .setBloomFilterType(BloomType.NONE)\n+        .setDataBlockEncoding(org.apache.hadoop.hbase.io.encoding.DataBlockEncoding.ROW_INDEX_V1)\n         .build())\n       .setColumnFamily(ColumnFamilyDescriptorBuilder.newBuilder(HConstants.TABLE_FAMILY)\n         .setMaxVersions(conf.getInt(HConstants.HBASE_META_VERSIONS,\n             HConstants.DEFAULT_HBASE_META_VERSIONS))\n         .setInMemory(true)\n         .setBlocksize(8 * 1024)\n         .setScope(HConstants.REPLICATION_SCOPE_LOCAL)\n-        // Disable blooms for meta.  Needs work.  Seems to mess w/ getClosestOrBefore.\n-        .setBloomFilterType(BloomType.NONE)\n+        .setDataBlockEncoding(org.apache.hadoop.hbase.io.encoding.DataBlockEncoding.ROW_INDEX_V1)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA1NjEyMA=="}, "originalCommit": {"oid": "228b6d2364a4183922fc5d9218a7db6bb9c374c5"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI1NDg3ODQzOnYy", "diffSide": "LEFT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwMzowODoxMVrOFcJRLA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xMFQwNzozNTo0NFrOFcMJ3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA1NjMwMA==", "bodyText": "So we use ROW bloom which is the default. The above comment is no longer applies (or its equivalent API usage)", "url": "https://github.com/apache/hbase/pull/1012#discussion_r365056300", "createdAt": "2020-01-10T03:08:11Z", "author": {"login": "anoopsjohn"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java", "diffHunk": "@@ -158,25 +158,22 @@ public static TableDescriptorBuilder createMetaTableDescriptorBuilder(final Conf\n         .setBlocksize(conf.getInt(HConstants.HBASE_META_BLOCK_SIZE,\n                 HConstants.DEFAULT_HBASE_META_BLOCK_SIZE))\n         .setScope(HConstants.REPLICATION_SCOPE_LOCAL)\n-        // Disable blooms for meta.  Needs work.  Seems to mess w/ getClosestOrBefore.\n-        .setBloomFilterType(BloomType.NONE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "228b6d2364a4183922fc5d9218a7db6bb9c374c5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTEwMzU4Mw==", "bodyText": "Do you mean this comment?\n     // Disable blooms for meta.  Needs work.  Seems to mess w/ getClosestOrBefore.", "url": "https://github.com/apache/hbase/pull/1012#discussion_r365103583", "createdAt": "2020-01-10T07:35:44Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java", "diffHunk": "@@ -158,25 +158,22 @@ public static TableDescriptorBuilder createMetaTableDescriptorBuilder(final Conf\n         .setBlocksize(conf.getInt(HConstants.HBASE_META_BLOCK_SIZE,\n                 HConstants.DEFAULT_HBASE_META_BLOCK_SIZE))\n         .setScope(HConstants.REPLICATION_SCOPE_LOCAL)\n-        // Disable blooms for meta.  Needs work.  Seems to mess w/ getClosestOrBefore.\n-        .setBloomFilterType(BloomType.NONE)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTA1NjMwMA=="}, "originalCommit": {"oid": "228b6d2364a4183922fc5d9218a7db6bb9c374c5"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2223, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}