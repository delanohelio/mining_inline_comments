{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5Mjg3MDg4", "number": 1203, "title": "HBASE-23878 : Backport HBASE-22040 to branch-2.1", "bodyText": "HBASE-22040 - Add mergeRegionsAsync with a List of region names method in AsyncAdmin", "createdAt": "2020-02-24T23:39:52Z", "url": "https://github.com/apache/hbase/pull/1203", "merged": true, "mergeCommit": {"oid": "e15525fcec3e6012b4c32b31f80238cedc689875"}, "closed": true, "closedAt": "2020-02-27T19:08:56Z", "author": {"login": "jatsakthi"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHmP-yAH2gAyMzc5Mjg3MDg4OjdlMjM2ZWNhOGFiODdjMTkzOGYwYTI3ZDkwMzI5ZDFhZDYxNmEwZWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIYatHABqjMwNzcxOTUxMjg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7e236eca8ab87c1938f0a27d90329d1ad616a0ef", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/7e236eca8ab87c1938f0a27d90329d1ad616a0ef", "committedDate": "2020-02-24T23:37:24Z", "message": "HBASE-23878 : Backport HBASE-22040 to branch-2.1\n\nHBASE-22040 - Add mergeRegionsAsync with a List of region names method in AsyncAdmin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13da56ca9dc1c3f709874b2f1a6543e0137afbc9", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/13da56ca9dc1c3f709874b2f1a6543e0137afbc9", "committedDate": "2020-02-25T16:51:04Z", "message": "Fix checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0OTg2MDM3", "url": "https://github.com/apache/hbase/pull/1203#pullrequestreview-364986037", "createdAt": "2020-02-26T15:18:32Z", "commit": {"oid": "13da56ca9dc1c3f709874b2f1a6543e0137afbc9"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxNToxODozMlrOFuvr4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxNToyODowNFrOFuwHLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDU2MDA5Nw==", "bodyText": "this version number will need to be updated", "url": "https://github.com/apache/hbase/pull/1203#discussion_r384560097", "createdAt": "2020-02-26T15:18:32Z", "author": {"login": "busbey"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/Admin.java", "diffHunk": "@@ -1282,29 +1282,31 @@ void mergeRegions(byte[] nameOfRegionA, byte[] nameOfRegionB,\n \n   /**\n    * Merge two regions. Asynchronous operation.\n-   *\n    * @param nameOfRegionA encoded or full name of region a\n    * @param nameOfRegionB encoded or full name of region b\n-   * @param forcible <code>true</code> if do a compulsory merge, otherwise we will only merge\n-   *          two adjacent regions\n-   * @throws IOException\n+   * @param forcible <code>true</code> if do a compulsory merge, otherwise we will only merge two\n+   *          adjacent regions\n    */\n-  Future<Void> mergeRegionsAsync(\n-      byte[] nameOfRegionA,\n-      byte[] nameOfRegionB,\n-      boolean forcible) throws IOException;\n+  default Future<Void> mergeRegionsAsync(byte[] nameOfRegionA, byte[] nameOfRegionB,\n+      boolean forcible) throws IOException {\n+    byte[][] nameofRegionsToMerge = new byte[2][];\n+    nameofRegionsToMerge[0] = nameOfRegionA;\n+    nameofRegionsToMerge[1] = nameOfRegionB;\n+    return mergeRegionsAsync(nameofRegionsToMerge, forcible);\n+  }\n \n   /**\n    * Merge regions. Asynchronous operation.\n-   *\n+   * <p/>\n+   * You may get a {@code DoNotRetryIOException} if you pass more than two regions in but the master\n+   * does not support merging more than two regions. At least till 2.2.0, we still only support", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13da56ca9dc1c3f709874b2f1a6543e0137afbc9"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDU2NTA5MQ==", "bodyText": "this version number will need to be updated", "url": "https://github.com/apache/hbase/pull/1203#discussion_r384565091", "createdAt": "2020-02-26T15:25:30Z", "author": {"login": "busbey"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/AsyncAdmin.java", "diffHunk": "@@ -474,8 +475,22 @@\n    * @param forcible true if do a compulsory merge, otherwise we will only merge two adjacent\n    *          regions\n    */\n-  CompletableFuture<Void> mergeRegions(byte[] nameOfRegionA, byte[] nameOfRegionB,\n-      boolean forcible);\n+  default CompletableFuture<Void> mergeRegions(byte[] nameOfRegionA, byte[] nameOfRegionB,\n+      boolean forcible) {\n+    return mergeRegions(Arrays.asList(nameOfRegionA, nameOfRegionB), forcible);\n+  }\n+\n+  /**\n+   * Merge regions.\n+   * <p/>\n+   * You may get a {@code DoNotRetryIOException} if you pass more than two regions in but the master\n+   * does not support merging more than two regions. At least till 2.2.0, we still only support", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13da56ca9dc1c3f709874b2f1a6543e0137afbc9"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDU2NzA4NA==", "bodyText": "just to confirm my understanding, we're doing this ourselves instead of using Preconditions because guava doesn't have a version of Preconditions that will return a future?", "url": "https://github.com/apache/hbase/pull/1203#discussion_r384567084", "createdAt": "2020-02-26T15:28:04Z", "author": {"login": "busbey"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/RawAsyncHBaseAdmin.java", "diffHunk": "@@ -1185,41 +1184,41 @@ private void checkAndGetTableName(byte[] encodeRegionName, AtomicReference<Table\n   }\n \n   @Override\n-  public CompletableFuture<Void> mergeRegions(byte[] nameOfRegionA, byte[] nameOfRegionB,\n-      boolean forcible) {\n+  public CompletableFuture<Void> mergeRegions(List<byte[]> nameOfRegionsToMerge, boolean forcible) {\n+    if (nameOfRegionsToMerge.size() < 2) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13da56ca9dc1c3f709874b2f1a6543e0137afbc9"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "991f882022e87dce669c0464e0defaab0005b30d", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/991f882022e87dce669c0464e0defaab0005b30d", "committedDate": "2020-02-27T10:03:50Z", "message": "Fix checkstyle and versions"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "da889e4509c14856d74efcad39da07c9b3fb12a6", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/da889e4509c14856d74efcad39da07c9b3fb12a6", "committedDate": "2020-02-27T10:00:20Z", "message": "asdf"}, "afterCommit": {"oid": "991f882022e87dce669c0464e0defaab0005b30d", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/991f882022e87dce669c0464e0defaab0005b30d", "committedDate": "2020-02-27T10:03:50Z", "message": "Fix checkstyle and versions"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2858, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}