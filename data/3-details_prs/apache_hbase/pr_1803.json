{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0OTg2MTEy", "number": 1803, "title": "HBASE-24468 Add region info when log meessages in HStore.", "bodyText": "", "createdAt": "2020-05-29T09:15:13Z", "url": "https://github.com/apache/hbase/pull/1803", "merged": true, "mergeCommit": {"oid": "eee06c2d7e33ff169db562ccb16b5f138511b4ec"}, "closed": true, "closedAt": "2020-06-09T06:12:45Z", "author": {"login": "songxincun"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcl-1fMgH2gAyNDI0OTg2MTEyOmZkZWMzYTE4MjM4Y2ZlMDg0ZDNlMzFmZGQxYTYyZTY3YzQyMDBkNTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABco8wXTgFqTQyNTgyNTE5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "fdec3a18238cfe084d3e31fdd1a62e67c4200d57", "author": {"user": {"login": "songxincun", "name": "xincunSong"}}, "url": "https://github.com/apache/hbase/commit/fdec3a18238cfe084d3e31fdd1a62e67c4200d57", "committedDate": "2020-05-29T09:13:49Z", "message": "[HBASE-24468]Add region info when log meessages in HStore."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMTU3MjMx", "url": "https://github.com/apache/hbase/pull/1803#pullrequestreview-421157231", "createdAt": "2020-05-29T17:39:11Z", "commit": {"oid": "fdec3a18238cfe084d3e31fdd1a62e67c4200d57"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNzozOToxMVrOGcmKWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxNzozOToxMVrOGcmKWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYzODU1NQ==", "bodyText": "In all the places we have this pattern  \"in store {} in region {}\"\nBetter we can change toString().  Include region and store name there.  Then in every log we can just refer to 'this'\n:  some format like this for toString?", "url": "https://github.com/apache/hbase/pull/1803#discussion_r432638555", "createdAt": "2020-05-29T17:39:11Z", "author": {"login": "anoopsjohn"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java", "diffHunk": "@@ -276,7 +276,8 @@ protected HStore(final HRegion region, final ColumnFamilyDescriptor family,\n     // used by ScanQueryMatcher\n     long timeToPurgeDeletes =\n         Math.max(conf.getLong(\"hbase.hstore.time.to.purge.deletes\", 0), 0);\n-    LOG.trace(\"Time to purge deletes set to {}ms in store {}\", timeToPurgeDeletes, this);\n+    LOG.trace(\"Time to purge deletes set to {}ms in store {} in region {}\", timeToPurgeDeletes,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fdec3a18238cfe084d3e31fdd1a62e67c4200d57"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMzUyMzk2", "url": "https://github.com/apache/hbase/pull/1803#pullrequestreview-421352396", "createdAt": "2020-05-29T23:50:55Z", "commit": {"oid": "fdec3a18238cfe084d3e31fdd1a62e67c4200d57"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQyMzo1MDo1NVrOGcvIHg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQyMzo1NDowM1rOGcvKZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc4NTQzOA==", "bodyText": "I like what @anoopsjohn  says. toString could be encodedRegionName/store-name (region name is too much -- could be anything given it includes start key... could be a spew of binary characters....)", "url": "https://github.com/apache/hbase/pull/1803#discussion_r432785438", "createdAt": "2020-05-29T23:50:55Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java", "diffHunk": "@@ -276,7 +276,8 @@ protected HStore(final HRegion region, final ColumnFamilyDescriptor family,\n     // used by ScanQueryMatcher\n     long timeToPurgeDeletes =\n         Math.max(conf.getLong(\"hbase.hstore.time.to.purge.deletes\", 0), 0);\n-    LOG.trace(\"Time to purge deletes set to {}ms in store {}\", timeToPurgeDeletes, this);\n+    LOG.trace(\"Time to purge deletes set to {}ms in store {} in region {}\", timeToPurgeDeletes,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYzODU1NQ=="}, "originalCommit": {"oid": "fdec3a18238cfe084d3e31fdd1a62e67c4200d57"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc4NTU3OA==", "bodyText": "Otherwise I'd comment that no need of words 'store' or 'region' in log message; no need of these qualifiers.", "url": "https://github.com/apache/hbase/pull/1803#discussion_r432785578", "createdAt": "2020-05-29T23:51:45Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java", "diffHunk": "@@ -276,7 +276,8 @@ protected HStore(final HRegion region, final ColumnFamilyDescriptor family,\n     // used by ScanQueryMatcher\n     long timeToPurgeDeletes =\n         Math.max(conf.getLong(\"hbase.hstore.time.to.purge.deletes\", 0), 0);\n-    LOG.trace(\"Time to purge deletes set to {}ms in store {}\", timeToPurgeDeletes, this);\n+    LOG.trace(\"Time to purge deletes set to {}ms in store {} in region {}\", timeToPurgeDeletes,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjYzODU1NQ=="}, "originalCommit": {"oid": "fdec3a18238cfe084d3e31fdd1a62e67c4200d57"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc4NTc4MQ==", "bodyText": "Why have 'HStore:' in here? Instead of 'Created HStore: Store=', just have 'Created '.", "url": "https://github.com/apache/hbase/pull/1803#discussion_r432785781", "createdAt": "2020-05-29T23:52:38Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java", "diffHunk": "@@ -331,11 +332,11 @@ protected HStore(final HRegion region, final ColumnFamilyDescriptor family,\n       confPrintThreshold = 10;\n     }\n     this.parallelPutCountPrintThreshold = confPrintThreshold;\n-    LOG.info(\"Store={},  memstore type={}, storagePolicy={}, verifyBulkLoads={}, \"\n-            + \"parallelPutCountPrintThreshold={}, encoding={}, compression={}\",\n+    LOG.info(\"Created HStore: Store={},  memstore type={}, storagePolicy={}, verifyBulkLoads={}, \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fdec3a18238cfe084d3e31fdd1a62e67c4200d57"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc4NTgyMA==", "bodyText": "Encoded name, not full name.", "url": "https://github.com/apache/hbase/pull/1803#discussion_r432785820", "createdAt": "2020-05-29T23:52:52Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java", "diffHunk": "@@ -331,11 +332,11 @@ protected HStore(final HRegion region, final ColumnFamilyDescriptor family,\n       confPrintThreshold = 10;\n     }\n     this.parallelPutCountPrintThreshold = confPrintThreshold;\n-    LOG.info(\"Store={},  memstore type={}, storagePolicy={}, verifyBulkLoads={}, \"\n-            + \"parallelPutCountPrintThreshold={}, encoding={}, compression={}\",\n+    LOG.info(\"Created HStore: Store={},  memstore type={}, storagePolicy={}, verifyBulkLoads={}, \"\n+            + \"parallelPutCountPrintThreshold={}, encoding={}, compression={} in region {}\",\n         getColumnFamilyName(), memstore.getClass().getSimpleName(), policyName, verifyBulkLoads,\n         parallelPutCountPrintThreshold, family.getDataBlockEncoding(),\n-        family.getCompressionType());\n+        family.getCompressionType(), getRegionInfo().getRegionNameAsString());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fdec3a18238cfe084d3e31fdd1a62e67c4200d57"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc4NjAyMw==", "bodyText": "No need of 'Store' or 'region'... its obvious that we're talking store and region. Having these works in there bulk up logging and make it harder to read/parse.", "url": "https://github.com/apache/hbase/pull/1803#discussion_r432786023", "createdAt": "2020-05-29T23:54:03Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java", "diffHunk": "@@ -1192,8 +1198,10 @@ public StoreFileWriter createWriterInTmp(long maxKeyCount, Compression.Algorithm\n       if (shouldCacheDataOnWrite) {\n         writerCacheConf.enableCacheOnWrite();\n         if (!cacheOnWriteLogged) {\n-          LOG.info(\"For Store {} , cacheDataOnWrite is true, hence enabled cacheOnWrite for \" +\n-            \"Index blocks and Bloom filter blocks\", getColumnFamilyName());\n+          LOG.info(\"For Store {} in region {}, \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fdec3a18238cfe084d3e31fdd1a62e67c4200d57"}, "originalPosition": 88}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a83e7becd885f83d827afd0fab95d4fe61a3748", "author": {"user": {"login": "songxincun", "name": "xincunSong"}}, "url": "https://github.com/apache/hbase/commit/4a83e7becd885f83d827afd0fab95d4fe61a3748", "committedDate": "2020-05-31T05:37:22Z", "message": "Revert \"[HBASE-24468]Add region info when log meessages in HStore.\"\n\nThis reverts commit fdec3a18238cfe084d3e31fdd1a62e67c4200d57."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7a3af26d7da1abc9d62528d0bd08ded585b00b1", "author": {"user": {"login": "songxincun", "name": "xincunSong"}}, "url": "https://github.com/apache/hbase/commit/f7a3af26d7da1abc9d62528d0bd08ded585b00b1", "committedDate": "2020-05-31T07:23:56Z", "message": "Fix what saintstack and anoopsjohn suggest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNDcwMjUz", "url": "https://github.com/apache/hbase/pull/1803#pullrequestreview-421470253", "createdAt": "2020-05-31T07:49:07Z", "commit": {"oid": "f7a3af26d7da1abc9d62528d0bd08ded585b00b1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNjE1NTcz", "url": "https://github.com/apache/hbase/pull/1803#pullrequestreview-421615573", "createdAt": "2020-06-01T06:17:28Z", "commit": {"oid": "f7a3af26d7da1abc9d62528d0bd08ded585b00b1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwNjoxNzoyOFrOGc_4GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMVQwNjoxNzoyOFrOGc_4GQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzA1OTg2NQ==", "bodyText": "add a space before is", "url": "https://github.com/apache/hbase/pull/1803#discussion_r433059865", "createdAt": "2020-06-01T06:17:28Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java", "diffHunk": "@@ -1953,8 +1950,7 @@ public boolean shouldPerformMajorCompaction() throws IOException {\n     }\n \n     if (LOG.isDebugEnabled()) {\n-      LOG.debug(getRegionInfo().getEncodedName() + \" - \" + getColumnFamilyName()\n-          + \": Initiating \" + (request.isMajor() ? \"major\" : \"minor\") + \" compaction\"\n+      LOG.debug(this + \"is initiating \" + (request.isMajor() ? \"major\" : \"minor\") + \" compaction\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7a3af26d7da1abc9d62528d0bd08ded585b00b1"}, "originalPosition": 136}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e477bb015f743e1e1e61781ff83135f3de802940", "author": {"user": {"login": "songxincun", "name": "xincunSong"}}, "url": "https://github.com/apache/hbase/commit/e477bb015f743e1e1e61781ff83135f3de802940", "committedDate": "2020-06-01T06:25:15Z", "message": "Add a space as binlijin suggested"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxNjE5NjEw", "url": "https://github.com/apache/hbase/pull/1803#pullrequestreview-421619610", "createdAt": "2020-06-01T06:29:05Z", "commit": {"oid": "e477bb015f743e1e1e61781ff83135f3de802940"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1ODI1MTky", "url": "https://github.com/apache/hbase/pull/1803#pullrequestreview-425825192", "createdAt": "2020-06-07T14:30:11Z", "commit": {"oid": "e477bb015f743e1e1e61781ff83135f3de802940"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4822, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}