{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2MzU0OTE2", "number": 2825, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNzowMTo1NFrOFJspGw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNzowMTo1NFrOFJspGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NzEyOTIzOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "isResolved": false, "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNzowMTo1NFrOIMIdGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0zMVQwMToyOToxMlrOIM4CzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5MjM0NQ==", "bodyText": "What is the difference about Closeables.close and IOUtils.close?", "url": "https://github.com/apache/hbase/pull/2825#discussion_r549592345", "createdAt": "2020-12-29T07:01:54Z", "author": {"login": "infraio"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -832,7 +832,7 @@ private void finishActiveMasterInitialization(MonitoredTask status) throws IOExc\n             HBaseFsck.createLockRetryCounterFactory(this.conf).create());\n       } finally {\n         if (result != null) {\n-          IOUtils.closeQuietly(result.getSecond());\n+          Closeables.close(result.getSecond(), true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1f5ff871ea17ac5e2862cc62ccb91313b57d610e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYwNDY3MA==", "bodyText": "Closeables.close(c, true) will swallow the IOException thrown while IOUtils.close will not.", "url": "https://github.com/apache/hbase/pull/2825#discussion_r549604670", "createdAt": "2020-12-29T07:51:14Z", "author": {"login": "Apache9"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -832,7 +832,7 @@ private void finishActiveMasterInitialization(MonitoredTask status) throws IOExc\n             HBaseFsck.createLockRetryCounterFactory(this.conf).create());\n       } finally {\n         if (result != null) {\n-          IOUtils.closeQuietly(result.getSecond());\n+          Closeables.close(result.getSecond(), true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5MjM0NQ=="}, "originalCommit": {"oid": "1f5ff871ea17ac5e2862cc62ccb91313b57d610e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkwNjk4OQ==", "bodyText": "Seems there are three methods you used: Closeables.closeQuietly, Closeables.close, IOUtils.closeQuietly. Do we have a developer guide doc about what we recommend to use?", "url": "https://github.com/apache/hbase/pull/2825#discussion_r549906989", "createdAt": "2020-12-30T01:36:43Z", "author": {"login": "infraio"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -832,7 +832,7 @@ private void finishActiveMasterInitialization(MonitoredTask status) throws IOExc\n             HBaseFsck.createLockRetryCounterFactory(this.conf).create());\n       } finally {\n         if (result != null) {\n-          IOUtils.closeQuietly(result.getSecond());\n+          Closeables.close(result.getSecond(), true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5MjM0NQ=="}, "originalCommit": {"oid": "1f5ff871ea17ac5e2862cc62ccb91313b57d610e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTkwNzgyOQ==", "bodyText": "Closeables.close will still throw IOExceptions on the method signature, so usually it is only suitable to be used in UT, where we are free to change the method signature.\nIOUtils.closeQuietly will not throw any exceptions but you need to pass in a consumer to process the IOException(usually just a logging).\nCloseables.closeQuietly is for closing Reader and InputStream, where we will not throw any exceptions.", "url": "https://github.com/apache/hbase/pull/2825#discussion_r549907829", "createdAt": "2020-12-30T01:41:47Z", "author": {"login": "Apache9"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -832,7 +832,7 @@ private void finishActiveMasterInitialization(MonitoredTask status) throws IOExc\n             HBaseFsck.createLockRetryCounterFactory(this.conf).create());\n       } finally {\n         if (result != null) {\n-          IOUtils.closeQuietly(result.getSecond());\n+          Closeables.close(result.getSecond(), true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5MjM0NQ=="}, "originalCommit": {"oid": "1f5ff871ea17ac5e2862cc62ccb91313b57d610e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDIxMDM0NQ==", "bodyText": "And in general, I do not have very strong opinion on forcing these rules, developers are free to use these methods, just not use a deprecated one...", "url": "https://github.com/apache/hbase/pull/2825#discussion_r550210345", "createdAt": "2020-12-30T14:20:11Z", "author": {"login": "Apache9"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -832,7 +832,7 @@ private void finishActiveMasterInitialization(MonitoredTask status) throws IOExc\n             HBaseFsck.createLockRetryCounterFactory(this.conf).create());\n       } finally {\n         if (result != null) {\n-          IOUtils.closeQuietly(result.getSecond());\n+          Closeables.close(result.getSecond(), true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5MjM0NQ=="}, "originalCommit": {"oid": "1f5ff871ea17ac5e2862cc62ccb91313b57d610e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDM2ODg4NA==", "bodyText": "IOUtils.closeQuietly is also deprecated with a long time -- apache/commons-io@ce2b3e8", "url": "https://github.com/apache/hbase/pull/2825#discussion_r550368884", "createdAt": "2020-12-31T01:05:06Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -832,7 +832,7 @@ private void finishActiveMasterInitialization(MonitoredTask status) throws IOExc\n             HBaseFsck.createLockRetryCounterFactory(this.conf).create());\n       } finally {\n         if (result != null) {\n-          IOUtils.closeQuietly(result.getSecond());\n+          Closeables.close(result.getSecond(), true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5MjM0NQ=="}, "originalCommit": {"oid": "1f5ff871ea17ac5e2862cc62ccb91313b57d610e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDM2OTIzNw==", "bodyText": "As is Closeables#closeQuietly... google/guava#1118", "url": "https://github.com/apache/hbase/pull/2825#discussion_r550369237", "createdAt": "2020-12-31T01:07:25Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -832,7 +832,7 @@ private void finishActiveMasterInitialization(MonitoredTask status) throws IOExc\n             HBaseFsck.createLockRetryCounterFactory(this.conf).create());\n       } finally {\n         if (result != null) {\n-          IOUtils.closeQuietly(result.getSecond());\n+          Closeables.close(result.getSecond(), true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5MjM0NQ=="}, "originalCommit": {"oid": "1f5ff871ea17ac5e2862cc62ccb91313b57d610e"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDM3MjA0NQ==", "bodyText": "For IOUtils.closeQuietly, now it provides a version with a consumer parameter to process the IOException which is not deprecated.\nFor Closeables.closeQuirtly, the version which takes a Closeable as parameter has already been removed for a long time, but the version which takes a InputStream or a Reader is still available and is not deprecated.", "url": "https://github.com/apache/hbase/pull/2825#discussion_r550372045", "createdAt": "2020-12-31T01:29:12Z", "author": {"login": "Apache9"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -832,7 +832,7 @@ private void finishActiveMasterInitialization(MonitoredTask status) throws IOExc\n             HBaseFsck.createLockRetryCounterFactory(this.conf).create());\n       } finally {\n         if (result != null) {\n-          IOUtils.closeQuietly(result.getSecond());\n+          Closeables.close(result.getSecond(), true);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU5MjM0NQ=="}, "originalCommit": {"oid": "1f5ff871ea17ac5e2862cc62ccb91313b57d610e"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2281, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}