{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4Njk1NjU3", "number": 1198, "title": "HBASE-23740 Invalid StoreFile WARN log message printed for recovered.\u2026", "bodyText": "Skipping the WARN log for the recovered.hfile dir.", "createdAt": "2020-02-23T11:33:47Z", "url": "https://github.com/apache/hbase/pull/1198", "merged": true, "mergeCommit": {"oid": "3c3aae9a2f35bf63c7a10374701f89c0aa8b71a4"}, "closed": true, "closedAt": "2020-02-26T12:22:22Z", "author": {"login": "pankaj72981"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcHFzLvgH2gAyMzc4Njk1NjU3OjM5MDQ1ZTMwZmNkNmY4OGI5NTA3MGE0YTlmM2QxNWYzMmJkYjJhODQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcHroaugFqTM2Mzg4NTQyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "39045e30fcd6f88b95070a4a9f3d15f32bdb2a84", "author": {"user": {"login": "pankaj72981", "name": "Pankaj"}}, "url": "https://github.com/apache/hbase/commit/39045e30fcd6f88b95070a4a9f3d15f32bdb2a84", "committedDate": "2020-02-23T09:48:59Z", "message": "HBASE-23740 Invalid StoreFile WARN log message printed for recovered.hfiles directory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMTE1MTU2", "url": "https://github.com/apache/hbase/pull/1198#pullrequestreview-363115156", "createdAt": "2020-02-23T18:59:16Z", "commit": {"oid": "39045e30fcd6f88b95070a4a9f3d15f32bdb2a84"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QxODo1OToxN1rOFtSQ0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yM1QxODo1OToxN1rOFtSQ0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzAyOTQ1Nw==", "bodyText": "Might want to use {} for status.getPath()?", "url": "https://github.com/apache/hbase/pull/1198#discussion_r383029457", "createdAt": "2020-02-23T18:59:17Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionFileSystem.java", "diffHunk": "@@ -245,7 +245,11 @@ public String getStoragePolicyName(String familyName) {\n     ArrayList<StoreFileInfo> storeFiles = new ArrayList<>(files.length);\n     for (FileStatus status: files) {\n       if (validate && !StoreFileInfo.isValid(status)) {\n-        LOG.warn(\"Invalid StoreFile: \" + status.getPath());\n+        // recovered.hfiles directory is expected inside CF path when hbase.wal.split.to.hfile to\n+        // true, refer HBASE-23740\n+        if (!HConstants.RECOVERED_HFILES_DIR.equals(status.getPath().getName())) {\n+          LOG.warn(\"Invalid StoreFile: \" + status.getPath());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39045e30fcd6f88b95070a4a9f3d15f32bdb2a84"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzMjMzMjY1", "url": "https://github.com/apache/hbase/pull/1198#pullrequestreview-363233265", "createdAt": "2020-02-24T08:53:40Z", "commit": {"oid": "39045e30fcd6f88b95070a4a9f3d15f32bdb2a84"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODo1Mzo0MFrOFtY6MQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQwODo1Mzo0MFrOFtY6MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzEzODM1Mw==", "bodyText": "Same here.", "url": "https://github.com/apache/hbase/pull/1198#discussion_r383138353", "createdAt": "2020-02-24T08:53:40Z", "author": {"login": "petersomogyi"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionFileSystem.java", "diffHunk": "@@ -278,7 +282,11 @@ public String getStoragePolicyName(String familyName) {\n     List<LocatedFileStatus> validStoreFiles = Lists.newArrayList();\n     for (LocatedFileStatus status : locatedFileStatuses) {\n       if (validate && !StoreFileInfo.isValid(status)) {\n-        LOG.warn(\"Invalid StoreFile: \" + status.getPath());\n+        // recovered.hfiles directory is expected inside CF path when hbase.wal.split.to.hfile to\n+        // true, refer HBASE-23740\n+        if (!HConstants.RECOVERED_HFILES_DIR.equals(status.getPath().getName())) {\n+          LOG.warn(\"Invalid StoreFile: \" + status.getPath());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "39045e30fcd6f88b95070a4a9f3d15f32bdb2a84"}, "originalPosition": 21}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34f2189716dd98c7a8319a1b7f2185a40b775503", "author": {"user": {"login": "pankaj72981", "name": "Pankaj"}}, "url": "https://github.com/apache/hbase/commit/34f2189716dd98c7a8319a1b7f2185a40b775503", "committedDate": "2020-02-24T09:34:45Z", "message": "HBASE-23740 Invalid StoreFile WARN log message printed for recovered.hfiles directory"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNDQ0MDk0", "url": "https://github.com/apache/hbase/pull/1198#pullrequestreview-363444094", "createdAt": "2020-02-24T14:50:09Z", "commit": {"oid": "34f2189716dd98c7a8319a1b7f2185a40b775503"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzODg1NDI5", "url": "https://github.com/apache/hbase/pull/1198#pullrequestreview-363885429", "createdAt": "2020-02-25T05:53:37Z", "commit": {"oid": "34f2189716dd98c7a8319a1b7f2185a40b775503"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2838, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}