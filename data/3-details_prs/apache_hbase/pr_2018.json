{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0MzkzNzkx", "number": 2018, "title": "HBASE-24659 Calculate FIXED_OVERHEAD automatically", "bodyText": "", "createdAt": "2020-07-05T11:21:16Z", "url": "https://github.com/apache/hbase/pull/2018", "merged": true, "mergeCommit": {"oid": "f710d2d65463983f4f5c1c1d5d97ab3b36f3ec3a"}, "closed": true, "closedAt": "2020-08-06T21:50:32Z", "author": {"login": "nyl3532016"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcx91XOABqjM1MTMzODk3NTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc8W_oSgFqTQ2Mjg5NTU3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7a52a1e08c79720e96d4a90bb668e821a305a624", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/7a52a1e08c79720e96d4a90bb668e821a305a624", "committedDate": "2020-07-05T11:15:17Z", "message": "HBASE-24659 Calculate FIXED_OVERHEAD automatically"}, "afterCommit": {"oid": "330f7f94dd66a51ec069be3a33362c825ea2cd37", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/330f7f94dd66a51ec069be3a33362c825ea2cd37", "committedDate": "2020-07-05T14:50:14Z", "message": "HBASE-24659 Calculate FIXED_OVERHEAD automatically"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNjg3MDI2", "url": "https://github.com/apache/hbase/pull/2018#pullrequestreview-442687026", "createdAt": "2020-07-05T15:38:57Z", "commit": {"oid": "330f7f94dd66a51ec069be3a33362c825ea2cd37"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyNjkyOTcz", "url": "https://github.com/apache/hbase/pull/2018#pullrequestreview-442692973", "createdAt": "2020-07-05T17:14:20Z", "commit": {"oid": "330f7f94dd66a51ec069be3a33362c825ea2cd37"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNVQxNzoxNDoyMVrOGtDqIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNVQxNzoxNDoyMVrOGtDqIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTg5OTA0Mw==", "bodyText": "Does ClassSize come up w/ same general numbers as old manual technique. It does deep size rather than shallow?", "url": "https://github.com/apache/hbase/pull/2018#discussion_r449899043", "createdAt": "2020-07-05T17:14:21Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java", "diffHunk": "@@ -8405,12 +8405,7 @@ private static long getLongValue(final Cell cell) throws DoNotRetryIOException {\n     return cells;\n   }\n \n-  public static final long FIXED_OVERHEAD = ClassSize.align(\n-      ClassSize.OBJECT +\n-      56 * ClassSize.REFERENCE +\n-      3 * Bytes.SIZEOF_INT +\n-      14 * Bytes.SIZEOF_LONG +\n-      3 * Bytes.SIZEOF_BOOLEAN);\n+  public static final long FIXED_OVERHEAD = ClassSize.estimateBase(HRegion.class, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "330f7f94dd66a51ec069be3a33362c825ea2cd37"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccbff0b9cc464227ae9cef3a720eb81fd83d4e77", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/ccbff0b9cc464227ae9cef3a720eb81fd83d4e77", "committedDate": "2020-07-12T07:29:24Z", "message": "HBASE-24659 Calculate FIXED_OVERHEAD automatically"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "330f7f94dd66a51ec069be3a33362c825ea2cd37", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/330f7f94dd66a51ec069be3a33362c825ea2cd37", "committedDate": "2020-07-05T14:50:14Z", "message": "HBASE-24659 Calculate FIXED_OVERHEAD automatically"}, "afterCommit": {"oid": "ccbff0b9cc464227ae9cef3a720eb81fd83d4e77", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/ccbff0b9cc464227ae9cef3a720eb81fd83d4e77", "committedDate": "2020-07-12T07:29:24Z", "message": "HBASE-24659 Calculate FIXED_OVERHEAD automatically"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NTU2NTE0", "url": "https://github.com/apache/hbase/pull/2018#pullrequestreview-459556514", "createdAt": "2020-08-01T06:03:09Z", "commit": {"oid": "ccbff0b9cc464227ae9cef3a720eb81fd83d4e77"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyODk1NTcz", "url": "https://github.com/apache/hbase/pull/2018#pullrequestreview-462895573", "createdAt": "2020-08-06T21:40:30Z", "commit": {"oid": "ccbff0b9cc464227ae9cef3a720eb81fd83d4e77"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTo0MDozMVrOG9FLtA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQyMTo0NjoyNVrOG9FVNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjcwMTIzNg==", "bodyText": "Or, sorry, yeah, FIXED_OVERHEAD is 'this' classes size; i.e. the shallow size (I think).", "url": "https://github.com/apache/hbase/pull/2018#discussion_r466701236", "createdAt": "2020-08-06T21:40:31Z", "author": {"login": "saintstack"}, "path": "hbase-common/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileContext.java", "diffHunk": "@@ -37,13 +37,7 @@\n  */\n @InterfaceAudience.Private\n public class HFileContext implements HeapSize, Cloneable {\n-  public static final int FIXED_OVERHEAD = ClassSize.align(ClassSize.OBJECT +\n-      // Algorithm, checksumType, encoding, Encryption.Context, hfileName reference,\n-      5 * ClassSize.REFERENCE + 2 * Bytes.SIZEOF_INT +\n-      // usesHBaseChecksum, includesMvcc, includesTags and compressTags\n-      4 * Bytes.SIZEOF_BOOLEAN + Bytes.SIZEOF_LONG +\n-      //byte[] headers for column family and table name\n-      2 * ClassSize.ARRAY + 2 * ClassSize.REFERENCE);\n+  public static final long FIXED_OVERHEAD = ClassSize.estimateBase(HFileContext.class, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ccbff0b9cc464227ae9cef3a720eb81fd83d4e77"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjcwMzY2OQ==", "bodyText": "I went back through history of ClassSize... its so old.", "url": "https://github.com/apache/hbase/pull/2018#discussion_r466703669", "createdAt": "2020-08-06T21:46:25Z", "author": {"login": "saintstack"}, "path": "hbase-common/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileContext.java", "diffHunk": "@@ -37,13 +37,7 @@\n  */\n @InterfaceAudience.Private\n public class HFileContext implements HeapSize, Cloneable {\n-  public static final int FIXED_OVERHEAD = ClassSize.align(ClassSize.OBJECT +\n-      // Algorithm, checksumType, encoding, Encryption.Context, hfileName reference,\n-      5 * ClassSize.REFERENCE + 2 * Bytes.SIZEOF_INT +\n-      // usesHBaseChecksum, includesMvcc, includesTags and compressTags\n-      4 * Bytes.SIZEOF_BOOLEAN + Bytes.SIZEOF_LONG +\n-      //byte[] headers for column family and table name\n-      2 * ClassSize.ARRAY + 2 * ClassSize.REFERENCE);\n+  public static final long FIXED_OVERHEAD = ClassSize.estimateBase(HFileContext.class, false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjcwMTIzNg=="}, "originalCommit": {"oid": "ccbff0b9cc464227ae9cef3a720eb81fd83d4e77"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4208, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}