{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyNDk2NzU4", "number": 1500, "title": "HBASE-24164 Retain the ReadRequests and WriteRequests of region on we\u2026", "bodyText": "\u2026b UI after alter table", "createdAt": "2020-04-13T06:29:16Z", "url": "https://github.com/apache/hbase/pull/1500", "merged": true, "mergeCommit": {"oid": "5e32e08782bc937ec6e6e2b02fbae07b077b4728"}, "closed": true, "closedAt": "2020-05-14T05:28:46Z", "author": {"login": "bsglz"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcb1yxqAFqTQwMTMyMTY1Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcgzeaRAH2gAyNDAyNDk2NzU4OjRiYzA0MGNjOGY4NDYyYjRiMDBjYWZjZDRmNDBmMTRmYTA1MzdkMTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMzIxNjU2", "url": "https://github.com/apache/hbase/pull/1500#pullrequestreview-401321656", "createdAt": "2020-04-27T20:59:09Z", "commit": {"oid": "9b61ab26bbbf2f98b6ca9c0cede5bcc362f56c14"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QyMDo1OTowOVrOGM3bcw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QyMTowMjowNFrOGM3i2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0NDI0Mw==", "bodyText": "If the Region went to another server and was over there for a week before coming to this server, then these metrics would be incorrect? Thats ok?", "url": "https://github.com/apache/hbase/pull/1500#discussion_r416144243", "createdAt": "2020-04-27T20:59:09Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java", "diffHunk": "@@ -877,6 +877,19 @@ public HRegion(final HRegionFileSystem fs, final WAL wal, final Configuration co\n     this.maxCellSize = conf.getLong(HBASE_MAX_CELL_SIZE_KEY, DEFAULT_MAX_CELL_SIZE);\n     this.miniBatchSize = conf.getInt(HBASE_REGIONSERVER_MINIBATCH_SIZE,\n         DEFAULT_HBASE_REGIONSERVER_MINIBATCH_SIZE);\n+\n+    // recover the metrics of read and write requests count if they were retained\n+    if (rsServices != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b61ab26bbbf2f98b6ca9c0cede5bcc362f56c14"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0NDUwOA==", "bodyText": "Has to be public? Can't be private or package private?", "url": "https://github.com/apache/hbase/pull/1500#discussion_r416144508", "createdAt": "2020-04-27T20:59:34Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java", "diffHunk": "@@ -8964,4 +8977,12 @@ static void decorateRegionConfiguration(Configuration conf) {\n       }\n     }\n   }\n+\n+  public void setReadRequestsCount(long readRequestsCount) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b61ab26bbbf2f98b6ca9c0cede5bcc362f56c14"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0NTE0OA==", "bodyText": "Has to be public? Can't be package private?", "url": "https://github.com/apache/hbase/pull/1500#discussion_r416145148", "createdAt": "2020-04-27T21:00:35Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RegionServerAccounting.java", "diffHunk": "@@ -123,6 +127,13 @@ public long getGlobalMemStoreOffHeapSize() {\n     return this.globalMemStoreOffHeapSize.sum();\n   }\n \n+  /**\n+   * @return the retained metrics of region's read and write requests count\n+   */\n+  public ConcurrentMap<String, Pair<Long, Long>> getRetainedRegionRWRequestsCnt() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b61ab26bbbf2f98b6ca9c0cede5bcc362f56c14"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjE0NjEzNg==", "bodyText": "This data structure can grow w/o bound?\nThis data structure needs a comment on how it is used and life cycle of items. They items should age out I'd think.", "url": "https://github.com/apache/hbase/pull/1500#discussion_r416146136", "createdAt": "2020-04-27T21:02:04Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RegionServerAccounting.java", "diffHunk": "@@ -67,6 +70,7 @@ public RegionServerAccounting(Configuration conf) {\n     this.globalOnHeapMemstoreLimit = MemorySizeUtil.getOnheapGlobalMemStoreSize(conf);\n     this.globalOnHeapMemstoreLimitLowMark =\n         (long) (this.globalOnHeapMemstoreLimit * this.globalMemStoreLimitLowMarkPercent);\n+    this.retainedRegionRWRequestsCnt = new ConcurrentHashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9b61ab26bbbf2f98b6ca9c0cede5bcc362f56c14"}, "originalPosition": 21}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1Mzc0MzAy", "url": "https://github.com/apache/hbase/pull/1500#pullrequestreview-405374302", "createdAt": "2020-05-04T21:51:29Z", "commit": {"oid": "f065841f13a814077b9b5d48998b61128f12a55f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f065841f13a814077b9b5d48998b61128f12a55f", "author": {"user": {"login": "bsglz", "name": null}}, "url": "https://github.com/apache/hbase/commit/f065841f13a814077b9b5d48998b61128f12a55f", "committedDate": "2020-04-28T03:12:26Z", "message": "fix review issues"}, "afterCommit": {"oid": "f19c393f22d11135b7360334574abc5771acea3c", "author": {"user": {"login": "bsglz", "name": null}}, "url": "https://github.com/apache/hbase/commit/f19c393f22d11135b7360334574abc5771acea3c", "committedDate": "2020-05-05T10:30:50Z", "message": "fix review issues"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "315e7a6e5a9eff15e4f131f3c85e617c77e3d6fb", "author": {"user": {"login": "bsglz", "name": null}}, "url": "https://github.com/apache/hbase/commit/315e7a6e5a9eff15e4f131f3c85e617c77e3d6fb", "committedDate": "2020-05-13T05:56:02Z", "message": "HBASE-24164 Retain the ReadRequests and WriteRequests of region on web UI after alter table"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "059a36496097f6e530d8ea325c1280e876da6609", "author": {"user": {"login": "bsglz", "name": null}}, "url": "https://github.com/apache/hbase/commit/059a36496097f6e530d8ea325c1280e876da6609", "committedDate": "2020-05-05T12:53:11Z", "message": "fix compile error"}, "afterCommit": {"oid": "315e7a6e5a9eff15e4f131f3c85e617c77e3d6fb", "author": {"user": {"login": "bsglz", "name": null}}, "url": "https://github.com/apache/hbase/commit/315e7a6e5a9eff15e4f131f3c85e617c77e3d6fb", "committedDate": "2020-05-13T05:56:02Z", "message": "HBASE-24164 Retain the ReadRequests and WriteRequests of region on web UI after alter table"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4bc040cc8f8462b4b00cafcd4f40f14fa0537d12", "author": {"user": {"login": "bsglz", "name": null}}, "url": "https://github.com/apache/hbase/commit/4bc040cc8f8462b4b00cafcd4f40f14fa0537d12", "committedDate": "2020-05-13T07:10:02Z", "message": "fix ut issue."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2426, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}