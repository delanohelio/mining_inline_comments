{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ2Mjk0OTc0", "number": 2824, "title": "HBASE-25447 remoteProc is suspended due to OOM ERROR", "bodyText": "", "createdAt": "2020-12-29T02:06:50Z", "url": "https://github.com/apache/hbase/pull/2824", "merged": true, "mergeCommit": {"oid": "600be60a4bd4d3b3e9652027a0cb8bdd32016c6b"}, "closed": true, "closedAt": "2021-01-04T15:34:39Z", "author": {"login": "cuibo01"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdqw-0pgH2gAyNTQ2Mjk0OTc0OjgwMWMzNTk4OTZlNDcxOWNhMTUxYjQwZmU5Y2Y0OTA4ZmI2OWM5YmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdswJY0AFqTU2MDc5Nzk3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "801c359896e4719ca151b40fe9cf4908fb69c9ba", "author": {"user": {"login": "cuibo01", "name": "Bo Cui"}}, "url": "https://github.com/apache/hbase/commit/801c359896e4719ca151b40fe9cf4908fb69c9ba", "committedDate": "2020-12-29T02:06:07Z", "message": "HBASE-25447 remoteProc is suspended due to OOM ERROR"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU5NDE0OTE5", "url": "https://github.com/apache/hbase/pull/2824#pullrequestreview-559414919", "createdAt": "2020-12-29T07:51:37Z", "commit": {"oid": "801c359896e4719ca151b40fe9cf4908fb69c9ba"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNzo1MTozN1rOIMJNoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNzo1MTozN1rOIMJNoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYwNDc2OQ==", "bodyText": "Should we abort for all exception or only for OOM?", "url": "https://github.com/apache/hbase/pull/2824#discussion_r549604769", "createdAt": "2020-12-29T07:51:37Z", "author": {"login": "pankaj72981"}, "path": "hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/RemoteProcedureDispatcher.java", "diffHunk": "@@ -306,15 +315,22 @@ public TimeoutExecutorThread() {\n     @Override\n     public void run() {\n       while (running.get()) {\n-        final DelayedWithTimeout task = DelayedUtil.takeWithoutInterrupt(queue);\n-        if (task == null || task == DelayedUtil.DELAYED_POISON) {\n-          // the executor may be shutting down, and the task is just the shutdown request\n-          continue;\n-        }\n-        if (task instanceof DelayedTask) {\n-          threadPool.execute(((DelayedTask) task).getObject());\n-        } else {\n-          ((BufferNode) task).dispatch();\n+        try {\n+          final DelayedWithTimeout task = DelayedUtil.takeWithoutInterrupt(queue);\n+          if (task == null || task == DelayedUtil.DELAYED_POISON) {\n+            // the executor may be shutting down, and the task is just the shutdown request\n+            continue;\n+          }\n+          if (task instanceof DelayedTask) {\n+            threadPool.execute(((DelayedTask) task).getObject());\n+          } else {\n+            ((BufferNode) task).dispatch();\n+          }\n+        } catch (Throwable e) {\n+          LOG.error(\"Caught error\", e);\n+          if (timeoutExecutorError != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "801c359896e4719ca151b40fe9cf4908fb69c9ba"}, "originalPosition": 49}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8eefa73d10f7c448e985f03715f6ad9bf2c10fa3", "author": {"user": {"login": "cuibo01", "name": "Bo Cui"}}, "url": "https://github.com/apache/hbase/commit/8eefa73d10f7c448e985f03715f6ad9bf2c10fa3", "committedDate": "2020-12-31T14:22:20Z", "message": "HBASE-25447 remoteProc is suspended due to OOME"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNTkwNjg3", "url": "https://github.com/apache/hbase/pull/2824#pullrequestreview-560590687", "createdAt": "2021-01-01T14:54:35Z", "commit": {"oid": "8eefa73d10f7c448e985f03715f6ad9bf2c10fa3"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMVQxNDo1NDozNlrOINQrhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wMVQxNDo1NDozNlrOINQrhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc3NTY4Ng==", "bodyText": "Better name it something else? Like setTimeoutExecutorUncaughtExceptionHandler? As we have a method all getUncaugtExceptionHandler in this class, for getting uncaughtExceptionHandler for the thread pool.", "url": "https://github.com/apache/hbase/pull/2824#discussion_r550775686", "createdAt": "2021-01-01T14:54:36Z", "author": {"login": "Apache9"}, "path": "hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/RemoteProcedureDispatcher.java", "diffHunk": "@@ -106,6 +106,10 @@ public boolean start() {\n     return true;\n   }\n \n+  protected void setUncaughtExceptionHandler(UncaughtExceptionHandler eh) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8eefa73d10f7c448e985f03715f6ad9bf2c10fa3"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1403aa47be2149d97b5b927264500fa5ee570f15", "author": {"user": {"login": "cuibo01", "name": "Bo Cui"}}, "url": "https://github.com/apache/hbase/commit/1403aa47be2149d97b5b927264500fa5ee570f15", "committedDate": "2021-01-03T03:00:20Z", "message": "HBASE-25447 remoteProc is suspended due to OOM ERROR"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f407a03747ee053560359f56087fc84926e5686f", "author": {"user": {"login": "cuibo01", "name": "Bo Cui"}}, "url": "https://github.com/apache/hbase/commit/f407a03747ee053560359f56087fc84926e5686f", "committedDate": "2021-01-03T02:43:56Z", "message": "HBASE-25447 remoteProc is suspended due to OOM ERROR"}, "afterCommit": {"oid": "1403aa47be2149d97b5b927264500fa5ee570f15", "author": {"user": {"login": "cuibo01", "name": "Bo Cui"}}, "url": "https://github.com/apache/hbase/commit/1403aa47be2149d97b5b927264500fa5ee570f15", "committedDate": "2021-01-03T03:00:20Z", "message": "HBASE-25447 remoteProc is suspended due to OOM ERROR"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNzEyODkx", "url": "https://github.com/apache/hbase/pull/2824#pullrequestreview-560712891", "createdAt": "2021-01-03T17:23:18Z", "commit": {"oid": "1403aa47be2149d97b5b927264500fa5ee570f15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNzY0NTQz", "url": "https://github.com/apache/hbase/pull/2824#pullrequestreview-560764543", "createdAt": "2021-01-04T03:28:52Z", "commit": {"oid": "1403aa47be2149d97b5b927264500fa5ee570f15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwNzk3OTcx", "url": "https://github.com/apache/hbase/pull/2824#pullrequestreview-560797971", "createdAt": "2021-01-04T06:15:37Z", "commit": {"oid": "1403aa47be2149d97b5b927264500fa5ee570f15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4935, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}