{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5ODE3NjM5", "number": 2076, "title": "HBASE-24740 Enable journal logging for HBase snapshot operation", "bodyText": "", "createdAt": "2020-07-16T00:37:32Z", "url": "https://github.com/apache/hbase/pull/2076", "merged": true, "mergeCommit": {"oid": "5211859058ecd194461650dd811e3fe4708cbec4"}, "closed": true, "closedAt": "2020-07-17T20:27:09Z", "author": {"login": "sguggilam"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1VdWcAFqTQ0OTQ1MTA0Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc13Z2egFqTQ1MDg0MDQ4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NDUxMDQy", "url": "https://github.com/apache/hbase/pull/2076#pullrequestreview-449451042", "createdAt": "2020-07-16T01:41:49Z", "commit": {"oid": "78356c875934b95421002b96299b933612116bd1"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMTo0MTo0OVrOGyXELg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwMjowMzoyN1rOGyXbag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ1OTg4Ng==", "bodyText": "branch-1 doesn't support parameterized logging, so wrap with LOG.isDebugEnabled() checks? Saves string construction when debug logging isn't enabled. (multiple places).", "url": "https://github.com/apache/hbase/pull/2076#discussion_r455459886", "createdAt": "2020-07-16T01:41:49Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.java", "diffHunk": "@@ -624,14 +623,16 @@ private void takeSnapshotInternal(SnapshotDescription snapshot) throws IOExcepti\n     AssignmentManager assignmentMgr = master.getAssignmentManager();\n     if (assignmentMgr.getTableStateManager().isTableState(snapshotTable,\n         ZooKeeperProtos.Table.State.ENABLED)) {\n-      LOG.debug(\"Table enabled, starting distributed snapshot.\");\n+      LOG.debug(\"Table enabled, starting distributed snapshot for \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78356c875934b95421002b96299b933612116bd1"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ2NTgzNA==", "bodyText": "Any reason to have a separate setter instead of passing it via create() ?", "url": "https://github.com/apache/hbase/pull/2076#discussion_r455465834", "createdAt": "2020-07-16T02:03:27Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotManifest.java", "diffHunk": "@@ -343,6 +343,13 @@ private void load() throws IOException {\n     }\n   }\n \n+  /**\n+   * Sets the status task for monitoring all the subtasks for Snapshot operation\n+   */\n+  public void setMonitoredTask(MonitoredTask statusTask) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78356c875934b95421002b96299b933612116bd1"}, "originalPosition": 53}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NzM0MDIw", "url": "https://github.com/apache/hbase/pull/2076#pullrequestreview-449734020", "createdAt": "2020-07-16T10:49:30Z", "commit": {"oid": "78356c875934b95421002b96299b933612116bd1"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMDo0OTozMFrOGylk9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQxMDo1Nzo1N1rOGyl2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTY5NzY1NQ==", "bodyText": "Passing with create() sounds good, this class is anyways IA.Private, we can add new argument to public methods.", "url": "https://github.com/apache/hbase/pull/2076#discussion_r455697655", "createdAt": "2020-07-16T10:49:30Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotManifest.java", "diffHunk": "@@ -343,6 +343,13 @@ private void load() throws IOException {\n     }\n   }\n \n+  /**\n+   * Sets the status task for monitoring all the subtasks for Snapshot operation\n+   */\n+  public void setMonitoredTask(MonitoredTask statusTask) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ2NTgzNA=="}, "originalCommit": {"oid": "78356c875934b95421002b96299b933612116bd1"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTcwMjA2OA==", "bodyText": "looks like import reorder is due to formatter :)", "url": "https://github.com/apache/hbase/pull/2076#discussion_r455702068", "createdAt": "2020-07-16T10:57:57Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.java", "diffHunk": "@@ -34,22 +37,21 @@\n import java.util.concurrent.TimeUnit;\n import java.util.concurrent.locks.ReadWriteLock;\n import java.util.concurrent.locks.ReentrantReadWriteLock;\n-\n import org.apache.commons.logging.Log;\n import org.apache.commons.logging.LogFactory;\n-import org.apache.hadoop.hbase.classification.InterfaceAudience;\n-import org.apache.hadoop.hbase.classification.InterfaceStability;\n import org.apache.hadoop.conf.Configuration;\n import org.apache.hadoop.fs.FSDataInputStream;\n import org.apache.hadoop.fs.FileStatus;\n import org.apache.hadoop.fs.FileSystem;\n import org.apache.hadoop.fs.Path;\n-import org.apache.hadoop.hbase.TableName;\n import org.apache.hadoop.hbase.HBaseInterfaceAudience;\n import org.apache.hadoop.hbase.HConstants;\n import org.apache.hadoop.hbase.HTableDescriptor;\n-import org.apache.hadoop.hbase.Stoppable;\n import org.apache.hadoop.hbase.MetaTableAccessor;\n+import org.apache.hadoop.hbase.Stoppable;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.classification.InterfaceAudience;\n+import org.apache.hadoop.hbase.classification.InterfaceStability;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "78356c875934b95421002b96299b933612116bd1"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d04b5783108048fb4f7232b9507dc203ca0b83fc", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/d04b5783108048fb4f7232b9507dc203ca0b83fc", "committedDate": "2020-07-16T18:49:57Z", "message": "HBASE-24740 Enable journal logging for HBase snapshot operation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMjU0MDk4", "url": "https://github.com/apache/hbase/pull/2076#pullrequestreview-450254098", "createdAt": "2020-07-16T22:17:15Z", "commit": {"oid": "d04b5783108048fb4f7232b9507dc203ca0b83fc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNDA4NDEw", "url": "https://github.com/apache/hbase/pull/2076#pullrequestreview-450408410", "createdAt": "2020-07-17T06:41:42Z", "commit": {"oid": "d04b5783108048fb4f7232b9507dc203ca0b83fc"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjo0MTo0MlrOGzHN4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwNjo0ODo1MVrOGzHZCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI0ODgwMQ==", "bodyText": "It seems more straight to readers if we pass this in the create(). Also this class field can be final then. @sguggilam We can have two versions of create() I guess? The one supporting those call sites which do not need monitored task does not need to change.", "url": "https://github.com/apache/hbase/pull/2076#discussion_r456248801", "createdAt": "2020-07-17T06:41:42Z", "author": {"login": "liuml07"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotManifest.java", "diffHunk": "@@ -343,6 +343,13 @@ private void load() throws IOException {\n     }\n   }\n \n+  /**\n+   * Sets the status task for monitoring all the subtasks for Snapshot operation\n+   */\n+  public void setMonitoredTask(MonitoredTask statusTask) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ2NTgzNA=="}, "originalCommit": {"oid": "78356c875934b95421002b96299b933612116bd1"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI1MTY1OQ==", "bodyText": "Is this required?", "url": "https://github.com/apache/hbase/pull/2076#discussion_r456251659", "createdAt": "2020-07-17T06:48:51Z", "author": {"login": "liuml07"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/monitoring/MonitoredTaskImpl.java", "diffHunk": "@@ -18,15 +18,13 @@\n  */\n package org.apache.hadoop.hbase.monitoring;\n \n-import org.apache.hadoop.hbase.classification.InterfaceAudience;\n-\n import java.io.IOException;\n import java.util.ArrayList;\n import java.util.Collections;\n import java.util.HashMap;\n import java.util.List;\n import java.util.Map;\n-\n+import org.apache.hadoop.hbase.classification.InterfaceAudience;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d04b5783108048fb4f7232b9507dc203ca0b83fc"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNzA5MDg0", "url": "https://github.com/apache/hbase/pull/2076#pullrequestreview-450709084", "createdAt": "2020-07-17T14:33:06Z", "commit": {"oid": "d04b5783108048fb4f7232b9507dc203ca0b83fc"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNDozMzowNlrOGzVYVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNDozMzozM1rOGzVZQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQ4MDg1Mg==", "bodyText": "+1", "url": "https://github.com/apache/hbase/pull/2076#discussion_r456480852", "createdAt": "2020-07-17T14:33:06Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotManifest.java", "diffHunk": "@@ -343,6 +343,13 @@ private void load() throws IOException {\n     }\n   }\n \n+  /**\n+   * Sets the status task for monitoring all the subtasks for Snapshot operation\n+   */\n+  public void setMonitoredTask(MonitoredTask statusTask) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTQ2NTgzNA=="}, "originalCommit": {"oid": "78356c875934b95421002b96299b933612116bd1"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQ4MTA4OA==", "bodyText": "This also looks formatter's doing.", "url": "https://github.com/apache/hbase/pull/2076#discussion_r456481088", "createdAt": "2020-07-17T14:33:33Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/monitoring/MonitoredTaskImpl.java", "diffHunk": "@@ -18,15 +18,13 @@\n  */\n package org.apache.hadoop.hbase.monitoring;\n \n-import org.apache.hadoop.hbase.classification.InterfaceAudience;\n-\n import java.io.IOException;\n import java.util.ArrayList;\n import java.util.Collections;\n import java.util.HashMap;\n import java.util.List;\n import java.util.Map;\n-\n+import org.apache.hadoop.hbase.classification.InterfaceAudience;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjI1MTY1OQ=="}, "originalCommit": {"oid": "d04b5783108048fb4f7232b9507dc203ca0b83fc"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f6544aabbbdad41806e76df287cc97769c63a15", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/1f6544aabbbdad41806e76df287cc97769c63a15", "committedDate": "2020-07-17T17:02:24Z", "message": "review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwODQwNDgz", "url": "https://github.com/apache/hbase/pull/2076#pullrequestreview-450840483", "createdAt": "2020-07-17T17:37:05Z", "commit": {"oid": "1f6544aabbbdad41806e76df287cc97769c63a15"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4283, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}