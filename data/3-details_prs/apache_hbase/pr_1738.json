{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIwMTI0MDQ2", "number": 1738, "title": "HBASE-24399 [Flakey Tests] Some UTs about RSGroup should wait RSGroup\u2026", "bodyText": "\u2026InfoManager to be online\nhttps://issues.apache.org/jira/browse/HBASE-24399", "createdAt": "2020-05-19T13:35:16Z", "url": "https://github.com/apache/hbase/pull/1738", "merged": true, "mergeCommit": {"oid": "22e0e32e6b670bc4b8609c5d50a9cef2e50b1787"}, "closed": true, "closedAt": "2020-05-20T07:10:22Z", "author": {"login": "ddupg"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABci_IoKgH2gAyNDIwMTI0MDQ2OjVhZWVmYmVkYjMxNTE4NTIxMWY3M2Q4NDMzYzgyN2MxZDZhZTM1Njc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcjBF_mgFqTQxNDk3ODc2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5aeefbedb315185211f73d8433c827c1d6ae3567", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/5aeefbedb315185211f73d8433c827c1d6ae3567", "committedDate": "2020-05-20T01:52:57Z", "message": "HBASE-24399 [Flakey Tests] Some UTs about RSGroup should wait RSGroupInfoManager to be online"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "913ca5adefe8c75ca3c7ed15d296cf6f4be5a7d4", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/913ca5adefe8c75ca3c7ed15d296cf6f4be5a7d4", "committedDate": "2020-05-19T13:31:54Z", "message": "HBASE-24399 [Flakey Tests] Some UTs about RSGroup should wait RSGroupInfoManager to be online"}, "afterCommit": {"oid": "5aeefbedb315185211f73d8433c827c1d6ae3567", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/5aeefbedb315185211f73d8433c827c1d6ae3567", "committedDate": "2020-05-20T01:52:57Z", "message": "HBASE-24399 [Flakey Tests] Some UTs about RSGroup should wait RSGroupInfoManager to be online"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0OTU4MDY4", "url": "https://github.com/apache/hbase/pull/1738#pullrequestreview-414958068", "createdAt": "2020-05-20T02:54:34Z", "commit": {"oid": "5aeefbedb315185211f73d8433c827c1d6ae3567"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwMjo1NDozNVrOGX5iwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwMjo1NDozNVrOGX5iwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzcxMzIxOA==", "bodyText": "Why this removed?", "url": "https://github.com/apache/hbase/pull/1738#discussion_r427713218", "createdAt": "2020-05-20T02:54:35Z", "author": {"login": "infraio"}, "path": "hbase-rsgroup/src/test/java/org/apache/hadoop/hbase/rsgroup/TestRSGroupUtil.java", "diffHunk": "@@ -57,39 +68,40 @@ public static void setUp() throws Exception {\n       RSGroupAdminEndpoint.class.getName());\n     UTIL.startMiniCluster(5);\n     master = UTIL.getMiniHBaseCluster().getMaster();\n-    admin = UTIL.getAdmin();\n-    rsGroupAdminClient = new RSGroupAdminClient(UTIL.getConnection());\n \n-    HRegionServer rs = UTIL.getHBaseCluster().getRegionServer(0);\n-    rsGroupAdminClient.addRSGroup(GROUP_NAME);\n-    rsGroupAdminClient.moveServers(Collections.singleton(rs.getServerName().getAddress()), GROUP_NAME);\n-    admin.createNamespace(NamespaceDescriptor.create(NAMESPACE_NAME)\n-      .addConfiguration(RSGroupInfo.NAMESPACE_DESC_PROP_GROUP, GROUP_NAME)\n-      .build());\n+    UTIL.waitFor(60000, (Predicate<Exception>) () ->\n+        master.isInitialized() && ((RSGroupBasedLoadBalancer) master.getLoadBalancer()).isOnline());\n \n-    rsGroupInfoManager = RSGroupInfoManagerImpl.getInstance(master);\n-    rsGroupInfoManager.start();\n+    rsGroupAdminClient = new RSGroupAdminClient(UTIL.getConnection());\n+\n+    List<RSGroupAdminEndpoint> cps =\n+        master.getMasterCoprocessorHost().findCoprocessors(RSGroupAdminEndpoint.class);\n+    assertTrue(cps.size() > 0);\n+    rsGroupInfoManager = cps.get(0).getGroupInfoManager();\n   }\n \n   @AfterClass\n-  public static void tearDown() throws IOException {\n-    admin.deleteNamespace(NAMESPACE_NAME);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5aeefbedb315185211f73d8433c827c1d6ae3567"}, "originalPosition": 82}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE0OTc4NzYy", "url": "https://github.com/apache/hbase/pull/1738#pullrequestreview-414978762", "createdAt": "2020-05-20T04:09:53Z", "commit": {"oid": "5aeefbedb315185211f73d8433c827c1d6ae3567"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4672, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}