{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwMTA2NTMw", "number": 2514, "title": "HBASE-25166 MobFileCompactionChore is closing the master's shared clu\u2026", "bodyText": "\u2026ster connection", "createdAt": "2020-10-08T18:26:06Z", "url": "https://github.com/apache/hbase/pull/2514", "merged": true, "mergeCommit": {"oid": "7d00e43dce576387f16e87fc7f89dd03358cc7a1"}, "closed": true, "closedAt": "2020-10-20T05:22:34Z", "author": {"login": "ankitsinghal"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQl8L5gFqTUwNTA1ODYwOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUH2tmgBqjM4OTQ3MzY2MTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MDU4NjA5", "url": "https://github.com/apache/hbase/pull/2514#pullrequestreview-505058609", "createdAt": "2020-10-08T18:32:14Z", "commit": {"oid": "30b50200e654299960bf8be46af6e88e09e4b795"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODozMjoxNFrOHeraDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxODozMjoxNFrOHeraDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkzMDUwOQ==", "bodyText": "I feel like we've run into this a few times recently.\nAny thoughts about whether it's a good idea to make the ShortCircuitingClusterConnection not close itself (unless we can know that we're in the process of shutting down)?", "url": "https://github.com/apache/hbase/pull/2514#discussion_r501930509", "createdAt": "2020-10-08T18:32:14Z", "author": {"login": "joshelser"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/mob/MobFileCompactionChore.java", "diffHunk": "@@ -84,10 +84,10 @@ public MobFileCompactionChore(Configuration conf, int batchSize) {\n   protected void chore() {\n \n     boolean reported = false;\n-\n-    try (Connection conn = master.getConnection();\n-        Admin admin = conn.getAdmin();) {\n-\n+    Admin admin = null;\n+    try {\n+      Connection conn = master.getConnection();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30b50200e654299960bf8be46af6e88e09e4b795"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MDkxNjc2", "url": "https://github.com/apache/hbase/pull/2514#pullrequestreview-505091676", "createdAt": "2020-10-08T19:16:07Z", "commit": {"oid": "30b50200e654299960bf8be46af6e88e09e4b795"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxOToxNjowN1rOHes8TA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxOToxNjowN1rOHes8TA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk1NTY2MA==", "bodyText": "Can we just use try with resources on the Admin object? Do we actually use the Connection at all?", "url": "https://github.com/apache/hbase/pull/2514#discussion_r501955660", "createdAt": "2020-10-08T19:16:07Z", "author": {"login": "busbey"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/mob/MobFileCompactionChore.java", "diffHunk": "@@ -84,10 +84,10 @@ public MobFileCompactionChore(Configuration conf, int batchSize) {\n   protected void chore() {\n \n     boolean reported = false;\n-\n-    try (Connection conn = master.getConnection();\n-        Admin admin = conn.getAdmin();) {\n-\n+    Admin admin = null;\n+    try {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30b50200e654299960bf8be46af6e88e09e4b795"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MzI3NjA0", "url": "https://github.com/apache/hbase/pull/2514#pullrequestreview-505327604", "createdAt": "2020-10-09T02:56:13Z", "commit": {"oid": "05bd9f4a505ed65e155aebc79998098c6a86d6fe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1NTE5OTI1", "url": "https://github.com/apache/hbase/pull/2514#pullrequestreview-505519925", "createdAt": "2020-10-09T09:42:32Z", "commit": {"oid": "05bd9f4a505ed65e155aebc79998098c6a86d6fe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MTM1MDQx", "url": "https://github.com/apache/hbase/pull/2514#pullrequestreview-506135041", "createdAt": "2020-10-11T00:45:40Z", "commit": {"oid": "05bd9f4a505ed65e155aebc79998098c6a86d6fe"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "317258499d8f351535bf66752f23901dfa26116f", "author": {"user": {"login": "ankitsinghal", "name": "Ankit Singhal"}}, "url": "https://github.com/apache/hbase/commit/317258499d8f351535bf66752f23901dfa26116f", "committedDate": "2020-10-19T17:44:22Z", "message": "HBASE-25166 MobFileCompactionChore is closing the master's shared cluster connection"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05bd9f4a505ed65e155aebc79998098c6a86d6fe", "author": {"user": {"login": "ankitsinghal", "name": "Ankit Singhal"}}, "url": "https://github.com/apache/hbase/commit/05bd9f4a505ed65e155aebc79998098c6a86d6fe", "committedDate": "2020-10-09T00:51:48Z", "message": "Close Admin resource under try"}, "afterCommit": {"oid": "317258499d8f351535bf66752f23901dfa26116f", "author": {"user": {"login": "ankitsinghal", "name": "Ankit Singhal"}}, "url": "https://github.com/apache/hbase/commit/317258499d8f351535bf66752f23901dfa26116f", "committedDate": "2020-10-19T17:44:22Z", "message": "HBASE-25166 MobFileCompactionChore is closing the master's shared cluster connection"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4322, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}