{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxODMzMDkx", "number": 1315, "title": "HBASE-24030 Add necessary validations to HRegion.checkAndMutate() and\u2026", "bodyText": "\u2026 HRegion.checkAndRowMutate()", "createdAt": "2020-03-21T08:44:43Z", "url": "https://github.com/apache/hbase/pull/1315", "merged": true, "mergeCommit": {"oid": "9b4e75a7f6b876e00c6360dd69adb13d3200b1f2"}, "closed": true, "closedAt": "2020-03-22T02:55:53Z", "author": {"login": "brfrn169"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPx5n1ABqjMxNTE1OTcyMDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcP9UcSgFqTM3ODk1ODI1Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88658d522f718315f6ab58b63581ab8b7cf74ae8", "author": {"user": {"login": "brfrn169", "name": "Toshihiro Suzuki"}}, "url": "https://github.com/apache/hbase/commit/88658d522f718315f6ab58b63581ab8b7cf74ae8", "committedDate": "2020-03-21T08:42:05Z", "message": "HBASE-24030 Add necessary validations to HRegion.checkAndMutate() and HRegion.checkAndRowMutate()"}, "afterCommit": {"oid": "7f8dc9814f304d5bc95b74387230b45cbf6f83af", "author": {"user": {"login": "brfrn169", "name": "Toshihiro Suzuki"}}, "url": "https://github.com/apache/hbase/commit/7f8dc9814f304d5bc95b74387230b45cbf6f83af", "committedDate": "2020-03-21T09:41:23Z", "message": "HBASE-24030 Add necessary validations to HRegion.checkAndMutate() and HRegion.checkAndRowMutate()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTA3NDgy", "url": "https://github.com/apache/hbase/pull/1315#pullrequestreview-378907482", "createdAt": "2020-03-21T10:09:14Z", "commit": {"oid": "7f8dc9814f304d5bc95b74387230b45cbf6f83af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxMDowOToxNVrOF5osjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxMDowOToxNVrOF5osjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk3OTkxOQ==", "bodyText": "would it be better to put checkMutationType() and checkRow() in doCheckAndRowMutate() method?", "url": "https://github.com/apache/hbase/pull/1315#discussion_r395979919", "createdAt": "2020-03-21T10:09:15Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java", "diffHunk": "@@ -4207,26 +4208,31 @@ protected Durability getEffectiveDurability(Durability d) {\n   @Override\n   public boolean checkAndMutate(byte[] row, byte[] family, byte[] qualifier, CompareOperator op,\n     ByteArrayComparable comparator, TimeRange timeRange, Mutation mutation) throws IOException {\n-    checkMutationType(mutation, row);\n+    checkMutationType(mutation);\n+    checkRow(mutation, row);\n     return doCheckAndRowMutate(row, family, qualifier, op, comparator, null, timeRange, null,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f8dc9814f304d5bc95b74387230b45cbf6f83af"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95dbd19b7ca237d3fc4f19cc9a95d2710526324d", "author": {"user": {"login": "brfrn169", "name": "Toshihiro Suzuki"}}, "url": "https://github.com/apache/hbase/commit/95dbd19b7ca237d3fc4f19cc9a95d2710526324d", "committedDate": "2020-03-21T11:40:32Z", "message": "HBASE-24030 Add necessary validations to HRegion.checkAndMutate() and HRegion.checkAndRowMutate()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7f8dc9814f304d5bc95b74387230b45cbf6f83af", "author": {"user": {"login": "brfrn169", "name": "Toshihiro Suzuki"}}, "url": "https://github.com/apache/hbase/commit/7f8dc9814f304d5bc95b74387230b45cbf6f83af", "committedDate": "2020-03-21T09:41:23Z", "message": "HBASE-24030 Add necessary validations to HRegion.checkAndMutate() and HRegion.checkAndRowMutate()"}, "afterCommit": {"oid": "95dbd19b7ca237d3fc4f19cc9a95d2710526324d", "author": {"user": {"login": "brfrn169", "name": "Toshihiro Suzuki"}}, "url": "https://github.com/apache/hbase/commit/95dbd19b7ca237d3fc4f19cc9a95d2710526324d", "committedDate": "2020-03-21T11:40:32Z", "message": "HBASE-24030 Add necessary validations to HRegion.checkAndMutate() and HRegion.checkAndRowMutate()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTEyNjU2", "url": "https://github.com/apache/hbase/pull/1315#pullrequestreview-378912656", "createdAt": "2020-03-21T11:43:33Z", "commit": {"oid": "95dbd19b7ca237d3fc4f19cc9a95d2710526324d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTIzMTgy", "url": "https://github.com/apache/hbase/pull/1315#pullrequestreview-378923182", "createdAt": "2020-03-21T14:38:07Z", "commit": {"oid": "95dbd19b7ca237d3fc4f19cc9a95d2710526324d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxNDozODowN1rOF5pyyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxNDozODowN1rOF5pyyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk5Nzg5Ng==", "bodyText": "Are there also positive test cases? The new one's only seem to catch exceptions?", "url": "https://github.com/apache/hbase/pull/1315#discussion_r395997896", "createdAt": "2020-03-21T14:38:07Z", "author": {"login": "HorizonNet"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java", "diffHunk": "@@ -2268,6 +2269,78 @@ public void testCheckAndMutate_WithFiltersAndTimeRange() throws Throwable {\n     assertTrue(region.get(new Get(row).addColumn(FAMILY, Bytes.toBytes(\"A\"))).isEmpty());\n   }\n \n+  @Test\n+  public void testCheckAndMutate_wrongMutationType() throws Throwable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95dbd19b7ca237d3fc4f19cc9a95d2710526324d"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4OTU4MjU3", "url": "https://github.com/apache/hbase/pull/1315#pullrequestreview-378958257", "createdAt": "2020-03-21T23:01:29Z", "commit": {"oid": "95dbd19b7ca237d3fc4f19cc9a95d2710526324d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2724, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}