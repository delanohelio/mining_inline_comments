{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMjA1NzU0", "number": 1494, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QwNjo0MzozM1rODxJ_gQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNToyODoxM1rODyxS-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyODcwNTI5OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QwNjo0MzozM1rOGEeQAQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QwNjo1MjoxOVrOGEeaXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0MzEwNQ==", "bodyText": "If we want to make this change, it should go to master, branch-2 first right?", "url": "https://github.com/apache/hbase/pull/1494#discussion_r407343105", "createdAt": "2020-04-13T06:43:33Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -2260,16 +2259,13 @@ public RpcServer(final Server server, final String name,\n   }\n \n   @Override\n-  public void onConfigurationChange(Configuration newConf) {\n+  public synchronized void onConfigurationChange(Configuration newConf) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ebc1791149d292eec1358fc5b1bc60275526ce6"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0NTEyNQ==", "bodyText": "I saw the warning in branch-1 only after HBASE-24174. I can forward-port to branch-2 and master. But as you said it is supressed, dilemma...", "url": "https://github.com/apache/hbase/pull/1494#discussion_r407345125", "createdAt": "2020-04-13T06:50:14Z", "author": {"login": "Reidddddd"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -2260,16 +2259,13 @@ public RpcServer(final Server server, final String name,\n   }\n \n   @Override\n-  public void onConfigurationChange(Configuration newConf) {\n+  public synchronized void onConfigurationChange(Configuration newConf) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0MzEwNQ=="}, "originalCommit": {"oid": "9ebc1791149d292eec1358fc5b1bc60275526ce6"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0NTc1OA==", "bodyText": "Right, it is suppressed there. Either we can backport suppressed one or forward port this to branch-2+ and remove suppression there. Sure, let's see QA \ud83d\udc4d", "url": "https://github.com/apache/hbase/pull/1494#discussion_r407345758", "createdAt": "2020-04-13T06:52:19Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -2260,16 +2259,13 @@ public RpcServer(final Server server, final String name,\n   }\n \n   @Override\n-  public void onConfigurationChange(Configuration newConf) {\n+  public synchronized void onConfigurationChange(Configuration newConf) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0MzEwNQ=="}, "originalCommit": {"oid": "9ebc1791149d292eec1358fc5b1bc60275526ce6"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU0NTYzMDY0OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNToyODoxM1rOGHAZ7w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwNTozMjo0MlrOGHAeAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTk5OTg1NQ==", "bodyText": "btw, this if condition is an enhancement for this patch? is it necessary?", "url": "https://github.com/apache/hbase/pull/1494#discussion_r409999855", "createdAt": "2020-04-17T05:28:13Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -2265,14 +2264,9 @@ public void onConfigurationChange(Configuration newConf) {\n     if (scheduler instanceof ConfigurationObserver) {\n       ((ConfigurationObserver)scheduler).onConfigurationChange(newConf);\n     }\n-    // Make sure authManager will read hbase-policy file\n-    System.setProperty(\"hadoop.policy.file\", \"hbase-policy.xml\");\n-    synchronized (authManager) {\n-      authManager.refresh(newConf, new HBasePolicyProvider());\n+    if (authorize) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e6f3aaff67ff85e58129ba310fa3bad30818ec7"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAwMDY3MA==", "bodyText": "Yes, it is, to avoid unnecessary refresh. If authorization is disabled, then no need to refresh it which it is time consuming.\nWe should forward-port this patch to branch-2+ and master as well, quite some changes.", "url": "https://github.com/apache/hbase/pull/1494#discussion_r410000670", "createdAt": "2020-04-17T05:31:45Z", "author": {"login": "Reidddddd"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -2265,14 +2264,9 @@ public void onConfigurationChange(Configuration newConf) {\n     if (scheduler instanceof ConfigurationObserver) {\n       ((ConfigurationObserver)scheduler).onConfigurationChange(newConf);\n     }\n-    // Make sure authManager will read hbase-policy file\n-    System.setProperty(\"hadoop.policy.file\", \"hbase-policy.xml\");\n-    synchronized (authManager) {\n-      authManager.refresh(newConf, new HBasePolicyProvider());\n+    if (authorize) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTk5OTg1NQ=="}, "originalCommit": {"oid": "6e6f3aaff67ff85e58129ba310fa3bad30818ec7"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAwMDg5OA==", "bodyText": "\ud83d\udc4d", "url": "https://github.com/apache/hbase/pull/1494#discussion_r410000898", "createdAt": "2020-04-17T05:32:42Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -2265,14 +2264,9 @@ public void onConfigurationChange(Configuration newConf) {\n     if (scheduler instanceof ConfigurationObserver) {\n       ((ConfigurationObserver)scheduler).onConfigurationChange(newConf);\n     }\n-    // Make sure authManager will read hbase-policy file\n-    System.setProperty(\"hadoop.policy.file\", \"hbase-policy.xml\");\n-    synchronized (authManager) {\n-      authManager.refresh(newConf, new HBasePolicyProvider());\n+    if (authorize) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTk5OTg1NQ=="}, "originalCommit": {"oid": "6e6f3aaff67ff85e58129ba310fa3bad30818ec7"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1908, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}