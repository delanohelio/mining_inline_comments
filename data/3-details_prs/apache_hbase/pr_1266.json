{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MjUyNDM2", "number": 1266, "title": "HBASE-23956 Use less resources running tests", "bodyText": "Add being able to configure netty thread counts. Enable socket reuse\n(should not have any impact).\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/BlockingRpcConnection.java\nRename the threads we create in here so they are NOT named same was\nthreads created by Hadoop RPC.\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/DefaultNettyEventLoopConfig.java\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcClient.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/AsyncFSWAL.java\nAllow configuring eventloopgroup thread count (so can override for\ntests)\nhbase-examples/src/main/java/org/apache/hadoop/hbase/client/example/HttpProxyExample.java\nEnable socket resuse.\nhbase-server/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcServer.java\nEnable socket resuse and config for how many threads to use.\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java\nThread name edit; drop the redundant 'Thread' suffix.\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/HFileReplicator.java\nMake closeable and shutdown executor when called.\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSink.java\nCall close on HFileReplicator\nhbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationBase.java\nHDFS creates lots of threads. Use less of it so less threads overall.\nhbase-server/src/test/resources/hbase-site.xml\nhbase-server/src/test/resources/hdfs-site.xml\nConstrain resources when running in test context.\nhbase-server/src/test/resources/log4j.properties\nEnable debug on netty to see netty configs in our log\npom.xml\nAdd system properties when we launch JVMs to constrain thread counts in\ntests", "createdAt": "2020-03-10T16:56:41Z", "url": "https://github.com/apache/hbase/pull/1266", "merged": true, "mergeCommit": {"oid": "2655f9647e492901ac9aebf7974ff8dc6b585f40"}, "closed": true, "closedAt": "2020-03-11T17:25:12Z", "author": {"login": "saintstack"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMbgzBAFqTM3MjM5NzA4MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMojVLABqjMxMTkyMzA0MTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMzk3MDgx", "url": "https://github.com/apache/hbase/pull/1266#pullrequestreview-372397081", "createdAt": "2020-03-10T23:54:31Z", "commit": {"oid": "2073d240679dade6036d031e021646ff7113d2a6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQyMzo1NDozMVrOF0k_lw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQyMzo1NDozMVrOF0k_lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDY3NjM3NQ==", "bodyText": "This is not the design...\nThe design is to create a new EventLoop and make the code use it.\nChange a configuration to change the 'default' instance and then make the code use the 'default' instance seems strange...\nAnd also another anti pattern is that, we even do not have a Configuration instance here...", "url": "https://github.com/apache/hbase/pull/1266#discussion_r390676375", "createdAt": "2020-03-10T23:54:31Z", "author": {"login": "Apache9"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/ipc/DefaultNettyEventLoopConfig.java", "diffHunk": "@@ -31,10 +30,16 @@\n  */\n @InterfaceAudience.Private\n class DefaultNettyEventLoopConfig {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2073d240679dade6036d031e021646ff7113d2a6"}, "originalPosition": 11}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2073d240679dade6036d031e021646ff7113d2a6", "author": {"user": {"login": "saintstack", "name": "Michael Stack"}}, "url": "https://github.com/apache/hbase/commit/2073d240679dade6036d031e021646ff7113d2a6", "committedDate": "2020-03-10T16:54:45Z", "message": "HBASE-23956 Use less resources running tests\n\nAdd being able to configure netty thread counts. Enable socket reuse\n(should not have any impact).\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/BlockingRpcConnection.java\n Rename the threads we create in here so they are NOT named same was\n threads created by Hadoop RPC.\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/DefaultNettyEventLoopConfig.java\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcClient.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/AsyncFSWAL.java\n Allow configuring eventloopgroup thread count (so can override for\n tests)\n\nhbase-examples/src/main/java/org/apache/hadoop/hbase/client/example/HttpProxyExample.java\n Enable socket resuse.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcServer.java\n Enable socket resuse and config for how many threads to use.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java\n Thread name edit; drop the redundant 'Thread' suffix.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/HFileReplicator.java\n Make closeable and shutdown executor when called.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSink.java\n Call close on HFileReplicator\n\nhbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationBase.java\n HDFS creates lots of threads. Use less of it so less threads overall.\n\nhbase-server/src/test/resources/hbase-site.xml\nhbase-server/src/test/resources/hdfs-site.xml\n Constrain resources when running in test context.\n\nhbase-server/src/test/resources/log4j.properties\n Enable debug on netty to see netty configs in our log\n\npom.xml\n Add system properties when we launch JVMs to constrain thread counts in\n tests"}, "afterCommit": {"oid": "b7ebaae98978699b7789669e8ad604ab588e0ba1", "author": {"user": {"login": "saintstack", "name": "Michael Stack"}}, "url": "https://github.com/apache/hbase/commit/b7ebaae98978699b7789669e8ad604ab588e0ba1", "committedDate": "2020-03-11T05:53:44Z", "message": "HBASE-23956 Use less resources running tests\n\nAdd being able to configure netty thread counts. Enable socket reuse\n(should not have any impact).\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/BlockingRpcConnection.java\n Rename the threads we create in here so they are NOT named same was\n threads created by Hadoop RPC.\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/DefaultNettyEventLoopConfig.java\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcClient.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/AsyncFSWAL.java\n Allow configuring eventloopgroup thread count (so can override for\n tests)\n\nhbase-examples/src/main/java/org/apache/hadoop/hbase/client/example/HttpProxyExample.java\n Enable socket resuse.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcServer.java\n Enable socket resuse and config for how many threads to use.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java\n Thread name edit; drop the redundant 'Thread' suffix.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/HFileReplicator.java\n Make closeable and shutdown executor when called.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSink.java\n Call close on HFileReplicator\n\nhbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationBase.java\n HDFS creates lots of threads. Use less of it so less threads overall.\n\nhbase-server/src/test/resources/hbase-site.xml\nhbase-server/src/test/resources/hdfs-site.xml\n Constrain resources when running in test context.\n\nhbase-server/src/test/resources/log4j.properties\n Enable debug on netty to see netty configs in our log\n\npom.xml\n Add system properties when we launch JVMs to constrain thread counts in\n tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c12d53fa4b36ae9f64ea55eaacfe0dcc05545832", "author": {"user": {"login": "saintstack", "name": "Michael Stack"}}, "url": "https://github.com/apache/hbase/commit/c12d53fa4b36ae9f64ea55eaacfe0dcc05545832", "committedDate": "2020-03-11T15:07:36Z", "message": "HBASE-23956 Use less resources running tests\n\nAdd being able to configure netty thread counts. Enable socket reuse\n(should not have any impact).\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/BlockingRpcConnection.java\n Rename the threads we create in here so they are NOT named same was\n threads created by Hadoop RPC.\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/DefaultNettyEventLoopConfig.java\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcClient.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/AsyncFSWAL.java\n Allow configuring eventloopgroup thread count (so can override for\n tests)\n\nhbase-examples/src/main/java/org/apache/hadoop/hbase/client/example/HttpProxyExample.java\n Enable socket resuse.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcServer.java\n Enable socket resuse and config for how many threads to use.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java\n Thread name edit; drop the redundant 'Thread' suffix.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/HFileReplicator.java\n Make closeable and shutdown executor when called.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSink.java\n Call close on HFileReplicator\n\nhbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationBase.java\n HDFS creates lots of threads. Use less of it so less threads overall.\n\nhbase-server/src/test/resources/hbase-site.xml\nhbase-server/src/test/resources/hdfs-site.xml\n Constrain resources when running in test context.\n\nhbase-server/src/test/resources/log4j.properties\n Enable debug on netty to see netty configs in our log\n\npom.xml\n Add system properties when we launch JVMs to constrain thread counts in\n tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b7ebaae98978699b7789669e8ad604ab588e0ba1", "author": {"user": {"login": "saintstack", "name": "Michael Stack"}}, "url": "https://github.com/apache/hbase/commit/b7ebaae98978699b7789669e8ad604ab588e0ba1", "committedDate": "2020-03-11T05:53:44Z", "message": "HBASE-23956 Use less resources running tests\n\nAdd being able to configure netty thread counts. Enable socket reuse\n(should not have any impact).\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/BlockingRpcConnection.java\n Rename the threads we create in here so they are NOT named same was\n threads created by Hadoop RPC.\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/DefaultNettyEventLoopConfig.java\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcClient.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/AsyncFSWAL.java\n Allow configuring eventloopgroup thread count (so can override for\n tests)\n\nhbase-examples/src/main/java/org/apache/hadoop/hbase/client/example/HttpProxyExample.java\n Enable socket resuse.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcServer.java\n Enable socket resuse and config for how many threads to use.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java\n Thread name edit; drop the redundant 'Thread' suffix.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/HFileReplicator.java\n Make closeable and shutdown executor when called.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSink.java\n Call close on HFileReplicator\n\nhbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationBase.java\n HDFS creates lots of threads. Use less of it so less threads overall.\n\nhbase-server/src/test/resources/hbase-site.xml\nhbase-server/src/test/resources/hdfs-site.xml\n Constrain resources when running in test context.\n\nhbase-server/src/test/resources/log4j.properties\n Enable debug on netty to see netty configs in our log\n\npom.xml\n Add system properties when we launch JVMs to constrain thread counts in\n tests"}, "afterCommit": {"oid": "c12d53fa4b36ae9f64ea55eaacfe0dcc05545832", "author": {"user": {"login": "saintstack", "name": "Michael Stack"}}, "url": "https://github.com/apache/hbase/commit/c12d53fa4b36ae9f64ea55eaacfe0dcc05545832", "committedDate": "2020-03-11T15:07:36Z", "message": "HBASE-23956 Use less resources running tests\n\nAdd being able to configure netty thread counts. Enable socket reuse\n(should not have any impact).\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/BlockingRpcConnection.java\n Rename the threads we create in here so they are NOT named same was\n threads created by Hadoop RPC.\n\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/DefaultNettyEventLoopConfig.java\nhbase-client/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcClient.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/AsyncFSWAL.java\n Allow configuring eventloopgroup thread count (so can override for\n tests)\n\nhbase-examples/src/main/java/org/apache/hadoop/hbase/client/example/HttpProxyExample.java\n Enable socket resuse.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/ipc/NettyRpcServer.java\n Enable socket resuse and config for how many threads to use.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java\nhbase-server/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java\n Thread name edit; drop the redundant 'Thread' suffix.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/HFileReplicator.java\n Make closeable and shutdown executor when called.\n\nhbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSink.java\n Call close on HFileReplicator\n\nhbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationBase.java\n HDFS creates lots of threads. Use less of it so less threads overall.\n\nhbase-server/src/test/resources/hbase-site.xml\nhbase-server/src/test/resources/hdfs-site.xml\n Constrain resources when running in test context.\n\nhbase-server/src/test/resources/log4j.properties\n Enable debug on netty to see netty configs in our log\n\npom.xml\n Add system properties when we launch JVMs to constrain thread counts in\n tests"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2631, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}