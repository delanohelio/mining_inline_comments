{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2NTI3OTE0", "number": 2396, "title": "[Flaky Test][branch-1] TestFromClientSide#testCheckAndDeleteWithCompareOp", "bodyText": "https://issues.apache.org/jira/browse/HBASE-25025", "createdAt": "2020-09-14T11:04:41Z", "url": "https://github.com/apache/hbase/pull/2396", "merged": true, "mergeCommit": {"oid": "93b76fdb322130b474a122494a3844893e628443"}, "closed": true, "closedAt": "2020-09-29T06:38:22Z", "author": {"login": "Reidddddd"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJKPLbgFqTQ4ODg0MDkzOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdNQOjvABqjM4MTM1NjQ2NjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4ODQwOTM4", "url": "https://github.com/apache/hbase/pull/2396#pullrequestreview-488840938", "createdAt": "2020-09-15T16:06:14Z", "commit": {"oid": "74345240a52ce4684f1ee9d7b84a94d432910517"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjowNjoxNVrOHSJMIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNjoxMDo1MFrOHSJYag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc4Njk3Nw==", "bodyText": "so this was just a redundant put right?", "url": "https://github.com/apache/hbase/pull/2396#discussion_r488786977", "createdAt": "2020-09-15T16:06:15Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java", "diffHunk": "@@ -5028,73 +5028,70 @@ public void testCheckAndDeleteWithCompareOp() throws IOException, InterruptedExc\n         FAMILY);\n     TEST_UTIL.waitTableAvailable(TableName.valueOf(\"testCheckAndDeleteWithCompareOp\"), 10000);\n \n-    Put put2 = new Put(ROW);\n-    put2.add(FAMILY, QUALIFIER, value2);\n-    table.put(put2);\n+    Put bbbb = new Put(ROW);\n+    bbbb.add(FAMILY, QUALIFIER, value2);\n \n-    Put put3 = new Put(ROW);\n-    put3.add(FAMILY, QUALIFIER, value3);\n+    Put cccc = new Put(ROW);\n+    cccc.add(FAMILY, QUALIFIER, value3);\n \n     Delete delete = new Delete(ROW);\n     delete.deleteColumns(FAMILY, QUALIFIER);\n \n     // cell = \"bbbb\", using \"aaaa\" to compare only LESS/LESS_OR_EQUAL/NOT_EQUAL\n     // turns out \"match\"\n+    table.put(bbbb);\n     boolean ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.GREATER, value1, delete);\n-    assertEquals(ok, false);\n+    // aaaa is less than bbbb, > || >= should be false\n+    assertFalse(ok);\n     ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.EQUAL, value1, delete);\n-    assertEquals(ok, false);\n+    assertFalse(ok);\n     ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.GREATER_OR_EQUAL, value1, delete);\n-    assertEquals(ok, false);\n+    assertFalse(ok);\n+    // aaaa is less than bbbb, < || <= should be true\n     ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.LESS, value1, delete);\n-    assertEquals(ok, true);\n-    table.put(put2);\n+    assertTrue(ok);\n+    table.put(bbbb);\n     ok = table.checkAndDelete(ROW, FAMILY, QUALIFIER, CompareOp.LESS_OR_EQUAL, value1, delete);\n-    assertEquals(ok, true);\n-    table.put(put2);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "74345240a52ce4684f1ee9d7b84a94d432910517"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc5MDEyMg==", "bodyText": "Curious to know if keeping this put operation on this line is a code improvement or has something to do with flaky behaviour?", "url": "https://github.com/apache/hbase/pull/2396#discussion_r488790122", "createdAt": "2020-09-15T16:10:50Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java", "diffHunk": "@@ -5028,73 +5028,70 @@ public void testCheckAndDeleteWithCompareOp() throws IOException, InterruptedExc\n         FAMILY);\n     TEST_UTIL.waitTableAvailable(TableName.valueOf(\"testCheckAndDeleteWithCompareOp\"), 10000);\n \n-    Put put2 = new Put(ROW);\n-    put2.add(FAMILY, QUALIFIER, value2);\n-    table.put(put2);\n+    Put bbbb = new Put(ROW);\n+    bbbb.add(FAMILY, QUALIFIER, value2);\n \n-    Put put3 = new Put(ROW);\n-    put3.add(FAMILY, QUALIFIER, value3);\n+    Put cccc = new Put(ROW);\n+    cccc.add(FAMILY, QUALIFIER, value3);\n \n     Delete delete = new Delete(ROW);\n     delete.deleteColumns(FAMILY, QUALIFIER);\n \n     // cell = \"bbbb\", using \"aaaa\" to compare only LESS/LESS_OR_EQUAL/NOT_EQUAL\n     // turns out \"match\"\n+    table.put(bbbb);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "74345240a52ce4684f1ee9d7b84a94d432910517"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5MzM1MTIz", "url": "https://github.com/apache/hbase/pull/2396#pullrequestreview-489335123", "createdAt": "2020-09-16T07:11:55Z", "commit": {"oid": "74345240a52ce4684f1ee9d7b84a94d432910517"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2537bc03fe3658e28162b03445d0ca993bd8d511", "author": {"user": {"login": "Reidddddd", "name": "Reid Chan"}}, "url": "https://github.com/apache/hbase/commit/2537bc03fe3658e28162b03445d0ca993bd8d511", "committedDate": "2020-09-28T09:32:15Z", "message": "HBASE-25025 [Flaky Test][branch-1] TestFromClientSide#testCheckAndDeleteWithCompareOp"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "74345240a52ce4684f1ee9d7b84a94d432910517", "author": {"user": {"login": "Reidddddd", "name": "Reid Chan"}}, "url": "https://github.com/apache/hbase/commit/74345240a52ce4684f1ee9d7b84a94d432910517", "committedDate": "2020-09-14T11:03:19Z", "message": "[Flaky Test][branch-1] TestFromClientSide#testCheckAndDeleteWithCompareOp"}, "afterCommit": {"oid": "2537bc03fe3658e28162b03445d0ca993bd8d511", "author": {"user": {"login": "Reidddddd", "name": "Reid Chan"}}, "url": "https://github.com/apache/hbase/commit/2537bc03fe3658e28162b03445d0ca993bd8d511", "committedDate": "2020-09-28T09:32:15Z", "message": "HBASE-25025 [Flaky Test][branch-1] TestFromClientSide#testCheckAndDeleteWithCompareOp"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4804, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}