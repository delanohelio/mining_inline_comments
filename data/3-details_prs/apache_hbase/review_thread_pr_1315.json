{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxODMzMDkx", "number": 1315, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxMDowOToxNVrODqEtxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxNDozODowN1rODqFjnw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NDQ0MDM4OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxMDowOToxNVrOF5osjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxMTozODo0N1rOF5pCJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk3OTkxOQ==", "bodyText": "would it be better to put checkMutationType() and checkRow() in doCheckAndRowMutate() method?", "url": "https://github.com/apache/hbase/pull/1315#discussion_r395979919", "createdAt": "2020-03-21T10:09:15Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java", "diffHunk": "@@ -4207,26 +4208,31 @@ protected Durability getEffectiveDurability(Durability d) {\n   @Override\n   public boolean checkAndMutate(byte[] row, byte[] family, byte[] qualifier, CompareOperator op,\n     ByteArrayComparable comparator, TimeRange timeRange, Mutation mutation) throws IOException {\n-    checkMutationType(mutation, row);\n+    checkMutationType(mutation);\n+    checkRow(mutation, row);\n     return doCheckAndRowMutate(row, family, qualifier, op, comparator, null, timeRange, null,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7f8dc9814f304d5bc95b74387230b45cbf6f83af"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk4NTQ0Nw==", "bodyText": "@virajjasani Thank you for reviewing this.\nSure. I'll do that.", "url": "https://github.com/apache/hbase/pull/1315#discussion_r395985447", "createdAt": "2020-03-21T11:38:47Z", "author": {"login": "brfrn169"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java", "diffHunk": "@@ -4207,26 +4208,31 @@ protected Durability getEffectiveDurability(Durability d) {\n   @Override\n   public boolean checkAndMutate(byte[] row, byte[] family, byte[] qualifier, CompareOperator op,\n     ByteArrayComparable comparator, TimeRange timeRange, Mutation mutation) throws IOException {\n-    checkMutationType(mutation, row);\n+    checkMutationType(mutation);\n+    checkRow(mutation, row);\n     return doCheckAndRowMutate(row, family, qualifier, op, comparator, null, timeRange, null,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk3OTkxOQ=="}, "originalCommit": {"oid": "7f8dc9814f304d5bc95b74387230b45cbf6f83af"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NDU3ODIzOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQxNDozODowN1rOF5pyyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMVQyMDowMDowNlrOF5rZrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk5Nzg5Ng==", "bodyText": "Are there also positive test cases? The new one's only seem to catch exceptions?", "url": "https://github.com/apache/hbase/pull/1315#discussion_r395997896", "createdAt": "2020-03-21T14:38:07Z", "author": {"login": "HorizonNet"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java", "diffHunk": "@@ -2268,6 +2269,78 @@ public void testCheckAndMutate_WithFiltersAndTimeRange() throws Throwable {\n     assertTrue(region.get(new Get(row).addColumn(FAMILY, Bytes.toBytes(\"A\"))).isEmpty());\n   }\n \n+  @Test\n+  public void testCheckAndMutate_wrongMutationType() throws Throwable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95dbd19b7ca237d3fc4f19cc9a95d2710526324d"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjAyNDIzOA==", "bodyText": "Thank you for reviewing this.\nYes, the new tests I added only catch exceptions, but I think we already have positive test cases for HRegion.checkAndMutate() and HRegion.checkAndRowMutate() originally.", "url": "https://github.com/apache/hbase/pull/1315#discussion_r396024238", "createdAt": "2020-03-21T20:00:06Z", "author": {"login": "brfrn169"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java", "diffHunk": "@@ -2268,6 +2269,78 @@ public void testCheckAndMutate_WithFiltersAndTimeRange() throws Throwable {\n     assertTrue(region.get(new Get(row).addColumn(FAMILY, Bytes.toBytes(\"A\"))).isEmpty());\n   }\n \n+  @Test\n+  public void testCheckAndMutate_wrongMutationType() throws Throwable {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTk5Nzg5Ng=="}, "originalCommit": {"oid": "95dbd19b7ca237d3fc4f19cc9a95d2710526324d"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2044, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}