{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzOTkwNDkw", "number": 2803, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQyMTozMToxM1rOFJoABw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQyMTozMToxM1rOFJoABw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQ1NjM2ODcxOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/TableDescriptorChecker.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOFQyMTozMToxM1rOIMCYgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yOVQwNDowNzoyMlrOIMGhog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQ5Mjg2NQ==", "bodyText": "Is this a little awkward? Should it be....\nlong maxFileSize = td.getMaxFileSize() == null? conf.getLong(HConstants.HREGION_MAX....): Long.parseLong(td.getMaxFileSize()); ?", "url": "https://github.com/apache/hbase/pull/2803#discussion_r549492865", "createdAt": "2020-12-28T21:31:13Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/TableDescriptorChecker.java", "diffHunk": "@@ -82,8 +83,11 @@ public static void sanityCheck(final Configuration c, final TableDescriptor td)\n \n     // check max file size\n     long maxFileSizeLowerLimit = 2 * 1024 * 1024L; // 2M is the default lower limit\n-    long maxFileSize = td.getMaxFileSize();\n-    if (maxFileSize < 0) {\n+    String maxFileSizeValue = td.getValue(TableDescriptorBuilder.MAX_FILESIZE);\n+    long maxFileSize = maxFileSizeValue == null? -1 : Long.parseLong(maxFileSizeValue);\n+    // if not set MAX_FILESIZE in TableDescriptor,\n+    // use maxFileSizeLowerLimit instead to skip this check\n+    if (maxFileSizeValue == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "828a3259ea0b345dc6a658457af080ebe2b17b03"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU2MDczOA==", "bodyText": "Thanks for the suggestion, fix it now.", "url": "https://github.com/apache/hbase/pull/2803#discussion_r549560738", "createdAt": "2020-12-29T04:07:22Z", "author": {"login": "ZhaoBQ"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/TableDescriptorChecker.java", "diffHunk": "@@ -82,8 +83,11 @@ public static void sanityCheck(final Configuration c, final TableDescriptor td)\n \n     // check max file size\n     long maxFileSizeLowerLimit = 2 * 1024 * 1024L; // 2M is the default lower limit\n-    long maxFileSize = td.getMaxFileSize();\n-    if (maxFileSize < 0) {\n+    String maxFileSizeValue = td.getValue(TableDescriptorBuilder.MAX_FILESIZE);\n+    long maxFileSize = maxFileSizeValue == null? -1 : Long.parseLong(maxFileSizeValue);\n+    // if not set MAX_FILESIZE in TableDescriptor,\n+    // use maxFileSizeLowerLimit instead to skip this check\n+    if (maxFileSizeValue == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQ5Mjg2NQ=="}, "originalCommit": {"oid": "828a3259ea0b345dc6a658457af080ebe2b17b03"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2259, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}