{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0Mjc4ODQ1", "number": 1797, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwODo0MDoxNVrOEAaiCQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDoxMDowNVrOEAqK9Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY4ODcwMTUzOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwODo0MDoxNVrOGbrV3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMDowODoyNlrOGbucqA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY3NDg0NQ==", "bodyText": "sleep is good enough right? why sleeps?", "url": "https://github.com/apache/hbase/pull/1797#discussion_r431674845", "createdAt": "2020-05-28T08:40:15Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java", "diffHunk": "@@ -1472,7 +1470,7 @@ private void waitOnAllRegionsToClose(final boolean abort) {\n     }\n   }\n \n-  private static boolean sleep(long millis) {\n+  private static boolean sleeps(long millis) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7fc7100665f35e3ebe88d0b1f2352b29c59e1f4"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY4Nzg0Ng==", "bodyText": "sleep is clash with Thread.", "url": "https://github.com/apache/hbase/pull/1797#discussion_r431687846", "createdAt": "2020-05-28T09:01:59Z", "author": {"login": "bsglz"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java", "diffHunk": "@@ -1472,7 +1470,7 @@ private void waitOnAllRegionsToClose(final boolean abort) {\n     }\n   }\n \n-  private static boolean sleep(long millis) {\n+  private static boolean sleeps(long millis) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY3NDg0NQ=="}, "originalCommit": {"oid": "f7fc7100665f35e3ebe88d0b1f2352b29c59e1f4"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTcxOTQ5MQ==", "bodyText": "Oh yes, missed it. Let's name it sleepInterrupted because it makes thread sleep and if interrupted, returns true, else false.", "url": "https://github.com/apache/hbase/pull/1797#discussion_r431719491", "createdAt": "2020-05-28T09:57:18Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java", "diffHunk": "@@ -1472,7 +1470,7 @@ private void waitOnAllRegionsToClose(final boolean abort) {\n     }\n   }\n \n-  private static boolean sleep(long millis) {\n+  private static boolean sleeps(long millis) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY3NDg0NQ=="}, "originalCommit": {"oid": "f7fc7100665f35e3ebe88d0b1f2352b29c59e1f4"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTcyNTczNg==", "bodyText": "Good idea, thanks.", "url": "https://github.com/apache/hbase/pull/1797#discussion_r431725736", "createdAt": "2020-05-28T10:08:26Z", "author": {"login": "bsglz"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java", "diffHunk": "@@ -1472,7 +1470,7 @@ private void waitOnAllRegionsToClose(final boolean abort) {\n     }\n   }\n \n-  private static boolean sleep(long millis) {\n+  private static boolean sleeps(long millis) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY3NDg0NQ=="}, "originalCommit": {"oid": "f7fc7100665f35e3ebe88d0b1f2352b29c59e1f4"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5MTI2MzQ2OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "isResolved": false, "comments": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDowOTo1N1rOGcFAeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQxMDo1NjoyMlrOGcYIoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTM1Mg==", "bodyText": "This is not needed w/ this patch?", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432095352", "createdAt": "2020-05-28T20:09:57Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -122,9 +121,9 @@ public SplitLogManager(MasterServices master, Configuration conf)\n       throws IOException {\n     this.server = master;\n     this.conf = conf;\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjIzODAwMg==", "bodyText": "Seems still needed, since the master here maybe a mocked one.\neg: DummyMasterServices in TestSplitLogManager, it extends MockNoopMasterServices which implement MasterServices, but does not extends Thread.\nThanks.", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432238002", "createdAt": "2020-05-29T03:36:38Z", "author": {"login": "bsglz"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -122,9 +121,9 @@ public SplitLogManager(MasterServices master, Configuration conf)\n       throws IOException {\n     this.server = master;\n     this.conf = conf;\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTM1Mg=="}, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI4Mzk1OA==", "bodyText": "We should not worry about mocked objects. Ideally, we can provide getName() default implementation in MasterServices and HMaster specifically can implement getName() as Thread.getName(), that way here the caller will just call: String name = master.getName();", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432283958", "createdAt": "2020-05-29T06:39:44Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -122,9 +121,9 @@ public SplitLogManager(MasterServices master, Configuration conf)\n       throws IOException {\n     this.server = master;\n     this.conf = conf;\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTM1Mg=="}, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI4NDY3Mw==", "bodyText": "However, there is no harm w/o this change as Stack said. Maybe good to take this clean-up in separate Jira if you would like.\nWill merge this PR in a while.", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432284673", "createdAt": "2020-05-29T06:41:49Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -122,9 +121,9 @@ public SplitLogManager(MasterServices master, Configuration conf)\n       throws IOException {\n     this.server = master;\n     this.conf = conf;\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTM1Mg=="}, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI4NjU3NA==", "bodyText": "Good idea, will fix it in separate jira.\nThanks.", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432286574", "createdAt": "2020-05-29T06:47:08Z", "author": {"login": "bsglz"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -122,9 +121,9 @@ public SplitLogManager(MasterServices master, Configuration conf)\n       throws IOException {\n     this.server = master;\n     this.conf = conf;\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTM1Mg=="}, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI5MDk1NA==", "bodyText": "Thanks @bsglz\nI just triggered one build. Let it go through and one result is out, will merge the PR.", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432290954", "createdAt": "2020-05-29T06:58:39Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -122,9 +121,9 @@ public SplitLogManager(MasterServices master, Configuration conf)\n       throws IOException {\n     this.server = master;\n     this.conf = conf;\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTM1Mg=="}, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjI5MzM0MQ==", "bodyText": "In addition, maybe we can just always use master.getServerName().toShortString() as name here, WDYT?", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432293341", "createdAt": "2020-05-29T07:04:58Z", "author": {"login": "bsglz"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -122,9 +121,9 @@ public SplitLogManager(MasterServices master, Configuration conf)\n       throws IOException {\n     this.server = master;\n     this.conf = conf;\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTM1Mg=="}, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQwMjUyMA==", "bodyText": "Yes, is should be fine. Does it match with ((Thread)master).getName() exactly? If so, let's do it now, else later.", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432402520", "createdAt": "2020-05-29T10:42:26Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -122,9 +121,9 @@ public SplitLogManager(MasterServices master, Configuration conf)\n       throws IOException {\n     this.server = master;\n     this.conf = conf;\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTM1Mg=="}, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQwODczNg==", "bodyText": "Not exactly.\n\ngetName returns master/xxx:16000\nmaster.getServerName().toShortString() returns xxx:16000\n\nSo, will do it later.\nThanks.", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432408736", "createdAt": "2020-05-29T10:56:22Z", "author": {"login": "bsglz"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -122,9 +121,9 @@ public SplitLogManager(MasterServices master, Configuration conf)\n       throws IOException {\n     this.server = master;\n     this.conf = conf;\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTM1Mg=="}, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5MTI2Mzg5OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMDoxMDowNVrOGcFAug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwMzozNjo1OFrOGcNt8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTQxOA==", "bodyText": "Ditto", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432095418", "createdAt": "2020-05-28T20:10:05Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java", "diffHunk": "@@ -1908,9 +1907,9 @@ protected void queueAssign(final RegionStateNode regionNode) {\n   }\n \n   private void startAssignmentThread() {\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjIzODA2Nw==", "bodyText": "Ditto", "url": "https://github.com/apache/hbase/pull/1797#discussion_r432238067", "createdAt": "2020-05-29T03:36:58Z", "author": {"login": "bsglz"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java", "diffHunk": "@@ -1908,9 +1907,9 @@ protected void queueAssign(final RegionStateNode regionNode) {\n   }\n \n   private void startAssignmentThread() {\n-    // Get Server Thread name. Sometimes the Server is mocked so may not implement HasThread.\n+    // Get Server Thread name. Sometimes the Server is mocked so may not implement Thread.\n     // For example, in tests.\n-    String name = master instanceof HasThread? ((HasThread)master).getName():\n+    String name = master instanceof Thread? ((Thread)master).getName():", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjA5NTQxOA=="}, "originalCommit": {"oid": "e31989c5a58ead98adf56907612b7095828cf096"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3074, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}