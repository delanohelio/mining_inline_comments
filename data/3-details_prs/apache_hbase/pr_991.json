{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5NDM1MDgx", "number": 991, "title": "HBASE-23651 Region balance throttling can be disabled", "bodyText": "", "createdAt": "2020-01-06T07:57:48Z", "url": "https://github.com/apache/hbase/pull/991", "merged": true, "mergeCommit": {"oid": "66d1258aa3a8c48a6001f5ec9d8eaeb64415873e"}, "closed": true, "closedAt": "2020-01-08T11:01:22Z", "author": {"login": "binlijin"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb3nYzOgH2gAyMzU5NDM1MDgxOjE5OGYwNmQyZTY5ZjFiMjhhNDI3NzVjYWUyZDI0NGYyMGMyYTZmYWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb4Ss1YgFqTMzOTc2ODgwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "198f06d2e69f1b28a42775cae2d244f20c2a6fac", "author": {"user": {"login": "binlijin", "name": null}}, "url": "https://github.com/apache/hbase/commit/198f06d2e69f1b28a42775cae2d244f20c2a6fac", "committedDate": "2020-01-06T07:54:09Z", "message": "HBASE-23651 Region balance throttling can be disabled"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4NTE3MDgw", "url": "https://github.com/apache/hbase/pull/991#pullrequestreview-338517080", "createdAt": "2020-01-06T08:29:32Z", "commit": {"oid": "198f06d2e69f1b28a42775cae2d244f20c2a6fac"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQwODoyOTozM1rOFaXy4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNlQwODoyOTozM1rOFaXy4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE5NzE1NA==", "bodyText": "ok so by disabling throttling what we mean is providing negative int value for hbase.balancer.max.balancing in master site config", "url": "https://github.com/apache/hbase/pull/991#discussion_r363197154", "createdAt": "2020-01-06T08:29:33Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -1860,11 +1856,14 @@ public boolean balance(boolean force) throws IOException {\n         //rpCount records balance plans processed, does not care if a plan succeeds\n         rpCount++;\n \n-        balanceThrottling(balanceStartTime + rpCount * balanceInterval, maxRegionsInTransition,\n+        if (this.maxBlancingTime > 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "198f06d2e69f1b28a42775cae2d244f20c2a6fac"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5MDE1Mjcx", "url": "https://github.com/apache/hbase/pull/991#pullrequestreview-339015271", "createdAt": "2020-01-07T03:31:31Z", "commit": {"oid": "198f06d2e69f1b28a42775cae2d244f20c2a6fac"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QwMzozMTozMVrOFavGXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wN1QwMzozNDoyN1rOFavIAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU3ODk3NQ==", "bodyText": "This change is wrong right?  We no longer check any configured value for HBASE_BALANCER_PERIOD.\nU wanted it like\nmaxBalancingTime = getConfiguration().getInt(HConstants.HBASE_BALANCER_MAX_BALANCING,  getConfiguration().getInt(HConstants.HBASE_BALANCER_PERIOD,\nHConstants.DEFAULT_HBASE_BALANCER_PERIOD);", "url": "https://github.com/apache/hbase/pull/991#discussion_r363578975", "createdAt": "2020-01-07T03:31:31Z", "author": {"login": "anoopsjohn"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -1688,12 +1688,8 @@ InetAddress getRemoteInetAddress(final int port,\n    * @return Maximum time we should run balancer for\n    */\n   private int getMaxBalancingTime() {\n-    int maxBalancingTime = getConfiguration().getInt(HConstants.HBASE_BALANCER_MAX_BALANCING, -1);\n-    if (maxBalancingTime == -1) {\n-      // if max balancing time isn't set, defaulting it to period time\n-      maxBalancingTime = getConfiguration().getInt(HConstants.HBASE_BALANCER_PERIOD,\n-        HConstants.DEFAULT_HBASE_BALANCER_PERIOD);\n-    }\n+    int maxBalancingTime = getConfiguration()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "198f06d2e69f1b28a42775cae2d244f20c2a6fac"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzU3OTM5Mg==", "bodyText": "So you will change this maxBlancingTime dynamically at HM config?\nIf permanently for the cluster the throttling needs disabled, hbase.master.balancer.maxRitPercent can be 100% right (which is the def value).  What am missing here? I did not read this part of code fully though", "url": "https://github.com/apache/hbase/pull/991#discussion_r363579392", "createdAt": "2020-01-07T03:34:27Z", "author": {"login": "anoopsjohn"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java", "diffHunk": "@@ -1860,11 +1856,14 @@ public boolean balance(boolean force) throws IOException {\n         //rpCount records balance plans processed, does not care if a plan succeeds\n         rpCount++;\n \n-        balanceThrottling(balanceStartTime + rpCount * balanceInterval, maxRegionsInTransition,\n+        if (this.maxBlancingTime > 0) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzE5NzE1NA=="}, "originalCommit": {"oid": "198f06d2e69f1b28a42775cae2d244f20c2a6fac"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4b5f71457dc9771acb17a8c8ad2aa68812bd7aca", "author": {"user": {"login": "binlijin", "name": null}}, "url": "https://github.com/apache/hbase/commit/4b5f71457dc9771acb17a8c8ad2aa68812bd7aca", "committedDate": "2020-01-07T06:10:33Z", "message": "fix comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37ef9c988605c43c85cb51fb58bea9886b538137", "author": {"user": {"login": "binlijin", "name": null}}, "url": "https://github.com/apache/hbase/commit/37ef9c988605c43c85cb51fb58bea9886b538137", "committedDate": "2020-01-07T06:13:01Z", "message": "fix comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM5NzY4ODA0", "url": "https://github.com/apache/hbase/pull/991#pullrequestreview-339768804", "createdAt": "2020-01-08T10:21:57Z", "commit": {"oid": "37ef9c988605c43c85cb51fb58bea9886b538137"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3118, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}