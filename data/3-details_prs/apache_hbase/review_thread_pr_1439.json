{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5NDc5ODY4", "number": 1439, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzowMDoxMlrODvOKAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODozMDoxMVrODvsEyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwODQxNjAwOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxNzowMDoxMlrOGBhRUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwOTo0NTo1OFrOGB7oZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI0Njg2Nw==", "bodyText": "Regarding thread-safety, do we need to synchronize on authManager while this happens? Otherwise authorize() requests and this init can race and can result in some weird authz results..", "url": "https://github.com/apache/hbase/pull/1439#discussion_r404246867", "createdAt": "2020-04-06T17:00:12Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -313,6 +314,7 @@ public void onConfigurationChange(Configuration newConf) {\n     if (scheduler instanceof ConfigurationObserver) {\n       ((ConfigurationObserver) scheduler).onConfigurationChange(newConf);\n     }\n+    HBasePolicyProvider.init(newConf, authManager);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efc2e027f21c95ac74f3f526b2d3580771d62510"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDY3ODc1OA==", "bodyText": "Fixed", "url": "https://github.com/apache/hbase/pull/1439#discussion_r404678758", "createdAt": "2020-04-07T09:45:58Z", "author": {"login": "Reidddddd"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -313,6 +314,7 @@ public void onConfigurationChange(Configuration newConf) {\n     if (scheduler instanceof ConfigurationObserver) {\n       ((ConfigurationObserver) scheduler).onConfigurationChange(newConf);\n     }\n+    HBasePolicyProvider.init(newConf, authManager);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDI0Njg2Nw=="}, "originalCommit": {"oid": "efc2e027f21c95ac74f3f526b2d3580771d62510"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxMzMxNzg2OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODozMDoxMVrOGCQukQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QxODozMDoxMVrOGCQukQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTAyNDQwMQ==", "bodyText": "nit: Add a quick log that we are re-setting the authManager state, probably helps with debugging races later if any..", "url": "https://github.com/apache/hbase/pull/1439#discussion_r405024401", "createdAt": "2020-04-07T18:30:11Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -313,6 +315,10 @@ public void onConfigurationChange(Configuration newConf) {\n     if (scheduler instanceof ConfigurationObserver) {\n       ((ConfigurationObserver) scheduler).onConfigurationChange(newConf);\n     }\n+    synchronized (authManager) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02daa1541707536f523ffab34670f8d97844ef64"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1869, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}