{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1NTYxNjMy", "number": 2126, "title": "HBASE-24759 Refuse to update configuration of default group", "bodyText": "", "createdAt": "2020-07-23T08:43:13Z", "url": "https://github.com/apache/hbase/pull/2126", "merged": true, "mergeCommit": {"oid": "c2721c823550ed2f1930a7fdd2334597bae6551f"}, "closed": true, "closedAt": "2020-09-04T00:19:39Z", "author": {"login": "ddupg"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdDQGT9gBqjM3MDI3Nzc2MzM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdEzmDHgBqjM3MTc2OTYzMjc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8363fade35dfcc289b9e4b4a0d223e1e503e7c33", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/8363fade35dfcc289b9e4b4a0d223e1e503e7c33", "committedDate": "2020-07-23T08:18:56Z", "message": "HBASE-24759 Persisting configuration of default rsgroup"}, "afterCommit": {"oid": "8638a6f18fda813c81ead1062a448006be3a5d8d", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/8638a6f18fda813c81ead1062a448006be3a5d8d", "committedDate": "2020-08-28T07:44:02Z", "message": "HBASE-24759 Persisting configuration of default rsgroup"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3NjkyNDk1", "url": "https://github.com/apache/hbase/pull/2126#pullrequestreview-477692495", "createdAt": "2020-08-28T12:38:27Z", "commit": {"oid": "8638a6f18fda813c81ead1062a448006be3a5d8d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMjozODoyN1rOHJCuKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMjozODoyN1rOHJCuKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTI0MzgxOA==", "bodyText": "Why change this? getDefaultServers not used any more?", "url": "https://github.com/apache/hbase/pull/2126#discussion_r479243818", "createdAt": "2020-08-28T12:38:27Z", "author": {"login": "infraio"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupInfoManagerImpl.java", "diffHunk": "@@ -592,7 +594,13 @@ private synchronized void refresh(boolean forceOnline) throws IOException {\n \n     // This is added to the last of the list so it overwrites the 'default' rsgroup loaded\n     // from region group table or zk\n-    groupList.add(new RSGroupInfo(RSGroupInfo.DEFAULT_GROUP, getDefaultServers(groupList)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8638a6f18fda813c81ead1062a448006be3a5d8d"}, "originalPosition": 24}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3NjkyOTU3", "url": "https://github.com/apache/hbase/pull/2126#pullrequestreview-477692957", "createdAt": "2020-08-28T12:39:07Z", "commit": {"oid": "8638a6f18fda813c81ead1062a448006be3a5d8d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMjozOTowN1rOHJCxPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yOFQxMjozOTowN1rOHJCxPw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTI0NDYwNw==", "bodyText": "I didn't follow this. DEFAULT_GROUP don't need this?", "url": "https://github.com/apache/hbase/pull/2126#discussion_r479244607", "createdAt": "2020-08-28T12:39:07Z", "author": {"login": "infraio"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupInfoManagerImpl.java", "diffHunk": "@@ -709,6 +713,22 @@ private void saveRSGroupMapToZK(Map<String, RSGroupInfo> newGroupMap) throws IOE\n     }\n   }\n \n+  /**\n+   * Convert to {@link RSGroupProtos.RSGroupInfo} to store in zk and hbase:rsgroup table.\n+   * Ignore group's tables and servers if group is the default\n+   * @param rsGroupInfo need to persist\n+   * @return converted proto\n+   */\n+  private RSGroupProtos.RSGroupInfo toProtoGroupInfoForPersisting(RSGroupInfo rsGroupInfo) {\n+    if (!rsGroupInfo.getName().equals(RSGroupInfo.DEFAULT_GROUP)) {\n+      return ProtobufUtil.toProtoGroupInfo(rsGroupInfo);\n+    } else {\n+      RSGroupInfo defaultGroupInfo = new RSGroupInfo(rsGroupInfo.getName());\n+      rsGroupInfo.getConfiguration().forEach(defaultGroupInfo::setConfiguration);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8638a6f18fda813c81ead1062a448006be3a5d8d"}, "originalPosition": 90}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8638a6f18fda813c81ead1062a448006be3a5d8d", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/8638a6f18fda813c81ead1062a448006be3a5d8d", "committedDate": "2020-08-28T07:44:02Z", "message": "HBASE-24759 Persisting configuration of default rsgroup"}, "afterCommit": {"oid": "295617e5cefc081a7dda28a33b1136375c3197a6", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/295617e5cefc081a7dda28a33b1136375c3197a6", "committedDate": "2020-08-29T08:35:11Z", "message": "HBASE-24759 Refuse to update configuration of default group"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MTc0NjI2", "url": "https://github.com/apache/hbase/pull/2126#pullrequestreview-478174626", "createdAt": "2020-08-30T06:11:14Z", "commit": {"oid": "295617e5cefc081a7dda28a33b1136375c3197a6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4MTc0Nzc0", "url": "https://github.com/apache/hbase/pull/2126#pullrequestreview-478174774", "createdAt": "2020-08-30T06:14:19Z", "commit": {"oid": "295617e5cefc081a7dda28a33b1136375c3197a6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwNjoxNDoxOVrOHJgPTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0zMFQwNjoxNDoxOVrOHJgPTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTcyNzQzOA==", "bodyText": "Please add more comment here.", "url": "https://github.com/apache/hbase/pull/2126#discussion_r479727438", "createdAt": "2020-08-30T06:14:19Z", "author": {"login": "infraio"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/rsgroup/RSGroupInfoManagerImpl.java", "diffHunk": "@@ -1270,6 +1270,9 @@ public synchronized void renameRSGroup(String oldName, String newName) throws IO\n   @Override\n   public synchronized void updateRSGroupConfig(String groupName, Map<String, String> configuration)\n       throws IOException {\n+    if (RSGroupInfo.DEFAULT_GROUP.equals(groupName)) {\n+      throw new ConstraintException(RSGroupInfo.DEFAULT_GROUP + \" can't be stored persistently\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "295617e5cefc081a7dda28a33b1136375c3197a6"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "295617e5cefc081a7dda28a33b1136375c3197a6", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/295617e5cefc081a7dda28a33b1136375c3197a6", "committedDate": "2020-08-29T08:35:11Z", "message": "HBASE-24759 Refuse to update configuration of default group"}, "afterCommit": {"oid": "51aba1dac4883c5fdbbf28c3d2e55386cdf88349", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/51aba1dac4883c5fdbbf28c3d2e55386cdf88349", "committedDate": "2020-09-01T09:55:38Z", "message": "HBASE-24759 Refuse to update configuration of default group"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9f5c0863358c39423c9319e1ab235242325123f", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/e9f5c0863358c39423c9319e1ab235242325123f", "committedDate": "2020-09-02T03:39:25Z", "message": "HBASE-24759 Refuse to update configuration of default group"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "51aba1dac4883c5fdbbf28c3d2e55386cdf88349", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/51aba1dac4883c5fdbbf28c3d2e55386cdf88349", "committedDate": "2020-09-01T09:55:38Z", "message": "HBASE-24759 Refuse to update configuration of default group"}, "afterCommit": {"oid": "e9f5c0863358c39423c9319e1ab235242325123f", "author": {"user": {"login": "ddupg", "name": "XinSun"}}, "url": "https://github.com/apache/hbase/commit/e9f5c0863358c39423c9319e1ab235242325123f", "committedDate": "2020-09-02T03:39:25Z", "message": "HBASE-24759 Refuse to update configuration of default group"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4051, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}