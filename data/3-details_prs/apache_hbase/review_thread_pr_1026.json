{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxOTA2Njk3", "number": 1026, "reviewThreads": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMjoxMjoyOVrODXtvbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxNjo1NDowMFrODYPj2Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2MTkzMjYwOnYy", "diffSide": "RIGHT", "path": "hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/ProcedureExecutor.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMjoxMjoyOVrOFdKZQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxMjowMzowNFrOFdVNsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyMzMzMQ==", "bodyText": "I think it is usually better to do nullable annotations with issues like this to make the contracts clear at the API level.  It also helps static code analyzers to catch issues like these.\nFor example you could do @nullable in this case..", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366123331", "createdAt": "2020-01-14T02:12:29Z", "author": {"login": "bharathv"}, "path": "hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/ProcedureExecutor.java", "diffHunk": "@@ -733,6 +733,9 @@ public long getKeepAliveTime(final TimeUnit timeUnit) {\n    * @param chore the chore to add\n    */\n   public void addChore(ProcedureInMemoryChore<TEnvironment> chore) {\n+    if (chore == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3cef49d9c4350c82ca054d89b84e8a1f708d7c6f"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjMwMDU5NQ==", "bodyText": "OK", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366300595", "createdAt": "2020-01-14T12:03:04Z", "author": {"login": "binlijin"}, "path": "hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/ProcedureExecutor.java", "diffHunk": "@@ -733,6 +733,9 @@ public long getKeepAliveTime(final TimeUnit timeUnit) {\n    * @param chore the chore to add\n    */\n   public void addChore(ProcedureInMemoryChore<TEnvironment> chore) {\n+    if (chore == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyMzMzMQ=="}, "originalCommit": {"oid": "3cef49d9c4350c82ca054d89b84e8a1f708d7c6f"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2MTkzNDEyOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQwMjoxMzowOVrOFdKaAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNVQyMzowNTowMFrOFmKQfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyMzUyMw==", "bodyText": "nit: Guess this is redundant if the method accepts null values.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366123523", "createdAt": "2020-01-14T02:13:09Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java", "diffHunk": "@@ -1378,7 +1378,9 @@ public void joinCluster() throws IOException {\n \n     // Start the chores\n     master.getMasterProcedureExecutor().addChore(this.ritChore);\n-    master.getMasterProcedureExecutor().addChore(this.deadMetricChore);\n+    if (this.deadMetricChore != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3cef49d9c4350c82ca054d89b84e8a1f708d7c6f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjMwMDU0NA==", "bodyText": "Yes.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366300544", "createdAt": "2020-01-14T12:02:56Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java", "diffHunk": "@@ -1378,7 +1378,9 @@ public void joinCluster() throws IOException {\n \n     // Start the chores\n     master.getMasterProcedureExecutor().addChore(this.ritChore);\n-    master.getMasterProcedureExecutor().addChore(this.deadMetricChore);\n+    if (this.deadMetricChore != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyMzUyMw=="}, "originalCommit": {"oid": "3cef49d9c4350c82ca054d89b84e8a1f708d7c6f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk4ODUwNA==", "bodyText": "I mean .. we can get rid of this if block? addChore has a similar check right?", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366988504", "createdAt": "2020-01-15T16:51:17Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java", "diffHunk": "@@ -1378,7 +1378,9 @@ public void joinCluster() throws IOException {\n \n     // Start the chores\n     master.getMasterProcedureExecutor().addChore(this.ritChore);\n-    master.getMasterProcedureExecutor().addChore(this.deadMetricChore);\n+    if (this.deadMetricChore != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyMzUyMw=="}, "originalCommit": {"oid": "3cef49d9c4350c82ca054d89b84e8a1f708d7c6f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzIwMzcyNQ==", "bodyText": "I know it can  be removed,  add it to show just where is wrong actually and cause the problem.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r367203725", "createdAt": "2020-01-16T02:27:20Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java", "diffHunk": "@@ -1378,7 +1378,9 @@ public void joinCluster() throws IOException {\n \n     // Start the chores\n     master.getMasterProcedureExecutor().addChore(this.ritChore);\n-    master.getMasterProcedureExecutor().addChore(this.deadMetricChore);\n+    if (this.deadMetricChore != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyMzUyMw=="}, "originalCommit": {"oid": "3cef49d9c4350c82ca054d89b84e8a1f708d7c6f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU1ODI3MQ==", "bodyText": "nit: Remove the if condition here, since the method's args are Nullable?", "url": "https://github.com/apache/hbase/pull/1026#discussion_r375558271", "createdAt": "2020-02-05T23:05:00Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/assignment/AssignmentManager.java", "diffHunk": "@@ -1378,7 +1378,9 @@ public void joinCluster() throws IOException {\n \n     // Start the chores\n     master.getMasterProcedureExecutor().addChore(this.ritChore);\n-    master.getMasterProcedureExecutor().addChore(this.deadMetricChore);\n+    if (this.deadMetricChore != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyMzUyMw=="}, "originalCommit": {"oid": "3cef49d9c4350c82ca054d89b84e8a1f708d7c6f"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2NDIyOTU1OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxNzo0NDoyMFrOFdgNHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQwMTo0NjoxMVrOFdrO6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MDY2OQ==", "bodyText": "Copy + paste leftovers?", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366480669", "createdAt": "2020-01-14T17:44:20Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjY2MTM1Mw==", "bodyText": "yes, fix it", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366661353", "createdAt": "2020-01-15T01:46:11Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MDY2OQ=="}, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2NDIzMDM0OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxNzo0NDozNlrOFdgNmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQwMTo0NTo1OFrOFdrOwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MDc5NA==", "bodyText": "This would be MediumTest, no?", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366480794", "createdAt": "2020-01-14T17:44:36Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Base class for AM test.\n+ */\n+@Category({ MasterTests.class, LargeTests.class })", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjY2MTMxNA==", "bodyText": "OK", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366661314", "createdAt": "2020-01-15T01:45:58Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Base class for AM test.\n+ */\n+@Category({ MasterTests.class, LargeTests.class })", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MDc5NA=="}, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2NDIzMjk4OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxNzo0NTozNlrOFdgPXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQwMTo0NjoyNVrOFdrPJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MTI0Nw==", "bodyText": "Again looks like a remnant of copy+paste from TestAssignment...", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366481247", "createdAt": "2020-01-14T17:45:36Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Base class for AM test.\n+ */\n+@Category({ MasterTests.class, LargeTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  protected void setupConfiguration(Configuration conf) throws Exception {\n+    FSUtils.setRootDir(conf, util.getDataTestDir());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjY2MTQxMw==", "bodyText": "fix it", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366661413", "createdAt": "2020-01-15T01:46:25Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Base class for AM test.\n+ */\n+@Category({ MasterTests.class, LargeTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  protected void setupConfiguration(Configuration conf) throws Exception {\n+    FSUtils.setRootDir(conf, util.getDataTestDir());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MTI0Nw=="}, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2NDIzNDAzOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNFQxNzo0NTo1OVrOFdgQHA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxMDoyMDo0OVrOFeUg_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MTQzNg==", "bodyText": "Move to tearDown()?", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366481436", "createdAt": "2020-01-14T17:45:59Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Base class for AM test.\n+ */\n+@Category({ MasterTests.class, LargeTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  protected void setupConfiguration(Configuration conf) throws Exception {\n+    FSUtils.setRootDir(conf, util.getDataTestDir());\n+    // Disable DeadServerMetricRegionChore\n+    conf.setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    setupConfiguration(util.getConfiguration());\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();\n+      // Master start up normal.\n+      final TableName tableName = TableName.valueOf(\"testDeadServerMetricRegionChore\");\n+      this.util.createTable(tableName, \"f\");\n+      this.util.waitTableAvailable(tableName);\n+    } finally {\n+      this.util.killMiniHBaseCluster();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjU3MzE4MQ==", "bodyText": "I think it's better to have a shutdown, instead of kill the cluster, in tearDown. Also seems that an assertion in this test is missing.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366573181", "createdAt": "2020-01-14T21:08:58Z", "author": {"login": "HorizonNet"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Base class for AM test.\n+ */\n+@Category({ MasterTests.class, LargeTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  protected void setupConfiguration(Configuration conf) throws Exception {\n+    FSUtils.setRootDir(conf, util.getDataTestDir());\n+    // Disable DeadServerMetricRegionChore\n+    conf.setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    setupConfiguration(util.getConfiguration());\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();\n+      // Master start up normal.\n+      final TableName tableName = TableName.valueOf(\"testDeadServerMetricRegionChore\");\n+      this.util.createTable(tableName, \"f\");\n+      this.util.waitTableAvailable(tableName);\n+    } finally {\n+      this.util.killMiniHBaseCluster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MTQzNg=="}, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjY2NzUzNw==", "bodyText": "The test is failed  when startMiniCluster without this patch.\n[INFO] Running org.apache.hadoop.hbase.master.assignment.TestDeadServerMetricRegionChore\n[ERROR] Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 210.246 s <<< FAILURE! - in org.apache.hadoop.hbase.master.assignment.TestDeadServerMetricRegionChore\n[ERROR] org.apache.hadoop.hbase.master.assignment.TestDeadServerMetricRegionChore.testDeadServerMetricRegionChore  Time elapsed: 210.054 s  <<< ERROR!\njava.io.IOException: Shutting down\nat org.apache.hadoop.hbase.master.assignment.TestDeadServerMetricRegionChore.testDeadServerMetricRegionChore(TestDeadServerMetricRegionChore.java:60)\nCaused by: java.lang.RuntimeException: Master not initialized after 200000ms\nat org.apache.hadoop.hbase.master.assignment.TestDeadServerMetricRegionChore.testDeadServerMetricRegionChore(TestDeadServerMetricRegionChore.java:60)", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366667537", "createdAt": "2020-01-15T02:16:43Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Base class for AM test.\n+ */\n+@Category({ MasterTests.class, LargeTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  protected void setupConfiguration(Configuration conf) throws Exception {\n+    FSUtils.setRootDir(conf, util.getDataTestDir());\n+    // Disable DeadServerMetricRegionChore\n+    conf.setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    setupConfiguration(util.getConfiguration());\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();\n+      // Master start up normal.\n+      final TableName tableName = TableName.valueOf(\"testDeadServerMetricRegionChore\");\n+      this.util.createTable(tableName, \"f\");\n+      this.util.waitTableAvailable(tableName);\n+    } finally {\n+      this.util.killMiniHBaseCluster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MTQzNg=="}, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzMyNzcwMg==", "bodyText": "Is the shutdown failing or because it is part of the tearDown?", "url": "https://github.com/apache/hbase/pull/1026#discussion_r367327702", "createdAt": "2020-01-16T10:00:23Z", "author": {"login": "HorizonNet"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Base class for AM test.\n+ */\n+@Category({ MasterTests.class, LargeTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  protected void setupConfiguration(Configuration conf) throws Exception {\n+    FSUtils.setRootDir(conf, util.getDataTestDir());\n+    // Disable DeadServerMetricRegionChore\n+    conf.setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    setupConfiguration(util.getConfiguration());\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();\n+      // Master start up normal.\n+      final TableName tableName = TableName.valueOf(\"testDeadServerMetricRegionChore\");\n+      this.util.createTable(tableName, \"f\");\n+      this.util.waitTableAvailable(tableName);\n+    } finally {\n+      this.util.killMiniHBaseCluster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MTQzNg=="}, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzMzNzcyNg==", "bodyText": "The shutdown has no problem, i already change killMiniHBaseCluster\nto shutdownMiniCluster.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r367337726", "createdAt": "2020-01-16T10:20:49Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,74 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.LargeTests;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.util.FSUtils;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Base class for AM test.\n+ */\n+@Category({ MasterTests.class, LargeTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  protected void setupConfiguration(Configuration conf) throws Exception {\n+    FSUtils.setRootDir(conf, util.getDataTestDir());\n+    // Disable DeadServerMetricRegionChore\n+    conf.setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    setupConfiguration(util.getConfiguration());\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();\n+      // Master start up normal.\n+      final TableName tableName = TableName.valueOf(\"testDeadServerMetricRegionChore\");\n+      this.util.createTable(tableName, \"f\");\n+      this.util.waitTableAvailable(tableName);\n+    } finally {\n+      this.util.killMiniHBaseCluster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4MTQzNg=="}, "originalCommit": {"oid": "8cebce3675a9cbd7c5e33511b6e302be232d2de7"}, "originalPosition": 70}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2NzQ3MjQwOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxNjo1Mzo0MlrOFd_SRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQwNzozMDoxMVrOFmRZLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk4OTg5Mw==", "bodyText": "Still don't understand why we cant move startMiniCluster() to setUp() and shutDownMiniCLuster() to tearDown().\nI get the point that without the patch, startMiniCluster() throws, but with the patch, it shouldn't, right? Did I miss something.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366989893", "createdAt": "2020-01-15T16:53:42Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.testclassification.MediumTests;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Testcase for HBASE-23682.\n+ */\n+@Category({ MasterTests.class, MediumTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    // Disable DeadServerMetricRegionChore\n+    util.getConfiguration()\n+      .setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzIwNDQzNg==", "bodyText": "Yes, without the patch HMaster will abort when startup so startMiniCluster throws exception, with the patch it will not.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r367204436", "createdAt": "2020-01-16T02:31:09Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.testclassification.MediumTests;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Testcase for HBASE-23682.\n+ */\n+@Category({ MasterTests.class, MediumTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    // Disable DeadServerMetricRegionChore\n+    util.getConfiguration()\n+      .setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk4OTg5Mw=="}, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzU2NzY2Mg==", "bodyText": "So, I think the only pending question is ...why not move shutdownMiniCluster() to tearDown()? I think @HorizonNet is also asking the same thing.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r367567662", "createdAt": "2020-01-16T18:01:48Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.testclassification.MediumTests;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Testcase for HBASE-23682.\n+ */\n+@Category({ MasterTests.class, MediumTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    // Disable DeadServerMetricRegionChore\n+    util.getConfiguration()\n+      .setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk4OTg5Mw=="}, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzczNjE5OQ==", "bodyText": "Ok, fix it.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r367736199", "createdAt": "2020-01-17T01:51:11Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.testclassification.MediumTests;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Testcase for HBASE-23682.\n+ */\n+@Category({ MasterTests.class, MediumTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    // Disable DeadServerMetricRegionChore\n+    util.getConfiguration()\n+      .setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk4OTg5Mw=="}, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU1ODQwMg==", "bodyText": "Didn't address this yet?", "url": "https://github.com/apache/hbase/pull/1026#discussion_r375558402", "createdAt": "2020-02-05T23:05:29Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.testclassification.MediumTests;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Testcase for HBASE-23682.\n+ */\n+@Category({ MasterTests.class, MediumTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    // Disable DeadServerMetricRegionChore\n+    util.getConfiguration()\n+      .setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk4OTg5Mw=="}, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTY3NTE4MA==", "bodyText": "shutdownMiniCluster() already move to tearDown(), shoud have addressed it.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r375675180", "createdAt": "2020-02-06T07:30:11Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.master.assignment;\n+\n+import org.apache.hadoop.hbase.HBaseClassTestRule;\n+import org.apache.hadoop.hbase.HBaseTestingUtility;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.testclassification.MasterTests;\n+import org.apache.hadoop.hbase.testclassification.MediumTests;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.ClassRule;\n+import org.junit.Test;\n+import org.junit.experimental.categories.Category;\n+\n+/**\n+ * Testcase for HBASE-23682.\n+ */\n+@Category({ MasterTests.class, MediumTests.class })\n+public class TestDeadServerMetricRegionChore {\n+\n+  @ClassRule\n+  public static final HBaseClassTestRule CLASS_RULE =\n+    HBaseClassTestRule.forClass(TestDeadServerMetricRegionChore.class);\n+\n+  protected HBaseTestingUtility util;\n+\n+  @Before\n+  public void setUp() throws Exception {\n+    util = new HBaseTestingUtility();\n+    // Disable DeadServerMetricRegionChore\n+    util.getConfiguration()\n+      .setInt(AssignmentManager.DEAD_REGION_METRIC_CHORE_INTERVAL_MSEC_CONF_KEY, -1);\n+  }\n+\n+  @After\n+  public void tearDown() throws Exception {\n+  }\n+\n+  @Test\n+  public void testDeadServerMetricRegionChore() throws Exception {\n+    try {\n+      this.util.startMiniCluster();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk4OTg5Mw=="}, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2NzQ3MzUzOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxNjo1NDowMFrOFd_S8g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQwODoyMToxOVrOFeRKZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk5MDA2Ng==", "bodyText": "nit: /*", "url": "https://github.com/apache/hbase/pull/1026#discussion_r366990066", "createdAt": "2020-01-15T16:54:00Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzIwNTEyNg==", "bodyText": "You mean change \"/**\" to \"/*\" ?    I see other tests all use \"/**\" no one use \"/*\"", "url": "https://github.com/apache/hbase/pull/1026#discussion_r367205126", "createdAt": "2020-01-16T02:34:32Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk5MDA2Ng=="}, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzI2Mjk3Ng==", "bodyText": "/** is interpreted as a javadoc in IDEs. If you notice others' changes, people are switching to /* incrementally in their patches (files they are touching). Now that you are adding a new class, it is better to start with /*.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r367262976", "createdAt": "2020-01-16T07:18:52Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk5MDA2Ng=="}, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzI4Mjc5MQ==", "bodyText": "OK, thanks for you explanation.", "url": "https://github.com/apache/hbase/pull/1026#discussion_r367282791", "createdAt": "2020-01-16T08:21:19Z", "author": {"login": "binlijin"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestDeadServerMetricRegionChore.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/**", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njk5MDA2Ng=="}, "originalCommit": {"oid": "0419b2aea6a5acab96cd739957297069154ab10f"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2121, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}