{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1NzM4ODYx", "number": 1173, "title": "HBASE-23851 Log networks and bind addresses when multicast publisher/\u2026", "bodyText": "\u2026listener enabled", "createdAt": "2020-02-15T17:25:38Z", "url": "https://github.com/apache/hbase/pull/1173", "merged": true, "mergeCommit": {"oid": "a6700bc6b56cb921051466557c9e2d0679adffde"}, "closed": true, "closedAt": "2020-03-10T17:55:45Z", "author": {"login": "saintstack"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcEneXvgH2gAyMzc1NzM4ODYxOmNmNjNmNGQzMjEzZmUyOGNmMWI4ZTZlMGE0YmZhYTVkOWU5NDI2ZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcHiTauAFqTM2MzYyMDAyMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7", "author": {"user": {"login": "saintstack", "name": "Michael Stack"}}, "url": "https://github.com/apache/hbase/commit/cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7", "committedDate": "2020-02-15T17:21:15Z", "message": "HBASE-23851 Log networks and bind addresses when multicast publisher/listener enabled"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MzU5MjQy", "url": "https://github.com/apache/hbase/pull/1173#pullrequestreview-359359242", "createdAt": "2020-02-15T18:25:50Z", "commit": {"oid": "cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MzYxNDQ3", "url": "https://github.com/apache/hbase/pull/1173#pullrequestreview-359361447", "createdAt": "2020-02-15T19:14:29Z", "commit": {"oid": "cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYzNjIwMDIz", "url": "https://github.com/apache/hbase/pull/1173#pullrequestreview-363620023", "createdAt": "2020-02-24T18:53:15Z", "commit": {"oid": "cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxODo1MzoxNVrOFtr4vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNFQxOTowMDoxOVrOFtsHXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ0OTI3OA==", "bodyText": "Why WARN and not DEBUG?", "url": "https://github.com/apache/hbase/pull/1173#discussion_r383449278", "createdAt": "2020-02-24T18:53:15Z", "author": {"login": "ndimiduk"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/AsyncConnectionImpl.java", "diffHunk": "@@ -165,8 +165,7 @@ public void newDead(ServerName sn) {\n               }\n             }, conf, listenerClass);\n         } catch (IOException e) {\n-          LOG.warn(\"Failed to create ClusterStatusListener, not a critical problem, ignoring...\",\n-            e);\n+          LOG.warn(\"Failed create of ClusterStatusListener, not a critical, ignoring...\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ0OTU1Mw==", "bodyText": "nit s/not a critical,/not critical,/", "url": "https://github.com/apache/hbase/pull/1173#discussion_r383449553", "createdAt": "2020-02-24T18:53:46Z", "author": {"login": "ndimiduk"}, "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/AsyncConnectionImpl.java", "diffHunk": "@@ -165,8 +165,7 @@ public void newDead(ServerName sn) {\n               }\n             }, conf, listenerClass);\n         } catch (IOException e) {\n-          LOG.warn(\"Failed to create ClusterStatusListener, not a critical problem, ignoring...\",\n-            e);\n+          LOG.warn(\"Failed create of ClusterStatusListener, not a critical, ignoring...\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ1MDg1NQ==", "bodyText": "If you're going to tweak toString() methods, you mind converting over use Commons's ToStringBuilder with the ShortPrefixToStringStyle ?", "url": "https://github.com/apache/hbase/pull/1173#discussion_r383450855", "createdAt": "2020-02-24T18:56:19Z", "author": {"login": "ndimiduk"}, "path": "hbase-common/src/main/java/org/apache/hadoop/hbase/ScheduledChore.java", "diffHunk": "@@ -373,7 +373,7 @@ protected synchronized void cleanup() {\n   @InterfaceAudience.Private\n   @Override\n   public String toString() {\n-    return \"[ScheduledChore: Name: \" + getName() + \" Period: \" + getPeriod() + \" Unit: \"\n-        + getTimeUnit() + \"]\";\n+    return \"ScheduledChore name=\" + getName() + \", period=\" + getPeriod() +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ1MTQyNg==", "bodyText": "Likewise with the ToStringBuilder.", "url": "https://github.com/apache/hbase/pull/1173#discussion_r383451426", "createdAt": "2020-02-24T18:57:26Z", "author": {"login": "ndimiduk"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/ClusterStatusPublisher.java", "diffHunk": "@@ -126,6 +127,11 @@ public ClusterStatusPublisher(HMaster master, Configuration conf,\n     connected = true;\n   }\n \n+  @Override\n+  public String toString() {\n+    return super.toString() + \", publisher=\" + this.publisher + \", connected=\" + this.connected;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ1MzAyMg==", "bodyText": "What is the expected class/thread that needs this configuration change downstream from here? This seems like it introduces a timing race between this chore thread and the presumed viewer, which may or may not start after this code is hit.\nIs there a better approach to take? This strikes me as fishing for side-effects with global mutable state.", "url": "https://github.com/apache/hbase/pull/1173#discussion_r383453022", "createdAt": "2020-02-24T19:00:19Z", "author": {"login": "ndimiduk"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/ClusterStatusPublisher.java", "diffHunk": "@@ -285,27 +295,33 @@ public void connect(Configuration conf) throws IOException {\n         }\n         ni = NetworkInterface.getByInetAddress(localAddress);\n       }\n-\n       Bootstrap b = new Bootstrap();\n       b.group(group)\n         .channelFactory(new HBaseDatagramChannelFactory<Channel>(NioDatagramChannel.class, family))\n         .option(ChannelOption.SO_REUSEADDR, true)\n         .handler(new ClusterMetricsEncoder(isa));\n-\n       try {\n+        LOG.debug(\"Channel bindAddress={}, networkInterface={}, INA={}\", bindAddress, ni, ina);\n         channel = (DatagramChannel) b.bind(bindAddress, 0).sync().channel();\n         channel.joinGroup(ina, ni, null, channel.newPromise()).sync();\n         channel.connect(isa).sync();\n+        // Set into configuration in case many networks available. Do this for tests so that\n+        // server and client use same Interface (presuming share same Configuration).\n+        // TestAsyncTableRSCrashPublish was failing when connected to VPN because extra networks\n+        // available with Master binding on one Interface and client on another so test failed.\n+        if (ni != null) {\n+          conf.set(HConstants.STATUS_MULTICAST_NI_NAME, ni.getName());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cf63f4d3213fe28cf1b8e6e0a4bfaa5d9e9426d7"}, "originalPosition": 100}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2788, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}