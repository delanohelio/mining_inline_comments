{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxODUzNzUy", "number": 1138, "title": "HBASE-22827 Expose multi-region merge in shell and Admin API", "bodyText": "mergeRegionsAsync with two regions as parameters, to be deprecated since 2.3.0 and removed from 4.0\nmerge_region shell command syntax changed (as it goes into minor release & major release i.e. 2.3.0, 3.0.0). It now supports multiple region merge.", "createdAt": "2020-02-06T11:41:06Z", "url": "https://github.com/apache/hbase/pull/1138", "merged": true, "mergeCommit": {"oid": "5f61df479260598ea8f7856b4abc2541c27ed5db"}, "closed": true, "closedAt": "2020-02-13T22:40:47Z", "author": {"login": "jatsakthi"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBpKIlgH2gAyMzcxODUzNzUyOjI0YWE4NDA4NjYxODEyNmRhNjg4MGNhZGY4MWIyNTUwNTNiNGVjMjk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcECKQ4AH2gAyMzcxODUzNzUyOjQzZGUzMzk0NWEwNjQ1MjMyZGNlYzMwYTc0M2JmMjJhZmIzNGNjY2Q=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "24aa84086618126da6880cadf81b255053b4ec29", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/24aa84086618126da6880cadf81b255053b4ec29", "committedDate": "2020-02-06T11:37:11Z", "message": "HBASE-22827 Expose multi-region merge in shell and Admin API"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NDc1OTAy", "url": "https://github.com/apache/hbase/pull/1138#pullrequestreview-355475902", "createdAt": "2020-02-07T22:31:09Z", "commit": {"oid": "24aa84086618126da6880cadf81b255053b4ec29"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMjozMTowOVrOFnMLhg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMjozMTowOVrOFnMLhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYzODM0Mg==", "bodyText": "Can we add support for the previous syntax? and not just when an array is used?", "url": "https://github.com/apache/hbase/pull/1138#discussion_r376638342", "createdAt": "2020-02-07T22:31:09Z", "author": {"login": "esteban"}, "path": "hbase-shell/src/main/ruby/hbase/admin.rb", "diffHunk": "@@ -535,14 +535,20 @@ def move(encoded_region_name, server = nil)\n     end\n \n     #----------------------------------------------------------------------------------------------\n-    # Merge two regions\n-    def merge_region(region_a_name, region_b_name, force)\n-      @admin.mergeRegionsAsync(\n-        region_a_name.to_java_bytes,\n-        region_b_name.to_java_bytes,\n-        java.lang.Boolean.valueOf(force)\n+    # Merge multiple regions\n+    def merge_region(regions = [], force)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24aa84086618126da6880cadf81b255053b4ec29"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NDc2MjUw", "url": "https://github.com/apache/hbase/pull/1138#pullrequestreview-355476250", "createdAt": "2020-02-07T22:32:01Z", "commit": {"oid": "24aa84086618126da6880cadf81b255053b4ec29"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMjozMjowMVrOFnMMpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wN1QyMjozMjowMVrOFnMMpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjYzODYzMA==", "bodyText": "As my previous comment, if we keep support of the syntax for adding only two regions and multiple regions we should keep both examples.", "url": "https://github.com/apache/hbase/pull/1138#discussion_r376638630", "createdAt": "2020-02-07T22:32:01Z", "author": {"login": "esteban"}, "path": "hbase-shell/src/main/ruby/shell/commands/merge_region.rb", "diffHunk": "@@ -33,16 +33,18 @@ def help\n \n Examples:\n \n-  hbase> merge_region 'FULL_REGIONNAME', 'FULL_REGIONNAME'\n-  hbase> merge_region 'FULL_REGIONNAME', 'FULL_REGIONNAME', true\n+  hbase> merge_region ['FULL_REGIONNAME', 'FULL_REGIONNAME']\n+  hbase> merge_region ['FULL_REGIONNAME', 'FULL_REGIONNAME', 'FULL_REGIONNAME', ...]\n+  hbase> merge_region ['FULL_REGIONNAME', 'FULL_REGIONNAME', 'FULL_REGIONNAME', ...], true\n \n-  hbase> merge_region 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME'\n-  hbase> merge_region 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', true\n+  hbase> merge_region ['ENCODED_REGIONNAME', 'ENCODED_REGIONNAME']\n+  hbase> merge_region ['ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', ...]\n+  hbase> merge_region ['ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', ...], true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24aa84086618126da6880cadf81b255053b4ec29"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NDc2ODgw", "url": "https://github.com/apache/hbase/pull/1138#pullrequestreview-355476880", "createdAt": "2020-02-07T22:33:37Z", "commit": {"oid": "24aa84086618126da6880cadf81b255053b4ec29"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ae7711ce022baeae04809f9bc418466196e8671", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/7ae7711ce022baeae04809f9bc418466196e8671", "committedDate": "2020-02-08T02:06:38Z", "message": "Review Comments 1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU1NTMzODA1", "url": "https://github.com/apache/hbase/pull/1138#pullrequestreview-355533805", "createdAt": "2020-02-08T06:40:47Z", "commit": {"oid": "7ae7711ce022baeae04809f9bc418466196e8671"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ae0d68a3757890e8f98c46f299aa446d99b06a97", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/ae0d68a3757890e8f98c46f299aa446d99b06a97", "committedDate": "2020-02-11T02:43:30Z", "message": "Review Comments 2 : Modify examples to show array of regions is accepted"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4c921a2015a41fc89ac14a37c85c53d5be6113d", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/d4c921a2015a41fc89ac14a37c85c53d5be6113d", "committedDate": "2020-02-11T03:10:31Z", "message": "Add test case to test acceptance of array of regions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NDM5MjQ2", "url": "https://github.com/apache/hbase/pull/1138#pullrequestreview-358439246", "createdAt": "2020-02-13T18:10:29Z", "commit": {"oid": "d4c921a2015a41fc89ac14a37c85c53d5be6113d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NDM5NDM5", "url": "https://github.com/apache/hbase/pull/1138#pullrequestreview-358439439", "createdAt": "2020-02-13T18:10:46Z", "commit": {"oid": "d4c921a2015a41fc89ac14a37c85c53d5be6113d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU4NDQzMDEw", "url": "https://github.com/apache/hbase/pull/1138#pullrequestreview-358443010", "createdAt": "2020-02-13T18:16:07Z", "commit": {"oid": "d4c921a2015a41fc89ac14a37c85c53d5be6113d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxODoxODowNVrOFpedDg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xM1QxODoxODowNVrOFpedDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTAzNDg5NA==", "bodyText": "nit: \"at least\"", "url": "https://github.com/apache/hbase/pull/1138#discussion_r379034894", "createdAt": "2020-02-13T18:18:05Z", "author": {"login": "joshelser"}, "path": "hbase-shell/src/main/ruby/shell/commands/merge_region.rb", "diffHunk": "@@ -31,18 +31,42 @@ def help\n TestTable,0094429456,1289497600452.527db22f95c8a9e0116f0cc13c680396. then\n the encoded region name portion is 527db22f95c8a9e0116f0cc13c680396\n \n+You can either pass the list of regions as comma separated values or as an\n+array of regions as shown:\n+\n Examples:\n \n   hbase> merge_region 'FULL_REGIONNAME', 'FULL_REGIONNAME'\n-  hbase> merge_region 'FULL_REGIONNAME', 'FULL_REGIONNAME', true\n+  hbase> merge_region 'FULL_REGIONNAME', 'FULL_REGIONNAME', 'FULL_REGIONNAME', ...\n+  hbase> merge_region 'FULL_REGIONNAME', 'FULL_REGIONNAME', 'FULL_REGIONNAME', ..., true\n+\n+  hbase> merge_region ['FULL_REGIONNAME', 'FULL_REGIONNAME']\n+  hbase> merge_region ['FULL_REGIONNAME', 'FULL_REGIONNAME', 'FULL_REGIONNAME', ...]\n+  hbase> merge_region ['FULL_REGIONNAME', 'FULL_REGIONNAME', 'FULL_REGIONNAME', ..., true]\n \n   hbase> merge_region 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME'\n-  hbase> merge_region 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', true\n+  hbase> merge_region 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', ...\n+  hbase> merge_region 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', ..., true\n+\n+  hbase> merge_region ['ENCODED_REGIONNAME', 'ENCODED_REGIONNAME']\n+  hbase> merge_region ['ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', ...]\n+  hbase> merge_region ['ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', 'ENCODED_REGIONNAME', ..., true]\n EOF\n       end\n \n-      def command(region_a_name, region_b_name, force = 'false')\n-        admin.merge_region(region_a_name, region_b_name, force)\n+      def command(*args)\n+        args = args.flatten.compact\n+        args_len = args.length\n+        raise(ArgumentError, 'Must pass atleast 2 regions to merge') unless args_len > 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4c921a2015a41fc89ac14a37c85c53d5be6113d"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86ce51cb6712b53898f739caec922e66719dbb8b", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/86ce51cb6712b53898f739caec922e66719dbb8b", "committedDate": "2020-02-13T21:48:01Z", "message": "Review comments 3: fix spelling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43de33945a0645232dcec30a743bf22afb34cccd", "author": {"user": {"login": "jatsakthi", "name": "Sakthi"}}, "url": "https://github.com/apache/hbase/commit/43de33945a0645232dcec30a743bf22afb34cccd", "committedDate": "2020-02-13T21:52:48Z", "message": "Fix the array example"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2750, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}