{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3ODIwNTY4", "number": 1852, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNToxMzo1OVrOECm8qQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNToxMzo1OVrOECm8qQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMTcwNzI5OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterRpcServices.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNToxMzo1OVrOGfK24w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNToxMzo1OVrOGfK24w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTMzNjkzMQ==", "bodyText": "Agreed. If we have how to resolve a full region name from only the encoded name. The motivation to allow only region encoded name is because that's what's easily available for operators, and normally reported on hbck/hbck2.", "url": "https://github.com/apache/hbase/pull/1852#discussion_r435336931", "createdAt": "2020-06-04T15:13:59Z", "author": {"login": "wchevreuil"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterRpcServices.java", "diffHunk": "@@ -2500,31 +2502,39 @@ public GetTableStateResponse setTableStateInMeta(RpcController controller,\n    * @return previous states of the regions\n    */\n   @Override\n-  public GetRegionStateInMetaResponse setRegionStateInMeta(RpcController controller,\n+  public SetRegionStateInMetaResponse setRegionStateInMeta(RpcController controller,\n     SetRegionStateInMetaRequest request) throws ServiceException {\n-    final GetRegionStateInMetaResponse.Builder builder = GetRegionStateInMetaResponse.newBuilder();\n-    for(ClusterStatusProtos.RegionState s : request.getStatesList()) {\n-      try {\n-        RegionInfo info = this.master.getAssignmentManager().\n-          loadRegionFromMeta(s.getRegionInfo().getRegionEncodedName());\n+    SetRegionStateInMetaResponse.Builder builder = SetRegionStateInMetaResponse.newBuilder();\n+    try {\n+      for (RegionSpecifierAndState s : request.getStatesList()) {\n+        RegionSpecifier spec = s.getRegionSpecifier();\n+        String encodedName;\n+        if (spec.getType() == RegionSpecifierType.ENCODED_REGION_NAME) {\n+          encodedName = spec.getValue().toStringUtf8();\n+        } else {\n+          // TODO: actually, a full region name can save a lot on meta scan, improve later.\n+          encodedName = RegionInfo.encodeRegionName(spec.getValue().toByteArray());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6b6f67bcd68729eb27c6ca93c707826eeeb66a5f"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2938, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}