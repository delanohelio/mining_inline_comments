{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3MTcxNDg1", "number": 2400, "title": "HBASE-24877 addendum: additional checks to avoid one extra possible race control in the initialize loop", "bodyText": "", "createdAt": "2020-09-15T09:40:55Z", "url": "https://github.com/apache/hbase/pull/2400", "merged": true, "mergeCommit": {"oid": "9fc29c4cbf6671589f34b15e4ab41970bd4f3b45"}, "closed": true, "closedAt": "2020-09-29T09:00:58Z", "author": {"login": "wchevreuil"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdJEhNjgH2gAyNDg3MTcxNDg1OmE4ODZmNjc2MjAzZmUyYzZjMmUxZmU0NWEwYzY1ZTdlM2ZiNTRmNmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZmAQigFqTUyNDUxMDkwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a886f676203fe2c6c2e1fe45a0c65e7e3fb54f6b", "author": {"user": {"login": "wchevreuil", "name": "Wellington Ramos Chevreuil"}}, "url": "https://github.com/apache/hbase/commit/a886f676203fe2c6c2e1fe45a0c65e7e3fb54f6b", "committedDate": "2020-09-15T09:38:27Z", "message": "HBASE-24877 addendum: additional checks to avoid one extra possible race control in the initialize loop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cc94a30b9f3c401da19cfa50a6afa1863753db9e", "author": {"user": {"login": "wchevreuil", "name": "Wellington Ramos Chevreuil"}}, "url": "https://github.com/apache/hbase/commit/cc94a30b9f3c401da19cfa50a6afa1863753db9e", "committedDate": "2020-09-16T11:05:09Z", "message": "Addressing Duo's comment on the related branch-2 PR"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkzMDYyMjMx", "url": "https://github.com/apache/hbase/pull/2400#pullrequestreview-493062231", "createdAt": "2020-09-22T00:16:58Z", "commit": {"oid": "cc94a30b9f3c401da19cfa50a6afa1863753db9e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72144ad276dc6c5c7541187ab719f4e850f58560", "author": {"user": {"login": "wchevreuil", "name": "Wellington Ramos Chevreuil"}}, "url": "https://github.com/apache/hbase/commit/72144ad276dc6c5c7541187ab719f4e850f58560", "committedDate": "2020-09-23T16:36:57Z", "message": "Merge branch 'master' into HBASE-24877-addendum"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0ODYxNjkw", "url": "https://github.com/apache/hbase/pull/2400#pullrequestreview-494861690", "createdAt": "2020-09-23T16:54:53Z", "commit": {"oid": "72144ad276dc6c5c7541187ab719f4e850f58560"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNjo1NDo1NFrOHW30mg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QxNjo1NDo1NFrOHW30mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzc0NTMwNg==", "bodyText": "nit: indentation", "url": "https://github.com/apache/hbase/pull/2400#discussion_r493745306", "createdAt": "2020-09-23T16:54:54Z", "author": {"login": "joshelser"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java", "diffHunk": "@@ -618,28 +622,34 @@ private void initialize() {\n \n   @Override\n   public void startup() {\n-    if (this.sourceRunning) {\n-      return;\n-    }\n+    // mark we are running now\n     this.sourceRunning = true;\n-    //Flag that signalizes uncaught error happening while starting up the source\n-    // and a retry should be attempted\n-    MutableBoolean retryStartup = new MutableBoolean(true);\n-    do {\n-      if(retryStartup.booleanValue()) {\n-        retryStartup.setValue(false);\n-        startupOngoing.set(true);\n-        // mark we are running now\n-        initThread = new Thread(this::initialize);\n-        Threads.setDaemonThreadRunning(initThread,\n-          Thread.currentThread().getName() + \".replicationSource,\" + this.queueId,\n-          (t,e) -> {\n+    startupOngoing.set(true);\n+    initThread = new Thread(this::initialize);\n+      Threads.setDaemonThreadRunning(initThread,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "72144ad276dc6c5c7541187ab719f4e850f58560"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0ODY0Njk3", "url": "https://github.com/apache/hbase/pull/2400#pullrequestreview-494864697", "createdAt": "2020-09-23T16:58:31Z", "commit": {"oid": "72144ad276dc6c5c7541187ab719f4e850f58560"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "980152c5df3acc5dbbb003194155a841ff2c1125", "author": {"user": {"login": "wchevreuil", "name": "Wellington Ramos Chevreuil"}}, "url": "https://github.com/apache/hbase/commit/980152c5df3acc5dbbb003194155a841ff2c1125", "committedDate": "2020-09-24T09:41:11Z", "message": "addressing lates checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5b01752dbf5e19082a355080afbe5adaf47b26a3", "author": {"user": {"login": "wchevreuil", "name": "Wellington Ramos Chevreuil"}}, "url": "https://github.com/apache/hbase/commit/5b01752dbf5e19082a355080afbe5adaf47b26a3", "committedDate": "2020-09-28T10:33:48Z", "message": "More checkstyles"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NTEwOTA0", "url": "https://github.com/apache/hbase/pull/2400#pullrequestreview-524510904", "createdAt": "2020-11-05T17:42:00Z", "commit": {"oid": "cc94a30b9f3c401da19cfa50a6afa1863753db9e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNzo0MjowMVrOHuOz1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxNzo0MjowMVrOHuOz1g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODIzOTE5MA==", "bodyText": "Bumping into this during rebase of HBASE-18070 branch. If count is not used, just remove it from this class?", "url": "https://github.com/apache/hbase/pull/2400#discussion_r518239190", "createdAt": "2020-11-05T17:42:01Z", "author": {"login": "huaxiangsun"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/replication/regionserver/TestReplicationSource.java", "diffHunk": "@@ -416,6 +416,17 @@ public synchronized UUID getPeerUUID() {\n \n   }\n \n+  public static class FaultyReplicationEndpoint extends DoNothingReplicationEndpoint {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc94a30b9f3c401da19cfa50a6afa1863753db9e"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4814, "cost": 1, "resetAt": "2021-10-28T16:48:13Z"}}}