{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwNDA1Mjk2", "number": 1450, "title": "HBASE-24126 Up the container nproc uplimit from 10000 to 12500", "bodyText": "", "createdAt": "2020-04-07T17:31:35Z", "url": "https://github.com/apache/hbase/pull/1450", "merged": true, "mergeCommit": {"oid": "14342b6527a3855fd544b6028c0d7539e8e74305"}, "closed": true, "closedAt": "2020-04-10T22:57:48Z", "author": {"login": "saintstack"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVeTYmgFqTM4OTYwOTk5Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVwnyyAFqTM5MDM5ODIwOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NjA5OTk2", "url": "https://github.com/apache/hbase/pull/1450#pullrequestreview-389609996", "createdAt": "2020-04-08T02:16:49Z", "commit": {"oid": "da2beb832d5981a50f96f708341c1ace1ddf7b6f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMTE0OTA2", "url": "https://github.com/apache/hbase/pull/1450#pullrequestreview-390114906", "createdAt": "2020-04-08T16:01:30Z", "commit": {"oid": "da2beb832d5981a50f96f708341c1ace1ddf7b6f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjowMTozMFrOGC2Fwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjowMTozMFrOGC2Fwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTYzNjU0Ng==", "bodyText": "I don't think this should be here. we want this proc limit change all the time, not just when the hadoopcheck test is enabled.", "url": "https://github.com/apache/hbase/pull/1450#discussion_r405636546", "createdAt": "2020-04-08T16:01:30Z", "author": {"login": "busbey"}, "path": "dev-support/hbase-personality.sh", "diffHunk": "@@ -513,6 +516,7 @@ function hadoopcheck_parse_args\n ## @stability    evolving\n function hadoopcheck_docker_support\n {\n+  DOCKER_EXTRAARGS=(\"${DOCKER_EXTRAARGS[@]}\" \"--ulimit\" \"nproc=12500\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "da2beb832d5981a50f96f708341c1ace1ddf7b6f"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "baf2d8929e6c56deff5ee300631a9f432bd784b2", "author": {"user": {"login": "saintstack", "name": "Michael Stack"}}, "url": "https://github.com/apache/hbase/commit/baf2d8929e6c56deff5ee300631a9f432bd784b2", "committedDate": "2020-04-08T21:30:13Z", "message": "HBASE-24126 Up the container nproc uplimit from 10000 to 12500"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "da2beb832d5981a50f96f708341c1ace1ddf7b6f", "author": {"user": {"login": "saintstack", "name": "Michael Stack"}}, "url": "https://github.com/apache/hbase/commit/da2beb832d5981a50f96f708341c1ace1ddf7b6f", "committedDate": "2020-04-07T17:26:11Z", "message": "HBASE-24126 Up the container nproc uplimit from 10000 to 12500"}, "afterCommit": {"oid": "baf2d8929e6c56deff5ee300631a9f432bd784b2", "author": {"user": {"login": "saintstack", "name": "Michael Stack"}}, "url": "https://github.com/apache/hbase/commit/baf2d8929e6c56deff5ee300631a9f432bd784b2", "committedDate": "2020-04-08T21:30:13Z", "message": "HBASE-24126 Up the container nproc uplimit from 10000 to 12500"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMzk4MjA5", "url": "https://github.com/apache/hbase/pull/1450#pullrequestreview-390398209", "createdAt": "2020-04-08T23:29:03Z", "commit": {"oid": "baf2d8929e6c56deff5ee300631a9f432bd784b2"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQyMzoyOTowM1rOGDEeGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQyMzozNzoxNVrOGDEn9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg3MjE1Mw==", "bodyText": "Yikes. This is just hiding over here in the corner. TODO: update flaky reporting to use yetus to run builds.", "url": "https://github.com/apache/hbase/pull/1450#discussion_r405872153", "createdAt": "2020-04-08T23:29:03Z", "author": {"login": "ndimiduk"}, "path": "dev-support/flaky-tests/flaky-reporting.Jenkinsfile", "diffHunk": "@@ -43,7 +43,7 @@ pipeline {\n           flaky_args=(\"${flaky_args[@]}\" --urls \"${JENKINS_URL}/job/HBase%20Nightly/job/${BRANCH_NAME}\" --is-yetus True --max-builds 10)\n           flaky_args=(\"${flaky_args[@]}\" --urls \"${JENKINS_URL}/job/HBase-Flaky-Tests/job/${BRANCH_NAME}\" --is-yetus False --max-builds 30)\n           docker build -t hbase-dev-support dev-support\n-          docker run -v \"${WORKSPACE}\":/hbase --workdir=/hbase hbase-dev-support python dev-support/flaky-tests/report-flakies.py --mvn -v \"${flaky_args[@]}\"\n+          docker run --ulimit nproc=12500 -v \"${WORKSPACE}\":/hbase --workdir=/hbase hbase-dev-support python dev-support/flaky-tests/report-flakies.py --mvn -v \"${flaky_args[@]}\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baf2d8929e6c56deff5ee300631a9f432bd784b2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg3MzAzNA==", "bodyText": "Oh no, I didn't know this script existed. I probably broke it with the improvements that went in with HBASE-23945.", "url": "https://github.com/apache/hbase/pull/1450#discussion_r405873034", "createdAt": "2020-04-08T23:31:58Z", "author": {"login": "ndimiduk"}, "path": "dev-support/hbase_docker.sh", "diffHunk": "@@ -159,4 +159,4 @@ done\n echo \"Successfully built ${IMAGE_NAME}.\"\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baf2d8929e6c56deff5ee300631a9f432bd784b2"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg3NDQzNw==", "bodyText": "Ah, yeah. In yetus, the env variable is PROC_LIMIT. You found a bug :)", "url": "https://github.com/apache/hbase/pull/1450#discussion_r405874437", "createdAt": "2020-04-08T23:36:22Z", "author": {"login": "ndimiduk"}, "path": "dev-support/hbase-personality.sh", "diffHunk": "@@ -81,8 +81,11 @@ function personality_globals\n \n   # Yetus 0.7.0 enforces limits. Default proclimit is 1000.\n   # Up it. See HBASE-19902 for how we arrived at this number.\n+  # NOTE: I don't think changing this has an effect. Set the\n+  # --proclimit passed to yetus. This seems to do what we\n+  # need changing proclimit.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baf2d8929e6c56deff5ee300631a9f432bd784b2"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg3NDYzNQ==", "bodyText": "If the above change for PROC_LIMIT works, this line can be dropped.", "url": "https://github.com/apache/hbase/pull/1450#discussion_r405874635", "createdAt": "2020-04-08T23:37:05Z", "author": {"login": "ndimiduk"}, "path": "dev-support/hbase_nightly_yetus.sh", "diffHunk": "@@ -66,7 +66,7 @@ YETUS_ARGS=(\"--branch=${BRANCH_NAME}\" \"${YETUS_ARGS[@]}\")\n YETUS_ARGS=(\"--tests-filter=${TESTS_FILTER}\" \"${YETUS_ARGS[@]}\")\n YETUS_ARGS=(\"--ignore-unknown-options=true\" \"${YETUS_ARGS[@]}\")\n # Why are these not being picked up from hbase-personality?\n-YETUS_ARGS=(\"--proclimit=10000\" \"${YETUS_ARGS[@]}\")\n+YETUS_ARGS=(\"--proclimit=12500\" \"${YETUS_ARGS[@]}\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baf2d8929e6c56deff5ee300631a9f432bd784b2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTg3NDY3OA==", "bodyText": "likewise.", "url": "https://github.com/apache/hbase/pull/1450#discussion_r405874678", "createdAt": "2020-04-08T23:37:15Z", "author": {"login": "ndimiduk"}, "path": "dev-support/jenkins_precommit_github_yetus.sh", "diffHunk": "@@ -102,7 +102,7 @@ YETUS_ARGS+=(\"--reapermode=kill\")\n # set relatively high limits for ASF machines\n # changing these to higher values may cause problems\n # with other jobs on systemd-enabled machines\n-YETUS_ARGS+=(\"--proclimit=10000\")\n+YETUS_ARGS+=(\"--proclimit=12500\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "baf2d8929e6c56deff5ee300631a9f432bd784b2"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2329, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}