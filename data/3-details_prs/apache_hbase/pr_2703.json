{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2MzY0MzE2", "number": 2703, "title": "HBASE-25324 Remove unnecessary array to list conversion in SplitLogManager", "bodyText": "\u2026nager", "createdAt": "2020-11-24T10:11:46Z", "url": "https://github.com/apache/hbase/pull/2703", "merged": true, "mergeCommit": {"oid": "dc48071e01e19539647a4d6261cec0d25198d81e"}, "closed": true, "closedAt": "2020-11-27T00:20:25Z", "author": {"login": "yuqi1129"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfm6AHAH2gAyNTI2MzY0MzE2OmE5NjI1YmI1NTcyODYyN2QzM2ZkYzJiMWMyNTg5ZjhmN2I1YTJmZjM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgJdOqgH2gAyNTI2MzY0MzE2OmYwYTZlM2Y1NTNiZDMzMTAyMWIwNDBjZmQzODEyMjUwNjcxYWVlNzA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a9625bb55728627d33fdc2b1c2589f8f7b5a2ff3", "author": {"user": {"login": "yuqi1129", "name": "Qi Yu"}}, "url": "https://github.com/apache/hbase/commit/a9625bb55728627d33fdc2b1c2589f8f7b5a2ff3", "committedDate": "2020-11-24T10:08:38Z", "message": "HBASE-25324 Remove unnecessary array to list conversion in SplitLogManager"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2453e09408bb0236c3e2ce781a61934343c08d1d", "author": {"user": {"login": "yuqi1129", "name": "Qi Yu"}}, "url": "https://github.com/apache/hbase/commit/2453e09408bb0236c3e2ce781a61934343c08d1d", "committedDate": "2020-11-24T10:12:33Z", "message": "HBASE-25324 Remove unnecessary array to list conversion in SplitLogManager, change 1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NTM5NzQx", "url": "https://github.com/apache/hbase/pull/2703#pullrequestreview-537539741", "createdAt": "2020-11-24T14:22:29Z", "commit": {"oid": "2453e09408bb0236c3e2ce781a61934343c08d1d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNDoyMjoyOVrOH5DG0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNDoyMjoyOVrOH5DG0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTU4MTc3Ng==", "bodyText": "Nice", "url": "https://github.com/apache/hbase/pull/2703#discussion_r529581776", "createdAt": "2020-11-24T14:22:29Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALSplitter.java", "diffHunk": "@@ -220,17 +218,16 @@ public static boolean splitLogFile(Path walDir, FileStatus logfile, FileSystem w\n     Path rootDir = CommonFSUtils.getRootDir(conf);\n     FileSystem rootFS = rootDir.getFileSystem(conf);\n     WALSplitter splitter = new WALSplitter(factory, conf, walRootDir, walFS, rootDir, rootFS);\n-    final FileStatus[] wals =\n+    final List<FileStatus> wals =\n       SplitLogManager.getFileList(conf, Collections.singletonList(walsDir), null);\n     List<Path> splits = new ArrayList<>();\n-    if (ArrayUtils.isNotEmpty(wals)) {\n+    if (CollectionUtils.isNotEmpty(wals)) {\n       for (FileStatus wal: wals) {\n         SplitWALResult splitWALResult = splitter.splitWAL(wal, null);\n         if (splitWALResult.isFinished()) {\n           WALSplitUtil.archive(wal.getPath(), splitWALResult.isCorrupt(), archiveDir, walFS, conf);\n-          if (splitter.outputSink.splits != null) {\n-            splits.addAll(splitter.outputSink.splits);\n-          }\n+          //splitter.outputSink.splits is mark as final, do not need null check\n+          splits.addAll(splitter.outputSink.splits);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2453e09408bb0236c3e2ce781a61934343c08d1d"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NzE5NTE4", "url": "https://github.com/apache/hbase/pull/2703#pullrequestreview-537719518", "createdAt": "2020-11-24T16:57:02Z", "commit": {"oid": "2453e09408bb0236c3e2ce781a61934343c08d1d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNjo1NzowM1rOH5MPLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxNjo1NzowM1rOH5MPLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTczMTM3NA==", "bodyText": "s/logfiles.size != 0/logfiles.isEmpty()/", "url": "https://github.com/apache/hbase/pull/2703#discussion_r529731374", "createdAt": "2020-11-24T16:57:03Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java", "diffHunk": "@@ -242,11 +242,11 @@ public long splitLogDistributed(final Set<ServerName> serverNames, final List<Pa\n     long totalSize = 0;\n     TaskBatch batch = null;\n     long startTime = 0;\n-    FileStatus[] logfiles = getFileList(logDirs, filter);\n-    if (logfiles.length != 0) {\n+    List<FileStatus> logfiles = getFileList(logDirs, filter);\n+    if (logfiles.size() != 0) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2453e09408bb0236c3e2ce781a61934343c08d1d"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MDU2MjYw", "url": "https://github.com/apache/hbase/pull/2703#pullrequestreview-538056260", "createdAt": "2020-11-24T23:49:20Z", "commit": {"oid": "2453e09408bb0236c3e2ce781a61934343c08d1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQyMzo0OToyMFrOH5dt-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQyMzo0OToyMFrOH5dt-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDAxNzc4Ng==", "bodyText": "wals.isEmpty()?", "url": "https://github.com/apache/hbase/pull/2703#discussion_r530017786", "createdAt": "2020-11-24T23:49:20Z", "author": {"login": "infraio"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALSplitter.java", "diffHunk": "@@ -220,17 +218,16 @@ public static boolean splitLogFile(Path walDir, FileStatus logfile, FileSystem w\n     Path rootDir = CommonFSUtils.getRootDir(conf);\n     FileSystem rootFS = rootDir.getFileSystem(conf);\n     WALSplitter splitter = new WALSplitter(factory, conf, walRootDir, walFS, rootDir, rootFS);\n-    final FileStatus[] wals =\n+    final List<FileStatus> wals =\n       SplitLogManager.getFileList(conf, Collections.singletonList(walsDir), null);\n     List<Path> splits = new ArrayList<>();\n-    if (ArrayUtils.isNotEmpty(wals)) {\n+    if (CollectionUtils.isNotEmpty(wals)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2453e09408bb0236c3e2ce781a61934343c08d1d"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0ef40378ffd2e4cbc2d31e3263c3aedb8f5c803", "author": {"user": {"login": "yuqi1129", "name": "Qi Yu"}}, "url": "https://github.com/apache/hbase/commit/e0ef40378ffd2e4cbc2d31e3263c3aedb8f5c803", "committedDate": "2020-11-25T02:31:21Z", "message": "Fix discussion 1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6da6d6e420d4f818185c739fe19badc4f0a5a7cd", "author": {"user": {"login": "yuqi1129", "name": "Qi Yu"}}, "url": "https://github.com/apache/hbase/commit/6da6d6e420d4f818185c739fe19badc4f0a5a7cd", "committedDate": "2020-11-25T04:02:27Z", "message": "Fix discussion 3"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4MjA4ODYx", "url": "https://github.com/apache/hbase/pull/2703#pullrequestreview-538208861", "createdAt": "2020-11-25T07:13:54Z", "commit": {"oid": "6da6d6e420d4f818185c739fe19badc4f0a5a7cd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ba66dbd8f5dcee5af05b1f21017918718f52180e", "author": {"user": {"login": "yuqi1129", "name": "Qi Yu"}}, "url": "https://github.com/apache/hbase/commit/ba66dbd8f5dcee5af05b1f21017918718f52180e", "committedDate": "2020-11-25T09:15:58Z", "message": "Fix discussion 4, fix checkstyle problem"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e058aa1321233c0acf5af7b7df3e58966a461ad", "author": {"user": {"login": "yuqi1129", "name": "Qi Yu"}}, "url": "https://github.com/apache/hbase/commit/6e058aa1321233c0acf5af7b7df3e58966a461ad", "committedDate": "2020-11-25T09:18:04Z", "message": "Merge branch 'master' of https://github.com/apache/hbase into HBASE-25324"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bce4bb6d131e8e708e40415bc94d79ad17832b46", "author": {"user": {"login": "yuqi1129", "name": "Qi Yu"}}, "url": "https://github.com/apache/hbase/commit/bce4bb6d131e8e708e40415bc94d79ad17832b46", "committedDate": "2020-11-26T01:52:26Z", "message": "Merge branch 'master' into HBASE-25324"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a125c4d2eda3f1a92be41fca16b5c56f3611af98", "author": {"user": {"login": "yuqi1129", "name": "Qi Yu"}}, "url": "https://github.com/apache/hbase/commit/a125c4d2eda3f1a92be41fca16b5c56f3611af98", "committedDate": "2020-11-26T02:20:44Z", "message": "merge master and resolve conflict"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0a6e3f553bd331021b040cfd3812250671aee70", "author": {"user": {"login": "yuqi1129", "name": "Qi Yu"}}, "url": "https://github.com/apache/hbase/commit/f0a6e3f553bd331021b040cfd3812250671aee70", "committedDate": "2020-11-26T02:23:53Z", "message": "Merge master, fix conflict again"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4993, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}