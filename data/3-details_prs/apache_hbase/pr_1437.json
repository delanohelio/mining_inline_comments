{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5MTI0OTQy", "number": 1437, "title": "HBASE-24055 Make AsyncFSWAL can run on EC cluster", "bodyText": "", "createdAt": "2020-04-05T15:11:22Z", "url": "https://github.com/apache/hbase/pull/1437", "merged": true, "mergeCommit": {"oid": "f60f0bdbf04935e8eb28dcc9580e193ba49fa2a6"}, "closed": true, "closedAt": "2020-04-07T15:41:36Z", "author": {"login": "Apache9"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVIJyCgFqTM4ODY5NDA1OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVTt3RgFqTM4OTE0MTcwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4Njk0MDU4", "url": "https://github.com/apache/hbase/pull/1437#pullrequestreview-388694058", "createdAt": "2020-04-06T23:47:18Z", "commit": {"oid": "1a1a3202501db69730c93b1400fbafb76fbfe5e7"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMzo0NzoxOVrOGBt8pQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMzo0ODowMFrOGBt9pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDU2NQ==", "bodyText": "Should this be logged at warn instead?", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404454565", "createdAt": "2020-04-06T23:47:19Z", "author": {"login": "ndimiduk"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/io/asyncfs/FanOutOneBlockAsyncDFSOutputHelper.java", "diffHunk": "@@ -272,6 +272,15 @@ private static FileCreator createFileCreator() throws NoSuchMethodException {\n     return createFileCreator2();\n   }\n \n+  private static CreateFlag loadShouldReplicateFlag() {\n+    try {\n+      return CreateFlag.valueOf(\"SHOULD_REPLICATE\");\n+    } catch (IllegalArgumentException e) {\n+      LOG.debug(\"can not find SHOULD_REPLICATE flag, should be hadoop 2.x\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a1a3202501db69730c93b1400fbafb76fbfe5e7"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDgyMg==", "bodyText": "nice cleanup.", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404454822", "createdAt": "2020-04-06T23:48:00Z", "author": {"login": "ndimiduk"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/io/asyncfs/FanOutOneBlockAsyncDFSOutputHelper.java", "diffHunk": "@@ -502,8 +524,8 @@ private static FanOutOneBlockAsyncDFSOutput createOutput(DistributedFileSystem d\n       try {\n         stat = FILE_CREATOR.create(namenode, src,\n           FsPermission.getFileDefault().applyUMask(FsPermission.getUMask(conf)), clientName,\n-          new EnumSetWritable<>(overwrite ? EnumSet.of(CREATE, OVERWRITE) : EnumSet.of(CREATE)),\n-          createParent, replication, blockSize, CryptoProtocolVersion.supported());\n+          getCreateFlags(overwrite), createParent, replication, blockSize,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1a1a3202501db69730c93b1400fbafb76fbfe5e7"}, "originalPosition": 67}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NzI2MTg5", "url": "https://github.com/apache/hbase/pull/1437#pullrequestreview-388726189", "createdAt": "2020-04-07T01:27:39Z", "commit": {"oid": "1a1a3202501db69730c93b1400fbafb76fbfe5e7"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwMToyNzozOVrOGBvtpg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wN1QwMTozMToyNlrOGBvxtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ4MzQ5NA==", "bodyText": "This happens every time we open a file in hadoop2? Or just once on class loading? (Looks like the latter).", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404483494", "createdAt": "2020-04-07T01:27:39Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/io/asyncfs/FanOutOneBlockAsyncDFSOutputHelper.java", "diffHunk": "@@ -272,6 +272,15 @@ private static FileCreator createFileCreator() throws NoSuchMethodException {\n     return createFileCreator2();\n   }\n \n+  private static CreateFlag loadShouldReplicateFlag() {\n+    try {\n+      return CreateFlag.valueOf(\"SHOULD_REPLICATE\");\n+    } catch (IllegalArgumentException e) {\n+      LOG.debug(\"can not find SHOULD_REPLICATE flag, should be hadoop 2.x\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDU2NQ=="}, "originalCommit": {"oid": "1a1a3202501db69730c93b1400fbafb76fbfe5e7"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ4NDUzNA==", "bodyText": "This is how we test if the the SHOULD_REPLICATE flag is available? It is not available if hadoop2? If so, can we have a comment on the method to this effect? The log is a little confusing. Suggest: \"SHOULD_REPLICATE is not available; this is a problem if we are running on hadoop3 (Its expected if hadoop2)\".", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404484534", "createdAt": "2020-04-07T01:31:26Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/io/asyncfs/FanOutOneBlockAsyncDFSOutputHelper.java", "diffHunk": "@@ -272,6 +272,15 @@ private static FileCreator createFileCreator() throws NoSuchMethodException {\n     return createFileCreator2();\n   }\n \n+  private static CreateFlag loadShouldReplicateFlag() {\n+    try {\n+      return CreateFlag.valueOf(\"SHOULD_REPLICATE\");\n+    } catch (IllegalArgumentException e) {\n+      LOG.debug(\"can not find SHOULD_REPLICATE flag, should be hadoop 2.x\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDU2NQ=="}, "originalCommit": {"oid": "1a1a3202501db69730c93b1400fbafb76fbfe5e7"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1f7a4ef1f3ce26cddb6a04a1b34bbeb3c26f11ce", "author": {"user": {"login": "Apache9", "name": "Duo Zhang"}}, "url": "https://github.com/apache/hbase/commit/1f7a4ef1f3ce26cddb6a04a1b34bbeb3c26f11ce", "committedDate": "2020-04-07T01:50:03Z", "message": "HBASE-24055 Make AsyncFSWAL can run on EC cluster"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9eb6cce57547e361101642bf77b9c575bf21f531", "author": {"user": {"login": "Apache9", "name": "Duo Zhang"}}, "url": "https://github.com/apache/hbase/commit/9eb6cce57547e361101642bf77b9c575bf21f531", "committedDate": "2020-04-07T04:27:56Z", "message": "add comment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1a1a3202501db69730c93b1400fbafb76fbfe5e7", "author": {"user": {"login": "Apache9", "name": "Duo Zhang"}}, "url": "https://github.com/apache/hbase/commit/1a1a3202501db69730c93b1400fbafb76fbfe5e7", "committedDate": "2020-04-05T15:10:53Z", "message": "HBASE-24055 Make AsyncFSWAL can run on EC cluster"}, "afterCommit": {"oid": "9eb6cce57547e361101642bf77b9c575bf21f531", "author": {"user": {"login": "Apache9", "name": "Duo Zhang"}}, "url": "https://github.com/apache/hbase/commit/9eb6cce57547e361101642bf77b9c575bf21f531", "committedDate": "2020-04-07T04:27:56Z", "message": "add comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5MTQxNzA1", "url": "https://github.com/apache/hbase/pull/1437#pullrequestreview-389141705", "createdAt": "2020-04-07T13:56:47Z", "commit": {"oid": "9eb6cce57547e361101642bf77b9c575bf21f531"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2309, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}