{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyNTMyMDg4", "number": 1771, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjo0MTo0MlrOD_Xy2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjo0NTozOVrOD_X24A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3Nzc2NzMwOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/resources/hbase-webapps/master/hbck.jsp", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjo0MTo0MlrOGZ_5KQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjo0MTo0MlrOGZ_5KQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkxNDQwOQ==", "bodyText": "nit: Since we need boolean, we can directly use: Boolean.parseBoolean(cacheParameterValue)", "url": "https://github.com/apache/hbase/pull/1771#discussion_r429914409", "createdAt": "2020-05-25T12:41:42Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/resources/hbase-webapps/master/hbck.jsp", "diffHunk": "@@ -37,9 +37,17 @@\n <%@ page import=\"org.apache.hadoop.hbase.util.Pair\" %>\n <%@ page import=\"org.apache.hadoop.hbase.master.CatalogJanitor\" %>\n <%@ page import=\"org.apache.hadoop.hbase.master.CatalogJanitor.Report\" %>\n+<%@ page import=\"org.apache.hadoop.hbase.util.Threads\" %>\n <%\n+  final String cacheParameterValue = request.getParameter(\"cache\");\n+  boolean cache = Boolean.valueOf(cacheParameterValue);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa988350db1629bce564889ced9ab8107bf25c05"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3Nzc3Mjk3OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/resources/hbase-webapps/master/hbck.jsp", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjo0Mzo1MVrOGZ_8nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQxOToxOTo0MlrOGaswcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkxNTI5Mw==", "bodyText": "MasterRpcServices throw ServiceException for both runHbckChore and runCatalogScan. Maybe we can handle it and print some nice error message?", "url": "https://github.com/apache/hbase/pull/1771#discussion_r429915293", "createdAt": "2020-05-25T12:43:51Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/resources/hbase-webapps/master/hbck.jsp", "diffHunk": "@@ -37,9 +37,17 @@\n <%@ page import=\"org.apache.hadoop.hbase.util.Pair\" %>\n <%@ page import=\"org.apache.hadoop.hbase.master.CatalogJanitor\" %>\n <%@ page import=\"org.apache.hadoop.hbase.master.CatalogJanitor.Report\" %>\n+<%@ page import=\"org.apache.hadoop.hbase.util.Threads\" %>\n <%\n+  final String cacheParameterValue = request.getParameter(\"cache\");\n+  boolean cache = Boolean.valueOf(cacheParameterValue);\n   final HMaster master = (HMaster) getServletContext().getAttribute(HMaster.MASTER);\n   pageContext.setAttribute(\"pageTitle\", \"HBase Master HBCK Report: \" + master.getServerName());\n+  if (!cache) {\n+    // Run the two reporters inline w/ drawing of the page. If exception, will show in page draw.\n+    master.getMasterRpcServices().runHbckChore(null, null);\n+    master.getMasterRpcServices().runCatalogScan(null, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa988350db1629bce564889ced9ab8107bf25c05"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY0OTQ1OQ==", "bodyText": "Yeah. Was thinking about it. Though the rare SE not the end of the world. Added something at your prompting.... it looks like this when generated...\n   if (!Boolean.parseBoolean(cacheParameterValue)) {\n     // Run the two reporters inline w/ drawing of the page. If exception, will show in page draw.\n     try {\n       master.getMasterRpcServices().runHbckChore(null, null);\n     } catch (org.apache.hbase.thirdparty.com.google.protobuf.ServiceException se) {\n       out.write(\"Failed generating a new hbck_chore report; using cache; try again or run hbck_chore_run in the shell: \" + se.getMessage() + \"\\n\");\n     }\n     try {\n       master.getMasterRpcServices().runCatalogScan(null, null);\n     } catch (org.apache.hbase.thirdparty.com.google.protobuf.ServiceException se) {\n       out.write(\"Failed generating a new catalogjanitor report; using cache; try again or run catalogjanitor_run in the shell: \" + se.getMessage() + \"\\n\");\n     }\n   }", "url": "https://github.com/apache/hbase/pull/1771#discussion_r430649459", "createdAt": "2020-05-26T19:19:42Z", "author": {"login": "saintstack"}, "path": "hbase-server/src/main/resources/hbase-webapps/master/hbck.jsp", "diffHunk": "@@ -37,9 +37,17 @@\n <%@ page import=\"org.apache.hadoop.hbase.util.Pair\" %>\n <%@ page import=\"org.apache.hadoop.hbase.master.CatalogJanitor\" %>\n <%@ page import=\"org.apache.hadoop.hbase.master.CatalogJanitor.Report\" %>\n+<%@ page import=\"org.apache.hadoop.hbase.util.Threads\" %>\n <%\n+  final String cacheParameterValue = request.getParameter(\"cache\");\n+  boolean cache = Boolean.valueOf(cacheParameterValue);\n   final HMaster master = (HMaster) getServletContext().getAttribute(HMaster.MASTER);\n   pageContext.setAttribute(\"pageTitle\", \"HBase Master HBCK Report: \" + master.getServerName());\n+  if (!cache) {\n+    // Run the two reporters inline w/ drawing of the page. If exception, will show in page draw.\n+    master.getMasterRpcServices().runHbckChore(null, null);\n+    master.getMasterRpcServices().runCatalogScan(null, null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkxNTI5Mw=="}, "originalCommit": {"oid": "fa988350db1629bce564889ced9ab8107bf25c05"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY3Nzc3NzYwOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/resources/hbase-webapps/master/hbck.jsp", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjo0NTozOVrOGZ__ew==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxMjo0NTozOVrOGZ__ew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkxNjAyNw==", "bodyText": "Not being used it seems.", "url": "https://github.com/apache/hbase/pull/1771#discussion_r429916027", "createdAt": "2020-05-25T12:45:39Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/resources/hbase-webapps/master/hbck.jsp", "diffHunk": "@@ -37,9 +37,17 @@\n <%@ page import=\"org.apache.hadoop.hbase.util.Pair\" %>\n <%@ page import=\"org.apache.hadoop.hbase.master.CatalogJanitor\" %>\n <%@ page import=\"org.apache.hadoop.hbase.master.CatalogJanitor.Report\" %>\n+<%@ page import=\"org.apache.hadoop.hbase.util.Threads\" %>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fa988350db1629bce564889ced9ab8107bf25c05"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3036, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}