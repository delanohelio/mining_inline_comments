{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNzMyNDg0", "number": 1986, "title": "HBASE-24581 Skip compaction request/check for replica regions at the \u2026", "bodyText": "\u2026early stage.", "createdAt": "2020-06-26T18:41:13Z", "url": "https://github.com/apache/hbase/pull/1986", "merged": true, "mergeCommit": {"oid": "2505c7760de66535b89de493326e9f2b800d8c3f"}, "closed": true, "closedAt": "2020-07-14T22:49:21Z", "author": {"login": "huaxiangsun"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcvZQ2KgBqjM0ODkwNTA5MjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc09dfhAFqTQ0ODQ5OTg4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9757fa040bde48bc8e880511e9eabfcd9b30d5f6", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/9757fa040bde48bc8e880511e9eabfcd9b30d5f6", "committedDate": "2020-06-25T20:20:22Z", "message": "HBASE-24581 Skip compaction request/check for replica regions at the early stage."}, "afterCommit": {"oid": "168102f3c09d85cba441ac8247de427626d8954d", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/168102f3c09d85cba441ac8247de427626d8954d", "committedDate": "2020-06-27T15:05:19Z", "message": "HBASE-24581 Skip compaction request/check for replica regions at the early stage."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4NzM0OTU5", "url": "https://github.com/apache/hbase/pull/1986#pullrequestreview-438734959", "createdAt": "2020-06-28T01:20:21Z", "commit": {"oid": "168102f3c09d85cba441ac8247de427626d8954d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOFQwMToyMDoyMVrOGp5eig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOFQwMToyMDoyMVrOGp5eig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjU4NjUwNg==", "bodyText": "Why this change?", "url": "https://github.com/apache/hbase/pull/1986#discussion_r446586506", "createdAt": "2020-06-28T01:20:21Z", "author": {"login": "infraio"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestRegionReplicaSplit.java", "diffHunk": "@@ -109,7 +109,7 @@ public void testRegionReplicaSplitRegionAssignment() throws Exception {\n         }\n       }\n       // There are 6 regions before split, 9 regions after split.\n-      HTU.getAdmin().split(table.getName(), Bytes.toBytes(1));\n+      HTU.getAdmin().split(table.getName(), Bytes.toBytes(\"d\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "168102f3c09d85cba441ac8247de427626d8954d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "518c97bfff2f9d582c7a9907bda5da9ee61fe102", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/518c97bfff2f9d582c7a9907bda5da9ee61fe102", "committedDate": "2020-07-02T01:10:25Z", "message": "HBASE-24581 Skip compaction request/check for replica regions at the early stage."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "168102f3c09d85cba441ac8247de427626d8954d", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/168102f3c09d85cba441ac8247de427626d8954d", "committedDate": "2020-06-27T15:05:19Z", "message": "HBASE-24581 Skip compaction request/check for replica regions at the early stage."}, "afterCommit": {"oid": "518c97bfff2f9d582c7a9907bda5da9ee61fe102", "author": {"user": null}, "url": "https://github.com/apache/hbase/commit/518c97bfff2f9d582c7a9907bda5da9ee61fe102", "committedDate": "2020-07-02T01:10:25Z", "message": "HBASE-24581 Skip compaction request/check for replica regions at the early stage."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MTYwMjYx", "url": "https://github.com/apache/hbase/pull/1986#pullrequestreview-444160261", "createdAt": "2020-07-07T18:48:44Z", "commit": {"oid": "518c97bfff2f9d582c7a9907bda5da9ee61fe102"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODo0ODo0NFrOGuLSkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wN1QxODo0ODo0NFrOGuLSkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTA3MjY1Ng==", "bodyText": "Can we have a test to verify we don't split meta/read-only region?", "url": "https://github.com/apache/hbase/pull/1986#discussion_r451072656", "createdAt": "2020-07-07T18:48:44Z", "author": {"login": "clarax"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestRegionReplicaSplit.java", "diffHunk": "@@ -109,11 +112,16 @@ public void testRegionReplicaSplitRegionAssignment() throws Exception {\n         }\n       }\n       // There are 6 regions before split, 9 regions after split.\n-      HTU.getAdmin().split(table.getName(), Bytes.toBytes(1));\n+      HTU.getAdmin().split(table.getName(), Bytes.toBytes(\"d\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "518c97bfff2f9d582c7a9907bda5da9ee61fe102"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MDQ4Mzgx", "url": "https://github.com/apache/hbase/pull/1986#pullrequestreview-446048381", "createdAt": "2020-07-10T00:17:57Z", "commit": {"oid": "518c97bfff2f9d582c7a9907bda5da9ee61fe102"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwMDoxNzo1N1rOGvl7Ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwMDoxNzo1N1rOGvl7Ww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU1NzY1OQ==", "bodyText": "Why do you expect there to be data in all stores?", "url": "https://github.com/apache/hbase/pull/1986#discussion_r452557659", "createdAt": "2020-07-10T00:17:57Z", "author": {"login": "ndimiduk"}, "path": "hbase-server/src/test/java/org/apache/hadoop/hbase/master/assignment/TestRegionReplicaSplit.java", "diffHunk": "@@ -109,11 +112,16 @@ public void testRegionReplicaSplitRegionAssignment() throws Exception {\n         }\n       }\n       // There are 6 regions before split, 9 regions after split.\n-      HTU.getAdmin().split(table.getName(), Bytes.toBytes(1));\n+      HTU.getAdmin().split(table.getName(), Bytes.toBytes(\"d\"));\n       int count = 0;\n       while (true) {\n         for (RegionServerThread rs : HTU.getMiniHBaseCluster().getRegionServerThreads()) {\n           for (Region r : rs.getRegionServer().getRegions(table.getName())) {\n+            // Make sure that every region has some data (even for split daughter regions).\n+            if (RegionReplicaUtil.isDefaultReplica(r.getRegionInfo())) {\n+              assertTrue(r.getStore(f).hasReferences() ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "518c97bfff2f9d582c7a9907bda5da9ee61fe102"}, "originalPosition": 45}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NDk5ODgz", "url": "https://github.com/apache/hbase/pull/1986#pullrequestreview-448499883", "createdAt": "2020-07-14T22:06:34Z", "commit": {"oid": "518c97bfff2f9d582c7a9907bda5da9ee61fe102"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4409, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}