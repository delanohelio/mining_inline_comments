{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4MzU2NTI1", "number": 2345, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwODo1ODoyN1rOEf5Kkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxODowMTo0N1rOEgerKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODc3OTA3OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwODo1ODoyN1rOHMc-NQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwODo1ODoyN1rOHMc-NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgxOTYzNw==", "bodyText": "nit: \"Only lof entries for these tables...\"", "url": "https://github.com/apache/hbase/pull/2345#discussion_r482819637", "createdAt": "2020-09-03T08:58:27Z", "author": {"login": "wchevreuil"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -147,11 +153,13 @@ public void setSequenceFilter(long sequence) {\n   }\n \n   /**\n-   * Sets the table filter. Only log entries for this table are printed.\n-   * @param table table name to set.\n+   * Sets the tables filter. Only log entries for these table are printed.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ecf4e3f5c78d95a9057c76902ac9c1c742364f5"}, "originalPosition": 44}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODgxMTA2OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTowNjoyOFrOHMdSZQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwMzozMzozNlrOHM-UPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgyNDgwNQ==", "bodyText": "nit: for clarity, shouldn't we name it as tableSet instead of tableList? Or maybe better to use List/ArrayList.", "url": "https://github.com/apache/hbase/pull/2345#discussion_r482824805", "createdAt": "2020-09-03T09:06:28Z", "author": {"login": "wchevreuil"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -79,9 +81,12 @@\n   private boolean outputJSON;\n   // The following enable filtering by sequence, region, and row, respectively\n   private long sequence;\n-  private String table;\n+\n+  // List of tables for filter\n+  private Set<String> tableList;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ecf4e3f5c78d95a9057c76902ac9c1c742364f5"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg1NzQxNg==", "bodyText": "+1, and this should be final too.", "url": "https://github.com/apache/hbase/pull/2345#discussion_r482857416", "createdAt": "2020-09-03T09:56:12Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -79,9 +81,12 @@\n   private boolean outputJSON;\n   // The following enable filtering by sequence, region, and row, respectively\n   private long sequence;\n-  private String table;\n+\n+  // List of tables for filter\n+  private Set<String> tableList;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgyNDgwNQ=="}, "originalCommit": {"oid": "3ecf4e3f5c78d95a9057c76902ac9c1c742364f5"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NTk1MA==", "bodyText": "I used Set since every WALEntry is going to search in the Set which is optimal for search.\nas @virajjasani  pointed out in another comment", "url": "https://github.com/apache/hbase/pull/2345#discussion_r483365950", "createdAt": "2020-09-04T03:33:36Z", "author": {"login": "sandeepvinayak"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -79,9 +81,12 @@\n   private boolean outputJSON;\n   // The following enable filtering by sequence, region, and row, respectively\n   private long sequence;\n-  private String table;\n+\n+  // List of tables for filter\n+  private Set<String> tableList;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgyNDgwNQ=="}, "originalCommit": {"oid": "3ecf4e3f5c78d95a9057c76902ac9c1c742364f5"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODg0NjYyOnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOToxNDoxOFrOHMdoKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOToxNDoxOFrOHMdoKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgzMDM3OA==", "bodyText": "Is HashSet really needed here? Can this be a simple ArrayList?", "url": "https://github.com/apache/hbase/pull/2345#discussion_r482830378", "createdAt": "2020-09-03T09:14:18Z", "author": {"login": "wchevreuil"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -99,9 +104,10 @@ public WALPrettyPrinter() {\n     outputValues = false;\n     outputJSON = false;\n     sequence = -1;\n-    table = null;\n+    tableList = new HashSet<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ecf4e3f5c78d95a9057c76902ac9c1c742364f5"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxODg2MTU4OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOToxODowOVrOHMdxSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOToxODowOVrOHMdxSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgzMjcxMg==", "bodyText": "Let's be more direct: \"Prints only row keys\".", "url": "https://github.com/apache/hbase/pull/2345#discussion_r482832712", "createdAt": "2020-09-03T09:18:09Z", "author": {"login": "wchevreuil"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -391,6 +415,8 @@ public static void run(String[] args) throws IOException {\n         \"Region to filter by. Pass encoded region name; e.g. '9192caead6a5a20acb4454ffbc79fa14'\");\n     options.addOption(\"s\", \"sequence\", true,\n         \"Sequence to filter by. Pass sequence number.\");\n+    options.addOption(\"k\", \"outputOnlyRowKey\", false,\n+      \"If only row keys are required in output\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ecf4e3f5c78d95a9057c76902ac9c1c742364f5"}, "originalPosition": 148}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTAwNjk4OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTo1MTozNFrOHMfGfA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTo1MTozNFrOHMfGfA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg1NDUyNA==", "bodyText": "This can be replaced with:\n    Collections.addAll(tableList, tableListWithDelimiter.split(\",\"));", "url": "https://github.com/apache/hbase/pull/2345#discussion_r482854524", "createdAt": "2020-09-03T09:51:34Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -147,11 +153,13 @@ public void setSequenceFilter(long sequence) {\n   }\n \n   /**\n-   * Sets the table filter. Only log entries for this table are printed.\n-   * @param table table name to set.\n+   * Sets the tables filter. Only log entries for these table are printed.\n+   * @param tableListWithDelimiter table names separated with comma.\n    */\n-  public void setTableFilter(String table) {\n-    this.table = table;\n+  public void setTableFilter(String tableListWithDelimiter) {\n+    for (String table :  tableListWithDelimiter.split(\",\")) {\n+      tableList.add(table);\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ecf4e3f5c78d95a9057c76902ac9c1c742364f5"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAxOTAxODY4OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTo1NDozN1rOHMfNqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QwOTo1NDozN1rOHMfNqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjg1NjM2MQ==", "bodyText": "Looks like this efficient search with contains() is the reason behind using Set instead of List.\nBtw, (TableName) is redundant cast here.", "url": "https://github.com/apache/hbase/pull/2345#discussion_r482856361", "createdAt": "2020-09-03T09:54:37Z", "author": {"login": "virajjasani"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -274,7 +289,8 @@ public void processFile(final Configuration conf, final Path p)\n         Map<String, Object> txn = key.toStringMap();\n         long writeTime = key.getWriteTime();\n         // check output filters\n-        if (table != null && !((TableName) txn.get(\"table\")).toString().equals(table)) {\n+        if (!tableList.isEmpty() &&\n+          !tableList.contains(((TableName) txn.get(\"table\")).toString())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3ecf4e3f5c78d95a9057c76902ac9c1c742364f5"}, "originalPosition": 85}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyNDkyNDU5OnYy", "diffSide": "RIGHT", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxODowMTo0N1rOHNXQtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDo0ODoyNFrOHNbH5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc3NDY0NQ==", "bodyText": "nit: I think the second condition covers the first one.", "url": "https://github.com/apache/hbase/pull/2345#discussion_r483774645", "createdAt": "2020-09-04T18:01:47Z", "author": {"login": "bharathv"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -274,7 +287,8 @@ public void processFile(final Configuration conf, final Path p)\n         Map<String, Object> txn = key.toStringMap();\n         long writeTime = key.getWriteTime();\n         // check output filters\n-        if (table != null && !((TableName) txn.get(\"table\")).toString().equals(table)) {\n+        if (!tableSet.isEmpty() &&", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecb8cf32756553ba0b2b467f2d65efd1c4129ecc"}, "originalPosition": 93}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzNzkyNQ==", "bodyText": "I think we need the first one where we don't pass -t param and set is Empty. In that case, the second one will always skip all the tables. @bharathv", "url": "https://github.com/apache/hbase/pull/2345#discussion_r483837925", "createdAt": "2020-09-04T20:48:24Z", "author": {"login": "sandeepvinayak"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALPrettyPrinter.java", "diffHunk": "@@ -274,7 +287,8 @@ public void processFile(final Configuration conf, final Path p)\n         Map<String, Object> txn = key.toStringMap();\n         long writeTime = key.getWriteTime();\n         // check output filters\n-        if (table != null && !((TableName) txn.get(\"table\")).toString().equals(table)) {\n+        if (!tableSet.isEmpty() &&", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc3NDY0NQ=="}, "originalCommit": {"oid": "ecb8cf32756553ba0b2b467f2d65efd1c4129ecc"}, "originalPosition": 93}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2594, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}