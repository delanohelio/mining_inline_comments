{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgxMzcyNDMz", "number": 1223, "title": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table de\u2026", "bodyText": "\u2026scriptor directly", "createdAt": "2020-02-28T12:45:37Z", "url": "https://github.com/apache/hbase/pull/1223", "merged": true, "mergeCommit": {"oid": "df62dde394f6a797d045f83784f13effa37c735d"}, "closed": true, "closedAt": "2020-03-06T11:07:00Z", "author": {"login": "infraio"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcI4scJABqjMwODM4ODQxODQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcK8KJrgFqTM2ODUwMDA3NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "76779c36cb7d9529208e2016e91f32ac3d1c2369", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/76779c36cb7d9529208e2016e91f32ac3d1c2369", "committedDate": "2020-02-28T12:44:22Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}, "afterCommit": {"oid": "354fa73e495367ccdb3ae2b7319a3ac4bca9fe23", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/354fa73e495367ccdb3ae2b7319a3ac4bca9fe23", "committedDate": "2020-02-28T23:40:22Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2NzYwNjM2", "url": "https://github.com/apache/hbase/pull/1223#pullrequestreview-366760636", "createdAt": "2020-02-29T00:54:25Z", "commit": {"oid": "354fa73e495367ccdb3ae2b7319a3ac4bca9fe23"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQwMDo1NDoyNVrOFwGlng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQwMDo1NjoyM1rOFwGmmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk4MzkwMg==", "bodyText": "This changes the semantic? Not sure why but before this patch we only set this for HMaster?", "url": "https://github.com/apache/hbase/pull/1223#discussion_r385983902", "createdAt": "2020-02-29T00:54:25Z", "author": {"login": "Apache9"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java", "diffHunk": "@@ -721,20 +720,20 @@ private void initializeFileSystem() throws IOException {\n   }\n \n   private TableDescriptors getFsTableDescriptors() throws IOException {\n-    return new FSTableDescriptors(this.conf,\n-      this.dataFs, this.dataRootDir, !canUpdateTableDescriptor(), false, getMetaTableObserver());\n-  }\n-\n-  protected Function<TableDescriptorBuilder, TableDescriptorBuilder> getMetaTableObserver() {\n-    return null;\n+    if (canUpdateTableDescriptor()) {\n+      return new FSTableDescriptors(this.conf, this.dataFs, this.dataRootDir, false,\n+        builder -> builder.setRegionReplication(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "354fa73e495367ccdb3ae2b7319a3ac4bca9fe23"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk4NDE1Mw==", "bodyText": "I think FSTableDescriptor should extends ReadOnlyFSTableDescriptor? And what is the problem for the old implementation where we just use a flag?", "url": "https://github.com/apache/hbase/pull/1223#discussion_r385984153", "createdAt": "2020-02-29T00:56:23Z", "author": {"login": "Apache9"}, "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/ReadOnlyFSTableDescriptors.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.hadoop.hbase.util;\n+\n+import java.io.IOException;\n+\n+import org.apache.commons.lang3.NotImplementedException;\n+import org.apache.hadoop.conf.Configuration;\n+import org.apache.hadoop.fs.FileStatus;\n+import org.apache.hadoop.fs.FileSystem;\n+import org.apache.hadoop.fs.Path;\n+import org.apache.hadoop.hbase.TableName;\n+import org.apache.hadoop.hbase.client.TableDescriptor;\n+import org.apache.yetus.audience.InterfaceAudience;\n+\n+@InterfaceAudience.Private\n+public class ReadOnlyFSTableDescriptors extends FSTableDescriptors {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "354fa73e495367ccdb3ae2b7319a3ac4bca9fe23"}, "originalPosition": 32}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "354fa73e495367ccdb3ae2b7319a3ac4bca9fe23", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/354fa73e495367ccdb3ae2b7319a3ac4bca9fe23", "committedDate": "2020-02-28T23:40:22Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}, "afterCommit": {"oid": "d339582bf9fe70b37a3d95a9dd51222bfbdae5e4", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/d339582bf9fe70b37a3d95a9dd51222bfbdae5e4", "committedDate": "2020-03-04T02:07:19Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d339582bf9fe70b37a3d95a9dd51222bfbdae5e4", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/d339582bf9fe70b37a3d95a9dd51222bfbdae5e4", "committedDate": "2020-03-04T02:07:19Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}, "afterCommit": {"oid": "17e9b023dd88be112e2c2a281e2afaff8e08b892", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/17e9b023dd88be112e2c2a281e2afaff8e08b892", "committedDate": "2020-03-04T02:15:33Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "17e9b023dd88be112e2c2a281e2afaff8e08b892", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/17e9b023dd88be112e2c2a281e2afaff8e08b892", "committedDate": "2020-03-04T02:15:33Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}, "afterCommit": {"oid": "3d4d301d34ce6879d9d9bb6a060f2acf3d7351f6", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/3d4d301d34ce6879d9d9bb6a060f2acf3d7351f6", "committedDate": "2020-03-04T02:17:44Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3d4d301d34ce6879d9d9bb6a060f2acf3d7351f6", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/3d4d301d34ce6879d9d9bb6a060f2acf3d7351f6", "committedDate": "2020-03-04T02:17:44Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}, "afterCommit": {"oid": "2e8d35e826508d519c689e459e0427bbf1c81559", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/2e8d35e826508d519c689e459e0427bbf1c81559", "committedDate": "2020-03-05T04:15:40Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b61200ff54ab2808ca1726d7ffa4f09529c54171", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/b61200ff54ab2808ca1726d7ffa4f09529c54171", "committedDate": "2020-03-05T07:03:41Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2e8d35e826508d519c689e459e0427bbf1c81559", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/2e8d35e826508d519c689e459e0427bbf1c81559", "committedDate": "2020-03-05T04:15:40Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}, "afterCommit": {"oid": "b61200ff54ab2808ca1726d7ffa4f09529c54171", "author": {"user": {"login": "infraio", "name": "Guanghao Zhang"}}, "url": "https://github.com/apache/hbase/commit/b61200ff54ab2808ca1726d7ffa4f09529c54171", "committedDate": "2020-03-05T07:03:41Z", "message": "HBASE-23739 BoundedRecoveredHFilesOutputSink should read the table descriptor directly"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4NTAwMDc1", "url": "https://github.com/apache/hbase/pull/1223#pullrequestreview-368500075", "createdAt": "2020-03-04T04:38:08Z", "commit": {"oid": "3d4d301d34ce6879d9d9bb6a060f2acf3d7351f6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2895, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}