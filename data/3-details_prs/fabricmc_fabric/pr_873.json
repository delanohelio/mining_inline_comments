{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1ODg0OTEx", "number": 873, "title": "Add callback to allow registration of feature renderers.", "bodyText": "", "createdAt": "2020-07-08T03:03:15Z", "url": "https://github.com/FabricMC/fabric/pull/873", "merged": true, "mergeCommit": {"oid": "e2862de602a3145a1b76ef5f82f046d15db0f48b"}, "closed": true, "closedAt": "2020-08-07T18:49:40Z", "author": {"login": "i509VCB"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcy4h4NgFqTQ0NDY0Mzc1Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc6cPcZAFqTQ1OTUxMzI3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NjQzNzUy", "url": "https://github.com/FabricMC/fabric/pull/873#pullrequestreview-444643752", "createdAt": "2020-07-08T11:13:54Z", "commit": {"oid": "d63eef8a7c67660b49d5e5f984260a4d8f0a62b1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMToxMzo1NFrOGujM6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQxMToxMzo1NFrOGujM6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTQ2NDQyNg==", "bodyText": "can we create a local generic like <T extends LivingEntity> to simplify and guarantee some generics here", "url": "https://github.com/FabricMC/fabric/pull/873#discussion_r451464426", "createdAt": "2020-07-08T11:13:54Z", "author": {"login": "liach"}, "path": "fabric-rendering-v1/src/main/java/net/fabricmc/fabric/api/client/rendering/v1/RegisterFeatureRendererCallback.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.rendering.v1;\n+\n+import java.util.function.Consumer;\n+\n+import net.minecraft.client.render.entity.LivingEntityRenderer;\n+import net.minecraft.client.render.entity.feature.Deadmau5FeatureRenderer;\n+import net.minecraft.client.render.entity.feature.FeatureRenderer;\n+import net.minecraft.client.render.entity.model.EntityModel;\n+import net.minecraft.entity.LivingEntity;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+/**\n+ * Called when {@link FeatureRenderer feature renderers} for a {@link LivingEntityRenderer living entity renderer} are registered.\n+ *\n+ * <p>Feature renderers are typically used for rendering additional objects on an entity, such as armor, an elytra or {@link Deadmau5FeatureRenderer Deadmau5's ears}.\n+ * This callback lets developers add additional feature renderers for use in entity rendering.\n+ * Listeners should filter out the specific entity renderer they want to hook into, usually through {@code instanceof} checks.\n+ * Once listeners find a suitable entity renderer, they should register their feature renderer via the acceptor.\n+ *\n+ * <p>For example, to register a feature renderer for a player model, the example below may used:\n+ * <blockquote><pre>\n+ * RegisterFeatureRendererCallback.EVENT.register((entityRenderer, acceptor) -> {\n+ * \tif (entityRenderer instanceof PlayerEntityModel) {\n+ * \t\tacceptor.accept(new MyFeatureRenderer((PlayerEntityModel) entityRenderer));\n+ * \t}\n+ * });\n+ * </pre></blockquote>\n+ */\n+@FunctionalInterface\n+@Environment(EnvType.CLIENT)\n+public interface RegisterFeatureRendererCallback {\n+\tEvent<RegisterFeatureRendererCallback> EVENT = EventFactory.createArrayBacked(RegisterFeatureRendererCallback.class, callbacks -> (entityRenderer, acceptor) -> {\n+\t\tfor (RegisterFeatureRendererCallback callback : callbacks) {\n+\t\t\tcallback.registerFeatureRenderers(entityRenderer, acceptor);\n+\t\t}\n+\t});\n+\n+\tvoid registerFeatureRenderers(LivingEntityRenderer<? extends LivingEntity, ? extends EntityModel<? extends LivingEntity>> entityRenderer, Consumer<FeatureRenderer<? extends LivingEntity, ? extends EntityModel<? extends LivingEntity>>> acceptor);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d63eef8a7c67660b49d5e5f984260a4d8f0a62b1"}, "originalPosition": 58}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e1c9c314da9fab91f8f409b1bf850e6aaa3e8b5", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/9e1c9c314da9fab91f8f409b1bf850e6aaa3e8b5", "committedDate": "2020-07-08T20:50:19Z", "message": "Add callback to allow registration of feature renderers."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8d51d05c1a2472d92aca1d976c67b091d757d24", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/f8d51d05c1a2472d92aca1d976c67b091d757d24", "committedDate": "2020-07-08T20:50:20Z", "message": "Laymans terms for those who don't map yarn for a living."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "42de8c2287fd24d2134b500caed6fe85c6075fae", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/42de8c2287fd24d2134b500caed6fe85c6075fae", "committedDate": "2020-07-08T20:50:20Z", "message": "Be a little less generic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "88deb88648f81a6e2aa38f1da4a8edbd76d121f1", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/88deb88648f81a6e2aa38f1da4a8edbd76d121f1", "committedDate": "2020-07-08T20:50:20Z", "message": "Dispatch events in a better spot, play with generics again, move to renderer-registries.\n\nAlso move this to render registries"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e33549c6821b9fde79c6e0f29c312a13ecfeca3", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/8e33549c6821b9fde79c6e0f29c312a13ecfeca3", "committedDate": "2020-07-08T20:50:20Z", "message": "Handle players as well"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "12d1cd64a48b2f18e5664358c32ab044ef7ff8a2", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/12d1cd64a48b2f18e5664358c32ab044ef7ff8a2", "committedDate": "2020-07-08T20:43:49Z", "message": "Handle players as well"}, "afterCommit": {"oid": "8e33549c6821b9fde79c6e0f29c312a13ecfeca3", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/8e33549c6821b9fde79c6e0f29c312a13ecfeca3", "committedDate": "2020-07-08T20:50:20Z", "message": "Handle players as well"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbe32c8f418afa6fad315f1251f232507ede48bb", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/cbe32c8f418afa6fad315f1251f232507ede48bb", "committedDate": "2020-07-10T01:10:47Z", "message": "Tweak generics"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MDc5MjQy", "url": "https://github.com/FabricMC/fabric/pull/873#pullrequestreview-446079242", "createdAt": "2020-07-10T02:11:47Z", "commit": {"oid": "cbe32c8f418afa6fad315f1251f232507ede48bb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwMjoxMTo0N1rOGvnmRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xMFQwMjoxMTo0N1rOGvnmRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU4NTAyOA==", "bodyText": "imo you should just make this an interface and the impl creates an instance of FeatureAcceptor when it calls the event instead.", "url": "https://github.com/FabricMC/fabric/pull/873#discussion_r452585028", "createdAt": "2020-07-10T02:11:47Z", "author": {"login": "liach"}, "path": "fabric-renderer-registries-v1/src/main/java/net/fabricmc/fabric/api/client/rendereregistry/v1/RegisterFeatureRendererCallback.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.client.rendereregistry.v1;\n+\n+import java.util.Objects;\n+import java.util.function.Function;\n+\n+import net.minecraft.client.render.entity.LivingEntityRenderer;\n+import net.minecraft.client.render.entity.feature.Deadmau5FeatureRenderer;\n+import net.minecraft.client.render.entity.feature.FeatureRenderer;\n+import net.minecraft.client.render.entity.model.EntityModel;\n+import net.minecraft.entity.EntityType;\n+import net.minecraft.entity.LivingEntity;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.event.Event;\n+import net.fabricmc.fabric.api.event.EventFactory;\n+\n+/**\n+ * Called when {@link FeatureRenderer feature renderers} for a {@link LivingEntityRenderer living entity renderer} are registered.\n+ *\n+ * <p>Feature renderers are typically used for rendering additional objects on an entity, such as armor, an elytra or {@link Deadmau5FeatureRenderer Deadmau5's ears}.\n+ * This callback lets developers add additional feature renderers for use in entity rendering.\n+ * Listeners should filter out the specific entity renderer they want to hook into, usually through {@code instanceof} checks.\n+ * Once listeners find a suitable entity renderer, they should register their feature renderer via the acceptor.\n+ *\n+ * <p>For example, to register a feature renderer for a player model, the example below may used:\n+ * <blockquote><pre>\n+ * RegisterFeatureRendererCallback.EVENT.register((entityType, entityRenderer, acceptor) -> {\n+ * \tif (entityRenderer instanceof PlayerEntityModel) {\n+ * \t\tacceptor.accept(new MyFeatureRenderer((PlayerEntityModel) entityRenderer));\n+ *    }\n+ * });\n+ * </pre></blockquote>\n+ */\n+@FunctionalInterface\n+@Environment(EnvType.CLIENT)\n+public interface RegisterFeatureRendererCallback {\n+\tEvent<RegisterFeatureRendererCallback> EVENT = EventFactory.createArrayBacked(RegisterFeatureRendererCallback.class, callbacks -> (entityType, entityRenderer, acceptor) -> {\n+\t\tfor (RegisterFeatureRendererCallback callback : callbacks) {\n+\t\t\tcallback.registerFeatureRenderers(entityType, entityRenderer, acceptor);\n+\t\t}\n+\t});\n+\n+\t/**\n+\t * Called when feature renderers may be registered.\n+\t *\n+\t * @param entityType     the entity type of the renderer\n+\t * @param entityRenderer the entity renderer\n+\t * @param acceptor       the accepted used to register feature renderers\n+\t */\n+\tvoid registerFeatureRenderers(EntityType<? extends LivingEntity> entityType, LivingEntityRenderer<?, ?> entityRenderer, FeatureAcceptor acceptor);\n+\n+\tfinal class FeatureAcceptor {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbe32c8f418afa6fad315f1251f232507ede48bb"}, "originalPosition": 69}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f0e7e5aee01a7e64434425370fe27424f3e7f54", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/0f0e7e5aee01a7e64434425370fe27424f3e7f54", "committedDate": "2020-07-14T05:44:41Z", "message": "Hide acceptor impl"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MzU2Nzg3", "url": "https://github.com/FabricMC/fabric/pull/873#pullrequestreview-455356787", "createdAt": "2020-07-26T11:44:36Z", "commit": {"oid": "0f0e7e5aee01a7e64434425370fe27424f3e7f54"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMTo0NDozNlrOG3LuHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxMTo0NDozNlrOG3LuHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDUxNjg5Mw==", "bodyText": "Unless im blind I dont see this being added to the test mod json?", "url": "https://github.com/FabricMC/fabric/pull/873#discussion_r460516893", "createdAt": "2020-07-26T11:44:36Z", "author": {"login": "modmuss50"}, "path": "fabric-renderer-registries-v1/src/testmod/java/net/fabricmc/fabric/test/renderer/registry/FeatureRendererTests.java", "diffHunk": "@@ -0,0 +1,117 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.test.renderer.registry;\n+\n+import net.minecraft.client.network.AbstractClientPlayerEntity;\n+import net.minecraft.client.render.VertexConsumerProvider;\n+import net.minecraft.client.render.entity.ArmorStandEntityRenderer;\n+import net.minecraft.client.render.entity.BipedEntityRenderer;\n+import net.minecraft.client.render.entity.LivingEntityRenderer;\n+import net.minecraft.client.render.entity.PlayerEntityRenderer;\n+import net.minecraft.client.render.entity.feature.ElytraFeatureRenderer;\n+import net.minecraft.client.render.entity.feature.FeatureRenderer;\n+import net.minecraft.client.render.entity.feature.FeatureRendererContext;\n+import net.minecraft.client.render.entity.feature.HeldItemFeatureRenderer;\n+import net.minecraft.client.render.entity.model.ArmorStandArmorEntityModel;\n+import net.minecraft.client.render.entity.model.PlayerEntityModel;\n+import net.minecraft.client.util.math.MatrixStack;\n+import net.minecraft.entity.EntityType;\n+import net.minecraft.entity.LivingEntity;\n+import net.minecraft.entity.decoration.ArmorStandEntity;\n+\n+import net.fabricmc.api.ClientModInitializer;\n+import net.fabricmc.fabric.api.client.rendereregistry.v1.RegisterFeatureRendererCallback;\n+\n+public class FeatureRendererTests implements ClientModInitializer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f0e7e5aee01a7e64434425370fe27424f3e7f54"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NDAxNzcy", "url": "https://github.com/FabricMC/fabric/pull/873#pullrequestreview-455401772", "createdAt": "2020-07-26T22:48:30Z", "commit": {"oid": "0f0e7e5aee01a7e64434425370fe27424f3e7f54"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "daa25c37855b465a86e50e71e5ce3b1c0d767e7a", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/daa25c37855b465a86e50e71e5ce3b1c0d767e7a", "committedDate": "2020-07-30T22:56:40Z", "message": "Add actual testmod, fix where player events are fired, Simplify to returning a list."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de8f1f5cb6cc259e7c4fac4e4fd58849b36db03e", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/de8f1f5cb6cc259e7c4fac4e4fd58849b36db03e", "committedDate": "2020-07-30T23:20:59Z", "message": "the old style worked fine"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d717ef118be04cbbc88cfedf1960e138078da41", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/5d717ef118be04cbbc88cfedf1960e138078da41", "committedDate": "2020-07-30T23:24:35Z", "message": "registerRenderers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8376037751cdc5041548b8ab298084eae9923192", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/8376037751cdc5041548b8ab298084eae9923192", "committedDate": "2020-07-30T23:39:15Z", "message": "Rename the event interface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8cfe005401f516cf31bf3fe806d9fb25ef2c5db", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/f8cfe005401f516cf31bf3fe806d9fb25ef2c5db", "committedDate": "2020-07-31T00:29:27Z", "message": "Javadoc fixes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU4ODQ3ODc0", "url": "https://github.com/FabricMC/fabric/pull/873#pullrequestreview-458847874", "createdAt": "2020-07-31T00:29:35Z", "commit": {"oid": "8376037751cdc5041548b8ab298084eae9923192"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NTAyOTQx", "url": "https://github.com/FabricMC/fabric/pull/873#pullrequestreview-459502941", "createdAt": "2020-07-31T22:11:22Z", "commit": {"oid": "f8cfe005401f516cf31bf3fe806d9fb25ef2c5db"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NTEzMjcz", "url": "https://github.com/FabricMC/fabric/pull/873#pullrequestreview-459513273", "createdAt": "2020-07-31T22:47:54Z", "commit": {"oid": "f8cfe005401f516cf31bf3fe806d9fb25ef2c5db"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3169, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}