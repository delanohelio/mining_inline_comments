{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczMzE5NTgx", "number": 1046, "title": "Fix for #987", "bodyText": "This PR fixes a defect that causes Indigo to track in incorrect light face after a transform is applied.\nAs part of the fix, it simplifies geometry tracking generally and also deprecates some public non-API methods that are no longer needed or which should have reduced scope.  The intention is these methods should be removed or changed in the 1.17 cycle. removes or reduces the scope of some non-API methods that are no longer needed or should not be used externally.\nLastly, it exposes an improved fromVanilla method on MutableQuadView that is used in the implementation. This version is more compact and offers better encapsulation and consistency.  The existing method is deprecated and should be removed in the 1.17 cycle.\nThis change has been briefly tested with a modified fork of AE2 to confirm it fixes the reported issue, and also with Exotic Blocks and RenderBender which make extensive use of the API.\nBefore (with modified AE2 fork that removes current hack)\n\nAfter (with same fork)", "createdAt": "2020-08-25T16:24:58Z", "url": "https://github.com/FabricMC/fabric/pull/1046", "merged": true, "mergeCommit": {"oid": "8bcfced859bb9a0acfbc09a65f720a01682e5554"}, "closed": true, "closedAt": "2020-09-03T18:50:27Z", "author": {"login": "grondag"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCZUi0gH2gAyNDczMzE5NTgxOmQ0YmViMGQyZDhhZDgyYTUyNjQ5M2E1N2FjZDRlODVkNjg1Nzg0ZWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdDx_hEAH2gAyNDczMzE5NTgxOmVmMDYxZjJhYzI4MzFkNTBhNDNmZjM0ZGVjNGE4YzZkMTRlZGEyYzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d4beb0d2d8ad82a526493a57acd4e85d685784ea", "author": {"user": {"login": "grondag", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/d4beb0d2d8ad82a526493a57acd4e85d685784ea", "committedDate": "2020-08-25T15:55:09Z", "message": "Fix #987, simplify geometry tracking, clean up scoping"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e343452556a1633e4d3a50117b6439ec737c3f8c", "author": {"user": {"login": "grondag", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/e343452556a1633e4d3a50117b6439ec737c3f8c", "committedDate": "2020-08-25T16:00:21Z", "message": "Bump indigo version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f195f4a741334154566624ea06a829e0f494347", "author": {"user": {"login": "grondag", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/6f195f4a741334154566624ea06a829e0f494347", "committedDate": "2020-08-25T16:22:27Z", "message": "Expose improved fromVanilla method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0NzE4NjY4", "url": "https://github.com/FabricMC/fabric/pull/1046#pullrequestreview-474718668", "createdAt": "2020-08-25T17:50:38Z", "commit": {"oid": "6f195f4a741334154566624ea06a829e0f494347"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0NzMwMDIw", "url": "https://github.com/FabricMC/fabric/pull/1046#pullrequestreview-474730020", "createdAt": "2020-08-25T18:06:28Z", "commit": {"oid": "6f195f4a741334154566624ea06a829e0f494347"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODowNjoyOVrOHGj3-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNVQxODowNjo0NlrOHGj4pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY0MTI3NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t/*\n          \n          \n            \n            \t/**\n          \n      \n    \n    \n  \n\nSince this is a javadoc comment.", "url": "https://github.com/FabricMC/fabric/pull/1046#discussion_r476641275", "createdAt": "2020-08-25T18:06:29Z", "author": {"login": "Juuxel"}, "path": "fabric-renderer-indigo/src/main/java/net/fabricmc/fabric/impl/client/indigo/renderer/mesh/MutableQuadViewImpl.java", "diffHunk": "@@ -81,6 +81,11 @@ public final MutableQuadViewImpl cullFace(Direction face) {\n \t\treturn this;\n \t}\n \n+\t/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f195f4a741334154566624ea06a829e0f494347"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY0MTQ0Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t/*\n          \n          \n            \n            \t/**\n          \n      \n    \n    \n  \n\nSame here.", "url": "https://github.com/FabricMC/fabric/pull/1046#discussion_r476641446", "createdAt": "2020-08-25T18:06:46Z", "author": {"login": "Juuxel"}, "path": "fabric-renderer-indigo/src/main/java/net/fabricmc/fabric/impl/client/indigo/renderer/mesh/MutableQuadViewImpl.java", "diffHunk": "@@ -119,10 +140,15 @@ public MutableQuadViewImpl pos(int vertexIndex, float x, float y, float z) {\n \t\tdata[index] = Float.floatToRawIntBits(x);\n \t\tdata[index + 1] = Float.floatToRawIntBits(y);\n \t\tdata[index + 2] = Float.floatToRawIntBits(z);\n-\t\tisFaceNormalInvalid = true;\n+\t\tisGeometryInvalid = true;\n \t\treturn this;\n \t}\n \n+\t/*", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f195f4a741334154566624ea06a829e0f494347"}, "originalPosition": 65}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74cb893798ce7d6e2a49ee8bfbd374a620726082", "author": {"user": {"login": "grondag", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/74cb893798ce7d6e2a49ee8bfbd374a620726082", "committedDate": "2020-08-25T18:27:04Z", "message": "Strip deprecations in non-API components"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0NzcwOTY1", "url": "https://github.com/FabricMC/fabric/pull/1046#pullrequestreview-474770965", "createdAt": "2020-08-25T19:04:55Z", "commit": {"oid": "74cb893798ce7d6e2a49ee8bfbd374a620726082"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8b2c815ee8b9cd29c51a6cb8f3df713afcb1768", "author": {"user": {"login": "grondag", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/e8b2c815ee8b9cd29c51a6cb8f3df713afcb1768", "committedDate": "2020-08-26T14:31:51Z", "message": "bump renderer api version"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1936457c48f5dc940b1b299bac364e04f18796f", "author": {"user": {"login": "grondag", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/b1936457c48f5dc940b1b299bac364e04f18796f", "committedDate": "2020-08-26T15:25:25Z", "message": "Clear tag for converted quads\n\nOtherwise possible for tags added by transforms to pollute subsequent quads"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1NzQ0OTg1", "url": "https://github.com/FabricMC/fabric/pull/1046#pullrequestreview-475744985", "createdAt": "2020-08-26T18:21:57Z", "commit": {"oid": "b1936457c48f5dc940b1b299bac364e04f18796f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1OTI5MTcz", "url": "https://github.com/FabricMC/fabric/pull/1046#pullrequestreview-475929173", "createdAt": "2020-08-26T22:19:19Z", "commit": {"oid": "b1936457c48f5dc940b1b299bac364e04f18796f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc2OTExMjU3", "url": "https://github.com/FabricMC/fabric/pull/1046#pullrequestreview-476911257", "createdAt": "2020-08-27T16:56:20Z", "commit": {"oid": "b1936457c48f5dc940b1b299bac364e04f18796f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef061f2ac2831d50a43ff34dec4a8c6d14eda2c6", "author": {"user": {"login": "grondag", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/ef061f2ac2831d50a43ff34dec4a8c6d14eda2c6", "committedDate": "2020-08-29T23:13:44Z", "message": "Borrow from Canvas - don't set nominal face twice, prevent header state leakage"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3270, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}