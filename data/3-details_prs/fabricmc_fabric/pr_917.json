{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2MzU3NjIx", "number": 917, "title": "Structures API", "bodyText": "Replaces #687.\nThis PR adds an API to allow for custom structures to be registered, and adds APIs for setting basic behaviour of the structure not already easy to set with the vanilla API (like surface adjusting).\nThis API does not add structures to biomes, as it's easy to do that with the vanilla API.\nThis is the first API module I've added, so apologies for any mistakes with that.\nStill to do:\n\n Documentation\n Test mod", "createdAt": "2020-07-24T15:42:25Z", "url": "https://github.com/FabricMC/fabric/pull/917", "merged": true, "mergeCommit": {"oid": "516ece7c6e17dbf885200ff091674f95f3335e6a"}, "closed": true, "closedAt": "2020-08-21T16:22:58Z", "author": {"login": "Earthcomputer"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc4GN2cABqjM1ODQ1MzQ5Njg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAG6iKAFqTQ2OTQ0NzQyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2eb7ea6eb1fe2129a27434799c7b73fc04f30060", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/2eb7ea6eb1fe2129a27434799c7b73fc04f30060", "committedDate": "2020-07-24T15:34:32Z", "message": "Initial structures API implementation"}, "afterCommit": {"oid": "5c420335788906ac69f63b710763b9c8324dc97a", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/5c420335788906ac69f63b710763b9c8324dc97a", "committedDate": "2020-07-24T16:00:05Z", "message": "Initial structures API implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87a67fb663676473d2b35f984e53f60c87c11177", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/87a67fb663676473d2b35f984e53f60c87c11177", "committedDate": "2020-07-24T17:48:14Z", "message": "Initial structures API implementation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5c420335788906ac69f63b710763b9c8324dc97a", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/5c420335788906ac69f63b710763b9c8324dc97a", "committedDate": "2020-07-24T16:00:05Z", "message": "Initial structures API implementation"}, "afterCommit": {"oid": "87a67fb663676473d2b35f984e53f60c87c11177", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/87a67fb663676473d2b35f984e53f60c87c11177", "committedDate": "2020-07-24T17:48:14Z", "message": "Initial structures API implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/7972ad2361c958335eae3219e293731a9c3409bf", "committedDate": "2020-07-25T14:47:29Z", "message": "Improve generics + add a superflatFeature helper method"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fc69427b4cfb797a686bdd4914a299f2b74b3e43", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/fc69427b4cfb797a686bdd4914a299f2b74b3e43", "committedDate": "2020-07-24T18:05:36Z", "message": "Improve generics + add a superflatFeature helper method"}, "afterCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/7972ad2361c958335eae3219e293731a9c3409bf", "committedDate": "2020-07-25T14:47:29Z", "message": "Improve generics + add a superflatFeature helper method"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mjk2MDM1", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-455296035", "createdAt": "2020-07-25T16:46:24Z", "commit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 19, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQxNjo0NjoyNFrOG3F84A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQxNzowODowOFrOG3GExw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMjM2OA==", "bodyText": "buildAndRegister?", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460422368", "createdAt": "2020-07-25T16:46:24Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tthis.defaultConfig = config;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(int spacing, int separation, int salt) {\n+\t\treturn defaultConfig(new StructureConfig(spacing, separation, salt));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature) {\n+\t\tthis.superflatFeature = superflatFeature;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(FC config) {\n+\t\treturn superflatFeature(structure.configure(config));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> adjustsSurface() {\n+\t\tthis.adjustsSurface = true;\n+\t\treturn this;\n+\t}\n+\n+\tpublic S register() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 81}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMjU4OQ==", "bodyText": "This is fine, but I'd advise Objects.requireNonNull or preconditions.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460422589", "createdAt": "2020-07-25T16:48:59Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tthis.defaultConfig = config;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(int spacing, int separation, int salt) {\n+\t\treturn defaultConfig(new StructureConfig(spacing, separation, salt));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature) {\n+\t\tthis.superflatFeature = superflatFeature;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(FC config) {\n+\t\treturn superflatFeature(structure.configure(config));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> adjustsSurface() {\n+\t\tthis.adjustsSurface = true;\n+\t\treturn this;\n+\t}\n+\n+\tpublic S register() {\n+\t\tif (step == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMjY5OA==", "bodyText": "Validate the parameter to make sure it is non-null (per use in build method)", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460422698", "createdAt": "2020-07-25T16:50:11Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tthis.defaultConfig = config;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMjc1Nw==", "bodyText": "Null check", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460422757", "createdAt": "2020-07-25T16:50:40Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tthis.step = step;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMjk4Ng==", "bodyText": "Assertion errors please. Also specify in message something like Untransformed Accessor or This shouldn't happen", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460422986", "createdAt": "2020-07-25T16:54:07Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/mixin/structure/StructureFeatureAccessor.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.structure;\n+\n+import java.util.List;\n+\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.Mutable;\n+import org.spongepowered.asm.mixin.gen.Accessor;\n+import org.spongepowered.asm.mixin.gen.Invoker;\n+\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+@Mixin(StructureFeature.class)\n+public interface StructureFeatureAccessor {\n+\t@Accessor(\"field_24861\")\n+\t@Mutable\n+\tstatic void setSurfaceAdjustingStructures(List<StructureFeature<?>> surfaceAdjustingStructures) {\n+\t\tthrow new UnsupportedOperationException();\n+\t}\n+\n+\t@Invoker\n+\tstatic <F extends StructureFeature<?>> F callRegister(String name, F structureFeature, GenerationStep.Feature step) {\n+\t\tthrow new UnsupportedOperationException();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzA0Ng==", "bodyText": "Fully capitalized name, this is a static final field.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423046", "createdAt": "2020-07-25T16:54:46Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/impl/structure/FabricStructuresImpl.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.structure;\n+\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.WeakHashMap;\n+\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+\n+public class FabricStructuresImpl {\n+\tpublic static final Set<StructuresConfig> defaultStructuresConfigs = Collections.newSetFromMap(new WeakHashMap<>());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzE1MQ==", "bodyText": "Validate parameters as not null.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423151", "createdAt": "2020-07-25T16:55:35Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzIxMg==", "bodyText": "Javadoc please. Describe what each method in the builder does and which methods are required. I'd advise including a code example in class javadoc to show how to use this builder.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423212", "createdAt": "2020-07-25T16:56:42Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzI0Nw==", "bodyText": "Since constructor is private, I'd make this class final or make the constructor protected.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423247", "createdAt": "2020-07-25T16:57:14Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzIxMg=="}, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzMzNA==", "bodyText": "I have no idea what salt does in this context. Please explain it briefly in javadoc", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423334", "createdAt": "2020-07-25T16:57:59Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tthis.defaultConfig = config;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(int spacing, int separation, int salt) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzQxMQ==", "bodyText": "I assume this feature is used if the generator type is a superflat type. I'd specify that in javadoc so people know what it does.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423411", "createdAt": "2020-07-25T16:59:08Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tthis.defaultConfig = config;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(int spacing, int separation, int salt) {\n+\t\treturn defaultConfig(new StructureConfig(spacing, separation, salt));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzUzMg==", "bodyText": "Assertion error please like the other accessor.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423532", "createdAt": "2020-07-25T17:00:28Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/mixin/structure/FlatChunkGeneratorConfigAccessor.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.structure;\n+\n+import java.util.Map;\n+\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.gen.Accessor;\n+\n+import net.minecraft.world.gen.chunk.FlatChunkGeneratorConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+@Mixin(FlatChunkGeneratorConfig.class)\n+public interface FlatChunkGeneratorConfigAccessor {\n+\t@Accessor(\"STRUCTURE_TO_FEATURES\")\n+\tstatic Map<StructureFeature<?>, ConfiguredStructureFeature<?, ?>> getStructureToFeatures() {\n+\t\tthrow new UnsupportedOperationException();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzcwNQ==", "bodyText": "Is there a vanilla structure builder? If not I may consifer omitting Fabric from the class name, but player and liach may have different opinions about that.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423705", "createdAt": "2020-07-25T17:01:33Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzIxMg=="}, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzgzNw==", "bodyText": "Maybe put getName in quotes like this: \\\"getName\\\"", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423837", "createdAt": "2020-07-25T17:02:42Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tthis.defaultConfig = config;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(int spacing, int separation, int salt) {\n+\t\treturn defaultConfig(new StructureConfig(spacing, separation, salt));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature) {\n+\t\tthis.superflatFeature = superflatFeature;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(FC config) {\n+\t\treturn superflatFeature(structure.configure(config));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> adjustsSurface() {\n+\t\tthis.adjustsSurface = true;\n+\t\treturn this;\n+\t}\n+\n+\tpublic S register() {\n+\t\tif (step == null) {\n+\t\t\tthrow new IllegalStateException(\"Structure \\\"\" + id + \"\\\" is missing a generation step\");\n+\t\t}\n+\n+\t\tif (defaultConfig == null) {\n+\t\t\tthrow new IllegalStateException(\"Structure \\\"\" + id + \"\\\" is missing a default config\");\n+\t\t}\n+\n+\t\tStructureFeatureAccessor.callRegister(id.toString(), structure, step);\n+\n+\t\tif (!id.toString().equals(structure.getName())) {\n+\t\t\t// mods should not be overriding getName, but if they do and it's incorrect, this gives an error\n+\t\t\tthrow new IllegalStateException(\"Structure \" + id + \" has mismatching name \" + structure.getName() + \". Structures should not override getName.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 94}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMzkxMg==", "bodyText": "I assume this is what causes the game to extend the walls of a villager house downwards to fill in air?", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460423912", "createdAt": "2020-07-25T17:03:30Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tthis.defaultConfig = config;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(int spacing, int separation, int salt) {\n+\t\treturn defaultConfig(new StructureConfig(spacing, separation, salt));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature) {\n+\t\tthis.superflatFeature = superflatFeature;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(FC config) {\n+\t\treturn superflatFeature(structure.configure(config));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> adjustsSurface() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyNDA0OA==", "bodyText": "final and a private constructor since this is an impl class and has no real need to be constructed.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460424048", "createdAt": "2020-07-25T17:04:24Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/impl/structure/FabricStructuresImpl.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.structure;\n+\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.WeakHashMap;\n+\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+\n+public class FabricStructuresImpl {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyNDI2Ng==", "bodyText": "I remember modmuss had to add something to biome api since nether chunk generator was initialized before mod init. Maybe validate this isn't called too early before chunk generator type is created?", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460424266", "createdAt": "2020-07-25T17:06:32Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/mixin/structure/MixinChunkGeneratorType.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.structure;\n+\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n+\n+import net.minecraft.world.gen.chunk.ChunkGeneratorType;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+\n+@Mixin(ChunkGeneratorType.class)\n+public class MixinChunkGeneratorType {\n+\t@Inject(method = \"method_30641\", at = @At(\"RETURN\"))\n+\tprivate static void onCreateCavesType(CallbackInfoReturnable<ChunkGeneratorType> cir) {\n+\t\tFabricStructuresImpl.defaultStructuresConfigs.add(cir.getReturnValue().getConfig());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyNDMyMQ==", "bodyText": "Assertion error", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460424321", "createdAt": "2020-07-25T17:07:15Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/mixin/structure/StructuresConfigAccessor.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.structure;\n+\n+import com.google.common.collect.ImmutableMap;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.Mutable;\n+import org.spongepowered.asm.mixin.gen.Accessor;\n+\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+@Mixin(StructuresConfig.class)\n+public interface StructuresConfigAccessor {\n+\t@Mutable\n+\t@Accessor(\"DEFAULT_STRUCTURES\")\n+\tstatic void setDefaultStructures(ImmutableMap<StructureFeature<?>, StructureConfig> defaultStructures) {\n+\t\tthrow new UnsupportedOperationException();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyNDM5MQ==", "bodyText": "Hmm, what does this module use from base api? If it doesn't use anything from it, you can omit this dependency.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460424391", "createdAt": "2020-07-25T17:08:08Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/build.gradle", "diffHunk": "@@ -0,0 +1,6 @@\n+archivesBaseName = \"fabric-structure-api-v1\"\n+version = getSubprojectVersion(project, \"1.0.0\")\n+\n+dependencies {\n+\tcompile(project(path: ':fabric-api-base', configuration: 'dev'))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e7730e8d142b66f5a7b791a213e1e90d9536e01", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/5e7730e8d142b66f5a7b791a213e1e90d9536e01", "committedDate": "2020-07-25T19:17:54Z", "message": "Initialize StructuresConfig class early to prevent its assertion failing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MzI0NDM2", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-455324436", "createdAt": "2020-07-26T01:07:08Z", "commit": {"oid": "5e7730e8d142b66f5a7b791a213e1e90d9536e01"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwMTowNzowOFrOG3IdYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQwMTowODo0N1rOG3Idug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2MzQ1Ng==", "bodyText": "Yes, for these illegal states use objects check", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460463456", "createdAt": "2020-07-26T01:07:08Z", "author": {"login": "liach"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,120 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructuresImpl;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+public class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tthis.defaultConfig = config;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(int spacing, int separation, int salt) {\n+\t\treturn defaultConfig(new StructureConfig(spacing, separation, salt));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature) {\n+\t\tthis.superflatFeature = superflatFeature;\n+\t\treturn this;\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(FC config) {\n+\t\treturn superflatFeature(structure.configure(config));\n+\t}\n+\n+\tpublic FabricStructureBuilder<FC, S> adjustsSurface() {\n+\t\tthis.adjustsSurface = true;\n+\t\treturn this;\n+\t}\n+\n+\tpublic S register() {\n+\t\tif (step == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQyMjU4OQ=="}, "originalCommit": {"oid": "7972ad2361c958335eae3219e293731a9c3409bf"}, "originalPosition": 82}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2MzU0Ng==", "bodyText": "Hmm, this Impl sounds like this is implementing an interface while this is not. Maybe FabricStructureUtil?", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460463546", "createdAt": "2020-07-26T01:08:47Z", "author": {"login": "liach"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/impl/structure/FabricStructuresImpl.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.structure;\n+\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.WeakHashMap;\n+\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+\n+public class FabricStructuresImpl {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5e7730e8d142b66f5a7b791a213e1e90d9536e01"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5cb276b808dcefcaa2f12d43d22ca9f4d66f2d58", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/5cb276b808dcefcaa2f12d43d22ca9f4d66f2d58", "committedDate": "2020-07-26T11:28:32Z", "message": "Add a testmod"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8b75a5dd30a4409e997680e5e971abecf8a8779", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/e8b75a5dd30a4409e997680e5e971abecf8a8779", "committedDate": "2020-07-26T16:03:45Z", "message": "Documentation and null assertions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4d4a3f674a2ea90c753bef7ef83e3d0e39f8e6a2", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/4d4a3f674a2ea90c753bef7ef83e3d0e39f8e6a2", "committedDate": "2020-07-26T16:24:46Z", "message": "Apply review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mzc4MjI3", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-455378227", "createdAt": "2020-07-26T16:32:45Z", "commit": {"oid": "4d4a3f674a2ea90c753bef7ef83e3d0e39f8e6a2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjozMjo0NVrOG3NlAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjozMjo0NVrOG3NlAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0NzMzMQ==", "bodyText": "Unless I missed something, I think the arguments are missing here:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * FabricStructureBuilder.create()\n          \n          \n            \n             * FabricStructureBuilder.create(new Identifier(\"mymod:mystructure\"), structure)", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460547331", "createdAt": "2020-07-26T16:32:45Z", "author": {"login": "shartte"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import java.util.Objects;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructureUtil;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+/**\n+ * A builder for registering custom structures.\n+ *\n+ * <p>Example usage:\n+ * <pre>{@code\n+ * StructureFeature structure = new MyStructure(DefaultFeatureConfig.CODEC);\n+ * ConfiguredStructureFeature<DefaultFeatureConfig, ? extends StructureFeature<DefaultFeatureConfig>> configuredStructure\n+ *     = structure.configure(new DefaultFeatureConfig());\n+ * FabricStructureBuilder.create()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4d4a3f674a2ea90c753bef7ef83e3d0e39f8e6a2"}, "originalPosition": 46}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/d28978bb9ae2b90993bd991bff9d5aededd28882", "committedDate": "2020-07-26T16:34:11Z", "message": "Update fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java\n\nCo-authored-by: shartte <shartte@users.noreply.github.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mzc4NTc1", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-455378575", "createdAt": "2020-07-26T16:38:06Z", "commit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjozODowNlrOG3NnFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjozODowNlrOG3NnFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0Nzg2Mw==", "bodyText": "I think the description here was flipped.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * @param spacing The minimum distance between 2 structures of this type.\n          \n          \n            \n            \t * @param separation The average distance between 2 structures of this type along the X and Z axes.\n          \n          \n            \n            \t * @param spacing The average distance between 2 structures of this type along the X and Z axes in chunks.\n          \n          \n            \n            \t * @param separation The minimum distance between 2 structures of this type in chunks. Must be less than spacing.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460547863", "createdAt": "2020-07-26T16:38:06Z", "author": {"login": "shartte"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import java.util.Objects;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructureUtil;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+/**\n+ * A builder for registering custom structures.\n+ *\n+ * <p>Example usage:\n+ * <pre>{@code\n+ * StructureFeature structure = new MyStructure(DefaultFeatureConfig.CODEC);\n+ * ConfiguredStructureFeature<DefaultFeatureConfig, ? extends StructureFeature<DefaultFeatureConfig>> configuredStructure\n+ *     = structure.configure(new DefaultFeatureConfig());\n+ * FabricStructureBuilder.create(new Identifier(\"mymod:mystructure\"), structure)\n+ *     .step(GenerationStep.Feature.SURFACE_STRUCTURES) // required\n+ *     .defaultConfig(32, 8, 12345) // required\n+ *     .superflatFeature(configuredStructure)\n+ *     .register();}\n+ * </pre></p>\n+ *\n+ * <p>This class does <i>not</i> add structures to biomes for you, you have to do that yourself. You may also need to\n+ * register custom structure pieces yourself.</p>\n+ */\n+public final class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\t/**\n+\t * Creates a new {@code FabricStructureBuilder} for registering a structure.\n+\t *\n+\t * @param id The structure ID.\n+\t * @param structure The {@linkplain StructureFeature} you want to register.\n+\t */\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\tObjects.requireNonNull(id, \"id must not be null\");\n+\t\tObjects.requireNonNull(structure, \"structure must not be null\");\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\t/**\n+\t * Sets the generation step of this structure. The generation step specifies when the structure is generated, to\n+\t * ensure they are generated in the correct order to reduce the amount of floating blocks.\n+\t *\n+\t * <p>The most commonly used values for structures are {@linkplain GenerationStep.Feature#SURFACE_STRUCTURES} and\n+\t * {@linkplain GenerationStep.Feature#UNDERGROUND_STRUCTURES}, however technically any value in the\n+\t * {@linkplain GenerationStep.Feature} enum may be used.</p>\n+\t *\n+\t * <p>This is a required option.</p>\n+\t */\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tObjects.requireNonNull(step, \"step must not be null\");\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\t/**\n+\t * Sets the default {@linkplain StructureConfig} for this structure. See the alternative\n+\t * {@linkplain #defaultConfig(int, int, int)} for details.\n+\t *\n+\t * <p>This is a required option.</p>\n+\t */\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tObjects.requireNonNull(config, \"config must not be null\");\n+\t\tthis.defaultConfig = config;\n+\t\treturn this;\n+\t}\n+\n+\t/**\n+\t * Sets the default {@linkplain StructureConfig} for this structure. This sets the default configuration of where in\n+\t * the world to place structures.\n+\t *\n+\t * <p>Note: the {@code spacing} and {@code separation} options are subject to other checks for whether the structure\n+\t * can spawn, such as biome. If these checks always pass and the structure can spawn in every biome, then the\n+\t * description of these values below would be exactly correct.</p>\n+\t *\n+\t * <p>This is a required option. Vanilla needs it to function.</p>\n+\t *\n+\t * @param spacing The minimum distance between 2 structures of this type.\n+\t * @param separation The average distance between 2 structures of this type along the X and Z axes.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "originalPosition": 120}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mzc4ODEz", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-455378813", "createdAt": "2020-07-26T16:41:53Z", "commit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjo0MTo1M1rOG3Nokw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjo0MTo1M1rOG3Nokw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0ODI0Mw==", "bodyText": "Feel free to ignore this one\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t// update existing structure configs\n          \n          \n            \n            \t\t// update existing sets of structure configs", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460548243", "createdAt": "2020-07-26T16:41:53Z", "author": {"login": "shartte"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/api/structure/v1/FabricStructureBuilder.java", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.structure.v1;\n+\n+import java.util.Objects;\n+\n+import com.google.common.collect.ImmutableList;\n+import com.google.common.collect.ImmutableMap;\n+\n+import net.minecraft.util.Identifier;\n+import net.minecraft.world.gen.GenerationStep;\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.ConfiguredStructureFeature;\n+import net.minecraft.world.gen.feature.FeatureConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructureUtil;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+import net.fabricmc.fabric.mixin.structure.FlatChunkGeneratorConfigAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructureFeatureAccessor;\n+import net.fabricmc.fabric.mixin.structure.StructuresConfigAccessor;\n+\n+/**\n+ * A builder for registering custom structures.\n+ *\n+ * <p>Example usage:\n+ * <pre>{@code\n+ * StructureFeature structure = new MyStructure(DefaultFeatureConfig.CODEC);\n+ * ConfiguredStructureFeature<DefaultFeatureConfig, ? extends StructureFeature<DefaultFeatureConfig>> configuredStructure\n+ *     = structure.configure(new DefaultFeatureConfig());\n+ * FabricStructureBuilder.create(new Identifier(\"mymod:mystructure\"), structure)\n+ *     .step(GenerationStep.Feature.SURFACE_STRUCTURES) // required\n+ *     .defaultConfig(32, 8, 12345) // required\n+ *     .superflatFeature(configuredStructure)\n+ *     .register();}\n+ * </pre></p>\n+ *\n+ * <p>This class does <i>not</i> add structures to biomes for you, you have to do that yourself. You may also need to\n+ * register custom structure pieces yourself.</p>\n+ */\n+public final class FabricStructureBuilder<FC extends FeatureConfig, S extends StructureFeature<FC>> {\n+\tprivate final Identifier id;\n+\tprivate final S structure;\n+\tprivate GenerationStep.Feature step;\n+\tprivate StructureConfig defaultConfig;\n+\tprivate ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature;\n+\tprivate boolean adjustsSurface = false;\n+\n+\tprivate FabricStructureBuilder(Identifier id, S structure) {\n+\t\tthis.id = id;\n+\t\tthis.structure = structure;\n+\t}\n+\n+\t/**\n+\t * Creates a new {@code FabricStructureBuilder} for registering a structure.\n+\t *\n+\t * @param id The structure ID.\n+\t * @param structure The {@linkplain StructureFeature} you want to register.\n+\t */\n+\tpublic static <FC extends FeatureConfig, S extends StructureFeature<FC>> FabricStructureBuilder<FC, S> create(Identifier id, S structure) {\n+\t\tObjects.requireNonNull(id, \"id must not be null\");\n+\t\tObjects.requireNonNull(structure, \"structure must not be null\");\n+\t\treturn new FabricStructureBuilder<>(id, structure);\n+\t}\n+\n+\t/**\n+\t * Sets the generation step of this structure. The generation step specifies when the structure is generated, to\n+\t * ensure they are generated in the correct order to reduce the amount of floating blocks.\n+\t *\n+\t * <p>The most commonly used values for structures are {@linkplain GenerationStep.Feature#SURFACE_STRUCTURES} and\n+\t * {@linkplain GenerationStep.Feature#UNDERGROUND_STRUCTURES}, however technically any value in the\n+\t * {@linkplain GenerationStep.Feature} enum may be used.</p>\n+\t *\n+\t * <p>This is a required option.</p>\n+\t */\n+\tpublic FabricStructureBuilder<FC, S> step(GenerationStep.Feature step) {\n+\t\tObjects.requireNonNull(step, \"step must not be null\");\n+\t\tthis.step = step;\n+\t\treturn this;\n+\t}\n+\n+\t/**\n+\t * Sets the default {@linkplain StructureConfig} for this structure. See the alternative\n+\t * {@linkplain #defaultConfig(int, int, int)} for details.\n+\t *\n+\t * <p>This is a required option.</p>\n+\t */\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(StructureConfig config) {\n+\t\tObjects.requireNonNull(config, \"config must not be null\");\n+\t\tthis.defaultConfig = config;\n+\t\treturn this;\n+\t}\n+\n+\t/**\n+\t * Sets the default {@linkplain StructureConfig} for this structure. This sets the default configuration of where in\n+\t * the world to place structures.\n+\t *\n+\t * <p>Note: the {@code spacing} and {@code separation} options are subject to other checks for whether the structure\n+\t * can spawn, such as biome. If these checks always pass and the structure can spawn in every biome, then the\n+\t * description of these values below would be exactly correct.</p>\n+\t *\n+\t * <p>This is a required option. Vanilla needs it to function.</p>\n+\t *\n+\t * @param spacing The minimum distance between 2 structures of this type.\n+\t * @param separation The average distance between 2 structures of this type along the X and Z axes.\n+\t * @param salt The random salt of the structure. This does not affect how common the structure is, but every\n+\t *                structure must have an unique {@code salt} in order to spawn in different places.\n+\t *\n+\t * @see #defaultConfig(StructureConfig)\n+\t */\n+\tpublic FabricStructureBuilder<FC, S> defaultConfig(int spacing, int separation, int salt) {\n+\t\treturn defaultConfig(new StructureConfig(spacing, separation, salt));\n+\t}\n+\n+\t/**\n+\t * Sets the structure configuration which spawns in superflat worlds. If unset, this structure will not spawn in\n+\t * superflat worlds.\n+\t *\n+\t * @see #superflatFeature(FeatureConfig)\n+\t */\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(ConfiguredStructureFeature<FC, ? extends StructureFeature<FC>> superflatFeature) {\n+\t\tObjects.requireNonNull(superflatFeature, \"superflatFeature must not be null\");\n+\t\tthis.superflatFeature = superflatFeature;\n+\t\treturn this;\n+\t}\n+\n+\t/**\n+\t * Sets the structure configuration which spawns in superflat worlds. If unset, this structure will not spawn in\n+\t * superflat worlds.\n+\t *\n+\t * @see #superflatFeature(ConfiguredStructureFeature)\n+\t */\n+\tpublic FabricStructureBuilder<FC, S> superflatFeature(FC config) {\n+\t\treturn superflatFeature(structure.configure(config));\n+\t}\n+\n+\t/**\n+\t * Causes structure pieces of this structure to adjust the surface of the world to fit them, so that they don't\n+\t * stick out of or into the ground.\n+\t */\n+\tpublic FabricStructureBuilder<FC, S> adjustsSurface() {\n+\t\tthis.adjustsSurface = true;\n+\t\treturn this;\n+\t}\n+\n+\t/**\n+\t * Registers this structure and applies the other changes from the {@linkplain FabricStructureBuilder}.\n+\t */\n+\tpublic S register() {\n+\t\tObjects.requireNonNull(step, \"Structure \\\"\" + id + \"\\\" is missing a generation step\");\n+\t\tObjects.requireNonNull(defaultConfig, \"Structure \\\"\" + id + \"\\\" is missing a default config\");\n+\n+\t\t// Ensure StructuresConfig class is initialized, so the assertion in its static {} block doesn't fail\n+\t\tStructuresConfig.DEFAULT_STRUCTURES.size();\n+\n+\t\tStructureFeatureAccessor.callRegister(id.toString(), structure, step);\n+\n+\t\tif (!id.toString().equals(structure.getName())) {\n+\t\t\t// mods should not be overriding getName, but if they do and it's incorrect, this gives an error\n+\t\t\tthrow new IllegalStateException(String.format(\"Structure \\\"%s\\\" has mismatching name \\\"%s\\\". Structures should not override \\\"getName\\\".\", id, structure.getName()));\n+\t\t}\n+\n+\t\tStructuresConfigAccessor.setDefaultStructures(ImmutableMap.<StructureFeature<?>, StructureConfig>builder()\n+\t\t\t\t.putAll(StructuresConfig.DEFAULT_STRUCTURES)\n+\t\t\t\t.put(structure, defaultConfig)\n+\t\t\t\t.build());\n+\n+\t\tif (superflatFeature != null) {\n+\t\t\tFlatChunkGeneratorConfigAccessor.getStructureToFeatures().put(structure, superflatFeature);\n+\t\t}\n+\n+\t\tif (adjustsSurface) {\n+\t\t\tStructureFeatureAccessor.setSurfaceAdjustingStructures(ImmutableList.<StructureFeature<?>>builder()\n+\t\t\t\t\t.addAll(StructureFeature.field_24861)\n+\t\t\t\t\t.add(structure)\n+\t\t\t\t\t.build());\n+\t\t}\n+\n+\t\t// update existing structure configs", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "originalPosition": 194}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mzc4OTU1", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-455378955", "createdAt": "2020-07-26T16:44:21Z", "commit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjo0NDoyMVrOG3NpZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjo0NDoyMVrOG3NpZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0ODQ1Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tpublic static final Set<StructuresConfig> DEFAULT_STRUCTURES_CONFIGS = Collections.newSetFromMap(new WeakHashMap<>());\n          \n          \n            \n            \t// This tracks all StructuresConfig objects that have been created with the default set of structures\n          \n          \n            \n            \t// in order to add mod-created structures that are registered later\n          \n          \n            \n            \tpublic static final Set<StructuresConfig> DEFAULT_STRUCTURES_CONFIGS = Collections.newSetFromMap(new WeakHashMap<>());", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460548452", "createdAt": "2020-07-26T16:44:21Z", "author": {"login": "shartte"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/impl/structure/FabricStructureUtil.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.structure;\n+\n+import java.util.Collections;\n+import java.util.Set;\n+import java.util.WeakHashMap;\n+\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+\n+public final class FabricStructureUtil {\n+\tprivate FabricStructureUtil() { }\n+\n+\tpublic static final Set<StructuresConfig> DEFAULT_STRUCTURES_CONFIGS = Collections.newSetFromMap(new WeakHashMap<>());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mzc5MTQ5", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-455379149", "createdAt": "2020-07-26T16:47:21Z", "commit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjo0NzoyMlrOG3NqnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNjo0NzoyMlrOG3NqnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0ODc2NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t@Inject(method = \"<init>(Z)V\", at = @At(\"RETURN\"))\n          \n          \n            \n            \t// This constructor of StructuresConfig initializes it with the default set of structures.\n          \n          \n            \n            \t// Since a mod can register its structures later, we need to keep track of the object created\n          \n          \n            \n            \t// here, so that we can add new structures to it later.\n          \n          \n            \n            \t@Inject(method = \"<init>(Z)V\", at = @At(\"RETURN\"))", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r460548765", "createdAt": "2020-07-26T16:47:22Z", "author": {"login": "shartte"}, "path": "fabric-structure-api-v1/src/main/java/net/fabricmc/fabric/mixin/structure/MixinStructuresConfig.java", "diffHunk": "@@ -0,0 +1,50 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.structure;\n+\n+import java.util.Map;\n+\n+import org.spongepowered.asm.mixin.Final;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.Shadow;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n+\n+import net.minecraft.world.gen.chunk.StructureConfig;\n+import net.minecraft.world.gen.chunk.StructuresConfig;\n+import net.minecraft.world.gen.feature.StructureFeature;\n+\n+import net.fabricmc.fabric.impl.structure.FabricStructureUtil;\n+import net.fabricmc.fabric.impl.structure.StructuresConfigHooks;\n+\n+@Mixin(StructuresConfig.class)\n+public class MixinStructuresConfig implements StructuresConfigHooks {\n+\t@Shadow\n+\t@Final\n+\tprivate Map<StructureFeature<?>, StructureConfig> structures;\n+\n+\t@Inject(method = \"<init>(Z)V\", at = @At(\"RETURN\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "originalPosition": 41}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1Mzc5NjA5", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-455379609", "createdAt": "2020-07-26T16:54:07Z", "commit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1NDAxNTY5", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-455401569", "createdAt": "2020-07-26T22:44:39Z", "commit": {"oid": "d28978bb9ae2b90993bd991bff9d5aededd28882"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47f5012b7b4c7122636cd8381b1370da3feaceb0", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/47f5012b7b4c7122636cd8381b1370da3feaceb0", "committedDate": "2020-08-02T07:53:30Z", "message": "Apply review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5NjUyMzA2", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-459652306", "createdAt": "2020-08-02T14:14:44Z", "commit": {"oid": "47f5012b7b4c7122636cd8381b1370da3feaceb0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5Njc3MTc5", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-459677179", "createdAt": "2020-08-02T20:41:30Z", "commit": {"oid": "47f5012b7b4c7122636cd8381b1370da3feaceb0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NDk1ODE4", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-465495818", "createdAt": "2020-08-11T23:31:42Z", "commit": {"oid": "47f5012b7b4c7122636cd8381b1370da3feaceb0"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQyMzozMTo0MlrOG_Mrow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQyMzozMTo0MlrOG_Mrow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkyMTI1MQ==", "bodyText": "Hopefully modmuss's biome pr will remove the need for this.", "url": "https://github.com/FabricMC/fabric/pull/917#discussion_r468921251", "createdAt": "2020-08-11T23:31:42Z", "author": {"login": "i509VCB"}, "path": "fabric-structure-api-v1/src/testmod/java/net/fabricmc/fabric/test/structure/mixin/MixinDefaultBiomeCreator.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.test.structure.mixin;\n+\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;\n+\n+import net.minecraft.world.biome.Biome;\n+import net.minecraft.world.biome.DefaultBiomeCreator;\n+\n+import net.fabricmc.fabric.test.structure.StructureTest;\n+\n+@Mixin(DefaultBiomeCreator.class)\n+public class MixinDefaultBiomeCreator {\n+\t@Inject(method = \"createPlains\", at = @At(\"RETURN\"))\n+\tprivate static void addCustomStructure(String parent, boolean sunflower, CallbackInfoReturnable<Biome> cir) {\n+\t\tif (!sunflower) {\n+\t\t\tcir.getReturnValue().addStructureFeature(StructureTest.CONFIGURED_STRUCTURE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "47f5012b7b4c7122636cd8381b1370da3feaceb0"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NTQzMTQz", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-465543143", "createdAt": "2020-08-12T02:04:45Z", "commit": {"oid": "47f5012b7b4c7122636cd8381b1370da3feaceb0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NjUwMjA3", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-465650207", "createdAt": "2020-08-12T07:18:19Z", "commit": {"oid": "47f5012b7b4c7122636cd8381b1370da3feaceb0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fee7a3e0c0623f7633924febab4e05c75d774bed", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/fee7a3e0c0623f7633924febab4e05c75d774bed", "committedDate": "2020-08-15T14:31:37Z", "message": "Merge branch '1.16' into feature/structures"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1900725fdaaa1c79782db8b5005f408fa24ae108", "author": {"user": {"login": "Earthcomputer", "name": "Joseph Burton"}}, "url": "https://github.com/FabricMC/fabric/commit/1900725fdaaa1c79782db8b5005f408fa24ae108", "committedDate": "2020-08-15T14:51:39Z", "message": "Update to 1.16.2"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4MDA5MTky", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-468009192", "createdAt": "2020-08-15T18:10:29Z", "commit": {"oid": "1900725fdaaa1c79782db8b5005f408fa24ae108"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NDQ3NDI5", "url": "https://github.com/FabricMC/fabric/pull/917#pullrequestreview-469447429", "createdAt": "2020-08-18T13:20:36Z", "commit": {"oid": "1900725fdaaa1c79782db8b5005f408fa24ae108"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3183, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}