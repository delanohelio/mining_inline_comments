{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyOTU5MDI0", "number": 641, "title": "Create Game Rule API", "bodyText": "Allows mods to register gamerules.\nIncludes support for the following rule types:\nInteger (vanilla), Double and Float. All of these can have bounded values.\nBoolean (vanilla).\nEnum rule. Can be made to only support certain enum constants. Will appear as literals in the command, so it isn't possible to enter invalid values.\nAlso allows custom rules to use the new Edit GameRules screen added in 1.16.\nAnd the ability to register custom rule categories without any enum asm hackery. Including colored categories.\nThanks to @Hephaestus-Dev (Haven) for the logic to allow custom rule categories.\nSupersedes #283", "createdAt": "2020-05-26T02:50:08Z", "url": "https://github.com/FabricMC/fabric/pull/641", "merged": true, "mergeCommit": {"oid": "d532d74b8374fef45e8bb5451f49302ea6015e0d"}, "closed": true, "closedAt": "2020-07-24T15:25:11Z", "author": {"login": "i509VCB"}, "timelineItems": {"totalCount": 55, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABck-muVAFqTQxNzk5NTg1OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3hPPjAH2gAyNDIyOTU5MDI0OjY0MWFjODQ4ODE4ZWU2MGU4OWIyMDhmZDAzMzlmZDk5OTRmZjk1ZTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3OTk1ODU5", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-417995859", "createdAt": "2020-05-26T06:14:49Z", "commit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNjoxNDo0OVrOGaP7Sw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwNjoyMDozOVrOGaQDXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE3NzA5OQ==", "bodyText": "This shouldn't exist, should just use MinecraftClient.getInstance()", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430177099", "createdAt": "2020-05-26T06:14:49Z", "author": {"login": "shedaniel"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/client/ScreenAccessor.java", "diffHunk": "@@ -0,0 +1,29 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.gamerule.client;\n+\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.gen.Accessor;\n+\n+import net.minecraft.client.MinecraftClient;\n+import net.minecraft.client.gui.screen.Screen;\n+\n+@Mixin(Screen.class)\n+public interface ScreenAccessor {\n+\t@Accessor(\"client\")\n+\tMinecraftClient getClient();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE3OTE2NA==", "bodyText": "Should this be fabric-game-rule-api-v1 or fabric-gamerule-api-v1?\nReferring to #575", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430179164", "createdAt": "2020-05-26T06:20:39Z", "author": {"login": "shedaniel"}, "path": "fabric-gamerule-api-v1/build.gradle", "diffHunk": "@@ -0,0 +1,16 @@\n+archivesBaseName = \"fabric-gamerule-api-v1\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MTE2MzU0", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-418116354", "createdAt": "2020-05-26T09:17:08Z", "commit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOToxNzowOVrOGaVs-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOToxNzowOVrOGaVs-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3MTczOA==", "bodyText": "Why is there no getter here?", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430271738", "createdAt": "2020-05-26T09:17:09Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/CustomGameRuleCategory.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1;\n+\n+import net.minecraft.text.Text;\n+import net.minecraft.util.Identifier;\n+\n+/**\n+ * Utility class for registering GameRule objects with custom categories outside of the categories Minecraft provides.\n+ */\n+public final class CustomGameRuleCategory {\n+\tpublic static CustomGameRuleCategory of(Identifier id, Text name) {\n+\t\treturn new CustomGameRuleCategory(id, name);\n+\t}\n+\n+\tprivate final Identifier id;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 30}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MTE3NDMx", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-418117431", "createdAt": "2020-05-26T09:18:34Z", "commit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOToxODozNFrOGaVwWA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOToyNzozMlrOGaWFaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3MjYwMA==", "bodyText": "Why is this needed? RuleTypeConsumer is generic, it supports any rule implementations", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430272600", "createdAt": "2020-05-26T09:18:34Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/FabricRuleTypeConsumer.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1;\n+\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.rule.DoubleRule;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.EnumRule;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.FloatRule;\n+\n+/**\n+ * An extended RuleTypeConsumer which supports fabric's own rule types.\n+ */\n+public interface FabricRuleTypeConsumer extends GameRules.RuleTypeConsumer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3Mjk0NA==", "bodyText": "Invokers with return values should use call not invoke imo", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430272944", "createdAt": "2020-05-26T09:19:13Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/GameRuleRegistry.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1;\n+\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.impl.gamerule.RuleKeyInternals;\n+import net.fabricmc.fabric.mixin.gamerule.GameRulesAccessor;\n+\n+public final class GameRuleRegistry {\n+\tprivate GameRuleRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a {@link GameRules.Rule}.\n+\t *\n+\t * @param name   the name of the rule\n+\t * @param category the category of this rule\n+\t * @param type the rule type\n+\t * @param <T>  the type of rule\n+\t * @return a rule key which can be used to query the value of the rule\n+\t * @throws IllegalStateException if a rule of the same name already exists\n+\t */\n+\tpublic static <T extends GameRules.Rule<T>> GameRules.RuleKey<T> register(String name, GameRules.RuleCategory category, GameRules.RuleType<T> type) {\n+\t\treturn GameRulesAccessor.invokeRegister(name, category, type);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3MzMwOQ==", "bodyText": "exists/isRegistered?", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430273309", "createdAt": "2020-05-26T09:19:52Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/GameRuleRegistry.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1;\n+\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.impl.gamerule.RuleKeyInternals;\n+import net.fabricmc.fabric.mixin.gamerule.GameRulesAccessor;\n+\n+public final class GameRuleRegistry {\n+\tprivate GameRuleRegistry() {\n+\t}\n+\n+\t/**\n+\t * Registers a {@link GameRules.Rule}.\n+\t *\n+\t * @param name   the name of the rule\n+\t * @param category the category of this rule\n+\t * @param type the rule type\n+\t * @param <T>  the type of rule\n+\t * @return a rule key which can be used to query the value of the rule\n+\t * @throws IllegalStateException if a rule of the same name already exists\n+\t */\n+\tpublic static <T extends GameRules.Rule<T>> GameRules.RuleKey<T> register(String name, GameRules.RuleCategory category, GameRules.RuleType<T> type) {\n+\t\treturn GameRulesAccessor.invokeRegister(name, category, type);\n+\t}\n+\n+\t/**\n+\t * Registers a {@link GameRules.Rule} with a custom category.\n+\t *\n+\t * @param name \tthe name of the rule\n+\t * @param category the category of this rule\n+\t * @param type the rule type\n+\t * @param <T>  the type of rule\n+\t * @return a rule key which can be used to query the value of the rule\n+\t * @throws IllegalStateException if a rule of the same name already exists\n+\t */\n+\tpublic static <T extends GameRules.Rule<T>> GameRules.RuleKey<T> register(String name, CustomGameRuleCategory category, GameRules.RuleType<T> type) {\n+\t\tfinal GameRules.RuleKey<T> key = GameRulesAccessor.invokeRegister(name, GameRules.RuleCategory.MISC, type);\n+\t\t((RuleKeyInternals) (Object) key).fabric_setCustomCategory(category);\n+\t\treturn key;\n+\t}\n+\n+\t/**\n+\t * Checks if a name for a rule is already being used.\n+\t *\n+\t * @param ruleName the rule name to test\n+\t * @return true if the name is taken.\n+\t */\n+\tpublic static boolean isRuleNameUsed(String ruleName) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 64}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3Mzg2Ng==", "bodyText": "Missing command result", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430273866", "createdAt": "2020-05-26T09:20:45Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/DoubleRule.java", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public class DoubleRule extends GameRules.Rule<DoubleRule> implements ValidateableRule {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final double lowerBound;\n+\tprivate final double upperBound;\n+\tprivate double value;\n+\n+\t@Deprecated\n+\tpublic DoubleRule(GameRules.RuleType<DoubleRule> type, double value, double lowerBound, double upperBound) {\n+\t\tsuper(type);\n+\t\tthis.value = value;\n+\t\tthis.lowerBound = lowerBound;\n+\t\tthis.upperBound = upperBound;\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\tthis.value = context.getArgument(name, Double.class);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\tfinal double d = DoubleRule.parseDouble(value);\n+\n+\t\tif (this.lowerBound > d || this.upperBound < d) {\n+\t\t\tLOGGER.warn(\"Failed to parse double {}. Was out of bounds {} - {}\", value, this.lowerBound, this.upperBound);\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tthis.value = d;\n+\t}\n+\n+\tprivate static double parseDouble(String string) {\n+\t\tif (!string.isEmpty()) {\n+\t\t\ttry {\n+\t\t\t\treturn Double.parseDouble(string);\n+\t\t\t} catch (NumberFormatException e) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse double {}\", string);\n+\t\t\t}\n+\t\t}\n+\n+\t\treturn 0.0D;\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn Double.toString(this.value);\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\treturn 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3NDA2OQ==", "bodyText": "Missing command result", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430274069", "createdAt": "2020-05-26T09:21:06Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,154 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public class EnumRule<E extends Enum<E>> extends LiteralRule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprotected final Collection<E> supportedValues;\n+\tprotected E value;\n+\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.RuleType<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.RuleType<EnumRule<E>> type, E value, Collection<E> supportedValues) {\n+\t\tsuper(type);\n+\t\tthis.classType = value.getDeclaringClass();\n+\t\tthis.value = value;\n+\t\tthis.supportedValues = Collections.unmodifiableCollection(supportedValues);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\ttry {\n+\t\t\tfinal E deserialized = Enum.valueOf(this.classType, value);\n+\n+\t\t\tif (!this.supports(deserialized)) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}. Since the value {}, is unsupported.\", value, this.classType, value);\n+\t\t\t}\n+\n+\t\t\tthis.set(deserialized, null);\n+\t\t} catch (IllegalArgumentException e) {\n+\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}\", value, this.classType);\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn this.value.name();\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\treturn 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 76}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3NDM3OA==", "bodyText": "What is the purpose of this? Why does it need to be part of this object?", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430274378", "createdAt": "2020-05-26T09:21:35Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,154 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public class EnumRule<E extends Enum<E>> extends LiteralRule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprotected final Collection<E> supportedValues;\n+\tprotected E value;\n+\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.RuleType<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.RuleType<EnumRule<E>> type, E value, Collection<E> supportedValues) {\n+\t\tsuper(type);\n+\t\tthis.classType = value.getDeclaringClass();\n+\t\tthis.value = value;\n+\t\tthis.supportedValues = Collections.unmodifiableCollection(supportedValues);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\ttry {\n+\t\t\tfinal E deserialized = Enum.valueOf(this.classType, value);\n+\n+\t\t\tif (!this.supports(deserialized)) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}. Since the value {}, is unsupported.\", value, this.classType, value);\n+\t\t\t}\n+\n+\t\t\tthis.set(deserialized, null);\n+\t\t} catch (IllegalArgumentException e) {\n+\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}\", value, this.classType);\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn this.value.name();\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\treturn 0;\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> getThis() {\n+\t\treturn this;\n+\t}\n+\n+\tpublic Class<E> getEnumClass() {\n+\t\treturn this.classType;\n+\t}\n+\n+\t@Override\n+\tpublic String toString() {\n+\t\treturn this.value.toString();\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> copy() {\n+\t\treturn new EnumRule<E>(this.type, this.value, this.supportedValues);\n+\t}\n+\n+\t@Override\n+\tpublic void setValue(EnumRule<E> rule, MinecraftServer minecraftServer) {\n+\t\tthis.value = rule.value;\n+\t\tthis.changed(minecraftServer);\n+\t}\n+\n+\tpublic E get() {\n+\t\treturn this.value;\n+\t}\n+\n+\tpublic E cycle(E start) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 108}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3NDc2MQ==", "bodyText": "Missing command result", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430274761", "createdAt": "2020-05-26T09:22:13Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/FloatRule.java", "diffHunk": "@@ -0,0 +1,113 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public class FloatRule extends GameRules.Rule<FloatRule> implements ValidateableRule {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final float lowerBound;\n+\tprivate final float upperBound;\n+\tprivate float value;\n+\n+\t@Deprecated\n+\tpublic FloatRule(GameRules.RuleType<FloatRule> type, float value, float lowerBound, float upperBound) {\n+\t\tsuper(type);\n+\t\tthis.value = value;\n+\t\tthis.lowerBound = lowerBound;\n+\t\tthis.upperBound = upperBound;\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\tthis.value = context.getArgument(name, Float.class);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\tfinal float f = FloatRule.parseFloat(value);\n+\n+\t\tif (this.lowerBound > f || this.upperBound < f) {\n+\t\t\tLOGGER.warn(\"Failed to parse float {}. Was out of bounds {} - {}\", value, this.lowerBound, this.upperBound);\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tthis.value = f;\n+\t}\n+\n+\tprivate static float parseFloat(String string) {\n+\t\tif (!string.isEmpty()) {\n+\t\t\ttry {\n+\t\t\t\treturn Float.parseFloat(string);\n+\t\t\t} catch (NumberFormatException e) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse float {}\", string);\n+\t\t\t}\n+\t\t}\n+\n+\t\treturn 0.0F;\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn Float.toString(this.value);\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\treturn 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3NTM5Nw==", "bodyText": "The namespacing on these methods are not needed as the method descriptors contain a unique type", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430275397", "createdAt": "2020-05-26T09:23:17Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/RuleKeyInternals.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.CustomGameRuleCategory;\n+\n+public interface RuleKeyInternals {\n+\t/* @Nullable */\n+\tCustomGameRuleCategory fabric_getCustomCategory();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3Njc0Mw==", "bodyText": "Inconsistency with other accessors\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tthrow new AssertionError(\"Untransformed accessor\");\n          \n          \n            \n            \t\tthrow new AssertionError(\"This shouldn't happen!\");", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430276743", "createdAt": "2020-05-26T09:25:35Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/BooleanRuleAccessor.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.gamerule;\n+\n+import java.util.function.BiConsumer;\n+\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.gen.Invoker;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.world.GameRules;\n+\n+@Mixin(GameRules.BooleanRule.class)\n+public interface BooleanRuleAccessor {\n+\t@Invoker\n+\tstatic GameRules.RuleType<GameRules.BooleanRule> invokeCreate(boolean initialValue, BiConsumer<MinecraftServer, GameRules.BooleanRule> changeCallback) {\n+\t\tthrow new AssertionError(\"Untransformed accessor\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI3Nzk5Mw==", "bodyText": "This can be replaced with a Guava ArrayListMultimap", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430277993", "createdAt": "2020-05-26T09:27:32Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/client/RuleListWidgetMixin.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.gamerule.client;\n+\n+import java.util.ArrayList;\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.Unique;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n+\n+import net.minecraft.client.MinecraftClient;\n+import net.minecraft.client.gui.screen.world.EditGameRulesScreen;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.CustomGameRuleCategory;\n+import net.fabricmc.fabric.impl.gamerule.RuleKeyInternals;\n+\n+@Mixin(EditGameRulesScreen.RuleListWidget.class)\n+public abstract class RuleListWidgetMixin extends net.minecraft.client.gui.widget.EntryListWidget<EditGameRulesScreen.AbstractRuleWidget> {\n+\t@Unique\n+\tprivate final Map<CustomGameRuleCategory, ArrayList<EditGameRulesScreen.AbstractRuleWidget>> fabricCategories = new HashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 39}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MTMwNjAx", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-418130601", "createdAt": "2020-05-26T09:35:45Z", "commit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOTozNTo0NVrOGaWY7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOTozNTo0NVrOGaWY7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI4Mjk4OA==", "bodyText": "This should ensure the passed value is non-null before calling getDeclaredClass, to avoid an NPE and instead provide a more contextual IllegalArgumentException", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430282988", "createdAt": "2020-05-26T09:35:45Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,154 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public class EnumRule<E extends Enum<E>> extends LiteralRule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprotected final Collection<E> supportedValues;\n+\tprotected E value;\n+\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.RuleType<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.RuleType<EnumRule<E>> type, E value, Collection<E> supportedValues) {\n+\t\tsuper(type);\n+\t\tthis.classType = value.getDeclaringClass();\n+\t\tthis.value = value;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 50}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4MTMyNjA5", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-418132609", "createdAt": "2020-05-26T09:38:28Z", "commit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOTozODoyOFrOGaWfPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQwOTozODoyOFrOGaWfPA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI4NDYwNA==", "bodyText": "The API should require the enum class Class<E> explicitly", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430284604", "createdAt": "2020-05-26T09:38:28Z", "author": {"login": "ChloeDawn"}, "path": "fabric-gamerule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,154 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public class EnumRule<E extends Enum<E>> extends LiteralRule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprotected final Collection<E> supportedValues;\n+\tprotected E value;\n+\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.RuleType<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.RuleType<EnumRule<E>> type, E value, Collection<E> supportedValues) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e3d18f1f7b2e55151eb68b2b81020e2133198ced"}, "originalPosition": 47}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4Njc0ODIz", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-418674823", "createdAt": "2020-05-26T20:59:27Z", "commit": {"oid": "2dc9d5e7a0e044d22154d6dfdd6d07be6ed635a3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQyMDo1OToyN1rOGawHkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNlQyMDo1OToyN1rOGawHkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDcwNDUyOQ==", "bodyText": "Why, just use the constructor", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r430704529", "createdAt": "2020-05-26T20:59:27Z", "author": {"login": "liach"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/CustomGameRuleCategory.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1;\n+\n+import net.minecraft.text.Text;\n+import net.minecraft.util.Identifier;\n+\n+/**\n+ * Utility class for registering GameRule objects with custom categories outside of the categories Minecraft provides.\n+ */\n+public final class CustomGameRuleCategory {\n+\tpublic static CustomGameRuleCategory of(Identifier id, Text name) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2dc9d5e7a0e044d22154d6dfdd6d07be6ed635a3"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMzMxMzY5", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-421331369", "createdAt": "2020-05-29T22:30:11Z", "commit": {"oid": "2dc9d5e7a0e044d22154d6dfdd6d07be6ed635a3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQyMjozMDoxMVrOGcuB3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQyMjozMDoxMVrOGcuB3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjc2NzQ1NA==", "bodyText": "If this is from a Loom bug the relevant issue should be linked here so it's easier to locate once it's been resolved.", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r432767454", "createdAt": "2020-05-29T22:30:11Z", "author": {"login": "TheGlitch76"}, "path": "fabric-game-rule-api-v1/build.gradle", "diffHunk": "@@ -0,0 +1,16 @@\n+archivesBaseName = \"fabric-game-rule-api-v1\"\n+version = getSubprojectVersion(project, \"1.0.0\")\n+\n+minecraft {\n+\taccessWidener = file(\"src/main/resources/fabric-game-rule-api-v1.accesswidener\")\n+}\n+\n+dependencies {\n+\t// MUST BE A DEPENDENCY, OTHERWISE COMPILE WILL FAIL IN \"RuleListWidgetMixin\"\n+\t// YOU'VE BEEN WARNED\n+\tcompileOnly 'com.google.code.findbugs:jsr305:3.0.2'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2dc9d5e7a0e044d22154d6dfdd6d07be6ed635a3"}, "originalPosition": 11}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2dc9d5e7a0e044d22154d6dfdd6d07be6ed635a3", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/2dc9d5e7a0e044d22154d6dfdd6d07be6ed635a3", "committedDate": "2020-05-26T20:11:59Z", "message": "gamerule -> game-rule"}, "afterCommit": {"oid": "6f613113b1152e0345f1e4bcf74e1ac7be0f0ce9", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/6f613113b1152e0345f1e4bcf74e1ac7be0f0ce9", "committedDate": "2020-06-03T07:08:24Z", "message": "Fix translation keys and update to 20w22a"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNzQ3MjI5", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-423747229", "createdAt": "2020-06-03T16:50:01Z", "commit": {"oid": "111b7c15ac55a7b57b722bd4b495fed7c5d21779"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "111b7c15ac55a7b57b722bd4b495fed7c5d21779", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/111b7c15ac55a7b57b722bd4b495fed7c5d21779", "committedDate": "2020-06-03T07:15:38Z", "message": "Command results and remove unnessecary factory method"}, "afterCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/ab6cf760e7a051f2c010b297414d08e36dadbe05", "committedDate": "2020-06-04T20:53:29Z", "message": "Update to 1.16-pre1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0ODI0MzU1", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-424824355", "createdAt": "2020-06-04T21:00:28Z", "commit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "state": "APPROVED", "comments": {"totalCount": 37, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMTowMDoyOFrOGfXn7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQyMTowODoyNlrOGfX2eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NjA5Mw==", "bodyText": "shouldn't Identifier be public, or have a getter", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435546093", "createdAt": "2020-06-04T21:00:28Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/CustomGameRuleCategory.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1;\n+\n+import net.minecraft.text.Text;\n+import net.minecraft.util.Identifier;\n+\n+/**\n+ * Utility class for registering GameRule objects with custom categories outside of the categories Minecraft provides.\n+ */\n+public final class CustomGameRuleCategory {\n+\tprivate final Identifier id;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NjE4NQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435546185", "createdAt": "2020-06-04T21:00:39Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/FabricRuleTypeConsumer.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NjIyOA==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435546228", "createdAt": "2020-06-04T21:00:44Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/CustomGameRuleCategory.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NjY0Mw==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435546643", "createdAt": "2020-06-04T21:01:38Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/RuleFactory.java", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NjgxMQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435546811", "createdAt": "2020-06-04T21:02:00Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/DoubleRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NjkxOQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435546919", "createdAt": "2020-06-04T21:02:13Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NzA2OA==", "bodyText": "if those 2 are protected, why isn't the classType protected", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547068", "createdAt": "2020-06-04T21:02:33Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public class EnumRule<E extends Enum<E>> extends LiteralRule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprotected final Collection<E> supportedValues;\n+\tprotected E value;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NzE1Mg==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547152", "createdAt": "2020-06-04T21:02:43Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/FloatRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NzM1Mw==", "bodyText": "if all the fields are private, is this supposed to be a final class", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547353", "createdAt": "2020-06-04T21:03:09Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/FloatRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public class FloatRule extends GameRules.Rule<FloatRule> implements ValidateableRule {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NzQxMA==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547410", "createdAt": "2020-06-04T21:03:16Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/LiteralRule.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NzUwOA==", "bodyText": "mm yes predicates are gone crab", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547508", "createdAt": "2020-06-04T21:03:28Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/ValidateableRule.java", "diffHunk": "@@ -0,0 +1,21 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+public interface ValidateableRule {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NzU1Mg==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547552", "createdAt": "2020-06-04T21:03:32Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/ValidateableRule.java", "diffHunk": "@@ -0,0 +1,21 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NzU5OQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547599", "createdAt": "2020-06-04T21:03:36Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/EnumRuleCommand.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0Nzc2OA==", "bodyText": "same here, should this be final or the fields protected", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547768", "createdAt": "2020-06-04T21:03:56Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/EnumRuleType.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule;\n+\n+import static net.minecraft.server.command.CommandManager.literal;\n+\n+import java.util.function.BiConsumer;\n+import java.util.function.Function;\n+\n+import com.mojang.brigadier.builder.LiteralArgumentBuilder;\n+import com.mojang.brigadier.tree.LiteralCommandNode;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.rule.EnumRule;\n+\n+public class EnumRuleType<E extends Enum<E>> extends LiteralRuleType<EnumRule<E>> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NzgxMA==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547810", "createdAt": "2020-06-04T21:04:02Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/LiteralRuleCommand.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0Nzg0MQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547841", "createdAt": "2020-06-04T21:04:07Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/LiteralRuleType.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0NzkwOQ==", "bodyText": "gib private ctor", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435547909", "createdAt": "2020-06-04T21:04:16Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/LiteralRuleCommand.java", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule;\n+\n+import static net.minecraft.server.command.CommandManager.literal;\n+\n+import com.mojang.brigadier.builder.LiteralArgumentBuilder;\n+\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.rule.LiteralRule;\n+import net.fabricmc.fabric.mixin.gamerule.GameRuleCommandAccessor;\n+\n+public final class LiteralRuleCommand {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODAyNA==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548024", "createdAt": "2020-06-04T21:04:29Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/RuleKeyInternals.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODI5Mg==", "bodyText": "\ud83d\udeb2 \ud83c\udfe0 secretly add intellij annotations /s, replace it with a doc for now I guess", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548292", "createdAt": "2020-06-04T21:05:05Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/RuleKeyInternals.java", "diffHunk": "@@ -0,0 +1,26 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.CustomGameRuleCategory;\n+\n+public interface RuleKeyInternals {\n+\t/* @Nullable */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODM0MQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548341", "createdAt": "2020-06-04T21:05:11Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/rule/BoundedIntRule.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODQ1NA==", "bodyText": "parameter protected or final class", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548454", "createdAt": "2020-06-04T21:05:29Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/rule/BoundedIntRule.java", "diffHunk": "@@ -0,0 +1,86 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule.rule;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+import net.fabricmc.fabric.mixin.gamerule.IntRuleAccessor;\n+\n+public class BoundedIntRule extends GameRules.IntRule {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODQ5MA==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548490", "createdAt": "2020-06-04T21:05:33Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/widget/DoubleRuleWidget.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODUzMg==", "bodyText": "parameter protected or final class", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548532", "createdAt": "2020-06-04T21:05:39Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/widget/DoubleRuleWidget.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule.widget;\n+\n+import java.util.List;\n+\n+import com.google.common.collect.ImmutableList;\n+\n+import net.minecraft.class_5348;\n+import net.minecraft.client.MinecraftClient;\n+import net.minecraft.client.gui.Element;\n+import net.minecraft.client.gui.screen.world.EditGameRulesScreen;\n+import net.minecraft.client.gui.widget.TextFieldWidget;\n+import net.minecraft.client.util.math.MatrixStack;\n+import net.minecraft.text.Text;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.DoubleRule;\n+import net.fabricmc.fabric.mixin.gamerule.client.EditGameRulesScreenAccessor;\n+\n+@Environment(EnvType.CLIENT)\n+public class DoubleRuleWidget extends EditGameRulesScreen.AbstractRuleWidget {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODU2NQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548565", "createdAt": "2020-06-04T21:05:44Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/widget/EnumRuleWidget.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODYwMA==", "bodyText": "parameter protected or final class", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548600", "createdAt": "2020-06-04T21:05:49Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/widget/EnumRuleWidget.java", "diffHunk": "@@ -0,0 +1,81 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule.widget;\n+\n+import java.util.List;\n+import java.util.Locale;\n+\n+import com.google.common.collect.ImmutableList;\n+\n+import net.minecraft.class_5348;\n+import net.minecraft.client.gui.Element;\n+import net.minecraft.client.gui.screen.world.EditGameRulesScreen;\n+import net.minecraft.client.gui.widget.ButtonWidget;\n+import net.minecraft.client.resource.language.I18n;\n+import net.minecraft.client.util.math.MatrixStack;\n+import net.minecraft.text.LiteralText;\n+import net.minecraft.text.Text;\n+import net.minecraft.text.TranslatableText;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.EnumRule;\n+\n+@Environment(EnvType.CLIENT)\n+public class EnumRuleWidget<E extends Enum<E>> extends EditGameRulesScreen.AbstractRuleWidget {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODY0NQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548645", "createdAt": "2020-06-04T21:05:54Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/widget/FloatRuleWidget.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODY3Ng==", "bodyText": "parameter protected or final class", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548676", "createdAt": "2020-06-04T21:05:59Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/widget/FloatRuleWidget.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule.widget;\n+\n+import java.util.List;\n+\n+import com.google.common.collect.ImmutableList;\n+\n+import net.minecraft.class_5348;\n+import net.minecraft.client.MinecraftClient;\n+import net.minecraft.client.gui.Element;\n+import net.minecraft.client.gui.screen.world.EditGameRulesScreen;\n+import net.minecraft.client.gui.widget.TextFieldWidget;\n+import net.minecraft.client.util.math.MatrixStack;\n+import net.minecraft.text.Text;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.FloatRule;\n+import net.fabricmc.fabric.mixin.gamerule.client.EditGameRulesScreenAccessor;\n+\n+@Environment(EnvType.CLIENT)\n+public class FloatRuleWidget extends EditGameRulesScreen.AbstractRuleWidget {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODczMQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548731", "createdAt": "2020-06-04T21:06:05Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/BooleanRuleAccessor.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODc3OQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548779", "createdAt": "2020-06-04T21:06:09Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/GameRuleCommandAccessor.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODgxMg==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548812", "createdAt": "2020-06-04T21:06:15Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/GameRuleCommandRuleConsumerMixin.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODkxNA==", "bodyText": "native good and best in game", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548914", "createdAt": "2020-06-04T21:06:28Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/GameRuleCommandAccessor.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.mixin.gamerule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.gen.Invoker;\n+\n+import net.minecraft.server.command.GameRuleCommand;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+@Mixin(GameRuleCommand.class)\n+public interface GameRuleCommandAccessor {\n+\t@Invoker\n+\tstatic <T extends GameRules.Rule<T>> int invokeExecuteSet(CommandContext<ServerCommandSource> commandContext, GameRules.Key<T> ruleKey) {\n+\t\tthrow new AssertionError(\"This shouldn't happen!\");\n+\t}\n+\n+\t@Invoker\n+\tstatic <T extends GameRules.Rule<T>> int invokeExecuteQuery(ServerCommandSource serverCommandSource, GameRules.Key<T> ruleKey) {\n+\t\tthrow new AssertionError(\"This shouldn't happen!\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0ODk0OQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435548949", "createdAt": "2020-06-04T21:06:33Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/GameRulesAccessor.java", "diffHunk": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0OTA3Ng==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435549076", "createdAt": "2020-06-04T21:06:49Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/client/EditGameRulesScreenAccessor.java", "diffHunk": "@@ -0,0 +1,35 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0OTExOQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435549119", "createdAt": "2020-06-04T21:06:54Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/client/RuleListWidgetMixin.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0OTI2OQ==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435549269", "createdAt": "2020-06-04T21:07:14Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/mixin/gamerule/client/RuleListWidgetRuleTypeConsumerMixin.java", "diffHunk": "@@ -0,0 +1,88 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0OTc3OQ==", "bodyText": "irritatered, mixin good aw bad, some of these are unnecessary anyways, long live @Coerce", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435549779", "createdAt": "2020-06-04T21:08:20Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/main/resources/fabric-game-rule-api-v1.accesswidener", "diffHunk": "@@ -0,0 +1,5 @@\n+accessWidener\tv1\tnamed\n+accessible  method  net/minecraft/world/GameRules$Type <init>  (Ljava/util/function/Supplier;Ljava/util/function/Function;Ljava/util/function/BiConsumer;Lnet/minecraft/world/GameRules$Acceptor;)V\n+extendable  method  net/minecraft/world/GameRules$Type <init>  (Ljava/util/function/Supplier;Ljava/util/function/Function;Ljava/util/function/BiConsumer;Lnet/minecraft/world/GameRules$Acceptor;)V\n+accessible  class   net/minecraft/world/GameRules$Acceptor\n+accessible  class   net/minecraft/client/gui/screen/world/EditGameRulesScreen$RuleWidgetFactory", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTU0OTgxOA==", "bodyText": "2020", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r435549818", "createdAt": "2020-06-04T21:08:26Z", "author": {"login": "Devan-Kerman"}, "path": "fabric-game-rule-api-v1/src/testmod/java/net/fabricmc/fabric/test/gamerule/GameRulesTestMod.java", "diffHunk": "@@ -0,0 +1,148 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05"}, "originalPosition": 2}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab6cf760e7a051f2c010b297414d08e36dadbe05", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/ab6cf760e7a051f2c010b297414d08e36dadbe05", "committedDate": "2020-06-04T20:53:29Z", "message": "Update to 1.16-pre1"}, "afterCommit": {"oid": "3c2cb4c01a332ab343bd53b735639057277c1884", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/3c2cb4c01a332ab343bd53b735639057277c1884", "committedDate": "2020-06-05T18:49:05Z", "message": "Update to 1.16-pre1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2MjY4OTg2", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-426268986", "createdAt": "2020-06-08T13:56:55Z", "commit": {"oid": "3c2cb4c01a332ab343bd53b735639057277c1884"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMzo1Njo1NVrOGgfnJA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxMzo1Njo1NVrOGgfnJA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjcyNTU0MA==", "bodyText": "suggestion\n\nAn extended RuleTypeConsumer which supports Fabric's own rule types.", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r436725540", "createdAt": "2020-06-08T13:56:55Z", "author": {"login": "natanfudge"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/FabricRuleTypeConsumer.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1;\n+\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.rule.DoubleRule;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.EnumRule;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.FloatRule;\n+\n+/**\n+ * An extended RuleTypeConsumer which supports fabric's own rule types.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c2cb4c01a332ab343bd53b735639057277c1884"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NzY4MDMw", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-426768030", "createdAt": "2020-06-09T03:42:11Z", "commit": {"oid": "f569d5350e835dcca2fdf42c2c69650ed85ed1e0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2NzcwMzY3", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-426770367", "createdAt": "2020-06-09T03:51:07Z", "commit": {"oid": "f569d5350e835dcca2fdf42c2c69650ed85ed1e0"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMzo1MTowOFrOGg319g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQwMzo1MTowOFrOGg319g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzEyMjU1MA==", "bodyText": "Change this to a single line return with a ternary operator?\nreturn iterator.hasNext() ? iterator.next() : values.iterator().next();", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r437122550", "createdAt": "2020-06-09T03:51:08Z", "author": {"login": "Geometrically"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,161 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public class EnumRule<E extends Enum<E>> extends LiteralRule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprotected final Collection<E> supportedValues;\n+\tprotected E value;\n+\n+\t/**\n+\t * You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t/**\n+\t * You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, Collection<E> supportedValues) {\n+\t\tsuper(type);\n+\t\tthis.classType = value.getDeclaringClass();\n+\t\tthis.value = value;\n+\t\tthis.supportedValues = Collections.unmodifiableCollection(supportedValues);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\ttry {\n+\t\t\tfinal E deserialized = Enum.valueOf(this.classType, value);\n+\n+\t\t\tif (!this.supports(deserialized)) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}. Since the value {}, is unsupported.\", value, this.classType, value);\n+\t\t\t}\n+\n+\t\t\tthis.set(deserialized, null);\n+\t\t} catch (IllegalArgumentException e) {\n+\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}\", value, this.classType);\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn this.value.name();\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\t// For now we are gonna use the ordinal as the command result. Could be changed or set to relate to something else entirely.\n+\t\treturn this.value.ordinal();\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> getThis() {\n+\t\treturn this;\n+\t}\n+\n+\tpublic Class<E> getEnumClass() {\n+\t\treturn this.classType;\n+\t}\n+\n+\t@Override\n+\tpublic String toString() {\n+\t\treturn this.value.toString();\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> copy() {\n+\t\treturn new EnumRule<E>(this.type, this.value, this.supportedValues);\n+\t}\n+\n+\t@Override\n+\tpublic void setValue(EnumRule<E> rule, MinecraftServer minecraftServer) {\n+\t\tthis.value = rule.value;\n+\t\tthis.changed(minecraftServer);\n+\t}\n+\n+\tpublic E get() {\n+\t\treturn this.value;\n+\t}\n+\n+\tpublic E cycle(E start) {\n+\t\tif (this.supportedValues.size() > 1) {\n+\t\t\tE value = getNext(this.supportedValues, start);\n+\n+\t\t\treturn value;\n+\t\t}\n+\n+\t\treturn start;\n+\t}\n+\n+\tprotected static <T> T getNext(Collection<T> values, T value) {\n+\t\tIterator<T> iterator = values.iterator();\n+\n+\t\tdo {\n+\t\t\tif (!iterator.hasNext()) {\n+\t\t\t\treturn iterator.next();\n+\t\t\t}\n+\t\t} while (!iterator.next().equals(value));\n+\n+\t\tif (iterator.hasNext()) {\n+\t\t\treturn iterator.next();\n+\t\t} else {\n+\t\t\treturn values.iterator().next();\n+\t\t}\n+\t}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f569d5350e835dcca2fdf42c2c69650ed85ed1e0"}, "originalPosition": 139}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2Nzk0ODE4", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-426794818", "createdAt": "2020-06-09T05:17:45Z", "commit": {"oid": "5df904f6b6bf1984e04a966dba8e16820d692823"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5df904f6b6bf1984e04a966dba8e16820d692823", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/5df904f6b6bf1984e04a966dba8e16820d692823", "committedDate": "2020-06-09T04:22:43Z", "message": "I like final things"}, "afterCommit": {"oid": "77ab83c97da0a257e3640445b93e773e1884c548", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/77ab83c97da0a257e3640445b93e773e1884c548", "committedDate": "2020-06-10T18:52:45Z", "message": "I like final things"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI4NDg2NTQx", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-428486541", "createdAt": "2020-06-10T23:05:14Z", "commit": {"oid": "48fd3aa016e80de33935c11e25cba88397cdc03f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMzowNToxNFrOGiJH9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMFQyMzowNToxNFrOGiJH9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ1NDI2Mg==", "bodyText": "Hmm I need to fix these (Shouldn't be integer max here)", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r438454262", "createdAt": "2020-06-10T23:05:14Z", "author": {"login": "i509VCB"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/RuleFactory.java", "diffHunk": "@@ -0,0 +1,201 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.function.BiConsumer;\n+\n+import com.mojang.brigadier.arguments.DoubleArgumentType;\n+import com.mojang.brigadier.arguments.FloatArgumentType;\n+import com.mojang.brigadier.arguments.IntegerArgumentType;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.rule.DoubleRule;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.EnumRule;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.FloatRule;\n+import net.fabricmc.fabric.impl.gamerule.EnumRuleType;\n+import net.fabricmc.fabric.impl.gamerule.rule.BoundedIntRule;\n+import net.fabricmc.fabric.mixin.gamerule.BooleanRuleAccessor;\n+\n+public final class RuleFactory {\n+\tprivate RuleFactory() {\n+\t}\n+\n+\tpublic static GameRules.Type<GameRules.BooleanRule> createBooleanRule(boolean defaultValue) {\n+\t\treturn createBooleanRule(defaultValue, (server, rule) -> {\n+\t\t});\n+\t}\n+\n+\tpublic static GameRules.Type<GameRules.BooleanRule> createBooleanRule(boolean defaultValue, BiConsumer<MinecraftServer, GameRules.BooleanRule> changedCallback) {\n+\t\treturn BooleanRuleAccessor.invokeCreate(defaultValue, changedCallback);\n+\t}\n+\n+\tpublic static GameRules.Type<GameRules.IntRule> createIntRule(int defaultValue) {\n+\t\treturn createIntRule(defaultValue, (server, rule) -> {\n+\t\t});\n+\t}\n+\n+\tpublic static GameRules.Type<GameRules.IntRule> createIntRule(int defaultValue, int lowerBound) {\n+\t\treturn createIntRule(defaultValue, lowerBound, Integer.MAX_VALUE, (server, rule) -> {\n+\t\t});\n+\t}\n+\n+\tpublic static GameRules.Type<GameRules.IntRule> createIntRule(int defaultValue, int lowerBound, BiConsumer<MinecraftServer, GameRules.IntRule> changedCallback) {\n+\t\treturn createIntRule(defaultValue, lowerBound, Integer.MAX_VALUE, changedCallback);\n+\t}\n+\n+\tpublic static GameRules.Type<GameRules.IntRule> createIntRule(int defaultValue, int lowerBound, int upperBound) {\n+\t\treturn createIntRule(defaultValue, lowerBound, upperBound, (server, rule) -> {\n+\t\t});\n+\t}\n+\n+\tpublic static GameRules.Type<GameRules.IntRule> createIntRule(int defaultValue, BiConsumer<MinecraftServer, GameRules.IntRule> changedCallback) {\n+\t\treturn createIntRule(defaultValue, Integer.MIN_VALUE, Integer.MAX_VALUE, changedCallback);\n+\t}\n+\n+\tpublic static GameRules.Type<GameRules.IntRule> createIntRule(int defaultValue, int lowerBound, int upperBound, /* @Nullable */ BiConsumer<MinecraftServer, GameRules.IntRule> changedCallback) {\n+\t\treturn new GameRules.Type<>(\n+\t\t\t\t() -> IntegerArgumentType.integer(lowerBound, upperBound),\n+\t\t\t\ttype -> new BoundedIntRule(type, defaultValue, lowerBound, upperBound), // Internally use a bounded int rule\n+\t\t\t\tchangedCallback,\n+\t\t\t\tGameRules.TypeConsumer::acceptInt\n+\t\t);\n+\t}\n+\n+\tpublic static GameRules.Type<DoubleRule> createDoubleRule(double defaultValue) {\n+\t\treturn createDoubleRule(defaultValue, (server, rule) -> {\n+\t\t});\n+\t}\n+\n+\tpublic static GameRules.Type<DoubleRule> createDoubleRule(double defaultValue, double lowerBound) {\n+\t\treturn createDoubleRule(defaultValue, lowerBound, Integer.MAX_VALUE, (server, rule) -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48fd3aa016e80de33935c11e25cba88397cdc03f"}, "originalPosition": 88}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "32f864c30f3ef686089693c93808e259ecf1e18f", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/32f864c30f3ef686089693c93808e259ecf1e18f", "committedDate": "2020-06-11T22:26:37Z", "message": "Document LiteralRule, clarify generics"}, "afterCommit": {"oid": "3f8bc5052aca30d0e0f1e300fbadc7f4847a23fc", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/3f8bc5052aca30d0e0f1e300fbadc7f4847a23fc", "committedDate": "2020-06-11T22:29:49Z", "message": "Document LiteralRule, clarify generics"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3f8bc5052aca30d0e0f1e300fbadc7f4847a23fc", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/3f8bc5052aca30d0e0f1e300fbadc7f4847a23fc", "committedDate": "2020-06-11T22:29:49Z", "message": "Document LiteralRule, clarify generics"}, "afterCommit": {"oid": "607685a8b2d30d3460af714f984839caa2d644e0", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/607685a8b2d30d3460af714f984839caa2d644e0", "committedDate": "2020-06-12T17:28:33Z", "message": "Document LiteralRule, clarify generics"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "607685a8b2d30d3460af714f984839caa2d644e0", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/607685a8b2d30d3460af714f984839caa2d644e0", "committedDate": "2020-06-12T17:28:33Z", "message": "Document LiteralRule, clarify generics"}, "afterCommit": {"oid": "d84e6606904509d067262bec918176940f27274c", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/d84e6606904509d067262bec918176940f27274c", "committedDate": "2020-06-15T18:55:36Z", "message": "Document LiteralRule, clarify generics"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d84e6606904509d067262bec918176940f27274c", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/d84e6606904509d067262bec918176940f27274c", "committedDate": "2020-06-15T18:55:36Z", "message": "Document LiteralRule, clarify generics"}, "afterCommit": {"oid": "1cd025a085c1f5345a7e23491a9650ff64012e60", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/1cd025a085c1f5345a7e23491a9650ff64012e60", "committedDate": "2020-07-01T21:38:04Z", "message": "Update to 20w27a"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1cd025a085c1f5345a7e23491a9650ff64012e60", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/1cd025a085c1f5345a7e23491a9650ff64012e60", "committedDate": "2020-07-01T21:38:04Z", "message": "Update to 20w27a"}, "afterCommit": {"oid": "cf547cd02d5caf7f256414d356ee241285c9324b", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/cf547cd02d5caf7f256414d356ee241285c9324b", "committedDate": "2020-07-08T20:51:05Z", "message": "Update to 20w27a"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MTc5MjUy", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-445179252", "createdAt": "2020-07-08T22:47:45Z", "commit": {"oid": "cf547cd02d5caf7f256414d356ee241285c9324b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ2MDgxNTg4", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-446081588", "createdAt": "2020-07-10T02:20:28Z", "commit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3OTI4NzQ4", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-447928748", "createdAt": "2020-07-14T09:10:54Z", "commit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "state": "COMMENTED", "comments": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOToxMDo1NFrOGxLIjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwOTo1OToyNlrOGxM0_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIxNTgyMg==", "bodyText": "typo \"ofa\"", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454215822", "createdAt": "2020-07-14T09:10:54Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/GameRuleFactory.java", "diffHunk": "@@ -0,0 +1,396 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.function.BiConsumer;\n+\n+import com.mojang.brigadier.arguments.DoubleArgumentType;\n+import com.mojang.brigadier.arguments.FloatArgumentType;\n+import com.mojang.brigadier.arguments.IntegerArgumentType;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.rule.DoubleRule;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.EnumRule;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.FloatRule;\n+import net.fabricmc.fabric.impl.gamerule.EnumRuleType;\n+import net.fabricmc.fabric.impl.gamerule.rule.BoundedIntRule;\n+import net.fabricmc.fabric.mixin.gamerule.BooleanRuleAccessor;\n+\n+/**\n+ * A utility class containing factory methods to create game rule types.\n+ * A game rule is a persisted, per server data value which may control gameplay aspects.\n+ *\n+ * <p>Some factory methods allow specification ofa callback that is invoked when the value of a game rule has changed.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIyMDQ4OA==", "bodyText": "return d >= minimumValue && d <= maximumValue, cleaner and rejects NaN", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454220488", "createdAt": "2020-07-14T09:18:58Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/DoubleRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class DoubleRule extends GameRules.Rule<DoubleRule> implements ValidateableRule {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final double minimumValue;\n+\tprivate final double maximumValue;\n+\tprivate double value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic DoubleRule(GameRules.Type<DoubleRule> type, double value, double minimumValue, double maximumValue) {\n+\t\tsuper(type);\n+\t\tthis.value = value;\n+\t\tthis.minimumValue = minimumValue;\n+\t\tthis.maximumValue = maximumValue;\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\tthis.value = context.getArgument(name, Double.class);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\tfinal double d = DoubleRule.parseDouble(value);\n+\n+\t\tif (this.minimumValue > d || this.maximumValue < d) {\n+\t\t\tLOGGER.warn(\"Failed to parse double {}. Was out of bounds {} - {}\", value, this.minimumValue, this.maximumValue);\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tthis.value = d;\n+\t}\n+\n+\tprivate static double parseDouble(String string) {\n+\t\tif (!string.isEmpty()) {\n+\t\t\ttry {\n+\t\t\t\treturn Double.parseDouble(string);\n+\t\t\t} catch (NumberFormatException e) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse double {}\", string);\n+\t\t\t}\n+\t\t}\n+\n+\t\treturn 0.0D;\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn Double.toString(this.value);\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\treturn Double.compare(this.value, 0.0);\n+\t}\n+\n+\t@Override\n+\tprotected DoubleRule getThis() {\n+\t\treturn this;\n+\t}\n+\n+\t@Override\n+\tprotected DoubleRule copy() {\n+\t\treturn new DoubleRule(this.type, this.value, this.minimumValue, this.maximumValue);\n+\t}\n+\n+\t@Override\n+\tpublic void setValue(DoubleRule rule, MinecraftServer minecraftServer) {\n+\t\tthis.value = rule.value;\n+\t\tthis.changed(minecraftServer);\n+\t}\n+\n+\t@Override\n+\tpublic boolean validate(String value) {\n+\t\ttry {\n+\t\t\tfinal double d = Double.parseDouble(value);\n+\n+\t\t\treturn !(this.minimumValue > d) && !(this.maximumValue < d);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIyNjk2Mg==", "bodyText": "Checking Double.isInfinity and Double.isNan here for value and both bounds sounds like something we should do?", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454226962", "createdAt": "2020-07-14T09:30:05Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/DoubleRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class DoubleRule extends GameRules.Rule<DoubleRule> implements ValidateableRule {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final double minimumValue;\n+\tprivate final double maximumValue;\n+\tprivate double value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic DoubleRule(GameRules.Type<DoubleRule> type, double value, double minimumValue, double maximumValue) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIyNzI5Mg==", "bodyText": "this accepts Nan (comparing to NaN is always false). This wouldn't:\nif (d >= minimumValue && d <= maximumValue) { // rejects NaN\n  this.value = d;\n} else {\n  LOGGER.warn(\"Failed to parse double {}. Was out of bounds {} - {}\", value, this.minimumValue, this.maximumValue);\n  return;\n}", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454227292", "createdAt": "2020-07-14T09:30:36Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/DoubleRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class DoubleRule extends GameRules.Rule<DoubleRule> implements ValidateableRule {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final double minimumValue;\n+\tprivate final double maximumValue;\n+\tprivate double value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic DoubleRule(GameRules.Type<DoubleRule> type, double value, double minimumValue, double maximumValue) {\n+\t\tsuper(type);\n+\t\tthis.value = value;\n+\t\tthis.minimumValue = minimumValue;\n+\t\tthis.maximumValue = maximumValue;\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\tthis.value = context.getArgument(name, Double.class);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\tfinal double d = DoubleRule.parseDouble(value);\n+\n+\t\tif (this.minimumValue > d || this.maximumValue < d) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIzMDQwMA==", "bodyText": "supportedValues is private, no need to wrap this way. I'd turn it into ArrayList if it isn't a List already instead, which simplifies the other methods.", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454230400", "createdAt": "2020-07-14T09:36:03Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,162 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class EnumRule<E extends Enum<E>> extends GameRules.Rule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprivate final Collection<E> supportedValues;\n+\tprivate E value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t/**\n+\t * You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, Collection<E> supportedValues) {\n+\t\tsuper(type);\n+\t\tthis.classType = value.getDeclaringClass();\n+\t\tthis.value = value;\n+\t\tthis.supportedValues = Collections.unmodifiableCollection(supportedValues);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIzMDcyNA==", "bodyText": "return supportedValues.contains(value);", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454230724", "createdAt": "2020-07-14T09:36:36Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,162 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class EnumRule<E extends Enum<E>> extends GameRules.Rule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprivate final Collection<E> supportedValues;\n+\tprivate E value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t/**\n+\t * You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, Collection<E> supportedValues) {\n+\t\tsuper(type);\n+\t\tthis.classType = value.getDeclaringClass();\n+\t\tthis.value = value;\n+\t\tthis.supportedValues = Collections.unmodifiableCollection(supportedValues);\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\t// Do nothing. We use a different system for application with literals\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\ttry {\n+\t\t\tfinal E deserialized = Enum.valueOf(this.classType, value);\n+\n+\t\t\tif (!this.supports(deserialized)) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}. Since the value {}, is unsupported.\", value, this.classType, value);\n+\t\t\t}\n+\n+\t\t\tthis.set(deserialized, null);\n+\t\t} catch (IllegalArgumentException e) {\n+\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}\", value, this.classType);\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn this.value.name();\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\t// For now we are gonna use the ordinal as the command result. Could be changed or set to relate to something else entirely.\n+\t\treturn this.value.ordinal();\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> getThis() {\n+\t\treturn this;\n+\t}\n+\n+\tpublic Class<E> getEnumClass() {\n+\t\treturn this.classType;\n+\t}\n+\n+\t@Override\n+\tpublic String toString() {\n+\t\treturn this.value.toString();\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> copy() {\n+\t\treturn new EnumRule<>(this.type, this.value, this.supportedValues);\n+\t}\n+\n+\t@Override\n+\tpublic void setValue(EnumRule<E> rule, MinecraftServer minecraftServer) {\n+\t\tthis.value = rule.value;\n+\t\tthis.changed(minecraftServer);\n+\t}\n+\n+\tpublic E get() {\n+\t\treturn this.value;\n+\t}\n+\n+\tpublic E cycle(E start) {\n+\t\tif (this.supportedValues.size() > 1) {\n+\t\t\treturn getNext(this.supportedValues, start);\n+\t\t}\n+\n+\t\treturn start;\n+\t}\n+\n+\tprotected static <T> T getNext(Collection<T> values, T value) {\n+\t\tIterator<T> iterator = values.iterator();\n+\n+\t\tdo {\n+\t\t\tif (!iterator.hasNext()) {\n+\t\t\t\treturn iterator.next();\n+\t\t\t}\n+\t\t} while (!iterator.next().equals(value));\n+\n+\t\treturn iterator.hasNext() ? iterator.next() : values.iterator().next();\n+\t}\n+\n+\tpublic boolean supports(E value) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 142}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIzMTMwNg==", "bodyText": "Validate if value is in supportedValues? This also implicitly rejects empty supportedValues.", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454231306", "createdAt": "2020-07-14T09:37:38Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,162 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class EnumRule<E extends Enum<E>> extends GameRules.Rule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprivate final Collection<E> supportedValues;\n+\tprivate E value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t/**\n+\t * You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, Collection<E> supportedValues) {\n+\t\tsuper(type);\n+\t\tthis.classType = value.getDeclaringClass();\n+\t\tthis.value = value;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIzNDIyOQ==", "bodyText": "If supportedValues was a List, this could be implemented as easily as\nint idx = supportedValues.indexOf(start);\nif (idx < 0) throw new IllegalArgumentException(\"invalid value: \"+start);\n\nreturn supportedValues.get((idx + 1) % supportedValues.size());", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454234229", "createdAt": "2020-07-14T09:42:46Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,162 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class EnumRule<E extends Enum<E>> extends GameRules.Rule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprivate final Collection<E> supportedValues;\n+\tprivate E value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t/**\n+\t * You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, Collection<E> supportedValues) {\n+\t\tsuper(type);\n+\t\tthis.classType = value.getDeclaringClass();\n+\t\tthis.value = value;\n+\t\tthis.supportedValues = Collections.unmodifiableCollection(supportedValues);\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\t// Do nothing. We use a different system for application with literals\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\ttry {\n+\t\t\tfinal E deserialized = Enum.valueOf(this.classType, value);\n+\n+\t\t\tif (!this.supports(deserialized)) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}. Since the value {}, is unsupported.\", value, this.classType, value);\n+\t\t\t}\n+\n+\t\t\tthis.set(deserialized, null);\n+\t\t} catch (IllegalArgumentException e) {\n+\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}\", value, this.classType);\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn this.value.name();\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\t// For now we are gonna use the ordinal as the command result. Could be changed or set to relate to something else entirely.\n+\t\treturn this.value.ordinal();\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> getThis() {\n+\t\treturn this;\n+\t}\n+\n+\tpublic Class<E> getEnumClass() {\n+\t\treturn this.classType;\n+\t}\n+\n+\t@Override\n+\tpublic String toString() {\n+\t\treturn this.value.toString();\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> copy() {\n+\t\treturn new EnumRule<>(this.type, this.value, this.supportedValues);\n+\t}\n+\n+\t@Override\n+\tpublic void setValue(EnumRule<E> rule, MinecraftServer minecraftServer) {\n+\t\tthis.value = rule.value;\n+\t\tthis.changed(minecraftServer);\n+\t}\n+\n+\tpublic E get() {\n+\t\treturn this.value;\n+\t}\n+\n+\tpublic E cycle(E start) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 122}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIzNjUzNQ==", "bodyText": "There is no validation that the supplied rule is compatible with this one, should check if rule.value is in supportedValues", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454236535", "createdAt": "2020-07-14T09:46:47Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/EnumRule.java", "diffHunk": "@@ -0,0 +1,162 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import static com.google.common.base.Preconditions.checkNotNull;\n+\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Iterator;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class EnumRule<E extends Enum<E>> extends GameRules.Rule<EnumRule<E>> {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final Class<E> classType;\n+\tprivate final Collection<E> supportedValues;\n+\tprivate E value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, E[] supportedValues) {\n+\t\tthis(type, value, Arrays.asList(supportedValues));\n+\t}\n+\n+\t/**\n+\t * You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic EnumRule(GameRules.Type<EnumRule<E>> type, E value, Collection<E> supportedValues) {\n+\t\tsuper(type);\n+\t\tthis.classType = value.getDeclaringClass();\n+\t\tthis.value = value;\n+\t\tthis.supportedValues = Collections.unmodifiableCollection(supportedValues);\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\t// Do nothing. We use a different system for application with literals\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\ttry {\n+\t\t\tfinal E deserialized = Enum.valueOf(this.classType, value);\n+\n+\t\t\tif (!this.supports(deserialized)) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}. Since the value {}, is unsupported.\", value, this.classType, value);\n+\t\t\t}\n+\n+\t\t\tthis.set(deserialized, null);\n+\t\t} catch (IllegalArgumentException e) {\n+\t\t\tLOGGER.warn(\"Failed to parse rule of value {} for rule of type {}\", value, this.classType);\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn this.value.name();\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\t// For now we are gonna use the ordinal as the command result. Could be changed or set to relate to something else entirely.\n+\t\treturn this.value.ordinal();\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> getThis() {\n+\t\treturn this;\n+\t}\n+\n+\tpublic Class<E> getEnumClass() {\n+\t\treturn this.classType;\n+\t}\n+\n+\t@Override\n+\tpublic String toString() {\n+\t\treturn this.value.toString();\n+\t}\n+\n+\t@Override\n+\tprotected EnumRule<E> copy() {\n+\t\treturn new EnumRule<>(this.type, this.value, this.supportedValues);\n+\t}\n+\n+\t@Override\n+\tpublic void setValue(EnumRule<E> rule, MinecraftServer minecraftServer) {\n+\t\tthis.value = rule.value;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 114}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIzNjkzOQ==", "bodyText": "There is no validation that rule.value respects the same bounds.", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454236939", "createdAt": "2020-07-14T09:47:29Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/DoubleRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class DoubleRule extends GameRules.Rule<DoubleRule> implements ValidateableRule {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final double minimumValue;\n+\tprivate final double maximumValue;\n+\tprivate double value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic DoubleRule(GameRules.Type<DoubleRule> type, double value, double minimumValue, double maximumValue) {\n+\t\tsuper(type);\n+\t\tthis.value = value;\n+\t\tthis.minimumValue = minimumValue;\n+\t\tthis.maximumValue = maximumValue;\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\tthis.value = context.getArgument(name, Double.class);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\tfinal double d = DoubleRule.parseDouble(value);\n+\n+\t\tif (this.minimumValue > d || this.maximumValue < d) {\n+\t\t\tLOGGER.warn(\"Failed to parse double {}. Was out of bounds {} - {}\", value, this.minimumValue, this.maximumValue);\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tthis.value = d;\n+\t}\n+\n+\tprivate static double parseDouble(String string) {\n+\t\tif (!string.isEmpty()) {\n+\t\t\ttry {\n+\t\t\t\treturn Double.parseDouble(string);\n+\t\t\t} catch (NumberFormatException e) {\n+\t\t\t\tLOGGER.warn(\"Failed to parse double {}\", string);\n+\t\t\t}\n+\t\t}\n+\n+\t\treturn 0.0D;\n+\t}\n+\n+\t@Override\n+\tpublic String serialize() {\n+\t\treturn Double.toString(this.value);\n+\t}\n+\n+\t@Override\n+\tpublic int getCommandResult() {\n+\t\treturn Double.compare(this.value, 0.0);\n+\t}\n+\n+\t@Override\n+\tprotected DoubleRule getThis() {\n+\t\treturn this;\n+\t}\n+\n+\t@Override\n+\tprotected DoubleRule copy() {\n+\t\treturn new DoubleRule(this.type, this.value, this.minimumValue, this.maximumValue);\n+\t}\n+\n+\t@Override\n+\tpublic void setValue(DoubleRule rule, MinecraftServer minecraftServer) {\n+\t\tthis.value = rule.value;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDIzODg1Nw==", "bodyText": "Review comments from DoubleRule apply. I'm not 100% sure if it makes sense to have FloatRule though, DoubleRule is just a cast and reasonable bounds selection away from serving practically the same purpose.", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454238857", "createdAt": "2020-07-14T09:50:54Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/FloatRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class FloatRule extends GameRules.Rule<FloatRule> implements ValidateableRule {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI0MTE5Ng==", "bodyText": "DoubleRule.parseDouble confused me at the first look, I didn't expect it to specify the class for a local call and read Double.parseDouble instead.", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454241196", "createdAt": "2020-07-14T09:55:06Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/DoubleRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class DoubleRule extends GameRules.Rule<DoubleRule> implements ValidateableRule {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final double minimumValue;\n+\tprivate final double maximumValue;\n+\tprivate double value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic DoubleRule(GameRules.Type<DoubleRule> type, double value, double minimumValue, double maximumValue) {\n+\t\tsuper(type);\n+\t\tthis.value = value;\n+\t\tthis.minimumValue = minimumValue;\n+\t\tthis.maximumValue = maximumValue;\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\tthis.value = context.getArgument(name, Double.class);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\tfinal double d = DoubleRule.parseDouble(value);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI0MzU4MQ==", "bodyText": "This is a single-use utility method that also changes how the implementation deals with invalid values. EnumRule does nothing for deserialize(invalid), while this one sets the value to 0 unless it happened to be outside the valid range. So either a surprising 0-value or a 2nd redundant warning.", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r454243581", "createdAt": "2020-07-14T09:59:26Z", "author": {"login": "sfPlayer1"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/rule/DoubleRule.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.api.gamerule.v1.rule;\n+\n+import com.mojang.brigadier.context.CommandContext;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import net.minecraft.server.MinecraftServer;\n+import net.minecraft.server.command.ServerCommandSource;\n+import net.minecraft.world.GameRules;\n+\n+import net.fabricmc.fabric.api.gamerule.v1.GameRuleRegistry;\n+\n+public final class DoubleRule extends GameRules.Rule<DoubleRule> implements ValidateableRule {\n+\tprivate static final Logger LOGGER = LogManager.getLogger(GameRuleRegistry.class);\n+\n+\tprivate final double minimumValue;\n+\tprivate final double maximumValue;\n+\tprivate double value;\n+\n+\t/**\n+\t * @deprecated You should not be calling this constructor!\n+\t */\n+\t@Deprecated\n+\tpublic DoubleRule(GameRules.Type<DoubleRule> type, double value, double minimumValue, double maximumValue) {\n+\t\tsuper(type);\n+\t\tthis.value = value;\n+\t\tthis.minimumValue = minimumValue;\n+\t\tthis.maximumValue = maximumValue;\n+\t}\n+\n+\t@Override\n+\tprotected void setFromArgument(CommandContext<ServerCommandSource> context, String name) {\n+\t\tthis.value = context.getArgument(name, Double.class);\n+\t}\n+\n+\t@Override\n+\tprotected void deserialize(String value) {\n+\t\tfinal double d = DoubleRule.parseDouble(value);\n+\n+\t\tif (this.minimumValue > d || this.maximumValue < d) {\n+\t\t\tLOGGER.warn(\"Failed to parse double {}. Was out of bounds {} - {}\", value, this.minimumValue, this.maximumValue);\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tthis.value = d;\n+\t}\n+\n+\tprivate static double parseDouble(String string) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5"}, "originalPosition": 64}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/5b1de0ab9ee628a230a145ee5bb1ec61b703e2d5", "committedDate": "2020-07-10T01:00:13Z", "message": "finish javadoc"}, "afterCommit": {"oid": "5bfa53d20744789391b70cc27af164de1ca8e54a", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/5bfa53d20744789391b70cc27af164de1ca8e54a", "committedDate": "2020-07-15T22:26:38Z", "message": "Update to 20w29a, drop float rule"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NTQ4NTM5", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-449548539", "createdAt": "2020-07-16T06:46:06Z", "commit": {"oid": "5bfa53d20744789391b70cc27af164de1ca8e54a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5NjE1MTA3", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-449615107", "createdAt": "2020-07-16T08:07:49Z", "commit": {"oid": "5bfa53d20744789391b70cc27af164de1ca8e54a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwODowNzo0OVrOGyfgtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNlQwODowODoxN1rOGyfiLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU5ODI2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tthis.textFieldWidget.setEditableColor(14737632);\n          \n          \n            \n            \t\t\t\tthis.textFieldWidget.setEditableColor(0xE0E0E0);", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r455598261", "createdAt": "2020-07-16T08:07:49Z", "author": {"login": "JamiesWhiteShirt"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/widget/DoubleRuleWidget.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule.widget;\n+\n+import java.util.List;\n+\n+import net.minecraft.client.MinecraftClient;\n+import net.minecraft.client.gui.screen.world.EditGameRulesScreen;\n+import net.minecraft.client.gui.widget.TextFieldWidget;\n+import net.minecraft.client.util.math.MatrixStack;\n+import net.minecraft.text.StringRenderable;\n+import net.minecraft.text.Text;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.DoubleRule;\n+import net.fabricmc.fabric.mixin.gamerule.client.EditGameRulesScreenAccessor;\n+\n+@Environment(EnvType.CLIENT)\n+public final class DoubleRuleWidget extends EditGameRulesScreen.NamedRuleWidget {\n+\tprivate final TextFieldWidget textFieldWidget;\n+\n+\tpublic DoubleRuleWidget(EditGameRulesScreen gameRuleScreen, Text name, List<StringRenderable> description, final String ruleName, DoubleRule rule) {\n+\t\tgameRuleScreen.super(description, name);\n+\t\tEditGameRulesScreenAccessor accessor = (EditGameRulesScreenAccessor) gameRuleScreen;\n+\n+\t\tthis.textFieldWidget = new TextFieldWidget(MinecraftClient.getInstance().textRenderer, 10, 5, 42, 20,\n+\t\t\t\tname.shallowCopy()\n+\t\t\t\t.append(\"\\n\")\n+\t\t\t\t.append(ruleName)\n+\t\t\t\t.append(\"\\n\")\n+\t\t);\n+\n+\t\tthis.textFieldWidget.setText(Double.toString(rule.get()));\n+\t\tthis.textFieldWidget.setChangedListener(value -> {\n+\t\t\tif (rule.validate(value)) {\n+\t\t\t\tthis.textFieldWidget.setEditableColor(14737632);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bfa53d20744789391b70cc27af164de1ca8e54a"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU5ODYzOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tthis.textFieldWidget.setEditableColor(16711680);\n          \n          \n            \n            \t\t\t\tthis.textFieldWidget.setEditableColor(0xFF0000);", "url": "https://github.com/FabricMC/fabric/pull/641#discussion_r455598639", "createdAt": "2020-07-16T08:08:17Z", "author": {"login": "JamiesWhiteShirt"}, "path": "fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/impl/gamerule/widget/DoubleRuleWidget.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright (c) 2016, 2017, 2018, 2019 FabricMC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package net.fabricmc.fabric.impl.gamerule.widget;\n+\n+import java.util.List;\n+\n+import net.minecraft.client.MinecraftClient;\n+import net.minecraft.client.gui.screen.world.EditGameRulesScreen;\n+import net.minecraft.client.gui.widget.TextFieldWidget;\n+import net.minecraft.client.util.math.MatrixStack;\n+import net.minecraft.text.StringRenderable;\n+import net.minecraft.text.Text;\n+\n+import net.fabricmc.api.EnvType;\n+import net.fabricmc.api.Environment;\n+import net.fabricmc.fabric.api.gamerule.v1.rule.DoubleRule;\n+import net.fabricmc.fabric.mixin.gamerule.client.EditGameRulesScreenAccessor;\n+\n+@Environment(EnvType.CLIENT)\n+public final class DoubleRuleWidget extends EditGameRulesScreen.NamedRuleWidget {\n+\tprivate final TextFieldWidget textFieldWidget;\n+\n+\tpublic DoubleRuleWidget(EditGameRulesScreen gameRuleScreen, Text name, List<StringRenderable> description, final String ruleName, DoubleRule rule) {\n+\t\tgameRuleScreen.super(description, name);\n+\t\tEditGameRulesScreenAccessor accessor = (EditGameRulesScreenAccessor) gameRuleScreen;\n+\n+\t\tthis.textFieldWidget = new TextFieldWidget(MinecraftClient.getInstance().textRenderer, 10, 5, 42, 20,\n+\t\t\t\tname.shallowCopy()\n+\t\t\t\t.append(\"\\n\")\n+\t\t\t\t.append(ruleName)\n+\t\t\t\t.append(\"\\n\")\n+\t\t);\n+\n+\t\tthis.textFieldWidget.setText(Double.toString(rule.get()));\n+\t\tthis.textFieldWidget.setChangedListener(value -> {\n+\t\t\tif (rule.validate(value)) {\n+\t\t\t\tthis.textFieldWidget.setEditableColor(14737632);\n+\t\t\t\taccessor.callMarkValid(this);\n+\t\t\t} else {\n+\t\t\t\tthis.textFieldWidget.setEditableColor(16711680);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bfa53d20744789391b70cc27af164de1ca8e54a"}, "originalPosition": 54}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMDExNjM5", "url": "https://github.com/FabricMC/fabric/pull/641#pullrequestreview-450011639", "createdAt": "2020-07-16T16:22:24Z", "commit": {"oid": "0efd9563b21110ceb59a34bd3910a37a06e99e46"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "732428b0ae501621ef1a4915cdf6a3b39201adf3", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/732428b0ae501621ef1a4915cdf6a3b39201adf3", "committedDate": "2020-07-22T20:39:00Z", "message": "Create GameRule API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "747ce7a3d5b3d5f9727447db188b08030ba23857", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/747ce7a3d5b3d5f9727447db188b08030ba23857", "committedDate": "2020-07-22T20:39:00Z", "message": "Some tweaks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c5c13f1017e19a023aea82257ce8a453218f995", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/0c5c13f1017e19a023aea82257ce8a453218f995", "committedDate": "2020-07-22T20:39:00Z", "message": "gamerule -> game-rule"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b471dc7af92a5a47c0f7f68c18915fbbd0fd6c0f", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/b471dc7af92a5a47c0f7f68c18915fbbd0fd6c0f", "committedDate": "2020-07-22T20:39:00Z", "message": "Fix translation keys and update to 20w22a"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d2abd217969c82119ea775e02b4998faf010577", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/0d2abd217969c82119ea775e02b4998faf010577", "committedDate": "2020-07-22T20:39:01Z", "message": "Command results and remove unnessecary factory method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "64418eb5ae92048efe5e1a6ca99f611716d18002", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/64418eb5ae92048efe5e1a6ca99f611716d18002", "committedDate": "2020-07-22T20:39:01Z", "message": "Update to 1.16-pre1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d2eb827e16bc00d20d847f09b6d1815854c6d6c", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/0d2eb827e16bc00d20d847f09b6d1815854c6d6c", "committedDate": "2020-07-22T20:39:01Z", "message": "Update fabric-game-rule-api-v1/src/main/java/net/fabricmc/fabric/api/gamerule/v1/FabricRuleTypeConsumer.java\n\nCo-authored-by: liach <7806504+liach@users.noreply.github.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "59b4b299c24b7b058687eb4f4511b05f00ac6620", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/59b4b299c24b7b058687eb4f4511b05f00ac6620", "committedDate": "2020-07-22T20:39:01Z", "message": "I like final things"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d49243a9660b781d91378ccc55eee51965e6bc15", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/d49243a9660b781d91378ccc55eee51965e6bc15", "committedDate": "2020-07-22T20:39:01Z", "message": "Update to 1.16-pre3, change enum button style"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec777bfe7c3c9060ed1d9b83b5f6d0b08dc878b8", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/ec777bfe7c3c9060ed1d9b83b5f6d0b08dc878b8", "committedDate": "2020-07-22T20:39:01Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f935a55589db5b12c4fb8c97a66cad617a5c6c8", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/9f935a55589db5b12c4fb8c97a66cad617a5c6c8", "committedDate": "2020-07-22T20:39:01Z", "message": "use right min values"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b88099b5e4a7b09b25d886f20eca6d338d48692", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/7b88099b5e4a7b09b25d886f20eca6d338d48692", "committedDate": "2020-07-22T20:39:01Z", "message": "Document ValidatableRule"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca11ad32d4ddf33a8c446aa2144d4b27d1aaad45", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/ca11ad32d4ddf33a8c446aa2144d4b27d1aaad45", "committedDate": "2020-07-22T20:39:02Z", "message": "Document LiteralRule, clarify generics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99012a80c0ec6395762ce1cffcf3e19f6f10451e", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/99012a80c0ec6395762ce1cffcf3e19f6f10451e", "committedDate": "2020-07-22T20:39:02Z", "message": "Update to 20w27a"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9a04e0733b1f5acf76d078fb7b00b5e35b372b8", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/e9a04e0733b1f5acf76d078fb7b00b5e35b372b8", "committedDate": "2020-07-22T20:39:02Z", "message": "Rename some parts to compensate for future yarn renames.\n\nFlatten some logic related to EnumRules"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "851b8f485050c7c7375b2b4cf6e3296e43574c9a", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/851b8f485050c7c7375b2b4cf6e3296e43574c9a", "committedDate": "2020-07-22T20:39:02Z", "message": "forgot one"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "475c4bfba72e6b6b440984483464887c7e45db49", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/475c4bfba72e6b6b440984483464887c7e45db49", "committedDate": "2020-07-22T20:39:02Z", "message": "javadoc galore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3482b622dc653a2966fb9def3aced928fbcaf78", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/a3482b622dc653a2966fb9def3aced928fbcaf78", "committedDate": "2020-07-22T20:39:02Z", "message": "finish javadoc"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b3406430b93e9198334e68ff3d9f0b4ba4af02e", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/1b3406430b93e9198334e68ff3d9f0b4ba4af02e", "committedDate": "2020-07-22T20:39:02Z", "message": "Start things"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c561c2fe2796f032914b6308de2df2020ba300c3", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/c561c2fe2796f032914b6308de2df2020ba300c3", "committedDate": "2020-07-22T20:39:03Z", "message": "Update to 20w29a, drop float rule"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ffcaef4f30a65e71d1f3bc63971f63a4db245fd6", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/ffcaef4f30a65e71d1f3bc63971f63a4db245fd6", "committedDate": "2020-07-22T20:39:03Z", "message": "Make cycle naming more accurate"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6126a5b1df77f501d2f75fd2aa3424abfa6ed9ff", "author": {"user": {"login": "Prospector", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/6126a5b1df77f501d2f75fd2aa3424abfa6ed9ff", "committedDate": "2020-07-22T20:39:03Z", "message": "Convert colors to hex\n\nCo-authored-by: Erlend \u00c5mdal <erlend@aamdal.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c0680ea7596d31da97e4a1cd765c4a52cda1bac", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/8c0680ea7596d31da97e4a1cd765c4a52cda1bac", "committedDate": "2020-07-22T20:49:43Z", "message": "Update to 20w30a"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cf656c69aded31d4a9e66769b274c9b24aef49e7", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/cf656c69aded31d4a9e66769b274c9b24aef49e7", "committedDate": "2020-07-16T23:44:26Z", "message": "Merge branch 'gamerules' of https://github.com/FabLabsMC/fabric into gamerules"}, "afterCommit": {"oid": "8c0680ea7596d31da97e4a1cd765c4a52cda1bac", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/8c0680ea7596d31da97e4a1cd765c4a52cda1bac", "committedDate": "2020-07-22T20:49:43Z", "message": "Update to 20w30a"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "641ac848818ee60e89b208fd0339fd9994ff95e1", "author": {"user": {"login": "i509VCB", "name": null}}, "url": "https://github.com/FabricMC/fabric/commit/641ac848818ee60e89b208fd0339fd9994ff95e1", "committedDate": "2020-07-22T20:55:26Z", "message": "imports again"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3456, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}