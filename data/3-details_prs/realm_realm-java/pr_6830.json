{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyNzkwNjE3", "number": 6830, "title": "Fix broken tests on CI and expose bug in Core", "bodyText": "Fixes our own tests and add a test for realm/realm-core#3707", "createdAt": "2020-05-04T07:50:58Z", "url": "https://github.com/realm/realm-java/pull/6830", "merged": true, "mergeCommit": {"oid": "4cdd2f2a0a620ad0b1aa9919d5f08a6699947de0"}, "closed": true, "closedAt": "2020-05-04T09:27:10Z", "author": {"login": "cmelchior"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcd6p35gH2gAyNDEyNzkwNjE3OjM5OWQ4OWZjNjgxNWJhZTBlZTdjM2U0NmUxM2IwMzFkNTFlYzExMGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcd8B7pAFqTQwNDgyOTg5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "399d89fc6815bae0ee7c3e46e13b031d51ec110b", "author": {"user": {"login": "cmelchior", "name": "Christian Melchior"}}, "url": "https://github.com/realm/realm-java/commit/399d89fc6815bae0ee7c3e46e13b031d51ec110b", "committedDate": "2020-05-04T07:50:07Z", "message": "Fix tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0ODI5NjI1", "url": "https://github.com/realm/realm-java/pull/6830#pullrequestreview-404829625", "createdAt": "2020-05-04T09:25:52Z", "commit": {"oid": "399d89fc6815bae0ee7c3e46e13b031d51ec110b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyNTo1M1rOGP4wFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyNTo1M1rOGP4wFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMxMTYzOA==", "bodyText": "I assume the callback above will be immediately executed after committing the transaction, right? Otherwise, we could face problems with the test finishing before the callback kicks in.", "url": "https://github.com/realm/realm-java/pull/6830#discussion_r419311638", "createdAt": "2020-05-04T09:25:53Z", "author": {"login": "edualonso"}, "path": "realm/realm-library/src/androidTest/java/io/realm/internal/OsSharedRealmTests.java", "diffHunk": "@@ -178,6 +178,33 @@ public void onSchemaChanged() {\n         assertTrue(listenerCalled.get());\n     }\n \n+    // Test for https://github.com/realm/realm-core/issues/3707\n+    @Test\n+    public void emitTableInstructionsForCustomClasses() {\n+        final AtomicBoolean listenerCalled = new AtomicBoolean(false);\n+        assertFalse(sharedRealm.hasTable(\"NewTable\"));\n+        sharedRealm.registerSchemaChangedCallback(new OsSharedRealm.SchemaChangedCallback() {\n+            @Override\n+            public void onSchemaChanged() {\n+                assertTrue(sharedRealm.hasTable(\"NewTable\"));\n+                listenerCalled.set(true);\n+            }\n+        });\n+\n+        // Change schema using another Realm\n+        // Classes not starting with class_ were treated differently by Sync\n+        OsSharedRealm bgRealm = OsSharedRealm.getInstance(config, OsSharedRealm.VersionID.LIVE);\n+        bgRealm.beginTransaction();\n+        bgRealm.createTable(\"NewTable\");\n+        bgRealm.commitTransaction();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "399d89fc6815bae0ee7c3e46e13b031d51ec110b"}, "originalPosition": 61}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0ODI5ODkw", "url": "https://github.com/realm/realm-java/pull/6830#pullrequestreview-404829890", "createdAt": "2020-05-04T09:26:18Z", "commit": {"oid": "399d89fc6815bae0ee7c3e46e13b031d51ec110b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2514, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}