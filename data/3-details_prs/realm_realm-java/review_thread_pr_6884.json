{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0NDE2NTI4", "number": 6884, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjo0MzozMlrOECpT7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjo0NjoxMlrOECpXxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMjA5NDUyOnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/entities/SyncAllTypes.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjo0MzozMlrOGfOs1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNzo0NTo1NFrOGfQ_GA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5OTg5Mg==", "bodyText": "Most of these will fail unless made @required, right?", "url": "https://github.com/realm/realm-java/pull/6884#discussion_r435399892", "createdAt": "2020-06-04T16:43:32Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/entities/SyncAllTypes.kt", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm.entities\n+\n+import io.realm.MutableRealmInteger\n+import io.realm.RealmList\n+import io.realm.RealmObject\n+import io.realm.TestHelper\n+import io.realm.annotations.PrimaryKey\n+import io.realm.annotations.RealmField\n+import io.realm.annotations.Required\n+import org.bson.types.Decimal128\n+import org.bson.types.ObjectId\n+import java.math.BigDecimal\n+import java.util.*\n+\n+open class SyncAllTypes : RealmObject() {\n+\n+    companion object {\n+        const val CLASS_NAME = \"AllTypes\"\n+        const val FIELD_STRING = \"columnString\"\n+        const val FIELD_LONG = \"columnLong\"\n+        const val FIELD_FLOAT = \"columnFloat\"\n+        const val FIELD_DOUBLE = \"columnDouble\"\n+        const val FIELD_BOOLEAN = \"columnBoolean\"\n+        const val FIELD_DATE = \"columnDate\"\n+        const val FIELD_BINARY = \"columnBinary\"\n+        const val FIELD_MUTABLEREALMINTEGER = \"columnMutableRealmInteger\"\n+        const val FIELD_DECIMAL128 = \"columnDecimal128\"\n+        const val FIELD_OBJECT_ID = \"columnObjectId\"\n+        const val FIELD_REALMOBJECT = \"columnRealmObject\"\n+        const val FIELD_REALMLIST = \"columnRealmList\"\n+        const val FIELD_STRING_LIST = \"columnStringList\"\n+        const val FIELD_BINARY_LIST = \"columnBinaryList\"\n+        const val FIELD_BOOLEAN_LIST = \"columnBooleanList\"\n+        const val FIELD_LONG_LIST = \"columnLongList\"\n+        const val FIELD_DOUBLE_LIST = \"columnDoubleList\"\n+        const val FIELD_FLOAT_LIST = \"columnFloatList\"\n+        const val FIELD_DATE_LIST = \"columnDateList\"\n+        val INVALID_TYPES_FIELDS_FOR_DISTINCT = arrayOf(FIELD_REALMOBJECT, FIELD_REALMLIST, FIELD_DOUBLE, FIELD_FLOAT,\n+                FIELD_STRING_LIST, FIELD_BINARY_LIST, FIELD_BOOLEAN_LIST, FIELD_LONG_LIST,\n+                FIELD_DOUBLE_LIST, FIELD_FLOAT_LIST, FIELD_DATE_LIST)\n+    }\n+\n+    @PrimaryKey\n+    @RealmField(name = \"_id\")\n+    var id = ObjectId()\n+\n+    @Required\n+    var columnString = \"\"\n+    var columnLong: Long = 0\n+    var columnFloat = 0f\n+    var columnDouble = 0.0\n+    var isColumnBoolean = false\n+\n+    @Required\n+    var columnDate = Date(0)\n+\n+    @Required\n+    var columnBinary = ByteArray(0)\n+\n+    @Required\n+    var columnDecimal128 = Decimal128(BigDecimal.ZERO)\n+\n+    @Required\n+    var columnObjectId = ObjectId(TestHelper.randomObjectIdHexString())\n+    val columnRealmInteger = MutableRealmInteger.ofNull()\n+    var columnRealmObject: SyncDog? = null\n+    var columnRealmList: RealmList<SyncDog>? = null\n+    var columnStringList: RealmList<String>? = null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1760905bdfed61dda355815d246dc92b534848c2"}, "originalPosition": 84}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQzNzMzNg==", "bodyText": "Yes. Tests using this are currently all ignore. It took me some time to realise that lists with null elements where not supported on the server. The initial upload worked and the subsequent sync failed because of mismatched schema as the server just \"truncated\" the nullable parameter on the initial upload. Issue is raised on the server. Will fix in another PR when the issue is also fixed on the server.", "url": "https://github.com/realm/realm-java/pull/6884#discussion_r435437336", "createdAt": "2020-06-04T17:45:54Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/entities/SyncAllTypes.kt", "diffHunk": "@@ -0,0 +1,99 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm.entities\n+\n+import io.realm.MutableRealmInteger\n+import io.realm.RealmList\n+import io.realm.RealmObject\n+import io.realm.TestHelper\n+import io.realm.annotations.PrimaryKey\n+import io.realm.annotations.RealmField\n+import io.realm.annotations.Required\n+import org.bson.types.Decimal128\n+import org.bson.types.ObjectId\n+import java.math.BigDecimal\n+import java.util.*\n+\n+open class SyncAllTypes : RealmObject() {\n+\n+    companion object {\n+        const val CLASS_NAME = \"AllTypes\"\n+        const val FIELD_STRING = \"columnString\"\n+        const val FIELD_LONG = \"columnLong\"\n+        const val FIELD_FLOAT = \"columnFloat\"\n+        const val FIELD_DOUBLE = \"columnDouble\"\n+        const val FIELD_BOOLEAN = \"columnBoolean\"\n+        const val FIELD_DATE = \"columnDate\"\n+        const val FIELD_BINARY = \"columnBinary\"\n+        const val FIELD_MUTABLEREALMINTEGER = \"columnMutableRealmInteger\"\n+        const val FIELD_DECIMAL128 = \"columnDecimal128\"\n+        const val FIELD_OBJECT_ID = \"columnObjectId\"\n+        const val FIELD_REALMOBJECT = \"columnRealmObject\"\n+        const val FIELD_REALMLIST = \"columnRealmList\"\n+        const val FIELD_STRING_LIST = \"columnStringList\"\n+        const val FIELD_BINARY_LIST = \"columnBinaryList\"\n+        const val FIELD_BOOLEAN_LIST = \"columnBooleanList\"\n+        const val FIELD_LONG_LIST = \"columnLongList\"\n+        const val FIELD_DOUBLE_LIST = \"columnDoubleList\"\n+        const val FIELD_FLOAT_LIST = \"columnFloatList\"\n+        const val FIELD_DATE_LIST = \"columnDateList\"\n+        val INVALID_TYPES_FIELDS_FOR_DISTINCT = arrayOf(FIELD_REALMOBJECT, FIELD_REALMLIST, FIELD_DOUBLE, FIELD_FLOAT,\n+                FIELD_STRING_LIST, FIELD_BINARY_LIST, FIELD_BOOLEAN_LIST, FIELD_LONG_LIST,\n+                FIELD_DOUBLE_LIST, FIELD_FLOAT_LIST, FIELD_DATE_LIST)\n+    }\n+\n+    @PrimaryKey\n+    @RealmField(name = \"_id\")\n+    var id = ObjectId()\n+\n+    @Required\n+    var columnString = \"\"\n+    var columnLong: Long = 0\n+    var columnFloat = 0f\n+    var columnDouble = 0.0\n+    var isColumnBoolean = false\n+\n+    @Required\n+    var columnDate = Date(0)\n+\n+    @Required\n+    var columnBinary = ByteArray(0)\n+\n+    @Required\n+    var columnDecimal128 = Decimal128(BigDecimal.ZERO)\n+\n+    @Required\n+    var columnObjectId = ObjectId(TestHelper.randomObjectIdHexString())\n+    val columnRealmInteger = MutableRealmInteger.ofNull()\n+    var columnRealmObject: SyncDog? = null\n+    var columnRealmList: RealmList<SyncDog>? = null\n+    var columnStringList: RealmList<String>? = null", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5OTg5Mg=="}, "originalCommit": {"oid": "1760905bdfed61dda355815d246dc92b534848c2"}, "originalPosition": 84}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMjA5NTEyOnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/entities/SyncAllTypesSchema.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjo0Mzo0MVrOGfOtOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNzo0Njo0OFrOGfRBLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5OTk5Mw==", "bodyText": "License is duplicated", "url": "https://github.com/realm/realm-java/pull/6884#discussion_r435399993", "createdAt": "2020-06-04T16:43:41Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/entities/SyncAllTypesSchema.kt", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+/**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1760905bdfed61dda355815d246dc92b534848c2"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQzNzg2OA==", "bodyText": "Will fix in another PR along with the other SyncAllTypesSchema comments.", "url": "https://github.com/realm/realm-java/pull/6884#discussion_r435437868", "createdAt": "2020-06-04T17:46:48Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/entities/SyncAllTypesSchema.kt", "diffHunk": "@@ -0,0 +1,41 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+/**", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTM5OTk5Mw=="}, "originalCommit": {"oid": "1760905bdfed61dda355815d246dc92b534848c2"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMjA5OTY3OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/entities/SyncSupportedTypes.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjo0NTowMVrOGfOwSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNzo1MToyNlrOGfRMsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQwMDc3OA==", "bodyText": "Not sure I get having both this class and SyncAllTypes we should probably only keep one of them?", "url": "https://github.com/realm/realm-java/pull/6884#discussion_r435400778", "createdAt": "2020-06-04T16:45:01Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/entities/SyncSupportedTypes.kt", "diffHunk": "@@ -0,0 +1,102 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm.entities\n+\n+import io.realm.MutableRealmInteger\n+import io.realm.RealmList\n+import io.realm.RealmObject\n+import io.realm.TestHelper\n+import io.realm.annotations.PrimaryKey\n+import io.realm.annotations.RealmField\n+import io.realm.annotations.Required\n+import org.bson.types.Decimal128\n+import org.bson.types.ObjectId\n+import java.math.BigDecimal\n+import java.util.*\n+\n+open class SyncSupportedTypes : RealmObject() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1760905bdfed61dda355815d246dc92b534848c2"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQ0MDgxOQ==", "bodyText": "I introduced this one to enable successful testing while keeping the SyncAllTypes to track the issues of re-syncing with the server. Did not have the overview of what actually caused the trouble (lacking server support for Double and lists with nullable elements). Will clean it up in another PR along with the other SyncAlllTypesSchema", "url": "https://github.com/realm/realm-java/pull/6884#discussion_r435440819", "createdAt": "2020-06-04T17:51:26Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/entities/SyncSupportedTypes.kt", "diffHunk": "@@ -0,0 +1,102 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm.entities\n+\n+import io.realm.MutableRealmInteger\n+import io.realm.RealmList\n+import io.realm.RealmObject\n+import io.realm.TestHelper\n+import io.realm.annotations.PrimaryKey\n+import io.realm.annotations.RealmField\n+import io.realm.annotations.Required\n+import org.bson.types.Decimal128\n+import org.bson.types.ObjectId\n+import java.math.BigDecimal\n+import java.util.*\n+\n+open class SyncSupportedTypes : RealmObject() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQwMDc3OA=="}, "originalCommit": {"oid": "1760905bdfed61dda355815d246dc92b534848c2"}, "originalPosition": 31}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxMjEwNDM4OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/cpp/io_realm_mongodb_sync_SyncSession.cpp", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNjo0NjoxMlrOGfOzSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNzo1Mjo0NVrOGfRP3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQwMTU0Nw==", "bodyText": "We should probably rename the java_syncmanager_class variables as that is no longer accurate", "url": "https://github.com/realm/realm-java/pull/6884#discussion_r435401547", "createdAt": "2020-06-04T16:46:12Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/cpp/io_realm_mongodb_sync_SyncSession.cpp", "diffHunk": "@@ -252,17 +252,17 @@ JNIEXPORT jlong JNICALL Java_io_realm_mongodb_sync_SyncSession_nativeAddConnecti\n             return 0;\n         }\n \n-        static JavaClass java_syncmanager_class(env, \"io/realm/mongodb/sync/Sync\");\n-        static JavaMethod java_notify_connection_listener(env, java_syncmanager_class, \"notifyConnectionListeners\", \"(Ljava/lang/String;JJ)V\", true);\n+        static JavaClass java_syncmanager_class(env, \"io/realm/mongodb/sync/SyncSession\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1760905bdfed61dda355815d246dc92b534848c2"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQ0MTYyOQ==", "bodyText": "I will leave it for now, but will put a not on that in the issue for cleaning up the memory leak.", "url": "https://github.com/realm/realm-java/pull/6884#discussion_r435441629", "createdAt": "2020-06-04T17:52:45Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/main/cpp/io_realm_mongodb_sync_SyncSession.cpp", "diffHunk": "@@ -252,17 +252,17 @@ JNIEXPORT jlong JNICALL Java_io_realm_mongodb_sync_SyncSession_nativeAddConnecti\n             return 0;\n         }\n \n-        static JavaClass java_syncmanager_class(env, \"io/realm/mongodb/sync/Sync\");\n-        static JavaMethod java_notify_connection_listener(env, java_syncmanager_class, \"notifyConnectionListeners\", \"(Ljava/lang/String;JJ)V\", true);\n+        static JavaClass java_syncmanager_class(env, \"io/realm/mongodb/sync/SyncSession\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTQwMTU0Nw=="}, "originalCommit": {"oid": "1760905bdfed61dda355815d246dc92b534848c2"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 727, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}