{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE5ODQ2Mzk5", "number": 7199, "title": "Realm CLI tool", "bodyText": "It is a convenient single entry point to the realm helper tools.\nIt allows to control the sync server:\n\nStart\nStop\nRestart\nStatus\nBind emulator ports\n\nAnd the realm-java library:\n\ninstall locally\nbuild\ntest (run full test suite as in Jenkins)\ncheck\nclean", "createdAt": "2020-11-12T12:19:18Z", "url": "https://github.com/realm/realm-java/pull/7199", "merged": true, "mergeCommit": {"oid": "8b4d9459b46c862b9fabb2e84c17dab894af9d73"}, "closed": true, "closedAt": "2020-11-17T17:39:11Z", "author": {"login": "clementetb"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdbxhE4AH2gAyNTE5ODQ2Mzk5OmUxYjIzNjliZWU3MGJjMjk2NTM1NWNlMmZiZGY4MjMwMmRjNDkzMWI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdcCWAtAH2gAyNTE5ODQ2Mzk5Ojg2MzI4ODcxYzFkYmQ1ZGY1ODljY2VkMGU1ZDc3YWQ5NzQwNDY2YjE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e1b2369bee70bc2965355ce2fbdf82302dc4931b", "author": {"user": {"login": "clementetb", "name": null}}, "url": "https://github.com/realm/realm-java/commit/e1b2369bee70bc2965355ce2fbdf82302dc4931b", "committedDate": "2020-11-12T12:14:40Z", "message": "realm cli!"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MDMyNzA3", "url": "https://github.com/realm/realm-java/pull/7199#pullrequestreview-529032707", "createdAt": "2020-11-12T12:21:26Z", "commit": {"oid": "e1b2369bee70bc2965355ce2fbdf82302dc4931b"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5MDMzNTYy", "url": "https://github.com/realm/realm-java/pull/7199#pullrequestreview-529033562", "createdAt": "2020-11-12T12:22:42Z", "commit": {"oid": "e1b2369bee70bc2965355ce2fbdf82302dc4931b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI5ODE0OTIx", "url": "https://github.com/realm/realm-java/pull/7199#pullrequestreview-529814921", "createdAt": "2020-11-13T07:02:47Z", "commit": {"oid": "e1b2369bee70bc2965355ce2fbdf82302dc4931b"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNzowMjo0N1rOHyfWmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xM1QwNzowMjo0N1rOHyfWmQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjcwNDUzNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            esac\n          \n          \n            \n            esac", "url": "https://github.com/realm/realm-java/pull/7199#discussion_r522704537", "createdAt": "2020-11-13T07:02:47Z", "author": {"login": "cmelchior"}, "path": "tools/realm-cli.sh", "diffHunk": "@@ -0,0 +1,185 @@\n+#!/bin/bash\n+\n+# This script provides a single entry point to the different tools used during the\n+# realm-java development. \n+#\n+# It needs REALM_JAVA_PATH to be set to the realm-java repository path.\n+# \n+# Create an alias for convenient access, for example in .zshrc:\n+# alias realm=\"~/realm-java/tools/realm-cli.sh\"\n+\n+\n+is_server_active(){\n+    return `docker container ls | grep -Fq mongodb-realm`\n+}\n+\n+start_server(){\n+    if is_server_active\n+    then\n+        echo \"Warning: Sync server already runnning\"\n+    else\n+        echo -n \"Starting sync server...\"\n+        $REALM_JAVA_PATH/tools/sync_test_server/start_server.sh > /dev/null 2>&1\n+        echo \" done\"\n+    fi\n+}\n+\n+stop_server(){\n+    if is_server_active\n+    then\n+        echo -n \"Stopping sync server...\"\n+        $REALM_JAVA_PATH/tools/sync_test_server/stop_server.sh > /dev/null 2>&1\n+        echo \" done\"\n+    else\n+        echo \"Warning: Sync server not running\"\n+    fi\n+}\n+\n+restart_server(){\n+    if is_server_active\n+    then\n+        stop_server\n+        start_server\n+    else\n+        echo \"Warning: Sync server wasn't running\"\n+        start_server\n+    fi\n+}\n+\n+server_status(){\n+    if is_server_active\n+    then\n+        echo \"Sync server: ON\"\n+    else\n+        echo \"Sync server: OFF\"\n+    fi\n+}\n+\n+bind_server(){\n+    echo -n \"Forwarding ports... \"\n+    adb reverse tcp:9443 tcp:9443 && \\\n+    adb reverse tcp:9080 tcp:9080 && \\\n+    adb reverse tcp:9090 tcp:9090 && \\\n+    adb reverse tcp:8888 tcp:8888 && \\\n+    echo \"done\" || { echo \"failed\" ; exit 1 ; }\n+}\n+\n+server_help(){\n+    echo \"Try with:\n+\n+start   - starts the sync server\n+stop    - stops the sync server\n+restart - restarts the sync server\n+status  - shows the sync server status\n+bind    - bind the emulator ports to the sync server\"\n+}\n+\n+server(){\n+    action=$2\n+    case $action in\n+        start)\n+            start_server\n+            ;;\n+        stop)\n+            stop_server\n+            ;;\n+        restart)\n+            restart_server\n+            ;;\n+        status)\n+            server_status\n+            ;;\n+        bind)\n+            bind_server\n+            ;;\n+        *)\n+            server_help\n+    esac\n+}\n+\n+java_install(){\n+    pushd $REALM_JAVA_PATH\n+    ./gradlew installRealmJava\n+    popd\n+}\n+\n+java_build(){\n+    pushd $REALM_JAVA_PATH\n+    ./gradlew assemble --stacktrace\n+    popd\n+}\n+\n+java_test(){\n+    pushd $REALM_JAVA_PATH/realm\n+    ./gradlew connectedObjectServerDebugAndroidTest --stacktrace\n+    popd\n+}\n+\n+java_check(){\n+    pushd $REALM_JAVA_PATH/realm\n+    ./gradlew spotbugsMain pmd checkstyle\n+    popd\n+}\n+\n+java_clean(){\n+    pushd $REALM_JAVA_PATH\n+    ./gradlew clean\n+    popd\n+}\n+\n+java_help(){\n+    echo \"Try with:\n+\n+install - install realm-java locally\n+build   - builds realm-java\n+test    - runs the realm-java test suite\n+check   - runs realm-java spotbugs, checkstyle, pmd\n+clean   - cleans realm-java\"\n+}\n+\n+java(){\n+    action=$2\n+    case $action in\n+        install)\n+            java_install\n+            ;;\n+        build)\n+            java_build\n+            ;;\n+        test)\n+            java_test\n+            ;;\n+        check)\n+            java_check\n+            ;;\n+        clean)\n+            java_clean\n+            ;;\n+        *)\n+            java_help\n+    esac\n+}\n+\n+show_help(){\n+    echo \"Try with:\n+\n+server - controls the sync server\n+java    - executes realm-java actions\"\n+}\n+\n+if ! [[ -n \"${REALM_JAVA_PATH}\" ]]; then\n+    echo \"Error: \\$REALM_JAVA_PATH not defined.\"\n+    exit 1\n+fi\n+\n+command=$1\n+case $command in\n+    server)\n+    server $*\n+    ;;\n+    java)\n+    java $*\n+    ;;\n+    *)\n+    show_help\n+esac", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e1b2369bee70bc2965355ce2fbdf82302dc4931b"}, "originalPosition": 185}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86328871c1dbd5df589cced0e5d77ad9740466b1", "author": {"user": {"login": "clementetb", "name": null}}, "url": "https://github.com/realm/realm-java/commit/86328871c1dbd5df589cced0e5d77ad9740466b1", "committedDate": "2020-11-13T07:50:58Z", "message": "Update tools/realm-cli.sh\n\nCo-authored-by: Christian Melchior <christian@ilios.dk>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2202, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}