{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEyNzkwNjE3", "number": 6830, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyNTo1M1rOD46bIw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyNTo1M1rOD46bIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYxMDA0MDY3OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTest/java/io/realm/internal/OsSharedRealmTests.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyNTo1M1rOGP4wFg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOToyNjozNFrOGP4xbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMxMTYzOA==", "bodyText": "I assume the callback above will be immediately executed after committing the transaction, right? Otherwise, we could face problems with the test finishing before the callback kicks in.", "url": "https://github.com/realm/realm-java/pull/6830#discussion_r419311638", "createdAt": "2020-05-04T09:25:53Z", "author": {"login": "edualonso"}, "path": "realm/realm-library/src/androidTest/java/io/realm/internal/OsSharedRealmTests.java", "diffHunk": "@@ -178,6 +178,33 @@ public void onSchemaChanged() {\n         assertTrue(listenerCalled.get());\n     }\n \n+    // Test for https://github.com/realm/realm-core/issues/3707\n+    @Test\n+    public void emitTableInstructionsForCustomClasses() {\n+        final AtomicBoolean listenerCalled = new AtomicBoolean(false);\n+        assertFalse(sharedRealm.hasTable(\"NewTable\"));\n+        sharedRealm.registerSchemaChangedCallback(new OsSharedRealm.SchemaChangedCallback() {\n+            @Override\n+            public void onSchemaChanged() {\n+                assertTrue(sharedRealm.hasTable(\"NewTable\"));\n+                listenerCalled.set(true);\n+            }\n+        });\n+\n+        // Change schema using another Realm\n+        // Classes not starting with class_ were treated differently by Sync\n+        OsSharedRealm bgRealm = OsSharedRealm.getInstance(config, OsSharedRealm.VersionID.LIVE);\n+        bgRealm.beginTransaction();\n+        bgRealm.createTable(\"NewTable\");\n+        bgRealm.commitTransaction();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "399d89fc6815bae0ee7c3e46e13b031d51ec110b"}, "originalPosition": 61}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMxMTk4MQ==", "bodyText": "Yes, it does.", "url": "https://github.com/realm/realm-java/pull/6830#discussion_r419311981", "createdAt": "2020-05-04T09:26:34Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTest/java/io/realm/internal/OsSharedRealmTests.java", "diffHunk": "@@ -178,6 +178,33 @@ public void onSchemaChanged() {\n         assertTrue(listenerCalled.get());\n     }\n \n+    // Test for https://github.com/realm/realm-core/issues/3707\n+    @Test\n+    public void emitTableInstructionsForCustomClasses() {\n+        final AtomicBoolean listenerCalled = new AtomicBoolean(false);\n+        assertFalse(sharedRealm.hasTable(\"NewTable\"));\n+        sharedRealm.registerSchemaChangedCallback(new OsSharedRealm.SchemaChangedCallback() {\n+            @Override\n+            public void onSchemaChanged() {\n+                assertTrue(sharedRealm.hasTable(\"NewTable\"));\n+                listenerCalled.set(true);\n+            }\n+        });\n+\n+        // Change schema using another Realm\n+        // Classes not starting with class_ were treated differently by Sync\n+        OsSharedRealm bgRealm = OsSharedRealm.getInstance(config, OsSharedRealm.VersionID.LIVE);\n+        bgRealm.beginTransaction();\n+        bgRealm.createTable(\"NewTable\");\n+        bgRealm.commitTransaction();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMxMTYzOA=="}, "originalCommit": {"oid": "399d89fc6815bae0ee7c3e46e13b031d51ec110b"}, "originalPosition": 61}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 678, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}