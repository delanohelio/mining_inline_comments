{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4MjM2OTU2", "number": 7219, "reviewThreads": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMToyNToyMFrOFGqM5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNTozMjo0MlrOFGxCig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNTI3MjA3OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTest/java/io/realm/ManagedOrderedRealmCollectionTests.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMToyNToyMFrOIHxGMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOTo0NzozOFrOIIcCcQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAxNTM0Ng==", "bodyText": "It isn't possible to have two @ignore annotations, so this needs to be collapsed with the one below", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545015346", "createdAt": "2020-12-17T11:25:20Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTest/java/io/realm/ManagedOrderedRealmCollectionTests.java", "diffHunk": "@@ -113,6 +113,7 @@\n  * @see UnManagedRealmCollectionTests\n  */\n \n+@Ignore(\"Tests crash due to bug in core, see https://jira.mongodb.org/browse/RCORE-435\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcxODg5Nw==", "bodyText": "I think this was a merge conflict with Clemente's mixed type branch (I'm baselining this story on top of his work on mixed).", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545718897", "createdAt": "2020-12-18T09:47:38Z", "author": {"login": "edualonso"}, "path": "realm/realm-library/src/androidTest/java/io/realm/ManagedOrderedRealmCollectionTests.java", "diffHunk": "@@ -113,6 +113,7 @@\n  * @see UnManagedRealmCollectionTests\n  */\n \n+@Ignore(\"Tests crash due to bug in core, see https://jira.mongodb.org/browse/RCORE-435\")", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAxNTM0Ng=="}, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNTI3MzM5OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTest/java/io/realm/RealmTests.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMToyNTo0MlrOIHxG_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMToyNTo0MlrOIHxG_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAxNTU1MQ==", "bodyText": "Same", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545015551", "createdAt": "2020-12-17T11:25:42Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTest/java/io/realm/RealmTests.java", "diffHunk": "@@ -134,7 +134,7 @@\n import static org.mockito.Mockito.mock;\n import static org.mockito.Mockito.when;\n \n-\n+@Ignore(\"Tests crash due to bug in core, see https://jira.mongodb.org/browse/RCORE-435\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNTI4MTkyOnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTest/kotlin/io/realm/MapTests.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMToyNzozNVrOIHxLwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMToyNzozNVrOIHxLwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAxNjc2OA==", "bodyText": "Nitpick: I would probably just use unmanaged_<x> since the class is already named MapTests", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545016768", "createdAt": "2020-12-17T11:27:35Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTest/kotlin/io/realm/MapTests.kt", "diffHunk": "@@ -0,0 +1,195 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm\n+\n+import androidx.test.ext.junit.runners.AndroidJUnit4\n+import org.junit.Test\n+import org.junit.runner.RunWith\n+import kotlin.test.*\n+\n+private const val KEY = \"KEY\"\n+private const val KEY_1 = \"KEY_1\"\n+private const val KEY_2 = \"KEY_2\"\n+private const val VALUE = 666\n+private const val VALUE_1 = 1\n+private const val VALUE_2 = 2\n+\n+@RunWith(AndroidJUnit4::class)\n+class MapTests {\n+\n+    // ------------------------------------------\n+    // Unmanaged map\n+    // ------------------------------------------\n+\n+    @Test\n+    fun unmanagedMap_isManaged() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNTI5NDMyOnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTest/kotlin/io/realm/MapTests.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMTozMDo0NlrOIHxTQA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMDowNjowNlrOIIcqFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAxODY4OA==", "bodyText": "This seems to rely on some ordering within the map itself, so I suspect this test could break in the future? Not sure if there is a specific test method for comparing maps somewhere?", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545018688", "createdAt": "2020-12-17T11:30:46Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTest/kotlin/io/realm/MapTests.kt", "diffHunk": "@@ -0,0 +1,195 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm\n+\n+import androidx.test.ext.junit.runners.AndroidJUnit4\n+import org.junit.Test\n+import org.junit.runner.RunWith\n+import kotlin.test.*\n+\n+private const val KEY = \"KEY\"\n+private const val KEY_1 = \"KEY_1\"\n+private const val KEY_2 = \"KEY_2\"\n+private const val VALUE = 666\n+private const val VALUE_1 = 1\n+private const val VALUE_2 = 2\n+\n+@RunWith(AndroidJUnit4::class)\n+class MapTests {\n+\n+    // ------------------------------------------\n+    // Unmanaged map\n+    // ------------------------------------------\n+\n+    @Test\n+    fun unmanagedMap_isManaged() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertFalse(realmMap.isManaged)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_isValid() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertTrue(realmMap.isValid)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_size() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertEquals(0, realmMap.size)\n+        realmMap[KEY] = VALUE\n+        assertEquals(1, realmMap.size)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_isEmpty() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertTrue(realmMap.isEmpty())\n+        realmMap[KEY] = VALUE\n+        assertFalse(realmMap.isEmpty())\n+    }\n+\n+    @Test\n+    fun unmanagedMap_containsKey() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertTrue(realmMap.containsKey(KEY))\n+    }\n+\n+    @Test\n+    fun unmanagedMap_containsValue() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertTrue(realmMap.containsValue(VALUE))\n+    }\n+\n+    @Test\n+    fun unmanagedMap_get() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertEquals(realmMap[KEY], VALUE)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_put() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertEquals(0, realmMap.size)\n+        realmMap[KEY] = VALUE\n+        assertEquals(1, realmMap.size)\n+        assertEquals(realmMap[KEY], VALUE)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_remove() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertEquals(1, realmMap.size)\n+        realmMap.remove(KEY)\n+        assertEquals(0, realmMap.size)\n+        assertNull(realmMap[KEY])\n+    }\n+\n+    @Test\n+    fun unmanagedMap_putAll() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap.putAll(otherMap)\n+        assertEquals(2, realmMap.size)\n+        assertTrue(realmMap.containsKey(KEY_1))\n+        assertTrue(realmMap.containsKey(KEY_2))\n+        assertTrue(realmMap.containsValue(VALUE_1))\n+        assertTrue(realmMap.containsValue(VALUE_2))\n+    }\n+\n+    @Test\n+    fun unmanagedMap_clear() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertEquals(1, realmMap.size)\n+        realmMap.clear()\n+        assertEquals(0, realmMap.size)\n+        assertNull(realmMap[KEY])\n+    }\n+\n+    @Test\n+    fun unmanagedMap_constructorWithMap() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>(otherMap)\n+        assertEquals(2, realmMap.size)\n+        assertTrue(realmMap.containsKey(KEY_1))\n+        assertTrue(realmMap.containsKey(KEY_2))\n+        assertTrue(realmMap.containsValue(VALUE_1))\n+        assertTrue(realmMap.containsValue(VALUE_2))\n+    }\n+\n+    @Test\n+    fun unmanagedMap_keySet() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>(otherMap)\n+        val keySet = setOf(KEY_1, KEY_2)\n+        assertEquals(keySet, realmMap.keys)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_values() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>(otherMap)\n+        val valueCollection = listOf(VALUE_1, VALUE_2)\n+        assertEquals(valueCollection, realmMap.values.toList())\n+    }\n+\n+    @Test\n+    fun unmanagedMap_entrySet() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>(otherMap)\n+        val expectedEntries = listOf(\n+                Pair(KEY_1, VALUE_1),\n+                Pair(KEY_2, VALUE_2)\n+        )\n+\n+        val actualEntries = realmMap.entries.map { it.toPair() }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 179}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyOTA0Nw==", "bodyText": "Yes, I should be comparing against the entrysets of both maps \ud83e\udd26", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545729047", "createdAt": "2020-12-18T10:06:06Z", "author": {"login": "edualonso"}, "path": "realm/realm-library/src/androidTest/kotlin/io/realm/MapTests.kt", "diffHunk": "@@ -0,0 +1,195 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm\n+\n+import androidx.test.ext.junit.runners.AndroidJUnit4\n+import org.junit.Test\n+import org.junit.runner.RunWith\n+import kotlin.test.*\n+\n+private const val KEY = \"KEY\"\n+private const val KEY_1 = \"KEY_1\"\n+private const val KEY_2 = \"KEY_2\"\n+private const val VALUE = 666\n+private const val VALUE_1 = 1\n+private const val VALUE_2 = 2\n+\n+@RunWith(AndroidJUnit4::class)\n+class MapTests {\n+\n+    // ------------------------------------------\n+    // Unmanaged map\n+    // ------------------------------------------\n+\n+    @Test\n+    fun unmanagedMap_isManaged() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertFalse(realmMap.isManaged)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_isValid() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertTrue(realmMap.isValid)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_size() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertEquals(0, realmMap.size)\n+        realmMap[KEY] = VALUE\n+        assertEquals(1, realmMap.size)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_isEmpty() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertTrue(realmMap.isEmpty())\n+        realmMap[KEY] = VALUE\n+        assertFalse(realmMap.isEmpty())\n+    }\n+\n+    @Test\n+    fun unmanagedMap_containsKey() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertTrue(realmMap.containsKey(KEY))\n+    }\n+\n+    @Test\n+    fun unmanagedMap_containsValue() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertTrue(realmMap.containsValue(VALUE))\n+    }\n+\n+    @Test\n+    fun unmanagedMap_get() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertEquals(realmMap[KEY], VALUE)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_put() {\n+        val realmMap = RealmMap<String, Int>()\n+        assertEquals(0, realmMap.size)\n+        realmMap[KEY] = VALUE\n+        assertEquals(1, realmMap.size)\n+        assertEquals(realmMap[KEY], VALUE)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_remove() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertEquals(1, realmMap.size)\n+        realmMap.remove(KEY)\n+        assertEquals(0, realmMap.size)\n+        assertNull(realmMap[KEY])\n+    }\n+\n+    @Test\n+    fun unmanagedMap_putAll() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap.putAll(otherMap)\n+        assertEquals(2, realmMap.size)\n+        assertTrue(realmMap.containsKey(KEY_1))\n+        assertTrue(realmMap.containsKey(KEY_2))\n+        assertTrue(realmMap.containsValue(VALUE_1))\n+        assertTrue(realmMap.containsValue(VALUE_2))\n+    }\n+\n+    @Test\n+    fun unmanagedMap_clear() {\n+        val realmMap = RealmMap<String, Int>()\n+        realmMap[KEY] = VALUE\n+        assertEquals(1, realmMap.size)\n+        realmMap.clear()\n+        assertEquals(0, realmMap.size)\n+        assertNull(realmMap[KEY])\n+    }\n+\n+    @Test\n+    fun unmanagedMap_constructorWithMap() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>(otherMap)\n+        assertEquals(2, realmMap.size)\n+        assertTrue(realmMap.containsKey(KEY_1))\n+        assertTrue(realmMap.containsKey(KEY_2))\n+        assertTrue(realmMap.containsValue(VALUE_1))\n+        assertTrue(realmMap.containsValue(VALUE_2))\n+    }\n+\n+    @Test\n+    fun unmanagedMap_keySet() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>(otherMap)\n+        val keySet = setOf(KEY_1, KEY_2)\n+        assertEquals(keySet, realmMap.keys)\n+    }\n+\n+    @Test\n+    fun unmanagedMap_values() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>(otherMap)\n+        val valueCollection = listOf(VALUE_1, VALUE_2)\n+        assertEquals(valueCollection, realmMap.values.toList())\n+    }\n+\n+    @Test\n+    fun unmanagedMap_entrySet() {\n+        val otherMap = HashMap<String, Int>().apply {\n+            this[KEY_1] = VALUE_1\n+            this[KEY_2] = VALUE_2\n+        }\n+        val realmMap = RealmMap<String, Int>(otherMap)\n+        val expectedEntries = listOf(\n+                Pair(KEY_1, VALUE_1),\n+                Pair(KEY_2, VALUE_2)\n+        )\n+\n+        val actualEntries = realmMap.entries.map { it.toPair() }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTAxODY4OA=="}, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 179}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNTY0MzQwOnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTest/kotlin/io/realm/entities/MapClass.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMjo1NjoyM1rOIH0Y0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQwOTo1NDowM1rOIIcQ3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTA2OTI2Ng==", "bodyText": "This should probabl be val myMap: RealmMap<String, Int> = RealmMap() ?", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545069266", "createdAt": "2020-12-17T12:56:23Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTest/kotlin/io/realm/entities/MapClass.kt", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm.entities\n+\n+import io.realm.RealmMap\n+import io.realm.RealmObject\n+import io.realm.annotations.Ignore\n+\n+open class MapClass : RealmObject() {\n+    var testField: String = \"\"\n+\n+    @Ignore     // FIXME: this goes when the annotation processor is ready\n+    var myMap: RealmMap<String, Int>? = null", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTcyMjU5MA==", "bodyText": "This is irrelevant for this PR since the proxy generation code isn't ready yet in here. I should have written a \"please disregard\" comment.", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545722590", "createdAt": "2020-12-18T09:54:03Z", "author": {"login": "edualonso"}, "path": "realm/realm-library/src/androidTest/kotlin/io/realm/entities/MapClass.kt", "diffHunk": "@@ -0,0 +1,28 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm.entities\n+\n+import io.realm.RealmMap\n+import io.realm.RealmObject\n+import io.realm.annotations.Ignore\n+\n+open class MapClass : RealmObject() {\n+    var testField: String = \"\"\n+\n+    @Ignore     // FIXME: this goes when the annotation processor is ready\n+    var myMap: RealmMap<String, Int>? = null", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTA2OTI2Ng=="}, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNTY1ODY1OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/java/io/realm/MapOperatorFactory.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMjo1OTo1OVrOIH0hiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMjo1OTo1OVrOIH0hiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTA3MTQ5Nw==", "bodyText": "Maybe ManagedMapOperator ?", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545071497", "createdAt": "2020-12-17T12:59:59Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/java/io/realm/MapOperatorFactory.java", "diffHunk": "@@ -0,0 +1,202 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm;\n+\n+import java.util.Collection;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import io.realm.internal.ManageableObject;\n+import io.realm.internal.OsMap;\n+import io.realm.internal.Util;\n+\n+/**\n+ * This factory instantiates a {@link MapOperator} matching the map's key and value types.\n+ * <p>\n+ * Note: at the moment {@link RealmMap}s can only use {@code String}s as keys and primitive, Mixed,\n+ * RealmList, RealmSet and RealmMap as values\n+ * <p>\n+ * TODO even though Integers shouldn't be accepted, we are using them until Mixed type is ready\n+ */\n+public class MapOperatorFactory {\n+\n+    /**\n+     * FIXME\n+     *\n+     * @param keyClassString\n+     * @param valueClassString\n+     * @param baseRealm\n+     * @param osMap\n+     * @param <K>\n+     * @param <V>\n+     * @return\n+     */\n+    public static <K, V> MapOperator<K, V> getOperator(String keyClassString, String valueClassString, BaseRealm baseRealm, OsMap osMap) {\n+        // TODO: only String keys for now\n+        if (!keyClassString.equals(String.class.toString())) {\n+            throw new IllegalArgumentException(\"Only String keys are allowed in RealmMaps.\");\n+        } else {\n+            // TODO: add other types when ready\n+            if (valueClassString.equals(Integer.class.toString())) {\n+                return new MapOperator<>(baseRealm, keyClassString, new IntegerValueOperator(baseRealm, osMap));\n+            } else {\n+                throw new IllegalArgumentException(\"Only Integer values are allowed in RealmMaps.\");\n+            }\n+        }\n+    }\n+}\n+\n+/**\n+ * FIXME\n+ *\n+ * @param <K>\n+ * @param <V>\n+ */\n+class MapOperator<K, V> implements Map<K, V>, ManageableObject {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 69}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNTY2MTc1OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/java/io/realm/RealmMap.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMzowMDo0N1rOIH0jTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMzowMDo0N1rOIH0jTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTA3MTk0OA==", "bodyText": "Using strategies makes it much cleaner than what is currently in RealmList \ud83d\udc4f", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545071948", "createdAt": "2020-12-17T13:00:47Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/java/io/realm/RealmMap.java", "diffHunk": "@@ -0,0 +1,521 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm;\n+\n+import java.util.Collection;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import io.realm.internal.Freezable;\n+import io.realm.internal.ManageableObject;\n+import io.realm.internal.OsMap;\n+\n+/**\n+ * FIXME\n+ *\n+ * @param <K>\n+ * @param <V>\n+ */\n+public class RealmMap<K, V> implements Map<K, V>, ManageableObject, Freezable<RealmMap<K, V>> {\n+\n+    private final MapStrategy<K, V> mapStrategy;\n+\n+    // ------------------------------------------\n+    // Unmanaged constructors\n+    // ------------------------------------------\n+\n+    /**\n+     * Instantiates a RealmMap in unmanaged mode.\n+     */\n+    public RealmMap() {\n+        this.mapStrategy = new UnmanagedMapStrategy<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 46}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNTY2NzM4OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/java/io/realm/RealmMap.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMzowMjowN1rOIH0mjw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxMzowMjowN1rOIH0mjw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTA3Mjc4Mw==", "bodyText": "Generally I think we do something like:\n    /**\n     * {@inheritDoc}\n     */\n\nTo make sure that Javadoc works correctly", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545072783", "createdAt": "2020-12-17T13:02:07Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/java/io/realm/RealmMap.java", "diffHunk": "@@ -0,0 +1,521 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm;\n+\n+import java.util.Collection;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import io.realm.internal.Freezable;\n+import io.realm.internal.ManageableObject;\n+import io.realm.internal.OsMap;\n+\n+/**\n+ * FIXME\n+ *\n+ * @param <K>\n+ * @param <V>\n+ */\n+public class RealmMap<K, V> implements Map<K, V>, ManageableObject, Freezable<RealmMap<K, V>> {\n+\n+    private final MapStrategy<K, V> mapStrategy;\n+\n+    // ------------------------------------------\n+    // Unmanaged constructors\n+    // ------------------------------------------\n+\n+    /**\n+     * Instantiates a RealmMap in unmanaged mode.\n+     */\n+    public RealmMap() {\n+        this.mapStrategy = new UnmanagedMapStrategy<>();\n+    }\n+\n+    /**\n+     * Instantiates a RealmMap in unmanaged mode with an initial map.\n+     *\n+     * @param map initial map.\n+     */\n+    public RealmMap(Map<K, V> map) {\n+        this();\n+        mapStrategy.putAll(map);\n+    }\n+\n+    // ------------------------------------------\n+    // Managed constructors\n+    // ------------------------------------------\n+\n+    /**\n+     * Constructor used by {@code Realm}s.\n+     *\n+     * @param baseRealm\n+     * @param osMap\n+     * @param keyClass\n+     * @param valueClass\n+     */\n+    RealmMap(BaseRealm baseRealm, OsMap osMap, Class<K> keyClass, Class<V> valueClass) {\n+        this.mapStrategy = new ManagedMapStrategy<>(baseRealm, osMap, new RealmClassManager<>(keyClass, valueClass));\n+    }\n+\n+    /**\n+     * Constructor used by {@code DynamicRealm}s.\n+     *\n+     * @param baseRealm\n+     * @param osMap\n+     * @param keyClass\n+     * @param valueClass\n+     */\n+    RealmMap(BaseRealm baseRealm, OsMap osMap, String keyClass, String valueClass) {\n+        this.mapStrategy = new ManagedMapStrategy<>(baseRealm, osMap, new DynamicRealmClassManager(keyClass, valueClass));\n+    }\n+\n+    // ------------------------------------------\n+    // ManageableObject API\n+    // ------------------------------------------\n+\n+    @Override", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNjM4MjE5OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/java/io/realm/OrderedRealmCollectionSnapshot.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNTozMDo0MlrOIH7KGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMDowODoyOVrOIIcvPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4MDE4Ng==", "bodyText": "Shouldn't this also result in @Override being added to the relevant methods?", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545180186", "createdAt": "2020-12-17T15:30:42Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/java/io/realm/OrderedRealmCollectionSnapshot.java", "diffHunk": "@@ -48,7 +49,7 @@\n  * }\n  * </pre>\n  */\n-public class OrderedRealmCollectionSnapshot<E> extends OrderedRealmCollectionImpl<E> {\n+public class OrderedRealmCollectionSnapshot<E> extends OrderedRealmCollectionImpl<E> implements Freezable<OrderedRealmCollection<E>> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTczMDM2Ng==", "bodyText": "Nope, because this class already had a freeze method. It already had @Override because it came from OrderedRealmCollectionImpl, but now it comes from Freezable.", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545730366", "createdAt": "2020-12-18T10:08:29Z", "author": {"login": "edualonso"}, "path": "realm/realm-library/src/main/java/io/realm/OrderedRealmCollectionSnapshot.java", "diffHunk": "@@ -48,7 +49,7 @@\n  * }\n  * </pre>\n  */\n-public class OrderedRealmCollectionSnapshot<E> extends OrderedRealmCollectionImpl<E> {\n+public class OrderedRealmCollectionSnapshot<E> extends OrderedRealmCollectionImpl<E> implements Freezable<OrderedRealmCollection<E>> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4MDE4Ng=="}, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNjM4NDM1OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/java/io/realm/RealmResults.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNTozMToxMlrOIH7LcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMDowODo0NFrOIIcv4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4MDUyOQ==", "bodyText": "Same for the @Override", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545180529", "createdAt": "2020-12-17T15:31:12Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/java/io/realm/RealmResults.java", "diffHunk": "@@ -67,7 +68,7 @@\n  * @see RealmQuery#findAll()\n  * @see Realm#executeTransaction(Realm.Transaction)\n  */\n-public class RealmResults<E> extends OrderedRealmCollectionImpl<E> {\n+public class RealmResults<E> extends OrderedRealmCollectionImpl<E> implements Freezable<RealmResults<E>> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTczMDUyOQ==", "bodyText": "Same as above.", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545730529", "createdAt": "2020-12-18T10:08:44Z", "author": {"login": "edualonso"}, "path": "realm/realm-library/src/main/java/io/realm/RealmResults.java", "diffHunk": "@@ -67,7 +68,7 @@\n  * @see RealmQuery#findAll()\n  * @see Realm#executeTransaction(Realm.Transaction)\n  */\n-public class RealmResults<E> extends OrderedRealmCollectionImpl<E> {\n+public class RealmResults<E> extends OrderedRealmCollectionImpl<E> implements Freezable<RealmResults<E>> {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4MDUyOQ=="}, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQyNjM5MjQyOnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/java/io/realm/internal/Util.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xN1QxNTozMjo0MlrOIH7QNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxMTo1OToyNlrOIIgLtg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4MTc0OQ==", "bodyText": "This doesn't work if Proguard is enabled, I think @clementetb added something like this to support Mixed?", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545181749", "createdAt": "2020-12-17T15:32:42Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/java/io/realm/internal/Util.java", "diffHunk": "@@ -252,4 +252,19 @@ public static void checkContainsKey(final String key, final Map<String, ?> map,\n             throw new IllegalArgumentException(\"Key '\" + key + \"' required in '\"+ argName +\"'.\");\n         }\n     }\n+\n+    /**\n+     * Returns a {@link Class} object from a string.\n+     *\n+     * @param className the class name\n+     * @return the {@code Class} object matching the string.\n+     * @throws IllegalArgumentException if the class does not exist.\n+     */\n+    public static Class<?> getClassForName(String className) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTc4NjgwNg==", "bodyText": "Yes, it should be handled within a mediator. I will add it in an upcoming PR since the proxy code isn't ready yet here.", "url": "https://github.com/realm/realm-java/pull/7219#discussion_r545786806", "createdAt": "2020-12-18T11:59:26Z", "author": {"login": "edualonso"}, "path": "realm/realm-library/src/main/java/io/realm/internal/Util.java", "diffHunk": "@@ -252,4 +252,19 @@ public static void checkContainsKey(final String key, final Map<String, ?> map,\n             throw new IllegalArgumentException(\"Key '\" + key + \"' required in '\"+ argName +\"'.\");\n         }\n     }\n+\n+    /**\n+     * Returns a {@link Class} object from a string.\n+     *\n+     * @param className the class name\n+     * @return the {@code Class} object matching the string.\n+     * @throws IllegalArgumentException if the class does not exist.\n+     */\n+    public static Class<?> getClassForName(String className) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTE4MTc0OQ=="}, "originalCommit": {"oid": "5a87a19d6758af65b5d09bdfcd1bbabc48b34d28"}, "originalPosition": 12}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 384, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}