{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI1NTE2ODI0", "number": 6888, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDoyNzozMFrOEBL1zA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwODozMTo0MVrOECDgug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njc4MDI4OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/AppExt.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDoyNzozMFrOGc5VEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwOToxODowOFrOGdpNew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjU5NQ==", "bodyText": "What does this do?", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r432952595", "createdAt": "2020-05-31T14:27:30Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/AppExt.kt", "diffHunk": "@@ -13,28 +13,32 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-package io.realm\n+package io.realm.mongodb\n \n+import io.realm.BaseRealmExt\n import io.realm.admin.ServerAdmin\n+import io.realm.test_clear\n+import io.realm.mongodb.sync.test_reset\n \n /**\n  * Resets the Realm Application and delete all local state.\n  *\n  * Trying to access any Sync or Realm App API's after this has been called has undefined\n  * behavior.\n  */\n-fun RealmApp.close() {\n+fun App.close() {\n     ServerAdmin().deleteAllUsers()\n-    this.syncManager.reset()\n-    RealmApp.CREATED = false\n-    BaseRealm.applicationContext = null // Required for Realm.init() to work\n+    this.syncManager.test_reset()\n+    this.networkTransport.resetHeaders()\n+    App.CREATED = false\n+    BaseRealmExt.test_clear()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzczNzA4Mw==", "bodyText": "Works around that BaseRealm.applicationContext is package protected. BaseRealmExt is a public extension to BaseRealm, but in same package as BaseRealm, which allows us to clear the context for test purpose. Overall trying to allow tests to be in io.realm to ensure that we test public APIs, with as few hooks into protected state as possible.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r433737083", "createdAt": "2020-06-02T09:18:08Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/AppExt.kt", "diffHunk": "@@ -13,28 +13,32 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-package io.realm\n+package io.realm.mongodb\n \n+import io.realm.BaseRealmExt\n import io.realm.admin.ServerAdmin\n+import io.realm.test_clear\n+import io.realm.mongodb.sync.test_reset\n \n /**\n  * Resets the Realm Application and delete all local state.\n  *\n  * Trying to access any Sync or Realm App API's after this has been called has undefined\n  * behavior.\n  */\n-fun RealmApp.close() {\n+fun App.close() {\n     ServerAdmin().deleteAllUsers()\n-    this.syncManager.reset()\n-    RealmApp.CREATED = false\n-    BaseRealm.applicationContext = null // Required for Realm.init() to work\n+    this.syncManager.test_reset()\n+    this.networkTransport.resetHeaders()\n+    App.CREATED = false\n+    BaseRealmExt.test_clear()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjU5NQ=="}, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njc4MDg5OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/sync/SessionTests.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDoyODozMVrOGc5VZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDoyODozMVrOGc5VZw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjY3OQ==", "bodyText": "Schema has a public list of classes, probably we can just look them up through that instead", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r432952679", "createdAt": "2020-05-31T14:28:31Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/sync/SessionTests.kt", "diffHunk": "@@ -211,7 +217,8 @@ class SessionTests {\n \n                     // opening a Dynamic Realm should also work\n                     DynamicRealm.getInstance(backupRealmConfiguration).use { dynamicRealm ->\n-                        dynamicRealm.schema.checkHasTable(StringOnly.CLASS_NAME, \"Dynamic Realm should contains \" + StringOnly.CLASS_NAME)\n+                        // FIXME How to get access to dynamicRealm.schme.checkHasTable\n+//                        dynamicRealm.schema.checkHasTable(StringOnly.CLASS_NAME, \"Dynamic Realm should contains \" + StringOnly.CLASS_NAME)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 74}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njc4MjQ0OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/sync/SyncConfigurationTests.kt", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDozMToxMlrOGc5WNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwOTowMToxMVrOGdolzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1Mjg4NQ==", "bodyText": "if it isn't public, it probably should be.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r432952885", "createdAt": "2020-05-31T14:31:12Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/sync/SyncConfigurationTests.kt", "diffHunk": "@@ -163,7 +168,8 @@ class SyncConfigurationTests {\n                     }\n                 })\n                 .build()\n-        assertNotNull(config.initialDataTransaction)\n+        // FIXME How to verify this without access to initialDataTransaction\n+//        assertNotNull(config.initialDataTransaction)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 149}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzcyNjkyNA==", "bodyText": "There was actually a package protected access on RealmConfiguration so I just updraded it to protected. Could make it public if that makes sense, but to me it seems ok to leave non-public.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r433726924", "createdAt": "2020-06-02T09:01:11Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/sync/SyncConfigurationTests.kt", "diffHunk": "@@ -163,7 +168,8 @@ class SyncConfigurationTests {\n                     }\n                 })\n                 .build()\n-        assertNotNull(config.initialDataTransaction)\n+        // FIXME How to verify this without access to initialDataTransaction\n+//        assertNotNull(config.initialDataTransaction)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1Mjg4NQ=="}, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 149}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njc4MjYzOnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/sync/SyncExt.kt", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDozMTozNFrOGc5WTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDozMTozNFrOGc5WTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MjkxMA==", "bodyText": "testReset? test_reset() looks very c++.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r432952910", "createdAt": "2020-05-31T14:31:34Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/androidTestObjectServer/kotlin/io/realm/mongodb/sync/SyncExt.kt", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm.mongodb.sync\n+\n+// Helper to expose package protected methods for testing purpose\n+fun Sync.test_reset() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njc4NDI0OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/java/io/realm/BaseRealm.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDozNDowNFrOGc5XNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMDoyNTozMlrOGeCtxg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MzE0Mg==", "bodyText": "We mostly use this to check that people called Realm.init() as it loaded the native code and make sure we have a reference to getFilesDir.\nIf we must make it public, it would make most sense to have it on Realm I think.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r432953142", "createdAt": "2020-05-31T14:34:04Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/java/io/realm/BaseRealm.java", "diffHunk": "@@ -147,6 +147,14 @@ public void onInit(OsSharedRealm sharedRealm) {\n         this.shouldCloseSharedRealm = false;\n     }\n \n+    // FIXME Could we put this in Realm.getApplicationContext() only. Do not know why this lives\n+    //  on BaseRealm as it is never initialized/used for DynamicRealm, so might as well just\n+    //  be on Realm.\n+    // FIXME Review public exposure - Needed from <X>Configuration.Builder. Can we expose this? Alternatively required as argument to <X>Configruation.Builders\n+    public static Context getApplicationContext() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE1NDk1MA==", "bodyText": "I added it as Realm.getApplicationContext()", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r434154950", "createdAt": "2020-06-02T20:25:32Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/main/java/io/realm/BaseRealm.java", "diffHunk": "@@ -147,6 +147,14 @@ public void onInit(OsSharedRealm sharedRealm) {\n         this.shouldCloseSharedRealm = false;\n     }\n \n+    // FIXME Could we put this in Realm.getApplicationContext() only. Do not know why this lives\n+    //  on BaseRealm as it is never initialized/used for DynamicRealm, so might as well just\n+    //  be on Realm.\n+    // FIXME Review public exposure - Needed from <X>Configuration.Builder. Can we expose this? Alternatively required as argument to <X>Configruation.Builders\n+    public static Context getApplicationContext() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MzE0Mg=="}, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njc4NTA4OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/java/io/realm/DynamicRealm.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDozNToyM1rOGc5Xrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwOTo1NDowNFrOGdqgVw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MzI2Mw==", "bodyText": "Having this public feels problematic. What classes need to call this that don't live in io.realm ?", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r432953263", "createdAt": "2020-05-31T14:35:23Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/java/io/realm/DynamicRealm.java", "diffHunk": "@@ -333,7 +333,8 @@ public DynamicRealm freeze() {\n      *\n      * @param version the schema version to be set.\n      */\n-    void setVersion(long version) {\n+    // FIXME Review public exposure - Test only can be hidden by extension functions\n+    public void setVersion(long version) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc1ODI5NQ==", "bodyText": "Yes it is problematic. It was used from SyncedRealmMigrationTests Moved SyncedRealmMigrationTests to io.realm and added an extension method SyncConfiguration.Builder.testSchema as that was the only reason for putting it in io.realm.mongodb.sync.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r433758295", "createdAt": "2020-06-02T09:54:04Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/main/java/io/realm/DynamicRealm.java", "diffHunk": "@@ -333,7 +333,8 @@ public DynamicRealm freeze() {\n      *\n      * @param version the schema version to be set.\n      */\n-    void setVersion(long version) {\n+    // FIXME Review public exposure - Test only can be hidden by extension functions\n+    public void setVersion(long version) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MzI2Mw=="}, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY5Njc4NTYxOnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/main/java/io/realm/RealmConfiguration.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0zMVQxNDozNjowN1rOGc5X9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQwOToyNDowNlrOGdpbPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MzMzNQ==", "bodyText": "Probably doesn't hurt, although it does bloat the public API for very little value.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r432953335", "createdAt": "2020-05-31T14:36:07Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/main/java/io/realm/RealmConfiguration.java", "diffHunk": "@@ -435,7 +435,8 @@ public String toString() {\n      * @return {@code true} if RxJava dependency exist, {@code false} otherwise.\n      */\n     @SuppressWarnings(\"LiteralClassName\")\n-    static synchronized boolean isRxJavaAvailable() {\n+    // FIXME Review public exposure - Needed from SyncConfiguration.Builder can we expose this?\n+    public static synchronized boolean isRxJavaAvailable() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzc0MDYwNQ==", "bodyText": "Yep. Will move it to internal util.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r433740605", "createdAt": "2020-06-02T09:24:06Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/main/java/io/realm/RealmConfiguration.java", "diffHunk": "@@ -435,7 +435,8 @@ public String toString() {\n      * @return {@code true} if RxJava dependency exist, {@code false} otherwise.\n      */\n     @SuppressWarnings(\"LiteralClassName\")\n-    static synchronized boolean isRxJavaAvailable() {\n+    // FIXME Review public exposure - Needed from SyncConfiguration.Builder can we expose this?\n+    public static synchronized boolean isRxJavaAvailable() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1MzMzNQ=="}, "originalCommit": {"oid": "de6d5ad39c0e18a660e6ad075f34a70291d58241"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwNTg2NDkyOnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/objectServer/java/io/realm/internal/mongodb/Request.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwODoyMTo1OVrOGeRPBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwODoyMTo1OVrOGeRPBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM5MjgzNw==", "bodyText": "Since this now lives in internal, it is perfectly fine to have public constructors. So this FIXME can probably just be removed", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r434392837", "createdAt": "2020-06-03T08:21:59Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/objectServer/java/io/realm/internal/mongodb/Request.java", "diffHunk": "@@ -0,0 +1,97 @@\n+/*\n+ * Copyright 2020 Realm Inc.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.realm.internal.mongodb;\n+\n+import java.util.concurrent.Future;\n+import java.util.concurrent.ThreadPoolExecutor;\n+\n+import javax.annotation.Nullable;\n+\n+import io.realm.RealmAsyncTask;\n+import io.realm.internal.RealmNotifier;\n+import io.realm.internal.android.AndroidCapabilities;\n+import io.realm.internal.android.AndroidRealmNotifier;\n+import io.realm.internal.async.RealmAsyncTaskImpl;\n+import io.realm.log.RealmLog;\n+import io.realm.mongodb.App;\n+import io.realm.mongodb.ErrorCode;\n+import io.realm.mongodb.ObjectServerError;\n+\n+// Class wrapping requests made against MongoDB Realm. Is also responsible for calling with success/error on the\n+// correct thread.\n+public abstract class Request<T> {\n+    @Nullable\n+    private final App.Callback<T> callback;\n+    private final RealmNotifier handler;\n+    private final ThreadPoolExecutor networkPoolExecutor;\n+\n+    // FIXME Made public to use in Functions. Consider reworking when App, User is moved", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aaa2dba54b1ee66178ea3c261b7a0825323a0a2a"}, "originalPosition": 42}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcwNTkwMTM4OnYy", "diffSide": "RIGHT", "path": "realm/realm-library/src/syncTestUtils/kotlin/io/realm/mongodb/sync/SyncConfigurationExt.kt", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwODozMTo0MVrOGeRmjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wM1QwODo0MjoxMFrOGeR-xA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM5ODg2MA==", "bodyText": "Not 100% sure I understand why adding this is better than just renaming the schema method?", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r434398860", "createdAt": "2020-06-03T08:31:41Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/syncTestUtils/kotlin/io/realm/mongodb/sync/SyncConfigurationExt.kt", "diffHunk": "@@ -16,8 +16,13 @@\n \n package io.realm.mongodb.sync\n \n+import io.realm.RealmModel\n import io.realm.internal.OsRealmConfig\n \n-fun SyncConfiguration.Builder.test_sessionStopPolicy(policy: OsRealmConfig.SyncSessionStopPolicy): SyncConfiguration.Builder {\n+fun SyncConfiguration.Builder.testSchema(firstClass: Class<out RealmModel>, vararg x: Class<out RealmModel> ) : SyncConfiguration.Builder {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aaa2dba54b1ee66178ea3c261b7a0825323a0a2a"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwMjA1MQ==", "bodyText": "The schema method is package protected, so all tests using this would have to be in the io.realm.mongodb.sync packages. As the tests are also relating on other package protected methods from io.realm and io.realm.mongodb we cannot resolve all package private access by placing it in one of the packages. Thus adding test-only extension methods to workaround this. Alternative would be to subclass, but as almost all tests are in Kotlin now, I just went for the extensions.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r434402051", "createdAt": "2020-06-03T08:37:12Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/syncTestUtils/kotlin/io/realm/mongodb/sync/SyncConfigurationExt.kt", "diffHunk": "@@ -16,8 +16,13 @@\n \n package io.realm.mongodb.sync\n \n+import io.realm.RealmModel\n import io.realm.internal.OsRealmConfig\n \n-fun SyncConfiguration.Builder.test_sessionStopPolicy(policy: OsRealmConfig.SyncSessionStopPolicy): SyncConfiguration.Builder {\n+fun SyncConfiguration.Builder.testSchema(firstClass: Class<out RealmModel>, vararg x: Class<out RealmModel> ) : SyncConfiguration.Builder {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM5ODg2MA=="}, "originalCommit": {"oid": "aaa2dba54b1ee66178ea3c261b7a0825323a0a2a"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwMjYxMA==", "bodyText": "Ah okay. That sounds fine then \ud83d\udc4d", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r434402610", "createdAt": "2020-06-03T08:38:06Z", "author": {"login": "cmelchior"}, "path": "realm/realm-library/src/syncTestUtils/kotlin/io/realm/mongodb/sync/SyncConfigurationExt.kt", "diffHunk": "@@ -16,8 +16,13 @@\n \n package io.realm.mongodb.sync\n \n+import io.realm.RealmModel\n import io.realm.internal.OsRealmConfig\n \n-fun SyncConfiguration.Builder.test_sessionStopPolicy(policy: OsRealmConfig.SyncSessionStopPolicy): SyncConfiguration.Builder {\n+fun SyncConfiguration.Builder.testSchema(firstClass: Class<out RealmModel>, vararg x: Class<out RealmModel> ) : SyncConfiguration.Builder {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM5ODg2MA=="}, "originalCommit": {"oid": "aaa2dba54b1ee66178ea3c261b7a0825323a0a2a"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDQwNTA2MA==", "bodyText": "We could even remove some of these test-only internal methods to reduce the number of symbols now that it is so much easier to extend class from outside.", "url": "https://github.com/realm/realm-java/pull/6888#discussion_r434405060", "createdAt": "2020-06-03T08:42:10Z", "author": {"login": "rorbech"}, "path": "realm/realm-library/src/syncTestUtils/kotlin/io/realm/mongodb/sync/SyncConfigurationExt.kt", "diffHunk": "@@ -16,8 +16,13 @@\n \n package io.realm.mongodb.sync\n \n+import io.realm.RealmModel\n import io.realm.internal.OsRealmConfig\n \n-fun SyncConfiguration.Builder.test_sessionStopPolicy(policy: OsRealmConfig.SyncSessionStopPolicy): SyncConfiguration.Builder {\n+fun SyncConfiguration.Builder.testSchema(firstClass: Class<out RealmModel>, vararg x: Class<out RealmModel> ) : SyncConfiguration.Builder {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDM5ODg2MA=="}, "originalCommit": {"oid": "aaa2dba54b1ee66178ea3c261b7a0825323a0a2a"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 733, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}