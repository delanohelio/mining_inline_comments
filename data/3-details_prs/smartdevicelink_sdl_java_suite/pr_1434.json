{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzNjc1NDQx", "number": 1434, "title": "Feature/0296 possibility to update video streaming capabilities", "bodyText": "Fixes #1410\nThis PR is [ready] for review.\nRelated PR's\nCore\nHMI\nRisk\nThis PR makes [minor] API changes.\nTesting Plan\n\n I have run the unit tests with this PR\n I have tested this PR against Core and verified the behavior\n I have tested Android\n\nUnit Tests\n[Describe the unit tests and behaviors added in this PR]\nSummary\n\nAdd restart of video service on VIDEO_STREAMING notification\nImplement view resize for streaming on new params\nImplement additional state for StreamingStateMachine\nAdd callback for developers to provide streaming constraints\n\nCLA\n\n I have signed the CLA", "createdAt": "2020-08-05T22:27:53Z", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434", "merged": true, "mergeCommit": {"oid": "c60d308e11e2879ee674a59dd19e73f0535f821f"}, "closed": true, "closedAt": "2021-03-09T16:54:07Z", "author": {"login": "kboskin"}, "timelineItems": {"totalCount": 181, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdcG8y6gH2gAyNDYzNjc1NDQxOjZjNTg3ZGY4ZTYyN2UwN2EyMDlmNDg5M2YxYzJmYjA4ZmFlYmY0MDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABeBflB8gFqTYwNzYzMzM5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6c587df8e627e07a209f4893f1c2fb08faebf401", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/6c587df8e627e07a209f4893f1c2fb08faebf401", "committedDate": "2020-11-13T13:12:57Z", "message": "[0296]\n- Codestyle fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8bdb2055d323105a913a4efd7e60ec6641445e2", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c8bdb2055d323105a913a4efd7e60ec6641445e2", "committedDate": "2020-11-13T13:42:35Z", "message": "[0296]\n- Codestyle fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9da111ab1a6ecb2480cbac2a609ed7dcb6b09361", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/9da111ab1a6ecb2480cbac2a609ed7dcb6b09361", "committedDate": "2020-11-13T13:47:41Z", "message": "[0296]\n- Codestyle fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2395b68325685bcf2e04b14a0480b2e78867c2d1", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/2395b68325685bcf2e04b14a0480b2e78867c2d1", "committedDate": "2020-11-16T10:04:43Z", "message": "[0296]\n- Remove SdlProxyBase.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e26866274b08973baf549493a6deee097748e1ab", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e26866274b08973baf549493a6deee097748e1ab", "committedDate": "2020-11-16T10:25:16Z", "message": "[0296]\n- Remove unneeded public API changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/3263ce13badd6e9d5b70025bc6ba5305bc758798", "committedDate": "2020-11-18T09:13:26Z", "message": "[0296]\n- Fix Tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ4OTM1ODk1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-548935895", "createdAt": "2020-12-10T08:03:59Z", "commit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwODowNDowMFrOIC8NKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQwOToxNToxNlrOIC-9ug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk1NDQ3Mg==", "bodyText": "@kostyaBoss can you move line 936 right below line 925 (after the last entry for GENERAL_ADDITIONAL_CAPABILITY_LIST)?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539954472", "createdAt": "2020-12-10T08:04:00Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -912,11 +918,23 @@ public void onVoiceCommandSelected() {\n         GENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n         GENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \n+        GENERAL_ADDITIONAL_CAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n+        GENERAL_ADDITIONAL_CAPABILITY.setDiagonalScreenSize(GENERAL_DOUBLE);\n+        GENERAL_ADDITIONAL_CAPABILITY.setScale(GENERAL_DOUBLE);\n+\n+        GENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+        GENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+\n         GENERAL_VIDEOSTREAMINGCAPABILITY.setMaxBitrate(GENERAL_INT);\n         GENERAL_VIDEOSTREAMINGCAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n         GENERAL_VIDEOSTREAMINGCAPABILITY.setSupportedFormats(GENERAL_VIDEOSTREAMINGFORMAT_LIST);\n         GENERAL_VIDEOSTREAMINGCAPABILITY.setIsHapticSpatialDataSupported(GENERAL_BOOLEAN);\n \n+        GENERAL_VIDEOSTREAMINGCAPABILITY.setDiagonalScreenSize(GENERAL_DOUBLE);\n+        GENERAL_VIDEOSTREAMINGCAPABILITY.setPixelPerInch(GENERAL_DOUBLE);\n+        GENERAL_VIDEOSTREAMINGCAPABILITY.setScale(GENERAL_DOUBLE);\n+        GENERAL_ADDITIONAL_CAPABILITY.setAdditionalVideoStreamingCapabilities(GENERAL_ADDITIONAL_CAPABILITY_LIST);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk1NTEyMA==", "bodyText": "@kostyaBoss you can delete line 926 as it duplicates line 925.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539955120", "createdAt": "2020-12-10T08:05:08Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -912,11 +918,23 @@ public void onVoiceCommandSelected() {\n         GENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n         GENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \n+        GENERAL_ADDITIONAL_CAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n+        GENERAL_ADDITIONAL_CAPABILITY.setDiagonalScreenSize(GENERAL_DOUBLE);\n+        GENERAL_ADDITIONAL_CAPABILITY.setScale(GENERAL_DOUBLE);\n+\n+        GENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+        GENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk1Nzc3MQ==", "bodyText": "@kostyaBoss you can remove the blank line on line 932 so all of GENERAL_VIDEOSTREAMINGCAPABILITY are grouped together.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539957771", "createdAt": "2020-12-10T08:09:54Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -912,11 +918,23 @@ public void onVoiceCommandSelected() {\n         GENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n         GENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \n+        GENERAL_ADDITIONAL_CAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n+        GENERAL_ADDITIONAL_CAPABILITY.setDiagonalScreenSize(GENERAL_DOUBLE);\n+        GENERAL_ADDITIONAL_CAPABILITY.setScale(GENERAL_DOUBLE);\n+\n+        GENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+        GENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+\n         GENERAL_VIDEOSTREAMINGCAPABILITY.setMaxBitrate(GENERAL_INT);\n         GENERAL_VIDEOSTREAMINGCAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n         GENERAL_VIDEOSTREAMINGCAPABILITY.setSupportedFormats(GENERAL_VIDEOSTREAMINGFORMAT_LIST);\n         GENERAL_VIDEOSTREAMINGCAPABILITY.setIsHapticSpatialDataSupported(GENERAL_BOOLEAN);\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk2NDc3OA==", "bodyText": "@kostyaBoss are you able to do a reference.put(VideoStreamingCapability.KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES...) on line 91 to get it onto the reference object?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539964778", "createdAt": "2020-12-10T08:21:42Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/rpc/datatypes/VideoStreamingCapabilityTests.java", "diffHunk": "@@ -68,11 +71,15 @@ public void testRpcValues() {\n         assertNull(TestValues.NULL, msg.getDiagonalScreenSize());\n         assertNull(TestValues.NULL, msg.getPixelPerInch());\n         assertNull(TestValues.NULL, msg.getScale());\n+        assertNull(TestValues.NULL, msg.getAdditionalVideoStreamingCapabilities());\n     }\n \n     public void testJson() {\n         JSONObject reference = new JSONObject();\n \n+        msg.setAdditionalVideoStreamingCapabilities(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk2ODA5Mw==", "bodyText": "@kostyaBoss do you need to add unit tests here?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539968093", "createdAt": "2020-12-10T08:27:11Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/streaming/video/SdlRemoteDisplayTest.java", "diffHunk": "@@ -106,6 +106,11 @@ protected void onCreate(Bundle savedInstanceState) {\n \n         }\n \n+        @Override\n+        public void onViewResized(int width, int height) {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk3MjYzNQ==", "bodyText": "@kostyaBoss on lines 139-140 you are calling setSurface twice.  Is it necessary?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539972635", "createdAt": "2020-12-10T08:34:21Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -133,9 +135,16 @@ public void start() throws Exception {\n                 inputSurface = prepareVideoEncoder();\n \n                 // Create a virtual display that will output to our encoder.\n-                virtualDisplay = mDisplayManager.createVirtualDisplay(TAG,\n-                        streamingParams.getResolution().getResolutionWidth(), streamingParams.getResolution().getResolutionHeight(),\n-                        streamingParams.getDisplayDensity(), inputSurface, DisplayManager.VIRTUAL_DISPLAY_FLAG_PRESENTATION);\n+                if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP && virtualDisplay != null) {\n+                    virtualDisplay.setSurface(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk3Njk0MQ==", "bodyText": "@kostyaBoss in the onError method do you need to print out the info or do any other logging/exception handling?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539976941", "createdAt": "2020-12-10T08:41:16Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -192,6 +213,35 @@ public void onNotified(RPCNotification notification) {\n         }\n     };\n \n+    private final OnSystemCapabilityListener systemCapabilityListener = new OnSystemCapabilityListener() {\n+        @Override\n+        public void onCapabilityRetrieved(Object capability) {\n+            VideoStreamingParameters params = new VideoStreamingParameters();\n+\n+            VideoStreamingCapability castedCapability = ((VideoStreamingCapability)capability);\n+\n+            // means only scale received\n+            if (castedCapability.getPreferredResolution() == null &&\n+                    castedCapability.getScale() != null &&\n+                    castedCapability.getScale() != 0 &&\n+                    VideoStreamManager.this.parameters != null\n+                    && VideoStreamManager.this.parameters.getResolution() != null) {\n+                // set cached resolution\n+                castedCapability.setPreferredResolution(originalCapability.getPreferredResolution());\n+            }\n+            params.update(castedCapability, vehicleMake);//Streaming parameters are ready time to stream\n+            VideoStreamManager.this.parameters = params;\n+\n+            VideoStreamManager.this.withPendingRestart = true;\n+\n+            virtualDisplayEncoder.setStreamingParams(params);\n+            stopStreaming(true);\n+        }\n+\n+        @Override\n+        public void onError(String info) { }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 111}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk3ODQ4Mw==", "bodyText": "@kostyaBoss on lines 336-338 please format the comments so it lines up with the comments on the previous lines (lines 331-335)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539978483", "createdAt": "2020-12-10T08:43:38Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -274,6 +325,31 @@ public void onError(String info) {\n         }\n     }\n \n+    /**\n+     * Starts streaming a remote display to the module if there is a connected session. This method of streaming requires the device to be on API level 19 or higher\n+     *\n+     * @param context            a context that can be used to create the remote display\n+     * @param remoteDisplayClass class object of the remote display. This class will be used to create an instance of the remote display and will be projected to the module\n+     * @param parameters         streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n+     *                           If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n+     *                           works best for the currently connected module.\n+     * @param encrypted a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 156}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk5NDA1Mg==", "bodyText": "@kostyaBoss I generated this file using the generator tool located at: https://github.com/smartdevicelink/sdl_java_suite/tree/master/generator\nI see differences between the generated file and this file.  Can you please generate this file using the tool?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539994052", "createdAt": "2020-12-10T09:06:54Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package com.smartdevicelink.proxy.rpc;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk5NTg2OA==", "bodyText": "@kostyaBoss on line 53 you can change 7.0 to 7.0.0 (from the code generator tool).", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539995868", "createdAt": "2020-12-10T09:09:33Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -49,6 +49,10 @@\n     public static final String KEY_DIAGONAL_SCREEN_SIZE = \"diagonalScreenSize\";\n     public static final String KEY_PIXEL_PER_INCH = \"pixelPerInch\";\n     public static final String KEY_SCALE = \"scale\";\n+    /**\n+     * @since SmartDeviceLink 7.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk5NjcxNw==", "bodyText": "@kostyaBoss above line 193 please include (from the code generator tool):\n\"    /**\n* Sets the additionalVideoStreamingCapabilities.\n*\n* @param additionalVideoStreamingCapabilities\n* {\"array_min_size\": 1, \"array_max_size\": 100}\n* @SInCE SmartDeviceLink 7.0.0\n*/\"", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539996717", "createdAt": "2020-12-10T09:10:49Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -180,4 +184,14 @@ public VideoStreamingCapability setScale(Double scale) {\n         setValue(KEY_SCALE, scale);\n         return this;\n     }\n+\n+    @SuppressWarnings(\"unchecked\")\n+    public List<VideoStreamingCapability> getAdditionalVideoStreamingCapabilities(){\n+        return (List<VideoStreamingCapability>) getObject(VideoStreamingCapability.class, KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES);\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk5NzEwMg==", "bodyText": "@kostyaBoss on line 193 you can change the param name to additionalVideoStreamingCapabilities (code generator tool).", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539997102", "createdAt": "2020-12-10T09:11:28Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -180,4 +184,14 @@ public VideoStreamingCapability setScale(Double scale) {\n         setValue(KEY_SCALE, scale);\n         return this;\n     }\n+\n+    @SuppressWarnings(\"unchecked\")\n+    public List<VideoStreamingCapability> getAdditionalVideoStreamingCapabilities(){\n+        return (List<VideoStreamingCapability>) getObject(VideoStreamingCapability.class, KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES);\n+    }\n+\n+    public VideoStreamingCapability setAdditionalVideoStreamingCapabilities(List<VideoStreamingCapability> capabilities) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk5NzY1NA==", "bodyText": "@kostyaBoss above line 188 you can add these lines (code generator tool):\n\"    /**\n* Gets the additionalVideoStreamingCapabilities.\n*\n* @return List\n* {\"array_min_size\": 1, \"array_max_size\": 100}\n* @SInCE SmartDeviceLink 7.0.0\n*/\"", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539997654", "createdAt": "2020-12-10T09:12:15Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -180,4 +184,14 @@ public VideoStreamingCapability setScale(Double scale) {\n         setValue(KEY_SCALE, scale);\n         return this;\n     }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk5OTY3NA==", "bodyText": "@kostyaBoss I generated this file using the generator tool located at: https://github.com/smartdevicelink/sdl_java_suite/tree/master/generator\nI see differences between the generated file and this file.  Can you please generate this file using the tool?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r539999674", "createdAt": "2020-12-10T09:15:16Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/enums/AppCapabilityType.java", "diffHunk": "@@ -0,0 +1,23 @@\n+package com.smartdevicelink.proxy.rpc.enums;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NDAzODQ5", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-549403849", "createdAt": "2020-12-10T16:53:35Z", "commit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNjo1MzozNVrOIDTTQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNjo1ODoyMFrOIDThqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDMzMjg2NQ==", "bodyText": "@kostyaBoss Per the proposal, startRemoteDisplayStream should be defined as public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted, VideoStreamingRange streamingRange).\nYour definition is different because you take in two VideoStreamingRanges instead of just one.  Do you need to change yours to match up with the proposal?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r540332865", "createdAt": "2020-12-10T16:53:35Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -274,6 +325,31 @@ public void onError(String info) {\n         }\n     }\n \n+    /**\n+     * Starts streaming a remote display to the module if there is a connected session. This method of streaming requires the device to be on API level 19 or higher\n+     *\n+     * @param context            a context that can be used to create the remote display\n+     * @param remoteDisplayClass class object of the remote display. This class will be used to create an instance of the remote display and will be projected to the module\n+     * @param parameters         streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n+     *                           If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n+     *                           works best for the currently connected module.\n+     * @param encrypted a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n+     * @param landscapeRange constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+     * @param portraitRange constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+     */\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted, VideoStreamingRange landscapeRange, VideoStreamingRange portraitRange) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 160}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDMzNTE1NA==", "bodyText": "@kostyaBoss Per the proposal, isImageResolutionInRange should be defined as public Boolean isImageResolutionInRange(VideoStreamingRange range, ImageResolution currentResolution).\nYour definition is different because you take in two Resolution objects instead of just the VideoStreamingRange object. Do you need to change yours to match up with the proposal?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r540335154", "createdAt": "2020-12-10T16:56:40Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -648,6 +773,101 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            List<VideoStreamingCapability> originalAdditionalCapabilities\n+    ){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+\n+        VideoStreamingCapability preferredCapability = new VideoStreamingCapability();\n+        preferredCapability.setDiagonalScreenSize(parameters.getPreferredDiagonal());\n+        preferredCapability.setPreferredResolution(new ImageResolution(\n+                parameters.getResolution().getResolutionWidth(),\n+                parameters.getResolution().getResolutionHeight())\n+        );\n+\n+        // get the first one - the Desired resolution to guarantee streaming will start\n+        validCapabilities.add(preferredCapability);\n+        for (VideoStreamingRange range: ranges) {\n+\n+            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n+            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n+\n+            for (VideoStreamingCapability capability : originalAdditionalCapabilities) {\n+                double diagonal;\n+                if (capability.getPreferredResolution() == null\n+                        || capability.getPreferredResolution().getResolutionHeight() == null\n+                        || capability.getPreferredResolution().getResolutionWidth() == null) {\n+                    continue;\n+                }\n+                if (capability.getDiagonalScreenSize() == null) {\n+                    diagonal = parameters.getPreferredDiagonal();\n+                } else {\n+                    diagonal = capability.getDiagonalScreenSize();\n+                }\n+\n+                if (range.getMinScreenDiagonal() > diagonal) {\n+                    continue;\n+                }\n+\n+                if (!isAspectRatioInRange(range.getAspectRatio(), capability.getPreferredResolution())) {\n+                    if (constraintHeightMax == null && constraintHeightMin == null) {\n+                        continue;\n+                    }\n+                }\n+\n+                if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n+                    continue;\n+                }\n+\n+                validCapabilities.add(capability);\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    public Boolean isImageResolutionInRange(Resolution minResolution, Resolution maxResolution, ImageResolution currentResolution) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 422}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDMzNjU1NQ==", "bodyText": "@kostyaBoss Per the proposal, isAspectRatioInRange should be defined as public Boolean isAspectRatioInRange(VideoStreamingRange range, ImageResolution currentResolution).\nYour definition is different because you take in an AspectRatio object instead of a VideoStreamingRange object. Do you need to change yours to match up with the proposal?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r540336555", "createdAt": "2020-12-10T16:58:20Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -648,6 +773,101 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            List<VideoStreamingCapability> originalAdditionalCapabilities\n+    ){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+\n+        VideoStreamingCapability preferredCapability = new VideoStreamingCapability();\n+        preferredCapability.setDiagonalScreenSize(parameters.getPreferredDiagonal());\n+        preferredCapability.setPreferredResolution(new ImageResolution(\n+                parameters.getResolution().getResolutionWidth(),\n+                parameters.getResolution().getResolutionHeight())\n+        );\n+\n+        // get the first one - the Desired resolution to guarantee streaming will start\n+        validCapabilities.add(preferredCapability);\n+        for (VideoStreamingRange range: ranges) {\n+\n+            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n+            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n+\n+            for (VideoStreamingCapability capability : originalAdditionalCapabilities) {\n+                double diagonal;\n+                if (capability.getPreferredResolution() == null\n+                        || capability.getPreferredResolution().getResolutionHeight() == null\n+                        || capability.getPreferredResolution().getResolutionWidth() == null) {\n+                    continue;\n+                }\n+                if (capability.getDiagonalScreenSize() == null) {\n+                    diagonal = parameters.getPreferredDiagonal();\n+                } else {\n+                    diagonal = capability.getDiagonalScreenSize();\n+                }\n+\n+                if (range.getMinScreenDiagonal() > diagonal) {\n+                    continue;\n+                }\n+\n+                if (!isAspectRatioInRange(range.getAspectRatio(), capability.getPreferredResolution())) {\n+                    if (constraintHeightMax == null && constraintHeightMin == null) {\n+                        continue;\n+                    }\n+                }\n+\n+                if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n+                    continue;\n+                }\n+\n+                validCapabilities.add(capability);\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    public Boolean isImageResolutionInRange(Resolution minResolution, Resolution maxResolution, ImageResolution currentResolution) {\n+\n+        Integer constraintHeightMax = maxResolution.getResolutionHeight();\n+        Integer constraintHeightMin = minResolution.getResolutionHeight();\n+        Integer constraintWidthMax = maxResolution.getResolutionWidth();\n+        Integer constraintWidthMin = minResolution.getResolutionWidth();\n+        Integer resolutionHeight = currentResolution.getResolutionHeight();\n+        Integer resolutionWidth = currentResolution.getResolutionWidth();\n+        if (currentResolution.getResolutionHeight() > 0 && currentResolution.getResolutionWidth() > 0 && constraintHeightMax != null && constraintHeightMin != null) {\n+            if (!(resolutionHeight >= constraintHeightMin && resolutionHeight <= constraintHeightMax)) {\n+                return false;\n+            }\n+\n+            if (!(resolutionWidth >= constraintWidthMin && resolutionWidth <= constraintWidthMax)) {\n+                return false;\n+            }\n+        }\n+\n+        // TODO check what if dev provided invalid constraints\n+        return true;\n+    }\n+\n+    public Boolean isAspectRatioInRange(AspectRatio aspectRatio, ImageResolution currentResolution) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3263ce13badd6e9d5b70025bc6ba5305bc758798"}, "originalPosition": 444}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4f78f57f6940dc76232ae3b067b5709a486c439", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/b4f78f57f6940dc76232ae3b067b5709a486c439", "committedDate": "2020-12-13T16:09:45Z", "message": "[0297]\n- Fix PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTUzMTM2MDc1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-553136075", "createdAt": "2020-12-16T00:02:15Z", "commit": {"oid": "b4f78f57f6940dc76232ae3b067b5709a486c439"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwMDowMjoxNVrOIGlfCw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xNlQwMDo1MjoyNVrOIGmq7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mzc3NjUyMw==", "bodyText": "@kostyaBoss On line 194 after the @ it should be since instead of sInCe.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r543776523", "createdAt": "2020-12-16T00:02:15Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -186,12 +186,26 @@ public VideoStreamingCapability setScale(Double scale) {\n     }\n \n     @SuppressWarnings(\"unchecked\")\n+    /**\n+     * Gets the additionalVideoStreamingCapabilities.\n+     *\n+     * @return List\n+     * {\"array_min_size\": 1, \"array_max_size\": 100}\n+     * @SInCE SmartDeviceLink 7.0.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4f78f57f6940dc76232ae3b067b5709a486c439"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mzc3NjgxMg==", "bodyText": "@kostyaBoss On line 205 after the @ it should be since instead of SInCE.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r543776812", "createdAt": "2020-12-16T00:02:59Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -186,12 +186,26 @@ public VideoStreamingCapability setScale(Double scale) {\n     }\n \n     @SuppressWarnings(\"unchecked\")\n+    /**\n+     * Gets the additionalVideoStreamingCapabilities.\n+     *\n+     * @return List\n+     * {\"array_min_size\": 1, \"array_max_size\": 100}\n+     * @SInCE SmartDeviceLink 7.0.0\n+     */\n     public List<VideoStreamingCapability> getAdditionalVideoStreamingCapabilities(){\n         return (List<VideoStreamingCapability>) getObject(VideoStreamingCapability.class, KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES);\n     }\n \n-    public VideoStreamingCapability setAdditionalVideoStreamingCapabilities(List<VideoStreamingCapability> capabilities) {\n-        setValue(KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES, capabilities);\n+    /**\n+     * Sets the additionalVideoStreamingCapabilities.\n+     *\n+     * @param additionalVideoStreamingCapabilities\n+     * {\"array_min_size\": 1, \"array_max_size\": 100}\n+     * @SInCE SmartDeviceLink 7.0.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4f78f57f6940dc76232ae3b067b5709a486c439"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mzc4MTc2NA==", "bodyText": "@kostyaBoss I checked out your code generator tool: https://github.com/LuxoftSDL/rpc_spec.git\nLines 3273-3296 define the VideoStreamingCapability struct.  If you place your AppCapability XML below that struct then you should be able to generate it.  Also the XML for AppCapabilityType (enum) should be placed above AppCapability XML when you do this.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r543781764", "createdAt": "2020-12-16T00:15:52Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package com.smartdevicelink.proxy.rpc;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4f78f57f6940dc76232ae3b067b5709a486c439"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mzc5NTk1MA==", "bodyText": "@kostyaBoss I generated this file using the code generator tool, and see a few differences between the file I am generating and yours.\nCan you regenerate this?  An extra step here is under the <enum name=FunctionID> tag you will need to define an element like this <element name=\"OnAppCapabilityUpdatedID\" value = \"32791\" hexvalue=\"8017\" since=\"7.1\"/> around line 3082 in the MOBILE_API.xml.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r543795950", "createdAt": "2020-12-16T00:52:25Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/OnAppCapabilityUpdated.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package com.smartdevicelink.proxy.rpc;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b4f78f57f6940dc76232ae3b067b5709a486c439"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b567009082a70f9bb8203743a70aa2ee9343bf96", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/b567009082a70f9bb8203743a70aa2ee9343bf96", "committedDate": "2021-01-06T12:28:29Z", "message": "[0296]\n- Add documentation on AppCapability"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzMjUzODM1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-563253835", "createdAt": "2021-01-07T07:10:30Z", "commit": {"oid": "b567009082a70f9bb8203743a70aa2ee9343bf96"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QwNzoxMDozMFrOIPhWqA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wN1QwNzoxNjoxNlrOIPheAA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzE0NjAyNA==", "bodyText": "@kostyaBoss I generated the AppCapability.java file using your generator tool.  There are a lot of differences between the generated AppCapability.java file and the one you are using.  I have attached the generated AppCapability.java here.   It is a .txt file but you can rename the extension to .java.\nAppCapability.txt", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r553146024", "createdAt": "2021-01-07T07:10:30Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package com.smartdevicelink.proxy.rpc;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mzc4MTc2NA=="}, "originalCommit": {"oid": "b4f78f57f6940dc76232ae3b067b5709a486c439"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzE0NzkwNA==", "bodyText": "@kostyaBoss  I generated the OnAppCapabilityUpdated.java file using your generator tool. There are a lot of differences between the generated OnAppCapabilityUpdated.java file and the one you are using. I have attached the generated OnAppCapabilityUpdated.java file\nOnAppCapabilityUpdated.txt\nhere. It is a .txt file but you can rename the extension to .java.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r553147904", "createdAt": "2021-01-07T07:16:16Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/OnAppCapabilityUpdated.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package com.smartdevicelink.proxy.rpc;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mzc5NTk1MA=="}, "originalCommit": {"oid": "b4f78f57f6940dc76232ae3b067b5709a486c439"}, "originalPosition": 1}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c4baa702f08326bf11b62ca21dd0ac24e77b1484", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c4baa702f08326bf11b62ca21dd0ac24e77b1484", "committedDate": "2021-01-11T11:14:26Z", "message": "[0296]\n- Applied generated code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY1NDU0ODU2", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-565454856", "createdAt": "2021-01-11T15:21:57Z", "commit": {"oid": "c4baa702f08326bf11b62ca21dd0ac24e77b1484"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f5da45a6a88e026b2b71fdf3368745f8990afbb", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/5f5da45a6a88e026b2b71fdf3368745f8990afbb", "committedDate": "2021-01-28T11:49:06Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4757db072a6e879de6eb220ffb5c2946e5dee78", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/a4757db072a6e879de6eb220ffb5c2946e5dee78", "committedDate": "2021-02-02T16:18:01Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/managers/lifecycle/SystemCapabilityManagerTests.java\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/test/rpc/datatypes/VideoStreamingCapabilityTests.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java\n#\tbase/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java\n#\tbase/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/11dda53863c1f1d48e86257606c9d2e91becb716", "committedDate": "2021-02-02T18:06:42Z", "message": "[0293]\n- Fix mr conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTgzODA0NDk4", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-583804498", "createdAt": "2021-02-04T20:54:47Z", "commit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "state": "COMMENTED", "comments": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wNFQyMDo1NDo0OFrOIgGz6Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wNFQyMTo0MDozNVrOIgIWRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDUzNjkzNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @since SmartDeviceLink 7.0.0\n          \n          \n            \n                 * @since SmartDeviceLink 7.1.0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570536937", "createdAt": "2021-02-04T20:54:48Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -50,6 +50,10 @@\n     public static final String KEY_PIXEL_PER_INCH = \"pixelPerInch\";\n     public static final String KEY_SCALE = \"scale\";\n     public static final String KEY_PREFERRED_FPS = \"preferredFPS\";\n+    /**\n+     * @since SmartDeviceLink 7.0.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDUzNzUwMg==", "bodyText": "Can you move this annotation to below the comment block?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570537502", "createdAt": "2021-02-04T20:55:50Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -182,6 +186,30 @@ public VideoStreamingCapability setScale(Double scale) {\n         return this;\n     }\n \n+    @SuppressWarnings(\"unchecked\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDUzNzYwMw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @since SmartDeviceLink 7.0.0\n          \n          \n            \n                 * @since SmartDeviceLink 7.1.0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570537603", "createdAt": "2021-02-04T20:55:59Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -182,6 +186,30 @@ public VideoStreamingCapability setScale(Double scale) {\n         return this;\n     }\n \n+    @SuppressWarnings(\"unchecked\")\n+    /**\n+     * Gets the additionalVideoStreamingCapabilities.\n+     *\n+     * @return List\n+     * {\"array_min_size\": 1, \"array_max_size\": 100}\n+     * @since SmartDeviceLink 7.0.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDUzNzY5MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @since SmartDeviceLink 7.0.0\n          \n          \n            \n                 * @since SmartDeviceLink 7.1.0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570537691", "createdAt": "2021-02-04T20:56:09Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -182,6 +186,30 @@ public VideoStreamingCapability setScale(Double scale) {\n         return this;\n     }\n \n+    @SuppressWarnings(\"unchecked\")\n+    /**\n+     * Gets the additionalVideoStreamingCapabilities.\n+     *\n+     * @return List\n+     * {\"array_min_size\": 1, \"array_max_size\": 100}\n+     * @since SmartDeviceLink 7.0.0\n+     */\n+    public List<VideoStreamingCapability> getAdditionalVideoStreamingCapabilities(){\n+        return (List<VideoStreamingCapability>) getObject(VideoStreamingCapability.class, KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES);\n+    }\n+\n+    /**\n+     * Sets the additionalVideoStreamingCapabilities.\n+     *\n+     * @param additionalVideoStreamingCapabilities\n+     * {\"array_min_size\": 1, \"array_max_size\": 100}\n+     * @since SmartDeviceLink 7.0.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDUzODA3Ng==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             *      <td>Used as a descriptor of what data to expect in this struct. The corresponding param tothis enum should be included and the only other param included.</td>\n          \n          \n            \n             *      <td>Used as a descriptor of what data to expect in this struct. The corresponding param to this enum should be included and the only other param included.</td>", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570538076", "createdAt": "2021-02-04T20:56:53Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,141 @@\n+/*\n+ * Copyright (c) 2017 - 2021, SmartDeviceLink Consortium, Inc.\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are met:\n+ *\n+ * Redistributions of source code must retain the above copyright notice, this\n+ * list of conditions and the following disclaimer.\n+ *\n+ * Redistributions in binary form must reproduce the above copyright notice,\n+ * this list of conditions and the following\n+ * disclaimer in the documentation and/or other materials provided with the\n+ * distribution.\n+ *\n+ * Neither the name of the SmartDeviceLink Consortium Inc. nor the names of\n+ * its contributors may be used to endorse or promote products derived\n+ * from this software without specific prior written permission.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n+ * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n+ * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n+ * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n+ * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n+ * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n+ * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n+ * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n+ * POSSIBILITY OF SUCH DAMAGE.\n+ */\n+package com.smartdevicelink.proxy.rpc;\n+\n+import androidx.annotation.NonNull;\n+\n+import com.smartdevicelink.proxy.RPCStruct;\n+import com.smartdevicelink.proxy.rpc.enums.AppCapabilityType;\n+\n+import java.util.Hashtable;\n+\n+/**\n+ *\n+ * <p><b>Parameter List</b></p>\n+ *\n+ * <table border=\"1\" rules=\"all\">\n+ *  <tr>\n+ *      <th>Param Name</th>\n+ *      <th>Type</th>\n+ *      <th>Description</th>\n+ *      <th>Required</th>\n+ *      <th>Notes</th>\n+ *      <th>Version Available</th>\n+ *  </tr>\n+ *  <tr>\n+ *      <td>appCapabilityType</td>\n+ *      <td>AppCapabilityType</td>\n+ *      <td>Used as a descriptor of what data to expect in this struct. The corresponding param tothis enum should be included and the only other param included.</td>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDUzOTAxMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * @since SmartDeviceLink 7.0\n          \n          \n            \n             * @since SmartDeviceLink 7.1.0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570539011", "createdAt": "2021-02-04T20:58:31Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/enums/AppCapabilityType.java", "diffHunk": "@@ -0,0 +1,23 @@\n+package com.smartdevicelink.proxy.rpc.enums;\n+\n+/**\n+ * @since SmartDeviceLink 7.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU0MDY2OQ==", "bodyText": "This File is missing the copyright because the generator was not used to create this file, Can you try again to generate this file using the generator as the PR for the rpc_spec has changed since you last tried?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570540669", "createdAt": "2021-02-04T21:01:43Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/enums/AppCapabilityType.java", "diffHunk": "@@ -0,0 +1,23 @@\n+package com.smartdevicelink.proxy.rpc.enums;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU0MjI3MQ==", "bodyText": "This Deprecated method does not exist on master or develop and is not being used in this PR.\nThis method should be removed.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570542271", "createdAt": "2021-02-04T21:04:48Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -216,6 +227,45 @@ public void update(VideoStreamingCapability capability, String vehicleMake) {\n             this.frameRate = Math.min(this.frameRate, capability.getPreferredFPS());\n         }\n \n+        // This should be the last call as it will return out once a suitable format is found\n+        final List<VideoStreamingFormat> formats = capability.getSupportedFormats();\n+        if(formats != null && formats.size()>0){\n+            for(VideoStreamingFormat format : formats){\n+                for(int i = 0; i < currentlySupportedFormats.length; i ++){\n+                    if(currentlySupportedFormats[i].equals(format) ){\n+                        this.format = format;\n+                        return;\n+                    }\n+                }\n+            }\n+            DebugTool.logWarning(TAG, \"The VideoStreamingFormat has not been updated because none of the provided formats are supported.\");\n+\n+            //TODO In the future we should set format to null, but might be a breaking change\n+            // For now, format will remain whatever was set prior to this update\n+        }\n+\n+    }\n+\n+    /**\n+     * Update the values contained in the capability that should have been returned through the SystemCapabilityManager.\n+     * This update will use the most preferred streaming format from the module.\n+     * @param capability the video streaming capability returned from the SystemCapabilityManager\n+     * @see com.smartdevicelink.managers.lifecycle.SystemCapabilityManager\n+     * @see VideoStreamingCapability\n+     */\n+    @Deprecated\n+    public void update(VideoStreamingCapability capability){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU0NDE4NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (capability.getDiagonalScreenSize() != null) { preferredDiagonal = capability.getDiagonalScreenSize(); }\n          \n          \n            \n                    if (capability.getDiagonalScreenSize() != null) {\n          \n          \n            \n                        preferredDiagonal = capability.getDiagonalScreenSize(); \n          \n          \n            \n                    }\n          \n      \n    \n    \n  \n\nTo maintain consistent formatting", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570544184", "createdAt": "2021-02-04T21:08:20Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -186,12 +194,15 @@ public void update(VideoStreamingCapability capability, String vehicleMake) {\n             int capableBitrateInKb = Math.min(Integer.MAX_VALUE / 1000, capability.getMaxBitrate());\n             this.bitrate = Math.min(this.bitrate, capableBitrateInKb * 1000);\n         } // NOTE: the unit of maxBitrate in getSystemCapability is kbps.\n-        double scale = DEFAULT_SCALE;\n-        // For resolution and scale, the capability values should be taken rather than parameters specified by developers.\n         if (capability.getScale() != null) {\n             scale = capability.getScale();\n         }\n+        if (capability.getDiagonalScreenSize() != null) { preferredDiagonal = capability.getDiagonalScreenSize(); }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU0NjU2OQ==", "bodyText": "This does not match the proposal and should replace AspectRatio aspectRatio with Double minAspectRatio and Double maxAspectRatio\nFrom the proposal:\npublic class VideoStreamingRange {\nprivate Resolution minResolution;\nprivate Resolution maxResolution;\nprivate Double minAspectRatio;\nprivate Double maxAspectRatio;\nprivate Double minScreenDiagonal;\n}", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570546569", "createdAt": "2021-02-04T21:12:48Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,64 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minResolution;\n+    private Resolution maxResolution;\n+    private Double minScreenDiagonal;\n+    private AspectRatio aspectRatio;\n+\n+    public VideoStreamingRange(\n+            Resolution minResolution,\n+            Resolution maxResolution,\n+            Double minScreenDiagonal,\n+            AspectRatio aspectRatio\n+    ) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU0NzAwMA==", "bodyText": "When VideoSrteamingRange is updated to match the proposal this class should no longer be needed", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570547000", "createdAt": "2021-02-04T21:13:37Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/AspectRatio.java", "diffHunk": "@@ -0,0 +1,19 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public class AspectRatio {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU0NzY1MA==", "bodyText": "Can you fix the formatting in this if statement?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570547650", "createdAt": "2021-02-04T21:14:55Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -203,9 +205,15 @@ public void run() {\n                     inputSurface = prepareVideoEncoder();\n \n                     // Create a virtual display that will output to our encoder.\n+                    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP && virtualDisplay != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU1ODg5OQ==", "bodyText": "Why was this changed to use 1920x1080 instead of the resolution defined in the streaming parameters?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570558899", "createdAt": "2021-02-04T21:34:51Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -203,9 +205,15 @@ public void run() {\n                     inputSurface = prepareVideoEncoder();\n \n                     // Create a virtual display that will output to our encoder.\n+                    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP && virtualDisplay != null) {\n+                    virtualDisplay.setSurface(inputSurface);\n+                }\n+                else {\n+                    // recreate after stop in most of cases\n                     virtualDisplay = mDisplayManager.createVirtualDisplay(TAG,\n-                            streamingParams.getResolution().getResolutionWidth(), streamingParams.getResolution().getResolutionHeight(),\n+                            predefinedWidth, predefinedHeight,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU1OTg2Ng==", "bodyText": "Can you remove this import and use DebugTool instead of android Log", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570559866", "createdAt": "2021-02-04T21:36:33Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -36,6 +36,7 @@\n import android.content.Context;\n import android.os.SystemClock;\n import android.util.DisplayMetrics;\n+import android.util.Log;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU2MDIxMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(majorProtocolVersion >= 5 && !isCapabilitySupported){\n          \n          \n            \n                    if (majorProtocolVersion >= 5 && !isCapabilitySupported) {", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570560211", "createdAt": "2021-02-04T21:37:06Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,45 +363,95 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n-        if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n+        if(majorProtocolVersion >= 5 && !isCapabilitySupported){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 199}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU2MDUyMw==", "bodyText": "This commented block should not be included in the changed", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570560523", "createdAt": "2021-02-04T21:37:40Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,45 +363,95 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n-        if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n+        if(majorProtocolVersion >= 5 && !isCapabilitySupported){\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n-        if (majorProtocolVersion >= 5) {\n-            if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n-                internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n-                    @Override\n-                    public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n-                    }\n+        if (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+            getVideoStreamingParams();\n+        }\n+        checkState();\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n \n-                    @Override\n-                    public void onError(String info) {\n-                        stateMachine.transitionToState(StreamingStateMachine.ERROR);\n-                        DebugTool.logError(TAG, \"Error retrieving video streaming capability: \" + info);\n-                    }\n-                }, false);\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> listOfStreamingRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        if (listOfStreamingRange != null) {\n+            this.listOfStreamingRanges = listOfStreamingRange;\n+        }\n+    }\n+//\n+//    // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+//        if (majorProtocolVersion >= 5) {\n+//        if (internalInterface.getSystemCapabilityManager() != null) {\n+//            final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n+//            internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n+//                @Override\n+//                public void onCapabilityRetrieved(Object capability) {\n+//                    params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n+//                    startStreaming(params, encrypted);\n+//                }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 246}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU2MDkxNQ==", "bodyText": "empty else statement should be removed\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        } else { }\n          \n          \n            \n                                        }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570560915", "createdAt": "2021-02-04T21:38:20Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,45 +363,95 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n-        if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n+        if(majorProtocolVersion >= 5 && !isCapabilitySupported){\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n-        if (majorProtocolVersion >= 5) {\n-            if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n-                internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n-                    @Override\n-                    public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n-                    }\n+        if (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+            getVideoStreamingParams();\n+        }\n+        checkState();\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n \n-                    @Override\n-                    public void onError(String info) {\n-                        stateMachine.transitionToState(StreamingStateMachine.ERROR);\n-                        DebugTool.logError(TAG, \"Error retrieving video streaming capability: \" + info);\n-                    }\n-                }, false);\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> listOfStreamingRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        if (listOfStreamingRange != null) {\n+            this.listOfStreamingRanges = listOfStreamingRange;\n+        }\n+    }\n+//\n+//    // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+//        if (majorProtocolVersion >= 5) {\n+//        if (internalInterface.getSystemCapabilityManager() != null) {\n+//            final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n+//            internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n+//                @Override\n+//                public void onCapabilityRetrieved(Object capability) {\n+//                    params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n+//                    startStreaming(params, encrypted);\n+//                }\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters){\n+        if (parameters == null) {\n+            if (majorProtocolVersion >= 5) {\n+                if (internalInterface.getSystemCapabilityManager() != null) {\n+                    internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n+                        @Override\n+                        public void onCapabilityRetrieved(Object capability) {\n+                            VideoStreamingParameters params = new VideoStreamingParameters();\n+                            VideoStreamingCapability castedCapability = ((VideoStreamingCapability)capability);\n+                            VideoStreamManager.this.originalCapability = castedCapability;\n+\n+                            params.update(castedCapability, vehicleMake);    //Streaming parameters are ready time to stream\n+                            VideoStreamManager.this.parameters = params;\n+\n+                            if (listOfStreamingRanges != null) {\n+                                // filtering\n+                                castedCapability.setAdditionalVideoStreamingCapabilities(\n+                                        getSupportedCapabilities(\n+                                                listOfStreamingRanges,\n+                                                castedCapability.getAdditionalVideoStreamingCapabilities()\n+                                        )\n+                                );\n+                            } else { }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 270}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MDU2MjExNw==", "bodyText": "Can you fix the formatting here, this line should not be indented", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r570562117", "createdAt": "2021-02-04T21:40:35Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -367,28 +501,32 @@ private void startEncoder() {\n      *\n      * @see #resumeStreaming()\n      */\n-    public void stopStreaming() {\n-        if (remoteDisplay != null) {\n+    public void stopStreaming(boolean withPendingRestart) {\n+        if (remoteDisplay != null && !withPendingRestart) {\n             remoteDisplay.stop();\n+                this.withPendingRestart = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 348}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg1NTU0MDc3", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-585554077", "createdAt": "2021-02-08T14:28:29Z", "commit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg1OTU3OTA1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-585957905", "createdAt": "2021-02-08T21:54:02Z", "commit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wOFQyMTo1NDowMlrOIh4kQw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wOFQyMTo1NDowMlrOIh4kQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MjQwMDcwNw==", "bodyText": "Currently with this implementation we do not update the existing parameters with the capabilities received. This was the goal of SDL 0323\nIf the parameters sent to this method are not null we still want to update them based on the capabilities received.\nI propose removing the check if parameters are null if (parameters == null) { and create params just before calling getCapability()\nfinal VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r572400707", "createdAt": "2021-02-08T21:54:02Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,45 +363,95 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n-        if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n+        if(majorProtocolVersion >= 5 && !isCapabilitySupported){\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n-        if (majorProtocolVersion >= 5) {\n-            if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n-                internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n-                    @Override\n-                    public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n-                    }\n+        if (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+            getVideoStreamingParams();\n+        }\n+        checkState();\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n \n-                    @Override\n-                    public void onError(String info) {\n-                        stateMachine.transitionToState(StreamingStateMachine.ERROR);\n-                        DebugTool.logError(TAG, \"Error retrieving video streaming capability: \" + info);\n-                    }\n-                }, false);\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> listOfStreamingRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        if (listOfStreamingRange != null) {\n+            this.listOfStreamingRanges = listOfStreamingRange;\n+        }\n+    }\n+//\n+//    // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+//        if (majorProtocolVersion >= 5) {\n+//        if (internalInterface.getSystemCapabilityManager() != null) {\n+//            final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n+//            internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n+//                @Override\n+//                public void onCapabilityRetrieved(Object capability) {\n+//                    params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n+//                    startStreaming(params, encrypted);\n+//                }\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters){\n+        if (parameters == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "11dda53863c1f1d48e86257606c9d2e91becb716"}, "originalPosition": 249}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "859057a09c27b8e2a4addcbc6c802f29b211dd77", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/859057a09c27b8e2a4addcbc6c802f29b211dd77", "committedDate": "2021-02-09T10:55:42Z", "message": "[0296]\n- Fix Pr comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "529cd7459374012b3ec0b41e4a6e0bbd962aacbd", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/529cd7459374012b3ec0b41e4a6e0bbd962aacbd", "committedDate": "2021-02-09T10:58:19Z", "message": "[0296]\n- Remove unused methods"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg2OTU2ODg3", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-586956887", "createdAt": "2021-02-09T20:06:00Z", "commit": {"oid": "529cd7459374012b3ec0b41e4a6e0bbd962aacbd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wOVQyMDowNjowMFrOIipWig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wOVQyMjowNDozN1rOIiuOMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MzIwMDAxMA==", "bodyText": "This will cause all apps to subscribe for VideoStreamingCapabilities even apps that dont use the Video Streaming feature. In the changes for VideoStreamManager you are adding a OnSystemCapabilityListener for VideoStreamingCapabilities.\nI dont believe this change to BaseSystemCapabilityManager is needed.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r573200010", "createdAt": "2021-02-09T20:06:00Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -90,6 +90,7 @@\n         this.cachedSystemCapabilities = new HashMap<>();\n         this.systemCapabilitiesSubscriptionStatus = new HashMap<>();\n         this.systemCapabilitiesSubscriptionStatus.put(SystemCapabilityType.DISPLAYS, true);\n+        this.systemCapabilitiesSubscriptionStatus.put(SystemCapabilityType.VIDEO_STREAMING, true);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "529cd7459374012b3ec0b41e4a6e0bbd962aacbd"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MzIwNDMzMQ==", "bodyText": "This is a public method on a public class and would technically be a breaking change.\nPlease revert the changes to shutdown() and deprecate it.\nThen implement shutdown(boolean withPendingRestart)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r573204331", "createdAt": "2021-02-09T20:13:12Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -217,7 +226,7 @@ public void run() {\n         }\n     }\n \n-    public void shutDown() {\n+    public void shutDown(boolean withPendingRestart) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "529cd7459374012b3ec0b41e4a6e0bbd962aacbd"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MzI0Njg2NA==", "bodyText": "This is a public method on a public class and would technically be a breaking change.\nPlease revert the changes to stopStreaming() and deprecate it.\nThen implement stopStreaming(boolean withPendingRestart)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r573246864", "createdAt": "2021-02-09T21:17:15Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -367,28 +485,32 @@ private void startEncoder() {\n      *\n      * @see #resumeStreaming()\n      */\n-    public void stopStreaming() {\n-        if (remoteDisplay != null) {\n+    public void stopStreaming(boolean withPendingRestart) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "529cd7459374012b3ec0b41e4a6e0bbd962aacbd"}, "originalPosition": 283}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MzI1NzQ3NQ==", "bodyText": "Why was this change made? to convert from the touchCoord value to the MotionEvent pointer wouldnt we still want to multiple by the scalar value?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r573257475", "createdAt": "2021-02-09T21:34:06Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -608,7 +737,7 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n             long eventTime = sdlMotionEvent.eventTime;\n             pointer = sdlMotionEvent.getPointerById(touchEvent.getId());\n             if (pointer != null) {\n-                pointer.setCoords(touchCoord.getX() * touchScalar[0], touchCoord.getY() * touchScalar[1]);\n+                pointer.setCoords(touchCoord.getX() / touchScalar[0], touchCoord.getY() / touchScalar[1]);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "529cd7459374012b3ec0b41e4a6e0bbd962aacbd"}, "originalPosition": 364}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MzI3NTMwNw==", "bodyText": "For this logic we should be verifying that the ranges constraints are correct and then if the current aspect ratio meets those constraints. with the current implementation we are only checking the currentAspectRatio if the constraints are incorrect\n        if (aspectRatioMax > aspectRatioMin && aspectRatioMin > 0) {\n            return currentAspectRatio >= aspectRatioMin && currentAspectRatio <= aspectRatioMax;\n        }\n        else {\n            return false;\n        }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r573275307", "createdAt": "2021-02-09T22:00:19Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +774,101 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            List<VideoStreamingCapability> originalAdditionalCapabilities\n+    ){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+\n+        VideoStreamingCapability preferredCapability = new VideoStreamingCapability();\n+        preferredCapability.setDiagonalScreenSize(parameters.getPreferredDiagonal());\n+        preferredCapability.setPreferredResolution(new ImageResolution(\n+                parameters.getResolution().getResolutionWidth(),\n+                parameters.getResolution().getResolutionHeight())\n+        );\n+\n+        // get the first one - the Desired resolution to guarantee streaming will start\n+        validCapabilities.add(preferredCapability);\n+        for (VideoStreamingRange range: ranges) {\n+\n+            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n+            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n+\n+            for (VideoStreamingCapability capability : originalAdditionalCapabilities) {\n+                double diagonal;\n+                if (capability.getPreferredResolution() == null\n+                        || capability.getPreferredResolution().getResolutionHeight() == null\n+                        || capability.getPreferredResolution().getResolutionWidth() == null) {\n+                    continue;\n+                }\n+                if (capability.getDiagonalScreenSize() == null) {\n+                    diagonal = parameters.getPreferredDiagonal();\n+                } else {\n+                    diagonal = capability.getDiagonalScreenSize();\n+                }\n+\n+                if (range.getMinScreenDiagonal() > diagonal) {\n+                    continue;\n+                }\n+\n+                if (!isAspectRatioInRange(range.getAspectRatio(), capability.getPreferredResolution())) {\n+                    if (constraintHeightMax == null && constraintHeightMin == null) {\n+                        continue;\n+                    }\n+                }\n+\n+                if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n+                    continue;\n+                }\n+\n+                validCapabilities.add(capability);\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    public Boolean isImageResolutionInRange(Resolution minResolution, Resolution maxResolution, ImageResolution currentResolution) {\n+\n+        Integer constraintHeightMax = maxResolution.getResolutionHeight();\n+        Integer constraintHeightMin = minResolution.getResolutionHeight();\n+        Integer constraintWidthMax = maxResolution.getResolutionWidth();\n+        Integer constraintWidthMin = minResolution.getResolutionWidth();\n+        Integer resolutionHeight = currentResolution.getResolutionHeight();\n+        Integer resolutionWidth = currentResolution.getResolutionWidth();\n+        if (currentResolution.getResolutionHeight() > 0 && currentResolution.getResolutionWidth() > 0 && constraintHeightMax != null && constraintHeightMin != null) {\n+            if (!(resolutionHeight >= constraintHeightMin && resolutionHeight <= constraintHeightMax)) {\n+                return false;\n+            }\n+\n+            if (!(resolutionWidth >= constraintWidthMin && resolutionWidth <= constraintWidthMax)) {\n+                return false;\n+            }\n+        }\n+\n+        // TODO check what if dev provided invalid constraints\n+        return true;\n+    }\n+\n+    public Boolean isAspectRatioInRange(AspectRatio aspectRatio, ImageResolution currentResolution) {\n+        Double aspectRatioMin = aspectRatio.getMinAspectRatio();\n+        Double aspectRatioMax = aspectRatio.getMaxAspectRatio();\n+\n+        Double currentAspectRatio = Double.valueOf(currentResolution.getResolutionWidth()) / Double.valueOf(currentResolution.getResolutionHeight());\n+\n+        if (!(aspectRatioMax > aspectRatioMin && aspectRatioMin > 0)) {\n+            if (!(currentAspectRatio >= aspectRatioMin && currentAspectRatio <= aspectRatioMax)) {\n+                return false;\n+            }\n+        }\n+        return true;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "529cd7459374012b3ec0b41e4a6e0bbd962aacbd"}, "originalPosition": 465}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MzI3OTc5NA==", "bodyText": "This TODO should be resolved before completion of this card, based on the iOS implementation we should return false if the range and constraints are invalid\nif (currentResolution.getResolutionHeight() > 0 && currentResolution.getResolutionWidth() > 0 && constraintHeightMax != null && constraintHeightMin != null) {\n            if (!(resolutionHeight >= constraintHeightMin && resolutionHeight <= constraintHeightMax)) {\n                return false;\n            }\n\n            if (!(resolutionWidth >= constraintWidthMin && resolutionWidth <= constraintWidthMax)) {\n                return false;\n            }\n\n            return true;\n        } else {\n            return false;\n        }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r573279794", "createdAt": "2021-02-09T22:04:37Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +774,101 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            List<VideoStreamingCapability> originalAdditionalCapabilities\n+    ){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+\n+        VideoStreamingCapability preferredCapability = new VideoStreamingCapability();\n+        preferredCapability.setDiagonalScreenSize(parameters.getPreferredDiagonal());\n+        preferredCapability.setPreferredResolution(new ImageResolution(\n+                parameters.getResolution().getResolutionWidth(),\n+                parameters.getResolution().getResolutionHeight())\n+        );\n+\n+        // get the first one - the Desired resolution to guarantee streaming will start\n+        validCapabilities.add(preferredCapability);\n+        for (VideoStreamingRange range: ranges) {\n+\n+            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n+            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n+\n+            for (VideoStreamingCapability capability : originalAdditionalCapabilities) {\n+                double diagonal;\n+                if (capability.getPreferredResolution() == null\n+                        || capability.getPreferredResolution().getResolutionHeight() == null\n+                        || capability.getPreferredResolution().getResolutionWidth() == null) {\n+                    continue;\n+                }\n+                if (capability.getDiagonalScreenSize() == null) {\n+                    diagonal = parameters.getPreferredDiagonal();\n+                } else {\n+                    diagonal = capability.getDiagonalScreenSize();\n+                }\n+\n+                if (range.getMinScreenDiagonal() > diagonal) {\n+                    continue;\n+                }\n+\n+                if (!isAspectRatioInRange(range.getAspectRatio(), capability.getPreferredResolution())) {\n+                    if (constraintHeightMax == null && constraintHeightMin == null) {\n+                        continue;\n+                    }\n+                }\n+\n+                if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n+                    continue;\n+                }\n+\n+                validCapabilities.add(capability);\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    public Boolean isImageResolutionInRange(Resolution minResolution, Resolution maxResolution, ImageResolution currentResolution) {\n+\n+        Integer constraintHeightMax = maxResolution.getResolutionHeight();\n+        Integer constraintHeightMin = minResolution.getResolutionHeight();\n+        Integer constraintWidthMax = maxResolution.getResolutionWidth();\n+        Integer constraintWidthMin = minResolution.getResolutionWidth();\n+        Integer resolutionHeight = currentResolution.getResolutionHeight();\n+        Integer resolutionWidth = currentResolution.getResolutionWidth();\n+        if (currentResolution.getResolutionHeight() > 0 && currentResolution.getResolutionWidth() > 0 && constraintHeightMax != null && constraintHeightMin != null) {\n+            if (!(resolutionHeight >= constraintHeightMin && resolutionHeight <= constraintHeightMax)) {\n+                return false;\n+            }\n+\n+            if (!(resolutionWidth >= constraintWidthMin && resolutionWidth <= constraintWidthMax)) {\n+                return false;\n+            }\n+        }\n+\n+        // TODO check what if dev provided invalid constraints", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "529cd7459374012b3ec0b41e4a6e0bbd962aacbd"}, "originalPosition": 449}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad4e19bd2605be894df97e0603bcd43c2cf5482e", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/ad4e19bd2605be894df97e0603bcd43c2cf5482e", "committedDate": "2021-02-10T09:51:57Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "331ea3dfa64f2033ba19dba697ac23ac75ff1380", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/331ea3dfa64f2033ba19dba697ac23ac75ff1380", "committedDate": "2021-02-10T10:52:07Z", "message": "[0296]\n- Fix PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aaba8bbdf752ee5f91461be26177f0cc33cad244", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/aaba8bbdf752ee5f91461be26177f0cc33cad244", "committedDate": "2021-02-10T17:18:23Z", "message": "[0296]\n- Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cbe9e7213f1d9f9a8c591f27e5400ad935d9441", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/1cbe9e7213f1d9f9a8c591f27e5400ad935d9441", "committedDate": "2021-02-10T17:43:36Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c831a35cc1dff28d55ffcf39580f78f8977db22", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/3c831a35cc1dff28d55ffcf39580f78f8977db22", "committedDate": "2021-02-10T18:20:25Z", "message": "[0296]\n- Remove aspect ration class\n- Fix builder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91", "committedDate": "2021-02-10T18:46:48Z", "message": "[0296]\n- Revert predefined display"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg3OTY2NTU0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-587966554", "createdAt": "2021-02-10T19:21:14Z", "commit": {"oid": "3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMFQxOToyNDowMVrOIja2Dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMFQxOTo0NzoyMVrOIjbwLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDAxMDg5NA==", "bodyText": "Should we also add an update for preferredDiagonalScreenSize if it is available to this method?\nif (!params.preferredDiagonal != null) {\n    this.preferredDiagonal = params.preferredDiagonal\n}", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574010894", "createdAt": "2021-02-10T19:24:01Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -166,6 +170,10 @@ public void update(VideoStreamingParameters params) {\n             if (params.format != null) {\n                 this.format = params.format;\n             }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDAxMzAxNg==", "bodyText": "I feel we should add this check back in, if the format is already set we do not need to iterate over the rest of them\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(formats != null && formats.size()>0){\n          \n          \n            \n                    if(formats != null && formats.size()>0){\n          \n          \n            \n                        if (this.format != null && formats.contains(this.format)) {\n          \n          \n            \n                            return; // given format is supported, so no need to change.\n          \n          \n            \n                        }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574013016", "createdAt": "2021-02-10T19:27:19Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -218,13 +231,10 @@ public void update(VideoStreamingCapability capability, String vehicleMake) {\n \n         // This should be the last call as it will return out once a suitable format is found\n         final List<VideoStreamingFormat> formats = capability.getSupportedFormats();\n-        if (formats != null && formats.size() > 0) {\n-            if (this.format != null && formats.contains(this.format)) {\n-                return; // given format is supported, so no need to change.\n-            }\n-            for (VideoStreamingFormat format : formats) {\n-                for (VideoStreamingFormat currentlySupportedFormat : currentlySupportedFormats) {\n-                    if (currentlySupportedFormat.equals(format)) {\n+        if(formats != null && formats.size()>0){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDAxNzM3Mg==", "bodyText": "I believe these lines can be removed\nif (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n        getVideoStreamingParams();\n}\ncheckState();\n\nWhen we call processCapabilitiesWithPendingStart() then the params will be setup properly based on the capabilities", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574017372", "createdAt": "2021-02-10T19:34:00Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -274,6 +325,31 @@ public void onError(String info) {\n         }\n     }\n \n+    /**\n+     * Starts streaming a remote display to the module if there is a connected session. This method of streaming requires the device to be on API level 19 or higher\n+     *\n+     * @param context            a context that can be used to create the remote display\n+     * @param remoteDisplayClass class object of the remote display. This class will be used to create an instance of the remote display and will be projected to the module\n+     * @param parameters         streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n+     *                           If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n+     *                           works best for the currently connected module.\n+     * @param encrypted         a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n+     * @param landscapeRange    constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+     * @param portraitRange     constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+     */\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted, VideoStreamingRange landscapeRange, VideoStreamingRange portraitRange) {\n+        Collections.addAll(listOfStreamingRanges, portraitRange, landscapeRange);\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, listOfStreamingRanges);\n+        if(majorProtocolVersion >= 5 && !internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING)){\n+            stateMachine.transitionToState(StreamingStateMachine.ERROR);\n+            return;\n+        }\n+        if (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+            getVideoStreamingParams();\n+        }\n+        checkState();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91"}, "originalPosition": 165}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDAxNzg4Nw==", "bodyText": "I believe these lines can be removed\nif (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n        getVideoStreamingParams();\n}\ncheckState();\n\nWhen we call processCapabilitiesWithPendingStart() then the params will be setup properly based on the capabilities", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574017887", "createdAt": "2021-02-10T19:34:50Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +360,62 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n         if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+        if (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+            getVideoStreamingParams();\n+        }\n+        checkState();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91"}, "originalPosition": 192}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDAyMTMwOQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    VideoStreamingParameters params = new VideoStreamingParameters();\n          \n      \n    \n    \n  \n\nBy removing this line the params created at the begining of processCapabilitiesWithPendingStart will be used and then will be updated based on the capability retrieved", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574021309", "createdAt": "2021-02-10T19:40:02Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +360,62 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n         if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+        if (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+            getVideoStreamingParams();\n+        }\n+        checkState();\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n+\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> listOfStreamingRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        if (listOfStreamingRange != null) {\n+            this.listOfStreamingRanges = listOfStreamingRange;\n+        }\n+    }\n+\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters) {\n+        final VideoStreamingParameters params = (parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n         if (majorProtocolVersion >= 5) {\n             if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n                 internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n                     @Override\n                     public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n+                        VideoStreamingParameters params = new VideoStreamingParameters();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91"}, "originalPosition": 217}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDAyNDIzMQ==", "bodyText": "To maintain alignment with the iOS library and since the proposal is to Stop the Video stream and then start it again I recommend that we should not add a PAUSED state and should use the STOPPED state where appropriate", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574024231", "createdAt": "2021-02-10T19:44:53Z", "author": {"login": "RHenigan"}, "path": "base/src/main/java/com/smartdevicelink/managers/StreamingStateMachine.java", "diffHunk": "@@ -37,12 +37,12 @@\n import java.lang.annotation.RetentionPolicy;\n \n public class StreamingStateMachine {\n-    @IntDef({NONE, READY, STARTED, STOPPED, ERROR})\n+    @IntDef({NONE, READY, STARTED, STOPPED, ERROR, PAUSED})", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDAyNTc3Mw==", "bodyText": "Fix the formatting of this else statement so it is inline with the correct if statement", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574025773", "createdAt": "2021-02-10T19:47:21Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -203,9 +204,15 @@ public void run() {\n                     inputSurface = prepareVideoEncoder();\n \n                     // Create a virtual display that will output to our encoder.\n+                    if (Build.VERSION.SDK_INT >= VERSION_CODES.LOLLIPOP && virtualDisplay != null) {\n+                        virtualDisplay.setSurface(inputSurface);\n+                    }\n+                else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3c10fd78c9d04406de86b4e3c1134a5fbd3e8e91"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "87fe074595b540ce4f7bab8e90923e44b3243945", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/87fe074595b540ce4f7bab8e90923e44b3243945", "committedDate": "2021-02-10T20:19:33Z", "message": "[0296]\n- Fix PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0350d01ae3e44697fedd8c8d319e59a6ef05019", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/f0350d01ae3e44697fedd8c8d319e59a6ef05019", "committedDate": "2021-02-10T20:39:40Z", "message": "[0296]\n- Simplify format processing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg4MDUwNDAz", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-588050403", "createdAt": "2021-02-10T21:02:19Z", "commit": {"oid": "f0350d01ae3e44697fedd8c8d319e59a6ef05019"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMFQyMTowMjoxOVrOIjetJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMFQyMTowMjoxOVrOIjetJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDA3NDE1MA==", "bodyText": "@kostyaBoss As the VideoStreamService will be stopped and restarted, we can still dispose of the virtualDisplay in this case as it will be recreated when the VideoStreamService starts again.\nSince this is the case we do not need a new shutDown method and can continue to use the old one", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574074150", "createdAt": "2021-02-10T21:02:19Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -258,6 +265,47 @@ public void shutDown() {\n         }\n     }\n \n+    public void shutDown(boolean withPendingRestart) {\n+        if (!initPassed) {\n+            DebugTool.logError(TAG, \"VirtualDisplayEncoder was not properly initialized with the init() method.\");\n+            return;\n+        }\n+        try {\n+            // cleanup GLES stuff\n+            if (mCaptureThread != null) {\n+                mCaptureThread.stopAsync();\n+                try {\n+                    mCaptureThread.join();\n+                } catch(InterruptedException e) {\n+\n+                }\n+                mCaptureThread = null;\n+            }\n+            if (encoderThread != null) {\n+                encoderThread.interrupt();\n+                encoderThread = null;\n+            }\n+\n+            if (mVideoEncoder != null) {\n+                mVideoEncoder.stop();\n+                mVideoEncoder.release();\n+                mVideoEncoder = null;\n+            }\n+\n+            if (virtualDisplay != null && !withPendingRestart) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0350d01ae3e44697fedd8c8d319e59a6ef05019"}, "originalPosition": 83}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ae9087f6733950414cdcc28f8efc97c9b3dac1e", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/5ae9087f6733950414cdcc28f8efc97c9b3dac1e", "committedDate": "2021-02-11T20:32:47Z", "message": "[0296]\n- Remove paused state"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg4OTIwMTg1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-588920185", "createdAt": "2021-02-11T19:40:00Z", "commit": {"oid": "f0350d01ae3e44697fedd8c8d319e59a6ef05019"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMVQxOTo0MDowMFrOIkJlEA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMVQyMDoxMTozNVrOIkKvlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDc3NjU5Mg==", "bodyText": "This will cause an error when called here because the HMI is not FULL yet. I recommned moving this to the hmiListener onNotified method\nif (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel())) {\n                    if (VideoStreamManager.this.parameters == null) {\n                        getVideoStreamingParams();\n                    }\n                    internalInterface.getSystemCapabilityManager().addOnSystemCapabilityListener(SystemCapabilityType.VIDEO_STREAMING, systemCapabilityListener);\n }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574776592", "createdAt": "2021-02-11T19:40:00Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -209,7 +259,8 @@ public VideoStreamManager(ISdl internalInterface) {\n         internalInterface.addOnRPCNotificationListener(FunctionID.ON_TOUCH_EVENT, touchListener);\n         // Listen for HMILevel changes\n         internalInterface.addOnRPCNotificationListener(FunctionID.ON_HMI_STATUS, hmiListener);\n-\n+        // Listen for SystemCapabilityType VIDEO_STREAMING\n+        internalInterface.getSystemCapabilityManager().addOnSystemCapabilityListener(SystemCapabilityType.VIDEO_STREAMING, systemCapabilityListener);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0350d01ae3e44697fedd8c8d319e59a6ef05019"}, "originalPosition": 118}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDc3Nzk3Mg==", "bodyText": "to avoid an exception when calling startRemoteDisplayStream i recommend setting listOfStreamingRanges as an empty ArrayList with a starting size of 1\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private List<VideoStreamingRange> listOfStreamingRanges;\n          \n          \n            \n                private List<VideoStreamingRange> listOfStreamingRanges = new ArrayList<>(1);", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574777972", "createdAt": "2021-02-11T19:42:22Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -101,10 +106,15 @@\n     private OnHMIStatus currentOnHMIStatus;\n     private final StreamingStateMachine stateMachine;\n     private VideoStreamingParameters parameters;\n+    private VideoStreamingCapability originalCapability;\n     private IVideoStreamListener streamListener;\n     private boolean isTransportAvailable = false;\n+    private Integer majorProtocolVersion;\n+    private List<VideoStreamingRange> listOfStreamingRanges;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0350d01ae3e44697fedd8c8d319e59a6ef05019"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDc5NTY2OQ==", "bodyText": "This should be split into two seperate setters, setMaxAspectRatio and setMinAspectRatio", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574795669", "createdAt": "2021-02-11T20:11:35Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,75 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minResolution;\n+    private Resolution maxResolution;\n+    private Double minScreenDiagonal;\n+    private Double minAspectRatio;\n+    private Double maxAspectRatio;\n+\n+    public VideoStreamingRange(\n+            Resolution minResolution,\n+            Resolution maxResolution,\n+            Double minScreenDiagonal,\n+            Double minAspectRatio,\n+            Double maxAspectRatio\n+    ) {\n+        this.minResolution = minResolution;\n+        this.maxResolution = maxResolution;\n+        this.minScreenDiagonal = minScreenDiagonal;\n+        this.minAspectRatio = minAspectRatio;\n+        this.maxAspectRatio = maxAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinResolution() {\n+        return minResolution;\n+    }\n+\n+    public Resolution getMaxResolution() {\n+        return maxResolution;\n+    }\n+\n+    public Double getMinScreenDiagonal() {\n+        return minScreenDiagonal;\n+    }\n+\n+    public Double getMinAspectRatio() {\n+        return minAspectRatio;\n+    }\n+\n+    public Double getMaxAspectRatio() {\n+        return maxAspectRatio;\n+    }\n+\n+    public static class Builder {\n+        private VideoStreamingRange range = new VideoStreamingRange();\n+        private Double maxAspectRatio;\n+\n+        public Builder setMinSupportedResolution(Resolution minSupportedResolution) {\n+            range.minResolution = minSupportedResolution;\n+            return this;\n+        }\n+\n+        public Builder setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+            range.maxResolution = maxSupportedResolution;\n+            return this;\n+        }\n+\n+        public Builder setMinScreenDiagonal(Double minScreenDiagonal) {\n+            range.minScreenDiagonal = minScreenDiagonal;\n+            return this;\n+        }\n+        public Builder setAspectRatio(Double minAspectRatio, Double maxAspectRatio) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0350d01ae3e44697fedd8c8d319e59a6ef05019"}, "originalPosition": 65}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a96a475a7329b4023af345838be42bc5b11996c", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/6a96a475a7329b4023af345838be42bc5b11996c", "committedDate": "2021-02-11T21:03:30Z", "message": "[0296]\n- Fix pr comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7511035d76584cf000a5809cc1b96643c4902a8f", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/7511035d76584cf000a5809cc1b96643c4902a8f", "committedDate": "2021-02-11T21:39:48Z", "message": "[0296]\n- Fix pr comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg5MDEwMTk3", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-589010197", "createdAt": "2021-02-11T21:41:44Z", "commit": {"oid": "6a96a475a7329b4023af345838be42bc5b11996c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMVQyMTo0MTo0NFrOIkN09Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMVQyMTo0MTo0NFrOIkN09Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg0NjE5Nw==", "bodyText": "@kostyaBoss I noticed a bug while testing RTP where on resize the protocol would change back to RAW (the default value)\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        VideoStreamingParameters params = new VideoStreamingParameters();\n          \n          \n            \n                       VideoStreamingParameters params = (parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n          \n      \n    \n    \n  \n\nThis fixes the issue as the previously set parameters will be used and then updated based on the capability received", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574846197", "createdAt": "2021-02-11T21:41:44Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -192,6 +214,37 @@ public void onNotified(RPCNotification notification) {\n         }\n     };\n \n+    private final OnSystemCapabilityListener systemCapabilityListener = new OnSystemCapabilityListener() {\n+        @Override\n+        public void onCapabilityRetrieved(Object capability) {\n+            VideoStreamingParameters params = new VideoStreamingParameters();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6a96a475a7329b4023af345838be42bc5b11996c"}, "originalPosition": 95}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg5MDEyNzUy", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-589012752", "createdAt": "2021-02-11T21:45:10Z", "commit": {"oid": "7511035d76584cf000a5809cc1b96643c4902a8f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMVQyMTo0NToxMFrOIkN8ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMVQyMTo0NToxMFrOIkN8ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg0ODEzOA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    public Builder setMaxAspectRation(Double maxAspectRatio) {\n          \n          \n            \n                    public Builder setMaxAspectRatio(Double maxAspectRatio) {", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574848138", "createdAt": "2021-02-11T21:45:10Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minResolution;\n+    private Resolution maxResolution;\n+    private Double minScreenDiagonal;\n+    private Double minAspectRatio;\n+    private Double maxAspectRatio;\n+\n+    public VideoStreamingRange(\n+            Resolution minResolution,\n+            Resolution maxResolution,\n+            Double minScreenDiagonal,\n+            Double minAspectRatio,\n+            Double maxAspectRatio\n+    ) {\n+        this.minResolution = minResolution;\n+        this.maxResolution = maxResolution;\n+        this.minScreenDiagonal = minScreenDiagonal;\n+        this.minAspectRatio = minAspectRatio;\n+        this.maxAspectRatio = maxAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinResolution() {\n+        return minResolution;\n+    }\n+\n+    public Resolution getMaxResolution() {\n+        return maxResolution;\n+    }\n+\n+    public Double getMinScreenDiagonal() {\n+        return minScreenDiagonal;\n+    }\n+\n+    public Double getMinAspectRatio() {\n+        return minAspectRatio;\n+    }\n+\n+    public Double getMaxAspectRatio() {\n+        return maxAspectRatio;\n+    }\n+\n+    public static class Builder {\n+        private VideoStreamingRange range = new VideoStreamingRange();\n+        private Double maxAspectRatio;\n+\n+        public Builder setMinSupportedResolution(Resolution minSupportedResolution) {\n+            range.minResolution = minSupportedResolution;\n+            return this;\n+        }\n+\n+        public Builder setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+            range.maxResolution = maxSupportedResolution;\n+            return this;\n+        }\n+\n+        public Builder setMinScreenDiagonal(Double minScreenDiagonal) {\n+            range.minScreenDiagonal = minScreenDiagonal;\n+            return this;\n+        }\n+        public Builder setMinAspectRatio(Double minAspectRatio) {\n+            range.minAspectRatio = minAspectRatio;\n+            return this;\n+        }\n+\n+        public Builder setMaxAspectRation(Double maxAspectRatio) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7511035d76584cf000a5809cc1b96643c4902a8f"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg5MDI1NDgw", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-589025480", "createdAt": "2021-02-11T22:03:36Z", "commit": {"oid": "7511035d76584cf000a5809cc1b96643c4902a8f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMVQyMjowMzozNlrOIkOkDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMVQyMjowMzozNlrOIkOkDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NDg1ODI1NQ==", "bodyText": "We should add a null check for originalAdditionalCapabilities, it is possible for the HMI to send additionalVideoStreamingCapabilities as null and if that is the case there will be a NPE here", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r574858255", "createdAt": "2021-02-11T22:03:36Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +780,101 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            List<VideoStreamingCapability> originalAdditionalCapabilities\n+    ){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+\n+        VideoStreamingCapability preferredCapability = new VideoStreamingCapability();\n+        preferredCapability.setDiagonalScreenSize(parameters.getPreferredDiagonal());\n+        preferredCapability.setPreferredResolution(new ImageResolution(\n+                parameters.getResolution().getResolutionWidth(),\n+                parameters.getResolution().getResolutionHeight())\n+        );\n+\n+        // get the first one - the Desired resolution to guarantee streaming will start\n+        validCapabilities.add(preferredCapability);\n+        for (VideoStreamingRange range: ranges) {\n+\n+            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n+            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n+\n+            for (VideoStreamingCapability capability : originalAdditionalCapabilities) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7511035d76584cf000a5809cc1b96643c4902a8f"}, "originalPosition": 395}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39e217cddb6367def452380743edb67a2df027a6", "author": {"user": {"login": "kboskin", "name": "Kostiantyn Boskin"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/39e217cddb6367def452380743edb67a2df027a6", "committedDate": "2021-02-11T22:26:01Z", "message": "Update android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java\n\nCo-authored-by: Robert Henigan <heniganr1@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b9085044879f3132e2cf3fe56ad83c8822b82a0", "author": {"user": {"login": "kboskin", "name": "Kostiantyn Boskin"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/9b9085044879f3132e2cf3fe56ad83c8822b82a0", "committedDate": "2021-02-11T22:26:26Z", "message": "Update android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java\n\nCo-authored-by: Robert Henigan <heniganr1@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "717e68f447dc27e5866547e03d355cbb5179152b", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/717e68f447dc27e5866547e03d355cbb5179152b", "committedDate": "2021-02-11T22:29:08Z", "message": "[0296]\n- Add null check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8be00fae441f2a7de8b22764f8da3cd020098e87", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/8be00fae441f2a7de8b22764f8da3cd020098e87", "committedDate": "2021-02-11T22:34:20Z", "message": "Merge branch 'feature/0296_possibility_to_update_video_streaming_capabilities' of https://github.com/LuxoftSDL/sdl_java_suite into feature/0296_possibility_to_update_video_streaming_capabilities"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg5NzUwOTA2", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-589750906", "createdAt": "2021-02-12T18:50:37Z", "commit": {"oid": "8be00fae441f2a7de8b22764f8da3cd020098e87"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMlQxODo1MDozN1rOIky3Tw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMlQxODo1MDozN1rOIky3Tw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTQ1MzAwNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    OnAppCapabilityUpdated onAppCapabilityUpdated = new OnAppCapabilityUpdated();\n          \n          \n            \n                                    OnAppCapabilityUpdated onAppCapabilityUpdated = new OnAppCapabilityUpdated();\n          \n          \n            \n                                    onAppCapabilityUpdated.setAppCapability(appCapability);\n          \n      \n    \n    \n  \n\n@kostyaBoss the negotiate list of VideoStreamingCapabilities are not being sent back to the hmi, currently the OnAppCapabilityUpdated rpc is empty", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r575453007", "createdAt": "2021-02-12T18:50:37Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +357,57 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n         if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n+\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> listOfStreamingRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        if (listOfStreamingRange != null) {\n+            this.listOfStreamingRanges = listOfStreamingRange;\n+        }\n+    }\n+\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters) {\n+        final VideoStreamingParameters params = (parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n         if (majorProtocolVersion >= 5) {\n             if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n                 internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n                     @Override\n                     public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n+                        VideoStreamingCapability castedCapability = ((VideoStreamingCapability) capability);\n+                        VideoStreamManager.this.originalCapability = castedCapability;\n+\n+                        params.update(castedCapability, vehicleMake);    //Streaming parameters are ready time to stream\n+                        VideoStreamManager.this.parameters = params;\n+\n+                        if (listOfStreamingRanges != null) {\n+                            // filtering\n+                            castedCapability.setAdditionalVideoStreamingCapabilities(\n+                                    getSupportedCapabilities(\n+                                            listOfStreamingRanges,\n+                                            castedCapability.getAdditionalVideoStreamingCapabilities()\n+                                    )\n+                            );\n+                        }\n+                        AppCapability appCapability = new AppCapability();\n+                        appCapability.setVideoStreamingCapability(castedCapability);\n+\n+                        OnAppCapabilityUpdated onAppCapabilityUpdated = new OnAppCapabilityUpdated();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8be00fae441f2a7de8b22764f8da3cd020098e87"}, "originalPosition": 239}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8cb97c8a0afa47fe3e3b7e3cae24933e7836ac26", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/8cb97c8a0afa47fe3e3b7e3cae24933e7836ac26", "committedDate": "2021-02-12T18:53:46Z", "message": "[0296]\n- Send appCapability"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg5NzU5MDIz", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-589759023", "createdAt": "2021-02-12T19:02:37Z", "commit": {"oid": "8cb97c8a0afa47fe3e3b7e3cae24933e7836ac26"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMlQxOTowMjozN1rOIkzQmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xMlQxOTowMjozN1rOIkzQmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NTQ1OTQ4Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    appCapability.setVideoStreamingCapability(castedCapability);\n          \n          \n            \n                                    appCapability.setAppCapabilityType(AppCapabilityType.VIDEO_STREAMING);\n          \n          \n            \n                                    appCapability.setVideoStreamingCapability(castedCapability);\n          \n      \n    \n    \n  \n\n@kostyaBoss AppCapabilityType also needs to be set", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r575459482", "createdAt": "2021-02-12T19:02:37Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +357,57 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n         if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n+\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> listOfStreamingRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        if (listOfStreamingRange != null) {\n+            this.listOfStreamingRanges = listOfStreamingRange;\n+        }\n+    }\n+\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters) {\n+        final VideoStreamingParameters params = (parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n         if (majorProtocolVersion >= 5) {\n             if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n                 internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n                     @Override\n                     public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n+                        VideoStreamingCapability castedCapability = ((VideoStreamingCapability) capability);\n+                        VideoStreamManager.this.originalCapability = castedCapability;\n+\n+                        params.update(castedCapability, vehicleMake);    //Streaming parameters are ready time to stream\n+                        VideoStreamManager.this.parameters = params;\n+\n+                        if (listOfStreamingRanges != null) {\n+                            // filtering\n+                            castedCapability.setAdditionalVideoStreamingCapabilities(\n+                                    getSupportedCapabilities(\n+                                            listOfStreamingRanges,\n+                                            castedCapability.getAdditionalVideoStreamingCapabilities()\n+                                    )\n+                            );\n+                        }\n+                        AppCapability appCapability = new AppCapability();\n+                        appCapability.setVideoStreamingCapability(castedCapability);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8cb97c8a0afa47fe3e3b7e3cae24933e7836ac26"}, "originalPosition": 237}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27affe53901b2401a0eecfa62b0d1a37868ab761", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/27affe53901b2401a0eecfa62b0d1a37868ab761", "committedDate": "2021-02-12T19:04:27Z", "message": "[0296]\n- Send appCapability type"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTkwNjc5MTAx", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-590679101", "createdAt": "2021-02-15T18:02:03Z", "commit": {"oid": "27affe53901b2401a0eecfa62b0d1a37868ab761"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xNVQxODowMjowNFrOIlp_qg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xNVQxODoyMzozOFrOIlqhFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjM1NjI2Ng==", "bodyText": "@kostyaBoss Now that we have reverted the change to the shutdown method of VirtualDisplayEncoder do we still need this change here?\nIf not I believe all changes in this file can be reverted", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r576356266", "createdAt": "2021-02-15T18:02:04Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -203,9 +204,14 @@ public void run() {\n                     inputSurface = prepareVideoEncoder();\n \n                     // Create a virtual display that will output to our encoder.\n-                    virtualDisplay = mDisplayManager.createVirtualDisplay(TAG,\n-                            streamingParams.getResolution().getResolutionWidth(), streamingParams.getResolution().getResolutionHeight(),\n-                            streamingParams.getDisplayDensity(), inputSurface, DisplayManager.VIRTUAL_DISPLAY_FLAG_PRESENTATION);\n+                    if (Build.VERSION.SDK_INT >= VERSION_CODES.LOLLIPOP && virtualDisplay != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27affe53901b2401a0eecfa62b0d1a37868ab761"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjM2MzA4NA==", "bodyText": "Hello @kostyaBoss I dont this that this should be made public as this should only ever be called with TRUE from within the library and for any cases where the developer would be calling this method with FALSE I believe it would be better to use the existing stopStreaming method.\nI propose removing the deprecated annotation from the existing stopStreaming method and making this method private", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r576363084", "createdAt": "2021-02-15T18:19:06Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -377,18 +488,37 @@ public void stopStreaming() {\n         stateMachine.transitionToState(StreamingStateMachine.STOPPED);\n     }\n \n+    /**\n+     * Stops streaming from the remote display. To restart, call\n+     *\n+     * @see #resumeStreaming()\n+     */\n+    public void stopStreaming(boolean withPendingRestart) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27affe53901b2401a0eecfa62b0d1a37868ab761"}, "originalPosition": 303}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjM2NDI4OQ==", "bodyText": "If the proposed changes are made for the stopStreaming methods, this change can be reverted", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r576364289", "createdAt": "2021-02-15T18:22:11Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -397,7 +527,7 @@ public void resumeStreaming() {\n     @Override\n     @RestrictTo(RestrictTo.Scope.LIBRARY)\n     public void dispose() {\n-        stopStreaming();\n+        stopStreaming(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27affe53901b2401a0eecfa62b0d1a37868ab761"}, "originalPosition": 341}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjM2NDgyMg==", "bodyText": "Currently if a capability matches both ranges then it will be added twice to validCapabilities, We should see if the capability is already in validCapabilities before adding it.\nif (!validCapabilities.contains(capability)) {\n    validCapabilities.add(capability);\n}", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r576364822", "createdAt": "2021-02-15T18:23:38Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +781,103 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            List<VideoStreamingCapability> originalAdditionalCapabilities\n+    ){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+\n+        VideoStreamingCapability preferredCapability = new VideoStreamingCapability();\n+        preferredCapability.setDiagonalScreenSize(parameters.getPreferredDiagonal());\n+        preferredCapability.setPreferredResolution(new ImageResolution(\n+                parameters.getResolution().getResolutionWidth(),\n+                parameters.getResolution().getResolutionHeight())\n+        );\n+\n+        // get the first one - the Desired resolution to guarantee streaming will start\n+        validCapabilities.add(preferredCapability);\n+        for (VideoStreamingRange range: ranges) {\n+\n+            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n+            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n+            if (originalAdditionalCapabilities != null && !originalAdditionalCapabilities.isEmpty()) {\n+\n+                for (VideoStreamingCapability capability : originalAdditionalCapabilities) {\n+                    double diagonal;\n+                    if (capability.getPreferredResolution() == null\n+                            || capability.getPreferredResolution().getResolutionHeight() == null\n+                            || capability.getPreferredResolution().getResolutionWidth() == null) {\n+                        continue;\n+                    }\n+                    if (capability.getDiagonalScreenSize() == null) {\n+                        diagonal = parameters.getPreferredDiagonal();\n+                    } else {\n+                        diagonal = capability.getDiagonalScreenSize();\n+                    }\n+\n+                    if (range.getMinScreenDiagonal() > diagonal) {\n+                        continue;\n+                    }\n+\n+                    if (!isAspectRatioInRange(range.getMinAspectRatio(), range.getMaxAspectRatio(), capability.getPreferredResolution())) {\n+                        if (constraintHeightMax == null && constraintHeightMin == null) {\n+                            continue;\n+                        }\n+                    }\n+\n+                    if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n+                        continue;\n+                    }\n+\n+                    validCapabilities.add(capability);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "27affe53901b2401a0eecfa62b0d1a37868ab761"}, "originalPosition": 430}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "07cad3e9ced2b256970ecf988ec5273944915409", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/07cad3e9ced2b256970ecf988ec5273944915409", "committedDate": "2021-02-15T18:37:56Z", "message": "[0296]\n- Fix PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTkwNzYzODgw", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-590763880", "createdAt": "2021-02-15T21:33:49Z", "commit": {"oid": "07cad3e9ced2b256970ecf988ec5273944915409"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xNVQyMTozMzo0OVrOIluobA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xNVQyMTozNTowM1rOIlutfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjQzMjIzNg==", "bodyText": "This should refer back to stopStreaming() instead of stopStreaming(boolean withPendingRestart)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r576432236", "createdAt": "2021-02-15T21:33:49Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -377,18 +487,37 @@ public void stopStreaming() {\n         stateMachine.transitionToState(StreamingStateMachine.STOPPED);\n     }\n \n+    /**\n+     * Stops streaming from the remote display. To restart, call\n+     *\n+     * @see #resumeStreaming()\n+     */\n+    private void stopStreaming(boolean withPendingRestart) {\n+        if (remoteDisplay != null && !withPendingRestart) {\n+            remoteDisplay.stop();\n+            this.withPendingRestart = false;\n+        }\n+        if (this.isStreaming()) {\n+            if (virtualDisplayEncoder != null) {\n+                virtualDisplayEncoder.shutDown();\n+            }\n+            stateMachine.transitionToState(StreamingStateMachine.STOPPED);\n+            stopVideoStream();\n+        }\n+    }\n+\n     /**\n      * Resumes streaming after calling\n      *\n      * @see #startRemoteDisplayStream(android.content.Context, Class, com.smartdevicelink.streaming.video.VideoStreamingParameters, boolean)\n      * followed by a call to\n-     * @see #stopStreaming()\n+     * @see #stopStreaming(boolean withPendingRestart)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07cad3e9ced2b256970ecf988ec5273944915409"}, "originalPosition": 315}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjQzMzUzMw==", "bodyText": "The proposal was not very clear on what properties should get set on OnAppCapabilityUpdated.appCapability. videoStreamingCapability so we have decided we should not set the root videoStreamingCapability but only the additionalVideoStreamingCapabilities as outlined below:\n\nMobile checks both the root videoStreamingCapability and the additionalVideoStreamingCapabilities to see which ones it can support.\nMobile sends an OnAppCapabilityUpdated with only the VideoStreamingCapability.additionalVideoStreamingCapabilities parameter set. The  additionalVideoStreamingCapabilities should be set with all the capabilities it can support as determined by step 1.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r576433533", "createdAt": "2021-02-15T21:35:03Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +358,57 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n         if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n+\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> listOfStreamingRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        if (listOfStreamingRange != null) {\n+            this.listOfStreamingRanges = listOfStreamingRange;\n+        }\n+    }\n+\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters) {\n+        final VideoStreamingParameters params = (parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n         if (majorProtocolVersion >= 5) {\n             if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n                 internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n                     @Override\n                     public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n+                        VideoStreamingCapability castedCapability = ((VideoStreamingCapability) capability);\n+                        VideoStreamManager.this.originalCapability = castedCapability;\n+\n+                        params.update(castedCapability, vehicleMake);    //Streaming parameters are ready time to stream\n+                        VideoStreamManager.this.parameters = params;\n+\n+                        if (listOfStreamingRanges != null) {\n+                            // filtering\n+                            castedCapability.setAdditionalVideoStreamingCapabilities(\n+                                    getSupportedCapabilities(\n+                                            listOfStreamingRanges,\n+                                            castedCapability.getAdditionalVideoStreamingCapabilities()\n+                                    )\n+                            );\n+                        }\n+                        AppCapability appCapability = new AppCapability(AppCapabilityType.VIDEO_STREAMING);\n+                        appCapability.setVideoStreamingCapability(castedCapability);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07cad3e9ced2b256970ecf988ec5273944915409"}, "originalPosition": 244}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5930f18a6befcf6b5d47b0e3051641502d46fa8", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e5930f18a6befcf6b5d47b0e3051641502d46fa8", "committedDate": "2021-02-16T10:02:40Z", "message": "[0296]\n- Implement latest cr's"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c53b422522d37fe3c3af7a118176b8505d98513a", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c53b422522d37fe3c3af7a118176b8505d98513a", "committedDate": "2021-02-17T16:45:06Z", "message": "[0238]\n- Fix PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d85f46863c14a37646a3972727fcaa6bb6fa6cfe", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/d85f46863c14a37646a3972727fcaa6bb6fa6cfe", "committedDate": "2021-02-18T16:35:40Z", "message": "[0238]\n- Apply stackOverFlow fix suggestion"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTkzNTIwNjE0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-593520614", "createdAt": "2021-02-18T18:24:05Z", "commit": {"oid": "d85f46863c14a37646a3972727fcaa6bb6fa6cfe"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xOFQxODoyNDowNVrOIn19GQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xOFQxODoyNDowNVrOIn19GQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3ODY0OTM2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                if (!validCapabilities.contains(capability)) {\n          \n          \n            \n                                capability.setAdditionalVideoStreamingCapabilities(null);\n          \n          \n            \n                                if (!validCapabilities.contains(capability)) {\n          \n      \n    \n    \n  \n\nHello @kostyaBoss to avoid the edge case I discussed earlier from happening within the manager and to align to the iOS implementation we should set the additionalCapability of any capability to be added to null before it is added.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r578649369", "createdAt": "2021-02-18T18:24:05Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +779,98 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            VideoStreamingCapability rootCapability\n+    ){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        allCapabilities.add(rootCapability);\n+\n+        for (VideoStreamingRange range: ranges) {\n+\n+            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n+            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n+            if (allCapabilities != null && !allCapabilities.isEmpty()) {\n+\n+                for (VideoStreamingCapability capability : allCapabilities) {\n+                    double diagonal;\n+                    if (capability.getPreferredResolution() == null\n+                            || capability.getPreferredResolution().getResolutionHeight() == null\n+                            || capability.getPreferredResolution().getResolutionWidth() == null) {\n+                        continue;\n+                    }\n+                    if (capability.getDiagonalScreenSize() == null) {\n+                        diagonal = parameters.getPreferredDiagonal();\n+                    } else {\n+                        diagonal = capability.getDiagonalScreenSize();\n+                    }\n+\n+                    if (range.getMinScreenDiagonal() > diagonal) {\n+                        continue;\n+                    }\n+\n+                    if (!isAspectRatioInRange(range.getMinAspectRatio(), range.getMaxAspectRatio(), capability.getPreferredResolution())) {\n+                        if (constraintHeightMax == null && constraintHeightMin == null) {\n+                            continue;\n+                        }\n+                    }\n+\n+                    if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n+                        continue;\n+                    }\n+\n+                    if (!validCapabilities.contains(capability)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d85f46863c14a37646a3972727fcaa6bb6fa6cfe"}, "originalPosition": 403}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTkzNTkzOTM1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-593593935", "createdAt": "2021-02-18T19:56:31Z", "commit": {"oid": "d85f46863c14a37646a3972727fcaa6bb6fa6cfe"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xOFQxOTo1NjozMVrOIn5cHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0xOFQxOTo1NjozMVrOIn5cHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3ODcwNjQ2MQ==", "bodyText": "@kostyaBoss this will cause an NPE is getAdditionalVideoStreamingCapabilities is null", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r578706461", "createdAt": "2021-02-18T19:56:31Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +779,98 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            VideoStreamingCapability rootCapability\n+    ){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        allCapabilities.add(rootCapability);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d85f46863c14a37646a3972727fcaa6bb6fa6cfe"}, "originalPosition": 368}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39882aea315dd01f2cf6508438259362c36b3ad0", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/39882aea315dd01f2cf6508438259362c36b3ad0", "committedDate": "2021-02-18T20:26:01Z", "message": "[0238]\n- Fix PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e7d650626c12c6d78d779e1047ece9d0f62c5fde", "committedDate": "2021-02-18T20:47:29Z", "message": "[0238]\n- Fix failing test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk1NzA5NzA3", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-595709707", "createdAt": "2021-02-22T19:32:53Z", "commit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMlQxOTozMjo1M1rOIpo4uA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMlQyMDoxMDo1NFrOIpqY3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDUzMjQwOA==", "bodyText": "To maintain code style throughout the library please update this call to a single line rather than split the parameters across different lines.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r580532408", "createdAt": "2021-02-22T19:32:53Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -139,12 +151,20 @@ public void onServiceStarted(SdlSession session, SessionType type, boolean isEnc\n         @Override\n         public void onServiceEnded(SdlSession session, SessionType type) {\n             if (SessionType.NAV.equals(type)) {\n-                stopVideoStream();\n-                if (remoteDisplay != null) {\n-                    stopStreaming();\n+                if (remoteDisplay !=null){\n+                    stopStreaming(withPendingRestart);\n                 }\n                 stateMachine.transitionToState(StreamingStateMachine.NONE);\n                 transitionToState(SETTING_UP);\n+\n+                if (withPendingRestart){\n+                    VideoStreamManager manager = VideoStreamManager.this;\n+                    manager.internalInterface.startVideoService(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDUzNDEwMA==", "bodyText": "To maintain code style throughout the library please update this call to a single line rather than split the parameters across different lines.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r580534100", "createdAt": "2021-02-22T19:35:01Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +358,56 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n         if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n+\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> listOfStreamingRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        if (listOfStreamingRange != null) {\n+            this.listOfStreamingRanges = listOfStreamingRange;\n+        }\n+    }\n+\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters) {\n+        final VideoStreamingParameters params = (parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n         if (majorProtocolVersion >= 5) {\n             if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n                 internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n                     @Override\n                     public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n+                        VideoStreamingCapability castedCapability = ((VideoStreamingCapability) capability);\n+                        VideoStreamManager.this.originalCapability = castedCapability;\n+\n+                        params.update(castedCapability, vehicleMake);    //Streaming parameters are ready time to stream\n+                        VideoStreamManager.this.parameters = params;\n+\n+                        VideoStreamingCapability capabilityToSend = new VideoStreamingCapability();\n+                        if (listOfStreamingRanges != null) {\n+                            // filtering\n+                            capabilityToSend.setAdditionalVideoStreamingCapabilities(getSupportedCapabilities(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "originalPosition": 237}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDUzNDY0MA==", "bodyText": "If range is null this will cause an NPE", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r580534640", "createdAt": "2021-02-22T19:35:53Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +779,101 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            VideoStreamingCapability rootCapability\n+    ){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities != null){\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingRange range: ranges) {\n+\n+            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "originalPosition": 374}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDUzNDg3MA==", "bodyText": "To maintain code style throughout the library please update this method signature to a single line rather than split the parameters across different lines.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r580534870", "createdAt": "2021-02-22T19:36:16Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +779,101 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "originalPosition": 361}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDUzNTY0MA==", "bodyText": "To maintain code style throughout the library please update this method signature to a single line rather than split the parameters across different lines.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r580535640", "createdAt": "2021-02-22T19:37:26Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minResolution;\n+    private Resolution maxResolution;\n+    private Double minScreenDiagonal;\n+    private Double minAspectRatio;\n+    private Double maxAspectRatio;\n+\n+    public VideoStreamingRange(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDUzODI3Mw==", "bodyText": "A Builder is not necessary for this class and should be removed.\nsetters should be added. This class should be a very simple data structure.\nTo keep the setters chainable you can return VideoStreamingRange, i.e.\npublic VideoStreamingRange setMinSupportedResolution(Resolution minSupportedResolution) {\n        this.minResolution = minSupportedResolution;\n        return this;\n    }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r580538273", "createdAt": "2021-02-22T19:41:42Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,79 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minResolution;\n+    private Resolution maxResolution;\n+    private Double minScreenDiagonal;\n+    private Double minAspectRatio;\n+    private Double maxAspectRatio;\n+\n+    public VideoStreamingRange(\n+            Resolution minResolution,\n+            Resolution maxResolution,\n+            Double minScreenDiagonal,\n+            Double minAspectRatio,\n+            Double maxAspectRatio\n+    ) {\n+        this.minResolution = minResolution;\n+        this.maxResolution = maxResolution;\n+        this.minScreenDiagonal = minScreenDiagonal;\n+        this.minAspectRatio = minAspectRatio;\n+        this.maxAspectRatio = maxAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinResolution() {\n+        return minResolution;\n+    }\n+\n+    public Resolution getMaxResolution() {\n+        return maxResolution;\n+    }\n+\n+    public Double getMinScreenDiagonal() {\n+        return minScreenDiagonal;\n+    }\n+\n+    public Double getMinAspectRatio() {\n+        return minAspectRatio;\n+    }\n+\n+    public Double getMaxAspectRatio() {\n+        return maxAspectRatio;\n+    }\n+\n+    public static class Builder {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDU1NzAyMw==", "bodyText": "After Aligning changes with the iOS library there are some cases that were not accounted for or not aligned between the two libraries. Mainly these changes are to decide what it means if the developer set a null range or a range where the Resolutions are (0, 0) and how to handle these cases.\n\nIf both supportedPortraitStreamingRange and supportedLandscapeStreamingRange are not set or set to null by the developer, then the mobile library will support all VideoStreamingCapabilities returned by the module. This is done to ensure that streaming works as intended for developers who don't update the library to add the supportedPortraitStreamingRange and supportedLandscapeStreamingRange parameters.\nTo disable either supportedPortraitStreamingRange or supportedLandscapeStreamingRange, the developer has to set a VideoStreamingRange with the minimumResolution and maximumResolution set to 0 width and 0 height. If the developer chooses to disable both supportedPortraitStreamingRange and supportedLandscapeStreamingRange, video will not stream.\nIf supportedPortraitStreamingRange is not set or was set to null then the library will assume that all VideoStreamingCapabilities with a portrait aspect ratio are supported. The same is true if supportedLandscapeStreamingRange is not set; the library will assume that all VideoStreamingCapabilities with a landscape aspect ratio are supported.\n\nFor point 3) please refer to the iOS implementation on how to determine if a capability is a portrait or landscape capability\nmatchVideoCapability and isCapability in this file\nas well as SDLImageResolutionKind in this file", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r580557023", "createdAt": "2021-02-22T20:10:54Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +779,101 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(\n+            List<VideoStreamingRange> ranges,\n+            VideoStreamingCapability rootCapability\n+    ){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "originalPosition": 364}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk1NzUwNzg5", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-595750789", "createdAt": "2021-02-22T20:24:46Z", "commit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMlQyMDoyNDo0NlrOIpq6Fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yMlQyMDoyNDo0NlrOIpq6Fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDU2NTUyNg==", "bodyText": "Hello @kostyaBoss per this comment\nIf the developer uses this methos we should assume that the ranges are null and there for all capabilities would be supported.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r580565526", "createdAt": "2021-02-22T20:24:46Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +358,56 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e7d650626c12c6d78d779e1047ece9d0f62c5fde"}, "originalPosition": 195}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/81fa63cda1c4084fff46d12a7e3ec1aa89865e90", "committedDate": "2021-02-23T16:27:10Z", "message": "[0296]\n- Fix pr comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk3ODMyOTAz", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-597832903", "createdAt": "2021-02-24T19:12:01Z", "commit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNFQxOToxMjowMlrOIrQgXg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNFQxOTozNzo1OVrOIrRibg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjIzMDExMA==", "bodyText": "This enum will only be fore use inside of the library and because of this we should add a @RestrictTo annotation\n@RestrictTo(RestrictTo.Scope.LIBRARY)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582230110", "createdAt": "2021-02-24T19:12:02Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/ImageResolutionKind.java", "diffHunk": "@@ -0,0 +1,5 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public enum ImageResolutionKind {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjIzMTI4Mg==", "bodyText": "This should be a float value as it is a ratio\n float ratio = resolution.getResolutionWidth().floatValue() / resolution.getResolutionHeight().floatValue();\nIf we change ratio to a float we will also have to change ratioSquard from ratio ^ 2 to ratio * ratio", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582231282", "createdAt": "2021-02-24T19:13:57Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -864,16 +917,32 @@ public Boolean isAspectRatioInRange(Double aspectRatioMin, Double aspectRatioMax\n \n         Double currentAspectRatio = Double.valueOf(currentResolution.getResolutionWidth()) / Double.valueOf(currentResolution.getResolutionHeight());\n \n-        if (aspectRatioMax != null &&\n-                aspectRatioMin != null &&\n-                aspectRatioMax > aspectRatioMin &&\n-                aspectRatioMin > 0) {\n+        if (aspectRatioMax != null && aspectRatioMin != null && aspectRatioMax > aspectRatioMin && aspectRatioMin > 0) {\n             return currentAspectRatio >= aspectRatioMin && currentAspectRatio <= aspectRatioMax;\n         } else {\n             return false;\n         }\n     }\n \n+    private ImageResolutionKind determineResolutionType(ImageResolution resolution) {\n+        if (resolution == null) {\n+            return ImageResolutionKind.UNDEFINED;\n+        }\n+        if (resolution.getResolutionHeight() == null || resolution.getResolutionWidth() == null || resolution.getResolutionWidth() <= 0 || resolution.getResolutionHeight() <= 0) {\n+            return ImageResolutionKind.UNDEFINED;\n+        }\n+        int ratio = resolution.getResolutionWidth() / resolution.getResolutionHeight();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 268}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjIzNDg3OA==", "bodyText": "If rootCapability is null this null check will be too late as the line above will throw an npe when calling rootCapability.getAdditionalVideoStreamingCapabilities()", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582234878", "createdAt": "2021-02-24T19:19:34Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -783,50 +783,59 @@ public VideoStreamingParameters getLastCachedStreamingParameters() {\n         return parameters;\n     }\n \n-    private List<VideoStreamingCapability> getSupportedCapabilities(\n-            List<VideoStreamingRange> ranges,\n-            VideoStreamingCapability rootCapability\n-    ){\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n \n         List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n         List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (rootCapability == null || allCapabilities == null){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 110}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjIzNTUwNA==", "bodyText": "In this case we can return validCapabilities right after adding all capabilities", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582235504", "createdAt": "2021-02-24T19:20:30Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -783,50 +783,59 @@ public VideoStreamingParameters getLastCachedStreamingParameters() {\n         return parameters;\n     }\n \n-    private List<VideoStreamingCapability> getSupportedCapabilities(\n-            List<VideoStreamingRange> ranges,\n-            VideoStreamingCapability rootCapability\n-    ){\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n \n         List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n         List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (rootCapability == null || allCapabilities == null){\n+            return null;\n+        }\n         if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n             allCapabilities.add(rootCapability);\n         }\n \n-        for (VideoStreamingRange range: ranges) {\n-\n-            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n-            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n-            if (allCapabilities != null && !allCapabilities.isEmpty()) {\n-\n-                for (VideoStreamingCapability capability : allCapabilities) {\n-                    double diagonal;\n-                    if (capability.getPreferredResolution() == null\n-                            || capability.getPreferredResolution().getResolutionHeight() == null\n-                            || capability.getPreferredResolution().getResolutionWidth() == null) {\n-                        continue;\n-                    }\n-                    if (capability.getDiagonalScreenSize() == null) {\n-                        diagonal = parameters.getPreferredDiagonal();\n-                    } else {\n-                        diagonal = capability.getDiagonalScreenSize();\n-                    }\n-\n-                    if (range.getMinScreenDiagonal() > diagonal) {\n-                        continue;\n-                    }\n-\n-                    if (!isAspectRatioInRange(range.getMinAspectRatio(), range.getMaxAspectRatio(), capability.getPreferredResolution())) {\n-                        if (constraintHeightMax == null && constraintHeightMin == null) {\n-                            continue;\n-                        }\n-                    }\n+        if (this.supportedLandscapeStreamingRange == null && this.supportedPortraitStreamingRange == null){\n+            for (VideoStreamingCapability capability: allCapabilities) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+            }\n \n-                    if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n-                        continue;\n-                    }\n+            validCapabilities.addAll(allCapabilities);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 154}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjIzNzEzNA==", "bodyText": "Per part 3 of this comment\nwe should be adding all Portrait capabilities if the developer passes a null portrait range\nif (determineResolutionType(capability.getPreferredResolution()) == ImageResolutionKind.PORTRAIT)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582237134", "createdAt": "2021-02-24T19:23:06Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -783,50 +783,59 @@ public VideoStreamingParameters getLastCachedStreamingParameters() {\n         return parameters;\n     }\n \n-    private List<VideoStreamingCapability> getSupportedCapabilities(\n-            List<VideoStreamingRange> ranges,\n-            VideoStreamingCapability rootCapability\n-    ){\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n \n         List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n         List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (rootCapability == null || allCapabilities == null){\n+            return null;\n+        }\n         if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n             allCapabilities.add(rootCapability);\n         }\n \n-        for (VideoStreamingRange range: ranges) {\n-\n-            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n-            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n-            if (allCapabilities != null && !allCapabilities.isEmpty()) {\n-\n-                for (VideoStreamingCapability capability : allCapabilities) {\n-                    double diagonal;\n-                    if (capability.getPreferredResolution() == null\n-                            || capability.getPreferredResolution().getResolutionHeight() == null\n-                            || capability.getPreferredResolution().getResolutionWidth() == null) {\n-                        continue;\n-                    }\n-                    if (capability.getDiagonalScreenSize() == null) {\n-                        diagonal = parameters.getPreferredDiagonal();\n-                    } else {\n-                        diagonal = capability.getDiagonalScreenSize();\n-                    }\n-\n-                    if (range.getMinScreenDiagonal() > diagonal) {\n-                        continue;\n-                    }\n-\n-                    if (!isAspectRatioInRange(range.getMinAspectRatio(), range.getMaxAspectRatio(), capability.getPreferredResolution())) {\n-                        if (constraintHeightMax == null && constraintHeightMin == null) {\n-                            continue;\n-                        }\n-                    }\n+        if (this.supportedLandscapeStreamingRange == null && this.supportedPortraitStreamingRange == null){\n+            for (VideoStreamingCapability capability: allCapabilities) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+            }\n \n-                    if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n-                        continue;\n-                    }\n+            validCapabilities.addAll(allCapabilities);\n+        } else if (supportedLandscapeStreamingRange != null && supportedPortraitStreamingRange == null) {\n+            for (VideoStreamingCapability capability : allCapabilities) {\n+                if (determineResolutionType(capability.getPreferredResolution()) == ImageResolutionKind.LANDSCAPE){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 157}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjIzNzM0MA==", "bodyText": "Per part 3 of this comment\nwe should be adding all landscape capabilities if the developer passes a null landscape range\nif (determineResolutionType(capability.getPreferredResolution()) == ImageResolutionKind.LANDSCAPE)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582237340", "createdAt": "2021-02-24T19:23:25Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -783,50 +783,59 @@ public VideoStreamingParameters getLastCachedStreamingParameters() {\n         return parameters;\n     }\n \n-    private List<VideoStreamingCapability> getSupportedCapabilities(\n-            List<VideoStreamingRange> ranges,\n-            VideoStreamingCapability rootCapability\n-    ){\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n \n         List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n         List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (rootCapability == null || allCapabilities == null){\n+            return null;\n+        }\n         if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n             allCapabilities.add(rootCapability);\n         }\n \n-        for (VideoStreamingRange range: ranges) {\n-\n-            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n-            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n-            if (allCapabilities != null && !allCapabilities.isEmpty()) {\n-\n-                for (VideoStreamingCapability capability : allCapabilities) {\n-                    double diagonal;\n-                    if (capability.getPreferredResolution() == null\n-                            || capability.getPreferredResolution().getResolutionHeight() == null\n-                            || capability.getPreferredResolution().getResolutionWidth() == null) {\n-                        continue;\n-                    }\n-                    if (capability.getDiagonalScreenSize() == null) {\n-                        diagonal = parameters.getPreferredDiagonal();\n-                    } else {\n-                        diagonal = capability.getDiagonalScreenSize();\n-                    }\n-\n-                    if (range.getMinScreenDiagonal() > diagonal) {\n-                        continue;\n-                    }\n-\n-                    if (!isAspectRatioInRange(range.getMinAspectRatio(), range.getMaxAspectRatio(), capability.getPreferredResolution())) {\n-                        if (constraintHeightMax == null && constraintHeightMin == null) {\n-                            continue;\n-                        }\n-                    }\n+        if (this.supportedLandscapeStreamingRange == null && this.supportedPortraitStreamingRange == null){\n+            for (VideoStreamingCapability capability: allCapabilities) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+            }\n \n-                    if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n-                        continue;\n-                    }\n+            validCapabilities.addAll(allCapabilities);\n+        } else if (supportedLandscapeStreamingRange != null && supportedPortraitStreamingRange == null) {\n+            for (VideoStreamingCapability capability : allCapabilities) {\n+                if (determineResolutionType(capability.getPreferredResolution()) == ImageResolutionKind.LANDSCAPE){\n+                    capability.setAdditionalVideoStreamingCapabilities(null);\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        } else if (supportedLandscapeStreamingRange == null && supportedPortraitStreamingRange != null) {\n+            for (VideoStreamingCapability capability : allCapabilities) {\n+                if (determineResolutionType(capability.getPreferredResolution()) == ImageResolutionKind.PORTRAIT) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 164}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjI0MDU4Nw==", "bodyText": "This should not be an else condition, in the event that one of the ranges are null and the other isn't then we still need to check the capabilities against the non-null range.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582240587", "createdAt": "2021-02-24T19:28:07Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -783,50 +783,59 @@ public VideoStreamingParameters getLastCachedStreamingParameters() {\n         return parameters;\n     }\n \n-    private List<VideoStreamingCapability> getSupportedCapabilities(\n-            List<VideoStreamingRange> ranges,\n-            VideoStreamingCapability rootCapability\n-    ){\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n \n         List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n         List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (rootCapability == null || allCapabilities == null){\n+            return null;\n+        }\n         if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n             allCapabilities.add(rootCapability);\n         }\n \n-        for (VideoStreamingRange range: ranges) {\n-\n-            Integer constraintHeightMax = range.getMaxResolution().getResolutionHeight();\n-            Integer constraintHeightMin = range.getMinResolution().getResolutionHeight();\n-            if (allCapabilities != null && !allCapabilities.isEmpty()) {\n-\n-                for (VideoStreamingCapability capability : allCapabilities) {\n-                    double diagonal;\n-                    if (capability.getPreferredResolution() == null\n-                            || capability.getPreferredResolution().getResolutionHeight() == null\n-                            || capability.getPreferredResolution().getResolutionWidth() == null) {\n-                        continue;\n-                    }\n-                    if (capability.getDiagonalScreenSize() == null) {\n-                        diagonal = parameters.getPreferredDiagonal();\n-                    } else {\n-                        diagonal = capability.getDiagonalScreenSize();\n-                    }\n-\n-                    if (range.getMinScreenDiagonal() > diagonal) {\n-                        continue;\n-                    }\n-\n-                    if (!isAspectRatioInRange(range.getMinAspectRatio(), range.getMaxAspectRatio(), capability.getPreferredResolution())) {\n-                        if (constraintHeightMax == null && constraintHeightMin == null) {\n-                            continue;\n-                        }\n-                    }\n+        if (this.supportedLandscapeStreamingRange == null && this.supportedPortraitStreamingRange == null){\n+            for (VideoStreamingCapability capability: allCapabilities) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+            }\n \n-                    if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())) {\n-                        continue;\n-                    }\n+            validCapabilities.addAll(allCapabilities);\n+        } else if (supportedLandscapeStreamingRange != null && supportedPortraitStreamingRange == null) {\n+            for (VideoStreamingCapability capability : allCapabilities) {\n+                if (determineResolutionType(capability.getPreferredResolution()) == ImageResolutionKind.LANDSCAPE){\n+                    capability.setAdditionalVideoStreamingCapabilities(null);\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        } else if (supportedLandscapeStreamingRange == null && supportedPortraitStreamingRange != null) {\n+            for (VideoStreamingCapability capability : allCapabilities) {\n+                if (determineResolutionType(capability.getPreferredResolution()) == ImageResolutionKind.PORTRAIT) {\n+                    capability.setAdditionalVideoStreamingCapabilities(null);\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        } else if (isZeroRange(supportedPortraitStreamingRange) && isZeroRange(supportedLandscapeStreamingRange)) {\n+            return null;\n+        }else {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 171}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjI0MjU2Mw==", "bodyText": "These values are getting set twice right after each other, I think it is better to leave the setting of these two values to the configureGlobalParameters method", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582242563", "createdAt": "2021-02-24T19:31:09Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -340,8 +338,9 @@ public void onError(String info) {\n      * @param portraitRange     constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n      */\n     public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted, VideoStreamingRange landscapeRange, VideoStreamingRange portraitRange) {\n-        Collections.addAll(listOfStreamingRanges, portraitRange, landscapeRange);\n-        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, listOfStreamingRanges);\n+        this.supportedPortraitStreamingRange = portraitRange;\n+        this.supportedLandscapeStreamingRange = landscapeRange;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjI0NTAwOA==", "bodyText": "If the developer continues to use this method we should pass null ranges", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582245008", "createdAt": "2021-02-24T19:35:01Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -360,7 +359,7 @@ public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteD\n      */\n     @Deprecated\n     public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n-        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, supportedPortraitStreamingRange, supportedLandscapeStreamingRange);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MjI0NzAyMg==", "bodyText": "With the proposed changes we should allow these values to be set to null as this will indicate that all ranges or all ranges of that type are supported\nthis.supportedPortraitStreamingRange = portraitRange;\nthis.supportedLandscapeStreamingRange = landscapeRange;", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r582247022", "createdAt": "2021-02-24T19:37:59Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -370,13 +369,17 @@ public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteD\n         processCapabilitiesWithPendingStart(encrypted, parameters);\n     }\n \n-    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> listOfStreamingRange) {\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, VideoStreamingRange portraitRange, VideoStreamingRange landscapeRange) {\n         this.context = new WeakReference<>(context);\n         this.remoteDisplayClass = remoteDisplayClass;\n         this.isEncrypted = encrypted;\n         this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n-        if (listOfStreamingRange != null) {\n-            this.listOfStreamingRanges = listOfStreamingRange;\n+        if (portraitRange != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81fa63cda1c4084fff46d12a7e3ec1aa89865e90"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9a023933eb6a12f7ec37823422f048dfcb8f796", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/a9a023933eb6a12f7ec37823422f048dfcb8f796", "committedDate": "2021-02-25T12:43:44Z", "message": "[0296]\n- Fix pr comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "175f8974f0f73be5a09b223dc3cc7971850f1536", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/175f8974f0f73be5a09b223dc3cc7971850f1536", "committedDate": "2021-02-25T15:16:13Z", "message": "[0296]\n- Fix pr comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk4OTIwNjE0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-598920614", "createdAt": "2021-02-25T19:23:02Z", "commit": {"oid": "175f8974f0f73be5a09b223dc3cc7971850f1536"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNVQxOToyMzowMlrOIsFx-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNVQxOTozNjozOVrOIsGSVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzEwMjk3MA==", "bodyText": "A Null range will indicate no restrictions on the capabilities send so it should return true in this case", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r583102970", "createdAt": "2021-02-25T19:23:02Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +771,155 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        if (rootCapability == null){\n+            return null;\n+        }\n+\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities == null){\n+            return null;\n+        }\n+\n+        if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingCapability capability : allCapabilities) {\n+            ImageResolution imageResolution = capability.getPreferredResolution();\n+            boolean matches = false;\n+            switch (determineResolutionType(imageResolution)) {\n+                case SQUARE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange) || inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case PORTRAIT:\n+                    matches = inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case LANDSCAPE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange);\n+                    break;\n+                default:\n+                    break;\n+            }\n+\n+            if (matches) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+                if (!validCapabilities.contains(capability)) {\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    private Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n+        if (capability == null) {\n+            return false;\n+        }\n+        if (range == null) {\n+            return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "175f8974f0f73be5a09b223dc3cc7971850f1536"}, "originalPosition": 396}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzExMTI1Mw==", "bodyText": "In the unlikely event that the developer has:\n\ndisabled both portrait and landscape streaming ranges by setting the min/max to 0\nhas set a portrait and landscape range that that is not supported by the module\nWe should not send an OnAppCapabilityUpdated notification and we transition the state machine to stopped, since we will not stream the video\n\nif (capabilityToSend.getAdditionalVideoStreamingCapabilities() == null) {\n    stateMachine.transitionToState(StreamingStateMachine.STOPPED);\n    return;\n}\n.......", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r583111253", "createdAt": "2021-02-25T19:36:39Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +354,52 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n         if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n+\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, VideoStreamingRange portraitRange, VideoStreamingRange landscapeRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        this.supportedPortraitStreamingRange = portraitRange;\n+        this.supportedLandscapeStreamingRange = landscapeRange;\n+    }\n+\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters) {\n+        final VideoStreamingParameters params = (parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n         if (majorProtocolVersion >= 5) {\n             if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n                 internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n                     @Override\n                     public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n+                        VideoStreamingCapability castedCapability = ((VideoStreamingCapability) capability);\n+                        VideoStreamManager.this.originalCapability = castedCapability;\n+\n+                        params.update(castedCapability, vehicleMake);    //Streaming parameters are ready time to stream\n+                        VideoStreamManager.this.parameters = params;\n+\n+                        VideoStreamingCapability capabilityToSend = new VideoStreamingCapability();\n+                        capabilityToSend.setAdditionalVideoStreamingCapabilities(getSupportedCapabilities(castedCapability));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "175f8974f0f73be5a09b223dc3cc7971850f1536"}, "originalPosition": 223}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "682c15692a3c666d3e27163cb309a619e8f5fbfa", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/682c15692a3c666d3e27163cb309a619e8f5fbfa", "committedDate": "2021-02-25T20:13:40Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0fbbf300e8c968d33f35d04c57450dbb8b6d670f", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/0fbbf300e8c968d33f35d04c57450dbb8b6d670f", "committedDate": "2021-02-25T20:22:53Z", "message": "[0296]\n- Fix pr comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk5Njk5MjE5", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-599699219", "createdAt": "2021-02-26T15:45:34Z", "commit": {"oid": "0fbbf300e8c968d33f35d04c57450dbb8b6d670f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNlQxNTo0NTozNFrOIssI1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0yNlQxNjoyNToxOVrOIst0pA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzczMTQxNQ==", "bodyText": "Hello @kostyaBoss\nTo maintain alignment with the iOS library this method should be moved to the VideoStreamingRange class and only take in the ImageResolution as a parameter\npublic Boolean isImageResolutionInRange(ImageResolution imageResolution) {}", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r583731415", "createdAt": "2021-02-26T15:45:34Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +773,155 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        if (rootCapability == null){\n+            return null;\n+        }\n+\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities == null){\n+            return null;\n+        }\n+\n+        if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingCapability capability : allCapabilities) {\n+            ImageResolution imageResolution = capability.getPreferredResolution();\n+            boolean matches = false;\n+            switch (determineResolutionType(imageResolution)) {\n+                case SQUARE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange) || inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case PORTRAIT:\n+                    matches = inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case LANDSCAPE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange);\n+                    break;\n+                default:\n+                    break;\n+            }\n+\n+            if (matches) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+                if (!validCapabilities.contains(capability)) {\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    private Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n+        if (capability == null) {\n+            return false;\n+        }\n+        if (range == null) {\n+            return true;\n+        }\n+\n+        if (isZeroRange(range)){\n+            return false;\n+        }\n+\n+        if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())){\n+            return false;\n+        }\n+\n+        if (!isAspectRatioInRange(range.getMinAspectRatio(), range.getMaxAspectRatio(), capability.getPreferredResolution())){\n+            return false;\n+        }\n+\n+        double diagonal;\n+        if (capability.getDiagonalScreenSize() == null) {\n+            diagonal = parameters.getPreferredDiagonal();\n+        } else {\n+            diagonal = capability.getDiagonalScreenSize();\n+        }\n+\n+        if (range.getMinScreenDiagonal() > diagonal) {\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    private Boolean isZeroRange(VideoStreamingRange range){\n+        if (range == null || range.getMaxResolution() == null || range.getMinResolution() == null){\n+            return true;\n+        }\n+        return isZeroResolution(range.getMaxResolution()) && isZeroResolution(range.getMinResolution());\n+    }\n+\n+    private boolean isZeroResolution(Resolution resolution){\n+        if (resolution == null) {\n+            return true;\n+        }\n+        return resolution.getResolutionHeight() != null && resolution.getResolutionWidth() != null && resolution.getResolutionHeight() <= 0 && resolution.getResolutionWidth() <= 0;\n+    }\n+\n+    private Boolean isImageResolutionInRange(Resolution minResolution, Resolution maxResolution, ImageResolution currentResolution) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fbbf300e8c968d33f35d04c57450dbb8b6d670f"}, "originalPosition": 441}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzczMjE0NA==", "bodyText": "Hello @kostyaBoss\nTo maintain alignment with the iOS library this method should be moved to the VideoStreamingRange class and only take in the aspect ratio as a parameter\npublic Boolean isAspectRatioInRange(Double aspectRatio) {}", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r583732144", "createdAt": "2021-02-26T15:46:38Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +773,155 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        if (rootCapability == null){\n+            return null;\n+        }\n+\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities == null){\n+            return null;\n+        }\n+\n+        if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingCapability capability : allCapabilities) {\n+            ImageResolution imageResolution = capability.getPreferredResolution();\n+            boolean matches = false;\n+            switch (determineResolutionType(imageResolution)) {\n+                case SQUARE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange) || inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case PORTRAIT:\n+                    matches = inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case LANDSCAPE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange);\n+                    break;\n+                default:\n+                    break;\n+            }\n+\n+            if (matches) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+                if (!validCapabilities.contains(capability)) {\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    private Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n+        if (capability == null) {\n+            return false;\n+        }\n+        if (range == null) {\n+            return true;\n+        }\n+\n+        if (isZeroRange(range)){\n+            return false;\n+        }\n+\n+        if (!isImageResolutionInRange(range.getMinResolution(), range.getMaxResolution(), capability.getPreferredResolution())){\n+            return false;\n+        }\n+\n+        if (!isAspectRatioInRange(range.getMinAspectRatio(), range.getMaxAspectRatio(), capability.getPreferredResolution())){\n+            return false;\n+        }\n+\n+        double diagonal;\n+        if (capability.getDiagonalScreenSize() == null) {\n+            diagonal = parameters.getPreferredDiagonal();\n+        } else {\n+            diagonal = capability.getDiagonalScreenSize();\n+        }\n+\n+        if (range.getMinScreenDiagonal() > diagonal) {\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    private Boolean isZeroRange(VideoStreamingRange range){\n+        if (range == null || range.getMaxResolution() == null || range.getMinResolution() == null){\n+            return true;\n+        }\n+        return isZeroResolution(range.getMaxResolution()) && isZeroResolution(range.getMinResolution());\n+    }\n+\n+    private boolean isZeroResolution(Resolution resolution){\n+        if (resolution == null) {\n+            return true;\n+        }\n+        return resolution.getResolutionHeight() != null && resolution.getResolutionWidth() != null && resolution.getResolutionHeight() <= 0 && resolution.getResolutionWidth() <= 0;\n+    }\n+\n+    private Boolean isImageResolutionInRange(Resolution minResolution, Resolution maxResolution, ImageResolution currentResolution) {\n+\n+        Integer constraintHeightMax = maxResolution.getResolutionHeight();\n+        Integer constraintHeightMin = minResolution.getResolutionHeight();\n+        Integer constraintWidthMax = maxResolution.getResolutionWidth();\n+        Integer constraintWidthMin = minResolution.getResolutionWidth();\n+        Integer resolutionHeight = currentResolution.getResolutionHeight();\n+        Integer resolutionWidth = currentResolution.getResolutionWidth();\n+        if (currentResolution.getResolutionHeight() > 0 && currentResolution.getResolutionWidth() > 0 && constraintHeightMax != null && constraintHeightMin != null) {\n+            if (!(resolutionHeight >= constraintHeightMin && resolutionHeight <= constraintHeightMax)) {\n+                return false;\n+            }\n+\n+            if (!(resolutionWidth >= constraintWidthMin && resolutionWidth <= constraintWidthMax)) {\n+                return false;\n+            }\n+            return true;\n+        } else {\n+            return false;\n+        }\n+    }\n+\n+    public Boolean isAspectRatioInRange(Double aspectRatioMin, Double aspectRatioMax, ImageResolution currentResolution) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fbbf300e8c968d33f35d04c57450dbb8b6d670f"}, "originalPosition": 463}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzczNTk2Mw==", "bodyText": "Hello @kostyaBoss,\nTo maintain alignment with the iOS library we should update these parameter names to the names listed below, the getter and setter methods should also have titles updated to match the new parameter names.\nprivate Double minimumAspectRatio;\nprivate Double maximumAspectRatio;\nprivate Double minimumDiagonal;\nprivate Resolution minimumResolution;\nprivate Resolution maximumResolution;\n\ngetMinimumAspectRatio(){}\n.....\ngetMaximumResolution(){}\nsetMinimumAspectRatio(){}\n.....\nsetMaximumResolution(){}", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r583735963", "createdAt": "2021-02-26T15:52:04Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,65 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minResolution;\n+    private Resolution maxResolution;\n+    private Double minScreenDiagonal;\n+    private Double minAspectRatio;\n+    private Double maxAspectRatio;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fbbf300e8c968d33f35d04c57450dbb8b6d670f"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4Mzc1MzkzNg==", "bodyText": "Hello @kostyaBoss,\nI want to make sure that the documentation surrounding this method is clear to the developer. Please see the documentation below, to better align with the iOS library I also recommend change the parameter names from landscapeRange and portraitRange to supportedLandscapeStreamingRange and supportedPortraitStreamingRange\n/**\n     * Starts streaming a remote display to the module if there is a connected session. This method of streaming requires the device to be on API level 19 or higher\n     * Two ranges (supportedLandscapeStreamingRange and supportedLandscapeStreamingRange) can be provided with image dimension ranges and aspect ratio ranges that your remoteDisplay class supports.\n     * If the module's screen size for your app changes during streaming (i.e. to a collapsed view, split screen, preview mode, or picture-in-picture), your remoteDisplay will be resized to the new screen size.\n     * If either range is `null`, the default is to support all streaming ranges of that format (landscape or portrait).\n     * If you wish to disable support for streaming in a given format (landscape or portrait), set a VideoStreamingRange with all `0` values.\n     *\n     * NOTE If both supportedLandscapeStreamingRange and supportedLandscapeStreamingRange are disabled then the video will not stream.\n     *\n     * Any changes to screen size will notify the onViewResized method you have implemented in your remoteDisplay class.\n     *\n     *\n     * @param context            a context that can be used to create the remote display\n     * @param remoteDisplayClass class object of the remote display. This class will be used to create an instance of the remote display and will be projected to the module\n     * @param parameters         streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n     *                           If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n     *                           works best for the currently connected module.\n     * @param encrypted         a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n     * @param supportedLandscapeStreamingRange      constraints for vehicle display : min/max aspect ratio, min/max resolutions, max diagonal size.\n     * @param supportedLandscapeStreamingRange      constraints for vehicle display : min/max aspect ratio, min/max resolutions, max diagonal size.\n     */", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r583753936", "createdAt": "2021-02-26T16:17:59Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -274,6 +324,26 @@ public void onError(String info) {\n         }\n     }\n \n+    /**\n+     * Starts streaming a remote display to the module if there is a connected session. This method of streaming requires the device to be on API level 19 or higher\n+     *\n+     * @param context            a context that can be used to create the remote display\n+     * @param remoteDisplayClass class object of the remote display. This class will be used to create an instance of the remote display and will be projected to the module\n+     * @param parameters         streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n+     *                           If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n+     *                           works best for the currently connected module.\n+     * @param encrypted         a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n+     * @param landscapeRange    constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+     * @param portraitRange     constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+     */\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted, VideoStreamingRange landscapeRange, VideoStreamingRange portraitRange) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fbbf300e8c968d33f35d04c57450dbb8b6d670f"}, "originalPosition": 164}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4Mzc1ODkzMg==", "bodyText": "@kostyaBoss\nPlease update the documentation above to include the afterPendingRestart parameter\n@param afterPendingRestart specify true when the videoService is starting again after the display has been resized", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r583758932", "createdAt": "2021-02-26T16:25:13Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/lifecycle/LifecycleManager.java", "diffHunk": "@@ -155,7 +155,7 @@ void startVideoService(boolean isEncrypted, VideoStreamingParameters parameters)\n      * @param isEncrypted Specify true if packets on this service have to be encrypted\n      * @param parameters  VideoStreamingParameters that are desired. Does not guarantee this is what will be accepted.\n      */\n-    private void tryStartVideoStream(boolean isEncrypted, VideoStreamingParameters parameters) {\n+    private void tryStartVideoStream(boolean isEncrypted, VideoStreamingParameters parameters, boolean afterPendingRestart) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fbbf300e8c968d33f35d04c57450dbb8b6d670f"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4Mzc1OTAxMg==", "bodyText": "@kostyaBoss\nPlease update the documentation above to include the afterPendingRestart parameter\n@param afterPendingRestart specify true when the videoService is starting again after the display has been resized", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r583759012", "createdAt": "2021-02-26T16:25:19Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/lifecycle/LifecycleManager.java", "diffHunk": "@@ -134,7 +134,7 @@ void onTransportDisconnected(String info, boolean availablePrimary, BaseTranspor\n      * @param parameters  the desired video streaming parameters\n      */\n     @Override\n-    void startVideoService(boolean isEncrypted, VideoStreamingParameters parameters) {\n+    void startVideoService(boolean isEncrypted, VideoStreamingParameters parameters, boolean afterPendingRestart) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0fbbf300e8c968d33f35d04c57450dbb8b6d670f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "18dd57cd46b201064099dd25ebd0831299d2c44b", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/18dd57cd46b201064099dd25ebd0831299d2c44b", "committedDate": "2021-02-27T15:35:51Z", "message": "[0296]\n- Fix pr comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjAyMjkzNzg0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-602293784", "createdAt": "2021-03-02T21:34:58Z", "commit": {"oid": "18dd57cd46b201064099dd25ebd0831299d2c44b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wMlQyMTozNDo1OFrOIuyHTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wMlQyMTozNDo1OFrOIuyHTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTkyNjQ3Ng==", "bodyText": "Hello @kostyaBoss,\nper the proposal revisions can you update this to take in the aspectRatio?\npublic Boolean isAspectRatioInRange(Double aspectRatio)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r585926476", "createdAt": "2021-03-02T21:34:58Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,101 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+import com.smartdevicelink.proxy.rpc.ImageResolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minimumResolution;\n+    private Resolution maximumResolution;\n+    private Double minimumDiagonal;\n+    private Double minimumAspectRatio;\n+    private Double maximumAspectRatio;\n+\n+    public VideoStreamingRange(Resolution minimumResolution, Resolution maximumResolution, Double minimumDiagonal, Double minimumAspectRatio, Double maximumAspectRatio) {\n+        this.minimumResolution = minimumResolution;\n+        this.maximumResolution = maximumResolution;\n+        this.minimumDiagonal = minimumDiagonal;\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        this.maximumAspectRatio = maximumAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinimumResolution() {\n+        return minimumResolution;\n+    }\n+\n+    public Resolution getMaximumResolution() {\n+        return maximumResolution;\n+    }\n+\n+    public Double getMinimumDiagonal() {\n+        return minimumDiagonal;\n+    }\n+\n+    public Double getMinimumAspectRatio() {\n+        return minimumAspectRatio;\n+    }\n+\n+    public Double getMaximumAspectRatio() {\n+        return maximumAspectRatio;\n+    }\n+\n+    public VideoStreamingRange setMinSupportedResolution(Resolution minSupportedResolution) {\n+        this.minimumResolution = minSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+        this.maximumResolution = maxSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumDiagonal(Double minimumDiagonal) {\n+        this.minimumDiagonal = minimumDiagonal;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumAspectRatio(Double minimumAspectRatio) {\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaximumAspectRatio(Double maximumAspectRatio) {\n+        this.maximumAspectRatio = maximumAspectRatio;\n+        return this;\n+    }\n+\n+    public Boolean isImageResolutionInRange(ImageResolution currentResolution) {\n+\n+        Integer constraintHeightMax = maximumResolution.getResolutionHeight();\n+        Integer constraintHeightMin = minimumResolution.getResolutionHeight();\n+        Integer constraintWidthMax = maximumResolution.getResolutionWidth();\n+        Integer constraintWidthMin = minimumResolution.getResolutionWidth();\n+        Integer resolutionHeight = currentResolution.getResolutionHeight();\n+        Integer resolutionWidth = currentResolution.getResolutionWidth();\n+        if (currentResolution.getResolutionHeight() > 0 && currentResolution.getResolutionWidth() > 0 && constraintHeightMax != null && constraintHeightMin != null) {\n+            if (!(resolutionHeight >= constraintHeightMin && resolutionHeight <= constraintHeightMax)) {\n+                return false;\n+            }\n+\n+            if (!(resolutionWidth >= constraintWidthMin && resolutionWidth <= constraintWidthMax)) {\n+                return false;\n+            }\n+            return true;\n+        } else {\n+            return false;\n+        }\n+    }\n+\n+    public Boolean isAspectRatioInRange(ImageResolution currentResolution) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18dd57cd46b201064099dd25ebd0831299d2c44b"}, "originalPosition": 90}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/adf067bb9019f085ed852f6112488a1b5bffc353", "committedDate": "2021-03-03T13:12:21Z", "message": "[0296]\n- Fix pr comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjAzMjA4NTMx", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-603208531", "createdAt": "2021-03-03T18:18:46Z", "commit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wM1QxODoxODo0NlrOIvfe3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wM1QyMDoyNjoyNlrOIvkn0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NjY2OTc5MA==", "bodyText": "Here we should also be checking if the list is empty,\nIf no ranges are supported the video should not be streamed", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r586669790", "createdAt": "2021-03-03T18:18:46Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +363,54 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n         if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n+\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, VideoStreamingRange portraitRange, VideoStreamingRange landscapeRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        this.supportedPortraitStreamingRange = portraitRange;\n+        this.supportedLandscapeStreamingRange = landscapeRange;\n+    }\n+\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters) {\n+        final VideoStreamingParameters params = (parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n         if (majorProtocolVersion >= 5) {\n             if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n                 internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n                     @Override\n                     public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n+                        VideoStreamingCapability castedCapability = ((VideoStreamingCapability) capability);\n+                        VideoStreamManager.this.originalCapability = castedCapability;\n+\n+                        params.update(castedCapability, vehicleMake);    //Streaming parameters are ready time to stream\n+                        VideoStreamManager.this.parameters = params;\n+\n+                        VideoStreamingCapability capabilityToSend = new VideoStreamingCapability();\n+                        capabilityToSend.setAdditionalVideoStreamingCapabilities(getSupportedCapabilities(castedCapability));\n+\n+                        if (capabilityToSend.getAdditionalVideoStreamingCapabilities() == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353"}, "originalPosition": 234}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NjY4NTEyNw==", "bodyText": "This should return false, the developer can set the minResolution or maxResolution in the range to null if they choose to only compare against aspectRatio and/or screen diagonal\nA range will be considered disabled if the minResolution and maxResolution are explicitly set to (0 width, 0 height)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r586685127", "createdAt": "2021-03-03T18:40:53Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +782,124 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        if (rootCapability == null){\n+            return null;\n+        }\n+\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities == null){\n+            return null;\n+        }\n+\n+        if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingCapability capability : allCapabilities) {\n+            ImageResolution imageResolution = capability.getPreferredResolution();\n+            boolean matches = false;\n+            switch (determineResolutionType(imageResolution)) {\n+                case SQUARE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange) || inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case PORTRAIT:\n+                    matches = inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case LANDSCAPE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange);\n+                    break;\n+                default:\n+                    break;\n+            }\n+\n+            if (matches) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+                if (!validCapabilities.contains(capability)) {\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    private Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n+        if (capability == null) {\n+            return false;\n+        }\n+        if (range == null) {\n+            return true;\n+        }\n+\n+        if (isZeroRange(range)){\n+            return false;\n+        }\n+\n+        if (!range.isImageResolutionInRange(capability.getPreferredResolution())){\n+            return false;\n+        }\n+\n+        ImageResolution resolution = capability.getPreferredResolution();\n+        Double currentAspectRatio = Double.valueOf(resolution.getResolutionWidth()) / Double.valueOf(resolution.getResolutionHeight());\n+        if (!range.isAspectRatioInRange(currentAspectRatio)){\n+            return false;\n+        }\n+\n+        double diagonal;\n+        if (capability.getDiagonalScreenSize() == null) {\n+            diagonal = parameters.getPreferredDiagonal();\n+        } else {\n+            diagonal = capability.getDiagonalScreenSize();\n+        }\n+\n+        if (range.getMinimumDiagonal() > diagonal) {\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    private Boolean isZeroRange(VideoStreamingRange range){\n+        if (range == null || range.getMaximumResolution() == null || range.getMinimumResolution() == null){\n+            return true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353"}, "originalPosition": 440}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NjY4NTM0NA==", "bodyText": "This should return false, the developer can set the minResolution or maxResolution in the range to null if they choose to only compare against aspectRatio and/or screen diagonal\nA range will be considered disabled if the minResolution and maxResolution are explicitly set to (0 width, 0 height)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r586685344", "createdAt": "2021-03-03T18:41:12Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +782,124 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        if (rootCapability == null){\n+            return null;\n+        }\n+\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities == null){\n+            return null;\n+        }\n+\n+        if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingCapability capability : allCapabilities) {\n+            ImageResolution imageResolution = capability.getPreferredResolution();\n+            boolean matches = false;\n+            switch (determineResolutionType(imageResolution)) {\n+                case SQUARE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange) || inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case PORTRAIT:\n+                    matches = inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case LANDSCAPE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange);\n+                    break;\n+                default:\n+                    break;\n+            }\n+\n+            if (matches) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+                if (!validCapabilities.contains(capability)) {\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    private Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n+        if (capability == null) {\n+            return false;\n+        }\n+        if (range == null) {\n+            return true;\n+        }\n+\n+        if (isZeroRange(range)){\n+            return false;\n+        }\n+\n+        if (!range.isImageResolutionInRange(capability.getPreferredResolution())){\n+            return false;\n+        }\n+\n+        ImageResolution resolution = capability.getPreferredResolution();\n+        Double currentAspectRatio = Double.valueOf(resolution.getResolutionWidth()) / Double.valueOf(resolution.getResolutionHeight());\n+        if (!range.isAspectRatioInRange(currentAspectRatio)){\n+            return false;\n+        }\n+\n+        double diagonal;\n+        if (capability.getDiagonalScreenSize() == null) {\n+            diagonal = parameters.getPreferredDiagonal();\n+        } else {\n+            diagonal = capability.getDiagonalScreenSize();\n+        }\n+\n+        if (range.getMinimumDiagonal() > diagonal) {\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    private Boolean isZeroRange(VideoStreamingRange range){\n+        if (range == null || range.getMaximumResolution() == null || range.getMinimumResolution() == null){\n+            return true;\n+        }\n+        return isZeroResolution(range.getMaximumResolution()) && isZeroResolution(range.getMinimumResolution());\n+    }\n+\n+    private boolean isZeroResolution(Resolution resolution){\n+        if (resolution == null) {\n+            return true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353"}, "originalPosition": 447}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NjcwNDI4Mg==", "bodyText": "The developer can set the minAspectRatio or maxAspectRatio in the range to null if they choose to only compare against resolution and/or screen diagonal\nThis method should first check if both maximumAspectRatio and minimumAspectRatio are null and if they are null then it should return true\nThen it should check if the given ratio is in range.\npublic Boolean isAspectRatioInRange(Double aspectRatio) {\n        if (maximumAspectRatio == null && minimumAspectRatio == null) {\n            return true;\n        }\n\n        boolean isInRange = true;\n        if (minimumAspectRatio != null) {\n            isInRange = aspectRatio >= minimumAspectRatio;\n        }\n        if (isInRange && maximumAspectRatio != null) {\n            isInRange = aspectRatio <= maximumAspectRatio;\n        }\n        return isInRange;\n    }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r586704282", "createdAt": "2021-03-03T19:08:08Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,98 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+import com.smartdevicelink.proxy.rpc.ImageResolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minimumResolution;\n+    private Resolution maximumResolution;\n+    private Double minimumDiagonal;\n+    private Double minimumAspectRatio;\n+    private Double maximumAspectRatio;\n+\n+    public VideoStreamingRange(Resolution minimumResolution, Resolution maximumResolution, Double minimumDiagonal, Double minimumAspectRatio, Double maximumAspectRatio) {\n+        this.minimumResolution = minimumResolution;\n+        this.maximumResolution = maximumResolution;\n+        this.minimumDiagonal = minimumDiagonal;\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        this.maximumAspectRatio = maximumAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinimumResolution() {\n+        return minimumResolution;\n+    }\n+\n+    public Resolution getMaximumResolution() {\n+        return maximumResolution;\n+    }\n+\n+    public Double getMinimumDiagonal() {\n+        return minimumDiagonal;\n+    }\n+\n+    public Double getMinimumAspectRatio() {\n+        return minimumAspectRatio;\n+    }\n+\n+    public Double getMaximumAspectRatio() {\n+        return maximumAspectRatio;\n+    }\n+\n+    public VideoStreamingRange setMinSupportedResolution(Resolution minSupportedResolution) {\n+        this.minimumResolution = minSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+        this.maximumResolution = maxSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumDiagonal(Double minimumDiagonal) {\n+        this.minimumDiagonal = minimumDiagonal;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumAspectRatio(Double minimumAspectRatio) {\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaximumAspectRatio(Double maximumAspectRatio) {\n+        this.maximumAspectRatio = maximumAspectRatio;\n+        return this;\n+    }\n+\n+    public Boolean isImageResolutionInRange(ImageResolution currentResolution) {\n+\n+        Integer constraintHeightMax = maximumResolution.getResolutionHeight();\n+        Integer constraintHeightMin = minimumResolution.getResolutionHeight();\n+        Integer constraintWidthMax = maximumResolution.getResolutionWidth();\n+        Integer constraintWidthMin = minimumResolution.getResolutionWidth();\n+        Integer resolutionHeight = currentResolution.getResolutionHeight();\n+        Integer resolutionWidth = currentResolution.getResolutionWidth();\n+        if (currentResolution.getResolutionHeight() > 0 && currentResolution.getResolutionWidth() > 0 && constraintHeightMax != null && constraintHeightMin != null) {\n+            if (!(resolutionHeight >= constraintHeightMin && resolutionHeight <= constraintHeightMax)) {\n+                return false;\n+            }\n+\n+            if (!(resolutionWidth >= constraintWidthMin && resolutionWidth <= constraintWidthMax)) {\n+                return false;\n+            }\n+            return true;\n+        } else {\n+            return false;\n+        }\n+    }\n+\n+    public Boolean isAspectRatioInRange(Double aspectRatio) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NjcxMzAzMQ==", "bodyText": "MinDiagonal could be null if the developer does not want to specify a minimumDiagonal, we should make sure the minimumDiagonal is not null before comparign and if the minimumDiagonal is null it means the developer does not want to restrict capabilities based on this field\nif (range.getMinimumDiagonal() != null && range.getMinimumDiagonal() > diagonal) {\n     return false;\n}", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r586713031", "createdAt": "2021-03-03T19:21:52Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +782,124 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        if (rootCapability == null){\n+            return null;\n+        }\n+\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities == null){\n+            return null;\n+        }\n+\n+        if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingCapability capability : allCapabilities) {\n+            ImageResolution imageResolution = capability.getPreferredResolution();\n+            boolean matches = false;\n+            switch (determineResolutionType(imageResolution)) {\n+                case SQUARE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange) || inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case PORTRAIT:\n+                    matches = inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case LANDSCAPE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange);\n+                    break;\n+                default:\n+                    break;\n+            }\n+\n+            if (matches) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+                if (!validCapabilities.contains(capability)) {\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    private Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n+        if (capability == null) {\n+            return false;\n+        }\n+        if (range == null) {\n+            return true;\n+        }\n+\n+        if (isZeroRange(range)){\n+            return false;\n+        }\n+\n+        if (!range.isImageResolutionInRange(capability.getPreferredResolution())){\n+            return false;\n+        }\n+\n+        ImageResolution resolution = capability.getPreferredResolution();\n+        Double currentAspectRatio = Double.valueOf(resolution.getResolutionWidth()) / Double.valueOf(resolution.getResolutionHeight());\n+        if (!range.isAspectRatioInRange(currentAspectRatio)){\n+            return false;\n+        }\n+\n+        double diagonal;\n+        if (capability.getDiagonalScreenSize() == null) {\n+            diagonal = parameters.getPreferredDiagonal();\n+        } else {\n+            diagonal = capability.getDiagonalScreenSize();\n+        }\n+\n+        if (range.getMinimumDiagonal() > diagonal) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353"}, "originalPosition": 431}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NjcxNjI0Mg==", "bodyText": "The developer can set the minResolution and maxResolution in the range to null if they choose to only compare against aspectRatio and/or screen diagonal,\nIf both are null we should not perform this check\nif (range.getMinimumResolution() != null || range.getMaximumResolution() != null) {\n         if (!range.isImageResolutionInRange(capability.getPreferredResolution())) {\n             return false;\n            }\n         }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r586716242", "createdAt": "2021-03-03T19:26:54Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +782,124 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        if (rootCapability == null){\n+            return null;\n+        }\n+\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities == null){\n+            return null;\n+        }\n+\n+        if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingCapability capability : allCapabilities) {\n+            ImageResolution imageResolution = capability.getPreferredResolution();\n+            boolean matches = false;\n+            switch (determineResolutionType(imageResolution)) {\n+                case SQUARE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange) || inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case PORTRAIT:\n+                    matches = inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case LANDSCAPE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange);\n+                    break;\n+                default:\n+                    break;\n+            }\n+\n+            if (matches) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+                if (!validCapabilities.contains(capability)) {\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    private Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n+        if (capability == null) {\n+            return false;\n+        }\n+        if (range == null) {\n+            return true;\n+        }\n+\n+        if (isZeroRange(range)){\n+            return false;\n+        }\n+\n+        if (!range.isImageResolutionInRange(capability.getPreferredResolution())){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353"}, "originalPosition": 414}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4Njc1NDAwMA==", "bodyText": "A few additional checks should be made here,\nif the passed resolution is null we should return false (no resolution received from the capability)\nif both the minimumResolution and maximumResolution are null we should return true (the developer does not want to use resolution for the range)\nIf one of the reolutions (minimumResolution and maximumResolution) is null or set to 0 values it should return false (only one of the resolutions is null or the resolution has 0 values)\n        if (currentResolution == null) {\n            return false;\n        }\n\n        if (minimumResolution == null && maximumResolution == null) {\n            return true;\n        }\n\n        if (minimumResolution == null || (minimumResolution.getResolutionWidth() == 0 && minimumResolution.getResolutionHeight() == 0)) {\n            return false;\n        }\n\n        if (maximumResolution != null || (maximumResolution.getResolutionWidth() == 0 && maximumResolution.getResolutionHeight() == 0)) {\n            return false;\n        }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r586754000", "createdAt": "2021-03-03T20:26:26Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,98 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+import com.smartdevicelink.proxy.rpc.ImageResolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minimumResolution;\n+    private Resolution maximumResolution;\n+    private Double minimumDiagonal;\n+    private Double minimumAspectRatio;\n+    private Double maximumAspectRatio;\n+\n+    public VideoStreamingRange(Resolution minimumResolution, Resolution maximumResolution, Double minimumDiagonal, Double minimumAspectRatio, Double maximumAspectRatio) {\n+        this.minimumResolution = minimumResolution;\n+        this.maximumResolution = maximumResolution;\n+        this.minimumDiagonal = minimumDiagonal;\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        this.maximumAspectRatio = maximumAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinimumResolution() {\n+        return minimumResolution;\n+    }\n+\n+    public Resolution getMaximumResolution() {\n+        return maximumResolution;\n+    }\n+\n+    public Double getMinimumDiagonal() {\n+        return minimumDiagonal;\n+    }\n+\n+    public Double getMinimumAspectRatio() {\n+        return minimumAspectRatio;\n+    }\n+\n+    public Double getMaximumAspectRatio() {\n+        return maximumAspectRatio;\n+    }\n+\n+    public VideoStreamingRange setMinSupportedResolution(Resolution minSupportedResolution) {\n+        this.minimumResolution = minSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+        this.maximumResolution = maxSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumDiagonal(Double minimumDiagonal) {\n+        this.minimumDiagonal = minimumDiagonal;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumAspectRatio(Double minimumAspectRatio) {\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaximumAspectRatio(Double maximumAspectRatio) {\n+        this.maximumAspectRatio = maximumAspectRatio;\n+        return this;\n+    }\n+\n+    public Boolean isImageResolutionInRange(ImageResolution currentResolution) {\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353"}, "originalPosition": 69}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "62fd8528ddd76d992bd3b2b56b0d02c2961da7a6", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/62fd8528ddd76d992bd3b2b56b0d02c2961da7a6", "committedDate": "2021-03-04T11:45:53Z", "message": "[0296]\n- Fix pr comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA0MzIxMTc1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-604321175", "createdAt": "2021-03-04T16:49:22Z", "commit": {"oid": "62fd8528ddd76d992bd3b2b56b0d02c2961da7a6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wNFQxNjo0OToyMlrOIwak1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wNFQxNzowNzo1M1rOIwbl6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzYzNzk3NA==", "bodyText": "We need to adjust the resolution here based on the scale of the capability, a helper method can be added and we can call it with the capability we are testing against\nprivate Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n        \n        ...\n\n        if (range.getMinimumResolution() != null || range.getMaximumResolution() != null) {\n            if (!range.isImageResolutionInRange(makeScaledImageResolution(capability))) {\n                return false;\n            }\n        }\n        \n        ...\n\n}\n\nprivate ImageResolution makeScaledImageResolution(VideoStreamingCapability capability) {\n        if (capability.getScale() == null) {\n            return capability.getPreferredResolution();\n        } else {\n            double scaledWidth = (double) capability.getPreferredResolution().getResolutionWidth() / capability.getScale();\n            double scaledHeight = (double) capability.getPreferredResolution().getResolutionHeight() / capability.getScale();\n            return new ImageResolution((int) scaledWidth, (int) scaledHeight);\n        }\n    }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r587637974", "createdAt": "2021-03-04T16:49:22Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +782,126 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        if (rootCapability == null){\n+            return null;\n+        }\n+\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities == null){\n+            return null;\n+        }\n+\n+        if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingCapability capability : allCapabilities) {\n+            ImageResolution imageResolution = capability.getPreferredResolution();\n+            boolean matches = false;\n+            switch (determineResolutionType(imageResolution)) {\n+                case SQUARE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange) || inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case PORTRAIT:\n+                    matches = inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case LANDSCAPE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange);\n+                    break;\n+                default:\n+                    break;\n+            }\n+\n+            if (matches) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+                if (!validCapabilities.contains(capability)) {\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    private Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n+        if (capability == null) {\n+            return false;\n+        }\n+        if (range == null) {\n+            return true;\n+        }\n+\n+        if (isZeroRange(range)){\n+            return false;\n+        }\n+\n+        if (range.getMinimumResolution() != null || range.getMaximumResolution() != null) {\n+            if (!range.isImageResolutionInRange(capability.getPreferredResolution())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62fd8528ddd76d992bd3b2b56b0d02c2961da7a6"}, "originalPosition": 415}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzY0MDIwNg==", "bodyText": "We need to normalize the aspectRatio, a helper method can be added and we can call it with the resolution we get from the capability\nprivate Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n        \n        ...\n\n        ImageResolution resolution = capability.getPreferredResolution();\n        if (resolution != null) {\n            Double currentAspectRatio = normalizeAspectRatio(resolution);\n            if (!range.isAspectRatioInRange(currentAspectRatio)){\n                return false;\n            }\n        }\n        \n        ...\n        \n}\n\nprivate Double normalizeAspectRatio(ImageResolution resolution) {\n        double width = resolution.getResolutionWidth();\n        double height = resolution.getResolutionHeight();\n\n        if (width <= 0.0 || height <= 0.0) {\n            return 0.0;\n        } else if (width < height) {\n            return height/width;\n        } else if (width > height) {\n            return width/height;\n        } else {\n            return 1.0;\n        }\n    }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r587640206", "createdAt": "2021-03-04T16:52:00Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -645,6 +782,126 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n         return motionEventList;\n     }\n \n+    public VideoStreamingParameters getLastCachedStreamingParameters() {\n+        return parameters;\n+    }\n+\n+    private List<VideoStreamingCapability> getSupportedCapabilities(VideoStreamingCapability rootCapability){\n+\n+        List<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+        if (rootCapability == null){\n+            return null;\n+        }\n+\n+        List<VideoStreamingCapability> allCapabilities = rootCapability.getAdditionalVideoStreamingCapabilities();\n+        if (allCapabilities == null){\n+            return null;\n+        }\n+\n+        if (allCapabilities != null){\n+            rootCapability.setAdditionalVideoStreamingCapabilities(null);\n+            allCapabilities.add(rootCapability);\n+        }\n+\n+        for (VideoStreamingCapability capability : allCapabilities) {\n+            ImageResolution imageResolution = capability.getPreferredResolution();\n+            boolean matches = false;\n+            switch (determineResolutionType(imageResolution)) {\n+                case SQUARE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange) || inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case PORTRAIT:\n+                    matches = inRange(capability, this.supportedPortraitStreamingRange);\n+                    break;\n+                case LANDSCAPE:\n+                    matches = inRange(capability, this.supportedLandscapeStreamingRange);\n+                    break;\n+                default:\n+                    break;\n+            }\n+\n+            if (matches) {\n+                capability.setAdditionalVideoStreamingCapabilities(null);\n+                if (!validCapabilities.contains(capability)) {\n+                    validCapabilities.add(capability);\n+                }\n+            }\n+        }\n+\n+        return validCapabilities;\n+    }\n+\n+    private Boolean inRange(VideoStreamingCapability capability, VideoStreamingRange range){\n+        if (capability == null) {\n+            return false;\n+        }\n+        if (range == null) {\n+            return true;\n+        }\n+\n+        if (isZeroRange(range)){\n+            return false;\n+        }\n+\n+        if (range.getMinimumResolution() != null || range.getMaximumResolution() != null) {\n+            if (!range.isImageResolutionInRange(capability.getPreferredResolution())) {\n+                return false;\n+            }\n+        }\n+\n+        ImageResolution resolution = capability.getPreferredResolution();\n+        Double currentAspectRatio = Double.valueOf(resolution.getResolutionWidth()) / Double.valueOf(resolution.getResolutionHeight());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62fd8528ddd76d992bd3b2b56b0d02c2961da7a6"}, "originalPosition": 421}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzY0MTM3MA==", "bodyText": "This was a typo on my previous comment\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (maximumResolution != null || (maximumResolution.getResolutionWidth() == 0 && maximumResolution.getResolutionHeight() == 0)) {\n          \n          \n            \n                    if (maximumResolution == null || (maximumResolution.getResolutionWidth() == 0 && maximumResolution.getResolutionHeight() == 0)) {", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r587641370", "createdAt": "2021-03-04T16:53:18Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,122 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+import com.smartdevicelink.proxy.rpc.ImageResolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minimumResolution;\n+    private Resolution maximumResolution;\n+    private Double minimumDiagonal;\n+    private Double minimumAspectRatio;\n+    private Double maximumAspectRatio;\n+\n+    public VideoStreamingRange(Resolution minimumResolution, Resolution maximumResolution, Double minimumDiagonal, Double minimumAspectRatio, Double maximumAspectRatio) {\n+        this.minimumResolution = minimumResolution;\n+        this.maximumResolution = maximumResolution;\n+        this.minimumDiagonal = minimumDiagonal;\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        this.maximumAspectRatio = maximumAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinimumResolution() {\n+        return minimumResolution;\n+    }\n+\n+    public Resolution getMaximumResolution() {\n+        return maximumResolution;\n+    }\n+\n+    public Double getMinimumDiagonal() {\n+        return minimumDiagonal;\n+    }\n+\n+    public Double getMinimumAspectRatio() {\n+        return minimumAspectRatio;\n+    }\n+\n+    public Double getMaximumAspectRatio() {\n+        return maximumAspectRatio;\n+    }\n+\n+    public VideoStreamingRange setMinSupportedResolution(Resolution minSupportedResolution) {\n+        this.minimumResolution = minSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+        this.maximumResolution = maxSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumDiagonal(Double minimumDiagonal) {\n+        this.minimumDiagonal = minimumDiagonal;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumAspectRatio(Double minimumAspectRatio) {\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaximumAspectRatio(Double maximumAspectRatio) {\n+        this.maximumAspectRatio = maximumAspectRatio;\n+        return this;\n+    }\n+\n+    public Boolean isImageResolutionInRange(ImageResolution currentResolution) {\n+\n+        Integer constraintHeightMax = maximumResolution.getResolutionHeight();\n+        Integer constraintHeightMin = minimumResolution.getResolutionHeight();\n+        Integer constraintWidthMax = maximumResolution.getResolutionWidth();\n+        Integer constraintWidthMin = minimumResolution.getResolutionWidth();\n+        Integer resolutionHeight = currentResolution.getResolutionHeight();\n+        Integer resolutionWidth = currentResolution.getResolutionWidth();\n+\n+        if (currentResolution == null) {\n+            return false;\n+        }\n+\n+        if (minimumResolution == null && maximumResolution == null) {\n+            return true;\n+        }\n+\n+        if (minimumResolution == null || (minimumResolution.getResolutionWidth() == 0 && minimumResolution.getResolutionHeight() == 0)) {\n+            return false;\n+        }\n+\n+        if (maximumResolution != null || (maximumResolution.getResolutionWidth() == 0 && maximumResolution.getResolutionHeight() == 0)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62fd8528ddd76d992bd3b2b56b0d02c2961da7a6"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzY0NDM5Mg==", "bodyText": "Hello @kostyaBoss, these checks should happen before initializing these local variables to avoid a NPE on maximumResolution.getResolutionHeight() or minimumResolution.getResolutionHeight()\nInteger constraintHeightMax = maximumResolution.getResolutionHeight();\nInteger constraintHeightMin = minimumResolution.getResolutionHeight();\nInteger constraintWidthMax = maximumResolution.getResolutionWidth();\nInteger constraintWidthMin = minimumResolution.getResolutionWidth();\nInteger resolutionHeight = currentResolution.getResolutionHeight();\nInteger resolutionWidth = currentResolution.getResolutionWidth();", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r587644392", "createdAt": "2021-03-04T16:56:51Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,98 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+import com.smartdevicelink.proxy.rpc.ImageResolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minimumResolution;\n+    private Resolution maximumResolution;\n+    private Double minimumDiagonal;\n+    private Double minimumAspectRatio;\n+    private Double maximumAspectRatio;\n+\n+    public VideoStreamingRange(Resolution minimumResolution, Resolution maximumResolution, Double minimumDiagonal, Double minimumAspectRatio, Double maximumAspectRatio) {\n+        this.minimumResolution = minimumResolution;\n+        this.maximumResolution = maximumResolution;\n+        this.minimumDiagonal = minimumDiagonal;\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        this.maximumAspectRatio = maximumAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinimumResolution() {\n+        return minimumResolution;\n+    }\n+\n+    public Resolution getMaximumResolution() {\n+        return maximumResolution;\n+    }\n+\n+    public Double getMinimumDiagonal() {\n+        return minimumDiagonal;\n+    }\n+\n+    public Double getMinimumAspectRatio() {\n+        return minimumAspectRatio;\n+    }\n+\n+    public Double getMaximumAspectRatio() {\n+        return maximumAspectRatio;\n+    }\n+\n+    public VideoStreamingRange setMinSupportedResolution(Resolution minSupportedResolution) {\n+        this.minimumResolution = minSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+        this.maximumResolution = maxSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumDiagonal(Double minimumDiagonal) {\n+        this.minimumDiagonal = minimumDiagonal;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumAspectRatio(Double minimumAspectRatio) {\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaximumAspectRatio(Double maximumAspectRatio) {\n+        this.maximumAspectRatio = maximumAspectRatio;\n+        return this;\n+    }\n+\n+    public Boolean isImageResolutionInRange(ImageResolution currentResolution) {\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4Njc1NDAwMA=="}, "originalCommit": {"oid": "adf067bb9019f085ed852f6112488a1b5bffc353"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzY0NDgyMw==", "bodyText": "Unit tests should be added for this method", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r587644823", "createdAt": "2021-03-04T16:57:21Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,122 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+import com.smartdevicelink.proxy.rpc.ImageResolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minimumResolution;\n+    private Resolution maximumResolution;\n+    private Double minimumDiagonal;\n+    private Double minimumAspectRatio;\n+    private Double maximumAspectRatio;\n+\n+    public VideoStreamingRange(Resolution minimumResolution, Resolution maximumResolution, Double minimumDiagonal, Double minimumAspectRatio, Double maximumAspectRatio) {\n+        this.minimumResolution = minimumResolution;\n+        this.maximumResolution = maximumResolution;\n+        this.minimumDiagonal = minimumDiagonal;\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        this.maximumAspectRatio = maximumAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinimumResolution() {\n+        return minimumResolution;\n+    }\n+\n+    public Resolution getMaximumResolution() {\n+        return maximumResolution;\n+    }\n+\n+    public Double getMinimumDiagonal() {\n+        return minimumDiagonal;\n+    }\n+\n+    public Double getMinimumAspectRatio() {\n+        return minimumAspectRatio;\n+    }\n+\n+    public Double getMaximumAspectRatio() {\n+        return maximumAspectRatio;\n+    }\n+\n+    public VideoStreamingRange setMinSupportedResolution(Resolution minSupportedResolution) {\n+        this.minimumResolution = minSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+        this.maximumResolution = maxSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumDiagonal(Double minimumDiagonal) {\n+        this.minimumDiagonal = minimumDiagonal;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumAspectRatio(Double minimumAspectRatio) {\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaximumAspectRatio(Double maximumAspectRatio) {\n+        this.maximumAspectRatio = maximumAspectRatio;\n+        return this;\n+    }\n+\n+    public Boolean isImageResolutionInRange(ImageResolution currentResolution) {\n+\n+        Integer constraintHeightMax = maximumResolution.getResolutionHeight();\n+        Integer constraintHeightMin = minimumResolution.getResolutionHeight();\n+        Integer constraintWidthMax = maximumResolution.getResolutionWidth();\n+        Integer constraintWidthMin = minimumResolution.getResolutionWidth();\n+        Integer resolutionHeight = currentResolution.getResolutionHeight();\n+        Integer resolutionWidth = currentResolution.getResolutionWidth();\n+\n+        if (currentResolution == null) {\n+            return false;\n+        }\n+\n+        if (minimumResolution == null && maximumResolution == null) {\n+            return true;\n+        }\n+\n+        if (minimumResolution == null || (minimumResolution.getResolutionWidth() == 0 && minimumResolution.getResolutionHeight() == 0)) {\n+            return false;\n+        }\n+\n+        if (maximumResolution != null || (maximumResolution.getResolutionWidth() == 0 && maximumResolution.getResolutionHeight() == 0)) {\n+            return false;\n+        }\n+\n+        if (currentResolution.getResolutionHeight() > 0 && currentResolution.getResolutionWidth() > 0 && constraintHeightMax != null && constraintHeightMin != null) {\n+            if (!(resolutionHeight >= constraintHeightMin && resolutionHeight <= constraintHeightMax)) {\n+                return false;\n+            }\n+\n+            if (!(resolutionWidth >= constraintWidthMin && resolutionWidth <= constraintWidthMax)) {\n+                return false;\n+            }\n+            return true;\n+        } else {\n+            return false;\n+        }\n+    }\n+\n+    public Boolean isAspectRatioInRange(Double aspectRatio) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62fd8528ddd76d992bd3b2b56b0d02c2961da7a6"}, "originalPosition": 107}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzY0NTEzMA==", "bodyText": "Unit tests should be added for this method", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r587645130", "createdAt": "2021-03-04T16:57:41Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,122 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+import com.smartdevicelink.proxy.rpc.ImageResolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minimumResolution;\n+    private Resolution maximumResolution;\n+    private Double minimumDiagonal;\n+    private Double minimumAspectRatio;\n+    private Double maximumAspectRatio;\n+\n+    public VideoStreamingRange(Resolution minimumResolution, Resolution maximumResolution, Double minimumDiagonal, Double minimumAspectRatio, Double maximumAspectRatio) {\n+        this.minimumResolution = minimumResolution;\n+        this.maximumResolution = maximumResolution;\n+        this.minimumDiagonal = minimumDiagonal;\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        this.maximumAspectRatio = maximumAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinimumResolution() {\n+        return minimumResolution;\n+    }\n+\n+    public Resolution getMaximumResolution() {\n+        return maximumResolution;\n+    }\n+\n+    public Double getMinimumDiagonal() {\n+        return minimumDiagonal;\n+    }\n+\n+    public Double getMinimumAspectRatio() {\n+        return minimumAspectRatio;\n+    }\n+\n+    public Double getMaximumAspectRatio() {\n+        return maximumAspectRatio;\n+    }\n+\n+    public VideoStreamingRange setMinSupportedResolution(Resolution minSupportedResolution) {\n+        this.minimumResolution = minSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+        this.maximumResolution = maxSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumDiagonal(Double minimumDiagonal) {\n+        this.minimumDiagonal = minimumDiagonal;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumAspectRatio(Double minimumAspectRatio) {\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaximumAspectRatio(Double maximumAspectRatio) {\n+        this.maximumAspectRatio = maximumAspectRatio;\n+        return this;\n+    }\n+\n+    public Boolean isImageResolutionInRange(ImageResolution currentResolution) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62fd8528ddd76d992bd3b2b56b0d02c2961da7a6"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzY1NDYzNA==", "bodyText": "Can we add a log message here so the developer is aware of why the video has not streamed\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                        stateMachine.transitionToState(StreamingStateMachine.STOPPED);\n          \n          \n            \n                                        stateMachine.transitionToState(StreamingStateMachine.STOPPED);\n          \n          \n            \n                                        DebugTool.logError(TAG, \"The Video stream was not started because there were no supported video streaming capabilities, please double check that the VideoStreamRanges provided are not disabled ranges\");", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r587654634", "createdAt": "2021-03-04T17:07:53Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -284,25 +363,54 @@ public void onError(String info) {\n      *                           works best for the currently connected module.\n      * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n      */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+    @Deprecated\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null, null);\n         boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n         if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n             DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n             stateMachine.transitionToState(StreamingStateMachine.ERROR);\n             return;\n         }\n-        // regardless of VideoStreamingParameters are specified or not, we should refer to VideoStreamingCapability.\n+        processCapabilitiesWithPendingStart(encrypted, parameters);\n+    }\n+\n+    private void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, VideoStreamingRange portraitRange, VideoStreamingRange landscapeRange) {\n+        this.context = new WeakReference<>(context);\n+        this.remoteDisplayClass = remoteDisplayClass;\n+        this.isEncrypted = encrypted;\n+        this.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+        this.supportedPortraitStreamingRange = portraitRange;\n+        this.supportedLandscapeStreamingRange = landscapeRange;\n+    }\n+\n+\n+    private void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters) {\n+        final VideoStreamingParameters params = (parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n         if (majorProtocolVersion >= 5) {\n             if (internalInterface.getSystemCapabilityManager() != null) {\n-                final VideoStreamingParameters params = ( parameters == null) ? new VideoStreamingParameters() : new VideoStreamingParameters(parameters);\n                 internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n                     @Override\n                     public void onCapabilityRetrieved(Object capability) {\n-                        params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                        startStreaming(params, encrypted);\n+                        VideoStreamingCapability castedCapability = ((VideoStreamingCapability) capability);\n+                        VideoStreamManager.this.originalCapability = castedCapability;\n+\n+                        params.update(castedCapability, vehicleMake);    //Streaming parameters are ready time to stream\n+                        VideoStreamManager.this.parameters = params;\n+\n+                        VideoStreamingCapability capabilityToSend = new VideoStreamingCapability();\n+                        capabilityToSend.setAdditionalVideoStreamingCapabilities(getSupportedCapabilities(castedCapability));\n+\n+                        if (capabilityToSend.getAdditionalVideoStreamingCapabilities() == null || capabilityToSend.getAdditionalVideoStreamingCapabilities().isEmpty()) {\n+                            stateMachine.transitionToState(StreamingStateMachine.STOPPED);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62fd8528ddd76d992bd3b2b56b0d02c2961da7a6"}, "originalPosition": 235}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c6ee23ef3da181426be970b3459e39249f0ddf1", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/1c6ee23ef3da181426be970b3459e39249f0ddf1", "committedDate": "2021-03-05T11:15:15Z", "message": "[0296]\n- Fix pr comments\n- Add tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA1MzMwNjI0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-605330624", "createdAt": "2021-03-05T15:20:53Z", "commit": {"oid": "1c6ee23ef3da181426be970b3459e39249f0ddf1"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wNVQxNToyMDo1NFrOIxHsSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0wNVQxNToyMzoyN1rOIxH1VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODM3NzE2MQ==", "bodyText": "@kostyaBoss, Please add more unit tests here,\nThere should be tests for\ntestResolutionOutOfRange\ntestAspectRatioOutOfRange\ntestResolutionWithNullResolutionRange (Range resolutions are set to null and should return true)\ntestAspectRatioWithNullAspectRatioRange (Range aspect Ratios are set to null and should return true)\ntestResolutionWithDisabledResolutionRange (Range resolutions have 0 width and height values and should return false)\ntestResolutionWithDisabledAspectRatioRange (Range aspectRatios have 0 values and should return false)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r588377161", "createdAt": "2021-03-05T15:20:54Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamingRangeTests.java", "diffHunk": "@@ -0,0 +1,46 @@\n+package com.smartdevicelink.managers.video;\n+\n+import androidx.test.ext.junit.runners.AndroidJUnit4;\n+\n+import com.smartdevicelink.managers.video.resolution.Resolution;\n+import com.smartdevicelink.managers.video.resolution.VideoStreamingRange;\n+import com.smartdevicelink.proxy.rpc.ImageResolution;\n+\n+import junit.framework.TestCase;\n+\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+\n+@RunWith(AndroidJUnit4.class)\n+public class VideoStreamingRangeTests extends TestCase {\n+\n+    VideoStreamingRange testRange;\n+    Resolution minResolution;\n+    Resolution maxResolution;\n+    Double minimumDiagonal;\n+    Double minimumAspectRatio;\n+    Double maximumAspectRatio;\n+\n+    @Before\n+    public void setUp() {\n+        minResolution = new Resolution(640, 480);\n+        maxResolution = new Resolution(1920, 1080);\n+        minimumDiagonal = 3.3;\n+        minimumAspectRatio = 1.0;\n+        maximumAspectRatio = 2.0;\n+        testRange = new VideoStreamingRange(minResolution, maxResolution, minimumDiagonal, minimumAspectRatio, maximumAspectRatio);\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c6ee23ef3da181426be970b3459e39249f0ddf1"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODM3OTQ3Nw==", "bodyText": "Hello @kostyaBoss,\none comment was missed in the last commit, These lines can potentially throw NPEs\nInteger constraintHeightMax = maximumResolution.getResolutionHeight();\nInteger constraintHeightMin = minimumResolution.getResolutionHeight();\nInteger constraintWidthMax = maximumResolution.getResolutionWidth();\nInteger constraintWidthMin = minimumResolution.getResolutionWidth();\nInteger resolutionHeight = currentResolution.getResolutionHeight();\nInteger resolutionWidth = currentResolution.getResolutionWidth();\n\nBecause of this, these checks should be performed first.\n        if (currentResolution == null) {\n            return false;\n        }\n\n        if (minimumResolution == null && maximumResolution == null) {\n            return true;\n        }\n\n        if (minimumResolution == null || (minimumResolution.getResolutionWidth() == 0 && minimumResolution.getResolutionHeight() == 0)) {\n            return false;\n        }\n\n        if (maximumResolution == null || (maximumResolution.getResolutionWidth() == 0 && maximumResolution.getResolutionHeight() == 0)) {\n            return false;\n        }", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r588379477", "createdAt": "2021-03-05T15:23:27Z", "author": {"login": "RHenigan"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,122 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+import com.smartdevicelink.proxy.rpc.ImageResolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minimumResolution;\n+    private Resolution maximumResolution;\n+    private Double minimumDiagonal;\n+    private Double minimumAspectRatio;\n+    private Double maximumAspectRatio;\n+\n+    public VideoStreamingRange(Resolution minimumResolution, Resolution maximumResolution, Double minimumDiagonal, Double minimumAspectRatio, Double maximumAspectRatio) {\n+        this.minimumResolution = minimumResolution;\n+        this.maximumResolution = maximumResolution;\n+        this.minimumDiagonal = minimumDiagonal;\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        this.maximumAspectRatio = maximumAspectRatio;\n+    }\n+\n+    private VideoStreamingRange() {\n+    }\n+\n+    public Resolution getMinimumResolution() {\n+        return minimumResolution;\n+    }\n+\n+    public Resolution getMaximumResolution() {\n+        return maximumResolution;\n+    }\n+\n+    public Double getMinimumDiagonal() {\n+        return minimumDiagonal;\n+    }\n+\n+    public Double getMinimumAspectRatio() {\n+        return minimumAspectRatio;\n+    }\n+\n+    public Double getMaximumAspectRatio() {\n+        return maximumAspectRatio;\n+    }\n+\n+    public VideoStreamingRange setMinSupportedResolution(Resolution minSupportedResolution) {\n+        this.minimumResolution = minSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaxSupportedResolution(Resolution maxSupportedResolution) {\n+        this.maximumResolution = maxSupportedResolution;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumDiagonal(Double minimumDiagonal) {\n+        this.minimumDiagonal = minimumDiagonal;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMinimumAspectRatio(Double minimumAspectRatio) {\n+        this.minimumAspectRatio = minimumAspectRatio;\n+        return this;\n+    }\n+\n+    public VideoStreamingRange setMaximumAspectRatio(Double maximumAspectRatio) {\n+        this.maximumAspectRatio = maximumAspectRatio;\n+        return this;\n+    }\n+\n+    public Boolean isImageResolutionInRange(ImageResolution currentResolution) {\n+\n+        Integer constraintHeightMax = maximumResolution.getResolutionHeight();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1c6ee23ef3da181426be970b3459e39249f0ddf1"}, "originalPosition": 70}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c790274460a219b2630b0fa2bf02b5bb5f89ba5a", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c790274460a219b2630b0fa2bf02b5bb5f89ba5a", "committedDate": "2021-03-08T20:17:22Z", "message": "[0296]\n- Add tests\n- Fix npes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "56f6cc7531d742da67b8637e2c5ba65f3ba9e4a9", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/56f6cc7531d742da67b8637e2c5ba65f3ba9e4a9", "committedDate": "2021-03-08T21:06:48Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "038c990437f55d991bc03fb2d89a3321e87995d5", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/038c990437f55d991bc03fb2d89a3321e87995d5", "committedDate": "2021-03-08T21:19:05Z", "message": "[0293]\n- Fix PR comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "577df30f19db0bb1234a41cd4ae2ae9f22a9d296", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/577df30f19db0bb1234a41cd4ae2ae9f22a9d296", "committedDate": "2021-03-08T22:20:30Z", "message": "[0296]\n- Fix PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NjA3NjMzMzk1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-607633395", "createdAt": "2021-03-09T16:49:49Z", "commit": {"oid": "577df30f19db0bb1234a41cd4ae2ae9f22a9d296"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5d30ae0fa3e9f99081a3edc8bd56d36fed318004", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/5d30ae0fa3e9f99081a3edc8bd56d36fed318004", "committedDate": "2020-04-30T12:35:09Z", "message": "[poc/unknown-enums]\n    - Fix Button capabilities logging\n    - Improve lifecycle management and version retrieving for RAI\n    - Fix NPE for responses if SDLVersion is passed as null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0958db7f962f1fdb0c1154aaac5c0807f4acba1a", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/0958db7f962f1fdb0c1154aaac5c0807f4acba1a", "committedDate": "2020-04-30T12:36:08Z", "message": "[poc/unknown-enums]\n    - Fix Button capabilities logging\n    - Improve lifecycle management and version retrieving for RAI\n    - Fix NPE for responses if SDLVersion is passed as null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "67cc2e489372b315c6143131570d1c97a1167738", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/67cc2e489372b315c6143131570d1c97a1167738", "committedDate": "2020-04-30T12:45:24Z", "message": "[poc/video-streaming]\n    - Hardcoded display size to 2k"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f48cd995d7f9711ff3eae8760f9bd7562f5afd0", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/4f48cd995d7f9711ff3eae8760f9bd7562f5afd0", "committedDate": "2020-04-30T14:05:33Z", "message": "[poc/video-streaming]\n    - Add video config fields\n    - Fix bug with default bad scale"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc7ca23a5c749df8dba9a728c9a3ab7543251621", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/dc7ca23a5c749df8dba9a728c9a3ab7543251621", "committedDate": "2020-04-30T14:06:48Z", "message": "[poc/video-streaming]\n    - Add video config fields\n    - Fix bug with default bad scale"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e15cc6514667ff453aad63547a6678c5ad9944c3", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e15cc6514667ff453aad63547a6678c5ad9944c3", "committedDate": "2020-05-05T17:46:53Z", "message": "[poc/video-streaming]\n    - Add service restart"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e79b976f3969789d05a00db36962f919e3cd196", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/4e79b976f3969789d05a00db36962f919e3cd196", "committedDate": "2020-05-19T11:17:16Z", "message": "[poc/video-streaming]\n    - Implement video streaming POC for android"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac26007d0dfbc51649d7c1c20cc7cf9d94dd9f79", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/ac26007d0dfbc51649d7c1c20cc7cf9d94dd9f79", "committedDate": "2020-05-27T14:10:24Z", "message": "[poc/video-streaming]\n    - Update onServiceEnded with proper handling"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1a11c2093b373b024bb1eb3b3e1db70cb2d61e5", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/f1a11c2093b373b024bb1eb3b3e1db70cb2d61e5", "committedDate": "2020-05-27T14:19:10Z", "message": "Merge branch 'develop' into poc/video_streaming_with_capabilities_update\n\n# Conflicts:\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e1d401d17b9bce5f1ce1efc105598420578f971b", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e1d401d17b9bce5f1ce1efc105598420578f971b", "committedDate": "2020-05-31T13:22:53Z", "message": "[poc/video-streaming]\n    - Remove unused logs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36a69c7fe85000fbb008c585ed160bad90db10e7", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/36a69c7fe85000fbb008c585ed160bad90db10e7", "committedDate": "2020-06-08T09:21:35Z", "message": "[poc/video-streaming]\n    - Remove dependency on start/stopVideoService\n    - Move logic to VideoStreamManager"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6744a342991119f28aa31440fce625ec8d9bb25", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c6744a342991119f28aa31440fce625ec8d9bb25", "committedDate": "2020-06-08T09:33:31Z", "message": "[poc/video-streaming]\n    - Extend with callback to give third-party devs control on view resize process"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dbd4861246a1a12d20cbab0a2f1229190cdeb985", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/dbd4861246a1a12d20cbab0a2f1229190cdeb985", "committedDate": "2020-06-08T10:00:58Z", "message": "[poc/video-streaming]\n    - Implement new \"Paused\" state for state machine"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1a1748ab25e7ea065653dc2c45a46a3d6880200", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/b1a1748ab25e7ea065653dc2c45a46a3d6880200", "committedDate": "2020-06-11T12:55:14Z", "message": "[poc/video-streaming]\n    - Implement new \"Paused\" state for state machine\n    - Implement developer-provided info about resolution"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d3ed1cc09c21cde42c592351888611d767dd512", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/6d3ed1cc09c21cde42c592351888611d767dd512", "committedDate": "2020-06-12T13:34:12Z", "message": "[poc/video-streaming]\n    - Updated according to latest specification"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "483c0d86203739d61c15bd565fe3786bb757285d", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/483c0d86203739d61c15bd565fe3786bb757285d", "committedDate": "2020-06-30T08:35:21Z", "message": "[0296]\n    - Update according to new proposal revision"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "631938cf2a3cb4bcfd67677d753346c52733c6d6", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/631938cf2a3cb4bcfd67677d753346c52733c6d6", "committedDate": "2020-07-10T14:42:35Z", "message": "[VideoStreaming]\n    - Add new notification\n    - Fix compilation error\n    - Move mocks to make easier pending implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b856cef0c3f2eda3059d4a8dc2f08494d8eeb0b9", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/b856cef0c3f2eda3059d4a8dc2f08494d8eeb0b9", "committedDate": "2020-07-15T11:19:50Z", "message": "[VideoStreaming]\n    - Fix logic error with unused ranges provided by developer\n    - Provide builder for SupportedStreamingRange\n    - Add share prefs for saving ip on edit\n    - Add button to kill app and all it's components"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a8292176d0d83678b2f128d5c84ad3e45999d6c", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/9a8292176d0d83678b2f128d5c84ad3e45999d6c", "committedDate": "2020-07-21T12:58:15Z", "message": "Merge branch 'develop' into poc/fork/video_streaming_with_capabilities_update\n\n# Conflicts:\n#\tandroid/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/managers/SdlManager.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/streaming/video/SdlRemoteDisplay.java\n#\tbase/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43434a8f1be4cac4798b4a80254acc8a6dda132e", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/43434a8f1be4cac4798b4a80254acc8a6dda132e", "committedDate": "2020-07-21T20:27:16Z", "message": "[VideoStreaming]\n    - Fix bugs after develop merge\n    - Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ad5ef1a8cd5477f986a8d486a8abd62ffc154ac2", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/ad5ef1a8cd5477f986a8d486a8abd62ffc154ac2", "committedDate": "2020-07-27T14:05:18Z", "message": "[VideoStreaming]\n    - Fix Version\n    - Rename according to proposal"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7843cf303811ada8d0fbfaedc171e0204e3e0f44", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/7843cf303811ada8d0fbfaedc171e0204e3e0f44", "committedDate": "2020-07-28T07:42:03Z", "message": "[VideoStreaming]\n    - Fix wrong diagonal crash"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ca86259f26896a4f939df854befd2faf1613198d", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/ca86259f26896a4f939df854befd2faf1613198d", "committedDate": "2020-07-29T09:24:56Z", "message": "[VideoStreaming]\n    - Add validation for inconsistent capabilities\n    - Fix filtration algorithm"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "315cb858f438c214b822943b7c04a7ba6a4afffb", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/315cb858f438c214b822943b7c04a7ba6a4afffb", "committedDate": "2020-07-30T08:08:23Z", "message": "[VideoStreaming]\n    - Fix edge case when notification contains only scale parameter\n    - Align resolutions according to QA needs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "770b69f32a0109194ee903d576a961a33dcb6001", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/770b69f32a0109194ee903d576a961a33dcb6001", "committedDate": "2020-08-03T07:41:05Z", "message": "[VideoStreaming]\n    - Fix notifications flow\n    - Fix \"only scale in notification\" wrong processing\n    - Add caching of previous parameters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6c1159d2c5b7994addc24e0b60e916db647f0e6", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/a6c1159d2c5b7994addc24e0b60e916db647f0e6", "committedDate": "2020-08-05T22:09:26Z", "message": "[VideoStreaming]\n    - Refactor filtering to methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d9e233f1fe3ec41271056a9234a0265fed5c86f", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/8d9e233f1fe3ec41271056a9234a0265fed5c86f", "committedDate": "2020-08-05T22:23:00Z", "message": "[VideoStreaming]\n    - Use methods to simplify code and decrease complexity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e50ea7693886972939bf28aaefabd002d2b8892", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/7e50ea7693886972939bf28aaefabd002d2b8892", "committedDate": "2020-08-06T16:43:11Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/proxy/SdlProxyBase.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec", "committedDate": "2020-08-06T16:58:02Z", "message": "[VideoStreaming]\n     - Fix compilation errors on merge"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3ODIwNzYy", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-467820762", "createdAt": "2020-08-14T19:18:13Z", "commit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4NjM3NzA5", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-468637709", "createdAt": "2020-08-17T16:52:39Z", "commit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be4e36dfb5dc8db77fa9120bc0fad7b6be74f1aa", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/be4e36dfb5dc8db77fa9120bc0fad7b6be74f1aa", "committedDate": "2020-08-18T13:03:39Z", "message": "Merge branch 'develop' into Feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/hello_sdl_android/build.gradle\n#\tandroid/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/test/streaming/video/SdlRemoteDisplayTest.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/proxy/SdlProxyBase.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d57ad9b4990c051ac60e981884b46248fc96b970", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/d57ad9b4990c051ac60e981884b46248fc96b970", "committedDate": "2020-08-18T13:57:32Z", "message": "[0296]\n    - Fix compilation errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dece45c76f65ec2657f5a5feacf23f96bdb3262c", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/dece45c76f65ec2657f5a5feacf23f96bdb3262c", "committedDate": "2020-08-18T14:41:12Z", "message": "Merge remote-tracking branch 'origin/feature/0296_possibility_to_update_video_streaming_capabilities' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/proxy/SdlProxyBase.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16e430a7de2ac66bd9a5612f0b1059ac0fbac24f", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/16e430a7de2ac66bd9a5612f0b1059ac0fbac24f", "committedDate": "2020-08-18T14:45:09Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tbase/src/main/java/com/smartdevicelink/protocol/enums/FunctionID.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY4Njc0NjAz", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-468674603", "createdAt": "2020-08-17T17:24:22Z", "commit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QxNzoyNzoxNFrOHBy8iQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQwOTowNjowN1rOHCKdug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY0NTMyMQ==", "bodyText": "Per the proposal, getSupportedCapabilities should be defined as:\n\"...\nprivate List<VideoStreamingCapability> getSupportedCapabilities( Resolution minResolution, Resolution maxResolution, Double minAspectRatio, Double maxAspectRatio, Double minScreenDiagonal )\n...\"\nDo you need to change your method definition to match with the proposal?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471645321", "createdAt": "2020-08-17T17:27:14Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -603,6 +744,120 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n \t\treturn motionEventList;\n \t}\n \n+\tpublic VideoStreamingParameters getLastCachedStreamingParameters() {\n+\t\treturn parameters;\n+\t}\n+\n+\tpublic boolean getLastCachedIsEncrypted() {\n+\t\treturn isEncrypted;\n+\t}\n+\n+\tprivate List<VideoStreamingCapability> getSupportedCapabilities(\n+\t\t\tResolution minResolution,\n+\t\t\tResolution maxResolution,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 443}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgyMDM0OQ==", "bodyText": "On line 166, you can use the TAG variable instead of \"MyTagLog\"", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471820349", "createdAt": "2020-08-17T23:01:53Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -138,13 +150,20 @@ public void update(VideoStreamingParameters params){\n      */\n     public void update(VideoStreamingCapability capability, String vehicleMake){\n         if(capability.getMaxBitrate()!=null){ this.bitrate = capability.getMaxBitrate() * 1000; } // NOTE: the unit of maxBitrate in getSystemCapability is kbps.\n-        double scale = DEFAULT_SCALE;\n         if(capability.getScale() != null) { scale = capability.getScale(); }\n+        if (capability.getDiagonalScreenSize() != null) { preferredDiagonal = capability.getDiagonalScreenSize(); }\n         ImageResolution resolution = capability.getPreferredResolution();\n+        if (capability.getAdditionalVideoStreamingCapabilities() != null &&\n+                !capability.getAdditionalVideoStreamingCapabilities().isEmpty()) {\n+            this.additionalCapabilities = capability.getAdditionalVideoStreamingCapabilities();\n+        }\n         if(resolution!=null){\n \n             if (vehicleMake != null) {\n-                if ((vehicleMake.contains(\"Ford\") || vehicleMake.contains(\"Lincoln\")) && ((resolution.getResolutionHeight() != null && resolution.getResolutionHeight() > 800) || (resolution.getResolutionWidth() != null && resolution.getResolutionWidth() > 800))) {\n+                if ((vehicleMake.contains(\"Ford\") || vehicleMake.contains(\"Lincoln\")) &&\n+                        ((resolution.getResolutionHeight() != null && resolution.getResolutionHeight() > 800) ||\n+                                (resolution.getResolutionWidth() != null && resolution.getResolutionWidth() > 800))) {\n+                    Log.d(\"MyTagLog\", \"specific case\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgyMDU0Mg==", "bodyText": "You may not need this function public List<VideoStreamingCapability> getAdditionalCapabilities() { return additionalCapabilities; };.\nIt is not being used.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471820542", "createdAt": "2020-08-17T23:02:31Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -259,6 +279,13 @@ public ImageResolution getResolution() {\n \t\treturn resolution;\n \t}\n \n+    public double getScale() { return scale; }\n+\n+    public double getPreferredDiagonal() { return preferredDiagonal; }\n+\n+    public List<VideoStreamingCapability> getAdditionalCapabilities() { return additionalCapabilities; };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgyNjAwNg==", "bodyText": "AppCapabilityType.java needs a valueForString() method.\nYou could define like below:\n`\"    ;\n/**\n * Convert String to AppCapabilityType\n * @param value String\n * @return AppCapabilityType\n */\npublic static AppCapabilityType valueForString(String value) {\n    try{\n        return valueOf(value);\n    }catch(Exception e){\n        return null;\n    }\n}\"`", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471826006", "createdAt": "2020-08-17T23:19:13Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/enums/AppCapabilityType.java", "diffHunk": "@@ -0,0 +1,9 @@\n+package com.smartdevicelink.proxy.rpc.enums;\n+\n+/**\n+ * Since SmartDeviceLink 6.0\n+ * Enumerations of all available app capability types\n+ */\n+public enum AppCapabilityType {\n+    VIDEO_STREAMING,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgyNzE0MQ==", "bodyText": "Unit tests for this enum are needed.  They should be in a file called AppCapabilityTypeTests.java under the .../test/rpc/enums folder.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471827141", "createdAt": "2020-08-17T23:22:49Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/enums/AppCapabilityType.java", "diffHunk": "@@ -0,0 +1,9 @@\n+package com.smartdevicelink.proxy.rpc.enums;\n+\n+/**\n+ * Since SmartDeviceLink 6.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkzNDAxOQ==", "bodyText": "VideoStreamingCapability capability is not mandatory, so you do not need to initialize it in this constructor.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471934019", "createdAt": "2020-08-18T06:04:05Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.smartdevicelink.proxy.rpc;\n+\n+import android.support.annotation.NonNull;\n+\n+import com.smartdevicelink.proxy.RPCStruct;\n+import com.smartdevicelink.proxy.rpc.enums.AppCapabilityType;\n+\n+import java.util.Hashtable;\n+\n+public class AppCapability extends RPCStruct {\n+    public static final String KEY_APP_CAPABILITY_TYPE = \"appCapabilityType\";\n+    public static final String KEY_VIDEO_STREAMING_CAPABILITY = \"videoStreamingCapability\";\n+\n+    public AppCapability() {\n+    }\n+\n+    /**\n+     * Constructs a new AppCapability object indicated by the Hashtable\n+     * parameter\n+     *\n+     * @param hash hashtable filled with params to create an instance of this RPC\n+     *             The hash table to use\n+     */\n+    public AppCapability(Hashtable<String, Object> hash) {\n+        super(hash);\n+    }\n+\n+    public AppCapability(@NonNull VideoStreamingCapability capability, AppCapabilityType appCapabilityType) {\n+        this();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkzNDYxMw==", "bodyText": "On line 43, this should be \"...getObject(AppCapabilityType.class...)\"  instead of \"...getObject(VideoStreamingCapability.class...\"", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471934613", "createdAt": "2020-08-18T06:05:54Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.smartdevicelink.proxy.rpc;\n+\n+import android.support.annotation.NonNull;\n+\n+import com.smartdevicelink.proxy.RPCStruct;\n+import com.smartdevicelink.proxy.rpc.enums.AppCapabilityType;\n+\n+import java.util.Hashtable;\n+\n+public class AppCapability extends RPCStruct {\n+    public static final String KEY_APP_CAPABILITY_TYPE = \"appCapabilityType\";\n+    public static final String KEY_VIDEO_STREAMING_CAPABILITY = \"videoStreamingCapability\";\n+\n+    public AppCapability() {\n+    }\n+\n+    /**\n+     * Constructs a new AppCapability object indicated by the Hashtable\n+     * parameter\n+     *\n+     * @param hash hashtable filled with params to create an instance of this RPC\n+     *             The hash table to use\n+     */\n+    public AppCapability(Hashtable<String, Object> hash) {\n+        super(hash);\n+    }\n+\n+    public AppCapability(@NonNull VideoStreamingCapability capability, AppCapabilityType appCapabilityType) {\n+        this();\n+        setVideoStreamingCapability(capability);\n+        setAppCapabilityType(appCapabilityType);\n+    }\n+\n+    public VideoStreamingCapability getVideoStreamingCapability() {\n+        return (VideoStreamingCapability) getObject(VideoStreamingCapability.class, KEY_VIDEO_STREAMING_CAPABILITY);\n+    }\n+\n+    public void setVideoStreamingCapability(@NonNull VideoStreamingCapability capabilityType) {\n+        setValue(KEY_VIDEO_STREAMING_CAPABILITY, capabilityType);\n+    }\n+\n+    public AppCapabilityType getAppCapabilityType() {\n+        return (AppCapabilityType) getObject(VideoStreamingCapability.class, KEY_APP_CAPABILITY_TYPE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkzNTY2Mg==", "bodyText": "Unit tests are needed for this class, and should be defined in AppCapabilityTests.java", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471935662", "createdAt": "2020-08-18T06:09:15Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.smartdevicelink.proxy.rpc;\n+\n+import android.support.annotation.NonNull;\n+\n+import com.smartdevicelink.proxy.RPCStruct;\n+import com.smartdevicelink.proxy.rpc.enums.AppCapabilityType;\n+\n+import java.util.Hashtable;\n+\n+public class AppCapability extends RPCStruct {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkzODQ0MQ==", "bodyText": "This class is missing unit tests.  Unit tests should be defined in the file OnAppCapabilityUpdatedTests.java", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471938441", "createdAt": "2020-08-18T06:17:37Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/OnAppCapabilityUpdated.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package com.smartdevicelink.proxy.rpc;\n+\n+import com.smartdevicelink.protocol.enums.FunctionID;\n+import com.smartdevicelink.proxy.RPCNotification;\n+\n+import java.util.Hashtable;\n+\n+/**\n+ * since Smart Device Link 6.0\n+ * A notification to inform SDL Core that a specific app capability has changed.\n+ */\n+\n+public class OnAppCapabilityUpdated extends RPCNotification {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk0MDE3Ng==", "bodyText": "This looks good,but the unit tests in VideoStreamingCapabilityTests.java need to be updated to include the new parameter additionalVideoStreamingCapabilities.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471940176", "createdAt": "2020-08-18T06:22:05Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -49,6 +50,7 @@\n \tpublic static final String KEY_DIAGONAL_SCREEN_SIZE = \"diagonalScreenSize\";\n \tpublic static final String KEY_PIXEL_PER_INCH = \"pixelPerInch\";\n \tpublic static final String KEY_SCALE = \"scale\";\n+\tpublic static final String KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES = \"additionalVideoStreamingCapabilities\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk0NTQ2OQ==", "bodyText": "Does VideoStreamingParametersTest.java need to be updated to include tests for the new parameter List<VideoStreamingCapability> additionalCapabilities?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471945469", "createdAt": "2020-08-18T06:35:14Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -61,8 +64,11 @@\n \tprivate int frameRate;\n \tprivate int bitrate;\n \tprivate int interval;\n+\tprivate double preferredDiagonal;\n+\tprivate double scale = DEFAULT_SCALE;\n \tprivate ImageResolution resolution;\n \tprivate VideoStreamingFormat format;\n+\tprivate List<VideoStreamingCapability> additionalCapabilities = new ArrayList<>(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk0ODQyMA==", "bodyText": "I believe that the app_name value has been \"Hello Sdl Android\" since the beginning.  Does it need to be changed at this point, or can it still be \"Hello Sdl Android\" like before?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471948420", "createdAt": "2020-08-18T06:42:19Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/res/values/strings.xml", "diffHunk": "@@ -1,7 +1,7 @@\n <?xml version=\"1.0\" encoding=\"utf-8\"?>\n <resources>\n \n-    <string name=\"app_name\">Hello Sdl Android</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk1NzI0Mg==", "bodyText": "This looks good, but can you export all of the hard coded strings into the strings.xml file?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471957242", "createdAt": "2020-08-18T07:01:45Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/res/layout/activity_main.xml", "diffHunk": "@@ -1,16 +1,81 @@\n <RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n-    xmlns:tools=\"http://schemas.android.com/tools\"\n-    android:layout_width=\"match_parent\"\n-    android:layout_height=\"match_parent\"\n-    android:paddingBottom=\"@dimen/activity_vertical_margin\"\n-    android:paddingLeft=\"@dimen/activity_horizontal_margin\"\n-    android:paddingRight=\"@dimen/activity_horizontal_margin\"\n-    android:paddingTop=\"@dimen/activity_vertical_margin\"\n-    tools:context=\"com.sdl.hellosdlandroid.MainActivity\" >\n+    android:layout_width=\"wrap_content\"\n+    android:layout_height=\"match_parent\">\n \n     <TextView", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk1ODM4Mg==", "bodyText": "This looks good, but could you export all of the hard coded strings into the strings.xml file?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471958382", "createdAt": "2020-08-18T07:03:57Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/res/layout/ui_streaming_layout.xml", "diffHunk": "@@ -0,0 +1,48 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_marginLeft=\"30dp\"\n+    android:layout_marginTop=\"30dp\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk3Nzc2Mg==", "bodyText": "The variables on lines 25-27 are not being used, and can be removed.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471977762", "createdAt": "2020-08-18T07:39:15Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java", "diffHunk": "@@ -1,25 +1,142 @@\n package com.sdl.hellosdlandroid;\n \n import android.content.Intent;\n+import android.content.SharedPreferences;\n import android.os.Bundle;\n+import android.preference.PreferenceManager;\n import android.support.v7.app.AppCompatActivity;\n+import android.text.Editable;\n+import android.text.TextWatcher;\n import android.view.Menu;\n import android.view.MenuItem;\n+import android.view.View;\n+import android.widget.Button;\n+import android.widget.EditText;\n+import android.widget.Toast;\n+\n+import java.util.Timer;\n+import java.util.TimerTask;\n \n public class MainActivity extends AppCompatActivity {\n \tprivate static final String TAG = \"MainActivity\";\n-\t\n+\n+\tpublic static final String IP = \"ip\";\n+\tpublic static final String PORT = \"port\";\n+\tpublic static final String COMMAND = \"command\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk3OTEwNA==", "bodyText": "To be consistent in the naming of the UI variables, I would do the following:\n\nline 45: rename stopApp to exitApplication\nline 47: rename ip to machineIp\nline 48: rename port to machinePort", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471979104", "createdAt": "2020-08-18T07:41:32Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java", "diffHunk": "@@ -1,25 +1,142 @@\n package com.sdl.hellosdlandroid;\n \n import android.content.Intent;\n+import android.content.SharedPreferences;\n import android.os.Bundle;\n+import android.preference.PreferenceManager;\n import android.support.v7.app.AppCompatActivity;\n+import android.text.Editable;\n+import android.text.TextWatcher;\n import android.view.Menu;\n import android.view.MenuItem;\n+import android.view.View;\n+import android.widget.Button;\n+import android.widget.EditText;\n+import android.widget.Toast;\n+\n+import java.util.Timer;\n+import java.util.TimerTask;\n \n public class MainActivity extends AppCompatActivity {\n \tprivate static final String TAG = \"MainActivity\";\n-\t\n+\n+\tpublic static final String IP = \"ip\";\n+\tpublic static final String PORT = \"port\";\n+\tpublic static final String COMMAND = \"command\";\n+\tpublic static final String COMMAND_START_PROXY = \"c_start_proxy\";\n+\tpublic static final String COMMAND_START_STREAM = \"c_start_stream\";\n+\n+\tpublic static final String PREDEFINED_WIDTH = \"pre_def_w\";\n+\tpublic static final String PREDEFINED_HEIGHT = \"pre_def_h\";\n+\tpublic static final String IP_ADDRESS = \"ip_address\";\n+\tSharedPreferences preferences;\n+\n \t@Override\n \tprotected void onCreate(Bundle savedInstanceState) {\n \t\tsuper.onCreate(savedInstanceState);\n \t\tsetContentView(R.layout.activity_main);\n-\t\t//If we are connected to a module we want to start our SdlService\n-\t\tif(BuildConfig.TRANSPORT.equals(\"MULTI\") || BuildConfig.TRANSPORT.equals(\"MULTI_HB\")) {\n-\t\t\tSdlReceiver.queryForConnectedService(this);\n-\t\t}else if(BuildConfig.TRANSPORT.equals(\"TCP\")) {\n-\t\t\tIntent proxyIntent = new Intent(this, SdlService.class);\n-\t\t\tstartService(proxyIntent);\n-\t\t}\n+\n+\t\tpreferences = PreferenceManager.getDefaultSharedPreferences(this);\n+\n+\n+\t\tButton startStreaming = findViewById(R.id.start_streaming);\n+\t\tButton startStreamingUI = findViewById(R.id.start_streaming_ui);\n+\t\tButton startProxy = findViewById(R.id.start_proxy);\n+\t\tButton stopApp = findViewById(R.id.exit_application);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk3OTU1NQ==", "bodyText": "On line 92, you could change the Toast message to \"IP and Port are empty.\"", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471979555", "createdAt": "2020-08-18T07:42:18Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java", "diffHunk": "@@ -1,25 +1,142 @@\n package com.sdl.hellosdlandroid;\n \n import android.content.Intent;\n+import android.content.SharedPreferences;\n import android.os.Bundle;\n+import android.preference.PreferenceManager;\n import android.support.v7.app.AppCompatActivity;\n+import android.text.Editable;\n+import android.text.TextWatcher;\n import android.view.Menu;\n import android.view.MenuItem;\n+import android.view.View;\n+import android.widget.Button;\n+import android.widget.EditText;\n+import android.widget.Toast;\n+\n+import java.util.Timer;\n+import java.util.TimerTask;\n \n public class MainActivity extends AppCompatActivity {\n \tprivate static final String TAG = \"MainActivity\";\n-\t\n+\n+\tpublic static final String IP = \"ip\";\n+\tpublic static final String PORT = \"port\";\n+\tpublic static final String COMMAND = \"command\";\n+\tpublic static final String COMMAND_START_PROXY = \"c_start_proxy\";\n+\tpublic static final String COMMAND_START_STREAM = \"c_start_stream\";\n+\n+\tpublic static final String PREDEFINED_WIDTH = \"pre_def_w\";\n+\tpublic static final String PREDEFINED_HEIGHT = \"pre_def_h\";\n+\tpublic static final String IP_ADDRESS = \"ip_address\";\n+\tSharedPreferences preferences;\n+\n \t@Override\n \tprotected void onCreate(Bundle savedInstanceState) {\n \t\tsuper.onCreate(savedInstanceState);\n \t\tsetContentView(R.layout.activity_main);\n-\t\t//If we are connected to a module we want to start our SdlService\n-\t\tif(BuildConfig.TRANSPORT.equals(\"MULTI\") || BuildConfig.TRANSPORT.equals(\"MULTI_HB\")) {\n-\t\t\tSdlReceiver.queryForConnectedService(this);\n-\t\t}else if(BuildConfig.TRANSPORT.equals(\"TCP\")) {\n-\t\t\tIntent proxyIntent = new Intent(this, SdlService.class);\n-\t\t\tstartService(proxyIntent);\n-\t\t}\n+\n+\t\tpreferences = PreferenceManager.getDefaultSharedPreferences(this);\n+\n+\n+\t\tButton startStreaming = findViewById(R.id.start_streaming);\n+\t\tButton startStreamingUI = findViewById(R.id.start_streaming_ui);\n+\t\tButton startProxy = findViewById(R.id.start_proxy);\n+\t\tButton stopApp = findViewById(R.id.exit_application);\n+\n+\t\tfinal EditText ip = findViewById(R.id.machine_ip);\n+\t\tfinal EditText port = findViewById(R.id.machine_port);\n+\n+\t\tfinal EditText preConfWidth = findViewById(R.id.pre_conf_width);\n+\t\tfinal EditText preConfHeight = findViewById(R.id.pre_conf_height);\n+\n+\t\tip.setText(preferences.getString(IP_ADDRESS, \"192.168.0.101\"));\n+\n+\t\tip.addTextChangedListener(new TextWatcher() {\n+\t\t\t@Override\n+\t\t\tpublic void beforeTextChanged(CharSequence s, int start, int count, int after) { }\n+\n+\t\t\t@Override\n+\t\t\tpublic void onTextChanged(CharSequence s, int start, int before, int count) { }\n+\n+\t\t\t@Override\n+\t\t\tpublic void afterTextChanged(Editable s) {\n+\t\t\t\tif (s!=null) {\n+\t\t\t\t\tpreferences.edit().putString(IP_ADDRESS, s.toString()).commit();\n+\t\t\t\t}\n+\t\t\t}\n+\t\t});\n+\n+\t\tstartProxy.setOnClickListener(new View.OnClickListener() {\n+\t\t\t@Override\n+\t\t\tpublic void onClick(View view) {\n+\t\t\t\t//If we are connected to a module we want to start our SdlService\n+\t\t\t\tif(BuildConfig.TRANSPORT.equals(\"MULTI\") || BuildConfig.TRANSPORT.equals(\"MULTI_HB\")) {\n+\t\t\t\t\tSdlReceiver.queryForConnectedService(MainActivity.this);\n+\t\t\t\t}else if(BuildConfig.TRANSPORT.equals(\"TCP\")) {\n+\t\t\t\t\tIntent proxyIntent = new Intent(MainActivity.this, SdlService.class);\n+\n+\t\t\t\t\tString ipString = ip.getText().toString();\n+\t\t\t\t\tString portString = port.getText().toString();\n+\t\t\t\t\tif (!ipString.isEmpty() && !portString.isEmpty()) {\n+\t\t\t\t\t\tproxyIntent.putExtra(IP, ip.getText().toString());\n+\t\t\t\t\t\ttry {\n+\t\t\t\t\t\t\tproxyIntent.putExtra(PORT, Integer.parseInt(port.getText().toString()));\n+\t\t\t\t\t\t} catch (NumberFormatException e){\n+\t\t\t\t\t\t\tToast.makeText(MainActivity.this, \"Port should be number\", Toast.LENGTH_SHORT).show();\n+\t\t\t\t\t\t\treturn;\n+\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\tstartService(proxyIntent);\n+\t\t\t\t\t} else {\n+\t\t\t\t\t\tToast.makeText(MainActivity.this, \"Fill ip and port\", Toast.LENGTH_SHORT).show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 100}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk3OTk3Nw==", "bodyText": "The toast messages on lines 106 and 120 are the same (\"Configure display width and height\").  Are they supposed to be the same?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471979977", "createdAt": "2020-08-18T07:43:03Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java", "diffHunk": "@@ -1,25 +1,142 @@\n package com.sdl.hellosdlandroid;\n \n import android.content.Intent;\n+import android.content.SharedPreferences;\n import android.os.Bundle;\n+import android.preference.PreferenceManager;\n import android.support.v7.app.AppCompatActivity;\n+import android.text.Editable;\n+import android.text.TextWatcher;\n import android.view.Menu;\n import android.view.MenuItem;\n+import android.view.View;\n+import android.widget.Button;\n+import android.widget.EditText;\n+import android.widget.Toast;\n+\n+import java.util.Timer;\n+import java.util.TimerTask;\n \n public class MainActivity extends AppCompatActivity {\n \tprivate static final String TAG = \"MainActivity\";\n-\t\n+\n+\tpublic static final String IP = \"ip\";\n+\tpublic static final String PORT = \"port\";\n+\tpublic static final String COMMAND = \"command\";\n+\tpublic static final String COMMAND_START_PROXY = \"c_start_proxy\";\n+\tpublic static final String COMMAND_START_STREAM = \"c_start_stream\";\n+\n+\tpublic static final String PREDEFINED_WIDTH = \"pre_def_w\";\n+\tpublic static final String PREDEFINED_HEIGHT = \"pre_def_h\";\n+\tpublic static final String IP_ADDRESS = \"ip_address\";\n+\tSharedPreferences preferences;\n+\n \t@Override\n \tprotected void onCreate(Bundle savedInstanceState) {\n \t\tsuper.onCreate(savedInstanceState);\n \t\tsetContentView(R.layout.activity_main);\n-\t\t//If we are connected to a module we want to start our SdlService\n-\t\tif(BuildConfig.TRANSPORT.equals(\"MULTI\") || BuildConfig.TRANSPORT.equals(\"MULTI_HB\")) {\n-\t\t\tSdlReceiver.queryForConnectedService(this);\n-\t\t}else if(BuildConfig.TRANSPORT.equals(\"TCP\")) {\n-\t\t\tIntent proxyIntent = new Intent(this, SdlService.class);\n-\t\t\tstartService(proxyIntent);\n-\t\t}\n+\n+\t\tpreferences = PreferenceManager.getDefaultSharedPreferences(this);\n+\n+\n+\t\tButton startStreaming = findViewById(R.id.start_streaming);\n+\t\tButton startStreamingUI = findViewById(R.id.start_streaming_ui);\n+\t\tButton startProxy = findViewById(R.id.start_proxy);\n+\t\tButton stopApp = findViewById(R.id.exit_application);\n+\n+\t\tfinal EditText ip = findViewById(R.id.machine_ip);\n+\t\tfinal EditText port = findViewById(R.id.machine_port);\n+\n+\t\tfinal EditText preConfWidth = findViewById(R.id.pre_conf_width);\n+\t\tfinal EditText preConfHeight = findViewById(R.id.pre_conf_height);\n+\n+\t\tip.setText(preferences.getString(IP_ADDRESS, \"192.168.0.101\"));\n+\n+\t\tip.addTextChangedListener(new TextWatcher() {\n+\t\t\t@Override\n+\t\t\tpublic void beforeTextChanged(CharSequence s, int start, int count, int after) { }\n+\n+\t\t\t@Override\n+\t\t\tpublic void onTextChanged(CharSequence s, int start, int before, int count) { }\n+\n+\t\t\t@Override\n+\t\t\tpublic void afterTextChanged(Editable s) {\n+\t\t\t\tif (s!=null) {\n+\t\t\t\t\tpreferences.edit().putString(IP_ADDRESS, s.toString()).commit();\n+\t\t\t\t}\n+\t\t\t}\n+\t\t});\n+\n+\t\tstartProxy.setOnClickListener(new View.OnClickListener() {\n+\t\t\t@Override\n+\t\t\tpublic void onClick(View view) {\n+\t\t\t\t//If we are connected to a module we want to start our SdlService\n+\t\t\t\tif(BuildConfig.TRANSPORT.equals(\"MULTI\") || BuildConfig.TRANSPORT.equals(\"MULTI_HB\")) {\n+\t\t\t\t\tSdlReceiver.queryForConnectedService(MainActivity.this);\n+\t\t\t\t}else if(BuildConfig.TRANSPORT.equals(\"TCP\")) {\n+\t\t\t\t\tIntent proxyIntent = new Intent(MainActivity.this, SdlService.class);\n+\n+\t\t\t\t\tString ipString = ip.getText().toString();\n+\t\t\t\t\tString portString = port.getText().toString();\n+\t\t\t\t\tif (!ipString.isEmpty() && !portString.isEmpty()) {\n+\t\t\t\t\t\tproxyIntent.putExtra(IP, ip.getText().toString());\n+\t\t\t\t\t\ttry {\n+\t\t\t\t\t\t\tproxyIntent.putExtra(PORT, Integer.parseInt(port.getText().toString()));\n+\t\t\t\t\t\t} catch (NumberFormatException e){\n+\t\t\t\t\t\t\tToast.makeText(MainActivity.this, \"Port should be number\", Toast.LENGTH_SHORT).show();\n+\t\t\t\t\t\t\treturn;\n+\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\tstartService(proxyIntent);\n+\t\t\t\t\t} else {\n+\t\t\t\t\t\tToast.makeText(MainActivity.this, \"Fill ip and port\", Toast.LENGTH_SHORT).show();\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t}\n+\t\t});\n+\n+\t\tstartStreaming.setOnClickListener(new View.OnClickListener() {\n+\t\t\t@Override\n+\t\t\tpublic void onClick(View view) {\n+\t\t\t\tif (!preConfWidth.getText().toString().isEmpty() && !preConfHeight.getText().toString().isEmpty()) {\n+\t\t\t\t\tpreferences.edit().putInt(PREDEFINED_WIDTH, Integer.parseInt(preConfWidth.getText().toString())).commit();\n+\t\t\t\t\tpreferences.edit().putInt(PREDEFINED_HEIGHT, Integer.parseInt(preConfHeight.getText().toString())).commit();\n+\t\t\t\t\tSdlService.relay.accept(STREAM_ENUM.START_STREAMING);\n+\t\t\t\t} else {\n+\t\t\t\t\tToast.makeText(MainActivity.this, \"Configure display width and height\", Toast.LENGTH_SHORT).show();\n+\t\t\t\t}\n+\t\t\t}\n+\t\t});\n+\n+\t\tstartStreamingUI.setOnClickListener(new View.OnClickListener() {\n+\t\t\t@Override\n+\t\t\tpublic void onClick(View view) {\n+\n+\t\t\t\tif (!preConfWidth.getText().toString().isEmpty() && !preConfHeight.getText().toString().isEmpty()) {\n+\t\t\t\t\tpreferences.edit().putInt(PREDEFINED_WIDTH, Integer.parseInt(preConfWidth.getText().toString())).commit();\n+\t\t\t\t\tpreferences.edit().putInt(PREDEFINED_HEIGHT, Integer.parseInt(preConfHeight.getText().toString())).commit();\n+\t\t\t\t\tSdlService.relay.accept(STREAM_ENUM.START_STREAMING_UI);\n+\t\t\t\t} else {\n+\t\t\t\t\tToast.makeText(MainActivity.this, \"Configure display width and height\", Toast.LENGTH_SHORT).show();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 128}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk4OTU2Mg==", "bodyText": "This looks good.  You can remove the unused imports on lines 42-43.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471989562", "createdAt": "2020-08-18T07:59:14Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/streaming/video/SdlRemoteDisplay.java", "diffHunk": "@@ -39,9 +39,12 @@\n import android.os.Bundle;\n import android.os.Handler;\n import android.os.Looper;\n+import android.support.annotation.NonNull;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk5MjM1Mg==", "bodyText": "Can you add code to unit test the newly added resizeView(...) function in SdlRemoteDisplay.java?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471992352", "createdAt": "2020-08-18T08:04:07Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/streaming/video/SdlRemoteDisplayTest.java", "diffHunk": "@@ -37,7 +37,7 @@ public void testCreator(){\n         assertNotNull(encoder);\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk5OTc3NA==", "bodyText": "You can remove the unused imports on lines 35 and 46.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471999774", "createdAt": "2020-08-18T08:16:52Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -32,14 +32,18 @@\n \n package com.smartdevicelink.encoder;\n \n+import android.annotation.SuppressLint;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk5OTk3Mw==", "bodyText": "You can rename this to preferences", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r471999973", "createdAt": "2020-08-18T08:17:15Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -98,6 +105,11 @@ public void init(Context context, IVideoStreamListener outputListener, VideoStre\n \n         mOutputListener = outputListener;\n \n+        SharedPreferences p = PreferenceManager.getDefaultSharedPreferences(context);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjAwNTIyOQ==", "bodyText": "What does the paused state represent?  I don't see it mentioned in the proposal.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472005229", "createdAt": "2020-08-18T08:25:50Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/StreamingStateMachine.java", "diffHunk": "@@ -37,10 +37,10 @@\n import java.lang.annotation.RetentionPolicy;\n \n public class StreamingStateMachine {\n-\t@IntDef({NONE, READY, STARTED, STOPPED, ERROR})\n+\t@IntDef({NONE, READY, STARTED, STOPPED, ERROR, PAUSED})", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjAyOTcyMg==", "bodyText": "In the setup function around line 105, does a call need to be made to videoStreamingCapability.setAdditionalVideoStreamingCapabilities(...)?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472029722", "createdAt": "2020-08-18T09:04:40Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/lifecycle/SystemCapabilityManagerTests.java", "diffHunk": "@@ -365,9 +365,9 @@ public void testGetCapabilityHmiNone() {\n \t\tscm.setCapability(SystemCapabilityType.VIDEO_STREAMING, null);\n \t\tVideoStreamingCapability retrievedCapability = (VideoStreamingCapability) scm.getCapability(SystemCapabilityType.VIDEO_STREAMING, onSystemCapabilityListener, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjAzMDY1MA==", "bodyText": "In the testGetVSCapability function around line 221, does a call need to be made to vsCapability.setAdditionalVideoStreamingCapabilities(...)?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472030650", "createdAt": "2020-08-18T09:06:07Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/lifecycle/SystemCapabilityManagerTests.java", "diffHunk": "@@ -365,9 +365,9 @@ public void testGetCapabilityHmiNone() {\n \t\tscm.setCapability(SystemCapabilityType.VIDEO_STREAMING, null);\n \t\tVideoStreamingCapability retrievedCapability = (VideoStreamingCapability) scm.getCapability(SystemCapabilityType.VIDEO_STREAMING, onSystemCapabilityListener, false);\n \t\tassertNull(retrievedCapability);\n-\t\tverify(internalInterface, times(0)).sendRPC(any(GetSystemCapability.class));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23b4799bd98bee6509f6d8b8a021f4f21be1e8c6", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/23b4799bd98bee6509f6d8b8a021f4f21be1e8c6", "committedDate": "2020-08-18T17:29:58Z", "message": "Merge branch 'feature/0296_possibility_to_update_video_streaming_capabilities' of https://github.com/LuxoftSDL/sdl_java_suite into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/proxy/SdlProxyBase.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b99237b669f09357eac214870d5f351911060ce", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/9b99237b669f09357eac214870d5f351911060ce", "committedDate": "2020-08-18T20:40:26Z", "message": "Merge branch 'develop' into Feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tbase/src/main/java/com/smartdevicelink/protocol/enums/FunctionID.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5ODQ0OTI2", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-469844926", "createdAt": "2020-08-18T21:30:50Z", "commit": {"oid": "16e430a7de2ac66bd9a5612f0b1059ac0fbac24f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMTozMDo1MFrOHCnZpA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMTozMToxMVrOHCnaNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjUwNDc0MA==", "bodyText": "For these three:\nON_SUBTLE_ALERT_PRESSED(32788, \"OnSubtleAlertPressed\"), ON_UPDATE_FILE(32789, \"OnUpdateFile\"), ON_UPDATE_SUB_MENU(32790, \"OnUpdateSubMenu\"),\nI don't see these RPC notifications defined in the proposal.  Can you explain what they are?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472504740", "createdAt": "2020-08-18T21:30:50Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/protocol/enums/FunctionID.java", "diffHunk": "@@ -132,6 +132,9 @@\n     ON_RC_STATUS(32785, \"OnRCStatus\"),\r\n     ON_APP_SERVICE_DATA(32786, \"OnAppServiceData\"),\r\n     ON_SYSTEM_CAPABILITY_UPDATED(32787, \"OnSystemCapabilityUpdated\"),\r\n+    ON_SUBTLE_ALERT_PRESSED(32788, \"OnSubtleAlertPressed\"),\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16e430a7de2ac66bd9a5612f0b1059ac0fbac24f"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjUwNDg4Nw==", "bodyText": "Unit tests are needed for OnSubtleAlertPressed.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472504887", "createdAt": "2020-08-18T21:31:11Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/protocol/enums/FunctionID.java", "diffHunk": "@@ -132,6 +132,9 @@\n     ON_RC_STATUS(32785, \"OnRCStatus\"),\r\n     ON_APP_SERVICE_DATA(32786, \"OnAppServiceData\"),\r\n     ON_SYSTEM_CAPABILITY_UPDATED(32787, \"OnSystemCapabilityUpdated\"),\r\n+    ON_SUBTLE_ALERT_PRESSED(32788, \"OnSubtleAlertPressed\"),\r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16e430a7de2ac66bd9a5612f0b1059ac0fbac24f"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9", "author": {"user": {"login": "kboskin", "name": "Kostiantyn Boskin"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e64d5879fa5d471514ebea3c6d07fb6082562cd9", "committedDate": "2020-08-18T23:18:02Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5ODk3MTcw", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-469897170", "createdAt": "2020-08-18T23:29:53Z", "commit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMzoyOTo1NFrOHCqGwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMzoyOTo1NFrOHCqGwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU0OTA1Nw==", "bodyText": "I believe this should be 7.0 instead of 6.0.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472549057", "createdAt": "2020-08-18T23:29:54Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/OnAppCapabilityUpdated.java", "diffHunk": "@@ -0,0 +1,52 @@\n+package com.smartdevicelink.proxy.rpc;\n+\n+import com.smartdevicelink.protocol.enums.FunctionID;\n+import com.smartdevicelink.proxy.RPCNotification;\n+\n+import java.util.Hashtable;\n+\n+/**\n+ * since Smart Device Link 6.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 9}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5ODk5NDgw", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-469899480", "createdAt": "2020-08-18T23:36:18Z", "commit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMzozNjoxOFrOHCqPFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMzozNjoxOFrOHCqPFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU1MTE5MQ==", "bodyText": "Based on the mobile_API.xml, this file should have the /** @since 7.0 */ annotation.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472551191", "createdAt": "2020-08-18T23:36:18Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,50 @@\n+package com.smartdevicelink.proxy.rpc;\n+\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5OTAwMTg4", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-469900188", "createdAt": "2020-08-18T23:38:33Z", "commit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMzozODozM1rOHCqRgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQyMzozODozM1rOHCqRgw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU1MTgxMQ==", "bodyText": "This should be 7.0 instead of 6.0 on line 4.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472551811", "createdAt": "2020-08-18T23:38:33Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/enums/AppCapabilityType.java", "diffHunk": "@@ -0,0 +1,9 @@\n+package com.smartdevicelink.proxy.rpc.enums;\n+\n+/**\n+ * Since SmartDeviceLink 6.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwMTM0NDE3", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-470134417", "createdAt": "2020-08-19T05:28:04Z", "commit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwNToyODowNFrOHC0MDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwNToyODowNFrOHC0MDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcxNDI1Mg==", "bodyText": "Can the STREAM_ENUM enum be defined in a separate class?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472714252", "createdAt": "2020-08-19T05:28:04Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java", "diffHunk": "@@ -40,4 +157,8 @@ public boolean onOptionsItemSelected(MenuItem item) {\n \t\t}\n \t\treturn super.onOptionsItemSelected(item);\n \t}\n+\n+\tpublic static enum STREAM_ENUM{", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 158}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwMTM3MjA2", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-470137206", "createdAt": "2020-08-19T05:36:15Z", "commit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwNTozNjoxNVrOHC0gyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQwNzoyMDo1NlrOHC5Pww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcxOTU2MA==", "bodyText": "This whole section is commented out including boilerplate calls to setVoiceCommands();``sendMenus(); performWelcomeSpeak();``performWelcomeShow();``preloadChoices();``subscribeToButtons(); .  Do these calls need to be made from anywhere else?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472719560", "createdAt": "2020-08-19T05:36:15Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -166,31 +221,43 @@ private void startProxy() {\n \n \t\t\t// The app type to be used\n \t\t\tVector<AppHMIType> appType = new Vector<>();\n-\t\t\tappType.add(AppHMIType.DEFAULT);\n+\t\t\tappType.add(AppHMIType.NAVIGATION);\n \n \t\t\t// The manager listener helps you know when certain events that pertain to the SDL Manager happen\n \t\t\t// Here we will listen for ON_HMI_STATUS and ON_COMMAND notifications\n \t\t\tSdlManagerListener listener = new SdlManagerListener() {\n \t\t\t\t@Override\n \t\t\t\tpublic void onStart() {\n-\t\t\t\t\t// HMI Status Listener\n-\t\t\t\t\tsdlManager.addOnRPCNotificationListener(FunctionID.ON_HMI_STATUS, new OnRPCNotificationListener() {\n-\t\t\t\t\t\t@Override\n-\t\t\t\t\t\tpublic void onNotified(RPCNotification notification) {\n-\t\t\t\t\t\t\tOnHMIStatus onHMIStatus = (OnHMIStatus)notification;\n-\t\t\t\t\t\t\tif (onHMIStatus.getWindowID() != null && onHMIStatus.getWindowID() != PredefinedWindows.DEFAULT_WINDOW.getValue()) {\n-\t\t\t\t\t\t\t\treturn;\n-\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\tif (onHMIStatus.getHmiLevel() == HMILevel.HMI_FULL && onHMIStatus.getFirstRun()) {\n-\t\t\t\t\t\t\t\tsetVoiceCommands();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 167}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyMTMyOQ==", "bodyText": "Can the UIStreamingDisplay class be put into a separate file?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472721329", "createdAt": "2020-08-19T05:39:18Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -450,4 +531,97 @@ public void onError(String error) {\n \t\t\tsdlManager.getScreenManager().presentChoiceSet(choiceSet, InteractionMode.MANUAL_ONLY);\n \t\t}\n \t}\n+\n+\tpublic static class UIStreamingDisplay extends SdlRemoteDisplay {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 249}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyMjI3OQ==", "bodyText": "Instead of button1, button2, clickCounter1, clickCounter2 , counter1, and counter2 can more descriptive names be given to the variables in the source code and in the layout xml?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472722279", "createdAt": "2020-08-19T05:40:44Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -450,4 +531,97 @@ public void onError(String error) {\n \t\t\tsdlManager.getScreenManager().presentChoiceSet(choiceSet, InteractionMode.MANUAL_ONLY);\n \t\t}\n \t}\n+\n+\tpublic static class UIStreamingDisplay extends SdlRemoteDisplay {\n+\t\tint clickCounter1 = 0;\n+\t\tint clickCounter2 = 0;\n+\t\tpublic UIStreamingDisplay(Context context, Display display) {\n+\t\t\tsuper(context, display);\n+\t\t}\n+\n+\t\t@Override\n+\t\tprotected void onCreate(Bundle savedInstanceState) {\n+\t\t\tsuper.onCreate(savedInstanceState);\n+\t\t\tsetContentView(R.layout.ui_streaming_layout);\n+\n+\n+\t\t\tfinal Button button1 = findViewById(R.id.button1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 262}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyMzg2OQ==", "bodyText": "Can the MyDisplay class be put into its own separate file?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472723869", "createdAt": "2020-08-19T05:43:05Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -450,4 +531,97 @@ public void onError(String error) {\n \t\t\tsdlManager.getScreenManager().presentChoiceSet(choiceSet, InteractionMode.MANUAL_ONLY);\n \t\t}\n \t}\n+\n+\tpublic static class UIStreamingDisplay extends SdlRemoteDisplay {\n+\t\tint clickCounter1 = 0;\n+\t\tint clickCounter2 = 0;\n+\t\tpublic UIStreamingDisplay(Context context, Display display) {\n+\t\t\tsuper(context, display);\n+\t\t}\n+\n+\t\t@Override\n+\t\tprotected void onCreate(Bundle savedInstanceState) {\n+\t\t\tsuper.onCreate(savedInstanceState);\n+\t\t\tsetContentView(R.layout.ui_streaming_layout);\n+\n+\n+\t\t\tfinal Button button1 = findViewById(R.id.button1);\n+\t\t\tfinal Button button2 = findViewById(R.id.button2);\n+\t\t\tfinal TextView counter1 = findViewById(R.id.button_one_counter);\n+\t\t\tfinal TextView counter2 = findViewById(R.id.button_two_counter);\n+            button1.setOnTouchListener(new View.OnTouchListener() {\n+\t\t\t\t@Override\n+\t\t\t\tpublic boolean onTouch(View view, MotionEvent motionEvent) {\n+\n+                    counter1.setText(\"Click!!! \" + ++clickCounter1);\n+\t\t\t\t\tLog.d(\"MyTagClickCounter\", String.valueOf(clickCounter1));\n+\t\t\t\t\tint location [] = new int[2];\n+                    button1.getLocationInWindow(location);\n+                    //counter1.append(\"\\nButton size: \" + button1.getWidth() + \"x\" + button1.getHeight());\n+\t\t\t\t\t//textView.append(\"\\nButton location: \" + location[0] + \",\" + location[1]);\n+\t\t\t\t\treturn false;\n+\t\t\t\t}\n+\t\t\t});\n+\n+            button2.setOnTouchListener(new View.OnTouchListener() {\n+                @Override\n+                public boolean onTouch(View view, MotionEvent motionEvent) {\n+\n+                    counter2.setText(\"Click!!! \" + ++clickCounter2);\n+                    Log.d(\"MyTagClickCounter\", String.valueOf(clickCounter2));\n+                    int location [] = new int[2];\n+                    button2.getLocationInWindow(location);\n+                    //counter2.append(\"\\nButton size: \" + button.getWidth() + \"x\" + button.getHeight());\n+                    //textView.append(\"\\nButton location: \" + location[0] + \",\" + location[1]);\n+                    return false;\n+                }\n+            });\n+\t\t}\n+\n+\t\t@Override\n+\t\tpublic void onViewResized(int width, int height) {\n+\t\t\tToast.makeText(getContext(),\n+\t\t\t\t\tString.format(\"Remote view new width and height (%s, %s)\", width, height),\n+\t\t\t\t\tToast.LENGTH_SHORT\n+\t\t\t).show();\n+\t\t}\n+\t}\n+\n+\tpublic static class MyDisplay extends SdlRemoteDisplay {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 304}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyODA1OA==", "bodyText": "You could use DebugTool.logError(...) here instead of Log.d(...)", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472728058", "createdAt": "2020-08-19T05:49:20Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -165,17 +184,48 @@ public void onNotified(RPCNotification notification) {\n \tprivate final OnRPCNotificationListener touchListener = new OnRPCNotificationListener() {\n \t\t@Override\n \t\tpublic void onNotified(RPCNotification notification) {\n-\t\t\tif(notification != null && remoteDisplay != null){\n+\t\t\tif(notification != null && sdlRemoteDisplay != null){\n \t\t\t\tList<MotionEvent> motionEventList = convertTouchEvent((OnTouchEvent)notification);\n \t\t\t\tif (motionEventList != null && !motionEventList.isEmpty()) {\n \t\t\t\t\tfor (MotionEvent motionEvent : motionEventList) {\n-\t\t\t\t\t\tremoteDisplay.handleMotionEvent(motionEvent);\n+\t\t\t\t\t\tsdlRemoteDisplay.handleMotionEvent(motionEvent);\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t};\n \n+\tprivate final OnSystemCapabilityListener systemCapabilityListener = new OnSystemCapabilityListener() {\n+\t\t@Override\n+\t\tpublic void onCapabilityRetrieved(Object capability) {\n+\t\t\tVideoStreamingParameters params = new VideoStreamingParameters();\n+\n+\t\t\tVideoStreamingCapability castedCapability = ((VideoStreamingCapability)capability);\n+\n+\t\t\t// means only scale received\n+\t\t\tif (castedCapability.getPreferredResolution() == null &&\n+\t\t\t\t\tcastedCapability.getScale() != null &&\n+\t\t\t\t\tcastedCapability.getScale() != 0 &&\n+\t\t\t\t\tVideoStreamManager.this.parameters != null\n+\t\t\t\t\t&& VideoStreamManager.this.parameters.getResolution() != null) {\n+\t\t\t\t// set cached resolution\n+\t\t\t\tcastedCapability.setPreferredResolution(originalCapability.getPreferredResolution());\n+\t\t\t}\n+\t\t\tparams.update(castedCapability, vehicleMake);\t//Streaming parameters are ready time to stream\n+\t\t\tVideoStreamManager.this.parameters = params;\n+\n+\t\t\tVideoStreamManager.this.withPendingRestart = true;\n+\n+\t\t\tvirtualDisplayEncoder.setStreamingParams(params);\n+\t\t\tstopStreaming(true);\n+\t\t}\n+\n+\t\t@Override\n+\t\tpublic void onError(String info) {\n+\t\t\tLog.d(\"MyTagLogInfo\", info);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 146}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjczMzMxMw==", "bodyText": "Can you delete the overloaded configureGlobalParameters method (the one with 3 parameters), and just use this one and set this.streamingRange = streamingRange; if streamingRange is not null?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472733313", "createdAt": "2020-08-19T05:56:54Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -262,23 +337,69 @@ public void onError(String info) {\n \t *\n \t * @param encrypted a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n \t */\n+\t@Deprecated\n \tpublic void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n-\t\tthis.context = new WeakReference<>(context);\n-\t\tthis.remoteDisplayClass = remoteDisplayClass;\n-\t\tint majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+\t\tconfigureGlobalParameters(context, remoteDisplayClass, isEncrypted);\n \t\tif(majorProtocolVersion >= 5 && !internalInterface.isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING)){\n \t\t\tDebugTool.logError(TAG, \"Video streaming not supported on this module\");\n \t\t\tstateMachine.transitionToState(StreamingStateMachine.ERROR);\n \t\t\treturn;\n \t\t}\n+\t\tif (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+\t\t\tgetVideoStreamingParams();\n+\t\t}\n+\t\tcheckState();\n+\t\tprocessCapabilitiesWithPendingStart(encrypted, parameters);\n+\t}\n+\n+\tprivate void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted) {\n+\t\tthis.context = new WeakReference<>(context);\n+\t\tthis.remoteDisplayClass = remoteDisplayClass;\n+\t\tthis.isEncrypted = encrypted;\n+\t\tthis.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+\t}\n+\n+\tprivate void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, VideoStreamingRange streamingRange) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 238}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0MDk0Mw==", "bodyText": "Can you delete lines 455 and 456 and instead just do createRemoteDisplay(virtualDisplayEncoder.getDisplay());?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472740943", "createdAt": "2020-08-19T06:08:07Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -323,11 +444,17 @@ protected void startStreaming(VideoStreamingParameters parameters, boolean encry\n \t */\n \tprivate void startEncoder(){\n \t\ttry {\n+\t\t\tif (sdlRemoteDisplay != null) {\n+\t\t\t\tsdlRemoteDisplay.resizeView(parameters.getResolution().getResolutionWidth(), parameters.getResolution().getResolutionHeight());\n+\t\t\t}\n+\n \t\t\tvirtualDisplayEncoder.init(this.context.get(), streamListener, parameters);\n \t\t\t//We are all set so we can start streaming at at this point\n \t\t\tvirtualDisplayEncoder.start();\n \t\t\t//Encoder should be up and running\n-\t\t\tcreateRemoteDisplay(virtualDisplayEncoder.getVirtualDisplay());\n+\t\t\tDisplay display = virtualDisplayEncoder.getDisplay();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 297}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0MzM3Mg==", "bodyText": "Can you replace lines 541-543 with return (stateMachine.getState() == StreamingStateMachine.STARTED) && (isHMIStateVideoStreamCapable(currentOnHMIStatus));?  This was the previous code, and is equivalent to the new code.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472743372", "createdAt": "2020-08-19T06:11:28Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -397,15 +529,18 @@ public void dispose(){\n \tpublic boolean isServiceActive(){\n \t\treturn (stateMachine.getState() == StreamingStateMachine.READY) ||\n \t\t\t\t(stateMachine.getState() == StreamingStateMachine.STARTED) ||\n-\t\t\t\t(stateMachine.getState() == StreamingStateMachine.STOPPED);\n+\t\t\t\t(stateMachine.getState() == StreamingStateMachine.STOPPED) ||\n+\t\t\t\t(stateMachine.getState() == StreamingStateMachine.PAUSED);\n \t}\n \n \t/**\n \t * Check if video is currently streaming and visible\n \t * @return boolean (true = yes, false = no)\n \t */\n \tpublic boolean isStreaming(){\n-\t\treturn (stateMachine.getState() == StreamingStateMachine.STARTED) && (isHMIStateVideoStreamCapable(currentOnHMIStatus));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 373}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc1MDU1MQ==", "bodyText": "In VideoStreamManager.java there is this line pointer.setCoords(touchCoord.getX() / touchScalar[0], touchCoord.getY() / touchScalar[1]); where the MotionEvent pointer is set using division.  How come in the unit test it has been changed to multiplication?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472750551", "createdAt": "2020-08-19T06:21:35Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamManagerTests.java", "diffHunk": "@@ -538,8 +543,8 @@ private void assertMotionEventWithScale(int width, int height, float scale) {\n \n         motionEvent = motionEventList.get(0);\n         assertEquals(1, motionEvent.getPointerCount());\n-        assertEquals(Math.round(e1x / scale), Math.round(motionEvent.getX(0)));\n-        assertEquals(Math.round(e1y / scale), Math.round(motionEvent.getY(0)));\n+        assertEquals(Math.round(e1x * scale), Math.round(motionEvent.getX(0)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc1MTIxNw==", "bodyText": "Do more unit tests need to be added to test all of the new code that was added in VideoStreamManager.java?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472751217", "createdAt": "2020-08-19T06:22:24Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamManagerTests.java", "diffHunk": "@@ -92,6 +92,11 @@ protected void onCreate(Bundle savedInstanceState) {\n \t\t\tsetContentView(simulatedView);\n \t\t}\n \n+\t\t@Override\n+\t\tpublic void onViewResized(int width, int height) {\n+\n+\t\t}\n+\n \t\t@Override", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc3OTc3Ng==", "bodyText": "This method updateCachedVideoStreamingCapabilities(...)  on line 234 is never used.  Can it be deleted?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472779776", "createdAt": "2020-08-19T06:59:24Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -228,6 +231,9 @@ private void updateCachedDisplayCapabilityList(List<DisplayCapability> newCapabi\n \t\tupdateDeprecatedDisplayCapabilities();\n \t}\n \n+\tprivate void updateCachedVideoStreamingCapabilities(VideoStreamingCapability capability) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc4NDM4Ng==", "bodyText": "The alignment of private void setupRpcListeners() was altered .  It (and all of its code) needs to be on the same level as the function above it (parseRAIResponse(...)).", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472784386", "createdAt": "2020-08-19T07:05:23Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -266,81 +272,90 @@ void parseRAIResponse(RegisterAppInterfaceResponse response) {\n \t\t}\n \t}\n \n-\tprivate void setupRpcListeners() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc5Mjc0Nw==", "bodyText": "On line 311, the alignment of case ON_SYSTEM_CAPABILITY_UPDATED was altered . It (and all of its code) needs to be on the same level as the case above it (case ON_HMI_STATUS).", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472792747", "createdAt": "2020-08-19T07:15:49Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -266,81 +272,90 @@ void parseRAIResponse(RegisterAppInterfaceResponse response) {\n \t\t}\n \t}\n \n-\tprivate void setupRpcListeners() {\n-\t\trpcListener = new OnRPCListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onReceived(RPCMessage message) {\n-\t\t\t\tif (message != null) {\n-\t\t\t\t\tif (RPCMessage.KEY_RESPONSE.equals(message.getMessageType())) {\n-\t\t\t\t\t\tswitch (message.getFunctionID()) {\n-\t\t\t\t\t\t\tcase SET_DISPLAY_LAYOUT:\n-\t\t\t\t\t\t\t\tSetDisplayLayoutResponse response = (SetDisplayLayoutResponse) message;\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.DISPLAY, response.getDisplayCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.BUTTON, response.getButtonCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.PRESET_BANK, response.getPresetBankCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.SOFTBUTTON, response.getSoftButtonCapabilities());\n-\t\t\t\t\t\t\t\tif (shouldConvertDeprecatedDisplayCapabilities) {\n-\t\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.DISPLAYS, createDisplayCapabilityList(response));\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\tcase GET_SYSTEM_CAPABILITY:\n-\t\t\t\t\t\t\t\tGetSystemCapabilityResponse systemCapabilityResponse = (GetSystemCapabilityResponse) message;\n-\t\t\t\t\t\t\t\tSystemCapability systemCapability = systemCapabilityResponse.getSystemCapability();\n-\t\t\t\t\t\t\t\tif (systemCapabilityResponse.getSuccess() && SystemCapabilityType.DISPLAYS.equals(systemCapability.getSystemCapabilityType())) {\n-\t\t\t\t\t\t\t\t\tshouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n-\t\t\t\t\t\t\t\t\tList<DisplayCapability> newCapabilities = (List<DisplayCapability>) systemCapability.getCapabilityForType(SystemCapabilityType.DISPLAYS);\n-\t\t\t\t\t\t\t\t\tupdateCachedDisplayCapabilityList(newCapabilities);\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t}\n-\t\t\t\t\t} else if (RPCMessage.KEY_NOTIFICATION.equals(message.getMessageType())) {\n-\t\t\t\t\t\tswitch (message.getFunctionID()) {\n+    private void setupRpcListeners() {\n+        rpcListener = new OnRPCListener() {\n+            @Override\n+            public void onReceived(RPCMessage message) {\n+                if (message != null) {\n+                    if (RPCMessage.KEY_RESPONSE.equals(message.getMessageType())) {\n+                        switch (message.getFunctionID()) {\n+                            case SET_DISPLAY_LAYOUT:\n+                                SetDisplayLayoutResponse response = (SetDisplayLayoutResponse) message;\n+                                setCapability(SystemCapabilityType.DISPLAY, response.getDisplayCapabilities());\n+                                setCapability(SystemCapabilityType.BUTTON, response.getButtonCapabilities());\n+                                setCapability(SystemCapabilityType.PRESET_BANK, response.getPresetBankCapabilities());\n+                                setCapability(SystemCapabilityType.SOFTBUTTON, response.getSoftButtonCapabilities());\n+                                if (shouldConvertDeprecatedDisplayCapabilities) {\n+                                    setCapability(SystemCapabilityType.DISPLAYS, createDisplayCapabilityList(response));\n+                                }\n+                                break;\n+                            case GET_SYSTEM_CAPABILITY:\n+                                GetSystemCapabilityResponse systemCapabilityResponse = (GetSystemCapabilityResponse) message;\n+                                SystemCapability systemCapability = systemCapabilityResponse.getSystemCapability();\n+                                if (systemCapabilityResponse.getSuccess() && SystemCapabilityType.DISPLAYS.equals(systemCapability.getSystemCapabilityType())) {\n+                                    shouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                                    List<DisplayCapability> newCapabilities = (List<DisplayCapability>) systemCapability.getCapabilityForType(SystemCapabilityType.DISPLAYS);\n+                                    updateCachedDisplayCapabilityList(newCapabilities);\n+                                }\n+                                break;\n+                        }\n+                    } else if (RPCMessage.KEY_NOTIFICATION.equals(message.getMessageType())) {\n+                        switch (message.getFunctionID()) {\n \t\t\t\t\t\t\tcase ON_HMI_STATUS:\n \t\t\t\t\t\t\t\tOnHMIStatus onHMIStatus = (OnHMIStatus) message;\n \t\t\t\t\t\t\t\tif (onHMIStatus.getWindowID() != null && onHMIStatus.getWindowID() != PredefinedWindows.DEFAULT_WINDOW.getValue()) {\n \t\t\t\t\t\t\t\t\treturn;\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\tcurrentHMILevel = onHMIStatus.getHmiLevel();\n \t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\tcase ON_SYSTEM_CAPABILITY_UPDATED:\n-\t\t\t\t\t\t\t\tOnSystemCapabilityUpdated onSystemCapabilityUpdated = (OnSystemCapabilityUpdated) message;\n-\t\t\t\t\t\t\t\tif (onSystemCapabilityUpdated.getSystemCapability() != null) {\n-\t\t\t\t\t\t\t\t\tSystemCapability systemCapability = onSystemCapabilityUpdated.getSystemCapability();\n-\t\t\t\t\t\t\t\t\tSystemCapabilityType systemCapabilityType = systemCapability.getSystemCapabilityType();\n-\t\t\t\t\t\t\t\t\tObject capability = systemCapability.getCapabilityForType(systemCapabilityType);\n-\t\t\t\t\t\t\t\t\tif (cachedSystemCapabilities.containsKey(systemCapabilityType)) { //The capability already exists\n-\t\t\t\t\t\t\t\t\t\tswitch (systemCapabilityType) {\n-\t\t\t\t\t\t\t\t\t\t\tcase APP_SERVICES:\n-\t\t\t\t\t\t\t\t\t\t\t\t// App services only updates what was changed so we need\n-\t\t\t\t\t\t\t\t\t\t\t\t// to update the capability rather than override it\n-\t\t\t\t\t\t\t\t\t\t\t\tAppServicesCapabilities appServicesCapabilities = (AppServicesCapabilities) capability;\n-\t\t\t\t\t\t\t\t\t\t\t\tif (capability != null) {\n-\t\t\t\t\t\t\t\t\t\t\t\t\tList<AppServiceCapability> appServicesCapabilitiesList = appServicesCapabilities.getAppServices();\n-\t\t\t\t\t\t\t\t\t\t\t\t\tAppServicesCapabilities cachedAppServicesCapabilities = (AppServicesCapabilities) cachedSystemCapabilities.get(systemCapabilityType);\n-\t\t\t\t\t\t\t\t\t\t\t\t\t//Update the cached app services\n-\t\t\t\t\t\t\t\t\t\t\t\t\tif (cachedAppServicesCapabilities != null) {\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\tcachedAppServicesCapabilities.updateAppServices(appServicesCapabilitiesList);\n-\t\t\t\t\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t\t\t\t\t\t//Set the new capability object to the updated cached capabilities\n-\t\t\t\t\t\t\t\t\t\t\t\t\tcapability = cachedAppServicesCapabilities;\n-\t\t\t\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\t\t\t\t\tcase DISPLAYS:\n-\t\t\t\t\t\t\t\t\t\t\t\tshouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                            case ON_SYSTEM_CAPABILITY_UPDATED:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc5NTQ0Mg==", "bodyText": "On line 341, the alignment of case VIDEO_STREAMING needs to be fixed. It (and all of its code) needs to be on the same level as the case above it (case DISPLAYS).", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472795442", "createdAt": "2020-08-19T07:18:56Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -266,81 +272,90 @@ void parseRAIResponse(RegisterAppInterfaceResponse response) {\n \t\t}\n \t}\n \n-\tprivate void setupRpcListeners() {\n-\t\trpcListener = new OnRPCListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onReceived(RPCMessage message) {\n-\t\t\t\tif (message != null) {\n-\t\t\t\t\tif (RPCMessage.KEY_RESPONSE.equals(message.getMessageType())) {\n-\t\t\t\t\t\tswitch (message.getFunctionID()) {\n-\t\t\t\t\t\t\tcase SET_DISPLAY_LAYOUT:\n-\t\t\t\t\t\t\t\tSetDisplayLayoutResponse response = (SetDisplayLayoutResponse) message;\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.DISPLAY, response.getDisplayCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.BUTTON, response.getButtonCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.PRESET_BANK, response.getPresetBankCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.SOFTBUTTON, response.getSoftButtonCapabilities());\n-\t\t\t\t\t\t\t\tif (shouldConvertDeprecatedDisplayCapabilities) {\n-\t\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.DISPLAYS, createDisplayCapabilityList(response));\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\tcase GET_SYSTEM_CAPABILITY:\n-\t\t\t\t\t\t\t\tGetSystemCapabilityResponse systemCapabilityResponse = (GetSystemCapabilityResponse) message;\n-\t\t\t\t\t\t\t\tSystemCapability systemCapability = systemCapabilityResponse.getSystemCapability();\n-\t\t\t\t\t\t\t\tif (systemCapabilityResponse.getSuccess() && SystemCapabilityType.DISPLAYS.equals(systemCapability.getSystemCapabilityType())) {\n-\t\t\t\t\t\t\t\t\tshouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n-\t\t\t\t\t\t\t\t\tList<DisplayCapability> newCapabilities = (List<DisplayCapability>) systemCapability.getCapabilityForType(SystemCapabilityType.DISPLAYS);\n-\t\t\t\t\t\t\t\t\tupdateCachedDisplayCapabilityList(newCapabilities);\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t}\n-\t\t\t\t\t} else if (RPCMessage.KEY_NOTIFICATION.equals(message.getMessageType())) {\n-\t\t\t\t\t\tswitch (message.getFunctionID()) {\n+    private void setupRpcListeners() {\n+        rpcListener = new OnRPCListener() {\n+            @Override\n+            public void onReceived(RPCMessage message) {\n+                if (message != null) {\n+                    if (RPCMessage.KEY_RESPONSE.equals(message.getMessageType())) {\n+                        switch (message.getFunctionID()) {\n+                            case SET_DISPLAY_LAYOUT:\n+                                SetDisplayLayoutResponse response = (SetDisplayLayoutResponse) message;\n+                                setCapability(SystemCapabilityType.DISPLAY, response.getDisplayCapabilities());\n+                                setCapability(SystemCapabilityType.BUTTON, response.getButtonCapabilities());\n+                                setCapability(SystemCapabilityType.PRESET_BANK, response.getPresetBankCapabilities());\n+                                setCapability(SystemCapabilityType.SOFTBUTTON, response.getSoftButtonCapabilities());\n+                                if (shouldConvertDeprecatedDisplayCapabilities) {\n+                                    setCapability(SystemCapabilityType.DISPLAYS, createDisplayCapabilityList(response));\n+                                }\n+                                break;\n+                            case GET_SYSTEM_CAPABILITY:\n+                                GetSystemCapabilityResponse systemCapabilityResponse = (GetSystemCapabilityResponse) message;\n+                                SystemCapability systemCapability = systemCapabilityResponse.getSystemCapability();\n+                                if (systemCapabilityResponse.getSuccess() && SystemCapabilityType.DISPLAYS.equals(systemCapability.getSystemCapabilityType())) {\n+                                    shouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                                    List<DisplayCapability> newCapabilities = (List<DisplayCapability>) systemCapability.getCapabilityForType(SystemCapabilityType.DISPLAYS);\n+                                    updateCachedDisplayCapabilityList(newCapabilities);\n+                                }\n+                                break;\n+                        }\n+                    } else if (RPCMessage.KEY_NOTIFICATION.equals(message.getMessageType())) {\n+                        switch (message.getFunctionID()) {\n \t\t\t\t\t\t\tcase ON_HMI_STATUS:\n \t\t\t\t\t\t\t\tOnHMIStatus onHMIStatus = (OnHMIStatus) message;\n \t\t\t\t\t\t\t\tif (onHMIStatus.getWindowID() != null && onHMIStatus.getWindowID() != PredefinedWindows.DEFAULT_WINDOW.getValue()) {\n \t\t\t\t\t\t\t\t\treturn;\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\tcurrentHMILevel = onHMIStatus.getHmiLevel();\n \t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\tcase ON_SYSTEM_CAPABILITY_UPDATED:\n-\t\t\t\t\t\t\t\tOnSystemCapabilityUpdated onSystemCapabilityUpdated = (OnSystemCapabilityUpdated) message;\n-\t\t\t\t\t\t\t\tif (onSystemCapabilityUpdated.getSystemCapability() != null) {\n-\t\t\t\t\t\t\t\t\tSystemCapability systemCapability = onSystemCapabilityUpdated.getSystemCapability();\n-\t\t\t\t\t\t\t\t\tSystemCapabilityType systemCapabilityType = systemCapability.getSystemCapabilityType();\n-\t\t\t\t\t\t\t\t\tObject capability = systemCapability.getCapabilityForType(systemCapabilityType);\n-\t\t\t\t\t\t\t\t\tif (cachedSystemCapabilities.containsKey(systemCapabilityType)) { //The capability already exists\n-\t\t\t\t\t\t\t\t\t\tswitch (systemCapabilityType) {\n-\t\t\t\t\t\t\t\t\t\t\tcase APP_SERVICES:\n-\t\t\t\t\t\t\t\t\t\t\t\t// App services only updates what was changed so we need\n-\t\t\t\t\t\t\t\t\t\t\t\t// to update the capability rather than override it\n-\t\t\t\t\t\t\t\t\t\t\t\tAppServicesCapabilities appServicesCapabilities = (AppServicesCapabilities) capability;\n-\t\t\t\t\t\t\t\t\t\t\t\tif (capability != null) {\n-\t\t\t\t\t\t\t\t\t\t\t\t\tList<AppServiceCapability> appServicesCapabilitiesList = appServicesCapabilities.getAppServices();\n-\t\t\t\t\t\t\t\t\t\t\t\t\tAppServicesCapabilities cachedAppServicesCapabilities = (AppServicesCapabilities) cachedSystemCapabilities.get(systemCapabilityType);\n-\t\t\t\t\t\t\t\t\t\t\t\t\t//Update the cached app services\n-\t\t\t\t\t\t\t\t\t\t\t\t\tif (cachedAppServicesCapabilities != null) {\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\tcachedAppServicesCapabilities.updateAppServices(appServicesCapabilitiesList);\n-\t\t\t\t\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t\t\t\t\t\t//Set the new capability object to the updated cached capabilities\n-\t\t\t\t\t\t\t\t\t\t\t\t\tcapability = cachedAppServicesCapabilities;\n-\t\t\t\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\t\t\t\t\tcase DISPLAYS:\n-\t\t\t\t\t\t\t\t\t\t\t\tshouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                            case ON_SYSTEM_CAPABILITY_UPDATED:\n+                                OnSystemCapabilityUpdated onSystemCapabilityUpdated = (OnSystemCapabilityUpdated) message;\n+                                if (onSystemCapabilityUpdated.getSystemCapability() != null) {\n+                                    SystemCapability systemCapability = onSystemCapabilityUpdated.getSystemCapability();\n+                                    SystemCapabilityType systemCapabilityType = systemCapability.getSystemCapabilityType();\n+                                    Object capability = systemCapability.getCapabilityForType(systemCapabilityType);\n+                                    if (cachedSystemCapabilities.containsKey(systemCapabilityType)) { //The capability already exists\n+                                        switch (systemCapabilityType) {\n+                                            case APP_SERVICES:\n+                                                // App services only updates what was changed so we need\n+                                                // to update the capability rather than override it\n+                                                AppServicesCapabilities appServicesCapabilities = (AppServicesCapabilities) capability;\n+                                                if (capability != null) {\n+                                                    List<AppServiceCapability> appServicesCapabilitiesList = appServicesCapabilities.getAppServices();\n+                                                    AppServicesCapabilities cachedAppServicesCapabilities = (AppServicesCapabilities) cachedSystemCapabilities.get(systemCapabilityType);\n+                                                    //Update the cached app services\n+                                                    if (cachedAppServicesCapabilities != null) {\n+                                                    \tcachedAppServicesCapabilities.updateAppServices(appServicesCapabilitiesList);\n+                                                    }\n+                                                    //Set the new capability object to the updated cached capabilities\n+                                                    capability = cachedAppServicesCapabilities;\n+                                                }\n+                                                break;\n+                                            case DISPLAYS:\n+                                                shouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                                                // this notification can return only affected windows (hence not all windows)\n+                                                List<DisplayCapability> newCapabilities = (List<DisplayCapability>) capability;\n+                                                updateCachedDisplayCapabilityList(newCapabilities);\n+                                                systemCapabilitiesSubscriptionStatus.put(SystemCapabilityType.DISPLAYS, true);\n+                                                break;\n+\t\t\t\t\t\t\t\t\t\t\tcase VIDEO_STREAMING:", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 151}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc5NzEyMw==", "bodyText": "On lines 552 and 554, instead of Log.d you could use DebugTool.log...", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r472797123", "createdAt": "2020-08-19T07:20:56Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -534,6 +549,11 @@ public void addOnSystemCapabilityListener(final SystemCapabilityType systemCapab\n \t\t\t\tonSystemCapabilityListeners.get(systemCapabilityType).add(listener);\n \t\t\t}\n \t\t}\n+\t\tLog.d(\"MyTagLog\", \"add capabilityListener\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 189}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "992ae762be81fe57c51d72d2d3fccdf7c47555c9", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/992ae762be81fe57c51d72d2d3fccdf7c47555c9", "committedDate": "2020-08-19T10:12:24Z", "message": "[VideoStreaming]\n     - Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "036bb2cfc4699b01ac7481ddd355ca23fedb55f8", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/036bb2cfc4699b01ac7481ddd355ca23fedb55f8", "committedDate": "2020-08-19T10:21:12Z", "message": "Fix merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a65b8944e8b0bae1d79859965c15fb11565179c3", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/a65b8944e8b0bae1d79859965c15fb11565179c3", "committedDate": "2020-08-19T10:23:22Z", "message": "Merge branch 'feature/0296_possibility_to_update_video_streaming_capabilities' of https://github.com/LuxoftSDL/sdl_java_suite into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tbase/src/main/java/com/smartdevicelink/protocol/enums/FunctionID.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a95ce91f0d4e37bee70768f0c997773cd0d26ec", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/7a95ce91f0d4e37bee70768f0c997773cd0d26ec", "committedDate": "2020-08-19T10:35:15Z", "message": "[VideoStreaming]\n    - Remove boilerplate from SdlService\n    - Remote logs from BaseSystemCapabilityManager.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3aaf4bdd2416b05b748f2cb83f56692b7c6fe2c5", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/3aaf4bdd2416b05b748f2cb83f56692b7c6fe2c5", "committedDate": "2020-08-19T10:36:13Z", "message": "[VideoStreaming]\n    - Remove logs from VideoStreamManager.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2bf1b3b04ee5adbd5257d0cd4d6311dc65cca8e", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e2bf1b3b04ee5adbd5257d0cd4d6311dc65cca8e", "committedDate": "2020-08-19T10:44:45Z", "message": "[VideoStreaming]\n    - Remove logs from VirtualDisplayEncoder"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe17e5a24f309d0c472cea7c05c7b9f2f505ffbe", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/fe17e5a24f309d0c472cea7c05c7b9f2f505ffbe", "committedDate": "2020-08-19T10:46:08Z", "message": "[VideoStreaming]\n    - Add valueForString for AppCapabilityType.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1747be61f0299e92810d3b62f33cb9d54326e4b5", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/1747be61f0299e92810d3b62f33cb9d54326e4b5", "committedDate": "2020-08-19T10:47:56Z", "message": "[VideoStreaming]\n    - CleanUp VideoStreamingParameters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72d1e91979b0075afb02f02a0710c8680c697a71", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/72d1e91979b0075afb02f02a0710c8680c697a71", "committedDate": "2020-08-19T10:57:16Z", "message": "[VideoStreaming]\n    - CleanUp AppCapabilityType.java\n    - CleanUp VideoStreamingCapability.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f6ac80b3337f798cc02b42f8f842f6b2f50cb38", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/6f6ac80b3337f798cc02b42f8f842f6b2f50cb38", "committedDate": "2020-08-19T10:59:37Z", "message": "[VideoStreaming]\n    - CleanUp AppCapability"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cec21bb8699e83d49a8f95181544c81c430a37e0", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/cec21bb8699e83d49a8f95181544c81c430a37e0", "committedDate": "2020-08-19T11:00:20Z", "message": "[VideoStreaming]\n    - CleanUp AppCapability"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "530e9c0b363760a9993ca2d605f9b44048fc86cd", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/530e9c0b363760a9993ca2d605f9b44048fc86cd", "committedDate": "2020-08-19T11:06:11Z", "message": "[VideoStreaming]\n    - CleanUp MainActivity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4bc2fcd0f588609986fb04f4deb3d7278ee21765", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/4bc2fcd0f588609986fb04f4deb3d7278ee21765", "committedDate": "2020-08-19T12:15:53Z", "message": "[VideoStreaming]\n    - Add AppCapabilityTypeTests.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3f81e5920d0cf3fce0efd991ae75cd7739c3ae8", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/f3f81e5920d0cf3fce0efd991ae75cd7739c3ae8", "committedDate": "2020-08-19T12:21:22Z", "message": "[VideoStreaming]\n    - Cleanup updateCachedVideoStreamingCapabilities"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/6994540523a3b5cda4c60e35fe5e779875f6caa3", "committedDate": "2020-08-19T14:08:26Z", "message": "[VideoStreaming]\n    - Add tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcwNjM0NDgw", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-470634480", "createdAt": "2020-08-19T16:25:18Z", "commit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3"}, "state": "COMMENTED", "comments": {"totalCount": 35, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQxNjoyNToxOFrOHDPQlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOVQyMjoxNDo0N1rOHDcq8g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE1Nzc4MQ==", "bodyText": "@kostyaBoss  if you think it should be deleted, then you can go ahead and delete it.  Thanks.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473157781", "createdAt": "2020-08-19T16:25:18Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java", "diffHunk": "@@ -40,4 +157,8 @@ public boolean onOptionsItemSelected(MenuItem item) {\n \t\t}\n \t\treturn super.onOptionsItemSelected(item);\n \t}\n+\n+\tpublic static enum STREAM_ENUM{", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcxNDI1Mg=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 158}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE1OTIzMQ==", "bodyText": "@kostyaBoss If you think it is needed for testing, then you can go ahead and keep the Toasts.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473159231", "createdAt": "2020-08-19T16:26:36Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java", "diffHunk": "@@ -1,25 +1,142 @@\n package com.sdl.hellosdlandroid;\n \n import android.content.Intent;\n+import android.content.SharedPreferences;\n import android.os.Bundle;\n+import android.preference.PreferenceManager;\n import android.support.v7.app.AppCompatActivity;\n+import android.text.Editable;\n+import android.text.TextWatcher;\n import android.view.Menu;\n import android.view.MenuItem;\n+import android.view.View;\n+import android.widget.Button;\n+import android.widget.EditText;\n+import android.widget.Toast;\n+\n+import java.util.Timer;\n+import java.util.TimerTask;\n \n public class MainActivity extends AppCompatActivity {\n \tprivate static final String TAG = \"MainActivity\";\n-\t\n+\n+\tpublic static final String IP = \"ip\";\n+\tpublic static final String PORT = \"port\";\n+\tpublic static final String COMMAND = \"command\";\n+\tpublic static final String COMMAND_START_PROXY = \"c_start_proxy\";\n+\tpublic static final String COMMAND_START_STREAM = \"c_start_stream\";\n+\n+\tpublic static final String PREDEFINED_WIDTH = \"pre_def_w\";\n+\tpublic static final String PREDEFINED_HEIGHT = \"pre_def_h\";\n+\tpublic static final String IP_ADDRESS = \"ip_address\";\n+\tSharedPreferences preferences;\n+\n \t@Override\n \tprotected void onCreate(Bundle savedInstanceState) {\n \t\tsuper.onCreate(savedInstanceState);\n \t\tsetContentView(R.layout.activity_main);\n-\t\t//If we are connected to a module we want to start our SdlService\n-\t\tif(BuildConfig.TRANSPORT.equals(\"MULTI\") || BuildConfig.TRANSPORT.equals(\"MULTI_HB\")) {\n-\t\t\tSdlReceiver.queryForConnectedService(this);\n-\t\t}else if(BuildConfig.TRANSPORT.equals(\"TCP\")) {\n-\t\t\tIntent proxyIntent = new Intent(this, SdlService.class);\n-\t\t\tstartService(proxyIntent);\n-\t\t}\n+\n+\t\tpreferences = PreferenceManager.getDefaultSharedPreferences(this);\n+\n+\n+\t\tButton startStreaming = findViewById(R.id.start_streaming);\n+\t\tButton startStreamingUI = findViewById(R.id.start_streaming_ui);\n+\t\tButton startProxy = findViewById(R.id.start_proxy);\n+\t\tButton stopApp = findViewById(R.id.exit_application);\n+\n+\t\tfinal EditText ip = findViewById(R.id.machine_ip);\n+\t\tfinal EditText port = findViewById(R.id.machine_port);\n+\n+\t\tfinal EditText preConfWidth = findViewById(R.id.pre_conf_width);\n+\t\tfinal EditText preConfHeight = findViewById(R.id.pre_conf_height);\n+\n+\t\tip.setText(preferences.getString(IP_ADDRESS, \"192.168.0.101\"));\n+\n+\t\tip.addTextChangedListener(new TextWatcher() {\n+\t\t\t@Override\n+\t\t\tpublic void beforeTextChanged(CharSequence s, int start, int count, int after) { }\n+\n+\t\t\t@Override\n+\t\t\tpublic void onTextChanged(CharSequence s, int start, int before, int count) { }\n+\n+\t\t\t@Override\n+\t\t\tpublic void afterTextChanged(Editable s) {\n+\t\t\t\tif (s!=null) {\n+\t\t\t\t\tpreferences.edit().putString(IP_ADDRESS, s.toString()).commit();\n+\t\t\t\t}\n+\t\t\t}\n+\t\t});\n+\n+\t\tstartProxy.setOnClickListener(new View.OnClickListener() {\n+\t\t\t@Override\n+\t\t\tpublic void onClick(View view) {\n+\t\t\t\t//If we are connected to a module we want to start our SdlService\n+\t\t\t\tif(BuildConfig.TRANSPORT.equals(\"MULTI\") || BuildConfig.TRANSPORT.equals(\"MULTI_HB\")) {\n+\t\t\t\t\tSdlReceiver.queryForConnectedService(MainActivity.this);\n+\t\t\t\t}else if(BuildConfig.TRANSPORT.equals(\"TCP\")) {\n+\t\t\t\t\tIntent proxyIntent = new Intent(MainActivity.this, SdlService.class);\n+\n+\t\t\t\t\tString ipString = ip.getText().toString();\n+\t\t\t\t\tString portString = port.getText().toString();\n+\t\t\t\t\tif (!ipString.isEmpty() && !portString.isEmpty()) {\n+\t\t\t\t\t\tproxyIntent.putExtra(IP, ip.getText().toString());\n+\t\t\t\t\t\ttry {\n+\t\t\t\t\t\t\tproxyIntent.putExtra(PORT, Integer.parseInt(port.getText().toString()));\n+\t\t\t\t\t\t} catch (NumberFormatException e){\n+\t\t\t\t\t\t\tToast.makeText(MainActivity.this, \"Port should be number\", Toast.LENGTH_SHORT).show();\n+\t\t\t\t\t\t\treturn;\n+\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\tstartService(proxyIntent);\n+\t\t\t\t\t} else {\n+\t\t\t\t\t\tToast.makeText(MainActivity.this, \"Fill ip and port\", Toast.LENGTH_SHORT).show();\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t}\n+\t\t});\n+\n+\t\tstartStreaming.setOnClickListener(new View.OnClickListener() {\n+\t\t\t@Override\n+\t\t\tpublic void onClick(View view) {\n+\t\t\t\tif (!preConfWidth.getText().toString().isEmpty() && !preConfHeight.getText().toString().isEmpty()) {\n+\t\t\t\t\tpreferences.edit().putInt(PREDEFINED_WIDTH, Integer.parseInt(preConfWidth.getText().toString())).commit();\n+\t\t\t\t\tpreferences.edit().putInt(PREDEFINED_HEIGHT, Integer.parseInt(preConfHeight.getText().toString())).commit();\n+\t\t\t\t\tSdlService.relay.accept(STREAM_ENUM.START_STREAMING);\n+\t\t\t\t} else {\n+\t\t\t\t\tToast.makeText(MainActivity.this, \"Configure display width and height\", Toast.LENGTH_SHORT).show();\n+\t\t\t\t}\n+\t\t\t}\n+\t\t});\n+\n+\t\tstartStreamingUI.setOnClickListener(new View.OnClickListener() {\n+\t\t\t@Override\n+\t\t\tpublic void onClick(View view) {\n+\n+\t\t\t\tif (!preConfWidth.getText().toString().isEmpty() && !preConfHeight.getText().toString().isEmpty()) {\n+\t\t\t\t\tpreferences.edit().putInt(PREDEFINED_WIDTH, Integer.parseInt(preConfWidth.getText().toString())).commit();\n+\t\t\t\t\tpreferences.edit().putInt(PREDEFINED_HEIGHT, Integer.parseInt(preConfHeight.getText().toString())).commit();\n+\t\t\t\t\tSdlService.relay.accept(STREAM_ENUM.START_STREAMING_UI);\n+\t\t\t\t} else {\n+\t\t\t\t\tToast.makeText(MainActivity.this, \"Configure display width and height\", Toast.LENGTH_SHORT).show();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk3OTk3Nw=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 128}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE3MjI5Nw==", "bodyText": "@kostyaBoss I still see this issue.  Wherever you have values for android:text or android:hint can you define those strings in the strings.xml file?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473172297", "createdAt": "2020-08-19T16:41:44Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/res/layout/ui_streaming_layout.xml", "diffHunk": "@@ -0,0 +1,48 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_marginLeft=\"30dp\"\n+    android:layout_marginTop=\"30dp\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk1ODM4Mg=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE3Mjk3Nw==", "bodyText": "@kostyaBoss I still see the issue.  Can you keep the app_name variable as \"Hello Sdl Android\" or does it need to be changed?  Thanks.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473172977", "createdAt": "2020-08-19T16:42:48Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/res/values/strings.xml", "diffHunk": "@@ -1,7 +1,7 @@\n <?xml version=\"1.0\" encoding=\"utf-8\"?>\n <resources>\n \n-    <string name=\"app_name\">Hello Sdl Android</string>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk0ODQyMA=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE4MDgzNQ==", "bodyText": "Per the proposal, VideoStreamingRange should be defined as:\n\"...\npublic class VideoStreamingRange { private Resolution minResolution; private Resolution maxResolution; private Double minAspectRatio; private Double maxAspectRatio; private Double minScreenDiagonal; }\n...\"\nDo you need to change your variable definitions to match with the proposal?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473180835", "createdAt": "2020-08-19T16:56:03Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,61 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public class VideoStreamingRange {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzIxNDg2OA==", "bodyText": "@kostyaBoss the unused import on line 35 import android util.Log' can be removed.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473214868", "createdAt": "2020-08-19T17:47:52Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -32,13 +32,16 @@\n \n package com.smartdevicelink.streaming.video;\n \n+import android.util.Log;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMzMjcwMQ==", "bodyText": "Can you delete the overloaded configureGlobalParameters method (the one with 3 parameters), and just use this one and set this.streamingRange = streamingRange; if streamingRange is not null?\n\n@kostyaBoss I still see this issue.  Are you able to make this change?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473332701", "createdAt": "2020-08-19T21:20:52Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -262,23 +337,69 @@ public void onError(String info) {\n \t *\n \t * @param encrypted a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n \t */\n+\t@Deprecated\n \tpublic void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n-\t\tthis.context = new WeakReference<>(context);\n-\t\tthis.remoteDisplayClass = remoteDisplayClass;\n-\t\tint majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+\t\tconfigureGlobalParameters(context, remoteDisplayClass, isEncrypted);\n \t\tif(majorProtocolVersion >= 5 && !internalInterface.isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING)){\n \t\t\tDebugTool.logError(TAG, \"Video streaming not supported on this module\");\n \t\t\tstateMachine.transitionToState(StreamingStateMachine.ERROR);\n \t\t\treturn;\n \t\t}\n+\t\tif (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+\t\t\tgetVideoStreamingParams();\n+\t\t}\n+\t\tcheckState();\n+\t\tprocessCapabilitiesWithPendingStart(encrypted, parameters);\n+\t}\n+\n+\tprivate void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted) {\n+\t\tthis.context = new WeakReference<>(context);\n+\t\tthis.remoteDisplayClass = remoteDisplayClass;\n+\t\tthis.isEncrypted = encrypted;\n+\t\tthis.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+\t}\n+\n+\tprivate void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, VideoStreamingRange streamingRange) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjczMzMxMw=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 238}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMzMzgyNA==", "bodyText": "Can you delete lines 455 and 456 and instead just do createRemoteDisplay(virtualDisplayEncoder.getDisplay());?\n\n@kostyaBoss I still see this issue.  Are you able to make this change?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473333824", "createdAt": "2020-08-19T21:22:10Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -323,11 +444,17 @@ protected void startStreaming(VideoStreamingParameters parameters, boolean encry\n \t */\n \tprivate void startEncoder(){\n \t\ttry {\n+\t\t\tif (sdlRemoteDisplay != null) {\n+\t\t\t\tsdlRemoteDisplay.resizeView(parameters.getResolution().getResolutionWidth(), parameters.getResolution().getResolutionHeight());\n+\t\t\t}\n+\n \t\t\tvirtualDisplayEncoder.init(this.context.get(), streamListener, parameters);\n \t\t\t//We are all set so we can start streaming at at this point\n \t\t\tvirtualDisplayEncoder.start();\n \t\t\t//Encoder should be up and running\n-\t\t\tcreateRemoteDisplay(virtualDisplayEncoder.getVirtualDisplay());\n+\t\t\tDisplay display = virtualDisplayEncoder.getDisplay();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0MDk0Mw=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 297}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMzNTU0Mw==", "bodyText": "Can you replace lines 541-543 with return (stateMachine.getState() == StreamingStateMachine.STARTED) && (isHMIStateVideoStreamCapable(currentOnHMIStatus));? This was the previous code, and is equivalent to the new code.\n\n@kostyaBoss I still see this issue.  Are you able to make this change?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473335543", "createdAt": "2020-08-19T21:24:01Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -397,15 +529,18 @@ public void dispose(){\n \tpublic boolean isServiceActive(){\n \t\treturn (stateMachine.getState() == StreamingStateMachine.READY) ||\n \t\t\t\t(stateMachine.getState() == StreamingStateMachine.STARTED) ||\n-\t\t\t\t(stateMachine.getState() == StreamingStateMachine.STOPPED);\n+\t\t\t\t(stateMachine.getState() == StreamingStateMachine.STOPPED) ||\n+\t\t\t\t(stateMachine.getState() == StreamingStateMachine.PAUSED);\n \t}\n \n \t/**\n \t * Check if video is currently streaming and visible\n \t * @return boolean (true = yes, false = no)\n \t */\n \tpublic boolean isStreaming(){\n-\t\treturn (stateMachine.getState() == StreamingStateMachine.STARTED) && (isHMIStateVideoStreamCapable(currentOnHMIStatus));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc0MzM3Mg=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 373}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMzNzA2Mg==", "bodyText": "Per the proposal, getSupportedCapabilities should be defined as:\n\"...\nprivate List<VideoStreamingCapability> getSupportedCapabilities( Resolution minResolution, Resolution maxResolution, Double minAspectRatio, Double maxAspectRatio, Double minScreenDiagonal )\n...\"\nDo you need to change your method definition to match with the proposal?\n\n@kostyaBoss Does your method definition need to match with the proposal?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473337062", "createdAt": "2020-08-19T21:25:40Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -603,6 +744,120 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n \t\treturn motionEventList;\n \t}\n \n+\tpublic VideoStreamingParameters getLastCachedStreamingParameters() {\n+\t\treturn parameters;\n+\t}\n+\n+\tpublic boolean getLastCachedIsEncrypted() {\n+\t\treturn isEncrypted;\n+\t}\n+\n+\tprivate List<VideoStreamingCapability> getSupportedCapabilities(\n+\t\t\tResolution minResolution,\n+\t\t\tResolution maxResolution,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY0NTMyMQ=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 443}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzMzODYwMg==", "bodyText": "@kostyaBoss Do the other setters need to be added here like\npreferredCapability.setPixelPerInch(...);\npreferredCapability.setAdditionalVideoStreamingCapabilities();?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473338602", "createdAt": "2020-08-19T21:27:25Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -603,6 +742,120 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n \t\treturn motionEventList;\n \t}\n \n+\tpublic VideoStreamingParameters getLastCachedStreamingParameters() {\n+\t\treturn parameters;\n+\t}\n+\n+\tpublic boolean getLastCachedIsEncrypted() {\n+\t\treturn isEncrypted;\n+\t}\n+\n+\tprivate List<VideoStreamingCapability> getSupportedCapabilities(\n+\t\t\tResolution minResolution,\n+\t\t\tResolution maxResolution,\n+\t\t\tDouble constraintDiagonalMax,\n+\t\t\tAspectRatio ratioRange,\n+\t\t\tList<VideoStreamingCapability> originalAdditionalCapabilities\n+\t){\n+\t\tInteger constraintHeightMax = maxResolution.getResolutionHeight();\n+\t\tInteger constraintHeightMin = minResolution.getResolutionHeight();\n+\t\tInteger constraintWidthMax = maxResolution.getResolutionWidth();\n+\t\tInteger constraintWidthMin = minResolution.getResolutionWidth();\n+\t\tDouble aspectRationMin = ratioRange.getMinAspectRatio();\n+\t\tDouble aspectRationMax = ratioRange.getMaxAspectRatio();\n+\n+\t\tList<VideoStreamingCapability> validCapabilities = new ArrayList<>();\n+\n+\t\tVideoStreamingCapability preferredCapability = new VideoStreamingCapability();\n+\t\tpreferredCapability.setDiagonalScreenSize(parameters.getPreferredDiagonal());\n+\t\tpreferredCapability.setPreferredResolution(new ImageResolution(\n+\t\t\t\tparameters.getResolution().getResolutionWidth(),\n+\t\t\t\tparameters.getResolution().getResolutionHeight())\n+\t\t);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3"}, "originalPosition": 455}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM1NzI2Nw==", "bodyText": "@kostyaBoss can you revert this change?  I think you should bring those back and leave it commented like before.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473357267", "createdAt": "2020-08-19T21:49:37Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -166,31 +221,43 @@ private void startProxy() {\n \n \t\t\t// The app type to be used\n \t\t\tVector<AppHMIType> appType = new Vector<>();\n-\t\t\tappType.add(AppHMIType.DEFAULT);\n+\t\t\tappType.add(AppHMIType.NAVIGATION);\n \n \t\t\t// The manager listener helps you know when certain events that pertain to the SDL Manager happen\n \t\t\t// Here we will listen for ON_HMI_STATUS and ON_COMMAND notifications\n \t\t\tSdlManagerListener listener = new SdlManagerListener() {\n \t\t\t\t@Override\n \t\t\t\tpublic void onStart() {\n-\t\t\t\t\t// HMI Status Listener\n-\t\t\t\t\tsdlManager.addOnRPCNotificationListener(FunctionID.ON_HMI_STATUS, new OnRPCNotificationListener() {\n-\t\t\t\t\t\t@Override\n-\t\t\t\t\t\tpublic void onNotified(RPCNotification notification) {\n-\t\t\t\t\t\t\tOnHMIStatus onHMIStatus = (OnHMIStatus)notification;\n-\t\t\t\t\t\t\tif (onHMIStatus.getWindowID() != null && onHMIStatus.getWindowID() != PredefinedWindows.DEFAULT_WINDOW.getValue()) {\n-\t\t\t\t\t\t\t\treturn;\n-\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\tif (onHMIStatus.getHmiLevel() == HMILevel.HMI_FULL && onHMIStatus.getFirstRun()) {\n-\t\t\t\t\t\t\t\tsetVoiceCommands();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcxOTU2MA=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 167}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM1Nzk4Mg==", "bodyText": "@kostyaBoss If you think the code should be deleted, then you can go ahead and delete it.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473357982", "createdAt": "2020-08-19T21:50:26Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -450,4 +531,97 @@ public void onError(String error) {\n \t\t\tsdlManager.getScreenManager().presentChoiceSet(choiceSet, InteractionMode.MANUAL_ONLY);\n \t\t}\n \t}\n+\n+\tpublic static class UIStreamingDisplay extends SdlRemoteDisplay {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyMTMyOQ=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 249}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM1ODg3Nw==", "bodyText": "Instead of button1, button2, clickCounter1, clickCounter2 , counter1, and counter2 can more descriptive names be given to the variables in the source code and in the layout xml?\n\n@kostyaBoss I still see the old variable names.  Can you change these to more descriptive names?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473358877", "createdAt": "2020-08-19T21:51:28Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -450,4 +531,97 @@ public void onError(String error) {\n \t\t\tsdlManager.getScreenManager().presentChoiceSet(choiceSet, InteractionMode.MANUAL_ONLY);\n \t\t}\n \t}\n+\n+\tpublic static class UIStreamingDisplay extends SdlRemoteDisplay {\n+\t\tint clickCounter1 = 0;\n+\t\tint clickCounter2 = 0;\n+\t\tpublic UIStreamingDisplay(Context context, Display display) {\n+\t\t\tsuper(context, display);\n+\t\t}\n+\n+\t\t@Override\n+\t\tprotected void onCreate(Bundle savedInstanceState) {\n+\t\t\tsuper.onCreate(savedInstanceState);\n+\t\t\tsetContentView(R.layout.ui_streaming_layout);\n+\n+\n+\t\t\tfinal Button button1 = findViewById(R.id.button1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyMjI3OQ=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 262}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM1OTIzOA==", "bodyText": "@kostyaBoss If you think the class can be deleted, then you can go ahead and delete it.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473359238", "createdAt": "2020-08-19T21:51:53Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -450,4 +531,97 @@ public void onError(String error) {\n \t\t\tsdlManager.getScreenManager().presentChoiceSet(choiceSet, InteractionMode.MANUAL_ONLY);\n \t\t}\n \t}\n+\n+\tpublic static class UIStreamingDisplay extends SdlRemoteDisplay {\n+\t\tint clickCounter1 = 0;\n+\t\tint clickCounter2 = 0;\n+\t\tpublic UIStreamingDisplay(Context context, Display display) {\n+\t\t\tsuper(context, display);\n+\t\t}\n+\n+\t\t@Override\n+\t\tprotected void onCreate(Bundle savedInstanceState) {\n+\t\t\tsuper.onCreate(savedInstanceState);\n+\t\t\tsetContentView(R.layout.ui_streaming_layout);\n+\n+\n+\t\t\tfinal Button button1 = findViewById(R.id.button1);\n+\t\t\tfinal Button button2 = findViewById(R.id.button2);\n+\t\t\tfinal TextView counter1 = findViewById(R.id.button_one_counter);\n+\t\t\tfinal TextView counter2 = findViewById(R.id.button_two_counter);\n+            button1.setOnTouchListener(new View.OnTouchListener() {\n+\t\t\t\t@Override\n+\t\t\t\tpublic boolean onTouch(View view, MotionEvent motionEvent) {\n+\n+                    counter1.setText(\"Click!!! \" + ++clickCounter1);\n+\t\t\t\t\tLog.d(\"MyTagClickCounter\", String.valueOf(clickCounter1));\n+\t\t\t\t\tint location [] = new int[2];\n+                    button1.getLocationInWindow(location);\n+                    //counter1.append(\"\\nButton size: \" + button1.getWidth() + \"x\" + button1.getHeight());\n+\t\t\t\t\t//textView.append(\"\\nButton location: \" + location[0] + \",\" + location[1]);\n+\t\t\t\t\treturn false;\n+\t\t\t\t}\n+\t\t\t});\n+\n+            button2.setOnTouchListener(new View.OnTouchListener() {\n+                @Override\n+                public boolean onTouch(View view, MotionEvent motionEvent) {\n+\n+                    counter2.setText(\"Click!!! \" + ++clickCounter2);\n+                    Log.d(\"MyTagClickCounter\", String.valueOf(clickCounter2));\n+                    int location [] = new int[2];\n+                    button2.getLocationInWindow(location);\n+                    //counter2.append(\"\\nButton size: \" + button.getWidth() + \"x\" + button.getHeight());\n+                    //textView.append(\"\\nButton location: \" + location[0] + \",\" + location[1]);\n+                    return false;\n+                }\n+            });\n+\t\t}\n+\n+\t\t@Override\n+\t\tpublic void onViewResized(int width, int height) {\n+\t\t\tToast.makeText(getContext(),\n+\t\t\t\t\tString.format(\"Remote view new width and height (%s, %s)\", width, height),\n+\t\t\t\t\tToast.LENGTH_SHORT\n+\t\t\t).show();\n+\t\t}\n+\t}\n+\n+\tpublic static class MyDisplay extends SdlRemoteDisplay {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcyMzg2OQ=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 304}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2NTMyOA==", "bodyText": "@kostyaBoss Unused import on line 29 can be removed.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473365328", "createdAt": "2020-08-19T21:59:22Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -7,23 +7,36 @@\n import android.app.Service;\n import android.content.Context;\n import android.content.Intent;\n+import android.net.Uri;\n import android.os.Build;\n+import android.os.Bundle;\n import android.os.IBinder;\n import android.util.Log;\n-\n+import android.view.Display;\n+import android.view.MotionEvent;\n+import android.view.View;\n+import android.widget.Button;\n+import android.widget.TextView;\n+import android.widget.Toast;\n+import android.widget.VideoView;\n+\n+import com.jakewharton.rxrelay2.PublishRelay;\n import com.smartdevicelink.managers.CompletionListener;\n-import com.smartdevicelink.managers.screen.OnButtonListener;\n import com.smartdevicelink.managers.SdlManager;\n import com.smartdevicelink.managers.SdlManagerListener;\n import com.smartdevicelink.managers.file.filetypes.SdlArtwork;\n import com.smartdevicelink.managers.lifecycle.LifecycleConfigurationUpdate;\n+import com.smartdevicelink.managers.screen.OnButtonListener;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2NjgzMQ==", "bodyText": "@kostyaBoss I still see this issue.  Are you able to export all of the hard coded strings (values for android:text and android:hint) and put them in the strings.xml file?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473366831", "createdAt": "2020-08-19T22:01:20Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/res/layout/activity_main.xml", "diffHunk": "@@ -1,16 +1,81 @@\n <RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n-    xmlns:tools=\"http://schemas.android.com/tools\"\n-    android:layout_width=\"match_parent\"\n-    android:layout_height=\"match_parent\"\n-    android:paddingBottom=\"@dimen/activity_vertical_margin\"\n-    android:paddingLeft=\"@dimen/activity_horizontal_margin\"\n-    android:paddingRight=\"@dimen/activity_horizontal_margin\"\n-    android:paddingTop=\"@dimen/activity_vertical_margin\"\n-    tools:context=\"com.sdl.hellosdlandroid.MainActivity\" >\n+    android:layout_width=\"wrap_content\"\n+    android:layout_height=\"match_parent\">\n \n     <TextView", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk1NzI0Mg=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2ODA1Mg==", "bodyText": "In the setup function around line 105, does a call need to be made to videoStreamingCapability.setAdditionalVideoStreamingCapabilities(...)?\n\n@kostyaBoss I still see this issue.  In the setup function around line 106, does a call need to be made to videoStreamingCapability.setAdditionalVideoStreamingCapabilities(...)?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473368052", "createdAt": "2020-08-19T22:02:53Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/lifecycle/SystemCapabilityManagerTests.java", "diffHunk": "@@ -365,9 +365,9 @@ public void testGetCapabilityHmiNone() {\n \t\tscm.setCapability(SystemCapabilityType.VIDEO_STREAMING, null);\n \t\tVideoStreamingCapability retrievedCapability = (VideoStreamingCapability) scm.getCapability(SystemCapabilityType.VIDEO_STREAMING, onSystemCapabilityListener, false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjAyOTcyMg=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2ODQ0NA==", "bodyText": "In the testGetVSCapability function around line 221, does a call need to be made to vsCapability.setAdditionalVideoStreamingCapabilities(...)?\n\n@kostyaBoss I still see this issue.  In the testGetVSCapability function around line 221, does a call need to be made to vsCapability.setAdditionalVideoStreamingCapabilities(...)?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473368444", "createdAt": "2020-08-19T22:03:22Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/lifecycle/SystemCapabilityManagerTests.java", "diffHunk": "@@ -365,9 +365,9 @@ public void testGetCapabilityHmiNone() {\n \t\tscm.setCapability(SystemCapabilityType.VIDEO_STREAMING, null);\n \t\tVideoStreamingCapability retrievedCapability = (VideoStreamingCapability) scm.getCapability(SystemCapabilityType.VIDEO_STREAMING, onSystemCapabilityListener, false);\n \t\tassertNull(retrievedCapability);\n-\t\tverify(internalInterface, times(0)).sendRPC(any(GetSystemCapability.class));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjAzMDY1MA=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2ODg1NQ==", "bodyText": "Do more unit tests need to be added to test all of the new code that was added in VideoStreamManager.java?\n\n@kostyaBoss Do more unit tests need to be added to test all of the new code that was added in VideoStreamManager.java?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473368855", "createdAt": "2020-08-19T22:03:56Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamManagerTests.java", "diffHunk": "@@ -92,6 +92,11 @@ protected void onCreate(Bundle savedInstanceState) {\n \t\t\tsetContentView(simulatedView);\n \t\t}\n \n+\t\t@Override\n+\t\tpublic void onViewResized(int width, int height) {\n+\n+\t\t}\n+\n \t\t@Override", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc1MTIxNw=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2OTEzOA==", "bodyText": "In VideoStreamManager.java there is this line pointer.setCoords(touchCoord.getX() / touchScalar[0], touchCoord.getY() / touchScalar[1]); where the MotionEvent pointer is set using division. How come in the unit test it has been changed to multiplication?\n\n@kostyaBoss In VideoStreamManager.java there is this line pointer.setCoords(touchCoord.getX() / touchScalar[0], touchCoord.getY() / touchScalar[1]); where the MotionEvent pointer is set using division. How come in the unit test it has been changed to multiplication?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473369138", "createdAt": "2020-08-19T22:04:19Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamManagerTests.java", "diffHunk": "@@ -538,8 +543,8 @@ private void assertMotionEventWithScale(int width, int height, float scale) {\n \n         motionEvent = motionEventList.get(0);\n         assertEquals(1, motionEvent.getPointerCount());\n-        assertEquals(Math.round(e1x / scale), Math.round(motionEvent.getX(0)));\n-        assertEquals(Math.round(e1y / scale), Math.round(motionEvent.getY(0)));\n+        assertEquals(Math.round(e1x * scale), Math.round(motionEvent.getX(0)));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc1MDU1MQ=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM2OTc1MQ==", "bodyText": "@kostyaBoss On line 908, I think you need to add these lines:\nGENERAL_VIDEOSTREAMINGCAPABILITY.setAdditionalVideoStreamingCapabilities(...);\nGENERAL_VIDEOSTREAMINGCAPABILITY.setDiagonalScreenSize(...);\nGENERAL_VIDEOSTREAMINGCAPABILITY.setPixelPerInch(...);\nGENERAL_VIDEOSTREAMINGCAPABILITY.setScale(...);", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473369751", "createdAt": "2020-08-19T22:05:04Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -1133,6 +1137,9 @@ public void onVoiceCommandSelected() {\n \t\tGENERAL_WINDOW_STATUS.setLocation(TestValues.GENERAL_GRID);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3MDI5NQ==", "bodyText": "@kostyaBoss In this comment on line 52, you can change this from AmbientLightStatus to AppCapabilityType.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473370295", "createdAt": "2020-08-19T22:05:50Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/rpc/enums/AppCapabilityTypeTests.java", "diffHunk": "@@ -0,0 +1,63 @@\n+package com.smartdevicelink.test.rpc.enums;\n+\n+import com.smartdevicelink.proxy.rpc.enums.AppCapabilityType;\n+\n+import junit.framework.TestCase;\n+\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+public class AppCapabilityTypeTests extends TestCase {\n+\n+    /**\n+     * Verifies that the enum values are not null upon valid assignment.\n+     */\n+    public void testValidEnums () {\n+        String example = \"VIDEO_STREAMING\";\n+        AppCapabilityType enumVideoStreaming = AppCapabilityType.valueForString(example);\n+\n+        assertNotNull(\"VIDEO_STREAMING returned null\", enumVideoStreaming);\n+    }\n+\n+    /**\n+     * Verifies that an invalid assignment is null.\n+     */\n+    public void testInvalidEnum () {\n+        String example = \"VidEOs_Treamin\";\n+        try {\n+            AppCapabilityType temp = AppCapabilityType.valueForString(example);\n+            assertNull(\"Result of valueForString should be null.\", temp);\n+        }\n+        catch (IllegalArgumentException exception) {\n+            fail(\"Invalid enum throws IllegalArgumentException.\");\n+        }\n+    }\n+\n+    /**\n+     * Verifies that a null assignment is invalid.\n+     */\n+    public void testNullEnum () {\n+        String example = null;\n+        try {\n+            AppCapabilityType temp = AppCapabilityType.valueForString(example);\n+            assertNull(\"Result of valueForString should be null.\", temp);\n+        }\n+        catch (NullPointerException exception) {\n+            fail(\"Null string throws NullPointerException.\");\n+        }\n+    }\n+\n+    /**\n+     * Verifies the possible enum values of AmbientLightStatus.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3MDgwNQ==", "bodyText": "Can you add code to unit test the newly added resizeView(...) function in SdlRemoteDisplay.java?\n\n@kostyaBoss .  Are you able to add code to unit test the newly added resizeView(...) function?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473370805", "createdAt": "2020-08-19T22:06:32Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/streaming/video/SdlRemoteDisplayTest.java", "diffHunk": "@@ -37,7 +37,7 @@ public void testCreator(){\n         assertNotNull(encoder);\n ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk5MjM1Mg=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3MTUzNQ==", "bodyText": "@kostyaBoss I still see this.  On line 106, can you rename the variable p to preferences?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473371535", "createdAt": "2020-08-19T22:07:25Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -98,6 +105,11 @@ public void init(Context context, IVideoStreamListener outputListener, VideoStre\n \n         mOutputListener = outputListener;\n \n+        SharedPreferences p = PreferenceManager.getDefaultSharedPreferences(context);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk5OTk3Mw=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3MjAzOQ==", "bodyText": "@kostyaBoss You can remove the unused import import android.util.Log; on line 39.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473372039", "createdAt": "2020-08-19T22:08:00Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -36,6 +36,7 @@\n import android.content.Context;\n import android.os.SystemClock;\n import android.util.DisplayMetrics;\n+import android.util.Log;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3MzQwMg==", "bodyText": "@kostyaBoss The unused import on line 55 can be removed.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473373402", "createdAt": "2020-08-19T22:09:32Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -52,6 +52,7 @@\n import com.smartdevicelink.proxy.rpc.SetDisplayLayoutResponse;\n import com.smartdevicelink.proxy.rpc.SoftButtonCapabilities;\n import com.smartdevicelink.proxy.rpc.SystemCapability;\n+import com.smartdevicelink.proxy.rpc.VideoStreamingCapability;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6994540523a3b5cda4c60e35fe5e779875f6caa3"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3Mzc3OQ==", "bodyText": "The alignment of private void setupRpcListeners() was altered . It (and all of its code) needs to be on the same level as the function above it (parseRAIResponse(...)).\n\n@kostyaBoss I still see this issue.  The alignment of private void setupRpcListeners() is still a little bit off. It (and all of its code) needs to be on the same level as the function above it (parseRAIResponse(...)).", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473373779", "createdAt": "2020-08-19T22:10:02Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -266,81 +272,90 @@ void parseRAIResponse(RegisterAppInterfaceResponse response) {\n \t\t}\n \t}\n \n-\tprivate void setupRpcListeners() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc4NDM4Ng=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3NDI5OA==", "bodyText": "On line 311, the alignment of case ON_SYSTEM_CAPABILITY_UPDATED was altered . It (and all of its code) needs to be on the same level as the case above it (case ON_HMI_STATUS).\n\n@kostyaBoss I still see the alignment issue with case ON_SYSTEM_CAPABILITY_UPDATED on line 305.  It (and all of its code) needs to be on the same level as the case above it (case ON_HMI_STATUS).", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473374298", "createdAt": "2020-08-19T22:10:36Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -266,81 +272,90 @@ void parseRAIResponse(RegisterAppInterfaceResponse response) {\n \t\t}\n \t}\n \n-\tprivate void setupRpcListeners() {\n-\t\trpcListener = new OnRPCListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onReceived(RPCMessage message) {\n-\t\t\t\tif (message != null) {\n-\t\t\t\t\tif (RPCMessage.KEY_RESPONSE.equals(message.getMessageType())) {\n-\t\t\t\t\t\tswitch (message.getFunctionID()) {\n-\t\t\t\t\t\t\tcase SET_DISPLAY_LAYOUT:\n-\t\t\t\t\t\t\t\tSetDisplayLayoutResponse response = (SetDisplayLayoutResponse) message;\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.DISPLAY, response.getDisplayCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.BUTTON, response.getButtonCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.PRESET_BANK, response.getPresetBankCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.SOFTBUTTON, response.getSoftButtonCapabilities());\n-\t\t\t\t\t\t\t\tif (shouldConvertDeprecatedDisplayCapabilities) {\n-\t\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.DISPLAYS, createDisplayCapabilityList(response));\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\tcase GET_SYSTEM_CAPABILITY:\n-\t\t\t\t\t\t\t\tGetSystemCapabilityResponse systemCapabilityResponse = (GetSystemCapabilityResponse) message;\n-\t\t\t\t\t\t\t\tSystemCapability systemCapability = systemCapabilityResponse.getSystemCapability();\n-\t\t\t\t\t\t\t\tif (systemCapabilityResponse.getSuccess() && SystemCapabilityType.DISPLAYS.equals(systemCapability.getSystemCapabilityType())) {\n-\t\t\t\t\t\t\t\t\tshouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n-\t\t\t\t\t\t\t\t\tList<DisplayCapability> newCapabilities = (List<DisplayCapability>) systemCapability.getCapabilityForType(SystemCapabilityType.DISPLAYS);\n-\t\t\t\t\t\t\t\t\tupdateCachedDisplayCapabilityList(newCapabilities);\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t}\n-\t\t\t\t\t} else if (RPCMessage.KEY_NOTIFICATION.equals(message.getMessageType())) {\n-\t\t\t\t\t\tswitch (message.getFunctionID()) {\n+    private void setupRpcListeners() {\n+        rpcListener = new OnRPCListener() {\n+            @Override\n+            public void onReceived(RPCMessage message) {\n+                if (message != null) {\n+                    if (RPCMessage.KEY_RESPONSE.equals(message.getMessageType())) {\n+                        switch (message.getFunctionID()) {\n+                            case SET_DISPLAY_LAYOUT:\n+                                SetDisplayLayoutResponse response = (SetDisplayLayoutResponse) message;\n+                                setCapability(SystemCapabilityType.DISPLAY, response.getDisplayCapabilities());\n+                                setCapability(SystemCapabilityType.BUTTON, response.getButtonCapabilities());\n+                                setCapability(SystemCapabilityType.PRESET_BANK, response.getPresetBankCapabilities());\n+                                setCapability(SystemCapabilityType.SOFTBUTTON, response.getSoftButtonCapabilities());\n+                                if (shouldConvertDeprecatedDisplayCapabilities) {\n+                                    setCapability(SystemCapabilityType.DISPLAYS, createDisplayCapabilityList(response));\n+                                }\n+                                break;\n+                            case GET_SYSTEM_CAPABILITY:\n+                                GetSystemCapabilityResponse systemCapabilityResponse = (GetSystemCapabilityResponse) message;\n+                                SystemCapability systemCapability = systemCapabilityResponse.getSystemCapability();\n+                                if (systemCapabilityResponse.getSuccess() && SystemCapabilityType.DISPLAYS.equals(systemCapability.getSystemCapabilityType())) {\n+                                    shouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                                    List<DisplayCapability> newCapabilities = (List<DisplayCapability>) systemCapability.getCapabilityForType(SystemCapabilityType.DISPLAYS);\n+                                    updateCachedDisplayCapabilityList(newCapabilities);\n+                                }\n+                                break;\n+                        }\n+                    } else if (RPCMessage.KEY_NOTIFICATION.equals(message.getMessageType())) {\n+                        switch (message.getFunctionID()) {\n \t\t\t\t\t\t\tcase ON_HMI_STATUS:\n \t\t\t\t\t\t\t\tOnHMIStatus onHMIStatus = (OnHMIStatus) message;\n \t\t\t\t\t\t\t\tif (onHMIStatus.getWindowID() != null && onHMIStatus.getWindowID() != PredefinedWindows.DEFAULT_WINDOW.getValue()) {\n \t\t\t\t\t\t\t\t\treturn;\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\tcurrentHMILevel = onHMIStatus.getHmiLevel();\n \t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\tcase ON_SYSTEM_CAPABILITY_UPDATED:\n-\t\t\t\t\t\t\t\tOnSystemCapabilityUpdated onSystemCapabilityUpdated = (OnSystemCapabilityUpdated) message;\n-\t\t\t\t\t\t\t\tif (onSystemCapabilityUpdated.getSystemCapability() != null) {\n-\t\t\t\t\t\t\t\t\tSystemCapability systemCapability = onSystemCapabilityUpdated.getSystemCapability();\n-\t\t\t\t\t\t\t\t\tSystemCapabilityType systemCapabilityType = systemCapability.getSystemCapabilityType();\n-\t\t\t\t\t\t\t\t\tObject capability = systemCapability.getCapabilityForType(systemCapabilityType);\n-\t\t\t\t\t\t\t\t\tif (cachedSystemCapabilities.containsKey(systemCapabilityType)) { //The capability already exists\n-\t\t\t\t\t\t\t\t\t\tswitch (systemCapabilityType) {\n-\t\t\t\t\t\t\t\t\t\t\tcase APP_SERVICES:\n-\t\t\t\t\t\t\t\t\t\t\t\t// App services only updates what was changed so we need\n-\t\t\t\t\t\t\t\t\t\t\t\t// to update the capability rather than override it\n-\t\t\t\t\t\t\t\t\t\t\t\tAppServicesCapabilities appServicesCapabilities = (AppServicesCapabilities) capability;\n-\t\t\t\t\t\t\t\t\t\t\t\tif (capability != null) {\n-\t\t\t\t\t\t\t\t\t\t\t\t\tList<AppServiceCapability> appServicesCapabilitiesList = appServicesCapabilities.getAppServices();\n-\t\t\t\t\t\t\t\t\t\t\t\t\tAppServicesCapabilities cachedAppServicesCapabilities = (AppServicesCapabilities) cachedSystemCapabilities.get(systemCapabilityType);\n-\t\t\t\t\t\t\t\t\t\t\t\t\t//Update the cached app services\n-\t\t\t\t\t\t\t\t\t\t\t\t\tif (cachedAppServicesCapabilities != null) {\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\tcachedAppServicesCapabilities.updateAppServices(appServicesCapabilitiesList);\n-\t\t\t\t\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t\t\t\t\t\t//Set the new capability object to the updated cached capabilities\n-\t\t\t\t\t\t\t\t\t\t\t\t\tcapability = cachedAppServicesCapabilities;\n-\t\t\t\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\t\t\t\t\tcase DISPLAYS:\n-\t\t\t\t\t\t\t\t\t\t\t\tshouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                            case ON_SYSTEM_CAPABILITY_UPDATED:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc5Mjc0Nw=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3NDU2Nw==", "bodyText": "On line 341, the alignment of case VIDEO_STREAMING needs to be fixed. It (and all of its code) needs to be on the same level as the case above it (case DISPLAYS).\n\n@kostyaBoss I still see this issue.  On line 335, the alignment of case VIDEO_STREAMING needs to be fixed. It (and all of its code) needs to be on the same level as the case above it (case DISPLAYS).", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473374567", "createdAt": "2020-08-19T22:10:58Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java", "diffHunk": "@@ -266,81 +272,90 @@ void parseRAIResponse(RegisterAppInterfaceResponse response) {\n \t\t}\n \t}\n \n-\tprivate void setupRpcListeners() {\n-\t\trpcListener = new OnRPCListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onReceived(RPCMessage message) {\n-\t\t\t\tif (message != null) {\n-\t\t\t\t\tif (RPCMessage.KEY_RESPONSE.equals(message.getMessageType())) {\n-\t\t\t\t\t\tswitch (message.getFunctionID()) {\n-\t\t\t\t\t\t\tcase SET_DISPLAY_LAYOUT:\n-\t\t\t\t\t\t\t\tSetDisplayLayoutResponse response = (SetDisplayLayoutResponse) message;\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.DISPLAY, response.getDisplayCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.BUTTON, response.getButtonCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.PRESET_BANK, response.getPresetBankCapabilities());\n-\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.SOFTBUTTON, response.getSoftButtonCapabilities());\n-\t\t\t\t\t\t\t\tif (shouldConvertDeprecatedDisplayCapabilities) {\n-\t\t\t\t\t\t\t\t\tsetCapability(SystemCapabilityType.DISPLAYS, createDisplayCapabilityList(response));\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\tcase GET_SYSTEM_CAPABILITY:\n-\t\t\t\t\t\t\t\tGetSystemCapabilityResponse systemCapabilityResponse = (GetSystemCapabilityResponse) message;\n-\t\t\t\t\t\t\t\tSystemCapability systemCapability = systemCapabilityResponse.getSystemCapability();\n-\t\t\t\t\t\t\t\tif (systemCapabilityResponse.getSuccess() && SystemCapabilityType.DISPLAYS.equals(systemCapability.getSystemCapabilityType())) {\n-\t\t\t\t\t\t\t\t\tshouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n-\t\t\t\t\t\t\t\t\tList<DisplayCapability> newCapabilities = (List<DisplayCapability>) systemCapability.getCapabilityForType(SystemCapabilityType.DISPLAYS);\n-\t\t\t\t\t\t\t\t\tupdateCachedDisplayCapabilityList(newCapabilities);\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t}\n-\t\t\t\t\t} else if (RPCMessage.KEY_NOTIFICATION.equals(message.getMessageType())) {\n-\t\t\t\t\t\tswitch (message.getFunctionID()) {\n+    private void setupRpcListeners() {\n+        rpcListener = new OnRPCListener() {\n+            @Override\n+            public void onReceived(RPCMessage message) {\n+                if (message != null) {\n+                    if (RPCMessage.KEY_RESPONSE.equals(message.getMessageType())) {\n+                        switch (message.getFunctionID()) {\n+                            case SET_DISPLAY_LAYOUT:\n+                                SetDisplayLayoutResponse response = (SetDisplayLayoutResponse) message;\n+                                setCapability(SystemCapabilityType.DISPLAY, response.getDisplayCapabilities());\n+                                setCapability(SystemCapabilityType.BUTTON, response.getButtonCapabilities());\n+                                setCapability(SystemCapabilityType.PRESET_BANK, response.getPresetBankCapabilities());\n+                                setCapability(SystemCapabilityType.SOFTBUTTON, response.getSoftButtonCapabilities());\n+                                if (shouldConvertDeprecatedDisplayCapabilities) {\n+                                    setCapability(SystemCapabilityType.DISPLAYS, createDisplayCapabilityList(response));\n+                                }\n+                                break;\n+                            case GET_SYSTEM_CAPABILITY:\n+                                GetSystemCapabilityResponse systemCapabilityResponse = (GetSystemCapabilityResponse) message;\n+                                SystemCapability systemCapability = systemCapabilityResponse.getSystemCapability();\n+                                if (systemCapabilityResponse.getSuccess() && SystemCapabilityType.DISPLAYS.equals(systemCapability.getSystemCapabilityType())) {\n+                                    shouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                                    List<DisplayCapability> newCapabilities = (List<DisplayCapability>) systemCapability.getCapabilityForType(SystemCapabilityType.DISPLAYS);\n+                                    updateCachedDisplayCapabilityList(newCapabilities);\n+                                }\n+                                break;\n+                        }\n+                    } else if (RPCMessage.KEY_NOTIFICATION.equals(message.getMessageType())) {\n+                        switch (message.getFunctionID()) {\n \t\t\t\t\t\t\tcase ON_HMI_STATUS:\n \t\t\t\t\t\t\t\tOnHMIStatus onHMIStatus = (OnHMIStatus) message;\n \t\t\t\t\t\t\t\tif (onHMIStatus.getWindowID() != null && onHMIStatus.getWindowID() != PredefinedWindows.DEFAULT_WINDOW.getValue()) {\n \t\t\t\t\t\t\t\t\treturn;\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\tcurrentHMILevel = onHMIStatus.getHmiLevel();\n \t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\tcase ON_SYSTEM_CAPABILITY_UPDATED:\n-\t\t\t\t\t\t\t\tOnSystemCapabilityUpdated onSystemCapabilityUpdated = (OnSystemCapabilityUpdated) message;\n-\t\t\t\t\t\t\t\tif (onSystemCapabilityUpdated.getSystemCapability() != null) {\n-\t\t\t\t\t\t\t\t\tSystemCapability systemCapability = onSystemCapabilityUpdated.getSystemCapability();\n-\t\t\t\t\t\t\t\t\tSystemCapabilityType systemCapabilityType = systemCapability.getSystemCapabilityType();\n-\t\t\t\t\t\t\t\t\tObject capability = systemCapability.getCapabilityForType(systemCapabilityType);\n-\t\t\t\t\t\t\t\t\tif (cachedSystemCapabilities.containsKey(systemCapabilityType)) { //The capability already exists\n-\t\t\t\t\t\t\t\t\t\tswitch (systemCapabilityType) {\n-\t\t\t\t\t\t\t\t\t\t\tcase APP_SERVICES:\n-\t\t\t\t\t\t\t\t\t\t\t\t// App services only updates what was changed so we need\n-\t\t\t\t\t\t\t\t\t\t\t\t// to update the capability rather than override it\n-\t\t\t\t\t\t\t\t\t\t\t\tAppServicesCapabilities appServicesCapabilities = (AppServicesCapabilities) capability;\n-\t\t\t\t\t\t\t\t\t\t\t\tif (capability != null) {\n-\t\t\t\t\t\t\t\t\t\t\t\t\tList<AppServiceCapability> appServicesCapabilitiesList = appServicesCapabilities.getAppServices();\n-\t\t\t\t\t\t\t\t\t\t\t\t\tAppServicesCapabilities cachedAppServicesCapabilities = (AppServicesCapabilities) cachedSystemCapabilities.get(systemCapabilityType);\n-\t\t\t\t\t\t\t\t\t\t\t\t\t//Update the cached app services\n-\t\t\t\t\t\t\t\t\t\t\t\t\tif (cachedAppServicesCapabilities != null) {\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\tcachedAppServicesCapabilities.updateAppServices(appServicesCapabilitiesList);\n-\t\t\t\t\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t\t\t\t\t\t//Set the new capability object to the updated cached capabilities\n-\t\t\t\t\t\t\t\t\t\t\t\t\tcapability = cachedAppServicesCapabilities;\n-\t\t\t\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\t\t\t\t\tcase DISPLAYS:\n-\t\t\t\t\t\t\t\t\t\t\t\tshouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                            case ON_SYSTEM_CAPABILITY_UPDATED:\n+                                OnSystemCapabilityUpdated onSystemCapabilityUpdated = (OnSystemCapabilityUpdated) message;\n+                                if (onSystemCapabilityUpdated.getSystemCapability() != null) {\n+                                    SystemCapability systemCapability = onSystemCapabilityUpdated.getSystemCapability();\n+                                    SystemCapabilityType systemCapabilityType = systemCapability.getSystemCapabilityType();\n+                                    Object capability = systemCapability.getCapabilityForType(systemCapabilityType);\n+                                    if (cachedSystemCapabilities.containsKey(systemCapabilityType)) { //The capability already exists\n+                                        switch (systemCapabilityType) {\n+                                            case APP_SERVICES:\n+                                                // App services only updates what was changed so we need\n+                                                // to update the capability rather than override it\n+                                                AppServicesCapabilities appServicesCapabilities = (AppServicesCapabilities) capability;\n+                                                if (capability != null) {\n+                                                    List<AppServiceCapability> appServicesCapabilitiesList = appServicesCapabilities.getAppServices();\n+                                                    AppServicesCapabilities cachedAppServicesCapabilities = (AppServicesCapabilities) cachedSystemCapabilities.get(systemCapabilityType);\n+                                                    //Update the cached app services\n+                                                    if (cachedAppServicesCapabilities != null) {\n+                                                    \tcachedAppServicesCapabilities.updateAppServices(appServicesCapabilitiesList);\n+                                                    }\n+                                                    //Set the new capability object to the updated cached capabilities\n+                                                    capability = cachedAppServicesCapabilities;\n+                                                }\n+                                                break;\n+                                            case DISPLAYS:\n+                                                shouldConvertDeprecatedDisplayCapabilities = false; // Successfully got DISPLAYS data. No conversion needed anymore\n+                                                // this notification can return only affected windows (hence not all windows)\n+                                                List<DisplayCapability> newCapabilities = (List<DisplayCapability>) capability;\n+                                                updateCachedDisplayCapabilityList(newCapabilities);\n+                                                systemCapabilitiesSubscriptionStatus.put(SystemCapabilityType.DISPLAYS, true);\n+                                                break;\n+\t\t\t\t\t\t\t\t\t\t\tcase VIDEO_STREAMING:", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc5NTQ0Mg=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 151}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3NTI3Nw==", "bodyText": "Based on the mobile_API.xml, this file should have the /** @since 7.0 */ annotation.\n\n@kostyaBoss I dont see the annotation /** @since 7.0 */ at the top. Can you please add it whenever you get the chance?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473375277", "createdAt": "2020-08-19T22:11:54Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,50 @@\n+package com.smartdevicelink.proxy.rpc;\n+\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjU1MTE5MQ=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3NjE1NQ==", "bodyText": "VideoStreamingCapability capability is not mandatory, so you do not need to initialize it in this constructor.\n\n@kostyaBoss I still see VideoStreamingCapability capability being passed into the constructor on line 29.  You don't need it, since it is not a mandatory field.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473376155", "createdAt": "2020-08-19T22:13:02Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,49 @@\n+package com.smartdevicelink.proxy.rpc;\n+\n+import android.support.annotation.NonNull;\n+\n+import com.smartdevicelink.proxy.RPCStruct;\n+import com.smartdevicelink.proxy.rpc.enums.AppCapabilityType;\n+\n+import java.util.Hashtable;\n+\n+public class AppCapability extends RPCStruct {\n+    public static final String KEY_APP_CAPABILITY_TYPE = \"appCapabilityType\";\n+    public static final String KEY_VIDEO_STREAMING_CAPABILITY = \"videoStreamingCapability\";\n+\n+    public AppCapability() {\n+    }\n+\n+    /**\n+     * Constructs a new AppCapability object indicated by the Hashtable\n+     * parameter\n+     *\n+     * @param hash hashtable filled with params to create an instance of this RPC\n+     *             The hash table to use\n+     */\n+    public AppCapability(Hashtable<String, Object> hash) {\n+        super(hash);\n+    }\n+\n+    public AppCapability(@NonNull VideoStreamingCapability capability, AppCapabilityType appCapabilityType) {\n+        this();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTkzNDAxOQ=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3NjU2NA==", "bodyText": "This looks good,but the unit tests in VideoStreamingCapabilityTests.java need to be updated to include the new parameter additionalVideoStreamingCapabilities.\n\n@kostyaBoss I still see this issue.  In VideoStreamingCapabilityTests.java you need to update the unit tests to include the new parameter additionalVideoStreamingCapabilities.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473376564", "createdAt": "2020-08-19T22:13:32Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -49,6 +50,7 @@\n \tpublic static final String KEY_DIAGONAL_SCREEN_SIZE = \"diagonalScreenSize\";\n \tpublic static final String KEY_PIXEL_PER_INCH = \"pixelPerInch\";\n \tpublic static final String KEY_SCALE = \"scale\";\n+\tpublic static final String KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES = \"additionalVideoStreamingCapabilities\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk0MDE3Ng=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3NjgxNA==", "bodyText": "Based on the mobile_API.xml, the new parameter on line 53 needs the /** @since 7.0 */ annotation.\n\n@kostyaBoss I still see this issue.  The parameter KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES should have the /** @since 7.0 */ annotation.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473376814", "createdAt": "2020-08-19T22:13:52Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -49,6 +50,7 @@\n \tpublic static final String KEY_DIAGONAL_SCREEN_SIZE = \"diagonalScreenSize\";\n \tpublic static final String KEY_PIXEL_PER_INCH = \"pixelPerInch\";\n \tpublic static final String KEY_SCALE = \"scale\";\n+\tpublic static final String KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES = \"additionalVideoStreamingCapabilities\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk0MDE3Ng=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzM3NzUyMg==", "bodyText": "Does VideoStreamingParametersTest.java need to be updated to include tests for the new parameter List<VideoStreamingCapability> additionalCapabilities?\n\n@kostyaBoss I still see this issue.  Does VideoStreamingParametersTest.java need to be updated to include tests for the new parameter List<VideoStreamingCapability> additionalCapabilities?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r473377522", "createdAt": "2020-08-19T22:14:47Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -61,8 +64,11 @@\n \tprivate int frameRate;\n \tprivate int bitrate;\n \tprivate int interval;\n+\tprivate double preferredDiagonal;\n+\tprivate double scale = DEFAULT_SCALE;\n \tprivate ImageResolution resolution;\n \tprivate VideoStreamingFormat format;\n+\tprivate List<VideoStreamingCapability> additionalCapabilities = new ArrayList<>(1);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk0NTQ2OQ=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e2814610b5026f05f639ff18f34df499908a5db6", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e2814610b5026f05f639ff18f34df499908a5db6", "committedDate": "2020-08-20T10:17:13Z", "message": "Merge remote-tracking branch 'origin/feature/0296_possibility_to_update_video_streaming_capabilities' into feature/0296_possibility_to_update_video_streaming_capabilities"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "79e44f2840619e41d9bf97f8142eddd369a2a419", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/79e44f2840619e41d9bf97f8142eddd369a2a419", "committedDate": "2020-08-20T21:37:15Z", "message": "[0296]\n     - Remove unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "332f8e66c741bb5ab0430febb40d8c706050dec0", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/332f8e66c741bb5ab0430febb40d8c706050dec0", "committedDate": "2020-08-20T21:54:07Z", "message": "[VideoStreaming]\n     - Fix multiple review comments, refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e100f13cdfc8b54cc57e31398dda2204e380c4e0", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/e100f13cdfc8b54cc57e31398dda2204e380c4e0", "committedDate": "2020-08-20T22:07:13Z", "message": "[VideoStreaming]\n     - Fix multiple review comments, refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e5b627c96376d480771ebfd6952ed77bed9c6c4", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/0e5b627c96376d480771ebfd6952ed77bed9c6c4", "committedDate": "2020-08-20T22:19:42Z", "message": "[VideoStreaming]\n     - Fix multiple review comments, refactor code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "66cc5e9da7fc040c0c67ee9cbac46dd1c68ad488", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/66cc5e9da7fc040c0c67ee9cbac46dd1c68ad488", "committedDate": "2020-08-20T22:22:10Z", "message": "[VideoStreaming]\n     - Simplify Logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "81bc8ee7231d44b1bdba740005706e8c280d8bf6", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/81bc8ee7231d44b1bdba740005706e8c280d8bf6", "committedDate": "2020-08-20T23:04:32Z", "message": "[VideoStreaming]\n     - Add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2df898e309f66e6889d25e112cbc073dbad9b4a3", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/2df898e309f66e6889d25e112cbc073dbad9b4a3", "committedDate": "2020-08-21T08:52:29Z", "message": "[VideoStreaming]\n     - Align VideoStreamManager.java according to the proposal's flow"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/09efe463a0068e98e98580c794c2710313dcfa46", "committedDate": "2020-08-21T09:02:39Z", "message": "[VideoStreaming]\n     - Add test for AdditionalCapability"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNjE1NTAw", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-472615500", "createdAt": "2020-08-21T16:08:19Z", "commit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQxNjowODoxOVrOHEzAPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMVQyMzoxODo0NlrOHFAJ0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDc5MTk5Nw==", "bodyText": "@kostyaBoss Could you also bring back the methods and code for setVoiceCommands();, sendMenus();, performWelcomeSpeak();,  performWelcomeShow();, preloadChoices(); , subscribeToButtons();?  You can leave it commented out, but it can be there for reference.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474791997", "createdAt": "2020-08-21T16:08:19Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -166,31 +221,43 @@ private void startProxy() {\n \n \t\t\t// The app type to be used\n \t\t\tVector<AppHMIType> appType = new Vector<>();\n-\t\t\tappType.add(AppHMIType.DEFAULT);\n+\t\t\tappType.add(AppHMIType.NAVIGATION);\n \n \t\t\t// The manager listener helps you know when certain events that pertain to the SDL Manager happen\n \t\t\t// Here we will listen for ON_HMI_STATUS and ON_COMMAND notifications\n \t\t\tSdlManagerListener listener = new SdlManagerListener() {\n \t\t\t\t@Override\n \t\t\t\tpublic void onStart() {\n-\t\t\t\t\t// HMI Status Listener\n-\t\t\t\t\tsdlManager.addOnRPCNotificationListener(FunctionID.ON_HMI_STATUS, new OnRPCNotificationListener() {\n-\t\t\t\t\t\t@Override\n-\t\t\t\t\t\tpublic void onNotified(RPCNotification notification) {\n-\t\t\t\t\t\t\tOnHMIStatus onHMIStatus = (OnHMIStatus)notification;\n-\t\t\t\t\t\t\tif (onHMIStatus.getWindowID() != null && onHMIStatus.getWindowID() != PredefinedWindows.DEFAULT_WINDOW.getValue()) {\n-\t\t\t\t\t\t\t\treturn;\n-\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\tif (onHMIStatus.getHmiLevel() == HMILevel.HMI_FULL && onHMIStatus.getFirstRun()) {\n-\t\t\t\t\t\t\t\tsetVoiceCommands();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjcxOTU2MA=="}, "originalCommit": {"oid": "e64d5879fa5d471514ebea3c6d07fb6082562cd9"}, "originalPosition": 167}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgwNjA4Ng==", "bodyText": "@kostyaBoss I still see this issue.  For all of the strings here (\"Start Proxy\", \"Start streaming\", \"Start Streaming ui\", \"Exit Application\", \"Width of remote display in px\", \"Height of remote display in px\", etc.) can you export these to strings.xml?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474806086", "createdAt": "2020-08-21T16:36:00Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/res/layout/activity_main.xml", "diffHunk": "@@ -1,16 +1,81 @@\n <RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n-    xmlns:tools=\"http://schemas.android.com/tools\"\n-    android:layout_width=\"match_parent\"\n-    android:layout_height=\"match_parent\"\n-    android:paddingBottom=\"@dimen/activity_vertical_margin\"\n-    android:paddingLeft=\"@dimen/activity_horizontal_margin\"\n-    android:paddingRight=\"@dimen/activity_horizontal_margin\"\n-    android:paddingTop=\"@dimen/activity_vertical_margin\"\n-    tools:context=\"com.sdl.hellosdlandroid.MainActivity\" >\n+    android:layout_width=\"wrap_content\"\n+    android:layout_height=\"match_parent\">\n \n     <TextView", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk1NzI0Mg=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgxNTI3NA==", "bodyText": "@kostyaBoss On line 314, can you rename privateStringField to sdlRemoteDisplayField?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474815274", "createdAt": "2020-08-21T16:54:49Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamManagerTests.java", "diffHunk": "@@ -268,16 +275,60 @@ public void onComplete(boolean success) {\n \t\t\t\thmiListener[0].onNotified(fullNotification);\n \n \t\t\t\tvideoStreamManager.startRemoteDisplayStream(mTestContext, TestPresentation.class, null, false);\n-\n \t\t\t\t//assertTrue(touchEventOccured);\n \n-\t\t\t\tvideoStreamManager.dispose();\n \t\t\t\tassertTrue(listenerSet.isEmpty());\n \t\t\t}\n \t\t});\n \n \t}\n \n+\t@Test\n+\tpublic void testOnViewResized() {\n+\t\tISdl internalInterface = mock(ISdl.class);\n+\n+\t\tfinal OnRPCNotificationListener[] hmiListener = {null};\n+\n+\t\tAnswer<Void> onAddHMIListener = new Answer<Void>() {\n+\t\t\t@Override\n+\t\t\tpublic Void answer(InvocationOnMock invocation) {\n+\t\t\t\tObject[] args = invocation.getArguments();\n+\t\t\t\thmiListener[0] = (OnRPCNotificationListener) args[1];\n+\t\t\t\treturn null;\n+\t\t\t}\n+\t\t};\n+\n+\t\tdoAnswer(onAddHMIListener).when(internalInterface).addOnRPCNotificationListener(eq(FunctionID.ON_HMI_STATUS), any(OnRPCNotificationListener.class));\n+\n+\t\tfinal VideoStreamManager videoStreamManager = new VideoStreamManager(internalInterface);\n+\t\tvideoStreamManager.start(new CompletionListener() {\n+\t\t\t@Override\n+\t\t\tpublic void onComplete(boolean success) {\n+\t\t\t\tassertTrue(success);\n+\t\t\t\tOnHMIStatus fullNotification = new OnHMIStatus();\n+\t\t\t\tfullNotification.setHmiLevel(HMILevel.HMI_FULL);\n+\t\t\t\thmiListener[0].onNotified(fullNotification);\n+\n+\t\t\t\tvideoStreamManager.startRemoteDisplayStream(mTestContext, TestPresentation.class, null, false);\n+\n+\t\t\t\tField privateStringField = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 70}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgyMjM0OQ==", "bodyText": "On line 66, the variable scale is defined at the class level.  However, here on line 201, it is defined again locally.  I assume you want the class level variable.\nI think you don't need to redefine it.  On line 201, you can change double scale = DEFAULT_SCALE; to scale = DEFAULT_SCALE;", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474822349", "createdAt": "2020-08-21T17:09:34Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java", "diffHunk": "@@ -184,6 +200,7 @@ public void update(VideoStreamingCapability capability){\n         if(capability.getMaxBitrate()!=null){ this.bitrate = capability.getMaxBitrate() * 1000; } // NOTE: the unit of maxBitrate in getSystemCapability is kbps.\n         double scale = DEFAULT_SCALE;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgyMzQ2Mw==", "bodyText": "@kostyaBoss On line 37, you can remove the unused import.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474823463", "createdAt": "2020-08-21T17:11:47Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -34,6 +34,7 @@\n import com.smartdevicelink.proxy.RPCStruct;\n import com.smartdevicelink.util.SdlDataTypeConverter;\n \n+import java.util.ArrayList;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgyODM3NQ==", "bodyText": "@kostyaBoss On line 162, I don't see setAspectRatio defined in VideoStreamingRange.java.  Does this call need to be changed to setMinAspectRatio or setMaxAspectRatio?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474828375", "createdAt": "2020-08-21T17:21:50Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -133,7 +143,35 @@ public void onDestroy() {\n \t\tsuper.onDestroy();\n \t}\n \n-\tprivate void startProxy() {\n+\tprivate void startStreaming(final MainActivity.STREAM_ENUM value) {\n+\t\tif (sdlManager.getVideoStreamManager() != null) {\n+\t\t\tsdlManager.getVideoStreamManager().start(new CompletionListener() {\n+\t\t\t\t@Override\n+\t\t\t\tpublic void onComplete(boolean success) {\n+\t\t\t\t\tif (success) {\n+\t\t\t\t\t\tClass myClass;\n+\t\t\t\t\t\tif (value.equals(MainActivity.STREAM_ENUM.START_STREAMING)) {\n+\t\t\t\t\t\t\tmyClass = MyDisplay.class;\n+\t\t\t\t\t\t} else {\n+\t\t\t\t\t\t\tmyClass = UIStreamingDisplay.class;\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\tVideoStreamingRange.Builder builder = new VideoStreamingRange.Builder();\n+\t\t\t\t\t\tbuilder\n+\t\t\t\t\t\t\t\t.setMaxSupportedResolution(new Resolution(800, 480))\n+\t\t\t\t\t\t\t\t.setMinSupportedResolution(new Resolution(400, 200))\n+\t\t\t\t\t\t\t\t.setAspectRatio(new AspectRatio(1., 6.))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 128}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgzNTA4MA==", "bodyText": "@kostyaBoss On line 19 I would change the name to @+id\\textView_top_left_counter.\nSo it would be android:id=\"@+id/textView_top_left_counter\"", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474835080", "createdAt": "2020-08-21T17:35:45Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/res/layout/ui_streaming_layout.xml", "diffHunk": "@@ -0,0 +1,48 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_marginLeft=\"@dimen/margin_default\"\n+    android:layout_marginTop=\"@dimen/margin_default\"\n+    android:layout_marginRight=\"@dimen/margin_default\"\n+    android:layout_marginBottom=\"@dimen/margin_default\"\n+    android:orientation=\"vertical\"\n+    android:layout_height=\"match_parent\">\n+\n+    <Button\n+        android:id=\"@+id/button_top_left\"\n+        android:layout_width=\"wrap_content\"\n+        android:layout_height=\"wrap_content\"\n+        android:text=\"@string/button_top_left\" />\n+\n+    <TextView\n+        android:layout_below=\"@id/button_top_left\"\n+        android:id=\"@+id/button_top_left_counter\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgzODA1OA==", "bodyText": "@kostyaBoss On line 38 I would rename button_bottom_right_counter to textView_bottom_right_counter.\nSo line 38 would become android:id=\"@+id/textView_bottom_right_counter\".", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474838058", "createdAt": "2020-08-21T17:42:03Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/res/layout/ui_streaming_layout.xml", "diffHunk": "@@ -0,0 +1,48 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_marginLeft=\"@dimen/margin_default\"\n+    android:layout_marginTop=\"@dimen/margin_default\"\n+    android:layout_marginRight=\"@dimen/margin_default\"\n+    android:layout_marginBottom=\"@dimen/margin_default\"\n+    android:orientation=\"vertical\"\n+    android:layout_height=\"match_parent\">\n+\n+    <Button\n+        android:id=\"@+id/button_top_left\"\n+        android:layout_width=\"wrap_content\"\n+        android:layout_height=\"wrap_content\"\n+        android:text=\"@string/button_top_left\" />\n+\n+    <TextView\n+        android:layout_below=\"@id/button_top_left\"\n+        android:id=\"@+id/button_top_left_counter\"\n+        android:layout_width=\"wrap_content\"\n+        android:layout_height=\"wrap_content\"\n+        android:lines=\"5\"\n+        android:maxLines=\"5\"\n+        android:scrollbars=\"vertical\"\n+        android:text=\"@string/counter_1\" />\n+\n+    <Button\n+        android:layout_alignParentBottom=\"true\"\n+        android:layout_alignParentRight=\"true\"\n+        android:layout_alignParentEnd=\"true\"\n+        android:id=\"@+id/button_bottom_right\"\n+        android:layout_width=\"wrap_content\"\n+        android:layout_height=\"wrap_content\"\n+        android:layout_gravity=\"bottom|end\"\n+        android:text=\"@string/button_bottom_right\" />\n+\n+    <TextView\n+        android:id=\"@+id/button_bottom_right_counter\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg0NDE4MQ==", "bodyText": "@kostyaBoss On lines 325-328, can you rename the variables to match with your layout file names?\nSo button1 can be renamed to buttonTopLeft, button2 can be renamed to buttonBottomRight, counter1 can be renamed to textViewTopLeftCounter, and counter2 can be renamed to textViewBottomRightCounter.\nIt would look like this:\nfinal Button buttonTopLeft = findViewById(R.id.button_top_left);\nfinal Button buttonBottomRight = findViewById(R.id.button_bottom_right);\nfinal TextView textViewTopLeftCounter = findViewById(R.id.textView_top_left_counter);\nfinal TextView textViewBottomRightCounter = findViewById(R.id.textView_bottom_right_counter);", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474844181", "createdAt": "2020-08-21T17:54:48Z", "author": {"login": "santhanamk"}, "path": "android/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java", "diffHunk": "@@ -247,207 +285,118 @@ public LifecycleConfigurationUpdate managerShouldUpdateLifecycle(Language langua\n \t\t\t// Create App Icon, this is set in the SdlManager builder\n \t\t\tSdlArtwork appIcon = new SdlArtwork(ICON_FILENAME, FileType.GRAPHIC_PNG, R.mipmap.ic_launcher, true);\n \n+\t\t\tonRPCNotificationListenerMap.put(FunctionID.ON_HMI_STATUS, new OnRPCNotificationListener() {\n+\t\t\t\t@Override\n+\t\t\t\tpublic void onNotified(RPCNotification notification) {\n+\t\t\t\t\tOnHMIStatus status = (OnHMIStatus) notification;\n+\t\t\t\t\tif (status != null && status.getHmiLevel() == HMILevel.HMI_NONE) {\n+\t\t\t\t\t\t//Stop the stream\n+\t\t\t\t\t\tif (sdlManager.getVideoStreamManager() != null && sdlManager.getVideoStreamManager().isStreaming()) {\n+\t\t\t\t\t\t\tLog.d(\"OnHmiStatus\", \"stop streaming\");\n+\t\t\t\t\t\t\tsdlManager.getVideoStreamManager().stopStreaming(false);\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t});\n \t\t\t// The manager builder sets options for your session\n \t\t\tSdlManager.Builder builder = new SdlManager.Builder(this, APP_ID, APP_NAME, listener);\n \t\t\tbuilder.setAppTypes(appType);\n \t\t\tbuilder.setTransportType(transport);\n \t\t\tbuilder.setAppIcon(appIcon);\n+\t\t\tbuilder.setRPCNotificationListeners(onRPCNotificationListenerMap);\n \t\t\tsdlManager = builder.build();\n \t\t\tsdlManager.start();\n \t\t}\n \t}\n \n-\t/**\n-\t * Send some voice commands\n-\t */\n-\tprivate void setVoiceCommands(){\n-\n-\t\tList<String> list1 = Collections.singletonList(\"Command One\");\n-\t\tList<String> list2 = Collections.singletonList(\"Command two\");\n-\n-\t\tVoiceCommand voiceCommand1 = new VoiceCommand(list1, new VoiceCommandSelectionListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onVoiceCommandSelected() {\n-\t\t\t\tLog.i(TAG, \"Voice Command 1 triggered\");\n-\t\t\t}\n-\t\t});\n-\n-\t\tVoiceCommand voiceCommand2 = new VoiceCommand(list2, new VoiceCommandSelectionListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onVoiceCommandSelected() {\n-\t\t\t\tLog.i(TAG, \"Voice Command 2 triggered\");\n-\t\t\t}\n-\t\t});\n-\n-\t\tsdlManager.getScreenManager().setVoiceCommands(Arrays.asList(voiceCommand1,voiceCommand2));\n-\t}\n-\n-\t/**\n-\t *  Add menus for the app on SDL.\n-\t */\n-\tprivate void sendMenus(){\n-\n-\t\t// some arts\n-\t\tSdlArtwork livio = new SdlArtwork(\"livio\", FileType.GRAPHIC_PNG, R.drawable.sdl, false);\n-\n-\t\t// some voice commands\n-\t\tList<String> voice2 = Collections.singletonList(\"Cell two\");\n-\n-\t\tMenuCell mainCell1 = new MenuCell(\"Test Cell 1 (speak)\", livio, null, new MenuSelectionListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onTriggered(TriggerSource trigger) {\n-\t\t\t\tLog.i(TAG, \"Test cell 1 triggered. Source: \"+ trigger.toString());\n-\t\t\t\tshowTest();\n-\t\t\t}\n-\t\t});\n-\n-\t\tMenuCell mainCell2 = new MenuCell(\"Test Cell 2\", null, voice2, new MenuSelectionListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onTriggered(TriggerSource trigger) {\n-\t\t\t\tLog.i(TAG, \"Test cell 2 triggered. Source: \"+ trigger.toString());\n-\t\t\t}\n-\t\t});\n-\n-\t\t// SUB MENU\n-\n-\t\tMenuCell subCell1 = new MenuCell(\"SubCell 1\",null, null, new MenuSelectionListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onTriggered(TriggerSource trigger) {\n-\t\t\t\tLog.i(TAG, \"Sub cell 1 triggered. Source: \"+ trigger.toString());\n-\t\t\t}\n-\t\t});\n-\n-\t\tMenuCell subCell2 = new MenuCell(\"SubCell 2\",null, null, new MenuSelectionListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onTriggered(TriggerSource trigger) {\n-\t\t\t\tLog.i(TAG, \"Sub cell 2 triggered. Source: \"+ trigger.toString());\n-\t\t\t}\n-\t\t});\n-\n-\t\t// sub menu parent cell\n-\t\tMenuCell mainCell3 = new MenuCell(\"Test Cell 3 (sub menu)\", MenuLayout.LIST, null, Arrays.asList(subCell1,subCell2));\n-\n-\t\tMenuCell mainCell4 = new MenuCell(\"Show Perform Interaction\", null, null, new MenuSelectionListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onTriggered(TriggerSource trigger) {\n-\t\t\t\tshowPerformInteraction();\n-\t\t\t}\n-\t\t});\n-\n-\t\tMenuCell mainCell5 = new MenuCell(\"Clear the menu\",null, null, new MenuSelectionListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onTriggered(TriggerSource trigger) {\n-\t\t\t\tLog.i(TAG, \"Clearing Menu. Source: \"+ trigger.toString());\n-\t\t\t\t// Clear this thing\n-\t\t\t\tsdlManager.getScreenManager().setMenu(Collections.<MenuCell>emptyList());\n-\t\t\t\tshowAlert(\"Menu Cleared\");\n-\t\t\t}\n-\t\t});\n+\tpublic static class UIStreamingDisplay extends SdlRemoteDisplay {\n+\t\tint clickCounter1 = 0;\n+\t\tint clickCounter2 = 0;\n+\t\tpublic UIStreamingDisplay(Context context, Display display) {\n+\t\t\tsuper(context, display);\n+\t\t}\n \n-\t\t// Send the entire menu off to be created\n-\t\tsdlManager.getScreenManager().setMenu(Arrays.asList(mainCell1, mainCell2, mainCell3, mainCell4, mainCell5));\n-\t}\n+\t\t@Override\n+\t\tprotected void onCreate(Bundle savedInstanceState) {\n+\t\t\tsuper.onCreate(savedInstanceState);\n+\t\t\tsetContentView(R.layout.ui_streaming_layout);\n \n-\t/**\n-\t * Will speak a sample welcome message\n-\t */\n-\tprivate void performWelcomeSpeak(){\n-\t\tsdlManager.sendRPC(new Speak(TTSChunkFactory.createSimpleTTSChunks(WELCOME_SPEAK)));\n-\t}\n \n-\t/**\n-\t * Use the Screen Manager to set the initial screen text and set the image.\n-\t * Because we are setting multiple items, we will call beginTransaction() first,\n-\t * and finish with commit() when we are done.\n-\t */\n-\tprivate void performWelcomeShow() {\n-\t\tsdlManager.getScreenManager().beginTransaction();\n-\t\tsdlManager.getScreenManager().setTextField1(APP_NAME);\n-\t\tsdlManager.getScreenManager().setTextField2(WELCOME_SHOW);\n-\t\tsdlManager.getScreenManager().setPrimaryGraphic(new SdlArtwork(SDL_IMAGE_FILENAME, FileType.GRAPHIC_PNG, R.drawable.sdl, true));\n-\t\tsdlManager.getScreenManager().commit(new CompletionListener() {\n-\t\t\t@Override\n-\t\t\tpublic void onComplete(boolean success) {\n-\t\t\t\tif (success){\n-\t\t\t\t\tLog.i(TAG, \"welcome show successful\");\n+\t\t\tfinal Button button1 = findViewById(R.id.button_top_left);\n+\t\t\tfinal Button button2 = findViewById(R.id.button_bottom_right);\n+\t\t\tfinal TextView counter1 = findViewById(R.id.button_top_left_counter);\n+\t\t\tfinal TextView counter2 = findViewById(R.id.button_bottom_right_counter);\n+            button1.setOnTouchListener(new View.OnTouchListener() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 358}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg0ODQxNQ==", "bodyText": "@kostyaBoss On lines 71 and 72, can you rename these variables using camel case format?\nSo it would become:\nprivate int predefinedWidth = 1920;\nprivate int predefinedHeight = 1080;", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474848415", "createdAt": "2020-08-21T18:03:35Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/encoder/VirtualDisplayEncoder.java", "diffHunk": "@@ -66,6 +68,9 @@\n     private Boolean initPassed = false;\n     private final Object STREAMING_LOCK = new Object();\n \n+    private int predefined_width = 1920;\n+    private int predefined_height = 1080;\n+\n     // Codec-specific data (SPS and PPS)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDg0OTE3MA==", "bodyText": "@kostyaBoss You can remove the unused import on line 48.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474849170", "createdAt": "2020-08-21T18:05:13Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -45,20 +45,26 @@\n import com.smartdevicelink.managers.BaseSubManager;\n import com.smartdevicelink.managers.CompletionListener;\n import com.smartdevicelink.managers.StreamingStateMachine;\n+import com.smartdevicelink.managers.video.resolution.AspectRatio;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDk5MDIxMA==", "bodyText": "@kostyaBoss I see that you have the AspectRatio class defined which has minAspectRatio and maxAspectRatio.\nYou can replace Double minAspectRatio and Double maxAspectRatio with the AspectRatio class.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474990210", "createdAt": "2020-08-21T22:07:41Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/resolution/VideoStreamingRange.java", "diffHunk": "@@ -0,0 +1,76 @@\n+package com.smartdevicelink.managers.video.resolution;\n+\n+public class VideoStreamingRange {\n+    private Resolution minResolution;\n+    private Resolution maxResolution;\n+    private Double minScreenDiagonal;\n+    private Double minAspectRatio;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDk5Nzg2Ng==", "bodyText": "This looks good,but the unit tests in VideoStreamingCapabilityTests.java need to be updated to include the new parameter additionalVideoStreamingCapabilities.\n\n@kostyaBoss I still see this issue. In VideoStreamingCapabilityTests.java you need to update the unit tests to include the new parameter additionalVideoStreamingCapabilities.\n\n@kostyaBoss I still see this issue.  In VideoStreamingCapabilityTests.java you need to update the unit tests to include the new parameter additionalVideoStreamingCapabilities.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r474997866", "createdAt": "2020-08-21T22:36:33Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -49,6 +50,7 @@\n \tpublic static final String KEY_DIAGONAL_SCREEN_SIZE = \"diagonalScreenSize\";\n \tpublic static final String KEY_PIXEL_PER_INCH = \"pixelPerInch\";\n \tpublic static final String KEY_SCALE = \"scale\";\n+\tpublic static final String KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES = \"additionalVideoStreamingCapabilities\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk0MDE3Ng=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAwMDgzMg==", "bodyText": "You can remove the touchEventOccured variable on line 72.  You assign it later on line 104, but it is not being used.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r475000832", "createdAt": "2020-08-21T22:48:41Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamManagerTests.java", "diffHunk": "@@ -69,6 +70,7 @@\n \tpublic static final String TAG = \"VideoStreamManagerTests\";\n \tprivate Context mTestContext;\n \tprivate static boolean touchEventOccured = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAwMjA3OA==", "bodyText": "@kostyaBoss you can change ...setDiagonalScreenSize(6.); to ...setDiagonalScreenSize(GENERAL_DOUBLE);", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r475002078", "createdAt": "2020-08-21T22:53:59Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -897,11 +903,23 @@ public void onVoiceCommandSelected() {\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setDiagonalScreenSize(4.);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setScale(1.);\n+\n+\t\tGENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setMaxBitrate(GENERAL_INT);\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setSupportedFormats(GENERAL_VIDEOSTREAMINGFORMAT_LIST);\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setIsHapticSpatialDataSupported(GENERAL_BOOLEAN);\n \n+\t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setDiagonalScreenSize(6.);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAwMjQyMw==", "bodyText": "@kostyaBoss you can change ...setPixelPerInch(29.); to ...setPixelPerInch(GENERAL_DOUBLE);", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r475002423", "createdAt": "2020-08-21T22:55:23Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -897,11 +903,23 @@ public void onVoiceCommandSelected() {\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setDiagonalScreenSize(4.);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setScale(1.);\n+\n+\t\tGENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setMaxBitrate(GENERAL_INT);\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setSupportedFormats(GENERAL_VIDEOSTREAMINGFORMAT_LIST);\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setIsHapticSpatialDataSupported(GENERAL_BOOLEAN);\n \n+\t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setDiagonalScreenSize(6.);\n+\t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setPixelPerInch(29.);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAwMjgyMw==", "bodyText": "@kostyaBoss you can change ...setScale(1.); to ...setScale(GENERAL_DOUBLE);", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r475002823", "createdAt": "2020-08-21T22:57:06Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -897,11 +903,23 @@ public void onVoiceCommandSelected() {\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setDiagonalScreenSize(4.);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setScale(1.);\n+\n+\t\tGENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setMaxBitrate(GENERAL_INT);\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setSupportedFormats(GENERAL_VIDEOSTREAMINGFORMAT_LIST);\n \t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setIsHapticSpatialDataSupported(GENERAL_BOOLEAN);\n \n+\t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setDiagonalScreenSize(6.);\n+\t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setPixelPerInch(29.);\n+\t\tGENERAL_VIDEOSTREAMINGCAPABILITY.setScale(1.);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAwMzU1NA==", "bodyText": "@kostyaBoss you can change ...setDiagonalScreenSize(4.); to ...setDiagonalScreenSize(GENERAL_DOUBLE);", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r475003554", "createdAt": "2020-08-21T23:00:22Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -897,11 +903,23 @@ public void onVoiceCommandSelected() {\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setDiagonalScreenSize(4.);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAwMzc4NQ==", "bodyText": "@kostyaBoss you can change ...setScale(1.); to ...setScale(GENERAL_DOUBLE);", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r475003785", "createdAt": "2020-08-21T23:01:30Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -897,11 +903,23 @@ public void onVoiceCommandSelected() {\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setDiagonalScreenSize(4.);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setScale(1.);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAwNjg1NQ==", "bodyText": "@kostyaBoss You can replace lines 749-750 with your AspectRatio object.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r475006855", "createdAt": "2020-08-21T23:15:48Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -603,6 +734,109 @@ void createTouchScalar(ImageResolution resolution, DisplayMetrics displayMetrics\n \t\treturn motionEventList;\n \t}\n \n+\tpublic VideoStreamingParameters getLastCachedStreamingParameters() {\n+\t\treturn parameters;\n+\t}\n+\n+\tpublic boolean getLastCachedIsEncrypted() {\n+\t\treturn isEncrypted;\n+\t}\n+\n+\tprivate List<VideoStreamingCapability> getSupportedCapabilities(\n+\t\t\tResolution minResolution,\n+\t\t\tResolution maxResolution,\n+\t\t\tDouble minScreenDiagonal,\n+\t\t\tDouble minAspectRatio,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 413}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTAwNzQ0Mw==", "bodyText": "@kostyaBoss On line 12 you can replace @since 7.0 with @since SmartDeviceLink 7.0", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r475007443", "createdAt": "2020-08-21T23:18:46Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/AppCapability.java", "diffHunk": "@@ -0,0 +1,53 @@\n+package com.smartdevicelink.proxy.rpc;\n+\n+\n+import androidx.annotation.NonNull;\n+\n+import com.smartdevicelink.proxy.RPCStruct;\n+import com.smartdevicelink.proxy.rpc.enums.AppCapabilityType;\n+\n+import java.util.Hashtable;\n+\n+/**\n+ * @since 7.0", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "09efe463a0068e98e98580c794c2710313dcfa46"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdc46d2f4b5f5fc57cd47bde1da7e7fed6aea0c5", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/bdc46d2f4b5f5fc57cd47bde1da7e7fed6aea0c5", "committedDate": "2020-08-26T07:57:09Z", "message": "[VideoStreaming]\n     - Rollback aspect ratio\n     - Fix method naming"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be305793d96b955350d38897e95da099ba49997f", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/be305793d96b955350d38897e95da099ba49997f", "committedDate": "2020-08-26T08:01:29Z", "message": "[VideoStreaming]\n     - Extract strings\n     - Fix naming in tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6c9a1892855a84d15f968e5ea43868c2c3b3626", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c6c9a1892855a84d15f968e5ea43868c2c3b3626", "committedDate": "2020-08-26T08:56:44Z", "message": "[VideoStreaming]\n     - Fix id's in xml\n     - Fix tests\n     - Add javadoc to AppCapability.java\n     - Refactor imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb085c052a2f54522ecb8033b1cce995bf4429b3", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/eb085c052a2f54522ecb8033b1cce995bf4429b3", "committedDate": "2020-08-26T08:58:50Z", "message": "[VideoStreaming]\n     - Rollback original commented code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc1NjkwNzQz", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-475690743", "createdAt": "2020-08-26T17:07:42Z", "commit": {"oid": "eb085c052a2f54522ecb8033b1cce995bf4429b3"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxNzowNzo0MlrOHHVlwQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yNlQxODo1NjozNlrOHHZY-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzQ1NTgwOQ==", "bodyText": "@kostyaBoss you can delete line 911.  It is the same as line 910.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r477455809", "createdAt": "2020-08-26T17:07:42Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java", "diffHunk": "@@ -897,11 +903,23 @@ public void onVoiceCommandSelected() {\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \t\tGENERAL_VIDEOSTREAMINGFORMAT_LIST.add(GENERAL_VIDEOSTREAMINGFORMAT);\n \n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setPreferredResolution(GENERAL_IMAGERESOLUTION);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setDiagonalScreenSize(GENERAL_DOUBLE);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY.setScale(GENERAL_DOUBLE);\n+\n+\t\tGENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);\n+\t\tGENERAL_ADDITIONAL_CAPABILITY_LIST.add(GENERAL_ADDITIONAL_CAPABILITY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb085c052a2f54522ecb8033b1cce995bf4429b3"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzUxODA3Mg==", "bodyText": "This looks good,but the unit tests in VideoStreamingCapabilityTests.java need to be updated to include the new parameter additionalVideoStreamingCapabilities.\n\n@kostyaBoss I still see this issue. In VideoStreamingCapabilityTests.java you need to update the unit tests to include the new parameter additionalVideoStreamingCapabilities.\n\n@kostyaBoss I still see this issue. In VideoStreamingCapabilityTests.java you need to update the unit tests to include the new parameter additionalVideoStreamingCapabilities.\n\n@kostyaBoss I still see this issue.  Can you update the unit tests in VideoStreamingCapabilityTests.java to include the new parameter additionalVideoStreamingCapabilities?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r477518072", "createdAt": "2020-08-26T18:56:36Z", "author": {"login": "santhanamk"}, "path": "base/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java", "diffHunk": "@@ -49,6 +50,7 @@\n \tpublic static final String KEY_DIAGONAL_SCREEN_SIZE = \"diagonalScreenSize\";\n \tpublic static final String KEY_PIXEL_PER_INCH = \"pixelPerInch\";\n \tpublic static final String KEY_SCALE = \"scale\";\n+\tpublic static final String KEY_ADDITIONAL_VIDEO_STREAMING_CAPABILITIES = \"additionalVideoStreamingCapabilities\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTk0MDE3Ng=="}, "originalCommit": {"oid": "2c1422192d1b4ef1dca0ab74f30a714f69a4d9ec"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "baf78986c6f754e62ebe8e5b230a0b4fa5e76a9f", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/baf78986c6f754e62ebe8e5b230a0b4fa5e76a9f", "committedDate": "2020-08-27T17:58:12Z", "message": "[VideoStreaming]\n     - Add tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a066b88ac054c6d1debcab98be010d8d7ebd153", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/5a066b88ac054c6d1debcab98be010d8d7ebd153", "committedDate": "2020-08-27T18:03:10Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/hello_sdl_android/build.gradle\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c09868c3a1a268cdd6260a4dc7ca0c35a03b3dc", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/4c09868c3a1a268cdd6260a4dc7ca0c35a03b3dc", "committedDate": "2020-08-27T18:05:41Z", "message": "[VideoStreaming]\n     - Fix compilation errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93860747ae3712a943374a997e65432f30c7e0e1", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/93860747ae3712a943374a997e65432f30c7e0e1", "committedDate": "2020-08-27T18:08:08Z", "message": "[VideoStreaming]\n     - Fix compilation errors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "710cff0d397e4ce5b8d098612f845d3bea0e4386", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/710cff0d397e4ce5b8d098612f845d3bea0e4386", "committedDate": "2020-08-27T18:12:46Z", "message": "[VideoStreaming]\n     - Fix errors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc3MjAwMTM3", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-477200137", "createdAt": "2020-08-28T02:24:34Z", "commit": {"oid": "710cff0d397e4ce5b8d098612f845d3bea0e4386"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc4ODExODI1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-478811825", "createdAt": "2020-08-31T17:40:09Z", "commit": {"oid": "710cff0d397e4ce5b8d098612f845d3bea0e4386"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e33dee9384251f7f7f1a581c802a36e6b7b3ba8", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/1e33dee9384251f7f7f1a581c802a36e6b7b3ba8", "committedDate": "2020-09-10T16:42:23Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/managers/lifecycle/LifecycleManager.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/proxy/SdlProxyBase.java\n#\tbase/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java\n#\tbase/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "622a5163d32974b466fad7feefda0cbb4d0f16a6", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/622a5163d32974b466fad7feefda0cbb4d0f16a6", "committedDate": "2020-09-10T17:28:41Z", "message": "[VideoStreaming]\n- Fix streaming flow after refactoring"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02b3f68123bf45a1ea906150545fcb707f69fa62", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/02b3f68123bf45a1ea906150545fcb707f69fa62", "committedDate": "2020-09-10T17:42:41Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamManagerTests.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2005b83caad04cffe274768277afd1fb102db964", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/2005b83caad04cffe274768277afd1fb102db964", "committedDate": "2020-09-10T17:47:19Z", "message": "[VideoStreaming]\n- Fix compilation errors on merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b8dc5aec4ee34e61305a65d3ce6dbeac639ef4a", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/8b8dc5aec4ee34e61305a65d3ce6dbeac639ef4a", "committedDate": "2020-09-21T11:22:40Z", "message": "[VideoStreaming]\n- Fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af31063c4a6eaef66df277ba84b6c865593b90e3", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/af31063c4a6eaef66df277ba84b6c865593b90e3", "committedDate": "2020-09-25T09:14:56Z", "message": "[VideoStreaming]\n- Applied portrait/landscape logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94e1d8abd3a4520faa52d68d852cd15592b3956b", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/94e1d8abd3a4520faa52d68d852cd15592b3956b", "committedDate": "2020-09-28T10:34:21Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/managers/lifecycle/SystemCapabilityManagerTests.java\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamManagerTests.java\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/test/TestValues.java\n#\tandroid/sdl_android/src/androidTest/java/com/smartdevicelink/test/rpc/datatypes/VideoStreamingCapabilityTests.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java\n#\tandroid/sdl_android/src/main/java/com/smartdevicelink/streaming/video/SdlRemoteDisplay.java\n#\tbase/src/main/java/com/smartdevicelink/managers/ISdl.java\n#\tbase/src/main/java/com/smartdevicelink/managers/StreamingStateMachine.java\n#\tbase/src/main/java/com/smartdevicelink/managers/lifecycle/BaseSystemCapabilityManager.java\n#\tbase/src/main/java/com/smartdevicelink/proxy/rpc/VideoStreamingCapability.java\n#\tbase/src/main/java/com/smartdevicelink/streaming/video/VideoStreamingParameters.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2d25e4dce948a695cbd707e8a312547e04f57ddc", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/2d25e4dce948a695cbd707e8a312547e04f57ddc", "committedDate": "2020-09-28T11:49:50Z", "message": "[VideoStreaming]\n- Update subscribtion management after merge\n- Fix errors\n- Update tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "307aac6a75f198a557d3058960955a75486afbe4", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/307aac6a75f198a557d3058960955a75486afbe4", "committedDate": "2020-09-29T12:07:09Z", "message": "[VideoStreaming]\n- Fix tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA0OTQxOTg1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-504941985", "createdAt": "2020-10-08T16:06:51Z", "commit": {"oid": "307aac6a75f198a557d3058960955a75486afbe4"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxNjowNjo1MlrOHel23Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQxNjoyNTo1M1rOHemoFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTgzOTU4MQ==", "bodyText": "@kostyaBoss I would rename streamingRange to listOfStreamingRanges on line114.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r501839581", "createdAt": "2020-10-08T16:06:52Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -94,17 +100,22 @@\n     private WeakReference<Context> context;\n     private volatile VirtualDisplayEncoder virtualDisplayEncoder;\n     private Class<? extends SdlRemoteDisplay> remoteDisplayClass = null;\n-    private SdlRemoteDisplay remoteDisplay;\n+    private SdlRemoteDisplay sdlRemoteDisplay;\n     private final float[] touchScalar = {1.0f, 1.0f}; //x, y\n     private HapticInterfaceManager hapticManager;\n     private SdlMotionEvent sdlMotionEvent = null;\n     private OnHMIStatus currentOnHMIStatus;\n     private final StreamingStateMachine stateMachine;\n     private VideoStreamingParameters parameters;\n+\tprivate VideoStreamingCapability originalCapability;\n     private IVideoStreamListener streamListener;\n     private boolean isTransportAvailable = false;\n-    private boolean hasStarted;\n+    private Integer majorProtocolVersion;\n+\tprivate List<VideoStreamingRange> streamingRange;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "307aac6a75f198a557d3058960955a75486afbe4"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg0MTcwNA==", "bodyText": "@kostyaBoss I would swap lines 339 and 340 since landscapeRange is passed into the method before portraitRange.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r501841704", "createdAt": "2020-10-08T16:10:00Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -282,27 +335,89 @@ public void onError(String info) {\n      * @param parameters         streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n      *                           If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n      *                           works best for the currently connected module.\n-     * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n-     */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n-        boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n-        if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n-            DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n-            stateMachine.transitionToState(StreamingStateMachine.ERROR);\n-            return;\n-        }\n+\t * @param encrypted a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n+\t * @param portraitRange constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "307aac6a75f198a557d3058960955a75486afbe4"}, "originalPosition": 225}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg0MjcwMQ==", "bodyText": "@kostyaBoss  I would rename this parameter from streamingRange to listOfStreamingRanges.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r501842701", "createdAt": "2020-10-08T16:11:36Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -282,27 +335,89 @@ public void onError(String info) {\n      * @param parameters         streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n      *                           If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n      *                           works best for the currently connected module.\n-     * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n-     */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n-        boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n-        if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n-            DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n-            stateMachine.transitionToState(StreamingStateMachine.ERROR);\n-            return;\n-        }\n+\t * @param encrypted a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n+\t * @param portraitRange constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+\t * @param landscapeRange constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+\t */\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted, VideoStreamingRange landscapeRange, VideoStreamingRange portraitRange) {\n+\t\tconfigureGlobalParameters(context, remoteDisplayClass, isEncrypted, streamingRange);\n+\t\tif(majorProtocolVersion >= 5 && !internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING)){\n+\t\t\tstateMachine.transitionToState(StreamingStateMachine.ERROR);\n+\t\t\treturn;\n+\t\t}\n+        if (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+\t\t\tgetVideoStreamingParams();\n+\t\t}\n+\t\tcheckState();\n+\t\tprocessCapabilitiesWithPendingStart(encrypted, parameters);\n+\t}\n+\t/**\n+\t * Starts streaming a remote display to the module if there is a connected session. This method of streaming requires the device to be on API level 19 or higher\n+\t * @param context a context that can be used to create the remote display\n+\t * @param remoteDisplayClass class object of the remote display. This class will be used to create an instance of the remote display and will be projected to the module\n+\t * @param parameters streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n+\t *                   If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n+\t *                   works best for the currently connected module.\n+\t *\n+\t * @param encrypted a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n+\t */\n+\t@Deprecated\n+\tpublic void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n+\t\tboolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n+\t\tif(majorProtocolVersion >= 5 && !isCapabilitySupported){\n+\t\t\tDebugTool.logError(TAG, \"Video streaming not supported on this module\");\n+\t\t\tstateMachine.transitionToState(StreamingStateMachine.ERROR);\n+\t\t\treturn;\n+\t\t}\n+\t\tif (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+\t\t\tgetVideoStreamingParams();\n+\t\t}\n+\t\tcheckState();\n+\t\tprocessCapabilitiesWithPendingStart(encrypted, parameters);\n+\t}\n+\n+\tprivate void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> streamingRange) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "307aac6a75f198a557d3058960955a75486afbe4"}, "originalPosition": 266}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg0NTU2OA==", "bodyText": "@kostyaBoss on line 410 you can change this from streamingRange to listOfStreamingRanges.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r501845568", "createdAt": "2020-10-08T16:15:52Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -282,27 +335,89 @@ public void onError(String info) {\n      * @param parameters         streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n      *                           If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n      *                           works best for the currently connected module.\n-     * @param encrypted          a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n-     */\n-    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted) {\n-        this.context = new WeakReference<>(context);\n-        this.remoteDisplayClass = remoteDisplayClass;\n-        int majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n-        boolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n-        if (majorProtocolVersion >= 5 && !isCapabilitySupported) {\n-            DebugTool.logError(TAG, \"Video streaming not supported on this module\");\n-            stateMachine.transitionToState(StreamingStateMachine.ERROR);\n-            return;\n-        }\n+\t * @param encrypted a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n+\t * @param portraitRange constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+\t * @param landscapeRange constraints for vehicle display : aspect ratio, min/max resolutions, max diagonal size.\n+\t */\n+    public void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted, VideoStreamingRange landscapeRange, VideoStreamingRange portraitRange) {\n+\t\tconfigureGlobalParameters(context, remoteDisplayClass, isEncrypted, streamingRange);\n+\t\tif(majorProtocolVersion >= 5 && !internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING)){\n+\t\t\tstateMachine.transitionToState(StreamingStateMachine.ERROR);\n+\t\t\treturn;\n+\t\t}\n+        if (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+\t\t\tgetVideoStreamingParams();\n+\t\t}\n+\t\tcheckState();\n+\t\tprocessCapabilitiesWithPendingStart(encrypted, parameters);\n+\t}\n+\t/**\n+\t * Starts streaming a remote display to the module if there is a connected session. This method of streaming requires the device to be on API level 19 or higher\n+\t * @param context a context that can be used to create the remote display\n+\t * @param remoteDisplayClass class object of the remote display. This class will be used to create an instance of the remote display and will be projected to the module\n+\t * @param parameters streaming parameters to be used when streaming. If null is sent in, the default/optimized options will be used.\n+\t *                   If you are unsure about what parameters to be used it is best to just send null and let the system determine what\n+\t *                   works best for the currently connected module.\n+\t *\n+\t * @param encrypted a flag of if the stream should be encrypted. Only set if you have a supplied encryption library that the module can understand.\n+\t */\n+\t@Deprecated\n+\tpublic void startRemoteDisplayStream(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, VideoStreamingParameters parameters, final boolean encrypted){\n+        configureGlobalParameters(context, remoteDisplayClass, isEncrypted, null);\n+\t\tboolean isCapabilitySupported = internalInterface.getSystemCapabilityManager() != null && internalInterface.getSystemCapabilityManager().isCapabilitySupported(SystemCapabilityType.VIDEO_STREAMING);\n+\t\tif(majorProtocolVersion >= 5 && !isCapabilitySupported){\n+\t\t\tDebugTool.logError(TAG, \"Video streaming not supported on this module\");\n+\t\t\tstateMachine.transitionToState(StreamingStateMachine.ERROR);\n+\t\t\treturn;\n+\t\t}\n+\t\tif (!HMILevel.HMI_NONE.equals(currentOnHMIStatus.getHmiLevel()) && VideoStreamManager.this.parameters == null) {\n+\t\t\tgetVideoStreamingParams();\n+\t\t}\n+\t\tcheckState();\n+\t\tprocessCapabilitiesWithPendingStart(encrypted, parameters);\n+\t}\n+\n+\tprivate void configureGlobalParameters(Context context, Class<? extends SdlRemoteDisplay> remoteDisplayClass, boolean encrypted, List<VideoStreamingRange> streamingRange) {\n+\t\tthis.context = new WeakReference<>(context);\n+\t\tthis.remoteDisplayClass = remoteDisplayClass;\n+\t\tthis.isEncrypted = encrypted;\n+\t\tthis.majorProtocolVersion = internalInterface.getProtocolVersion().getMajor();\n+\t\tif (streamingRange != null) {\n+\t\t\tthis.streamingRange = streamingRange;\n+\t\t}\n+\t}\n+\n+\tprivate void processCapabilitiesWithPendingStart(boolean encrypted, VideoStreamingParameters parameters){\n         if (parameters == null) {\n             if (majorProtocolVersion >= 5) {\n                 if (internalInterface.getSystemCapabilityManager() != null) {\n                     internalInterface.getSystemCapabilityManager().getCapability(SystemCapabilityType.VIDEO_STREAMING, new OnSystemCapabilityListener() {\n                         @Override\n                         public void onCapabilityRetrieved(Object capability) {\n                             VideoStreamingParameters params = new VideoStreamingParameters();\n-                            params.update((VideoStreamingCapability) capability, vehicleMake);    //Streaming parameters are ready time to stream\n-                            startStreaming(params, encrypted);\n+                            VideoStreamingCapability castedCapability = ((VideoStreamingCapability)capability);\n+\t\t\t\t\t\tVideoStreamManager.this.originalCapability = castedCapability;\n+\n+\t\t\t\t\t\t// Mocks data here\n+\t\t\t\t\t\t// castedCapability.setAdditionalVideoStreamingCapabilities(getMockedAdditionalCapabilities());\n+\t\t\t\t\t\tparams.update(castedCapability, vehicleMake);    //Streaming parameters are ready time to stream\n+                            VideoStreamManager.this.parameters = params;\n+\n+\t\t\t\t\t\tif (streamingRange != null) {\n+\t\t\t\t\t\t\t// filtering\n+\t\t\t\t\t\t\tcastedCapability.setAdditionalVideoStreamingCapabilities(\n+\t\t\t\t\t\t\t\t\tgetSupportedCapabilities(\n+\t\t\t\t\t\t\t\t\t\t\tstreamingRange,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "307aac6a75f198a557d3058960955a75486afbe4"}, "originalPosition": 298}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1MjE4Mw==", "bodyText": "@kostyaBoss Given that changes were made to VideoStreamManager.java, do changes need to be made to VideoStreamManagerTests.java?", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#discussion_r501852183", "createdAt": "2020-10-08T16:25:53Z", "author": {"login": "santhanamk"}, "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/managers/video/VideoStreamManagerTests.java", "diffHunk": "@@ -21,6 +21,7 @@\n import com.smartdevicelink.proxy.rpc.OnHMIStatus;\n import com.smartdevicelink.proxy.rpc.OnTouchEvent;\n import com.smartdevicelink.proxy.rpc.RegisterAppInterfaceResponse;\n+import com.smartdevicelink.proxy.rpc.SdlMsgVersion;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "307aac6a75f198a557d3058960955a75486afbe4"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ef3090bbd48ad096722ec8e0fd7aec30138c79e", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/6ef3090bbd48ad096722ec8e0fd7aec30138c79e", "committedDate": "2020-10-11T13:31:50Z", "message": "[VideoStreaming]\n- Fix naming\n- Fix comments code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NzQ3MjY1", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1434#pullrequestreview-506747265", "createdAt": "2020-10-12T16:05:14Z", "commit": {"oid": "6ef3090bbd48ad096722ec8e0fd7aec30138c79e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06c58187c197218c6fae6a5a3a89dbdd8f194926", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/06c58187c197218c6fae6a5a3a89dbdd8f194926", "committedDate": "2020-11-11T09:15:33Z", "message": "Merge branch 'develop' into feature/0296_possibility_to_update_video_streaming_capabilities\n\n# Conflicts:\n#\tandroid/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/MainActivity.java\n#\tandroid/hello_sdl_android/src/main/java/com/sdl/hellosdlandroid/SdlService.java\n#\tandroid/hello_sdl_android/src/main/res/layout/activity_main.xml"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5303319b363a0d3f773cdf3bc2bc38ab1f497113", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/5303319b363a0d3f773cdf3bc2bc38ab1f497113", "committedDate": "2020-11-13T12:22:36Z", "message": "[0296]\n- Example rollback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c5e6c269ee8935a3711ad1d5ab5af77f30e540e6", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c5e6c269ee8935a3711ad1d5ab5af77f30e540e6", "committedDate": "2020-11-13T12:48:46Z", "message": "[0296]\n- Codestyle fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac3c9a392f6d37b536569b62a89f9dc2b43a33bf", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/ac3c9a392f6d37b536569b62a89f9dc2b43a33bf", "committedDate": "2020-11-13T12:55:12Z", "message": "[0296]\n- Codestyle fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "891f8a8cdf8c8448676c208b9392c17122de9ca4", "author": {"user": null}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/891f8a8cdf8c8448676c208b9392c17122de9ca4", "committedDate": "2020-11-13T13:11:12Z", "message": "[0296]\n- Codestyle fix"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2066, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}