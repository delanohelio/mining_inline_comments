{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQwNzE3MzM5", "number": 1399, "title": "Refactor LCM Updates", "bodyText": "This PR is ready for review.\nRisk\nThis PR makes minor API changes.\nTesting Plan\n\n I have verified that I have not introduced new warnings in this PR (or explain why below)\n I have run the unit tests with this PR\n I have tested this PR against TDK and verified behavior (if applicable, if not applicable, explain why below).\n I have tested Android\n\nTDK Tests\nSpecifically these refactorings were focused on the added video and audio streaming features. I used Livio's video streaming sample app to tests.\nSummary\n\nRemoved unused return values in moved methods\nRemoved unnecessary uses of extra threads that were used as a sleep timer\nRenamed variables to match their purpose (eg nav -> video)\nRefactored some of the TransportBroker. The new LCM doesn't have the same queueing architecture that the proxy did so it caused issues in the TransportBroker that weren't previously happening. (Deadlock on USB disconnect)\n\nChangelog\nEnhancements\n\nRefactored the LCM updates for this release so that the old code doesn't just persist into the future indefinitely.\n\nCLA\n\n I have signed the CLA", "createdAt": "2020-06-26T18:03:04Z", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1399", "merged": true, "mergeCommit": {"oid": "c367dd8c2ed58b7ba1a134e513886aca2e549060"}, "closed": true, "closedAt": "2020-06-30T15:37:08Z", "author": {"login": "joeygrover"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABct1CDSgH2gAyNDQwNzE3MzM5OjMzZWQzYjU4MGEyYjQxNjg2ZmFmYWNjOTk3NzdhMjU0ZDhmNDVjMDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwXSa5gFqTQ0MDEyODI0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "33ed3b580a2b41686fafacc99777a254d8f45c08", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/33ed3b580a2b41686fafacc99777a254d8f45c08", "committedDate": "2020-06-22T18:19:53Z", "message": "Remove proxy naming from LCM"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d917c6b90d17c2d5a614db5b43dd778796605b35", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/d917c6b90d17c2d5a614db5b43dd778796605b35", "committedDate": "2020-06-24T19:12:16Z", "message": "Move internal classes to bottom of file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "39d5b6e2fd91e2e7e94c5ee3f1abb63629069fb1", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/39d5b6e2fd91e2e7e94c5ee3f1abb63629069fb1", "committedDate": "2020-06-24T19:12:55Z", "message": "Refactor to more descriptive naming\n\nand make context into a weakreference"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c9d7c38010137c486c0b64646456282d118b1aed", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/c9d7c38010137c486c0b64646456282d118b1aed", "committedDate": "2020-06-25T19:16:50Z", "message": "Rename callbacks to better reflect events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48c151d5faa54bb52f9d9f5187d5cd0687a6d1ab", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/48c151d5faa54bb52f9d9f5187d5cd0687a6d1ab", "committedDate": "2020-06-25T19:55:38Z", "message": "Remove unncessary sleeps and extra classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecb3b3828baeee1764bb0a04047e34208dc87473", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/ecb3b3828baeee1764bb0a04047e34208dc87473", "committedDate": "2020-06-26T14:19:59Z", "message": "Merge branch 'develop' of https://github.com/smartdevicelink/sdl_android into bugfix/refactor_lcm_updates"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "99d5a47698d22de4d46d97fd50efff7743c78d29", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/99d5a47698d22de4d46d97fd50efff7743c78d29", "committedDate": "2020-06-26T14:34:20Z", "message": "Remove unused return value from tryVideoStream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a410e24bc4aae3c748e3bb795465b3920f7a0287", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/a410e24bc4aae3c748e3bb795465b3920f7a0287", "committedDate": "2020-06-26T14:34:30Z", "message": "Remove unused state booleans"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11a8e7e6552054cf9618a3f21176e8f20bdbbdc5", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/11a8e7e6552054cf9618a3f21176e8f20bdbbdc5", "committedDate": "2020-06-26T17:46:54Z", "message": "Add synchronized lock to sdlmanager.dispose"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a5cc3d19814d1460299b9636bc645dd5d9a83b6b", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/a5cc3d19814d1460299b9636bc645dd5d9a83b6b", "committedDate": "2020-06-26T17:47:27Z", "message": "Add synchronized lock to lcm.stop\n\nAlso cleraed session in stop() as well as make taskmaster a daemon thread."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4234bcc14808e3e3dc143ea75afdcdedbfacec55", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/4234bcc14808e3e3dc143ea75afdcdedbfacec55", "committedDate": "2020-06-26T17:48:28Z", "message": "Refactor TransportBroker to fit with LCM\n\nWith some of the removed queues out of the proxy base class, the tarnsport broker was experiencing some issues shutting down."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MTY4NzE3", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1399#pullrequestreview-439168717", "createdAt": "2020-06-29T13:56:03Z", "commit": {"oid": "4234bcc14808e3e3dc143ea75afdcdedbfacec55"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxMzo1NjowNFrOGqSJlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNTowOTowM1rOGqVb1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njk5MDc0MQ==", "bodyText": "onServiceEnded, onStopServiceNACKed methods seem to be not overridden anymore and could be removed from the BaseLifecycleManager class.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1399#discussion_r446990741", "createdAt": "2020-06-29T13:56:04Z", "author": {"login": "bilal-alsharifi"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/lifecycle/LifecycleManager.java", "diffHunk": "@@ -161,42 +161,18 @@ void onTransportDisconnected(String info, boolean availablePrimary, BaseTranspor\n         if (availablePrimary) {\n             _transportConfig = transportConfig;\n             Log.d(TAG, \"notifying RPC session ended, but potential primary transport available\");\n-            cycleProxy(SdlDisconnectedReason.PRIMARY_TRANSPORT_CYCLE_REQUEST);\n+            cycle(SdlDisconnectedReason.PRIMARY_TRANSPORT_CYCLE_REQUEST);\n         } else {\n             onClose(info, null, null);\n         }\n     }\n \n     @Override\n-    void onProtocolSessionStartedNACKed(SessionType sessionType) {\n-        super.onProtocolSessionStartedNACKed(sessionType);\n-        if (sessionType.eq(SessionType.NAV)) {\n-            navServiceStartResponseReceived = true;\n-            navServiceStartResponse = false;\n-        }\n-    }\n-\n-    @Override\n-    void onProtocolSessionEnded(SessionType sessionType) {\n-        super.onProtocolSessionEnded(sessionType);\n+    void onStartServiceNACKed(SessionType sessionType) {\n+        super.onStartServiceNACKed(sessionType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4234bcc14808e3e3dc143ea75afdcdedbfacec55"}, "originalPosition": 123}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzA0NDU2Nw==", "bodyText": "There are some unused imports in this class that can be removed", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1399#discussion_r447044567", "createdAt": "2020-06-29T15:09:03Z", "author": {"login": "bilal-alsharifi"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/lifecycle/LifecycleManager.java", "diffHunk": "@@ -54,6 +54,7 @@\n import com.smartdevicelink.transport.enums.TransportType;\n import com.smartdevicelink.util.DebugTool;\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4234bcc14808e3e3dc143ea75afdcdedbfacec55"}, "originalPosition": 10}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfcff7818ca66cc9b2a6ac37bf178c740a68ae29", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/bfcff7818ca66cc9b2a6ac37bf178c740a68ae29", "committedDate": "2020-06-30T15:09:16Z", "message": "Remove unused imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "712c4a9b2ffba92586f75ee55de3b32942314846", "author": {"user": {"login": "joeygrover", "name": "Joey Grover"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/712c4a9b2ffba92586f75ee55de3b32942314846", "committedDate": "2020-06-30T15:11:42Z", "message": "Remove unused methods in base LCM"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwMTI4MjQy", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1399#pullrequestreview-440128242", "createdAt": "2020-06-30T15:22:23Z", "commit": {"oid": "712c4a9b2ffba92586f75ee55de3b32942314846"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2214, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}