{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYwMTc5ODI3", "number": 1250, "title": "Fix an issue with starting video stream after closing the app", "bodyText": "Fixes #1248\nThis PR is ready for review.\nRisk\nThis PR makes no API changes.\nTesting Plan\n\nStart video stream on a SYNC 3 head unit\nClose the app using voice commands\nOpen the app again and start the video stream\nMake sure streaming works correctly\n\nSummary\nThis PR handles a bug in some head units where the StartService for video streaming gets a NAK response after the app is being closed using voice commands.\nThe PR fixes that by manually sending EndService from app side when the app is closed using voice commands.\nCLA\n\n I have signed the CLA", "createdAt": "2020-01-07T21:25:53Z", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1250", "merged": true, "mergeCommit": {"oid": "b0697d6ab03658efd9bb1c9fee0ae132b7da539a"}, "closed": true, "closedAt": "2020-01-17T21:31:20Z", "author": {"login": "bilal-alsharifi"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4HZIAAH2gAyMzYwMTc5ODI3OmZmOTMwMzJjNWRiNDY5MmM0MjU5Yzc5MmM0M2ZiNmNjNmE0ZGJiNzA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb7VqeuAFqTM0NDg1MjA1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "ff93032c5db4692c4259c792c43fb6cc6a4dbb70", "author": {"user": {"login": "bilal-alsharifi", "name": "Bilal Alsharifi"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/ff93032c5db4692c4259c792c43fb6cc6a4dbb70", "committedDate": "2020-01-07T21:11:28Z", "message": "Fix an issue with starting video stream after closing the app"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a62c4d115a28d38500bb6364bced4866d3192cd", "author": {"user": {"login": "bilal-alsharifi", "name": "Bilal Alsharifi"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/5a62c4d115a28d38500bb6364bced4866d3192cd", "committedDate": "2020-01-08T15:01:50Z", "message": "Update the condition for stopping video streaming"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e8bf1c3368b8208a84bee30a7aab902a6b218fe", "author": {"user": {"login": "bilal-alsharifi", "name": "Bilal Alsharifi"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/8e8bf1c3368b8208a84bee30a7aab902a6b218fe", "committedDate": "2020-01-14T20:06:53Z", "message": "Merge branch 'develop' into feature/issue_1248"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQzOTQ1OTcy", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1250#pullrequestreview-343945972", "createdAt": "2020-01-16T14:21:48Z", "commit": {"oid": "8e8bf1c3368b8208a84bee30a7aab902a6b218fe"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxNDoyMTo0OFrOFea8gQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxNDoyMTo0OFrOFea8gQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzQ0MzA3Mw==", "bodyText": "Potential NPE using the equals method here. You can either use the == comparator  or switch the enum instance calling the equals() metod, eg  HMILevel.HMI_FULL.equals(prevHMILevel) as the HMILevel enum instances will always be valid. Either solution will work.", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1250#discussion_r367443073", "createdAt": "2020-01-16T14:21:48Z", "author": {"login": "joeygrover"}, "path": "android/sdl_android/src/main/java/com/smartdevicelink/managers/video/VideoStreamManager.java", "diffHunk": "@@ -148,10 +148,16 @@ public void onNotified(RPCNotification notification) {\n \t\t\t\tif (onHMIStatus.getWindowID() != null && onHMIStatus.getWindowID() != PredefinedWindows.DEFAULT_WINDOW.getValue()) {\n \t\t\t\t\treturn;\n \t\t\t\t}\n+\t\t\t\tHMILevel prevHMILevel = hmiLevel;\n \t\t\t\thmiLevel = onHMIStatus.getHmiLevel();\n \t\t\t\tif(hmiLevel.equals(HMILevel.HMI_FULL)){\n \t\t\t\t\tcheckState();\n \t\t\t\t}\n+\t\t\t\tif (hasStarted && (prevHMILevel.equals(HMILevel.HMI_FULL) || prevHMILevel.equals(HMILevel.HMI_LIMITED)) && (hmiLevel.equals(HMILevel.HMI_NONE) || hmiLevel.equals(HMILevel.HMI_BACKGROUND))){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8e8bf1c3368b8208a84bee30a7aab902a6b218fe"}, "originalPosition": 9}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69da23e3b2e43d8caef0365be6e94df8de5d1301", "author": {"user": {"login": "bilal-alsharifi", "name": "Bilal Alsharifi"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/69da23e3b2e43d8caef0365be6e94df8de5d1301", "committedDate": "2020-01-16T15:34:38Z", "message": "Fix potential NPE issue in VideoStreamManager"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "15d43541770e941205389c64eb697b05301ec2e0", "author": {"user": {"login": "bilal-alsharifi", "name": "Bilal Alsharifi"}}, "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/15d43541770e941205389c64eb697b05301ec2e0", "committedDate": "2020-01-16T16:12:24Z", "message": "Update transitions in VideoStreamManager"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0ODUyMDUx", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1250#pullrequestreview-344852051", "createdAt": "2020-01-17T21:30:52Z", "commit": {"oid": "15d43541770e941205389c64eb697b05301ec2e0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2112, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}