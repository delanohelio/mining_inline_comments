{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczNTgzMjU1", "number": 1369, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNzozNzozNlrODfErmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMDo0OTo1OVrODfIX8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzOTA5MTQ3OnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNzozNzozNlrOFokOAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMTozNDo0OVrOForSkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA4MDc3MQ==", "bodyText": "We shouldn't make it a singleton class and make the utility functions as static methods.", "url": "https://github.com/edx/edx-app-android/pull/1369#discussion_r378080771", "createdAt": "2020-02-12T07:37:36Z", "author": {"login": "farhan"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -0,0 +1,84 @@\n+package org.edx.mobile.util\n+\n+import android.text.TextUtils\n+import com.google.firebase.remoteconfig.FirebaseRemoteConfig\n+import com.google.gson.Gson\n+import com.google.gson.reflect.TypeToken\n+import org.edx.mobile.BuildConfig\n+import java.util.*\n+\n+/**\n+ * Created by rohan on 3/12/15.\n+ */\n+object ConfigUtil {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4d7f8afcfe59e0ba1ebd790fa46dfe160a3d9196"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODE5NjYyNQ==", "bodyText": "done.", "url": "https://github.com/edx/edx-app-android/pull/1369#discussion_r378196625", "createdAt": "2020-02-12T11:34:49Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -0,0 +1,84 @@\n+package org.edx.mobile.util\n+\n+import android.text.TextUtils\n+import com.google.firebase.remoteconfig.FirebaseRemoteConfig\n+import com.google.gson.Gson\n+import com.google.gson.reflect.TypeToken\n+import org.edx.mobile.BuildConfig\n+import java.util.*\n+\n+/**\n+ * Created by rohan on 3/12/15.\n+ */\n+object ConfigUtil {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA4MDc3MQ=="}, "originalCommit": {"oid": "4d7f8afcfe59e0ba1ebd790fa46dfe160a3d9196"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzOTA5MjQ5OnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQwNzozODowNFrOFokOrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMTozNDo1M1rOForSvQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA4MDk0MA==", "bodyText": "Remove these docs, please \ud83d\ude09", "url": "https://github.com/edx/edx-app-android/pull/1369#discussion_r378080940", "createdAt": "2020-02-12T07:38:04Z", "author": {"login": "farhan"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -0,0 +1,84 @@\n+package org.edx.mobile.util\n+\n+import android.text.TextUtils\n+import com.google.firebase.remoteconfig.FirebaseRemoteConfig\n+import com.google.gson.Gson\n+import com.google.gson.reflect.TypeToken\n+import org.edx.mobile.BuildConfig\n+import java.util.*\n+\n+/**\n+ * Created by rohan on 3/12/15.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4d7f8afcfe59e0ba1ebd790fa46dfe160a3d9196"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODE5NjY2OQ==", "bodyText": "done.", "url": "https://github.com/edx/edx-app-android/pull/1369#discussion_r378196669", "createdAt": "2020-02-12T11:34:53Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -0,0 +1,84 @@\n+package org.edx.mobile.util\n+\n+import android.text.TextUtils\n+import com.google.firebase.remoteconfig.FirebaseRemoteConfig\n+import com.google.gson.Gson\n+import com.google.gson.reflect.TypeToken\n+import org.edx.mobile.BuildConfig\n+import java.util.*\n+\n+/**\n+ * Created by rohan on 3/12/15.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODA4MDk0MA=="}, "originalCommit": {"oid": "4d7f8afcfe59e0ba1ebd790fa46dfe160a3d9196"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjMzOTY5NjUxOnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMDo0OTo1OVrOFop89Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xMlQxMTozNTowM1rOForS_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODE3NDcwOQ==", "bodyText": "As per discussion, following code is more optimized.\n    /**\n     * Utility method to check the status of the course upgrade.\n     *\n     * @param config   [Config]\n     * @param listener [OnCourseUpgradeStatusListener] callback for the status of the course upgrade.\n     */\n    fun checkCourseUpgradeEnabled(config: Config,\n                                  listener: OnCourseUpgradeStatusListener) {\n        // Check firebase enabled in config\n        if (config.firebaseConfig.isEnabled) {\n            val firebaseRemoteConfig = FirebaseRemoteConfig.getInstance()\n            firebaseRemoteConfig.fetchAndActivate().addOnCompleteListener {\n                val courseUpgradeEnabled = firebaseRemoteConfig\n                        .getBoolean(AppConstants.FirebaseConstants.REV_934_ENABLED)\n                // Check course upgrade enabled in firebase remote config\n                if (courseUpgradeEnabled) {\n                    val whiteListedReleasesJson = firebaseRemoteConfig\n                            .getString(AppConstants.FirebaseConstants.REV_934_WHITELISTED_RELEASES)\n                    if (!TextUtils.isEmpty(whiteListedReleasesJson)) {\n                        val whiteListedReleases = Gson().fromJson<ArrayList<String>>(whiteListedReleasesJson,\n                                object : TypeToken<ArrayList<String>>() {}.type)\n                        // Check current release is white listed in firebase remote config\n                        for (release in whiteListedReleases) {\n                            if (BuildConfig.VERSION_NAME.equals(release, ignoreCase = true)) {\n                                listener.onCourseUpgradeResult(true)\n                                return@addOnCompleteListener\n                            }\n                        }\n                    }\n                }\n                listener.onCourseUpgradeResult(false)\n            }\n        }\n    }\n\n    /**\n     * Interface to provide the callback for the status of the course upgrade.\n     */\n    interface OnCourseUpgradeStatusListener {\n        /**\n         * Callback to send course upgrade status result.\n         */\n        fun onCourseUpgradeResult(enabled: Boolean)\n    }", "url": "https://github.com/edx/edx-app-android/pull/1369#discussion_r378174709", "createdAt": "2020-02-12T10:49:59Z", "author": {"login": "farhan"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -0,0 +1,84 @@\n+package org.edx.mobile.util\n+\n+import android.text.TextUtils\n+import com.google.firebase.remoteconfig.FirebaseRemoteConfig\n+import com.google.gson.Gson\n+import com.google.gson.reflect.TypeToken\n+import org.edx.mobile.BuildConfig\n+import java.util.*\n+\n+/**\n+ * Created by rohan on 3/12/15.\n+ */\n+object ConfigUtil {\n+\n+    /**\n+     * Returns true if domain of the given URL is white-listed in the configuration,\n+     * false otherwise.\n+     *\n+     * @param url\n+     * @return\n+     */\n+    fun isWhiteListedURL(url: String, config: Config): Boolean {\n+        // check if this URL is a white-listed URL, anything outside the white-list is EXTERNAL LINK\n+        for (domain in config.zeroRatingConfig.whiteListedDomains) {\n+            if (BrowserUtil.isUrlOfHost(url, domain)) {\n+                // this is white-listed URL\n+                return true\n+            }\n+        }\n+        return false\n+    }\n+\n+    /**\n+     * Utility method to check the current build is white listed in Firebase remote config.\n+     *\n+     * @param config   [Config]\n+     * @param listener [OnCourseUpgradeStateListener] callback for the white listed release\n+     */\n+    fun isReleaseWhiteListed(config: Config,\n+                             listener: OnCourseUpgradeStateListener?) {\n+        if (config.firebaseConfig.isEnabled) {\n+            val firebaseRemoteConfig = FirebaseRemoteConfig.getInstance()\n+            firebaseRemoteConfig.fetchAndActivate().addOnCompleteListener {\n+                val courseUpgradeEnabled = firebaseRemoteConfig\n+                        .getBoolean(AppConstants.FirebaseConstants.REV_934_ENABLED)\n+                var releaseWhiteListed = false\n+                if (courseUpgradeEnabled) {\n+                    val whiteListedReleasesJson = firebaseRemoteConfig\n+                            .getString(AppConstants.FirebaseConstants.REV_934_WHITELISTED_RELEASES)\n+                    if (!TextUtils.isEmpty(whiteListedReleasesJson)) {\n+                        val whiteListReleases = Gson().fromJson<ArrayList<String>>(whiteListedReleasesJson,\n+                                object : TypeToken<ArrayList<String>>() {}.type)\n+                        for (WhiteListedRelease in whiteListReleases) {\n+                            if (BuildConfig.VERSION_NAME.equals(WhiteListedRelease, ignoreCase = true)) {\n+                                listener?.onWhiteListedRelease()\n+                                releaseWhiteListed = true\n+                                break\n+                            }\n+                        }\n+                    }\n+                }\n+                if (!releaseWhiteListed) {\n+                    listener?.onCourseUpgradeDisable()\n+                }\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Interface to provide the callback for the status of the course update.\n+     */\n+    interface OnCourseUpgradeStateListener {\n+        /**\n+         * Callback about to know the current release is white listed for the course upgrade feature\n+         * */\n+        fun onWhiteListedRelease()\n+\n+        /**\n+         * Callback to know that the course update is enabled or current release is block for the\n+         * course upgrade feature\n+         * */\n+        fun onCourseUpgradeDisable()\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4d7f8afcfe59e0ba1ebd790fa46dfe160a3d9196"}, "originalPosition": 83}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODE5NjczMw==", "bodyText": "done.", "url": "https://github.com/edx/edx-app-android/pull/1369#discussion_r378196733", "createdAt": "2020-02-12T11:35:03Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/ConfigUtil.kt", "diffHunk": "@@ -0,0 +1,84 @@\n+package org.edx.mobile.util\n+\n+import android.text.TextUtils\n+import com.google.firebase.remoteconfig.FirebaseRemoteConfig\n+import com.google.gson.Gson\n+import com.google.gson.reflect.TypeToken\n+import org.edx.mobile.BuildConfig\n+import java.util.*\n+\n+/**\n+ * Created by rohan on 3/12/15.\n+ */\n+object ConfigUtil {\n+\n+    /**\n+     * Returns true if domain of the given URL is white-listed in the configuration,\n+     * false otherwise.\n+     *\n+     * @param url\n+     * @return\n+     */\n+    fun isWhiteListedURL(url: String, config: Config): Boolean {\n+        // check if this URL is a white-listed URL, anything outside the white-list is EXTERNAL LINK\n+        for (domain in config.zeroRatingConfig.whiteListedDomains) {\n+            if (BrowserUtil.isUrlOfHost(url, domain)) {\n+                // this is white-listed URL\n+                return true\n+            }\n+        }\n+        return false\n+    }\n+\n+    /**\n+     * Utility method to check the current build is white listed in Firebase remote config.\n+     *\n+     * @param config   [Config]\n+     * @param listener [OnCourseUpgradeStateListener] callback for the white listed release\n+     */\n+    fun isReleaseWhiteListed(config: Config,\n+                             listener: OnCourseUpgradeStateListener?) {\n+        if (config.firebaseConfig.isEnabled) {\n+            val firebaseRemoteConfig = FirebaseRemoteConfig.getInstance()\n+            firebaseRemoteConfig.fetchAndActivate().addOnCompleteListener {\n+                val courseUpgradeEnabled = firebaseRemoteConfig\n+                        .getBoolean(AppConstants.FirebaseConstants.REV_934_ENABLED)\n+                var releaseWhiteListed = false\n+                if (courseUpgradeEnabled) {\n+                    val whiteListedReleasesJson = firebaseRemoteConfig\n+                            .getString(AppConstants.FirebaseConstants.REV_934_WHITELISTED_RELEASES)\n+                    if (!TextUtils.isEmpty(whiteListedReleasesJson)) {\n+                        val whiteListReleases = Gson().fromJson<ArrayList<String>>(whiteListedReleasesJson,\n+                                object : TypeToken<ArrayList<String>>() {}.type)\n+                        for (WhiteListedRelease in whiteListReleases) {\n+                            if (BuildConfig.VERSION_NAME.equals(WhiteListedRelease, ignoreCase = true)) {\n+                                listener?.onWhiteListedRelease()\n+                                releaseWhiteListed = true\n+                                break\n+                            }\n+                        }\n+                    }\n+                }\n+                if (!releaseWhiteListed) {\n+                    listener?.onCourseUpgradeDisable()\n+                }\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Interface to provide the callback for the status of the course update.\n+     */\n+    interface OnCourseUpgradeStateListener {\n+        /**\n+         * Callback about to know the current release is white listed for the course upgrade feature\n+         * */\n+        fun onWhiteListedRelease()\n+\n+        /**\n+         * Callback to know that the course update is enabled or current release is block for the\n+         * course upgrade feature\n+         * */\n+        fun onCourseUpgradeDisable()\n+    }", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODE3NDcwOQ=="}, "originalCommit": {"oid": "4d7f8afcfe59e0ba1ebd790fa46dfe160a3d9196"}, "originalPosition": 83}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 486, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}