{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwNDAxNDQy", "number": 1385, "title": "Update already enrolled course message", "bodyText": "Description\nLEARNER-6671\n\nPreviously when user tap on already enrolled course App shows you this message: \"You are now enrolled in this course\". Now the message is \"You are already enrolled in this course.\"\n\nHow to Reproduce:\n\nLoad Course Discovery and enroll a course\nLoad Courses Tab and make sure specific course is enrolled successfully\nLoad Course Discovery and note that you can enroll again to same course", "createdAt": "2020-03-18T12:17:49Z", "url": "https://github.com/edx/edx-app-android/pull/1385", "merged": true, "mergeCommit": {"oid": "62bb0580191004cce844e8c218380cbd092542ec"}, "closed": true, "closedAt": "2020-04-02T16:49:54Z", "author": {"login": "omerhabib26"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPe-NjgFqTM3ODQxMDU1Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTuSuqABqjMxOTI4MzIxMzY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4NDEwNTUy", "url": "https://github.com/edx/edx-app-android/pull/1385#pullrequestreview-378410552", "createdAt": "2020-03-20T11:37:15Z", "commit": {"oid": "92cd5c289e290b9232c41a0acb4a73df11b7eae4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMTozNzoxNlrOF5QV2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMFQxMTozOTo0NVrOF5QZ1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTU4MDg4OA==", "bodyText": "We are duplicating the functionality of this function. It should be removed and the following should be used.\n\n  \n    \n      edx-app-android/OpenEdXMobile/src/main/java/org/edx/mobile/course/CourseAPI.java\n    \n    \n        Lines 118 to 131\n      in\n      c897ba3\n    \n    \n    \n    \n\n        \n          \n               /** \n        \n\n        \n          \n                * @param courseId The course ID. \n        \n\n        \n          \n                * @return The course identified by the provided ID if available from the cache, null if no \n        \n\n        \n          \n                *         course is found. \n        \n\n        \n          \n                */ \n        \n\n        \n          \n               @Nullable \n        \n\n        \n          \n               public EnrolledCoursesResponse getCourseById(@NonNull final String courseId) throws Exception { \n        \n\n        \n          \n                   for (EnrolledCoursesResponse r : executeStrict(getEnrolledCoursesFromCache())) { \n        \n\n        \n          \n                       if (r.getCourse().getId().equals(courseId)) { \n        \n\n        \n          \n                           return r; \n        \n\n        \n          \n                       } \n        \n\n        \n          \n                   } \n        \n\n        \n          \n                   return null; \n        \n\n        \n          \n               }", "url": "https://github.com/edx/edx-app-android/pull/1385#discussion_r395580888", "createdAt": "2020-03-20T11:37:16Z", "author": {"login": "farhan"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/services/CourseManager.java", "diffHunk": "@@ -134,4 +139,26 @@ public boolean apply(CourseComponent courseComponent) {\n             }\n         });\n     }\n+\n+    /**\n+     * Obtain the enrolled courses data from app level cache and then find the specified course.\n+     *\n+     * @param courseId    Id of the course.\n+     * @return Searched out the course. In case course is not present in\n+     * app level cache it will return false.\n+     */\n+    public Boolean getEnrolledCourseByIdFromAppLevelCache(@NonNull final String courseId) {\n+        try {\n+            List<EnrolledCoursesResponse> enrolledCoursesResponse =\n+                    executeStrict(courseApi.getEnrolledCoursesFromCache());\n+            for (EnrolledCoursesResponse course : enrolledCoursesResponse) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92cd5c289e290b9232c41a0acb4a73df11b7eae4"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTU4MTkwOQ==", "bodyText": "Function doc is not properly indented.\nPro Tip: Use \"Option + Command + L\" short cut key.\nAlso content of the comment needs to be improved", "url": "https://github.com/edx/edx-app-android/pull/1385#discussion_r395581909", "createdAt": "2020-03-20T11:39:45Z", "author": {"login": "farhan"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/services/CourseManager.java", "diffHunk": "@@ -134,4 +139,26 @@ public boolean apply(CourseComponent courseComponent) {\n             }\n         });\n     }\n+\n+    /**\n+     * Obtain the enrolled courses data from app level cache and then find the specified course.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "92cd5c289e290b9232c41a0acb4a73df11b7eae4"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwMDk2NDI2", "url": "https://github.com/edx/edx-app-android/pull/1385#pullrequestreview-380096426", "createdAt": "2020-03-24T08:41:43Z", "commit": {"oid": "d353956b08b075daaaac1a603c261f79e63c88c3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d353956b08b075daaaac1a603c261f79e63c88c3", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/d353956b08b075daaaac1a603c261f79e63c88c3", "committedDate": "2020-03-20T12:37:50Z", "message": "Address PR comments"}, "afterCommit": {"oid": "ba7ae5cf8491adec68e08e8e38099706b1f43d7e", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/ba7ae5cf8491adec68e08e8e38099706b1f43d7e", "committedDate": "2020-03-25T07:11:26Z", "message": "Address PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NDY3ODk5", "url": "https://github.com/edx/edx-app-android/pull/1385#pullrequestreview-385467899", "createdAt": "2020-04-01T10:44:27Z", "commit": {"oid": "ba7ae5cf8491adec68e08e8e38099706b1f43d7e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMDo0NDoyN1rOF-6_0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxMDo0NDoyN1rOF-6_0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTUyMjY0MQ==", "bodyText": "it's better to check if the course is already enrolled before the service call of course enrollment and move to the course dashboard without calling an extra service.", "url": "https://github.com/edx/edx-app-android/pull/1385#discussion_r401522641", "createdAt": "2020-04-01T10:44:27Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/util/links/DefaultActionListener.java", "diffHunk": "@@ -162,7 +162,10 @@ public void onClickEnroll(@NonNull final String courseId, final boolean emailOpt\n                     protected void onResponse(@NonNull final ResponseBody responseBody) {\n                         super.onResponse(responseBody);\n                         logger.debug(\"Enrollment successful: \" + courseId);\n-                        Toast.makeText(activity, activity.getString(R.string.you_are_now_enrolled), Toast.LENGTH_SHORT).show();\n+                        Toast.makeText(activity, activity.getString(\n+                                courseApi.isCourseEnrolled(courseId) ?", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ba7ae5cf8491adec68e08e8e38099706b1f43d7e"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1NzMzNDYw", "url": "https://github.com/edx/edx-app-android/pull/1385#pullrequestreview-385733460", "createdAt": "2020-04-01T16:06:18Z", "commit": {"oid": "cb4689a8014e5280251d965fbac714c782ffaa36"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "604620747a67b77973944bd3460502783d494c0a", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/604620747a67b77973944bd3460502783d494c0a", "committedDate": "2020-04-02T14:07:14Z", "message": "Suggested Changes for already enrolled course"}, "afterCommit": {"oid": "cb4689a8014e5280251d965fbac714c782ffaa36", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/cb4689a8014e5280251d965fbac714c782ffaa36", "committedDate": "2020-04-01T13:47:46Z", "message": "Address PR comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2NTM2MDIw", "url": "https://github.com/edx/edx-app-android/pull/1385#pullrequestreview-386536020", "createdAt": "2020-04-02T15:23:03Z", "commit": {"oid": "cb4689a8014e5280251d965fbac714c782ffaa36"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cb4689a8014e5280251d965fbac714c782ffaa36", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/cb4689a8014e5280251d965fbac714c782ffaa36", "committedDate": "2020-04-01T13:47:46Z", "message": "Address PR comments"}, "afterCommit": {"oid": "2a13d70198bd70c41e0331658694039fb5c05ca6", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/2a13d70198bd70c41e0331658694039fb5c05ca6", "committedDate": "2020-04-02T15:39:07Z", "message": "Update already enrolled course message"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a13d70198bd70c41e0331658694039fb5c05ca6", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/2a13d70198bd70c41e0331658694039fb5c05ca6", "committedDate": "2020-04-02T15:39:07Z", "message": "Update already enrolled course message"}, "afterCommit": {"oid": "83732240d024dfa6f5f88eb2af2283d92de79b03", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/83732240d024dfa6f5f88eb2af2283d92de79b03", "committedDate": "2020-04-02T15:42:35Z", "message": "LEARNER-6671 Update already enrolled course message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6f2f1afc117297ae7f42b85c5f6b3d082695c3f8", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/6f2f1afc117297ae7f42b85c5f6b3d082695c3f8", "committedDate": "2020-04-02T15:46:23Z", "message": "Update already enrolled course message\n- LEARNER-6671"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83732240d024dfa6f5f88eb2af2283d92de79b03", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/83732240d024dfa6f5f88eb2af2283d92de79b03", "committedDate": "2020-04-02T15:42:35Z", "message": "LEARNER-6671 Update already enrolled course message"}, "afterCommit": {"oid": "6f2f1afc117297ae7f42b85c5f6b3d082695c3f8", "author": {"user": {"login": "omerhabib26", "name": "Omer Habib"}}, "url": "https://github.com/edx/edx-app-android/commit/6f2f1afc117297ae7f42b85c5f6b3d082695c3f8", "committedDate": "2020-04-02T15:46:23Z", "message": "Update already enrolled course message\n- LEARNER-6671"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4146, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}