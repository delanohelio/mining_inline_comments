{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU1OTQ3MDM1", "number": 1442, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwOTo1NjoyNFrOERxBsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMToyMTozMFrOERyXyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MDY0NDk2OnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/authentication/LoginService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwOTo1NjoyNFrOG2pvmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMToyNjozN1rOG2r8lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk2MDIxNw==", "bodyText": "Remove extra line", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459960217", "createdAt": "2020-07-24T09:56:24Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/authentication/LoginService.java", "diffHunk": "@@ -41,6 +42,17 @@ public LoginService get() {\n         }\n     }\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk5NjMxMQ==", "bodyText": "removed.", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459996311", "createdAt": "2020-07-24T11:26:37Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/authentication/LoginService.java", "diffHunk": "@@ -41,6 +42,17 @@ public LoginService get() {\n         }\n     }\n \n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk2MDIxNw=="}, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MDY1MzA1OnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/http/constants/ApiConstants.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQwOTo1OToxM1rOG2p0XQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMTozMzoxN1rOG2sGsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk2MTQzNw==", "bodyText": "IMO, it should be \"URL_VALIDATE_REGISTERATION_FIELDS\"", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459961437", "createdAt": "2020-07-24T09:59:13Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/http/constants/ApiConstants.java", "diffHunk": "@@ -32,6 +32,8 @@\n \n     public static final String URL_REGISTRATION = \"/user_api/{\" + API_VERSION + \"}/account/registration/\";\n \n+    public static final String URL_VALIDATION_REGISTRATION = \"/api/user/v1/validation/registration\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk5ODg5OA==", "bodyText": "updated to URL_VALIDATE_REGISTRATION_FIELDS", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459998898", "createdAt": "2020-07-24T11:33:17Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/http/constants/ApiConstants.java", "diffHunk": "@@ -32,6 +32,8 @@\n \n     public static final String URL_REGISTRATION = \"/user_api/{\" + API_VERSION + \"}/account/registration/\";\n \n+    public static final String URL_VALIDATION_REGISTRATION = \"/api/user/v1/validation/registration\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk2MTQzNw=="}, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MDcxNDcwOnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDoyMjoyOVrOG2qZ3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMTo0Mzo0OVrOG2sWhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3MTAzOA==", "bodyText": "IMO, it should be \"getRegistrationParameters\"", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459971038", "createdAt": "2020-07-24T10:22:29Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "diffHunk": "@@ -368,6 +391,46 @@ public void onClick(DialogInterface dialog, int which) {\n         task.execute();\n     }\n \n+    private Bundle getRegistrationParameter() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 173}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAwMjk1MQ==", "bodyText": "Renamed.", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r460002951", "createdAt": "2020-07-24T11:43:49Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "diffHunk": "@@ -368,6 +391,46 @@ public void onClick(DialogInterface dialog, int which) {\n         task.execute();\n     }\n \n+    private Bundle getRegistrationParameter() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3MTAzOA=="}, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 173}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MDcxNjUwOnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDoyMzoxMVrOG2qa7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMTo0Mzo1OVrOG2sW2g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3MTMxMA==", "bodyText": "remove irrelevant comment or update it", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459971310", "createdAt": "2020-07-24T10:23:11Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "diffHunk": "@@ -368,6 +391,46 @@ public void onClick(DialogInterface dialog, int which) {\n         task.execute();\n     }\n \n+    private Bundle getRegistrationParameter() {\n+        boolean hasError = false;\n+        // prepare query (POST body)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 175}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAwMzAzNA==", "bodyText": "removed.", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r460003034", "createdAt": "2020-07-24T11:43:59Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "diffHunk": "@@ -368,6 +391,46 @@ public void onClick(DialogInterface dialog, int which) {\n         task.execute();\n     }\n \n+    private Bundle getRegistrationParameter() {\n+        boolean hasError = false;\n+        // prepare query (POST body)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk3MTMxMA=="}, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 175}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MDc4Njk3OnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/authentication/LoginService.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMDo1MDozMVrOG2rFoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMTozNToyOVrOG2sKIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk4MjI0MQ==", "bodyText": "IMO, can we make the doc a bit simple?", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459982241", "createdAt": "2020-07-24T10:50:31Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/authentication/LoginService.java", "diffHunk": "@@ -41,6 +42,17 @@ public LoginService get() {\n         }\n     }\n \n+\n+    /**\n+     * Depending on the query parameters for this endpoint, a different action will be triggered", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk5OTc3OA==", "bodyText": "done.", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459999778", "createdAt": "2020-07-24T11:35:29Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/authentication/LoginService.java", "diffHunk": "@@ -41,6 +42,17 @@ public LoginService get() {\n         }\n     }\n \n+\n+    /**\n+     * Depending on the query parameters for this endpoint, a different action will be triggered", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk4MjI0MQ=="}, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MDg1MzMxOnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMToxNzowMVrOG2rtug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMjowNDo1MFrOG2s4DQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk5MjUwNg==", "bodyText": "Can we make a common function for this as L:329 has the same code", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459992506", "createdAt": "2020-07-24T11:17:01Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "diffHunk": "@@ -183,6 +189,62 @@ public void onClick(View v) {\n         tryToSetUIInteraction(true);\n     }\n \n+    private void validateRegistrationFields() {\n+        Bundle parameters = getRegistrationParameter();\n+        if (parameters == null) {\n+            return;\n+        }\n+        showProgress();\n+        final Map<String, String> parameterMap = new HashMap<>();\n+        for (String key : parameters.keySet()) {\n+            parameterMap.put(key, parameters.getString(key));\n+        }\n+        Call<JsonObject> validateRegistrationFields = loginService.validateRegistrationFields(parameterMap);\n+        validateRegistrationFields.enqueue(new ErrorHandlingCallback<JsonObject>(this) {\n+            @Override\n+            protected void onResponse(@NonNull JsonObject responseBody) {\n+                final Type stringMapType = new TypeToken<HashMap<String, String>>() {\n+                }.getType();\n+                final HashMap<String, String> messageBody = new Gson().fromJson(responseBody.get(\"validation_decisions\"), stringMapType);\n+                if (hasValidationError(messageBody)) {\n+                    hideProgress();\n+                } else {\n+                    createAccount(parameters);\n+                }\n+            }\n+\n+            @Override\n+            protected void onFailure(@NonNull Throwable error) {\n+                hideProgress();\n+                RegisterActivity.this.showAlertDialog(null, ErrorUtils.getErrorMessage(error,\n+                        RegisterActivity.this));\n+                logger.error(error);\n+            }\n+        });\n+    }\n+\n+    private boolean hasValidationError(HashMap<String, String> messageBody) {\n+        boolean errorShown = false;\n+        for (String key : messageBody.keySet()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDAxMTUzMw==", "bodyText": "I already tried but both lines of codes have the following differences.\n\nUsing Difference HashMap types.\nThe availability of error messages are different.\nScenarios Conditions.\n\nAlso, the effort is more than it's worth to create a common method.", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r460011533", "createdAt": "2020-07-24T12:04:50Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "diffHunk": "@@ -183,6 +189,62 @@ public void onClick(View v) {\n         tryToSetUIInteraction(true);\n     }\n \n+    private void validateRegistrationFields() {\n+        Bundle parameters = getRegistrationParameter();\n+        if (parameters == null) {\n+            return;\n+        }\n+        showProgress();\n+        final Map<String, String> parameterMap = new HashMap<>();\n+        for (String key : parameters.keySet()) {\n+            parameterMap.put(key, parameters.getString(key));\n+        }\n+        Call<JsonObject> validateRegistrationFields = loginService.validateRegistrationFields(parameterMap);\n+        validateRegistrationFields.enqueue(new ErrorHandlingCallback<JsonObject>(this) {\n+            @Override\n+            protected void onResponse(@NonNull JsonObject responseBody) {\n+                final Type stringMapType = new TypeToken<HashMap<String, String>>() {\n+                }.getType();\n+                final HashMap<String, String> messageBody = new Gson().fromJson(responseBody.get(\"validation_decisions\"), stringMapType);\n+                if (hasValidationError(messageBody)) {\n+                    hideProgress();\n+                } else {\n+                    createAccount(parameters);\n+                }\n+            }\n+\n+            @Override\n+            protected void onFailure(@NonNull Throwable error) {\n+                hideProgress();\n+                RegisterActivity.this.showAlertDialog(null, ErrorUtils.getErrorMessage(error,\n+                        RegisterActivity.this));\n+                logger.error(error);\n+            }\n+        });\n+    }\n+\n+    private boolean hasValidationError(HashMap<String, String> messageBody) {\n+        boolean errorShown = false;\n+        for (String key : messageBody.keySet()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk5MjUwNg=="}, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 91}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3MDg2NTM2OnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMToyMTozMFrOG2r0pA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNFQxMTozNjowNFrOG2sK_g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk5NDI3Ng==", "bodyText": "Can we use a constant for \"validation_decisions\"", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459994276", "createdAt": "2020-07-24T11:21:30Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "diffHunk": "@@ -183,6 +189,62 @@ public void onClick(View v) {\n         tryToSetUIInteraction(true);\n     }\n \n+    private void validateRegistrationFields() {\n+        Bundle parameters = getRegistrationParameter();\n+        if (parameters == null) {\n+            return;\n+        }\n+        showProgress();\n+        final Map<String, String> parameterMap = new HashMap<>();\n+        for (String key : parameters.keySet()) {\n+            parameterMap.put(key, parameters.getString(key));\n+        }\n+        Call<JsonObject> validateRegistrationFields = loginService.validateRegistrationFields(parameterMap);\n+        validateRegistrationFields.enqueue(new ErrorHandlingCallback<JsonObject>(this) {\n+            @Override\n+            protected void onResponse(@NonNull JsonObject responseBody) {\n+                final Type stringMapType = new TypeToken<HashMap<String, String>>() {\n+                }.getType();\n+                final HashMap<String, String> messageBody = new Gson().fromJson(responseBody.get(\"validation_decisions\"), stringMapType);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 71}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk5OTk5OA==", "bodyText": "Declare in ApiConstants.java named VALIDATION_DECISIONS", "url": "https://github.com/edx/edx-app-android/pull/1442#discussion_r459999998", "createdAt": "2020-07-24T11:36:04Z", "author": {"login": "farhan-arshad-dev"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/RegisterActivity.java", "diffHunk": "@@ -183,6 +189,62 @@ public void onClick(View v) {\n         tryToSetUIInteraction(true);\n     }\n \n+    private void validateRegistrationFields() {\n+        Bundle parameters = getRegistrationParameter();\n+        if (parameters == null) {\n+            return;\n+        }\n+        showProgress();\n+        final Map<String, String> parameterMap = new HashMap<>();\n+        for (String key : parameters.keySet()) {\n+            parameterMap.put(key, parameters.getString(key));\n+        }\n+        Call<JsonObject> validateRegistrationFields = loginService.validateRegistrationFields(parameterMap);\n+        validateRegistrationFields.enqueue(new ErrorHandlingCallback<JsonObject>(this) {\n+            @Override\n+            protected void onResponse(@NonNull JsonObject responseBody) {\n+                final Type stringMapType = new TypeToken<HashMap<String, String>>() {\n+                }.getType();\n+                final HashMap<String, String> messageBody = new Gson().fromJson(responseBody.get(\"validation_decisions\"), stringMapType);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk5NDI3Ng=="}, "originalCommit": {"oid": "3600dfc92e94dee01034a6c5101ea6a2052092cd"}, "originalPosition": 71}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 570, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}