{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc0NzgyMzM4", "number": 1455, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNTo0NzowNFrOEdSE6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjoyNDozNFrOEdS_hQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MTQwMzI4OnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNTo0NzowNFrOHIWhOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjozNjo1M1rOHIYcpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODUxOTYwOQ==", "bodyText": "This should be called enrolledCoursesCall", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478519609", "createdAt": "2020-08-27T15:47:04Z", "author": {"login": "miankhalid"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -49,6 +49,7 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n     @Inject\n     private lateinit var courseAPI: CourseAPI\n     private lateinit var errorNotification: FullScreenErrorNotification\n+    private lateinit var enrolledCoursesApi: Call<List<EnrolledCoursesResponse>>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU1MTIwNw==", "bodyText": "Done", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478551207", "createdAt": "2020-08-27T16:36:53Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -49,6 +49,7 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n     @Inject\n     private lateinit var courseAPI: CourseAPI\n     private lateinit var errorNotification: FullScreenErrorNotification\n+    private lateinit var enrolledCoursesApi: Call<List<EnrolledCoursesResponse>>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODUxOTYwOQ=="}, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MTQxOTEyOnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNTo1MDo1NVrOHIWrFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjozNzoyNFrOHIYdwQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODUyMjEzMg==", "bodyText": "comment not needed.", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478522132", "createdAt": "2020-08-27T15:50:55Z", "author": {"login": "miankhalid"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -100,13 +101,15 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n     override fun onResume() {\n         super.onResume()\n         if (refreshOnResume) {\n-            loadData(showProgress = false, isCached = true)\n+            loadData(showProgress = true, isCached = true)\n             refreshOnResume = false\n         }\n     }\n \n     override fun onDestroy() {\n         super.onDestroy()\n+        // Cancel the api call in case of activity destroy", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU1MTQ4OQ==", "bodyText": "comment removed", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478551489", "createdAt": "2020-08-27T16:37:24Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -100,13 +101,15 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n     override fun onResume() {\n         super.onResume()\n         if (refreshOnResume) {\n-            loadData(showProgress = false, isCached = true)\n+            loadData(showProgress = true, isCached = true)\n             refreshOnResume = false\n         }\n     }\n \n     override fun onDestroy() {\n         super.onDestroy()\n+        // Cancel the api call in case of activity destroy", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODUyMjEzMg=="}, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MTQ2MDczOnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjowMDo1NlrOHIXEwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjozNzoxM1rOHIYdVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODUyODcwNA==", "bodyText": "why was this changed?", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478528704", "createdAt": "2020-08-27T16:00:56Z", "author": {"login": "miankhalid"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -100,13 +101,15 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n     override fun onResume() {\n         super.onResume()\n         if (refreshOnResume) {\n-            loadData(showProgress = false, isCached = true)\n+            loadData(showProgress = true, isCached = true)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU1MTM4MQ==", "bodyText": "Change reverted", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478551381", "createdAt": "2020-08-27T16:37:13Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -100,13 +101,15 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n     override fun onResume() {\n         super.onResume()\n         if (refreshOnResume) {\n-            loadData(showProgress = false, isCached = true)\n+            loadData(showProgress = true, isCached = true)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODUyODcwNA=="}, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MTUzNDc0OnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjoxOTo0NlrOHIXy1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjo0MDo0NVrOHIYllg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU0MDUwMQ==", "bodyText": "isCached should be renamed to fromCache and javadoc should be updated accordingly.", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478540501", "createdAt": "2020-08-27T16:19:46Z", "author": {"login": "miankhalid"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -124,23 +127,20 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n             binding.loadingIndicator.root.visibility = View.VISIBLE\n             errorNotification.hideError()\n         }\n-        if (isCached) {\n-            getUserEnrolledCourses(courseAPI.enrolledCoursesFromCache, isCached = true)\n-        } else {\n-            getUserEnrolledCourses(courseAPI.enrolledCourses)\n-        }\n+        enrolledCoursesApi = if (isCached) courseAPI.enrolledCoursesFromCache else courseAPI.enrolledCourses", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU1MzQ5NA==", "bodyText": "Renamed", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478553494", "createdAt": "2020-08-27T16:40:45Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -124,23 +127,20 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n             binding.loadingIndicator.root.visibility = View.VISIBLE\n             errorNotification.hideError()\n         }\n-        if (isCached) {\n-            getUserEnrolledCourses(courseAPI.enrolledCoursesFromCache, isCached = true)\n-        } else {\n-            getUserEnrolledCourses(courseAPI.enrolledCourses)\n-        }\n+        enrolledCoursesApi = if (isCached) courseAPI.enrolledCoursesFromCache else courseAPI.enrolledCourses", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU0MDUwMQ=="}, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk5MTU1MzMzOnYy", "diffSide": "RIGHT", "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjoyNDozNFrOHIX-ng==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yN1QxNjo1MjoxM1rOHIZATQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU0MzUxOA==", "bodyText": "Should add a comment here:\n// Fetch latest data from server in the background after displaying previously cached data", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478543518", "createdAt": "2020-08-27T16:24:34Z", "author": {"login": "miankhalid"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -124,23 +127,20 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n             binding.loadingIndicator.root.visibility = View.VISIBLE\n             errorNotification.hideError()\n         }\n-        if (isCached) {\n-            getUserEnrolledCourses(courseAPI.enrolledCoursesFromCache, isCached = true)\n-        } else {\n-            getUserEnrolledCourses(courseAPI.enrolledCourses)\n-        }\n+        enrolledCoursesApi = if (isCached) courseAPI.enrolledCoursesFromCache else courseAPI.enrolledCourses\n+        getUserEnrolledCourses(isCached)\n     }\n \n-    private fun getUserEnrolledCourses(enrolledCoursesApi: Call<List<EnrolledCoursesResponse>>, isCached: Boolean = false) {\n+    private fun getUserEnrolledCourses(isCached: Boolean = false) {\n         enrolledCoursesApi.enqueue(object : Callback<List<EnrolledCoursesResponse>> {\n             override fun onResponse(call: Call<List<EnrolledCoursesResponse>>, response: Response<List<EnrolledCoursesResponse>>) {\n                 if (response.isSuccessful && response.code() == HttpStatus.OK) {\n                     populateCourseData(ArrayList(response.body()), isCachedData = isCached)\n                     if (isCached) {\n-                        getUserEnrolledCourses(courseAPI.enrolledCourses)\n+                        loadData(showProgress = response.body()?.isEmpty() == true, isCached = false)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU2MDMzMw==", "bodyText": "Done", "url": "https://github.com/edx/edx-app-android/pull/1455#discussion_r478560333", "createdAt": "2020-08-27T16:52:13Z", "author": {"login": "omerhabib26"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/MyCoursesListFragment.kt", "diffHunk": "@@ -124,23 +127,20 @@ class MyCoursesListFragment : OfflineSupportBaseFragment(), RefreshListener {\n             binding.loadingIndicator.root.visibility = View.VISIBLE\n             errorNotification.hideError()\n         }\n-        if (isCached) {\n-            getUserEnrolledCourses(courseAPI.enrolledCoursesFromCache, isCached = true)\n-        } else {\n-            getUserEnrolledCourses(courseAPI.enrolledCourses)\n-        }\n+        enrolledCoursesApi = if (isCached) courseAPI.enrolledCoursesFromCache else courseAPI.enrolledCourses\n+        getUserEnrolledCourses(isCached)\n     }\n \n-    private fun getUserEnrolledCourses(enrolledCoursesApi: Call<List<EnrolledCoursesResponse>>, isCached: Boolean = false) {\n+    private fun getUserEnrolledCourses(isCached: Boolean = false) {\n         enrolledCoursesApi.enqueue(object : Callback<List<EnrolledCoursesResponse>> {\n             override fun onResponse(call: Call<List<EnrolledCoursesResponse>>, response: Response<List<EnrolledCoursesResponse>>) {\n                 if (response.isSuccessful && response.code() == HttpStatus.OK) {\n                     populateCourseData(ArrayList(response.body()), isCachedData = isCached)\n                     if (isCached) {\n-                        getUserEnrolledCourses(courseAPI.enrolledCourses)\n+                        loadData(showProgress = response.body()?.isEmpty() == true, isCached = false)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3ODU0MzUxOA=="}, "originalCommit": {"oid": "1cafe0e56bb1aceb07238cdcc29b22d07981d734"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 582, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}