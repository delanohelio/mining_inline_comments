{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgyOTEzNjk0", "number": 1379, "title": "Resolve IllegalStateException crash initiated by YouTube Player", "bodyText": "Description\nLEARNER-7638\n\nYouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\nforcefully kill the YouTube app before and moves back in the app.\n\nReproduce Steps:\n\nCourse Dashboard > Play some Youtube video\nPause the video > tap on \"more videos\" button\nSelect any video from the list, it will load the Youtube interface.\nKill the YouTube App and moves back to the edx app, it will crash app.", "createdAt": "2020-03-03T12:07:39Z", "url": "https://github.com/edx/edx-app-android/pull/1379", "merged": true, "mergeCommit": {"oid": "0c346be42caf4ff74b3efc26c0181d4111836b35"}, "closed": true, "closedAt": "2020-03-06T14:41:09Z", "author": {"login": "farhan-arshad-dev"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKBOHhgBqjMwOTE4OTMyODQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLA1FhAFqTM3MDM1MjEzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e84c33ebc6bb873b673573094185114de1f49152", "author": {"user": {"login": "farhan-arshad-dev", "name": "Farhan Arshad"}}, "url": "https://github.com/edx/edx-app-android/commit/e84c33ebc6bb873b673573094185114de1f49152", "committedDate": "2020-03-03T11:59:49Z", "message": "Resolve IllegalStateException crash reproduce by YouTubePlayerSupportFragment\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app before and moves back in the app."}, "afterCommit": {"oid": "a0aa29776689d9dfed4dee5c6e229dfca6116842", "author": {"user": {"login": "farhan-arshad-dev", "name": "Farhan Arshad"}}, "url": "https://github.com/edx/edx-app-android/commit/a0aa29776689d9dfed4dee5c6e229dfca6116842", "committedDate": "2020-03-03T12:09:03Z", "message": "Handle IllegalStateException crash reproduce by YouTube Player Fragment\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMjg2MDg1", "url": "https://github.com/edx/edx-app-android/pull/1379#pullrequestreview-370286085", "createdAt": "2020-03-06T12:28:18Z", "commit": {"oid": "a0aa29776689d9dfed4dee5c6e229dfca6116842"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMjoyODoxOFrOFy3E5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMzozMDoyMlrOFy4ulg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg3NTQ5Mw==", "bodyText": "Apply try catch to this line only", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388875493", "createdAt": "2020-03-06T12:28:18Z", "author": {"login": "farhan"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitYoutubePlayerFragment.java", "diffHunk": "@@ -114,8 +114,18 @@ protected long getPlayerCurrentPosition() {\n \n     @Override\n     protected void setFullScreen(boolean fullscreen) {\n-        if (youTubePlayer != null) {\n-            youTubePlayer.setFullscreen(fullscreen);\n+        /* Some times `YouTubePlayerSupportFragment` throws the `IllegalStateException` when user moves\n+         * back after forcefully kill the YouTube app so catch the exception and reinitialize the\n+         * YouTube Player to play the YouTube based video content\n+         */\n+        try {\n+            if (youTubePlayer != null) {\n+                youTubePlayer.setFullscreen(fullscreen);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0aa29776689d9dfed4dee5c6e229dfca6116842"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODg5OTYzNg==", "bodyText": "/*\n         * If the youtube player is not in a proper state than it throws the  IllegalStateException.\n         * To avoid the crash and continue the flow we are reinitializing the player here.\n         * \n         * It may occur when the edX app was in background and user kills the device youtube app\n         */\n\n\nIt seems better comment.", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388899636", "createdAt": "2020-03-06T13:24:13Z", "author": {"login": "farhan"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitYoutubePlayerFragment.java", "diffHunk": "@@ -114,8 +114,18 @@ protected long getPlayerCurrentPosition() {\n \n     @Override\n     protected void setFullScreen(boolean fullscreen) {\n-        if (youTubePlayer != null) {\n-            youTubePlayer.setFullscreen(fullscreen);\n+        /* Some times `YouTubePlayerSupportFragment` throws the `IllegalStateException` when user moves", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0aa29776689d9dfed4dee5c6e229dfca6116842"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwMjU1MA==", "bodyText": "Same comment", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388902550", "createdAt": "2020-03-06T13:30:22Z", "author": {"login": "farhan"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -109,6 +109,18 @@ public void onPageScrollStateChanged(int state) {\n         mNextBtn.setOnClickListener(view -> navigateNextComponent());\n     }\n \n+    @Override\n+    public void onSaveInstanceState(Bundle outState) {\n+        /* Some times `YouTubePlayerSupportFragment` throws the `IllegalStateException` when user moves", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0aa29776689d9dfed4dee5c6e229dfca6116842"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a0aa29776689d9dfed4dee5c6e229dfca6116842", "author": {"user": {"login": "farhan-arshad-dev", "name": "Farhan Arshad"}}, "url": "https://github.com/edx/edx-app-android/commit/a0aa29776689d9dfed4dee5c6e229dfca6116842", "committedDate": "2020-03-03T12:09:03Z", "message": "Handle IllegalStateException crash reproduce by YouTube Player Fragment\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app."}, "afterCommit": {"oid": "2c8bd4d985ee51311329d84c84fce5a3850b800f", "author": {"user": {"login": "farhan-arshad-dev", "name": "Farhan Arshad"}}, "url": "https://github.com/edx/edx-app-android/commit/2c8bd4d985ee51311329d84c84fce5a3850b800f", "committedDate": "2020-03-06T13:35:25Z", "message": "Handle IllegalStateException crash reproduce by YouTube Player Fragment\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMzI2NTU4", "url": "https://github.com/edx/edx-app-android/pull/1379#pullrequestreview-370326558", "createdAt": "2020-03-06T13:39:13Z", "commit": {"oid": "2c8bd4d985ee51311329d84c84fce5a3850b800f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMzI5MDE5", "url": "https://github.com/edx/edx-app-android/pull/1379#pullrequestreview-370329019", "createdAt": "2020-03-06T13:43:12Z", "commit": {"oid": "2c8bd4d985ee51311329d84c84fce5a3850b800f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMzo0MzoxM1rOFy5GtQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMzo0Mzo1OVrOFy5IQw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwODcyNQ==", "bodyText": "2 nits:\n\nthen instead of than.\nremove extra space before IllegalStateException.", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388908725", "createdAt": "2020-03-06T13:43:13Z", "author": {"login": "miankhalid"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -109,6 +109,21 @@ public void onPageScrollStateChanged(int state) {\n         mNextBtn.setOnClickListener(view -> navigateNextComponent());\n     }\n \n+    @Override\n+    public void onSaveInstanceState(Bundle outState) {\n+        /*\n+         * If the youtube player is not in a proper state than it throws the  IllegalStateException.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c8bd4d985ee51311329d84c84fce5a3850b800f"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwODkyMQ==", "bodyText": "the on-device YouTube app.", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388908921", "createdAt": "2020-03-06T13:43:35Z", "author": {"login": "miankhalid"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitNavigationActivity.java", "diffHunk": "@@ -109,6 +109,21 @@ public void onPageScrollStateChanged(int state) {\n         mNextBtn.setOnClickListener(view -> navigateNextComponent());\n     }\n \n+    @Override\n+    public void onSaveInstanceState(Bundle outState) {\n+        /*\n+         * If the youtube player is not in a proper state than it throws the  IllegalStateException.\n+         * To avoid the crash and continue the flow we are catching the exception.\n+         *\n+         * It may occur when the edX app was in background and user kills the device youtube app", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c8bd4d985ee51311329d84c84fce5a3850b800f"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwOTAzNg==", "bodyText": "2 nits:\n\nthen instead of than.\nremove extra space before IllegalStateException.", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388909036", "createdAt": "2020-03-06T13:43:49Z", "author": {"login": "miankhalid"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitYoutubePlayerFragment.java", "diffHunk": "@@ -114,8 +114,20 @@ protected long getPlayerCurrentPosition() {\n \n     @Override\n     protected void setFullScreen(boolean fullscreen) {\n+        /*\n+         * If the youtube player is not in a proper state than it throws the  IllegalStateException.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c8bd4d985ee51311329d84c84fce5a3850b800f"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwOTEyMw==", "bodyText": "the on-device YouTube app.", "url": "https://github.com/edx/edx-app-android/pull/1379#discussion_r388909123", "createdAt": "2020-03-06T13:43:59Z", "author": {"login": "miankhalid"}, "path": "OpenEdXMobile/src/main/java/org/edx/mobile/view/CourseUnitYoutubePlayerFragment.java", "diffHunk": "@@ -114,8 +114,20 @@ protected long getPlayerCurrentPosition() {\n \n     @Override\n     protected void setFullScreen(boolean fullscreen) {\n+        /*\n+         * If the youtube player is not in a proper state than it throws the  IllegalStateException.\n+         * To avoid the crash and continue the flow we are reinitializing the player here.\n+         *\n+         * It may occur when the edX app was in background and user kills the device youtube app", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c8bd4d985ee51311329d84c84fce5a3850b800f"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7339376f075c670bacd12268f4e7dd38ea38c383", "author": {"user": {"login": "farhan-arshad-dev", "name": "Farhan Arshad"}}, "url": "https://github.com/edx/edx-app-android/commit/7339376f075c670bacd12268f4e7dd38ea38c383", "committedDate": "2020-03-06T14:14:15Z", "message": "Resolve IllegalStateException crash initiated by YouTube Player\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2c8bd4d985ee51311329d84c84fce5a3850b800f", "author": {"user": {"login": "farhan-arshad-dev", "name": "Farhan Arshad"}}, "url": "https://github.com/edx/edx-app-android/commit/2c8bd4d985ee51311329d84c84fce5a3850b800f", "committedDate": "2020-03-06T13:35:25Z", "message": "Handle IllegalStateException crash reproduce by YouTube Player Fragment\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app."}, "afterCommit": {"oid": "7339376f075c670bacd12268f4e7dd38ea38c383", "author": {"user": {"login": "farhan-arshad-dev", "name": "Farhan Arshad"}}, "url": "https://github.com/edx/edx-app-android/commit/7339376f075c670bacd12268f4e7dd38ea38c383", "committedDate": "2020-03-06T14:14:15Z", "message": "Resolve IllegalStateException crash initiated by YouTube Player\n\n- LEARNER-7638\n- YouTubePlayerSupportFragment throw the \"IllegalStateException\" when user\n  forcefully kill the YouTube app and moves back-in the app."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwMzUyMTM1", "url": "https://github.com/edx/edx-app-android/pull/1379#pullrequestreview-370352135", "createdAt": "2020-03-06T14:17:14Z", "commit": {"oid": "7339376f075c670bacd12268f4e7dd38ea38c383"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4143, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}