{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyNDYyOTAz", "number": 8226, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMToyNjo0MlrOEzfTSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMToyNjo0MlrOEzfTSA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIyNDI1NjcyOnYy", "diffSide": "RIGHT", "path": "src/cpp/r/R/Api.R", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMToyNjo0MlrOHqvV1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQyMToyNjo0MlrOHqvV1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDU3Nzg3OQ==", "bodyText": "nit: should we do this in an on.exit so that an error condition doesn't leave the altered path as a side effect?", "url": "https://github.com/rstudio/rstudio/pull/8226#discussion_r514577879", "createdAt": "2020-10-29T21:26:42Z", "author": {"login": "jmcphers"}, "path": "src/cpp/r/R/Api.R", "diffHunk": "@@ -65,11 +65,14 @@\n    # attempt to initialize a project within that directory\n    .rs.ensureDirectory(path)\n    \n-   # check to see if a .Rproj file already exists in that directory;\n-   # if so, then we don't need to re-initialize\n-   rProjFiles <- list.files(path, \n-                            pattern = \"[.]Rproj$\",\n-                            full.names = TRUE)\n+   # NOTE: list.files() will fail on Windows for paths containing\n+   # characters not representable in the current locale, so we instead\n+   # change to the requested directory, list files, and then build the\n+   # full paths\n+   owd <- setwd(path)\n+   rProjFiles <- list.files(pattern = \"[.]Rproj$\")\n+   rProjFiles <- normalizePath(rProjFiles, winslash = \"/\", mustWork = TRUE)\n+   setwd(owd)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e7e0f26540e3eb9798db280c4df15572069a0a8"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4170, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}