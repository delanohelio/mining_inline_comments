{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzMjk5MTYy", "number": 6520, "title": "allow configuring graphics device type, antialias", "bodyText": "This PR makes it possible to configure some parameters of the graphics device created by RStudio. In particular:\n\nThe backend (ie: Quartz vs. Windows vs. Cairo);\nWhether anti-aliasing is used for the generated plots.\n\nThis will primarily be useful on Windows, where users have often wished they could use Cairo as opposed to the default Windows graphics backend.\nCloses #2142.", "createdAt": "2020-03-24T23:06:53Z", "url": "https://github.com/rstudio/rstudio/pull/6520", "merged": true, "mergeCommit": {"oid": "3111a2c24d7af818a38d3af2018f505808ae26b5"}, "closed": true, "closedAt": "2020-03-26T20:18:20Z", "author": {"login": "kevinushey"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQ6vSggH2gAyMzkzMjk5MTYyOjYxY2RiNmY4NjkwYmVkMzU3ZThhOGYzNmNjMjg0Y2Q3MDFhZTJiYzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRN-J5gH2gAyMzkzMjk5MTYyOmNkNzIwZjU4NmVhYWM5YjY3NDc4NWU3MTM1NDJiM2VjM2IyYWYyNGY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "61cdb6f8690bed357e8a8f36cc284cd701ae2bc4", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/61cdb6f8690bed357e8a8f36cc284cd701ae2bc4", "committedDate": "2020-03-24T22:35:01Z", "message": "allow configuring graphics device type, antialias"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b68ad72320ebe433670b4984b8c6a81c6666dc37", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/b68ad72320ebe433670b4984b8c6a81c6666dc37", "committedDate": "2020-03-24T22:41:29Z", "message": "guard against 'windows' on non-Windows machine"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db8923119a66671c1ce2f1568935c547961d2fd1", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/db8923119a66671c1ce2f1568935c547961d2fd1", "committedDate": "2020-03-24T22:57:32Z", "message": "define shared constants"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d4f6451bd3a455592c964a1cb4c27c446a53d13c", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/d4f6451bd3a455592c964a1cb4c27c446a53d13c", "committedDate": "2020-03-24T23:06:31Z", "message": "fixup antialias for Windows"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac6f96a008770911ea6b862ef0b76c1de698d786", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/ac6f96a008770911ea6b862ef0b76c1de698d786", "committedDate": "2020-03-25T04:03:26Z", "message": "sync with prefs on load"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd96a8e0b3c72a745fe3c70c7d0b399229071d6b", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/cd96a8e0b3c72a745fe3c70c7d0b399229071d6b", "committedDate": "2020-03-25T04:06:36Z", "message": "change antialias for both default, windows"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgwODcxNjM3", "url": "https://github.com/rstudio/rstudio/pull/6520#pullrequestreview-380871637", "createdAt": "2020-03-25T05:47:39Z", "commit": {"oid": "cd96a8e0b3c72a745fe3c70c7d0b399229071d6b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDM0MjEy", "url": "https://github.com/rstudio/rstudio/pull/6520#pullrequestreview-381434212", "createdAt": "2020-03-25T18:40:14Z", "commit": {"oid": "cd96a8e0b3c72a745fe3c70c7d0b399229071d6b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxODo0MDoxNFrOF7pPEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxODo0MDoxNFrOF7pPEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA4NTkwNg==", "bodyText": "Do we also need to e.g. ignore cairo if the pref was set on a machine that had cairo but then read on a machine that didn't? (feels like we should just get the set of supported backends here and double check that the pref is included)", "url": "https://github.com/rstudio/rstudio/pull/6520#discussion_r398085906", "createdAt": "2020-03-25T18:40:14Z", "author": {"login": "jmcphers"}, "path": "src/cpp/r/session/graphics/RGraphicsUtils.cpp", "diffHunk": "@@ -150,29 +154,48 @@ bool validateRequirements(std::string* pMessage)\n \n std::string extraBitmapParams()\n {\n-#if defined(_WIN32)\n-\n-   // no extra params for windows\n-\n-#elif defined(__APPLE__)\n-\n-   return \", type = \\\"quartz\\\", antialias=\\\"default\\\"\";\n-\n-#else\n-\n-   // if bitmapType is Xlib then force cairo if we can\n-   if (r::options::getOption<std::string>(\"bitmapType\") == \"Xlib\")\n-   {\n-      if (r::util::hasRequiredVersion(\"2.14\") &&\n-          r::util::hasCapability(\"cairo\"))\n-      {\n-         return \", type = \\\"cairo\\\"\";\n-      }\n-   }\n-\n+   std::vector<std::string> params;\n+   \n+   std::string backend = r::options::getOption<std::string>(\n+            kGraphicsOptionBackend,\n+            \"default\",\n+            false);\n+   \n+#ifndef __APPLE__\n+   // silently ignore 'quartz' on non-macOS platforms\n+   // (assume this would arise if one copied UI prefs across different machines)\n+   if (backend == \"quartz\")\n+      backend = \"default\";\n+#endif\n+   \n+#ifndef _WIN32\n+   // silently ignore 'windows' on non-Windows platforms\n+   // (assume this would arise if one copied UI prefs across different machines)\n+   if (backend == \"windows\")\n+      backend = \"default\";\n+#endif\n+   ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd96a8e0b3c72a745fe3c70c7d0b399229071d6b"}, "originalPosition": 75}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd720f586eaac9b674785e713542b3ec3b2af24f", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/cd720f586eaac9b674785e713542b3ec3b2af24f", "committedDate": "2020-03-25T20:59:27Z", "message": "validate that we have a supported backend"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 301, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}