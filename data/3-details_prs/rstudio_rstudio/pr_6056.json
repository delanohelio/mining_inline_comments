{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NDk4ODg0", "number": 6056, "title": "Avoid stealing focus when closing tabs", "bodyText": "This change fixes an annoying issue with focus while debugging, which is that the cursor jumps into the Source pane a lot more than most people expect.\nThe reason this occurs is somewhat involved (see #6039 for details). The short version is that we open tabs to view source code while stepping through instructions, then automatically close those tabs when we are done stepping. The problem is that closing a tab always causes us to open and then immediately focus the adjacent tab -- regardless of where focus was before.\nThe fix is to use a custom selection event that carries information about whether we had focus when the tab was closed, and to only restore focus if we had it in the first place.\nFixes #6039.", "createdAt": "2020-01-19T05:45:25Z", "url": "https://github.com/rstudio/rstudio/pull/6056", "merged": true, "mergeCommit": {"oid": "a936a87aec80bf22ae45ba13ead8ef2a9bd2d2a5"}, "closed": true, "closedAt": "2020-01-20T20:51:51Z", "author": {"login": "jmcphers"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7xPMIAH2gAyMzY0NDk4ODg0OjQ4OTM4OWM4NGFlMTJjNWEwYzBiMmU3ODZkOTkzMWY0YmEyYWE2YTU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb774AZAFqTM0NTAxNjcwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "489389c84ae12c5a0c0b2e786d9931f4ba2aa6a5", "author": {"user": {"login": "jmcphers", "name": "Jonathan"}}, "url": "https://github.com/rstudio/rstudio/commit/489389c84ae12c5a0c0b2e786d9931f4ba2aa6a5", "committedDate": "2020-01-19T05:38:24Z", "message": "avoid stealing focus when closing tabs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MDE2NzA0", "url": "https://github.com/rstudio/rstudio/pull/6056#pullrequestreview-345016704", "createdAt": "2020-01-19T18:01:00Z", "commit": {"oid": "489389c84ae12c5a0c0b2e786d9931f4ba2aa6a5"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOVQxODowMTowMFrOFfP7Pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOVQxODowMTowMFrOFfP7Pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODMxMTEwMg==", "bodyText": "This would be nice to have as a DomUtils.containsFocus() method, will be needing that for some related work I'll be doing.", "url": "https://github.com/rstudio/rstudio/pull/6056#discussion_r368311102", "createdAt": "2020-01-19T18:01:00Z", "author": {"login": "gtritchie"}, "path": "src/gwt/src/org/rstudio/core/client/theme/DocTabLayoutPanel.java", "diffHunk": "@@ -237,7 +237,16 @@ public void moveTab(int index, int delta)\n    @Override\n    public void selectTab(int index)\n    {\n-      super.selectTab(index);\n+      // select the tab, but don't fire events (we need to fire our own)\n+      super.selectTab(index, false);\n+      \n+      // determine whether focus is currently inside the container\n+      boolean focused = DomUtils.contains(getElement(), DomUtils.getActiveElement());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "489389c84ae12c5a0c0b2e786d9931f4ba2aa6a5"}, "originalPosition": 9}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 428, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}