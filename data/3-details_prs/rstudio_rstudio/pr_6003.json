{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxOTM3NzA5", "number": 6003, "title": "use aria-pressed to make LatchingToolbarButton a toggle button", "bodyText": "in one use of this control (for showing/hiding document outline), the accessibility text is changed to indicate the state of the button; in that situation it is NOT appropriate to use aria-pressed as the text is sufficient to tell screen readers what is going on\nin the other use, the Filter button in the data viewer, the text does not change, so aria-pressed is required to indicate that this is a toggle button and to indicate what state it is currently in\n\nToggle Button example", "createdAt": "2020-01-13T05:23:27Z", "url": "https://github.com/rstudio/rstudio/pull/6003", "merged": true, "mergeCommit": {"oid": "ca808390c103cd4130cc5089a6b78fe030162de6"}, "closed": true, "closedAt": "2020-01-13T17:00:45Z", "author": {"login": "gtritchie"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb51ZSUAH2gAyMzYxOTM3NzA5OjdjZWQ0MTFjOGE3MjI4NTEwNzYxMzBhODAwOWMwNGY4MjQzN2RjZmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb54IwyAFqTM0MTY4NzkyNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7ced411c8a722851076130a8009c04f82437dcfb", "author": {"user": {"login": "gtritchie", "name": "Gary"}}, "url": "https://github.com/rstudio/rstudio/commit/7ced411c8a722851076130a8009c04f82437dcfb", "committedDate": "2020-01-13T05:21:12Z", "message": "use aria-pressed to make LatchingToolbarButton a toggle button\n\n- in one use of this control (for showing/hiding document outline), the accessibility text is changed to indicate the state of the button; in that situation it is NOT appropriate to use aria-pressed as the text is sufficient to tell screen readers what is going on\n- in the other use, the Filter button in the data viewer, the text does not change, so aria-pressed is required to indicate that this is a toggle button and to indicate what state it is currently in"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNjg3OTI2", "url": "https://github.com/rstudio/rstudio/pull/6003#pullrequestreview-341687926", "createdAt": "2020-01-13T08:32:47Z", "commit": {"oid": "7ced411c8a722851076130a8009c04f82437dcfb"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODozMjo0OFrOFcvpEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QwODozMjo0OFrOFcvpEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY4NTAxMQ==", "bodyText": "Could be worth pulling these out into a local helper method that's merely setAriaPressedState(TRUE/FALSE) and it does the if check and the longer incantation (if you ever get tired of copy/pasting all that across all these!)", "url": "https://github.com/rstudio/rstudio/pull/6003#discussion_r365685011", "createdAt": "2020-01-13T08:32:48Z", "author": {"login": "adamconroy"}, "path": "src/gwt/src/org/rstudio/core/client/widget/LatchingToolbarButton.java", "diffHunk": "@@ -39,10 +49,19 @@ public void setLatched(boolean latched)\n       latched_ = latched;\n       \n       if (latched_)\n+      {\n+         if (!textIndicatesState_)\n+            Roles.getButtonRole().setAriaPressedState(getElement(), PressedValue.TRUE);\n          getElement().addClassName(ThemeStyles.INSTANCE.toolbarButtonLatched());\n+      }\n       else\n+      {\n+         if (!textIndicatesState_)\n+            Roles.getButtonRole().setAriaPressedState(getElement(), PressedValue.FALSE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ced411c8a722851076130a8009c04f82437dcfb"}, "originalPosition": 53}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 421, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}