{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyNjU1OTM3", "number": 8415, "title": "set default cursor color for visual mode", "bodyText": "Intent\nCloses #8409.\nApproach\nNot all Ace themes define a color: for the ace_cursor CSS style. Some themes style the cursor by instead coloring the cursor element's border, or via other means.\nFor such cases, it suffices just to use a better default cursor color (white for dark themes; black for light themes).\nQA Notes\nTest that the themes enumerated in #8409 (comment) have a visible cursor in visual mode.", "createdAt": "2020-11-17T19:30:07Z", "url": "https://github.com/rstudio/rstudio/pull/8415", "merged": true, "mergeCommit": {"oid": "a57c579be7051ca68f97933faeb8454dea5ab213"}, "closed": true, "closedAt": "2020-11-17T20:52:08Z", "author": {"login": "kevinushey"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdde26NAFqTUzMjc0NjkzNQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABddf6jTgFqTUzMjgwMjA3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyNzQ2OTM1", "url": "https://github.com/rstudio/rstudio/pull/8415#pullrequestreview-532746935", "createdAt": "2020-11-17T19:38:04Z", "commit": {"oid": "6c9b4b261eb7d9b06dc3ec3358574580680f95d2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxOTozODowNFrOH1GNLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xN1QxOTozODowNFrOH1GNLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTQzODI1NA==", "bodyText": "Is this right? It looks like it will use the cursorColor only when it's empty.", "url": "https://github.com/rstudio/rstudio/pull/8415#discussion_r525438254", "createdAt": "2020-11-17T19:38:04Z", "author": {"login": "jmcphers"}, "path": "src/gwt/src/org/rstudio/studio/client/panmirror/theme/PanmirrorThemeCreator.java", "diffHunk": "@@ -37,7 +38,12 @@ public static PanmirrorTheme themeFromEditorTheme(AceTheme aceTheme, UserPrefs p\n       theme.darkMode = aceTheme.isDark();\n       theme.solarizedMode = aceTheme.isSolarizedLight();\n       \n-      theme.cursorColor = DomUtils.extractCssValue(\"ace_cursor\", \"color\");\n+      // get cursor color (guard against themes that don't set ace_cursor color)\n+      String defaultCursorColor = aceTheme.isDark() ? \"white\" : \"black\";\n+      String cursorColor = DomUtils.extractCssValue(\"ace_cursor\", \"color\");\n+      theme.cursorColor = StringUtil.isNullOrEmpty(cursorColor)\n+            ? cursorColor", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6c9b4b261eb7d9b06dc3ec3358574580680f95d2"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e42b08b132ba0cdcfc05abb99b1e093342292da0", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/e42b08b132ba0cdcfc05abb99b1e093342292da0", "committedDate": "2020-11-17T20:23:26Z", "message": "set default cursor color for visual mode"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6cdaf098fd76164447bfd6604dff7ccad1a379eb", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/6cdaf098fd76164447bfd6604dff7ccad1a379eb", "committedDate": "2020-11-17T20:23:26Z", "message": "better fixup for Ace cursor color"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "acc3c72acfc091d9cfabab334f4d1398f5f0c96a", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/acc3c72acfc091d9cfabab334f4d1398f5f0c96a", "committedDate": "2020-11-17T20:22:18Z", "message": "better fixup for Ace cursor color"}, "afterCommit": {"oid": "6cdaf098fd76164447bfd6604dff7ccad1a379eb", "author": {"user": {"login": "kevinushey", "name": "Kevin Ushey"}}, "url": "https://github.com/rstudio/rstudio/commit/6cdaf098fd76164447bfd6604dff7ccad1a379eb", "committedDate": "2020-11-17T20:23:26Z", "message": "better fixup for Ace cursor color"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyODAyMDcx", "url": "https://github.com/rstudio/rstudio/pull/8415#pullrequestreview-532802071", "createdAt": "2020-11-17T20:52:03Z", "commit": {"oid": "6cdaf098fd76164447bfd6604dff7ccad1a379eb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4901, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}