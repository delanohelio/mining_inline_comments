{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE0OTQ2NDEy", "number": 6835, "title": "For IE11 (only), use core-js 3.6.5 polyfill", "bodyText": "Yes, the core-js version is 3.6.5, despite the files saying 3.6.4.\nSource: https://unpkg.com/browse/core-js-bundle@3.6.5/\nPanmirror requires a polyfill for IE11, and @jmcphers said bugs have arisen in the past due to spotty polyfill coverage for IE11.\nThe minified polyfill is 156KB (before gzip) so for now I'm restricting it to user agents with /.*Trident.*/. We may need additional, lighter polyfills for other browsers in the future--I'm not sure yet.\nI injected this at the index.htm level because 1) I've forgotten everything I know about GWT, 2) it seemed advantageous to have a structural guarantee that the polyfill would be loaded before any other JS. If there is a cleaner way to do this with GWT I'm happy to revisit.\nI did NOT remove any existing polyfills that this PR might have made superfluous.", "createdAt": "2020-05-07T22:13:18Z", "url": "https://github.com/rstudio/rstudio/pull/6835", "merged": true, "mergeCommit": {"oid": "1e2db8c9cba3c88051d24af5b098d822578cd6c2"}, "closed": true, "closedAt": "2020-05-08T00:18:45Z", "author": {"login": "jcheng5"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcfEx-8gH2gAyNDE0OTQ2NDEyOmVkY2MwNTJkOWNjOWRjZTU2NmI5NzViOWZiM2MyMTU2YTVlZjVmNzI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcfGAoJgFqTQwNzkwNjcyNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "edcc052d9cc9dce566b975b9fb3c2156a5ef5f72", "author": {"user": {"login": "jcheng5", "name": "Joe Cheng"}}, "url": "https://github.com/rstudio/rstudio/commit/edcc052d9cc9dce566b975b9fb3c2156a5ef5f72", "committedDate": "2020-05-07T22:11:57Z", "message": "For IE11 (only), use core-js 3.6.5 polyfill\n\nYes, the core-js version is 3.6.5, despite the files saying 3.6.4.\nSource: https://unpkg.com/browse/core-js-bundle@3.6.5/"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3OTAzODEw", "url": "https://github.com/rstudio/rstudio/pull/6835#pullrequestreview-407903810", "createdAt": "2020-05-07T23:29:32Z", "commit": {"oid": "edcc052d9cc9dce566b975b9fb3c2156a5ef5f72"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzoyOTozM1rOGSTwpw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wN1QyMzoyOTozM1rOGSTwpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTg1MTMwMw==", "bodyText": "This looks like a no-op -- should we just omit the else?", "url": "https://github.com/rstudio/rstudio/pull/6835#discussion_r421851303", "createdAt": "2020-05-07T23:29:33Z", "author": {"login": "jmcphers"}, "path": "src/cpp/core/gwt/GwtFileHandler.cpp", "diffHunk": "@@ -133,11 +133,19 @@ void handleFileRequest(const FileRequestOptions& options,\n                          (request.queryParamValue(\"emulatedStack\") == \"1\");\n       vars[\"compiler_stack_mode\"] = useEmulatedStack ? \"emulated\" : \"native\";\n \n+      // polyfill for IE11 (only)\n+      std::string polyfill = \"<script type=\\\"text/javascript\\\" language=\\\"javascript\\\" src=\\\"js/core-js/minified.js\\\"></script>\\n\";\n+      if (regex_utils::match(request.userAgent(), boost::regex(\".*Trident.*\"))) {\n+         vars[\"head_tags\"] = polyfill;\n+      } else {\n+         vars[\"head_tags\"] = std::string();\n+      }\n+\n       // check for initJs\n       if (!options.initJs.empty())\n-         vars[\"head_tags\"] = \"<script>\" + options.initJs + \"</script>\";\n+         vars[\"head_tags\"] = vars[\"head_tags\"] + \"<script>\" + options.initJs + \"</script>\";\n       else\n-         vars[\"head_tags\"] = std::string();\n+         vars[\"head_tags\"] = vars[\"head_tags\"] + std::string();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "edcc052d9cc9dce566b975b9fb3c2156a5ef5f72"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4eb7b85550796c6e4cf45cd9ae60efe8f92fcba3", "author": {"user": {"login": "jcheng5", "name": "Joe Cheng"}}, "url": "https://github.com/rstudio/rstudio/commit/4eb7b85550796c6e4cf45cd9ae60efe8f92fcba3", "committedDate": "2020-05-07T23:32:36Z", "message": "Remove extraneous else"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA3OTA2NzI3", "url": "https://github.com/rstudio/rstudio/pull/6835#pullrequestreview-407906727", "createdAt": "2020-05-07T23:37:51Z", "commit": {"oid": "4eb7b85550796c6e4cf45cd9ae60efe8f92fcba3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 248, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}