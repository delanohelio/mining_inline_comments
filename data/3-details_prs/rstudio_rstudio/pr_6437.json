{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MzI0MDM1", "number": 6437, "title": "Update SessionSource.R", "bodyText": "Filter empty string (a symbol) #5285", "createdAt": "2020-03-10T19:32:19Z", "url": "https://github.com/rstudio/rstudio/pull/6437", "merged": true, "mergeCommit": {"oid": "dc633397ba513a61441708e131a9abda36714160"}, "closed": true, "closedAt": "2020-03-25T19:43:07Z", "author": {"login": "Katzmann1983"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcMXuTfAH2gAyMzg2MzI0MDM1OjY2M2EyNmM5MDFhOTkyOTI4N2EyZjZlYjcwNGMwYWE1MmI3ZTIwNGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRM3x_gFqTM4MTQ3ODg2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "663a26c901a9929287a2f6eb704c0aa52b7e204e", "author": {"user": {"login": "Katzmann1983", "name": null}}, "url": "https://github.com/rstudio/rstudio/commit/663a26c901a9929287a2f6eb704c0aa52b7e204e", "committedDate": "2020-03-10T19:31:34Z", "message": "Update SessionSource.R\n\n# Filter empty string (a symbol) https://github.com/rstudio/rstudio/issues/5285"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNDIzNjI4", "url": "https://github.com/rstudio/rstudio/pull/6437#pullrequestreview-372423628", "createdAt": "2020-03-11T01:29:06Z", "commit": {"oid": "663a26c901a9929287a2f6eb704c0aa52b7e204e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQwMToyOTowNlrOF0mcFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQwMToyOTowNlrOF0mcFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDcwMDA1Mw==", "bodyText": "as.expression(x) might return a vector of length > 1, so this isn't the right test.\nAssuming I understand the issue correctly, I think you just want to check something like if (!is.null(ee)) below in the for loop.", "url": "https://github.com/rstudio/rstudio/pull/6437#discussion_r390700053", "createdAt": "2020-03-11T01:29:06Z", "author": {"login": "kevinushey"}, "path": "src/cpp/session/modules/SessionSource.R", "diffHunk": "@@ -184,6 +184,8 @@\n    \n    if (length(args) > 0)\n    {\n+      # Filter empty string https://github.com/rstudio/rstudio/issues/5285\n+      args <- args[sapply(args, function(x) nchar(as.character(as.expression(x))) > 0 )]", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "663a26c901a9929287a2f6eb704c0aa52b7e204e"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "63b6ac6980fa4052d75000f46eb78d6016db7efd", "author": {"user": {"login": "Katzmann1983", "name": null}}, "url": "https://github.com/rstudio/rstudio/commit/63b6ac6980fa4052d75000f46eb78d6016db7efd", "committedDate": "2020-03-12T10:57:35Z", "message": "Update SessionSource.R\n\nResolving comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0e9e7fce436a4bce00ec286c5b26b823374af7c", "author": {"user": {"login": "Katzmann1983", "name": null}}, "url": "https://github.com/rstudio/rstudio/commit/c0e9e7fce436a4bce00ec286c5b26b823374af7c", "committedDate": "2020-03-12T14:53:48Z", "message": "Update SessionSource.R"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0NDU2NTU2", "url": "https://github.com/rstudio/rstudio/pull/6437#pullrequestreview-374456556", "createdAt": "2020-03-13T16:48:07Z", "commit": {"oid": "c0e9e7fce436a4bce00ec286c5b26b823374af7c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNjo0ODowN1rOF2LDeQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xM1QxNjo0ODowN1rOF2LDeQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjM0ODUzNw==", "bodyText": "I'm realizing now that this line is unnecessary as it's legal to access an R missing value that lives within a list object. For example:\n> x <- quote(expr = )\n> x\nError: argument \"x\" is missing, with no default\n> l <- list(x = quote(expr = ))\n> l$x\n\n\nSo simply re-structuring the loop so that we access args[[i]] through an index rather than looping fixes the issue.\n(Also note: it really is quote(expr = ) as opposed to an empty expression() object)", "url": "https://github.com/rstudio/rstudio/pull/6437#discussion_r392348537", "createdAt": "2020-03-13T16:48:07Z", "author": {"login": "kevinushey"}, "path": "src/cpp/session/modules/SessionSource.R", "diffHunk": "@@ -184,8 +184,10 @@\n    \n    if (length(args) > 0)\n    {\n-      for (ee in args)\n-         freeVars <- c(freeVars, codetools:::walkCode(ee, w))\n+      for (i in seq_along(args))\n+         # Filter empty string https://github.com/rstudio/rstudio/issues/5285\n+         if (!identical(args[[i]], expression()))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0e9e7fce436a4bce00ec286c5b26b823374af7c"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0eaf59ba71868f34ebfe589b46bdb35269af0f1", "author": {"user": {"login": "Katzmann1983", "name": null}}, "url": "https://github.com/rstudio/rstudio/commit/b0eaf59ba71868f34ebfe589b46bdb35269af0f1", "committedDate": "2020-03-16T09:31:18Z", "message": "It's legal to access an R NA within a list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ddf0e62e15fc35c98b0f2ad52fba999fd0e428c", "author": {"user": {"login": "Katzmann1983", "name": null}}, "url": "https://github.com/rstudio/rstudio/commit/8ddf0e62e15fc35c98b0f2ad52fba999fd0e428c", "committedDate": "2020-03-16T09:32:09Z", "message": "Update SessionSource.R"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NTEzNzky", "url": "https://github.com/rstudio/rstudio/pull/6437#pullrequestreview-375513792", "createdAt": "2020-03-16T19:14:13Z", "commit": {"oid": "8ddf0e62e15fc35c98b0f2ad52fba999fd0e428c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDc4ODYz", "url": "https://github.com/rstudio/rstudio/pull/6437#pullrequestreview-381478863", "createdAt": "2020-03-25T19:42:35Z", "commit": {"oid": "8ddf0e62e15fc35c98b0f2ad52fba999fd0e428c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 287, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}