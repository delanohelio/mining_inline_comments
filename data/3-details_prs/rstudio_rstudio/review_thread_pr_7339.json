{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDgwMDAy", "number": 7339, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMTowODo0MFrOEN_dsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwMDo1MzowNVrOEODuJg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMTA2NzM4OnYy", "diffSide": "LEFT", "path": "src/cpp/session/resources/schema/user-prefs-schema.json", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMTowODo0MFrOGw57pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwMDoxODoyNFrOGw_Tuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkzMzk5MA==", "bodyText": "What do you think about leaving this option in and just changing the default to true? The reason I suggest this is that it's come up at least once in conversation that in some environments we might actually want to constrain the UI (e.g. in a tutorial mode where we need to preserve the \"only one file is open\" invariant). We could use the option to do this since you've already done the wiring, though we might want to rename it to something more specific.", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r453933990", "createdAt": "2020-07-13T21:08:40Z", "author": {"login": "jmcphers"}, "path": "src/cpp/session/resources/schema/user-prefs-schema.json", "diffHunk": "@@ -210,12 +210,6 @@\n             },\n             \"description\": \"Layout of panes in the RStudio workbench.\"\n         },\n-        \"enable_additional_columns\": {\n-           \"type\": \"boolean\",\n-           \"default\": false,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAxMzQzOA==", "bodyText": "Done! I added \"Allow Source Columns\" which defaults to true.", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r454013438", "createdAt": "2020-07-13T23:49:10Z", "author": {"login": "melissa-barca"}, "path": "src/cpp/session/resources/schema/user-prefs-schema.json", "diffHunk": "@@ -210,12 +210,6 @@\n             },\n             \"description\": \"Layout of panes in the RStudio workbench.\"\n         },\n-        \"enable_additional_columns\": {\n-           \"type\": \"boolean\",\n-           \"default\": false,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkzMzk5MA=="}, "originalCommit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAxNzAzOQ==", "bodyText": "Anything to worry about if a user has added source columns, then switches off this preference? Do existing source columns get closed or do they continue to function, that sort of thing?", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r454017039", "createdAt": "2020-07-14T00:00:44Z", "author": {"login": "gtritchie"}, "path": "src/cpp/session/resources/schema/user-prefs-schema.json", "diffHunk": "@@ -210,12 +210,6 @@\n             },\n             \"description\": \"Layout of panes in the RStudio workbench.\"\n         },\n-        \"enable_additional_columns\": {\n-           \"type\": \"boolean\",\n-           \"default\": false,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkzMzk5MA=="}, "originalCommit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAxOTA4Nw==", "bodyText": "The columns will persist until the user refreshes the browser, then any open tabs are moved to the main source column. The Remove Column button in Global Options is still enabled after the option is turned off so the user could go there to remove columns. Removing them as soon as the option is set to Off seems jarring.", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r454019087", "createdAt": "2020-07-14T00:07:46Z", "author": {"login": "melissa-barca"}, "path": "src/cpp/session/resources/schema/user-prefs-schema.json", "diffHunk": "@@ -210,12 +210,6 @@\n             },\n             \"description\": \"Layout of panes in the RStudio workbench.\"\n         },\n-        \"enable_additional_columns\": {\n-           \"type\": \"boolean\",\n-           \"default\": false,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkzMzk5MA=="}, "originalCommit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAyMjA3NQ==", "bodyText": "Not suggesting we remove them when option is turned off, was just curious how it behaves.", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r454022075", "createdAt": "2020-07-14T00:18:24Z", "author": {"login": "gtritchie"}, "path": "src/cpp/session/resources/schema/user-prefs-schema.json", "diffHunk": "@@ -210,12 +210,6 @@\n             },\n             \"description\": \"Layout of panes in the RStudio workbench.\"\n         },\n-        \"enable_additional_columns\": {\n-           \"type\": \"boolean\",\n-           \"default\": false,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkzMzk5MA=="}, "originalCommit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMTA3NDAxOnYy", "diffSide": "RIGHT", "path": "src/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PreferencesDialog.css", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMToxMDo0MFrOGw5_nQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMzo1MDo1MlrOGw-0Lw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkzNTAwNQ==", "bodyText": "Maybe personal preference but I think it looks a little odd to have square corners (from the options dropdowns) right up against these rounded ones. Can we tone these borders down a little (just a dark gray) and reduce the radius?", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r453935005", "createdAt": "2020-07-13T21:10:40Z", "author": {"login": "jmcphers"}, "path": "src/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PreferencesDialog.css", "diffHunk": "@@ -27,16 +27,28 @@\n    margin-bottom: 11px;\n }\n \n+.paneLayoutTable {\n+   height: 160px;\n+}\n+\n .paneLayoutTable td.paneLayoutTable {\n    background-color: white;\n-   height: 200px;\n    vertical-align: top;\n-   padding-top: 0px;\n+   padding: 0px;\n+   border: 1px solid #1e77bc;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAxMzk5OQ==", "bodyText": "I changed the border and added a screenshot to this PR's description.", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r454013999", "createdAt": "2020-07-13T23:50:52Z", "author": {"login": "melissa-barca"}, "path": "src/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PreferencesDialog.css", "diffHunk": "@@ -27,16 +27,28 @@\n    margin-bottom: 11px;\n }\n \n+.paneLayoutTable {\n+   height: 160px;\n+}\n+\n .paneLayoutTable td.paneLayoutTable {\n    background-color: white;\n-   height: 200px;\n    vertical-align: top;\n-   padding-top: 0px;\n+   padding: 0px;\n+   border: 1px solid #1e77bc;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkzNTAwNQ=="}, "originalCommit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "originalPosition": 14}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzMTc2NDg2OnYy", "diffSide": "RIGHT", "path": "src/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PaneLayoutPreferencesPane.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwMDo1MzowNVrOGw_-vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwMDo1MzowNVrOGw_-vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAzMzA4Ng==", "bodyText": "Recommend giving this table an accessible name; this is a cheap but effective accessibility improvement for screen reader users.\n     Roles.getGridRole().setAriaLabelProperty(grid_.getElement(), \"Columns and Panes Layout\");", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r454033086", "createdAt": "2020-07-14T00:53:05Z", "author": {"login": "gtritchie"}, "path": "src/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PaneLayoutPreferencesPane.java", "diffHunk": "@@ -320,13 +331,121 @@ else if (!otherIndices.get(i))\n       updateTabSetLabels();\n    }\n \n+   private String updateTable(int newCount)\n+   {\n+      // nothing has changed since the last update\n+      if (grid_ != null && displayColumnCount_ == newCount)\n+         return \"\";\n+\n+      // cells will be twice a wide as columns to preserve space\n+      double columnCount = newCount + (2 * GRID_PANE_COUNT);\n+      double columnWidthValue = (double)TABLE_WIDTH / columnCount;\n+      double cellWidthValue = columnWidthValue * GRID_PANE_COUNT;\n+\n+      // If the column width is bigger than MAX_COLUMN_WIDTH, give space back to the panes\n+      if (newCount > 0 && Math.min(columnWidthValue, MAX_COLUMN_WIDTH) != columnWidthValue)\n+      {\n+         double extra = (newCount * (columnWidthValue - MAX_COLUMN_WIDTH)) / GRID_PANE_COUNT;\n+         cellWidthValue += extra;\n+         columnWidthValue = MAX_COLUMN_WIDTH;\n+      }\n+      cellWidthValue -= (GRID_CELL_SPACING + GRID_CELL_PADDING);\n+      columnWidthValue -= (GRID_CELL_SPACING + GRID_CELL_PADDING);\n+\n+      final String columnWidth = columnWidthValue + \"px\";\n+      final String cellWidth = cellWidthValue + \"px\";\n+      leftTop_.setWidth(cellWidth);\n+      leftBottom_.setWidth(cellWidth);\n+      rightTop_.setWidth(cellWidth);\n+      rightBottom_.setWidth(cellWidth);\n+\n+      // create grid\n+      if (grid_ == null)\n+      {\n+         grid_ = new FlexTable();\n+         grid_.addStyleName(res_.styles().paneLayoutTable());\n+         grid_.setCellSpacing(GRID_CELL_SPACING);\n+         grid_.setCellPadding(GRID_CELL_PADDING);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb7ae4c3c46a09246ce1d868d36cbfb8d9b8b32c"}, "originalPosition": 199}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4313, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}