{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NTY3NTg3", "number": 7341, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxNzowMjowN1rOEOWRiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxNzowMjowN1rOEOWRiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzNDgwNDU3OnYy", "diffSide": "RIGHT", "path": "src/gwt/src/org/rstudio/studio/client/workbench/views/viewer/ViewerPane.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxNzowMjowN1rOGxc3PQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxOToyOToxNFrOGxiJHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDUwNjMwMQ==", "bodyText": "Wouldn't this imply an attempt to open a null URL if we couldn't get the IFrame URL (e.g. because of DOM restrictions)?", "url": "https://github.com/rstudio/rstudio/pull/7341#discussion_r454506301", "createdAt": "2020-07-14T17:02:07Z", "author": {"login": "kevinushey"}, "path": "src/gwt/src/org/rstudio/studio/client/workbench/views/viewer/ViewerPane.java", "diffHunk": "@@ -232,6 +232,15 @@ public void popout()\n       {\n          globalDisplay_.showHtmlFile(rmdPreviewParams_.getOutputFile());\n       }\n+      else if (frame_ != null &&\n+          !StringUtil.equals(frame_.getIFrame().getCurrentUrl(), getUrl()))\n+      {\n+         // Typically we navigate to the unmodified URL (i.e. without the\n+         // viewer_pane=1 query params, etc.) However, if the URL currently\n+         // loaded in the frame is different, the user probably navigated away\n+         // from original URL, so load that URL as-is.\n+         globalDisplay_.openWindow(frame_.getIFrame().getCurrentUrl());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4695ea78ab5d0a0bda478c5cf73a1c46c5c434cd"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDU5Mjc5Nw==", "bodyText": "Hmm, you're right (I had this test in at some point but lost it when refactoring). Updated!", "url": "https://github.com/rstudio/rstudio/pull/7341#discussion_r454592797", "createdAt": "2020-07-14T19:29:14Z", "author": {"login": "jmcphers"}, "path": "src/gwt/src/org/rstudio/studio/client/workbench/views/viewer/ViewerPane.java", "diffHunk": "@@ -232,6 +232,15 @@ public void popout()\n       {\n          globalDisplay_.showHtmlFile(rmdPreviewParams_.getOutputFile());\n       }\n+      else if (frame_ != null &&\n+          !StringUtil.equals(frame_.getIFrame().getCurrentUrl(), getUrl()))\n+      {\n+         // Typically we navigate to the unmodified URL (i.e. without the\n+         // viewer_pane=1 query params, etc.) However, if the URL currently\n+         // loaded in the frame is different, the user probably navigated away\n+         // from original URL, so load that URL as-is.\n+         globalDisplay_.openWindow(frame_.getIFrame().getCurrentUrl());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDUwNjMwMQ=="}, "originalCommit": {"oid": "4695ea78ab5d0a0bda478c5cf73a1c46c5c434cd"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4315, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}