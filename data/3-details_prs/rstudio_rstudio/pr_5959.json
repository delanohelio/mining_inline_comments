{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU5MTU3MjQy", "number": 5959, "title": "Fix excessive CPU usage in pathological R session closure", "bodyText": "This change fixes an issue in which R sessions can hang around eating CPU for unreasonably long after they should have been terminated.\nThe problem is that when the R session is bound to a giant, unindexed directory (which occurs if you e.g. try to create a project from your home directory), the file indexing threads can keep running for a long time. These threads try to retrieve preferences related to object file hiding, which results in exceptions once the main thread is unwound and the preferences don't exist any more. These exceptions then trigger expensive exception handling and logging code which further slows the termination process.\nThe fix is to pass the pref values in using functional value binding (once) instead of hitting the pref for every single file test, which is more performant anyway.\nOf course, there are a lot of other pathologies that occur when you try to open ~ as a project (see #5855), so I've also added a sanity check to prevent that.\n\nFixes #5855.\nCloses #1552.", "createdAt": "2020-01-03T23:43:37Z", "url": "https://github.com/rstudio/rstudio/pull/5959", "merged": true, "mergeCommit": {"oid": "527a108f4245f95ea34459b4f0885d58a2a0d87d"}, "closed": true, "closedAt": "2020-01-06T17:23:29Z", "author": {"login": "jmcphers"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb23DnXAH2gAyMzU5MTU3MjQyOjNiZmE0NWM1OTY5MjRlNTk4YTAxNjkxYTdmZjQ4YmI2Y2YxYzIwYjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb3MVBPgFqTMzODM0MTI1OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3bfa45c596924e598a01691a7ff48bb6cf1c20b1", "author": {"user": {"login": "jmcphers", "name": "Jonathan"}}, "url": "https://github.com/rstudio/rstudio/commit/3bfa45c596924e598a01691a7ff48bb6cf1c20b1", "committedDate": "2020-01-03T23:35:34Z", "message": "disallow opening ~ as a project; bind prefs to file listing"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzM4MzQxMjU4", "url": "https://github.com/rstudio/rstudio/pull/5959#pullrequestreview-338341258", "createdAt": "2020-01-04T07:10:21Z", "commit": {"oid": "3bfa45c596924e598a01691a7ff48bb6cf1c20b1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQwNzoxMDoyMlrOFaNBlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wNFQwNzoxMDoyMlrOFaNBlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzAyMDY5Mg==", "bodyText": "2020? Mind blown!!!!", "url": "https://github.com/rstudio/rstudio/pull/5959#discussion_r363020692", "createdAt": "2020-01-04T07:10:22Z", "author": {"login": "gtritchie"}, "path": "src/cpp/session/include/session/SessionModuleContext.hpp", "diffHunk": "@@ -1,8 +1,8 @@\n /*\n  * SessionModuleContext.hpp\n  *\n- * Copyright (C) 2009-18 by RStudio, Inc.\n-\n+ * Copyright (C) 2009-20 by RStudio, Inc.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3bfa45c596924e598a01691a7ff48bb6cf1c20b1"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 412, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}