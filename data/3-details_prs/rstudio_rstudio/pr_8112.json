{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA2Mjk4OTA1", "number": 8112, "title": "hardcode location for POSTGRES librarys on macOS", "bodyText": "Intent\nMac package builds should include the postgreql dependencies in the generated bundle, otherwise the application may not run on a non-developer machine.\nOn some configurations this was not happening, and cmake was deciding these libraries are part of the system and not including them. Specifically, find_library was resolving to:\nPQ_LIB:FILEPATH=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.15.sdk/usr/lib/libpq.tbd\nApproach\nHardcode path to library on macOS only. Confirmed with a local build that this results in all dependencies going into the resulting package build.\nQA Notes\nDev / build thing, nothing to test", "createdAt": "2020-10-19T21:48:16Z", "url": "https://github.com/rstudio/rstudio/pull/8112", "merged": true, "mergeCommit": {"oid": "e9fb980d92f100dec095137bd5587b45959eacf1"}, "closed": true, "closedAt": "2020-10-20T00:01:59Z", "author": {"login": "gtritchie"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdULQ5eAH2gAyNTA2Mjk4OTA1OjhmNjdlMGFhODNhZjI1MDJiNWU2NGU1OGFjZjAyNWFmMDczZjI3MDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdULpwSgH2gAyNTA2Mjk4OTA1OjA4ZGFiNjkxNmZjOTQ2ODkzYTMwZTZlYzdiNDc1Mzc3MTgzZDUwNmQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8f67e0aa83af2502b5e64e58acf025af073f2701", "author": {"user": {"login": "gtritchie", "name": "Gary"}}, "url": "https://github.com/rstudio/rstudio/commit/8f67e0aa83af2502b5e64e58acf025af073f2701", "committedDate": "2020-10-19T21:43:08Z", "message": "hardcode location for POSTGRES librarys on macOS\n\n- Without this, and depending on system configuration, cmake's find_library would decide that these libraries are part of the system and not include them in the package build\n- For example: `PQ_LIB:FILEPATH=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.15.sdk/usr/lib/libpq.tbd`"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyMTg3MDg4", "url": "https://github.com/rstudio/rstudio/pull/8112#pullrequestreview-512187088", "createdAt": "2020-10-19T21:53:45Z", "commit": {"oid": "8f67e0aa83af2502b5e64e58acf025af073f2701"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEyMTkwNjc3", "url": "https://github.com/rstudio/rstudio/pull/8112#pullrequestreview-512190677", "createdAt": "2020-10-19T22:00:27Z", "commit": {"oid": "8f67e0aa83af2502b5e64e58acf025af073f2701"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQyMjowMDoyN1rOHkjOHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOVQyMjowMDoyN1rOHkjOHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODA4NzgzOQ==", "bodyText": "@gtritchie Also if you don't mind let's put a comment here about why we're specifically setting the path on OSX (qt bundle script will only bundle dylibs, so if this is pointing to an xcode library spec file it won't get copied into the bundle)", "url": "https://github.com/rstudio/rstudio/pull/8112#discussion_r508087839", "createdAt": "2020-10-19T22:00:27Z", "author": {"login": "kfeinauer"}, "path": "src/cpp/CMakeLists.txt", "diffHunk": "@@ -415,7 +415,11 @@ if(UNIX)\n    find_library(DL_LIB \"dl\")\n    find_library(SQLITE_LIB \"sqlite3\")\n    get_filename_component(SQLITE_LIB \"${SQLITE_LIB}\" REALPATH)\n-   find_library(PQ_LIB \"pq\")\n+   if (APPLE)\n+      set(PQ_LIB \"/usr/local/lib/libpq.dylib\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f67e0aa83af2502b5e64e58acf025af073f2701"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08dab6916fc946893a30e6ec7b475377183d506d", "author": {"user": {"login": "gtritchie", "name": "Gary"}}, "url": "https://github.com/rstudio/rstudio/commit/08dab6916fc946893a30e6ec7b475377183d506d", "committedDate": "2020-10-19T22:10:17Z", "message": "add a comment"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4936, "cost": 1, "resetAt": "2021-11-02T10:47:05Z"}}}