{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDgwMDAy", "number": 7339, "title": "Add new UI for additional source columns and remove feature flag", "bodyText": "This PR remove the user pref enable_additional_columns so the feature will be available without specifying the option. Global Options Pane Layout will now look like the following screenshots. Users are able to add and remove source columns so they can look at multiple editors at once.\nThis PR also includes some adjustments to the consolidateColumns function. This function previously didn't work as expected but wasn't being used so caused no issues.\nThere is still a fair amount of work to do for this feature, this is just the next big step.\nUpdated screenshot 7/14:", "createdAt": "2020-07-13T20:44:21Z", "url": "https://github.com/rstudio/rstudio/pull/7339", "merged": true, "mergeCommit": {"oid": "3ce88583e078fc394daddb1da744b682b1ea55af"}, "closed": true, "closedAt": "2020-07-16T00:10:04Z", "author": {"login": "melissa-barca"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0lK_PAH2gAyNDQ4NDgwMDAyOmJjYTJhY2ZkYjNjMmEwMTM3MGZhNGNjZGM2NzI1YTYzNGY3NjVkZmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1TVKngH2gAyNDQ4NDgwMDAyOmEzZDI4MmU0YzEwNGUyMGRjZWQ4YjRlNDIwN2Q4ZDJlNmRjYTJhOTI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bca2acfdb3c2a01370fa4ccdc6725a634f765dfc", "author": {"user": {"login": "melissa-barca", "name": "Melissa Barca"}}, "url": "https://github.com/rstudio/rstudio/commit/bca2acfdb3c2a01370fa4ccdc6725a634f765dfc", "committedDate": "2020-07-13T17:48:38Z", "message": "remove enable additional columns user pref and update add columns UI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c87f32a9a709360b1186dc908dcb85946463fdf", "author": {"user": {"login": "melissa-barca", "name": "Melissa Barca"}}, "url": "https://github.com/rstudio/rstudio/commit/9c87f32a9a709360b1186dc908dcb85946463fdf", "committedDate": "2020-07-13T17:51:00Z", "message": "remove unused function"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5e46fa8b7f1a698cb950bc680f6eb7bcbcdb561a", "author": {"user": {"login": "melissa-barca", "name": "Melissa Barca"}}, "url": "https://github.com/rstudio/rstudio/commit/5e46fa8b7f1a698cb950bc680f6eb7bcbcdb561a", "committedDate": "2020-07-13T19:14:03Z", "message": "Merge branch 'master' of https://github.com/rstudio/rstudio into feature/columns-options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab", "author": {"user": {"login": "melissa-barca", "name": "Melissa Barca"}}, "url": "https://github.com/rstudio/rstudio/commit/3dcba1f6abec568cca78e145bae54e7f9e5d48ab", "committedDate": "2020-07-13T20:32:06Z", "message": "clean up consolidate function"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3NjAzMDQ3", "url": "https://github.com/rstudio/rstudio/pull/7339#pullrequestreview-447603047", "createdAt": "2020-07-13T21:08:40Z", "commit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMTowODo0MFrOGw57pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xM1QyMToxMDo0MFrOGw5_nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkzMzk5MA==", "bodyText": "What do you think about leaving this option in and just changing the default to true? The reason I suggest this is that it's come up at least once in conversation that in some environments we might actually want to constrain the UI (e.g. in a tutorial mode where we need to preserve the \"only one file is open\" invariant). We could use the option to do this since you've already done the wiring, though we might want to rename it to something more specific.", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r453933990", "createdAt": "2020-07-13T21:08:40Z", "author": {"login": "jmcphers"}, "path": "src/cpp/session/resources/schema/user-prefs-schema.json", "diffHunk": "@@ -210,12 +210,6 @@\n             },\n             \"description\": \"Layout of panes in the RStudio workbench.\"\n         },\n-        \"enable_additional_columns\": {\n-           \"type\": \"boolean\",\n-           \"default\": false,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkzNTAwNQ==", "bodyText": "Maybe personal preference but I think it looks a little odd to have square corners (from the options dropdowns) right up against these rounded ones. Can we tone these borders down a little (just a dark gray) and reduce the radius?", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r453935005", "createdAt": "2020-07-13T21:10:40Z", "author": {"login": "jmcphers"}, "path": "src/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PreferencesDialog.css", "diffHunk": "@@ -27,16 +27,28 @@\n    margin-bottom: 11px;\n }\n \n+.paneLayoutTable {\n+   height: 160px;\n+}\n+\n .paneLayoutTable td.paneLayoutTable {\n    background-color: white;\n-   height: 200px;\n    vertical-align: top;\n-   padding-top: 0px;\n+   padding: 0px;\n+   border: 1px solid #1e77bc;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3dcba1f6abec568cca78e145bae54e7f9e5d48ab"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e15244bd5db875a184694f20b0b35d8e38230826", "author": {"user": {"login": "melissa-barca", "name": "Melissa Barca"}}, "url": "https://github.com/rstudio/rstudio/commit/e15244bd5db875a184694f20b0b35d8e38230826", "committedDate": "2020-07-13T23:41:52Z", "message": "add Allow Source Columns user pref so adding source columns can be disabled"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb7ae4c3c46a09246ce1d868d36cbfb8d9b8b32c", "author": {"user": {"login": "melissa-barca", "name": "Melissa Barca"}}, "url": "https://github.com/rstudio/rstudio/commit/eb7ae4c3c46a09246ce1d868d36cbfb8d9b8b32c", "committedDate": "2020-07-13T23:48:06Z", "message": "tone down borders"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3NzExMDA3", "url": "https://github.com/rstudio/rstudio/pull/7339#pullrequestreview-447711007", "createdAt": "2020-07-14T00:53:05Z", "commit": {"oid": "eb7ae4c3c46a09246ce1d868d36cbfb8d9b8b32c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwMDo1MzowNVrOGw_-vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQwMDo1MzowNVrOGw_-vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDAzMzA4Ng==", "bodyText": "Recommend giving this table an accessible name; this is a cheap but effective accessibility improvement for screen reader users.\n     Roles.getGridRole().setAriaLabelProperty(grid_.getElement(), \"Columns and Panes Layout\");", "url": "https://github.com/rstudio/rstudio/pull/7339#discussion_r454033086", "createdAt": "2020-07-14T00:53:05Z", "author": {"login": "gtritchie"}, "path": "src/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PaneLayoutPreferencesPane.java", "diffHunk": "@@ -320,13 +331,121 @@ else if (!otherIndices.get(i))\n       updateTabSetLabels();\n    }\n \n+   private String updateTable(int newCount)\n+   {\n+      // nothing has changed since the last update\n+      if (grid_ != null && displayColumnCount_ == newCount)\n+         return \"\";\n+\n+      // cells will be twice a wide as columns to preserve space\n+      double columnCount = newCount + (2 * GRID_PANE_COUNT);\n+      double columnWidthValue = (double)TABLE_WIDTH / columnCount;\n+      double cellWidthValue = columnWidthValue * GRID_PANE_COUNT;\n+\n+      // If the column width is bigger than MAX_COLUMN_WIDTH, give space back to the panes\n+      if (newCount > 0 && Math.min(columnWidthValue, MAX_COLUMN_WIDTH) != columnWidthValue)\n+      {\n+         double extra = (newCount * (columnWidthValue - MAX_COLUMN_WIDTH)) / GRID_PANE_COUNT;\n+         cellWidthValue += extra;\n+         columnWidthValue = MAX_COLUMN_WIDTH;\n+      }\n+      cellWidthValue -= (GRID_CELL_SPACING + GRID_CELL_PADDING);\n+      columnWidthValue -= (GRID_CELL_SPACING + GRID_CELL_PADDING);\n+\n+      final String columnWidth = columnWidthValue + \"px\";\n+      final String cellWidth = cellWidthValue + \"px\";\n+      leftTop_.setWidth(cellWidth);\n+      leftBottom_.setWidth(cellWidth);\n+      rightTop_.setWidth(cellWidth);\n+      rightBottom_.setWidth(cellWidth);\n+\n+      // create grid\n+      if (grid_ == null)\n+      {\n+         grid_ = new FlexTable();\n+         grid_.addStyleName(res_.styles().paneLayoutTable());\n+         grid_.setCellSpacing(GRID_CELL_SPACING);\n+         grid_.setCellPadding(GRID_CELL_PADDING);\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "eb7ae4c3c46a09246ce1d868d36cbfb8d9b8b32c"}, "originalPosition": 199}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "144eb6fee2105f5a7fb4526a0877a0a8e4b7d764", "author": {"user": {"login": "melissa-barca", "name": "Melissa Barca"}}, "url": "https://github.com/rstudio/rstudio/commit/144eb6fee2105f5a7fb4526a0877a0a8e4b7d764", "committedDate": "2020-07-14T03:26:36Z", "message": "add accessibility name to grid"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2ddbf9906d05360650c24da899f5662781c414a", "author": {"user": {"login": "melissa-barca", "name": "Melissa Barca"}}, "url": "https://github.com/rstudio/rstudio/commit/f2ddbf9906d05360650c24da899f5662781c414a", "committedDate": "2020-07-14T18:29:02Z", "message": "move 'Source' label to top of column, increase padding around drop downs,\ndisable/enable column buttons depending on the current display"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ5MzkxMDgw", "url": "https://github.com/rstudio/rstudio/pull/7339#pullrequestreview-449391080", "createdAt": "2020-07-15T22:38:00Z", "commit": {"oid": "f2ddbf9906d05360650c24da899f5662781c414a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3d282e4c104e20dced8b4e4207d8d2e6dca2a92", "author": {"user": {"login": "melissa-barca", "name": "Melissa Barca"}}, "url": "https://github.com/rstudio/rstudio/commit/a3d282e4c104e20dced8b4e4207d8d2e6dca2a92", "committedDate": "2020-07-15T23:35:23Z", "message": "Merge branches 'feature/columns-options' and 'master' of https://github.com/rstudio/rstudio into feature/columns-options\n\n\u0001 Conflicts:\n\u0001\tsrc/gwt/src/org/rstudio/studio/client/workbench/prefs/views/PaneLayoutPreferencesPane.java"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 111, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}