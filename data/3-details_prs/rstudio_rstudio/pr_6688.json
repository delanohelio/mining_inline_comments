{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA1Mjc4Mzcy", "number": 6688, "title": "Show metadata summary for tibbles in R Notebooks", "bodyText": "This change adds information about tibbles to the paged tables in R Notebooks, so it's easy to see how e.g., the tibble is grouped.\n\nThe change is much smaller than it appears; most of the pagedtables.js diff is whitespace introduced by prettier.\nCloses #5970.", "createdAt": "2020-04-17T18:27:38Z", "url": "https://github.com/rstudio/rstudio/pull/6688", "merged": true, "mergeCommit": {"oid": "2f9ab10d7088d0df04fa5cf73ffc793921c3508c"}, "closed": true, "closedAt": "2020-04-22T21:35:00Z", "author": {"login": "jmcphers"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYVn3ggH2gAyNDA1Mjc4MzcyOjAwZjcxZjdiMTBhYWU1YmNkZGIwZWU0NzM1ZDIxMDhhOTlmNWI4NGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaPC8JAFqTM5ODU5Nzk2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "00f71f7b10aae5bcddb0ee4735d2108a99f5b84e", "author": {"user": {"login": "jmcphers", "name": "Jonathan"}}, "url": "https://github.com/rstudio/rstudio/commit/00f71f7b10aae5bcddb0ee4735d2108a99f5b84e", "committedDate": "2020-04-16T23:51:49Z", "message": "initial plumbing for tibble metadata"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76e04d93d1a0799305392c4502384ebf016f86c3", "author": {"user": {"login": "jmcphers", "name": "Jonathan"}}, "url": "https://github.com/rstudio/rstudio/commit/76e04d93d1a0799305392c4502384ebf016f86c3", "committedDate": "2020-04-17T17:57:46Z", "message": "better treatment for metadata"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc8af59e0bc865d03740ce92a97ae40f9dbbbada", "author": {"user": {"login": "jmcphers", "name": "Jonathan"}}, "url": "https://github.com/rstudio/rstudio/commit/dc8af59e0bc865d03740ce92a97ae40f9dbbbada", "committedDate": "2020-04-17T18:21:30Z", "message": "run prettier on javascript"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6a5ff3349905c57235b95b7c6b29297721ed8fd", "author": {"user": {"login": "jmcphers", "name": "Jonathan"}}, "url": "https://github.com/rstudio/rstudio/commit/c6a5ff3349905c57235b95b7c6b29297721ed8fd", "committedDate": "2020-04-17T18:30:00Z", "message": "update NEWS"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3Nzc0MTYw", "url": "https://github.com/rstudio/rstudio/pull/6688#pullrequestreview-397774160", "createdAt": "2020-04-22T01:05:23Z", "commit": {"oid": "c6a5ff3349905c57235b95b7c6b29297721ed8fd"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwMTowNToyNFrOGJexcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQwMToxMDoxOFrOGJe3qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjU5NDU0NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                if (isNamespaceLoaded(\"tibble\"))\n          \n          \n            \n                if (\"tibble\" %in% loadedNamespaces())\n          \n      \n    \n    \n  \n\nisNamespaceLoaded() was added in R 3.2.0, and so is a bit too new for us to use.", "url": "https://github.com/rstudio/rstudio/pull/6688#discussion_r412594544", "createdAt": "2020-04-22T01:05:24Z", "author": {"login": "kevinushey"}, "path": "src/cpp/session/modules/NotebookData.R", "diffHunk": "@@ -92,9 +92,16 @@\n       options,\n       file = output)\n \n-    .Call(\"rs_recordData\", output, list(classes = className,\n-                                        nrow = nRow, \n-                                        ncol = nCol))\n+    # standard metadata\n+    metadata <- list(classes = className, nrow = nRow, ncol = nCol, summary = list())\n+\n+    # if tibble is loaded, use it to create a summary of the object\n+    if (isNamespaceLoaded(\"tibble\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a5ff3349905c57235b95b7c6b29297721ed8fd"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjU5NDY0NA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                .Call(\"rs_recordData\", output, metadata)\n          \n          \n            \n                .Call(\"rs_recordData\", output, metadata, PACKAGE = \"(embedding)\")", "url": "https://github.com/rstudio/rstudio/pull/6688#discussion_r412594644", "createdAt": "2020-04-22T01:05:40Z", "author": {"login": "kevinushey"}, "path": "src/cpp/session/modules/NotebookData.R", "diffHunk": "@@ -92,9 +92,16 @@\n       options,\n       file = output)\n \n-    .Call(\"rs_recordData\", output, list(classes = className,\n-                                        nrow = nRow, \n-                                        ncol = nCol))\n+    # standard metadata\n+    metadata <- list(classes = className, nrow = nRow, ncol = nCol, summary = list())\n+\n+    # if tibble is loaded, use it to create a summary of the object\n+    if (isNamespaceLoaded(\"tibble\"))\n+    {\n+       metadata$summary <- as.list(tibble::tbl_sum(original))\n+    }\n+\n+    .Call(\"rs_recordData\", output, metadata)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6a5ff3349905c57235b95b7c6b29297721ed8fd"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjU5NjEzOQ==", "bodyText": "This check feels a bit awkward, since I don't think there's any real guarantee that two empty objects are identical:\n$ node\nWelcome to Node.js v13.13.0.\nType \".help\" for more information.\n> {} === {}\nfalse\n\nMaybe instead check for the length of Object.keys(options.metadata)?", "url": "https://github.com/rstudio/rstudio/pull/6688#discussion_r412596139", "createdAt": "2020-04-22T01:10:18Z", "author": {"login": "kevinushey"}, "path": "src/cpp/session/resources/pagedtable/pagedtable.js", "diffHunk": "@@ -525,6 +528,36 @@ var PagedTable = function (pagedTable) {\n \n     var fragment = document.createDocumentFragment();\n \n+    // show metadata on top of header\n+    if (options.metadata !== {}) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "00f71f7b10aae5bcddb0ee4735d2108a99f5b84e"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f644f29defc3f81baffc6cdc988e4698dbd9aaa", "author": {"user": {"login": "jmcphers", "name": "Jonathan"}}, "url": "https://github.com/rstudio/rstudio/commit/2f644f29defc3f81baffc6cdc988e4698dbd9aaa", "committedDate": "2020-04-22T17:00:10Z", "message": "Apply suggestions from code review\n\nCo-Authored-By: Kevin Ushey <kevin@rstudio.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a664d069c4fcc2cd7ce697545b0014809eefe90", "author": {"user": {"login": "jmcphers", "name": "Jonathan"}}, "url": "https://github.com/rstudio/rstudio/commit/6a664d069c4fcc2cd7ce697545b0014809eefe90", "committedDate": "2020-04-22T17:01:46Z", "message": "Merge remote-tracking branch 'origin/master' into feature/notebook-chunk-metadata"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NTk3OTYy", "url": "https://github.com/rstudio/rstudio/pull/6688#pullrequestreview-398597962", "createdAt": "2020-04-22T21:19:54Z", "commit": {"oid": "6a664d069c4fcc2cd7ce697545b0014809eefe90"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 212, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}