{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzMTk3NzYz", "number": 7759, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQyMzo0NToyNVrOEh5VoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQyMzo0NToyNVrOEh5VoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAzOTc3ODg4OnYy", "diffSide": "RIGHT", "path": "src/gwt/panmirror/src/editor/src/optional/ace/ace.ts", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQyMzo0NToyNVrOHPd78Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQxOToyNToxNlrOHQCovw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk4MTE2OQ==", "bodyText": "Is listening for beforeEndOperation signals from the editor instance itself an option here? This is basically where Ace itself looks and tries to scroll into view after a command is executed:\nhttps://github.com/ajaxorg/ace/blob/3ebb0c34dc023aff3b6a951dd116a702510369fe/lib/ace/editor.js#L175", "url": "https://github.com/rstudio/rstudio/pull/7759#discussion_r485981169", "createdAt": "2020-09-09T23:45:25Z", "author": {"login": "kevinushey"}, "path": "src/gwt/panmirror/src/editor/src/optional/ace/ace.ts", "diffHunk": "@@ -455,6 +501,16 @@ export class AceNodeView implements NodeView {\n       }\n     });\n \n+    // If the cursor moves and we're in focus, ensure that the cursor is\n+    // visible. Ace's own cursor visiblity mechanisms don't work in embedded\n+    // editors.\n+    this.editSession.getSelection().on('changeCursor', () => {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e1a197eef12f528379dd9c9babddbcee6c0ddfd"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk4MjMxNg==", "bodyText": "I'll look into that. The first couple tries at this fix were unsuccessful because scrolling the document immediately after the cursor moved generated jumpiness and unwanted selections (Ace wasn't really done).", "url": "https://github.com/rstudio/rstudio/pull/7759#discussion_r485982316", "createdAt": "2020-09-09T23:49:29Z", "author": {"login": "jmcphers"}, "path": "src/gwt/panmirror/src/editor/src/optional/ace/ace.ts", "diffHunk": "@@ -455,6 +501,16 @@ export class AceNodeView implements NodeView {\n       }\n     });\n \n+    // If the cursor moves and we're in focus, ensure that the cursor is\n+    // visible. Ace's own cursor visiblity mechanisms don't work in embedded\n+    // editors.\n+    this.editSession.getSelection().on('changeCursor', () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk4MTE2OQ=="}, "originalCommit": {"oid": "3e1a197eef12f528379dd9c9babddbcee6c0ddfd"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjUzODY3NQ==", "bodyText": "@kevinushey beforeEndOperation is indeed better! Updated.", "url": "https://github.com/rstudio/rstudio/pull/7759#discussion_r486538675", "createdAt": "2020-09-10T18:12:22Z", "author": {"login": "jmcphers"}, "path": "src/gwt/panmirror/src/editor/src/optional/ace/ace.ts", "diffHunk": "@@ -455,6 +501,16 @@ export class AceNodeView implements NodeView {\n       }\n     });\n \n+    // If the cursor moves and we're in focus, ensure that the cursor is\n+    // visible. Ace's own cursor visiblity mechanisms don't work in embedded\n+    // editors.\n+    this.editSession.getSelection().on('changeCursor', () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk4MTE2OQ=="}, "originalCommit": {"oid": "3e1a197eef12f528379dd9c9babddbcee6c0ddfd"}, "originalPosition": 90}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjU4MjQ2Mw==", "bodyText": "Awesome; LGTM!", "url": "https://github.com/rstudio/rstudio/pull/7759#discussion_r486582463", "createdAt": "2020-09-10T19:25:16Z", "author": {"login": "kevinushey"}, "path": "src/gwt/panmirror/src/editor/src/optional/ace/ace.ts", "diffHunk": "@@ -455,6 +501,16 @@ export class AceNodeView implements NodeView {\n       }\n     });\n \n+    // If the cursor moves and we're in focus, ensure that the cursor is\n+    // visible. Ace's own cursor visiblity mechanisms don't work in embedded\n+    // editors.\n+    this.editSession.getSelection().on('changeCursor', () => {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk4MTE2OQ=="}, "originalCommit": {"oid": "3e1a197eef12f528379dd9c9babddbcee6c0ddfd"}, "originalPosition": 90}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4187, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}