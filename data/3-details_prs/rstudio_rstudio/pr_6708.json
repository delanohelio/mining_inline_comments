{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3MzQ3NjQy", "number": 6708, "title": "Prevent path traversal: Ignore relative URL path referencing past root", "bodyText": "Closes #1495\nThis PR adds a protection against path traversal in some scenarios.\nThe core of this change is the implementation of core::http::Path::cleanup().\nGoal: Pair each occurrence of ../ with a removal of an item from the path.\nBefore: If there was no matching pair (it was already on the \"root\") the ../ was preserved.\nNow: If there's no matching pair, the ../ is discarded.\nThe new behavior is similar to how NGINX handles relative paths.\nThat was detected when comparing open source and pro.\nWith the change above, core::http::URL::complete() will start to discard extraneous ../.\nThe boost::test gig present in URL was included in core/http/URLTests.cpp to be sure we keep testing these changes.\nThe second part of this change is exposing core::http::URL::cleanupPath() as a public function.\nThis function calls core::http::Path::cleanup().\nFinally, the core::http::pathAfterPrefix() function calls cleanupPath() ensuring that we thwart any attempts of path traversal, including /help which was the originally affected path.", "createdAt": "2020-04-22T14:59:36Z", "url": "https://github.com/rstudio/rstudio/pull/6708", "merged": true, "mergeCommit": {"oid": "27f390fe2a083a5ec96b947a68bbfea071a2604d"}, "closed": true, "closedAt": "2020-04-22T18:03:39Z", "author": {"login": "ricardofandrade"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZ8YDfAH2gAyNDA3MzQ3NjQyOmU4YzdiYzE4NTBiMDAxOTkwZDlhYjA2Y2Y5M2RjMjMwMjA1ZWQwZjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaMPJTgFqTM5ODQyODQ5OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "e8c7bc1850b001990d9ab06cf93dc230205ed0f2", "author": {"user": {"login": "ricardofandrade", "name": "Ricardo Andrade"}}, "url": "https://github.com/rstudio/rstudio/commit/e8c7bc1850b001990d9ab06cf93dc230205ed0f2", "committedDate": "2020-04-21T23:34:46Z", "message": "Ignore relative URL path referencing past root"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NDI4NDk4", "url": "https://github.com/rstudio/rstudio/pull/6708#pullrequestreview-398428498", "createdAt": "2020-04-22T17:42:42Z", "commit": {"oid": "e8c7bc1850b001990d9ab06cf93dc230205ed0f2"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzo0Mjo0MlrOGKC5lQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxNzo0Mjo0MlrOGKC5lQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE4NjQ1Mw==", "bodyText": "Thanks for adding these to the unit tests!", "url": "https://github.com/rstudio/rstudio/pull/6708#discussion_r413186453", "createdAt": "2020-04-22T17:42:42Z", "author": {"login": "jmcphers"}, "path": "src/cpp/core/http/URLTests.cpp", "diffHunk": "@@ -25,6 +25,11 @@ namespace util {\n \n test_context(\"HttpUtil Tests\")\n {\n+   test_that(\"URL pass\")\n+   {\n+      URL::test();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8c7bc1850b001990d9ab06cf93dc230205ed0f2"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 215, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}