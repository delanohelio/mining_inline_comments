{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyMzE3OTU5", "number": 5981, "title": "Cache deck split", "bodyText": "Pull Request template\nPurpose / Description\nThis PR does multiple very related changes.\n\nIt takes path and basename from upstream, make them public and uses them where possible to make code more readable\nIt uses array instead of list for paths. So that we avoid a useless transformation.\nIt cache name splitting, which is actually a very time-consuming operation. (7 seconds in loading the list of decks are spent on splitting deck name on my collection. Mostly because in order to sort decks, we must split them first.)\nthe methods _isParent and _isAncestor were wrongly implemented. In particular in cases where the ancestor was longer than descendant, it may return true.\n\nI should note that if and when you merge this PR or #5943 the other will need to be rebased. Because this other commit does a split without using path() method.\nHow Has This Been Tested?\nIn my \"merge\" branch.\nChecklist\nPlease, go through these checks before submitting the PR.\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-04-12T10:25:26Z", "url": "https://github.com/ankidroid/Anki-Android/pull/5981", "merged": true, "mergeCommit": {"oid": "be6d3d9aa807ccaeb42b020810cad4f8b52b5f45"}, "closed": true, "closedAt": "2020-04-12T20:00:03Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcW4BrcABqjMyMjQ5NzA4OTA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcW-gE7AFqTM5MTg4MzIwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c75c467373e823f81ac87dc01a692d3d47f8e16b", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/c75c467373e823f81ac87dc01a692d3d47f8e16b", "committedDate": "2020-04-12T10:15:08Z", "message": "Cache path name"}, "afterCommit": {"oid": "de92f72d53bb4500d3f0631f73dcbdef29a360d2", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/de92f72d53bb4500d3f0631f73dcbdef29a360d2", "committedDate": "2020-04-12T10:48:34Z", "message": "Cache path name"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "de92f72d53bb4500d3f0631f73dcbdef29a360d2", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/de92f72d53bb4500d3f0631f73dcbdef29a360d2", "committedDate": "2020-04-12T10:48:34Z", "message": "Cache path name"}, "afterCommit": {"oid": "d91893a64ce9473c2fed4ae09186ff4788dadf0d", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/d91893a64ce9473c2fed4ae09186ff4788dadf0d", "committedDate": "2020-04-12T12:17:09Z", "message": "Cache path name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODY3NDM0", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#pullrequestreview-391867434", "createdAt": "2020-04-12T15:16:10Z", "commit": {"oid": "dfcac93a3bd9b12612339c268a88e0959c868692"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNToxNjoxMFrOGEWQWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNToyMjowOFrOGEWTvA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIxMjEyMg==", "bodyText": "[Edited: this is correct on re-read, disregard this comment]\nI don't believe this is correct. By definition a child path will have more parts than a parent path, so their size will be unequal, so this will return false even if the parent is the valid parent of the child.\nPython seems more expressive in this sense - here is the upstream code - so the implementations are not directly comparable unfortunately\nhttps://github.com/ankitects/anki/blob/0c5f22f4ae7be0b1e5ffcb1d5a8dddd9f73930f0/pylib/anki/decks.py#L274-L277", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#discussion_r407212122", "createdAt": "2020-04-12T15:16:10Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -521,9 +521,14 @@ private boolean _canDragAndDrop(String draggedDeckName, String ontoDeckName) {\n \n     private boolean _isParent(String parentDeckName, String childDeckName) {\n         List<String> parentDeckPath = path(parentDeckName);\n+        List<String> childDeckPath = path(childDeckName);\n         parentDeckPath.add(basename(childDeckName));\n-\n-        Iterator<String> cpIt = path(childDeckName).iterator();\n+        \n+        if (parentDeckPath.size() != childDeckPath.size()) {\n+            return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfcac93a3bd9b12612339c268a88e0959c868692"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIxMjM0OA==", "bodyText": "AnkiDroid coding standards - whitespace around operators so they stand out visually\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    for(int i=0; i<path.size() - 1; i++) {\n          \n          \n            \n                    for(int i = 0; i < path.size() - 1; i++) {", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#discussion_r407212348", "createdAt": "2020-04-12T15:17:32Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -574,7 +574,8 @@ public String _ensureParents(String name) {\n         if (path.size() < 2) {\n             return name;\n         }\n-        for(String p : path.subList(0, path.size() - 1)) {\n+        for(int i=0; i<path.size() - 1; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "49a9824a8cb037e01009e35e3580a89d284ad5b6"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIxMjcyNg==", "bodyText": "Oh wait! I didn't see the +1, this is correct. Just needs a whitespace difference", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#discussion_r407212726", "createdAt": "2020-04-12T15:19:53Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -521,9 +521,14 @@ private boolean _canDragAndDrop(String draggedDeckName, String ontoDeckName) {\n \n     private boolean _isParent(String parentDeckName, String childDeckName) {\n         List<String> parentDeckPath = path(parentDeckName);\n+        List<String> childDeckPath = path(childDeckName);\n         parentDeckPath.add(basename(childDeckName));\n-\n-        Iterator<String> cpIt = path(childDeckName).iterator();\n+        \n+        if (parentDeckPath.size() != childDeckPath.size()) {\n+            return false;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIxMjEyMg=="}, "originalCommit": {"oid": "dfcac93a3bd9b12612339c268a88e0959c868692"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIxMjgyMA==", "bodyText": "whitespace around operators so they stand out\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (parentDeckPath.length +1 != childDeckPath.length) {\n          \n          \n            \n                    if (parentDeckPath.length + 1 != childDeckPath.length) {", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#discussion_r407212820", "createdAt": "2020-04-12T15:20:43Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -520,17 +520,15 @@ private boolean _canDragAndDrop(String draggedDeckName, String ontoDeckName) {\n \n \n     private boolean _isParent(String parentDeckName, String childDeckName) {\n-        List<String> parentDeckPath = path(parentDeckName);\n-        List<String> childDeckPath = path(childDeckName);\n+        String[] parentDeckPath = path(parentDeckName);\n+        String[] childDeckPath = path(childDeckName);\n         \n-        if (parentDeckPath.size() +1 != childDeckName.size()) {\n+        if (parentDeckPath.length +1 != childDeckPath.length) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "def41eacd135d5e2f56304c3e19d323fca451109"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIxMjg2OQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    for (int i=0; i < parentDeckPath.length; i++) {\n          \n          \n            \n                    for (int i = 0; i < parentDeckPath.length; i++) {", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#discussion_r407212869", "createdAt": "2020-04-12T15:21:06Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -520,17 +520,15 @@ private boolean _canDragAndDrop(String draggedDeckName, String ontoDeckName) {\n \n \n     private boolean _isParent(String parentDeckName, String childDeckName) {\n-        List<String> parentDeckPath = path(parentDeckName);\n-        List<String> childDeckPath = path(childDeckName);\n+        String[] parentDeckPath = path(parentDeckName);\n+        String[] childDeckPath = path(childDeckName);\n         \n-        if (parentDeckPath.size() +1 != childDeckName.size()) {\n+        if (parentDeckPath.length +1 != childDeckPath.length) {\n             return false;\n         }\n-        \n-        Iterator<String> cpIt = childDeckPath.iterator();\n-        Iterator<String> ppIt = parentDeckPath.iterator();\n-        while (cpIt.hasNext() && ppIt.hasNext()) {\n-            if (!cpIt.next().equals(ppIt.next())) {\n+\n+        for (int i=0; i < parentDeckPath.length; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "def41eacd135d5e2f56304c3e19d323fca451109"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIxMjk4OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    for (int i=0; i<ancestorDeckPath.length; i++) {\n          \n          \n            \n                    for (int i = 0; i < ancestorDeckPath.length; i++) {\n          \n      \n    \n    \n  \n\nI'm leaving these whitespace comments as suggestions but if you actually commit them like this the commit history will be hash and I'll want to squash, better to rebase and fix the original commits so I can rebase+merge and preserve the otherwise-beautifully separated commits", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#discussion_r407212988", "createdAt": "2020-04-12T15:22:08Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -539,29 +537,28 @@ private boolean _isParent(String parentDeckName, String childDeckName) {\n \n \n     private boolean _isAncestor(String ancestorDeckName, String descendantDeckName) {\n-        List<String> ancestorDeckPath = path(ancestorDeckName);\n-        List<String> descendantDeckPath = path(descendantDeckName);\n-        if (ancestorDeckPath.size() > descendantDeckName.size()) {\n+        String[] ancestorDeckPath = path(ancestorDeckName);\n+        String[] descendantDeckPath = path(descendantDeckName);\n+        if (ancestorDeckPath.length > descendantDeckPath.length) {\n             return false;\n         }\n-        Iterator<String> apIt = ancestorDeckPath.iterator();\n-        Iterator<String> dpIt = descendantDeckPath.iterator();\n-        while (apIt.hasNext() && dpIt.hasNext()) {\n-            if (!apIt.next().equals(dpIt.next())) {\n+\n+        for (int i=0; i<ancestorDeckPath.length; i++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "def41eacd135d5e2f56304c3e19d323fca451109"}, "originalPosition": 41}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d91893a64ce9473c2fed4ae09186ff4788dadf0d", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/d91893a64ce9473c2fed4ae09186ff4788dadf0d", "committedDate": "2020-04-12T12:17:09Z", "message": "Cache path name"}, "afterCommit": {"oid": "8d2c9cc56eda37074b946c2a13b82400ebe3ab7e", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/8d2c9cc56eda37074b946c2a13b82400ebe3ab7e", "committedDate": "2020-04-12T15:40:54Z", "message": "Cache path name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODcwNjE1", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#pullrequestreview-391870615", "createdAt": "2020-04-12T15:51:40Z", "commit": {"oid": "8d2c9cc56eda37074b946c2a13b82400ebe3ab7e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNTo1MTo0MVrOGEWiEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxNTo1MTo0MVrOGEWiEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIxNjY1OQ==", "bodyText": "Yes - your commit histories are usually very nice, to the extent they can be (sometimes things are messy because life is messy). Ironically though, this is all fixed now except this one line that has the comment pinned to it :-) - line 546 of libanki/Decks.java", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#discussion_r407216659", "createdAt": "2020-04-12T15:51:41Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -539,29 +537,28 @@ private boolean _isParent(String parentDeckName, String childDeckName) {\n \n \n     private boolean _isAncestor(String ancestorDeckName, String descendantDeckName) {\n-        List<String> ancestorDeckPath = path(ancestorDeckName);\n-        List<String> descendantDeckPath = path(descendantDeckName);\n-        if (ancestorDeckPath.size() > descendantDeckName.size()) {\n+        String[] ancestorDeckPath = path(ancestorDeckName);\n+        String[] descendantDeckPath = path(descendantDeckName);\n+        if (ancestorDeckPath.length > descendantDeckPath.length) {\n             return false;\n         }\n-        Iterator<String> apIt = ancestorDeckPath.iterator();\n-        Iterator<String> dpIt = descendantDeckPath.iterator();\n-        while (apIt.hasNext() && dpIt.hasNext()) {\n-            if (!apIt.next().equals(dpIt.next())) {\n+\n+        for (int i=0; i<ancestorDeckPath.length; i++) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIxMjk4OA=="}, "originalCommit": {"oid": "def41eacd135d5e2f56304c3e19d323fca451109"}, "originalPosition": 41}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d2c9cc56eda37074b946c2a13b82400ebe3ab7e", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/8d2c9cc56eda37074b946c2a13b82400ebe3ab7e", "committedDate": "2020-04-12T15:40:54Z", "message": "Cache path name"}, "afterCommit": {"oid": "be225401cb09ee3a2b014ebd45313523804d8e1e", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/be225401cb09ee3a2b014ebd45313523804d8e1e", "committedDate": "2020-04-12T16:21:32Z", "message": "Cache path name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODc0ODcy", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#pullrequestreview-391874872", "createdAt": "2020-04-12T16:39:46Z", "commit": {"oid": "be225401cb09ee3a2b014ebd45313523804d8e1e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "be225401cb09ee3a2b014ebd45313523804d8e1e", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/be225401cb09ee3a2b014ebd45313523804d8e1e", "committedDate": "2020-04-12T16:21:32Z", "message": "Cache path name"}, "afterCommit": {"oid": "2f3fb9a811282267b7c10be1a3f0e6e1a2094794", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/2f3fb9a811282267b7c10be1a3f0e6e1a2094794", "committedDate": "2020-04-12T16:24:09Z", "message": "Cache path name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0e9a121930d7113257e092c82a0c89fe7530519", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/e0e9a121930d7113257e092c82a0c89fe7530519", "committedDate": "2020-04-12T18:15:11Z", "message": "Decks._path to path\n\nAs in upstream anki"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "adb39fe54b829fa97203c0dd3c68068104698526", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/adb39fe54b829fa97203c0dd3c68068104698526", "committedDate": "2020-04-12T18:17:01Z", "message": "uses Decks.path everywhere possible"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a347aa0246d538725499629f3c83891f218860e", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/2a347aa0246d538725499629f3c83891f218860e", "committedDate": "2020-04-12T18:17:02Z", "message": "basename public as in upstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ad8712339d710f99fbc31be50db9aecf8eb9a65", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7ad8712339d710f99fbc31be50db9aecf8eb9a65", "committedDate": "2020-04-12T18:17:02Z", "message": "remove duplicate code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16cd407614563b753f4e51a7a02ca517f812f5bd", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/16cd407614563b753f4e51a7a02ca517f812f5bd", "committedDate": "2020-04-12T18:17:02Z", "message": "use basename where possible"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e40d256f79dfae7cf771f3ca614e56e79c036701", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/e40d256f79dfae7cf771f3ca614e56e79c036701", "committedDate": "2020-04-12T18:17:02Z", "message": "correct _isParent similarly to upstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b2e4b63c0352895eec91e05829ee553c3b8f420", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/3b2e4b63c0352895eec91e05829ee553c3b8f420", "committedDate": "2020-04-12T18:17:02Z", "message": "Correct _isAncestor As in upstream"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "104a1fbc348cc31835937b4e017cbc9fca14e105", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/104a1fbc348cc31835937b4e017cbc9fca14e105", "committedDate": "2020-04-12T18:17:02Z", "message": "Don't add to parentDeckName\n\nThis was useless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1183af8dc5adf4427ef707f1c7e6b47256c5e150", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/1183af8dc5adf4427ef707f1c7e6b47256c5e150", "committedDate": "2020-04-12T18:17:02Z", "message": "_ensureParents without sublist\n\nUselessly slow for what it's worth here"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2f3fb9a811282267b7c10be1a3f0e6e1a2094794", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/2f3fb9a811282267b7c10be1a3f0e6e1a2094794", "committedDate": "2020-04-12T16:24:09Z", "message": "Cache path name"}, "afterCommit": {"oid": "882db7feedb7adee0ba2a9441ee1ea4b64806f03", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/882db7feedb7adee0ba2a9441ee1ea4b64806f03", "committedDate": "2020-04-12T18:17:02Z", "message": "Cache path name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27eb4bcc6de9d8bdd126233fd7ba11ff24109433", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/27eb4bcc6de9d8bdd126233fd7ba11ff24109433", "committedDate": "2020-04-12T18:19:21Z", "message": "Decks.path return array"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "701fbb5b7be3e152d743a8184f8178f8fcb069a1", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/701fbb5b7be3e152d743a8184f8178f8fcb069a1", "committedDate": "2020-04-12T18:19:21Z", "message": "Cache path name"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "882db7feedb7adee0ba2a9441ee1ea4b64806f03", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/882db7feedb7adee0ba2a9441ee1ea4b64806f03", "committedDate": "2020-04-12T18:17:02Z", "message": "Cache path name"}, "afterCommit": {"oid": "701fbb5b7be3e152d743a8184f8178f8fcb069a1", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/701fbb5b7be3e152d743a8184f8178f8fcb069a1", "committedDate": "2020-04-12T18:19:21Z", "message": "Cache path name"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxODgzMjA3", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#pullrequestreview-391883207", "createdAt": "2020-04-12T18:21:34Z", "commit": {"oid": "701fbb5b7be3e152d743a8184f8178f8fcb069a1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxODoyMTozNFrOGEXocg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMlQxODoyMTozNFrOGEXocg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzIzNDY3NA==", "bodyText": "Issue found: Fields should be declared at the top of the class, before any method declarations, constructors, initializers or inner classes.", "url": "https://github.com/ankidroid/Anki-Android/pull/5981#discussion_r407234674", "createdAt": "2020-04-12T18:21:34Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -533,23 +533,32 @@ private boolean _isParent(String parentDeckName, String childDeckName) {\n \n \n     private boolean _isAncestor(String ancestorDeckName, String descendantDeckName) {\n-        Iterator<String> apIt = _path(ancestorDeckName).iterator();\n-        Iterator<String> dpIt = _path(descendantDeckName).iterator();\n-        while (apIt.hasNext() && dpIt.hasNext()) {\n-            if (!apIt.next().equals(dpIt.next())) {\n+        String[] ancestorDeckPath = path(ancestorDeckName);\n+        String[] descendantDeckPath = path(descendantDeckName);\n+        if (ancestorDeckPath.length > descendantDeckPath.length) {\n+            return false;\n+        }\n+\n+        for (int i = 0; i < ancestorDeckPath.length; i++) {\n+            if (ancestorDeckPath[i] != descendantDeckPath[i]) {\n                 return false;\n             }\n         }\n         return true;\n     }\n \n \n-    private List<String> _path(String name) {\n-        return Arrays.asList(name.split(\"::\", -1));\n+    private static HashMap<String, String[]> pathCache = new HashMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "701fbb5b7be3e152d743a8184f8178f8fcb069a1"}, "originalPosition": 67}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3642, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}