{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzOTk5MDAw", "number": 6453, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QxOTozNjoyN1rOEFRZhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODozMzoyOVrOEGQDtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjczOTYzMzk2OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QxOTozNjoyN1rOGjZCuQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QxOTozNjoyN1rOGjZCuQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc2MzY0MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                /** With .28, anki started strips whitespace of deck name.\n          \n          \n            \n                /** With 2.1.28, anki started strips whitespace of deck name.", "url": "https://github.com/ankidroid/Anki-Android/pull/6453#discussion_r439763641", "createdAt": "2020-06-13T19:36:27Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -777,6 +779,27 @@ private void maybeAddToActive() {\n                 \"select id from cards where did in \" + Utils.ids2str(Utils.arrayList2array(dids)), 0));\n     }\n \n+\n+    private static final Pattern spaceAroundSeparator = Pattern.compile(\" *:: *\");\n+    private static String strip(String deckName) {\n+        return spaceAroundSeparator.matcher(deckName.trim()).replaceAll( \"::\");\n+    }\n+\n+    /** With .28, anki started strips whitespace of deck name.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8315849aee4669996e25a5e95b345a8834c87c1d"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTg5NDAyOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODozMTo0OFrOGk7ZFQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwOToxNjo0MVrOGk9Hrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM3NDk5Nw==", "bodyText": "sSpaceAroundSeparator", "url": "https://github.com/ankidroid/Anki-Android/pull/6453#discussion_r441374997", "createdAt": "2020-06-17T08:31:48Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -777,6 +779,27 @@ private void maybeAddToActive() {\n                 \"select id from cards where did in \" + Utils.ids2str(Utils.arrayList2array(dids)), 0));\n     }\n \n+\n+    private static final Pattern spaceAroundSeparator = Pattern.compile(\" *:: *\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456b8a9036adde0def848bad303ef06e5a40c5df"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM3NTM1Mw==", "bodyText": "Is this the same pattern as the one that Anki uses? Will have have problems such as the triple-colon that you previously solved?", "url": "https://github.com/ankidroid/Anki-Android/pull/6453#discussion_r441375353", "createdAt": "2020-06-17T08:32:24Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -777,6 +779,27 @@ private void maybeAddToActive() {\n                 \"select id from cards where did in \" + Utils.ids2str(Utils.arrayList2array(dids)), 0));\n     }\n \n+\n+    private static final Pattern spaceAroundSeparator = Pattern.compile(\" *:: *\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM3NDk5Nw=="}, "originalCommit": {"oid": "456b8a9036adde0def848bad303ef06e5a40c5df"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQwMzMxMQ==", "bodyText": "No triple column problem. The 3rd columnis the first letter of the deck nme, so no reason to strip ant space.\nI have not found where this change is made in rust, so can't tell whether this regexp is used", "url": "https://github.com/ankidroid/Anki-Android/pull/6453#discussion_r441403311", "createdAt": "2020-06-17T09:16:41Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -777,6 +779,27 @@ private void maybeAddToActive() {\n                 \"select id from cards where did in \" + Utils.ids2str(Utils.arrayList2array(dids)), 0));\n     }\n \n+\n+    private static final Pattern spaceAroundSeparator = Pattern.compile(\" *:: *\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM3NDk5Nw=="}, "originalCommit": {"oid": "456b8a9036adde0def848bad303ef06e5a40c5df"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjc0OTkwMDA0OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QwODozMzoyOVrOGk7dEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxMDowOToyOVrOGk_F8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM3NjAxOQ==", "bodyText": "Have you tested this on decks with duplicate names and different spacing?\nHave you tested this on decks which would normalise to the same name: \"Foo\" and \" FOO \"\nCan the user currently call their deck \"\", or \" \", would this generate an invalid name? What happens in Anki Desktop?", "url": "https://github.com/ankidroid/Anki-Android/pull/6453#discussion_r441376019", "createdAt": "2020-06-17T08:33:29Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -777,6 +779,27 @@ private void maybeAddToActive() {\n                 \"select id from cards where did in \" + Utils.ids2str(Utils.arrayList2array(dids)), 0));\n     }\n \n+\n+    private static final Pattern spaceAroundSeparator = Pattern.compile(\" *:: *\");\n+    private static String strip(String deckName) {\n+        return spaceAroundSeparator.matcher(deckName.trim()).replaceAll( \"::\");\n+    }\n+\n+    /** With 2.1.28, anki started strips whitespace of deck name.\n+     * This method is here for compatibility while we wait for rust.\n+     * It should be executed before other methods, because both \"FOO \" and \"FOO\" will be renamed to the same name,\n+     * and so this will need to be renamed by _checkDeckTree.*/\n+    private void _removeSpaces () {\n+        for (JSONObject deck: all()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "456b8a9036adde0def848bad303ef06e5a40c5df"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQwNDQ1Ng==", "bodyText": "Duplicate name and different spacing was mentionned above. I don t know whether \" \" used to be valid, im pretty sure that \"\" was already not valid", "url": "https://github.com/ankidroid/Anki-Android/pull/6453#discussion_r441404456", "createdAt": "2020-06-17T09:18:40Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -777,6 +779,27 @@ private void maybeAddToActive() {\n                 \"select id from cards where did in \" + Utils.ids2str(Utils.arrayList2array(dids)), 0));\n     }\n \n+\n+    private static final Pattern spaceAroundSeparator = Pattern.compile(\" *:: *\");\n+    private static String strip(String deckName) {\n+        return spaceAroundSeparator.matcher(deckName.trim()).replaceAll( \"::\");\n+    }\n+\n+    /** With 2.1.28, anki started strips whitespace of deck name.\n+     * This method is here for compatibility while we wait for rust.\n+     * It should be executed before other methods, because both \"FOO \" and \"FOO\" will be renamed to the same name,\n+     * and so this will need to be renamed by _checkDeckTree.*/\n+    private void _removeSpaces () {\n+        for (JSONObject deck: all()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM3NjAxOQ=="}, "originalCommit": {"oid": "456b8a9036adde0def848bad303ef06e5a40c5df"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQxNTgyNQ==", "bodyText": "Just checked: \"FOO   \" is detected to be the same deck as \"foo\" so can't be created. Creating a deck is just ignored. Renaming is rejected with a message stating that this deck already exists.\nI just discovered that ankidroid accepts to create the deck \"\". (and that \"   \" is renamed as \"\", but I was expecting that)", "url": "https://github.com/ankidroid/Anki-Android/pull/6453#discussion_r441415825", "createdAt": "2020-06-17T09:36:28Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -777,6 +779,27 @@ private void maybeAddToActive() {\n                 \"select id from cards where did in \" + Utils.ids2str(Utils.arrayList2array(dids)), 0));\n     }\n \n+\n+    private static final Pattern spaceAroundSeparator = Pattern.compile(\" *:: *\");\n+    private static String strip(String deckName) {\n+        return spaceAroundSeparator.matcher(deckName.trim()).replaceAll( \"::\");\n+    }\n+\n+    /** With 2.1.28, anki started strips whitespace of deck name.\n+     * This method is here for compatibility while we wait for rust.\n+     * It should be executed before other methods, because both \"FOO \" and \"FOO\" will be renamed to the same name,\n+     * and so this will need to be renamed by _checkDeckTree.*/\n+    private void _removeSpaces () {\n+        for (JSONObject deck: all()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM3NjAxOQ=="}, "originalCommit": {"oid": "456b8a9036adde0def848bad303ef06e5a40c5df"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQzNTYzNQ==", "bodyText": "\"\" is rejected upstream, while \" \" is accepted and then renamed to \"blank\". I corrected it in ankitects/anki#669", "url": "https://github.com/ankidroid/Anki-Android/pull/6453#discussion_r441435635", "createdAt": "2020-06-17T10:09:29Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -777,6 +779,27 @@ private void maybeAddToActive() {\n                 \"select id from cards where did in \" + Utils.ids2str(Utils.arrayList2array(dids)), 0));\n     }\n \n+\n+    private static final Pattern spaceAroundSeparator = Pattern.compile(\" *:: *\");\n+    private static String strip(String deckName) {\n+        return spaceAroundSeparator.matcher(deckName.trim()).replaceAll( \"::\");\n+    }\n+\n+    /** With 2.1.28, anki started strips whitespace of deck name.\n+     * This method is here for compatibility while we wait for rust.\n+     * It should be executed before other methods, because both \"FOO \" and \"FOO\" will be renamed to the same name,\n+     * and so this will need to be renamed by _checkDeckTree.*/\n+    private void _removeSpaces () {\n+        for (JSONObject deck: all()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTM3NjAxOQ=="}, "originalCommit": {"oid": "456b8a9036adde0def848bad303ef06e5a40c5df"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 185, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}