{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyNTkxMzA3", "number": 5993, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzo0MTo1NVrODxPsZw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzo1NDoyNlrODxP71A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyOTYzOTQzOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/FieldEditText.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzo0MTo1NVrOGEm06A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNDoxODowM1rOGEn5aQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ4MzYyNA==", "bodyText": "This is not the proper use of the Compat infrastructure\nIf you can't put a comment on top of every single API that you add to Compat that explains the difference in behavior across Android versions, and in which exact version you can remove the Compat API with old workaround-implementation and inline the \"modern\" implementation, then it does not belong in Compat", "url": "https://github.com/ankidroid/Anki-Android/pull/5993#discussion_r407483624", "createdAt": "2020-04-13T13:41:55Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/FieldEditText.java", "diffHunk": "@@ -18,7 +19,7 @@\n \n public class FieldEditText extends AppCompatEditText {\n \n-    public static final String NEW_LINE = System.getProperty(\"line.separator\");\n+    public static final String NEW_LINE = CompatHelper.getCompat().getLineSeparator();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cc63b7965f4e869ba2389a2c4bb3dc11e5642895"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ5NTQ3MQ==", "bodyText": "Wasn't aware. I'll rebase and kill this change.", "url": "https://github.com/ankidroid/Anki-Android/pull/5993#discussion_r407495471", "createdAt": "2020-04-13T14:06:11Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/FieldEditText.java", "diffHunk": "@@ -18,7 +19,7 @@\n \n public class FieldEditText extends AppCompatEditText {\n \n-    public static final String NEW_LINE = System.getProperty(\"line.separator\");\n+    public static final String NEW_LINE = CompatHelper.getCompat().getLineSeparator();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ4MzYyNA=="}, "originalCommit": {"oid": "cc63b7965f4e869ba2389a2c4bb3dc11e5642895"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzUwMTE2MQ==", "bodyText": "I have to admit since deprecation / forward-porting was the first thing I started working on in earnest in the project I feel like Compat is my baby but the structure itself already completely existed, and after learning how it worked I like it. Not sure if there is a better way to handle API differences without just bumping minSdkVersion but this one is certainly powerful and not too hard to drive as a developer. If you ever dig into the stack of deprecation issues you'll become intimately familiar, anyway :-)", "url": "https://github.com/ankidroid/Anki-Android/pull/5993#discussion_r407501161", "createdAt": "2020-04-13T14:18:03Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/FieldEditText.java", "diffHunk": "@@ -18,7 +19,7 @@\n \n public class FieldEditText extends AppCompatEditText {\n \n-    public static final String NEW_LINE = System.getProperty(\"line.separator\");\n+    public static final String NEW_LINE = CompatHelper.getCompat().getLineSeparator();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ4MzYyNA=="}, "originalCommit": {"oid": "cc63b7965f4e869ba2389a2c4bb3dc11e5642895"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyOTY2NTc1OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/activity/MultimediaEditFieldActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzo1MDoxMFrOGEnEgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzo1OTowNVrOGEnVaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ4NzYxNw==", "bodyText": "https://developer.android.com/reference/android/content/Intent#getExtras()\n\"the map of all extras previously added with putExtra(), or null if none have been added.\"\n...you never know", "url": "https://github.com/ankidroid/Anki-Android/pull/5993#discussion_r407487617", "createdAt": "2020-04-13T13:50:10Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/activity/MultimediaEditFieldActivity.java", "diffHunk": "@@ -96,15 +96,21 @@ protected void onCreate(Bundle savedInstanceState) {\n             setSupportActionBar(toolbar);\n         }\n \n-        mField = (IField) this.getIntent().getExtras().getSerializable(EXTRA_FIELD);\n+        Intent intent = this.getIntent();\n+        mField = getFieldFromIntent(intent);\n \n-        mNote = (IMultimediaEditableNote) this.getIntent().getSerializableExtra(EXTRA_WHOLE_NOTE);\n+        mNote = (IMultimediaEditableNote) intent.getSerializableExtra(EXTRA_WHOLE_NOTE);\n \n-        mFieldIndex = this.getIntent().getIntExtra(EXTRA_FIELD_INDEX, 0);\n+        mFieldIndex = intent.getIntExtra(EXTRA_FIELD_INDEX, 0);\n \n         recreateEditingUi(ChangeUIRequest.init(mField));\n     }\n \n+    @VisibleForTesting\n+    public static IField getFieldFromIntent(Intent intent) {\n+        return (IField) intent.getExtras().getSerializable(EXTRA_FIELD);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c73658c9c00e42e688f4c37c811e11628206420e"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ5MTk0NA==", "bodyText": "I'm just using this as an accessor to ensure consistency between the reading of the activity output data in the test. There's no code change here.", "url": "https://github.com/ankidroid/Anki-Android/pull/5993#discussion_r407491944", "createdAt": "2020-04-13T13:59:05Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/activity/MultimediaEditFieldActivity.java", "diffHunk": "@@ -96,15 +96,21 @@ protected void onCreate(Bundle savedInstanceState) {\n             setSupportActionBar(toolbar);\n         }\n \n-        mField = (IField) this.getIntent().getExtras().getSerializable(EXTRA_FIELD);\n+        Intent intent = this.getIntent();\n+        mField = getFieldFromIntent(intent);\n \n-        mNote = (IMultimediaEditableNote) this.getIntent().getSerializableExtra(EXTRA_WHOLE_NOTE);\n+        mNote = (IMultimediaEditableNote) intent.getSerializableExtra(EXTRA_WHOLE_NOTE);\n \n-        mFieldIndex = this.getIntent().getIntExtra(EXTRA_FIELD_INDEX, 0);\n+        mFieldIndex = intent.getIntExtra(EXTRA_FIELD_INDEX, 0);\n \n         recreateEditingUi(ChangeUIRequest.init(mField));\n     }\n \n+    @VisibleForTesting\n+    public static IField getFieldFromIntent(Intent intent) {\n+        return (IField) intent.getExtras().getSerializable(EXTRA_FIELD);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ4NzYxNw=="}, "originalCommit": {"oid": "c73658c9c00e42e688f4c37c811e11628206420e"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyOTY3MjA0OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/test/java/com/ichi2/anki/RobolectricTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzo1MjoxNlrOGEnIUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzo1MjoxNlrOGEnIUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ4ODU5NQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                protected Note addBasicNote(String front, String back) {\n          \n          \n            \n                protected Note getNoteUsingBasicModel(String front, String back) {\n          \n      \n    \n    \n  \n\n...or similar, just a bit more unambiguous that the note itself isn't basic (maybe means a simple note?) but that it is attached to the basic model", "url": "https://github.com/ankidroid/Anki-Android/pull/5993#discussion_r407488595", "createdAt": "2020-04-13T13:52:16Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/test/java/com/ichi2/anki/RobolectricTest.java", "diffHunk": "@@ -91,4 +95,23 @@ protected JSONObject getCurrentDatabaseModelCopy(String modelName) throws JSONEx\n         Models collectionModels = getCol().getModels();\n         return new JSONObject(collectionModels.byName(modelName).toString().trim());\n     }\n+\n+    protected <T extends AnkiActivity> T startActivityNormallyOpenCollectionWithIntent(Class<T> clazz, Intent i) {\n+        ActivityController multimediaController = Robolectric.buildActivity(clazz, i)\n+                .create().start().resume().visible();\n+        //noinspection unchecked\n+        return (T) multimediaController.get();\n+    }\n+\n+    protected Note addBasicNote(String front, String back) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c73658c9c00e42e688f4c37c811e11628206420e"}, "originalPosition": 34}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyOTY3ODkyOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/test/java/com/ichi2/anki/RobolectricTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzo1NDoyNlrOGEnMSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxMzo1NDoyNlrOGEnMSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzQ4OTYxMQ==", "bodyText": "On first read I thought this was bound to the multimedia work but it looks like you've made a fully general purpose activity starter?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                protected <T extends AnkiActivity> T startActivityNormallyOpenCollectionWithIntent(Class<T> clazz, Intent i) {\n          \n          \n            \n                    ActivityController multimediaController = Robolectric.buildActivity(clazz, i)\n          \n          \n            \n                            .create().start().resume().visible();\n          \n          \n            \n                    //noinspection unchecked\n          \n          \n            \n                    return (T) multimediaController.get();\n          \n          \n            \n                }\n          \n          \n            \n                protected <T extends AnkiActivity> T startActivityNormallyOpenCollectionWithIntent(Class<T> clazz, Intent i) {\n          \n          \n            \n                    ActivityController controller = Robolectric.buildActivity(clazz, i)\n          \n          \n            \n                            .create().start().resume().visible();\n          \n          \n            \n                    //noinspection unchecked\n          \n          \n            \n                    return (T) controller.get();\n          \n          \n            \n                }", "url": "https://github.com/ankidroid/Anki-Android/pull/5993#discussion_r407489611", "createdAt": "2020-04-13T13:54:26Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/test/java/com/ichi2/anki/RobolectricTest.java", "diffHunk": "@@ -91,4 +95,23 @@ protected JSONObject getCurrentDatabaseModelCopy(String modelName) throws JSONEx\n         Models collectionModels = getCol().getModels();\n         return new JSONObject(collectionModels.byName(modelName).toString().trim());\n     }\n+\n+    protected <T extends AnkiActivity> T startActivityNormallyOpenCollectionWithIntent(Class<T> clazz, Intent i) {\n+        ActivityController multimediaController = Robolectric.buildActivity(clazz, i)\n+                .create().start().resume().visible();\n+        //noinspection unchecked\n+        return (T) multimediaController.get();\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c73658c9c00e42e688f4c37c811e11628206420e"}, "originalPosition": 32}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 571, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}