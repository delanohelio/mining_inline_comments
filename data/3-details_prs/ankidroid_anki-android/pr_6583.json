{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQxNDk5Nzc5", "number": 6583, "title": "NF: Decrement moved to decrementCount", "bodyText": "This allow in future commit to precompute the next card without\nchanging the count; the counts being changed only when getCard\nactually return a card.\nThis would also avoid the code duplication of\ncard.getLeft() / 1000;\n\nExcept that instead we get comment duplication.\nThis is a commit from #6026 ; the idea as usual is to ensure that #6026 gets simpler to review.\nIt has been tested on my phone for weeks (month ?)", "createdAt": "2020-06-29T15:43:22Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6583", "merged": true, "mergeCommit": {"oid": "159b5b96e431c69e3c411b4c39989aacd3a45cb9"}, "closed": true, "closedAt": "2020-06-29T20:57:06Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwEPvyAFqTQzOTM0MjgzOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcwFzlbgFqTQzOTQxODk3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5MzQyODM4", "url": "https://github.com/ankidroid/Anki-Android/pull/6583#pullrequestreview-439342838", "createdAt": "2020-06-29T17:11:15Z", "commit": {"oid": "5dabb7487ef0abfed87fb75b4cea681eecddb510"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNzoxMToxNVrOGqaXEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxNzoxMToxNVrOGqaXEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzEyNTI2Ng==", "bodyText": "Make it obvious to match the two lines, and add a comment on decrementCount explaining why\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            /* upstream decrease mLrnCount. We do it in\n          \n          \n            \n                            // mLrnCount -= card.getLeft() / 1000; See decrementCount()", "url": "https://github.com/ankidroid/Anki-Android/pull/6583#discussion_r447125266", "createdAt": "2020-06-29T17:11:15Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/Sched.java", "diffHunk": "@@ -438,7 +438,8 @@ protected Card _getLrnCard(boolean collapse) {\n             if (mLrnQueue.getFirst()[0] < cutoff) {\n                 long id = mLrnQueue.remove()[1];\n                 Card card = mCol.getCard(id);\n-                mLrnCount -= card.getLeft() / 1000;\n+                /* upstream decrease mLrnCount. We do it in", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5dabb7487ef0abfed87fb75b4cea681eecddb510"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDA2MjE0", "url": "https://github.com/ankidroid/Anki-Android/pull/6583#pullrequestreview-439406214", "createdAt": "2020-06-29T18:41:51Z", "commit": {"oid": "bc49548260197d74a22db34061f67f43fecaf272"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxODo0MTo1MVrOGqdgRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yOVQxODo0MTo1MVrOGqdgRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzE3Njc3NA==", "bodyText": "Gah... GitHub's UI changes are terrible, sorry about that\nCould you also perform this change for the other line comments", "url": "https://github.com/ankidroid/Anki-Android/pull/6583#discussion_r447176774", "createdAt": "2020-06-29T18:41:51Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/Sched.java", "diffHunk": "@@ -438,7 +438,8 @@ protected Card _getLrnCard(boolean collapse) {\n             if (mLrnQueue.getFirst()[0] < cutoff) {\n                 long id = mLrnQueue.remove()[1];\n                 Card card = mCol.getCard(id);\n-                mLrnCount -= card.getLeft() / 1000;\n+                // mLrnCount -= card.getLeft() / 1000; See decrementCount()\n+                 * decrementCount once the card is returned.*/", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bc49548260197d74a22db34061f67f43fecaf272"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "85f94eb66ba5103d570d19c2d5608f016904423a", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/85f94eb66ba5103d570d19c2d5608f016904423a", "committedDate": "2020-06-29T18:42:05Z", "message": "NF: Decrement moved to decrementCount\n\nThis allow in future commit to precompute the next card without\nchanging the count; the counts being changed only when getCard\nactually return a card.\n\nThis would also avoid the code duplication of\n```\ncard.getLeft() / 1000;\n```\nExcept that instead we get comment duplication."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bc49548260197d74a22db34061f67f43fecaf272", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/bc49548260197d74a22db34061f67f43fecaf272", "committedDate": "2020-06-29T18:38:51Z", "message": "Update AnkiDroid/src/main/java/com/ichi2/libanki/sched/Sched.java\n\nCo-authored-by: david-allison-1 <62114487+david-allison-1@users.noreply.github.com>"}, "afterCommit": {"oid": "85f94eb66ba5103d570d19c2d5608f016904423a", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/85f94eb66ba5103d570d19c2d5608f016904423a", "committedDate": "2020-06-29T18:42:05Z", "message": "NF: Decrement moved to decrementCount\n\nThis allow in future commit to precompute the next card without\nchanging the count; the counts being changed only when getCard\nactually return a card.\n\nThis would also avoid the code duplication of\n```\ncard.getLeft() / 1000;\n```\nExcept that instead we get comment duplication."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDA5OTMy", "url": "https://github.com/ankidroid/Anki-Android/pull/6583#pullrequestreview-439409932", "createdAt": "2020-06-29T18:47:18Z", "commit": {"oid": "85f94eb66ba5103d570d19c2d5608f016904423a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM5NDE4OTc3", "url": "https://github.com/ankidroid/Anki-Android/pull/6583#pullrequestreview-439418977", "createdAt": "2020-06-29T19:00:19Z", "commit": {"oid": "85f94eb66ba5103d570d19c2d5608f016904423a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3038, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}