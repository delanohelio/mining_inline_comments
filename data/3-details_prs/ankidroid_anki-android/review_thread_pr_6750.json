{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2NjM4MjM1", "number": 6750, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNTozMzoyMlrOESKLzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxODo1ODozMFrOESLMoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NDc2Njg0OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/async/CollectionTask.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxNTozMzoyMlrOG3NNNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QwMjoxNzozOFrOG3RmYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0MTIzOA==", "bodyText": "I think this would be more readable as: Undoable.revertToProvidedState(card, BURY_CARD)", "url": "https://github.com/ankidroid/Anki-Android/pull/6750#discussion_r460541238", "createdAt": "2020-07-26T15:33:22Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/async/CollectionTask.java", "diffHunk": "@@ -643,19 +653,29 @@ private TaskData doInBackgroundDismissNote(TaskData... params) {\n                 switch (type) {\n                     case BURY_CARD:\n                         // collect undo information\n-                        col.markUndo(new UndoableBuryCard(note.cards(), card.getId()));\n+                        Undoable buryCard = new UndoableFlushAll(BURY_CARD, note.cards(), card.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4ab156e68089881a960864f9e132927f22f8d3f6"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYxMzA1NA==", "bodyText": "Done.", "url": "https://github.com/ankidroid/Anki-Android/pull/6750#discussion_r460613054", "createdAt": "2020-07-27T02:16:48Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/async/CollectionTask.java", "diffHunk": "@@ -643,19 +653,29 @@ private TaskData doInBackgroundDismissNote(TaskData... params) {\n                 switch (type) {\n                     case BURY_CARD:\n                         // collect undo information\n-                        col.markUndo(new UndoableBuryCard(note.cards(), card.getId()));\n+                        Undoable buryCard = new UndoableFlushAll(BURY_CARD, note.cards(), card.getId());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0MTIzOA=="}, "originalCommit": {"oid": "4ab156e68089881a960864f9e132927f22f8d3f6"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDYxMzIxNg==", "bodyText": "Should I do a distinct PR for this idea ? Because it was already relevant.\nIn this PR I was trying to concentrate on one idea: moving code to where it is actually used. It seems strange to do other change simultaneously, even if it does improve code quality", "url": "https://github.com/ankidroid/Anki-Android/pull/6750#discussion_r460613216", "createdAt": "2020-07-27T02:17:38Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/async/CollectionTask.java", "diffHunk": "@@ -643,19 +653,29 @@ private TaskData doInBackgroundDismissNote(TaskData... params) {\n                 switch (type) {\n                     case BURY_CARD:\n                         // collect undo information\n-                        col.markUndo(new UndoableBuryCard(note.cards(), card.getId()));\n+                        Undoable buryCard = new UndoableFlushAll(BURY_CARD, note.cards(), card.getId());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU0MTIzOA=="}, "originalCommit": {"oid": "4ab156e68089881a960864f9e132927f22f8d3f6"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg3NDkzMjgxOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/async/CollectionTask.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQxODo1ODozMFrOG3Ob-w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNlQyMDozNDo0NVrOG3O_aA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU2MTQwMw==", "bodyText": "nit: I feel a static method accepting a card and enum value, returning a class (name doesn't matter) would be better than a constructor here\n\nAccepting a card makes the intent clear - it's the card that we care about, and getting the siblings is an implementation detail\nThe intent of the method (revertToProvidedState) won't change, and that provides more meaning than the name of the class", "url": "https://github.com/ankidroid/Anki-Android/pull/6750#discussion_r460561403", "createdAt": "2020-07-26T18:58:30Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/async/CollectionTask.java", "diffHunk": "@@ -643,19 +653,29 @@ private TaskData doInBackgroundDismissNote(TaskData... params) {\n                 switch (type) {\n                     case BURY_CARD:\n                         // collect undo information\n-                        col.markUndo(new UndoableBuryCard(note.cards(), card.getId()));\n+                        Undoable buryCard = new RevertToProvidedState(BURY_CARD, note.cards(), card.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "63bdf388b2f7c5415579cd0e43b90c0f0d6ec150"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU3MDQ3Mg==", "bodyText": "Done", "url": "https://github.com/ankidroid/Anki-Android/pull/6750#discussion_r460570472", "createdAt": "2020-07-26T20:34:45Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/async/CollectionTask.java", "diffHunk": "@@ -643,19 +653,29 @@ private TaskData doInBackgroundDismissNote(TaskData... params) {\n                 switch (type) {\n                     case BURY_CARD:\n                         // collect undo information\n-                        col.markUndo(new UndoableBuryCard(note.cards(), card.getId()));\n+                        Undoable buryCard = new RevertToProvidedState(BURY_CARD, note.cards(), card.getId());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU2MTQwMw=="}, "originalCommit": {"oid": "63bdf388b2f7c5415579cd0e43b90c0f0d6ec150"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4955, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}