{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE3NTMzNjM4", "number": 7631, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwNzoxMDoyMVrOE2oNkA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwNzoxMDoyMVrOE2oNkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI1NzE3MzkyOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AnkiDroidApp.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQwNzoxMDoyMVrOHvhMrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOVQxNjozMTowN1rOHv2_-A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTU4OTAzOQ==", "bodyText": "There may be a better way to do this (check if Application is an instance of another class), this is the main line that worries me, as if this returns false, it means the process will be killed, and there may be other reasons that this happens", "url": "https://github.com/ankidroid/Anki-Android/pull/7631#discussion_r519589039", "createdAt": "2020-11-09T07:10:21Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AnkiDroidApp.java", "diffHunk": "@@ -190,6 +191,17 @@ public static InputStream getResourceAsStream(@NonNull String name) {\n     }\n \n \n+    public static boolean wasStartedAfterBackupRestoration() {\n+        return sInstance == null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d0a6da6dda18a9b2008fe3f13e46d146245e481"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTgyMTc3Mw==", "bodyText": "Seems like you could know for sure if it \"wasStartedAfterBackupRestoration\" if you implemented a BackupAgent a la https://stackoverflow.com/a/57244796/9910298 and stored the related state so you could query the BackupAgent implementation if onRestoreFinished has already been called.\nBut that is likely overkill, I think the assumption is valid now, but it is embedded in the name, perhaps you could change the method name to something that exposes the assumption in case calling code doesn't understand there is an assumption, like \"singletonInstanceInitialized\" with a comment that with current code if onCreate was called, it will always be true, so it can be used as a shorthand for that currently, and thus serves as a shorthand for a backup restoration test", "url": "https://github.com/ankidroid/Anki-Android/pull/7631#discussion_r519821773", "createdAt": "2020-11-09T13:41:16Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AnkiDroidApp.java", "diffHunk": "@@ -190,6 +191,17 @@ public static InputStream getResourceAsStream(@NonNull String name) {\n     }\n \n \n+    public static boolean wasStartedAfterBackupRestoration() {\n+        return sInstance == null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTU4OTAzOQ=="}, "originalCommit": {"oid": "7d0a6da6dda18a9b2008fe3f13e46d146245e481"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTkzNjExOQ==", "bodyText": "Renamed to isInitialized", "url": "https://github.com/ankidroid/Anki-Android/pull/7631#discussion_r519936119", "createdAt": "2020-11-09T16:17:29Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AnkiDroidApp.java", "diffHunk": "@@ -190,6 +191,17 @@ public static InputStream getResourceAsStream(@NonNull String name) {\n     }\n \n \n+    public static boolean wasStartedAfterBackupRestoration() {\n+        return sInstance == null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTU4OTAzOQ=="}, "originalCommit": {"oid": "7d0a6da6dda18a9b2008fe3f13e46d146245e481"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTk0NjIzMg==", "bodyText": "works for me!", "url": "https://github.com/ankidroid/Anki-Android/pull/7631#discussion_r519946232", "createdAt": "2020-11-09T16:31:07Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AnkiDroidApp.java", "diffHunk": "@@ -190,6 +191,17 @@ public static InputStream getResourceAsStream(@NonNull String name) {\n     }\n \n \n+    public static boolean wasStartedAfterBackupRestoration() {\n+        return sInstance == null;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTU4OTAzOQ=="}, "originalCommit": {"oid": "7d0a6da6dda18a9b2008fe3f13e46d146245e481"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 711, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}