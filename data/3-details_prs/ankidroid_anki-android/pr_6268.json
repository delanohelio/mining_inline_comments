{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyMzkwNjMz", "number": 6268, "title": "NF: Remove hook", "bodyText": "This was discussed on https://www.google.com/url?q=https://groups.google.com/d/msgid/anki-android/64e5bb2c-36b4-442f-858c-37fdb9d6f927%2540googlegroups.com?utm_medium%3Demail%26utm_source%3Dfooter&source=gmail&ust=1590400772169000&usg=AFQjCNGNtVL2zpgVkV3rcxQHprw2mZ50rQ\nI remove the hook package. I remove all \"Hook\" classes, and most classes which only contain a hook and a small function.\nThe reason to do so is:\n\ncode is simpler to follow. For example, when processing a card content, instead of looking for all occurrence of \"mungeQA\", I just need to follow the functions dealing with chess and LaTeX.\nCode is smaller\nCode is well typed, as there are no more Object, and ...\nIt will become far simpler to work differently for card content processing for browser and for reviewer. This will allow to easily show LaTeX (and chess notation ?) inside of browser, instead of deleting it as we currently do.\n\nI also moved the remaining classes (advanced stats and chess) to other package where it makes more sens.\nAs usual, the change is \"big\" (more than 500 lines) and my seem complex. To make the task easier, I split it into a lot of small commit. It should be easy to check that none of those commit change the behavior of AnkiDroid in any way; and so the full PR does not change the behavior either.", "createdAt": "2020-05-24T10:04:27Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6268", "merged": true, "mergeCommit": {"oid": "7d83fd251e059269fd5832fd6e30c4fba3a2c95d"}, "closed": true, "closedAt": "2020-06-02T23:01:40Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABckZT7cgBqjMzNjc4NDM1NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoqkyjgFqTQyNTc1NTMzMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7734a875235940a0c4368590d9bd535bfe162c4b", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7734a875235940a0c4368590d9bd535bfe162c4b", "committedDate": "2020-05-24T09:58:13Z", "message": "NF: remove class Leech"}, "afterCommit": {"oid": "b4925d0198115ba286ce1b5d6a597a941a44582a", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/b4925d0198115ba286ce1b5d6a597a941a44582a", "committedDate": "2020-05-24T10:27:54Z", "message": "NF: remove class Leech"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MzQ1MTk3", "url": "https://github.com/ankidroid/Anki-Android/pull/6268#pullrequestreview-417345197", "createdAt": "2020-05-24T10:23:48Z", "commit": {"oid": "7734a875235940a0c4368590d9bd535bfe162c4b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxMDoyMzo0OFrOGZuAsg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNFQxMDoyMzo0OFrOGZuAsg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTYyMTQyNg==", "bodyText": "Could you move this into AbstractSched if it's shared and not in libAnki", "url": "https://github.com/ankidroid/Anki-Android/pull/6268#discussion_r429621426", "createdAt": "2020-05-24T10:23:48Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/SchedV2.java", "diffHunk": "@@ -2701,4 +2702,25 @@ public void setReportLimit(int reportLimit) {\n     }\n \n     /** End #5666 */\n+\n+    protected static void leech(Card card, Activity activity) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7734a875235940a0c4368590d9bd535bfe162c4b"}, "originalPosition": 40}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b4925d0198115ba286ce1b5d6a597a941a44582a", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/b4925d0198115ba286ce1b5d6a597a941a44582a", "committedDate": "2020-05-24T10:27:54Z", "message": "NF: remove class Leech"}, "afterCommit": {"oid": "638571e95557bcf5874a64a1305961f89f6f4de2", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/638571e95557bcf5874a64a1305961f89f6f4de2", "committedDate": "2020-05-24T11:10:28Z", "message": "NF: remove class Leech"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "638571e95557bcf5874a64a1305961f89f6f4de2", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/638571e95557bcf5874a64a1305961f89f6f4de2", "committedDate": "2020-05-24T11:10:28Z", "message": "NF: remove class Leech"}, "afterCommit": {"oid": "f87739a2ece90cf0562323920c01a2e8d38e42dd", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f87739a2ece90cf0562323920c01a2e8d38e42dd", "committedDate": "2020-05-24T11:19:04Z", "message": "NF: remove class Leech"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3MzQ4OTY5", "url": "https://github.com/ankidroid/Anki-Android/pull/6268#pullrequestreview-417348969", "createdAt": "2020-05-24T11:19:53Z", "commit": {"oid": "f87739a2ece90cf0562323920c01a2e8d38e42dd"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f87739a2ece90cf0562323920c01a2e8d38e42dd", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f87739a2ece90cf0562323920c01a2e8d38e42dd", "committedDate": "2020-05-24T11:19:04Z", "message": "NF: remove class Leech"}, "afterCommit": {"oid": "1f60819bf58bc09a8de1274799e13391f7a5fe2b", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/1f60819bf58bc09a8de1274799e13391f7a5fe2b", "committedDate": "2020-05-24T15:46:03Z", "message": "NF: remove class Leech"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1f60819bf58bc09a8de1274799e13391f7a5fe2b", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/1f60819bf58bc09a8de1274799e13391f7a5fe2b", "committedDate": "2020-05-24T15:46:03Z", "message": "NF: remove class Leech"}, "afterCommit": {"oid": "648f20ff9ac4b064902b35b5671760a01c0d792b", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/648f20ff9ac4b064902b35b5671760a01c0d792b", "committedDate": "2020-05-24T15:51:31Z", "message": "NF: remove class Leech"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "75653a93f73853070c35e49c99c1d632f1f4b5b4", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/75653a93f73853070c35e49c99c1d632f1f4b5b4", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: Remove not used addHook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71cfe65507b700213cfbf0c8e826d9a137fc0e32", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/71cfe65507b700213cfbf0c8e826d9a137fc0e32", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove remHook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "05907a9496f29b6f497d0df5fa997e4015aff20b", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/05907a9496f29b6f497d0df5fa997e4015aff20b", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: runHook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebd3580893efc5c7b88ea5ea51284ccad0c505db", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/ebd3580893efc5c7b88ea5ea51284ccad0c505db", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove unused variable hooks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ee708254c6e59916d62729e9deab7d92b026c76b", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/ee708254c6e59916d62729e9deab7d92b026c76b", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove unused variable prefs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a633c6bb3790dd5a931aa5a12e16f51eee1e9ff", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/8a633c6bb3790dd5a931aa5a12e16f51eee1e9ff", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove unusev variable context"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "add136f561ecc8a9e00434cb97bdbf7ae527d6d0", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/add136f561ecc8a9e00434cb97bdbf7ae527d6d0", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove trivial constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29edf493de2e23f41b2e6ec503cb747571bf8fad", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/29edf493de2e23f41b2e6ec503cb747571bf8fad", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove unused method runHook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0915133dd6cf487b672f0d6caab176c908f852bf", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/0915133dd6cf487b672f0d6caab176c908f852bf", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: Remove etends Hook\n\nIt was not used as hook anymore"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7b5745a0f2fb4562acda50bc52f02d003cfb7e6f", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7b5745a0f2fb4562acda50bc52f02d003cfb7e6f", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove unused type Hook"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36a94a2ef673fcf322e9cbd309ba51d90c2be081", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/36a94a2ef673fcf322e9cbd309ba51d90c2be081", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove unused parameter context"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83fb689d2f81a84662e5cd933f63efd37b597c40", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/83fb689d2f81a84662e5cd933f63efd37b597c40", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove unused import to Hooks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c678dc1b254824f711cafe7293afa66ea5246a5", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/9c678dc1b254824f711cafe7293afa66ea5246a5", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: remove Hooks.getInstance"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ba5e045370d81dae924d8a3d5e81c92c8a23626", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/6ba5e045370d81dae924d8a3d5e81c92c8a23626", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: delete unused ExternalHookLoader"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a7f468c7d08eae9d9eaa62321c31e4dea515c83", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7a7f468c7d08eae9d9eaa62321c31e4dea515c83", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: delete unused HookPlugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f32c8f04caa15f025dbc43679f69f30a1cbe013", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/2f32c8f04caa15f025dbc43679f69f30a1cbe013", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: delete unused hooks"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "89c73b2a778753707e48977792ef61d6fbe9b79f", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/89c73b2a778753707e48977792ef61d6fbe9b79f", "committedDate": "2020-05-24T15:53:01Z", "message": "NF: remove wrong import\n\n(It will be corrected in the actual PR, when current PR are merged)"}, "afterCommit": {"oid": "2f32c8f04caa15f025dbc43679f69f30a1cbe013", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/2f32c8f04caa15f025dbc43679f69f30a1cbe013", "committedDate": "2020-06-02T20:52:46Z", "message": "NF: delete unused hooks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzMDUxODg5", "url": "https://github.com/ankidroid/Anki-Android/pull/6268#pullrequestreview-423051889", "createdAt": "2020-06-02T20:57:16Z", "commit": {"oid": "2f32c8f04caa15f025dbc43679f69f30a1cbe013"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMDo1NzoxNlrOGeDs8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQyMDo1NzoxNlrOGeDs8A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE3MTEyMA==", "bodyText": "Issue found: The utility class name 'ChessFilter' doesn't match '[A-Z][a-zA-Z0-9]+(Utils?|Helper|Constants)'", "url": "https://github.com/ankidroid/Anki-Android/pull/6268#discussion_r434171120", "createdAt": "2020-06-02T20:57:16Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/hooks/ChessFilter.java", "diffHunk": "@@ -28,7 +28,7 @@\n \n import timber.log.Timber;\n \n-public class ChessFilter extends Hook {\n+public class ChessFilter {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f32c8f04caa15f025dbc43679f69f30a1cbe013"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzMDU4MTQ2", "url": "https://github.com/ankidroid/Anki-Android/pull/6268#pullrequestreview-423058146", "createdAt": "2020-06-02T21:07:17Z", "commit": {"oid": "2f32c8f04caa15f025dbc43679f69f30a1cbe013"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI1NzU1MzMz", "url": "https://github.com/ankidroid/Anki-Android/pull/6268#pullrequestreview-425755333", "createdAt": "2020-06-06T17:19:14Z", "commit": {"oid": "2f32c8f04caa15f025dbc43679f69f30a1cbe013"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNlQxNzoxOToxNVrOGgEvYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNlQxNzoxOToxNVrOGgEvYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI4NTI4MA==", "bodyText": "Looks like forgot to remove?", "url": "https://github.com/ankidroid/Anki-Android/pull/6268#discussion_r436285280", "createdAt": "2020-06-06T17:19:15Z", "author": {"login": "Kubo2"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Storage.java", "diffHunk": "@@ -46,7 +45,6 @@ public static Collection Collection(Context context, String path) {\n     public static Collection Collection(Context context, String path, boolean server, boolean log) {\n         assert path.endsWith(\".anki2\");\n         // Since this is the entry point into libanki, initialize the hooks here.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f32c8f04caa15f025dbc43679f69f30a1cbe013"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3333, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}