{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwODI4NDM0", "number": 5952, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo1MjowN1rODv-m9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMzoyNjo1M1rODv_hAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjM1NDQ0OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo1MjowN1rOGCtv-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo1MjowN1rOGCtv-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ5OTg5OA==", "bodyText": "Issue found: The method 'filterUrl(String)' has an NPath complexity of 22176", "url": "https://github.com/ankidroid/Anki-Android/pull/5952#discussion_r405499898", "createdAt": "2020-04-08T12:52:07Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -3168,4 +2910,300 @@ public static int getSignalFromUrl(String url) {\n             return SIGNAL_UNHANDLED; //unknown, or not a signal.\n         }\n     }\n+\n+    protected class CardViewerWebClient extends WebViewClient {\n+        @Override\n+        @TargetApi(Build.VERSION_CODES.N)\n+        public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) {\n+            String url = request.getUrl().toString();\n+            Timber.i(\"Obtained URL from card: '%s'\", url);\n+            return filterUrl(url);\n+        }\n+\n+\n+        @Override\n+        @TargetApi(Build.VERSION_CODES.N)\n+        public WebResourceResponse shouldInterceptRequest(WebView view, WebResourceRequest request) {\n+            WebResourceResponse webResourceResponse = null;\n+            if (!AdaptionUtil.hasWebBrowser(getBaseContext())) {\n+                String scheme = request.getUrl().getScheme().trim();\n+                if (scheme.equalsIgnoreCase(\"http\") || scheme.equalsIgnoreCase(\"https\")) {\n+                    String response = getResources().getString(R.string.no_outgoing_link_in_cardbrowser);\n+                    webResourceResponse = new WebResourceResponse(\"text/html\", \"utf-8\", new ByteArrayInputStream(response.getBytes()));\n+                }\n+            }\n+            return webResourceResponse;\n+        }\n+\n+\n+        @Override\n+        @SuppressWarnings(\"deprecation\") // tracked as #5017 in github\n+        public boolean shouldOverrideUrlLoading(WebView view, String url) {\n+            return filterUrl(url);\n+        }\n+\n+\n+        // Filter any links using the custom \"playsound\" protocol defined in Sound.java.\n+        // We play sounds through these links when a user taps the sound icon.\n+        private boolean filterUrl(String url) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62225f4da802971884308ea4c101461737076701"}, "originalPosition": 306}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjM1NDUyOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/test/java/com/ichi2/anki/AbstractFlashcardViewerTest.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo1MjowOFrOGCtwBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMjo1MjowOFrOGCtwBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ5OTkwOQ==", "bodyText": "Issue found: JUnit tests should include assert() or fail()", "url": "https://github.com/ankidroid/Anki-Android/pull/5952#discussion_r405499909", "createdAt": "2020-04-08T12:52:08Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/test/java/com/ichi2/anki/AbstractFlashcardViewerTest.java", "diffHunk": "@@ -272,4 +285,40 @@ public void invalidEaseIsParsedFromSignal() {\n         String url = \"signal:answer_ease0\";\n         assertEquals(SIGNAL_NOOP, getSignalFromUrl(url));\n     }\n+\n+    @Test\n+    public void invalidEncodingDoesNotCrash() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "62225f4da802971884308ea4c101461737076701"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUxNjUwMzA3OnYy", "diffSide": "LEFT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMzoyNjo1M1rOGCvLmg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMzoyNjo1M1rOGCvLmg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUyMzM1NA==", "bodyText": "Yeah, maybe having a 250+ line sub-class inline isn't the best idea... ;-)", "url": "https://github.com/ankidroid/Anki-Android/pull/5952#discussion_r405523354", "createdAt": "2020-04-08T13:26:53Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -1494,265 +1494,7 @@ private WebView createWebView() {\n         webView.setScrollbarFadingEnabled(true);\n         Timber.d(\"Focusable = %s, Focusable in touch mode = %s\", webView.isFocusable(), webView.isFocusableInTouchMode());\n \n-        webView.setWebViewClient(new WebViewClient() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44f3f8b6b6a63ea8e19c5957ffa68296175fa368"}, "originalPosition": 4}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 527, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}