{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMzODkxNzIw", "number": 6447, "title": "CardViewer - Fix crash viewing card after close", "bodyText": "Purpose / Description\nloadDataWithBaseURL throws a NullPointerException if called after onDestroy\nhttps://stackoverflow.com/questions/28856883/java-nullpointer-exception-from-webview-in-android-webkit-webviewclassic-loaddat\nFixes\nFixes #6446\nApproach\nDetect if onDestroy() was called, and stop rendering if that happeend,\nHow Has This Been Tested?\nAPI 16 emulator (hit the Timber.w with no crashes) and Android 9 device.\nLearning\n\u26a0\ufe0f Please read: https://developer.android.com/reference/android/app/Activity#isDestroyed() - mentions \"final onDestroy\" - This goes against my knowledge of the lifecycle.\nChecklist\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-06-12T21:27:20Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6447", "merged": true, "mergeCommit": {"oid": "314eca81f7a5ecb0f3ec2643d0d01b8fe50047c6"}, "closed": true, "closedAt": "2020-06-13T04:29:19Z", "author": {"login": "david-allison-1"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqpvsNAFqTQzMDA0NzQ4OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcqp0rigBqjM0NDAwMDYzODk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDQ3NDg4", "url": "https://github.com/ankidroid/Anki-Android/pull/6447#pullrequestreview-430047488", "createdAt": "2020-06-12T21:29:05Z", "commit": {"oid": "c6eb0a5b8833afa09090f865da91d37e449ac4c8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMToyOTowNlrOGjSF2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMlQyMToyOTowNlrOGjSF2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTY0OTc1NQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            Timber.w(\"Now loading card - Activity is in the process of being destroyed.\");\n          \n          \n            \n                            Timber.w(\"Not loading card - Activity is in the process of being destroyed.\");", "url": "https://github.com/ankidroid/Anki-Android/pull/6447#discussion_r439649755", "createdAt": "2020-06-12T21:29:06Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -2603,6 +2603,17 @@ public MyWebView(Context context) {\n             super(context);\n         }\n \n+\n+        @Override\n+        public void loadDataWithBaseURL(@Nullable String baseUrl, String data, @Nullable String mimeType, @Nullable String encoding, @Nullable String historyUrl) {\n+            if (!AbstractFlashcardViewer.this.wasDestroyed()) {\n+                super.loadDataWithBaseURL(baseUrl, data, mimeType, encoding, historyUrl);\n+            } else {\n+                Timber.w(\"Now loading card - Activity is in the process of being destroyed.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c6eb0a5b8833afa09090f865da91d37e449ac4c8"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMDQ3OTY1", "url": "https://github.com/ankidroid/Anki-Android/pull/6447#pullrequestreview-430047965", "createdAt": "2020-06-12T21:30:09Z", "commit": {"oid": "c6eb0a5b8833afa09090f865da91d37e449ac4c8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76e9b741642c7eb29e1d597322e6a053f6634ff3", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/76e9b741642c7eb29e1d597322e6a053f6634ff3", "committedDate": "2020-06-12T21:33:59Z", "message": "CardViewer - Fix crash viewing card after close\n\nloadDataWithBaseURL throws a NullPointerException if called\nafter onDestroy\n\nhttps://stackoverflow.com/questions/28856883/java-nullpointer-exception-from-webview-in-android-webkit-webviewclassic-loaddat\n\nFixes 6446"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c6eb0a5b8833afa09090f865da91d37e449ac4c8", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/c6eb0a5b8833afa09090f865da91d37e449ac4c8", "committedDate": "2020-06-12T21:23:44Z", "message": "CardViewer - Fix crash viewing card after close\n\nloadDataWithBaseURL throws a NullPointerException if called\nafter onDestroy\n\nhttps://stackoverflow.com/questions/28856883/java-nullpointer-exception-from-webview-in-android-webkit-webviewclassic-loaddat\n\nFixes 6446"}, "afterCommit": {"oid": "76e9b741642c7eb29e1d597322e6a053f6634ff3", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/76e9b741642c7eb29e1d597322e6a053f6634ff3", "committedDate": "2020-06-12T21:33:59Z", "message": "CardViewer - Fix crash viewing card after close\n\nloadDataWithBaseURL throws a NullPointerException if called\nafter onDestroy\n\nhttps://stackoverflow.com/questions/28856883/java-nullpointer-exception-from-webview-in-android-webkit-webviewclassic-loaddat\n\nFixes 6446"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3189, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}