{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzOTg2MDg4", "number": 7600, "title": "NF: calls ids2String without useless conversions", "bodyText": "Those values without conversion are already usable as-is", "createdAt": "2020-11-02T11:15:30Z", "url": "https://github.com/ankidroid/Anki-Android/pull/7600", "merged": true, "mergeCommit": {"oid": "fe2bc6aeb1af48a2a7cd8f8633368d36c429b5d1"}, "closed": true, "closedAt": "2020-11-08T19:48:42Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYjAQ5gFqTUyMTU1MjI5NA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdaCp4GgBqjM5Njk1MDc2NTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNTUyMjk0", "url": "https://github.com/ankidroid/Anki-Android/pull/7600#pullrequestreview-521552294", "createdAt": "2020-11-02T11:36:41Z", "commit": {"oid": "5a9f798b5faa4e8f1a2f7931821f8338984de6bb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMTozNjo0MVrOHsA2Yw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxMTozODowN1rOHsA42A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTkxMzMxNQ==", "bodyText": "What's the extra comma for?", "url": "https://github.com/ankidroid/Anki-Android/pull/7600#discussion_r515913315", "createdAt": "2020-11-02T11:36:41Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java", "diffHunk": "@@ -2609,14 +2609,9 @@ public void confirmDeckDeletion(long did) {\n             return;\n         }\n         // Get the number of cards contained in this deck and its subdecks\n-        TreeMap<String, Long> children = getCol().getDecks().children(did);\n-        long[] dids = new long[children.size() + 1];\n-        dids[0] = did;\n-        int i = 1;\n-        for (Long l : children.values()) {\n-            dids[i++] = l;\n-        }\n-        String ids = Utils.ids2str(dids);\n+        java.util.Collection<Long> children = getCol().getDecks().children(did).values();\n+        children.add(did);\n+        String ids = Utils.ids2str(children)+ \",\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a9f798b5faa4e8f1a2f7931821f8338984de6bb"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTkxMzgxMQ==", "bodyText": "You can't use array.toString()", "url": "https://github.com/ankidroid/Anki-Android/pull/7600#discussion_r515913811", "createdAt": "2020-11-02T11:37:48Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -2042,7 +2042,7 @@ private void _closeLog() {\n      */\n     public void setUserFlag(int flag, long[] cids)  {\n         assert (0<= flag && flag <= 7);\n-        mDb.execute(\"update cards set flags = (flags & ~?) | ?, usn=?, mod=? where id in \" + Utils.ids2str(cids),\n+        mDb.execute(\"update cards set flags = (flags & ~?) | ?, usn=?, mod=? where id in \" + cids,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a9f798b5faa4e8f1a2f7931821f8338984de6bb"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTkxMzk0NA==", "bodyText": "Ditto - and this needs regression coverage, as the breakage wasn't caught.", "url": "https://github.com/ankidroid/Anki-Android/pull/7600#discussion_r515913944", "createdAt": "2020-11-02T11:38:07Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -2193,7 +2193,7 @@ public Context getContext() {\n     /** Not in libAnki */\n     @CheckResult\n     public List<Long> filterToValidCards(long[] cards) {\n-        return getDb().queryLongList(\"select id from cards where id in \" + Utils.ids2str(cards));\n+        return getDb().queryLongList(\"select id from cards where id in \" + cards);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5a9f798b5faa4e8f1a2f7931821f8338984de6bb"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5a9f798b5faa4e8f1a2f7931821f8338984de6bb", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5a9f798b5faa4e8f1a2f7931821f8338984de6bb", "committedDate": "2020-11-02T11:14:45Z", "message": "NF: calls ids2String without useless conversions\n\nThose values without conversion are already usable as-is"}, "afterCommit": {"oid": "3dc1e3cb9ab0028e4081f6332b3fae79bb858973", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/3dc1e3cb9ab0028e4081f6332b3fae79bb858973", "committedDate": "2020-11-02T11:43:25Z", "message": "NF: calls ids2String without useless conversions\n\nThose values without conversion are already usable as-is"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3dc1e3cb9ab0028e4081f6332b3fae79bb858973", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/3dc1e3cb9ab0028e4081f6332b3fae79bb858973", "committedDate": "2020-11-02T11:43:25Z", "message": "NF: calls ids2String without useless conversions\n\nThose values without conversion are already usable as-is"}, "afterCommit": {"oid": "5704d1be3e9d3859f1bbc3ebf08d07ef231b5414", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5704d1be3e9d3859f1bbc3ebf08d07ef231b5414", "committedDate": "2020-11-02T11:45:04Z", "message": "NF: calls ids2String without useless conversions\n\nThose values without conversion are already usable as-is"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6feebb1126e413754544e80d35c0991bd8abcc9b", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/6feebb1126e413754544e80d35c0991bd8abcc9b", "committedDate": "2020-11-02T11:50:46Z", "message": "NF: regression test filterToValidCards"}, "afterCommit": {"oid": "60d7d670de0d05e22bf7b42aa9312f8cd4258bca", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/60d7d670de0d05e22bf7b42aa9312f8cd4258bca", "committedDate": "2020-11-02T12:34:22Z", "message": "NF: regression test filterToValidCards"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "60d7d670de0d05e22bf7b42aa9312f8cd4258bca", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/60d7d670de0d05e22bf7b42aa9312f8cd4258bca", "committedDate": "2020-11-02T12:34:22Z", "message": "NF: regression test filterToValidCards"}, "afterCommit": {"oid": "a2752e4728a77e460f0f9e4b2f396dfd2af79fa6", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/a2752e4728a77e460f0f9e4b2f396dfd2af79fa6", "committedDate": "2020-11-02T13:14:15Z", "message": "NF: regression test filterToValidCards"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxOTUyMjY2", "url": "https://github.com/ankidroid/Anki-Android/pull/7600#pullrequestreview-521952266", "createdAt": "2020-11-02T20:00:48Z", "commit": {"oid": "a2752e4728a77e460f0f9e4b2f396dfd2af79fa6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b41a07dd52c5d78ee083faeabe55949c7d1f7953", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/b41a07dd52c5d78ee083faeabe55949c7d1f7953", "committedDate": "2020-11-07T03:04:40Z", "message": "NF: calls ids2String without useless conversions\n\nThose values without conversion are already usable as-is"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ab25ad059b86c4ca111ec44450b7c250f04c4c4", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5ab25ad059b86c4ca111ec44450b7c250f04c4c4", "committedDate": "2020-11-07T03:04:40Z", "message": "NF: regression test filterToValidCards"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a2752e4728a77e460f0f9e4b2f396dfd2af79fa6", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/a2752e4728a77e460f0f9e4b2f396dfd2af79fa6", "committedDate": "2020-11-02T13:14:15Z", "message": "NF: regression test filterToValidCards"}, "afterCommit": {"oid": "5ab25ad059b86c4ca111ec44450b7c250f04c4c4", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5ab25ad059b86c4ca111ec44450b7c250f04c4c4", "committedDate": "2020-11-07T03:04:40Z", "message": "NF: regression test filterToValidCards"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3814, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}