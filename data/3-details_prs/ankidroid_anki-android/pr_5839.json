{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkxMjIxNTE4", "number": 5839, "title": "Fix #5253 - Deck Options Corruption on Export", "bodyText": "Purpose / Description\nUser complaint that exporting a deck reset the deck options to 1.\nThis also appears to have been the cause of a dynamic deck having options, and therefore being corrupted.\nFixes\nFixes #5253\nFixes #5708\nFixes #5202\nApproach\nWe fix this via an inefficient deep clone.\nHow Has This Been Tested?\n\nNew Collection - created on 2.10alpha46\nCreate New Deck\nCreate new options group and assign to new deck\nFails - new deck's option group is set to default\nLoad 2.10alpha51\nExport\nPasses - deck is still the same\n\nAlso tested with default deck and a custom study deck, both were corrupt (database errors on study).\nLearning (optional, can help others)\nstackOverflow: How do I clone an org.json.JSONObject in Java?\nChecklist\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-03-19T20:27:46Z", "url": "https://github.com/ankidroid/Anki-Android/pull/5839", "merged": true, "mergeCommit": {"oid": "fbb115f372867c0867d9dd81b2bd1bd2f55528f9"}, "closed": true, "closedAt": "2020-03-19T22:14:39Z", "author": {"login": "david-allison-1"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcPR4BBgH2gAyMzkxMjIxNTE4OmEyNmQ3MWZlZTYzMjAxMTg4ZmM5M2ZlOTVhMDM3ZTAxZWJkM2I1OGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPSjmFgFqTM3ODA5NzAzNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a26d71fee63201188fc93fe95a037e01ebd3b58a", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/a26d71fee63201188fc93fe95a037e01ebd3b58a", "committedDate": "2020-03-19T20:24:31Z", "message": "Fix #5253 - Deck Options Corruption on Export\n\nUser complaint that exporting a deck reset the deck options to 1.\n\nThis also appears to have been the cause of a dynamic deck having\noptions, and therefore being corrupted. #5708\n\nWe fix this via an inefficient deep clone."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MDc3MjAz", "url": "https://github.com/ankidroid/Anki-Android/pull/5839#pullrequestreview-378077203", "createdAt": "2020-03-19T20:40:39Z", "commit": {"oid": "a26d71fee63201188fc93fe95a037e01ebd3b58a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQyMDo0MDozOVrOF4_oIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQyMDo0MDozOVrOF4_oIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTMwNzA0MQ==", "bodyText": "Issue found: Avoid unnecessary constructors - the compiler will generate these for you", "url": "https://github.com/ankidroid/Anki-Android/pull/5839#discussion_r395307041", "createdAt": "2020-03-19T20:40:39Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/AnkiPackageExporter.java", "diffHunk": "@@ -313,6 +315,17 @@ public void setIncludeMedia(boolean includeMedia) {\n     public void setDid(Long did) {\n         mDid = did;\n     }\n+\n+    private static class JSONObjectUtils {\n+        private JSONObjectUtils() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a26d71fee63201188fc93fe95a037e01ebd3b58a"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc4MDk3MDM1", "url": "https://github.com/ankidroid/Anki-Android/pull/5839#pullrequestreview-378097035", "createdAt": "2020-03-19T21:12:07Z", "commit": {"oid": "a26d71fee63201188fc93fe95a037e01ebd3b58a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3530, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}