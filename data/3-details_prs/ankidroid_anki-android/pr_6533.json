{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NjMxNTkw", "number": 6533, "title": "Nested decks support in ContentProviderTest", "bodyText": "Pull Request template\nPurpose / Description\nAdding nested decks to test. Seems especially useful since it seems they failed and required some change\nFixes\nThey seemed to be requested in\n#6526 (review)\nApproach\nFirst: adding a nested deck. Running test. Seeing test fails, and correcting them in a way which makes sens\nHow Has This Been Tested?\nRunning test.\nLearning (optional, can help others)\nI don't need to understand all matrix and all to run tests\nChecklist\nPlease, go through these checks before submitting the PR.\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-06-22T01:19:20Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6533", "merged": true, "mergeCommit": {"oid": "736dc9f9cf7797c690ae6114711e07260364e344"}, "closed": true, "closedAt": "2020-06-22T16:35:34Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABctl-sBAH2gAyNDM3NjMxNTkwOjE4ZDcwYjBiN2YzZmQwMzBmZGJkMWU5OTdiMThmMTBjNGZhY2JmMDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABctzicJgFqTQzNTA5NDMwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "18d70b0b7f3fd030fdbd1e997b18f10c4facbf02", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/18d70b0b7f3fd030fdbd1e997b18f10c4facbf02", "committedDate": "2020-06-22T00:47:38Z", "message": "NF: moving comma at end of line"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b415e749c7267f83d24ad08b19ada20e9067073a", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/b415e749c7267f83d24ad08b19ada20e9067073a", "committedDate": "2020-06-22T01:16:58Z", "message": "ContentProviderTest adding nested deck"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cb9f538423e7eb9dabcac781c6c05c070bd6378", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/1cb9f538423e7eb9dabcac781c6c05c070bd6378", "committedDate": "2020-06-22T01:56:53Z", "message": "mTestDeckIds is an array list\n\nThis is required because, with nested decks, the total number of deck\nmay be gerater than the number of deck in the array"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b00fcd3728e005c50e747fb3605ee23007986458", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/b00fcd3728e005c50e747fb3605ee23007986458", "committedDate": "2020-06-22T01:16:59Z", "message": "ContentProviderTest delete children deck too during cleaning\n\nOtherwise, finding the deck with id did seems to create back its\nparent decks"}, "afterCommit": {"oid": "67c597d8c942fd488b2b226459dff62cee4154c8", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/67c597d8c942fd488b2b226459dff62cee4154c8", "committedDate": "2020-06-22T01:57:46Z", "message": "ContentProviderTest delete children deck too during cleaning\n\nOtherwise, finding the deck with id did seems to create back its\nparent decks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NTczOTEx", "url": "https://github.com/ankidroid/Anki-Android/pull/6533#pullrequestreview-434573911", "createdAt": "2020-06-22T02:49:32Z", "commit": {"oid": "67c597d8c942fd488b2b226459dff62cee4154c8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMjo0OTozMlrOGmwgbA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yMlQwMjo0OTozMlrOGmwgbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzI5MzgwNA==", "bodyText": "Why is this necessary? Shouldn't id() call _ensureParents? Is this because decks are created, but not added to the list?", "url": "https://github.com/ankidroid/Anki-Android/pull/6533#discussion_r443293804", "createdAt": "2020-06-22T02:49:32Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/androidTest/java/com/ichi2/anki/tests/ContentProviderTest.java", "diffHunk": "@@ -118,9 +125,21 @@ public void setUp() throws Exception {\n         // create test decks and add one note for every deck\n         mNumDecksBeforeTest = col.getDecks().count();\n         for(int i = 0; i < TEST_DECKS.length; i++) {\n-            long did = col.getDecks().id(TEST_DECKS[i]);\n-            mTestDeckIds[i] = did;\n-            mCreatedNotes.add(setupNewNote(col, mModelId, did, mDummyFields, TEST_TAG));\n+            String fullName = TEST_DECKS[i];\n+            String[] path = col.getDecks().path(fullName);\n+            String partialName = \"\";\n+            // Dealing with each parents of fullName\n+            for (int j = 0; j < path.length; j++) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "67c597d8c942fd488b2b226459dff62cee4154c8"}, "originalPosition": 42}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edbd61c51b6ae0ca8ce6c6eae4718b06e869322e", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/edbd61c51b6ae0ca8ce6c6eae4718b06e869322e", "committedDate": "2020-06-22T09:25:40Z", "message": "ContentProviderTest: add parents decks to mTestDeckIds"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebf7e31b4c24c44b227655f9d96003d208e374f8", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/ebf7e31b4c24c44b227655f9d96003d208e374f8", "committedDate": "2020-06-22T09:25:40Z", "message": "ContentProviderTest delete children deck too during cleaning\n\nOtherwise, finding the deck with id did seems to create back its\nparent decks"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "67c597d8c942fd488b2b226459dff62cee4154c8", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/67c597d8c942fd488b2b226459dff62cee4154c8", "committedDate": "2020-06-22T01:57:46Z", "message": "ContentProviderTest delete children deck too during cleaning\n\nOtherwise, finding the deck with id did seems to create back its\nparent decks"}, "afterCommit": {"oid": "ebf7e31b4c24c44b227655f9d96003d208e374f8", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/ebf7e31b4c24c44b227655f9d96003d208e374f8", "committedDate": "2020-06-22T09:25:40Z", "message": "ContentProviderTest delete children deck too during cleaning\n\nOtherwise, finding the deck with id did seems to create back its\nparent decks"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0ODI0OTA0", "url": "https://github.com/ankidroid/Anki-Android/pull/6533#pullrequestreview-434824904", "createdAt": "2020-06-22T11:12:26Z", "commit": {"oid": "ebf7e31b4c24c44b227655f9d96003d208e374f8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MDk0MzA2", "url": "https://github.com/ankidroid/Anki-Android/pull/6533#pullrequestreview-435094306", "createdAt": "2020-06-22T16:35:27Z", "commit": {"oid": "ebf7e31b4c24c44b227655f9d96003d208e374f8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3132, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}