{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAzOTg0NjMz", "number": 6020, "title": "Collection filename / getCol refactor", "bodyText": "Sometime, the file name is given explicitly instead of using a constant. This is corrected in the first commit.\nSecond commit factorize a code part which appears 13 times identically in all the code.", "createdAt": "2020-04-15T20:55:40Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6020", "merged": true, "mergeCommit": {"oid": "fb2425ba15a17f6c962f632a4d11c32d094f0281"}, "closed": true, "closedAt": "2020-04-16T02:15:28Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcX94hOgH2gAyNDAzOTg0NjMzOjkxNzJhY2E4YjhiYzFiNTVlMDU1OGMwMGVjY2UzYTYyNjQxMGE0NmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcX_n9EAFqTM5NDE3MjQ1Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9172aca8b8bc1b55e0558c00ecce3a626410a46e", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/9172aca8b8bc1b55e0558c00ecce3a626410a46e", "committedDate": "2020-04-15T20:12:17Z", "message": "Uses COLLECTION_FILENAME instead of string constant"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0c7566a7ac5039185558a888b73f593d78b7990", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/a0c7566a7ac5039185558a888b73f593d78b7990", "committedDate": "2020-04-15T20:48:01Z", "message": "getCol in ContentProviderTest (factorizing code)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c4b62488bbda45b28f8e5c36a57b598b140b384e", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/c4b62488bbda45b28f8e5c36a57b598b140b384e", "committedDate": "2020-04-15T20:50:34Z", "message": "setTest in Collection Helper\n\nThis will ensure that tests are executed in a separate directory. So\nthis won't need a full sync. And more important, it ensures that\neverything is quick since everything runs on an empty collection. This\nis the difference between 2 minutes of tests and 20 minutes !"}, "afterCommit": {"oid": "02bde3959ea01444ed611300da80c41bdda50cf1", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/02bde3959ea01444ed611300da80c41bdda50cf1", "committedDate": "2020-04-15T21:00:42Z", "message": "setTest in Collection Helper\n\nThis will ensure that tests are executed in a separate directory. So\nthis won't need a full sync. And more important, it ensures that\neverything is quick since everything runs on an empty collection. This\nis the difference between 2 minutes of tests and 20 minutes !"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MTM2MTUw", "url": "https://github.com/ankidroid/Anki-Android/pull/6020#pullrequestreview-394136150", "createdAt": "2020-04-15T21:08:02Z", "commit": {"oid": "c4b62488bbda45b28f8e5c36a57b598b140b384e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQyMTowODozNFrOGGLnaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNVQyMTowODozNFrOGGLnaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTEzNDk1NQ==", "bodyText": "I love the idea.\nI have also struggled with running the connected tests against my main collection on my main real device for fear of polluting my collection. That's a strong enough argument for something like this, but the performance consideration is important as well of course.\nI do not want test code in the 'main' tree if possible though and I've gone to some lengths to avoid it in my own testing. There is almost always a way to have the \"main\" tree be \"clean\" (but maybe more flexible, so you can inject test settings) without having actual test-related code in here.\nIn this instance, perhaps you could sub-class CollectionHelper as TestCollectionHelper in the \"test\" class hierarchy and override the method, then use the TestCollectionHelper to do the same - this is a common and easy pattern", "url": "https://github.com/ankidroid/Anki-Android/pull/6020#discussion_r409134955", "createdAt": "2020-04-15T21:08:34Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/CollectionHelper.java", "diffHunk": "@@ -116,6 +119,10 @@ public synchronized Collection getCol(Context context) {\n         return mCollection;\n     }\n \n+    public void setTest() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "02bde3959ea01444ed611300da80c41bdda50cf1"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "02bde3959ea01444ed611300da80c41bdda50cf1", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/02bde3959ea01444ed611300da80c41bdda50cf1", "committedDate": "2020-04-15T21:00:42Z", "message": "setTest in Collection Helper\n\nThis will ensure that tests are executed in a separate directory. So\nthis won't need a full sync. And more important, it ensures that\neverything is quick since everything runs on an empty collection. This\nis the difference between 2 minutes of tests and 20 minutes !"}, "afterCommit": {"oid": "6d2cf697f64ba3537627333a124284396cf260d3", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/6d2cf697f64ba3537627333a124284396cf260d3", "committedDate": "2020-04-15T21:39:09Z", "message": "setTest in Collection Helper\n\nThis will ensure that tests are executed in a separate directory. So\nthis won't need a full sync. And more important, it ensures that\neverything is quick since everything runs on an empty collection. This\nis the difference between 2 minutes of tests and 20 minutes !"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6d2cf697f64ba3537627333a124284396cf260d3", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/6d2cf697f64ba3537627333a124284396cf260d3", "committedDate": "2020-04-15T21:39:09Z", "message": "setTest in Collection Helper\n\nThis will ensure that tests are executed in a separate directory. So\nthis won't need a full sync. And more important, it ensures that\neverything is quick since everything runs on an empty collection. This\nis the difference between 2 minutes of tests and 20 minutes !"}, "afterCommit": {"oid": "a0c7566a7ac5039185558a888b73f593d78b7990", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/a0c7566a7ac5039185558a888b73f593d78b7990", "committedDate": "2020-04-15T20:48:01Z", "message": "getCol in ContentProviderTest (factorizing code)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk0MTcyNDUy", "url": "https://github.com/ankidroid/Anki-Android/pull/6020#pullrequestreview-394172452", "createdAt": "2020-04-15T22:14:00Z", "commit": {"oid": "a0c7566a7ac5039185558a888b73f593d78b7990"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3401, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}