{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2ODI1NjEw", "number": 6502, "title": "Automated deck renaming", "bodyText": "Anki is changing the way it deals with deck name in case of trouble.\n\n\"\" is replaced by \"blank\"\n\"::::\" is replaced by \"::blank::\"\nduplicate name just replace a name n by n+ (actually, it now allows to rename deck to give it the name of an already existing deck. It seems quite strange and probably an accident, so I won't port this feature yet)\n\nI made the first two changes before looking for duplicate name, otherwise it would make little sens.\nTested:\n\nDeck with \"::::::\"\ndeck \"\"\n\nI didn't test duplicate name, mostly because there is no easy way to create duplicate name in ankidroid", "createdAt": "2020-06-19T00:29:06Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6502", "merged": true, "mergeCommit": {"oid": "5d54b6fe63f3286cba517ebd8685e14b286742a5"}, "closed": true, "closedAt": "2020-06-19T17:50:42Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsntRnAH2gAyNDM2ODI1NjEwOmRjMDMwNjJhZmUyMzk3MWQ0NGEyOTUyMjBkMWRhMTRiNmUxYjQzN2Y=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsoxSJgFqTQzMzc0NjU5Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dc03062afe23971d44a295220d1da14b6e1b437f", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/dc03062afe23971d44a295220d1da14b6e1b437f", "committedDate": "2020-06-19T00:14:30Z", "message": "In case of duplicate deck name, add \"+\"\n\nThis is the new behaviour in anki"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3156b67c71cf76e52c2351b8b03851a0f76141ce", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/3156b67c71cf76e52c2351b8b03851a0f76141ce", "committedDate": "2020-06-19T00:16:32Z", "message": "Change :: before looking for duplicate deck name"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af55f5e398bf37985523655650e949ead740b027", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/af55f5e398bf37985523655650e949ead740b027", "committedDate": "2020-06-19T00:19:27Z", "message": "Replace \"::::\" by \"blank\" in deck name\n\nthis is consistent with current behaviour"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "882517d66226407a4a6d87cc38a1208ff9e2ed58", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/882517d66226407a4a6d87cc38a1208ff9e2ed58", "committedDate": "2020-06-19T00:22:00Z", "message": "Empty deck name is replaced by \"blank\"\n\nTo be consistent with upstream"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNzQ1NDEw", "url": "https://github.com/ankidroid/Anki-Android/pull/6502#pullrequestreview-433745410", "createdAt": "2020-06-19T01:24:43Z", "commit": {"oid": "af55f5e398bf37985523655650e949ead740b027"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwMToyNDo0M1rOGmFHTg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xOVQwMToyNDo0M1rOGmFHTg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjU4Mjg2Mg==", "bodyText": "Please note this is not a request for change. I think this is kind of C-like code though, and it's more expressive to use String.contains(otherString) when that's what you are really asking. I checked and in real scenarios comparing two Strings the performance is the same. Not worth changing at all - it's a weak opinion in an area we have no standard on, just a language nerd note.", "url": "https://github.com/ankidroid/Anki-Android/pull/6502#discussion_r442582862", "createdAt": "2020-06-19T01:24:43Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Decks.java", "diffHunk": "@@ -792,7 +792,10 @@ private void _checkDeckTree() {\n             // ensure no sections are blank\n             if (deck.getString(\"name\").indexOf(\"::::\") != -1) {\n                 Timber.i(\"fix deck with missing sections %s\", deck.getString(\"name\"));\n-                deck.put(\"name\", \"recovered\"+Utils.intTime(1000));\n+                do {\n+                    deck.put(\"name\", deck.getString(\"name\").replace(\"::::\", \"::blank::\"));\n+                    // We may need to iterate, in order to replace \"::::::\" and adding to \"blank\" in it.\n+                } while (deck.getString(\"name\").indexOf(\"::::\") != -1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "af55f5e398bf37985523655650e949ead740b027"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMzNzQ2NTk3", "url": "https://github.com/ankidroid/Anki-Android/pull/6502#pullrequestreview-433746597", "createdAt": "2020-06-19T01:28:47Z", "commit": {"oid": "882517d66226407a4a6d87cc38a1208ff9e2ed58"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3234, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}