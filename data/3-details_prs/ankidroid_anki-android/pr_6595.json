{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyMzQyMzU0", "number": 6595, "title": "Disallow invalid (null || only whitespace) deck names", "bodyText": "Pull Request template\nPurpose / Description\nFor some reason we used to allow almost anything as a deck name. Even nulls (!?)\nUpstream seems to silently disallow empty decknames, and I think we can reasonably go further and say deck names that don't have at least one non-whitespace character are nonsense\nFixes\nFixes #6590\nApproach\nCreate a quick valid deck name method, use it everywhere that Decks.id or Decks.rename is called to pre-validate\nToast with a new invalid deck name message if it's invalid\nHow Has This Been Tested?\nemulator, create a blank-named deck, rename a deck to blank name, create a filtered deck and try an empty name\nCan't do any of those now\nLearning (optional, can help others)\nString.trim().isEmpty() (once you have null-checked) is efficient and \"good enough\" for non-whitespace checking. You can do a regex on \\\\w+ or similar, and maybe there are UTF-16 or HTML people can get through but that's okay I think. This will stop the majority of silly deck names and if people go to that trouble, they really mean it, let them have an empty-looking name.\nChecklist\nPlease, go through these checks before submitting the PR.\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-06-30T23:05:27Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6595", "merged": true, "mergeCommit": {"oid": "f908a1ead3050976d74b2cff1271bac93829002e"}, "closed": true, "closedAt": "2020-07-01T01:54:00Z", "author": {"login": "mikehardy"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwd9zcAFqTQ0MDQ0NTQwMA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcweXCrAFqTQ0MDQ1NTIxNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNDQ1NDAw", "url": "https://github.com/ankidroid/Anki-Android/pull/6595#pullrequestreview-440445400", "createdAt": "2020-06-30T23:09:12Z", "commit": {"oid": "b258038597ae330175f4d4a51aa6820537a25aaa"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMzowOToxMlrOGrReIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0zMFQyMzowOToxMlrOGrReIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAyODE5Mw==", "bodyText": "list the name (in quotes)", "url": "https://github.com/ankidroid/Anki-Android/pull/6595#discussion_r448028193", "createdAt": "2020-06-30T23:09:12Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java", "diffHunk": "@@ -653,6 +659,11 @@ public boolean onOptionsItemSelected(MenuItem item) {\n                         .negativeText(res.getString(R.string.dialog_cancel))\n                         .onPositive((dialog, which) -> {\n                             String filteredDeckName = mDialogEditText.getText().toString();\n+                            if (!Decks.isValidDeckName(filteredDeckName)) {\n+                                Timber.d(\"Not creating deck with invalid name\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b258038597ae330175f4d4a51aa6820537a25aaa"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNDQ1OTQ5", "url": "https://github.com/ankidroid/Anki-Android/pull/6595#pullrequestreview-440445949", "createdAt": "2020-06-30T23:10:41Z", "commit": {"oid": "b258038597ae330175f4d4a51aa6820537a25aaa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7e789f96d805159ec14f3a93476682623c5b4706", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7e789f96d805159ec14f3a93476682623c5b4706", "committedDate": "2020-06-30T23:29:20Z", "message": "Disallow invalid (null || only whitespace) deck names\n\nFixes #6590"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b258038597ae330175f4d4a51aa6820537a25aaa", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/b258038597ae330175f4d4a51aa6820537a25aaa", "committedDate": "2020-06-30T23:00:33Z", "message": "Disallow invalid (null || only whitespace) deck names\n\nFixes #6590"}, "afterCommit": {"oid": "7e789f96d805159ec14f3a93476682623c5b4706", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7e789f96d805159ec14f3a93476682623c5b4706", "committedDate": "2020-06-30T23:29:20Z", "message": "Disallow invalid (null || only whitespace) deck names\n\nFixes #6590"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQwNDU1MjE2", "url": "https://github.com/ankidroid/Anki-Android/pull/6595#pullrequestreview-440455216", "createdAt": "2020-06-30T23:36:46Z", "commit": {"oid": "7e789f96d805159ec14f3a93476682623c5b4706"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3049, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}