{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyMDYzNTIz", "number": 7267, "title": "Ensure closing transaction won't crash", "bodyText": "Fixes\nFixes #7265\nApproach\nCall inTransaction and use a try...catch\nHow Has This Been Tested?\nOnly unit tests\nChecklist\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-09-23T22:01:20Z", "url": "https://github.com/ankidroid/Anki-Android/pull/7267", "merged": true, "mergeCommit": {"oid": "c84a8cd5c0629da7d73a4e52a64c7a1713dfcef4"}, "closed": true, "closedAt": "2020-09-24T05:19:56Z", "author": {"login": "david-allison-1"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdLzA5AAH2gAyNDkyMDYzNTIzOmI5MmY4MTgzNGQ4NGE2M2UxMTI4YjQ1N2NiNzY3M2M0NGRkOTVjNmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdL0JHEgFqTQ5NTA4NjMzMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b92f81834d84a63e1128b457cb7673c44dd95c6b", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/b92f81834d84a63e1128b457cb7673c44dd95c6b", "committedDate": "2020-09-23T20:56:32Z", "message": "Converted void methods to executeInTransaction\n\nThis ensures that the endTransaction behaviour is correct\n\nFixes some of 7265"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9afb959e1d14a34a53b28326d9677f9395413bd", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/a9afb959e1d14a34a53b28326d9677f9395413bd", "committedDate": "2020-09-23T21:01:02Z", "message": "Added DB.safeEndInTransaction\n\nTo ensure that the actual error message in a failure is observed\n\nFixes 7265"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MDg2MDM3", "url": "https://github.com/ankidroid/Anki-Android/pull/7267#pullrequestreview-495086037", "createdAt": "2020-09-23T22:14:47Z", "commit": {"oid": "b92f81834d84a63e1128b457cb7673c44dd95c6b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMjoxNDo0OFrOHXC02w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yM1QyMjoxNDo0OFrOHXC02w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzkyNTU5NQ==", "bodyText": "Hmm - I think it's just because it can never throw? shouldn't matter?", "url": "https://github.com/ankidroid/Anki-Android/pull/7267#discussion_r493925595", "createdAt": "2020-09-23T22:14:48Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/DB.java", "diffHunk": "@@ -391,4 +385,34 @@ public void executeManyNoTransaction(String sql, List<Object[]> list) {\n     public String getPath() {\n         return mDatabase.getPath();\n     }\n+\n+\n+    public void executeInTransaction(Runnable r) {\n+        // Ported from code which started the transaction outside the try..finally\n+        getDatabase().beginTransaction();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b92f81834d84a63e1128b457cb7673c44dd95c6b"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MDg2MzMy", "url": "https://github.com/ankidroid/Anki-Android/pull/7267#pullrequestreview-495086332", "createdAt": "2020-09-23T22:15:25Z", "commit": {"oid": "a9afb959e1d14a34a53b28326d9677f9395413bd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3899, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}