{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyMzUyNjE3", "number": 5855, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzozMToyMVrODqYL8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxNjo0MDowOFrODqdbbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NzYzMDU5OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzozMToyMVrOF6FeNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzo1MzowOVrOF6GZDw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ1MTM4Mg==", "bodyText": "These strings are basically all the same. Some have a hard value in them and some are interpolated. This one has a misspelling ('colection') but in general the less strings the better - nothing should be repeated. I think we can have one general string (that is always interpolated, then 150MB (or whatever) can be sent in for those cases otherwise it gets the dynamic value. Then just one extra string you can concatenate that says how much free space there is now.", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396451382", "createdAt": "2020-03-23T13:31:21Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "diffHunk": "@@ -151,4 +151,13 @@\n     <string name=\"collection_load_welcome_request_permissions_title\">Welcome to AnkiDroid!</string>\n     <string name=\"collection_load_welcome_request_permissions_details\">AnkiDroid requires storage permission, which we use exclusively to store your AnkiDroid collection, flashcard media and backups. Our code is open-source, written by volunteers, and trusted by millions.\\n\\nIf you have any questions, please access our in-app manual or visit our support forums.\\n\\nThank you for trying AnkiDroid!\\n\u2014AnkiDroid Development Team</string>\n     <string name=\"mutimedia_editor_assertion_failed\">Unknown error occurred displaying Advanced Editor</string>\n+\n+    <!-- Database Integrity Check -->\n+    <string name=\"integrity_check_continue_anyway\">Continue Anyway</string>\n+    <string name=\"integrity_check_insufficient_space\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least %s free space on your device before continuing.\\n\\nYou currently have %s free.</string>\n+\n+    <string name=\"integrity_check_error_colection_load_failed\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least 150MB free space on your device before continuing.</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34e9f70abea29826f0d5f5e13fb60f2a75e8e15e"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ2NTc3MQ==", "bodyText": "Agreed that this can be done better, I haven't done localisation in years, and never where it mattered.\nI don't like explicit concatenation as it defines a concrete ordering over the strings, but I'll have a think and get back to this one. It can be done better.", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396465771", "createdAt": "2020-03-23T13:52:11Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "diffHunk": "@@ -151,4 +151,13 @@\n     <string name=\"collection_load_welcome_request_permissions_title\">Welcome to AnkiDroid!</string>\n     <string name=\"collection_load_welcome_request_permissions_details\">AnkiDroid requires storage permission, which we use exclusively to store your AnkiDroid collection, flashcard media and backups. Our code is open-source, written by volunteers, and trusted by millions.\\n\\nIf you have any questions, please access our in-app manual or visit our support forums.\\n\\nThank you for trying AnkiDroid!\\n\u2014AnkiDroid Development Team</string>\n     <string name=\"mutimedia_editor_assertion_failed\">Unknown error occurred displaying Advanced Editor</string>\n+\n+    <!-- Database Integrity Check -->\n+    <string name=\"integrity_check_continue_anyway\">Continue Anyway</string>\n+    <string name=\"integrity_check_insufficient_space\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least %s free space on your device before continuing.\\n\\nYou currently have %s free.</string>\n+\n+    <string name=\"integrity_check_error_colection_load_failed\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least 150MB free space on your device before continuing.</string>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ1MTM4Mg=="}, "originalCommit": {"oid": "34e9f70abea29826f0d5f5e13fb60f2a75e8e15e"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ2NjQ0Nw==", "bodyText": "In this case where it will be warning message + information message, I think it will work fine", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396466447", "createdAt": "2020-03-23T13:53:09Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "diffHunk": "@@ -151,4 +151,13 @@\n     <string name=\"collection_load_welcome_request_permissions_title\">Welcome to AnkiDroid!</string>\n     <string name=\"collection_load_welcome_request_permissions_details\">AnkiDroid requires storage permission, which we use exclusively to store your AnkiDroid collection, flashcard media and backups. Our code is open-source, written by volunteers, and trusted by millions.\\n\\nIf you have any questions, please access our in-app manual or visit our support forums.\\n\\nThank you for trying AnkiDroid!\\n\u2014AnkiDroid Development Team</string>\n     <string name=\"mutimedia_editor_assertion_failed\">Unknown error occurred displaying Advanced Editor</string>\n+\n+    <!-- Database Integrity Check -->\n+    <string name=\"integrity_check_continue_anyway\">Continue Anyway</string>\n+    <string name=\"integrity_check_insufficient_space\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least %s free space on your device before continuing.\\n\\nYou currently have %s free.</string>\n+\n+    <string name=\"integrity_check_error_colection_load_failed\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least 150MB free space on your device before continuing.</string>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ1MTM4Mg=="}, "originalCommit": {"oid": "34e9f70abea29826f0d5f5e13fb60f2a75e8e15e"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NzY1NDA1OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/CollectionHelper.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzozNzowMFrOF6FtFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzo0NTozOFrOF6GEZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ1NTE4OA==", "bodyText": "this comment is too cryptic for me \ud83e\udd23", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396455188", "createdAt": "2020-03-23T13:37:00Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/CollectionHelper.java", "diffHunk": "@@ -225,4 +239,82 @@ private static String getParentDirectory(String path) {\n         return new File(path).getParentFile().getAbsolutePath();\n     }\n \n+    /** Union: (required space * free space) | Error */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34e9f70abea29826f0d5f5e13fb60f2a75e8e15e"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ2MTE1Ng==", "bodyText": "Will fix.", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396461156", "createdAt": "2020-03-23T13:45:38Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/CollectionHelper.java", "diffHunk": "@@ -225,4 +239,82 @@ private static String getParentDirectory(String path) {\n         return new File(path).getParentFile().getAbsolutePath();\n     }\n \n+    /** Union: (required space * free space) | Error */", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ1NTE4OA=="}, "originalCommit": {"oid": "34e9f70abea29826f0d5f5e13fb60f2a75e8e15e"}, "originalPosition": 47}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NzY2OTU3OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/CollectionHelper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzo0MDozN1rOF6F2rQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzo0MDozN1rOF6F2rQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ1NzY0NQ==", "bodyText": "I have to admit I don't like the wtf's. Timber says \"log an assert message\", but what does that mean? Are these all going to change behavior unexpectedly and stop effectively mapping to error / start actually being a hard crash assert when the new Android Studio 4 de-sugaring comes in? I'd rather stick with Timber.d through Timber.e", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396457645", "createdAt": "2020-03-23T13:40:37Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/CollectionHelper.java", "diffHunk": "@@ -225,4 +239,82 @@ private static String getParentDirectory(String path) {\n         return new File(path).getParentFile().getAbsolutePath();\n     }\n \n+    /** Union: (required space * free space) | Error */\n+    public static class CollectionIntegrityCheckStatus {\n+\n+        @Nullable\n+        private final String mErrorMessage;\n+\n+        //OR:\n+        @Nullable\n+        private final Long mRequiredSpace;\n+        @Nullable\n+        private final Long mFreeSpace;\n+\n+        private CollectionIntegrityCheckStatus(long requiredSpace, long freeSpace) {\n+            this.mFreeSpace = freeSpace;\n+            this.mRequiredSpace = requiredSpace;\n+            this.mErrorMessage = null;\n+        }\n+\n+        private CollectionIntegrityCheckStatus(@NonNull String errorMessage) {\n+            this.mRequiredSpace = null;\n+            this.mFreeSpace = null;\n+            this.mErrorMessage = errorMessage;\n+        }\n+\n+        private static CollectionIntegrityCheckStatus fromError(String errorMessage) {\n+            return new CollectionIntegrityCheckStatus(errorMessage);\n+        }\n+\n+        public static CollectionIntegrityCheckStatus createInstance(Context context) {\n+\n+            Long maybeCurrentCollectionSizeInBytes = getCollectionSize(context);\n+            if (maybeCurrentCollectionSizeInBytes == null) {\n+                return fromError(context.getResources().getString(R.string.integrity_check_error_colection_load_failed));\n+            }\n+\n+            // This means that when VACUUMing a database, as much as twice the size of the original database file is\n+            // required in free disk space. - https://www.sqlite.org/lang_vacuum.html\n+            long requiredSpaceInBytes = maybeCurrentCollectionSizeInBytes * 2;\n+\n+            // We currently use the same directory as the collection for VACUUM/ANALYZE due to the SQLite APIs\n+            File collectionFile = new File(getCollectionPath(context));\n+            long freeSpace = FileUtil.getFreeDiskSpace(collectionFile, -1);\n+\n+            if (freeSpace == -1) {\n+                String readableFileSize  = Formatter.formatFileSize(context, requiredSpaceInBytes);\n+                return fromError(context.getResources().getString(R.string.integrity_check_error_remaining_filesystem_size_failed, readableFileSize));\n+            }\n+\n+            return new CollectionIntegrityCheckStatus(requiredSpaceInBytes, freeSpace);\n+        }\n+\n+        public boolean shouldWarnOnIntegrityCheck() {\n+            return this.mErrorMessage != null || fileSystemDoesNotHaveSpaceForBackup();\n+        }\n+\n+        private boolean fileSystemDoesNotHaveSpaceForBackup() {\n+            //only to be called when mErrorMessage == null\n+            if (mFreeSpace == null || mRequiredSpace == null) {\n+                Timber.wtf(\"fileSystemDoesNotHaveSpaceForBackup called in invalid state.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34e9f70abea29826f0d5f5e13fb60f2a75e8e15e"}, "originalPosition": 105}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NzY3NjY3OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/CollectionHelper.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzo0MjoxOVrOF6F7Jw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxMzo0MjoxOVrOF6F7Jw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjQ1ODc5MQ==", "bodyText": "The name is CollectionIntegrityCheckStatus but the logic is all \"do I have space for fix integrity\", should it be CollectionIntegrityStorageCheck\" or something else similar that bakes the idea it's all storage-related into it, instead of sounding like it's more general?", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396458791", "createdAt": "2020-03-23T13:42:19Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/CollectionHelper.java", "diffHunk": "@@ -225,4 +239,82 @@ private static String getParentDirectory(String path) {\n         return new File(path).getParentFile().getAbsolutePath();\n     }\n \n+    /** Union: (required space * free space) | Error */\n+    public static class CollectionIntegrityCheckStatus {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "34e9f70abea29826f0d5f5e13fb60f2a75e8e15e"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1ODQ4NTMwOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxNjozOTowOVrOF6OD3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxNjozOTowOVrOF6OD3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU5MjA5Mw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <string name=\"integrity_check_startup_content\">AnkiDroid has been upgraded. It is advised that you check and optimise your database to ensure an optimal user experience.</string>\n          \n          \n            \n                <string name=\"integrity_check_startup_content\">AnkiDroid has been upgraded. This upgrade includes fixes for possible database problems, and we advise you to run check database now.</string>\n          \n      \n    \n    \n  \n\nMy only hesitation here is that I can imagine a time when the check is not optional. Right now I think the checks are all \"grooming\" type things so they are optional, so I kind of like the idea of letting the user skip it, but in the future we may need another option that is more direct and not-cancellable\nOn balance, I approve of this with the wording tweak (where I studiously avoided en-US or en-GB :) )", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396592093", "createdAt": "2020-03-23T16:39:09Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "diffHunk": "@@ -151,4 +151,12 @@\n     <string name=\"collection_load_welcome_request_permissions_title\">Welcome to AnkiDroid!</string>\n     <string name=\"collection_load_welcome_request_permissions_details\">AnkiDroid requires storage permission, which we use exclusively to store your AnkiDroid collection, flashcard media and backups. Our code is open-source, written by volunteers, and trusted by millions.\\n\\nIf you have any questions, please access our in-app manual or visit our support forums.\\n\\nThank you for trying AnkiDroid!\\n\u2014AnkiDroid Development Team</string>\n     <string name=\"mutimedia_editor_assertion_failed\">Unknown error occurred displaying Advanced Editor</string>\n+\n+    <!-- Database Integrity Check -->\n+    <string name=\"integrity_check_startup_title\">AnkiDroid Upgraded</string>\n+    <string name=\"integrity_check_startup_content\">AnkiDroid has been upgraded. It is advised that you check and optimise your database to ensure an optimal user experience.</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89a7f6450c506f9c445516c05ee0c89b0d459f11"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1ODQ4OTQxOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxNjo0MDowOFrOF6OGlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxODo1OTozMFrOF6T07Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU5Mjc4OQ==", "bodyText": "I still don't like that the string is almost completely duplicated, it increases translator load for no value I can discern", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396592789", "createdAt": "2020-03-23T16:40:08Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "diffHunk": "@@ -151,4 +151,12 @@\n     <string name=\"collection_load_welcome_request_permissions_title\">Welcome to AnkiDroid!</string>\n     <string name=\"collection_load_welcome_request_permissions_details\">AnkiDroid requires storage permission, which we use exclusively to store your AnkiDroid collection, flashcard media and backups. Our code is open-source, written by volunteers, and trusted by millions.\\n\\nIf you have any questions, please access our in-app manual or visit our support forums.\\n\\nThank you for trying AnkiDroid!\\n\u2014AnkiDroid Development Team</string>\n     <string name=\"mutimedia_editor_assertion_failed\">Unknown error occurred displaying Advanced Editor</string>\n+\n+    <!-- Database Integrity Check -->\n+    <string name=\"integrity_check_startup_title\">AnkiDroid Upgraded</string>\n+    <string name=\"integrity_check_startup_content\">AnkiDroid has been upgraded. It is advised that you check and optimise your database to ensure an optimal user experience.</string>\n+    <string name=\"integrity_check_positive\">Check Database</string>\n+    <string name=\"integrity_check_continue_anyway\">Continue Anyway</string>\n+    <string name=\"integrity_check_insufficient_space\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least %s free space on your device before continuing.\\n\\nYou currently have %s free.</string>>\n+    <string name=\"integrity_check_maybe_insufficient_space\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least %s free space on your device before continuing.</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "89a7f6450c506f9c445516c05ee0c89b0d459f11"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjYxNDQ2Mg==", "bodyText": "I'll fix it with an in-code concat, don't like it to be honest, but it's not a hill to die on ;)", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396614462", "createdAt": "2020-03-23T17:10:31Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "diffHunk": "@@ -151,4 +151,12 @@\n     <string name=\"collection_load_welcome_request_permissions_title\">Welcome to AnkiDroid!</string>\n     <string name=\"collection_load_welcome_request_permissions_details\">AnkiDroid requires storage permission, which we use exclusively to store your AnkiDroid collection, flashcard media and backups. Our code is open-source, written by volunteers, and trusted by millions.\\n\\nIf you have any questions, please access our in-app manual or visit our support forums.\\n\\nThank you for trying AnkiDroid!\\n\u2014AnkiDroid Development Team</string>\n     <string name=\"mutimedia_editor_assertion_failed\">Unknown error occurred displaying Advanced Editor</string>\n+\n+    <!-- Database Integrity Check -->\n+    <string name=\"integrity_check_startup_title\">AnkiDroid Upgraded</string>\n+    <string name=\"integrity_check_startup_content\">AnkiDroid has been upgraded. It is advised that you check and optimise your database to ensure an optimal user experience.</string>\n+    <string name=\"integrity_check_positive\">Check Database</string>\n+    <string name=\"integrity_check_continue_anyway\">Continue Anyway</string>\n+    <string name=\"integrity_check_insufficient_space\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least %s free space on your device before continuing.\\n\\nYou currently have %s free.</string>>\n+    <string name=\"integrity_check_maybe_insufficient_space\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least %s free space on your device before continuing.</string>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU5Mjc4OQ=="}, "originalCommit": {"oid": "89a7f6450c506f9c445516c05ee0c89b0d459f11"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjY4NjU3Mw==", "bodyText": "It's a think of \"practical beauty\" - the translators will appreciate I think. If this blows up RTL in terrible ways, you'll have one free \"I told you so\" card to throw down", "url": "https://github.com/ankidroid/Anki-Android/pull/5855#discussion_r396686573", "createdAt": "2020-03-23T18:59:30Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/res/values/03-dialogs.xml", "diffHunk": "@@ -151,4 +151,12 @@\n     <string name=\"collection_load_welcome_request_permissions_title\">Welcome to AnkiDroid!</string>\n     <string name=\"collection_load_welcome_request_permissions_details\">AnkiDroid requires storage permission, which we use exclusively to store your AnkiDroid collection, flashcard media and backups. Our code is open-source, written by volunteers, and trusted by millions.\\n\\nIf you have any questions, please access our in-app manual or visit our support forums.\\n\\nThank you for trying AnkiDroid!\\n\u2014AnkiDroid Development Team</string>\n     <string name=\"mutimedia_editor_assertion_failed\">Unknown error occurred displaying Advanced Editor</string>\n+\n+    <!-- Database Integrity Check -->\n+    <string name=\"integrity_check_startup_title\">AnkiDroid Upgraded</string>\n+    <string name=\"integrity_check_startup_content\">AnkiDroid has been upgraded. It is advised that you check and optimise your database to ensure an optimal user experience.</string>\n+    <string name=\"integrity_check_positive\">Check Database</string>\n+    <string name=\"integrity_check_continue_anyway\">Continue Anyway</string>\n+    <string name=\"integrity_check_insufficient_space\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least %s free space on your device before continuing.\\n\\nYou currently have %s free.</string>>\n+    <string name=\"integrity_check_maybe_insufficient_space\">Check Database uses a large amount of temporary storage.\\n\\nIt is strongly recommended that you have at least %s free space on your device before continuing.</string>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU5Mjc4OQ=="}, "originalCommit": {"oid": "89a7f6450c506f9c445516c05ee0c89b0d459f11"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 461, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}