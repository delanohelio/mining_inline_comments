{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MTcxNTg0", "number": 5916, "title": "Fix Crash on Unreadable Gallery Image", "bodyText": "Purpose / Description\nCrash caused due to being unable to decode the following intent.\nFailure delivering result ResultInfo{who=null, request=1, result=-1, \ndata=Intent { dat=content://com.simplemobiletools.gallery.provider/external_files/data/data/com.simplemobiletools.gallery/files/storage/emulated/0/Pictures/Screenshots/[REDACTED] typ=image/png flg=0x1 }}\n to activity {com.ichi2.anki/com.ichi2.anki.multimediacard.activity.MultimediaEditFieldActivity}: java.lang.IllegalStateException: Couldn't read row 0, col -1 from CursorWindow. Make sure the Cursor is initialized correctly before accessing data from it.\n\nFixes\nFixes #5909\nApproach\nWe catch any exceptions, or show a toast on known failure\nHow Has This Been Tested?\nUnit Test. Couldn't repro on my device. Image insert still works correctly\nChecklist\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-04-03T13:24:07Z", "url": "https://github.com/ankidroid/Anki-Android/pull/5916", "merged": true, "mergeCommit": {"oid": "8ac7e1f8cbdde471e9c6105abbb6266bc4e343e6"}, "closed": true, "closedAt": "2020-04-03T14:34:41Z", "author": {"login": "david-allison-1"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUAOCZAH2gAyMzk4MTcxNTg0OjUxM2UzOGVjMTM2ZjBhOGNhZmY3NTdlZmE3NGNiODZhNmFiOTQwMGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcUBIU3AFqTM4NzI2Nzc5Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "513e38ec136f0a8caff757efa74cb86a6ab9400e", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/513e38ec136f0a8caff757efa74cb86a6ab9400e", "committedDate": "2020-04-03T12:39:54Z", "message": "NF: Handle handleSelectImageIntent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1630775db71fe75079753811519c7b6a88b824ae", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/1630775db71fe75079753811519c7b6a88b824ae", "committedDate": "2020-04-03T12:46:26Z", "message": "ImageController: Handle unhandled request code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "865bf5a2440e1262215b7180c122b6139bc5e97f", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/865bf5a2440e1262215b7180c122b6139bc5e97f", "committedDate": "2020-04-03T13:39:12Z", "message": "ImageController: Handle exception\n\nFixes #5909 - an exception previously crashed the application"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d29ff60f026ccecef137db3912723e45ba445f4b", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/d29ff60f026ccecef137db3912723e45ba445f4b", "committedDate": "2020-04-03T13:39:17Z", "message": "ImageController: \"Select Image\" Logging\n\nThis provides more logging and less exceptions if an error occurs when\nselecting a new image"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "156a95517994c4b4bba658917028bf36d0df484c", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/156a95517994c4b4bba658917028bf36d0df484c", "committedDate": "2020-04-03T13:07:06Z", "message": "ImageController: \"Select Image\" Logging\n\nThis provides more logging and less exceptions if an error occurs when\nselecting a new image"}, "afterCommit": {"oid": "d29ff60f026ccecef137db3912723e45ba445f4b", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/d29ff60f026ccecef137db3912723e45ba445f4b", "committedDate": "2020-04-03T13:39:17Z", "message": "ImageController: \"Select Image\" Logging\n\nThis provides more logging and less exceptions if an error occurs when\nselecting a new image"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MjY2NDY4", "url": "https://github.com/ankidroid/Anki-Android/pull/5916#pullrequestreview-387266468", "createdAt": "2020-04-03T13:42:03Z", "commit": {"oid": "d29ff60f026ccecef137db3912723e45ba445f4b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxMzo0MjowM1rOGAV_VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxMzo0MjowM1rOGAV_VQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAxMzQ2MQ==", "bodyText": "Issue found: JUnit tests should include assert() or fail()", "url": "https://github.com/ankidroid/Anki-Android/pull/5916#discussion_r403013461", "createdAt": "2020-04-03T13:42:03Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/test/java/com/ichi2/anki/multimediacard/fields/BasicImageFieldControllerTest.java", "diffHunk": "@@ -65,6 +72,24 @@ public void erroringFileDoesNotDisplayPreview() {\n                 is(false));\n     }\n \n+\n+    @Test\n+    public void invalidImageResultDoesNotCrashController() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d29ff60f026ccecef137db3912723e45ba445f4b"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MjY2NDgx", "url": "https://github.com/ankidroid/Anki-Android/pull/5916#pullrequestreview-387266481", "createdAt": "2020-04-03T13:42:04Z", "commit": {"oid": "d29ff60f026ccecef137db3912723e45ba445f4b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxMzo0MjowNFrOGAV_Xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxMzo0MjowNFrOGAV_Xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAxMzQ3MA==", "bodyText": "Issue found: The utility class name 'MockCursor' doesn't match '[A-Z][a-zA-Z0-9]+(Utils?|Helper)'", "url": "https://github.com/ankidroid/Anki-Android/pull/5916#discussion_r403013470", "createdAt": "2020-04-03T13:42:04Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/test/java/com/ichi2/testutils/MockCursor.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package com.ichi2.testutils;\n+\n+import android.database.Cursor;\n+import android.database.CursorWrapper;\n+\n+import org.mockito.Mockito;\n+\n+import static org.mockito.ArgumentMatchers.anyInt;\n+import static org.mockito.Mockito.when;\n+\n+public class MockCursor {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d29ff60f026ccecef137db3912723e45ba445f4b"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MjY2NDk4", "url": "https://github.com/ankidroid/Anki-Android/pull/5916#pullrequestreview-387266498", "createdAt": "2020-04-03T13:42:05Z", "commit": {"oid": "d29ff60f026ccecef137db3912723e45ba445f4b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxMzo0MjowNVrOGAV_ZA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxMzo0MjowNVrOGAV_ZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzAxMzQ3Ng==", "bodyText": "Issue found: The utility class name 'MockContentResolver' doesn't match '[A-Z][a-zA-Z0-9]+(Utils?|Helper)'", "url": "https://github.com/ankidroid/Anki-Android/pull/5916#discussion_r403013476", "createdAt": "2020-04-03T13:42:05Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/test/java/com/ichi2/testutils/MockContentResolver.java", "diffHunk": "@@ -0,0 +1,24 @@\n+package com.ichi2.testutils;\n+\n+import android.content.ContentResolver;\n+import android.database.Cursor;\n+\n+import org.mockito.Mockito;\n+\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.when;\n+\n+public class MockContentResolver {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d29ff60f026ccecef137db3912723e45ba445f4b"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3MjY3Nzky", "url": "https://github.com/ankidroid/Anki-Android/pull/5916#pullrequestreview-387267792", "createdAt": "2020-04-03T13:43:34Z", "commit": {"oid": "d29ff60f026ccecef137db3912723e45ba445f4b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3579, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}