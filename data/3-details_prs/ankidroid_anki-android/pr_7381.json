{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAyMTI1MzQ3", "number": 7381, "title": "Fix #7118: Adding Filter by flag icon to card browser.", "bodyText": "Purpose / Description\nUsers don't know that they can type: flag:1 etc... this needs a visual item in the Card Browser Action bar - similar to the item in the Reviewer.\nFixes\nFixes #7118\nApproach\n\nFlag icon is added to card browser menu with ifRoom option. After that change it will replace \"Add card button\" on most mobile phones, since there is not enough room for both and search icon.\nWhen flag is selected, searchTerms are updated to have flag:N.\nIf there was already search term looked for by user, selecting flag will prepend flag:N to search terms.\nIf user has selected a flag and then wants to switch to other flag:N term is replaced with correct flag, without removing existing search terms.\nOnly one flag can be selected at one time, when using Search by flag option.\n\nHow Has This Been Tested?\n\nAdded unit test for checking if my function is selecting correct cards.\nTested it on emulated device in Android Studio (Pixel 3a API 30)\n\nLearning (optional, can help others)\nNone\nChecklist\nPlease, go through these checks before submitting the PR.\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-10-13T09:12:16Z", "url": "https://github.com/ankidroid/Anki-Android/pull/7381", "merged": true, "mergeCommit": {"oid": "99ab89ed6fb3bb0c568db544a76ae9928ce79db7"}, "closed": true, "closedAt": "2020-10-14T18:58:42Z", "author": {"login": "Volfee"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRw3_igH2gAyNTAyMTI1MzQ3OjRmZGNhMGU0MWUyOGE3NzZmY2U2MGE2MmI2MmNlOWU3ZDY0NzI0OWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSemL6AFqTUwODQ0ODczMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4fdca0e41e28a776fce60a62b62ce9e7d647249a", "author": {"user": {"login": "Volfee", "name": "Przemyslaw Wilk"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/4fdca0e41e28a776fce60a62b62ce9e7d647249a", "committedDate": "2020-10-12T09:50:33Z", "message": "Added flag icon to card browser. When selecting flag, flag color changes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e63cb9ae3a29c616271bc5c749a6cb637830eda", "author": {"user": {"login": "Volfee", "name": "Przemyslaw Wilk"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/9e63cb9ae3a29c616271bc5c749a6cb637830eda", "committedDate": "2020-10-12T12:25:40Z", "message": "When flag is selected, mSearchTerms are updated and correct cards are selected."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4e2c26b9236da34690c486f7585b09a34440e57", "author": {"user": {"login": "Volfee", "name": "Przemyslaw Wilk"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/b4e2c26b9236da34690c486f7585b09a34440e57", "committedDate": "2020-10-12T15:33:15Z", "message": "When search widget is closed turn flag back to transparent."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69a6661393918f14a3ef97e1a8a299df94132036", "author": {"user": {"login": "Volfee", "name": "Przemyslaw Wilk"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/69a6661393918f14a3ef97e1a8a299df94132036", "committedDate": "2020-10-12T16:34:23Z", "message": "When user adds filtration by flag from options menu and there is existing search term, flag filtration is appended to the search instead of replacing it."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0270ed716f2d27e5d05954d7a2d684b0987933b5", "author": {"user": {"login": "Volfee", "name": "Przemyslaw Wilk"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/0270ed716f2d27e5d05954d7a2d684b0987933b5", "committedDate": "2020-10-12T16:52:34Z", "message": "Adding final fixes."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d530bd4575c0bf8c2298d3f7b69fde4211cf191", "author": {"user": {"login": "Volfee", "name": "Przemyslaw Wilk"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/8d530bd4575c0bf8c2298d3f7b69fde4211cf191", "committedDate": "2020-10-13T08:10:47Z", "message": "Adding test for filter by flag."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "831e9263c3635c6a183efebf1b9299d5b72a238f", "author": {"user": {"login": "Volfee", "name": "Przemyslaw Wilk"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/831e9263c3635c6a183efebf1b9299d5b72a238f", "committedDate": "2020-10-13T08:22:01Z", "message": "Small fixes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA3MzYyNzMy", "url": "https://github.com/ankidroid/Anki-Android/pull/7381#pullrequestreview-507362732", "createdAt": "2020-10-13T12:08:32Z", "commit": {"oid": "831e9263c3635c6a183efebf1b9299d5b72a238f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMjowODozMlrOHgjb-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QxMjowODozMlrOHgjb-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzg5NzA4MQ==", "bodyText": "I feel it'd be best to move this into the menu with the other search items (both removing it as an action, and repositioning it).\nThere's little visual feedback that the flag icon means \"search\", and it feels peculiar to give it priority over other methods of filtering.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    ankidroid:showAsAction=\"ifRoom\"\n          \n          \n            \n                    ankidroid:showAsAction=\"never\"", "url": "https://github.com/ankidroid/Anki-Android/pull/7381#discussion_r503897081", "createdAt": "2020-10-13T12:08:32Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/res/menu/card_browser.xml", "diffHunk": "@@ -1,11 +1,40 @@\n <menu xmlns:android=\"http://schemas.android.com/apk/res/android\"\n     xmlns:ankidroid=\"http://schemas.android.com/apk/res-auto\" >\n \n+    <item\n+        ankidroid:showAsAction=\"ifRoom\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "831e9263c3635c6a183efebf1b9299d5b72a238f"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1c306244e3478c179fee0201ff1f3dccaa3d6cfa", "author": {"user": {"login": "Volfee", "name": "Przemyslaw Wilk"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/1c306244e3478c179fee0201ff1f3dccaa3d6cfa", "committedDate": "2020-10-13T16:41:09Z", "message": "Moving `Filter by flag` option to menu, in relation to this removing icon and methods that modified icon when selected, to keep code cleaner."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4MjczMjAw", "url": "https://github.com/ankidroid/Anki-Android/pull/7381#pullrequestreview-508273200", "createdAt": "2020-10-14T12:03:53Z", "commit": {"oid": "1c306244e3478c179fee0201ff1f3dccaa3d6cfa"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0ada24f56adf3c4178d3a830c7e7bb2f8f3b89ef", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/0ada24f56adf3c4178d3a830c7e7bb2f8f3b89ef", "committedDate": "2020-10-14T15:04:34Z", "message": "Merge branch 'master' into master"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NDQ4NzMw", "url": "https://github.com/ankidroid/Anki-Android/pull/7381#pullrequestreview-508448730", "createdAt": "2020-10-14T15:06:44Z", "commit": {"oid": "0ada24f56adf3c4178d3a830c7e7bb2f8f3b89ef"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3963, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}