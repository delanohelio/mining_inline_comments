{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI5MzQ3MzU4", "number": 6386, "title": "Show Toast using JavaScript function in WebView", "bodyText": "Pull Request template\nPurpose / Description\nAs sometime it needed to toast in AnkiDroid. This will create native toast of message passed by card developer\nThis is continuation of #6307\nFixes\nFixes Link to the issues.\nApproach\nAdded signal for calling function\nIn card.js\nankiShowToast(msg)\n\nHow Has This Been Tested?\nTested on emulator,\nThe function accept string for showing toast message\nIn front side of card template add it in <script> tag\nankiShowToast(\"Showing native toast using javascript\");\n\nLearning (optional, can help others)\nhttps://developer.android.com/guide/topics/ui/notifiers/toasts\nChecklist\nPlease, go through these checks before submitting the PR.\n\n[ x ] You have not changed whitespace unnecessarily (it makes diffs hard to read)\n[ x ] You have a descriptive commit message with a short title (first line, max 50 chars).\n[ x ] Your code follows the style of the project (e.g. never omit braces in if statements)\n[ x ] You have commented your code, particularly in hard-to-understand areas\n[ x ] You have performed a self-review of your own code", "createdAt": "2020-06-06T17:51:42Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6386", "merged": true, "mergeCommit": {"oid": "7d68b87a7e2f37a99dabdfabc6225d614a540146"}, "closed": true, "closedAt": "2020-06-20T17:06:07Z", "author": {"login": "infinyte7"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcoq69gAH2gAyNDI5MzQ3MzU4OjI3MzBkMGE2MmU4YmNjNDVhMTFlZmE2MDNmODFmYTcyYjNhMmU0MGU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABctKxanAFqTQzNDQ0MTE5Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2730d0a62e8bcc45a11efa603f81fa72b3a2e40e", "author": {"user": {"login": "infinyte7", "name": "Mani"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/2730d0a62e8bcc45a11efa603f81fa72b3a2e40e", "committedDate": "2020-06-06T17:43:28Z", "message": "\tAdded function ankiShowToast card.js\n\tAbstractFlashcardViewer.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTI3NjM4", "url": "https://github.com/ankidroid/Anki-Android/pull/6386#pullrequestreview-430127638", "createdAt": "2020-06-13T09:43:24Z", "commit": {"oid": "2730d0a62e8bcc45a11efa603f81fa72b3a2e40e"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QwOTo0MzoyNFrOGjWuaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QwOTo0Mzo0NlrOGjWufQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcyNTY3Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                window.location.href = \"signal:anki_show_toast\" + message;\n          \n          \n            \n                window.location.href = \"signal:anki_show_toast:\" + message;", "url": "https://github.com/ankidroid/Anki-Android/pull/6386#discussion_r439725673", "createdAt": "2020-06-13T09:43:24Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/assets/scripts/card.js", "diffHunk": "@@ -125,6 +125,11 @@ function ankiToggleFlag(flag) {\n     }\n }\n \n+// Show toast using js\n+function ankiShowToast(message) {\n+    window.location.href = \"signal:anki_show_toast\" + message;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2730d0a62e8bcc45a11efa603f81fa72b3a2e40e"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcyNTY4MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (url.startsWith(\"signal:anki_show_toast\")) {\n          \n          \n            \n                        if (url.startsWith(\"signal:anki_show_toast:\")) {", "url": "https://github.com/ankidroid/Anki-Android/pull/6386#discussion_r439725681", "createdAt": "2020-06-13T09:43:35Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -3110,6 +3110,13 @@ private boolean filterUrl(String url) {\n                 }\n             }\n \n+            // Show toast using JS\n+            if (url.startsWith(\"signal:anki_show_toast\")) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2730d0a62e8bcc45a11efa603f81fa72b3a2e40e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTcyNTY5Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            String msg = url.replaceFirst(\"signal:anki_show_toast\",\"\");\n          \n          \n            \n                            String msg = url.replaceFirst(\"signal:anki_show_toast:\", \"\");", "url": "https://github.com/ankidroid/Anki-Android/pull/6386#discussion_r439725693", "createdAt": "2020-06-13T09:43:46Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -3110,6 +3110,13 @@ private boolean filterUrl(String url) {\n                 }\n             }\n \n+            // Show toast using JS\n+            if (url.startsWith(\"signal:anki_show_toast\")) {\n+                String msg = url.replaceFirst(\"signal:anki_show_toast\",\"\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2730d0a62e8bcc45a11efa603f81fa72b3a2e40e"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aacf62710b28795e16c1fac5bcb94c5921543bec", "author": {"user": {"login": "infinyte7", "name": "Mani"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/aacf62710b28795e16c1fac5bcb94c5921543bec", "committedDate": "2020-06-13T14:08:04Z", "message": "\tAdded url decoding of msg"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35296286267a60482b296c31ea365e7e2a045633", "author": {"user": {"login": "infinyte7", "name": "Mani"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/35296286267a60482b296c31ea365e7e2a045633", "committedDate": "2020-06-13T17:59:09Z", "message": "\tAdded encode toast msg, card.js"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTU1ODE2", "url": "https://github.com/ankidroid/Anki-Android/pull/6386#pullrequestreview-430155816", "createdAt": "2020-06-13T18:05:19Z", "commit": {"oid": "35296286267a60482b296c31ea365e7e2a045633"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QxODowNToxOVrOGjYqaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xM1QxODowNToxOVrOGjYqaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc1NzQxNg==", "bodyText": "This needs to be in a try.. catch as the user can manually trigger a signal with bad input.", "url": "https://github.com/ankidroid/Anki-Android/pull/6386#discussion_r439757416", "createdAt": "2020-06-13T18:05:19Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -3110,6 +3110,14 @@ private boolean filterUrl(String url) {\n                 }\n             }\n \n+            // Show toast using JS\n+            if (url.startsWith(\"signal:anki_show_toast:\")) {\n+                String msg = url.replaceFirst(\"signal:anki_show_toast:\", \"\");\n+                String msgDecode = Uri.decode(msg);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35296286267a60482b296c31ea365e7e2a045633"}, "originalPosition": 7}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c470a03ce483885778c6ead3e6e74aca9988baca", "author": {"user": {"login": "infinyte7", "name": "Mani"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/c470a03ce483885778c6ead3e6e74aca9988baca", "committedDate": "2020-06-13T18:24:56Z", "message": "\tUpdated AbstractFlashcardViewer.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMwMTU3MTgz", "url": "https://github.com/ankidroid/Anki-Android/pull/6386#pullrequestreview-430157183", "createdAt": "2020-06-13T18:28:42Z", "commit": {"oid": "c470a03ce483885778c6ead3e6e74aca9988baca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NDM4NDc4", "url": "https://github.com/ankidroid/Anki-Android/pull/6386#pullrequestreview-434438478", "createdAt": "2020-06-20T16:17:16Z", "commit": {"oid": "c470a03ce483885778c6ead3e6e74aca9988baca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NDQxMTk2", "url": "https://github.com/ankidroid/Anki-Android/pull/6386#pullrequestreview-434441196", "createdAt": "2020-06-20T17:05:42Z", "commit": {"oid": "c470a03ce483885778c6ead3e6e74aca9988baca"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3154, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}