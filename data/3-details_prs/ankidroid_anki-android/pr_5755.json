{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc1NzMwMjUz", "number": 5755, "title": "Fix add audio crashes", "bodyText": "Pull Request template\nPurpose / Description\nAdd audio clips was a highly requested feature, and it worked structurally but failed when confronted with unexpected audio clip names or unexpected content resolver states (like, no results - it always expected one)\nAlso the error handling and implementation of file copies were non-standard\nFixes\nFixes #5509\nApproach\nBest to review each commit separately as they are discrete and independently useful\n\ngeneralize the ability to show toasts (so we can inform users of audio clip issues)\nstandardize the content file copy and error handling using existing helper function\nimprove content resolver results handling in case results are empty or contain an audio clip with no file extensions\n\nHow Has This Been Tested?\nI used an API29 emulator attached to a google play account so I could use my Google Drive as a source of audio files that would not be resolved to file paths.\nI added two audio files, one with extension and one without to my google drive\nI verified crashes when attempting to add the audio file without an extension\nI verified everything works for both files after all the changes\nChecklist\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-02-15T15:55:25Z", "url": "https://github.com/ankidroid/Anki-Android/pull/5755", "merged": true, "mergeCommit": {"oid": "6958194e17e6edeeae71039710280816e1081a92"}, "closed": true, "closedAt": "2020-02-16T19:22:34Z", "author": {"login": "mikehardy"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcEsSuHgFqTM1OTM3MDYxMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcE5SuKgBqjMwNDE1ODA3ODE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU5MzcwNjEz", "url": "https://github.com/ankidroid/Anki-Android/pull/5755#pullrequestreview-359370613", "createdAt": "2020-02-15T22:56:13Z", "commit": {"oid": "7470d5e6467b5acbc959bf4fc681c81f1a2a3db4"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNVQyMjo1NjoxM1rOFqQ5Qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xNVQyMjo1NjoxM1rOFqQ5Qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTg2MTMxNQ==", "bodyText": "Seems unnecessary as we already have showThemedToast()", "url": "https://github.com/ankidroid/Anki-Android/pull/5755#discussion_r379861315", "createdAt": "2020-02-15T22:56:13Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/UIUtils.java", "diffHunk": "@@ -97,6 +97,13 @@ public static Snackbar showSnackbar(Activity activity, String mainText, int leng\n     }\n \n \n+    public static void showToast(Context context, CharSequence text) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7470d5e6467b5acbc959bf4fc681c81f1a2a3db4"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "418f62f5683bc2dae434e770df12d178ffbbe86f", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/418f62f5683bc2dae434e770df12d178ffbbe86f", "committedDate": "2020-02-16T14:00:03Z", "message": "Add showToast as a general UIUtils method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dccb6d9023f11d4684f9eed24484c465a29331d1", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/dccb6d9023f11d4684f9eed24484c465a29331d1", "committedDate": "2020-02-16T14:00:13Z", "message": "Add missing copyright header to audio clip controller"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78d8fd559c7c836afffd73d3caae1470aee77528", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/78d8fd559c7c836afffd73d3caae1470aee77528", "committedDate": "2020-02-16T14:04:06Z", "message": "Improve file copy / error handling for audio clips"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eca8b32e5d28d9e6541fadced415cfada57ab5b5", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/eca8b32e5d28d9e6541fadced415cfada57ab5b5", "committedDate": "2020-02-16T14:06:23Z", "message": "Avoid crashing on missing or oddly named audio clips\n\nFixes #5509"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7470d5e6467b5acbc959bf4fc681c81f1a2a3db4", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7470d5e6467b5acbc959bf4fc681c81f1a2a3db4", "committedDate": "2020-02-15T15:46:15Z", "message": "Avoid crashing on missing or oddly named audio clips\n\nFixes #5509"}, "afterCommit": {"oid": "eca8b32e5d28d9e6541fadced415cfada57ab5b5", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/eca8b32e5d28d9e6541fadced415cfada57ab5b5", "committedDate": "2020-02-16T14:06:23Z", "message": "Avoid crashing on missing or oddly named audio clips\n\nFixes #5509"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3676, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}