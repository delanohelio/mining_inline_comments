{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk5OTM2NjUx", "number": 5942, "title": "Add Disable Extended Text UI Preference", "bodyText": "Purpose / Description\nThis allows 'Cloze Deletion' to be shown in Landscape mode.\nFixes\nFixes #5533\nApproach\nWe pass a flag to the IME to disable the Extended Text UI\nHow Has This Been Tested?\nOn my Android with GBoard\n\nLearning (optional, can help others)\nhttps://stackoverflow.com/a/23367951\nChecklist\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-04-06T22:22:46Z", "url": "https://github.com/ankidroid/Anki-Android/pull/5942", "merged": true, "mergeCommit": {"oid": "29170861da5f0b2b1adf364723cf484f744216de"}, "closed": true, "closedAt": "2020-04-10T19:05:04Z", "author": {"login": "david-allison-1"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVGXnZgFqTM4ODY2MDQ5NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWU7EPAFqTM5MTU3NjYzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NjYwNDk1", "url": "https://github.com/ankidroid/Anki-Android/pull/5942#pullrequestreview-388660495", "createdAt": "2020-04-06T22:23:43Z", "commit": {"oid": "a41f71e68c3176e8b60943de89c67af3597a7bf5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMjoyMzo0M1rOGBsIHQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMjoyMzo0M1rOGBsIHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQyNDczMw==", "bodyText": "This is intentionally inconsistent with the default setting.\nI wasn't sure which one to pick, but it's up for discussion and we should standardise both before this gets in.", "url": "https://github.com/ankidroid/Anki-Android/pull/5942#discussion_r404424733", "createdAt": "2020-04-06T22:23:43Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/FieldEditText.java", "diffHunk": "@@ -42,6 +49,25 @@ public Parcelable onSaveInstanceState() {\n         return null;\n     }\n \n+    @Override\n+    protected void onAttachedToWindow() {\n+        super.onAttachedToWindow();\n+        if (shouldDisableExtendedTextUi()) {\n+            Timber.i(\"Disabling Extended Text UI\");\n+            this.setImeOptions(this.getImeOptions() | IME_FLAG_NO_EXTRACT_UI);\n+        }\n+    }\n+\n+    private boolean shouldDisableExtendedTextUi() {\n+        try {\n+            SharedPreferences sp = PreferenceManager.getDefaultSharedPreferences(this.getContext());\n+            return sp.getBoolean(\"disableExtendedTextUi\", false);\n+        } catch (Exception e) {\n+            Timber.e(e, \"Failed to get extended UI preference\");\n+            return false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a41f71e68c3176e8b60943de89c67af3597a7bf5"}, "originalPosition": 41}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a41f71e68c3176e8b60943de89c67af3597a7bf5", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/a41f71e68c3176e8b60943de89c67af3597a7bf5", "committedDate": "2020-04-06T22:20:12Z", "message": "Add Disable Extended Text UI Preference\n\n#5533\n\nThis allows 'Cloze Deletion' to be shown in Landscape mode."}, "afterCommit": {"oid": "bfaea22562ac58afcb4411fecfa16343a3d9667c", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/bfaea22562ac58afcb4411fecfa16343a3d9667c", "committedDate": "2020-04-06T22:27:50Z", "message": "Add Disable Extended Text UI Preference\n\n#5533\n\nThis allows 'Cloze Deletion' to be shown in Landscape mode."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg4NjYzMDUw", "url": "https://github.com/ankidroid/Anki-Android/pull/5942#pullrequestreview-388663050", "createdAt": "2020-04-06T22:29:13Z", "commit": {"oid": "a41f71e68c3176e8b60943de89c67af3597a7bf5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMjoyOToyOFrOGBsRDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMjoyOToyOFrOGBsRDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQyNzAyMA==", "bodyText": "I think should default to false. The reason the edit field goes full screen in landscape is because it's really useful for any sort of edit by anyone, whereas cloze is not used by that many. So I think default to false wins if you weigh proportion of use cases, plus principle of least surprise is to not change behavior", "url": "https://github.com/ankidroid/Anki-Android/pull/5942#discussion_r404427020", "createdAt": "2020-04-06T22:29:28Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/res/xml/preferences_advanced.xml", "diffHunk": "@@ -67,6 +67,12 @@\n                 android:key=\"fixHebrewText\"\n                 android:summary=\"@string/fix_hebrew_text_summ\"\n                 android:title=\"@string/fix_hebrew_text\" />\n+            <!-- Workaround for #5533 -->\n+            <CheckBoxPreference\n+                android:defaultValue=\"true\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bfaea22562ac58afcb4411fecfa16343a3d9667c"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46c3539f46edb7095b284da690873e73caa25919", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/46c3539f46edb7095b284da690873e73caa25919", "committedDate": "2020-04-06T22:38:02Z", "message": "Add Disable Extended Text UI Preference\n\n#5533\n\nThis allows 'Cloze Deletion' to be shown in Landscape mode."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bfaea22562ac58afcb4411fecfa16343a3d9667c", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/bfaea22562ac58afcb4411fecfa16343a3d9667c", "committedDate": "2020-04-06T22:27:50Z", "message": "Add Disable Extended Text UI Preference\n\n#5533\n\nThis allows 'Cloze Deletion' to be shown in Landscape mode."}, "afterCommit": {"oid": "46c3539f46edb7095b284da690873e73caa25919", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/46c3539f46edb7095b284da690873e73caa25919", "committedDate": "2020-04-06T22:38:02Z", "message": "Add Disable Extended Text UI Preference\n\n#5533\n\nThis allows 'Cloze Deletion' to be shown in Landscape mode."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNTc2NjM3", "url": "https://github.com/ankidroid/Anki-Android/pull/5942#pullrequestreview-391576637", "createdAt": "2020-04-10T17:55:02Z", "commit": {"oid": "46c3539f46edb7095b284da690873e73caa25919"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3594, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}