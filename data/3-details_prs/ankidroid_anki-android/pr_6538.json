{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4NjkwNjU3", "number": 6538, "title": "Deck name in node", "bodyText": "Pull Request template\nPurpose / Description\nThe whole story is #6481\nThe short story of this PR is that mName makes NO\u00a0sens. For a deck \"A::B::C\", it's value is {\"A::B::C\"}, then {\"A\", \"B\", \"C\"} then {\"B\", \"C\"}, and finally {\"C\"}.\nInstead of giving multiple meaning to the same parameter, I just:\n\nput a variable mName, which is final and set to \"A::B::C\"\nput a variable mSplittedName which is final and set to {\"A::B::C\"}\nuse method with proper name (as suggested in #6522 (comment) ) to get the part of the name we want, i.e. last part of the name to display in the deck picker, full name in the card content provider.\n\nFixes\n\nConfusing method getName which returns very different result depending on which function created the object\nFor a deck of depth n, copying its array n times\nhopefully, decrease the complexity of #6522\n\nApproach\nHow does this change address the problem?\nHow Has This Been Tested?\n\nRunning on my phone\ndeck tests ensure that the name obtained by col.getDecks().get and the deck name obtained through this object are the same. This is tested with nested decks", "createdAt": "2020-06-23T16:41:12Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6538", "merged": true, "mergeCommit": {"oid": "feb4ff357d1cef63a3f673f985782bb0b0a42ae2"}, "closed": true, "closedAt": "2020-06-26T20:33:42Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuIdmNABqjM0NzM5MTI3MjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcvBxfUgFqTQzODIyODI5Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c4930e22ba0ddf9fb4b9f683188ef69b908fe98c", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/c4930e22ba0ddf9fb4b9f683188ef69b908fe98c", "committedDate": "2020-06-23T16:35:45Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "6f8f536c418388ff794d61d799d5d3bbe737e252", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/6f8f536c418388ff794d61d799d5d3bbe737e252", "committedDate": "2020-06-23T16:58:02Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1OTkzMzQy", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#pullrequestreview-435993342", "createdAt": "2020-06-23T17:19:25Z", "commit": {"oid": "36a754b4f1d682289b428833019933435818a3c2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNzoxOToyNlrOGnzEPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yM1QxNzoxOToyNlrOGnzEPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDM4NDMxNw==", "bodyText": "I like this change a lot I think it makes it more clear to reason about the name, certainly.\nNow I'm going to propose a change that will touch every line of the PR just about, but is also a simple rename refactor in Android Studio :-), \"Splitted\" is not a valid word in English, and the variable really represents an array of the variable's components, so perhaps:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    private String[] mSplittedName;\n          \n          \n            \n                    private String[] mNameComponents;", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r444384317", "createdAt": "2020-06-23T17:19:26Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -178,29 +178,25 @@\n      * this field and use getNamePart(0) for those cases.\n      */\n     public class DeckDueTreeNode implements Comparable {\n-        private String[] mName;\n+        private final String mName;\n+        private String[] mSplittedName;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36a754b4f1d682289b428833019933435818a3c2"}, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f8f536c418388ff794d61d799d5d3bbe737e252", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/6f8f536c418388ff794d61d799d5d3bbe737e252", "committedDate": "2020-06-23T16:58:02Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "f68cf5505f79c5390270318ac64ac0496a8a6fd6", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f68cf5505f79c5390270318ac64ac0496a8a6fd6", "committedDate": "2020-06-23T17:28:48Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MDEzNzIx", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#pullrequestreview-436013721", "createdAt": "2020-06-23T17:42:57Z", "commit": {"oid": "f68cf5505f79c5390270318ac64ac0496a8a6fd6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f68cf5505f79c5390270318ac64ac0496a8a6fd6", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f68cf5505f79c5390270318ac64ac0496a8a6fd6", "committedDate": "2020-06-23T17:28:48Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "7b19c703a4ecddcf43d25409bb5445dce6d16a33", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7b19c703a4ecddcf43d25409bb5445dce6d16a33", "committedDate": "2020-06-23T19:35:20Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7b19c703a4ecddcf43d25409bb5445dce6d16a33", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7b19c703a4ecddcf43d25409bb5445dce6d16a33", "committedDate": "2020-06-23T19:35:20Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "91d6655605369a4a11c35f9d0c255c36f89b7b11", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/91d6655605369a4a11c35f9d0c255c36f89b7b11", "committedDate": "2020-06-23T20:12:47Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91d6655605369a4a11c35f9d0c255c36f89b7b11", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/91d6655605369a4a11c35f9d0c255c36f89b7b11", "committedDate": "2020-06-23T20:12:47Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "4ff76061cf21e4b30182c6a123be4655b1d471f8", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/4ff76061cf21e4b30182c6a123be4655b1d471f8", "committedDate": "2020-06-23T20:16:45Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MjQyMDQy", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#pullrequestreview-436242042", "createdAt": "2020-06-24T00:13:46Z", "commit": {"oid": "1423bb175853f8cadbc83ffca7dd2b37684271bb"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwMDoxMzo0NlrOGn-uYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQwMDoxMzo0NlrOGn-uYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDU3NTMzMQ==", "bodyText": "mName is final, and this is the only place we set it\nmNameComponents is built off mName, implying that it can be final as well, and should be set right here\nThen you don't need a method setNameComponents with a null check and worry about whether it is set or not", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r444575331", "createdAt": "2020-06-24T00:13:46Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -178,29 +177,25 @@\n      * this field and use getNamePart(0) for those cases.\n      */\n     public class DeckDueTreeNode implements Comparable {\n-        private String[] mName;\n+        private final String mName;\n+        private String[] mNameComponents;\n         private long mDid;\n-        private int mDepth;\n         private int mRevCount;\n         private int mLrnCount;\n         private int mNewCount;\n         private List<DeckDueTreeNode> mChildren = new ArrayList<>();\n \n-        public DeckDueTreeNode(String[] mName, long mDid, int mRevCount, int mLrnCount, int mNewCount) {\n+        public DeckDueTreeNode(String mName, long mDid, int mRevCount, int mLrnCount, int mNewCount) {\n             this.mName = mName;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1423bb175853f8cadbc83ffca7dd2b37684271bb"}, "originalPosition": 24}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4ff76061cf21e4b30182c6a123be4655b1d471f8", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/4ff76061cf21e4b30182c6a123be4655b1d471f8", "committedDate": "2020-06-23T20:16:45Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "5948c3c700bd7f2d85a707b3a25f23094cf0d7ac", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5948c3c700bd7f2d85a707b3a25f23094cf0d7ac", "committedDate": "2020-06-24T00:21:37Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5948c3c700bd7f2d85a707b3a25f23094cf0d7ac", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5948c3c700bd7f2d85a707b3a25f23094cf0d7ac", "committedDate": "2020-06-24T00:21:37Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "5cfb880edc5e628d582f5529c6c69c949b822610", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5cfb880edc5e628d582f5529c6c69c949b822610", "committedDate": "2020-06-24T19:22:28Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f87580d38db17cbcf6a5c4245e2012945de72984", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f87580d38db17cbcf6a5c4245e2012945de72984", "committedDate": "2020-06-24T21:35:49Z", "message": "NF: compute loop size outside of loop"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19137685dd646f8bd0056075198b28984485d9da", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/19137685dd646f8bd0056075198b28984485d9da", "committedDate": "2020-06-24T21:39:07Z", "message": "NF: rename getNamePart into getDeckNameComponent\n\nI don't know why and how the wrong name was commited into master"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5cfb880edc5e628d582f5529c6c69c949b822610", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5cfb880edc5e628d582f5529c6c69c949b822610", "committedDate": "2020-06-24T19:22:28Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "6612016658e5d458273f3ca1d435ade06d64906d", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/6612016658e5d458273f3ca1d435ade06d64906d", "committedDate": "2020-06-24T21:40:53Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6612016658e5d458273f3ca1d435ade06d64906d", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/6612016658e5d458273f3ca1d435ade06d64906d", "committedDate": "2020-06-24T21:40:53Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "fe384112ffda10d7b3de54190495f7affe51ac58", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/fe384112ffda10d7b3de54190495f7affe51ac58", "committedDate": "2020-06-24T21:42:39Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODgyNTc3", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#pullrequestreview-437882577", "createdAt": "2020-06-25T21:47:40Z", "commit": {"oid": "bbf24faff866340d6cc2729499f0620f0ee736f9"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMTo0Nzo0MFrOGpM-PA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMTo0Nzo0MFrOGpM-PA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg1NzM0MA==", "bodyText": "(this comment was duplicated below in your commit for Sched, for SchedV2 it was missing before so nothing to do there)\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        // Compose the \"children\" node list. The children is a list of all the nodes that proceed\n          \n          \n            \n                        // the current one that contain the same name[0], except for the current one itself.\n          \n          \n            \n                        // I.e., they are subdecks that stem from this node.\n          \n          \n            \n                        // This is our version of python's itertools.groupby.", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r445857340", "createdAt": "2020-06-25T21:47:40Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/Sched.java", "diffHunk": "@@ -245,21 +245,27 @@ private void unburyCardsForDeck(List<Long> allDecks) {\n \n \n     @Override\n-    protected List<DeckDueTreeNode> _groupChildrenMain(List<DeckDueTreeNode> grps) {\n+    protected List<DeckDueTreeNode> _groupChildrenMain(List<DeckDueTreeNode> grps, int depth) {\n         List<DeckDueTreeNode> tree = new ArrayList<>();\n         // group and recurse\n         ListIterator<DeckDueTreeNode> it = grps.listIterator();\n         while (it.hasNext()) {\n             DeckDueTreeNode node = it.next();\n-            String head = node.getDeckNameComponent(0);\n+            String head = node.getDeckNameComponent(depth);\n             // Compose the \"children\" node list. The children is a list of all the nodes that proceed\n             // the current one that contain the same name[0], except for the current one itself.\n             // I.e., they are subdecks that stem from this node.\n             // This is our version of python's itertools.groupby.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bbf24faff866340d6cc2729499f0620f0ee736f9"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODgzNTI1", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#pullrequestreview-437883525", "createdAt": "2020-06-25T21:49:18Z", "commit": {"oid": "fe384112ffda10d7b3de54190495f7affe51ac58"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3ODkwNjM5", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#pullrequestreview-437890639", "createdAt": "2020-06-25T22:03:07Z", "commit": {"oid": "fe384112ffda10d7b3de54190495f7affe51ac58"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMjowMzowN1rOGpNXvQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNVQyMjoxMDo0M1rOGpNjEw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg2Mzg2OQ==", "bodyText": "Wold be nice to have a comment on both of these methods giving an example of what they return", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r445863869", "createdAt": "2020-06-25T22:03:07Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -230,32 +228,28 @@ public int compareTo(Object other) {\n \n         @Override\n         public String toString() {\n-            return String.format(Locale.US, \"%s, %d, %d, %d, %d, %d, %s\",\n-                    Arrays.toString(mName), mDid, mDepth, mRevCount, mLrnCount, mNewCount, mChildren);\n+            return String.format(Locale.US, \"%s, %d, %d, %d, %d, %s\",\n+                    mName, mDid, mRevCount, mLrnCount, mNewCount, mChildren);\n         }\n \n-        public String[] getNames() {\n+        public String getFullDeckName() {\n             return mName;\n         }\n \n-        public String getNamePart(int part) {\n-            return mName[part];\n+        public String getDeckNameComponent(int part) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe384112ffda10d7b3de54190495f7affe51ac58"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg2NjMzOQ==", "bodyText": "Could you @NonNull this", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r445866339", "createdAt": "2020-06-25T22:09:36Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -178,29 +178,26 @@\n      * this field and use getNamePart(0) for those cases.\n      */\n     public class DeckDueTreeNode implements Comparable {\n-        private String[] mName;\n+        private final String mName;\n+        private final String[] mNameComponents;\n         private long mDid;\n-        private int mDepth;\n         private int mRevCount;\n         private int mLrnCount;\n         private int mNewCount;\n         private List<DeckDueTreeNode> mChildren = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe384112ffda10d7b3de54190495f7affe51ac58"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg2Njc3MQ==", "bodyText": "Do we have the Android API to use Comparable<T> here?", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r445866771", "createdAt": "2020-06-25T22:10:43Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -178,29 +178,26 @@\n      * this field and use getNamePart(0) for those cases.\n      */\n     public class DeckDueTreeNode implements Comparable {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fe384112ffda10d7b3de54190495f7affe51ac58"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fe384112ffda10d7b3de54190495f7affe51ac58", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/fe384112ffda10d7b3de54190495f7affe51ac58", "committedDate": "2020-06-24T21:42:39Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "665bfdfff617291e88879ed62e41cc630133d1fb", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/665bfdfff617291e88879ed62e41cc630133d1fb", "committedDate": "2020-06-25T23:43:25Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "665bfdfff617291e88879ed62e41cc630133d1fb", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/665bfdfff617291e88879ed62e41cc630133d1fb", "committedDate": "2020-06-25T23:43:25Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "46fb40b4fd6f6f83d4386653c895f1e995d6ec10", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/46fb40b4fd6f6f83d4386653c895f1e995d6ec10", "committedDate": "2020-06-25T23:49:53Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3OTQwMzM0", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#pullrequestreview-437940334", "createdAt": "2020-06-26T00:17:17Z", "commit": {"oid": "46fb40b4fd6f6f83d4386653c895f1e995d6ec10"}, "state": "APPROVED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMDoxNzoxN1rOGpP5vA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNlQwMDoyMjo1NVrOGpP-0w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNTM0MA==", "bodyText": "The *s in the comment seems irregular", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r445905340", "createdAt": "2020-06-26T00:17:17Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -270,10 +286,17 @@ public int getLrnCount() {\n             return mLrnCount;\n         }\n \n+        /** \n+         * @return The children of this deck. Note that they are set\n+         in the * data structure returned by DeckDueTree but are", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46fb40b4fd6f6f83d4386653c895f1e995d6ec10"}, "originalPosition": 143}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNTUzNQ==", "bodyText": "A doccomment is for one method, so try to avoid referencing other methods", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r445905535", "createdAt": "2020-06-26T00:18:09Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -230,34 +228,52 @@ public int compareTo(Object other) {\n \n         @Override\n         public String toString() {\n-            return String.format(Locale.US, \"%s, %d, %d, %d, %d, %d, %s\",\n-                    Arrays.toString(mName), mDid, mDepth, mRevCount, mLrnCount, mNewCount, mChildren);\n+            return String.format(Locale.US, \"%s, %d, %d, %d, %d, %s\",\n+                    mName, mDid, mRevCount, mLrnCount, mNewCount, mChildren);\n         }\n \n-        public String[] getNames() {\n+        /** \n+         * @return The full deck name, e.g. \"A::B::C\"\n+         * */\n+        public String getFullDeckName() {\n             return mName;\n         }\n \n-        public String getNamePart(int part) {\n-            return mName[part];\n+        /** \n+         * For deck \"A::B::C\", `getDeckNameComponent(0)` returns \"A\",\n+         * `getDeckNameComponent(1)` returns \"B\", etc...\n+         */\n+        public String getDeckNameComponent(int part) {\n+            return mNameComponents[part];\n         }\n-        \n-        public void setNames(String[] mName) {\n-            this.mName = mName;\n+\n+        /** \n+         * The part of the name displayed in deck picker, i.e. the\n+         * part that does not belong to its parents. E.g.  for deck\n+         * \"A::B::C\", returns \"C\".\n+         */\n+        public String getLastDeckNameComponent() {\n+            return getDeckNameComponent(getDepth());\n         }\n \n         public long getDid() {\n             return mDid;\n         }\n \n+        /** \n+         * @return The depth of a deck. Top level decks have depth 0,\n+         * their children have depth 1, etc... So \"A::B::C\" would have\n+         * depth 2.\n+         */\n         public int getDepth() {\n-            return mDepth;\n-        }\n-\n-        public void setDepth(int mDepth) {\n-            this.mDepth = mDepth;\n+            return mNameComponents.length - 1;\n         }\n \n+        /** The three following methods return the numbers to be", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46fb40b4fd6f6f83d4386653c895f1e995d6ec10"}, "originalPosition": 129}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNTU4Ng==", "bodyText": "Not relevant to the PR, let's remove it", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r445905586", "createdAt": "2020-06-26T00:18:26Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -230,34 +228,52 @@ public int compareTo(Object other) {\n \n         @Override\n         public String toString() {\n-            return String.format(Locale.US, \"%s, %d, %d, %d, %d, %d, %s\",\n-                    Arrays.toString(mName), mDid, mDepth, mRevCount, mLrnCount, mNewCount, mChildren);\n+            return String.format(Locale.US, \"%s, %d, %d, %d, %d, %s\",\n+                    mName, mDid, mRevCount, mLrnCount, mNewCount, mChildren);\n         }\n \n-        public String[] getNames() {\n+        /** \n+         * @return The full deck name, e.g. \"A::B::C\"\n+         * */\n+        public String getFullDeckName() {\n             return mName;\n         }\n \n-        public String getNamePart(int part) {\n-            return mName[part];\n+        /** \n+         * For deck \"A::B::C\", `getDeckNameComponent(0)` returns \"A\",\n+         * `getDeckNameComponent(1)` returns \"B\", etc...\n+         */\n+        public String getDeckNameComponent(int part) {\n+            return mNameComponents[part];\n         }\n-        \n-        public void setNames(String[] mName) {\n-            this.mName = mName;\n+\n+        /** \n+         * The part of the name displayed in deck picker, i.e. the\n+         * part that does not belong to its parents. E.g.  for deck\n+         * \"A::B::C\", returns \"C\".\n+         */\n+        public String getLastDeckNameComponent() {\n+            return getDeckNameComponent(getDepth());\n         }\n \n         public long getDid() {\n             return mDid;\n         }\n \n+        /** \n+         * @return The depth of a deck. Top level decks have depth 0,\n+         * their children have depth 1, etc... So \"A::B::C\" would have\n+         * depth 2.\n+         */\n         public int getDepth() {\n-            return mDepth;\n-        }\n-\n-        public void setDepth(int mDepth) {\n-            this.mDepth = mDepth;\n+            return mNameComponents.length - 1;\n         }\n \n+        /** The three following methods return the numbers to be", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNTUzNQ=="}, "originalCommit": {"oid": "46fb40b4fd6f6f83d4386653c895f1e995d6ec10"}, "originalPosition": 129}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNjAzOA==", "bodyText": "I don't understand why you're referencing the android API.\nThe scheduler sorts a list of DeckDueTreeNode and uses the fact that the nodes are comparable.\nI can write Comparable<DeckDueTreeNode> if you prefer. I have not touched this line but it would not be hard to add it\n\nUsually the reason we're not using a \"better\" API is due to us referencing API 16. I was wondering if this was the rationale behind not using the correct Comparable", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r445906038", "createdAt": "2020-06-26T00:20:24Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -178,29 +178,26 @@\n      * this field and use getNamePart(0) for those cases.\n      */\n     public class DeckDueTreeNode implements Comparable {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg2Njc3MQ=="}, "originalCommit": {"oid": "fe384112ffda10d7b3de54190495f7affe51ac58"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTkwNjY0Mw==", "bodyText": "I thought it was set implicitly in both constructors?", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#discussion_r445906643", "createdAt": "2020-06-26T00:22:55Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/AbstractSched.java", "diffHunk": "@@ -178,29 +178,26 @@\n      * this field and use getNamePart(0) for those cases.\n      */\n     public class DeckDueTreeNode implements Comparable {\n-        private String[] mName;\n+        private final String mName;\n+        private final String[] mNameComponents;\n         private long mDid;\n-        private int mDepth;\n         private int mRevCount;\n         private int mLrnCount;\n         private int mNewCount;\n         private List<DeckDueTreeNode> mChildren = new ArrayList<>();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTg2NjMzOQ=="}, "originalCommit": {"oid": "fe384112ffda10d7b3de54190495f7affe51ac58"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM3OTU5MDI2", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#pullrequestreview-437959026", "createdAt": "2020-06-26T01:24:54Z", "commit": {"oid": "46fb40b4fd6f6f83d4386653c895f1e995d6ec10"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c695bf9f3f178f23a174c4026a9cfa44021e412", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/4c695bf9f3f178f23a174c4026a9cfa44021e412", "committedDate": "2020-06-26T01:35:07Z", "message": "NF: DeckDueTree avoid changing names"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e5882cbdd2d0225cbbc516fb246fd9faf712e723", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/e5882cbdd2d0225cbbc516fb246fd9faf712e723", "committedDate": "2020-06-26T01:35:08Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "46fb40b4fd6f6f83d4386653c895f1e995d6ec10", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/46fb40b4fd6f6f83d4386653c895f1e995d6ec10", "committedDate": "2020-06-25T23:49:53Z", "message": "NF: processNodes don't need depth variable"}, "afterCommit": {"oid": "e5882cbdd2d0225cbbc516fb246fd9faf712e723", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/e5882cbdd2d0225cbbc516fb246fd9faf712e723", "committedDate": "2020-06-26T01:35:08Z", "message": "NF: processNodes don't need depth variable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM4MjI4Mjk3", "url": "https://github.com/ankidroid/Anki-Android/pull/6538#pullrequestreview-438228297", "createdAt": "2020-06-26T11:44:29Z", "commit": {"oid": "e5882cbdd2d0225cbbc516fb246fd9faf712e723"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2999, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}