{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5MzA5OTAz", "number": 6911, "title": "Don't offer to type answer if there is no front", "bodyText": "My goal is to preload card as much as possible. This mean pre rendering html before actually needing to show it, in particular mathjax and loading media. This also mean that I need to deal with sound outside of the AbstractFlashCard Viewer. I believe that doing simple cleaning is a good first step to attain this goal easily.\nMy point is that I'm not just doing refactoring for the sake of cleaning.\u00a0I am doing it because I've got a goal in mind and that I expect that this will help reach it.\nIn this case, what I want is to get the display string without having to directly show it.\nAs a side note, it ensures that if the card is empty, set answer field is set to Gone", "createdAt": "2020-08-18T08:56:42Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6911", "merged": true, "mergeCommit": {"oid": "3de8fd297f870a6625a536c115a40f0380342782"}, "closed": true, "closedAt": "2020-09-19T13:22:21Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdAHoS3gFqTQ2OTQ5NDQ4MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdKaHTNgFqTQ5MTk5ODQyOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NDk0NDgx", "url": "https://github.com/ankidroid/Anki-Android/pull/6911#pullrequestreview-469494481", "createdAt": "2020-08-18T14:10:34Z", "commit": {"oid": "44fa5768a4e8ad703d8b5af028c93c1cb1741f7e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNDoxMDozNVrOHCWbxw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNDoxMDozNVrOHCWbxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjIyNjc1OQ==", "bodyText": "The rest seems fine but I do not understand this import, it does not appear to be used in this PR, either this commit or following ones?", "url": "https://github.com/ankidroid/Anki-Android/pull/6911#discussion_r472226759", "createdAt": "2020-08-18T14:10:35Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Card.java", "diffHunk": "@@ -22,6 +22,7 @@\n import android.database.Cursor;\n import android.text.TextUtils;\n \n+import com.ichi2.anki.cardviewer.CardAppearance;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44fa5768a4e8ad703d8b5af028c93c1cb1741f7e"}, "originalPosition": 4}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5MTc1NjIy", "url": "https://github.com/ankidroid/Anki-Android/pull/6911#pullrequestreview-469175622", "createdAt": "2020-08-18T10:00:38Z", "commit": {"oid": "83647dd633e1c58c8529e2da515cebfd8053da70"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMDowMDozOFrOHCMakQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxMDowNToxNlrOHCMkIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA2MjYwOQ==", "bodyText": "This is duplicated", "url": "https://github.com/ankidroid/Anki-Android/pull/6911#discussion_r472062609", "createdAt": "2020-08-18T10:00:38Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -1956,36 +1956,43 @@ protected void displayCardQuestion() {\n         jsApiInit();\n     }\n \n-    protected void displayCardQuestion(boolean reload) {\n-        Timber.d(\"displayCardQuestion()\");\n-        sDisplayAnswer = false;\n-\n-        setInterface();\n-\n-        String question;\n-        String displayString = \"\";\n+    private String displayString(boolean reload) {\n         if (mCurrentCard.isEmpty()) {\n-            displayString = getResources().getString(R.string.empty_card_warning);\n+            return getResources().getString(R.string.empty_card_warning);\n         } else {\n-            question = mCurrentCard.q(reload);\n+            String question = mCurrentCard.q(reload);\n             question = getCol().getMedia().escapeImages(question);\n             question = typeAnsQuestionFilter(question);\n \n             Timber.v(\"question: '%s'\", question);\n-            // Show text entry based on if the user wants to write the answer\n-            if (typeAnswer()) {\n-                mAnswerField.setVisibility(View.VISIBLE);\n-            } else {\n-                mAnswerField.setVisibility(View.GONE);\n-            }\n \n-            displayString = CardAppearance.enrichWithQADiv(question, false);\n+            return CardAppearance.enrichWithQADiv(question, false);\n \n             //if (mSpeakText) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83647dd633e1c58c8529e2da515cebfd8053da70"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA2Mjc2NA==", "bodyText": "This is not required", "url": "https://github.com/ankidroid/Anki-Android/pull/6911#discussion_r472062764", "createdAt": "2020-08-18T10:00:54Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Card.java", "diffHunk": "@@ -22,6 +22,7 @@\n import android.database.Cursor;\n import android.text.TextUtils;\n \n+import com.ichi2.anki.cardviewer.CardAppearance;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83647dd633e1c58c8529e2da515cebfd8053da70"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjA2NTA1OA==", "bodyText": "Could you comment what this is for", "url": "https://github.com/ankidroid/Anki-Android/pull/6911#discussion_r472065058", "createdAt": "2020-08-18T10:05:16Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -1956,30 +1956,40 @@ protected void displayCardQuestion() {\n         jsApiInit();\n     }\n \n-    protected void displayCardQuestion(boolean reload) {\n-        Timber.d(\"displayCardQuestion()\");\n-        sDisplayAnswer = false;\n-\n-        setInterface();\n-\n-        String displayString = \"\";\n+    private String displayString(boolean reload) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "44fa5768a4e8ad703d8b5af028c93c1cb1741f7e"}, "originalPosition": 11}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83647dd633e1c58c8529e2da515cebfd8053da70", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/83647dd633e1c58c8529e2da515cebfd8053da70", "committedDate": "2020-08-18T08:48:01Z", "message": "Empty card don't show answer field"}, "afterCommit": {"oid": "f1e08a2b1bdcdefb81c07d032af0c12ea9cbecfa", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f1e08a2b1bdcdefb81c07d032af0c12ea9cbecfa", "committedDate": "2020-08-18T17:42:06Z", "message": "Empty card don't show answer field"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1293974fef9afe05cdabef7b933c87ed4870f3c0", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/1293974fef9afe05cdabef7b933c87ed4870f3c0", "committedDate": "2020-09-07T17:17:04Z", "message": "NF: move declaration in block"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "688904f213dce6a0fec0ca94d5d767f248933e3b", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/688904f213dce6a0fec0ca94d5d767f248933e3b", "committedDate": "2020-09-07T17:17:55Z", "message": "NF: displayString as a separate method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f638d1025008989c883aa0e726985bd128174442", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f638d1025008989c883aa0e726985bd128174442", "committedDate": "2020-09-07T17:17:55Z", "message": "Empty card don't show answer field"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f1e08a2b1bdcdefb81c07d032af0c12ea9cbecfa", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f1e08a2b1bdcdefb81c07d032af0c12ea9cbecfa", "committedDate": "2020-08-18T17:42:06Z", "message": "Empty card don't show answer field"}, "afterCommit": {"oid": "f638d1025008989c883aa0e726985bd128174442", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f638d1025008989c883aa0e726985bd128174442", "committedDate": "2020-09-07T17:17:55Z", "message": "Empty card don't show answer field"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkxOTk4NDI5", "url": "https://github.com/ankidroid/Anki-Android/pull/6911#pullrequestreview-491998429", "createdAt": "2020-09-19T13:21:59Z", "commit": {"oid": "f638d1025008989c883aa0e726985bd128174442"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2944, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}