{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwOTA1NjQ0", "number": 6686, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMDo0Mjo1M1rOEPfLWQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMDo0MzowNlrOEPfLkA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0Njc0OTA1OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/Sched.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMDo0Mjo1M1rOGzOWlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMzo1ODoxM1rOGzUFdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM2NTcxNw==", "bodyText": "This changes functionality if ja has more than 2 elements.", "url": "https://github.com/ankidroid/Anki-Android/pull/6686#discussion_r456365717", "createdAt": "2020-07-17T10:42:53Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/Sched.java", "diffHunk": "@@ -1224,11 +1224,10 @@ protected void _updateCutoff() {\n     protected void update(JSONObject g) {\n         for (String t : new String[] { \"new\", \"rev\", \"lrn\", \"time\" }) {\n             String key = t + \"Today\";\n+            JSONArray ja = g.getJSONArray(key);\n             if (g.getJSONArray(key).getInt(0) != mToday) {\n-                JSONArray ja = new JSONArray();\n-                ja.put(mToday);\n-                ja.put(0);\n-                g.put(key, ja);\n+                ja.put(0, mToday);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35141120957a0e7c09f9df999692d066a73b51c0"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM3OTQzNQ==", "bodyText": "ja is never supposed to have more than two elements. If ja has more than two elements there is a bigger problem, which is that the json was broke somewhere. Normally, ja is a pair, not a list.\nAccording to our wiki:\n\nnewToday/revToday/lrnToday : two number array.\nFirst one is the number of days that have passed between the collection was created and the deck was last updated\nThe second one is equal to the number of cards seen today in this deck minus the number of new cards in custom study today.\nBEWARE, it's changed in anki.sched(v2).Scheduler._updateStats and anki.sched(v2).Scheduler._updateCutoff.update  but can't be found by grepping 'newToday', because it's instead written as type+\"Today\" with type which may be new/rev/lrnToday", "url": "https://github.com/ankidroid/Anki-Android/pull/6686#discussion_r456379435", "createdAt": "2020-07-17T11:16:02Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/Sched.java", "diffHunk": "@@ -1224,11 +1224,10 @@ protected void _updateCutoff() {\n     protected void update(JSONObject g) {\n         for (String t : new String[] { \"new\", \"rev\", \"lrn\", \"time\" }) {\n             String key = t + \"Today\";\n+            JSONArray ja = g.getJSONArray(key);\n             if (g.getJSONArray(key).getInt(0) != mToday) {\n-                JSONArray ja = new JSONArray();\n-                ja.put(mToday);\n-                ja.put(0);\n-                g.put(key, ja);\n+                ja.put(0, mToday);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM2NTcxNw=="}, "originalCommit": {"oid": "35141120957a0e7c09f9df999692d066a73b51c0"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxNzI4OQ==", "bodyText": "Do you feel \"replace\", or \"keep the other values\" will be better for backwards compatibility?\nIf we're using the Array as an Object (index -> property), then we'd be best to keep the other values and this change is correct.", "url": "https://github.com/ankidroid/Anki-Android/pull/6686#discussion_r456417289", "createdAt": "2020-07-17T12:42:38Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/Sched.java", "diffHunk": "@@ -1224,11 +1224,10 @@ protected void _updateCutoff() {\n     protected void update(JSONObject g) {\n         for (String t : new String[] { \"new\", \"rev\", \"lrn\", \"time\" }) {\n             String key = t + \"Today\";\n+            JSONArray ja = g.getJSONArray(key);\n             if (g.getJSONArray(key).getInt(0) != mToday) {\n-                JSONArray ja = new JSONArray();\n-                ja.put(mToday);\n-                ja.put(0);\n-                g.put(key, ja);\n+                ja.put(0, mToday);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM2NTcxNw=="}, "originalCommit": {"oid": "35141120957a0e7c09f9df999692d066a73b51c0"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQ1OTYzOA==", "bodyText": "I can't easily imagine why we would want to delete a third value if it was introduced. It would not be read anywhere in our code, and any other code which would introduce such a value should probably be made assuming the third value may or may not disappear", "url": "https://github.com/ankidroid/Anki-Android/pull/6686#discussion_r456459638", "createdAt": "2020-07-17T13:58:13Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/Sched.java", "diffHunk": "@@ -1224,11 +1224,10 @@ protected void _updateCutoff() {\n     protected void update(JSONObject g) {\n         for (String t : new String[] { \"new\", \"rev\", \"lrn\", \"time\" }) {\n             String key = t + \"Today\";\n+            JSONArray ja = g.getJSONArray(key);\n             if (g.getJSONArray(key).getInt(0) != mToday) {\n-                JSONArray ja = new JSONArray();\n-                ja.put(mToday);\n-                ja.put(0);\n-                g.put(key, ja);\n+                ja.put(0, mToday);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM2NTcxNw=="}, "originalCommit": {"oid": "35141120957a0e7c09f9df999692d066a73b51c0"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0Njc0OTYwOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/SchedV2.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMDo0MzowNlrOGzOW4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMDo0MzowNlrOGzOW4w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM2NTc5NQ==", "bodyText": "ditto", "url": "https://github.com/ankidroid/Anki-Android/pull/6686#discussion_r456365795", "createdAt": "2020-07-17T10:43:06Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/sched/SchedV2.java", "diffHunk": "@@ -2019,11 +2017,10 @@ private int _daysSinceCreation() {\n     protected void update(JSONObject g) {\n         for (String t : new String[] { \"new\", \"rev\", \"lrn\", \"time\" }) {\n             String key = t + \"Today\";\n+            JSONArray ja = g.getJSONArray(key);\n             if (g.getJSONArray(key).getInt(0) != mToday) {\n-                JSONArray ja = new JSONArray();\n-                ja.put(mToday);\n-                ja.put(0);\n-                g.put(key, ja);\n+                ja.put(0, mToday);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35141120957a0e7c09f9df999692d066a73b51c0"}, "originalPosition": 21}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 128, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}