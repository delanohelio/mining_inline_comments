{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ0Mjk1NDMw", "number": 6609, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQxODoyNzo1MVrOELZjow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNVQxNDowMjozN1rOELd2KQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMzg4NTE1OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Finder.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQxODoyNzo1MVrOGs9Tsw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQyMDozNjowNVrOGs912g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5NDk5NQ==", "bodyText": "The binding between all the classes is unnecessary, you can always do CollectionTask.getInstance() to get the currently executing task, and we only do one at a time so this should work?", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449794995", "createdAt": "2020-07-04T18:27:51Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Finder.java", "diffHunk": "@@ -77,11 +77,22 @@ public Finder(Collection col) {\n \n     @CheckResult\n     public List<Long> findCards(String query, boolean _order) {\n-        return _findCards(query, _order);\n+        return findCards(query, _order, null);\n     }\n \n+    @CheckResult\n+    public List<Long> findCards(String query, boolean _order, CollectionTask task) {\n+        return _findCards(query, _order, task);\n+    }\n \n+\n+    @CheckResult\n     private List<Long> _findCards(String query, Object _order) {\n+        return _findCards(query, _order, null);\n+    }\n+\n+    @CheckResult\n+    private List<Long> _findCards(String query, Object _order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMDU5MA==", "bodyText": "Honestly, I would hope that one day we are able to do multiple task at the same time, so I believe getInstance should be avoided.", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449800590", "createdAt": "2020-07-04T19:49:55Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Finder.java", "diffHunk": "@@ -77,11 +77,22 @@ public Finder(Collection col) {\n \n     @CheckResult\n     public List<Long> findCards(String query, boolean _order) {\n-        return _findCards(query, _order);\n+        return findCards(query, _order, null);\n     }\n \n+    @CheckResult\n+    public List<Long> findCards(String query, boolean _order, CollectionTask task) {\n+        return _findCards(query, _order, task);\n+    }\n \n+\n+    @CheckResult\n     private List<Long> _findCards(String query, Object _order) {\n+        return _findCards(query, _order, null);\n+    }\n+\n+    @CheckResult\n+    private List<Long> _findCards(String query, Object _order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5NDk5NQ=="}, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMDc4NA==", "bodyText": "If and when that happens it will be a cross-cutting infrastructure plan and the migration (maybe an API change like this? Maybe something else) would be all at once. That said I just searched for other users of getInstance and there are actually zero other callers! So, you have a point. I'll accept this API change then if you add one more commit to kill the CollectionTask.getInstance method so we are committed to the direction. If I am understanding things correctly this is a trivial request - if I am mistaken and there other users I don't intend for this to spiral out into a big change so I'd just use it", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449800784", "createdAt": "2020-07-04T19:52:45Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Finder.java", "diffHunk": "@@ -77,11 +77,22 @@ public Finder(Collection col) {\n \n     @CheckResult\n     public List<Long> findCards(String query, boolean _order) {\n-        return _findCards(query, _order);\n+        return findCards(query, _order, null);\n     }\n \n+    @CheckResult\n+    public List<Long> findCards(String query, boolean _order, CollectionTask task) {\n+        return _findCards(query, _order, task);\n+    }\n \n+\n+    @CheckResult\n     private List<Long> _findCards(String query, Object _order) {\n+        return _findCards(query, _order, null);\n+    }\n+\n+    @CheckResult\n+    private List<Long> _findCards(String query, Object _order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5NDk5NQ=="}, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMTQ2NQ==", "bodyText": "Done", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449801465", "createdAt": "2020-07-04T20:02:10Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Finder.java", "diffHunk": "@@ -77,11 +77,22 @@ public Finder(Collection col) {\n \n     @CheckResult\n     public List<Long> findCards(String query, boolean _order) {\n-        return _findCards(query, _order);\n+        return findCards(query, _order, null);\n     }\n \n+    @CheckResult\n+    public List<Long> findCards(String query, boolean _order, CollectionTask task) {\n+        return _findCards(query, _order, task);\n+    }\n \n+\n+    @CheckResult\n     private List<Long> _findCards(String query, Object _order) {\n+        return _findCards(query, _order, null);\n+    }\n+\n+    @CheckResult\n+    private List<Long> _findCards(String query, Object _order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5NDk5NQ=="}, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMjM4NA==", "bodyText": "I think the commit went on a different PR somehow?", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449802384", "createdAt": "2020-07-04T20:15:26Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Finder.java", "diffHunk": "@@ -77,11 +77,22 @@ public Finder(Collection col) {\n \n     @CheckResult\n     public List<Long> findCards(String query, boolean _order) {\n-        return _findCards(query, _order);\n+        return findCards(query, _order, null);\n     }\n \n+    @CheckResult\n+    public List<Long> findCards(String query, boolean _order, CollectionTask task) {\n+        return _findCards(query, _order, task);\n+    }\n \n+\n+    @CheckResult\n     private List<Long> _findCards(String query, Object _order) {\n+        return _findCards(query, _order, null);\n+    }\n+\n+    @CheckResult\n+    private List<Long> _findCards(String query, Object _order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5NDk5NQ=="}, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMzczOA==", "bodyText": "#6616\nmake more sens in a separate PR.\nI may have added it elsewhere by accident I guess", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449803738", "createdAt": "2020-07-04T20:36:05Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Finder.java", "diffHunk": "@@ -77,11 +77,22 @@ public Finder(Collection col) {\n \n     @CheckResult\n     public List<Long> findCards(String query, boolean _order) {\n-        return _findCards(query, _order);\n+        return findCards(query, _order, null);\n     }\n \n+    @CheckResult\n+    public List<Long> findCards(String query, boolean _order, CollectionTask task) {\n+        return _findCards(query, _order, task);\n+    }\n \n+\n+    @CheckResult\n     private List<Long> _findCards(String query, Object _order) {\n+        return _findCards(query, _order, null);\n+    }\n+\n+    @CheckResult\n+    private List<Long> _findCards(String query, Object _order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5NDk5NQ=="}, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMzg4NTQ0OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQxODoyODoyMVrOGs9T2A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNFQxOTo1OTowMlrOGs9r_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5NTAzMg==", "bodyText": "CollectionTask.getInstance() is available, so no need to change the APIs here", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449795032", "createdAt": "2020-07-04T18:28:21Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -1131,7 +1131,7 @@ public String _flagNameFromCardFlags(int flags){\n         return new Finder(this).findCards(search, order);\n     }\n \n-    public List<Long> findCards(String search, boolean order) {\n+    public List<Long> findCards(String search, boolean order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTgwMTIxMg==", "bodyText": "Closing, given the above conversation, it's not useful anymore", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449801212", "createdAt": "2020-07-04T19:59:02Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -1131,7 +1131,7 @@ public String _flagNameFromCardFlags(int flags){\n         return new Finder(this).findCards(search, order);\n     }\n \n-    public List<Long> findCards(String search, boolean order) {\n+    public List<Long> findCards(String search, boolean order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTc5NTAzMg=="}, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwNDU4NzkzOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNVQxNDowMjozN1rOGtCjWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNVQxNDoyMDowM1rOGtCqSw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTg4MDkyMw==", "bodyText": "This parameter seems unnecessary or is unused.", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449880923", "createdAt": "2020-07-05T14:02:37Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -1131,7 +1131,7 @@ public String _flagNameFromCardFlags(int flags){\n         return new Finder(this).findCards(search, order);\n     }\n \n-    public List<Long> findCards(String search, boolean order) {\n+    public List<Long> findCards(String search, boolean order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTg4MjY1Mw==", "bodyText": "oops, indeed, I forgot to send it to findCards. Didn't realize there was this indirection.", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449882653", "createdAt": "2020-07-05T14:19:28Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -1131,7 +1131,7 @@ public String _flagNameFromCardFlags(int flags){\n         return new Finder(this).findCards(search, order);\n     }\n \n-    public List<Long> findCards(String search, boolean order) {\n+    public List<Long> findCards(String search, boolean order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTg4MDkyMw=="}, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTg4MjY5OQ==", "bodyText": "Corrected", "url": "https://github.com/ankidroid/Anki-Android/pull/6609#discussion_r449882699", "createdAt": "2020-07-05T14:20:03Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/Collection.java", "diffHunk": "@@ -1131,7 +1131,7 @@ public String _flagNameFromCardFlags(int flags){\n         return new Finder(this).findCards(search, order);\n     }\n \n-    public List<Long> findCards(String search, boolean order) {\n+    public List<Long> findCards(String search, boolean order, CollectionTask task) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTg4MDkyMw=="}, "originalCommit": {"oid": "d5064b35eadac86a3c05c1025c1a0249502571c5"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 74, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}