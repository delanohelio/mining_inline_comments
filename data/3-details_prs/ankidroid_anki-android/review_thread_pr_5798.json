{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1Mjg2ODM0", "number": 5798, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQyMDoyODozNVrODmHsBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQyMDozMDoxNVrODmHsYQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMjk4NDM3OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQyMDoyODozNVrOFzXPJg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwMzowODoyOFrOFzZ5KA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQwMjQwNg==", "bodyText": "You seriously want to use a hyphen here? \ud83e\udd14\ud83d\ude05 A colon and new line character may be the way to go...?", "url": "https://github.com/ankidroid/Anki-Android/pull/5798#discussion_r389402406", "createdAt": "2020-03-08T20:28:35Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java", "diffHunk": "@@ -1542,6 +1542,9 @@ public void onPostExecute(Payload data) {\n                         showSyncErrorMessage(joinSyncMessages(dialogMessage, syncMessage));\n                     } else if (\"connectionError\".equals(resultType)) {\n                         dialogMessage = res.getString(R.string.sync_connection_error);\n+                        if (result.length >= 1 && result[1] instanceof Exception) {\n+                            dialogMessage += \" - \" + ((Exception)result[1]).getLocalizedMessage();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efbf5a87a52fba82ab8218319ee94f7929f84990"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ0NTkyOA==", "bodyText": "I had a colon first but it looked silly next to the period, a newline is just the trick though. Altered it, looks much better", "url": "https://github.com/ankidroid/Anki-Android/pull/5798#discussion_r389445928", "createdAt": "2020-03-09T03:08:28Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/DeckPicker.java", "diffHunk": "@@ -1542,6 +1542,9 @@ public void onPostExecute(Payload data) {\n                         showSyncErrorMessage(joinSyncMessages(dialogMessage, syncMessage));\n                     } else if (\"connectionError\".equals(resultType)) {\n                         dialogMessage = res.getString(R.string.sync_connection_error);\n+                        if (result.length >= 1 && result[1] instanceof Exception) {\n+                            dialogMessage += \" - \" + ((Exception)result[1]).getLocalizedMessage();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQwMjQwNg=="}, "originalCommit": {"oid": "efbf5a87a52fba82ab8218319ee94f7929f84990"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQxMjk4NTI5OnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/MyAccount.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOFQyMDozMDoxNVrOFzXPoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwMzowOToyNFrOFzZ55A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQwMjUyOQ==", "bodyText": "I'm not sure how meaningful this is, as it's pretty much guaranteed to truncate in the snack bar. Maybe you want to show a dialog when there's an error and only show the snack bar when there's not.", "url": "https://github.com/ankidroid/Anki-Android/pull/5798#discussion_r389402529", "createdAt": "2020-03-08T20:30:15Z", "author": {"login": "timrae"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/MyAccount.java", "diffHunk": "@@ -200,11 +200,16 @@ public void onPostExecute(Payload data) {\n                     switchToState(STATE_LOGGED_IN);\n                 }\n             } else {\n-                Timber.e(\"Login failed, error code %d\",data.returnType);\n+                Timber.e(\"Login failed, error code %d\", data.returnType);\n                 if (data.returnType == 403) {\n                     UIUtils.showSimpleSnackbar(MyAccount.this, R.string.invalid_username_password, true);\n                 } else {\n-                    UIUtils.showSimpleSnackbar(MyAccount.this, R.string.connection_error_message, true);\n+                    String message = getResources().getString(R.string.connection_error_message);\n+                    Object[] result = (Object [])data.result;\n+                    if (result.length > 1 && result[1] instanceof Exception) {\n+                        message += \": \" + ((Exception)result[1]).getLocalizedMessage();\n+                    }\n+                    UIUtils.showSimpleSnackbar(MyAccount.this, message, false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efbf5a87a52fba82ab8218319ee94f7929f84990"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ0NjExNg==", "bodyText": "The truncation was still leaving a meaningful message and I was thinking it was better to just leave it as a snackbar but if a dialog is okay by you, that certainly gives more room - in the case where I have more information (there is an Exception in the result) now I do a dialog as suggested", "url": "https://github.com/ankidroid/Anki-Android/pull/5798#discussion_r389446116", "createdAt": "2020-03-09T03:09:24Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/MyAccount.java", "diffHunk": "@@ -200,11 +200,16 @@ public void onPostExecute(Payload data) {\n                     switchToState(STATE_LOGGED_IN);\n                 }\n             } else {\n-                Timber.e(\"Login failed, error code %d\",data.returnType);\n+                Timber.e(\"Login failed, error code %d\", data.returnType);\n                 if (data.returnType == 403) {\n                     UIUtils.showSimpleSnackbar(MyAccount.this, R.string.invalid_username_password, true);\n                 } else {\n-                    UIUtils.showSimpleSnackbar(MyAccount.this, R.string.connection_error_message, true);\n+                    String message = getResources().getString(R.string.connection_error_message);\n+                    Object[] result = (Object [])data.result;\n+                    if (result.length > 1 && result[1] instanceof Exception) {\n+                        message += \": \" + ((Exception)result[1]).getLocalizedMessage();\n+                    }\n+                    UIUtils.showSimpleSnackbar(MyAccount.this, message, false);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQwMjUyOQ=="}, "originalCommit": {"oid": "efbf5a87a52fba82ab8218319ee94f7929f84990"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 596, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}