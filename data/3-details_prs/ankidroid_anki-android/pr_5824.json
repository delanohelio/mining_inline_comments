{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5MjYzNTgz", "number": 5824, "title": "Fix #5506 NullPointerException in StudyOptionsFragment", "bodyText": "Purpose / Description\nThere was a NPE assuming that the view was not null. This assumption does not hold.\nWe also remove an unused method (loading preferences) on View Load. This was removed in #555 (2da08a0).\nFixes\nFixes #5506\nApproach\n\nCheck for null and exit before we perform any view logic.\nMark variable as nullable so it won't happen again\n\nHow Has This Been Tested?\nThis is not tested, since I could not replicate the failure condition on my device.\nPlease see each commit for the logical steps in refactoring.\nChecklist\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-03-16T14:08:14Z", "url": "https://github.com/ankidroid/Anki-Android/pull/5824", "merged": true, "mergeCommit": {"oid": "8a5fd48d1dfe85e7b01849005004175e1a092378"}, "closed": true, "closedAt": "2020-03-18T20:59:08Z", "author": {"login": "david-allison-1"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOO1s8gBqjMxMzMzOTYxOTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcO9xMlAFqTM3NzIzMDY0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f25f14524af1b5eedad0a0b22bee5169f6ba44ea", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f25f14524af1b5eedad0a0b22bee5169f6ba44ea", "committedDate": "2020-03-16T14:03:25Z", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null"}, "afterCommit": {"oid": "5880d19b7d034b738237976f7a7c35b34577b0d9", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5880d19b7d034b738237976f7a7c35b34577b0d9", "committedDate": "2020-03-16T14:17:50Z", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6998866e11e6bb93d2d6faf60c76a80bf4b6481", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/e6998866e11e6bb93d2d6faf60c76a80bf4b6481", "committedDate": "2020-03-16T14:21:52Z", "message": "NF: Removed unnecessary method\n\nWe were loading preferences, but not using them.\n\nContext:\nUsage removed in 2da08a086c417acc42de813d2714a3ce7261947f, but method\nremained."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "371db18ce09e018173af3c616505abd190e38380", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/371db18ce09e018173af3c616505abd190e38380", "committedDate": "2020-03-16T14:21:56Z", "message": "StudyOptions: Unconditionally process arguments\n\nArguments were previously unset if there was no associated view."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58f9b3ad8f9143751d560ea994ac4c7e4a4f4f60", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/58f9b3ad8f9143751d560ea994ac4c7e4a4f4f60", "committedDate": "2020-03-16T14:21:56Z", "message": "NF: Remove references to mStudyOptionsView\n\nI want to add a Nullable annotation to the variable and want to remove\nreferences to the local"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97405cfadfce5e51d523193d4be641f167f91d42", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/97405cfadfce5e51d523193d4be641f167f91d42", "committedDate": "2020-03-16T14:21:56Z", "message": "#5506: Only refresh view when view exists\n\nWe can be in this state without an associated View.\n\nIf so, don't perform any view-related operations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5880d19b7d034b738237976f7a7c35b34577b0d9", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5880d19b7d034b738237976f7a7c35b34577b0d9", "committedDate": "2020-03-16T14:17:50Z", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null"}, "afterCommit": {"oid": "f90ac478460f08aac689d0958aac6ab76e7f67e6", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f90ac478460f08aac689d0958aac6ab76e7f67e6", "committedDate": "2020-03-16T14:21:56Z", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDU1NDM5", "url": "https://github.com/ankidroid/Anki-Android/pull/5824#pullrequestreview-375455439", "createdAt": "2020-03-16T17:56:48Z", "commit": {"oid": "e6998866e11e6bb93d2d6faf60c76a80bf4b6481"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzo1Njo0OFrOF2_ptQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxNzo1Njo0OFrOF2_ptQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIxMDI5Mw==", "bodyText": "So strange - I checked that method to see if there were any side effects (that we wanted) to explain why we get a prefs object and then ignore it everywhere, and nothing. I love seeing dead code go away, thanks", "url": "https://github.com/ankidroid/Anki-Android/pull/5824#discussion_r393210293", "createdAt": "2020-03-16T17:56:48Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/StudyOptionsFragment.java", "diffHunk": "@@ -487,13 +485,6 @@ private void dismissProgressDialog() {\n         }\n     }\n \n-\n-    public SharedPreferences restorePreferences() {\n-        SharedPreferences preferences = AnkiDroidApp.getSharedPrefs(getActivity().getBaseContext());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6998866e11e6bb93d2d6faf60c76a80bf4b6481"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDY0NTc1", "url": "https://github.com/ankidroid/Anki-Android/pull/5824#pullrequestreview-375464575", "createdAt": "2020-03-16T18:04:27Z", "commit": {"oid": "f90ac478460f08aac689d0958aac6ab76e7f67e6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxODowNDoyOFrOF2_-Ig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxODowNDoyOFrOF2_-Ig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIxNTUyMg==", "bodyText": "assert doesn't work in the android JVM so this is something we don't use in AnkiDroid\nI believe the Android Studio 4.x toolchain (including gradle plugins) which actually start making assert work via the extra de-sugaring they are implementing but that's still in alpha\nEither way, if we want assert behavior we Timber.e and throw RuntimeException, it's effectively the same", "url": "https://github.com/ankidroid/Anki-Android/pull/5824#discussion_r393215522", "createdAt": "2020-03-16T18:04:28Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/StudyOptionsFragment.java", "diffHunk": "@@ -189,6 +190,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n             return null;\n         }\n         mStudyOptionsView = inflater.inflate(R.layout.studyoptions_fragment, container, false);\n+        assert mStudyOptionsView != null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f90ac478460f08aac689d0958aac6ab76e7f67e6"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc70130b3250d652de5822bf1f23830bf2e4557a", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/dc70130b3250d652de5822bf1f23830bf2e4557a", "committedDate": "2020-03-17T17:35:07Z", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f90ac478460f08aac689d0958aac6ab76e7f67e6", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/f90ac478460f08aac689d0958aac6ab76e7f67e6", "committedDate": "2020-03-16T14:21:56Z", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null"}, "afterCommit": {"oid": "dc70130b3250d652de5822bf1f23830bf2e4557a", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/dc70130b3250d652de5822bf1f23830bf2e4557a", "committedDate": "2020-03-17T17:35:07Z", "message": "NF: Marked mStudyOptionsView as nullable\n\n#5506 was caused by this being null"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MjMwNjQy", "url": "https://github.com/ankidroid/Anki-Android/pull/5824#pullrequestreview-377230642", "createdAt": "2020-03-18T20:58:58Z", "commit": {"oid": "dc70130b3250d652de5822bf1f23830bf2e4557a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3517, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}