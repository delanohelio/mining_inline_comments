{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MDU5ODYx", "number": 6854, "title": "Time box", "bodyText": "Pull Request template\nFixes\nFixes #6853\nApproach\nThe timebox is consistently used BEFORE getting the next card, so that counting is consistent and there is no more need for special case.\nHow Has This Been Tested?\nTry to reproduce bugs as shown previously. On second timebox it'll show the correct number of cards\nChecklist\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-08-08T18:19:39Z", "url": "https://github.com/ankidroid/Anki-Android/pull/6854", "merged": true, "mergeCommit": {"oid": "dc770f8a812da3285f48a8f3f599d5e781285d37"}, "closed": true, "closedAt": "2020-08-24T16:18:37Z", "author": {"login": "Arthur-Milchior"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc87LszgH2gAyNDY1MDU5ODYxOjczZWRiYTNkYzU1NDcyY2QwZTYyOTM2ZTAyY2Y2NTEwMGM4NWQ1NDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdALVCPAFqTQ2OTcxODM0NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "73edba3dc55472cd0e62936e02cf65100c85d541", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/73edba3dc55472cd0e62936e02cf65100c85d541", "committedDate": "2020-08-08T15:58:43Z", "message": "NF: timeBoxReached return a pair"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20a5df67da752cbf4ad4bdde291bc0dca15ae9c5", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/20a5df67da752cbf4ad4bdde291bc0dca15ae9c5", "committedDate": "2020-08-08T17:34:45Z", "message": "NF: split dealWithTimeBox"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c2745e7fdffa458632962670df23e08bb140e3d", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/7c2745e7fdffa458632962670df23e08bb140e3d", "committedDate": "2020-08-08T18:14:01Z", "message": "NF: onPreExecute call super\n\nNF mostly because super.onPreExecute do nothing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "11f98d962f2a9ad563c44608bc3b6f0e9514ae17", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/11f98d962f2a9ad563c44608bc3b6f0e9514ae17", "committedDate": "2020-08-08T18:14:17Z", "message": "Time box opened at correct time\n\nTime box works (upstream and here) by looking at the number of reps at the start and end of the timebox and looking at\nthe difference.\n\nIn order for this number to make sens, the timebox should be always considered BEFORE or always considered AFTER getting\na new card, and not sometime before, sometime after. I moved it so that it's always considered before. This makes sens\nanyway because you can display the toast \"you had reviewed n cards in m minutes\" while loading the next card.\n\nThis means we don't need to count the \"not found card\" as a special case. There was never any reason to count both the\ncards you get and the cards you don't get. The correction in https://github.com/ankidroid/Anki-Android/pull/834\npartially corrected it; in the sens of it corrected off-by-one error for the first time box but created a off-by-one\nerror in the other direction on next time box.\n\nThis also remove a scheduler action from the listener, which may help with avoiding leaking context"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23438e43688a2df168a30807750f8518767f459f", "author": {"user": {"login": "Arthur-Milchior", "name": "Arthur Milchior"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/23438e43688a2df168a30807750f8518767f459f", "committedDate": "2020-08-08T18:16:45Z", "message": "NF: Reps modifier are protected"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NDkyMjIx", "url": "https://github.com/ankidroid/Anki-Android/pull/6854#pullrequestreview-465492221", "createdAt": "2020-08-11T23:21:58Z", "commit": {"oid": "23438e43688a2df168a30807750f8518767f459f"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQyMzoyMTo1OFrOG_MfMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQyMzoyMTo1OFrOG_MfMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkxODA2Nw==", "bodyText": "Was this removed due to another PR?", "url": "https://github.com/ankidroid/Anki-Android/pull/6854#discussion_r468918067", "createdAt": "2020-08-11T23:21:58Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -621,19 +624,14 @@ protected void displayNext(Card nextCard) {\n                 AbstractFlashcardViewer.this.unblockControls();\n                 AbstractFlashcardViewer.this.displayCardQuestion();\n             }\n+        }\n \n-            // Since reps are incremented on fetch of next card, we will miss counting the\n-            // last rep since there isn't a next card. We manually account for it here.\n-            if (mNoMoreCards) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23438e43688a2df168a30807750f8518767f459f"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NjMyNTIx", "url": "https://github.com/ankidroid/Anki-Android/pull/6854#pullrequestreview-466632521", "createdAt": "2020-08-13T10:21:41Z", "commit": {"oid": "23438e43688a2df168a30807750f8518767f459f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NzE4MzQ0", "url": "https://github.com/ankidroid/Anki-Android/pull/6854#pullrequestreview-469718344", "createdAt": "2020-08-18T18:29:11Z", "commit": {"oid": "23438e43688a2df168a30807750f8518767f459f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2903, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}