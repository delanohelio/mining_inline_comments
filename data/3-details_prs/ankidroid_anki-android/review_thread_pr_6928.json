{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxMDQyMDE5", "number": 6928, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNjoyMzo1MlrOEanC3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxODoyMTo1OFrOEap1fg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MzM4MTQxOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/stats/Stats.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNjoyMzo1MlrOHEJasQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNjoyNDo0NlrOHEJc3A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDExMDY0MQ==", "bodyText": "this can't be correct?\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            \"(cast((id/1000.0 - ?) / SECONDS_PER_DAY.0 as int))/? as day,\" +\n          \n          \n            \n                            \"(cast((id/1000.0 - ?) / \" + SECONDS_PER_DAY + \" as int))/? as day,\" +", "url": "https://github.com/ankidroid/Anki-Android/pull/6928#discussion_r474110641", "createdAt": "2020-08-20T16:23:52Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/stats/Stats.java", "diffHunk": "@@ -226,7 +226,7 @@ private String getRevlogTimeFilter(AxisType timespan, boolean inverse) {\n         long cut = mCol.getSched().getDayCutoff();\n         int cardCount = 0;\n         String query = \"select \" +\n-                \"(cast((id/1000.0 - ?) / 86400.0 as int))/? as day,\" +\n+                \"(cast((id/1000.0 - ?) / SECONDS_PER_DAY.0 as int))/? as day,\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a23c714b01e2b191609c928b5988d1f4516b33a2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDExMTE5Ng==", "bodyText": "Clearly not.", "url": "https://github.com/ankidroid/Anki-Android/pull/6928#discussion_r474111196", "createdAt": "2020-08-20T16:24:46Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/stats/Stats.java", "diffHunk": "@@ -226,7 +226,7 @@ private String getRevlogTimeFilter(AxisType timespan, boolean inverse) {\n         long cut = mCol.getSched().getDayCutoff();\n         int cardCount = 0;\n         String query = \"select \" +\n-                \"(cast((id/1000.0 - ?) / 86400.0 as int))/? as day,\" +\n+                \"(cast((id/1000.0 - ?) / SECONDS_PER_DAY.0 as int))/? as day,\" +", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDExMDY0MQ=="}, "originalCommit": {"oid": "a23c714b01e2b191609c928b5988d1f4516b33a2"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MzM4NTUzOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/test/java/com/ichi2/libanki/FinderTest.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNjoyNDo1NVrOHEJdMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxNjo0MDowNVrOHEKMWA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDExMTI4Mg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        col.getDb().execute(\"update cards set id = id - SECONDS_PER_DAY*1000 where id = ?\", id);\n          \n          \n            \n                        col.getDb().execute(\"update cards set id = id - \" + SECONDS_PER_DAY + \"*1000 where id = ?\", id);", "url": "https://github.com/ankidroid/Anki-Android/pull/6928#discussion_r474111282", "createdAt": "2020-08-20T16:24:55Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/test/java/com/ichi2/libanki/FinderTest.java", "diffHunk": "@@ -308,7 +308,7 @@ public void test_findCards() {\n             assertEquals(1, col.findCards(\"rated:2:2\").size());\n             // added\n             assertEquals(0, col.findCards(\"added:0\").size());\n-            col.getDb().execute(\"update cards set id = id - 86400*1000 where id = ?\", id);\n+            col.getDb().execute(\"update cards set id = id - SECONDS_PER_DAY*1000 where id = ?\", id);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a23c714b01e2b191609c928b5988d1f4516b33a2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDEyMzM1Mg==", "bodyText": "why don't we get typed query ? I'd love typed queries.\nThanks", "url": "https://github.com/ankidroid/Anki-Android/pull/6928#discussion_r474123352", "createdAt": "2020-08-20T16:40:05Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/test/java/com/ichi2/libanki/FinderTest.java", "diffHunk": "@@ -308,7 +308,7 @@ public void test_findCards() {\n             assertEquals(1, col.findCards(\"rated:2:2\").size());\n             // added\n             assertEquals(0, col.findCards(\"added:0\").size());\n-            col.getDb().execute(\"update cards set id = id - 86400*1000 where id = ?\", id);\n+            col.getDb().execute(\"update cards set id = id - SECONDS_PER_DAY*1000 where id = ?\", id);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDExMTI4Mg=="}, "originalCommit": {"oid": "a23c714b01e2b191609c928b5988d1f4516b33a2"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2MzgzODcwOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/libanki/stats/Stats.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxODoyMTo1OFrOHEN5kg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxODo0NDoxNlrOHEOqIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4NDA4Mg==", "bodyText": "I had to read this to verify the what/why https://www.sqlite.org/lang_expr.html - seems legit", "url": "https://github.com/ankidroid/Anki-Android/pull/6928#discussion_r474184082", "createdAt": "2020-08-20T18:21:58Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/stats/Stats.java", "diffHunk": "@@ -226,7 +226,7 @@ private String getRevlogTimeFilter(AxisType timespan, boolean inverse) {\n         long cut = mCol.getSched().getDayCutoff();\n         int cardCount = 0;\n         String query = \"select \" +\n-                \"(cast((id/1000.0 - ?) / 86400.0 as int))/? as day,\" +\n+                \"(cast((id/1000.0 - ?) / \" + SECONDS_PER_DAY + \".0 as int))/? as day,\" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5047a1333f67f40cd625387159e61a5cbb34e3d6"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4OTg2MA==", "bodyText": "The query is literally the same here.", "url": "https://github.com/ankidroid/Anki-Android/pull/6928#discussion_r474189860", "createdAt": "2020-08-20T18:32:20Z", "author": {"login": "Arthur-Milchior"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/stats/Stats.java", "diffHunk": "@@ -226,7 +226,7 @@ private String getRevlogTimeFilter(AxisType timespan, boolean inverse) {\n         long cut = mCol.getSched().getDayCutoff();\n         int cardCount = 0;\n         String query = \"select \" +\n-                \"(cast((id/1000.0 - ?) / 86400.0 as int))/? as day,\" +\n+                \"(cast((id/1000.0 - ?) / \" + SECONDS_PER_DAY + \".0 as int))/? as day,\" +", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4NDA4Mg=="}, "originalCommit": {"oid": "5047a1333f67f40cd625387159e61a5cbb34e3d6"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE5NjUxNA==", "bodyText": "it definitely is, I just had never considered SQL (or perhaps sqlite specifically) had casting semantics and wanted to satisfy the curiosity - is it still needed? how's it work?", "url": "https://github.com/ankidroid/Anki-Android/pull/6928#discussion_r474196514", "createdAt": "2020-08-20T18:44:16Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/libanki/stats/Stats.java", "diffHunk": "@@ -226,7 +226,7 @@ private String getRevlogTimeFilter(AxisType timespan, boolean inverse) {\n         long cut = mCol.getSched().getDayCutoff();\n         int cardCount = 0;\n         String query = \"select \" +\n-                \"(cast((id/1000.0 - ?) / 86400.0 as int))/? as day,\" +\n+                \"(cast((id/1000.0 - ?) / \" + SECONDS_PER_DAY + \".0 as int))/? as day,\" +", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDE4NDA4Mg=="}, "originalCommit": {"oid": "5047a1333f67f40cd625387159e61a5cbb34e3d6"}, "originalPosition": 50}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4871, "cost": 1, "resetAt": "2021-11-12T09:44:50Z"}}}