{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg3MTY1ODU4", "number": 7103, "title": "Refactor BasicImageFieldController", "bodyText": "Purpose / Description\nI felt the code was too complex to add the 'rename' feature without introducing technical debt\nFixes\nRelated: #5192\nApproach\nRefactor the code so it's easier to reason about\nHow Has This Been Tested?\nOn my device - no change\nChecklist\n\n You have not changed whitespace unnecessarily (it makes diffs hard to read)\n You have a descriptive commit message with a short title (first line, max 50 chars).\n Your code follows the style of the project (e.g. never omit braces in if statements)\n You have commented your code, particularly in hard-to-understand areas\n You have performed a self-review of your own code", "createdAt": "2020-09-15T09:32:45Z", "url": "https://github.com/ankidroid/Anki-Android/pull/7103", "merged": true, "mergeCommit": {"oid": "b570b61acd1e2cf0cabaae9975069909c8125770"}, "closed": true, "closedAt": "2020-09-21T18:44:44Z", "author": {"login": "david-allison-1"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdI7PlXgH2gAyNDg3MTY1ODU4OjVmOWZmY2ZmZjc5YTlkZjNkOGY3ZDBmNTE3NjUxNmM5MTliMWFmNGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdLEbiXAFqTQ5MjY3MzY0MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5f9ffcfff79a9df3d8f7d0f5176516c919b1af4c", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/5f9ffcfff79a9df3d8f7d0f5176516c919b1af4c", "committedDate": "2020-09-14T22:50:03Z", "message": "NF: Extract onValidImage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0c04933b69826a7ed529e244926b6d27ccb8746", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/b0c04933b69826a7ed529e244926b6d27ccb8746", "committedDate": "2020-09-15T09:20:27Z", "message": "NF: Extract image path and Uri to ViewModel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ee98bddfccee5ec187dbe5f5fbb54e698b26468", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/2ee98bddfccee5ec187dbe5f5fbb54e698b26468", "committedDate": "2020-09-15T09:20:30Z", "message": "NF: Extract captureImage"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eba0ba180a223a295e580c36a9c60207bc3d2786", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/eba0ba180a223a295e580c36a9c60207bc3d2786", "committedDate": "2020-09-15T09:20:30Z", "message": "NF: Extract canUseCamera"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2eae905f3ed22adba0c6d7960291b8afe99360fc", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/2eae905f3ed22adba0c6d7960291b8afe99360fc", "committedDate": "2020-09-15T09:20:31Z", "message": "extract rotateAndCompress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4437e9501a83d447620808a94d8e0ae4a9c802af", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/4437e9501a83d447620808a94d8e0ae4a9c802af", "committedDate": "2020-09-15T09:20:31Z", "message": "extract setTemporaryMedia"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83fc2ef5642ee9bad82721af1a3944900707461d", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/83fc2ef5642ee9bad82721af1a3944900707461d", "committedDate": "2020-09-15T09:20:32Z", "message": "refactor rotateAndCompress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea5971586d5c07eda0440b7868d989539c65fe21", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/ea5971586d5c07eda0440b7868d989539c65fe21", "committedDate": "2020-09-15T09:20:33Z", "message": "refactor mViewModel"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "363cb8529edec0f6169879f85c3e7113d1a5fa32", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/363cb8529edec0f6169879f85c3e7113d1a5fa32", "committedDate": "2020-09-15T09:21:55Z", "message": "BasicImageFieldController: Final Refactorings\n\nBefore 5192 - adding rename"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1b665775d25d4a0a560bb646736d880786c60553", "author": {"user": {"login": "david-allison-1", "name": "David Allison"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/1b665775d25d4a0a560bb646736d880786c60553", "committedDate": "2020-09-15T09:31:56Z", "message": "NF: Refactor requestCrop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NTAwMzg2", "url": "https://github.com/ankidroid/Anki-Android/pull/7103#pullrequestreview-488500386", "createdAt": "2020-09-15T09:33:32Z", "commit": {"oid": "1b665775d25d4a0a560bb646736d880786c60553"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwOTozMzozMlrOHR5LTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQwOTozNDoyN1rOHR5NXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODUyNDYyMA==", "bodyText": "Extracted from getImageUri", "url": "https://github.com/ankidroid/Anki-Android/pull/7103#discussion_r488524620", "createdAt": "2020-09-15T09:33:32Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/fields/BasicImageFieldController.java", "diffHunk": "@@ -400,17 +407,20 @@ private void handleSelectImageIntent(Intent data) {\n \n         File internalizedPick = internalizeUri(selectedImage);\n         if (internalizedPick == null) {\n+            String urlImagePath = getImageInfoFromUri(mActivity, selectedImage).first;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b665775d25d4a0a560bb646736d880786c60553"}, "originalPosition": 252}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODUyNTE0OQ==", "bodyText": "Handled in rotateAndCompress now", "url": "https://github.com/ankidroid/Anki-Android/pull/7103#discussion_r488525149", "createdAt": "2020-09-15T09:34:27Z", "author": {"login": "david-allison-1"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/multimediacard/fields/BasicImageFieldController.java", "diffHunk": "@@ -643,22 +662,35 @@ private void handleCropResult() {\n         Timber.d(\"handleCropResult\");\n         if (!rotateAndCompress()) {\n             Timber.i(\"handleCropResult() appears to have an invalid file, reverting\");\n-            revertToPreviousImage();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1b665775d25d4a0a560bb646736d880786c60553"}, "originalPosition": 443}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ce4b867719606a5b27efca6ff9eea2d800d89dcd", "author": {"user": {"login": "mikehardy", "name": "Mike Hardy"}}, "url": "https://github.com/ankidroid/Anki-Android/commit/ce4b867719606a5b27efca6ff9eea2d800d89dcd", "committedDate": "2020-09-21T14:38:42Z", "message": "Merge branch 'master' into 5192-refactor"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDkyNjczNjQw", "url": "https://github.com/ankidroid/Anki-Android/pull/7103#pullrequestreview-492673640", "createdAt": "2020-09-21T14:40:06Z", "commit": {"oid": "ce4b867719606a5b27efca6ff9eea2d800d89dcd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3983, "cost": 1, "resetAt": "2021-10-29T17:30:11Z"}}}