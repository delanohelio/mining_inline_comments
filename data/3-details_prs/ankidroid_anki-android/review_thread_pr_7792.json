{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI5MDM2NzUx", "number": 7792, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOVQxMzoyMjoxNlrOE-ZNGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOVQxMzoyMjoxNlrOE-ZNGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMzODYwMTIxOnYy", "diffSide": "RIGHT", "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOVQxMzoyMjoxNlrOH7jeRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOVQxMzoyMjoxNlrOH7jeRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjIwOTIyMg==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        Timber.d(\"onPageFinished triggered: %s\", url);\n          \n          \n            \n            \n          \n          \n            \n                        // onPageFinished will be called multiple times if the WebView redirects by setting window.location.href\n          \n          \n            \n                        if (url.equals(mViewerUrl)) {\n          \n          \n            \n                            drawFlag();\n          \n          \n            \n                            drawMark();\n          \n          \n            \n                            view.loadUrl(\"javascript:onPageFinished();\");\n          \n          \n            \n                        }\n          \n          \n            \n                        Timber.d(\"Java onPageFinished triggered: %s\", url);\n          \n          \n            \n            \n          \n          \n            \n                        // onPageFinished will be called multiple times if the WebView redirects by setting window.location.href\n          \n          \n            \n                        if (url.equals(mViewerUrl)) {\n          \n          \n            \n                            Timber.d(\"New URL, drawing flags, marks, and triggering JS onPageFinished: %s\", url);\n          \n          \n            \n                            drawFlag();\n          \n          \n            \n                            drawMark();\n          \n          \n            \n                            view.loadUrl(\"javascript:onPageFinished();\");\n          \n          \n            \n                        }", "url": "https://github.com/ankidroid/Anki-Android/pull/7792#discussion_r532209222", "createdAt": "2020-11-29T13:22:16Z", "author": {"login": "mikehardy"}, "path": "AnkiDroid/src/main/java/com/ichi2/anki/AbstractFlashcardViewer.java", "diffHunk": "@@ -3478,10 +3480,14 @@ private String decodeUrl(String url) {\n         // Run any post-load events in javascript that rely on the window being completely loaded.\n         @Override\n         public void onPageFinished(WebView view, String url) {\n-            Timber.d(\"onPageFinished triggered\");\n-            drawFlag();\n-            drawMark();\n-            view.loadUrl(\"javascript:onPageFinished();\");\n+            Timber.d(\"onPageFinished triggered: %s\", url);\n+\n+            // onPageFinished will be called multiple times if the WebView redirects by setting window.location.href\n+            if (url.equals(mViewerUrl)) {\n+                drawFlag();\n+                drawMark();\n+                view.loadUrl(\"javascript:onPageFinished();\");\n+            }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "158f6995c36216441fcbb31e5779dd166ef2e3dd"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 668, "cost": 1, "resetAt": "2021-11-11T21:28:48Z"}}}