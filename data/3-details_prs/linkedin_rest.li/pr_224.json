{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwMTk0MjM2", "number": 224, "title": "Improvements to the PDL translation task.", "bodyText": "Add option to skip verification.\nDon't failfast on errors while loading schemas.\nWrite schemas failing verification to temp location to diff them\neasily.\nStrip trailing whitespaces in PDL.", "createdAt": "2020-03-18T03:29:57Z", "url": "https://github.com/linkedin/rest.li/pull/224", "merged": true, "mergeCommit": {"oid": "3dd1c7f1c0160bf96dca853354c898110ac302c2"}, "closed": true, "closedAt": "2020-03-18T06:55:26Z", "author": {"login": "karthikbalasub"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOvo4mgFqTM3NjU1ODA5OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcOxoihgBqjMxNDAxNjQ2Mzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NTU4MDk5", "url": "https://github.com/linkedin/rest.li/pull/224#pullrequestreview-376558099", "createdAt": "2020-03-18T04:31:13Z", "commit": {"oid": "0f2e7f504a072cee06c862d324dd56a06e5bb094"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NTYwMjQ3", "url": "https://github.com/linkedin/rest.li/pull/224#pullrequestreview-376560247", "createdAt": "2020-03-18T04:40:12Z", "commit": {"oid": "0f2e7f504a072cee06c862d324dd56a06e5bb094"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNDo0MDoxMlrOF32J2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNDo0MDoxMlrOF32J2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDEwMzI1OQ==", "bodyText": "the log will be huge, shall we use LOGGER.debug instead?", "url": "https://github.com/linkedin/rest.li/pull/224#discussion_r394103259", "createdAt": "2020-03-18T04:40:12Z", "author": {"login": "nickibi"}, "path": "restli-tools/src/main/java/com/linkedin/restli/tools/data/SchemaFormatTranslator.java", "diffHunk": "@@ -268,8 +282,13 @@ private void verifyTranslatedSchemas(Map<String, SchemaInfo> topLevelTranslatedS\n         if (!sourceSchema.equals(destSchema))\n         {\n           LOGGER.error(\"Translation failed for schema: {}\", schemaName);\n-          LOGGER.error(\"Source format: {}, schema:\\n{}\", _sourceFormat, sourceSchema.toString());\n-          LOGGER.error(\"Destination format: {}, schema:\\n{}\", _destFormat, destSchema.toString());\n+          // Write the translated schema to temp dir.\n+          File sourceFile = new File(errorSchemasDir, sourceSchema.getName() + \"_\" + _sourceFormat);\n+          FileUtils.writeStringToFile(sourceFile, SchemaToJsonEncoder.schemaToJson(sourceSchema, JsonBuilder.Pretty.INDENTED));\n+          File destFile = new File(errorSchemasDir, sourceSchema.getName() + \"_\" + _destFormat);\n+          FileUtils.writeStringToFile(destFile, SchemaToJsonEncoder.schemaToJson(destSchema, JsonBuilder.Pretty.INDENTED));\n+          LOGGER.error(\"To see the difference between source and tanslated schemas, run: \");\n+          LOGGER.error(\"diff {} {}\", sourceFile.getAbsolutePath(), destFile.getAbsolutePath());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f2e7f504a072cee06c862d324dd56a06e5bb094"}, "originalPosition": 66}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NTYwNDE4", "url": "https://github.com/linkedin/rest.li/pull/224#pullrequestreview-376560418", "createdAt": "2020-03-18T04:40:58Z", "commit": {"oid": "0f2e7f504a072cee06c862d324dd56a06e5bb094"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NTc3NjQ3", "url": "https://github.com/linkedin/rest.li/pull/224#pullrequestreview-376577647", "createdAt": "2020-03-18T05:44:31Z", "commit": {"oid": "0f2e7f504a072cee06c862d324dd56a06e5bb094"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNTo0NDozMVrOF33BMA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNjowOTowNlrOF33aKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDExNzQyNA==", "bodyText": "By RE convention \"\\s+$\" is what is usually used.", "url": "https://github.com/linkedin/rest.li/pull/224#discussion_r394117424", "createdAt": "2020-03-18T05:44:31Z", "author": {"login": "junchuanwang"}, "path": "restli-tools/src/main/java/com/linkedin/restli/tools/data/SchemaFormatTranslator.java", "diffHunk": "@@ -59,6 +60,8 @@\n {\n   private static final Logger LOGGER = LoggerFactory.getLogger(SchemaFormatTranslator.class);\n \n+  private static final Pattern LINE_END_SPACES = Pattern.compile(\" +$\", Pattern.MULTILINE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f2e7f504a072cee06c862d324dd56a06e5bb094"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDEyMzgxOA==", "bodyText": "I understand you want to show them in two lines, but following code would feel better\nLOGGER.error(\"To see the difference between source and tanslated schemas, run: \\n diff {} {}\", sourceFile.getAbsolutePath(), destFile.getAbsolutePath());", "url": "https://github.com/linkedin/rest.li/pull/224#discussion_r394123818", "createdAt": "2020-03-18T06:09:06Z", "author": {"login": "junchuanwang"}, "path": "restli-tools/src/main/java/com/linkedin/restli/tools/data/SchemaFormatTranslator.java", "diffHunk": "@@ -268,8 +282,13 @@ private void verifyTranslatedSchemas(Map<String, SchemaInfo> topLevelTranslatedS\n         if (!sourceSchema.equals(destSchema))\n         {\n           LOGGER.error(\"Translation failed for schema: {}\", schemaName);\n-          LOGGER.error(\"Source format: {}, schema:\\n{}\", _sourceFormat, sourceSchema.toString());\n-          LOGGER.error(\"Destination format: {}, schema:\\n{}\", _destFormat, destSchema.toString());\n+          // Write the translated schema to temp dir.\n+          File sourceFile = new File(errorSchemasDir, sourceSchema.getName() + \"_\" + _sourceFormat);\n+          FileUtils.writeStringToFile(sourceFile, SchemaToJsonEncoder.schemaToJson(sourceSchema, JsonBuilder.Pretty.INDENTED));\n+          File destFile = new File(errorSchemasDir, sourceSchema.getName() + \"_\" + _destFormat);\n+          FileUtils.writeStringToFile(destFile, SchemaToJsonEncoder.schemaToJson(destSchema, JsonBuilder.Pretty.INDENTED));\n+          LOGGER.error(\"To see the difference between source and tanslated schemas, run: \");\n+          LOGGER.error(\"diff {} {}\", sourceFile.getAbsolutePath(), destFile.getAbsolutePath());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f2e7f504a072cee06c862d324dd56a06e5bb094"}, "originalPosition": 66}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "457d4762e146cd36a0ef14cef211f4016d10e2a7", "author": {"user": null}, "url": "https://github.com/linkedin/rest.li/commit/457d4762e146cd36a0ef14cef211f4016d10e2a7", "committedDate": "2020-03-18T06:40:11Z", "message": "Improvements to the PDL translation task.\n - Add option to skip verification.\n - Don't failfast on errors while loading schemas.\n - Write schemas failing verification to temp location to diff them\n   easily.\n - Strip trailing whitespaces in PDL."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0f2e7f504a072cee06c862d324dd56a06e5bb094", "author": {"user": null}, "url": "https://github.com/linkedin/rest.li/commit/0f2e7f504a072cee06c862d324dd56a06e5bb094", "committedDate": "2020-03-18T03:26:50Z", "message": "Improvements to the PDL translation task.\n - Add option to skip verification.\n - Don't failfast on errors while loading schemas.\n - Write schemas failing verification to temp location to diff them\n   easily.\n - Strip trailing whitespaces in PDL."}, "afterCommit": {"oid": "b8d1347e8226eab3f18ff1b73d2d7cf9935e60e0", "author": {"user": null}, "url": "https://github.com/linkedin/rest.li/commit/b8d1347e8226eab3f18ff1b73d2d7cf9935e60e0", "committedDate": "2020-03-18T06:40:11Z", "message": "Address review comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NTk2ODc1", "url": "https://github.com/linkedin/rest.li/pull/224#pullrequestreview-376596875", "createdAt": "2020-03-18T06:42:09Z", "commit": {"oid": "b8d1347e8226eab3f18ff1b73d2d7cf9935e60e0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b8d1347e8226eab3f18ff1b73d2d7cf9935e60e0", "author": {"user": null}, "url": "https://github.com/linkedin/rest.li/commit/b8d1347e8226eab3f18ff1b73d2d7cf9935e60e0", "committedDate": "2020-03-18T06:40:11Z", "message": "Address review comments"}, "afterCommit": {"oid": "522521314fee33995f9ab4f3168312f777d41522", "author": {"user": null}, "url": "https://github.com/linkedin/rest.li/commit/522521314fee33995f9ab4f3168312f777d41522", "committedDate": "2020-03-18T06:41:56Z", "message": "Address review comments\nRelease 28.1.30"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73d68346bda01c845e16871da17e8b49d73e3276", "author": {"user": null}, "url": "https://github.com/linkedin/rest.li/commit/73d68346bda01c845e16871da17e8b49d73e3276", "committedDate": "2020-03-18T06:50:21Z", "message": "Address review comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "522521314fee33995f9ab4f3168312f777d41522", "author": {"user": null}, "url": "https://github.com/linkedin/rest.li/commit/522521314fee33995f9ab4f3168312f777d41522", "committedDate": "2020-03-18T06:41:56Z", "message": "Address review comments\nRelease 28.1.30"}, "afterCommit": {"oid": "73d68346bda01c845e16871da17e8b49d73e3276", "author": {"user": null}, "url": "https://github.com/linkedin/rest.li/commit/73d68346bda01c845e16871da17e8b49d73e3276", "committedDate": "2020-03-18T06:50:21Z", "message": "Address review comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3, "cost": 1, "resetAt": "2021-11-01T16:19:10Z"}}}