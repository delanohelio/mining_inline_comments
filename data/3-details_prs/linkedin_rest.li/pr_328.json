{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM2MDkwOTIz", "number": 328, "title": "Add spock integration testing to the project and gradle-plugin module.", "bodyText": "This script Create a script to allow spock integration testing.\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\nCreate a script that adds spock integration testing for a module\nAdd integration testing to the gradle-plugin module\nCreate an integ test that validates the pegasus plugin can be applied", "createdAt": "2020-06-17T20:55:03Z", "url": "https://github.com/linkedin/rest.li/pull/328", "merged": true, "mergeCommit": {"oid": "779fd16dcbf65a630b929ff50d35de73055abeb9"}, "closed": true, "closedAt": "2020-06-23T21:21:09Z", "author": {"login": "Astro03"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcsQR8lAFqTQzMjc3MDMyMg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcuLL6dAH2gAyNDM2MDkwOTIzOjU1MjJhNWJkNTZmZTk0MjllMjA4YWJiZGY4MjQxNmM2N2JhNTVmMTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNzcwMzIy", "url": "https://github.com/linkedin/rest.li/pull/328#pullrequestreview-432770322", "createdAt": "2020-06-17T20:56:50Z", "commit": {"oid": "2a87ed4d165fa4299a0201aad5a9bff7d3776105"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QyMDo1Njo1MFrOGlXI1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QyMDo1Njo1MFrOGlXI1A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTgyOTU4OA==", "bodyText": "NB: compile gradleApi() is applied automatically by the java-gradle-plugin, hence it's correct to remove it here", "url": "https://github.com/linkedin/rest.li/pull/328#discussion_r441829588", "createdAt": "2020-06-17T20:56:50Z", "author": {"login": "DPUkyle"}, "path": "gradle-plugins/build.gradle", "diffHunk": "@@ -1,10 +1,9 @@\n-apply plugin: 'java'\n+// Setup integTests\n+apply from: \"${buildScriptDirPath}/integTest.gradle\"\n \n dependencies {\n-  compile gradleApi()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2a87ed4d165fa4299a0201aad5a9bff7d3776105"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNzcxNjQ4", "url": "https://github.com/linkedin/rest.li/pull/328#pullrequestreview-432771648", "createdAt": "2020-06-17T20:58:53Z", "commit": {"oid": "2a87ed4d165fa4299a0201aad5a9bff7d3776105"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QyMDo1ODo1M1rOGlXMzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QyMDo1ODo1M1rOGlXMzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTgzMDYwNw==", "bodyText": "This is implied by invoking GradleRunner#build - an exception is thrown if the build was not successful.\nInstead please change to result.task(': mainDataTemplateJar').outcome == TaskOutcome.SUCCESS", "url": "https://github.com/linkedin/rest.li/pull/328#discussion_r441830607", "createdAt": "2020-06-17T20:58:53Z", "author": {"login": "DPUkyle"}, "path": "gradle-plugins/src/integTest/groovy/com/linkedin/pegasus/gradle/PegasusPluginIntegrationTest.groovy", "diffHunk": "@@ -0,0 +1,28 @@\n+package com.linkedin.pegasus.gradle\n+\n+import org.gradle.testkit.runner.GradleRunner\n+import org.junit.Rule\n+import org.junit.rules.TemporaryFolder\n+import spock.lang.Specification\n+\n+class PegasusPluginIntegrationTest extends Specification {\n+  @Rule\n+  TemporaryFolder tempDir = new TemporaryFolder()\n+\n+  def 'apply pegasus plugin'() {\n+    setup:\n+    def buildFile = tempDir.newFile('build.gradle')\n+    buildFile.text = \"plugins { id 'pegasus' }\"\n+\n+    when:\n+    def result = GradleRunner.create()\n+        .withProjectDir(tempDir.root)\n+        .withPluginClasspath()\n+        .withArguments(\"mainDataTemplateJar\")\n+        .forwardOutput()\n+        .build()\n+\n+    then:\n+    result.output.contains(\"BUILD SUCCESSFUL\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2a87ed4d165fa4299a0201aad5a9bff7d3776105"}, "originalPosition": 26}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2a87ed4d165fa4299a0201aad5a9bff7d3776105", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/2a87ed4d165fa4299a0201aad5a9bff7d3776105", "committedDate": "2020-06-17T20:46:32Z", "message": "Add spock integration testing to the project and gradle-plugin module.\n\nThis script Create a script to allow spock integration testing.\n\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\n* Create a script that adds spock integration testing for a module\n* Add integration testing to the gradle-plugin module\n* Create an integ test that validates the pegasus plugin can be applied"}, "afterCommit": {"oid": "8575f8498ea6f991948a1c90b7c5d5fd6736586f", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/8575f8498ea6f991948a1c90b7c5d5fd6736586f", "committedDate": "2020-06-17T21:25:02Z", "message": "Add spock integration testing to the project and gradle-plugin module.\n\nThis script Create a script to allow spock integration testing.\n\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\n* Create a script that adds spock integration testing for a module\n* Add integration testing to the gradle-plugin module\n* Create an integ test that validates the pegasus plugin can be applied"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8575f8498ea6f991948a1c90b7c5d5fd6736586f", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/8575f8498ea6f991948a1c90b7c5d5fd6736586f", "committedDate": "2020-06-17T21:25:02Z", "message": "Add spock integration testing to the project and gradle-plugin module.\n\nThis script Create a script to allow spock integration testing.\n\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\n* Create a script that adds spock integration testing for a module\n* Add integration testing to the gradle-plugin module\n* Create an integ test that validates the pegasus plugin can be applied"}, "afterCommit": {"oid": "037e79c58e34b698da0355ffc01c05ea8ac2891a", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/037e79c58e34b698da0355ffc01c05ea8ac2891a", "committedDate": "2020-06-17T21:30:29Z", "message": "Add spock integration testing to the project and gradle-plugin module.\n\nThis script Create a script to allow spock integration testing.\n\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\n* Create a script that adds spock integration testing for a module\n* Add integration testing to the gradle-plugin module\n* Create an integ test that validates the pegasus plugin can be applied"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "037e79c58e34b698da0355ffc01c05ea8ac2891a", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/037e79c58e34b698da0355ffc01c05ea8ac2891a", "committedDate": "2020-06-17T21:30:29Z", "message": "Add spock integration testing to the project and gradle-plugin module.\n\nThis script Create a script to allow spock integration testing.\n\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\n* Create a script that adds spock integration testing for a module\n* Add integration testing to the gradle-plugin module\n* Create an integ test that validates the pegasus plugin can be applied"}, "afterCommit": {"oid": "8ee37ee1ed56f2a13da79d7bba1298095dbc4ef8", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/8ee37ee1ed56f2a13da79d7bba1298095dbc4ef8", "committedDate": "2020-06-17T21:34:38Z", "message": "Add spock integration testing to the project and gradle-plugin module.\n\nThis script Create a script to allow spock integration testing.\n\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\n* Create a script that adds spock integration testing for a module\n* Add integration testing to the gradle-plugin module\n* Create an integ test that validates the pegasus plugin can be applied"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNzk3MTMw", "url": "https://github.com/linkedin/rest.li/pull/328#pullrequestreview-432797130", "createdAt": "2020-06-17T21:41:15Z", "commit": {"oid": "8ee37ee1ed56f2a13da79d7bba1298095dbc4ef8"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QyMTo0MToxNVrOGlYZzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QyMTo0MToxNVrOGlYZzw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTg1MDMxOQ==", "bodyText": "I suggest:\nproject.tasks.withType(Test) {\n  if (it.options instanceof TestNGOptions) {\n    it.options.excludeGroups 'ci-flaky'\n    it.systemProperties['test.httpRequestTimeout'] = '20000'\n  }\n}", "url": "https://github.com/linkedin/rest.li/pull/328#discussion_r441850319", "createdAt": "2020-06-17T21:41:15Z", "author": {"login": "DPUkyle"}, "path": "build.gradle", "diffHunk": "@@ -286,10 +287,11 @@ subprojects {\n     }\n   }\n \n-  // Exclude tests which are known to be flaky in the Travis CI environment\n+  // Exclude tests which are known to be flaky in the Travis CI environment. Since all test tasks are TestNG tasks\n+  // EXCEPT the integTest task, exclude the options from being evaluated by travis for the integTest task.\n   if (System.getenv('TRAVIS') == 'true' && System.getenv('USER') == 'travis') {\n     afterEvaluate {\n-      project.tasks.withType(Test).forEach {\n+      project.tasks.withType(Test).matching { it.name != \"integTest\" }.forEach {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8ee37ee1ed56f2a13da79d7bba1298095dbc4ef8"}, "originalPosition": 18}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e69d77f6e8ecc872995957a4de3f1cba87c945c", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/1e69d77f6e8ecc872995957a4de3f1cba87c945c", "committedDate": "2020-06-17T21:44:33Z", "message": "Add spock integration testing to the project and gradle-plugin module.\n\nThis script Create a script to allow spock integration testing.\n\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\n* Create a script that adds spock integration testing for a module\n* Add integration testing to the gradle-plugin module\n* Create an integ test that validates the pegasus plugin can be applied"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8ee37ee1ed56f2a13da79d7bba1298095dbc4ef8", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/8ee37ee1ed56f2a13da79d7bba1298095dbc4ef8", "committedDate": "2020-06-17T21:34:38Z", "message": "Add spock integration testing to the project and gradle-plugin module.\n\nThis script Create a script to allow spock integration testing.\n\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\n* Create a script that adds spock integration testing for a module\n* Add integration testing to the gradle-plugin module\n* Create an integ test that validates the pegasus plugin can be applied"}, "afterCommit": {"oid": "1e69d77f6e8ecc872995957a4de3f1cba87c945c", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/1e69d77f6e8ecc872995957a4de3f1cba87c945c", "committedDate": "2020-06-17T21:44:33Z", "message": "Add spock integration testing to the project and gradle-plugin module.\n\nThis script Create a script to allow spock integration testing.\n\nAs per https://guides.gradle.org/testing-gradle-plugins/#integration-tests:\nIntegration tests or \"functional tests verify the correctness of the [Gradle]\nplugin end-to-end. In practice that means applying, configuring and\nexecuting the functionality of the plugin implementation\".\n\n* Create a script that adds spock integration testing for a module\n* Add integration testing to the gradle-plugin module\n* Create an integ test that validates the pegasus plugin can be applied"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2MTA2MjY5", "url": "https://github.com/linkedin/rest.li/pull/328#pullrequestreview-436106269", "createdAt": "2020-06-23T19:53:12Z", "commit": {"oid": "1e69d77f6e8ecc872995957a4de3f1cba87c945c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5522a5bd56fe9429e208abbdf82416c67ba55f19", "author": {"user": {"login": "Astro03", "name": "Astro D Ashtaralnakhai"}}, "url": "https://github.com/linkedin/rest.li/commit/5522a5bd56fe9429e208abbdf82416c67ba55f19", "committedDate": "2020-06-23T20:08:34Z", "message": "Merge branch 'master' into fpe/add-integTest-to-gradle-plugin"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4843, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}