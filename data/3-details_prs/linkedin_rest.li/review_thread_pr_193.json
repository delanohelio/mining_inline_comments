{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNTI0MzMx", "number": 193, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoxMTowNFrODjQtxg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwMToyOTozMVrODjqyyg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzAwNjE0OnYy", "diffSide": "RIGHT", "path": "data/src/main/java/com/linkedin/data/schema/PathSpec.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoxMTowNFrOFu-OnQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoxMTowNFrOFu-OnQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc5ODM2NQ==", "bodyText": "Just use Collection", "url": "https://github.com/linkedin/rest.li/pull/193#discussion_r384798365", "createdAt": "2020-02-26T22:11:04Z", "author": {"login": "karthikbalasub"}, "path": "data/src/main/java/com/linkedin/data/schema/PathSpec.java", "diffHunk": "@@ -84,6 +86,17 @@ public PathSpec(String... segments)\n     _path = new ArrayList<String>(Arrays.asList(segments));\n   }\n \n+  /**\n+   * Construct a new {@link PathSpec} from {@link AbstractCollection} type\n+   *\n+   * @param pathSpecCollection the collection that contains path segments.\n+   */\n+  public PathSpec(AbstractCollection<String> pathSpecCollection)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53b5ba4b920b412e7cc0656f49dffc8b2a76b517"}, "originalPosition": 18}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzAxMDY2OnYy", "diffSide": "RIGHT", "path": "data/src/main/java/com/linkedin/data/schema/PathSpec.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoxMjozMlrOFu-RXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoxMjozMlrOFu-RXw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc5OTA3MQ==", "bodyText": "initialize size using Collection::size()", "url": "https://github.com/linkedin/rest.li/pull/193#discussion_r384799071", "createdAt": "2020-02-26T22:12:32Z", "author": {"login": "karthikbalasub"}, "path": "data/src/main/java/com/linkedin/data/schema/PathSpec.java", "diffHunk": "@@ -84,6 +86,17 @@ public PathSpec(String... segments)\n     _path = new ArrayList<String>(Arrays.asList(segments));\n   }\n \n+  /**\n+   * Construct a new {@link PathSpec} from {@link AbstractCollection} type\n+   *\n+   * @param pathSpecCollection the collection that contains path segments.\n+   */\n+  public PathSpec(AbstractCollection<String> pathSpecCollection)\n+  {\n+    _path = new ArrayList<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53b5ba4b920b412e7cc0656f49dffc8b2a76b517"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzAxODIyOnYy", "diffSide": "RIGHT", "path": "gradle-plugins/src/main/java/com/linkedin/pegasus/gradle/tasks/ValidateSchemaAnnotationTask.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoxNTowOFrOFu-WEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoyMjo0NFrOFu-jqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgwMDI3Mw==", "bodyText": "Why is it okay to skip?", "url": "https://github.com/linkedin/rest.li/pull/193#discussion_r384800273", "createdAt": "2020-02-26T22:15:08Z", "author": {"login": "karthikbalasub"}, "path": "gradle-plugins/src/main/java/com/linkedin/pegasus/gradle/tasks/ValidateSchemaAnnotationTask.java", "diffHunk": "@@ -198,10 +198,16 @@ private void checkHandlerAnnotation(String name, List<String> foundClasses) thro\n             return;\n           }\n         }\n-      } catch (ClassNotFoundException e)\n+      }\n+      catch (ClassNotFoundException e)\n       {\n         throw new IOException(\"Failed to load class while scanning classes\", e);\n       }\n+      catch (Exception | Error e)\n+      {\n+        getProject().getLogger()\n+                    .info(\"Unexpected exceptions or errors found during scanning class, ok to skip\", e);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53b5ba4b920b412e7cc0656f49dffc8b2a76b517"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgwMzc1NQ==", "bodyText": "Sorry I found I made a mistake regarding the content to publish. Let me create a separate view for above change.\nI want this review to only focus on PathSpec key type change", "url": "https://github.com/linkedin/rest.li/pull/193#discussion_r384803755", "createdAt": "2020-02-26T22:22:44Z", "author": {"login": "junchuanwang"}, "path": "gradle-plugins/src/main/java/com/linkedin/pegasus/gradle/tasks/ValidateSchemaAnnotationTask.java", "diffHunk": "@@ -198,10 +198,16 @@ private void checkHandlerAnnotation(String name, List<String> foundClasses) thro\n             return;\n           }\n         }\n-      } catch (ClassNotFoundException e)\n+      }\n+      catch (ClassNotFoundException e)\n       {\n         throw new IOException(\"Failed to load class while scanning classes\", e);\n       }\n+      catch (Exception | Error e)\n+      {\n+        getProject().getLogger()\n+                    .info(\"Unexpected exceptions or errors found during scanning class, ok to skip\", e);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgwMDI3Mw=="}, "originalCommit": {"oid": "53b5ba4b920b412e7cc0656f49dffc8b2a76b517"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzA0NDc3OnYy", "diffSide": "RIGHT", "path": "data/src/test/java/com/linkedin/data/schema/annotation/TestSchemaAnnotationProcessor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoyMzo0NFrOFu-l0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMjoyMzo0NFrOFu-l0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgwNDMwNg==", "bodyText": "Only change in test?", "url": "https://github.com/linkedin/rest.li/pull/193#discussion_r384804306", "createdAt": "2020-02-26T22:23:44Z", "author": {"login": "mchen07"}, "path": "data/src/test/java/com/linkedin/data/schema/annotation/TestSchemaAnnotationProcessor.java", "diffHunk": "@@ -344,7 +345,7 @@ public void testDenormalizedSchemaProcessing(String filePath, List<List<String>>\n     ResolvedPropertiesReaderVisitor resolvedPropertiesReaderVisitor = new ResolvedPropertiesReaderVisitor();\n     DataSchemaRichContextTraverser traverser = new DataSchemaRichContextTraverser(resolvedPropertiesReaderVisitor);\n     traverser.traverse(result.getResultSchema());\n-    Map<String, Map<String, Object>> pathSpecToResolvedPropertiesMap = resolvedPropertiesReaderVisitor.getLeafFieldsPathSpecToResolvedPropertiesMap();\n+    Map<PathSpec, Map<String, Object>> pathSpecToResolvedPropertiesMap = resolvedPropertiesReaderVisitor.getLeafFieldsPathSpecToResolvedPropertiesMap();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "138c0bc457a4c4f4c96a0bea738d19a61a2fffb8"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NzI3ODgyOnYy", "diffSide": "RIGHT", "path": "data/src/main/java/com/linkedin/data/schema/annotation/ResolvedPropertiesReaderVisitor.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwMToyOTozMVrOFvm33A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQwMToyOTozMVrOFvm33A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQ2NDI4NA==", "bodyText": "I understand that you need to rename the method to avoid conflicts, but this is very wordy. I'd suggest cutting it down. How about getLeafFieldToResolvedPropertiesMap? You don't need to say \"pathSpec\" because it's implied based on the return type.", "url": "https://github.com/linkedin/rest.li/pull/193#discussion_r385464284", "createdAt": "2020-02-28T01:29:31Z", "author": {"login": "evanw555"}, "path": "data/src/main/java/com/linkedin/data/schema/annotation/ResolvedPropertiesReaderVisitor.java", "diffHunk": "@@ -122,8 +122,26 @@ public void callbackOnContext(DataSchemaRichContextTraverser.TraverserContext co\n     return null;\n   }\n \n-  public Map<PathSpec, Map<String, Object>> getLeafFieldsPathSpecToResolvedPropertiesMap()\n+  /**\n+   * This method is deprecated and should not be used due to performance consideration, because this method will generate string and use that as map keys,\n+   * and it is not necessarily memory-efficient.\n+   *\n+   * User should use {@link #getLeafFieldsPathSpecObjToResolvedPropertiesMap}, which use PathSpec object as map key.\n+   * @return a map with {@link PathSpec} string points to leaf field as map key and the resolved properties as its value\n+   *\n+   */\n+  @Deprecated\n+  public Map<String, Map<String, Object>> getLeafFieldsPathSpecToResolvedPropertiesMap()\n   {\n-    return _leafFieldsPathSpecToResolvedPropertiesMap;\n+    return _leafFieldsPathSpecObjToResolvedPropertiesMap.entrySet()\n+                                                        .stream()\n+                                                        .collect(Collectors.toMap(e -> e.getKey().toString(),\n+                                                                                  Map.Entry::getValue));\n+\n+  }\n+\n+  public Map<PathSpec, Map<String, Object>> getLeafFieldsPathSpecObjToResolvedPropertiesMap()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3371afcbc35cdd85e376ac0e583c035b023a3df7"}, "originalPosition": 69}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 589, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}