{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI3NzUxNTg5", "number": 487, "title": "Enable cycle check when serializing only when assertions are enabled.", "bodyText": "This is to avoid severe performance degradation at high QPS due to ThreadLocal slowdown.\nSee: https://jira.atlassian.com/browse/JRASERVER-71058 for a similar issue.", "createdAt": "2020-11-26T00:14:11Z", "url": "https://github.com/linkedin/rest.li/pull/487", "merged": true, "mergeCommit": {"oid": "722db7cc97a948f01aa81e23e9e7902241cf0d14"}, "closed": true, "closedAt": "2020-11-30T18:49:34Z", "author": {"login": "karthikrg"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdgLpHygFqTUzODk5MzU3NQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdga9GigBqjQwNDQwMTMzMDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM4OTkzNTc1", "url": "https://github.com/linkedin/rest.li/pull/487#pullrequestreview-538993575", "createdAt": "2020-11-26T04:55:26Z", "commit": {"oid": "ad39c40fb615fb58b5d0e838ff54fc8f7f70c125"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwNDo1NToyNlrOH6L2JA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNlQwNDo1NTo1NlrOH6L2ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc3MzU0MA==", "bodyText": "nit: record cycles when assertions are .. (remove comma)", "url": "https://github.com/linkedin/rest.li/pull/487#discussion_r530773540", "createdAt": "2020-11-26T04:55:26Z", "author": {"login": "karthikbalasub"}, "path": "data/src/main/java/com/linkedin/data/Data.java", "diffHunk": "@@ -112,8 +112,15 @@\n   /**\n    * Supplier for cycle checker used when traversing instances using a {@link Data.TraverseCallback}. Applications can\n    * choose to replace this with a supplier vending custom implementations, at their own risk of ensuring correctness.\n+   *\n+   * <p>The default implementation uses a {@link ThreadLocal} in every {@link DataList} and {@link DataMap} to detect\n+   * and record cycles, when assertions are enabled, and does NO checks when assertions are disabled.</p>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad39c40fb615fb58b5d0e838ff54fc8f7f70c125"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDc3MzY2Mg==", "bodyText": "nice!", "url": "https://github.com/linkedin/rest.li/pull/487#discussion_r530773662", "createdAt": "2020-11-26T04:55:56Z", "author": {"login": "karthikbalasub"}, "path": "data/src/main/java/com/linkedin/data/Data.java", "diffHunk": "@@ -112,8 +112,15 @@\n   /**\n    * Supplier for cycle checker used when traversing instances using a {@link Data.TraverseCallback}. Applications can\n    * choose to replace this with a supplier vending custom implementations, at their own risk of ensuring correctness.\n+   *\n+   * <p>The default implementation uses a {@link ThreadLocal} in every {@link DataList} and {@link DataMap} to detect\n+   * and record cycles, when assertions are enabled, and does NO checks when assertions are disabled.</p>\n    */\n-  private static Supplier<CycleChecker> CYCLE_CHECKER_SUPPLIER = DefaultCycleChecker::new;\n+  private static Supplier<CycleChecker> CYCLE_CHECKER_SUPPLIER = () -> {\n+    boolean assertionsEnabled = false;\n+    assert assertionsEnabled = true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ad39c40fb615fb58b5d0e838ff54fc8f7f70c125"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d43b29e2438a12f426ff379fad29f0f3d712bb68", "author": {"user": {"login": "li-kramgopa", "name": null}}, "url": "https://github.com/linkedin/rest.li/commit/d43b29e2438a12f426ff379fad29f0f3d712bb68", "committedDate": "2020-11-26T22:46:52Z", "message": "Enable cycle check when serializing only when assertions are enabled, to avoid severe performance degradation at high QPS due to ThreadLocal slowdown."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ad39c40fb615fb58b5d0e838ff54fc8f7f70c125", "author": {"user": {"login": "li-kramgopa", "name": null}}, "url": "https://github.com/linkedin/rest.li/commit/ad39c40fb615fb58b5d0e838ff54fc8f7f70c125", "committedDate": "2020-11-26T00:13:12Z", "message": "Enable cycle check when serializing only when assertions are enabled, to avoid severe performance degradation at high QPS due to ThreadLocal slowdown."}, "afterCommit": {"oid": "d43b29e2438a12f426ff379fad29f0f3d712bb68", "author": {"user": {"login": "li-kramgopa", "name": null}}, "url": "https://github.com/linkedin/rest.li/commit/d43b29e2438a12f426ff379fad29f0f3d712bb68", "committedDate": "2020-11-26T22:46:52Z", "message": "Enable cycle check when serializing only when assertions are enabled, to avoid severe performance degradation at high QPS due to ThreadLocal slowdown."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4592, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}