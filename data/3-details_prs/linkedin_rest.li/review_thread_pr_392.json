{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDcxMjAyMjI5", "number": 392, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTo0MTozOFrOEark3Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTo0NTozOFrOEarqBw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NDEyMzgxOnYy", "diffSide": "RIGHT", "path": "darkcluster/src/main/java/com/linkedin/darkcluster/api/DarkDispatcherVerifier.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTo0MTozOFrOHEQuVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTo0ODo0MFrOHEQ8cA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIzMDM1Nw==", "bodyText": "this name can be confused with the other Verifier ... and you can't tell what's what when configuring config properties. What about DarkCustomGatekeeper? DarkGatekeeper?", "url": "https://github.com/linkedin/rest.li/pull/392#discussion_r474230357", "createdAt": "2020-08-20T19:41:38Z", "author": {"login": "davidhoa"}, "path": "darkcluster/src/main/java/com/linkedin/darkcluster/api/DarkDispatcherVerifier.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package com.linkedin.darkcluster.api;\n+\n+import com.linkedin.r2.message.RequestContext;\n+import com.linkedin.r2.message.rest.RestRequest;\n+\n+\n+/**\n+ * Interface that lets users define custom logic to determine if a given request is to be dispatched to dark cluster or not.\n+ */\n+@FunctionalInterface\n+public interface DarkDispatcherVerifier", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b862a5d635bf16266893973d68cdfa4fb8308960"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIzMzk2OA==", "bodyText": "Will call it DarkGateKeeper", "url": "https://github.com/linkedin/rest.li/pull/392#discussion_r474233968", "createdAt": "2020-08-20T19:48:40Z", "author": {"login": "srikrish-19"}, "path": "darkcluster/src/main/java/com/linkedin/darkcluster/api/DarkDispatcherVerifier.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package com.linkedin.darkcluster.api;\n+\n+import com.linkedin.r2.message.RequestContext;\n+import com.linkedin.r2.message.rest.RestRequest;\n+\n+\n+/**\n+ * Interface that lets users define custom logic to determine if a given request is to be dispatched to dark cluster or not.\n+ */\n+@FunctionalInterface\n+public interface DarkDispatcherVerifier", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIzMDM1Nw=="}, "originalCommit": {"oid": "b862a5d635bf16266893973d68cdfa4fb8308960"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk2NDEzNzAzOnYy", "diffSide": "RIGHT", "path": "darkcluster/src/main/java/com/linkedin/darkcluster/impl/DarkClusterManagerImpl.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTo0NTozOFrOHEQ2pg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQxOTo0NTozOFrOHEQ2pg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIzMjQ4Ng==", "bodyText": "lets  create a no op implementation and do the null check here, instead of on every request.", "url": "https://github.com/linkedin/rest.li/pull/392#discussion_r474232486", "createdAt": "2020-08-20T19:45:38Z", "author": {"login": "davidhoa"}, "path": "darkcluster/src/main/java/com/linkedin/darkcluster/impl/DarkClusterManagerImpl.java", "diffHunk": "@@ -54,19 +54,27 @@\n   private final Facilities _facilities;\n   private final String _sourceClusterName;\n   private final DarkClusterStrategyFactory _darkClusterStrategyFactory;\n+  private final DarkDispatcherVerifier _darkDispatcherVerifier;\n   private Map<String, AtomicReference<URIRewriter>> _uriRewriterMap;\n \n   public DarkClusterManagerImpl(@Nonnull String sourceClusterName, @Nonnull Facilities facilities,\n                                 @Nonnull DarkClusterStrategyFactory strategyFactory, String whiteListRegEx,\n                                 String blackListRegEx, @Nonnull Notifier notifier)\n   {\n+    this(sourceClusterName, facilities, strategyFactory, whiteListRegEx, blackListRegEx, notifier, null);\n+  }\n+\n+  public DarkClusterManagerImpl(@Nonnull String sourceClusterName, @Nonnull Facilities facilities,\n+      @Nonnull DarkClusterStrategyFactory strategyFactory, String whiteListRegEx,\n+      String blackListRegEx, @Nonnull Notifier notifier, DarkDispatcherVerifier darkDispatcherVerifier) {\n     _whiteListRegEx = whiteListRegEx == null ? null : Pattern.compile(whiteListRegEx);\n     _blackListRegEx = blackListRegEx == null ? null : Pattern.compile(blackListRegEx);\n     _notifier = notifier;\n     _facilities = facilities;\n     _sourceClusterName = sourceClusterName;\n     _darkClusterStrategyFactory = strategyFactory;\n     _uriRewriterMap = new HashMap<>();\n+    _darkDispatcherVerifier = darkDispatcherVerifier;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b862a5d635bf16266893973d68cdfa4fb8308960"}, "originalPosition": 40}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 321, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}