{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzMTg2NDM1", "number": 286, "title": "Set up automated releases, improve helper scripts", "bodyText": "Sets up automatic Bintray publications in Travis whenever a tag is pushed. Improves/moves the local-release and release scripts. Also bumps the Bintray Gradle plugin, and bumps the project version to 28.3.4.\nAlso adds an explicit dependency for assemble on buildTestArtifacts for projects where test artifacts are published (i.e. d2, darkcluster). The only reason this wasn't a problem earlier is because d2 happened to add some custom tasks which resulted in testJar ultimately getting run. Once darkcluster was added, this wasn't the case and the test artifacts weren't being built.\nNote:\n\nThis makes the release workflow and helper scripts exactly the same as in ParSeq.\nOnce this is merged, I'll test the process by releasing 28.3.4", "createdAt": "2020-05-04T21:09:52Z", "url": "https://github.com/linkedin/rest.li/pull/286", "merged": true, "mergeCommit": {"oid": "946432981596e0d6d8cf26c72349f25b1d035973"}, "closed": true, "closedAt": "2020-05-07T02:25:49Z", "author": {"login": "evanw555"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABceGQhMgFqTQwNTM1NjU2MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcezuYpABqjMzMTA5NTA1NTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1MzU2NTYw", "url": "https://github.com/linkedin/rest.li/pull/286#pullrequestreview-405356560", "createdAt": "2020-05-04T21:21:17Z", "commit": {"oid": "9755a86732eeefc15f65d8b78d0b7a4fd26a75ce"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQyMToyMToxN1rOGQSqRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQyMToyMToxN1rOGQSqRg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTczNjEzNA==", "bodyText": "28.3.4 is already in master, please rebase master", "url": "https://github.com/linkedin/rest.li/pull/286#discussion_r419736134", "createdAt": "2020-05-04T21:21:17Z", "author": {"login": "nickibi"}, "path": "gradle.properties", "diffHunk": "@@ -1,4 +1,4 @@\n-version=28.3.3\n+version=28.3.4", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9755a86732eeefc15f65d8b78d0b7a4fd26a75ce"}, "originalPosition": 2}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9755a86732eeefc15f65d8b78d0b7a4fd26a75ce", "author": {"user": {"login": "evanw555", "name": "Evan Williams"}}, "url": "https://github.com/linkedin/rest.li/commit/9755a86732eeefc15f65d8b78d0b7a4fd26a75ce", "committedDate": "2020-05-04T21:07:00Z", "message": "Set up automated releases, improve helper scripts\n\nSets up automatic Bintray publications in Travis whenever a tag is\npushed. Improves/moves the local-release and release scripts. Also bumps\nthe Bintray Gradle plugin, and bumps the project version to 28.3.4."}, "afterCommit": {"oid": "fa2ee4d87e350e122d25e24921945aff50ef4ea3", "author": {"user": {"login": "evanw555", "name": "Evan Williams"}}, "url": "https://github.com/linkedin/rest.li/commit/fa2ee4d87e350e122d25e24921945aff50ef4ea3", "committedDate": "2020-05-04T21:42:56Z", "message": "Set up automated releases, improve helper scripts\n\nSets up automatic Bintray publications in Travis whenever a tag is\npushed. Improves/moves the local-release and release scripts. Also bumps\nthe Bintray Gradle plugin, and bumps the project version to 28.3.5."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1NTQyMzY0", "url": "https://github.com/linkedin/rest.li/pull/286#pullrequestreview-405542364", "createdAt": "2020-05-05T07:15:53Z", "commit": {"oid": "69ed5a7408aedad77b10c4d612aaff53890f4ece"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwNzoxNTo1M1rOGQdHLQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQwNzoxNTo1M1rOGQdHLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTkwNzM3Mw==", "bodyText": "can you add super_secret, plain text credentials to our internal wiki? for hotfix releases and bookkeeping\nalso, are these required here? can we not add these in repository settings?", "url": "https://github.com/linkedin/rest.li/pull/286#discussion_r419907373", "createdAt": "2020-05-05T07:15:53Z", "author": {"login": "aman1309"}, "path": ".travis.yml", "diffHunk": "@@ -1,20 +1,40 @@\n language: java\n-\n-# Skip testing for now, since this is experimental\n-script: ./gradlew build -x test\n-\n jdk:\n   - oraclejdk8\n \n+# Anything after trusty doesn't have Java 8\n dist: trusty\n \n # Below skips the installation step completely (https://docs.travis-ci.com/user/customizing-the-build/#Skipping-the-Installation-Step)\n-# If we don't skip it, Travis runs unnecessary Gradle tasks like './gradlew assemble'\n-install:\n-  - true\n+# If we don't skip it Travis runs unnecessary Gradle tasks like './gradlew assemble'\n+install: true\n \n-# Only build on master and release tags\n+# Build and test commits to master, PRs to master, and release tags\n+# Skip testing for now, since this is experimental\n+script: ./gradlew build -x test\n branches:\n   only:\n-  - master\n-  - /^v\\d+\\.\\d+\\.\\d+$/\n+    - master\n+    - /^v\\d+\\.\\d+\\.\\d+$/\n+\n+# Set environment variables (includes Bintray credentials)\n+env:\n+  global:\n+    - secure: 'DJbT0+O3W57jxaXmpVvuY4AH5VDqAgvmAwtw9GLK7fHhntmKMh8o43xWU7Tmv5LUPDU/UChXzte5fRPSe75KvkS72Rie02M/MSizO9B9fWGQ5trzWqCqGO4mI38v9e2PfInOWa7R/FA3z1NYas11CulkTXQI+a10po7nzIMrEnM='\n+    - secure: 'b4Q5mdqAQJcyuDyvxZK6MiImxho18HteKMDT0UANpIyrFXEfzWKIlB110unofXSXKiI0bAg+ob/PLRULkB/wuj69WasXRiH83+Ao2WpNbWyMoqPwiY/DL8MN0M1RhHbuSMso/O6C34eRImhj5NDcN+nkI+py8pHAq9FNrmQ92O4='", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69ed5a7408aedad77b10c4d612aaff53890f4ece"}, "originalPosition": 34}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1OTgyNTI0", "url": "https://github.com/linkedin/rest.li/pull/286#pullrequestreview-405982524", "createdAt": "2020-05-05T17:00:25Z", "commit": {"oid": "69ed5a7408aedad77b10c4d612aaff53890f4ece"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzowMDoyNVrOGQy8BQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxNzowMDoyNVrOGQy8BQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI2NDk2NQ==", "bodyText": "What's the plan to delete this one?", "url": "https://github.com/linkedin/rest.li/pull/286#discussion_r420264965", "createdAt": "2020-05-05T17:00:25Z", "author": {"login": "nickibi"}, "path": "local-release", "diffHunk": "@@ -1,25 +1,5 @@\n #!/bin/sh\n-# The purpose of this script is to publish artifacts to ~/local-repo\n-\n-if [ ! -d \"$HOME\" ]; then\n-  echo 'Cannot perform local release, $HOME is not set to a valid directory'\n-  exit 1\n-fi\n-\n-LOCAL_REPO=\"${HOME}/local-repo\"\n-\n-if [ ! -d $LOCAL_REPO ]; then\n-  mkdir $LOCAL_REPO\n-fi\n-\n-VERSION=$(awk 'BEGIN { FS = \"=\" }; $1 == \"version\" { print $2 }' gradle.properties | awk '{ print $1 }')\n-echo \"Publishing pegasus $VERSION to ${LOCAL_REPO}...\"\n-\n-./gradlew -Dmaven.repo.local=$LOCAL_REPO publishReleasePublicationToMavenLocal\n-\n-if [ $? -eq 0 ]; then\n-  echo \"Published pegasus $VERSION to $LOCAL_REPO\"\n-else\n-  exit 1\n-fi\n \n+# TODO: delete this eventually\n+echo 'This script has been moved to ./scripts/local-release'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69ed5a7408aedad77b10c4d612aaff53890f4ece"}, "originalPosition": 27}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA1OTg0NDcz", "url": "https://github.com/linkedin/rest.li/pull/286#pullrequestreview-405984473", "createdAt": "2020-05-05T17:03:01Z", "commit": {"oid": "69ed5a7408aedad77b10c4d612aaff53890f4ece"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MDQzNjU1", "url": "https://github.com/linkedin/rest.li/pull/286#pullrequestreview-406043655", "createdAt": "2020-05-05T18:21:17Z", "commit": {"oid": "69ed5a7408aedad77b10c4d612aaff53890f4ece"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxODoyMToxN1rOGQ1_dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNVQxODoyMToxN1rOGQ1_dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDMxNDk5OA==", "bodyText": "The script is still doing only build (-x test), so this comment should be updated?", "url": "https://github.com/linkedin/rest.li/pull/286#discussion_r420314998", "createdAt": "2020-05-05T18:21:17Z", "author": {"login": "karthikbalasub"}, "path": ".travis.yml", "diffHunk": "@@ -1,20 +1,40 @@\n language: java\n-\n-# Skip testing for now, since this is experimental\n-script: ./gradlew build -x test\n-\n jdk:\n   - oraclejdk8\n \n+# Anything after trusty doesn't have Java 8\n dist: trusty\n \n # Below skips the installation step completely (https://docs.travis-ci.com/user/customizing-the-build/#Skipping-the-Installation-Step)\n-# If we don't skip it, Travis runs unnecessary Gradle tasks like './gradlew assemble'\n-install:\n-  - true\n+# If we don't skip it Travis runs unnecessary Gradle tasks like './gradlew assemble'\n+install: true\n \n-# Only build on master and release tags\n+# Build and test commits to master, PRs to master, and release tags", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69ed5a7408aedad77b10c4d612aaff53890f4ece"}, "originalPosition": 20}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2MDk4MzMw", "url": "https://github.com/linkedin/rest.li/pull/286#pullrequestreview-406098330", "createdAt": "2020-05-05T19:39:33Z", "commit": {"oid": "ac56788bb9f4e0cb3cb14f940484c83aa5736b5d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43015213a4f043515fb22697796dbf4e28b06568", "author": {"user": {"login": "evanw555", "name": "Evan Williams"}}, "url": "https://github.com/linkedin/rest.li/commit/43015213a4f043515fb22697796dbf4e28b06568", "committedDate": "2020-05-07T02:19:21Z", "message": "Set up automated releases, improve helper scripts\n\nSets up automatic Bintray publications in Travis whenever a tag is\npushed. Improves/moves the local-release and release scripts. Also bumps\nthe Bintray Gradle plugin, and bumps the project version to 28.3.6."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac56788bb9f4e0cb3cb14f940484c83aa5736b5d", "author": {"user": {"login": "evanw555", "name": "Evan Williams"}}, "url": "https://github.com/linkedin/rest.li/commit/ac56788bb9f4e0cb3cb14f940484c83aa5736b5d", "committedDate": "2020-05-05T18:34:50Z", "message": "Fix comments in .travis.yml"}, "afterCommit": {"oid": "43015213a4f043515fb22697796dbf4e28b06568", "author": {"user": {"login": "evanw555", "name": "Evan Williams"}}, "url": "https://github.com/linkedin/rest.li/commit/43015213a4f043515fb22697796dbf4e28b06568", "committedDate": "2020-05-07T02:19:21Z", "message": "Set up automated releases, improve helper scripts\n\nSets up automatic Bintray publications in Travis whenever a tag is\npushed. Improves/moves the local-release and release scripts. Also bumps\nthe Bintray Gradle plugin, and bumps the project version to 28.3.6."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4774, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}