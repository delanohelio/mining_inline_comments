{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc4NDE5Mjc2", "number": 405, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNzo0MDozN1rOEgF8EQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDozMzo1MlrOEghAbA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMDg3MTg1OnYy", "diffSide": "RIGHT", "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxNzo0MDozN1rOHMxC_A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMjo1OTo1NlrOHM6GCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE0ODU0MA==", "bodyText": "I don't see why \"parseSources\" should load from both locations.\nBased on my understanding: When SchemaDirectoryName == EXTENSION, the ExtensionSchemaResolver will be configured to resolve from both locations.\nAnd parseSource should only parse the extension schemas, right?", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483148540", "createdAt": "2020-09-03T17:40:37Z", "author": {"login": "karthikbalasub"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,10 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().startsWith(SchemaDirectoryName.PEGASUS.getName()) ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08a857d8c1f1d9e73e515f04196a2c4963527f85"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE4MDQxNg==", "bodyText": "The reason for doing this change is for users who don't want to create two parsers to call parse sources twice.\nThe other reason is that when I add the condition in this FileFormatDataSchemaParser, I had the pegasus base entry in mind.\nI also feel that extension schema only also make sense.\nFor the other question that resolve from both location, it is true, and it is in my existing unit test cases.", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483180416", "createdAt": "2020-09-03T18:37:12Z", "author": {"login": "BrianPin"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,10 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().startsWith(SchemaDirectoryName.PEGASUS.getName()) ||", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE0ODU0MA=="}, "originalCommit": {"oid": "08a857d8c1f1d9e73e515f04196a2c4963527f85"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI5Njc3OA==", "bodyText": "After offline discussion, I removed the support of parsing pegasus PDL by ExtensionSchemaResolver", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483296778", "createdAt": "2020-09-03T22:59:56Z", "author": {"login": "BrianPin"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,10 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().startsWith(SchemaDirectoryName.PEGASUS.getName()) ||", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE0ODU0MA=="}, "originalCommit": {"oid": "08a857d8c1f1d9e73e515f04196a2c4963527f85"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMTA5NTYzOnYy", "diffSide": "RIGHT", "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QxODo0NTozOFrOHMzQSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMzowMDoyMVrOHM6GiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE4NDcxNQ==", "bodyText": "I'd like to make a comment on the original condition logic itself. It took me a while to understand what this if-statement is checking for because it's unnecessarily convoluted. The original logic basically said:\nif entryName.startsWith(schemasDirectoryName) or isExtensionEntry()\n...where isExtensionEntry() checks that the schemas directory name is extensions and that the entry name starts with extensions/\nCouldn't this just be reduced to\nif entryName.startsWith(schemasDirectoryName + '/')? Since if the schema directory name is extensions, then it would be checking that it starts with extensions/ anyway\nIgnoring the fact that the name isExtensionEntry() is misleading and inaccurate (since it also checks the resolver's schemas directory name value, not just the entry), it doesn't even seem like this method is needed.\nSince you're changing this logic, though, my suggestion is that you simplify this if-statement to make it more comprehensible.", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483184715", "createdAt": "2020-09-03T18:45:38Z", "author": {"login": "evanw555"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,10 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().startsWith(SchemaDirectoryName.PEGASUS.getName()) ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08a857d8c1f1d9e73e515f04196a2c4963527f85"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI5NjkwNA==", "bodyText": "@evanw555 , I modified the logic, please have a look", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483296904", "createdAt": "2020-09-03T23:00:21Z", "author": {"login": "BrianPin"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,10 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().startsWith(SchemaDirectoryName.PEGASUS.getName()) ||", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzE4NDcxNQ=="}, "originalCommit": {"oid": "08a857d8c1f1d9e73e515f04196a2c4963527f85"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMTkwMjYxOnYy", "diffSide": "RIGHT", "path": "CHANGELOG.md", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMzo0NDo1M1rOHM646g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wM1QyMzo0NDo1M1rOHM646g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMwOTgwMg==", "bodyText": "Update the changelog according to current version.", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483309802", "createdAt": "2020-09-03T23:44:53Z", "author": {"login": "nickibi"}, "path": "CHANGELOG.md", "diffHunk": "@@ -13,6 +13,7 @@ When updating the changelog, remember to be very clear about what behavior has c\n and what APIs have changed, if applicable.\n \n ## [Unreleased]\n+- Fix a bug in FileFormatDataSchemaParser, where jar entry match failed because of case", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71c0a06342e9c00e0d685134f2eac931bc97a782"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMjI2MjcyOnYy", "diffSide": "RIGHT", "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwMzoyMjowNFrOHM-KBg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwNDoyMjoxNlrOHM_BCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2MzMzNA==", "bodyText": "I'm not sure what the original logic (before the SchemaDirectoryName change) looked like, but would it make sense to add a + \"/\" to the check? Otherwise cases like pegasusFoo/Foo.pdl would not be filtered out. However, we need to make sure we don't break existing behavior.\n\n\nI'm curious about this bug. Why do we want to allow case-insensitive matches? I'll follow up offline.", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483363334", "createdAt": "2020-09-04T03:22:04Z", "author": {"login": "evanw555"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,9 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().toLowerCase().startsWith(_schemaResolver.getSchemasDirectoryName().name().toLowerCase())))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "71c0a06342e9c00e0d685134f2eac931bc97a782"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NjE0Nw==", "bodyText": "For #1 , yeah more or less your idea is great, but the original logic is like this\nFor #2, it is because we add to jar with lower cases, but the directory name defined Resolver is in upper case. That is why we need case insensitive. Follow up with me offline anytime", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483366147", "createdAt": "2020-09-04T03:34:31Z", "author": {"login": "BrianPin"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,9 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().toLowerCase().startsWith(_schemaResolver.getSchemasDirectoryName().name().toLowerCase())))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2MzMzNA=="}, "originalCommit": {"oid": "71c0a06342e9c00e0d685134f2eac931bc97a782"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NzMzNA==", "bodyText": "If this is the case, ignoring the case is generally ok.\nbut why did we add to jar using lower case ?", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483367334", "createdAt": "2020-09-04T03:40:09Z", "author": {"login": "junchuanwang"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,9 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().toLowerCase().startsWith(_schemaResolver.getSchemasDirectoryName().name().toLowerCase())))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2MzMzNA=="}, "originalCommit": {"oid": "71c0a06342e9c00e0d685134f2eac931bc97a782"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2ODgyMA==", "bodyText": "It is one of the original choice I guess", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483368820", "createdAt": "2020-09-04T03:46:54Z", "author": {"login": "BrianPin"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,9 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().toLowerCase().startsWith(_schemaResolver.getSchemasDirectoryName().name().toLowerCase())))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2MzMzNA=="}, "originalCommit": {"oid": "71c0a06342e9c00e0d685134f2eac931bc97a782"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM3NzQxNw==", "bodyText": "When a enum is being used, the method name() will return its original form which in our case is all upper cases. On the other hand, the method getName() will return the actual coded content literal, which in our is all lower cases.\nIn the beginning of my very first PR of this parser, I was using name() so it is not matching the configured entry prefix in jar, but I have the isExtensionEntry to help to rescue.", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483377417", "createdAt": "2020-09-04T04:22:16Z", "author": {"login": "BrianPin"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,9 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().toLowerCase().startsWith(_schemaResolver.getSchemasDirectoryName().name().toLowerCase())))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2MzMzNA=="}, "originalCommit": {"oid": "71c0a06342e9c00e0d685134f2eac931bc97a782"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyMzA5MjM4OnYy", "diffSide": "RIGHT", "path": "generator/src/test/java/com/linkedin/pegasus/generator/TestDataSchemaParser.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQwOTowMzo0N1rOHNFzQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQxOTo1NDoyM1rOHNZ-6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQ4ODU3OA==", "bodyText": "I don't think this test is covering the change made in the code.\nCan you add a test case that also has extension schemas in the jar?\nAnd a case where the extension schema includes a schema in /pegasus/ directory.", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483488578", "createdAt": "2020-09-04T09:03:47Z", "author": {"login": "karthikbalasub"}, "path": "generator/src/test/java/com/linkedin/pegasus/generator/TestDataSchemaParser.java", "diffHunk": "@@ -172,6 +172,54 @@ public void testSchemaFilesInExtensionPathInJar(String[] files, String[] expecte\n     }\n   }\n \n+  @DataProvider(name = \"PegasusSchemasWithExtensionResolver\")\n+  private Object[][] createPegasusSchemasWithExtensionResolver()\n+  {\n+    return new Object[][]\n+        {\n+            {\n+                new String[]{\n+                    \"pegasus/Foo.pdl\",\n+                    \"pegasus/Bar.pdl\",\n+                    \"pegasus/Fuzz.pdsc\"\n+                },\n+                new String[]{}\n+            },\n+        };\n+  }\n+\n+  @Test(dataProvider = \"PegasusSchemasWithExtensionResolver\")\n+  public void testBaseSchemaFilesInExtensionResolverInJar(String[] files, String[] expected) throws Exception", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d0d110ed70ad188f62ea5012cf29938308d2d86"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc5NjAyNQ==", "bodyText": "Karthik, The scenario you described is already in the same test class.  For extension schema project\nThere were 2 test scenario here\n\nextensions and pegasus in jar\nextensions and pegasus in path\n\nThe one I added here is to guarantee we dont parse pegasus schema in the jar\nWhich is a conclusion after viewing your comment and discuss with the team", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483796025", "createdAt": "2020-09-04T18:53:49Z", "author": {"login": "BrianPin"}, "path": "generator/src/test/java/com/linkedin/pegasus/generator/TestDataSchemaParser.java", "diffHunk": "@@ -172,6 +172,54 @@ public void testSchemaFilesInExtensionPathInJar(String[] files, String[] expecte\n     }\n   }\n \n+  @DataProvider(name = \"PegasusSchemasWithExtensionResolver\")\n+  private Object[][] createPegasusSchemasWithExtensionResolver()\n+  {\n+    return new Object[][]\n+        {\n+            {\n+                new String[]{\n+                    \"pegasus/Foo.pdl\",\n+                    \"pegasus/Bar.pdl\",\n+                    \"pegasus/Fuzz.pdsc\"\n+                },\n+                new String[]{}\n+            },\n+        };\n+  }\n+\n+  @Test(dataProvider = \"PegasusSchemasWithExtensionResolver\")\n+  public void testBaseSchemaFilesInExtensionResolverInJar(String[] files, String[] expected) throws Exception", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQ4ODU3OA=="}, "originalCommit": {"oid": "0d0d110ed70ad188f62ea5012cf29938308d2d86"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzc5NzY4OA==", "bodyText": "In that case, can we merge this testcase with the dataprovider above? No need to keep them separate", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483797688", "createdAt": "2020-09-04T18:57:52Z", "author": {"login": "karthikbalasub"}, "path": "generator/src/test/java/com/linkedin/pegasus/generator/TestDataSchemaParser.java", "diffHunk": "@@ -172,6 +172,54 @@ public void testSchemaFilesInExtensionPathInJar(String[] files, String[] expecte\n     }\n   }\n \n+  @DataProvider(name = \"PegasusSchemasWithExtensionResolver\")\n+  private Object[][] createPegasusSchemasWithExtensionResolver()\n+  {\n+    return new Object[][]\n+        {\n+            {\n+                new String[]{\n+                    \"pegasus/Foo.pdl\",\n+                    \"pegasus/Bar.pdl\",\n+                    \"pegasus/Fuzz.pdsc\"\n+                },\n+                new String[]{}\n+            },\n+        };\n+  }\n+\n+  @Test(dataProvider = \"PegasusSchemasWithExtensionResolver\")\n+  public void testBaseSchemaFilesInExtensionResolverInJar(String[] files, String[] expected) throws Exception", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQ4ODU3OA=="}, "originalCommit": {"oid": "0d0d110ed70ad188f62ea5012cf29938308d2d86"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgxOTI0Mw==", "bodyText": "Yes, merged the tests, resolving this comment for now.", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483819243", "createdAt": "2020-09-04T19:54:23Z", "author": {"login": "BrianPin"}, "path": "generator/src/test/java/com/linkedin/pegasus/generator/TestDataSchemaParser.java", "diffHunk": "@@ -172,6 +172,54 @@ public void testSchemaFilesInExtensionPathInJar(String[] files, String[] expecte\n     }\n   }\n \n+  @DataProvider(name = \"PegasusSchemasWithExtensionResolver\")\n+  private Object[][] createPegasusSchemasWithExtensionResolver()\n+  {\n+    return new Object[][]\n+        {\n+            {\n+                new String[]{\n+                    \"pegasus/Foo.pdl\",\n+                    \"pegasus/Bar.pdl\",\n+                    \"pegasus/Fuzz.pdsc\"\n+                },\n+                new String[]{}\n+            },\n+        };\n+  }\n+\n+  @Test(dataProvider = \"PegasusSchemasWithExtensionResolver\")\n+  public void testBaseSchemaFilesInExtensionResolverInJar(String[] files, String[] expected) throws Exception", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQ4ODU3OA=="}, "originalCommit": {"oid": "0d0d110ed70ad188f62ea5012cf29938308d2d86"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzAyNTMwNjY4OnYy", "diffSide": "RIGHT", "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMDozMzo1MlrOHNa1kQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wNFQyMTowMjozMFrOHNbaYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzMzIzMw==", "bodyText": "Just use SchemaDirectorName::getName here. Also I agree that we shouldn't ignore case.\nFollowing check should be enough:\nentry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName() + \"/\")", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483833233", "createdAt": "2020-09-04T20:33:52Z", "author": {"login": "karthikbalasub"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,9 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().toLowerCase().startsWith(_schemaResolver.getSchemasDirectoryName().name().toLowerCase() + \"/\")))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91d4bc56c25e268cd018692d799def41912e7fd2"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDMxOQ==", "bodyText": "Ok", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483840319", "createdAt": "2020-09-04T20:55:33Z", "author": {"login": "BrianPin"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,9 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().toLowerCase().startsWith(_schemaResolver.getSchemasDirectoryName().name().toLowerCase() + \"/\")))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzMzIzMw=="}, "originalCommit": {"oid": "91d4bc56c25e268cd018692d799def41912e7fd2"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MjY1Ng==", "bodyText": "Addressed", "url": "https://github.com/linkedin/rest.li/pull/405#discussion_r483842656", "createdAt": "2020-09-04T21:02:30Z", "author": {"login": "BrianPin"}, "path": "generator/src/main/java/com/linkedin/pegasus/generator/FileFormatDataSchemaParser.java", "diffHunk": "@@ -92,8 +92,9 @@ public FileFormatDataSchemaParser(String resolverPath, DataSchemaResolver schema\n               while (entries.hasMoreElements())\n               {\n                 final JarEntry entry = entries.nextElement();\n-                if (!entry.isDirectory() && entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n-                    (entry.getName().startsWith(_schemaResolver.getSchemasDirectoryName().getName()) || isExtensionEntry(entry)))\n+                if (!entry.isDirectory() &&\n+                    entry.getName().endsWith(_schemaParserFactory.getLanguageExtension()) &&\n+                    (entry.getName().toLowerCase().startsWith(_schemaResolver.getSchemasDirectoryName().name().toLowerCase() + \"/\")))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgzMzIzMw=="}, "originalCommit": {"oid": "91d4bc56c25e268cd018692d799def41912e7fd2"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 334, "cost": 1, "resetAt": "2021-11-12T20:44:06Z"}}}