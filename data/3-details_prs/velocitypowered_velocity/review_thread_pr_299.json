{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5MTU3NzQw", "number": 299, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMToxMDozOVrOD2Zozg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMjo0MTo0N1rOD2agwg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4MzY5NzQyOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/com/velocitypowered/api/command/CommandManager.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMToxMDozOVrOGMKHbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMToxODozN1rOGMKNEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwMTgzNw==", "bodyText": "This is the biggest problem I have with this. I am not a big fan of exposing a method like this. Could we do a bit better?\nOn an additional note, I think we should probably deprecate execute and friends and just outright replace them with *async variants. We'll clean up the API mess later on.", "url": "https://github.com/VelocityPowered/Velocity/pull/299#discussion_r415401837", "createdAt": "2020-04-26T21:10:39Z", "author": {"login": "astei"}, "path": "api/src/main/java/com/velocitypowered/api/command/CommandManager.java", "diffHunk": "@@ -35,10 +35,21 @@\n \n   /**\n    * Attempts to execute a command from the specified {@code cmdLine}.\n+   * CommandExecuteEvent will not called\n    *\n    * @param source the command's source\n    * @param cmdLine the command to run\n    * @return true if the command was found and executed, false if it was not\n    */\n   boolean execute(CommandSource source, String cmdLine);\n+\n+  /**\n+   * Attempts to execute a command from the specified {@code cmdLine}.\n+   *\n+   * @param source the command's source\n+   * @param cmdLine the command to run\n+   * @param callEvent will CommandExecuteEvent called or not\n+   * @return true if the command was found and executed, false if it was not\n+   */\n+  boolean execute(CommandSource source, String cmdLine, boolean callEvent);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1fb382e0f6b4fcb7c2100cabe0a284ce01862e89"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwMzI4MQ==", "bodyText": "I think its not problem, because execute will be called from event/scheduler thread pool in 99% cases. I think we should not messy this with async stuff.", "url": "https://github.com/VelocityPowered/Velocity/pull/299#discussion_r415403281", "createdAt": "2020-04-26T21:18:37Z", "author": {"login": "Leymooo"}, "path": "api/src/main/java/com/velocitypowered/api/command/CommandManager.java", "diffHunk": "@@ -35,10 +35,21 @@\n \n   /**\n    * Attempts to execute a command from the specified {@code cmdLine}.\n+   * CommandExecuteEvent will not called\n    *\n    * @param source the command's source\n    * @param cmdLine the command to run\n    * @return true if the command was found and executed, false if it was not\n    */\n   boolean execute(CommandSource source, String cmdLine);\n+\n+  /**\n+   * Attempts to execute a command from the specified {@code cmdLine}.\n+   *\n+   * @param source the command's source\n+   * @param cmdLine the command to run\n+   * @param callEvent will CommandExecuteEvent called or not\n+   * @return true if the command was found and executed, false if it was not\n+   */\n+  boolean execute(CommandSource source, String cmdLine, boolean callEvent);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQwMTgzNw=="}, "originalCommit": {"oid": "1fb382e0f6b4fcb7c2100cabe0a284ce01862e89"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4MzgzNTIwOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/com/velocitypowered/api/event/command/CommandExecuteEvent.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMjozODozMVrOGMLEyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMjozODozMVrOGMLEyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQxNzU0Nw==", "bodyText": "CommandExecuteEvent", "url": "https://github.com/VelocityPowered/Velocity/pull/299#discussion_r415417547", "createdAt": "2020-04-26T22:38:31Z", "author": {"login": "astei"}, "path": "api/src/main/java/com/velocitypowered/api/event/command/CommandExecuteEvent.java", "diffHunk": "@@ -0,0 +1,143 @@\n+package com.velocitypowered.api.event.command;\n+\n+import com.google.common.base.Preconditions;\n+import com.velocitypowered.api.command.CommandSource;\n+import com.velocitypowered.api.event.ResultedEvent;\n+import com.velocitypowered.api.event.command.CommandExecuteEvent.CommandResult;\n+import java.util.Optional;\n+import org.checkerframework.checker.nullness.qual.NonNull;\n+import org.checkerframework.checker.nullness.qual.Nullable;\n+\n+/**\n+ * This event is fired when a player types in a chat message.\n+ */\n+public final class CommandExecuteEvent implements ResultedEvent<CommandResult> {\n+\n+  private final CommandSource commandSource;\n+  private final String command;\n+  private CommandResult result;\n+\n+  /**\n+   * Constructs a PlayerChatEvent.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0b8e9d646cf94877c89f0b6d631ebb484f58ca2"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4MzgzNzkyOnYy", "diffSide": "RIGHT", "path": "proxy/src/main/java/com/velocitypowered/proxy/command/VelocityCommandManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMjo0MDoxOFrOGMLGBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMjo0MDoxOFrOGMLGBA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQxNzg2MA==", "bodyText": "source, not invoker\n(This is a typo in the original code. Whoops!)", "url": "https://github.com/VelocityPowered/Velocity/pull/299#discussion_r415417860", "createdAt": "2020-04-26T22:40:18Z", "author": {"login": "astei"}, "path": "proxy/src/main/java/com/velocitypowered/proxy/command/VelocityCommandManager.java", "diffHunk": "@@ -47,11 +57,38 @@ public void unregister(final String alias) {\n     this.commands.remove(alias.toLowerCase(Locale.ENGLISH));\n   }\n \n+  /**\n+   * Calls CommandExecuteEvent.\n+   * @param source the command's source\n+   * @param cmd the command\n+   * @return CompletableFuture of event\n+   */\n+  public CompletableFuture<CommandExecuteEvent> callCommandEvent(CommandSource source, String cmd) {\n+    Preconditions.checkNotNull(source, \"invoker\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0b8e9d646cf94877c89f0b6d631ebb484f58ca2"}, "originalPosition": 38}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4MzgzOTExOnYy", "diffSide": "RIGHT", "path": "api/src/main/java/com/velocitypowered/api/command/CommandManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMjo0MTowMVrOGMLGiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMjo0MTowMVrOGMLGiQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQxNzk5Mw==", "bodyText": "I'd like to add @Deprecated here", "url": "https://github.com/VelocityPowered/Velocity/pull/299#discussion_r415417993", "createdAt": "2020-04-26T22:41:01Z", "author": {"login": "astei"}, "path": "api/src/main/java/com/velocitypowered/api/command/CommandManager.java", "diffHunk": "@@ -34,11 +36,42 @@\n   void unregister(String alias);\n \n   /**\n-   * Attempts to execute a command from the specified {@code cmdLine}.\n+   * Calls CommandExecuteEvent and attempts to execute a command from the specified {@code cmdLine}\n+   * sync.\n    *\n    * @param source the command's source\n    * @param cmdLine the command to run\n    * @return true if the command was found and executed, false if it was not\n    */\n   boolean execute(CommandSource source, String cmdLine);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0b8e9d646cf94877c89f0b6d631ebb484f58ca2"}, "originalPosition": 20}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU4Mzg0MDY2OnYy", "diffSide": "RIGHT", "path": "api/src/main/java/com/velocitypowered/api/command/CommandManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMjo0MTo0N1rOGMLHNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yNlQyMjo0MTo0N1rOGMLHNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTQxODE2Nw==", "bodyText": "Velocity has no concept of sync. More accurately this could say Attempts to execute a command using the specified {@code cmdLine} in a blocking fashion.", "url": "https://github.com/VelocityPowered/Velocity/pull/299#discussion_r415418167", "createdAt": "2020-04-26T22:41:47Z", "author": {"login": "astei"}, "path": "api/src/main/java/com/velocitypowered/api/command/CommandManager.java", "diffHunk": "@@ -34,11 +36,42 @@\n   void unregister(String alias);\n \n   /**\n-   * Attempts to execute a command from the specified {@code cmdLine}.\n+   * Calls CommandExecuteEvent and attempts to execute a command from the specified {@code cmdLine}\n+   * sync.\n    *\n    * @param source the command's source\n    * @param cmdLine the command to run\n    * @return true if the command was found and executed, false if it was not\n    */\n   boolean execute(CommandSource source, String cmdLine);\n+\n+  /**\n+   * Attempts to execute a command from the specified {@code cmdLine} sync", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c0b8e9d646cf94877c89f0b6d631ebb484f58ca2"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2737, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}