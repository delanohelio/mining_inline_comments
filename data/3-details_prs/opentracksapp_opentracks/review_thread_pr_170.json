{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0Njc1OTY4", "number": 170, "reviewThreads": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxODoyMDo1NlrODsLgDw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNjoyMjoyMlrODswG7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjUyMzY3OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxODoyMDo1NlrOF88-yw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxMDozNTo1M1rOF9IhCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ1Nzk5NQ==", "bodyText": ":)\ntrue &&", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399457995", "createdAt": "2020-03-27T18:20:56Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -416,9 +453,12 @@ private void updateMenuItems(boolean isPaused) {\n         String title;\n         if (isRecording()) {\n             title = getString(isPaused ? R.string.generic_paused : R.string.generic_recording);\n+            resumeMenuItem.setVisible(false);\n         } else {\n             Track track = contentProviderUtils.getTrack(trackId);\n             title = track != null ? track.getName() : \"\";\n+            // Only visible if there aren't other tracks that is recording.\n+            resumeMenuItem.setVisible(true && recordingTrackId == -1L);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 118}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY0Njk4NA==", "bodyText": "Jajajajajajajaja.\nI don't know what I was thinking about.\nPS/ That's a great anecdote. I'll remember ever :D", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399646984", "createdAt": "2020-03-28T10:35:53Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -416,9 +453,12 @@ private void updateMenuItems(boolean isPaused) {\n         String title;\n         if (isRecording()) {\n             title = getString(isPaused ? R.string.generic_paused : R.string.generic_recording);\n+            resumeMenuItem.setVisible(false);\n         } else {\n             Track track = contentProviderUtils.getTrack(trackId);\n             title = track != null ? track.getName() : \"\";\n+            // Only visible if there aren't other tracks that is recording.\n+            resumeMenuItem.setVisible(true && recordingTrackId == -1L);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ1Nzk5NQ=="}, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 118}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjUzMDkwOnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxODoyMzowMFrOF89DUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxMDo0NTo1MVrOF9IkZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ1OTE1NQ==", "bodyText": "I am not sure the log message is correct; I guess it is more could not get service.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399459155", "createdAt": "2020-03-27T18:23:00Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -89,6 +92,27 @@ public void run() {\n                     trackController.update(isRecording(), recordingTrackPaused);\n                 }\n             });\n+\n+            if (recordingTrackId == -1L) {\n+                TrackRecordingServiceInterface service = trackRecordingServiceConnection.getServiceIfBound();\n+                if (service == null) {\n+                    Log.d(TAG, \"service not available to start gps or a new recording\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 30}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY0Nzg0NA==", "bodyText": "Yes, I didn't understand this message. I get it from old TrackListActivity and I mantained it like was. I'm going to change it.\nPS/ I use the same structure: all in lowercase and without period in the end of the sentence.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399647844", "createdAt": "2020-03-28T10:45:51Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -89,6 +92,27 @@ public void run() {\n                     trackController.update(isRecording(), recordingTrackPaused);\n                 }\n             });\n+\n+            if (recordingTrackId == -1L) {\n+                TrackRecordingServiceInterface service = trackRecordingServiceConnection.getServiceIfBound();\n+                if (service == null) {\n+                    Log.d(TAG, \"service not available to start gps or a new recording\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ1OTE1NQ=="}, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 30}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjU0Nzg5OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxODoyODowNlrOF89OPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxMDo1OTozNFrOF9Io-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ2MTk1MA==", "bodyText": "I am not a fan of these assignments.\nThey tend to look like boolean comparisions.\nWould you use separate assignments?", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399461950", "createdAt": "2020-03-27T18:28:06Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -89,6 +92,27 @@ public void run() {\n                     trackController.update(isRecording(), recordingTrackPaused);\n                 }\n             });\n+\n+            if (recordingTrackId == -1L) {\n+                TrackRecordingServiceInterface service = trackRecordingServiceConnection.getServiceIfBound();\n+                if (service == null) {\n+                    Log.d(TAG, \"service not available to start gps or a new recording\");\n+                    return;\n+                }\n+\n+                int msg;\n+                if (trackId == -1L) {\n+                    trackId = recordingTrackId = service.startNewTrack();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY0OTAxOQ==", "bodyText": "Of course, also I get recordingTrackId = trackId out from if-else.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399649019", "createdAt": "2020-03-28T10:59:34Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -89,6 +92,27 @@ public void run() {\n                     trackController.update(isRecording(), recordingTrackPaused);\n                 }\n             });\n+\n+            if (recordingTrackId == -1L) {\n+                TrackRecordingServiceInterface service = trackRecordingServiceConnection.getServiceIfBound();\n+                if (service == null) {\n+                    Log.d(TAG, \"service not available to start gps or a new recording\");\n+                    return;\n+                }\n+\n+                int msg;\n+                if (trackId == -1L) {\n+                    trackId = recordingTrackId = service.startNewTrack();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ2MTk1MA=="}, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 36}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjU1MzAzOnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxODoyOTozMFrOF89RYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxMTowNTo1MVrOF9Iq9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ2Mjc1NQ==", "bodyText": "Please document that trackId == -1 leads to a new track.\nThere should be at least a comment on top of the class.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399462755", "createdAt": "2020-03-27T18:29:30Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -89,6 +92,27 @@ public void run() {\n                     trackController.update(isRecording(), recordingTrackPaused);\n                 }\n             });\n+\n+            if (recordingTrackId == -1L) {\n+                TrackRecordingServiceInterface service = trackRecordingServiceConnection.getServiceIfBound();\n+                if (service == null) {\n+                    Log.d(TAG, \"service not available to start gps or a new recording\");\n+                    return;\n+                }\n+\n+                int msg;\n+                if (trackId == -1L) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY0OTUyNg==", "bodyText": "Ok. What do you think these comments?\n// Starts or resumes a track.\nint msg;\nif (trackId == -1L) {\n    // trackId isn't initialized -> leads a new recording.\n    trackId = service.startNewTrack();\n    msg = R.string.track_detail_record_success;\n} else {\n    // trackId is initialized -> resumes the track.\n    service.resumeTrack(trackId);\n    msg = R.string.track_detail_resume_success;\n}\n\n// A recording track is on.\nrecordingTrackId = trackId;\nToast.makeText(TrackDetailActivity.this, msg, Toast.LENGTH_SHORT).show();\ntrackDataHub.loadTrack(trackId);\ntrackController.onResume(isRecording(), recordingTrackPaused);\n\n\nThere should be at least a comment on top of the class.\n\nNow the class comment says \"An activity to show the track detail.\"\nBut this class do more things: show track detail and show and handle recording/resumes/stop track. So, what would you comment this class?", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399649526", "createdAt": "2020-03-28T11:05:51Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -89,6 +92,27 @@ public void run() {\n                     trackController.update(isRecording(), recordingTrackPaused);\n                 }\n             });\n+\n+            if (recordingTrackId == -1L) {\n+                TrackRecordingServiceInterface service = trackRecordingServiceConnection.getServiceIfBound();\n+                if (service == null) {\n+                    Log.d(TAG, \"service not available to start gps or a new recording\");\n+                    return;\n+                }\n+\n+                int msg;\n+                if (trackId == -1L) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ2Mjc1NQ=="}, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 35}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjU1NzE4OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxODozMDo1OVrOF89ULg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxMDo1OToxOFrOF9Io7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ2MzQ3MA==", "bodyText": "Could you add a new line before?\nIt looks like the stuff before handles waypoints.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399463470", "createdAt": "2020-03-27T18:30:59Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -387,9 +421,12 @@ private void handleIntent(Intent intent) {\n                 return;\n             }\n             trackId = waypoint.getTrackId();\n+            if (trackId == -1L) {\n+                finish();\n+                return;\n+            }\n         }\n         if (trackId == -1L) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 104}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY0OTAwNA==", "bodyText": "Of course. It's clearer now.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399649004", "createdAt": "2020-03-28T10:59:18Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -387,9 +421,12 @@ private void handleIntent(Intent intent) {\n                 return;\n             }\n             trackId = waypoint.getTrackId();\n+            if (trackId == -1L) {\n+                finish();\n+                return;\n+            }\n         }\n         if (trackId == -1L) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ2MzQ3MA=="}, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 104}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3NjU2NjAxOnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/services/TrackRecordingService.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QxODozMzozMlrOF89Zlg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOFQxMDo1OToxMFrOF9Io5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ2NDg1NA==", "bodyText": "I would go for an Log.e()", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399464854", "createdAt": "2020-03-27T18:33:32Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/services/TrackRecordingService.java", "diffHunk": "@@ -352,6 +352,26 @@ long startNewTrack() {\n         return trackId;\n     }\n \n+    /**\n+     * Resumes the track identified by trackId.\n+     *\n+     * @param trackId\n+     */\n+    void resumeTrack(long trackId) {\n+        Track track = contentProviderUtils.getTrack(trackId);\n+        if (track == null) {\n+            Log.d(TAG, \"Ignore resumeTrack. Track \" + trackId + \" does not exists.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTY0ODk5OQ==", "bodyText": "Yes, it makes more sense.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399648999", "createdAt": "2020-03-28T10:59:10Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/services/TrackRecordingService.java", "diffHunk": "@@ -352,6 +352,26 @@ long startNewTrack() {\n         return trackId;\n     }\n \n+    /**\n+     * Resumes the track identified by trackId.\n+     *\n+     * @param trackId\n+     */\n+    void resumeTrack(long trackId) {\n+        Track track = contentProviderUtils.getTrack(trackId);\n+        if (track == null) {\n+            Log.d(TAG, \"Ignore resumeTrack. Track \" + trackId + \" does not exists.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTQ2NDg1NA=="}, "originalCommit": {"oid": "c400e8423f8a9596804ee356d5e7dca0d20cc8ce"}, "originalPosition": 12}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3OTI1NTk4OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOVQxNzoxMjoyN1rOF9TcKQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOVQxNzoxMjoyN1rOF9TcKQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTgyNTk2MQ==", "bodyText": "\"an existing one\"", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399825961", "createdAt": "2020-03-29T17:12:27Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -43,14 +45,15 @@\n import de.dennisguse.opentracks.fragments.ConfirmDeleteDialogFragment;\n import de.dennisguse.opentracks.fragments.StatsFragment;\n import de.dennisguse.opentracks.services.TrackRecordingServiceConnection;\n+import de.dennisguse.opentracks.services.TrackRecordingServiceInterface;\n import de.dennisguse.opentracks.settings.SettingsActivity;\n import de.dennisguse.opentracks.util.IntentUtils;\n import de.dennisguse.opentracks.util.PreferencesUtils;\n import de.dennisguse.opentracks.util.TrackIconUtils;\n import de.dennisguse.opentracks.util.TrackUtils;\n \n /**\n- * An activity to show the track detail.\n+ * An activity to show the track detail, record a new track or resumes an existed one.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1a5af9fbc22bdacefed467059f4425f41a246e5"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3OTI1ODY2OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/fragments/StatsFragment.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOVQxNzoxNToyN1rOF9TdgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yOVQxNzoxNToyN1rOF9TdgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTgyNjMwNA==", "bodyText": "Unused", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r399826304", "createdAt": "2020-03-29T17:15:27Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/fragments/StatsFragment.java", "diffHunk": "@@ -112,6 +112,7 @@ public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container,\n \n     private TextView totalTimeValueView;\n     private final Runnable updateUIeachSecond = new Runnable() {\n+        long i = 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f1a5af9fbc22bdacefed467059f4425f41a246e5"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ4MjUyMTQwOnYy", "diffSide": "LEFT", "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNjoyMjoyMlrOF9xzVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxNzoyNDoxM1rOF90Ssw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMyMzQxNQ==", "bodyText": "Why was finish() removed?\nThe activity should not start if it got an invalid parameter, right?", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r400323415", "createdAt": "2020-03-30T16:22:22Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -387,9 +428,13 @@ private void handleIntent(Intent intent) {\n                 return;\n             }\n             trackId = waypoint.getTrackId();\n+            if (trackId == -1L) {\n+                finish();\n+                return;\n+            }\n         }\n+\n         if (trackId == -1L) {\n-            finish();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dc7c94f24bfba86eb3f37020f77102704d873f67"}, "originalPosition": 122}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM2MjIwNg==", "bodyText": "That finish() was there because TrackDetailActivity needed it to show or to record a Track. Then TrackDetailActivity always needed the trackId.\nNow, if TrackDetailActivity is started without trackId is because is started to record a new Track, so in handleIntent it doesn't finish, because TrackDetailActivity will start the service and will got trackId by its own.\nLook at this (in onResume())\nif (trackId != -1L) {\n    trackDataHub.loadTrack(trackId);\n    trackController.onResume(isRecording(), recordingTrackPaused);\n} else {\n    startRecording();\n}\n\nIf there isn't trackId in EXTRA_TRACK_ID then it calls to startRecording. Otherwise it shows the track.\nSo, we could say that TrackDetailActivity handle three \"modes\":\n\nWith trackId it enters in mode show.\nWithout trackId (trackId == -1) it enters in mode recording.\nWith trackId if user click on record button it enters in mode resuming.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r400362206", "createdAt": "2020-03-30T17:21:07Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -387,9 +428,13 @@ private void handleIntent(Intent intent) {\n                 return;\n             }\n             trackId = waypoint.getTrackId();\n+            if (trackId == -1L) {\n+                finish();\n+                return;\n+            }\n         }\n+\n         if (trackId == -1L) {\n-            finish();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMyMzQxNQ=="}, "originalCommit": {"oid": "dc7c94f24bfba86eb3f37020f77102704d873f67"}, "originalPosition": 122}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDM2NDIxMQ==", "bodyText": "Thanks for the clarification!\nThen let's merge it ;)", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/170#discussion_r400364211", "createdAt": "2020-03-30T17:24:13Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/TrackDetailActivity.java", "diffHunk": "@@ -387,9 +428,13 @@ private void handleIntent(Intent intent) {\n                 return;\n             }\n             trackId = waypoint.getTrackId();\n+            if (trackId == -1L) {\n+                finish();\n+                return;\n+            }\n         }\n+\n         if (trackId == -1L) {\n-            finish();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDMyMzQxNQ=="}, "originalCommit": {"oid": "dc7c94f24bfba86eb3f37020f77102704d873f67"}, "originalPosition": 122}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1975, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}