{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM3NzAyOTY0", "number": 299, "title": "Restructuring TrackRecordingService", "bodyText": "Describe the pull request\nRestructuring TrackRecordingService.\nThe idea was original discussed in #246 where there is useful information.\nThe main idea is that TrackRecordingService only manages the lifetime of different handlers.\nLicense agreement\nBy opening this pull request, you are providing your contribution under the Apache License 2.0 (see LICENSE.md).", "createdAt": "2020-06-22T06:00:21Z", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/299", "merged": true, "mergeCommit": {"oid": "17de8cea6fba9c01bf72a1f6ac5c852e51d7852c"}, "closed": true, "closedAt": "2020-07-17T10:29:30Z", "author": {"login": "rgmf"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcubs2AgFqTQzNjc1NjUzNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc1xNMvAH2gAyNDM3NzAyOTY0OjBjZGQxOWUzZWMyY2RkZDI1ZjM5YzA1ZWM4NjljMWY0NmFkOGUxNTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM2NzU2NTM2", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/299#pullrequestreview-436756536", "createdAt": "2020-06-24T15:23:01Z", "commit": {"oid": "241c0954a8f8911b09437874658ae7404ecc4b39"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNToyMzowMVrOGoXPeA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0yNFQxNToyMzowMVrOGoXPeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDk3NzAxNg==", "bodyText": "rename to recordingGpsAccuracy :)", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/299#discussion_r444977016", "createdAt": "2020-06-24T15:23:01Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/services/HandlerServer.java", "diffHunk": "@@ -0,0 +1,61 @@\n+package de.dennisguse.opentracks.services;\n+\n+import android.content.Context;\n+import android.location.Location;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import de.dennisguse.opentracks.content.data.TrackPoint;\n+\n+public class HandlerServer {\n+    private String TAG = HandlerServer.class.getSimpleName();\n+\n+    private List<HandlerSubscriber> subscriberList;\n+\n+    private static HandlerServer handlerServerInstance;\n+    private final LocationHandler locationHandler;\n+    private final Context context;\n+\n+    public static HandlerServer getInstance(Context context) {\n+        if (handlerServerInstance == null) {\n+            handlerServerInstance = new HandlerServer(context);\n+        }\n+        return handlerServerInstance;\n+    }\n+\n+    private HandlerServer(Context context) {\n+        this.subscriberList = new ArrayList<>();\n+        this.locationHandler = new LocationHandler();\n+        this.context = context;\n+    }\n+\n+    public void subscribe(HandlerSubscriber s) {\n+        if (subscriberList.isEmpty()) {\n+            locationHandler.onStart(context);\n+        }\n+        if (!subscriberList.contains(s)) {\n+            subscriberList.add(s);\n+        }\n+    }\n+\n+    public void unsubscribe(HandlerSubscriber s) {\n+        if (subscriberList.contains(s)) {\n+            subscriberList.remove(s);\n+            if (subscriberList.isEmpty()) {\n+                locationHandler.onStop();\n+            }\n+        }\n+    }\n+\n+    public void sendTrackPoint(TrackPoint trackPoint, int gpsAccuracy) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "241c0954a8f8911b09437874658ae7404ecc4b39"}, "originalPosition": 51}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cb3a41d0c3cdbb083e8f3a33da8b24edde554eb9", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/cb3a41d0c3cdbb083e8f3a33da8b24edde554eb9", "committedDate": "2020-07-06T11:34:52Z", "message": "Service refactoring: created LocationHandlerTest."}, "afterCommit": {"oid": "d25f8fc3f618dc52a9f174e32810c20ef1ff04b7", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/d25f8fc3f618dc52a9f174e32810c20ef1ff04b7", "committedDate": "2020-07-06T14:48:52Z", "message": "Service refactoring: refactoring tests."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d25f8fc3f618dc52a9f174e32810c20ef1ff04b7", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/d25f8fc3f618dc52a9f174e32810c20ef1ff04b7", "committedDate": "2020-07-06T14:48:52Z", "message": "Service refactoring: refactoring tests."}, "afterCommit": {"oid": "214a766d3ad1fbbfb520cf421a2d8e5c0a7d3982", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/214a766d3ad1fbbfb520cf421a2d8e5c0a7d3982", "committedDate": "2020-07-08T14:21:22Z", "message": "Service refactoring: refactoring tests."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "214a766d3ad1fbbfb520cf421a2d8e5c0a7d3982", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/214a766d3ad1fbbfb520cf421a2d8e5c0a7d3982", "committedDate": "2020-07-08T14:21:22Z", "message": "Service refactoring: refactoring tests."}, "afterCommit": {"oid": "0cdd19e3ec2cddd25f39c05ec869c1f46ad8e158", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/0cdd19e3ec2cddd25f39c05ec869c1f46ad8e158", "committedDate": "2020-07-17T10:23:50Z", "message": "Service refactoring: move location management to the LocationHandle.\nTests refactoring: location and service tests re-worked."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0cdd19e3ec2cddd25f39c05ec869c1f46ad8e158", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/0cdd19e3ec2cddd25f39c05ec869c1f46ad8e158", "committedDate": "2020-07-17T10:23:50Z", "message": "Service refactoring: move location management to the LocationHandle.\nTests refactoring: location and service tests re-worked."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2231, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}