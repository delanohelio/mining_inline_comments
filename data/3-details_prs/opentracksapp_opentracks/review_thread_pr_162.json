{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5MTQxNjUy", "number": 162, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxOTowMjozNFrODod1rw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxOTowNDoyN1rODod34w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzU4NTExOnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/util/IntentUtils.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxOTowMjozNFrOF3CGPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwNjozMjowNVrOF33x8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDM2Ng==", "bodyText": "Could you use a line break after every sentence?\nIt is usually easier to read", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393250366", "createdAt": "2020-03-16T19:02:34Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/util/IntentUtils.java", "diffHunk": "@@ -99,6 +101,29 @@ public static Intent newShareFileIntent(Context context, long[] trackIds) {\n                 .putExtra(Intent.EXTRA_TEXT, context.getString(R.string.share_track_share_file_body, trackDescription));\n     }\n \n+    /**\n+     * Creates an intent to share a waypoint image with an app.\n+     *\n+     * @param context the context.\n+     * @param uri     uri with the image to share.\n+     */\n+    public static Intent newShareImageIntent(Context context, Uri uri) {\n+        String mime = context.getContentResolver().getType(uri);\n+\n+        // Because the #166 bug, when you import KMZ tracks then it creates file:/// from markers", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0125b940d55b1318c983772b182b1cb5bb576e5e"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5MDY1NA==", "bodyText": "Of course ;)", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393290654", "createdAt": "2020-03-16T20:26:37Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/util/IntentUtils.java", "diffHunk": "@@ -99,6 +101,29 @@ public static Intent newShareFileIntent(Context context, long[] trackIds) {\n                 .putExtra(Intent.EXTRA_TEXT, context.getString(R.string.share_track_share_file_body, trackDescription));\n     }\n \n+    /**\n+     * Creates an intent to share a waypoint image with an app.\n+     *\n+     * @param context the context.\n+     * @param uri     uri with the image to share.\n+     */\n+    public static Intent newShareImageIntent(Context context, Uri uri) {\n+        String mime = context.getContentResolver().getType(uri);\n+\n+        // Because the #166 bug, when you import KMZ tracks then it creates file:/// from markers", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDM2Ng=="}, "originalCommit": {"oid": "0125b940d55b1318c983772b182b1cb5bb576e5e"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDEyOTkwNw==", "bodyText": "This is the last one (I promise): but could you modify the comment layout to use:\n\n/* */\nBecause all\nWrite one sentence per line followed by a line break\nIt is usually easier to read and will apply the proper formatting depending on the IDE's window width.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r394129907", "createdAt": "2020-03-18T06:32:05Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/util/IntentUtils.java", "diffHunk": "@@ -99,6 +101,29 @@ public static Intent newShareFileIntent(Context context, long[] trackIds) {\n                 .putExtra(Intent.EXTRA_TEXT, context.getString(R.string.share_track_share_file_body, trackDescription));\n     }\n \n+    /**\n+     * Creates an intent to share a waypoint image with an app.\n+     *\n+     * @param context the context.\n+     * @param uri     uri with the image to share.\n+     */\n+    public static Intent newShareImageIntent(Context context, Uri uri) {\n+        String mime = context.getContentResolver().getType(uri);\n+\n+        // Because the #166 bug, when you import KMZ tracks then it creates file:/// from markers", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDM2Ng=="}, "originalCommit": {"oid": "0125b940d55b1318c983772b182b1cb5bb576e5e"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzU4NjYzOnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/fragments/MarkerDetailFragment.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxOTowMjo1OVrOF3CHKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMDo0MDo1MVrOF3E9UQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDYwMg==", "bodyText": "needs to be:\nintent = Intent.createChooser(intent, null);", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393250602", "createdAt": "2020-03-16T19:02:59Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/fragments/MarkerDetailFragment.java", "diffHunk": "@@ -188,6 +197,13 @@ public boolean onOptionsItemSelected(MenuItem item) {\n                         .putExtra(MarkerEditActivity.EXTRA_MARKER_ID, markerId);\n                 startActivity(intent);\n                 return true;\n+            case R.id.marker_detail_share:\n+                if (waypoint.hasPhoto()) {\n+                    intent = IntentUtils.newShareImageIntent(getContext(), waypoint.getPhotoURI());\n+                    Intent.createChooser(intent, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0125b940d55b1318c983772b182b1cb5bb576e5e"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5MTQwNg==", "bodyText": "Ops, you are right. Sorry ;)", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393291406", "createdAt": "2020-03-16T20:28:16Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/fragments/MarkerDetailFragment.java", "diffHunk": "@@ -188,6 +197,13 @@ public boolean onOptionsItemSelected(MenuItem item) {\n                         .putExtra(MarkerEditActivity.EXTRA_MARKER_ID, markerId);\n                 startActivity(intent);\n                 return true;\n+            case R.id.marker_detail_share:\n+                if (waypoint.hasPhoto()) {\n+                    intent = IntentUtils.newShareImageIntent(getContext(), waypoint.getPhotoURI());\n+                    Intent.createChooser(intent, null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDYwMg=="}, "originalCommit": {"oid": "0125b940d55b1318c983772b182b1cb5bb576e5e"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI5NzIzMw==", "bodyText": "Happens to me all the time :)", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393297233", "createdAt": "2020-03-16T20:40:51Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/fragments/MarkerDetailFragment.java", "diffHunk": "@@ -188,6 +197,13 @@ public boolean onOptionsItemSelected(MenuItem item) {\n                         .putExtra(MarkerEditActivity.EXTRA_MARKER_ID, markerId);\n                 startActivity(intent);\n                 return true;\n+            case R.id.marker_detail_share:\n+                if (waypoint.hasPhoto()) {\n+                    intent = IntentUtils.newShareImageIntent(getContext(), waypoint.getPhotoURI());\n+                    Intent.createChooser(intent, null);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MDYwMg=="}, "originalCommit": {"oid": "0125b940d55b1318c983772b182b1cb5bb576e5e"}, "originalPosition": 40}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNzU5MDc1OnYy", "diffSide": "RIGHT", "path": "src/main/java/de/dennisguse/opentracks/fragments/MarkerDetailFragment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxOTowNDoyN1rOF3CJ1g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQyMDoyNDoxOVrOF3Efgg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MTI4Ng==", "bodyText": "Is this null check required?\nAnd this code could actually be moved into the calling methods (as long as it is only one menuItem).", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393251286", "createdAt": "2020-03-16T19:04:27Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/fragments/MarkerDetailFragment.java", "diffHunk": "@@ -170,8 +173,14 @@ public void setMenuVisibility(boolean menuVisible) {\n     @Override\n     public void onCreateOptionsMenu(@NonNull Menu menu, MenuInflater inflater) {\n         inflater.inflate(R.menu.marker_detail, menu);\n-\n+        shareMarkerImageMenuItem = menu.findItem(R.id.marker_detail_share);\n         updateWaypoint(false);\n+        updateMenuItems();\n+    }\n+\n+    private void updateMenuItems() {\n+        if (shareMarkerImageMenuItem != null)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0125b940d55b1318c983772b182b1cb5bb576e5e"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI4OTYwMg==", "bodyText": "Yes, it's required because I need to check if this option must be hidden every time this MarkerDetailFragment is resumed.\nThe first time the user goes to the marker detail, MarkerDetailFragment onResume is execute and the menu isn't created yet so shareMarkerImageMenuItem is null.\nBut now, you imagine that you go to the detail of a marker with image. Then you edit the marker and you deletes the image. Later you go back to the MarkerDetailFragment, onResume is executed, shareMarkerImageMenuItem isn't null and it must be not visible because the image was deleted.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/162#discussion_r393289602", "createdAt": "2020-03-16T20:24:19Z", "author": {"login": "rgmf"}, "path": "src/main/java/de/dennisguse/opentracks/fragments/MarkerDetailFragment.java", "diffHunk": "@@ -170,8 +173,14 @@ public void setMenuVisibility(boolean menuVisible) {\n     @Override\n     public void onCreateOptionsMenu(@NonNull Menu menu, MenuInflater inflater) {\n         inflater.inflate(R.menu.marker_detail, menu);\n-\n+        shareMarkerImageMenuItem = menu.findItem(R.id.marker_detail_share);\n         updateWaypoint(false);\n+        updateMenuItems();\n+    }\n+\n+    private void updateMenuItems() {\n+        if (shareMarkerImageMenuItem != null)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzI1MTI4Ng=="}, "originalCommit": {"oid": "0125b940d55b1318c983772b182b1cb5bb576e5e"}, "originalPosition": 28}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1973, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}