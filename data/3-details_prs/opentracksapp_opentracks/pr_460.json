{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA1NDUxODMy", "number": 460, "title": "Export All: ask to the user when conflicts and show a summary.", "bodyText": "Re-coded ExportActivity. All the logic is in this Activity. Progress and Finish fragments have been deleted.\nThe transparent theme cannot be deleted because ImportActivity use it.\nExportActivity uses a JobIntentService (ExportService) to enqueue every track to export. This service return the result of exporting: overwritten, skipped and exported according to the user demand.\nThe ExportService returns through the receiver with a RESULT_UNKNOWN when it doesn't have how to resolve a conflict so the user could decide what to do and enqueue it once again.\nUser can abort/cancel the exporting process clicking twice the backbutton.\nThis fixes #451\nSome screenshots:", "createdAt": "2020-10-18T10:50:34Z", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460", "merged": true, "mergeCommit": {"oid": "70c13797788efd83d4eed32a4ca2f8c7f63922f3"}, "closed": true, "closedAt": "2020-10-20T10:07:59Z", "author": {"login": "rgmf"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdTufHcgFqTUxMTEzNzAwNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdUVzfTAH2gAyNTA1NDUxODMyOmU5NDVmNTg2ZmU0MjExNjU0ZDkwM2RlNTFjZTdlZmU2YTE0ZDk0Mzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTExMTM3MDA3", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#pullrequestreview-511137007", "createdAt": "2020-10-18T11:54:16Z", "commit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "state": "APPROVED", "comments": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQxMTo1NDoxN1rOHjnydw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xOFQxMjowNzozN1rOHjoHOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExNDEwMw==", "bodyText": "can we get landscape mode as well?\nEverything else supports this nowadays.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507114103", "createdAt": "2020-10-18T11:54:17Z", "author": {"login": "dennisguse"}, "path": "src/main/AndroidManifest.xml", "diffHunk": "@@ -154,9 +154,7 @@ limitations under the License.\n         <activity android:name=\".io.file.importer.DirectoryChooserActivity$ExportDirectoryChooserActivity\" />\n         <activity android:name=\".io.file.importer.DirectoryChooserActivity$DefaultTrackExportDirectoryChooserActivity\" />\n \n-        <activity\n-            android:name=\".io.file.exporter.ExportActivity\"\n-            android:theme=\"@style/ThemeCustomTransparentActivity\" />\n+        <activity android:name=\".io.file.exporter.ExportActivity\" android:screenOrientation=\"portrait\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExNTAwMQ==", "bodyText": "Under which circumstances can this happen?", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507115001", "createdAt": "2020-10-18T11:56:33Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/io/file/exporter/ExportService.java", "diffHunk": "@@ -0,0 +1,90 @@\n+package de.dennisguse.opentracks.io.file.exporter;\n+\n+import android.app.job.JobService;\n+import android.content.Context;\n+import android.content.Intent;\n+import android.net.Uri;\n+import android.os.Bundle;\n+import android.os.ResultReceiver;\n+\n+import androidx.annotation.NonNull;\n+import androidx.core.app.JobIntentService;\n+import androidx.documentfile.provider.DocumentFile;\n+\n+import de.dennisguse.opentracks.content.data.Track;\n+import de.dennisguse.opentracks.content.provider.ContentProviderUtils;\n+import de.dennisguse.opentracks.io.file.TrackFileFormat;\n+import de.dennisguse.opentracks.util.ExportUtils;\n+\n+public class ExportService extends JobIntentService {\n+\n+    private static final int JOB_ID = 1;\n+\n+    private static final String EXTRA_RECEIVER = \"extra_receiver\";\n+    private static final String EXTRA_TRACK_ID = \"extra_track_id\";\n+    private static final String EXTRA_TRACK_FILE_FORMAT = \"extra_track_file_format\";\n+    private static final String EXTRA_DIRECTORY_URI = \"extra_directory_uri\";\n+    private static final String EXTRA_CONFLICT_DECISION = \"extra_conflict_decision\";\n+\n+    public static final int CONFLICT_UNKNOWN = 0;\n+    public static final int CONFLICT_OVERWRITE = 1;\n+    public static final int CONFLICT_SKIP = 2;\n+\n+    public static void enqueue(Context context, ExportServiceResultReceiver receiver, Track.Id trackId, TrackFileFormat trackFileFormat, Uri directoryUri, int conflictDecision) {\n+        Intent intent = new Intent(context, JobService.class);\n+        intent.putExtra(EXTRA_RECEIVER, receiver);\n+        intent.putExtra(EXTRA_TRACK_ID, trackId);\n+        intent.putExtra(EXTRA_TRACK_FILE_FORMAT, trackFileFormat);\n+        intent.putExtra(EXTRA_DIRECTORY_URI, directoryUri);\n+        intent.putExtra(EXTRA_CONFLICT_DECISION, conflictDecision);\n+        enqueueWork(context, ExportService.class, JOB_ID, intent);\n+    }\n+\n+    @Override\n+    protected void onHandleWork(@NonNull Intent intent) {\n+        // Get all data.\n+        ResultReceiver resultReceiver = intent.getParcelableExtra(EXTRA_RECEIVER);\n+        Track.Id trackId = intent.getParcelableExtra(EXTRA_TRACK_ID);\n+        TrackFileFormat trackFileFormat = (TrackFileFormat) intent.getSerializableExtra(EXTRA_TRACK_FILE_FORMAT);\n+        Uri directoryUri = intent.getParcelableExtra(EXTRA_DIRECTORY_URI);\n+        int conflictDecision = intent.getIntExtra(EXTRA_CONFLICT_DECISION, CONFLICT_UNKNOWN);\n+\n+        // Build directory file.\n+        DocumentFile directoryFile = DocumentFile.fromTreeUri(this, directoryUri);\n+\n+        // Checks if the track is already exported in the directory.\n+        boolean fileAlreadyExists = ExportUtils.existsExportDocumentFile(trackId, trackFileFormat.getExtension(), directoryFile);\n+\n+        // Prepare resultCode and bundle to send to the receiver.\n+        int resultCode = getResultCode(fileAlreadyExists, conflictDecision);\n+        Bundle bundle = new Bundle();\n+        bundle.putParcelable(ExportServiceResultReceiver.RESULT_EXTRA_TRACK_ID, trackId);\n+        bundle.putBoolean(ExportServiceResultReceiver.RESULT_EXTRA_SUCCESS, false);\n+\n+        // If file doesn't exists or exists but conflict decision is overwrite then export the track.\n+        if (!fileAlreadyExists || (fileAlreadyExists && conflictDecision == CONFLICT_OVERWRITE)) {\n+            ContentProviderUtils contentProviderUtils = new ContentProviderUtils(this);\n+            Track track = contentProviderUtils.getTrack(trackId);\n+            boolean success = ExportUtils.exportTrack(this, trackFileFormat, directoryFile, track);\n+            bundle.putBoolean(ExportServiceResultReceiver.RESULT_EXTRA_SUCCESS, success);\n+        }\n+\n+        // Send result to the receiver.\n+        resultReceiver.send(resultCode, bundle);\n+    }\n+\n+    private int getResultCode(boolean fileExists, int conflictDecicions) {\n+        if (!fileExists) {\n+            return ExportServiceResultReceiver.RESULT_EXPORTED;\n+        }\n+\n+        switch (conflictDecicions) {\n+            case CONFLICT_OVERWRITE:\n+                return ExportServiceResultReceiver.RESULT_OVERWRITTEN;\n+            case CONFLICT_SKIP:\n+                return ExportServiceResultReceiver.RESULT_SKIPPED;\n+            default:\n+                return ExportServiceResultReceiver.RESULT_UNKNOWN;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 87}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExNTI5MQ==", "bodyText": "Can we get one sentence per line?\nAnd also I would put the description on top of the class rather than the constructor.\nWhen the documentation is generated, this will be the description.\nConstructor descriptions are only need (IMHO) if they do something unexpected.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507115291", "createdAt": "2020-10-18T11:57:15Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/io/file/exporter/ExportServiceResultReceiver.java", "diffHunk": "@@ -0,0 +1,44 @@\n+package de.dennisguse.opentracks.io.file.exporter;\n+\n+import android.os.Bundle;\n+import android.os.Handler;\n+import android.os.ResultReceiver;\n+\n+public class ExportServiceResultReceiver extends ResultReceiver {\n+\n+    public static final int RESULT_UNKNOWN = 100;\n+    public static final int RESULT_OVERWRITTEN = 101;\n+    public static final int RESULT_SKIPPED = 102;\n+    public static final int RESULT_EXPORTED = 103;\n+\n+    public static final String RESULT_EXTRA_TRACK_ID = \"result_extra_track_id\";\n+    public static final String RESULT_EXTRA_SUCCESS = \"result_extra_success\";\n+\n+    private Receiver receiver;\n+\n+    /**\n+     * Create a new ResultReceive to receive results.  Your", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExNjcxNQ==", "bodyText": "I have no better option, but the name is somehow not telling me what it does.\nSomething like: isExportFileExists (but sucks also) :)", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507116715", "createdAt": "2020-10-18T12:00:55Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/util/ExportUtils.java", "diffHunk": "@@ -59,6 +59,10 @@ public static DocumentFile getExportDocumentFile(Track.Id trackId, String trackF\n         return file;\n     }\n \n+    public static boolean existsExportDocumentFile(Track.Id trackId, String trackFileFormatExtension, DocumentFile directory) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExNjg4OQ==", "bodyText": "directory.findFile(getExportFileNameByTrackId(trackId, trackFileFormatExtension)) != null", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507116889", "createdAt": "2020-10-18T12:01:19Z", "author": {"login": "dennisguse"}, "path": "src/main/java/de/dennisguse/opentracks/util/ExportUtils.java", "diffHunk": "@@ -59,6 +59,10 @@ public static DocumentFile getExportDocumentFile(Track.Id trackId, String trackF\n         return file;\n     }\n \n+    public static boolean existsExportDocumentFile(Track.Id trackId, String trackFileFormatExtension, DocumentFile directory) {\n+        return directory.findFile(getExportFileNameByTrackId(trackId, trackFileFormatExtension)) == null ? false : true;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExNzE3MQ==", "bodyText": "sed s/!/./", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507117171", "createdAt": "2020-10-18T12:01:59Z", "author": {"login": "dennisguse"}, "path": "src/main/res/values/strings.xml", "diffHunk": "@@ -216,6 +216,21 @@ limitations under the License.\n     <string name=\"export_progress_message\">Exporting to %1$s&#8230;</string>\n     <string name=\"export_success\">Exported %1$s to %2$s</string>\n     <string name=\"export_title\">Export to&#8230;</string>\n+    <string name=\"export_track_already_exists_msg\">The track %1$s already exists at the destination directory!</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExNzI5Mg==", "bodyText": "sed s/an/one/", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507117292", "createdAt": "2020-10-18T12:02:17Z", "author": {"login": "dennisguse"}, "path": "src/main/res/values/strings.xml", "diffHunk": "@@ -216,6 +216,21 @@ limitations under the License.\n     <string name=\"export_progress_message\">Exporting to %1$s&#8230;</string>\n     <string name=\"export_success\">Exported %1$s to %2$s</string>\n     <string name=\"export_title\">Export to&#8230;</string>\n+    <string name=\"export_track_already_exists_msg\">The track %1$s already exists at the destination directory!</string>\n+    <string name=\"export_all_end_with_errors\">Completed with %1$d errors</string>\n+    <string name=\"export_all_end_with_error\">Completed with an error</string>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExNzkwNg==", "bodyText": "Why not use a checkbox?\nhttps://material.io/develop/android/components/checkboxes", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507117906", "createdAt": "2020-10-18T12:03:43Z", "author": {"login": "dennisguse"}, "path": "src/main/res/layout/export_progress_activity.xml", "diffHunk": "@@ -0,0 +1,141 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+\n+<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"match_parent\"\n+    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+    xmlns:tools=\"http://schemas.android.com/tools\"\n+    android:orientation=\"vertical\">\n+\n+    <include layout=\"@layout/toolbar\" />\n+\n+    <androidx.constraintlayout.widget.ConstraintLayout\n+        android:layout_weight=\"1\"\n+        android:layout_width=\"match_parent\"\n+        android:layout_height=\"match_parent\">\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_done\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginStart=\"24dp\"\n+            android:layout_marginTop=\"48dp\"\n+            app:layout_constraintEnd_toStartOf=\"@id/export_progress_slash\"\n+            app:layout_constraintHorizontal_chainStyle=\"packed\"\n+            app:layout_constraintStart_toStartOf=\"parent\"\n+            app:layout_constraintTop_toTopOf=\"parent\"\n+            tools:text=\"1\" />\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_slash\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:text=\"@string/generic_separator_done_total\"\n+            app:layout_constraintBottom_toBottomOf=\"@id/export_progress_done\"\n+            app:layout_constraintEnd_toStartOf=\"@id/export_progress_total\"\n+            app:layout_constraintStart_toEndOf=\"@id/export_progress_done\"\n+            app:layout_constraintTop_toTopOf=\"@id/export_progress_done\" />\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_total\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginEnd=\"24dp\"\n+            app:layout_constraintBottom_toBottomOf=\"@id/export_progress_slash\"\n+            app:layout_constraintEnd_toEndOf=\"parent\"\n+            app:layout_constraintStart_toEndOf=\"@id/export_progress_slash\"\n+            app:layout_constraintTop_toTopOf=\"@id/export_progress_slash\"\n+            tools:text=\"10\" />\n+\n+        <ProgressBar\n+            android:id=\"@+id/export_progress_bar\"\n+            style=\"@android:style/Widget.ProgressBar.Horizontal\"\n+            android:layout_width=\"match_parent\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginLeft=\"24dp\"\n+            android:layout_marginTop=\"8dp\"\n+            android:layout_marginRight=\"24dp\"\n+            app:layout_constraintEnd_toEndOf=\"parent\"\n+            app:layout_constraintStart_toStartOf=\"parent\"\n+            app:layout_constraintTop_toBottomOf=\"@id/export_progress_done\"\n+            tools:progress=\"25\" />\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_summary\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"match_parent\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_margin=\"24dp\"\n+            android:text=\"@string/export_progress_review\"\n+            app:layout_constraintEnd_toEndOf=\"parent\"\n+            app:layout_constraintStart_toStartOf=\"parent\"\n+            app:layout_constraintTop_toBottomOf=\"@id/export_progress_bar\" />\n+\n+        <ImageView\n+            android:id=\"@+id/export_progress_alert_icon\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginStart=\"24dp\"\n+            android:layout_marginEnd=\"8dp\"\n+            app:layout_constraintHorizontal_chainStyle=\"packed\"\n+            app:layout_constraintBottom_toBottomOf=\"@id/export_progress_alert_msg\"\n+            app:layout_constraintEnd_toStartOf=\"@id/export_progress_alert_msg\"\n+            app:layout_constraintStart_toStartOf=\"parent\"\n+            app:layout_constraintTop_toTopOf=\"@id/export_progress_alert_msg\"\n+            app:tint=\"@android:color/holo_red_dark\"\n+            app:srcCompat=\"@drawable/ic_report_problem_24\" />\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_alert_msg\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"0dp\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginTop=\"24dp\"\n+            android:layout_marginEnd=\"24dp\"\n+            android:layout_marginBottom=\"24dp\"\n+            app:layout_constraintBottom_toTopOf=\"@id/export_progress_toggle\"\n+            app:layout_constraintEnd_toEndOf=\"parent\"\n+            app:layout_constraintStart_toEndOf=\"@id/export_progress_alert_icon\"\n+            app:layout_constraintTop_toBottomOf=\"@id/export_progress_summary\"\n+            app:layout_constraintVertical_chainStyle=\"packed\"\n+            tools:text=\"The track already exists\" />\n+\n+        <androidx.appcompat.widget.SwitchCompat", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 106}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExODI4Ng==", "bodyText": "i have not checked, but it might give us a problem with day/night mode.\nFor this we need to access colors via ?attr.", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507118286", "createdAt": "2020-10-18T12:04:42Z", "author": {"login": "dennisguse"}, "path": "src/main/res/layout/export_progress_activity.xml", "diffHunk": "@@ -0,0 +1,141 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+\n+<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"match_parent\"\n+    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+    xmlns:tools=\"http://schemas.android.com/tools\"\n+    android:orientation=\"vertical\">\n+\n+    <include layout=\"@layout/toolbar\" />\n+\n+    <androidx.constraintlayout.widget.ConstraintLayout\n+        android:layout_weight=\"1\"\n+        android:layout_width=\"match_parent\"\n+        android:layout_height=\"match_parent\">\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_done\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginStart=\"24dp\"\n+            android:layout_marginTop=\"48dp\"\n+            app:layout_constraintEnd_toStartOf=\"@id/export_progress_slash\"\n+            app:layout_constraintHorizontal_chainStyle=\"packed\"\n+            app:layout_constraintStart_toStartOf=\"parent\"\n+            app:layout_constraintTop_toTopOf=\"parent\"\n+            tools:text=\"1\" />\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_slash\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:text=\"@string/generic_separator_done_total\"\n+            app:layout_constraintBottom_toBottomOf=\"@id/export_progress_done\"\n+            app:layout_constraintEnd_toStartOf=\"@id/export_progress_total\"\n+            app:layout_constraintStart_toEndOf=\"@id/export_progress_done\"\n+            app:layout_constraintTop_toTopOf=\"@id/export_progress_done\" />\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_total\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginEnd=\"24dp\"\n+            app:layout_constraintBottom_toBottomOf=\"@id/export_progress_slash\"\n+            app:layout_constraintEnd_toEndOf=\"parent\"\n+            app:layout_constraintStart_toEndOf=\"@id/export_progress_slash\"\n+            app:layout_constraintTop_toTopOf=\"@id/export_progress_slash\"\n+            tools:text=\"10\" />\n+\n+        <ProgressBar\n+            android:id=\"@+id/export_progress_bar\"\n+            style=\"@android:style/Widget.ProgressBar.Horizontal\"\n+            android:layout_width=\"match_parent\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginLeft=\"24dp\"\n+            android:layout_marginTop=\"8dp\"\n+            android:layout_marginRight=\"24dp\"\n+            app:layout_constraintEnd_toEndOf=\"parent\"\n+            app:layout_constraintStart_toStartOf=\"parent\"\n+            app:layout_constraintTop_toBottomOf=\"@id/export_progress_done\"\n+            tools:progress=\"25\" />\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_summary\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"match_parent\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_margin=\"24dp\"\n+            android:text=\"@string/export_progress_review\"\n+            app:layout_constraintEnd_toEndOf=\"parent\"\n+            app:layout_constraintStart_toStartOf=\"parent\"\n+            app:layout_constraintTop_toBottomOf=\"@id/export_progress_bar\" />\n+\n+        <ImageView\n+            android:id=\"@+id/export_progress_alert_icon\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginStart=\"24dp\"\n+            android:layout_marginEnd=\"8dp\"\n+            app:layout_constraintHorizontal_chainStyle=\"packed\"\n+            app:layout_constraintBottom_toBottomOf=\"@id/export_progress_alert_msg\"\n+            app:layout_constraintEnd_toStartOf=\"@id/export_progress_alert_msg\"\n+            app:layout_constraintStart_toStartOf=\"parent\"\n+            app:layout_constraintTop_toTopOf=\"@id/export_progress_alert_msg\"\n+            app:tint=\"@android:color/holo_red_dark\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 88}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzExOTQxOQ==", "bodyText": "We can move the progressbar into the actionbar, then it looks very similar to the dialog:\nNever done this, just know that it recommened for Material design: https://material.io/components/progress-indicators", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/460#discussion_r507119419", "createdAt": "2020-10-18T12:07:37Z", "author": {"login": "dennisguse"}, "path": "src/main/res/layout/export_progress_activity.xml", "diffHunk": "@@ -0,0 +1,141 @@\n+<?xml version=\"1.0\" encoding=\"utf-8\"?>\n+\n+<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n+    android:layout_width=\"match_parent\"\n+    android:layout_height=\"match_parent\"\n+    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n+    xmlns:tools=\"http://schemas.android.com/tools\"\n+    android:orientation=\"vertical\">\n+\n+    <include layout=\"@layout/toolbar\" />\n+\n+    <androidx.constraintlayout.widget.ConstraintLayout\n+        android:layout_weight=\"1\"\n+        android:layout_width=\"match_parent\"\n+        android:layout_height=\"match_parent\">\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_done\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginStart=\"24dp\"\n+            android:layout_marginTop=\"48dp\"\n+            app:layout_constraintEnd_toStartOf=\"@id/export_progress_slash\"\n+            app:layout_constraintHorizontal_chainStyle=\"packed\"\n+            app:layout_constraintStart_toStartOf=\"parent\"\n+            app:layout_constraintTop_toTopOf=\"parent\"\n+            tools:text=\"1\" />\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_slash\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:text=\"@string/generic_separator_done_total\"\n+            app:layout_constraintBottom_toBottomOf=\"@id/export_progress_done\"\n+            app:layout_constraintEnd_toStartOf=\"@id/export_progress_total\"\n+            app:layout_constraintStart_toEndOf=\"@id/export_progress_done\"\n+            app:layout_constraintTop_toTopOf=\"@id/export_progress_done\" />\n+\n+        <TextView\n+            android:id=\"@+id/export_progress_total\"\n+            style=\"@style/TextMedium\"\n+            android:layout_width=\"wrap_content\"\n+            android:layout_height=\"wrap_content\"\n+            android:layout_marginEnd=\"24dp\"\n+            app:layout_constraintBottom_toBottomOf=\"@id/export_progress_slash\"\n+            app:layout_constraintEnd_toEndOf=\"parent\"\n+            app:layout_constraintStart_toEndOf=\"@id/export_progress_slash\"\n+            app:layout_constraintTop_toTopOf=\"@id/export_progress_slash\"\n+            tools:text=\"10\" />\n+\n+        <ProgressBar", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "026a9fe6286885c6df526d67e772ac782c850c20"}, "originalPosition": 53}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e53dde5500a3f06170b5cda39417bc7b9e44c5dd", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/e53dde5500a3f06170b5cda39417bc7b9e44c5dd", "committedDate": "2020-10-19T10:07:38Z", "message": "Performance. Conflicts manage by ExporActivity instead of JobIntentService."}, "afterCommit": {"oid": "0fc4929de78ff466f614070a02f67c2e42c087ff", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/0fc4929de78ff466f614070a02f67c2e42c087ff", "committedDate": "2020-10-19T14:10:00Z", "message": "Performance. Conflicts manage by ExporActivity instead of JobIntentService."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "99dd15460f0bb66ff5ff837c1fba768b865a9209", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/99dd15460f0bb66ff5ff837c1fba768b865a9209", "committedDate": "2020-10-19T18:03:25Z", "message": "Uses DocumentsContract instead of DocumentFile for find files."}, "afterCommit": {"oid": "d68dbb3545bf8a6d819606bb5d10ea5179b992ef", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/d68dbb3545bf8a6d819606bb5d10ea5179b992ef", "committedDate": "2020-10-20T09:51:16Z", "message": "Uses DocumentsContract instead of DocumentFile for find files."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d68dbb3545bf8a6d819606bb5d10ea5179b992ef", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/d68dbb3545bf8a6d819606bb5d10ea5179b992ef", "committedDate": "2020-10-20T09:51:16Z", "message": "Uses DocumentsContract instead of DocumentFile for find files."}, "afterCommit": {"oid": "dc5ee1d7708f118ea48df61479df2d012b1e5115", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/dc5ee1d7708f118ea48df61479df2d012b1e5115", "committedDate": "2020-10-20T09:59:11Z", "message": "Export All: ask to the user when conflicts (track already exported in the selected directory) and show a summary. Fixes #451."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dc5ee1d7708f118ea48df61479df2d012b1e5115", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/dc5ee1d7708f118ea48df61479df2d012b1e5115", "committedDate": "2020-10-20T09:59:11Z", "message": "Export All: ask to the user when conflicts (track already exported in the selected directory) and show a summary. Fixes #451."}, "afterCommit": {"oid": "e945f586fe4211654d903de51ce7efe6a14d9437", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/e945f586fe4211654d903de51ce7efe6a14d9437", "committedDate": "2020-10-20T09:59:58Z", "message": "Export All: ask to the user when conflicts (track already exported in the selected directory) and show a summary. Fixes #451."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e945f586fe4211654d903de51ce7efe6a14d9437", "author": {"user": {"login": "rgmf", "name": "Rom\u00e1n Mart\u00ednez"}}, "url": "https://github.com/OpenTracksApp/OpenTracks/commit/e945f586fe4211654d903de51ce7efe6a14d9437", "committedDate": "2020-10-20T09:59:58Z", "message": "Export All: ask to the user when conflicts (track already exported in the selected directory) and show a summary. Fixes #451."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2269, "cost": 1, "resetAt": "2021-11-01T15:33:45Z"}}}