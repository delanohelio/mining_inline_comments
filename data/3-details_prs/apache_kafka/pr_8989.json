{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ1MDAzOTg4", "number": 8989, "title": "KAFKA-10239: Make GroupInstanceId ignorable in DescribeGroups", "bodyText": "This is a bug fix for older admin clients using static membership and call DescribeGroups. By making groupInstanceId ignorable, it would not crash upon handling the response.\nAdded test coverages for DescribeGroups, and some side cleanups.\nVerified that the test testGroupInstanceIdIgnorableInDescribeGroupsResponse would fail without the ignorable flag:\norg.apache.kafka.common.errors.UnsupportedVersionException: Attempted to write a non-default groupInstanceId at version 0\n\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-07-06T21:10:53Z", "url": "https://github.com/apache/kafka/pull/8989", "merged": true, "mergeCommit": {"oid": "18f2589c1e087654c0cdd46d2473246f37f0b66a"}, "closed": true, "closedAt": "2020-07-07T01:50:41Z", "author": {"login": "abbccdda"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcyW-atgH2gAyNDQ1MDAzOTg4Ojk4NDBmN2E3MWE5NTAzYzM4ODU3YzliYjQ3NjZkZDhhNGViNTNkMzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcyaZC5gFqTQ0MzQ3OTc3Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9840f7a71a9503c38857c9bb4766dd8a4eb53d36", "author": {"user": {"login": "abbccdda", "name": "Boyang Chen"}}, "url": "https://github.com/apache/kafka/commit/9840f7a71a9503c38857c9bb4766dd8a4eb53d36", "committedDate": "2020-07-06T20:08:23Z", "message": "make GroupInstanceId ignorable in DescribeGroup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a9c2eb6c279688a5e1bd7f57103165be493f7825", "author": {"user": {"login": "abbccdda", "name": "Boyang Chen"}}, "url": "https://github.com/apache/kafka/commit/a9c2eb6c279688a5e1bd7f57103165be493f7825", "committedDate": "2020-07-06T21:10:47Z", "message": "tests and cleanups"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "a9c2eb6c279688a5e1bd7f57103165be493f7825", "author": {"user": {"login": "abbccdda", "name": "Boyang Chen"}}, "url": "https://github.com/apache/kafka/commit/a9c2eb6c279688a5e1bd7f57103165be493f7825", "committedDate": "2020-07-06T21:10:47Z", "message": "tests and cleanups"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNDIwMTIy", "url": "https://github.com/apache/kafka/pull/8989#pullrequestreview-443420122", "createdAt": "2020-07-06T21:30:10Z", "commit": {"oid": "a9c2eb6c279688a5e1bd7f57103165be493f7825"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMTozMDoxMVrOGtnu9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wNlQyMTozMToyN1rOGtnxGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MDEwMA==", "bodyText": "nit: may as well fix alignment as well", "url": "https://github.com/apache/kafka/pull/8989#discussion_r450490100", "createdAt": "2020-07-06T21:30:11Z", "author": {"login": "hachikuji"}, "path": "clients/src/test/java/org/apache/kafka/common/message/MessageTest.java", "diffHunk": "@@ -933,7 +983,7 @@ private void verifyWriteRaisesNpe(short version, Message message) throws Excepti\n \n     private void verifyWriteRaisesUve(short version,\n                                       String problemText,\n-                                     Message message) throws Exception {\n+                                     Message message) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9c2eb6c279688a5e1bd7f57103165be493f7825"}, "originalPosition": 172}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQ5MDY0OQ==", "bodyText": "Should we test the expected behavior for all versions?", "url": "https://github.com/apache/kafka/pull/8989#discussion_r450490649", "createdAt": "2020-07-06T21:31:27Z", "author": {"login": "hachikuji"}, "path": "clients/src/test/java/org/apache/kafka/common/message/MessageTest.java", "diffHunk": "@@ -218,6 +220,59 @@ public void testOffsetCommitDefaultGroupInstanceId() throws Exception {\n         testAllMessageRoundTripsFromVersion((short) 7, request.get().setGroupInstanceId(instanceId));\n     }\n \n+    @Test\n+    public void testDescribeGroupsRequestVersions() throws Exception {\n+        testAllMessageRoundTrips(new DescribeGroupsRequestData()\n+                .setGroups(Collections.singletonList(\"group\"))\n+                .setIncludeAuthorizedOperations(false));\n+    }\n+\n+    @Test\n+    public void testDescribeGroupsResponseVersions() throws Exception {\n+        DescribedGroupMember baseMember = new DescribedGroupMember()\n+            .setMemberId(memberId);\n+\n+        DescribedGroup baseGroup = new DescribedGroup()\n+                                       .setGroupId(\"group\")\n+                                       .setGroupState(\"Stable\").setErrorCode(Errors.NONE.code())\n+                                       .setMembers(Collections.singletonList(baseMember))\n+                                       .setProtocolType(\"consumer\");\n+        DescribeGroupsResponseData baseResponse = new DescribeGroupsResponseData()\n+                                                  .setGroups(Collections.singletonList(baseGroup));\n+        testAllMessageRoundTrips(baseResponse);\n+\n+        testAllMessageRoundTripsFromVersion((short) 1, baseResponse.setThrottleTimeMs(10));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a9c2eb6c279688a5e1bd7f57103165be493f7825"}, "originalPosition": 43}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bba3797eb3cbfbe46fad0a33fb7eecef007ac7c2", "author": {"user": {"login": "abbccdda", "name": "Boyang Chen"}}, "url": "https://github.com/apache/kafka/commit/bba3797eb3cbfbe46fad0a33fb7eecef007ac7c2", "committedDate": "2020-07-06T23:13:45Z", "message": "add throttle test coverage"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQzNDc5Nzc3", "url": "https://github.com/apache/kafka/pull/8989#pullrequestreview-443479777", "createdAt": "2020-07-07T00:07:11Z", "commit": {"oid": "bba3797eb3cbfbe46fad0a33fb7eecef007ac7c2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1190, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}