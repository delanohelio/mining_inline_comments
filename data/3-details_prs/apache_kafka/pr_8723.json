{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyNjE5MjQy", "number": 8723, "title": "KIP-569-KAFKA-9494: DescribeConfigsResponse - include additional metadata information", "bodyText": "Implements KIP-569\nAdds documentation and type of ConfigEntry in version 3 of DescribeConfigsResponse\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-05-25T08:33:08Z", "url": "https://github.com/apache/kafka/pull/8723", "merged": true, "mergeCommit": {"oid": "af3b8b50f2b79b41c1bc3a518942f3df1c5b64f9"}, "closed": true, "closedAt": "2020-05-29T22:18:50Z", "author": {"login": "srpanwar-confluent"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclu4YnAFqTQyMDE1NDE3Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcmHdJ1gFqTQyMTIxOTg5NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMTU0MTcy", "url": "https://github.com/apache/kafka/pull/8723#pullrequestreview-420154172", "createdAt": "2020-05-28T14:18:11Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNDoxODoxMVrOGb3RCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNDozNDo1OFrOGb4KCQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTg3MDIxOA==", "bodyText": "Should this return UNKNOWN since there may be a type in a new version that the client doesn't know about?", "url": "https://github.com/apache/kafka/pull/8723#discussion_r431870218", "createdAt": "2020-05-28T14:18:11Z", "author": {"login": "rajinisivaram"}, "path": "clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java", "diffHunk": "@@ -2052,6 +2057,49 @@ void handleFailure(Throwable throwable) {\n         return configSource;\n     }\n \n+    private ConfigEntry.ConfigType configType(DescribeConfigsResponse.ConfigType type) {\n+        if (type == null) {\n+            return ConfigEntry.ConfigType.UNKNOWN;\n+        }\n+\n+        ConfigEntry.ConfigType configType;\n+        switch (type) {\n+            case BOOLEAN:\n+                configType = ConfigEntry.ConfigType.BOOLEAN;\n+                break;\n+            case CLASS:\n+                configType = ConfigEntry.ConfigType.CLASS;\n+                break;\n+            case DOUBLE:\n+                configType = ConfigEntry.ConfigType.DOUBLE;\n+                break;\n+            case INT:\n+                configType = ConfigEntry.ConfigType.INT;\n+                break;\n+            case LIST:\n+                configType = ConfigEntry.ConfigType.LIST;\n+                break;\n+            case LONG:\n+                configType = ConfigEntry.ConfigType.LONG;\n+                break;\n+            case PASSWORD:\n+                configType = ConfigEntry.ConfigType.PASSWORD;\n+                break;\n+            case SHORT:\n+                configType = ConfigEntry.ConfigType.SHORT;\n+                break;\n+            case STRING:\n+                configType = ConfigEntry.ConfigType.STRING;\n+                break;\n+            case UNKNOWN:\n+                configType = ConfigEntry.ConfigType.UNKNOWN;\n+                break;\n+            default:\n+                throw new IllegalArgumentException(\"Unexpected config type \" + type);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 92}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTg3MDg1Mg==", "bodyText": "Since this is a public API, we should include this change in the KIP.", "url": "https://github.com/apache/kafka/pull/8723#discussion_r431870852", "createdAt": "2020-05-28T14:19:06Z", "author": {"login": "rajinisivaram"}, "path": "clients/src/main/java/org/apache/kafka/common/config/AbstractConfig.java", "diffHunk": "@@ -201,6 +201,13 @@ public String getString(String key) {\n         return configKey.type;\n     }\n \n+    public String documentationOf(String key) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTg3NTM4OA==", "bodyText": "Can we switch over to using the generated DescribeConfigsRequestData class?", "url": "https://github.com/apache/kafka/pull/8723#discussion_r431875388", "createdAt": "2020-05-28T14:24:59Z", "author": {"login": "rajinisivaram"}, "path": "clients/src/main/java/org/apache/kafka/common/requests/DescribeConfigsRequest.java", "diffHunk": "@@ -43,6 +43,7 @@\n     private static final String RESOURCE_TYPE_KEY_NAME = \"resource_type\";\n     private static final String RESOURCE_NAME_KEY_NAME = \"resource_name\";\n     private static final String CONFIG_NAMES_KEY_NAME = \"config_names\";\n+    private static final String INCLUDE_DOCUMENTATION = \"include_documentation\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTg3NjQwMg==", "bodyText": "Same as the request, can we switch over to the generated class?", "url": "https://github.com/apache/kafka/pull/8723#discussion_r431876402", "createdAt": "2020-05-28T14:26:23Z", "author": {"login": "rajinisivaram"}, "path": "clients/src/main/java/org/apache/kafka/common/requests/DescribeConfigsResponse.java", "diffHunk": "@@ -56,6 +56,8 @@\n     private static final String IS_SENSITIVE_KEY_NAME = \"is_sensitive\";\n     private static final String IS_DEFAULT_KEY_NAME = \"is_default\";\n     private static final String READ_ONLY_KEY_NAME = \"read_only\";\n+    private static final String CONFIG_VALUE_TYPE_KEY_NAME = \"config_value_type\";\n+    private static final String CONFIG_DOCUMENTATION_KEY_NAME = \"config_documentation\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTg3OTY0NQ==", "bodyText": "Unrelated to this PR, but since you are updating this file anyway, can you fix the typo in IncludeSynonyms?", "url": "https://github.com/apache/kafka/pull/8723#discussion_r431879645", "createdAt": "2020-05-28T14:29:51Z", "author": {"login": "rajinisivaram"}, "path": "clients/src/main/resources/common/message/DescribeConfigsRequest.json", "diffHunk": "@@ -32,6 +32,8 @@\n         \"about\": \"The configuration keys to list, or null to list all configuration keys.\" }\n     ]},\n     { \"name\": \"IncludeSynoyms\", \"type\": \"bool\", \"versions\": \"1+\", \"default\": \"false\", \"ignorable\": false,", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTg4NDgwOQ==", "bodyText": "indentation", "url": "https://github.com/apache/kafka/pull/8723#discussion_r431884809", "createdAt": "2020-05-28T14:34:58Z", "author": {"login": "rajinisivaram"}, "path": "core/src/main/scala/kafka/server/AdminManager.scala", "diffHunk": "@@ -347,7 +347,7 @@ class AdminManager(val config: KafkaConfig,\n     }\n   }\n \n-  def describeConfigs(resourceToConfigNames: Map[ConfigResource, Option[Set[String]]], includeSynonyms: Boolean): Map[ConfigResource, DescribeConfigsResponse.Config] = {\n+    def describeConfigs(resourceToConfigNames: Map[ConfigResource, Option[Set[String]]], includeSynonyms: Boolean, includeDocumentation: Boolean): Map[ConfigResource, DescribeConfigsResponse.Config] = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNzYyODY2", "url": "https://github.com/apache/kafka/pull/8723#pullrequestreview-420762866", "createdAt": "2020-05-29T08:43:20Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwODo0MzoyMFrOGcUDIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwODo1MTo0N1rOGcUVKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM0MTc5Mg==", "bodyText": "ConfigType.UNKNOWN instead of null since we use that as the default elsewhere?", "url": "https://github.com/apache/kafka/pull/8723#discussion_r432341792", "createdAt": "2020-05-29T08:43:20Z", "author": {"login": "rajinisivaram"}, "path": "clients/src/main/java/org/apache/kafka/common/requests/DescribeConfigsResponse.java", "diffHunk": "@@ -248,6 +321,14 @@ public DescribeConfigsResponse(Struct struct) {\n                 String configName = configEntriesStruct.getString(CONFIG_NAME_KEY_NAME);\n                 String configValue = configEntriesStruct.getString(CONFIG_VALUE_KEY_NAME);\n                 boolean isSensitive = configEntriesStruct.getBoolean(IS_SENSITIVE_KEY_NAME);\n+                ConfigType type = null;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 145}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM0NTA2Mg==", "bodyText": "Why is ConfigValue Type ignorable, but Documentation not?", "url": "https://github.com/apache/kafka/pull/8723#discussion_r432345062", "createdAt": "2020-05-29T08:49:27Z", "author": {"login": "rajinisivaram"}, "path": "clients/src/main/resources/common/message/DescribeConfigsResponse.json", "diffHunk": "@@ -59,7 +59,11 @@\n             \"about\": \"The synonym value.\" },\n           { \"name\": \"Source\", \"type\": \"int8\", \"versions\": \"1+\",\n             \"about\": \"The synonym source.\" }\n-        ]}\n+        ]},\n+        { \"name\": \"ConfigValueType\", \"type\": \"int8\", \"versions\": \"3+\", \"default\": \"0\", \"ignorable\": true,\n+          \"about\": \"The configuration data type. Type can be one of the following values - BOOLEAN, STRING, INT, SHORT, LONG, DOUBLE, LIST, CLASS, PASSWORD\" },\n+        { \"name\": \"Documentation\", \"type\": \"string\", \"versions\": \"3+\", \"nullableVersions\": \"0+\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 17}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM0NTQ1OA==", "bodyText": "ConfigType.UNKNOWN instead of null?", "url": "https://github.com/apache/kafka/pull/8723#discussion_r432345458", "createdAt": "2020-05-29T08:50:07Z", "author": {"login": "rajinisivaram"}, "path": "clients/src/test/java/org/apache/kafka/clients/admin/ConfigTest.java", "diffHunk": "@@ -92,6 +92,6 @@ public void shouldImplementToStringProperly() {\n \n     public static ConfigEntry newConfigEntry(String name, String value, ConfigEntry.ConfigSource source, boolean isSensitive,\n                                              boolean isReadOnly, List<ConfigEntry.ConfigSynonym> synonyms) {\n-        return new ConfigEntry(name, value, source, isSensitive, isReadOnly, synonyms);\n+        return new ConfigEntry(name, value, source, isSensitive, isReadOnly, synonyms, null, null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM0NjQxMA==", "bodyText": "case _ => UNKNOWN or throw an exception?", "url": "https://github.com/apache/kafka/pull/8723#discussion_r432346410", "createdAt": "2020-05-29T08:51:47Z", "author": {"login": "rajinisivaram"}, "path": "core/src/main/scala/kafka/server/AdminManager.scala", "diffHunk": "@@ -658,6 +658,26 @@ class AdminManager(val config: KafkaConfig,\n     DynamicBrokerConfig.brokerConfigSynonyms(name, matchListenerOverride = true)\n   }\n \n+  private def brokerDocumentation(name: String): String = {\n+    config.documentationOf(name)\n+  }\n+\n+  private def configResponseType(configType: Option[ConfigDef.Type]): DescribeConfigsResponse.ConfigType = {\n+    if (configType.isEmpty)\n+      DescribeConfigsResponse.ConfigType.UNKNOWN\n+    else configType.get match {\n+      case ConfigDef.Type.BOOLEAN => DescribeConfigsResponse.ConfigType.BOOLEAN\n+      case ConfigDef.Type.STRING => DescribeConfigsResponse.ConfigType.STRING\n+      case ConfigDef.Type.INT => DescribeConfigsResponse.ConfigType.INT\n+      case ConfigDef.Type.SHORT => DescribeConfigsResponse.ConfigType.SHORT\n+      case ConfigDef.Type.LONG => DescribeConfigsResponse.ConfigType.LONG\n+      case ConfigDef.Type.DOUBLE => DescribeConfigsResponse.ConfigType.DOUBLE\n+      case ConfigDef.Type.LIST => DescribeConfigsResponse.ConfigType.LIST\n+      case ConfigDef.Type.CLASS => DescribeConfigsResponse.ConfigType.CLASS\n+      case ConfigDef.Type.PASSWORD => DescribeConfigsResponse.ConfigType.PASSWORD", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 60}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwODE2MjI3", "url": "https://github.com/apache/kafka/pull/8723#pullrequestreview-420816227", "createdAt": "2020-05-29T09:59:39Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwOTo1OTozOVrOGcWilw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwOTo1OTozOVrOGcWilw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM4MjYxNQ==", "bodyText": "Any reason this is called ConfigValueType here while it is called ConfigType everywhere else?", "url": "https://github.com/apache/kafka/pull/8723#discussion_r432382615", "createdAt": "2020-05-29T09:59:39Z", "author": {"login": "rajinisivaram"}, "path": "clients/src/main/resources/common/message/DescribeConfigsResponse.json", "diffHunk": "@@ -59,7 +59,11 @@\n             \"about\": \"The synonym value.\" },\n           { \"name\": \"Source\", \"type\": \"int8\", \"versions\": \"1+\",\n             \"about\": \"The synonym source.\" }\n-        ]}\n+        ]},\n+        { \"name\": \"ConfigValueType\", \"type\": \"int8\", \"versions\": \"3+\", \"default\": \"0\", \"ignorable\": true,", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 15}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "3c104079898cb4b1034d90ba5586557b26d55425", "author": {"user": {"login": "srpanwar-confluent", "name": "Shailesh Panwar"}}, "url": "https://github.com/apache/kafka/commit/3c104079898cb4b1034d90ba5586557b26d55425", "committedDate": "2020-05-29T18:45:24Z", "message": "KAFKA-9494 Include additional metadata information in DescribeConfig response"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "3c104079898cb4b1034d90ba5586557b26d55425", "author": {"user": {"login": "srpanwar-confluent", "name": "Shailesh Panwar"}}, "url": "https://github.com/apache/kafka/commit/3c104079898cb4b1034d90ba5586557b26d55425", "committedDate": "2020-05-29T18:45:24Z", "message": "KAFKA-9494 Include additional metadata information in DescribeConfig response"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIxMjE5ODk1", "url": "https://github.com/apache/kafka/pull/8723#pullrequestreview-421219895", "createdAt": "2020-05-29T19:16:23Z", "commit": {"oid": "3c104079898cb4b1034d90ba5586557b26d55425"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1170, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}