{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg2MTQ1NjQ4", "number": 8263, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxOToxNDoxMlrODqLp1A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxOToxODowM1rODqLq3Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NTU3NzE2OnYy", "diffSide": "RIGHT", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/Herder.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxOToxNDoxMlrOF5x3VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QwNTo1NzoyMFrOF53v3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjEzMDEzMw==", "bodyText": "Actually, it's the new method that needs a default implementation if we choose to add it to this interface.", "url": "https://github.com/apache/kafka/pull/8263#discussion_r396130133", "createdAt": "2020-03-22T19:14:12Z", "author": {"login": "kkonstantine"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/Herder.java", "diffHunk": "@@ -178,7 +178,17 @@\n      * Validate the provided connector config values against the configuration definition.\n      * @param connectorConfig the provided connector config values\n      */\n-    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig);\n+    default ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig) {\n+        return validateConnectorConfig(connectorConfig, true);\n+    }\n+\n+    /**\n+     * Validate the provided connector config values against the configuration definition.\n+     * @param connectorConfig the provided connector config values\n+     * @param doLog set it to true to log all connectorConfig with INFO level. false to log nothing.\n+     *              Noted: there are many endpoints requiring this method but not all configs are worth being logged.\n+     */\n+    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig, boolean doLog);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjEzNDExMg==", "bodyText": "Thanks for suggestions!\nJust curious, is Herder.java a public interface?", "url": "https://github.com/apache/kafka/pull/8263#discussion_r396134112", "createdAt": "2020-03-22T19:54:50Z", "author": {"login": "chia7712"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/Herder.java", "diffHunk": "@@ -178,7 +178,17 @@\n      * Validate the provided connector config values against the configuration definition.\n      * @param connectorConfig the provided connector config values\n      */\n-    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig);\n+    default ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig) {\n+        return validateConnectorConfig(connectorConfig, true);\n+    }\n+\n+    /**\n+     * Validate the provided connector config values against the configuration definition.\n+     * @param connectorConfig the provided connector config values\n+     * @param doLog set it to true to log all connectorConfig with INFO level. false to log nothing.\n+     *              Noted: there are many endpoints requiring this method but not all configs are worth being logged.\n+     */\n+    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig, boolean doLog);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjEzMDEzMw=="}, "originalCommit": null, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjE5MzI1MA==", "bodyText": "I trace the history of Herder.java. It seems to me Herder.java is not public interface so it should be fine to add new methods directly. For example, the commit added three new methods without default implementation.\nAm I missing something here?", "url": "https://github.com/apache/kafka/pull/8263#discussion_r396193250", "createdAt": "2020-03-23T03:08:11Z", "author": {"login": "chia7712"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/Herder.java", "diffHunk": "@@ -178,7 +178,17 @@\n      * Validate the provided connector config values against the configuration definition.\n      * @param connectorConfig the provided connector config values\n      */\n-    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig);\n+    default ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig) {\n+        return validateConnectorConfig(connectorConfig, true);\n+    }\n+\n+    /**\n+     * Validate the provided connector config values against the configuration definition.\n+     * @param connectorConfig the provided connector config values\n+     * @param doLog set it to true to log all connectorConfig with INFO level. false to log nothing.\n+     *              Noted: there are many endpoints requiring this method but not all configs are worth being logged.\n+     */\n+    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig, boolean doLog);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjEzMDEzMw=="}, "originalCommit": null, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwNzE3MA==", "bodyText": "First, to your first question, no this interface is not public api, but as a general principle we are trying to maintain compatibility regardless, wherever it makes sense. Here, keeping both methods makes the most sense.\nNow, w/r/t the commit that you mention, indeed there's a difference.\nThat commit was the implementation of KIP-558. And that's how we document changes to public interfaces, by writing and discussing publicly KIPs. You may read more here: https://cwiki.apache.org/confluence/display/KAFKA/Kafka+Improvement+Proposals\nIn this PR a KIP would be an overkill, and given that this is not public interface, we can easily maintain compatibility the way I described above. The other difference is that here a default implementation makes sense, while in KIP-558 it didn't make much sense.\nHope this helps.", "url": "https://github.com/apache/kafka/pull/8263#discussion_r396207170", "createdAt": "2020-03-23T04:24:47Z", "author": {"login": "kkonstantine"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/Herder.java", "diffHunk": "@@ -178,7 +178,17 @@\n      * Validate the provided connector config values against the configuration definition.\n      * @param connectorConfig the provided connector config values\n      */\n-    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig);\n+    default ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig) {\n+        return validateConnectorConfig(connectorConfig, true);\n+    }\n+\n+    /**\n+     * Validate the provided connector config values against the configuration definition.\n+     * @param connectorConfig the provided connector config values\n+     * @param doLog set it to true to log all connectorConfig with INFO level. false to log nothing.\n+     *              Noted: there are many endpoints requiring this method but not all configs are worth being logged.\n+     */\n+    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig, boolean doLog);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjEzMDEzMw=="}, "originalCommit": null, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIyNjUyNw==", "bodyText": "@kkonstantine thanks for the great explanation!!! I have addressed your comments in the latest commit. Please take a look. thanks.", "url": "https://github.com/apache/kafka/pull/8263#discussion_r396226527", "createdAt": "2020-03-23T05:57:20Z", "author": {"login": "chia7712"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/Herder.java", "diffHunk": "@@ -178,7 +178,17 @@\n      * Validate the provided connector config values against the configuration definition.\n      * @param connectorConfig the provided connector config values\n      */\n-    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig);\n+    default ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig) {\n+        return validateConnectorConfig(connectorConfig, true);\n+    }\n+\n+    /**\n+     * Validate the provided connector config values against the configuration definition.\n+     * @param connectorConfig the provided connector config values\n+     * @param doLog set it to true to log all connectorConfig with INFO level. false to log nothing.\n+     *              Noted: there are many endpoints requiring this method but not all configs are worth being logged.\n+     */\n+    ConfigInfos validateConnectorConfig(Map<String, String> connectorConfig, boolean doLog);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjEzMDEzMw=="}, "originalCommit": null, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NTU3NzU5OnYy", "diffSide": "RIGHT", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/resources/ConnectorPluginsResource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxOToxNTowMFrOF5x3lQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxOToxNTowMFrOF5x3lQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjEzMDE5Nw==", "bodyText": "A per argument inline comment is not something I've seen being used widely in Connect's codebase.", "url": "https://github.com/apache/kafka/pull/8263#discussion_r396130197", "createdAt": "2020-03-22T19:15:00Z", "author": {"login": "kkonstantine"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/resources/ConnectorPluginsResource.java", "diffHunk": "@@ -78,7 +78,9 @@ public ConfigInfos validateConfigs(\n             );\n         }\n \n-        return herder.validateConnectorConfig(connectorConfig);\n+        return herder.validateConnectorConfig(connectorConfig,\n+            // the validated configs don't need to be logger.", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NTU3Nzc3OnYy", "diffSide": "RIGHT", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/resources/ConnectorPluginsResource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxOToxNTozMlrOF5x3tg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxOToxNTozMlrOF5x3tg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjEzMDIzMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    return herder.validateConnectorConfig(connectorConfig,\n          \n          \n            \n                        // the validated configs don't need to be logger.\n          \n          \n            \n                        false);\n          \n          \n            \n                    // the validated configs don't need to be logger.\n          \n          \n            \n                    return herder.validateConnectorConfig(connectorConfig, false);", "url": "https://github.com/apache/kafka/pull/8263#discussion_r396130230", "createdAt": "2020-03-22T19:15:32Z", "author": {"login": "kkonstantine"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/resources/ConnectorPluginsResource.java", "diffHunk": "@@ -78,7 +78,9 @@ public ConfigInfos validateConfigs(\n             );\n         }\n \n-        return herder.validateConnectorConfig(connectorConfig);\n+        return herder.validateConnectorConfig(connectorConfig,\n+            // the validated configs don't need to be logger.\n+            false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ1NTU3OTgxOnYy", "diffSide": "RIGHT", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxOToxODowM1rOF5x42Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxOToxODowM1rOF5x42Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjEzMDUyMQ==", "bodyText": "Related to the other comment, we'll need to keep the @Override of the previous method, and just have it call the new method that will also be overridden.", "url": "https://github.com/apache/kafka/pull/8263#discussion_r396130521", "createdAt": "2020-03-22T19:18:03Z", "author": {"login": "kkonstantine"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/AbstractHerder.java", "diffHunk": "@@ -299,7 +299,7 @@ public StatusBackingStore statusBackingStore() {\n     }\n \n     @Override\n-    public ConfigInfos validateConnectorConfig(Map<String, String> connectorProps) {\n+    public ConfigInfos validateConnectorConfig(Map<String, String> connectorProps, boolean doLog) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3300, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}