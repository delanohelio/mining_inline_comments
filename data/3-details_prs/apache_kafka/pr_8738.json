{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MjM2MTUx", "number": 8738, "title": "MINOR: remove unnecessary timeout for admin request", "bodyText": "Turns out future.get() actually does apply the admin's default.api.timeout.ms config internally, so we don't need to worry about providing a timeout of our own. Who knew", "createdAt": "2020-05-28T04:12:14Z", "url": "https://github.com/apache/kafka/pull/8738", "merged": true, "mergeCommit": {"oid": "36ca33f9cf1902399afe7494f88c6bbd16022b56"}, "closed": true, "closedAt": "2020-05-29T01:01:02Z", "author": {"login": "ableegoldman"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcll4q6AH2gAyNDI0MjM2MTUxOjdjMWVmNGQxMzA4OTE4N2M5ZDk5ZDMwZTA3M2ZlODQ4YjFlYzczNTI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcl1l36gH2gAyNDI0MjM2MTUxOmY3YWFkM2FlOWQyZGJjZTc3ZmUzZTJlYzI5NTcyOThkNDY2ZmIwMDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7c1ef4d13089187c9d99d30e073fe848b1ec7352", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/7c1ef4d13089187c9d99d30e073fe848b1ec7352", "committedDate": "2020-05-28T04:09:40Z", "message": "fix timeout config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7676de2577fb60ca5c3dc3765a5475725f6c0e3a", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/7676de2577fb60ca5c3dc3765a5475725f6c0e3a", "committedDate": "2020-05-28T04:09:40Z", "message": "reset nextProbingRebalanceMs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "702187a4518c2dc29a6123a89be14475c3617ecb", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/702187a4518c2dc29a6123a89be14475c3617ecb", "committedDate": "2020-05-28T04:09:41Z", "message": "extract internal admin configs"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NzY0NjM0", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-419764634", "createdAt": "2020-05-28T04:13:03Z", "commit": {"oid": "702187a4518c2dc29a6123a89be14475c3617ecb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwNDoxMzowNFrOGblBMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwNDoxMzowNFrOGblBMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU3MTI1MA==", "bodyText": "Moved to ClientUtil", "url": "https://github.com/apache/kafka/pull/8738#discussion_r431571250", "createdAt": "2020-05-28T04:13:04Z", "author": {"login": "ableegoldman"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/InternalTopicManager.java", "diffHunk": "@@ -44,12 +45,6 @@\n     private final static String INTERRUPTED_ERROR_MESSAGE = \"Thread got interrupted. This indicates a bug. \" +\n         \"Please report at https://issues.apache.org/jira/projects/KAFKA or dev-mailing list (https://kafka.apache.org/contact).\";\n \n-    private static final class InternalAdminClientConfig extends AdminClientConfig {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "702187a4518c2dc29a6123a89be14475c3617ecb"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NzY1NDkz", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-419765493", "createdAt": "2020-05-28T04:16:08Z", "commit": {"oid": "702187a4518c2dc29a6123a89be14475c3617ecb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwNDoxNjowOFrOGblD6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQwNDoxNjowOFrOGblD6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTU3MTk0Nw==", "bodyText": "This is neither relevant to this PR nor required for correctness, but I noticed the log message above tends to spam the logs in some tests. Since this gets set/reset at the end of every rebalance, we may as well reset it here to avoid an avalanche of Triggering the followup rebalance...", "url": "https://github.com/apache/kafka/pull/8738#discussion_r431571947", "createdAt": "2020-05-28T04:16:08Z", "author": {"login": "ableegoldman"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/StreamThread.java", "diffHunk": "@@ -551,6 +551,7 @@ void runLoop() {\n                 if (nextProbingRebalanceMs.get() < time.milliseconds()) {\n                     log.info(\"Triggering the followup rebalance scheduled for {} ms.\", nextProbingRebalanceMs.get());\n                     mainConsumer.enforceRebalance();\n+                    nextProbingRebalanceMs.set(Long.MAX_VALUE);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "702187a4518c2dc29a6123a89be14475c3617ecb"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "702187a4518c2dc29a6123a89be14475c3617ecb", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/702187a4518c2dc29a6123a89be14475c3617ecb", "committedDate": "2020-05-28T04:09:41Z", "message": "extract internal admin configs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ef807c2da090c350108f66202c1b5db800852eda", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/ef807c2da090c350108f66202c1b5db800852eda", "committedDate": "2020-05-28T05:31:45Z", "message": "default.api.timeout must be larger than request.timeout"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/8b5766a45520aff27623d6df4ad33048444784e7", "committedDate": "2020-05-28T05:42:32Z", "message": "fix javadocs missing end delimiter"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5OTU4MjE0", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-419958214", "createdAt": "2020-05-28T10:01:08Z", "commit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMDowMTowOFrOGbuNJQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMDowMTowOFrOGbuNJQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTcyMTc2NQ==", "bodyText": "It seems to me Duration is more readable than long. Is there a reason to make this change?", "url": "https://github.com/apache/kafka/pull/8738#discussion_r431721765", "createdAt": "2020-05-28T10:01:08Z", "author": {"login": "chia7712"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/ClientUtils.java", "diffHunk": "@@ -90,24 +96,21 @@ public static String getTaskProducerClientId(final String threadClientId, final\n         return result;\n     }\n \n-    public static Map<TopicPartition, ListOffsetsResultInfo> fetchEndOffsetsWithoutTimeout(final Collection<TopicPartition> partitions,\n-                                                                                           final Admin adminClient) {\n-        return fetchEndOffsets(partitions, adminClient, null);\n+    public static int getAdminDefaultApiTimeoutMs(final StreamsConfig streamsConfig) {\n+        final InternalAdminClientConfig dummyAdmin = new InternalAdminClientConfig(streamsConfig.getAdminConfigs(\"dummy\"));\n+        return dummyAdmin.getInt(AdminClientConfig.DEFAULT_API_TIMEOUT_MS_CONFIG);\n     }\n \n     public static Map<TopicPartition, ListOffsetsResultInfo> fetchEndOffsets(final Collection<TopicPartition> partitions,\n                                                                              final Admin adminClient,\n-                                                                             final Duration timeout) {\n+                                                                             final long timeoutMs) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "originalPosition": 51}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5OTYxNTk1", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-419961595", "createdAt": "2020-05-28T10:06:04Z", "commit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMDowNjowNFrOGbuX0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMDowNjowNFrOGbuX0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTcyNDQ5Nw==", "bodyText": "The admin configs is built in KafkaStreams construction. Could we reuse it?\n        adminClient = clientSupplier.getAdmin(config.getAdminConfigs(ClientUtils.getSharedAdminClientId(clientId)));", "url": "https://github.com/apache/kafka/pull/8738#discussion_r431724497", "createdAt": "2020-05-28T10:06:04Z", "author": {"login": "chia7712"}, "path": "streams/src/main/java/org/apache/kafka/streams/KafkaStreams.java", "diffHunk": "@@ -1246,7 +1247,12 @@ public void cleanUp() {\n         }\n \n         log.debug(\"Current changelog positions: {}\", allChangelogPositions);\n-        final Map<TopicPartition, ListOffsetsResultInfo> allEndOffsets = fetchEndOffsetsWithoutTimeout(allPartitions, adminClient);\n+        final Map<TopicPartition, ListOffsetsResultInfo> allEndOffsets =\n+            fetchEndOffsets(\n+                allPartitions,\n+                adminClient,\n+                getAdminDefaultApiTimeoutMs(config)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "originalPosition": 19}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5OTYyNzM0", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-419962734", "createdAt": "2020-05-28T10:07:41Z", "commit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMDowNzo0MVrOGbubJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMDowNzo0MVrOGbubJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTcyNTM1MQ==", "bodyText": "Could you add comment for the \"dummy\"?", "url": "https://github.com/apache/kafka/pull/8738#discussion_r431725351", "createdAt": "2020-05-28T10:07:41Z", "author": {"login": "chia7712"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/ClientUtils.java", "diffHunk": "@@ -90,24 +96,21 @@ public static String getTaskProducerClientId(final String threadClientId, final\n         return result;\n     }\n \n-    public static Map<TopicPartition, ListOffsetsResultInfo> fetchEndOffsetsWithoutTimeout(final Collection<TopicPartition> partitions,\n-                                                                                           final Admin adminClient) {\n-        return fetchEndOffsets(partitions, adminClient, null);\n+    public static int getAdminDefaultApiTimeoutMs(final StreamsConfig streamsConfig) {\n+        final InternalAdminClientConfig dummyAdmin = new InternalAdminClientConfig(streamsConfig.getAdminConfigs(\"dummy\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMjg1NzEx", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-420285711", "createdAt": "2020-05-28T16:25:50Z", "commit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNjoyNTo1MFrOGb9Ijg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxNjozMjo0MlrOGb9ZbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk2NjM1MA==", "bodyText": "How about QuietAdminClientConfig, like QuietStreamsConfig?", "url": "https://github.com/apache/kafka/pull/8738#discussion_r431966350", "createdAt": "2020-05-28T16:25:50Z", "author": {"login": "vvcephei"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/ClientUtils.java", "diffHunk": "@@ -40,9 +41,14 @@\n import org.slf4j.LoggerFactory;\n \n public class ClientUtils {\n-\n     private static final Logger LOG = LoggerFactory.getLogger(ClientUtils.class);\n \n+    static final class InternalAdminClientConfig extends AdminClientConfig {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk2ODU1OQ==", "bodyText": "I think it's because we're now also calling it right after calling getAdminDefaultApiTimeoutMs, so it seems a bummer to create a Duration from millis and then immediately convert it back to millis.", "url": "https://github.com/apache/kafka/pull/8738#discussion_r431968559", "createdAt": "2020-05-28T16:29:19Z", "author": {"login": "vvcephei"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/ClientUtils.java", "diffHunk": "@@ -90,24 +96,21 @@ public static String getTaskProducerClientId(final String threadClientId, final\n         return result;\n     }\n \n-    public static Map<TopicPartition, ListOffsetsResultInfo> fetchEndOffsetsWithoutTimeout(final Collection<TopicPartition> partitions,\n-                                                                                           final Admin adminClient) {\n-        return fetchEndOffsets(partitions, adminClient, null);\n+    public static int getAdminDefaultApiTimeoutMs(final StreamsConfig streamsConfig) {\n+        final InternalAdminClientConfig dummyAdmin = new InternalAdminClientConfig(streamsConfig.getAdminConfigs(\"dummy\"));\n+        return dummyAdmin.getInt(AdminClientConfig.DEFAULT_API_TIMEOUT_MS_CONFIG);\n     }\n \n     public static Map<TopicPartition, ListOffsetsResultInfo> fetchEndOffsets(final Collection<TopicPartition> partitions,\n                                                                              final Admin adminClient,\n-                                                                             final Duration timeout) {\n+                                                                             final long timeoutMs) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTcyMTc2NQ=="}, "originalCommit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk3MDY2OQ==", "bodyText": "Just curious, why the change from 9 to 90,000?", "url": "https://github.com/apache/kafka/pull/8738#discussion_r431970669", "createdAt": "2020-05-28T16:32:42Z", "author": {"login": "vvcephei"}, "path": "streams/src/test/java/org/apache/kafka/streams/integration/TaskAssignorIntegrationTest.java", "diffHunk": "@@ -89,7 +89,7 @@ public void shouldProperlyConfigureTheAssignor() throws NoSuchFieldException, Il\n                 mkEntry(StreamsConfig.MAX_WARMUP_REPLICAS_CONFIG, \"7\"),\n                 mkEntry(StreamsConfig.PROBING_REBALANCE_INTERVAL_MS_CONFIG, \"480000\"),\n                 mkEntry(StreamsConfig.InternalConfig.ASSIGNMENT_LISTENER, configuredAssignmentListener),\n-                mkEntry(AdminClientConfig.REQUEST_TIMEOUT_MS_CONFIG, 9)\n+                mkEntry(AdminClientConfig.DEFAULT_API_TIMEOUT_MS_CONFIG, 90_000)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8b5766a45520aff27623d6df4ad33048444784e7"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e03bd32fb7b2fa7a66295be569741ca0dca322a", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/1e03bd32fb7b2fa7a66295be569741ca0dca322a", "committedDate": "2020-05-28T17:02:58Z", "message": "github review suggestions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMzQxNjI1", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-420341625", "createdAt": "2020-05-28T17:35:12Z", "commit": {"oid": "1e03bd32fb7b2fa7a66295be569741ca0dca322a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c55e557223324208e782a23a196aa95c98fd8402", "author": {"user": {"login": "vvcephei", "name": "John Roesler"}}, "url": "https://github.com/apache/kafka/commit/c55e557223324208e782a23a196aa95c98fd8402", "committedDate": "2020-05-28T19:56:00Z", "message": "Merge branch 'trunk' into MINOR-remove-extra-admin-timeout-config"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNDg5MjAx", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-420489201", "createdAt": "2020-05-28T21:01:51Z", "commit": {"oid": "c55e557223324208e782a23a196aa95c98fd8402"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMTowMTo1MVrOGcGlqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMTowMTo1MVrOGcGlqg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjEyMTI1OA==", "bodyText": "Should we pass in MAX_VALUE to avoid introducing test flakyness?", "url": "https://github.com/apache/kafka/pull/8738#discussion_r432121258", "createdAt": "2020-05-28T21:01:51Z", "author": {"login": "mjsax"}, "path": "streams/src/test/java/org/apache/kafka/streams/processor/internals/ClientUtilsTest.java", "diffHunk": "@@ -45,42 +50,42 @@ public void fetchEndOffsetsShouldRethrowRuntimeExceptionAsStreamsException() {\n         final Admin adminClient = EasyMock.createMock(AdminClient.class);\n         EasyMock.expect(adminClient.listOffsets(EasyMock.anyObject())).andThrow(new RuntimeException());\n         replay(adminClient);\n-        assertThrows(StreamsException.class, () ->  fetchEndOffsetsWithoutTimeout(emptyList(), adminClient));\n+        assertThrows(StreamsException.class, () ->  fetchEndOffsets(emptyList(), adminClient, 60_000L));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c55e557223324208e782a23a196aa95c98fd8402"}, "originalPosition": 36}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNDg5NzE4", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-420489718", "createdAt": "2020-05-28T21:02:43Z", "commit": {"oid": "c55e557223324208e782a23a196aa95c98fd8402"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMTowMjo0M1rOGcGnNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMTowMjo0M1rOGcGnNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjEyMTY1NQ==", "bodyText": "As above (also below)\nAlso nit: 60_000L (if just 60 and TimeUnit.SECONDS?)", "url": "https://github.com/apache/kafka/pull/8738#discussion_r432121655", "createdAt": "2020-05-28T21:02:43Z", "author": {"login": "mjsax"}, "path": "streams/src/test/java/org/apache/kafka/streams/processor/internals/ClientUtilsTest.java", "diffHunk": "@@ -45,42 +50,42 @@ public void fetchEndOffsetsShouldRethrowRuntimeExceptionAsStreamsException() {\n         final Admin adminClient = EasyMock.createMock(AdminClient.class);\n         EasyMock.expect(adminClient.listOffsets(EasyMock.anyObject())).andThrow(new RuntimeException());\n         replay(adminClient);\n-        assertThrows(StreamsException.class, () ->  fetchEndOffsetsWithoutTimeout(emptyList(), adminClient));\n+        assertThrows(StreamsException.class, () ->  fetchEndOffsets(emptyList(), adminClient, 60_000L));\n         verify(adminClient);\n     }\n \n     @Test\n-    public void fetchEndOffsetsShouldRethrowInterruptedExceptionAsStreamsException() throws InterruptedException, ExecutionException {\n+    public void fetchEndOffsetsShouldRethrowInterruptedExceptionAsStreamsException() throws Exception {\n         final Admin adminClient = EasyMock.createMock(AdminClient.class);\n         final ListOffsetsResult result = EasyMock.createNiceMock(ListOffsetsResult.class);\n         final KafkaFuture<Map<TopicPartition, ListOffsetsResultInfo>> allFuture = EasyMock.createMock(KafkaFuture.class);\n \n         EasyMock.expect(adminClient.listOffsets(EasyMock.anyObject())).andStubReturn(result);\n         EasyMock.expect(result.all()).andStubReturn(allFuture);\n-        EasyMock.expect(allFuture.get()).andThrow(new InterruptedException());\n+        EasyMock.expect(allFuture.get(60000L, TimeUnit.MILLISECONDS)).andThrow(new InterruptedException());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c55e557223324208e782a23a196aa95c98fd8402"}, "originalPosition": 50}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c290156c2a9297c644b9c6b9f77da9583398f47b", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/c290156c2a9297c644b9c6b9f77da9583398f47b", "committedDate": "2020-05-28T21:49:20Z", "message": "remove timeout instead"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "54ea20bea7070784a490eaeff64feffda5d79ba3", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/54ea20bea7070784a490eaeff64feffda5d79ba3", "committedDate": "2020-05-28T21:51:08Z", "message": "Merge branch 'MINOR-remove-extra-admin-timeout-config' of https://github.com/ableegoldman/kafka into MINOR-remove-extra-admin-timeout-config"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNTI2Mzc3", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-420526377", "createdAt": "2020-05-28T22:06:27Z", "commit": {"oid": "54ea20bea7070784a490eaeff64feffda5d79ba3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNTI5Njcz", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-420529673", "createdAt": "2020-05-28T22:13:33Z", "commit": {"oid": "54ea20bea7070784a490eaeff64feffda5d79ba3"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMjoxMzozM1rOGcIkFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQyMjoxMzozM1rOGcIkFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjE1MzYyMw==", "bodyText": "Can we please update the JavaDocs of allLocalStorePartitionLags to state that a StreamsException could be thrown?", "url": "https://github.com/apache/kafka/pull/8738#discussion_r432153623", "createdAt": "2020-05-28T22:13:33Z", "author": {"login": "mjsax"}, "path": "streams/src/main/java/org/apache/kafka/streams/KafkaStreams.java", "diffHunk": "@@ -1246,7 +1246,7 @@ public void cleanUp() {\n         }\n \n         log.debug(\"Current changelog positions: {}\", allChangelogPositions);\n-        final Map<TopicPartition, ListOffsetsResultInfo> allEndOffsets = fetchEndOffsetsWithoutTimeout(allPartitions, adminClient);\n+        final Map<TopicPartition, ListOffsetsResultInfo> allEndOffsets = fetchEndOffsets(allPartitions, adminClient);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "54ea20bea7070784a490eaeff64feffda5d79ba3"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNTMxMzU0", "url": "https://github.com/apache/kafka/pull/8738#pullrequestreview-420531354", "createdAt": "2020-05-28T22:17:09Z", "commit": {"oid": "54ea20bea7070784a490eaeff64feffda5d79ba3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0edafb6b85ccbd42912033c0c5b622623d11b740", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/0edafb6b85ccbd42912033c0c5b622623d11b740", "committedDate": "2020-05-28T22:24:05Z", "message": "checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f7aad3ae9d2dbce77fe3e2ec2957298d466fb003", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/f7aad3ae9d2dbce77fe3e2ec2957298d466fb003", "committedDate": "2020-05-28T22:27:37Z", "message": "add StreamsException to javadocs"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 760, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}