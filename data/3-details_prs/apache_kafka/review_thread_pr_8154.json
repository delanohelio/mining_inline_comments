{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc4NDkwNjAw", "number": 8154, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQyMzoyMTowMlrODiCkig==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQwNjo1ODozMFrODiEY_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDIwMjk4OnYy", "diffSide": "RIGHT", "path": "clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQyMzoyMTowMlrOFtHXhw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQyMzoyMTowMlrOFtHXhw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg1MDk1MQ==", "bodyText": "nit: retriable", "url": "https://github.com/apache/kafka/pull/8154#discussion_r382850951", "createdAt": "2020-02-21T23:21:02Z", "author": {"login": "abbccdda"}, "path": "clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java", "diffHunk": "@@ -729,13 +725,10 @@ final void fail(long now, Throwable throwable) {\n             tries++;\n             nextAllowedTryMs = now + retryBackoffMs;\n \n+\n             // If the call has timed out, fail.\n             if (calcTimeoutMsRemainingAsInt(now, deadlineMs) < 0) {\n-                if (log.isDebugEnabled()) {\n-                    log.debug(\"{} timed out at {} after {} attempt(s)\", this, now, tries,\n-                        new Exception(prettyPrintException(throwable)));\n-                }\n-                handleFailure(throwable);\n+                failWithTimeout(now, throwable);\n                 return;\n             }\n             // If the exception is not retryable, fail.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9d70807baae0ad6bb5f248d606900ac562ae8483"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM3MDUwMTA5OnYy", "diffSide": "RIGHT", "path": "clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQwNjo1ODozMFrOFtJ5vw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMlQxODoyNjoxMVrOFtMSmA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg5MjQ3OQ==", "bodyText": "Below, we have a case where we throw the underlying exception if we run out of retries. Is that intentional?", "url": "https://github.com/apache/kafka/pull/8154#discussion_r382892479", "createdAt": "2020-02-22T06:58:30Z", "author": {"login": "ijuma"}, "path": "clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java", "diffHunk": "@@ -731,14 +727,10 @@ final void fail(long now, Throwable throwable) {\n \n             // If the call has timed out, fail.\n             if (calcTimeoutMsRemainingAsInt(now, deadlineMs) < 0) {\n-                if (log.isDebugEnabled()) {\n-                    log.debug(\"{} timed out at {} after {} attempt(s)\", this, now, tries,\n-                        new Exception(prettyPrintException(throwable)));\n-                }\n-                handleFailure(throwable);\n+                failWithTimeout(now, throwable);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1db9a0ab0808dedd4dad0fb4651307437e989a9"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzMDE2NA==", "bodyText": "Yeah, I was debating changing that one too. If retries are exhausted, do we consider that a timeout? I guess it's defensible.", "url": "https://github.com/apache/kafka/pull/8154#discussion_r382930164", "createdAt": "2020-02-22T18:01:14Z", "author": {"login": "hachikuji"}, "path": "clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java", "diffHunk": "@@ -731,14 +727,10 @@ final void fail(long now, Throwable throwable) {\n \n             // If the call has timed out, fail.\n             if (calcTimeoutMsRemainingAsInt(now, deadlineMs) < 0) {\n-                if (log.isDebugEnabled()) {\n-                    log.debug(\"{} timed out at {} after {} attempt(s)\", this, now, tries,\n-                        new Exception(prettyPrintException(throwable)));\n-                }\n-                handleFailure(throwable);\n+                failWithTimeout(now, throwable);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg5MjQ3OQ=="}, "originalCommit": {"oid": "a1db9a0ab0808dedd4dad0fb4651307437e989a9"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzMTYwOA==", "bodyText": "Right, if retries are exhausted and it's a retriable exception, then it seems like it should be a TimeoutException.", "url": "https://github.com/apache/kafka/pull/8154#discussion_r382931608", "createdAt": "2020-02-22T18:26:11Z", "author": {"login": "ijuma"}, "path": "clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java", "diffHunk": "@@ -731,14 +727,10 @@ final void fail(long now, Throwable throwable) {\n \n             // If the call has timed out, fail.\n             if (calcTimeoutMsRemainingAsInt(now, deadlineMs) < 0) {\n-                if (log.isDebugEnabled()) {\n-                    log.debug(\"{} timed out at {} after {} attempt(s)\", this, now, tries,\n-                        new Exception(prettyPrintException(throwable)));\n-                }\n-                handleFailure(throwable);\n+                failWithTimeout(now, throwable);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjg5MjQ3OQ=="}, "originalCommit": {"oid": "a1db9a0ab0808dedd4dad0fb4651307437e989a9"}, "originalPosition": 22}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4067, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}