{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzU4NjExMTU4", "number": 7886, "title": "KAFKA-9353: Add groupInstanceId to DescribeGroup for better visibility", "bodyText": "Kafka-8538(#6957) has already added\u00a0group.instance.id to MemberDescription but didn't print it, so we just print it.\nbefore the change, the describe command print as follows:\nGROUP           CONSUMER-ID                                                  HOST            CLIENT-ID               #PARTITIONS     \nDemoConsumer    consumer-DemoConsumer-2-89251f12-f0ae-4dc1-a118-bda49f2a6e86 /127.0.0.1      consumer-DemoConsumer-2 0               \nDemoConsumer    consumer-DemoConsumer-1-72221c6b-f3d9-4c68-96db-ffffa12ddf93 /127.0.0.1      consumer-DemoConsumer-1 1               \n\nafter the change, the describe command print as follows:\nGROUP           CONSUMER-ID                                    GROUP-INSTANCE-ID HOST            CLIENT-ID                       #PARTITIONS     \nDemoConsumer    groupIns2-f050379c-9c0d-433c-bbe0-44de6177b60d groupIns2         /127.0.0.1      consumer-DemoConsumer-groupIns2 0               \nDemoConsumer    groupIns1-44805ba9-ae6f-49d3-89af-44a4b95aff8d groupIns1         /127.0.0.1      consumer-DemoConsumer-groupIns1 1                        \n\nif all the GROUP-INSTANCE-ID is null, just as the previous:\nGROUP           CONSUMER-ID                                                  HOST            CLIENT-ID               #PARTITIONS     \nDemoConsumer    consumer-DemoConsumer-2-89251f12-f0ae-4dc1-a118-bda49f2a6e86 /127.0.0.1      consumer-DemoConsumer-2 0               \nDemoConsumer    consumer-DemoConsumer-1-72221c6b-f3d9-4c68-96db-ffffa12ddf93 /127.0.0.1      consumer-DemoConsumer-1 1", "createdAt": "2020-01-02T10:20:21Z", "url": "https://github.com/apache/kafka/pull/7886", "merged": true, "mergeCommit": {"oid": "33c8774acef27d061df8e001bc150d6c2eea8a2b"}, "closed": true, "closedAt": "2020-05-27T16:06:01Z", "author": {"login": "dengziming"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb2kfiQABqjI5MTkyNTI2MzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclQxiQAFqTQxODgzNDIxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0ODkyMDA2", "url": "https://github.com/apache/kafka/pull/7886#pullrequestreview-344892006", "createdAt": "2020-01-17T23:23:22Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0OTU3NTk4", "url": "https://github.com/apache/kafka/pull/7886#pullrequestreview-344957598", "createdAt": "2020-01-18T19:01:36Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxOTowMTozN1rOFfLwyw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xOFQxOTowMTozN1rOFfLwyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0Mjg5MQ==", "bodyText": "What do you think about adding this field only if the group instance id is not null?", "url": "https://github.com/apache/kafka/pull/7886#discussion_r368242891", "createdAt": "2020-01-18T19:01:37Z", "author": {"login": "hachikuji"}, "path": "core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala", "diffHunk": "@@ -249,20 +249,21 @@ object ConsumerGroupCommand extends Logging {\n       for ((groupId, (state, assignments)) <- members) {\n         if (shouldPrintMemberState(groupId, state, size(assignments))) {\n           // find proper columns width\n-          var (maxGroupLen, maxConsumerIdLen, maxHostLen, maxClientIdLen) = (15, 15, 15, 15)\n+          var (maxGroupLen, maxConsumerIdLen, maxGroupInstanceIdLen, maxHostLen, maxClientIdLen) = (15, 15, 17, 15, 15)\n           assignments match {\n             case None => // do nothing\n             case Some(memberAssignments) =>\n               memberAssignments.foreach { memberAssignment =>\n                 maxGroupLen = Math.max(maxGroupLen, memberAssignment.group.length)\n                 maxConsumerIdLen = Math.max(maxConsumerIdLen, memberAssignment.consumerId.length)\n+                maxGroupInstanceIdLen =  Math.max(maxGroupInstanceIdLen, memberAssignment.groupInstanceId.length)\n                 maxHostLen = Math.max(maxHostLen, memberAssignment.host.length)\n                 maxClientIdLen = Math.max(maxClientIdLen, memberAssignment.clientId.length)\n               }\n           }\n \n-          print(s\"\\n%${-maxGroupLen}s %${-maxConsumerIdLen}s %${-maxHostLen}s %${-maxClientIdLen}s %-15s \"\n-            .format(\"GROUP\", \"CONSUMER-ID\", \"HOST\", \"CLIENT-ID\", \"#PARTITIONS\"))\n+          print(s\"\\n%${-maxGroupLen}s %${-maxConsumerIdLen}s %${-maxGroupInstanceIdLen}s %${-maxHostLen}s %${-maxClientIdLen}s %-15s \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 29}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2MzU2MzE2", "url": "https://github.com/apache/kafka/pull/7886#pullrequestreview-346356316", "createdAt": "2020-01-22T05:44:44Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNTo0NDo0NFrOFgRGKw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwNTo0NDo0NFrOFgRGKw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTM3ODg1OQ==", "bodyText": "nit: it's a little surprising to see nullGroupInstanceId and groupInstanceId.length in the same expression. I'd expect that to be an NPE if I didn't see how it is called. I think I'd suggest inverting this. Instead of nullGroupInstanceId, how about includeGroupInstanceId? Then this becomes\nincludeGroupInstanceId = includeGroupInstanceId || memberAssignment.groupInstanceId.length > 0", "url": "https://github.com/apache/kafka/pull/7886#discussion_r369378859", "createdAt": "2020-01-22T05:44:44Z", "author": {"login": "hachikuji"}, "path": "core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala", "diffHunk": "@@ -249,20 +249,27 @@ object ConsumerGroupCommand extends Logging {\n       for ((groupId, (state, assignments)) <- members) {\n         if (shouldPrintMemberState(groupId, state, size(assignments))) {\n           // find proper columns width\n-          var (maxGroupLen, maxConsumerIdLen, maxHostLen, maxClientIdLen) = (15, 15, 15, 15)\n+          var (maxGroupLen, maxConsumerIdLen, maxGroupInstanceIdLen, maxHostLen, maxClientIdLen, nullGroupInstanceId) = (15, 15, 17, 15, 15, true)\n           assignments match {\n             case None => // do nothing\n             case Some(memberAssignments) =>\n               memberAssignments.foreach { memberAssignment =>\n                 maxGroupLen = Math.max(maxGroupLen, memberAssignment.group.length)\n                 maxConsumerIdLen = Math.max(maxConsumerIdLen, memberAssignment.consumerId.length)\n+                maxGroupInstanceIdLen =  Math.max(maxGroupInstanceIdLen, memberAssignment.groupInstanceId.length)\n                 maxHostLen = Math.max(maxHostLen, memberAssignment.host.length)\n                 maxClientIdLen = Math.max(maxClientIdLen, memberAssignment.clientId.length)\n+                nullGroupInstanceId = nullGroupInstanceId && memberAssignment.groupInstanceId.length == 0", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f7f75b5a87b9a4a6f81b679270d2dcbfd8728b9", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/0f7f75b5a87b9a4a6f81b679270d2dcbfd8728b9", "committedDate": "2020-01-31T07:51:31Z", "message": "KAFKA-9353: Add groupInstanceId to DescribeGroup for better visibility"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "0f7f75b5a87b9a4a6f81b679270d2dcbfd8728b9", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/0f7f75b5a87b9a4a6f81b679270d2dcbfd8728b9", "committedDate": "2020-01-31T07:51:31Z", "message": "KAFKA-9353: Add groupInstanceId to DescribeGroup for better visibility"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4Nzg0NDEz", "url": "https://github.com/apache/kafka/pull/7886#pullrequestreview-418784413", "createdAt": "2020-05-27T01:05:50Z", "commit": {"oid": "0f7f75b5a87b9a4a6f81b679270d2dcbfd8728b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE4ODM0MjEx", "url": "https://github.com/apache/kafka/pull/7886#pullrequestreview-418834211", "createdAt": "2020-05-27T03:33:52Z", "commit": {"oid": "0f7f75b5a87b9a4a6f81b679270d2dcbfd8728b9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2159, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}