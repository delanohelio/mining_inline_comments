{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3ODkxMDQy", "number": 9477, "title": "MINOR: TopologyTestDriver should not require dummy parameters", "bodyText": "TopologyTestDriver comes with a paper cut that it passes through a\nconfig requirement that application.id and bootstrap.servers must be\nconfigured. But these configs are not required in the context of\nTopologyTestDriver specifically. This change relaxes the requirement.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-10-21T22:07:48Z", "url": "https://github.com/apache/kafka/pull/9477", "merged": true, "mergeCommit": {"oid": "58bd0a6ee383b54ad8f1f9c7213d0978108150b8"}, "closed": true, "closedAt": "2020-10-22T13:19:02Z", "author": {"login": "vvcephei"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdU05LJABqjM5MDYxNzE2NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdVBZpnAFqTUxNDY4NTY5Ng==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "57e48003d9dd9732d65609c9da1d7e58e34acc91", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/57e48003d9dd9732d65609c9da1d7e58e34acc91", "committedDate": "2020-10-21T22:14:29Z", "message": "MINOR: TopologyTestDriver should not require dummy parameters"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57e48003d9dd9732d65609c9da1d7e58e34acc91", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/57e48003d9dd9732d65609c9da1d7e58e34acc91", "committedDate": "2020-10-21T22:14:29Z", "message": "MINOR: TopologyTestDriver should not require dummy parameters"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MjQ4NTg3", "url": "https://github.com/apache/kafka/pull/9477#pullrequestreview-514248587", "createdAt": "2020-10-21T23:00:28Z", "commit": {"oid": "57e48003d9dd9732d65609c9da1d7e58e34acc91"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzowMDoyOFrOHmKtCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzowMDoyOFrOHmKtCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc4MzMwNg==", "bodyText": "can be removed?", "url": "https://github.com/apache/kafka/pull/9477#discussion_r509783306", "createdAt": "2020-10-21T23:00:28Z", "author": {"login": "mjsax"}, "path": "streams/examples/src/test/java/org/apache/kafka/streams/examples/docs/DeveloperGuideTesting.java", "diffHunk": "@@ -73,7 +73,6 @@ public void setup() {\n         // setup test driver\n         final Properties props = new Properties();\n         props.setProperty(StreamsConfig.APPLICATION_ID_CONFIG, \"maxAggregation\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e48003d9dd9732d65609c9da1d7e58e34acc91"}, "originalPosition": 3}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0MjQ4NjYw", "url": "https://github.com/apache/kafka/pull/9477#pullrequestreview-514248660", "createdAt": "2020-10-21T23:00:40Z", "commit": {"oid": "57e48003d9dd9732d65609c9da1d7e58e34acc91"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzowMDo0MFrOHmKtVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzowMDo0MFrOHmKtVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc4MzM4MA==", "bodyText": "can be removed? (seems on many other tests, too)", "url": "https://github.com/apache/kafka/pull/9477#discussion_r509783380", "createdAt": "2020-10-21T23:00:40Z", "author": {"login": "mjsax"}, "path": "streams/src/test/java/org/apache/kafka/streams/TopologyTest.java", "diffHunk": "@@ -340,7 +340,6 @@ public void shouldThrowOnUnassignedStateStoreAccess() {\n         final String badNodeName = \"badGuy\";\n \n         final Properties config = new Properties();\n-        config.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"host:1\");\n         config.put(StreamsConfig.APPLICATION_ID_CONFIG, \"appId\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e48003d9dd9732d65609c9da1d7e58e34acc91"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91f9772971700f598b7375b57d823d239e2e77fe", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/91f9772971700f598b7375b57d823d239e2e77fe", "committedDate": "2020-10-22T04:05:22Z", "message": "unused import"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "058655fd846bd02e2d3b971c011d67ea1c13fe0d", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/058655fd846bd02e2d3b971c011d67ea1c13fe0d", "committedDate": "2020-10-22T04:11:39Z", "message": "keep necessary temp directory config"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c43e1984692dbb27934471e4c5d90e93f715c67", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/2c43e1984692dbb27934471e4c5d90e93f715c67", "committedDate": "2020-10-22T04:50:46Z", "message": "forgot about the new MockProcessorContext during the rebase"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0Njc3NjU5", "url": "https://github.com/apache/kafka/pull/9477#pullrequestreview-514677659", "createdAt": "2020-10-22T12:38:18Z", "commit": {"oid": "2c43e1984692dbb27934471e4c5d90e93f715c67"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMjozODoxOFrOHmfntA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMjozODoxOFrOHmfntA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEyNjAwNA==", "bodyText": "this comment (https://github.com/apache/kafka/blob/trunk/streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java#L138) can be removed since it is not necessary anymore.", "url": "https://github.com/apache/kafka/pull/9477#discussion_r510126004", "createdAt": "2020-10-22T12:38:18Z", "author": {"login": "chia7712"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -297,7 +297,15 @@ public TopologyTestDriver(final Topology topology,\n     private TopologyTestDriver(final InternalTopologyBuilder builder,\n                                final Properties config,\n                                final long initialWallClockTimeMs) {\n-        final StreamsConfig streamsConfig = new ClientUtils.QuietStreamsConfig(config);\n+        final Properties configCopy = new Properties();\n+        configCopy.putAll(config);\n+        if (!configCopy.containsKey(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c43e1984692dbb27934471e4c5d90e93f715c67"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTE0Njg1Njk2", "url": "https://github.com/apache/kafka/pull/9477#pullrequestreview-514685696", "createdAt": "2020-10-22T12:47:33Z", "commit": {"oid": "2c43e1984692dbb27934471e4c5d90e93f715c67"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMjo0NzozNFrOHmf-Vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMjo0NzozNFrOHmf-Vg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEzMTc5OA==", "bodyText": "How about replacing containsKey/setProperty by putIfAbsent", "url": "https://github.com/apache/kafka/pull/9477#discussion_r510131798", "createdAt": "2020-10-22T12:47:34Z", "author": {"login": "chia7712"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -297,7 +297,15 @@ public TopologyTestDriver(final Topology topology,\n     private TopologyTestDriver(final InternalTopologyBuilder builder,\n                                final Properties config,\n                                final long initialWallClockTimeMs) {\n-        final StreamsConfig streamsConfig = new ClientUtils.QuietStreamsConfig(config);\n+        final Properties configCopy = new Properties();\n+        configCopy.putAll(config);\n+        if (!configCopy.containsKey(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG)) {\n+            configCopy.setProperty(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"dummy-bootstrap-host:0\");\n+        }\n+        if (!configCopy.containsKey(StreamsConfig.APPLICATION_ID_CONFIG)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c43e1984692dbb27934471e4c5d90e93f715c67"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2841, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}