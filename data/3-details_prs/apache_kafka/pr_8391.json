{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2MDgyNDUy", "number": 8391, "title": "MINOR: reduce garbage in operation and resource java conversions", "bodyText": "Minor change to reduce unnecessary garbage generation on Operation and ResourceType java/scala conversions.\nThe round-trip tests in \n  \n    \n      kafka/core/src/test/scala/unit/kafka/security/auth/ResourceTypeTest.scala\n    \n    \n         Line 48\n      in\n      dbeaba5\n    \n    \n    \n    \n\n        \n          \n           case JResourceType.UNKNOWN | JResourceType.ANY => \n        \n    \n  \n\n and \n  \n    \n      kafka/core/src/test/scala/unit/kafka/security/auth/OperationTest.scala\n    \n    \n         Line 33\n      in\n      dbeaba5\n    \n    \n    \n    \n\n        \n          \n           case AclOperation.UNKNOWN | AclOperation.ANY => \n        \n    \n  \n\n test this code path well so this change is very small risk.", "createdAt": "2020-03-31T05:27:56Z", "url": "https://github.com/apache/kafka/pull/8391", "merged": true, "mergeCommit": {"oid": "cb9125106d69f4662df070cb2196341066698a5e"}, "closed": true, "closedAt": "2020-04-01T03:16:07Z", "author": {"login": "lbradstreet"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcS8K71AH2gAyMzk2MDgyNDUyOmNlZTI3NDlhYTNiODg5NzJiMjA3MGFjNzc1NGIzZGZjMTNjMDlhNTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcTFVf3gH2gAyMzk2MDgyNDUyOmYwNDM0YjMyOWJiOWRjOGRiMGUzYTNhMGQwZGVjMDY1YzZjM2NlMWY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cee2749aa3b88972b2070ac7754b3dfc13c09a54", "author": {"user": {"login": "lbradstreet", "name": "Lucas Bradstreet"}}, "url": "https://github.com/apache/kafka/commit/cee2749aa3b88972b2070ac7754b3dfc13c09a54", "committedDate": "2020-03-31T05:22:58Z", "message": "MINOR: unnecessary regex replace and string matching in operation\nconversions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6e84e48d87f2887235dfc741b3e535d4ff7d7999", "author": {"user": {"login": "lbradstreet", "name": "Lucas Bradstreet"}}, "url": "https://github.com/apache/kafka/commit/6e84e48d87f2887235dfc741b3e535d4ff7d7999", "committedDate": "2020-03-31T05:28:57Z", "message": "operation -> resourceType"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg0NDQ4NDE5", "url": "https://github.com/apache/kafka/pull/8391#pullrequestreview-384448419", "createdAt": "2020-03-31T06:58:11Z", "commit": {"oid": "6e84e48d87f2887235dfc741b3e535d4ff7d7999"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNjo1ODoxMVrOF-HwMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQwNjo1ODoyMVrOF-HwfQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4MzA1OQ==", "bodyText": "nit: Can we use error message similar to fromString method?", "url": "https://github.com/apache/kafka/pull/8391#discussion_r400683059", "createdAt": "2020-03-31T06:58:11Z", "author": {"login": "omkreddy"}, "path": "core/src/main/scala/kafka/security/auth/Operation.scala", "diffHunk": "@@ -91,7 +91,22 @@ object Operation {\n     op.getOrElse(throw new KafkaException(operation + \" not a valid operation name. The valid names are \" + values.mkString(\",\")))\n   }\n \n-  def fromJava(operation: AclOperation): Operation = fromString(operation.toString.replaceAll(\"_\", \"\"))\n+  def fromJava(operation: AclOperation): Operation = {\n+    operation match {\n+      case AclOperation.READ => Read\n+      case AclOperation.WRITE => Write\n+      case AclOperation.CREATE => Create\n+      case AclOperation.DELETE => Delete\n+      case AclOperation.ALTER => Alter\n+      case AclOperation.DESCRIBE => Describe\n+      case AclOperation.CLUSTER_ACTION => ClusterAction\n+      case AclOperation.ALTER_CONFIGS => AlterConfigs\n+      case AclOperation.DESCRIBE_CONFIGS => DescribeConfigs\n+      case AclOperation.IDEMPOTENT_WRITE => IdempotentWrite\n+      case AclOperation.ALL => All\n+      case _ => throw new KafkaException(\"Unexpected conversion of operation \" + operation)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e84e48d87f2887235dfc741b3e535d4ff7d7999"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY4MzEzMw==", "bodyText": "nit: Can we use error message similar to fromString method?", "url": "https://github.com/apache/kafka/pull/8391#discussion_r400683133", "createdAt": "2020-03-31T06:58:21Z", "author": {"login": "omkreddy"}, "path": "core/src/main/scala/kafka/security/auth/ResourceType.scala", "diffHunk": "@@ -80,5 +80,14 @@ object ResourceType {\n \n   def values: Seq[ResourceType] = List(Topic, Group, Cluster, TransactionalId, DelegationToken)\n \n-  def fromJava(operation: JResourceType): ResourceType = fromString(operation.toString.replaceAll(\"_\", \"\"))\n+  def fromJava(resourceType: JResourceType): ResourceType = {\n+    resourceType match {\n+      case JResourceType.TOPIC => Topic\n+      case JResourceType.GROUP => Group\n+      case JResourceType.CLUSTER => Cluster\n+      case JResourceType.TRANSACTIONAL_ID => TransactionalId\n+      case JResourceType.DELEGATION_TOKEN => DelegationToken\n+      case _ => throw new KafkaException(\"Unexpected conversion of operation \" + resourceType)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e84e48d87f2887235dfc741b3e535d4ff7d7999"}, "originalPosition": 12}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0434b329bb9dc8db0e3a3a0d0dec065c6c3ce1f", "author": {"user": {"login": "lbradstreet", "name": "Lucas Bradstreet"}}, "url": "https://github.com/apache/kafka/commit/f0434b329bb9dc8db0e3a3a0d0dec065c6c3ce1f", "committedDate": "2020-03-31T16:03:39Z", "message": "Improve error message"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 9, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}