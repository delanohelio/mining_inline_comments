{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA0MDU4NTA2", "number": 8495, "title": "MINOR: downgrade test should wait for ISR rejoin between rolls", "bodyText": "I added a change to the upgrade test a while back that would make it wait for ISR rejoin before rolls. This prevents incompatible brokers charging through a bad roll and disguising a downgrade problem.\nWe now also check for protocol errors in the broker logs.", "createdAt": "2020-04-16T00:50:04Z", "url": "https://github.com/apache/kafka/pull/8495", "merged": true, "mergeCommit": {"oid": "b161358998cdb6cee1ec184621836fa035fa16c6"}, "closed": true, "closedAt": "2020-04-23T07:15:44Z", "author": {"login": "lbradstreet"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcYB1DVgH2gAyNDA0MDU4NTA2OjRjZDg4MDRiNDQwZWRhNzBiYjEzMjEzOWRlZDNlYjVmNGY1NGY5NmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcaXjofgFqTM5ODgxOTE3OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4cd8804b440eda70bb132139ded3eb5f4f54f96c", "author": {"user": {"login": "lbradstreet", "name": "Lucas Bradstreet"}}, "url": "https://github.com/apache/kafka/commit/4cd8804b440eda70bb132139ded3eb5f4f54f96c", "committedDate": "2020-04-16T00:48:07Z", "message": "MINOR: downgrade test should wait for ISR rejoin between rolls"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1MDk0NzU1", "url": "https://github.com/apache/kafka/pull/8495#pullrequestreview-395094755", "createdAt": "2020-04-17T00:56:21Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwMDo1NjoyMVrOGG8Qiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xN1QwMDo1NjoyMVrOGG8Qiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTkzMTkxNQ==", "bodyText": "These additions don't work because of the changes to allow for static group membership. I will revert them and we can address it in a follow up PR.", "url": "https://github.com/apache/kafka/pull/8495#discussion_r409931915", "createdAt": "2020-04-17T00:56:21Z", "author": {"login": "lbradstreet"}, "path": "tests/kafkatest/tests/core/downgrade_test.py", "diffHunk": "@@ -71,7 +76,16 @@ def setup_services(self, kafka_version, compression_types, security_protocol):\n                              version=kafka_version)\n         self.consumer.start()\n \n+    def wait_until_rejoin(self):\n+        for partition in range(0, self.PARTITIONS):\n+            wait_until(lambda: len(self.kafka.isr_idx_list(self.topic, partition)) == self.REPLICATION_FACTOR, \n+                    timeout_sec=60, backoff_sec=1, err_msg=\"Replicas did not rejoin the ISR in a reasonable amount of time\")\n+\n     @cluster(num_nodes=7)\n+    @parametrize(version=str(LATEST_2_5), compression_types=[\"none\"])", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 53}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "4cd8804b440eda70bb132139ded3eb5f4f54f96c", "author": {"user": {"login": "lbradstreet", "name": "Lucas Bradstreet"}}, "url": "https://github.com/apache/kafka/commit/4cd8804b440eda70bb132139ded3eb5f4f54f96c", "committedDate": "2020-04-16T00:48:07Z", "message": "MINOR: downgrade test should wait for ISR rejoin between rolls"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4NDQyNzkw", "url": "https://github.com/apache/kafka/pull/8495#pullrequestreview-398442790", "createdAt": "2020-04-22T18:00:42Z", "commit": {"oid": "4cd8804b440eda70bb132139ded3eb5f4f54f96c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODowMDo0MlrOGKDsMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQxODowMDo0MlrOGKDsMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzE5OTQxMQ==", "bodyText": "Is this necessary to be defined as constants?", "url": "https://github.com/apache/kafka/pull/8495#discussion_r413199411", "createdAt": "2020-04-22T18:00:42Z", "author": {"login": "abbccdda"}, "path": "tests/kafkatest/tests/core/downgrade_test.py", "diffHunk": "@@ -26,10 +27,12 @@\n from kafkatest.version import LATEST_0_9, LATEST_0_10, LATEST_0_10_0, LATEST_0_10_1, LATEST_0_10_2, LATEST_0_11_0, LATEST_1_0, LATEST_1_1, LATEST_2_0, LATEST_2_1, LATEST_2_2, LATEST_2_3, V_0_9_0_0, V_0_11_0_0, DEV_BRANCH, KafkaVersion\n \n class TestDowngrade(EndToEndTest):\n+    PARTITIONS = 3\n+    REPLICATION_FACTOR = 3\n \n     TOPIC_CONFIG = {\n-        \"partitions\": 3,\n-        \"replication-factor\": 3,\n+        \"partitions\": PARTITIONS,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4cd8804b440eda70bb132139ded3eb5f4f54f96c"}, "originalPosition": 18}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4ODE5MTc5", "url": "https://github.com/apache/kafka/pull/8495#pullrequestreview-398819179", "createdAt": "2020-04-23T07:14:51Z", "commit": {"oid": "4cd8804b440eda70bb132139ded3eb5f4f54f96c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1529, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}