{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDMyOTEyOTYz", "number": 8853, "title": "KAFKA-10147 MockAdminClient#describeConfigs(Collection<ConfigResource\u2026", "bodyText": "MockAdminClient#describeConfigs(Collection<ConfigResource>) has new implementation introduced by 48b56e5. It is unable to handle broker resource so ReassignPartitionsUnitTest#testModifyBrokerThrottles throws NPE.\nhttps://issues.apache.org/jira/browse/KAFKA-10147\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-06-11T08:12:47Z", "url": "https://github.com/apache/kafka/pull/8853", "merged": true, "mergeCommit": {"oid": "26e238c6f5a242459f52bfefa97a6b0c247b2d5e"}, "closed": true, "closedAt": "2020-06-17T14:56:08Z", "author": {"login": "chia7712"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcqV2ktgFqTQyOTMzMTAwOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcsLHcPAFqTQzMjQ4ODIzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI5MzMxMDA5", "url": "https://github.com/apache/kafka/pull/8853#pullrequestreview-429331009", "createdAt": "2020-06-11T22:16:52Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjoxNjo1MlrOGiwo7Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xMVQyMjoxNzozMVrOGiwptA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTEwMTY3Nw==", "bodyText": "Maybe just deprecate public method instead of removing it", "url": "https://github.com/apache/kafka/pull/8853#discussion_r439101677", "createdAt": "2020-06-11T22:16:52Z", "author": {"login": "abbccdda"}, "path": "clients/src/test/java/org/apache/kafka/clients/admin/MockAdminClient.java", "diffHunk": "@@ -365,51 +366,6 @@ synchronized public DescribeTopicsResult describeTopics(Collection<String> topic\n         return new DescribeTopicsResult(topicDescriptions);\n     }\n \n-    @Override\n-    public DescribeConfigsResult describeConfigs(Collection<ConfigResource> resources) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTEwMTg3Ng==", "bodyText": "nit: topicMetadata.fetchesRemainingUntilVisible = Math.max(0, topicMetadata.fetchesRemainingUntilVisible -1);", "url": "https://github.com/apache/kafka/pull/8853#discussion_r439101876", "createdAt": "2020-06-11T22:17:31Z", "author": {"login": "abbccdda"}, "path": "clients/src/test/java/org/apache/kafka/clients/admin/MockAdminClient.java", "diffHunk": "@@ -560,10 +529,14 @@ synchronized private Config getResourceDescription(ConfigResource resource) {\n             }\n             case TOPIC: {\n                 TopicMetadata topicMetadata = allTopics.get(resource.name());\n-                if (topicMetadata == null) {\n-                    throw new UnknownTopicOrPartitionException();\n+                if (topicMetadata != null && !topicMetadata.markedForDeletion) {\n+                    if (topicMetadata.fetchesRemainingUntilVisible > 0) topicMetadata.fetchesRemainingUntilVisible--;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 96}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "184f83ab32b4a0caf4d0566d687f81efb611a5f7", "author": {"user": {"login": "chia7712", "name": "Chia-Ping Tsai"}}, "url": "https://github.com/apache/kafka/commit/184f83ab32b4a0caf4d0566d687f81efb611a5f7", "committedDate": "2020-06-13T10:33:49Z", "message": "KAFKA-10147 MockAdminClient#describeConfigs(Collection<ConfigResource>) is unable to handle broker resource"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "184f83ab32b4a0caf4d0566d687f81efb611a5f7", "author": {"user": {"login": "chia7712", "name": "Chia-Ping Tsai"}}, "url": "https://github.com/apache/kafka/commit/184f83ab32b4a0caf4d0566d687f81efb611a5f7", "committedDate": "2020-06-13T10:33:49Z", "message": "KAFKA-10147 MockAdminClient#describeConfigs(Collection<ConfigResource>) is unable to handle broker resource"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNDg2MzI1", "url": "https://github.com/apache/kafka/pull/8853#pullrequestreview-432486325", "createdAt": "2020-06-17T14:53:56Z", "commit": {"oid": "184f83ab32b4a0caf4d0566d687f81efb611a5f7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDMyNDg4MjM3", "url": "https://github.com/apache/kafka/pull/8853#pullrequestreview-432488237", "createdAt": "2020-06-17T14:55:49Z", "commit": {"oid": "184f83ab32b4a0caf4d0566d687f81efb611a5f7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDo1NTo1MFrOGlJumA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0xN1QxNDo1NTo1MFrOGlJumA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTYwOTg4MA==", "bodyText": "nit: I think that we can use toConfigObject(topicMetadata.configs) here.", "url": "https://github.com/apache/kafka/pull/8853#discussion_r441609880", "createdAt": "2020-06-17T14:55:50Z", "author": {"login": "dajac"}, "path": "clients/src/test/java/org/apache/kafka/clients/admin/MockAdminClient.java", "diffHunk": "@@ -560,10 +529,15 @@ synchronized private Config getResourceDescription(ConfigResource resource) {\n             }\n             case TOPIC: {\n                 TopicMetadata topicMetadata = allTopics.get(resource.name());\n-                if (topicMetadata == null) {\n-                    throw new UnknownTopicOrPartitionException();\n+                if (topicMetadata != null && !topicMetadata.markedForDeletion) {\n+                    if (topicMetadata.fetchesRemainingUntilVisible > 0)\n+                        topicMetadata.fetchesRemainingUntilVisible = Math.max(0, topicMetadata.fetchesRemainingUntilVisible - 1);\n+                    else return new Config(topicMetadata.configs.entrySet().stream()\n+                                .map(entry -> new ConfigEntry(entry.getKey(), entry.getValue()))\n+                                .collect(Collectors.toList()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "184f83ab32b4a0caf4d0566d687f81efb611a5f7"}, "originalPosition": 100}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 601, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}