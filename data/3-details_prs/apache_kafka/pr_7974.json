{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzNzMxOTA5", "number": 7974, "title": "MINOR: fix flaky StreamsUpgradeTestIntegrationTest", "bodyText": "This test failed on trunk recently. It looks like a race condition in which kafkaStreams4 hadn't completed the rebalance by the time we tested the final version number. Rather than trying to synchronize on state transitions, it's more foolproof (although potentially more opaque) to just wait a while for the versions to converge.\nSee https://builds.apache.org/blue/organizations/jenkins/kafka-trunk-jdk11/detail/kafka-trunk-jdk11/1085/tests for the failure\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-01-16T16:22:07Z", "url": "https://github.com/apache/kafka/pull/7974", "merged": true, "mergeCommit": {"oid": "cd4ab4189e32a7b4a88d6762a39fa947c4eee14b"}, "closed": true, "closedAt": "2020-01-16T22:30:58Z", "author": {"login": "vvcephei"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb68mM5AH2gAyMzYzNzMxOTA5OjE0ZjFjODAxN2ZlZWFhNTZkMTkwYmQ2NTQxMjg4NDUzMWQ2YThjZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6-UcjgH2gAyMzYzNzMxOTA5OjMxYTYyZWQ0ZDYyNmI4NmU3NTA5MDczY2ViMzdkNmVlNWY5ZDU0OTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "14f1c8017feeaa56d190bd65412884531d6a8cd7", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/14f1c8017feeaa56d190bd65412884531d6a8cd7", "committedDate": "2020-01-16T16:18:34Z", "message": "MINOR: fix flaky StreamsUpgradeTestIntegrationTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0MDkzODAy", "url": "https://github.com/apache/kafka/pull/7974#pullrequestreview-344093802", "createdAt": "2020-01-16T17:37:15Z", "commit": {"oid": "14f1c8017feeaa56d190bd65412884531d6a8cd7"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxNzozNzoxNVrOFeh3Wg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNlQxNzozNzoxNVrOFeh3Wg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzU1NjQ0Mg==", "bodyText": "Should we consider doing the same for second / first roll as well?", "url": "https://github.com/apache/kafka/pull/7974#discussion_r367556442", "createdAt": "2020-01-16T17:37:15Z", "author": {"login": "guozhangwang"}, "path": "streams/src/test/java/org/apache/kafka/streams/integration/StreamsUpgradeTestIntegrationTest.java", "diffHunk": "@@ -87,9 +88,9 @@ public void testVersionProbingUpgrade() throws InterruptedException {\n         final AtomicInteger usedVersion6 = new AtomicInteger();\n         final KafkaStreams kafkaStreams6 = buildFutureStreams(usedVersion6);\n         startSync(kafkaStreams6);\n-        assertThat(usedVersion6.get(), is(LATEST_SUPPORTED_VERSION + 1));\n-        assertThat(usedVersion5.get(), is(LATEST_SUPPORTED_VERSION + 1));\n-        assertThat(usedVersion4.get(), is(LATEST_SUPPORTED_VERSION + 1));\n+        retryOnExceptionWithTimeout(() -> assertThat(usedVersion6.get(), is(LATEST_SUPPORTED_VERSION + 1)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "14f1c8017feeaa56d190bd65412884531d6a8cd7"}, "originalPosition": 15}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "31a62ed4d626b86e7509073ceb37d6ee5f9d5490", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/31a62ed4d626b86e7509073ceb37d6ee5f9d5490", "committedDate": "2020-01-16T18:18:59Z", "message": "drop unrelated change"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2040, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}