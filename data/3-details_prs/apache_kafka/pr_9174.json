{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY3MDg3NzY0", "number": 9174, "title": "KAFKA-10395: relax output topic check in TTD to work with dynamic routing", "bodyText": "I went through all 5 stages of grief in thinking about what to do here and decided the best thing was to just relax the check after all. Hopefully users who find their output topic unexpectedly empty due to a typo in the topic name will be able to figure it out quickly from the warning we now log instead.\nNot sure how rampant the problem of output-topic-typos is to begin with...", "createdAt": "2020-08-13T01:11:47Z", "url": "https://github.com/apache/kafka/pull/9174", "merged": true, "mergeCommit": {"oid": "077984690132c6ecfe2514359450342101437032"}, "closed": true, "closedAt": "2020-08-18T14:39:41Z", "author": {"login": "ableegoldman"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc-VclggH2gAyNDY3MDg3NzY0OmM4M2NhOTUxNjk0M2RlN2M2MjJjNDgxNmRmOGQ2NDQxMGNkMDVhZGY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdAH94tAFqTQ2OTUxNTcwNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c83ca9516943de7c622c4816df8d64410cd05adf", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/c83ca9516943de7c622c4816df8d64410cd05adf", "committedDate": "2020-08-13T01:08:37Z", "message": "relax check to just a warning, add test coverage"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2NDYxOTk5", "url": "https://github.com/apache/kafka/pull/9174#pullrequestreview-466461999", "createdAt": "2020-08-13T05:52:59Z", "commit": {"oid": "c83ca9516943de7c622c4816df8d64410cd05adf"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwNTo1Mjo1OVrOG_892A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xM1QwNTo1NToxM1rOG_9BFw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxMjM0NA==", "bodyText": "nit: could avoid the last space after is correct.", "url": "https://github.com/apache/kafka/pull/9174#discussion_r469712344", "createdAt": "2020-08-13T05:52:59Z", "author": {"login": "abbccdda"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -805,10 +805,10 @@ public void advanceWallClockTime(final Duration advance) {\n \n     private Queue<ProducerRecord<byte[], byte[]>> getRecordsQueue(final String topicName) {\n         final Queue<ProducerRecord<byte[], byte[]>> outputRecords = outputRecordsByTopic.get(topicName);\n-        if (outputRecords == null) {\n-            if (!processorTopology.sinkTopics().contains(topicName)) {\n-                throw new IllegalArgumentException(\"Unknown topic: \" + topicName);\n-            }\n+        if (outputRecords == null && !processorTopology.sinkTopics().contains(topicName)) {\n+            log.warn(\"Unrecognized topic: {}, this can occur if dynamic routing is used and no output has been \"\n+                         + \"sent to this topic yet. If not using a TopicNameExtractor, check that the output topic \"\n+                         + \"is correct. \", topicName);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c83ca9516943de7c622c4816df8d64410cd05adf"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxMzE3NQ==", "bodyText": "Seems good enough as a bug fix, but I was wondering whether we could detect the dynamic topic is configured or not to make sure we are not actually allowing some other bugs to catch in TTD", "url": "https://github.com/apache/kafka/pull/9174#discussion_r469713175", "createdAt": "2020-08-13T05:55:13Z", "author": {"login": "abbccdda"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -805,10 +805,10 @@ public void advanceWallClockTime(final Duration advance) {\n \n     private Queue<ProducerRecord<byte[], byte[]>> getRecordsQueue(final String topicName) {\n         final Queue<ProducerRecord<byte[], byte[]>> outputRecords = outputRecordsByTopic.get(topicName);\n-        if (outputRecords == null) {\n-            if (!processorTopology.sinkTopics().contains(topicName)) {\n-                throw new IllegalArgumentException(\"Unknown topic: \" + topicName);\n-            }\n+        if (outputRecords == null && !processorTopology.sinkTopics().contains(topicName)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c83ca9516943de7c622c4816df8d64410cd05adf"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2OTg2NTE2", "url": "https://github.com/apache/kafka/pull/9174#pullrequestreview-466986516", "createdAt": "2020-08-13T17:32:37Z", "commit": {"oid": "c83ca9516943de7c622c4816df8d64410cd05adf"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8edc8f4720b89ef6e246dd3ed0b194a4eec8ea83", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/8edc8f4720b89ef6e246dd3ed0b194a4eec8ea83", "committedDate": "2020-08-13T17:37:21Z", "message": "fix test and remove extra space"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY5NTE1NzA3", "url": "https://github.com/apache/kafka/pull/9174#pullrequestreview-469515707", "createdAt": "2020-08-18T14:32:15Z", "commit": {"oid": "8edc8f4720b89ef6e246dd3ed0b194a4eec8ea83"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNDozMjoxNlrOHCXayg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xOFQxNDozMjoxNlrOHCXayg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjI0Mjg5MA==", "bodyText": "Ok, let's just keep it in our back pocket for now.", "url": "https://github.com/apache/kafka/pull/9174#discussion_r472242890", "createdAt": "2020-08-18T14:32:16Z", "author": {"login": "vvcephei"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -805,10 +805,10 @@ public void advanceWallClockTime(final Duration advance) {\n \n     private Queue<ProducerRecord<byte[], byte[]>> getRecordsQueue(final String topicName) {\n         final Queue<ProducerRecord<byte[], byte[]>> outputRecords = outputRecordsByTopic.get(topicName);\n-        if (outputRecords == null) {\n-            if (!processorTopology.sinkTopics().contains(topicName)) {\n-                throw new IllegalArgumentException(\"Unknown topic: \" + topicName);\n-            }\n+        if (outputRecords == null && !processorTopology.sinkTopics().contains(topicName)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTcxMzE3NQ=="}, "originalCommit": {"oid": "c83ca9516943de7c622c4816df8d64410cd05adf"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 755, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}