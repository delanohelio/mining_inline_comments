{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5NzczNzAy", "number": 9108, "title": "KAFKA-9273: Extract testShouldAutoShutdownOnIncompleteMetadata from S\u2026", "bodyText": "\u2026treamTableJoinIntegrationTest into its own test\nThe main goal is to remove usage of embedded broker (EmbeddedKafkaCluster) in AbstractJoinIntegrationTest and its subclasses.\nThis is because the tests under this class are no longer using the embedded broker, except for two.\ntestShouldAutoShutdownOnIncompleteMetadata is one of such tests.\nFurthermore, this test does not actually perfom stream-table join; it is testing an edge case of joining with a non-existent topic, so it should be in a separate test.\nTesting strategy: run existing unit and integration test\n@bbejeck\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-07-31T04:35:15Z", "url": "https://github.com/apache/kafka/pull/9108", "merged": true, "mergeCommit": {"oid": "153db488660575e8c033c3c4424211a6f567bb57"}, "closed": true, "closedAt": "2020-08-15T16:27:37Z", "author": {"login": "albert02lowis"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc6XnbFAFqTQ1OTMzODU5Mg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-nav3AFqTQ2NzE2MjI1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU5MzM4NTky", "url": "https://github.com/apache/kafka/pull/9108#pullrequestreview-459338592", "createdAt": "2020-07-31T17:24:34Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "166950971b19d3f11de0ef92d57ecdeb55c7c107", "author": {"user": {"login": "albert02lowis", "name": null}}, "url": "https://github.com/apache/kafka/commit/166950971b19d3f11de0ef92d57ecdeb55c7c107", "committedDate": "2020-08-01T02:28:59Z", "message": "KAFKA-9273: Extract testShouldAutoShutdownOnIncompleteMetadata from StreamTableJoinIntegrationTest into its own test\n\nThe main goal is to remove usage of embedded broker (EmbeddedKafkaCluster) in AbstractJoinIntegrationTest and its subclasses.\nThis is because the tests under this class are no longer using the embedded broker, except for two.\ntestShouldAutoShutdownOnIncompleteMetadata is one of such tests.\nFurthermore, this test does not actually perfom stream-table join; it is testing an edge case of joining with a non-existent topic, so it should be in a separate test."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "166950971b19d3f11de0ef92d57ecdeb55c7c107", "author": {"user": {"login": "albert02lowis", "name": null}}, "url": "https://github.com/apache/kafka/commit/166950971b19d3f11de0ef92d57ecdeb55c7c107", "committedDate": "2020-08-01T02:28:59Z", "message": "KAFKA-9273: Extract testShouldAutoShutdownOnIncompleteMetadata from StreamTableJoinIntegrationTest into its own test\n\nThe main goal is to remove usage of embedded broker (EmbeddedKafkaCluster) in AbstractJoinIntegrationTest and its subclasses.\nThis is because the tests under this class are no longer using the embedded broker, except for two.\ntestShouldAutoShutdownOnIncompleteMetadata is one of such tests.\nFurthermore, this test does not actually perfom stream-table join; it is testing an edge case of joining with a non-existent topic, so it should be in a separate test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08528e90fc3538c40cff6edd3856fb595b7a6b14", "author": {"user": {"login": "albert02lowis", "name": null}}, "url": "https://github.com/apache/kafka/commit/08528e90fc3538c40cff6edd3856fb595b7a6b14", "committedDate": "2020-08-01T06:54:08Z", "message": "KAFKA-9273: Extract shouldNotAccessJoinStoresWhenGivingName from StreamStreamJoinIntegrationTest into its own test.\n\nshouldNotAccessJoinStoresWhenGivingName is the last unit test that has a dependency to embedded broker in AbstractJoinIntegrationTest.\nThis test does not actually test the behaviour of stream-stream join;\nIt is testing an edge case of accessing the store of a join, so it should be in a separate test."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "865379e0182b685ba128cbd5d3491e9536bdfd38", "author": {"user": {"login": "albert02lowis", "name": null}}, "url": "https://github.com/apache/kafka/commit/865379e0182b685ba128cbd5d3491e9536bdfd38", "committedDate": "2020-08-01T06:54:11Z", "message": "KAFKA-9273: Remove dependency on embedded broker from AbstractJoinIntegrationTest.\n\nThe tests under AbstractJoinIntegrationTest previously requires embedded broker, but it is better to use TopologyTestDriver instead.\nExisting stream-stream join tests that still make use of embedded broker is moved to use TopologyTestDriver, by specifying it under BOOTSTRAP_SERVERS_CONFIG.\nAnd then the old EmbeddedKafkaCluster in AbstractJoinIntegrationTest is safely removed."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "865379e0182b685ba128cbd5d3491e9536bdfd38", "author": {"user": {"login": "albert02lowis", "name": null}}, "url": "https://github.com/apache/kafka/commit/865379e0182b685ba128cbd5d3491e9536bdfd38", "committedDate": "2020-08-01T06:54:11Z", "message": "KAFKA-9273: Remove dependency on embedded broker from AbstractJoinIntegrationTest.\n\nThe tests under AbstractJoinIntegrationTest previously requires embedded broker, but it is better to use TopologyTestDriver instead.\nExisting stream-stream join tests that still make use of embedded broker is moved to use TopologyTestDriver, by specifying it under BOOTSTRAP_SERVERS_CONFIG.\nAnd then the old EmbeddedKafkaCluster in AbstractJoinIntegrationTest is safely removed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY2MzMyNDY3", "url": "https://github.com/apache/kafka/pull/9108#pullrequestreview-466332467", "createdAt": "2020-08-12T22:59:35Z", "commit": {"oid": "865379e0182b685ba128cbd5d3491e9536bdfd38"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMjo1OTozNVrOG_1sTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQyMjo1OTozNVrOG_1sTA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTU5MzE2NA==", "bodyText": "@albert02lowis I've confirmed locally that the test failures are related.  The TopologyTestDriver still needs a bootstrap servers config value.\nAdding something like STREAMS_CONFIG.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \"test:0000\"); into the AbstractJoinIntegrationTest.setupConfigsAndUtils() gets all tests passing.\nI'm not sure how the JDK 14 tests passed as locally I got the same errors as the JDK 8 and 11 build locally.", "url": "https://github.com/apache/kafka/pull/9108#discussion_r469593164", "createdAt": "2020-08-12T22:59:35Z", "author": {"login": "bbejeck"}, "path": "streams/src/test/java/org/apache/kafka/streams/integration/AbstractJoinIntegrationTest.java", "diffHunk": "@@ -123,25 +117,18 @@\n     public static void setupConfigsAndUtils() {\n \n         STREAMS_CONFIG.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, \"earliest\");\n-        STREAMS_CONFIG.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, CLUSTER.bootstrapServers());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "865379e0182b685ba128cbd5d3491e9536bdfd38"}, "originalPosition": 32}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af05f07cda3b0cc232e2ed89d5f3d0f91fcf416a", "author": {"user": {"login": "albert02lowis", "name": null}}, "url": "https://github.com/apache/kafka/commit/af05f07cda3b0cc232e2ed89d5f3d0f91fcf416a", "committedDate": "2020-08-13T05:34:26Z", "message": "Centralize setting of BOOTSTRAP_SERVERS_CONFIG inside AbstractJoinIntegrationTest.\n\nPreviously the setting of BOOTSTRAP_SERVERS_CONFIG is added on each test method, but this can actually be extracted to the BeforeClass method which is setupConfigsAndUtils in AbstractJoinIntegrationTest."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3MTYyMjU5", "url": "https://github.com/apache/kafka/pull/9108#pullrequestreview-467162259", "createdAt": "2020-08-13T22:04:54Z", "commit": {"oid": "af05f07cda3b0cc232e2ed89d5f3d0f91fcf416a"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1012, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}