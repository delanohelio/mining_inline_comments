{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkyMTkzODQ2", "number": 8332, "title": "KAFKA-9688: kafka-topic.sh should show KIP-455 adding and removing replicas", "bodyText": "*More detailed description of your change,\nPrint AR and RR info in describe topic command, if the current reassignment exists.\n*Summary of testing strategy (including rationale)\n\nCommented out step B2 to B8 in KafkaController::onPartitionReassignment so the adding replica and removing replica won\u2019t be set to the empty set in memory.\nRecompile kafka src\nCreate a reassign json file with content below:\n{\"partitions\":\n[{\"topic\": \"my-replicated-topic\",\n\"partition\": 0,\n\"replicas\": [1,2] }],\n\"version\":1\n}\nRan the following scripts:\n$ bin/kafka-topics.sh --create --bootstrap-server localhost:9092 --replication-factor 3 --partitions 1 --topic my-replicated-topic\n$ bin/kafka-topics.sh --describe --bootstrap-server localhost:9092 --topic my-replicated-topic\nTopic: my-replicated-topic\tPartitionCount: 1\tReplicationFactor: 3\tConfigs: segment.bytes=1073741824\nTopic: my-replicated-topic\tPartition: 0\tLeader: 2\tReplicas: 2,1,0\tIsr: 2,1,0\n$ bin/kafka-reassign-partitions.sh --reassignment-json-file bin/reassign.json --execute --zookeeper localhost:2181\n$ bin/kafka-topics.sh --describe --bootstrap-server localhost:9092 --topic my-replicated-topic\nTopic: my-replicated-topic\tPartition: 0\tLeader: 2\tReplicas: 2,1,0\tIsr: 2,1,0\tAdding Replicas: \tRemoving Replicas: 0\nSimilarly, also tested no reassignment changes won\u2019t throw a null ptr exception. (edited)\n\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-03-23T06:53:33Z", "url": "https://github.com/apache/kafka/pull/8332", "merged": true, "mergeCommit": {"oid": "29697758a4e287d59332ffe97b6f0c1e0d4847ad"}, "closed": true, "closedAt": "2020-03-26T16:50:18Z", "author": {"login": "ctan888"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcQYi28AH2gAyMzkyMTkzODQ2OmRiMTU4OTYzNDdjYjA1NDcxYjAxNDg5NWZlZDlkZGZmYTg4YzMwNDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQjVTagH2gAyMzkyMTkzODQ2OjYyOWJjNjg4NDFmNTkxODViZDk0OWJkYWRkN2ZkZjljZjFiZWQyYTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "db15896347cb05471b014895fed9ddffa88c3047", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/db15896347cb05471b014895fed9ddffa88c3047", "committedDate": "2020-03-23T06:44:40Z", "message": "adding AR and RR printout in describe topic command"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc5Njk4NTM0", "url": "https://github.com/apache/kafka/pull/8332#pullrequestreview-379698534", "createdAt": "2020-03-23T18:16:13Z", "commit": {"oid": "db15896347cb05471b014895fed9ddffa88c3047"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxODoxNjoxNFrOF6SH4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yM1QxODoxNjoxNFrOF6SH4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjY1ODY1OA==", "bodyText": "You need to use .mkString or similar so that the text appears right", "url": "https://github.com/apache/kafka/pull/8332#discussion_r396658658", "createdAt": "2020-03-23T18:16:14Z", "author": {"login": "cmccabe"}, "path": "core/src/main/scala/kafka/admin/TopicCommand.scala", "diffHunk": "@@ -146,6 +146,10 @@ object TopicCommand extends Logging {\n       print(\"\\tLeader: \" + (if (hasLeader) info.leader.id else \"none\"))\n       print(\"\\tReplicas: \" + info.replicas.asScala.map(_.id).mkString(\",\"))\n       print(\"\\tIsr: \" + info.isr.asScala.map(_.id).mkString(\",\"))\n+      if (reassignment.nonEmpty) {\n+        print(\"\\tAdding Replicas: \" + reassignment.get.addingReplicas())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db15896347cb05471b014895fed9ddffa88c3047"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "629bc68841f59185bd949bdadd7fdf9cf1bed2a5", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/629bc68841f59185bd949bdadd7fdf9cf1bed2a5", "committedDate": "2020-03-23T19:18:49Z", "message": "Fixed the print format"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 362, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}