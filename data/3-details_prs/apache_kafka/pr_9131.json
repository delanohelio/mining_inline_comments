{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzOTExMTQy", "number": 9131, "title": "KAFKA-10367: Allow running the Streams demo app with a config file", "bodyText": "Update the 3 WordCount demos to accept a configuration file. I kept the changes to the minimum as the point of these samples is not to add a lot of logic for parsing arguments and handling usage errors.\nMore detailed description of your change,\nif necessary. The PR title and PR message become\nthe squashed commit message, so use a separate\ncomment to ping reviewers.\nSummary of testing strategy (including rationale)\nfor the feature or bug fix. Unit and/or integration\ntests are expected for any behaviour change and\nsystem tests should be considered for larger changes.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-08-06T09:35:01Z", "url": "https://github.com/apache/kafka/pull/9131", "merged": true, "mergeCommit": {"oid": "8af7b96bfbffb2455191beac41ec8db4f6d24e3b"}, "closed": true, "closedAt": "2020-08-22T16:00:01Z", "author": {"login": "mimaison"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc8McRogH2gAyNDYzOTExMTQyOjdiMDE3NTJiMWUzYmVkZmMyMmMxZTI3NGM4M2RmZTQ4N2Q1OGFkOTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdBJy-ZgFqTQ3Mjc2MjQxNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7b01752b1e3bedfc22c1e274c83dfe487d58ad98", "author": {"user": {"login": "mimaison", "name": "Mickael Maison"}}, "url": "https://github.com/apache/kafka/commit/7b01752b1e3bedfc22c1e274c83dfe487d58ad98", "committedDate": "2020-08-06T09:31:17Z", "message": "KAFKA-10367: Allow running the Streams demo app with a config file\n\nUpdate the 3 WordCount demos to accept a configuration file."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2a4683b2656802ef56e083275cf42e21c289939", "author": {"user": {"login": "mimaison", "name": "Mickael Maison"}}, "url": "https://github.com/apache/kafka/commit/a2a4683b2656802ef56e083275cf42e21c289939", "committedDate": "2020-08-06T17:26:39Z", "message": "Fix Checkstyle/Spotbugs issues"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYyNzYwMDI1", "url": "https://github.com/apache/kafka/pull/9131#pullrequestreview-462760025", "createdAt": "2020-08-06T18:08:33Z", "commit": {"oid": "a2a4683b2656802ef56e083275cf42e21c289939"}, "state": "COMMENTED", "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODowODozM1rOG8-tQQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxODoxMDo1MVrOG8-ySw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5NTEzNw==", "bodyText": "For args.length > 1 should we log a warning that some parameters are ignored and still use the first parameter as file name? -- Just ignoring all arguments silently (if there is more than one) seems not ideal?", "url": "https://github.com/apache/kafka/pull/9131#discussion_r466595137", "createdAt": "2020-08-06T18:08:33Z", "author": {"login": "mjsax"}, "path": "streams/examples/src/main/java/org/apache/kafka/streams/examples/wordcount/WordCountDemo.java", "diffHunk": "@@ -47,18 +49,23 @@\n     public static final String INPUT_TOPIC = \"streams-plaintext-input\";\n     public static final String OUTPUT_TOPIC = \"streams-wordcount-output\";\n \n-    static Properties getStreamsConfig() {\n+    static Properties getStreamsConfig(final String[] args) throws IOException {\n         final Properties props = new Properties();\n-        props.put(StreamsConfig.APPLICATION_ID_CONFIG, \"streams-wordcount\");\n-        props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"localhost:9092\");\n-        props.put(StreamsConfig.CACHE_MAX_BYTES_BUFFERING_CONFIG, 0);\n-        props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass().getName());\n-        props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass().getName());\n+        if (args != null && args.length == 1) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2a4683b2656802ef56e083275cf42e21c289939"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5NTU3Mw==", "bodyText": "Nit: We can just pass in null ?", "url": "https://github.com/apache/kafka/pull/9131#discussion_r466595573", "createdAt": "2020-08-06T18:09:18Z", "author": {"login": "mjsax"}, "path": "streams/examples/src/test/java/org/apache/kafka/streams/examples/wordcount/WordCountDemoTest.java", "diffHunk": "@@ -47,11 +48,11 @@\n     private TestOutputTopic<String, Long> outputTopic;\n \n     @Before\n-    public void setup() {\n+    public void setup() throws IOException {\n         final StreamsBuilder builder = new StreamsBuilder();\n         //Create Actual Stream Processing pipeline\n         WordCountDemo.createWordCountStream(builder);\n-        testDriver = new TopologyTestDriver(builder.build(), WordCountDemo.getStreamsConfig());\n+        testDriver = new TopologyTestDriver(builder.build(), WordCountDemo.getStreamsConfig(new String[] {}));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2a4683b2656802ef56e083275cf42e21c289939"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5NjA1NA==", "bodyText": "I think this must be final, too", "url": "https://github.com/apache/kafka/pull/9131#discussion_r466596054", "createdAt": "2020-08-06T18:10:13Z", "author": {"login": "mjsax"}, "path": "streams/examples/src/main/java/org/apache/kafka/streams/examples/wordcount/WordCountDemo.java", "diffHunk": "@@ -47,18 +49,23 @@\n     public static final String INPUT_TOPIC = \"streams-plaintext-input\";\n     public static final String OUTPUT_TOPIC = \"streams-wordcount-output\";\n \n-    static Properties getStreamsConfig() {\n+    static Properties getStreamsConfig(final String[] args) throws IOException {\n         final Properties props = new Properties();\n-        props.put(StreamsConfig.APPLICATION_ID_CONFIG, \"streams-wordcount\");\n-        props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"localhost:9092\");\n-        props.put(StreamsConfig.CACHE_MAX_BYTES_BUFFERING_CONFIG, 0);\n-        props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass().getName());\n-        props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass().getName());\n+        if (args != null && args.length == 1) {\n+            try (FileInputStream fis = new FileInputStream(args[0])) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2a4683b2656802ef56e083275cf42e21c289939"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5NjM3Mw==", "bodyText": "Missing try block to close the FileInputStream properly", "url": "https://github.com/apache/kafka/pull/9131#discussion_r466596373", "createdAt": "2020-08-06T18:10:45Z", "author": {"login": "mjsax"}, "path": "streams/examples/src/main/java/org/apache/kafka/streams/examples/wordcount/WordCountProcessorDemo.java", "diffHunk": "@@ -101,16 +103,20 @@ public void close() {}\n         }\n     }\n \n-    public static void main(final String[] args) {\n+    public static void main(final String[] args) throws IOException {\n         final Properties props = new Properties();\n-        props.put(StreamsConfig.APPLICATION_ID_CONFIG, \"streams-wordcount-processor\");\n-        props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"localhost:9092\");\n-        props.put(StreamsConfig.CACHE_MAX_BYTES_BUFFERING_CONFIG, 0);\n-        props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass());\n-        props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass());\n+        if (args != null && args.length == 1) {\n+            props.load(new FileInputStream(args[0]));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2a4683b2656802ef56e083275cf42e21c289939"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5NjQyNw==", "bodyText": "as above", "url": "https://github.com/apache/kafka/pull/9131#discussion_r466596427", "createdAt": "2020-08-06T18:10:51Z", "author": {"login": "mjsax"}, "path": "streams/examples/src/main/java/org/apache/kafka/streams/examples/wordcount/WordCountTransformerDemo.java", "diffHunk": "@@ -120,16 +122,19 @@ public void close() {}\n         }\n     }\n \n-    public static void main(final String[] args) {\n+    public static void main(final String[] args) throws IOException {\n         final Properties props = new Properties();\n-        props.put(StreamsConfig.APPLICATION_ID_CONFIG, \"streams-wordcount-transformer\");\n-        props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"localhost:9092\");\n-        props.put(StreamsConfig.CACHE_MAX_BYTES_BUFFERING_CONFIG, 0);\n-        props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass());\n-        props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass());\n+        if (args != null && args.length == 1) {\n+            props.load(new FileInputStream(args[0]));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a2a4683b2656802ef56e083275cf42e21c289939"}, "originalPosition": 22}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "dd4da0b5bcc19b5be29db8df164887bc72dd8558", "author": {"user": {"login": "mimaison", "name": "Mickael Maison"}}, "url": "https://github.com/apache/kafka/commit/dd4da0b5bcc19b5be29db8df164887bc72dd8558", "committedDate": "2020-08-08T07:19:57Z", "message": "Address comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "dd4da0b5bcc19b5be29db8df164887bc72dd8558", "author": {"user": {"login": "mimaison", "name": "Mickael Maison"}}, "url": "https://github.com/apache/kafka/commit/dd4da0b5bcc19b5be29db8df164887bc72dd8558", "committedDate": "2020-08-08T07:19:57Z", "message": "Address comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a581eae02c607d8694b21d5e57c372db5a7532e", "author": {"user": {"login": "mimaison", "name": "Mickael Maison"}}, "url": "https://github.com/apache/kafka/commit/2a581eae02c607d8694b21d5e57c372db5a7532e", "committedDate": "2020-08-18T20:49:42Z", "message": "reorder imports"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyNzYyNDE1", "url": "https://github.com/apache/kafka/pull/9131#pullrequestreview-472762415", "createdAt": "2020-08-21T19:15:59Z", "commit": {"oid": "2a581eae02c607d8694b21d5e57c372db5a7532e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1064, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}