{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI4ODMwNjkz", "number": 9660, "title": "Kafka 10629 - TopologyTestDriver should not require a Properties argument", "bodyText": "KIP-680: TopologyTestDriver should not require a Properties argument.\nhttps://cwiki.apache.org/confluence/display/KAFKA/KIP-680%3A+TopologyTestDriver+should+not+require+a+Properties+argument\nJira for the KIP:\nhttps://issues.apache.org/jira/browse/KAFKA-10629\n\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-11-28T01:50:31Z", "url": "https://github.com/apache/kafka/pull/9660", "merged": true, "mergeCommit": {"oid": "4e9c7fc8a5db6e59e43a67586867c3b1c9fbe567"}, "closed": true, "closedAt": "2020-12-04T18:51:12Z", "author": {"login": "rohitrmd"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXbFBegH2gAyNTI4ODMwNjkzOmRjOTExMzM1NTU2ZTVhZGJiMzE4NDY0MmRlYTU1NmYyMDE2ZTFmM2Q=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdhz5pyAH2gAyNTI4ODMwNjkzOjI2MGUzNjU4NGVjZTNiMTA3ZjgzNDMzYzI3ZmRkM2EwYzljNTk5NzE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dc911335556e5adbb3184642dea556f2016e1f3d", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/dc911335556e5adbb3184642dea556f2016e1f3d", "committedDate": "2020-10-29T23:50:25Z", "message": "added default constructor without properties in TopologyTestDriver"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29d2981ada9b06982175b1a03f9d60c01fcef16d", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/29d2981ada9b06982175b1a03f9d60c01fcef16d", "committedDate": "2020-10-30T01:16:04Z", "message": "using constructor of TopologyTestDriver without properties parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d12ef9095cd820db625332f2ac38522ca204f947", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/d12ef9095cd820db625332f2ac38522ca204f947", "committedDate": "2020-10-30T01:17:55Z", "message": "using constructor of TopologyTestDriver without properties parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fb237a7cdac1f18b1e990226fb55cc53c55bf42", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/8fb237a7cdac1f18b1e990226fb55cc53c55bf42", "committedDate": "2020-10-30T02:05:32Z", "message": "changed constructor reference to the one without properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0d51752b1692aa574c3f53047984d5ca85f15d6", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/e0d51752b1692aa574c3f53047984d5ca85f15d6", "committedDate": "2020-10-30T18:57:49Z", "message": "keeping default test props final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "afa7639610e79ad28a8e0ee9f3a1eb474d177521", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/afa7639610e79ad28a8e0ee9f3a1eb474d177521", "committedDate": "2020-10-30T19:41:48Z", "message": "fixed merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58aec7e134f0f7ac2c67a0c34954deb48d54892e", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/58aec7e134f0f7ac2c67a0c34954deb48d54892e", "committedDate": "2020-10-31T03:56:54Z", "message": "made changes as per style guilde"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34fce937f4fbfd252c0fe8ecf026c539f24dc1b8", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/34fce937f4fbfd252c0fe8ecf026c539f24dc1b8", "committedDate": "2020-11-06T23:56:53Z", "message": "no need of static default properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "825e8a456d226dfc139ee7db6165c81894094351", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/825e8a456d226dfc139ee7db6165c81894094351", "committedDate": "2020-11-07T04:26:11Z", "message": "provide randomized dummy app-id if it's not provided"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9bdb7b6de3b05186ba1c6430e398c9b07ab73921", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/9bdb7b6de3b05186ba1c6430e398c9b07ab73921", "committedDate": "2020-11-08T06:41:46Z", "message": "added another constructor with initial clock time parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d62c8fc0ab33e4ac779f60f00e514af1c1024373", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/d62c8fc0ab33e4ac779f60f00e514af1c1024373", "committedDate": "2020-11-28T01:26:47Z", "message": "fixed merge conflicts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQwMzg0NDg1", "url": "https://github.com/apache/kafka/pull/9660#pullrequestreview-540384485", "createdAt": "2020-11-28T16:07:39Z", "commit": {"oid": "d62c8fc0ab33e4ac779f60f00e514af1c1024373"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOFQxNjowNzozOVrOH7aG9A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yOFQxNjoxMTozM1rOH7aIXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjA1NTc5Ng==", "bodyText": "the config is not from empty properties so it may be incorrect to remove config.", "url": "https://github.com/apache/kafka/pull/9660#discussion_r532055796", "createdAt": "2020-11-28T16:07:39Z", "author": {"login": "chia7712"}, "path": "streams/test-utils/src/test/java/org/apache/kafka/streams/TopologyTestDriverTest.java", "diffHunk": "@@ -471,7 +471,7 @@ public void shouldCloseProcessor() {\n \n     @Test\n     public void shouldThrowForUnknownTopic() {\n-        testDriver = new TopologyTestDriver(new Topology(), config);\n+        testDriver = new TopologyTestDriver(new Topology());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d62c8fc0ab33e4ac779f60f00e514af1c1024373"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjA1NjAyMw==", "bodyText": "It seems to me putIfAbsent is more readable than containsKey + setProperty.", "url": "https://github.com/apache/kafka/pull/9660#discussion_r532056023", "createdAt": "2020-11-28T16:10:20Z", "author": {"login": "chia7712"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -298,8 +322,14 @@ private TopologyTestDriver(final InternalTopologyBuilder builder,\n                                final long initialWallClockTimeMs) {\n         final Properties configCopy = new Properties();\n         configCopy.putAll(config);\n-        configCopy.putIfAbsent(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"dummy-bootstrap-host:0\");\n-        configCopy.putIfAbsent(StreamsConfig.APPLICATION_ID_CONFIG, \"dummy-topology-test-driver-app-id\");\n+        if (!configCopy.containsKey(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d62c8fc0ab33e4ac779f60f00e514af1c1024373"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjA1NjEwNg==", "bodyText": "there are a lot of similar code change.", "url": "https://github.com/apache/kafka/pull/9660#discussion_r532056106", "createdAt": "2020-11-28T16:11:05Z", "author": {"login": "chia7712"}, "path": "streams/test-utils/src/test/java/org/apache/kafka/streams/TopologyTestDriverTest.java", "diffHunk": "@@ -471,7 +471,7 @@ public void shouldCloseProcessor() {\n \n     @Test\n     public void shouldThrowForUnknownTopic() {\n-        testDriver = new TopologyTestDriver(new Topology(), config);\n+        testDriver = new TopologyTestDriver(new Topology());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjA1NTc5Ng=="}, "originalCommit": {"oid": "d62c8fc0ab33e4ac779f60f00e514af1c1024373"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjA1NjE1Ng==", "bodyText": "Is it ok to remove StreamsConfig.STATE_DIR_CONFIG here?", "url": "https://github.com/apache/kafka/pull/9660#discussion_r532056156", "createdAt": "2020-11-28T16:11:33Z", "author": {"login": "chia7712"}, "path": "streams/src/test/java/org/apache/kafka/streams/TopologyTest.java", "diffHunk": "@@ -353,8 +349,7 @@ public void shouldThrowOnUnassignedStateStoreAccess() {\n             .addProcessor(badNodeName, new LocalMockProcessorSupplier(), sourceNodeName);\n \n         try {\n-            new TopologyTestDriver(topology, mkProperties(\n-                mkMap(mkEntry(StreamsConfig.STATE_DIR_CONFIG, TestUtils.tempDirectory().getAbsolutePath()))));\n+            new TopologyTestDriver(topology);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d62c8fc0ab33e4ac779f60f00e514af1c1024373"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "324c0ea0ae2c4ade0f5320ac2e794b020f57ab52", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/324c0ea0ae2c4ade0f5320ac2e794b020f57ab52", "committedDate": "2020-11-28T20:35:39Z", "message": "made changes as per code review"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b098e345a0df5151c57c6831571be85fbf0de769", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/b098e345a0df5151c57c6831571be85fbf0de769", "committedDate": "2020-11-29T19:58:45Z", "message": "fixed failing tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQxMzkwMjYw", "url": "https://github.com/apache/kafka/pull/9660#pullrequestreview-541390260", "createdAt": "2020-12-01T00:01:49Z", "commit": {"oid": "b098e345a0df5151c57c6831571be85fbf0de769"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDowMTo0OVrOH8SuLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMVQwMDowMTo0OVrOH8SuLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjk4MzM0Mg==", "bodyText": "This overload takes initialWallClockTimeMs, thus this sentence seems to be incorrect? Should go to TopologyTestDriver(final Topology topology) instead?", "url": "https://github.com/apache/kafka/pull/9660#discussion_r532983342", "createdAt": "2020-12-01T00:01:49Z", "author": {"login": "mjsax"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -254,6 +265,19 @@ public TopologyTestDriver(final Topology topology,\n         this(topology, config, null);\n     }\n \n+    /**\n+     * Create a new test diver instance.\n+     * Initialized the internally mocked wall-clock time with {@link System#currentTimeMillis() current system time}.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b098e345a0df5151c57c6831571be85fbf0de769"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "260e36584ece3b107f83433c27fdd3a0c9c59971", "author": {"user": {"login": "rohitrmd", "name": "Rohit Deshpande"}}, "url": "https://github.com/apache/kafka/commit/260e36584ece3b107f83433c27fdd3a0c9c59971", "committedDate": "2020-12-01T06:24:52Z", "message": "fixed the comment as per review"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2491, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}