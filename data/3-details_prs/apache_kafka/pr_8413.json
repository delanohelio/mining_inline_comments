{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3OTE3OTA3", "number": 8413, "title": "MINOR: Allow single struct to be a field in protocol spec", "bodyText": "Currently protocol generation code has this restriction that a structure\nfield need to be an array. There are however some case where fields need\nto be grouped but not be an array. This is for organizational purposes\nand mirrors program structure.\nThis change adds this capability to the protocol generation.\nMore detailed description of your change,\nif necessary. The PR title and PR message become\nthe squashed commit message, so use a separate\ncomment to ping reviewers.\nSummary of testing strategy (including rationale)\nfor the feature or bug fix. Unit and/or integration\ntests are expected for any behaviour change and\nsystem tests should be considered for larger changes.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-04-03T03:38:31Z", "url": "https://github.com/apache/kafka/pull/8413", "merged": true, "mergeCommit": {"oid": "a276c546375994300dcd4d257993cd4c75ec4e3b"}, "closed": true, "closedAt": "2020-04-10T20:15:05Z", "author": {"login": "soondenana"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcUGLoRAFqTM4NzUyOTcxNg==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcWEcKkABqjMyMjAyMTI2NTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NTI5NzE2", "url": "https://github.com/apache/kafka/pull/8413#pullrequestreview-387529716", "createdAt": "2020-04-03T19:36:42Z", "commit": {"oid": "95b142402c983088e6a34c394620507498d641af"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxOTozNjo0MlrOGAloYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxOTozNjo0MlrOGAloYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzI2OTcyOA==", "bodyText": "I don't think we should get rid of this check entirely.  We should change it to check for either array or struct type, rather than just array type, right?\nIt wouldn't make sense to have an int32 with fields, for example.", "url": "https://github.com/apache/kafka/pull/8413#discussion_r403269728", "createdAt": "2020-04-03T19:36:42Z", "author": {"login": "cmccabe"}, "path": "generator/src/main/java/org/apache/kafka/message/FieldSpec.java", "diffHunk": "@@ -101,11 +101,7 @@ public FieldSpec(@JsonProperty(\"name\") String name,\n         this.entityType.verifyTypeMatches(name, this.type);\n \n         this.about = about == null ? \"\" : about;\n-        if (!this.fields().isEmpty()) {\n-            if (!this.type.isArray()) {\n-                throw new RuntimeException(\"Non-array field \" + name + \" cannot have fields\");\n-            }\n-        }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "95b142402c983088e6a34c394620507498d641af"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "95b142402c983088e6a34c394620507498d641af", "author": {"user": {"login": "soondenana", "name": "Vikas Singh"}}, "url": "https://github.com/apache/kafka/commit/95b142402c983088e6a34c394620507498d641af", "committedDate": "2020-04-03T03:30:04Z", "message": "MINOR: Allow single struct to be a field in protocol spec\n\nCurrently protocol generation code has this restriction that a structure\nfield need to be an array. There are however some case where fields need\nto be grouped but not be an array. This is for organizational purposes\nand mirrors program structure.\n\nThis change adds this capability to the protocol generation."}, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "28d3bf9a0d1610fccba2fa7519d6732bdab4ee23", "author": {"user": {"login": "soondenana", "name": "Vikas Singh"}}, "url": "https://github.com/apache/kafka/commit/28d3bf9a0d1610fccba2fa7519d6732bdab4ee23", "committedDate": "2020-04-09T20:15:02Z", "message": "MINOR: Allow single struct to be a field in protocol spec\n\nCurrently protocol generation code has this restriction that a structure\nfield need to be an array. There are however some case where fields need\nto be grouped but not be an array. This is for organizational purposes\nand mirrors program structure.\n\nThis change adds this capability to the protocol generation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc6ea26ddf4a87a8bfb95b5f3c5f11887be65fa8", "author": {"user": {"login": "soondenana", "name": "Vikas Singh"}}, "url": "https://github.com/apache/kafka/commit/fc6ea26ddf4a87a8bfb95b5f3c5f11887be65fa8", "committedDate": "2020-04-09T20:15:02Z", "message": "Take care of review comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "295295079de4f189eff0524084d0b1ecbde8f205", "author": {"user": {"login": "soondenana", "name": "Vikas Singh"}}, "url": "https://github.com/apache/kafka/commit/295295079de4f189eff0524084d0b1ecbde8f205", "committedDate": "2020-04-09T20:15:02Z", "message": "Remove Struct nullable\n\nMaking struct nullable is a bigger change, my previous attempt left a\nbunch of place where modificaiton is needed. Simpler to not support it\nas this is the current state."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fead599e2658afef62235de40469bbd23aaef2bd", "author": {"user": {"login": "soondenana", "name": "Vikas Singh"}}, "url": "https://github.com/apache/kafka/commit/fead599e2658afef62235de40469bbd23aaef2bd", "committedDate": "2020-04-09T20:15:02Z", "message": "Add support for tagged structs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a5138d1bab4200d232e18600ba8217986946060", "author": {"user": {"login": "soondenana", "name": "Vikas Singh"}}, "url": "https://github.com/apache/kafka/commit/7a5138d1bab4200d232e18600ba8217986946060", "committedDate": "2020-04-09T22:34:43Z", "message": "Add roundtrip test for SimpleExampleMessage"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "7a5138d1bab4200d232e18600ba8217986946060", "author": {"user": {"login": "soondenana", "name": "Vikas Singh"}}, "url": "https://github.com/apache/kafka/commit/7a5138d1bab4200d232e18600ba8217986946060", "committedDate": "2020-04-09T22:34:43Z", "message": "Add roundtrip test for SimpleExampleMessage"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 66, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}