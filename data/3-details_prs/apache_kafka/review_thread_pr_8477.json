{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAyOTI0ODQy", "number": 8477, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwMjoxOToyM1rODxdDeg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDowNTowNlrODxqVYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzMTgyODQyOnYy", "diffSide": "RIGHT", "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "isResolved": true, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQwMjoxOToyM1rOGE7vZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDozMTozN1rOGFRiFQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgyNjI3OA==", "bodyText": "I think we want to make the string computation lazy, but not lose info. We could do that by overriding toString.", "url": "https://github.com/apache/kafka/pull/8477#discussion_r407826278", "createdAt": "2020-04-14T02:19:23Z", "author": {"login": "ijuma"}, "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "diffHunk": "@@ -30,11 +30,7 @@\n     private final double bound;\n \n     public QuotaViolationException(MetricName metricName, double value, double bound) {\n-        super(String.format(\n-                \"'%s' violated quota. Actual: %f, Threshold: %f\",\n-                metricName,\n-                value,\n-                bound));\n+        super(metricName + \" violated quota.\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "227ca86df24220727175b9465e9061268f279041"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgyNzU5NQ==", "bodyText": "Great idea. I don't think it's currently used but it seems helpful. I'll change that.", "url": "https://github.com/apache/kafka/pull/8477#discussion_r407827595", "createdAt": "2020-04-14T02:24:17Z", "author": {"login": "lbradstreet"}, "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "diffHunk": "@@ -30,11 +30,7 @@\n     private final double bound;\n \n     public QuotaViolationException(MetricName metricName, double value, double bound) {\n-        super(String.format(\n-                \"'%s' violated quota. Actual: %f, Threshold: %f\",\n-                metricName,\n-                value,\n-                bound));\n+        super(metricName + \" violated quota.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgyNjI3OA=="}, "originalCommit": {"oid": "227ca86df24220727175b9465e9061268f279041"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgzMTA2Mw==", "bodyText": "I've fixed this. toString for an example violation before and after both returned:\norg.apache.kafka.common.metrics.QuotaViolationException: 'MetricName [name=x, group=y, description=z, tags={}]' violated quota. Actual: 3.300000, Threshold: 3.300000", "url": "https://github.com/apache/kafka/pull/8477#discussion_r407831063", "createdAt": "2020-04-14T02:37:20Z", "author": {"login": "lbradstreet"}, "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "diffHunk": "@@ -30,11 +30,7 @@\n     private final double bound;\n \n     public QuotaViolationException(MetricName metricName, double value, double bound) {\n-        super(String.format(\n-                \"'%s' violated quota. Actual: %f, Threshold: %f\",\n-                metricName,\n-                value,\n-                bound));\n+        super(metricName + \" violated quota.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgyNjI3OA=="}, "originalCommit": {"oid": "227ca86df24220727175b9465e9061268f279041"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE2MTIyNQ==", "bodyText": "Can we remove the allocation altogether in the constructor?", "url": "https://github.com/apache/kafka/pull/8477#discussion_r408161225", "createdAt": "2020-04-14T14:03:02Z", "author": {"login": "ijuma"}, "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "diffHunk": "@@ -30,11 +30,7 @@\n     private final double bound;\n \n     public QuotaViolationException(MetricName metricName, double value, double bound) {\n-        super(String.format(\n-                \"'%s' violated quota. Actual: %f, Threshold: %f\",\n-                metricName,\n-                value,\n-                bound));\n+        super(metricName + \" violated quota.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgyNjI3OA=="}, "originalCommit": {"oid": "227ca86df24220727175b9465e9061268f279041"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE2ODc0Nw==", "bodyText": "Good point, now that toString is overridden I had actually just made that change and hadn't pushed it", "url": "https://github.com/apache/kafka/pull/8477#discussion_r408168747", "createdAt": "2020-04-14T14:12:51Z", "author": {"login": "lbradstreet"}, "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "diffHunk": "@@ -30,11 +30,7 @@\n     private final double bound;\n \n     public QuotaViolationException(MetricName metricName, double value, double bound) {\n-        super(String.format(\n-                \"'%s' violated quota. Actual: %f, Threshold: %f\",\n-                metricName,\n-                value,\n-                bound));\n+        super(metricName + \" violated quota.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgyNjI3OA=="}, "originalCommit": {"oid": "227ca86df24220727175b9465e9061268f279041"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE4MzMxNw==", "bodyText": "Done", "url": "https://github.com/apache/kafka/pull/8477#discussion_r408183317", "createdAt": "2020-04-14T14:31:37Z", "author": {"login": "lbradstreet"}, "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "diffHunk": "@@ -30,11 +30,7 @@\n     private final double bound;\n \n     public QuotaViolationException(MetricName metricName, double value, double bound) {\n-        super(String.format(\n-                \"'%s' violated quota. Actual: %f, Threshold: %f\",\n-                metricName,\n-                value,\n-                bound));\n+        super(metricName + \" violated quota.\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzgyNjI3OA=="}, "originalCommit": {"oid": "227ca86df24220727175b9465e9061268f279041"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUzNDAwNDE5OnYy", "diffSide": "RIGHT", "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDowNTowNlrOGFQShg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNDozMToyM1rOGFRhXA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE2Mjk1MA==", "bodyText": "Do we need String.format here? Seems like String concat would be fine.", "url": "https://github.com/apache/kafka/pull/8477#discussion_r408162950", "createdAt": "2020-04-14T14:05:06Z", "author": {"login": "ijuma"}, "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "diffHunk": "@@ -51,4 +47,20 @@ public double value() {\n     public double bound() {\n         return bound;\n     }\n+\n+    @Override\n+    public String toString() {\n+        return String.format(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d5d7a38003a93d4ab3fe9c08593d046cc2fc058"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE4MzEzMg==", "bodyText": "Sounds good. I figured it wasn't used so simply moved it but seems better to be safe.", "url": "https://github.com/apache/kafka/pull/8477#discussion_r408183132", "createdAt": "2020-04-14T14:31:23Z", "author": {"login": "lbradstreet"}, "path": "clients/src/main/java/org/apache/kafka/common/metrics/QuotaViolationException.java", "diffHunk": "@@ -51,4 +47,20 @@ public double value() {\n     public double bound() {\n         return bound;\n     }\n+\n+    @Override\n+    public String toString() {\n+        return String.format(", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODE2Mjk1MA=="}, "originalCommit": {"oid": "3d5d7a38003a93d4ab3fe9c08593d046cc2fc058"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2983, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}