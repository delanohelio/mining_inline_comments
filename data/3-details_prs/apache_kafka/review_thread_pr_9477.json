{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTA3ODkxMDQy", "number": 9477, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzowMDoyOFrOEwiJOA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMjo0NzozNFrOEwv8rg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MzI2NTIwOnYy", "diffSide": "RIGHT", "path": "streams/examples/src/test/java/org/apache/kafka/streams/examples/docs/DeveloperGuideTesting.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzowMDoyOFrOHmKtCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQwNDoxNDoyM1rOHmP9Hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc4MzMwNg==", "bodyText": "can be removed?", "url": "https://github.com/apache/kafka/pull/9477#discussion_r509783306", "createdAt": "2020-10-21T23:00:28Z", "author": {"login": "mjsax"}, "path": "streams/examples/src/test/java/org/apache/kafka/streams/examples/docs/DeveloperGuideTesting.java", "diffHunk": "@@ -73,7 +73,6 @@ public void setup() {\n         // setup test driver\n         final Properties props = new Properties();\n         props.setProperty(StreamsConfig.APPLICATION_ID_CONFIG, \"maxAggregation\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e48003d9dd9732d65609c9da1d7e58e34acc91"}, "originalPosition": 3}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg2OTM0Mg==", "bodyText": "Yeah, you're looking at a state where I had partially applied the suggestion to drop the unnecessary configs. Bootstrap Server is always unnecessary with TTD, but applicationId sometimes winds up being necessary to keep tests from colliding on the state directory. Chasing these down is what got me hung up the first time around, so I think I'll just leave it as-is for now.", "url": "https://github.com/apache/kafka/pull/9477#discussion_r509869342", "createdAt": "2020-10-22T04:14:23Z", "author": {"login": "vvcephei"}, "path": "streams/examples/src/test/java/org/apache/kafka/streams/examples/docs/DeveloperGuideTesting.java", "diffHunk": "@@ -73,7 +73,6 @@ public void setup() {\n         // setup test driver\n         final Properties props = new Properties();\n         props.setProperty(StreamsConfig.APPLICATION_ID_CONFIG, \"maxAggregation\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc4MzMwNg=="}, "originalCommit": {"oid": "57e48003d9dd9732d65609c9da1d7e58e34acc91"}, "originalPosition": 3}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5MzI2NTYwOnYy", "diffSide": "RIGHT", "path": "streams/src/test/java/org/apache/kafka/streams/TopologyTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzowMDo0MFrOHmKtVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMVQyMzowMDo0MFrOHmKtVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc4MzM4MA==", "bodyText": "can be removed? (seems on many other tests, too)", "url": "https://github.com/apache/kafka/pull/9477#discussion_r509783380", "createdAt": "2020-10-21T23:00:40Z", "author": {"login": "mjsax"}, "path": "streams/src/test/java/org/apache/kafka/streams/TopologyTest.java", "diffHunk": "@@ -340,7 +340,6 @@ public void shouldThrowOnUnassignedStateStoreAccess() {\n         final String badNodeName = \"badGuy\";\n \n         final Properties config = new Properties();\n-        config.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"host:1\");\n         config.put(StreamsConfig.APPLICATION_ID_CONFIG, \"appId\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57e48003d9dd9732d65609c9da1d7e58e34acc91"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTQ5MDM1OnYy", "diffSide": "RIGHT", "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMjozODoxOFrOHmfntA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyMzo1NFrOHmhkIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEyNjAwNA==", "bodyText": "this comment (https://github.com/apache/kafka/blob/trunk/streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java#L138) can be removed since it is not necessary anymore.", "url": "https://github.com/apache/kafka/pull/9477#discussion_r510126004", "createdAt": "2020-10-22T12:38:18Z", "author": {"login": "chia7712"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -297,7 +297,15 @@ public TopologyTestDriver(final Topology topology,\n     private TopologyTestDriver(final InternalTopologyBuilder builder,\n                                final Properties config,\n                                final long initialWallClockTimeMs) {\n-        final StreamsConfig streamsConfig = new ClientUtils.QuietStreamsConfig(config);\n+        final Properties configCopy = new Properties();\n+        configCopy.putAll(config);\n+        if (!configCopy.containsKey(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c43e1984692dbb27934471e4c5d90e93f715c67"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE1Nzg1Nw==", "bodyText": "That's a good point. I'll put it in the follow-up ticket.", "url": "https://github.com/apache/kafka/pull/9477#discussion_r510157857", "createdAt": "2020-10-22T13:23:54Z", "author": {"login": "vvcephei"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -297,7 +297,15 @@ public TopologyTestDriver(final Topology topology,\n     private TopologyTestDriver(final InternalTopologyBuilder builder,\n                                final Properties config,\n                                final long initialWallClockTimeMs) {\n-        final StreamsConfig streamsConfig = new ClientUtils.QuietStreamsConfig(config);\n+        final Properties configCopy = new Properties();\n+        configCopy.putAll(config);\n+        if (!configCopy.containsKey(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEyNjAwNA=="}, "originalCommit": {"oid": "2c43e1984692dbb27934471e4c5d90e93f715c67"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzE5NTUyNjg2OnYy", "diffSide": "RIGHT", "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMjo0NzozNFrOHmf-Vg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yMlQxMzoyMzoyNlrOHmhiuA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEzMTc5OA==", "bodyText": "How about replacing containsKey/setProperty by putIfAbsent", "url": "https://github.com/apache/kafka/pull/9477#discussion_r510131798", "createdAt": "2020-10-22T12:47:34Z", "author": {"login": "chia7712"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -297,7 +297,15 @@ public TopologyTestDriver(final Topology topology,\n     private TopologyTestDriver(final InternalTopologyBuilder builder,\n                                final Properties config,\n                                final long initialWallClockTimeMs) {\n-        final StreamsConfig streamsConfig = new ClientUtils.QuietStreamsConfig(config);\n+        final Properties configCopy = new Properties();\n+        configCopy.putAll(config);\n+        if (!configCopy.containsKey(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG)) {\n+            configCopy.setProperty(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"dummy-bootstrap-host:0\");\n+        }\n+        if (!configCopy.containsKey(StreamsConfig.APPLICATION_ID_CONFIG)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c43e1984692dbb27934471e4c5d90e93f715c67"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDE1NzQ5Ng==", "bodyText": "Good idea! I didn't think of that. I'm sorry that I didn't see this until after I merged.", "url": "https://github.com/apache/kafka/pull/9477#discussion_r510157496", "createdAt": "2020-10-22T13:23:26Z", "author": {"login": "vvcephei"}, "path": "streams/test-utils/src/main/java/org/apache/kafka/streams/TopologyTestDriver.java", "diffHunk": "@@ -297,7 +297,15 @@ public TopologyTestDriver(final Topology topology,\n     private TopologyTestDriver(final InternalTopologyBuilder builder,\n                                final Properties config,\n                                final long initialWallClockTimeMs) {\n-        final StreamsConfig streamsConfig = new ClientUtils.QuietStreamsConfig(config);\n+        final Properties configCopy = new Properties();\n+        configCopy.putAll(config);\n+        if (!configCopy.containsKey(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG)) {\n+            configCopy.setProperty(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"dummy-bootstrap-host:0\");\n+        }\n+        if (!configCopy.containsKey(StreamsConfig.APPLICATION_ID_CONFIG)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEzMTc5OA=="}, "originalCommit": {"oid": "2c43e1984692dbb27934471e4c5d90e93f715c67"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3922, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}