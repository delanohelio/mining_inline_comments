{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwODIxODQw", "number": 9674, "title": "KAFKA-10665: close all kafkaStreams before purgeLocalStreamsState", "bodyText": "The flaky tests are because we forgot to close the kafkaStreams before purgeLocalStreamsState, so that sometimes there will be some tmp files be created/deleted during streams running(ex: checkpoint.tmp), and caused the DirectoryNotEmptyException or NoSuchFileException be thrown.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-12-02T07:45:21Z", "url": "https://github.com/apache/kafka/pull/9674", "merged": true, "mergeCommit": {"oid": "20ae73b051272c53bac108ae5ffd5a4ccd411049"}, "closed": true, "closedAt": "2020-12-04T14:04:51Z", "author": {"login": "showuon"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdiJq7tAFqTU0MjU2ODEyOA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdipX1UAFqTU0NDQyMTA2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNTY4MTI4", "url": "https://github.com/apache/kafka/pull/9674#pullrequestreview-542568128", "createdAt": "2020-12-02T07:46:42Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzo0Njo0MlrOH9OIRA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQwNzo0Njo0MlrOH9OIRA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk1NjY3Ng==", "bodyText": "I think we don't need to start 2 streams for this test", "url": "https://github.com/apache/kafka/pull/9674#discussion_r533956676", "createdAt": "2020-12-02T07:46:42Z", "author": {"login": "showuon"}, "path": "streams/src/test/java/org/apache/kafka/streams/integration/StreamTableJoinTopologyOptimizationIntegrationTest.java", "diffHunk": "@@ -149,9 +153,7 @@ public void shouldDoStreamTableJoinWithDifferentNumberOfPartitions() throws Exce\n         sendEvents(inputTopic, timestamp, expectedRecords);\n         sendEvents(outputTopic, timestamp, expectedRecords);\n \n-        startStreams(streamsBuilder);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1adb805af6876b7e5fd4da045050c33dab8354cb", "author": {"user": {"login": "showuon", "name": "Luke Chen"}}, "url": "https://github.com/apache/kafka/commit/1adb805af6876b7e5fd4da045050c33dab8354cb", "committedDate": "2020-12-02T07:49:43Z", "message": "KAFKA-10665: close all kafkaStreams before purgeLocalStreamsState"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "1adb805af6876b7e5fd4da045050c33dab8354cb", "author": {"user": {"login": "showuon", "name": "Luke Chen"}}, "url": "https://github.com/apache/kafka/commit/1adb805af6876b7e5fd4da045050c33dab8354cb", "committedDate": "2020-12-02T07:49:43Z", "message": "KAFKA-10665: close all kafkaStreams before purgeLocalStreamsState"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0MzgyNjg4", "url": "https://github.com/apache/kafka/pull/9674#pullrequestreview-544382688", "createdAt": "2020-12-03T20:18:45Z", "commit": {"oid": "1adb805af6876b7e5fd4da045050c33dab8354cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0NDIxMDYz", "url": "https://github.com/apache/kafka/pull/9674#pullrequestreview-544421063", "createdAt": "2020-12-03T20:42:48Z", "commit": {"oid": "1adb805af6876b7e5fd4da045050c33dab8354cb"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2512, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}