{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ1MTgzNDEz", "number": 9785, "title": "KAFKA-10887 Migrate log4j-appender module to JUnit 5", "bodyText": "Migrate log4j-appender module to JUnit 5", "createdAt": "2020-12-24T07:13:54Z", "url": "https://github.com/apache/kafka/pull/9785", "merged": true, "mergeCommit": {"oid": "f06dff11030b3eebc9baa8e7ff95a1ce0c8f5997"}, "closed": true, "closedAt": "2021-01-10T06:59:32Z", "author": {"login": "g1geordie"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdpOWCGAH2gAyNTQ1MTgzNDEzOjgxZDY0MmM0OWZkOGMwNWRlNDQwNTQzMGRlYTc3Yjk2ZDYyNGRlYjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdu0E-dgFqTU2NDg3Njc3MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "81d642c49fd8c05de4405430dea77b96d624deb5", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/81d642c49fd8c05de4405430dea77b96d624deb5", "committedDate": "2020-12-24T07:10:52Z", "message": "KAFKA-10887 Migrate log4j-appender module to JUnit 5"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2640cf19647cc3667bbde1a70ffde47abaeeb6e4", "author": {"user": null}, "url": "https://github.com/apache/kafka/commit/2640cf19647cc3667bbde1a70ffde47abaeeb6e4", "committedDate": "2020-12-24T09:52:28Z", "message": "add test prefix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4NDQ3OTI1", "url": "https://github.com/apache/kafka/pull/9785#pullrequestreview-558447925", "createdAt": "2020-12-24T10:19:15Z", "commit": {"oid": "2640cf19647cc3667bbde1a70ffde47abaeeb6e4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxMDoxOToxNVrOILEp8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yNFQxMDoxOToxNVrOILEp8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODQ4MTUyMQ==", "bodyText": "@ijuma Should we remove hamcrest? Removing it causes a bigger patch. The benefit of removing it is that our test assert get more consistent.", "url": "https://github.com/apache/kafka/pull/9785#discussion_r548481521", "createdAt": "2020-12-24T10:19:15Z", "author": {"login": "chia7712"}, "path": "build.gradle", "diffHunk": "@@ -1782,8 +1782,8 @@ project(':log4j-appender') {\n     compile libs.slf4jlog4j\n \n     testCompile project(':clients').sourceSets.test.output\n-    testCompile libs.junitJupiterApi\n-    testCompile libs.junitVintageEngine\n+    testCompile libs.junitJupiter\n+    testCompile libs.hamcrest", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2640cf19647cc3667bbde1a70ffde47abaeeb6e4"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY0ODMzNzAy", "url": "https://github.com/apache/kafka/pull/9785#pullrequestreview-564833702", "createdAt": "2021-01-10T06:54:50Z", "commit": {"oid": "2640cf19647cc3667bbde1a70ffde47abaeeb6e4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY0ODc2Nzcw", "url": "https://github.com/apache/kafka/pull/9785#pullrequestreview-564876770", "createdAt": "2021-01-10T15:58:14Z", "commit": {"oid": "2640cf19647cc3667bbde1a70ffde47abaeeb6e4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMFQxNTo1ODoxNVrOIQ5StQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xMFQxNTo1ODoxNVrOIQ5StQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDU4NjgwNQ==", "bodyText": "What is the reason for having assertDoesNotThrow here and below? The test will fail if an exception is thrown, so seems like unnecessary noise.", "url": "https://github.com/apache/kafka/pull/9785#discussion_r554586805", "createdAt": "2021-01-10T15:58:15Z", "author": {"login": "ijuma"}, "path": "log4j-appender/src/test/java/org/apache/kafka/log4jappender/KafkaLog4jAppenderTest.java", "diffHunk": "@@ -130,55 +116,51 @@ public void testLog4jAppends() {\n         for (int i = 1; i <= 5; ++i) {\n             logger.error(getMessage(i));\n         }\n-\n-        Assert.assertEquals(\n-            5, (getMockKafkaLog4jAppender()).getHistory().size());\n+        assertEquals(getMockKafkaLog4jAppender().getHistory().size(), 5);\n     }\n \n-    @Test(expected = RuntimeException.class)\n-    public void testLog4jAppendsWithSyncSendAndSimulateProducerFailShouldThrowException() {\n+    @Test\n+    public void testSyncSendAndSimulateProducerFailShouldThrowException() {\n         Properties props = getLog4jConfig(true);\n         props.put(\"log4j.appender.KAFKA.IgnoreExceptions\", \"false\");\n         PropertyConfigurator.configure(props);\n \n         MockKafkaLog4jAppender mockKafkaLog4jAppender = getMockKafkaLog4jAppender();\n         replaceProducerWithMocked(mockKafkaLog4jAppender, false);\n \n-        logger.error(getMessage(0));\n+        assertThrows(RuntimeException.class, () -> logger.error(getMessage(0)));\n     }\n \n     @Test\n-    public void testLog4jAppendsWithSyncSendWithoutIgnoringExceptionsShouldNotThrowException() {\n+    public void testSyncSendWithoutIgnoringExceptionsShouldNotThrowException() {\n         Properties props = getLog4jConfig(true);\n         props.put(\"log4j.appender.KAFKA.IgnoreExceptions\", \"false\");\n         PropertyConfigurator.configure(props);\n \n         MockKafkaLog4jAppender mockKafkaLog4jAppender = getMockKafkaLog4jAppender();\n         replaceProducerWithMocked(mockKafkaLog4jAppender, true);\n \n-        logger.error(getMessage(0));\n+        assertDoesNotThrow(() -> logger.error(getMessage(0)));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2640cf19647cc3667bbde1a70ffde47abaeeb6e4"}, "originalPosition": 153}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2386, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}