{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzOTA0Nzkw", "number": 8360, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxODo0MzozMlrODryM6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNTo0MzoyMFrODtl1ZQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3MjM3ODY3OnYy", "diffSide": "RIGHT", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/RestServer.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxODo0MzozMlrOF8VWPA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQxOToxNjo1MFrOF8Wnsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgwODYzNg==", "bodyText": "I see how the names are by-convention of the form {protocol}_{host}{port} and that this technically works. Seems like at a minimum we need a comment (or better yet JavaDoc) that describes why this works and the assumptions it makes.", "url": "https://github.com/apache/kafka/pull/8360#discussion_r398808636", "createdAt": "2020-03-26T18:43:32Z", "author": {"login": "rhauch"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/RestServer.java", "diffHunk": "@@ -419,7 +419,7 @@ else if (listeners.contains(String.format(\"%s://\", PROTOCOL_HTTPS)))\n     ServerConnector findConnector(String protocol) {\n         for (Connector connector : jettyServer.getConnectors()) {\n             String connectorName = connector.getName();\n-            if (connectorName.startsWith(protocol) && !ADMIN_SERVER_CONNECTOR_NAME.equals(connectorName))\n+            if (connectorName.startsWith(protocol + \"_\") && !ADMIN_SERVER_CONNECTOR_NAME.equals(connectorName))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "08a03912d201982556dad3327239ef2f2dbd3c19"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgxNzA1Ng==", "bodyText": "\ud83d\udc4d for the comment, so we won't have to rediscover this convention in the future.", "url": "https://github.com/apache/kafka/pull/8360#discussion_r398817056", "createdAt": "2020-03-26T18:56:11Z", "author": {"login": "kkonstantine"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/RestServer.java", "diffHunk": "@@ -419,7 +419,7 @@ else if (listeners.contains(String.format(\"%s://\", PROTOCOL_HTTPS)))\n     ServerConnector findConnector(String protocol) {\n         for (Connector connector : jettyServer.getConnectors()) {\n             String connectorName = connector.getName();\n-            if (connectorName.startsWith(protocol) && !ADMIN_SERVER_CONNECTOR_NAME.equals(connectorName))\n+            if (connectorName.startsWith(protocol + \"_\") && !ADMIN_SERVER_CONNECTOR_NAME.equals(connectorName))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgwODYzNg=="}, "originalCommit": {"oid": "08a03912d201982556dad3327239ef2f2dbd3c19"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgyOTQ5MQ==", "bodyText": "Ack, will address", "url": "https://github.com/apache/kafka/pull/8360#discussion_r398829491", "createdAt": "2020-03-26T19:16:50Z", "author": {"login": "C0urante"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/RestServer.java", "diffHunk": "@@ -419,7 +419,7 @@ else if (listeners.contains(String.format(\"%s://\", PROTOCOL_HTTPS)))\n     ServerConnector findConnector(String protocol) {\n         for (Connector connector : jettyServer.getConnectors()) {\n             String connectorName = connector.getName();\n-            if (connectorName.startsWith(protocol) && !ADMIN_SERVER_CONNECTOR_NAME.equals(connectorName))\n+            if (connectorName.startsWith(protocol + \"_\") && !ADMIN_SERVER_CONNECTOR_NAME.equals(connectorName))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgwODYzNg=="}, "originalCommit": {"oid": "08a03912d201982556dad3327239ef2f2dbd3c19"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MTMyMzg5OnYy", "diffSide": "RIGHT", "path": "connect/runtime/src/test/java/org/apache/kafka/connect/runtime/rest/RestServerTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNTo0MzoyMFrOF_GySQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMVQxNjozNTo0OFrOF_JB_A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTcxNTc4NQ==", "bodyText": "Nit: perhaps mention that the order of the listeners config is important:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // correct listener is chosen when http and https are configured and advertised listener is http\n          \n          \n            \n                    // correct listener is chosen when https listener is configured before http listener and advertised listener is http", "url": "https://github.com/apache/kafka/pull/8360#discussion_r401715785", "createdAt": "2020-04-01T15:43:20Z", "author": {"login": "rhauch"}, "path": "connect/runtime/src/test/java/org/apache/kafka/connect/runtime/rest/RestServerTest.java", "diffHunk": "@@ -174,6 +174,14 @@ public void testAdvertisedUri() {\n         config = new DistributedConfig(configMap);\n         server = new RestServer(config);\n         Assert.assertEquals(\"http://my-hostname:8080/\", server.advertisedUrl().toString());\n+\n+        // correct listener is chosen when http and https are configured and advertised listener is http", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "35dd4d2836db7a4c078f78b22fad20ba1480a3f0"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc1MjU3Mg==", "bodyText": "Ack, added.", "url": "https://github.com/apache/kafka/pull/8360#discussion_r401752572", "createdAt": "2020-04-01T16:35:48Z", "author": {"login": "C0urante"}, "path": "connect/runtime/src/test/java/org/apache/kafka/connect/runtime/rest/RestServerTest.java", "diffHunk": "@@ -174,6 +174,14 @@ public void testAdvertisedUri() {\n         config = new DistributedConfig(configMap);\n         server = new RestServer(config);\n         Assert.assertEquals(\"http://my-hostname:8080/\", server.advertisedUrl().toString());\n+\n+        // correct listener is chosen when http and https are configured and advertised listener is http", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTcxNTc4NQ=="}, "originalCommit": {"oid": "35dd4d2836db7a4c078f78b22fad20ba1480a3f0"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3109, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}