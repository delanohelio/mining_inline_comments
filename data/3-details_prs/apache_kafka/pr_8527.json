{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3MDI1MzIw", "number": 8527, "title": "Remove dependencies on deprecated --zookeeper command flags in junit tests", "bodyText": "Removed the --zookeeper flag related tests. Scram credential related tests are also get removed since they are using --zookeeper flag.\n\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-04-22T03:38:27Z", "url": "https://github.com/apache/kafka/pull/8527", "merged": true, "mergeCommit": {"oid": "7cb1600d6ae7245bfa717fa93502d28f17096ea8"}, "closed": true, "closedAt": "2020-05-04T21:34:24Z", "author": {"login": "ctan888"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcZ_z40gH2gAyNDA3MDI1MzIwOjkzODVhNjU0MDA1NzMxNjcwODg4ZTc0ZDRlZmMzYmUwYWQxOGNjMWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcczhOwgBqjMyOTEzMTg1MDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/9385a654005731670888e74d4efc3be0ad18cc1d", "committedDate": "2020-04-22T03:34:53Z", "message": "Splitted unit tests for --zookeeper flag removal"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4OTgxNzUy", "url": "https://github.com/apache/kafka/pull/8527#pullrequestreview-398981752", "createdAt": "2020-04-23T10:50:35Z", "commit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMDo1MDozNVrOGKjF8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMDo1MDozNVrOGKjF8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzcxMzkwNw==", "bodyText": "Hmm.  Do we need this if we have passwordConfigs?", "url": "https://github.com/apache/kafka/pull/8527#discussion_r413713907", "createdAt": "2020-04-23T10:50:35Z", "author": {"login": "cmccabe"}, "path": "core/src/test/scala/integration/kafka/server/DynamicBrokerReconfigurationTest.scala", "diffHunk": "@@ -1408,13 +1408,23 @@ class DynamicBrokerReconfigurationTest extends ZooKeeperTestHarness with SaslSet\n     sslStoreProps.put(KafkaConfig.PasswordEncoderSecretProp, kafkaConfig.passwordEncoderSecret.map(_.value).orNull)\n     zkClient.makeSurePersistentPathExists(ConfigEntityChangeNotificationZNode.path)\n \n-    val args = Array(\"--zookeeper\", kafkaConfig.zkConnect,\n-      \"--alter\", \"--add-config\", sslStoreProps.asScala.map { case (k, v) => s\"$k=$v\" }.mkString(\",\"),\n-      \"--entity-type\", \"brokers\",\n-      \"--entity-name\", kafkaConfig.brokerId.toString)\n-    ConfigCommand.main(args)\n+    val entityType = ConfigType.Broker\n+    val entityName = kafkaConfig.brokerId.toString\n \n+    val passwordConfigs = sslStoreProps.asScala.keySet.filter(DynamicBrokerConfig.isPasswordConfig)\n+    val passwordEncoderConfigs = new Properties\n+    passwordEncoderConfigs ++= sslStoreProps.asScala.filter { case (key, _) => key.startsWith(\"password.encoder.\") }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "originalPosition": 14}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4OTg3MjA0", "url": "https://github.com/apache/kafka/pull/8527#pullrequestreview-398987204", "createdAt": "2020-04-23T10:58:43Z", "commit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMDo1ODo0M1rOGKjZbQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMDo1ODo0M1rOGKjZbQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzcxODg5Mw==", "bodyText": "There should be a \"get\" here to ensure that we actually create the partitions before shutting down, right?", "url": "https://github.com/apache/kafka/pull/8527#discussion_r413718893", "createdAt": "2020-04-23T10:58:43Z", "author": {"login": "cmccabe"}, "path": "core/src/test/scala/unit/kafka/admin/DeleteTopicTest.scala", "diffHunk": "@@ -227,8 +227,10 @@ class DeleteTopicTest extends ZooKeeperTestHarness {\n     }, s\"Not all replicas for topic $topic are in states of either ReplicaDeletionSuccessful or OfflineReplica\")\n \n     // increase the partition count for topic\n-    val topicCommandOptions = new TopicCommand.TopicCommandOptions(Array(\"--zookeeper\", zkConnect, \"--alter\", \"--topic\", topic, \"--partitions\", \"2\"))\n-    new ZookeeperTopicService(zkClient).alterTopic(topicCommandOptions)\n+    val props = new Properties()\n+    props.setProperty(AdminClientConfig.BOOTSTRAP_SERVERS_CONFIG, TestUtils.getBrokerListStrFromServers(servers))\n+    val adminClient = Admin.create(props)\n+    adminClient.createPartitions(Map(topic -> NewPartitions.increaseTo(2)).asJava)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4OTg4Mzk4", "url": "https://github.com/apache/kafka/pull/8527#pullrequestreview-398988398", "createdAt": "2020-04-23T11:00:22Z", "commit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMTowMDoyMlrOGKjdVA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMTowMDoyMlrOGKjdVA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzcxOTg5Mg==", "bodyText": "This is a good change since the test is not specifically testing the legacy mode (so it should use the new mode)  Keep this one", "url": "https://github.com/apache/kafka/pull/8527#discussion_r413719892", "createdAt": "2020-04-23T11:00:22Z", "author": {"login": "cmccabe"}, "path": "core/src/test/scala/unit/kafka/admin/ReassignPartitionsCommandArgsTest.scala", "diffHunk": "@@ -255,7 +225,7 @@ class ReassignPartitionsCommandArgsTest {\n   @Test\n   def shouldNotAllowBrokersListWithVerifyOption(): Unit = {\n     val args = Array(\n-      \"--zookeeper\", \"localhost:1234\",\n+      \"--bootstrap-server\", \"localhost:1234\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "originalPosition": 56}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4OTg4NDk2", "url": "https://github.com/apache/kafka/pull/8527#pullrequestreview-398988496", "createdAt": "2020-04-23T11:00:30Z", "commit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMTowMDozMFrOGKjdrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMTowMDozMFrOGKjdrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzcxOTk4Mw==", "bodyText": "keep this change", "url": "https://github.com/apache/kafka/pull/8527#discussion_r413719983", "createdAt": "2020-04-23T11:00:30Z", "author": {"login": "cmccabe"}, "path": "core/src/test/scala/unit/kafka/admin/ReassignPartitionsCommandArgsTest.scala", "diffHunk": "@@ -275,7 +245,7 @@ class ReassignPartitionsCommandArgsTest {\n   @Test\n   def shouldNotAllowTopicsOptionWithVerify(): Unit = {\n     val args = Array(\n-      \"--zookeeper\", \"localhost:1234\",\n+      \"--bootstrap-server\", \"localhost:1234\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "originalPosition": 74}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4OTg4NTgw", "url": "https://github.com/apache/kafka/pull/8527#pullrequestreview-398988580", "createdAt": "2020-04-23T11:00:37Z", "commit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMTowMDozN1rOGKjeAg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMTowMDozN1rOGKjeAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzcyMDA2Ng==", "bodyText": "keep this change", "url": "https://github.com/apache/kafka/pull/8527#discussion_r413720066", "createdAt": "2020-04-23T11:00:37Z", "author": {"login": "cmccabe"}, "path": "core/src/test/scala/unit/kafka/admin/ReassignPartitionsCommandArgsTest.scala", "diffHunk": "@@ -265,7 +235,7 @@ class ReassignPartitionsCommandArgsTest {\n   @Test\n   def shouldNotAllowThrottleWithVerifyOption(): Unit = {\n     val args = Array(\n-      \"--zookeeper\", \"localhost:1234\",\n+      \"--bootstrap-server\", \"localhost:1234\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "originalPosition": 65}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk4OTg5NTQy", "url": "https://github.com/apache/kafka/pull/8527#pullrequestreview-398989542", "createdAt": "2020-04-23T11:02:00Z", "commit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMTowMjowMFrOGKjhdg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxMTowMjowMFrOGKjhdg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzcyMDk1MA==", "bodyText": "It's weird that this is even in this file.  This should be moved to TopicCommandWithZKClientTest.scala, I think", "url": "https://github.com/apache/kafka/pull/8527#discussion_r413720950", "createdAt": "2020-04-23T11:02:00Z", "author": {"login": "cmccabe"}, "path": "core/src/test/scala/unit/kafka/admin/TopicCommandWithAdminClientTest.scala", "diffHunk": "@@ -293,13 +293,6 @@ class TopicCommandWithAdminClientTest extends KafkaServerTestHarness with Loggin\n     }\n   }\n \n-  @Test\n-  def testCreateWithUnspecifiedReplicationFactorAndPartitionsWithZkClient(): Unit = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9385a654005731670888e74d4efc3be0ad18cc1d"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ccb7bb2d581cd6b3fdfed4bb37af978e1f83134c", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/ccb7bb2d581cd6b3fdfed4bb37af978e1f83134c", "committedDate": "2020-04-24T20:07:58Z", "message": "Merge branch 'trunk' into HEAD"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8f7bdb7381734630d1ce4ff6ffa8e4f56282bbd", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/f8f7bdb7381734630d1ce4ff6ffa8e4f56282bbd", "committedDate": "2020-04-25T02:41:02Z", "message": "It gnore the tests instead of deletion"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d8e016d7b22c0e01126b279ae716a91d3d7ccd0c", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/d8e016d7b22c0e01126b279ae716a91d3d7ccd0c", "committedDate": "2020-04-25T02:36:07Z", "message": "It gnore the tests instead of deletion"}, "afterCommit": {"oid": "f8f7bdb7381734630d1ce4ff6ffa8e4f56282bbd", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/f8f7bdb7381734630d1ce4ff6ffa8e4f56282bbd", "committedDate": "2020-04-25T02:41:02Z", "message": "It gnore the tests instead of deletion"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "ccb7bb2d581cd6b3fdfed4bb37af978e1f83134c", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/ccb7bb2d581cd6b3fdfed4bb37af978e1f83134c", "committedDate": "2020-04-24T20:07:58Z", "message": "Merge branch 'trunk' into HEAD"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "920eec4c3ab3d7d0a4a9e9d1eaf0762805138301", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/920eec4c3ab3d7d0a4a9e9d1eaf0762805138301", "committedDate": "2020-04-30T20:57:14Z", "message": "Remove decorator"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "920eec4c3ab3d7d0a4a9e9d1eaf0762805138301", "author": {"user": {"login": "ctan888", "name": "Cheng Tan"}}, "url": "https://github.com/apache/kafka/commit/920eec4c3ab3d7d0a4a9e9d1eaf0762805138301", "committedDate": "2020-04-30T20:57:14Z", "message": "Remove decorator"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1618, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}