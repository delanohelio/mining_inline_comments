{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgzMjkzNjM5", "number": 9278, "title": "MINOR: remove DelayedOperations.checkAndCompleteFetch", "bodyText": "inspired by #8657 (comment)\nWith this change, DelayedOperations.checkAndCompleteFetch() is only used in tests. I am wondering if it can be removed. It's fine if we want to do this in a followup PR.\n\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-09-10T02:34:07Z", "url": "https://github.com/apache/kafka/pull/9278", "merged": true, "mergeCommit": {"oid": "6bba661e24d0a133bfbccef841fcd8f1e057ef6b"}, "closed": true, "closedAt": "2020-09-10T15:50:29Z", "author": {"login": "chia7712"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdHXcKcgH2gAyNDgzMjkzNjM5OjZlODliMjVhMWNjNGJhM2E5ODdmMWZhMDAzNTdmOTdiOTMyZmZhYWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHi1WagFqTQ4NjA3NjY4Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6e89b25a1cc4ba3a987f1fa00357f97b932ffaac", "author": {"user": {"login": "chia7712", "name": "Chia-Ping Tsai"}}, "url": "https://github.com/apache/kafka/commit/6e89b25a1cc4ba3a987f1fa00357f97b932ffaac", "committedDate": "2020-09-10T02:33:17Z", "message": "MINOR: remove DelayedOperations.checkAndCompleteFetch"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1NTI1MDc0", "url": "https://github.com/apache/kafka/pull/9278#pullrequestreview-485525074", "createdAt": "2020-09-10T02:35:21Z", "commit": {"oid": "6e89b25a1cc4ba3a987f1fa00357f97b932ffaac"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwMjozNToyMVrOHPgwLw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwMjozNToyMVrOHPgwLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjAyNzMxMQ==", "bodyText": "```appendRecordsToLeader`` does not complete delayed fetch anymore (c2273ad) so this test can be removed.", "url": "https://github.com/apache/kafka/pull/9278#discussion_r486027311", "createdAt": "2020-09-10T02:35:21Z", "author": {"login": "chia7712"}, "path": "core/src/test/scala/unit/kafka/cluster/PartitionTest.scala", "diffHunk": "@@ -922,102 +918,6 @@ class PartitionTest extends AbstractPartitionTest {\n     assertEquals(\"ISR\", Set[Integer](leader, follower1, follower2), partition.inSyncReplicaIds)\n   }\n \n-  /**\n-   * Verify that delayed fetch operations which are completed when records are appended don't result in deadlocks.\n-   * Delayed fetch operations acquire Partition leaderIsrUpdate read lock for one or more partitions. So they\n-   * need to be completed after releasing the lock acquired to append records. Otherwise, waiting writers\n-   * (e.g. to check if ISR needs to be shrinked) can trigger deadlock in request handler threads waiting for\n-   * read lock of one Partition while holding on to read lock of another Partition.\n-   */\n-  @Test\n-  def testDelayedFetchAfterAppendRecords(): Unit = {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e89b25a1cc4ba3a987f1fa00357f97b932ffaac"}, "originalPosition": 63}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2MDc2Njg3", "url": "https://github.com/apache/kafka/pull/9278#pullrequestreview-486076687", "createdAt": "2020-09-10T15:49:45Z", "commit": {"oid": "6e89b25a1cc4ba3a987f1fa00357f97b932ffaac"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 602, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}