{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk0NDQ1NDk0", "number": 8369, "title": "KAFKA-9771: Port patch for inter-worker Connect SSL from Jetty 9.4.25", "bodyText": "Jira\nFor reasons outlined in the ticket, we can't upgrade to a version of Jetty with the bug fixed, or downgrade to one prior to the introduction of the bug. Luckily, the actual fix is pretty straightforward and can be ported over to Connect for use until it's possible to upgrade to a version of Jetty with that bug fixed: https://github.com/eclipse/jetty.project/pull/4404/files#diff-58640db0f8f2cd84b7e653d1c1540913R2188-R2193\nThe changes here have been verified locally; currently investigating how they can best be tested via unit/integration/system tests.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-03-26T22:00:06Z", "url": "https://github.com/apache/kafka/pull/8369", "merged": true, "mergeCommit": {"oid": "ee832d7d78009e82a968eed28644bf97a34170e2"}, "closed": true, "closedAt": "2020-03-27T17:33:41Z", "author": {"login": "C0urante"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRjbqMgH2gAyMzk0NDQ1NDk0OmFiZTJmODdhMDlmMzhmYWUyMWU5YmJmNWY1YjYzYTEyNDUwODBiOGI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcR0IkWgFqTM4MzA2MTc3Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "abe2f87a09f38fae21e9bbf5f5b63a1245080b8b", "author": {"user": {"login": "C0urante", "name": "Chris Egerton"}}, "url": "https://github.com/apache/kafka/commit/abe2f87a09f38fae21e9bbf5f5b63a1245080b8b", "committedDate": "2020-03-26T21:59:41Z", "message": "KAFKA-9771: Port patch for inter-worker Connect SSL from Jetty 9.4.25"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "abe2f87a09f38fae21e9bbf5f5b63a1245080b8b", "author": {"user": {"login": "C0urante", "name": "Chris Egerton"}}, "url": "https://github.com/apache/kafka/commit/abe2f87a09f38fae21e9bbf5f5b63a1245080b8b", "committedDate": "2020-03-26T21:59:41Z", "message": "KAFKA-9771: Port patch for inter-worker Connect SSL from Jetty 9.4.25"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b694735257bb94a63ab894c40fcba0fbfb2ca94b", "author": {"user": {"login": "C0urante", "name": "Chris Egerton"}}, "url": "https://github.com/apache/kafka/commit/b694735257bb94a63ab894c40fcba0fbfb2ca94b", "committedDate": "2020-03-26T22:22:40Z", "message": "KAFKA-9771: Remove unused import"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDY2MTIx", "url": "https://github.com/apache/kafka/pull/8369#pullrequestreview-382466121", "createdAt": "2020-03-26T22:30:54Z", "commit": {"oid": "b694735257bb94a63ab894c40fcba0fbfb2ca94b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMjozMDo1NFrOF8c1uw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMjozMDo1NFrOF8c1uw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkzMTM4Nw==", "bodyText": "I do not think we want SslContextFactory.Client overwrite newSniX509ExtendedKeyManager which is supposed to be Server side. This will change Client behavior.  Could we just use  SslContextFactory.Server instead if require ClientAuth true ?", "url": "https://github.com/apache/kafka/pull/8369#discussion_r398931387", "createdAt": "2020-03-26T22:30:54Z", "author": {"login": "jeffhuang26"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/util/SSLUtils.java", "diffHunk": "@@ -64,7 +65,20 @@ public static SslContextFactory createServerSideSslContextFactory(WorkerConfig c\n     public static SslContextFactory createClientSideSslContextFactory(WorkerConfig config) {\n         Map<String, Object> sslConfigValues = config.valuesWithPrefixAllOrNothing(\"listeners.https.\");\n \n-        final SslContextFactory.Client ssl = new SslContextFactory.Client();\n+        // Override this method in order to avoid running into\n+        // https://github.com/eclipse/jetty.project/issues/4385, which would otherwise cause this to\n+        // break when the keystore contains multiple certificates.\n+        // The override here matches the bug fix in Jetty for that issue:\n+        // https://github.com/eclipse/jetty.project/pull/4404/files#diff-58640db0f8f2cd84b7e653d1c1540913R2188-R2193\n+        // TODO: Remove this override when the version of Jetty for the framework is bumped to\n+        //       9.4.25 or later\n+        final SslContextFactory.Client ssl = new SslContextFactory.Client() {\n+            @Override\n+            @SuppressWarnings(\"deprecation\")\n+            protected X509ExtendedKeyManager newSniX509ExtendedKeyManager(X509ExtendedKeyManager keyManager) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b694735257bb94a63ab894c40fcba0fbfb2ca94b"}, "originalPosition": 23}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMDQ4MDQz", "url": "https://github.com/apache/kafka/pull/8369#pullrequestreview-383048043", "createdAt": "2020-03-27T17:09:02Z", "commit": {"oid": "b694735257bb94a63ab894c40fcba0fbfb2ca94b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgzMDYxNzcz", "url": "https://github.com/apache/kafka/pull/8369#pullrequestreview-383061773", "createdAt": "2020-03-27T17:27:13Z", "commit": {"oid": "b694735257bb94a63ab894c40fcba0fbfb2ca94b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1702, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}