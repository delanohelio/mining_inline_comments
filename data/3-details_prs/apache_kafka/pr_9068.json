{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU2MDAzMDUw", "number": 9068, "title": "MINOR: INFO log4j when request re-join", "bodyText": "While debugging a rebalance scenario I found that inside rejoinNeededOrPending when we trigger rebalance due to metadata or subscription changes it is not logged, and hence it's actually a bit tricky to find out the reason of the triggered rebalance. I'm adding two INFO log4j entries to fill in the gap.\nOther requestRejoin() calls are already covered.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-07-23T23:33:43Z", "url": "https://github.com/apache/kafka/pull/9068", "merged": true, "mergeCommit": {"oid": "f748d59d28bf5882286acef896af7805a761b760"}, "closed": true, "closedAt": "2020-07-26T23:45:17Z", "author": {"login": "guozhangwang"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc34DXygH2gAyNDU2MDAzMDUwOjA1ZGRiM2JlMDY4YzI2NDhlZDcyYWUyYjA0YzI2OWM4N2E5MDFkZmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc42AFAAH2gAyNDU2MDAzMDUwOjVlZGNiNGFjYTgxMWE2NDBmODMwMjdmZGY4MDU5MTFmOWU5NzAyYzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "05ddb3be068c2648ed72ae2b04c269c87a901dfb", "author": {"user": {"login": "guozhangwang", "name": "Guozhang Wang"}}, "url": "https://github.com/apache/kafka/commit/05ddb3be068c2648ed72ae2b04c269c87a901dfb", "committedDate": "2020-07-23T23:30:17Z", "message": "first fix"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1MjYyOTc5", "url": "https://github.com/apache/kafka/pull/9068#pullrequestreview-455262979", "createdAt": "2020-07-25T05:30:39Z", "commit": {"oid": "05ddb3be068c2648ed72ae2b04c269c87a901dfb"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwNTozMDozOVrOG3Cogw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yNVQwNTozMDozOVrOG3Cogw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDM2ODAwMw==", "bodyText": "nit: fix alignment.", "url": "https://github.com/apache/kafka/pull/9068#discussion_r460368003", "createdAt": "2020-07-25T05:30:39Z", "author": {"login": "abbccdda"}, "path": "clients/src/main/java/org/apache/kafka/clients/consumer/internals/ConsumerCoordinator.java", "diffHunk": "@@ -770,12 +770,18 @@ public boolean rejoinNeededOrPending() {\n         // we need to rejoin if we performed the assignment and metadata has changed;\n         // also for those owned-but-no-longer-existed partitions we should drop them as lost\n         if (assignmentSnapshot != null && !assignmentSnapshot.matches(metadataSnapshot)) {\n+            log.info(\"Requesting to re-join the group and trigger rebalance since the assignment metadata has changed from {} to {}\",\n+                    assignmentSnapshot, metadataSnapshot);\n+\n             requestRejoin();\n             return true;\n         }\n \n         // we need to join if our subscription has changed since the last join\n         if (joinedSubscription != null && !joinedSubscription.equals(subscriptions.subscription())) {\n+            log.info(\"Requesting to re-join the group and trigger rebalance since the subscription has changed from {} to {}\",\n+                    joinedSubscription, subscriptions.subscription());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "05ddb3be068c2648ed72ae2b04c269c87a901dfb"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "858847dd0fa2fb385751bf03334d96f57726f0f2", "author": {"user": {"login": "guozhangwang", "name": "Guozhang Wang"}}, "url": "https://github.com/apache/kafka/commit/858847dd0fa2fb385751bf03334d96f57726f0f2", "committedDate": "2020-07-26T23:39:39Z", "message": "Merge branch 'trunk' of https://github.com/apache/kafka into KMinor-leader-rejoin-log4j"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5edcb4aca811a640f83027fdf805911f9e9702c2", "author": {"user": {"login": "guozhangwang", "name": "Guozhang Wang"}}, "url": "https://github.com/apache/kafka/commit/5edcb4aca811a640f83027fdf805911f9e9702c2", "committedDate": "2020-07-26T23:40:48Z", "message": "github comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 922, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}