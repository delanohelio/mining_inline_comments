{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5NzQwOTIw", "number": 8564, "title": "KAFKA-9921: disable caching on stores configured to retain duplicates", "bodyText": "These two options are essentially incompatible, as caching will do nothing to reduce downstream traffic and writes when it has to allow non-unique keys (skipping records where the value is also the same is a separate issue, see KIP-557). But enabling caching on a store that's configured to retain duplicates is actually more than just ineffective, and currently causes incorrect results.\nWe should just log a warning and disable caching whenever a store is retaining duplicates to avoid introducing a regression. Maybe when 3.0 comes around we should consider throwing an exception instead to alert the user more aggressively.", "createdAt": "2020-04-27T20:52:33Z", "url": "https://github.com/apache/kafka/pull/8564", "merged": true, "mergeCommit": {"oid": "6a5946282cbc6b24b185a1a1297110198fd9e97c"}, "closed": true, "closedAt": "2020-04-28T18:33:42Z", "author": {"login": "ableegoldman"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcb1pKbAH2gAyNDA5NzQwOTIwOjYyNmQzZWJlMTQ5OWI5YzI4YzJjZDRkNzAxZDU1MDg5ZTBkOWY2YjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccIPzmAFqTQwMjEwNTU5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "626d3ebe1499b9c28c2cd4d701d55089e0d9f6b0", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/626d3ebe1499b9c28c2cd4d701d55089e0d9f6b0", "committedDate": "2020-04-27T20:51:58Z", "message": "disable caching, log warning, add test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c461d16b428682499fff8c92c7495bc71c437a2a", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/c461d16b428682499fff8c92c7495bc71c437a2a", "committedDate": "2020-04-27T21:46:24Z", "message": "checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNDEwNTk3", "url": "https://github.com/apache/kafka/pull/8564#pullrequestreview-401410597", "createdAt": "2020-04-28T00:06:35Z", "commit": {"oid": "c461d16b428682499fff8c92c7495bc71c437a2a"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwMDowNjozNVrOGM8zqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yOFQwMDowNjozNVrOGM8zqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjIzMjM2Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (storeSupplier.retainDuplicates()) {\n          \n          \n            \n                    if (storeSupplier.retainDuplicates() && enableCaching) {\n          \n      \n    \n    \n  \n\nShould we only log if we're changing the configured caching? (Also applies below)", "url": "https://github.com/apache/kafka/pull/8564#discussion_r416232363", "createdAt": "2020-04-28T00:06:35Z", "author": {"login": "vvcephei"}, "path": "streams/src/main/java/org/apache/kafka/streams/state/internals/TimestampedWindowStoreBuilder.java", "diffHunk": "@@ -56,6 +59,11 @@ public TimestampedWindowStoreBuilder(final WindowBytesStoreSupplier storeSupplie\n                 store = new InMemoryTimestampedWindowStoreMarker(store);\n             }\n         }\n+        if (storeSupplier.retainDuplicates()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c461d16b428682499fff8c92c7495bc71c437a2a"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f354f53dbcc18669cca85f65eafc7ffd41b7b33a", "author": {"user": {"login": "ableegoldman", "name": "A. Sophie Blee-Goldman"}}, "url": "https://github.com/apache/kafka/commit/f354f53dbcc18669cca85f65eafc7ffd41b7b33a", "committedDate": "2020-04-28T00:09:49Z", "message": "github prop"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxNDc0NTAz", "url": "https://github.com/apache/kafka/pull/8564#pullrequestreview-401474503", "createdAt": "2020-04-28T03:35:36Z", "commit": {"oid": "f354f53dbcc18669cca85f65eafc7ffd41b7b33a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMTA1NTk0", "url": "https://github.com/apache/kafka/pull/8564#pullrequestreview-402105594", "createdAt": "2020-04-28T18:32:28Z", "commit": {"oid": "f354f53dbcc18669cca85f65eafc7ffd41b7b33a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1243, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}