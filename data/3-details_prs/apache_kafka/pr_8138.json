{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc3MjE5MjEw", "number": 8138, "title": "KAFKA-9573: Fix JVM options to run early versions of Kafka on the latest JVMs", "bodyText": "Startup scripts for the early version of Kafka contain removed JVM options like -XX:+PrintGCDateStamps or -XX:UseParNewGC.\nWhen system tests run on JVM that doesn't support these options we should set up environment variables with correct options.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-02-19T15:00:06Z", "url": "https://github.com/apache/kafka/pull/8138", "merged": true, "mergeCommit": {"oid": "befd80b38d3ccb1aa0c6d99a899129fd5cf27774"}, "closed": true, "closedAt": "2020-03-25T17:31:08Z", "author": {"login": "nizhikov"}, "timelineItems": {"totalCount": 43, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcF3s4JAH2gAyMzc3MjE5MjEwOjgzMjE3MWRkZGQzMDcxY2Y3YTdmNjkxNTcwN2U2YThlNmZiZGI2MDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRK9_EgFqTM4MTM3Njc1NQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "832171dddd3071cf7a7f6915707e6a8e6fbdb600", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/832171dddd3071cf7a7f6915707e6a8e6fbdb600", "committedDate": "2020-02-19T14:49:30Z", "message": "KAFKA-9573: Fix JVM options to run previous versions of Kafka on the latest JVMs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3b1e2ac9c8fa2ec8df0ac8a59fd567d0e317b0a6", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/3b1e2ac9c8fa2ec8df0ac8a59fd567d0e317b0a6", "committedDate": "2020-02-19T15:07:18Z", "message": "KAFKA-9573: Fix JVM options to run previous versions of Kafka on the latest JVMs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bcc6abc5235793664c319cdb10c0a8ad67427fa2", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/bcc6abc5235793664c319cdb10c0a8ad67427fa2", "committedDate": "2020-02-19T15:07:40Z", "message": "Merge branch 'trunk' into KAFKA-9573"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYxMTk0MDIw", "url": "https://github.com/apache/kafka/pull/8138#pullrequestreview-361194020", "createdAt": "2020-02-19T15:11:45Z", "commit": {"oid": "bcc6abc5235793664c319cdb10c0a8ad67427fa2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNToxMTo0NVrOFrsHcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0xOVQxNToxMTo0NVrOFrsHcA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM1NTg4OA==", "bodyText": "ConcMarkSweepGC has been removed recently too. Any reason not to use G1?", "url": "https://github.com/apache/kafka/pull/8138#discussion_r381355888", "createdAt": "2020-02-19T15:11:45Z", "author": {"login": "ijuma"}, "path": "tests/kafkatest/services/kafka/util.py", "diffHunk": "@@ -16,3 +16,20 @@\n from collections import namedtuple\n \n TopicPartition = namedtuple('TopicPartition', ['topic', 'partition'])\n+\n+def fix_opts_for_new_jvm(self, node):\n+    # Startup scripts for early versions of Kafka contains options\n+    # that not supported on latest versions of JVM like -XX:+PrintGCDateStamps or -XX:UseParNewGC.\n+    # When system test run on JVM that doesn't support these options\n+    # we should setup environment variables with correct options.\n+    java_version = node.account.ssh_capture(\"java -version 2>&1 | sed -E -n 's/.* version \\\"([0-9]*).*$/\\1/p'\")\n+\n+    if java_version <= 9\n+        return \"\"\n+\n+    cmd = \"\"\n+    if node.version == LATEST_0_9 or node.version == LATEST_0_8_2:\n+        cmd += \"export KAFKA_GC_LOG_OPTS=\\\"-verbose:gc\\\"; \"\n+    if node.version == LATEST_0_8_2:\n+        cmd += \"export KAFKA_JVM_PERFORMANCE_OPTS=\\\"-server -XX:+UseConcMarkSweepGC -XX:+CMSClassUnloadingEnabled -XX:+CMSScavengeBeforeRemark -XX:+DisableExplicitGC -Djava.awt.headless=true\\\"; \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bcc6abc5235793664c319cdb10c0a8ad67427fa2"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f134f549a599690d679dbb706e43918a581807e", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/5f134f549a599690d679dbb706e43918a581807e", "committedDate": "2020-02-19T15:38:44Z", "message": "KAFKA-9573: Fixing tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "09412c658fa8011c36736e5249231d9a45d4db75", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/09412c658fa8011c36736e5249231d9a45d4db75", "committedDate": "2020-02-19T15:48:21Z", "message": "KAFKA-9573: Fixing verifiable producer."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d88b73ace2f3a90700da18a03fe0dc6da461c9c", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/8d88b73ace2f3a90700da18a03fe0dc6da461c9c", "committedDate": "2020-02-19T19:23:25Z", "message": "KAFKA-9573: Fix import."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "28157dd5efb445e72da063aa4ea6c0fbbb1d3cb3", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/28157dd5efb445e72da063aa4ea6c0fbbb1d3cb3", "committedDate": "2020-02-19T19:34:00Z", "message": "KAFKA-9573: Fix import."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0a2a70317f4807e4503b5e4eec3f07a17c46ab48", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/0a2a70317f4807e4503b5e4eec3f07a17c46ab48", "committedDate": "2020-02-20T10:19:01Z", "message": "KAFKA-9573: Version to fix options added."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "759fb4d5722fe8e1642b1cf35408ee6f46893a72", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/759fb4d5722fe8e1642b1cf35408ee6f46893a72", "committedDate": "2020-02-20T10:57:45Z", "message": "KAFKA-9573: Version to fix options added."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "623eab20e5ebb1e0de11d9cb301064e5bfffdc01", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/623eab20e5ebb1e0de11d9cb301064e5bfffdc01", "committedDate": "2020-02-20T12:06:57Z", "message": "KAFKA-9573: Version to fix options added."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cf00524b0038795afe9b7291ad4912eda97ec9f6", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/cf00524b0038795afe9b7291ad4912eda97ec9f6", "committedDate": "2020-02-20T12:29:02Z", "message": "KAFKA-9573: syntax fix."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "355cae882f882e65fbc7c8a1dc08fd873f9ceebb", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/355cae882f882e65fbc7c8a1dc08fd873f9ceebb", "committedDate": "2020-02-20T13:16:47Z", "message": "KAFKA-9573: gc file path update."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c44806c3128c5f4e31acffb7fcd893d1d205d9d", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/2c44806c3128c5f4e31acffb7fcd893d1d205d9d", "committedDate": "2020-02-20T13:40:33Z", "message": "KAFKA-9573: gc file path update."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b372d9e5bc7e41f57fdae12a57fc76c9d39c70ce", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/b372d9e5bc7e41f57fdae12a57fc76c9d39c70ce", "committedDate": "2020-02-20T14:04:40Z", "message": "KAFKA-9573: gc file path update."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9da159423aa21223d5fc43efb284c595ded9c88f", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/9da159423aa21223d5fc43efb284c595ded9c88f", "committedDate": "2020-02-20T14:50:04Z", "message": "KAFKA-9573: gc file path update."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50678d0b212ce41a2eba704a4a0ff89a5107a7c5", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/50678d0b212ce41a2eba704a4a0ff89a5107a7c5", "committedDate": "2020-02-20T14:51:11Z", "message": "KAFKA-9573: gc file path update."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b639ddfd68d1e40a655839069082731c2bb0f634", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/b639ddfd68d1e40a655839069082731c2bb0f634", "committedDate": "2020-02-21T09:58:23Z", "message": "KAFKA-9573: fix jaxb-impl for jdk11."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f825978ff03c789106fbdf99b208e75e6a59fe78", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/f825978ff03c789106fbdf99b208e75e6a59fe78", "committedDate": "2020-02-21T10:49:46Z", "message": "KAFKA-9573: fix jaxb-impl for jdk11."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6fb636ed6bb8ddd7e07b62f710a253a1cc6b392b", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/6fb636ed6bb8ddd7e07b62f710a253a1cc6b392b", "committedDate": "2020-02-21T10:57:02Z", "message": "KAFKA-9573: fix jaxb-impl for jdk11."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "216a90454ef42facf32ae7f37aca8da4cfcc5dd7", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/216a90454ef42facf32ae7f37aca8da4cfcc5dd7", "committedDate": "2020-02-21T10:59:57Z", "message": "KAFKA-9573: fix jaxb-impl for jdk11."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "473bbccef13d5221483c2e24c296a1802317dda8", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/473bbccef13d5221483c2e24c296a1802317dda8", "committedDate": "2020-02-21T13:10:17Z", "message": "KAFKA-9573: ."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNjMwNDU4", "url": "https://github.com/apache/kafka/pull/8138#pullrequestreview-362630458", "createdAt": "2020-02-21T13:34:08Z", "commit": {"oid": "473bbccef13d5221483c2e24c296a1802317dda8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxMzozNDowOVrOFs3AQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxMzozNDowOVrOFs3AQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU4Mjg1MA==", "bodyText": "These changes should be reverted prior merge.\nKeeping it in PR just to show that all tests executed on JDK11.", "url": "https://github.com/apache/kafka/pull/8138#discussion_r382582850", "createdAt": "2020-02-21T13:34:09Z", "author": {"login": "nizhikov"}, "path": "tests/docker/run_tests.sh", "diffHunk": "@@ -25,6 +25,6 @@ die() {\n }\n \n if ${SCRIPT_DIR}/ducker-ak ssh | grep -q '(none)'; then\n-    ${SCRIPT_DIR}/ducker-ak up -n \"${KAFKA_NUM_CONTAINERS}\" || die \"ducker-ak up failed\"\n+    ${SCRIPT_DIR}/ducker-ak up -j 'openjdk:11' -n \"${KAFKA_NUM_CONTAINERS}\" || die \"ducker-ak up failed\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "473bbccef13d5221483c2e24c296a1802317dda8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e500da1b92b1fe0f583f10531ff5709583f6614c", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/e500da1b92b1fe0f583f10531ff5709583f6614c", "committedDate": "2020-02-21T14:35:00Z", "message": "KAFKA-9573: Fixing VerifiableConsumer(Producer) to run with 0.8.2.2."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyNjc2NjU1", "url": "https://github.com/apache/kafka/pull/8138#pullrequestreview-362676655", "createdAt": "2020-02-21T14:43:11Z", "commit": {"oid": "e500da1b92b1fe0f583f10531ff5709583f6614c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDo0MzoxMVrOFs5J6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNDo0MzoxMVrOFs5J6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxODA4OA==", "bodyText": "Can we add this comment in every usage? Also, let's be clear about the minimum version that this class must support in the comment. Same for VerifiableProducer.", "url": "https://github.com/apache/kafka/pull/8138#discussion_r382618088", "createdAt": "2020-02-21T14:43:11Z", "author": {"login": "ijuma"}, "path": "tools/src/main/java/org/apache/kafka/tools/VerifiableConsumer.java", "diffHunk": "@@ -663,16 +662,17 @@ public static void main(String[] args) {\n         ArgumentParser parser = argParser();\n         if (args.length == 0) {\n             parser.printHelp();\n-            Exit.exit(0);\n+            System.exit(0);\n         }\n         try {\n             final VerifiableConsumer consumer = createFromArgs(parser, args);\n-            Exit.addShutdownHook(\"verifiable-consumer-shutdown-hook\", () -> consumer.close());\n+            Runtime.getRuntime().addShutdownHook(new Thread(consumer::close, \"verifiable-consumer-shutdown-hook\"));\n \n             consumer.run();\n         } catch (ArgumentParserException e) {\n             parser.handleError(e);\n-            Exit.exit(1);\n+            //Can't use `Exit.exit` here because `Exit` doesn't exists on old version of Kafka.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e500da1b92b1fe0f583f10531ff5709583f6614c"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5192b1a33c0cedfc06b1b31c44aec253d2229319", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/5192b1a33c0cedfc06b1b31c44aec253d2229319", "committedDate": "2020-02-21T14:48:31Z", "message": "KAFKA-9573: Comments added."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1611002ac6f31d0a02a7894e37cd2500a9e47b5c", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/1611002ac6f31d0a02a7894e37cd2500a9e47b5c", "committedDate": "2020-02-21T14:54:15Z", "message": "KAFKA-9573: Comments fixed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "869e267adc1fdba60dd157284e0257690a2b1fa5", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/869e267adc1fdba60dd157284e0257690a2b1fa5", "committedDate": "2020-02-21T14:55:33Z", "message": "KAFKA-9573: Comments fixed."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzYyODA3MDc1", "url": "https://github.com/apache/kafka/pull/8138#pullrequestreview-362807075", "createdAt": "2020-02-21T17:51:15Z", "commit": {"oid": "869e267adc1fdba60dd157284e0257690a2b1fa5"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNzo1MToxNlrOFs_Y0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yMVQxNzo1MjoxMlrOFs_abw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjcyMDIwOA==", "bodyText": "nit: doesn't exist until 0.11.0.0 to be more accurate? Ditto below.", "url": "https://github.com/apache/kafka/pull/8138#discussion_r382720208", "createdAt": "2020-02-21T17:51:16Z", "author": {"login": "guozhangwang"}, "path": "tools/src/main/java/org/apache/kafka/tools/VerifiableConsumer.java", "diffHunk": "@@ -633,7 +632,8 @@ public static VerifiableConsumer createFromArgs(ArgumentParser parser, String[]\n             brokerHostandPort = res.getString(\"brokerList\");\n         } else {\n             parser.printHelp();\n-            Exit.exit(0);\n+            //Can't use `Exit.exit` here because `Exit` doesn't exists on 0.8.2.2.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "869e267adc1fdba60dd157284e0257690a2b1fa5"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjcyMDYyMw==", "bodyText": "Could you remove this part since we are close to merge it?", "url": "https://github.com/apache/kafka/pull/8138#discussion_r382720623", "createdAt": "2020-02-21T17:52:12Z", "author": {"login": "guozhangwang"}, "path": "tests/docker/run_tests.sh", "diffHunk": "@@ -25,6 +25,6 @@ die() {\n }\n \n if ${SCRIPT_DIR}/ducker-ak ssh | grep -q '(none)'; then\n-    ${SCRIPT_DIR}/ducker-ak up -n \"${KAFKA_NUM_CONTAINERS}\" || die \"ducker-ak up failed\"\n+    ${SCRIPT_DIR}/ducker-ak up -j 'openjdk:11' -n \"${KAFKA_NUM_CONTAINERS}\" || die \"ducker-ak up failed\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjU4Mjg1MA=="}, "originalCommit": {"oid": "473bbccef13d5221483c2e24c296a1802317dda8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93969f0ed091f9ffe0726c4c06a483ae2bd21513", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/93969f0ed091f9ffe0726c4c06a483ae2bd21513", "committedDate": "2020-02-21T19:21:26Z", "message": "KAFKA-9573: Code review comments fixed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "58586a540f1c1cf9b2cc8deb828c8aa42cdb2d2b", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/58586a540f1c1cf9b2cc8deb828c8aa42cdb2d2b", "committedDate": "2020-02-25T14:41:25Z", "message": "Merge branch 'trunk' into KAFKA-9573"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY2ODIzNjA4", "url": "https://github.com/apache/kafka/pull/8138#pullrequestreview-366823608", "createdAt": "2020-02-29T22:33:19Z", "commit": {"oid": "58586a540f1c1cf9b2cc8deb828c8aa42cdb2d2b"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQyMjozMzoxOVrOFwLQGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOVQyMjozNDoyOVrOFwLQTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA2MDMxNA==", "bodyText": "Can we submit the Exit changes as a separate PR? It needs to be cherry-picked to the 2.5 branch as well since it's causing system test failures.", "url": "https://github.com/apache/kafka/pull/8138#discussion_r386060314", "createdAt": "2020-02-29T22:33:19Z", "author": {"login": "ijuma"}, "path": "tools/src/main/java/org/apache/kafka/tools/VerifiableConsumer.java", "diffHunk": "@@ -633,7 +632,8 @@ public static VerifiableConsumer createFromArgs(ArgumentParser parser, String[]\n             brokerHostandPort = res.getString(\"brokerList\");\n         } else {\n             parser.printHelp();\n-            Exit.exit(0);\n+            //Can't use `Exit.exit` here because `Exit` doesn't exists until 0.11.0.0.\n+            System.exit(0);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58586a540f1c1cf9b2cc8deb828c8aa42cdb2d2b"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjA2MDM2Nw==", "bodyText": "I was thinking about this. It seems a bit weird to change the classpath in the system tests. There are 2 alternatives:\n\nChange the older branches to include this jar in the classpath. It's a bit weird because the older versions don't support Java 11.\nChange the compatibility tests to exclude the older versions when executed with Java 11.\n\nOption 2 seems better to me. What do you think?", "url": "https://github.com/apache/kafka/pull/8138#discussion_r386060367", "createdAt": "2020-02-29T22:34:29Z", "author": {"login": "ijuma"}, "path": "tests/docker/Dockerfile", "diffHunk": "@@ -59,6 +60,15 @@ RUN mkdir -p \"/opt/kafka-2.2.2\" && chmod a+rw /opt/kafka-2.2.2 && curl -s \"$KAFK\n RUN mkdir -p \"/opt/kafka-2.3.1\" && chmod a+rw /opt/kafka-2.3.1 && curl -s \"$KAFKA_MIRROR/kafka_2.12-2.3.1.tgz\" | tar xz --strip-components=1 -C \"/opt/kafka-2.3.1\"\n RUN mkdir -p \"/opt/kafka-2.4.0\" && chmod a+rw /opt/kafka-2.4.0 && curl -s \"$KAFKA_MIRROR/kafka_2.12-2.4.0.tgz\" | tar xz --strip-components=1 -C \"/opt/kafka-2.4.0\"\n \n+# Install jars missing on JDK11.\n+ARG MVN_MIRROR=\"https://repo1.maven.org/maven2\"\n+RUN if [ \"x$jdk_version\" = \"xopenjdk:11\" ] ; then curl -s \"$MVN_MIRROR/com/sun/xml/bind/jaxb-impl/2.3.1/jaxb-impl-2.3.1.jar\" -o /opt/kafka-0.10.1.1/libs/jaxb-impl-2.3.1.jar ; fi\n+RUN if [ \"x$jdk_version\" = \"xopenjdk:11\" ] ; then curl -s \"$MVN_MIRROR/com/sun/xml/bind/jaxb-impl/2.3.1/jaxb-impl-2.3.1.jar\" -o /opt/kafka-0.10.2.2/libs/jaxb-impl-2.3.1.jar ; fi\n+RUN if [ \"x$jdk_version\" = \"xopenjdk:11\" ] ; then curl -s \"$MVN_MIRROR/com/sun/xml/bind/jaxb-impl/2.3.1/jaxb-impl-2.3.1.jar\" -o /opt/kafka-0.11.0.3/libs/jaxb-impl-2.3.1.jar ; fi\n+RUN if [ \"x$jdk_version\" = \"xopenjdk:11\" ] ; then curl -s \"$MVN_MIRROR/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar\" -o /opt/kafka-0.10.1.1/libs/jaxb-api-2.3.1.jar ; fi\n+RUN if [ \"x$jdk_version\" = \"xopenjdk:11\" ] ; then curl -s \"$MVN_MIRROR/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar\" -o /opt/kafka-0.10.2.2/libs/jaxb-api-2.3.1.jar ; fi\n+RUN if [ \"x$jdk_version\" = \"xopenjdk:11\" ] ; then curl -s \"$MVN_MIRROR/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar\" -o /opt/kafka-0.11.0.3/libs/jaxb-api-2.3.1.jar ; fi", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "58586a540f1c1cf9b2cc8deb828c8aa42cdb2d2b"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "924e8f8f30886a9eed2d3ce1ae88656d5d421a25", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/924e8f8f30886a9eed2d3ce1ae88656d5d421a25", "committedDate": "2020-03-01T06:24:22Z", "message": "Merge branch 'trunk' into KAFKA-9573"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d5845ff2ae0e2aab0fe7a178271752f13da6ee9", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/1d5845ff2ae0e2aab0fe7a178271752f13da6ee9", "committedDate": "2020-03-02T05:56:03Z", "message": "Merge branch 'trunk' into KAFKA-9573"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d695d6a419b8bc8171322541da47e92c910318d2", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/d695d6a419b8bc8171322541da47e92c910318d2", "committedDate": "2020-03-16T19:23:06Z", "message": "Merge branch 'trunk' into KAFKA-9573"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "90a59a1bcc21c1cfbd5dbca717aea3c2ef3ac565", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/90a59a1bcc21c1cfbd5dbca717aea3c2ef3ac565", "committedDate": "2020-03-17T08:02:06Z", "message": "KAFKA-9573: Ignoring upgrade tests for old Kafka version if jdk version > 9"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "459c8f8e197fcd3e3aab591e7366ca0827f675ca", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/459c8f8e197fcd3e3aab591e7366ca0827f675ca", "committedDate": "2020-03-17T12:54:08Z", "message": "KAFKA-9573: minor fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a14254efbc98d6b8f9c620444373c4b2e12ce34", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/8a14254efbc98d6b8f9c620444373c4b2e12ce34", "committedDate": "2020-03-17T12:56:20Z", "message": "KAFKA-9573: minor fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "834a707a5f738e0fad53ed6222925258f7d3f6e9", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/834a707a5f738e0fad53ed6222925258f7d3f6e9", "committedDate": "2020-03-17T12:59:57Z", "message": "KAFKA-9573: minor fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1cf6244330aeb5e1661d85278ff19aa458fb8d88", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/1cf6244330aeb5e1661d85278ff19aa458fb8d88", "committedDate": "2020-03-17T13:02:23Z", "message": "KAFKA-9573: minor fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8efc9a193923ffd02a81492e1dacf5f284387967", "author": {"user": {"login": "nizhikov", "name": "Nikolay"}}, "url": "https://github.com/apache/kafka/commit/8efc9a193923ffd02a81492e1dacf5f284387967", "committedDate": "2020-03-18T13:46:48Z", "message": "KAFKA-9573: reverting unnecessary changes."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2OTY1Mjkw", "url": "https://github.com/apache/kafka/pull/8138#pullrequestreview-376965290", "createdAt": "2020-03-18T15:16:53Z", "commit": {"oid": "8efc9a193923ffd02a81492e1dacf5f284387967"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNToxNjo1M1rOF4J0oA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNToxNjo1M1rOF4J0oA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQyNTUwNA==", "bodyText": "Could we have kafka_opts return the adjusted ops for the new jvm?", "url": "https://github.com/apache/kafka/pull/8138#discussion_r394425504", "createdAt": "2020-03-18T15:16:53Z", "author": {"login": "ijuma"}, "path": "tests/kafkatest/services/console_consumer.py", "diffHunk": "@@ -167,7 +168,8 @@ def start_cmd(self, node):\n         else:\n             args['kafka_opts'] = self.security_config.kafka_opts", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8efc9a193923ffd02a81492e1dacf5f284387967"}, "originalPosition": 10}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxMzc2NzU1", "url": "https://github.com/apache/kafka/pull/8138#pullrequestreview-381376755", "createdAt": "2020-03-25T17:29:33Z", "commit": {"oid": "8efc9a193923ffd02a81492e1dacf5f284387967"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1491, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}