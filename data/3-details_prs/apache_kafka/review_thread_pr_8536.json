{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA3NTA5MDkz", "number": 8536, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwNjo0MToyMVrOD1Hljg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwNjo0Njo0NVrOD1Hs0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MDI1NDIyOnYy", "diffSide": "RIGHT", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/resources/ConnectorsResource.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwNjo0MToyMVrOGKZCaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QxNzo1Njo1NVrOGK07dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzU0OTE2MQ==", "bodyText": "this second comment line doesn't read very clearly for me.\nwho's \"we\" in this case?\nwouldn't this probably means that a rebalance has taken place be as good?", "url": "https://github.com/apache/kafka/pull/8536#discussion_r413549161", "createdAt": "2020-04-23T06:41:21Z", "author": {"login": "kkonstantine"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/resources/ConnectorsResource.java", "diffHunk": "@@ -341,7 +341,15 @@ private void checkAndPutConnectorConfigName(String connectorName, Map<String, St\n                     // this gives two total hops to resolve the request before giving up.\n                     boolean recursiveForward = forward == null;\n                     RequestTargetException targetException = (RequestTargetException) cause;\n-                    String forwardUrl = UriBuilder.fromUri(targetException.forwardUrl())\n+                    String forwardedUrl = targetException.forwardUrl();\n+                    if (forwardedUrl == null) {\n+                        // the target didn't know of the leader at this moment.\n+                        // we don't, it probably means that a rebalance has taken place.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d66a6301e872561c0ab0c82e5ddd260f193e005"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDAwNjEzNA==", "bodyText": "Ack.", "url": "https://github.com/apache/kafka/pull/8536#discussion_r414006134", "createdAt": "2020-04-23T17:56:55Z", "author": {"login": "rhauch"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/resources/ConnectorsResource.java", "diffHunk": "@@ -341,7 +341,15 @@ private void checkAndPutConnectorConfigName(String connectorName, Map<String, St\n                     // this gives two total hops to resolve the request before giving up.\n                     boolean recursiveForward = forward == null;\n                     RequestTargetException targetException = (RequestTargetException) cause;\n-                    String forwardUrl = UriBuilder.fromUri(targetException.forwardUrl())\n+                    String forwardedUrl = targetException.forwardUrl();\n+                    if (forwardedUrl == null) {\n+                        // the target didn't know of the leader at this moment.\n+                        // we don't, it probably means that a rebalance has taken place.", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzU0OTE2MQ=="}, "originalCommit": {"oid": "1d66a6301e872561c0ab0c82e5ddd260f193e005"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU3MDI3MjgwOnYy", "diffSide": "RIGHT", "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/resources/ConnectorsResource.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwNjo0Njo0NVrOGKZM0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yM1QwNjo0Njo0NVrOGKZM0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzU1MTgyNA==", "bodyText": "nit: due to no known leader URL ... or similar", "url": "https://github.com/apache/kafka/pull/8536#discussion_r413551824", "createdAt": "2020-04-23T06:46:45Z", "author": {"login": "kkonstantine"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/rest/resources/ConnectorsResource.java", "diffHunk": "@@ -341,7 +341,15 @@ private void checkAndPutConnectorConfigName(String connectorName, Map<String, St\n                     // this gives two total hops to resolve the request before giving up.\n                     boolean recursiveForward = forward == null;\n                     RequestTargetException targetException = (RequestTargetException) cause;\n-                    String forwardUrl = UriBuilder.fromUri(targetException.forwardUrl())\n+                    String forwardedUrl = targetException.forwardUrl();\n+                    if (forwardedUrl == null) {\n+                        // the target didn't know of the leader at this moment.\n+                        // we don't, it probably means that a rebalance has taken place.\n+                        throw new ConnectRestException(Response.Status.CONFLICT.getStatusCode(),\n+                                \"Cannot complete request momentarily due no known leader URL, \"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d66a6301e872561c0ab0c82e5ddd260f193e005"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2764, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}