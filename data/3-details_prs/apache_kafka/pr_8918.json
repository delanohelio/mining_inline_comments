{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDM4NzUzOTYy", "number": 8918, "title": "MINOR: Use debug level logging for noisy log messages in Connect", "bodyText": "This very simply reduces the log level for these very frequently logged, very infrequently useful log messages to debug level.\nMy experience operating these connectors is that these logs make reading info level logs quite cluttered. The MDC context certainly helps filter, but I think debug is more appropriate here -- if the log level were debug and someone wanted to promote it to info, that certainly would be an odd desire!\nDebug is recommended here over Trace, since these do not really help trace specific messages or paths, and give kind of general debug information at a regular cadence (volume of these log messages does not grow with throughput). That said, if there is strong support for Trace I think that would be an improvement over Info, too.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-06-23T18:48:01Z", "url": "https://github.com/apache/kafka/pull/8918", "merged": true, "mergeCommit": {"oid": "432be58a7cd16fd3a1d214e876ed6e0f0426b1ec"}, "closed": true, "closedAt": "2020-10-16T14:10:42Z", "author": {"login": "cyrusv"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcuJ_-GgH2gAyNDM4NzUzOTYyOjE4YWE1YzI5ZWE2M2Q1YjQ2YTdiY2I5YmYwMWNhODVkZWJhYmY2NmU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdTG8amgFqTUxMDUwNTAwNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e", "author": {"user": {"login": "cyrusv", "name": "Cyrus Vafadari"}}, "url": "https://github.com/apache/kafka/commit/18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e", "committedDate": "2020-06-23T18:45:37Z", "message": "Use debug level logging for noisy log messages in Connect"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0MDc2NDU4", "url": "https://github.com/apache/kafka/pull/8918#pullrequestreview-444076458", "createdAt": "2020-07-07T16:51:03Z", "commit": {"oid": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0Mzg0NzI1", "url": "https://github.com/apache/kafka/pull/8918#pullrequestreview-444384725", "createdAt": "2020-07-08T03:18:19Z", "commit": {"oid": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwMzoxODoxOVrOGuWpEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwMzoxOTowNlrOGuWpqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1ODY0MQ==", "bodyText": "these shouldn't be noisy. there is some dedup logic that should prevent the same message from being printed over and over again.", "url": "https://github.com/apache/kafka/pull/8918#discussion_r451258641", "createdAt": "2020-07-08T03:18:19Z", "author": {"login": "wicknicks"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java", "diffHunk": "@@ -343,7 +343,7 @@ private void doCommitSync(Map<TopicPartition, OffsetAndMetadata> offsets, int se\n     }\n \n     private void doCommitAsync(Map<TopicPartition, OffsetAndMetadata> offsets, final int seqno) {\n-        log.info(\"{} Committing offsets asynchronously using sequence number {}: {}\", this, seqno, offsets);\n+        log.debug(\"{} Committing offsets asynchronously using sequence number {}: {}\", this, seqno, offsets);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1ODczMA==", "bodyText": "nit: since this is indicating entry into a method, I think it can be trace level.", "url": "https://github.com/apache/kafka/pull/8918#discussion_r451258730", "createdAt": "2020-07-08T03:18:45Z", "author": {"login": "wicknicks"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -475,7 +475,7 @@ private synchronized void recordSent(final ProducerRecord<byte[], byte[]> record\n     public boolean commitOffsets() {\n         long commitTimeoutMs = workerConfig.getLong(WorkerConfig.OFFSET_COMMIT_TIMEOUT_MS_CONFIG);\n \n-        log.info(\"{} Committing offsets\", this);\n+        log.debug(\"{} Committing offsets\", this);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1ODc5Mw==", "bodyText": "nit: since this is mostly indicating exit from the method, I think it can be trace level too.", "url": "https://github.com/apache/kafka/pull/8918#discussion_r451258793", "createdAt": "2020-07-08T03:19:06Z", "author": {"login": "wicknicks"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -571,7 +571,7 @@ public boolean commitOffsets() {\n         finishSuccessfulFlush();\n         long durationMillis = time.milliseconds() - started;\n         recordCommitSuccess(durationMillis);\n-        log.info(\"{} Finished commitOffsets successfully in {} ms\",\n+        log.debug(\"{} Finished commitOffsets successfully in {} ms\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "751aeabd2ba0cd25c61ca336690617e3daf9e751", "author": {"user": {"login": "cyrusv", "name": "Cyrus Vafadari"}}, "url": "https://github.com/apache/kafka/commit/751aeabd2ba0cd25c61ca336690617e3daf9e751", "committedDate": "2020-07-08T04:33:33Z", "message": "Reduce to trace level"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ0NDExMTE0", "url": "https://github.com/apache/kafka/pull/8918#pullrequestreview-444411114", "createdAt": "2020-07-08T04:51:21Z", "commit": {"oid": "751aeabd2ba0cd25c61ca336690617e3daf9e751"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNDo1MToyMVrOGuYCOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wOFQwNDo1MToyMVrOGuYCOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI4MTQ2Ng==", "bodyText": "I think you missed this one.", "url": "https://github.com/apache/kafka/pull/8918#discussion_r451281466", "createdAt": "2020-07-08T04:51:21Z", "author": {"login": "wicknicks"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -571,7 +571,7 @@ public boolean commitOffsets() {\n         finishSuccessfulFlush();\n         long durationMillis = time.milliseconds() - started;\n         recordCommitSuccess(durationMillis);\n-        log.info(\"{} Finished commitOffsets successfully in {} ms\",\n+        log.debug(\"{} Finished commitOffsets successfully in {} ms\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTI1ODc5Mw=="}, "originalCommit": {"oid": "18aa5c29ea63d5b46a7bcb9bf01ca85debabf66e"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a66de28dc046a5b4845b57605f8748cc857a084d", "author": {"user": {"login": "cyrusv", "name": "Cyrus Vafadari"}}, "url": "https://github.com/apache/kafka/commit/a66de28dc046a5b4845b57605f8748cc857a084d", "committedDate": "2020-07-08T04:59:32Z", "message": "Change levels"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc5ODk1Mzk3", "url": "https://github.com/apache/kafka/pull/8918#pullrequestreview-479895397", "createdAt": "2020-09-01T15:57:21Z", "commit": {"oid": "a66de28dc046a5b4845b57605f8748cc857a084d"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNTo1NzoyMlrOHK9PPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMVQxNTo1Nzo0N1rOHK9QzQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTI1MTEzMw==", "bodyText": "Why set this to trace rather than debug like the other changes? Isn't it useful to know that we've entered this method before we lock?", "url": "https://github.com/apache/kafka/pull/8918#discussion_r481251133", "createdAt": "2020-09-01T15:57:22Z", "author": {"login": "rhauch"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -475,7 +475,7 @@ private synchronized void recordSent(final ProducerRecord<byte[], byte[]> record\n     public boolean commitOffsets() {\n         long commitTimeoutMs = workerConfig.getLong(WorkerConfig.OFFSET_COMMIT_TIMEOUT_MS_CONFIG);\n \n-        log.info(\"{} Committing offsets\", this);\n+        log.trace(\"{} Committing offsets\", this);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a66de28dc046a5b4845b57605f8748cc857a084d"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTI1MTUzMw==", "bodyText": "Same question here about trace vs debug, as denoted above. With debug logs, isn't it useful to know how long it took to commit all offsets?", "url": "https://github.com/apache/kafka/pull/8918#discussion_r481251533", "createdAt": "2020-09-01T15:57:47Z", "author": {"login": "rhauch"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -571,7 +571,7 @@ public boolean commitOffsets() {\n         finishSuccessfulFlush();\n         long durationMillis = time.milliseconds() - started;\n         recordCommitSuccess(durationMillis);\n-        log.info(\"{} Finished commitOffsets successfully in {} ms\",\n+        log.trace(\"{} Finished commitOffsets successfully in {} ms\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a66de28dc046a5b4845b57605f8748cc857a084d"}, "originalPosition": 23}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7efca0680a943d6accf625bd4d8544aec4244d95", "author": {"user": {"login": "cyrusv", "name": "Cyrus Vafadari"}}, "url": "https://github.com/apache/kafka/commit/7efca0680a943d6accf625bd4d8544aec4244d95", "committedDate": "2020-09-03T19:28:49Z", "message": "debug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8112f744c34ef4fbb7eacf54da07697444bee6d", "author": {"user": {"login": "cyrusv", "name": "Cyrus Vafadari"}}, "url": "https://github.com/apache/kafka/commit/d8112f744c34ef4fbb7eacf54da07697444bee6d", "committedDate": "2020-09-03T19:29:15Z", "message": "debug"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA4NjM0Njk2", "url": "https://github.com/apache/kafka/pull/8918#pullrequestreview-508634696", "createdAt": "2020-10-14T18:50:21Z", "commit": {"oid": "d8112f744c34ef4fbb7eacf54da07697444bee6d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxODo1MDoyMlrOHhglww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xNFQxODo1MDoyMlrOHhglww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDg5OTAxMQ==", "bodyText": "I'm not convinced that changing this to DEBUG is worth it. The number of source records output in this log message can be instrumental in some cases.\nFor example, if the producer does not keep up with the source task (for whatever reason), this currently INFO-level message appears shortly before the following ERROR-level message:\n... ERROR WorkerSourceTask{id=...} Failed to commit offsets (org.apache.kafka.connect.runtime.SourceTaskOffsetCommitter)\n\nThe number of outstanding source records reported by this line is an important factor in determining how to tune the producer and offset.flush.timeout.ms value.", "url": "https://github.com/apache/kafka/pull/8918#discussion_r504899011", "createdAt": "2020-10-14T18:50:22Z", "author": {"login": "rhauch"}, "path": "connect/runtime/src/main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java", "diffHunk": "@@ -492,7 +492,7 @@ public boolean commitOffsets() {\n             // to persistent storage\n \n             // Next we need to wait for all outstanding messages to finish sending\n-            log.info(\"{} flushing {} outstanding messages for offset commit\", this, outstandingMessages.size());\n+            log.debug(\"{} flushing {} outstanding messages for offset commit\", this, outstandingMessages.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d8112f744c34ef4fbb7eacf54da07697444bee6d"}, "originalPosition": 14}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3fe54aaa51319192de3efc6b8ee4fe5977e0cec3", "author": {"user": {"login": "cyrusv", "name": "Cyrus Vafadari"}}, "url": "https://github.com/apache/kafka/commit/3fe54aaa51319192de3efc6b8ee4fe5977e0cec3", "committedDate": "2020-10-14T20:46:07Z", "message": "Change back to info"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTEwNTA1MDA1", "url": "https://github.com/apache/kafka/pull/8918#pullrequestreview-510505005", "createdAt": "2020-10-16T14:07:13Z", "commit": {"oid": "3fe54aaa51319192de3efc6b8ee4fe5977e0cec3"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 710, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}