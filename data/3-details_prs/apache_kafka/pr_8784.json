{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI2NzExMTMy", "number": 8784, "title": "KAFKA-9788: Use distinct names for transaction and group load time se\u2026", "bodyText": "\u2026nsors\nSensor objects are stored in the Kafka metrics registry and keyed by name. If a new sensor is created with the same name as an existing one, the existing one is returned rather than a new object being created. The partition load time sensors for the transaction and group coordinators used the same name, so data recorded to either was stored in the same object. This meant that the metrics values for both metrics were identical and consisted of the combined data. This patch changes the names to be distinct so that the data will be stored in separate Sensor objects.\nMore detailed description of your change,\nif necessary. The PR title and PR message become\nthe squashed commit message, so use a separate\ncomment to ping reviewers.\nSummary of testing strategy (including rationale)\nfor the feature or bug fix. Unit and/or integration\ntests are expected for any behaviour change and\nsystem tests should be considered for larger changes.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-06-02T16:57:44Z", "url": "https://github.com/apache/kafka/pull/8784", "merged": true, "mergeCommit": {"oid": "87bef1d1b0fe1502be2335524990aad94bfd4bae"}, "closed": true, "closedAt": "2020-06-04T00:53:31Z", "author": {"login": "bob-barrett"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcnXzGzAH2gAyNDI2NzExMTMyOjgyYWRhOTNhZTUzNDNmODFhNDE4YjZkNWRhNzZkNWI0ZmVkZDgwY2M=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcnuy0QAFqTQyMzg3MjY0Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "82ada93ae5343f81a418b6d5da76d5b4fedd80cc", "author": {"user": {"login": "bob-barrett", "name": "Bob Barrett"}}, "url": "https://github.com/apache/kafka/commit/82ada93ae5343f81a418b6d5da76d5b4fedd80cc", "committedDate": "2020-06-02T16:52:46Z", "message": "KAFKA-9788: Use distinct names for transaction and group load time sensors\n\nSensor objects are stored in the Kafka metrics registry and keyed by name. If a new sensor is created with the same name as an existing one, the existing one is returned rather than a new object being created. The partition load time sensors for the transaction and group coordinators used the same name, so data recorded to either was stored in the same object. This meant that the metrics values for both metrics were identical and consisted of the combined data. This patch changes the names to be distinct so that the data will be stored in separate Sensor objects."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "68127aebf45308e4942eb456037273520c14bab7", "author": {"user": {"login": "bob-barrett", "name": "Bob Barrett"}}, "url": "https://github.com/apache/kafka/commit/68127aebf45308e4942eb456037273520c14bab7", "committedDate": "2020-06-02T17:11:45Z", "message": "Add group metrics constants"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyOTg4ODM0", "url": "https://github.com/apache/kafka/pull/8784#pullrequestreview-422988834", "createdAt": "2020-06-02T19:22:11Z", "commit": {"oid": "82ada93ae5343f81a418b6d5da76d5b4fedd80cc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxOToyMjoxMVrOGeAvOw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxOToyMjoxMVrOGeAvOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDEyMjU1NQ==", "bodyText": "nit: maybe we may as well add constant names for this as well as the metric group?", "url": "https://github.com/apache/kafka/pull/8784#discussion_r434122555", "createdAt": "2020-06-02T19:22:11Z", "author": {"login": "hachikuji"}, "path": "core/src/main/scala/kafka/coordinator/group/GroupMetadataManager.scala", "diffHunk": "@@ -89,7 +89,7 @@ class GroupMetadataManager(brokerId: Int,\n   private val openGroupsForProducer = mutable.HashMap[Long, mutable.Set[String]]()\n \n   /* setup metrics*/\n-  val partitionLoadSensor = metrics.sensor(\"PartitionLoadTime\")\n+  private val partitionLoadSensor = metrics.sensor(\"GroupPartitionLoadTime\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "82ada93ae5343f81a418b6d5da76d5b4fedd80cc"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzODcyNjQz", "url": "https://github.com/apache/kafka/pull/8784#pullrequestreview-423872643", "createdAt": "2020-06-03T19:40:16Z", "commit": {"oid": "68127aebf45308e4942eb456037273520c14bab7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 836, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}