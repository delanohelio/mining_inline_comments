{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5ODA1MDg5", "number": 8168, "title": "KAFKA-9607: Do not clear partition queues during close", "bodyText": "This PR fixes the illegal state bug where a task gets revived but has no input partition assigned anymore.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-02-25T21:14:52Z", "url": "https://github.com/apache/kafka/pull/8168", "merged": true, "mergeCommit": {"oid": "bafdf8630e7e66c2ff4405ff3ec75aa75105e837"}, "closed": true, "closedAt": "2020-02-27T01:47:14Z", "author": {"login": "abbccdda"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcH52FegFqTM2NDQ5NjA2OA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcINZsBABqjMwNzU0NTUwNzc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NDk2MDY4", "url": "https://github.com/apache/kafka/pull/8168#pullrequestreview-364496068", "createdAt": "2020-02-25T22:27:13Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NDk5NDkx", "url": "https://github.com/apache/kafka/pull/8168#pullrequestreview-364499491", "createdAt": "2020-02-25T22:33:39Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NTI3MTE2", "url": "https://github.com/apache/kafka/pull/8168#pullrequestreview-364527116", "createdAt": "2020-02-25T23:33:03Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzozMzowM1rOFuZL5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNVQyMzozMzowM1rOFuZL5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE5MTQ2Mw==", "bodyText": "@guozhangwang we should also reset the partitionTime for the RecordQueues in #clear?", "url": "https://github.com/apache/kafka/pull/8168#discussion_r384191463", "createdAt": "2020-02-25T23:33:03Z", "author": {"login": "ableegoldman"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/PartitionGroup.java", "diffHunk": "@@ -220,7 +220,7 @@ boolean allPartitionsBuffered() {\n \n     void close() {\n         clear();\n-        partitionQueues.clear();\n+\n         streamTime = RecordQueue.UNKNOWN;", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 6}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0NjE0MDYw", "url": "https://github.com/apache/kafka/pull/8168#pullrequestreview-364614060", "createdAt": "2020-02-26T04:16:57Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": null}, {"__typename": "PullRequestCommit", "commit": {"oid": "ea279ee39dba399cddc5fce9837b4272b3ca5a36", "author": {"user": {"login": "abbccdda", "name": "Boyang Chen"}}, "url": "https://github.com/apache/kafka/commit/ea279ee39dba399cddc5fce9837b4272b3ca5a36", "committedDate": "2020-02-26T21:13:36Z", "message": "Should not clear partition group if the task will be revived again"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "ea279ee39dba399cddc5fce9837b4272b3ca5a36", "author": {"user": {"login": "abbccdda", "name": "Boyang Chen"}}, "url": "https://github.com/apache/kafka/commit/ea279ee39dba399cddc5fce9837b4272b3ca5a36", "committedDate": "2020-02-26T21:13:36Z", "message": "Should not clear partition group if the task will be revived again"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1569, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}