{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyOTExODkx", "number": 9609, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQyMjoyODo1OVrOE75pDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwMDoyMjoyNFrOE9AuPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMjQ1ODM2OnYy", "diffSide": "RIGHT", "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQyMjoyODo1OVrOH3x2oQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQyMjoyODo1OVrOH3x2oQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI1MDUyOQ==", "bodyText": "nit: fix indention (same below in other constructor)", "url": "https://github.com/apache/kafka/pull/9609#discussion_r528250529", "createdAt": "2020-11-21T22:28:59Z", "author": {"login": "mjsax"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {\n+\n+    private Collection<String> topicNames;\n+    private Pattern topicPattern;\n+    private final ConsumedInternal<K, V> consumedInternal;\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Collection<String> topicNames,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMjQ1ODc5OnYy", "diffSide": "RIGHT", "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQyMjoyOTozM1rOH3x20w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQyMjoyOTozM1rOH3x20w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI1MDU3OQ==", "bodyText": "Can me make those field final?", "url": "https://github.com/apache/kafka/pull/9609#discussion_r528250579", "createdAt": "2020-11-21T22:29:33Z", "author": {"login": "mjsax"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {\n+\n+    private Collection<String> topicNames;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxMjQ1OTA1OnYy", "diffSide": "RIGHT", "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQyMjoyOTozOVrOH3x27g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMVQyMjoyOTozOVrOH3x27g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI1MDYwNg==", "bodyText": "final?", "url": "https://github.com/apache/kafka/pull/9609#discussion_r528250606", "createdAt": "2020-11-21T22:29:39Z", "author": {"login": "mjsax"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {\n+\n+    private Collection<String> topicNames;\n+    private Pattern topicPattern;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxNjY3OTI2OnYy", "diffSide": "RIGHT", "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjo0MzoxNlrOH4WLNg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wMlQxOToyNTo0OVrOH9qsLQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0NTYyMg==", "bodyText": "Should we already demand a set of topics in the constructors of  SourceGraphNode() and its children?", "url": "https://github.com/apache/kafka/pull/9609#discussion_r528845622", "createdAt": "2020-11-23T16:43:16Z", "author": {"login": "cadonna"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {\n+\n+    private Collection<String> topicNames;\n+    private Pattern topicPattern;\n+    private final ConsumedInternal<K, V> consumedInternal;\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Collection<String> topicNames,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+        super(nodeName);\n+\n+        this.topicNames = topicNames;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Pattern topicPattern,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+\n+        super(nodeName);\n+\n+        this.topicPattern = topicPattern;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public Set<String> topicNames() {\n+        return new HashSet<>(topicNames);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTk3MTEwMw==", "bodyText": "I'm not sure I understand exactly what you're asking, but I made a few changes to this topic collection/method. Please lmk if it hasn't addressed your question", "url": "https://github.com/apache/kafka/pull/9609#discussion_r529971103", "createdAt": "2020-11-24T22:56:01Z", "author": {"login": "ableegoldman"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {\n+\n+    private Collection<String> topicNames;\n+    private Pattern topicPattern;\n+    private final ConsumedInternal<K, V> consumedInternal;\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Collection<String> topicNames,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+        super(nodeName);\n+\n+        this.topicNames = topicNames;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Pattern topicPattern,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+\n+        super(nodeName);\n+\n+        this.topicPattern = topicPattern;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public Set<String> topicNames() {\n+        return new HashSet<>(topicNames);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0NTYyMg=="}, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDE5NjYyOQ==", "bodyText": "I like your changes. What I meant is that we could change the constructor of SourceGraphNode to:\npublic SourceGraphNode(final String nodeName,\n                       final Set<String> topicNames,\n                       final ConsumedInternal<K, V> consumedInternal)\n\nand the one of StreamSourceNode to:\npublic StreamSourceNode(final String nodeName,\n                        final Set<String> topicNames,\n                        final ConsumedInternal<K, V> consumedInternal)\n\nIn this way, we have a set of topics as soon as possible in the code path from the public API. I think this makes it clearer that it is not possible to have duplicates of topics internally.\nTo keep this PR small, I would propose to just do the changes for SourceGraphNode, and do the other changes in a separate PR.", "url": "https://github.com/apache/kafka/pull/9609#discussion_r530196629", "createdAt": "2020-11-25T08:45:38Z", "author": {"login": "cadonna"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {\n+\n+    private Collection<String> topicNames;\n+    private Pattern topicPattern;\n+    private final ConsumedInternal<K, V> consumedInternal;\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Collection<String> topicNames,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+        super(nodeName);\n+\n+        this.topicNames = topicNames;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Pattern topicPattern,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+\n+        super(nodeName);\n+\n+        this.topicPattern = topicPattern;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public Set<String> topicNames() {\n+        return new HashSet<>(topicNames);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0NTYyMg=="}, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzg3NjI4MA==", "bodyText": "Ah ok you meant making it a Set vs a Collection -- I do agree with the principle, and I did push the Set-ification of the topics up one level so that the actual class field is a Set. But I don't think it's really worth it to push it up another layer and Set-ify the constructor argument. For one thing we would just have to do the same conversion to a Set but in more places, and more importantly, the actual callers of the constructor don't care at all whether it's a Set or any other Collection. So I think it actually does make sense to convert to a Set inside the constructor body", "url": "https://github.com/apache/kafka/pull/9609#discussion_r533876280", "createdAt": "2020-12-02T03:41:52Z", "author": {"login": "ableegoldman"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {\n+\n+    private Collection<String> topicNames;\n+    private Pattern topicPattern;\n+    private final ConsumedInternal<K, V> consumedInternal;\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Collection<String> topicNames,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+        super(nodeName);\n+\n+        this.topicNames = topicNames;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Pattern topicPattern,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+\n+        super(nodeName);\n+\n+        this.topicPattern = topicPattern;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public Set<String> topicNames() {\n+        return new HashSet<>(topicNames);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0NTYyMg=="}, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzk5MDMzMA==", "bodyText": "Fair enough and I think that this is nothing urgent or absolute necessary. However, I would like to explain my line of thoughts. I think an interface of a class should also describe the constraints on the the object and as far as I see it does not make any sense to pass the same topic name multiple times to a source node.\nI do not see an issue with making the same conversion in more places and actually this is even not true because the only place we would do a conversion is in StreamsBuilder#stream(). All other dependent calls create a singleton collection which can be easily replaced with a singleton set. Actually, I do not understand why StreamsBuilder#stream() takes a collection instead of a set.\nI am not sure I can follow your other argument\n\nthe actual callers of the constructor don't care at all whether it's a Set or any other Collection\n\nDo you refer to the creation of the singleton collection in the callers?\nAs I said, I do not say we need to follow my proposal. I just wanted to argue in favor of a cleaner and more descriptive interface.", "url": "https://github.com/apache/kafka/pull/9609#discussion_r533990330", "createdAt": "2020-12-02T08:48:19Z", "author": {"login": "cadonna"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {\n+\n+    private Collection<String> topicNames;\n+    private Pattern topicPattern;\n+    private final ConsumedInternal<K, V> consumedInternal;\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Collection<String> topicNames,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+        super(nodeName);\n+\n+        this.topicNames = topicNames;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Pattern topicPattern,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+\n+        super(nodeName);\n+\n+        this.topicPattern = topicPattern;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public Set<String> topicNames() {\n+        return new HashSet<>(topicNames);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0NTYyMg=="}, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 52}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQyNDYyMQ==", "bodyText": "All other dependent calls create a singleton collection which can be easily replaced with a singleton set\n\nAh ok, I didn't notice that. I guess I only looked at StreamsBuilder#stream\n\nActually, I do not understand why StreamsBuilder#stream() takes a collection instead of a set.\n\nThis I totally agree with. I suspect the intention was just for convenience, so users don't have to do a list->set conversion themselves, but I personally don't find that to be a very strong argument. It doesn't seem worth doing a KIP over, but maybe if we rewrite some large parts of the DSL in the future, we can fix this as well\nBy \"callers\" I meant the method body of StreamsBuilder#stream, which doesn't really care whether there are duplicates in the collection because its only job is to pass the topics straight from the user to this source node.\nBut I see your point. If I touch on some related code in a future PR I can fix this on the side, or I'd be happy to review a PR if you want to submit one. Thanks for the discussion", "url": "https://github.com/apache/kafka/pull/9609#discussion_r534424621", "createdAt": "2020-12-02T19:25:49Z", "author": {"login": "ableegoldman"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {\n+\n+    private Collection<String> topicNames;\n+    private Pattern topicPattern;\n+    private final ConsumedInternal<K, V> consumedInternal;\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Collection<String> topicNames,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+        super(nodeName);\n+\n+        this.topicNames = topicNames;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public SourceGraphNode(final String nodeName,\n+                            final Pattern topicPattern,\n+                            final ConsumedInternal<K, V> consumedInternal) {\n+\n+        super(nodeName);\n+\n+        this.topicPattern = topicPattern;\n+        this.consumedInternal = consumedInternal;\n+    }\n+\n+    public Set<String> topicNames() {\n+        return new HashSet<>(topicNames);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0NTYyMg=="}, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 52}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMxNjY5MDA5OnYy", "diffSide": "RIGHT", "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QxNjo0NTo0N1rOH4WSIQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwODozMDowOFrOH5oEcw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0NzM5Mw==", "bodyText": "Can we also rename StreamsGraphNode to GraphNode? The Streams prefix is a bit confusing, IMO, because StreamSourceNode and StreamsGraphNode seem really similar although they are quite different.", "url": "https://github.com/apache/kafka/pull/9609#discussion_r528847393", "createdAt": "2020-11-23T16:45:47Z", "author": {"login": "cadonna"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTk3NDA5MA==", "bodyText": "Ok, but don't come crying when the PR blows up in length \ud83d\ude09 (but yeah that makes sense to me)", "url": "https://github.com/apache/kafka/pull/9609#discussion_r529974090", "createdAt": "2020-11-24T22:58:58Z", "author": {"login": "ableegoldman"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0NzM5Mw=="}, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDE4NzM3OQ==", "bodyText": "I have never said you need to do it in this PR \ud83d\ude09 . Jokes apart, I think in general it would be better to do such things in a separate PR, but when I wrote my comment, I completely forgot about it. Sorry about that!", "url": "https://github.com/apache/kafka/pull/9609#discussion_r530187379", "createdAt": "2020-11-25T08:30:08Z", "author": {"login": "cadonna"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/graph/SourceGraphNode.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements. See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.kafka.streams.kstream.internals.graph;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.regex.Pattern;\n+import org.apache.kafka.common.serialization.Serde;\n+import org.apache.kafka.streams.kstream.internals.ConsumedInternal;\n+\n+abstract public class SourceGraphNode<K, V> extends StreamsGraphNode {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODg0NzM5Mw=="}, "originalCommit": {"oid": "0b52cc30793fd12a76d60a4214bddd26fcc34e1c"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMyNDEwNDI5OnYy", "diffSide": "RIGHT", "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/CogroupedKStreamImpl.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwMDoyMjoyNFrOH5eYSQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNVQwMTo0MTozNlrOH5f49Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDAyODYxNw==", "bodyText": "nit: indention", "url": "https://github.com/apache/kafka/pull/9609#discussion_r530028617", "createdAt": "2020-11-25T00:22:24Z", "author": {"login": "mjsax"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/CogroupedKStreamImpl.java", "diffHunk": "@@ -129,7 +129,7 @@\n             subTopologySourceNodes,\n             name,\n             aggregateBuilder,\n-            streamsGraphNode,\n+                                                         graphNode,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "93518cd976bb9d35dc5ea92c5a2d2b98123dc0a0"}, "originalPosition": 44}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDA1MzM2NQ==", "bodyText": "wth happened here \ud83e\udd14", "url": "https://github.com/apache/kafka/pull/9609#discussion_r530053365", "createdAt": "2020-11-25T01:41:36Z", "author": {"login": "ableegoldman"}, "path": "streams/src/main/java/org/apache/kafka/streams/kstream/internals/CogroupedKStreamImpl.java", "diffHunk": "@@ -129,7 +129,7 @@\n             subTopologySourceNodes,\n             name,\n             aggregateBuilder,\n-            streamsGraphNode,\n+                                                         graphNode,", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDAyODYxNw=="}, "originalCommit": {"oid": "93518cd976bb9d35dc5ea92c5a2d2b98123dc0a0"}, "originalPosition": 44}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3877, "cost": 1, "resetAt": "2021-11-12T11:18:39Z"}}}