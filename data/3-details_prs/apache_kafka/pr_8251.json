{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg1MTgyNTAy", "number": 8251, "title": "MINOR: Code cleanup to improve generic typing", "bodyText": "Call for review @abbccdda @guozhangwang", "createdAt": "2020-03-07T19:07:02Z", "url": "https://github.com/apache/kafka/pull/8251", "merged": true, "mergeCommit": {"oid": "71113b4aac43a3a6f13625e25171ef8f2233fe7d"}, "closed": true, "closedAt": "2020-03-10T23:43:08Z", "author": {"login": "mjsax"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcL2YMegFqTM3MDkxNDE3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcMafgTgFqTM3MjM3MTk1OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwOTE0MTc2", "url": "https://github.com/apache/kafka/pull/8251#pullrequestreview-370914176", "createdAt": "2020-03-09T04:38:52Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNDozODo1MlrOFzaxWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQwNDozOTo0OFrOFzax3w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ2MDMxNA==", "bodyText": "What's the purpose of adding generic here?", "url": "https://github.com/apache/kafka/pull/8251#discussion_r389460314", "createdAt": "2020-03-09T04:38:52Z", "author": {"login": "abbccdda"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/ProcessorContextImpl.java", "diffHunk": "@@ -86,15 +85,15 @@ public StateStore getStateStore(final String name) {\n         final StateStore global = stateManager.getGlobalStore(name);\n         if (global != null) {\n             if (global instanceof TimestampedKeyValueStore) {\n-                return new TimestampedKeyValueStoreReadOnlyDecorator((TimestampedKeyValueStore) global);\n+                return new TimestampedKeyValueStoreReadOnlyDecorator<>((TimestampedKeyValueStore<?, ?>) global);", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ2MDQ0Nw==", "bodyText": "When we could actually close this TODO btw? @guozhangwang", "url": "https://github.com/apache/kafka/pull/8251#discussion_r389460447", "createdAt": "2020-03-09T04:39:48Z", "author": {"login": "abbccdda"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/Task.java", "diffHunk": "@@ -51,7 +51,7 @@\n      *          |            |                    |   |       |\n      *          |            v                    v   |       |\n      *          |      +-----+-------+       +----+---+----+  |\n-     *          |      | Running (2) | ----> | Suspended(3)|  |    * //TODO Suspended(3) could be removed after we've stable on KIP-429\n+     *          |      | Running (2) | ----> | Suspended(3)|  |    //TODO Suspended(3) could be removed after we've stable on KIP-429", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcxMzg5ODU0", "url": "https://github.com/apache/kafka/pull/8251#pullrequestreview-371389854", "createdAt": "2020-03-09T17:36:12Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxNzozNjoxMlrOFzykmQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wOVQxODowMDowNlrOFzzeLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg1MDI2NQ==", "bodyText": "Could you left some comments on the places you remove the casting to explain why it's okay to do so?", "url": "https://github.com/apache/kafka/pull/8251#discussion_r389850265", "createdAt": "2020-03-09T17:36:12Z", "author": {"login": "guozhangwang"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/ProcessorContextImpl.java", "diffHunk": "@@ -142,10 +139,9 @@ public StateStore getStateStore(final String name) {\n         forward(\n             key,\n             value,\n-            To.child(((List<ProcessorNode>) currentNode().children()).get(childIndex).name()));\n+            To.child((currentNode().children()).get(childIndex).name()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg2NDIwMg==", "bodyText": "Hmm, not clear about this change -- seems we are just delaying the casting by two lines of code here?", "url": "https://github.com/apache/kafka/pull/8251#discussion_r389864202", "createdAt": "2020-03-09T17:58:43Z", "author": {"login": "guozhangwang"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/ProcessorContextImpl.java", "diffHunk": "@@ -175,12 +171,12 @@ public StateStore getStateStore(final String name) {\n \n             final String sendTo = toInternal.child();\n             if (sendTo == null) {\n-                final List<ProcessorNode<K, V>> children = (List<ProcessorNode<K, V>>) currentNode().children();\n-                for (final ProcessorNode child : children) {\n-                    forward(child, key, value);\n+                final List<ProcessorNode<?, ?>> children = currentNode().children();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 91}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg2NTAwNA==", "bodyText": "When we can remove the eager protocol I think.", "url": "https://github.com/apache/kafka/pull/8251#discussion_r389865004", "createdAt": "2020-03-09T18:00:06Z", "author": {"login": "guozhangwang"}, "path": "streams/src/main/java/org/apache/kafka/streams/processor/internals/Task.java", "diffHunk": "@@ -51,7 +51,7 @@\n      *          |            |                    |   |       |\n      *          |            v                    v   |       |\n      *          |      +-----+-------+       +----+---+----+  |\n-     *          |      | Running (2) | ----> | Suspended(3)|  |    * //TODO Suspended(3) could be removed after we've stable on KIP-429\n+     *          |      | Running (2) | ----> | Suspended(3)|  |    //TODO Suspended(3) could be removed after we've stable on KIP-429", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTQ2MDQ0Nw=="}, "originalCommit": null, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMTk1MDk4", "url": "https://github.com/apache/kafka/pull/8251#pullrequestreview-372195098", "createdAt": "2020-03-10T18:00:38Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxODowMDozOFrOF0ar1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMFQxODowMDozOFrOF0ar1Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDUwNzQ3Nw==", "bodyText": "woah, how did this change?", "url": "https://github.com/apache/kafka/pull/8251#discussion_r390507477", "createdAt": "2020-03-10T18:00:38Z", "author": {"login": "vvcephei"}, "path": "streams/src/test/java/org/apache/kafka/streams/processor/internals/StreamThreadTest.java", "diffHunk": "@@ -977,6 +985,10 @@ public void shouldNotCloseTaskAndRemoveFromTaskManagerIfProducerGotFencedInCommi\n \n         assertThat(thread.activeTasks().size(), equalTo(1));\n \n+        // need to process a record to enable committing\n+        addRecord(mockConsumer, 0L);\n+        thread.runOnce();", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b0ecba43b45a8404035e8401e9a7794b603a6ce8", "author": {"user": {"login": "mjsax", "name": "Matthias J. Sax"}}, "url": "https://github.com/apache/kafka/commit/b0ecba43b45a8404035e8401e9a7794b603a6ce8", "committedDate": "2020-03-10T18:17:53Z", "message": "MINOR: Code cleanup to improve genric typing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec167350b461faa150a3f503fdebbd0ec97ffb0b", "author": {"user": {"login": "mjsax", "name": "Matthias J. Sax"}}, "url": "https://github.com/apache/kafka/commit/ec167350b461faa150a3f503fdebbd0ec97ffb0b", "committedDate": "2020-03-10T18:17:53Z", "message": "fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6520dc7a626c4049a56d436e0cde9b7bfeaa73a7", "author": {"user": {"login": "mjsax", "name": "Matthias J. Sax"}}, "url": "https://github.com/apache/kafka/commit/6520dc7a626c4049a56d436e0cde9b7bfeaa73a7", "committedDate": "2020-03-10T18:17:53Z", "message": "Github comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "6520dc7a626c4049a56d436e0cde9b7bfeaa73a7", "author": {"user": {"login": "mjsax", "name": "Matthias J. Sax"}}, "url": "https://github.com/apache/kafka/commit/6520dc7a626c4049a56d436e0cde9b7bfeaa73a7", "committedDate": "2020-03-10T18:17:53Z", "message": "Github comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMjE2MDg0", "url": "https://github.com/apache/kafka/pull/8251#pullrequestreview-372216084", "createdAt": "2020-03-10T18:28:54Z", "commit": {"oid": "6520dc7a626c4049a56d436e0cde9b7bfeaa73a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyMzcxOTU5", "url": "https://github.com/apache/kafka/pull/8251#pullrequestreview-372371959", "createdAt": "2020-03-10T22:45:07Z", "commit": {"oid": "6520dc7a626c4049a56d436e0cde9b7bfeaa73a7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 158, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}