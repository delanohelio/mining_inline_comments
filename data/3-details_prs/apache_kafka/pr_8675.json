{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4NjExNDU1", "number": 8675, "title": "KAFKA-10004: ConfigCommand fails to find default broker configs without ZK", "bodyText": "When running\nbin/kafka-configs.sh --describe --bootstrap-server localhost:9092 --entity-type brokers\nthe output will be:\nDynamic configs for broker 0 are: ....\nDynamic configs for broker  are:\nThe entity name for brokers must be a valid integer broker id, found: \nI found it's because we set the default entity name for broker as <default>, which should be empty string \"\". Also add the missing tests for the describe broker without entity name case.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-05-15T14:03:22Z", "url": "https://github.com/apache/kafka/pull/8675", "merged": true, "mergeCommit": {"oid": "ad0850659f5d536d43f09221c941022fc273e6d5"}, "closed": true, "closedAt": "2020-05-19T01:43:46Z", "author": {"login": "showuon"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcheVDkAH2gAyNDE4NjExNDU1OmEwMWM2NWJjZmY2MTMwMzFjMmFmZjg0MTU4NzYxN2M2NGRlOGMxNGE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchyGoogH2gAyNDE4NjExNDU1OjgzY2MyMzI4MDk5ZWYxNDI0YzNjZWE0OTIxNTZiZDRhODJmM2ZlNjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "a01c65bcff613031c2aff841587617c64de8c14a", "author": {"user": {"login": "showuon", "name": "Luke Chen"}}, "url": "https://github.com/apache/kafka/commit/a01c65bcff613031c2aff841587617c64de8c14a", "committedDate": "2020-05-15T09:05:44Z", "message": "fix the default broker name into empty string"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4e615b0c669cac8d33e66d01ac3e1bea0de55f0", "author": {"user": {"login": "showuon", "name": "Luke Chen"}}, "url": "https://github.com/apache/kafka/commit/a4e615b0c669cac8d33e66d01ac3e1bea0de55f0", "committedDate": "2020-05-15T13:52:05Z", "message": "add unit test for describe broker without entity name case"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyNjc4OTgz", "url": "https://github.com/apache/kafka/pull/8675#pullrequestreview-412678983", "createdAt": "2020-05-15T14:04:53Z", "commit": {"oid": "a4e615b0c669cac8d33e66d01ac3e1bea0de55f0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNDowNDo1M1rOGWGSWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNDowNDo1M1rOGWGSWg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTgyNDg1OA==", "bodyText": "reorder this test case to put the verifyAlterBrokerConfig test suits together. Note: the previous test is also test with verifyAlterBrokerConfig", "url": "https://github.com/apache/kafka/pull/8675#discussion_r425824858", "createdAt": "2020-05-15T14:04:53Z", "author": {"login": "showuon"}, "path": "core/src/test/scala/unit/kafka/admin/ConfigCommandTest.scala", "diffHunk": "@@ -736,6 +731,12 @@ class ConfigCommandTest extends ZooKeeperTestHarness with Logging {\n     verifyAlterBrokerConfig(node, \"\", List(\"--entity-default\"))\n   }\n \n+  @Test\n+  def shouldAddBrokerDynamicConfig(): Unit = {\n+    val node = new Node(1, \"localhost\", 9092)\n+    verifyAlterBrokerConfig(node, \"1\", List(\"--entity-name\", \"1\"))\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4e615b0c669cac8d33e66d01ac3e1bea0de55f0"}, "originalPosition": 38}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyNjc5NDQ4", "url": "https://github.com/apache/kafka/pull/8675#pullrequestreview-412679448", "createdAt": "2020-05-15T14:05:25Z", "commit": {"oid": "a4e615b0c669cac8d33e66d01ac3e1bea0de55f0"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNDowNToyNVrOGWGT7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNDowNToyNVrOGWGT7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTgyNTI2Mg==", "bodyText": "fix the wrong zk connection info", "url": "https://github.com/apache/kafka/pull/8675#discussion_r425825262", "createdAt": "2020-05-15T14:05:25Z", "author": {"login": "showuon"}, "path": "core/src/test/scala/unit/kafka/admin/ConfigCommandTest.scala", "diffHunk": "@@ -646,7 +641,7 @@ class ConfigCommandTest extends ZooKeeperTestHarness with Logging {\n \n   @Test\n   def testNoSpecifiedEntityOptionWithDescribeBrokersInZKIsAllowed(): Unit = {\n-    val optsList = List(\"--zookeeper\", \"localhost:9092\",\n+    val optsList = List(\"--zookeeper\", zkConnect,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4e615b0c669cac8d33e66d01ac3e1bea0de55f0"}, "originalPosition": 26}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEyNjkyNTgw", "url": "https://github.com/apache/kafka/pull/8675#pullrequestreview-412692580", "createdAt": "2020-05-15T14:20:58Z", "commit": {"oid": "a4e615b0c669cac8d33e66d01ac3e1bea0de55f0"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNDoyMDo1OFrOGWG7WA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNDoyMDo1OFrOGWG7WA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTgzNTM1Mg==", "bodyText": "Please substitute \"\" for BrokerDefaultEntityName in the match below, as well as in getResourceConfig.", "url": "https://github.com/apache/kafka/pull/8675#discussion_r425835352", "createdAt": "2020-05-15T14:20:58Z", "author": {"login": "bdbyrne"}, "path": "core/src/main/scala/kafka/admin/ConfigCommand.scala", "diffHunk": "@@ -424,7 +425,7 @@ object ConfigCommand extends Config {\n         case ConfigType.Topic =>\n           adminClient.listTopics(new ListTopicsOptions().listInternal(true)).names().get().asScala.toSeq\n         case ConfigType.Broker | BrokerLoggerConfigType =>\n-          adminClient.describeCluster(new DescribeClusterOptions()).nodes().get().asScala.map(_.idString).toSeq :+ ConfigEntityName.Default\n+          adminClient.describeCluster(new DescribeClusterOptions()).nodes().get().asScala.map(_.idString).toSeq :+ BrokerDefaultEntityName", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a4e615b0c669cac8d33e66d01ac3e1bea0de55f0"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83cc2328099ef1424c3cea492156bd4a82f3fe65", "author": {"user": {"login": "showuon", "name": "Luke Chen"}}, "url": "https://github.com/apache/kafka/commit/83cc2328099ef1424c3cea492156bd4a82f3fe65", "committedDate": "2020-05-16T08:08:05Z", "message": "KAFKA-1004: address reviewer's comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1024, "cost": 1, "resetAt": "2021-10-28T17:48:14Z"}}}