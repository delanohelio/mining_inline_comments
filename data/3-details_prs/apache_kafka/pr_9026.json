{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5MTcxMTU5", "number": 9026, "title": "KAFKA-10274; Consistent timeouts in transactions_test", "bodyText": "KAFKA-10235 fixed a consistency issue with the transaction timeout and the progress timeout. Since the test case relies on transaction timeouts, we need to wait at last as long as the timeout in order to ensure progress. However, having a low transaction timeout makes the test prone to the issue identified in KAFKA-9802, in which the coordinator timed out the transaction while the producer was awaiting a Produce response.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-07-15T00:02:55Z", "url": "https://github.com/apache/kafka/pull/9026", "merged": true, "mergeCommit": {"oid": "67f5b5de77d67c02edb335737215312d099a1cac"}, "closed": true, "closedAt": "2020-07-22T19:06:48Z", "author": {"login": "hachikuji"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0_DmrAH2gAyNDQ5MTcxMTU5OmRlYTk2YTRmZjllNzQyZWU1MjJjZjU0NjlhMDcxYTdmNTg3MDczOWY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3fqhQgFqTQ1MzYwNDI2Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dea96a4ff9e742ee522cf5469a071a7f5870739f", "author": {"user": {"login": "hachikuji", "name": "Jason Gustafson"}}, "url": "https://github.com/apache/kafka/commit/dea96a4ff9e742ee522cf5469a071a7f5870739f", "committedDate": "2020-07-14T23:58:06Z", "message": "KAFKA-10274; Consistent timeouts in transactions_test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NTc5MTQ5", "url": "https://github.com/apache/kafka/pull/9026#pullrequestreview-448579149", "createdAt": "2020-07-15T02:01:23Z", "commit": {"oid": "dea96a4ff9e742ee522cf5469a071a7f5870739f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4NzIwMjY1", "url": "https://github.com/apache/kafka/pull/9026#pullrequestreview-448720265", "createdAt": "2020-07-15T08:04:24Z", "commit": {"oid": "dea96a4ff9e742ee522cf5469a071a7f5870739f"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODowNDoyNFrOGxy51g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQwODowNDoyNFrOGxy51g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2NzQxNA==", "bodyText": "How about using different transaction_timeout for different mode? For example, lower timeout for hard_bounce of client and higher timeout for broker. I try to avoid higher waiting time (progress_timeout_sec) when encountering other error.", "url": "https://github.com/apache/kafka/pull/9026#discussion_r454867414", "createdAt": "2020-07-15T08:04:24Z", "author": {"login": "chia7712"}, "path": "tests/kafkatest/tests/core/transactions_test.py", "diffHunk": "@@ -47,11 +47,15 @@ def __init__(self, test_context):\n         self.num_output_partitions = 3\n         self.num_seed_messages = 100000\n         self.transaction_size = 750\n-        # The timeout of transaction should be lower than the timeout of verification. The transactional message sent by\n-        # client may be not correctly completed in hard_bounce mode. The pending transaction (unstable offset) stored by\n-        # broker obstructs TransactionMessageCopier from getting offset of partition which is used to calculate\n-        # remaining messages after restarting.\n-        self.transaction_timeout = 5000\n+\n+        # The transaction timeout should be lower than the progress timeout, but at\n+        # least as high as the request timeout (which is 30s by default). When the\n+        # client is hard-bounced, progress may depend on the previous transaction\n+        # being aborted. When the broker is hard-bounced, we may have to wait as\n+        # long as the request timeout to get a `Produce` response and we do not\n+        # want the coordinator timing out the transaction.\n+        self.transaction_timeout = 40000\n+        self.progress_timeout_sec = 60", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dea96a4ff9e742ee522cf5469a071a7f5870739f"}, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUzNjA0MjYy", "url": "https://github.com/apache/kafka/pull/9026#pullrequestreview-453604262", "createdAt": "2020-07-22T19:05:25Z", "commit": {"oid": "dea96a4ff9e742ee522cf5469a071a7f5870739f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1295, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}