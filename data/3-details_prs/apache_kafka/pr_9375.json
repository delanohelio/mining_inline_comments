{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3OTg2MTUz", "number": 9375, "title": "KAFKA-10574: Fix infinite loop in Values::parseString", "bodyText": "Jira\nThe special byte sequence 0xEF, 0xBF, 0xBF, when parsed as a UTF-8 string, causes the StringCharacterIterator to return CharacterIterator.DONE from its next(), current(), and other similar methods. This caused an infinite loop in the Values class whenever that byte sequence was encountered.\nThe fix is pretty simple. To see if we're at the end of a string, we compare StandardCharacterIterator::getIndex to StandardCharacterIterator::getEndIndex, instead of comparing the last-read character to CharacterIterator.DONE (since that character may occur in strings that we're parsing).\nI've added a unit test that replicates this bug (when the fix in the Values class is not present). I gave it a timeout of five seconds in case someone accidentally re-creates the infinite loop in order to save some time and potential confusion.\nAll existing unit tests for the Values class pass with this change.\nCommitter Checklist (excluded from commit message)\n\n Verify design and implementation\n Verify test coverage and CI build status\n Verify documentation (including upgrade notes)", "createdAt": "2020-10-05T16:50:51Z", "url": "https://github.com/apache/kafka/pull/9375", "merged": true, "mergeCommit": {"oid": "0a93d2b1af68ebe4601802cb366f57f20eb2a466"}, "closed": true, "closedAt": "2020-10-12T16:42:43Z", "author": {"login": "C0urante"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdPmugEgFqTUwMjI0NDgzMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdP4lwCgBqjM4NDU1MjAzMDk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjQ0ODMz", "url": "https://github.com/apache/kafka/pull/9375#pullrequestreview-502244833", "createdAt": "2020-10-05T16:53:17Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjYwMTM3", "url": "https://github.com/apache/kafka/pull/9375#pullrequestreview-502260137", "createdAt": "2020-10-05T17:14:10Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNzoxNDoxMFrOHcmXUw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNzoxNDoxMFrOHcmXUw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTc1MDczOQ==", "bodyText": "we need a comment here to explain things.", "url": "https://github.com/apache/kafka/pull/9375#discussion_r499750739", "createdAt": "2020-10-05T17:14:10Z", "author": {"login": "kkonstantine"}, "path": "connect/api/src/test/java/org/apache/kafka/connect/data/ValuesTest.java", "diffHunk": "@@ -73,6 +76,15 @@\n         INT_LIST.add(-987654321);\n     }\n \n+    @Test(timeout = 5000)\n+    public void shouldNotEncounterInfiniteLoop() {\n+        byte[] bytes = new byte[] { -17, -65,  -65 };", "state": "SUBMITTED", "replyTo": null, "originalCommit": null, "originalPosition": 17}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjY2MTk4", "url": "https://github.com/apache/kafka/pull/9375#pullrequestreview-502266198", "createdAt": "2020-10-05T17:22:22Z", "commit": null, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjY4NjU1", "url": "https://github.com/apache/kafka/pull/9375#pullrequestreview-502268655", "createdAt": "2020-10-05T17:25:50Z", "commit": null, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMzUzNzY5", "url": "https://github.com/apache/kafka/pull/9375#pullrequestreview-502353769", "createdAt": "2020-10-05T19:26:13Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMzY2MTgz", "url": "https://github.com/apache/kafka/pull/9375#pullrequestreview-502366183", "createdAt": "2020-10-05T19:44:41Z", "commit": null, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "946976062aab64fed5a0b4ada44e96ffe513915b", "author": {"user": {"login": "C0urante", "name": "Chris Egerton"}}, "url": "https://github.com/apache/kafka/commit/946976062aab64fed5a0b4ada44e96ffe513915b", "committedDate": "2020-10-06T13:35:32Z", "message": "KAFKA-10574: Fix infinite loop in Values::parseString"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "94cc47b2e584c2f2c8657efaeaa4bc7f7315bc89", "author": {"user": {"login": "C0urante", "name": "Chris Egerton"}}, "url": "https://github.com/apache/kafka/commit/94cc47b2e584c2f2c8657efaeaa4bc7f7315bc89", "committedDate": "2020-10-06T13:35:33Z", "message": "KAFKA-10574: Address review comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": null, "afterCommit": {"oid": "94cc47b2e584c2f2c8657efaeaa4bc7f7315bc89", "author": {"user": {"login": "C0urante", "name": "Chris Egerton"}}, "url": "https://github.com/apache/kafka/commit/94cc47b2e584c2f2c8657efaeaa4bc7f7315bc89", "committedDate": "2020-10-06T13:35:33Z", "message": "KAFKA-10574: Address review comments"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 440, "cost": 1, "resetAt": "2021-10-28T18:00:02Z"}}}