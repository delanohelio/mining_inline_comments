{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2MTk0NjMz", "number": 2302, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQwNjo1MTo1NFrODt0Y6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxODoxMDo0NlrODugYQA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ5MzcwODU5OnYy", "diffSide": "RIGHT", "path": "compiler/src/org.graalvm.compiler.nodes/src/org/graalvm/compiler/nodes/extended/RawVolatileLoadNode.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQwNjo1MTo1NFrOF_dgiA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wMlQwNjo1MTo1NFrOF_dgiA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA4ODA3Mg==", "bodyText": "Minor: This needs to propagate the nodeclass (TYPE) to the super class ctor", "url": "https://github.com/oracle/graal/pull/2302#discussion_r402088072", "createdAt": "2020-04-02T06:51:54Z", "author": {"login": "davleopo"}, "path": "compiler/src/org.graalvm.compiler.nodes/src/org/graalvm/compiler/nodes/extended/RawVolatileLoadNode.java", "diffHunk": "@@ -0,0 +1,56 @@\n+/*\n+ * Copyright (c) 2020, Oracle and/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, Red Hat Inc. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ */\n+\n+package org.graalvm.compiler.nodes.extended;\n+\n+import jdk.vm.ci.meta.JavaKind;\n+import org.graalvm.compiler.graph.NodeClass;\n+import org.graalvm.compiler.nodeinfo.NodeInfo;\n+import org.graalvm.compiler.nodes.ValueNode;\n+import org.graalvm.compiler.nodes.memory.SingleMemoryKill;\n+import org.graalvm.word.LocationIdentity;\n+\n+import static org.graalvm.compiler.nodeinfo.NodeCycles.CYCLES_2;\n+import static org.graalvm.compiler.nodeinfo.NodeSize.SIZE_1;\n+\n+@NodeInfo(cycles = CYCLES_2, size = SIZE_1)\n+public class RawVolatileLoadNode extends RawLoadNode implements SingleMemoryKill {\n+    public static final NodeClass<RawVolatileLoadNode> TYPE = NodeClass.create(RawVolatileLoadNode.class);\n+\n+    public RawVolatileLoadNode(ValueNode object, ValueNode offset, JavaKind accessKind, LocationIdentity locationIdentity) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "affa1f69b107f0d968079edd3d6585588167c80e"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwMDkxNTg0OnYy", "diffSide": "RIGHT", "path": "compiler/src/org.graalvm.compiler.nodes/src/org/graalvm/compiler/nodes/extended/RawStoreNode.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wM1QxODoxMDo0NlrOGAh8kQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQwNzoyNDozM1rOGBKz9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzIwOTM2MQ==", "bodyText": "There slipped a tiny bug through: A few lines down is a node intrinsic that used this ctor with needsbarrier and this commit changed it to isVolatile, this caused some of our internal tests to fail. I fixed that internally and started the integration process.", "url": "https://github.com/oracle/graal/pull/2302#discussion_r403209361", "createdAt": "2020-04-03T18:10:46Z", "author": {"login": "davleopo"}, "path": "compiler/src/org.graalvm.compiler.nodes/src/org/graalvm/compiler/nodes/extended/RawStoreNode.java", "diffHunk": "@@ -58,21 +58,28 @@\n     @Input ValueNode value;\n     @OptionalInput(State) FrameState stateAfter;\n     private final boolean needsBarrier;\n+    private boolean isVolatile;\n \n     public RawStoreNode(ValueNode object, ValueNode offset, ValueNode value, JavaKind accessKind, LocationIdentity locationIdentity) {\n-        this(object, offset, value, accessKind, locationIdentity, true);\n+        this(object, offset, value, accessKind, locationIdentity, true, false, null, false);\n     }\n \n-    public RawStoreNode(ValueNode object, ValueNode offset, ValueNode value, JavaKind accessKind, LocationIdentity locationIdentity, boolean needsBarrier) {\n-        this(object, offset, value, accessKind, locationIdentity, needsBarrier, null, false);\n+    public RawStoreNode(ValueNode object, ValueNode offset, ValueNode value, JavaKind accessKind, LocationIdentity locationIdentity, boolean isVolatile) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4e777e4d0a5bd1e02b172d475abc90aac308d073"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzg3ODkwMg==", "bodyText": "Thanks for fixing that one. And thanks for the quick turnaround on that one.", "url": "https://github.com/oracle/graal/pull/2302#discussion_r403878902", "createdAt": "2020-04-06T07:24:33Z", "author": {"login": "rwestrel"}, "path": "compiler/src/org.graalvm.compiler.nodes/src/org/graalvm/compiler/nodes/extended/RawStoreNode.java", "diffHunk": "@@ -58,21 +58,28 @@\n     @Input ValueNode value;\n     @OptionalInput(State) FrameState stateAfter;\n     private final boolean needsBarrier;\n+    private boolean isVolatile;\n \n     public RawStoreNode(ValueNode object, ValueNode offset, ValueNode value, JavaKind accessKind, LocationIdentity locationIdentity) {\n-        this(object, offset, value, accessKind, locationIdentity, true);\n+        this(object, offset, value, accessKind, locationIdentity, true, false, null, false);\n     }\n \n-    public RawStoreNode(ValueNode object, ValueNode offset, ValueNode value, JavaKind accessKind, LocationIdentity locationIdentity, boolean needsBarrier) {\n-        this(object, offset, value, accessKind, locationIdentity, needsBarrier, null, false);\n+    public RawStoreNode(ValueNode object, ValueNode offset, ValueNode value, JavaKind accessKind, LocationIdentity locationIdentity, boolean isVolatile) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzIwOTM2MQ=="}, "originalCommit": {"oid": "4e777e4d0a5bd1e02b172d475abc90aac308d073"}, "originalPosition": 13}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 847, "cost": 1, "resetAt": "2021-11-13T12:10:21Z"}}}