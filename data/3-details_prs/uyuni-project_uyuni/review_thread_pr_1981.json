{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0MTg4MTU4", "number": 1981, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNToyNDo1OFrODoH2Fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNToyNzowMFrODoH2xg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMzk4MTY2OnYy", "diffSide": "RIGHT", "path": "java/code/src/com/suse/manager/webui/utils/LoginHelper.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNToyNDo1OFrOF2ficA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNTo1ODo0MlrOF2fuvg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDE0NA==", "bodyText": "Here it is 12, but the Long is 130000 . Is this intentional?", "url": "https://github.com/uyuni-project/uyuni/pull/1981#discussion_r392684144", "createdAt": "2020-03-15T15:24:58Z", "author": {"login": "mantel"}, "path": "java/code/src/com/suse/manager/webui/utils/LoginHelper.java", "diffHunk": "@@ -65,8 +66,13 @@\n \n     private static Logger log = Logger.getLogger(LoginHelper.class);\n     private static final String DEFAULT_KERB_USER_PASSWORD = \"0\";\n-    private static final Long MIN_PG_DB_VERSION = 90600L;\n-    private static final String MIN_PG_DB_VERSION_STRING = \"9.6\";\n+    private static final Long MIN_PG_DB_VERSION = 100001L;\n+    private static final Long MAX_PG_DB_VERSION = 130000L;\n+    private static final String MIN_PG_DB_VERSION_STRING = \"10\";\n+    private static final String MAX_PG_DB_VERSION_STRING = \"12\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "543c76a9d5d0c70b924e2dc273f47651ed811486"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDM5OQ==", "bodyText": "yes as I check for \"less than\". But we could also set 129999L and test for \"less or equal than\"", "url": "https://github.com/uyuni-project/uyuni/pull/1981#discussion_r392684399", "createdAt": "2020-03-15T15:27:18Z", "author": {"login": "mcalmer"}, "path": "java/code/src/com/suse/manager/webui/utils/LoginHelper.java", "diffHunk": "@@ -65,8 +66,13 @@\n \n     private static Logger log = Logger.getLogger(LoginHelper.class);\n     private static final String DEFAULT_KERB_USER_PASSWORD = \"0\";\n-    private static final Long MIN_PG_DB_VERSION = 90600L;\n-    private static final String MIN_PG_DB_VERSION_STRING = \"9.6\";\n+    private static final Long MIN_PG_DB_VERSION = 100001L;\n+    private static final Long MAX_PG_DB_VERSION = 130000L;\n+    private static final String MIN_PG_DB_VERSION_STRING = \"10\";\n+    private static final String MAX_PG_DB_VERSION_STRING = \"12\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDE0NA=="}, "originalCommit": {"oid": "543c76a9d5d0c70b924e2dc273f47651ed811486"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NzI5NA==", "bodyText": "You were right. I checked already for greater than which means we should test for 129999L value. Changed.", "url": "https://github.com/uyuni-project/uyuni/pull/1981#discussion_r392687294", "createdAt": "2020-03-15T15:58:42Z", "author": {"login": "mcalmer"}, "path": "java/code/src/com/suse/manager/webui/utils/LoginHelper.java", "diffHunk": "@@ -65,8 +66,13 @@\n \n     private static Logger log = Logger.getLogger(LoginHelper.class);\n     private static final String DEFAULT_KERB_USER_PASSWORD = \"0\";\n-    private static final Long MIN_PG_DB_VERSION = 90600L;\n-    private static final String MIN_PG_DB_VERSION_STRING = \"9.6\";\n+    private static final Long MIN_PG_DB_VERSION = 100001L;\n+    private static final Long MAX_PG_DB_VERSION = 130000L;\n+    private static final String MIN_PG_DB_VERSION_STRING = \"10\";\n+    private static final String MAX_PG_DB_VERSION_STRING = \"12\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDE0NA=="}, "originalCommit": {"oid": "543c76a9d5d0c70b924e2dc273f47651ed811486"}, "originalPosition": 15}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzMzk4MzQyOnYy", "diffSide": "RIGHT", "path": "spacewalk/admin/spacewalk-startup-helper", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNToyNzowMFrOF2fjXw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNToyODoyN1rOF2fj5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDM4Mw==", "bodyText": "Why not simply\ng36:~ # psql --version\npsql (PostgreSQL) 10.10", "url": "https://github.com/uyuni-project/uyuni/pull/1981#discussion_r392684383", "createdAt": "2020-03-15T15:27:00Z", "author": {"login": "mantel"}, "path": "spacewalk/admin/spacewalk-startup-helper", "diffHunk": "@@ -5,13 +5,17 @@ if [ -x \"/usr/bin/lsof\" ]; then\n     LSOF=\"/usr/bin/lsof\"\n fi\n \n-wait_for_database() {\n+check_database() {\n     RETRIES=10;\n     while [ $RETRIES -gt 0 ]; do\n \n-        echo \"select 0 from dual;\" | spacewalk-sql --select-mode - &> /dev/null\n+        IFS=\".\" read -ra VARR <<< $(echo \"show server_version;\" | spacewalk-sql --select-mode - | sed -n 3p | xargs)\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "543c76a9d5d0c70b924e2dc273f47651ed811486"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDUxOA==", "bodyText": "In case of remote DB I want to read it from the real db we connect to.\nYou know we have one customer with that exception.", "url": "https://github.com/uyuni-project/uyuni/pull/1981#discussion_r392684518", "createdAt": "2020-03-15T15:28:27Z", "author": {"login": "mcalmer"}, "path": "spacewalk/admin/spacewalk-startup-helper", "diffHunk": "@@ -5,13 +5,17 @@ if [ -x \"/usr/bin/lsof\" ]; then\n     LSOF=\"/usr/bin/lsof\"\n fi\n \n-wait_for_database() {\n+check_database() {\n     RETRIES=10;\n     while [ $RETRIES -gt 0 ]; do\n \n-        echo \"select 0 from dual;\" | spacewalk-sql --select-mode - &> /dev/null\n+        IFS=\".\" read -ra VARR <<< $(echo \"show server_version;\" | spacewalk-sql --select-mode - | sed -n 3p | xargs)\n ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDM4Mw=="}, "originalCommit": {"oid": "543c76a9d5d0c70b924e2dc273f47651ed811486"}, "originalPosition": 11}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 124, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}