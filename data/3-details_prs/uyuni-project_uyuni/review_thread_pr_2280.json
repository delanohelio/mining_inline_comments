{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3MzIzNjA5", "number": 2280, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOToxMzowM1rOEDXJ8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOToyNjoyNVrOEDXcqQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxOTYwNTYzOnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/frontend/action/errata/ChannelAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOToxMzowM1rOGgVbtg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNDozMzowMFrOGghbyw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU1ODc3NA==", "bodyText": "makes sense to use com.redhat.rhn.frontend.struts.RequestContext.ERRATA_ID here as well", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436558774", "createdAt": "2020-06-08T09:13:03Z", "author": {"login": "chiaradiamarcelo"}, "path": "java/code/src/com/redhat/rhn/frontend/action/errata/ChannelAction.java", "diffHunk": "@@ -246,18 +246,20 @@ protected void processMethodKeys(Map<String, String> map) {\n      * {@inheritDoc}\n      * Add eid to our parameter map\n      */\n-    protected void processParamMap(ActionForm formIn,\n+    public void processParamMap(ActionForm formIn,\n                                    HttpServletRequest request,\n                                    Map<String, Object> params) {\n         //keep eid in params\n-        Long eid = new RequestContext(request).getRequiredParam(\"eid\");\n+        Long eid = new RequestContext(request).getParamAsLong(\"eid\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc1NTQwMw==", "bodyText": "Addressed", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436755403", "createdAt": "2020-06-08T14:33:00Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/action/errata/ChannelAction.java", "diffHunk": "@@ -246,18 +246,20 @@ protected void processMethodKeys(Map<String, String> map) {\n      * {@inheritDoc}\n      * Add eid to our parameter map\n      */\n-    protected void processParamMap(ActionForm formIn,\n+    public void processParamMap(ActionForm formIn,\n                                    HttpServletRequest request,\n                                    Map<String, Object> params) {\n         //keep eid in params\n-        Long eid = new RequestContext(request).getRequiredParam(\"eid\");\n+        Long eid = new RequestContext(request).getParamAsLong(\"eid\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU1ODc3NA=="}, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxOTYwNjI4OnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/frontend/action/errata/ChannelAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOToxMzoxNVrOGgVcEw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNDozMzoxMFrOGghcOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU1ODg2Nw==", "bodyText": "same here", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436558867", "createdAt": "2020-06-08T09:13:15Z", "author": {"login": "chiaradiamarcelo"}, "path": "java/code/src/com/redhat/rhn/frontend/action/errata/ChannelAction.java", "diffHunk": "@@ -246,18 +246,20 @@ protected void processMethodKeys(Map<String, String> map) {\n      * {@inheritDoc}\n      * Add eid to our parameter map\n      */\n-    protected void processParamMap(ActionForm formIn,\n+    public void processParamMap(ActionForm formIn,\n                                    HttpServletRequest request,\n                                    Map<String, Object> params) {\n         //keep eid in params\n-        Long eid = new RequestContext(request).getRequiredParam(\"eid\");\n+        Long eid = new RequestContext(request).getParamAsLong(\"eid\");\n+        if (eid != null) {\n+            params.put(\"eid\", eid);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc1NTUxMw==", "bodyText": "Addressed", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436755513", "createdAt": "2020-06-08T14:33:10Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/action/errata/ChannelAction.java", "diffHunk": "@@ -246,18 +246,20 @@ protected void processMethodKeys(Map<String, String> map) {\n      * {@inheritDoc}\n      * Add eid to our parameter map\n      */\n-    protected void processParamMap(ActionForm formIn,\n+    public void processParamMap(ActionForm formIn,\n                                    HttpServletRequest request,\n                                    Map<String, Object> params) {\n         //keep eid in params\n-        Long eid = new RequestContext(request).getRequiredParam(\"eid\");\n+        Long eid = new RequestContext(request).getParamAsLong(\"eid\");\n+        if (eid != null) {\n+            params.put(\"eid\", eid);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU1ODg2Nw=="}, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxOTYxMzE2OnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/frontend/action/errata/ChannelSetupAction.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOToxNToxNFrOGgVgRg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNDoyODo0NVrOGghQlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU1OTk0Mg==", "bodyText": "might make sense to return an optional here if Errata can be null. Maybe for a next PR", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436559942", "createdAt": "2020-06-08T09:15:14Z", "author": {"login": "chiaradiamarcelo"}, "path": "java/code/src/com/redhat/rhn/frontend/action/errata/ChannelSetupAction.java", "diffHunk": "@@ -65,7 +68,8 @@ public ActionForward execute(ActionMapping mapping,\n         clampListBounds(pc, request, user);\n \n         //Get the errata object\n-        Errata e = requestContext.lookupErratum();\n+        Long errataId = requestContext.getParamAsLong(ERRATA_ID);\n+        Errata e = ErrataManager.lookupErrata(errataId, requestContext.getCurrentUser());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc1MjUzMg==", "bodyText": "Yes, I am adding that to the list for the follow-up cleanup PR.", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436752532", "createdAt": "2020-06-08T14:28:45Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/action/errata/ChannelSetupAction.java", "diffHunk": "@@ -65,7 +68,8 @@ public ActionForward execute(ActionMapping mapping,\n         clampListBounds(pc, request, user);\n \n         //Get the errata object\n-        Errata e = requestContext.lookupErratum();\n+        Long errataId = requestContext.getParamAsLong(ERRATA_ID);\n+        Errata e = ErrataManager.lookupErrata(errataId, requestContext.getCurrentUser());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU1OTk0Mg=="}, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxOTYzODk5OnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/frontend/action/errata/CreateAction.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOToyMjoxMlrOGgVv-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNTowNToxMFrOGgi6HQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2Mzk2MA==", "bodyText": "is the whole concept of \"publishing an errata\" still valid? can it be an errata in another state that is \"not published\"?\nshouldn't we do this as part of the creation of the errata?", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436563960", "createdAt": "2020-06-08T09:22:12Z", "author": {"login": "chiaradiamarcelo"}, "path": "java/code/src/com/redhat/rhn/frontend/action/errata/CreateAction.java", "diffHunk": "@@ -134,6 +148,7 @@ public ActionForward execute(ActionMapping mapping,\n         e.setOrg(user.getOrg());\n \n         ErrataManager.storeErrata(e);\n+        ErrataManager.publish(e, channelAction.getChannelIdsFromRhnSet(set), user);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc1NDY2NQ==", "bodyText": "The concept of publishing an errata per se remains - it's just that before, one could publish both an unpublished or a published errata - now unpublished errata cease to exist. So the only remaining option is to re-publish something that was already published before - which is a valid thing to do.\nOn a high level, I completely agree the \"first publishing\" should be part of errata creation. Whether that means to wrap those methods together in this specific case is something I would leave for the follow up PR.\nSo see you there, if you agree.", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436754665", "createdAt": "2020-06-08T14:31:53Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/action/errata/CreateAction.java", "diffHunk": "@@ -134,6 +148,7 @@ public ActionForward execute(ActionMapping mapping,\n         e.setOrg(user.getOrg());\n \n         ErrataManager.storeErrata(e);\n+        ErrataManager.publish(e, channelAction.getChannelIdsFromRhnSet(set), user);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2Mzk2MA=="}, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc3OTU0OQ==", "bodyText": "It would be nice to address this in a follow up PR for clarify. Thanks", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436779549", "createdAt": "2020-06-08T15:05:10Z", "author": {"login": "chiaradiamarcelo"}, "path": "java/code/src/com/redhat/rhn/frontend/action/errata/CreateAction.java", "diffHunk": "@@ -134,6 +148,7 @@ public ActionForward execute(ActionMapping mapping,\n         e.setOrg(user.getOrg());\n \n         ErrataManager.storeErrata(e);\n+        ErrataManager.publish(e, channelAction.getChannelIdsFromRhnSet(set), user);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2Mzk2MA=="}, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 79}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxOTY0NjIzOnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/frontend/strings/jsp/StringResource_en_US.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOToyNDoxNFrOGgV0Pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNDozMjo0OVrOGghbXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2NTA1NQ==", "bodyText": "Should we still use the \"publish\" word in the UI? to me it gives some sense of \"an errata can be in another state than 'published'\"", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436565055", "createdAt": "2020-06-08T09:24:14Z", "author": {"login": "chiaradiamarcelo"}, "path": "java/code/src/com/redhat/rhn/frontend/strings/jsp/StringResource_en_US.xml", "diffHunk": "@@ -3384,7 +3384,7 @@ button below, and &lt;b&gt;will be unable to log back in&lt;/b&gt;.</source>\n         </context-group>\n       </trans-unit>\n       <trans-unit id=\"errata.publish.nochannelsselected\">\n-        <source>A published patch must belong to at least one channel.</source>\n+        <source>At least one channel must be selected for publishing.</source>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc1NTI5NA==", "bodyText": "Reworded.", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436755294", "createdAt": "2020-06-08T14:32:49Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/strings/jsp/StringResource_en_US.xml", "diffHunk": "@@ -3384,7 +3384,7 @@ button below, and &lt;b&gt;will be unable to log back in&lt;/b&gt;.</source>\n         </context-group>\n       </trans-unit>\n       <trans-unit id=\"errata.publish.nochannelsselected\">\n-        <source>A published patch must belong to at least one channel.</source>\n+        <source>At least one channel must be selected for publishing.</source>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2NTA1NQ=="}, "originalCommit": {"oid": "31bfd0fcb0a191f58eccd8fd9ccd772f8963a1c2"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjcxOTY1MzUzOnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/frontend/strings/jsp/StringResource_en_US.xml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQwOToyNjoyNVrOGgV4tQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNDozMzo0NlrOGghdwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2NjE5Nw==", "bodyText": "same here. I would remove the the \"publish\":\n\"The patches listed here will be cloned in the channels selected below. Once they are cloned, they will appear in each channel's patch list.\"", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436566197", "createdAt": "2020-06-08T09:26:25Z", "author": {"login": "chiaradiamarcelo"}, "path": "java/code/src/com/redhat/rhn/frontend/strings/jsp/StringResource_en_US.xml", "diffHunk": "@@ -7191,7 +7191,7 @@ organization management tools if you choose to remove this role from your login.\n         </context-group>\n       </trans-unit>\n       <trans-unit id=\"cloneconfirm.jsp.pagesummary\">\n-        <source>The patches listed below will be cloned. Once they are cloned, they will appear in your &lt;a href=&quot;{0}&quot;&gt;unpublished patches list&lt;/a&gt;. From there you can verify the text and associated packages for each patch. Once you are ready, you can publish the patches so they are available to users in your organization.</source>\n+        <source>The patches listed here will be cloned and published in the channels selected below. Once they are cloned, they will appear in each channel's patch list.</source>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3de78fcc64ae72761bc59ab4311b87b45aa2e865"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjc1NTkwNA==", "bodyText": "Reworded", "url": "https://github.com/uyuni-project/uyuni/pull/2280#discussion_r436755904", "createdAt": "2020-06-08T14:33:46Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/strings/jsp/StringResource_en_US.xml", "diffHunk": "@@ -7191,7 +7191,7 @@ organization management tools if you choose to remove this role from your login.\n         </context-group>\n       </trans-unit>\n       <trans-unit id=\"cloneconfirm.jsp.pagesummary\">\n-        <source>The patches listed below will be cloned. Once they are cloned, they will appear in your &lt;a href=&quot;{0}&quot;&gt;unpublished patches list&lt;/a&gt;. From there you can verify the text and associated packages for each patch. Once you are ready, you can publish the patches so they are available to users in your organization.</source>\n+        <source>The patches listed here will be cloned and published in the channels selected below. Once they are cloned, they will appear in each channel's patch list.</source>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjU2NjE5Nw=="}, "originalCommit": {"oid": "3de78fcc64ae72761bc59ab4311b87b45aa2e865"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4281, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}