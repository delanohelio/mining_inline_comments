{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIyNzY1MzYz", "number": 2248, "title": "Add bootstrapping for Oracle Linux 6, 7 and 8", "bodyText": "What does this PR change?\nAdd bootstrapping for Oracle Linux 6, 7 and 8\nTested bootstrap from\n\nOracle6: script (traditional), script (salt),\nOracle7: script (traditional),  script (salt-minion )WebUI (salt-minion),  WebUI (salt-ssh)\nOracle8: script (salt-minon), webUI (salt-minion), WebUI (salt-ssh)\n\nFailing\nOracle6:  WebUI (salt-ssh), WebUI (salt-minion), so far only on minimal installations (WORKS if using \"Basic Server\" profile.\n\nscp doesn't come preinstalled, so salt-ssh just doesn't work, so neither of the bootstraps work\nIf you install scp\n\nsalt-ssh fails because there's no machine-id (for salt-minions it gets created when the salt-minion package is installed)\nsalt-minion fails because Perl and Perl-Getopts are not available.\n\n\n\nI will run a quick test tomorrow with \"Basic Server\" profile.\nNOTE: Oracle6 salt from script showed:\nERROR: Dynamic CA-Trust > Updates are disabled. Enable Dynamic CA-Trust Updates with '/usr/bin/update-ca-trust force-enable'\nFinally, restart the onboarding sequence.\n\nAnd it seems the packages for traditional stack got updated as well... as they come preinstalled and the bootstrap script has a function to upload *rhnlib* and dependencies. I wonder if that's correct, but anyway this is nothing that's not happening for RES.\nGUI diff\nNo difference.\n\n DONE\n\nDocumentation\n\n\nNo documentation needed: Doc ready.\n\n\n DONE\n\n\nTest coverage\n\n\nNo tests: Not covered by the testsuite for now.\n\n\n DONE\n\n\nLinks\nPending:\nFixes SUSE/spacewalk#11549\n\n DONE\n\nChangelogs\nIf you don't need a changelog check, please mark this checkbox:\n\n No changelog needed\n\nIf you uncheck the checkbox after the PR is created, you will need to re-run changelog_test (see below)\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_lint_checkstyle\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"ruby_rubocop\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-05-25T13:57:50Z", "url": "https://github.com/uyuni-project/uyuni/pull/2248", "merged": true, "mergeCommit": {"oid": "f7043a6052a7630e95b2f9ae89dd3270b0f0aabb"}, "closed": true, "closedAt": "2020-05-27T09:14:26Z", "author": {"login": "juliogonzalez"}, "timelineItems": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABckwgYVABqjMzNzAzNjE1MDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABclVkOLgFqTQxOTAwMDk0Nw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c13304fe21005fe7d634f11dc00f6a07c7a45756", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c13304fe21005fe7d634f11dc00f6a07c7a45756", "committedDate": "2020-05-25T13:55:07Z", "message": "Add bootstrapping for Oracle Linux 6, 7 and 8"}, "afterCommit": {"oid": "684388113be72a51dbba33a0eec8bafcebee4889", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/684388113be72a51dbba33a0eec8bafcebee4889", "committedDate": "2020-05-25T13:58:03Z", "message": "Add bootstrapping for Oracle Linux 6, 7 and 8"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "684388113be72a51dbba33a0eec8bafcebee4889", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/684388113be72a51dbba33a0eec8bafcebee4889", "committedDate": "2020-05-25T13:58:03Z", "message": "Add bootstrapping for Oracle Linux 6, 7 and 8"}, "afterCommit": {"oid": "35c02da9f36b508a2128a6117d150426130d8323", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/35c02da9f36b508a2128a6117d150426130d8323", "committedDate": "2020-05-25T14:28:35Z", "message": "Add bootstrapping for Oracle Linux 6, 7 and 8"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "35c02da9f36b508a2128a6117d150426130d8323", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/35c02da9f36b508a2128a6117d150426130d8323", "committedDate": "2020-05-25T14:28:35Z", "message": "Add bootstrapping for Oracle Linux 6, 7 and 8"}, "afterCommit": {"oid": "d26a93970a3c54d042a2867f326c689cbafaffe2", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/d26a93970a3c54d042a2867f326c689cbafaffe2", "committedDate": "2020-05-25T15:09:12Z", "message": "Add bootstrapping for Oracle Linux 6, 7 and 8"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3NzY5NTkz", "url": "https://github.com/uyuni-project/uyuni/pull/2248#pullrequestreview-417769593", "createdAt": "2020-05-25T15:09:48Z", "commit": {"oid": "d26a93970a3c54d042a2867f326c689cbafaffe2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxNTowOTo0OFrOGaEEaA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQxNTowOTo0OFrOGaEEaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk4MjgyNA==", "bodyText": "This needs to be in this order because Oracle also has /etc/redhat-release.", "url": "https://github.com/uyuni-project/uyuni/pull/2248#discussion_r429982824", "createdAt": "2020-05-25T15:09:48Z", "author": {"login": "juliogonzalez"}, "path": "susemanager-utils/susemanager-sls/salt/bootstrap/init.sls", "diffHunk": "@@ -27,7 +27,9 @@ mgr_server_localhost_alias_absent:\n {% set bootstrap_repo_url = 'https://' ~ salt['pillar.get']('mgr_server') ~ '/pub/repositories/' ~ os_base ~ '/' ~ grains['osrelease'] ~ '/0/bootstrap/' %}\n {%- endif %}\n {%- elif grains['os_family'] == 'RedHat' %}\n-{% if salt['file.file_exists' ]('/etc/redhat-release') %}\n+{% if salt['file.file_exists' ]('/etc/oracle-release') %}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d26a93970a3c54d042a2867f326c689cbafaffe2"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30da7850927b5280b212ddf47a5560e1eacd423b", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/30da7850927b5280b212ddf47a5560e1eacd423b", "committedDate": "2020-05-25T20:57:58Z", "message": "Add bootstrapping for Oracle Linux 6, 7 and 8"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d26a93970a3c54d042a2867f326c689cbafaffe2", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/d26a93970a3c54d042a2867f326c689cbafaffe2", "committedDate": "2020-05-25T15:09:12Z", "message": "Add bootstrapping for Oracle Linux 6, 7 and 8"}, "afterCommit": {"oid": "30da7850927b5280b212ddf47a5560e1eacd423b", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/30da7850927b5280b212ddf47a5560e1eacd423b", "committedDate": "2020-05-25T20:57:58Z", "message": "Add bootstrapping for Oracle Linux 6, 7 and 8"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE3ODc1ODAy", "url": "https://github.com/uyuni-project/uyuni/pull/2248#pullrequestreview-417875802", "createdAt": "2020-05-25T21:06:29Z", "commit": {"oid": "30da7850927b5280b212ddf47a5560e1eacd423b"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQyMTowNjoyOVrOGaJq0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yNVQyMTowNjoyOVrOGaJq0g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDA3NDU3OA==", "bodyText": "For reference, I failed originally because I created Oracle*.sls files.\nHere are the grains from an Oracle Linux 8:\n    os:\n        OEL\n    os_family:\n        RedHat\n    osarch:\n        x86_64\n    oscodename:\n        Oracle Linux Server 8.2\n    osfinger:\n        Oracle Linux Server-8\n    osfullname:\n        Oracle Linux Server\n    osmajorrelease:\n        8\n    osrelease:\n        8.2\n    osrelease_info:\n        - 8\n        - 2", "url": "https://github.com/uyuni-project/uyuni/pull/2248#discussion_r430074578", "createdAt": "2020-05-25T21:06:29Z", "author": {"login": "juliogonzalez"}, "path": "susemanager-utils/susemanager-sls/salt/certs/OEL6.sls", "diffHunk": "@@ -0,0 +1 @@\n+RedHat6.sls", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30da7850927b5280b212ddf47a5560e1eacd423b"}, "originalPosition": 1}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5MDAwOTQ3", "url": "https://github.com/uyuni-project/uyuni/pull/2248#pullrequestreview-419000947", "createdAt": "2020-05-27T09:08:51Z", "commit": {"oid": "30da7850927b5280b212ddf47a5560e1eacd423b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1265, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}