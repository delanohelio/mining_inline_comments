{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMwMzI4MjEw", "number": 2953, "title": "spacewalk-java: Added RHEL build support. Simplified SPEC file.", "bodyText": "What does this PR change?\n\nAdded commons-jexl detection to java/buildconf/build-props.xml\nAdded RHEL8 build to SPEC file.\nMinimal simplification of the SPEC file.\n\nGUI diff\nNo difference.\n\n DONE\n\nDocumentation\n\n\nNo documentation needed: No functional change.\n\n\n DONE\n\n\nTest coverage\n\nNo tests: Tested during automatic build.\n\nBuild tested successfully with manual source modifications on CentOS 8 and LEAP 15.2.\nNotes on test:\n\nAfter test, source has been modified back.\nFor CentOS to build properly, you have to modify buildconf/build-prop.xml (until this is fixed):\nsed -i s'#commons-jexl#apache-commons-jexl/commons-jexl#' buildconf/build-props.xml\n\n\n DONE\n\nLinks\nFixes #\nTracks # add downstream PR, if any\n\n DONE\n\nChangelogs\nIf you don't need a changelog check, please mark this checkbox:\n\n No changelog needed\n\nIf you uncheck the checkbox after the PR is created, you will need to re-run changelog_test (see below)\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-12-01T14:09:30Z", "url": "https://github.com/uyuni-project/uyuni/pull/2953", "merged": true, "mergeCommit": {"oid": "2e55515f523109a39bedabd4ac9c78cc8339183f"}, "closed": true, "closedAt": "2020-12-05T13:04:30Z", "author": {"login": "sbluhm"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdi3rKXgFqTU0NDk0NTcwNA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdjMAdkgFqTU0NTU4NTgzNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ0OTQ1NzA0", "url": "https://github.com/uyuni-project/uyuni/pull/2953#pullrequestreview-544945704", "createdAt": "2020-12-04T13:11:54Z", "commit": {"oid": "4517f36b64b3eb1c21e14cdf3352aeaad3b13004"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMzoxMTo1NVrOH_QSqg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNFQxMzoxNzoxN1rOH_QfPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA4OTI1OA==", "bodyText": "This can be simplified as we have on SUSE now also apache-commons-el .\nI tried it and it works. Please remove jakarta-commons-el. It is not needed anymore.", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536089258", "createdAt": "2020-12-04T13:11:55Z", "author": {"login": "mcalmer"}, "path": "java/spacewalk-java.spec", "diffHunk": "@@ -32,34 +32,27 @@\n %define appdir          /srv/tomcat/webapps\n %define jardir          /srv/tomcat/webapps/rhn/WEB-INF/lib\n %define apache_group    www\n+%define salt_user-group    salt\n %define apache2         apache2\n-%define ehcache         ehcache >= 2.10.1\n-%define apache_commons_discovery   jakarta-commons-discovery\n-%define apache_commons_el          jakarta-commons-el\n-%define apache_commons_validator   jakarta-commons-validator\n %define java_version    11\n-%if 0%{?sle_version} > 150100\n-%define apache_commons_fileupload  apache-commons-fileupload\n-%define apache_commons_digester    apache-commons-digester\n-%define log4j                      log4j12\n-%else\n-%define apache_commons_fileupload  jakarta-commons-fileupload\n-%define apache_commons_digester    jakarta-commons-digester\n-%define log4j                      log4j\n-%endif\n %else\n %define appdir          %{_localstatedir}/lib/tomcat/webapps\n %define jardir          %{_localstatedir}/lib/tomcat/webapps/rhn/WEB-INF/lib\n %define apache_group    apache\n+%define salt_user_group root \n %define apache2         httpd\n-%define ehcache         ehcache-core >= 2.10.1\n-%define apache_commons_discovery   apache-commons-discovery\n-%define apache_commons_el          apache-commons-el\n-%define apache_commons_fileupload  apache-commons-fileupload\n-%define apache_commons_validator   apache-commons-validator\n %define java_version    1:11\n %endif\n \n+%define ehcache         ( mvn(net.sf.ehcache:ehcache-core) >= 2.10.1 or ehcache-core >= 2.10.1 or ehcache >= 2.10.1)\n+%define apache_commons_digester    (apache-commons-digester or jakarta-commons-digester)\n+%define apache_commons_discovery   (apache-commons-discovery or jakarta-commons-discovery)\n+%define apache_commons_el          (apache-commons-el or jakarta-commons-el)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4517f36b64b3eb1c21e14cdf3352aeaad3b13004"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MTY5Ng==", "bodyText": "In line 96 we have the same inside of a \"%if suse\". When this is also needed on CentOS, please remove it from above.", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536091696", "createdAt": "2020-12-04T13:15:59Z", "author": {"login": "mcalmer"}, "path": "java/spacewalk-java.spec", "diffHunk": "@@ -116,8 +111,14 @@ BuildRequires:  %{apache_commons_discovery}\n BuildRequires:  %{apache_commons_el}\n BuildRequires:  %{apache_commons_fileupload}\n BuildRequires:  %{apache_commons_validator}\n+%if 0%{?rhel} >= 8 || 0%{?fedora}\n+BuildRequires:  java-11-openjdk-devel\n+BuildRequires:\tmaven-javadoc-plugin\n+%else\n BuildRequires:  java-devel >= %{java_version}\n+%endif\n BuildRequires:  java-saml\n+BuildRequires:  javamail", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4517f36b64b3eb1c21e14cdf3352aeaad3b13004"}, "originalPosition": 67}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MjQ3OA==", "bodyText": "This BuildRequires exists already above. Maybe this should be just a \"Require\" ?", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536092478", "createdAt": "2020-12-04T13:17:17Z", "author": {"login": "mcalmer"}, "path": "java/spacewalk-java.spec", "diffHunk": "@@ -172,22 +173,26 @@ Requires:       c3p0 >= 0.9.1\n Requires:       cglib\n %if 0%{?suse_version}\n Requires:       classmate\n-Requires:       javamail\n %endif\n Requires:       cobbler >= 3.0.0\n Requires:       concurrent\n Requires:       dwr >= 3\n Requires:       %{ehcache}\n-Requires:       gnu-jaf\n+Requires:       (jaf or gnu-jaf)\n Requires:       google-gson >= 2.2.4\n Requires:       hibernate-commons-annotations\n Requires:       hibernate5\n Requires:       httpcomponents-client\n Requires:       ical4j\n Requires:       jade4j\n Requires:       %{apache_commons_digester}\n+%if 0%{?rhel} >= 8\n+BuildRequires:  java-11-openjdk", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4517f36b64b3eb1c21e14cdf3352aeaad3b13004"}, "originalPosition": 100}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4517f36b64b3eb1c21e14cdf3352aeaad3b13004", "author": {"user": {"login": "sbluhm", "name": "sbluhm"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4517f36b64b3eb1c21e14cdf3352aeaad3b13004", "committedDate": "2020-12-01T21:06:51Z", "message": "Added commons-jexl location for RHEL"}, "afterCommit": {"oid": "4a59781de07737fade3a863bd1ff0ebf280b124d", "author": {"user": {"login": "sbluhm", "name": "sbluhm"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4a59781de07737fade3a863bd1ff0ebf280b124d", "committedDate": "2020-12-04T15:09:38Z", "message": "spacewalk-java: Added RHEL build support. Simplified SPEC file."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4ecbef1b883fd9ac0ff25921248799a57ae4f1a0", "author": {"user": {"login": "sbluhm", "name": "sbluhm"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4ecbef1b883fd9ac0ff25921248799a57ae4f1a0", "committedDate": "2020-12-04T15:12:39Z", "message": "spacewalk-java: Added RHEL build support. Simplified SPEC file."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4a59781de07737fade3a863bd1ff0ebf280b124d", "author": {"user": {"login": "sbluhm", "name": "sbluhm"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4a59781de07737fade3a863bd1ff0ebf280b124d", "committedDate": "2020-12-04T15:09:38Z", "message": "spacewalk-java: Added RHEL build support. Simplified SPEC file."}, "afterCommit": {"oid": "4ecbef1b883fd9ac0ff25921248799a57ae4f1a0", "author": {"user": {"login": "sbluhm", "name": "sbluhm"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4ecbef1b883fd9ac0ff25921248799a57ae4f1a0", "committedDate": "2020-12-04T15:12:39Z", "message": "spacewalk-java: Added RHEL build support. Simplified SPEC file."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "328186d7c67d8d32edbdd4ecb6fe28f47d51da7a", "author": {"user": {"login": "sbluhm", "name": "sbluhm"}}, "url": "https://github.com/uyuni-project/uyuni/commit/328186d7c67d8d32edbdd4ecb6fe28f47d51da7a", "committedDate": "2020-12-04T15:26:03Z", "message": "Merge branch 'master' into sbluhm-spacewalk-java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NTgyMjg3", "url": "https://github.com/uyuni-project/uyuni/pull/2953#pullrequestreview-545582287", "createdAt": "2020-12-05T12:03:42Z", "commit": {"oid": "328186d7c67d8d32edbdd4ecb6fe28f47d51da7a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQxMjowMzo0MlrOH_2V1Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wNVQxMjowMzo1OFrOH_2Wag==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjcxMjY2MQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            BuildRequires:  apache_commons_el\n          \n          \n            \n            BuildRequires:  apache-commons-el", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536712661", "createdAt": "2020-12-05T12:03:42Z", "author": {"login": "mcalmer"}, "path": "java/spacewalk-java.spec", "diffHunk": "@@ -113,11 +106,17 @@ BuildRequires:  ical4j\n BuildRequires:  jade4j\n BuildRequires:  jaf\n BuildRequires:  %{apache_commons_discovery}\n-BuildRequires:  %{apache_commons_el}\n+BuildRequires:  apache_commons_el", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "328186d7c67d8d32edbdd4ecb6fe28f47d51da7a"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjcxMjgxMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            Requires:       apache_commons_el\n          \n          \n            \n            Requires:       apache-commons-el", "url": "https://github.com/uyuni-project/uyuni/pull/2953#discussion_r536712810", "createdAt": "2020-12-05T12:03:58Z", "author": {"login": "mcalmer"}, "path": "java/spacewalk-java.spec", "diffHunk": "@@ -211,7 +214,7 @@ Requires:       susemanager-docs_en\n Requires:       tomcat-taglibs-standard\n Requires(pre):  uyuni-base-server\n Requires:       %{apache_commons_discovery}\n-Requires:       %{apache_commons_el}\n+Requires:       apache_commons_el", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "328186d7c67d8d32edbdd4ecb6fe28f47d51da7a"}, "originalPosition": 125}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9928228a6d5c96526b8a24760a53a8ec29bc2a78", "author": {"user": {"login": "sbluhm", "name": "sbluhm"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9928228a6d5c96526b8a24760a53a8ec29bc2a78", "committedDate": "2020-12-05T12:23:11Z", "message": "Update java/spacewalk-java.spec\n\nCo-authored-by: Michael Calmer <Michael.Calmer@suse.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f10fb11c19c156f8f927109532fcdb070cb6755c", "author": {"user": {"login": "sbluhm", "name": "sbluhm"}}, "url": "https://github.com/uyuni-project/uyuni/commit/f10fb11c19c156f8f927109532fcdb070cb6755c", "committedDate": "2020-12-05T12:23:18Z", "message": "Update java/spacewalk-java.spec\n\nCo-authored-by: Michael Calmer <Michael.Calmer@suse.de>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ1NTg1ODM3", "url": "https://github.com/uyuni-project/uyuni/pull/2953#pullrequestreview-545585837", "createdAt": "2020-12-05T13:03:57Z", "commit": {"oid": "f10fb11c19c156f8f927109532fcdb070cb6755c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 790, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}