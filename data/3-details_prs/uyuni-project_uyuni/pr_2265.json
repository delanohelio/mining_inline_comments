{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI0MzU4Mjcz", "number": 2265, "title": "Implement selecting maintenance windows in Struts actions", "bodyText": "What does this PR change?\nImplement the maintenance window picker in Struts:\n\nbackend support: implement listing upcoming maintenance windows\nimplement the component in JSP\npopulate the component based on upcoming maint. windows for selected system(s) and action\nread the selected maint. window date time when user schedules an action\n\nIn order to implement that, the current date / maintenance window picker needed to be extended to accept more options (maintenance_window). After that, all places, where we populate the date picker and where we read from it were visited and enhanced with maint. window support.\nReview commit-by-commit.\nTODO:\n\n jUnit tests\n todos in the code\n corner cases:\n\n handle no maint. windows selected scenario (need to prevent the scheduling)\n reload the action chains editor on change\n\n\n more manual testing\n docs\n\nGUI diff\nBefore:\n\nAfter:\nSelect maint. windows:\n\nMaint. windows selector for action chain:\n\nMaint. windows picker hidden since systems in ssm have multiple schedules assigned:\n\n\n DONE\n\nDocumentation\nupdated SUSE/spacewalk#11254\n\n DONE\n\nTest coverage\n\n\nUnit tests were added\n\n\n DONE\n\n\nLinks\nTracks SUSE/spacewalk#11230\n\n DONE\n\nChangelogs\nIf you don't need a changelog check, please mark this checkbox:\n\n No changelog needed\n\nIf you uncheck the checkbox after the PR is created, you will need to re-run changelog_test (see below)\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_lint_checkstyle\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"ruby_rubocop\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-05-28T09:18:32Z", "url": "https://github.com/uyuni-project/uyuni/pull/2265", "merged": true, "mergeCommit": {"oid": "15a7a6ff0d4a4e90881db07cec19923c6c3cf9bb"}, "closed": true, "closedAt": "2020-06-15T05:48:36Z", "author": {"login": "hustodemon"}, "timelineItems": {"totalCount": 36, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclqZ6oABqjMzODE5MTM0MzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcp1OGmgBqjM0Mjg0MjU4OTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3654a177937287ef56f32971867bf8d2606c0719", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/3654a177937287ef56f32971867bf8d2606c0719", "committedDate": "2020-05-28T09:16:18Z", "message": "IMPORTANT: MOIO: Create the ServerAction after setting its parameters\n\nThis is because of the dat check in the ServerAction assignment."}, "afterCommit": {"oid": "9f3c145e21f8e8390f596f964be5136b7c5e6210", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9f3c145e21f8e8390f596f964be5136b7c5e6210", "committedDate": "2020-05-28T09:25:15Z", "message": "IMPORTANT: MOIO: Create the ServerAction after setting its parameters\n\nThis is because of the dat check in the ServerAction assignment."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9f3c145e21f8e8390f596f964be5136b7c5e6210", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9f3c145e21f8e8390f596f964be5136b7c5e6210", "committedDate": "2020-05-28T09:25:15Z", "message": "IMPORTANT: MOIO: Create the ServerAction after setting its parameters\n\nThis is because of the dat check in the ServerAction assignment."}, "afterCommit": {"oid": "6aa1371a725f43e016405fd94745fa404fefdfac", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/6aa1371a725f43e016405fd94745fa404fefdfac", "committedDate": "2020-05-28T09:26:23Z", "message": "IMPORTANT: MOIO: Create the ServerAction after setting its parameters\n\nThis is because of the dat check in the ServerAction assignment."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6aa1371a725f43e016405fd94745fa404fefdfac", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/6aa1371a725f43e016405fd94745fa404fefdfac", "committedDate": "2020-05-28T09:26:23Z", "message": "IMPORTANT: MOIO: Create the ServerAction after setting its parameters\n\nThis is because of the dat check in the ServerAction assignment."}, "afterCommit": {"oid": "ac983745d9b90ad50d10b91e21b9984eb1fcc037", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/ac983745d9b90ad50d10b91e21b9984eb1fcc037", "committedDate": "2020-05-28T09:27:08Z", "message": "IMPORTANT: MOIO: Create the ServerAction after setting its parameters\n\nThis is because of the dat check in the ServerAction assignment."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "86a88cd122f8700a156a5192a6b8362b85389e71", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/86a88cd122f8700a156a5192a6b8362b85389e71", "committedDate": "2020-05-28T09:29:14Z", "message": "Changelog"}, "afterCommit": {"oid": "e6bcf6b988a88daca8d4eb461e48235035cbac4d", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e6bcf6b988a88daca8d4eb461e48235035cbac4d", "committedDate": "2020-05-28T09:29:58Z", "message": "Changelog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwMDcxMTI0", "url": "https://github.com/uyuni-project/uyuni/pull/2265#pullrequestreview-420071124", "createdAt": "2020-05-28T12:47:56Z", "commit": {"oid": "e6bcf6b988a88daca8d4eb461e48235035cbac4d"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMjo0Nzo1NlrOGbzesw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOFQxMjo0Nzo1NlrOGbzesw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgwODE3OQ==", "bodyText": "empty() is not correct here, right? You need to check if schedules has a multi calendar and if yes, pass the schedule name to it.", "url": "https://github.com/uyuni-project/uyuni/pull/2265#discussion_r431808179", "createdAt": "2020-05-28T12:47:56Z", "author": {"login": "mcalmer"}, "path": "java/code/src/com/suse/manager/maintenance/MaintenanceManager.java", "diffHunk": "@@ -96,6 +106,101 @@ public static MaintenanceManager instance() {\n         return instance;\n     }\n \n+    /**\n+     * Given the systems and action type, return upcoming maintenance windows.\n+     *\n+     * The upper limit of returned maintenance windows is currently hardcoded to 10.\n+     *\n+     * If given action type is not maintenance-mode-only, return an empty optional.\n+     * If given systems do not have any maint. <b>schedules</b> assigned, return an empty optional.\n+     * If given systems have different maint. schedules assigned, throw an exception.\n+     * Otherwise return list of maintenance windows (the list can be empty, if the schedule does not contain\n+     * any upcoming maintenance windows).\n+     *\n+     * @param actionType the action type\n+     * @param systemIds the system ids\n+     * @return the optional upcoming maintenance windows\n+     * @throws IllegalStateException if two or more systems have different maint. schedules assigned\n+     */\n+    public Optional<List<Triple<String, String, Long>>> calculateUpcomingMaintenanceWindows(ActionType actionType,\n+            Set<Long> systemIds) throws IllegalStateException {\n+        // non-maintenance mode only don't use maint. windows\n+        if (!actionType.isMaintenancemodeOnly()) {\n+            return empty();\n+        }\n+\n+        Set<MaintenanceSchedule> schedules = MaintenanceManager.instance().listSchedulesOfSystems(systemIds);\n+        // if there are no schedules, we don't populate any windows (and display an empty list instead)\n+        if (schedules.isEmpty()) {\n+            return empty();\n+        }\n+\n+        // there are multiple schedules, we warn the user about it\n+        if (schedules.size() > 1) {\n+            throw new IllegalStateException(\"Multiple schedules\");\n+        }\n+\n+        PeriodList periods = schedules.iterator().next().getCalendarOpt()\n+                .flatMap(c -> parseCalendar(c))\n+                .map(c -> calculateUpcomingPeriodList(c, empty(), new Date(), 10))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e6bcf6b988a88daca8d4eb461e48235035cbac4d"}, "originalPosition": 105}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e6bcf6b988a88daca8d4eb461e48235035cbac4d", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e6bcf6b988a88daca8d4eb461e48235035cbac4d", "committedDate": "2020-05-28T09:29:58Z", "message": "Changelog"}, "afterCommit": {"oid": "e1faf0956bc32f12565855fe9940575c81feaa24", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e1faf0956bc32f12565855fe9940575c81feaa24", "committedDate": "2020-05-28T14:29:53Z", "message": "Changelog"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e1faf0956bc32f12565855fe9940575c81feaa24", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e1faf0956bc32f12565855fe9940575c81feaa24", "committedDate": "2020-05-28T14:29:53Z", "message": "Changelog"}, "afterCommit": {"oid": "c2031ba6464015309325d48797d3578c9bc263ce", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c2031ba6464015309325d48797d3578c9bc263ce", "committedDate": "2020-05-29T13:08:37Z", "message": "Changelog"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dd789b6ccedf96b356cf386b0337ddf6a5894f5e", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/dd789b6ccedf96b356cf386b0337ddf6a5894f5e", "committedDate": "2020-06-04T07:47:26Z", "message": "[wip]: MaintenanceWindowsAware interface"}, "afterCommit": {"oid": "ebf28b022205627da12df4c1123fb1a02edf1052", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/ebf28b022205627da12df4c1123fb1a02edf1052", "committedDate": "2020-06-08T10:34:51Z", "message": "Test computing upcoming windows from a calendar with multiple timezones"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ebf28b022205627da12df4c1123fb1a02edf1052", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/ebf28b022205627da12df4c1123fb1a02edf1052", "committedDate": "2020-06-08T10:34:51Z", "message": "Test computing upcoming windows from a calendar with multiple timezones"}, "afterCommit": {"oid": "9967f32a5838e488657eb706a55d68da390c106b", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9967f32a5838e488657eb706a55d68da390c106b", "committedDate": "2020-06-08T10:42:42Z", "message": "Test computing upcoming windows from a calendar with multiple timezones"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9967f32a5838e488657eb706a55d68da390c106b", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9967f32a5838e488657eb706a55d68da390c106b", "committedDate": "2020-06-08T10:42:42Z", "message": "Test computing upcoming windows from a calendar with multiple timezones"}, "afterCommit": {"oid": "f18415381bd7c8d85ec2396e9c23b0b0d4097950", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/f18415381bd7c8d85ec2396e9c23b0b0d4097950", "committedDate": "2020-06-08T10:44:50Z", "message": "Test computing upcoming windows from a calendar with multiple timezones"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f18415381bd7c8d85ec2396e9c23b0b0d4097950", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/f18415381bd7c8d85ec2396e9c23b0b0d4097950", "committedDate": "2020-06-08T10:44:50Z", "message": "Test computing upcoming windows from a calendar with multiple timezones"}, "afterCommit": {"oid": "0bbdfb4758399228fb303c6b6155750f09fe20be", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/0bbdfb4758399228fb303c6b6155750f09fe20be", "committedDate": "2020-06-08T15:50:54Z", "message": "Fix checkstyle violations"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI2Mzk1OTkw", "url": "https://github.com/uyuni-project/uyuni/pull/2265#pullrequestreview-426395990", "createdAt": "2020-06-08T16:10:25Z", "commit": {"oid": "07c89f10ba04a1072a5ca13be9e3091878fc66d1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNjoxMDoyNlrOGglrjA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOFQxNjoxMDoyNlrOGglrjA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjgyNDk3Mg==", "bodyText": "Note for the reviewer: I made the original class abstract and split the actual implementation into 2 concrete classes (above) since struts action using this class resulted in 2 different backend actions (diff or deploy).", "url": "https://github.com/uyuni-project/uyuni/pull/2265#discussion_r436824972", "createdAt": "2020-06-08T16:10:26Z", "author": {"login": "hustodemon"}, "path": "java/code/src/com/redhat/rhn/frontend/action/configuration/sdc/FileListConfirmSetupAction.java", "diffHunk": "@@ -30,13 +31,14 @@\n import org.apache.struts.action.DynaActionForm;\n \n import java.util.List;\n+import java.util.Set;\n \n \n /**\n  * FileListConfirmSetupAction, for sdc configuration\n  * @version $Rev$\n  */\n-public class FileListConfirmSetupAction extends BaseListAction {\n+public abstract class FileListConfirmSetupAction extends BaseListAction implements MaintenanceWindowsAware {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "07c89f10ba04a1072a5ca13be9e3091878fc66d1"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "91e8ed0561d7be270ff0ffdb2d0b3768bb1ca2d0", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/91e8ed0561d7be270ff0ffdb2d0b3768bb1ca2d0", "committedDate": "2020-06-08T16:18:50Z", "message": "Backend: Method for calculating upcoming maintenance windows"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed6470ae94f4b2bb6fdabc74a309163c1f493b1c", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/ed6470ae94f4b2bb6fdabc74a309163c1f493b1c", "committedDate": "2020-06-08T16:18:50Z", "message": "Test computing upcoming windows from a calendar with multiple timezones"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d27bf7c7ab246c773059619a6441138e1e56ffb0", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/d27bf7c7ab246c773059619a6441138e1e56ffb0", "committedDate": "2020-06-08T16:18:50Z", "message": "Struts: Refactor: USE_DATE -> SCHEDULE_TYPE field in the form\n\nThis will allow support of multiple action schedule selectors (not just\ndate picker and action chains)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cf07cb8248f9d04a24fbf71ad568e2d9148350e", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9cf07cb8248f9d04a24fbf71ad568e2d9148350e", "committedDate": "2020-06-08T16:18:50Z", "message": "JSP: Support for greying out date picker # Bitte geben Sie eine Commit-Beschreibung f\u00fcr Ihre \u00c4nderungen ein. Zeilen,"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e0e3c99a9cfb6bd89561ee3b1973778d8c5aa11", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/1e0e3c99a9cfb6bd89561ee3b1973778d8c5aa11", "committedDate": "2020-06-08T16:18:50Z", "message": "JSP: Implement maintenance window picker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0295573dea49b8654f700a22a0debe2d5a6cbe82", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/0295573dea49b8654f700a22a0debe2d5a6cbe82", "committedDate": "2020-06-08T16:18:50Z", "message": "Struts: Support reading maint. window date from the dynaForm"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e545294be42ac1f576779ff298a4df7753157beb", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e545294be42ac1f576779ff298a4df7753157beb", "committedDate": "2020-06-08T16:18:51Z", "message": "Struts: Support maintenance windows in Actions [1/2]: Populate the maintenance window picker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c05acba712e454dcc3f7ae71982120b2924b8a7b", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c05acba712e454dcc3f7ae71982120b2924b8a7b", "committedDate": "2020-06-08T16:18:51Z", "message": "Struts: Support maintenance windows in Actions [2/2]: Read schedule date from maintenance window picker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "46bf7cce4feefb30689b7780fa75512ec3d32deb", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/46bf7cce4feefb30689b7780fa75512ec3d32deb", "committedDate": "2020-06-08T16:18:51Z", "message": "Struts: Support maintenance windows for action chains"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7bb1bdcb71b8ab8a9b8876f74f7214244b454903", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/7bb1bdcb71b8ab8a9b8876f74f7214244b454903", "committedDate": "2020-06-08T16:18:51Z", "message": "Localization"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0bbdfb4758399228fb303c6b6155750f09fe20be", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/0bbdfb4758399228fb303c6b6155750f09fe20be", "committedDate": "2020-06-08T15:50:54Z", "message": "Fix checkstyle violations"}, "afterCommit": {"oid": "5891e963a80c4391944fa05ef594d4a93929a12a", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/5891e963a80c4391944fa05ef594d4a93929a12a", "committedDate": "2020-06-08T16:18:51Z", "message": "Fix checkstyle violations"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MDU3MDk4", "url": "https://github.com/uyuni-project/uyuni/pull/2265#pullrequestreview-427057098", "createdAt": "2020-06-09T11:47:34Z", "commit": {"oid": "91e8ed0561d7be270ff0ffdb2d0b3768bb1ca2d0"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMTo0NzozNFrOGhFf_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMjowMjoxMFrOGhF99g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM0NjMwMQ==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public String formatDate(Instant instant) {\n          \n          \n            \n                    Context ctx = Context.getCurrentContext();\n          \n          \n            \n                    Date date = Date.from(instant);\n          \n          \n            \n                    return formatDate(date, ctx.getLocale());\n          \n          \n            \n                }\n          \n          \n            \n                public String formatDate(Instant instant) {\n          \n          \n            \n                    return formatDate(Date.from(instant));\n          \n          \n            \n                }\n          \n      \n    \n    \n  \n\nMaybe this?", "url": "https://github.com/uyuni-project/uyuni/pull/2265#discussion_r437346301", "createdAt": "2020-06-09T11:47:34Z", "author": {"login": "mcalmer"}, "path": "java/code/src/com/redhat/rhn/common/localization/LocalizationService.java", "diffHunk": "@@ -393,6 +394,17 @@ public String formatDate(Date date) {\n         return formatDate(date, ctx.getLocale());\n     }\n \n+    /**\n+     * Format the instant and let the service determine the locale\n+     * @param instant the instant\n+     * @return String representation of given date.\n+     */\n+    public String formatDate(Instant instant) {\n+        Context ctx = Context.getCurrentContext();\n+        Date date = Date.from(instant);\n+        return formatDate(date, ctx.getLocale());\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "91e8ed0561d7be270ff0ffdb2d0b3768bb1ca2d0"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzM1Mzk3NA==", "bodyText": "They need to be copied over to all other language files.\nBut we can also decide to do it later on the maintenance-windows branch", "url": "https://github.com/uyuni-project/uyuni/pull/2265#discussion_r437353974", "createdAt": "2020-06-09T12:02:10Z", "author": {"login": "mcalmer"}, "path": "java/code/src/com/redhat/rhn/frontend/strings/jsp/StringResource_en_US.xml", "diffHunk": "@@ -6157,6 +6157,15 @@ organization. You may grant or remove the organization administrator role in the\n           <context context-type=\"sourcefile\">/rhn/systems/details/packages/ScheduleRemoteCommand.do</context>\n         </context-group>\n       </trans-unit>\n+      <trans-unit id=\"schedule.jsp.maint-window\">\n+        <source>Maintenance window:</source>\n+      </trans-unit>\n+      <trans-unit id=\"schedule.jsp.multiple_maintenance_schedules\">\n+        <source>There are multiple maintenance schedules for selected systems. Make sure that systems in the set use at most 1 maintenance schedule if you want to schedule by date or maintenance window.</source>\n+      </trans-unit>\n+      <trans-unit id=\"schedule.jsp.no_maintenance_windows\">\n+        <source>No upcoming maintenance windows</source>\n+      </trans-unit>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7bb1bdcb71b8ab8a9b8876f74f7214244b454903"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI3MTYxNzMy", "url": "https://github.com/uyuni-project/uyuni/pull/2265#pullrequestreview-427161732", "createdAt": "2020-06-09T13:41:18Z", "commit": {"oid": "1e0e3c99a9cfb6bd89561ee3b1973778d8c5aa11"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxMzo0MToxOFrOGhKXcA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wOVQxNDo1Mjo1MlrOGhOCzg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQyNjAzMg==", "bodyText": "Minor nitpick: don -> do", "url": "https://github.com/uyuni-project/uyuni/pull/2265#discussion_r437426032", "createdAt": "2020-06-09T13:41:18Z", "author": {"login": "parlt91"}, "path": "java/code/webapp/WEB-INF/pages/common/fragments/schedule-options.jspf", "diffHunk": "@@ -1,27 +1,50 @@\n <%@ page pageEncoding=\"iso-8859-1\" contentType=\"text/html;charset=utf-8\" %>\n+<%@ taglib uri=\"http://java.sun.com/jsp/jstl/core\" prefix=\"c\" %>\n <%@ taglib uri=\"http://struts.apache.org/tags-bean\" prefix=\"bean\" %>\n <%@ taglib uri=\"http://rhn.redhat.com/rhn\" prefix=\"rhn\" %>\n \n <script type=\"text/javascript\" src=\"/javascript/schedule-options.js?cb=${rhn:getConfig('web.buildtimestamp')}\"></script>\n <div class=\"spacewalk-scheduler\">\n     <div class=\"form-horizontal\">\n+        <c:choose>\n+            <%-- When there are multiple schedules, we don not display date picker nor the maint. window picker --%>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1e0e3c99a9cfb6bd89561ee3b1973778d8c5aa11"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzQ4NjI4Ng==", "bodyText": "Same typo here", "url": "https://github.com/uyuni-project/uyuni/pull/2265#discussion_r437486286", "createdAt": "2020-06-09T14:52:52Z", "author": {"login": "parlt91"}, "path": "java/code/webapp/WEB-INF/pages/schedule/actionchain.jsp", "diffHunk": "@@ -97,31 +97,54 @@\n         <div class=\"panel-body\">\n             <form action=\"/rhn/schedule/ActionChain.do?id=${param.id}\" method=\"post\" class=\"schedule\">\n             <div class=\"form-horizontal\">\n-                <div class=\"form-group\">\n-                    <div class=\"col-sm-12\">\n-                        <p>\n-                            <bean:message key=\"actionchain.jsp.schedulesummary\"/>\n-                        </p>\n-                    </div>\n-                </div>\n-                <div class=\"form-group\">\n-                    <rhn:hidden name=\"schedule_type\" value=\"date\"/>\n-                    <html:hidden property=\"dispatch\" value=\"${rhn:localize('actionchain.jsp.saveandschedule')}\"/>\n-                    <rhn:csrf/>\n-                    <rhn:submitted/>\n-                    <div class=\"col-md-offset-3 col-md-6\">\n-                        <jsp:include page=\"/WEB-INF/pages/common/fragments/date-picker.jsp\">\n-                            <jsp:param name=\"widget\" value=\"date\"/>\n-                        </jsp:include>\n-                    </div>\n-                </div>\n-                <div class=\"form-group\">\n-                    <div class=\"col-md-offset-3 col-md-6\">\n-                        <button type=\"button\" class=\"btn btn-success\" id=\"save-and-schedule\">\n-                            <bean:message key=\"actionchain.jsp.saveandschedule\"/>\n-                        </button>\n-                    </div>\n-                </div>\n+                <html:hidden property=\"dispatch\" value=\"${rhn:localize('actionchain.jsp.saveandschedule')}\"/>\n+                <rhn:csrf/>\n+                <rhn:submitted/>\n+\n+                <c:choose>\n+                    <%-- When there are multiple schedules, we don not display date picker nor the maint. window picker --%>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "46bf7cce4feefb30689b7780fa75512ec3d32deb"}, "originalPosition": 34}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "33724e1a0701434cbb767577182c2770ed85a664", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/33724e1a0701434cbb767577182c2770ed85a664", "committedDate": "2020-06-10T06:38:00Z", "message": "Reload action chain editor, when dealing with maintenance windows\n\nWe want to display either date picker/maintenance windows picker/warning\nbased on the systems and scheduled actions. When the systems change\n(user clicks delete system or delete action), we want to reload the\npage, so that the picker gets refreshed."}, "afterCommit": {"oid": "fd02d6367fe34941ba9a74ddfcbf55a526ef0451", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/fd02d6367fe34941ba9a74ddfcbf55a526ef0451", "committedDate": "2020-06-10T06:44:43Z", "message": "Reload action chain editor, when dealing with maintenance windows\n\nWe want to display either date picker/maintenance windows picker/warning\nbased on the systems and scheduled actions. When the systems change\n(user clicks delete system or delete action), we want to reload the\npage, so that the picker gets refreshed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb51a3ef2c16bf3887458ee98efadd12cc102fc2", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/eb51a3ef2c16bf3887458ee98efadd12cc102fc2", "committedDate": "2020-06-10T08:16:52Z", "message": "Create the ServerAction after setting its parameters\n\nThis is because of the date check in the ServerAction assignment."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "390fcf1829f139a89188e541e953bf1a8b903e75", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/390fcf1829f139a89188e541e953bf1a8b903e75", "committedDate": "2020-06-10T08:17:00Z", "message": "Changelog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b8ff228e985b4d112b259c2bd5d48e0f947626cb", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/b8ff228e985b4d112b259c2bd5d48e0f947626cb", "committedDate": "2020-06-10T08:17:00Z", "message": "Fix checkstyle violations"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37342d04aac3da822c5d823bedf26372afe33970", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/37342d04aac3da822c5d823bedf26372afe33970", "committedDate": "2020-06-10T08:17:00Z", "message": "Use review suggestion for formatting instant\n\nCo-authored-by: Michael Calmer <Michael.Calmer@suse.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e0ec041b98f377e620d6598ee21924f15ec46517", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e0ec041b98f377e620d6598ee21924f15ec46517", "committedDate": "2020-06-10T08:17:00Z", "message": "Fix typos"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fec57bbd97fd7d0a8bf0208824a0a2205377bf47", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/fec57bbd97fd7d0a8bf0208824a0a2205377bf47", "committedDate": "2020-06-10T08:17:00Z", "message": "Reload action chain editor, when dealing with maintenance windows\n\nWe want to display either date picker/maintenance windows picker/warning\nbased on the systems and scheduled actions. When the systems change\n(user clicks delete system or delete action), we want to reload the\npage, so that the picker gets refreshed."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7dafb94f7d0a9c0e5d29f992ec9c9308009a26fd", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/7dafb94f7d0a9c0e5d29f992ec9c9308009a26fd", "committedDate": "2020-06-10T08:17:00Z", "message": "Prevent scheduling actions when there are empty maintenance windows\n\nIn this case, display a warning to the user and hide the scheduling UI.\n\nThe maintenance-window-picker.jsp could be simplified: it's displayed,\nonly if the maintenance windows are non-empty (therefore the check in it\nwas unneeded)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2c560b660441fde9c96f9179925240a6e4cfd667", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/2c560b660441fde9c96f9179925240a6e4cfd667", "committedDate": "2020-06-10T08:17:00Z", "message": "Minor improvement: Maint. window caption in action chains scheduler"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8341c84534bfd1b2ed45ebb51e9c3e029772595", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e8341c84534bfd1b2ed45ebb51e9c3e029772595", "committedDate": "2020-06-10T08:17:00Z", "message": "Minor: Pre-check the maint. windows radio button when displaying the maint. windows picker"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fd7f3114a01b688eb93f5f45966ca60178a8008a", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/fd7f3114a01b688eb93f5f45966ca60178a8008a", "committedDate": "2020-06-10T07:26:45Z", "message": "Minor: Pre-check the maint. windows radio button when displaying the maint. windows picker"}, "afterCommit": {"oid": "e8341c84534bfd1b2ed45ebb51e9c3e029772595", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e8341c84534bfd1b2ed45ebb51e9c3e029772595", "committedDate": "2020-06-10T08:17:00Z", "message": "Minor: Pre-check the maint. windows radio button when displaying the maint. windows picker"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1278, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}