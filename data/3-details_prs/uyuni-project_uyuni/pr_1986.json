{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg0MzAwMTA4", "number": 1986, "title": "Virt pool stop", "bodyText": "What does this PR change?\nAdd virtual pool stop action\nGUI diff\nAfter:\nA Stop button has been added to the virtual pool actions\n\n DONE\n\nDocumentation\n\n\nuyuni-docs PR or issue was created for all pool actions\n\n\n DONE\n\n\nTest coverage\n\n\nUnit tests were added\n\n\nCucumber tests were added\n\n\n DONE\n\n\nLinks\nFixes #\nTracks # add downstream PR, if any\n\n DONE\n\nChangelogs\nIf you don't need a changelog check, please mark this checkbox:\n\n No changelog needed\n\nIf you uncheck the checkbox after the PR is created, you will need to re-run changelog_test (see below)\nTo avoid cluttering the changelog there is one commit adding changelog entry for all storage pool actions coming in an upcoming PR.\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_lint_checkstyle\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"ruby_rubocop\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-03-05T14:14:54Z", "url": "https://github.com/uyuni-project/uyuni/pull/1986", "merged": true, "mergeCommit": {"oid": "063bc54e19d45adbd9e6e36cfac3f7970680c8f4"}, "closed": true, "closedAt": "2020-03-23T10:58:25Z", "author": {"login": "cbosdo"}, "timelineItems": {"totalCount": 20, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKt7xCABqjMxMDE4OTcyMTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcQcJJOABqjMxNTQ2Nzk1MDY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c0c24b0761a5cc607d350f3c060dde3f323f2b75", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c0c24b0761a5cc607d350f3c060dde3f323f2b75", "committedDate": "2020-03-05T14:13:04Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "22e558f1e45132814cbe00755977471238dcf40a", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/22e558f1e45132814cbe00755977471238dcf40a", "committedDate": "2020-03-05T16:16:09Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "22e558f1e45132814cbe00755977471238dcf40a", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/22e558f1e45132814cbe00755977471238dcf40a", "committedDate": "2020-03-05T16:16:09Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "6045325f95432bba184fd05956956944577f9ec8", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/6045325f95432bba184fd05956956944577f9ec8", "committedDate": "2020-03-05T17:20:39Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6045325f95432bba184fd05956956944577f9ec8", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/6045325f95432bba184fd05956956944577f9ec8", "committedDate": "2020-03-05T17:20:39Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "b9045fc03706eeadf27725f5597fc05fdd902a70", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/b9045fc03706eeadf27725f5597fc05fdd902a70", "committedDate": "2020-03-06T13:40:46Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b9045fc03706eeadf27725f5597fc05fdd902a70", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/b9045fc03706eeadf27725f5597fc05fdd902a70", "committedDate": "2020-03-06T13:40:46Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "42c8651180cc0669f0ebb3f2f24ee79c4e81c50f", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/42c8651180cc0669f0ebb3f2f24ee79c4e81c50f", "committedDate": "2020-03-09T13:57:19Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "42c8651180cc0669f0ebb3f2f24ee79c4e81c50f", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/42c8651180cc0669f0ebb3f2f24ee79c4e81c50f", "committedDate": "2020-03-09T13:57:19Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "25e4eca92f7762ca9515b5a40d9a82b31d557ed3", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/25e4eca92f7762ca9515b5a40d9a82b31d557ed3", "committedDate": "2020-03-09T16:57:45Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "25e4eca92f7762ca9515b5a40d9a82b31d557ed3", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/25e4eca92f7762ca9515b5a40d9a82b31d557ed3", "committedDate": "2020-03-09T16:57:45Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "5b8009d2b22709365f3e94214da047980548447f", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/5b8009d2b22709365f3e94214da047980548447f", "committedDate": "2020-03-10T10:12:10Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNjM2NTEy", "url": "https://github.com/uyuni-project/uyuni/pull/1986#pullrequestreview-372636512", "createdAt": "2020-03-11T10:30:11Z", "commit": {"oid": "5b8009d2b22709365f3e94214da047980548447f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMDozMDoxMVrOF0xLgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMDozMDo1NFrOF0xNIA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg3NjAzNQ==", "bodyText": "\"When\" please", "url": "https://github.com/uyuni-project/uyuni/pull/1986#discussion_r390876035", "createdAt": "2020-03-11T10:30:11Z", "author": {"login": "Bischoff"}, "path": "testsuite/features/step_definitions/common_steps.rb", "diffHunk": "@@ -461,6 +461,24 @@\n   raise \"xpath: #{xpath} not found\" unless find(:xpath, xpath).set(true)\n end\n \n+When(/I wait until the tree item \"([^\"]+)\" has no sub-list/) do |item|\n+  repeat_until_timeout(message: \"could still find a sub list for tree item #{item}\") do\n+    xpath = \"//span[contains(text(), '#{item}')]/ancestor::div[contains(@class, 'product-details-wrapper')]/div/i[contains(@class, 'fa-angle-')]\"\n+    begin\n+      find(:xpath, xpath)\n+      sleep 1\n+    rescue Capybara::ElementNotFound\n+      break\n+    end\n+  end\n+end\n+\n+And(/^I wait until the tree item \"([^\"]+)\" contains \"([^\"]+)\" text$/) do |item, text|", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b8009d2b22709365f3e94214da047980548447f"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg3NjI0NQ==", "bodyText": "Could be \"And\"", "url": "https://github.com/uyuni-project/uyuni/pull/1986#discussion_r390876245", "createdAt": "2020-03-11T10:30:32Z", "author": {"login": "Bischoff"}, "path": "testsuite/features/secondary/minkvm_guests.feature", "diffHunk": "@@ -194,6 +194,27 @@ Feature: Be able to manage KVM virtual machines via the GUI\n     And I click on \"Delete\" in \"Delete Guest\" modal\n     Then I should not see a \"test-vm2\" virtual machine on \"kvm_server\"\n \n+@virthost_kvm\n+  Scenario: Refresh a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Refresh\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" has no sub-list", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b8009d2b22709365f3e94214da047980548447f"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg3NjMzMA==", "bodyText": "Same.", "url": "https://github.com/uyuni-project/uyuni/pull/1986#discussion_r390876330", "createdAt": "2020-03-11T10:30:42Z", "author": {"login": "Bischoff"}, "path": "testsuite/features/secondary/minkvm_guests.feature", "diffHunk": "@@ -194,6 +194,27 @@ Feature: Be able to manage KVM virtual machines via the GUI\n     And I click on \"Delete\" in \"Delete Guest\" modal\n     Then I should not see a \"test-vm2\" virtual machine on \"kvm_server\"\n \n+@virthost_kvm\n+  Scenario: Refresh a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Refresh\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" has no sub-list\n+\n+@virthost_kvm\n+  Scenario: Stop a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Stop\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" contains \"inactive\" text", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b8009d2b22709365f3e94214da047980548447f"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDg3NjQ0OA==", "bodyText": "Same.", "url": "https://github.com/uyuni-project/uyuni/pull/1986#discussion_r390876448", "createdAt": "2020-03-11T10:30:54Z", "author": {"login": "Bischoff"}, "path": "testsuite/features/secondary/minkvm_guests.feature", "diffHunk": "@@ -194,6 +194,27 @@ Feature: Be able to manage KVM virtual machines via the GUI\n     And I click on \"Delete\" in \"Delete Guest\" modal\n     Then I should not see a \"test-vm2\" virtual machine on \"kvm_server\"\n \n+@virthost_kvm\n+  Scenario: Refresh a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Refresh\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" has no sub-list\n+\n+@virthost_kvm\n+  Scenario: Stop a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Stop\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" contains \"inactive\" text\n+\n+@virthost_kvm\n+  Scenario: Start a virtual storage pool for KVM\n+    Given I am on the \"Virtualization\" page of this \"kvm_server\"\n+    When I follow \"Storage\"\n+    And I click on \"Start\" in tree item \"test-pool0\"\n+    Then I wait until the tree item \"test-pool0\" contains \"running\" text", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5b8009d2b22709365f3e94214da047980548447f"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5b8009d2b22709365f3e94214da047980548447f", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/5b8009d2b22709365f3e94214da047980548447f", "committedDate": "2020-03-10T10:12:10Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "754a5fb0d16533a32361c609df8e440de9d26e46", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/754a5fb0d16533a32361c609df8e440de9d26e46", "committedDate": "2020-03-11T15:44:59Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "754a5fb0d16533a32361c609df8e440de9d26e46", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/754a5fb0d16533a32361c609df8e440de9d26e46", "committedDate": "2020-03-11T15:44:59Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "a83530febfc7464322eb977207df987e02d39a29", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/a83530febfc7464322eb977207df987e02d39a29", "committedDate": "2020-03-11T16:21:18Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a83530febfc7464322eb977207df987e02d39a29", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/a83530febfc7464322eb977207df987e02d39a29", "committedDate": "2020-03-11T16:21:18Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "a4f3e8835945df4dfa4b9439527f6a99b3f969a9", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/a4f3e8835945df4dfa4b9439527f6a99b3f969a9", "committedDate": "2020-03-12T07:17:10Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a4f3e8835945df4dfa4b9439527f6a99b3f969a9", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/a4f3e8835945df4dfa4b9439527f6a99b3f969a9", "committedDate": "2020-03-12T07:17:10Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "8d7874bbac2581397f9be6795f48173e28cdd3fc", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8d7874bbac2581397f9be6795f48173e28cdd3fc", "committedDate": "2020-03-12T12:39:50Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d7874bbac2581397f9be6795f48173e28cdd3fc", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8d7874bbac2581397f9be6795f48173e28cdd3fc", "committedDate": "2020-03-12T12:39:50Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "5599ac3a0add54965cea46eac5be3942c5884ae7", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/5599ac3a0add54965cea46eac5be3942c5884ae7", "committedDate": "2020-03-13T15:59:58Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc1NDY2OTAy", "url": "https://github.com/uyuni-project/uyuni/pull/1986#pullrequestreview-375466902", "createdAt": "2020-03-16T18:07:50Z", "commit": {"oid": "5599ac3a0add54965cea46eac5be3942c5884ae7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5599ac3a0add54965cea46eac5be3942c5884ae7", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/5599ac3a0add54965cea46eac5be3942c5884ae7", "committedDate": "2020-03-13T15:59:58Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "2fcb8b6bacc710eac8cd8698f15058d5797b9255", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/2fcb8b6bacc710eac8cd8698f15058d5797b9255", "committedDate": "2020-03-23T10:11:16Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb73e7ff579587ec2e82e1652523fc3288699aec", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/fb73e7ff579587ec2e82e1652523fc3288699aec", "committedDate": "2020-03-23T10:55:58Z", "message": "Add virtual pool stop action"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77940af3dcc4b80b725090e03013a819fcb5aea1", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/77940af3dcc4b80b725090e03013a819fcb5aea1", "committedDate": "2020-03-23T10:55:58Z", "message": "Add Salt implementation for virtual pool stop action"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be069a9f7c753c28c7de6500678e4a86d43df31b", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/be069a9f7c753c28c7de6500678e4a86d43df31b", "committedDate": "2020-03-23T10:55:58Z", "message": "Add REST API to trigger virtual pool stop action"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bfc8c7dc1c3ac07db740bcaf15117e638064f28a", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/bfc8c7dc1c3ac07db740bcaf15117e638064f28a", "committedDate": "2020-03-23T10:55:58Z", "message": "Add cucumber step watching over text to appear in a tree item"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0bec74822a000127d14fe63618ef3a6fb48e999", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/a0bec74822a000127d14fe63618ef3a6fb48e999", "committedDate": "2020-03-23T10:55:58Z", "message": "Add virtual pool stop action UI and cucumber test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2fcb8b6bacc710eac8cd8698f15058d5797b9255", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/2fcb8b6bacc710eac8cd8698f15058d5797b9255", "committedDate": "2020-03-23T10:11:16Z", "message": "Add virtual pool stop action UI and cucumber test"}, "afterCommit": {"oid": "a0bec74822a000127d14fe63618ef3a6fb48e999", "author": {"user": {"login": "cbosdo", "name": "Cedric Bosdonnat"}}, "url": "https://github.com/uyuni-project/uyuni/commit/a0bec74822a000127d14fe63618ef3a6fb48e999", "committedDate": "2020-03-23T10:55:58Z", "message": "Add virtual pool stop action UI and cucumber test"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1625, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}