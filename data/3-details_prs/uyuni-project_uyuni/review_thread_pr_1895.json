{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzczMTIwMjIy", "number": 1895, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMTo0MzoxNlrODkPKmw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNDoxNzoxNlrODkSEZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5MzIzODAzOnYy", "diffSide": "RIGHT", "path": "schema/spacewalk/common/views/rhnServerOverview.sql", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMTo0MzoxNlrOFwcoMQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNDoxMzowOVrOFwg5gA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM0NTAwOQ==", "bodyText": "I think you need to use coalesce here as well. In case it is not a proxy you would get \"NULL\".\nAs far as I can see, the jsp did not work wil NULL value here. Or did you test it?\nDo you really need the ID, or just a \"yes/no\". As you use this value with PROXY_ID AS IS_RHN_PROXY\nit sounds like 1/0 would be enough.", "url": "https://github.com/uyuni-project/uyuni/pull/1895#discussion_r386345009", "createdAt": "2020-03-02T11:43:16Z", "author": {"login": "mcalmer"}, "path": "schema/spacewalk/common/views/rhnServerOverview.sql", "diffHunk": "@@ -109,7 +110,8 @@ select\n     os,\n     release,\n     ( select name from rhnServerArch where id = s.server_arch_id),\n-    coalesce((select 1 from rhnServerLock SL WHERE SL.server_id = S.id), 0)\n+    coalesce((select 1 from rhnServerLock SL WHERE SL.server_id = S.id), 0),\n+    ( select pxy.server_Id from rhnProxyInfo pxy where pxy.server_id = S.id)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9ab09988c5f7d72307accf9bab2713ad40e59e7d"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM3NDEzMg==", "bodyText": "Yes, I tested, the screenshot was taken from a properly working setup with this patch. The reason why I fetch the info in this way is because it was already designed to be like that, you can see it here : this is the DTO used to be populated by the rhnServerOverview view called from here", "url": "https://github.com/uyuni-project/uyuni/pull/1895#discussion_r386374132", "createdAt": "2020-03-02T12:52:25Z", "author": {"login": "ncounter"}, "path": "schema/spacewalk/common/views/rhnServerOverview.sql", "diffHunk": "@@ -109,7 +110,8 @@ select\n     os,\n     release,\n     ( select name from rhnServerArch where id = s.server_arch_id),\n-    coalesce((select 1 from rhnServerLock SL WHERE SL.server_id = S.id), 0)\n+    coalesce((select 1 from rhnServerLock SL WHERE SL.server_id = S.id), 0),\n+    ( select pxy.server_Id from rhnProxyInfo pxy where pxy.server_id = S.id)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM0NTAwOQ=="}, "originalCommit": {"oid": "9ab09988c5f7d72307accf9bab2713ad40e59e7d"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQxNDk3Ng==", "bodyText": "ok", "url": "https://github.com/uyuni-project/uyuni/pull/1895#discussion_r386414976", "createdAt": "2020-03-02T14:13:09Z", "author": {"login": "mcalmer"}, "path": "schema/spacewalk/common/views/rhnServerOverview.sql", "diffHunk": "@@ -109,7 +110,8 @@ select\n     os,\n     release,\n     ( select name from rhnServerArch where id = s.server_arch_id),\n-    coalesce((select 1 from rhnServerLock SL WHERE SL.server_id = S.id), 0)\n+    coalesce((select 1 from rhnServerLock SL WHERE SL.server_id = S.id), 0),\n+    ( select pxy.server_Id from rhnProxyInfo pxy where pxy.server_id = S.id)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM0NTAwOQ=="}, "originalCommit": {"oid": "9ab09988c5f7d72307accf9bab2713ad40e59e7d"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5MzI0NzAzOnYy", "diffSide": "RIGHT", "path": "java/code/webapp/WEB-INF/pages/common/fragments/systems/system_list_fragment.jspf", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxMTo0NjozN1rOFwctrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNDoxMzoyM1rOFwg5-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM0NjQxNQ==", "bodyText": "Not sure if this works when current.rhnProxy is empty. Have you tested it?", "url": "https://github.com/uyuni-project/uyuni/pull/1895#discussion_r386346415", "createdAt": "2020-03-02T11:46:37Z", "author": {"login": "mcalmer"}, "path": "java/code/webapp/WEB-INF/pages/common/fragments/systems/system_list_fragment.jspf", "diffHunk": "@@ -14,6 +15,10 @@\n   </c:otherwise>\n </c:choose>\n \n+<c:if test=\"${current.rhnProxy}\">", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "24d08d5f7c15c1d8f77b4f4ec494ccef03aaf6e5"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM3NDkxOA==", "bodyText": "Yes, like the other comment, it was tested manually and the screenshot taken from it. The reason is because of the DTO format I didn't want to change", "url": "https://github.com/uyuni-project/uyuni/pull/1895#discussion_r386374918", "createdAt": "2020-03-02T12:54:01Z", "author": {"login": "ncounter"}, "path": "java/code/webapp/WEB-INF/pages/common/fragments/systems/system_list_fragment.jspf", "diffHunk": "@@ -14,6 +15,10 @@\n   </c:otherwise>\n </c:choose>\n \n+<c:if test=\"${current.rhnProxy}\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM0NjQxNQ=="}, "originalCommit": {"oid": "24d08d5f7c15c1d8f77b4f4ec494ccef03aaf6e5"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQxNTA5OQ==", "bodyText": "ok", "url": "https://github.com/uyuni-project/uyuni/pull/1895#discussion_r386415099", "createdAt": "2020-03-02T14:13:23Z", "author": {"login": "mcalmer"}, "path": "java/code/webapp/WEB-INF/pages/common/fragments/systems/system_list_fragment.jspf", "diffHunk": "@@ -14,6 +15,10 @@\n   </c:otherwise>\n </c:choose>\n \n+<c:if test=\"${current.rhnProxy}\">", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjM0NjQxNQ=="}, "originalCommit": {"oid": "24d08d5f7c15c1d8f77b4f4ec494ccef03aaf6e5"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5MzcxMzY2OnYy", "diffSide": "RIGHT", "path": "schema/spacewalk/upgrade/susemanager-schema-4.1.3-to-susemanager-schema-4.1.4/005-rhnServerOverview.sql", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNDoxNzoxNlrOFwhCgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wMlQxNDoxNzoxNlrOFwhCgQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjQxNzI4MQ==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            drop view rhnServerOverview;\n          \n          \n            \n            drop view if exists rhnServerOverview;", "url": "https://github.com/uyuni-project/uyuni/pull/1895#discussion_r386417281", "createdAt": "2020-03-02T14:17:16Z", "author": {"login": "mcalmer"}, "path": "schema/spacewalk/upgrade/susemanager-schema-4.1.3-to-susemanager-schema-4.1.4/005-rhnServerOverview.sql", "diffHunk": "@@ -0,0 +1,101 @@\n+drop view rhnServerOverview;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d2235eb9de057a17541de7b1b630ef1ebc13301"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 152, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}