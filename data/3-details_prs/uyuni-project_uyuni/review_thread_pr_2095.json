{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk4MTc0NDI3", "number": 2095, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMDoxOToxNFrODvD9Ww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMToxMDowMFrODvTmWw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwNjc0NTIzOnYy", "diffSide": "RIGHT", "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMDoxOToxNFrOGBRFYw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMDoxOToxNFrOGBRFYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk4MTY2Nw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r403981667", "createdAt": "2020-04-06T10:19:14Z", "author": {"login": "renner"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -158,10 +201,15 @@ class BootstrapMinions extends React.Component {\n           messages = <Messages items={[{severity: \"info\", text:\n               <p>{t('Your system is bootstrapping: waiting for a response..')}</p>\n           }]}/>;\n+        } else if (this.state.privKeyLoading) {\n+          messages = <Messages items={[{severity: \"info\", text:\n+              <p>{t('Loading SSH Private Key..')}</p>\n+          }]}/>;\n         }\n \n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83cd2ef17d67278984a0ae25f863a17b0fbf5763"}, "originalPosition": 104}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwNjc2ODA5OnYy", "diffSide": "RIGHT", "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQxMDoyNTo0N1rOGBRUIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNDoyMDo0NVrOGCxkmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk4NTQ0MA==", "bodyText": "Maybe, as all the labels are upper-cased in this form, should we also uppercase this one as Authentication Method:?", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r403985440", "createdAt": "2020-04-06T10:25:47Z", "author": {"login": "renner"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -198,11 +236,43 @@ class BootstrapMinions extends React.Component {\n                     </div>\n                 </div>\n                 <div className=\"form-group\">\n+                    <label className=\"col-md-3 control-label\">Authentication method:</label>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "937fcec18b61dea3e4295e7477d8c779050b83cc"}, "originalPosition": 139}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU2MjUyMw==", "bodyText": "Done.", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r405562523", "createdAt": "2020-04-08T14:20:45Z", "author": {"login": "hustodemon"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -198,11 +236,43 @@ class BootstrapMinions extends React.Component {\n                     </div>\n                 </div>\n                 <div className=\"form-group\">\n+                    <label className=\"col-md-3 control-label\">Authentication method:</label>", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzk4NTQ0MA=="}, "originalCommit": {"oid": "937fcec18b61dea3e4295e7477d8c779050b83cc"}, "originalPosition": 139}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwOTI4ODEyOnYy", "diffSide": "RIGHT", "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMTowMzo0MFrOGBp0AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNDozODo0MVrOGCyXTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM4NjgxNw==", "bodyText": "What about creating a conditional HTML content variable before the return and just showing it here instead?\nSomething like:\nconst conditionalAuthContent = this.state.authMethod === \"password\" ?\n    <div>\n      // the password input box\n    </div>\n    :\n    <div>\n      // the  ssh-key box content (privKeyFile and privKeyPwd inputs)\n    </div>\nand then in the return body just use {conditionalAuthContent}.", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r404386817", "createdAt": "2020-04-06T21:03:40Z", "author": {"login": "ncounter"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -198,11 +246,43 @@ class BootstrapMinions extends React.Component {\n                     </div>\n                 </div>\n                 <div className=\"form-group\">\n+                    <label className=\"col-md-3 control-label\">Authentication method:</label>\n+\n+                    <div className=\"col-md-6\">\n+                        <div className=\"radio col-md-3\">\n+                            <label>\n+                                <input name=\"authMethod\" type=\"radio\" value=\"password\" checked={this.state.authMethod === \"password\"} onChange={this.authMethodChanged}/>\n+                                <span>{t(\"Password\")}</span>\n+                            </label>\n+                        </div>\n+                        <div className=\"radio col-md-3\">\n+                            <label>\n+                                <input name=\"authMethod\" type=\"radio\" value=\"ssh-key\" checked={this.state.authMethod === \"ssh-key\"} onChange={this.authMethodChanged}/>\n+                                <span>{t(\"SSH Private Key\")}</span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                </div>\n+                <div className=\"form-group\" style={this.state.authMethod === \"password\" ? {} : {display: \"none\"} } >", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83cd2ef17d67278984a0ae25f863a17b0fbf5763"}, "originalPosition": 132}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU3NTUwMQ==", "bodyText": "I did that in the original version, but for some reason React was complaining about changing controlled elements to uncontrolled and vice versa, but this is not the case anymore. I've changed as your suggested.", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r405575501", "createdAt": "2020-04-08T14:38:41Z", "author": {"login": "hustodemon"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -198,11 +246,43 @@ class BootstrapMinions extends React.Component {\n                     </div>\n                 </div>\n                 <div className=\"form-group\">\n+                    <label className=\"col-md-3 control-label\">Authentication method:</label>\n+\n+                    <div className=\"col-md-6\">\n+                        <div className=\"radio col-md-3\">\n+                            <label>\n+                                <input name=\"authMethod\" type=\"radio\" value=\"password\" checked={this.state.authMethod === \"password\"} onChange={this.authMethodChanged}/>\n+                                <span>{t(\"Password\")}</span>\n+                            </label>\n+                        </div>\n+                        <div className=\"radio col-md-3\">\n+                            <label>\n+                                <input name=\"authMethod\" type=\"radio\" value=\"ssh-key\" checked={this.state.authMethod === \"ssh-key\"} onChange={this.authMethodChanged}/>\n+                                <span>{t(\"SSH Private Key\")}</span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                </div>\n+                <div className=\"form-group\" style={this.state.authMethod === \"password\" ? {} : {display: \"none\"} } >", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM4NjgxNw=="}, "originalCommit": {"oid": "83cd2ef17d67278984a0ae25f863a17b0fbf5763"}, "originalPosition": 132}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwOTI5OTc2OnYy", "diffSide": "RIGHT", "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMTowNzoyMlrOGBp7Pw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxNTo1MToyMlrOGFVVrw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM4ODY3MQ==", "bodyText": "This is not used more than once. Maybe you can just do this inline three lines below\nreader.readAsText(event.target.files[0].", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r404388671", "createdAt": "2020-04-06T21:07:22Z", "author": {"login": "ncounter"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -48,12 +51,41 @@ class BootstrapMinions extends React.Component {\n         });\n     }\n \n+    authMethodChanged(event) {\n+        this.setState({\n+            authMethod: event.target.value\n+        });\n+    }\n+\n     passwordChanged(event) {\n         this.setState({\n             password: event.target.value\n         });\n     }\n \n+    privKeyFileChanged(event) {\n+        const file = event.target.files[0];", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83cd2ef17d67278984a0ae25f863a17b0fbf5763"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTU4MjczMQ==", "bodyText": "But many of the <something>Changed methods are only used once. I personally find it uglier, to do it all-in once (or maybe I didn't completely got your intention):\n    privKeyFileChanged(event) {\n        this.setState({\n            privKeyLoading: true\n        });\n        const file = event.target.files[0];\n        const reader = new FileReader();\n        reader.onload = (e) => this.setState({\n            privKey: keyString,\n            privKeyLoading: false\n        });\n        reader.readAsText(file);\n    }\nLet me know if this ^ is what you meant.", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r405582731", "createdAt": "2020-04-08T14:48:37Z", "author": {"login": "hustodemon"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -48,12 +51,41 @@ class BootstrapMinions extends React.Component {\n         });\n     }\n \n+    authMethodChanged(event) {\n+        this.setState({\n+            authMethod: event.target.value\n+        });\n+    }\n+\n     passwordChanged(event) {\n         this.setState({\n             password: event.target.value\n         });\n     }\n \n+    privKeyFileChanged(event) {\n+        const file = event.target.files[0];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM4ODY3MQ=="}, "originalCommit": {"oid": "83cd2ef17d67278984a0ae25f863a17b0fbf5763"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTc4NzMwNg==", "bodyText": "Oh, no no sorry, probably I was not that clear, but it was also not that important.\nThe render.onload is fine as it was, recalling the this.privKeyLoaded is fine.\nWhat I meant was only about dropping line\nconst file = event.target.files[0];\nbecause file variable is used only once, and just do it at\nreader.readAsText(event.target.files[0]);\nFeel free to keep it or change it, it's not a big deal in the end.", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r405787306", "createdAt": "2020-04-08T20:15:33Z", "author": {"login": "ncounter"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -48,12 +51,41 @@ class BootstrapMinions extends React.Component {\n         });\n     }\n \n+    authMethodChanged(event) {\n+        this.setState({\n+            authMethod: event.target.value\n+        });\n+    }\n+\n     passwordChanged(event) {\n         this.setState({\n             password: event.target.value\n         });\n     }\n \n+    privKeyFileChanged(event) {\n+        const file = event.target.files[0];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM4ODY3MQ=="}, "originalCommit": {"oid": "83cd2ef17d67278984a0ae25f863a17b0fbf5763"}, "originalPosition": 39}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODI0NTY3OQ==", "bodyText": "I see! Ok, I inlined that const.", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r408245679", "createdAt": "2020-04-14T15:51:22Z", "author": {"login": "hustodemon"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -48,12 +51,41 @@ class BootstrapMinions extends React.Component {\n         });\n     }\n \n+    authMethodChanged(event) {\n+        this.setState({\n+            authMethod: event.target.value\n+        });\n+    }\n+\n     passwordChanged(event) {\n         this.setState({\n             password: event.target.value\n         });\n     }\n \n+    privKeyFileChanged(event) {\n+        const file = event.target.files[0];", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM4ODY3MQ=="}, "originalCommit": {"oid": "83cd2ef17d67278984a0ae25f863a17b0fbf5763"}, "originalPosition": 39}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUwOTMwNzc5OnYy", "diffSide": "RIGHT", "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMToxMDowMFrOGBqASg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNlQyMToxMDowMFrOGBqASg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDM4OTk2Mg==", "bodyText": "Whenever it turns to use a flag as a loading traffic-light or condition, I prefer to do it at the very beginning of the function to make sure the info is properly communicated to the user, and to prevent any unexpected behavior from the function body without having the flag set yet. Please move this setState right after the privateKeyFileChanged(event) { line.", "url": "https://github.com/uyuni-project/uyuni/pull/2095#discussion_r404389962", "createdAt": "2020-04-06T21:10:00Z", "author": {"login": "ncounter"}, "path": "web/html/src/manager/systems/bootstrap/bootstrap-minions.js", "diffHunk": "@@ -48,12 +51,41 @@ class BootstrapMinions extends React.Component {\n         });\n     }\n \n+    authMethodChanged(event) {\n+        this.setState({\n+            authMethod: event.target.value\n+        });\n+    }\n+\n     passwordChanged(event) {\n         this.setState({\n             password: event.target.value\n         });\n     }\n \n+    privKeyFileChanged(event) {\n+        const file = event.target.files[0];\n+        const reader = new FileReader();\n+        reader.onload = (e) => this.privKeyLoaded(e.target.result);\n+        reader.readAsText(file);\n+        this.setState({\n+            privKeyLoading: true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "83cd2ef17d67278984a0ae25f863a17b0fbf5763"}, "originalPosition": 44}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 100, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}