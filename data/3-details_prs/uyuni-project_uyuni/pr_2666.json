{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk0NzcwMTEz", "number": 2666, "title": "Salt configuration modules for Activation Keys", "bodyText": "What does this PR change?\nAdd support for activation keys on the salt configuration modules.\nGUI diff\nNo difference.\n\n DONE\n\nDocumentation\n\n\nDocumentation PR\n\n\n DONE\n\n\nTest coverage\n\n\nUnit tests were added\n\n\nCucumber tests were added\n\n\n DONE\n\n\nLinks\nFixes SUSE/spacewalk#12495\nTracks:\nNeeds backport to 4.1\n\n DONE\n\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_lint_checkstyle\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-09-29T11:46:17Z", "url": "https://github.com/uyuni-project/uyuni/pull/2666", "merged": true, "mergeCommit": {"oid": "3b37a6e89318540a632549ed1a70bc473cbfb849"}, "closed": true, "closedAt": "2020-09-30T14:24:29Z", "author": {"login": "rjmateus"}, "timelineItems": {"totalCount": 29, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdNncG7gFqTQ5ODQxOTA3Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdN9k_mAFqTQ5OTQ4NjMxMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk4NDE5MDc2", "url": "https://github.com/uyuni-project/uyuni/pull/2666#pullrequestreview-498419076", "createdAt": "2020-09-29T12:35:15Z", "commit": {"oid": "127932d388af928f3b06a70a906d71b6e627df2f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MjU2ODQy", "url": "https://github.com/uyuni-project/uyuni/pull/2666#pullrequestreview-499256842", "createdAt": "2020-09-30T09:41:26Z", "commit": {"oid": "23f93dfb6df95a08a15079bc6b069b74db954c18"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwOTo0MToyN1rOHaVkZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQwOTo0MTo1NlrOHaVltA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM3ODQwNg==", "bodyText": ", and (strange English rule)", "url": "https://github.com/uyuni-project/uyuni/pull/2666#discussion_r497378406", "createdAt": "2020-09-30T09:41:27Z", "author": {"login": "Bischoff"}, "path": "testsuite/features/secondary/srv_user_configuration_salt_states.feature", "diffHunk": "@@ -1,7 +1,7 @@\n # Copyright (c) 2020 SUSE LLC\n # Licensed under the terms of the MIT license.\n \n-Feature: Create organizations, users and groups using Salt states\n+Feature: Create organizations, users, groups and activation keys using Salt states", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23f93dfb6df95a08a15079bc6b069b74db954c18"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzM3ODc0MA==", "bodyText": "Activation key (with capital)", "url": "https://github.com/uyuni-project/uyuni/pull/2666#discussion_r497378740", "createdAt": "2020-09-30T09:41:56Z", "author": {"login": "Bischoff"}, "path": "testsuite/features/secondary/srv_user_configuration_salt_states.feature", "diffHunk": "@@ -51,6 +51,15 @@ Feature: Create organizations, users and groups using Salt states\n     And I should see \"role_channel_admin\" as unchecked\n     And I should see \"role_system_group_admin\" as unchecked\n \n+  Scenario: activation was correctly created", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "23f93dfb6df95a08a15079bc6b069b74db954c18"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c06bf36dbe991af813b11341416b567ec58d7e8", "author": {"user": {"login": "moio", "name": "Silvio Moioli"}}, "url": "https://github.com/uyuni-project/uyuni/commit/0c06bf36dbe991af813b11341416b567ec58d7e8", "committedDate": "2020-09-30T11:29:14Z", "message": "Bugfix: return correct code if activation key does not exist"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0dfa2fc5a7657e8eea559a04c781eae971668ea5", "author": {"user": {"login": "moio", "name": "Silvio Moioli"}}, "url": "https://github.com/uyuni-project/uyuni/commit/0dfa2fc5a7657e8eea559a04c781eae971668ea5", "committedDate": "2020-09-30T11:29:14Z", "message": "Add support for activationkey.absent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8e77fe298a4344392ff3a9b61ea4dc370a9d2db6", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8e77fe298a4344392ff3a9b61ea4dc370a9d2db6", "committedDate": "2020-09-30T11:29:14Z", "message": "unit test for activation key absent salt state\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "177d5a983385c921d4c819249755b6267d5431f6", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/177d5a983385c921d4c819249755b6267d5431f6", "committedDate": "2020-09-30T11:29:14Z", "message": "hub salt states: activation key present\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "23f93dfb6df95a08a15079bc6b069b74db954c18", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/23f93dfb6df95a08a15079bc6b069b74db954c18", "committedDate": "2020-09-29T15:09:44Z", "message": "updata changes file\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}, "afterCommit": {"oid": "b3b5324a316a863d086ead2a4cfd387be3b17aa7", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/b3b5324a316a863d086ead2a4cfd387be3b17aa7", "committedDate": "2020-09-30T11:29:52Z", "message": "updata changes file\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5MzQyNDUy", "url": "https://github.com/uyuni-project/uyuni/pull/2666#pullrequestreview-499342452", "createdAt": "2020-09-30T11:44:02Z", "commit": {"oid": "b3b5324a316a863d086ead2a4cfd387be3b17aa7"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMTo0NDowM1rOHaZk9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0zMFQxMjozODo1NlrOHabe0A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ0NDA4Ng==", "bodyText": "IIUC this should be a list of strings. Why does the compiler not complain?", "url": "https://github.com/uyuni-project/uyuni/pull/2666#discussion_r497444086", "createdAt": "2020-09-30T11:44:03Z", "author": {"login": "moio"}, "path": "susemanager-utils/susemanager-sls/src/modules/uyuni_config.py", "diffHunk": "@@ -600,6 +607,226 @@ def get_minion_id_map(self, refresh: bool = False) -> Dict[str, int]:\n         return __context__[minions_token_key]\n \n \n+class UyuniActivationKey(UyuniRemoteObject):\n+    \"\"\"\n+    CRUD operations on Activation Keys.\n+    \"\"\"\n+\n+    def get_details(self, id: str) -> Dict[str, Any]:\n+        \"\"\"\n+        Get details of an Uyuni Activation Key\n+\n+        :param id: the Activation Key ID\n+\n+        :return: Activation Key information\n+        \"\"\"\n+        return self.client(\"activationkey.getDetails\", id)\n+\n+    def delete(self, id: str) -> bool:\n+        \"\"\"\n+        Deletes an Uyuni Activation Key\n+\n+        :param id: the Activation Key ID\n+\n+        :return: boolean, True indicates success\n+        \"\"\"\n+        return self._convert_bool_response(self.client(\"activationkey.delete\", id))\n+\n+    def create(self, key: str, description: str,\n+               base_channel_label: str = '',\n+               usage_limit: int = 0,\n+               system_types: List[int] = [],", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3b5324a316a863d086ead2a4cfd387be3b17aa7"}, "originalPosition": 62}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzQ3NTI4MA==", "bodyText": "Not sure I understand the doubt here, let's clarify this before merging.", "url": "https://github.com/uyuni-project/uyuni/pull/2666#discussion_r497475280", "createdAt": "2020-09-30T12:38:56Z", "author": {"login": "moio"}, "path": "susemanager-utils/susemanager-sls/src/modules/uyuni_config.py", "diffHunk": "@@ -1116,6 +1343,19 @@ def systemgroup_create(name, descr, org_admin_user=None, org_admin_password=None\n     return UyuniSystemgroup(org_admin_user, org_admin_password).create(name=name, description=descr)\n \n \n+# FIXME: Should we keep the fallback mechanism to the admin user in the authentication?\n+#        That could be dangerous if we didn't pass any authentication on some methods", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3b5324a316a863d086ead2a4cfd387be3b17aa7"}, "originalPosition": 293}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c5c25c720f3898e3df9d8044015fa79c27d5a75", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4c5c25c720f3898e3df9d8044015fa79c27d5a75", "committedDate": "2020-09-30T12:42:15Z", "message": "hub salt modules: activation key system types\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dc8dc6ad2bb3f289f3434a3a14f1d45876b0b62a", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/dc8dc6ad2bb3f289f3434a3a14f1d45876b0b62a", "committedDate": "2020-09-30T12:42:15Z", "message": "hub salt states: activation keys support\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30478b1ff74cdd9cf57c3a5d13a1f9061fc6c66e", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/30478b1ff74cdd9cf57c3a5d13a1f9061fc6c66e", "committedDate": "2020-09-30T12:42:15Z", "message": "config salt state: activation key with packages definition\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b3b5324a316a863d086ead2a4cfd387be3b17aa7", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/b3b5324a316a863d086ead2a4cfd387be3b17aa7", "committedDate": "2020-09-30T11:29:52Z", "message": "updata changes file\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}, "afterCommit": {"oid": "14a0db39aaedaa35dbd4274bc978a8bff1a5cf45", "author": {"user": {"login": "moio", "name": "Silvio Moioli"}}, "url": "https://github.com/uyuni-project/uyuni/commit/14a0db39aaedaa35dbd4274bc978a8bff1a5cf45", "committedDate": "2020-09-30T12:44:49Z", "message": "Rewording of some documentation comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "29e1c17233b094230a3c04d5ca53a0ba471c7c0a", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/29e1c17233b094230a3c04d5ca53a0ba471c7c0a", "committedDate": "2020-09-30T14:09:40Z", "message": "config salt state activation key support for groups\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f12c6ec1288a581b02a3a0f5f65fd36c37c2f1f5", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/f12c6ec1288a581b02a3a0f5f65fd36c37c2f1f5", "committedDate": "2020-09-30T14:09:49Z", "message": "addo support for configuration channels\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32008b4e66c96e6a5bb540efa79dd909ec00ee6f", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/32008b4e66c96e6a5bb540efa79dd909ec00ee6f", "committedDate": "2020-09-30T14:09:49Z", "message": "salt configuration modules: rename output changes labels\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5ce7663da11f563f1d0f5af23c23c89ac2dcc6b", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/f5ce7663da11f563f1d0f5af23c23c89ac2dcc6b", "committedDate": "2020-09-30T14:09:49Z", "message": "uyuni config salt states: display groups names on changes\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8b2794e0619dc9a26ce49255c114645e1682ae44", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8b2794e0619dc9a26ce49255c114645e1682ae44", "committedDate": "2020-09-30T14:09:49Z", "message": "refactoring of server groups map variables\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b588f7393ec2bc534600dae4fedd2fc21a39a32a", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/b588f7393ec2bc534600dae4fedd2fc21a39a32a", "committedDate": "2020-09-30T14:02:40Z", "message": "code review\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}, "afterCommit": {"oid": "8d35ba09ef443d357b9fa884af7b1c4379ef434f", "author": {"user": {"login": "moio", "name": "Silvio Moioli"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8d35ba09ef443d357b9fa884af7b1c4379ef434f", "committedDate": "2020-09-30T14:09:50Z", "message": "Rewording of some documentation comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e743764618ef7951ec605038155f45a35a2d073e", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e743764618ef7951ec605038155f45a35a2d073e", "committedDate": "2020-09-30T14:18:21Z", "message": "activation key salt module: code review and documentation\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43a35df740e361568f1bfa23d94723aff29ff305", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/43a35df740e361568f1bfa23d94723aff29ff305", "committedDate": "2020-09-30T14:18:29Z", "message": "salt configuration modules: test for activation key\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a3115887a070c628e9234b55c7ee2c73bde31708", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/a3115887a070c628e9234b55c7ee2c73bde31708", "committedDate": "2020-09-30T14:18:29Z", "message": "salt configuration modules: test for activation key\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "028b722c626b2f0682187eee0619eab249e2bff1", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/028b722c626b2f0682187eee0619eab249e2bff1", "committedDate": "2020-09-30T14:18:29Z", "message": "salt config states: activation key tests\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2223636d7a63c2f2eb153d97e21a8021f28f1901", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/2223636d7a63c2f2eb153d97e21a8021f28f1901", "committedDate": "2020-09-30T14:18:29Z", "message": "salt config state: activaton key update example\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de3e5e6d31f895e3599107a4a6390e75593af831", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/de3e5e6d31f895e3599107a4a6390e75593af831", "committedDate": "2020-09-30T14:18:29Z", "message": "config salt states: activation key Cucumber test\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a8606936b8963f4a2e6618e2066403ac9372eae", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/6a8606936b8963f4a2e6618e2066403ac9372eae", "committedDate": "2020-09-30T14:18:29Z", "message": "config salt states: add code documentation\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b6d003224b042a1c3137656a53a18446433e7929", "author": {"user": {"login": "rjmateus", "name": "Ricardo Mateus"}}, "url": "https://github.com/uyuni-project/uyuni/commit/b6d003224b042a1c3137656a53a18446433e7929", "committedDate": "2020-09-30T14:18:29Z", "message": "update of changes file\n\nSigned-off-by: Ricardo Mateus <rmateus@suse.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "062b4e048b4b366a995953b1b8500c4bbbea63ee", "author": {"user": {"login": "moio", "name": "Silvio Moioli"}}, "url": "https://github.com/uyuni-project/uyuni/commit/062b4e048b4b366a995953b1b8500c4bbbea63ee", "committedDate": "2020-09-30T14:18:29Z", "message": "Rewording of some documentation comments"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8d35ba09ef443d357b9fa884af7b1c4379ef434f", "author": {"user": {"login": "moio", "name": "Silvio Moioli"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8d35ba09ef443d357b9fa884af7b1c4379ef434f", "committedDate": "2020-09-30T14:09:50Z", "message": "Rewording of some documentation comments"}, "afterCommit": {"oid": "062b4e048b4b366a995953b1b8500c4bbbea63ee", "author": {"user": {"login": "moio", "name": "Silvio Moioli"}}, "url": "https://github.com/uyuni-project/uyuni/commit/062b4e048b4b366a995953b1b8500c4bbbea63ee", "committedDate": "2020-09-30T14:18:29Z", "message": "Rewording of some documentation comments"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk5NDg2MzEw", "url": "https://github.com/uyuni-project/uyuni/pull/2666#pullrequestreview-499486310", "createdAt": "2020-09-30T14:22:53Z", "commit": {"oid": "062b4e048b4b366a995953b1b8500c4bbbea63ee"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1024, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}