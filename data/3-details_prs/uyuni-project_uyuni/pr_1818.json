{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY1NzI1NjE3", "number": 1818, "title": "Also check python[2]-Jinja when installing python2-salt at buildhosts", "bodyText": "What does this PR change?\nAs otherwise in some cases python2-salt is available at SLE15, but not the required dependencies.\nSo for python2-salt to be installed, user needs make sure (for SLE15 >= SP1) that the Python2 Module is available to the instance.\nGUI diff\nNo difference.\n\n DONE\n\nDocumentation\n\n\nNo documentation needed: We already have an issue for this.\n\n\n DONE\n\n\nTest coverage\n\n\nNo tests: Covered by cucumber testsuite.\n\n\n DONE\n\n\nLinks\nNone.\n\n DONE\n\nChangelogs\nIf you don't need a changelog check, please mark this checkbox:\n\n No changelog needed\n\nIf you uncheck the checkbox after the PR is created, you will need to re-run changelog_test (see below)\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_lint_checkstyle\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"ruby_rubocop\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-01-22T08:28:28Z", "url": "https://github.com/uyuni-project/uyuni/pull/1818", "merged": true, "mergeCommit": {"oid": "751abe99231581facf7c87e1ef0c099ade4cd189"}, "closed": true, "closedAt": "2020-01-22T10:25:51Z", "author": {"login": "juliogonzalez"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb8xZ2TAH2gAyMzY1NzI1NjE3OjRiYWJkNDE2YmVlMWQyYzM1NDlmZTI2NTc3MjZiM2I5ZjBiNTk0MjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8zHtjAFqTM0NjQ4MDY1MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4babd416bee1d2c3549fe2657726b3b9f0b59421", "author": {"user": {"login": "juliogonzalez", "name": "Julio Gonz\u00e1lez Gil"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4babd416bee1d2c3549fe2657726b3b9f0b59421", "committedDate": "2020-01-22T08:23:58Z", "message": "Also check python[2]-Jinja when installing python2-salt at buildhosts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2NDEzMjAw", "url": "https://github.com/uyuni-project/uyuni/pull/1818#pullrequestreview-346413200", "createdAt": "2020-01-22T08:33:11Z", "commit": {"oid": "4babd416bee1d2c3549fe2657726b3b9f0b59421"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODozMzoxMVrOFgT5Zg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODozMzoxMVrOFgT5Zg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNDc0Mg==", "bodyText": "salt['pkg.info_available']('python-Jinja2', 'python2-Jinja2')\nSo it works with both SLE15 and SLE12:\nSLE-Module-Python2_15-SP1_x86_64/_channel:    <binary name=\"python2-Jinja2\" package=\"python-Jinja2\" supportstatus=\"l3\"/>\nSLE-Module-Basesystem_15_x86_64/_channel:    <binary name=\"python2-Jinja2\" package=\"python-Jinja2\" supportstatus=\"l3\"/>\nSLE-Manager-Tools_12_x86_64/_channel:    <binary package=\"python-Jinja2\"             name=\"python-Jinja2\"                    supportstatus=\"l3\"/>", "url": "https://github.com/uyuni-project/uyuni/pull/1818#discussion_r369424742", "createdAt": "2020-01-22T08:33:11Z", "author": {"login": "juliogonzalez"}, "path": "susemanager-utils/susemanager-sls/salt/services/docker.sls", "diffHunk": "@@ -15,7 +15,7 @@ mgr_install_docker:\n {%- endif %}\n {%- if grains['saltversioninfo'][0] >= 2018 %}\n       - python3-salt\n-    {%- if salt['pkg.info_available']('python', 'python2') and salt['pkg.info_available']('python2-salt') %}\n+    {%- if salt['pkg.info_available']('python', 'python2') and salt['pkg.info_available']('python2-salt') and salt['pkg.info_available']('python-Jinja2', 'python2-Jinja2') %}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4babd416bee1d2c3549fe2657726b3b9f0b59421"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2NDE4MjMx", "url": "https://github.com/uyuni-project/uyuni/pull/1818#pullrequestreview-346418231", "createdAt": "2020-01-22T08:42:45Z", "commit": {"oid": "4babd416bee1d2c3549fe2657726b3b9f0b59421"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODo0Mjo0NVrOFgUI6w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMlQwODo0Mjo0NVrOFgUI6w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyODcxNQ==", "bodyText": "performance: maybe it's faster to do a series of nested {% ifs (I'm not sure that jinja short-circuits boolean expressions)\nother possibility: pkg.info_available takes several arguments. Are they joined with a OR or a AND? If it's a AND, you could list all packages in one single call\n\nMy 2 cents", "url": "https://github.com/uyuni-project/uyuni/pull/1818#discussion_r369428715", "createdAt": "2020-01-22T08:42:45Z", "author": {"login": "Bischoff"}, "path": "susemanager-utils/susemanager-sls/salt/services/docker.sls", "diffHunk": "@@ -15,7 +15,7 @@ mgr_install_docker:\n {%- endif %}\n {%- if grains['saltversioninfo'][0] >= 2018 %}\n       - python3-salt\n-    {%- if salt['pkg.info_available']('python', 'python2') and salt['pkg.info_available']('python2-salt') %}\n+    {%- if salt['pkg.info_available']('python', 'python2') and salt['pkg.info_available']('python2-salt') and salt['pkg.info_available']('python-Jinja2', 'python2-Jinja2') %}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4babd416bee1d2c3549fe2657726b3b9f0b59421"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ2NDgwNjUx", "url": "https://github.com/uyuni-project/uyuni/pull/1818#pullrequestreview-346480651", "createdAt": "2020-01-22T10:23:58Z", "commit": {"oid": "4babd416bee1d2c3549fe2657726b3b9f0b59421"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1736, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}