{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5NjMwMDc3", "number": 1954, "title": "Modularisation Part1", "bodyText": "What does this PR change?\nThis PR contains the first batch of changes for modernizing our codebase better. This PR contains:\n\n\nintroducing an interface for all salt (non ssh) operations.\n\n\nremoving some low level salt calls with higher level methods.\n\n\nmarking future methods to be refined as deprecated.\n\n\nfirst batch of salt dependent classes changed to have non static method and take dependencies though constructor.\n\n\npushing instantiation of of components to the entry points (xml rpc, router, salt reactor).\n\n\nno logic should have been changed during this.\n\n\n TODO: double check synchronized methods since multiple instances will change behavior here.\n\n\nGUI diff\nNo difference.\n\n DONE\n\nDocumentation\n\n\nNo documentation needed: no user visible changes\n\n\n DONE\n\n\nTest coverage\n\n\nNo tests: covered by existing tests\n\n\n DONE\n\n\nLinks\nFixes #\nTracks # add downstream PR, if any\n\n DONE\n\nChangelogs\nIf you don't need a changelog check, please mark this checkbox:\n\n No changelog needed\n\nIf you uncheck the checkbox after the PR is created, you will need to re-run changelog_test (see below)\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_lint_checkstyle\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"ruby_rubocop\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-02-25T14:54:01Z", "url": "https://github.com/uyuni-project/uyuni/pull/1954", "merged": true, "mergeCommit": {"oid": "0f8f85a6c0b0c831d3771c77612630c3627614ed"}, "closed": true, "closedAt": "2020-03-19T17:02:48Z", "author": {"login": "lucidd"}, "timelineItems": {"totalCount": 52, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcH0NaeABqjMwNzAwMjk3OTM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcPOmHbgBqjMxNDYzNDg4OTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2938fe5e2878c69a2570952b3adb378139c67352", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/2938fe5e2878c69a2570952b3adb378139c67352", "committedDate": "2020-02-25T13:25:09Z", "message": "bootstrap NotificationMessageController"}, "afterCommit": {"oid": "0cf3201d280b5542d576c6cfbfc7724edfe266ad", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/0cf3201d280b5542d576c6cfbfc7724edfe266ad", "committedDate": "2020-02-25T15:53:06Z", "message": "fix checkstyle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0cf3201d280b5542d576c6cfbfc7724edfe266ad", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/0cf3201d280b5542d576c6cfbfc7724edfe266ad", "committedDate": "2020-02-25T15:53:06Z", "message": "fix checkstyle"}, "afterCommit": {"oid": "519203444cc1d117c9e75ea4cb6e86b6e749d89e", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/519203444cc1d117c9e75ea4cb6e86b6e749d89e", "committedDate": "2020-02-25T16:00:33Z", "message": "fix checkstyle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "519203444cc1d117c9e75ea4cb6e86b6e749d89e", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/519203444cc1d117c9e75ea4cb6e86b6e749d89e", "committedDate": "2020-02-25T16:00:33Z", "message": "fix checkstyle"}, "afterCommit": {"oid": "97d6bdc578a20c5f9085c9ad951a96bfc9af5f73", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/97d6bdc578a20c5f9085c9ad951a96bfc9af5f73", "committedDate": "2020-02-27T17:13:54Z", "message": "fix tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "97d6bdc578a20c5f9085c9ad951a96bfc9af5f73", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/97d6bdc578a20c5f9085c9ad951a96bfc9af5f73", "committedDate": "2020-02-27T17:13:54Z", "message": "fix tests"}, "afterCommit": {"oid": "02ee5b51cd31049b0a05354d5e76691e8de1976d", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/02ee5b51cd31049b0a05354d5e76691e8de1976d", "committedDate": "2020-02-28T17:33:53Z", "message": "fix tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "02ee5b51cd31049b0a05354d5e76691e8de1976d", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/02ee5b51cd31049b0a05354d5e76691e8de1976d", "committedDate": "2020-02-28T17:33:53Z", "message": "fix tests"}, "afterCommit": {"oid": "18646cb39d39262f847ccedfe1a546157274f4c2", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/18646cb39d39262f847ccedfe1a546157274f4c2", "committedDate": "2020-03-02T12:53:31Z", "message": "fix tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "18646cb39d39262f847ccedfe1a546157274f4c2", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/18646cb39d39262f847ccedfe1a546157274f4c2", "committedDate": "2020-03-02T12:53:31Z", "message": "fix tests"}, "afterCommit": {"oid": "8efbf8623750c492415037e31914d25643648293", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8efbf8623750c492415037e31914d25643648293", "committedDate": "2020-03-02T16:17:55Z", "message": "fix tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8efbf8623750c492415037e31914d25643648293", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8efbf8623750c492415037e31914d25643648293", "committedDate": "2020-03-02T16:17:55Z", "message": "fix tests"}, "afterCommit": {"oid": "c8cbafa49fa3348ea923b52991e78ec4d8e844d9", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c8cbafa49fa3348ea923b52991e78ec4d8e844d9", "committedDate": "2020-03-04T10:20:02Z", "message": "fix checkstyle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MTU0MzMw", "url": "https://github.com/uyuni-project/uyuni/pull/1954#pullrequestreview-368154330", "createdAt": "2020-03-03T16:56:24Z", "commit": {"oid": "8efbf8623750c492415037e31914d25643648293"}, "state": "APPROVED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QxNjo1NjoyNFrOFxOTog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxMTozMzozOVrOFxpy4g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE1ODk0Ng==", "bodyText": "As SystemQuery is defining an interface, should it really reside in the impl package? Could we maybe come up with a better package structure right from the beginning, or was it done on purpose?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r387158946", "createdAt": "2020-03-03T16:56:24Z", "author": {"login": "renner"}, "path": "java/code/src/com/suse/manager/webui/services/impl/SystemQuery.java", "diffHunk": "@@ -0,0 +1,149 @@\n+/**\n+ * Copyright (c) 2016 SUSE LLC\n+ *\n+ * This software is licensed to you under the GNU General Public License,\n+ * version 2 (GPLv2). There is NO WARRANTY for this software, express or\n+ * implied, including the implied warranties of MERCHANTABILITY or FITNESS\n+ * FOR A PARTICULAR PURPOSE. You should have received a copy of GPLv2\n+ * along with this software; if not, see\n+ * http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.\n+ *\n+ * Red Hat trademarks are not licensed under GPLv2. No permission is\n+ * granted to use or replicate Red Hat trademarks that are incorporated\n+ * in this software or its documentation.\n+ */\n+package com.suse.manager.webui.services.impl;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8efbf8623750c492415037e31914d25643648293"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzE2Mjc0MA==", "bodyText": "We are at 2020 meanwhile.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r387162740", "createdAt": "2020-03-03T17:02:15Z", "author": {"login": "renner"}, "path": "java/code/src/com/suse/manager/webui/services/impl/SystemQuery.java", "diffHunk": "@@ -0,0 +1,149 @@\n+/**\n+ * Copyright (c) 2016 SUSE LLC", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8efbf8623750c492415037e31914d25643648293"}, "originalPosition": 2}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzU2MDkwOQ==", "bodyText": "Here (and in other parts of this patch) you suggest to keep the old variable name (saltService). Is this just for simplicity in terms of less changes? Should it eventually be systemQuery everywhere?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r387560909", "createdAt": "2020-03-04T10:00:55Z", "author": {"login": "renner"}, "path": "java/code/src/com/suse/manager/webui/services/SaltServerActionService.java", "diffHunk": "@@ -201,11 +201,15 @@\n     private SaltActionChainGeneratorService saltActionChainGeneratorService =\n             SaltActionChainGeneratorService.INSTANCE;\n \n-    private SaltService saltService = SaltService.INSTANCE;\n+    private SystemQuery saltService;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8efbf8623750c492415037e31914d25643648293"}, "originalPosition": 24}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzYwNDI4Ng==", "bodyText": "Is SystemQuery actually the most appropriate name we can find for this new interface? I find the name suitable for most of the functionality, but for some of the methods it doesn't really fit, like generateSSHKey() or the ones related to key management on the master. I don't currently have a better name for suggestion, just wanted to raise it for discussion. Maybe there could even be a separate interface for things that just operate locally on another iteration, is that what you mean with \"split up further\"?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r387604286", "createdAt": "2020-03-04T11:22:41Z", "author": {"login": "renner"}, "path": "java/code/src/com/suse/manager/webui/services/impl/SystemQuery.java", "diffHunk": "@@ -0,0 +1,498 @@\n+/**\n+ * Copyright (c) 2016 SUSE LLC\n+ *\n+ * This software is licensed to you under the GNU General Public License,\n+ * version 2 (GPLv2). There is NO WARRANTY for this software, express or\n+ * implied, including the implied warranties of MERCHANTABILITY or FITNESS\n+ * FOR A PARTICULAR PURPOSE. You should have received a copy of GPLv2\n+ * along with this software; if not, see\n+ * http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.\n+ *\n+ * Red Hat trademarks are not licensed under GPLv2. No permission is\n+ * granted to use or replicate Red Hat trademarks that are incorporated\n+ * in this software or its documentation.\n+ */\n+package com.suse.manager.webui.services.impl;\n+\n+import com.google.gson.reflect.TypeToken;\n+import com.google.gson.JsonElement;\n+import com.redhat.rhn.domain.server.MinionServer;\n+import com.suse.manager.reactor.SaltReactor;\n+import com.suse.manager.virtualization.GuestDefinition;\n+import com.suse.manager.webui.services.impl.runner.MgrK8sRunner;\n+import com.suse.manager.webui.services.impl.runner.MgrUtilRunner;\n+import com.suse.manager.webui.utils.gson.BootstrapParameters;\n+import com.suse.manager.webui.utils.salt.custom.ScheduleMetadata;\n+import com.suse.salt.netapi.calls.LocalAsyncResult;\n+import com.suse.salt.netapi.calls.LocalCall;\n+import com.suse.salt.netapi.calls.modules.SaltUtil;\n+import com.suse.salt.netapi.calls.modules.State;\n+import com.suse.salt.netapi.calls.modules.Zypper;\n+import com.suse.salt.netapi.calls.runner.Jobs;\n+import com.suse.salt.netapi.calls.wheel.Key;\n+import com.suse.salt.netapi.datatypes.target.MinionList;\n+import com.suse.salt.netapi.datatypes.target.Target;\n+import com.suse.salt.netapi.errors.GenericError;\n+import com.suse.salt.netapi.event.EventStream;\n+import com.suse.salt.netapi.exception.SaltException;\n+import com.suse.salt.netapi.results.Result;\n+import com.suse.salt.netapi.results.SSHResult;\n+\n+import java.time.LocalDateTime;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.CompletionStage;\n+\n+/**\n+ * Interface containing methods for directly interacting and getting information from\n+ * a system.\n+ * Note: This interface should be split up further at some point.\n+ */\n+public interface SystemQuery {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8cbafa49fa3348ea923b52991e78ec4d8e844d9"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzYwNTE0MQ==", "bodyText": "The max line length is currently set to 120 characters (for checkstyle), so this should actually fit on a single line?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r387605141", "createdAt": "2020-03-04T11:24:45Z", "author": {"login": "renner"}, "path": "java/code/src/com/suse/manager/webui/services/impl/SystemQuery.java", "diffHunk": "@@ -0,0 +1,498 @@\n+/**\n+ * Copyright (c) 2016 SUSE LLC\n+ *\n+ * This software is licensed to you under the GNU General Public License,\n+ * version 2 (GPLv2). There is NO WARRANTY for this software, express or\n+ * implied, including the implied warranties of MERCHANTABILITY or FITNESS\n+ * FOR A PARTICULAR PURPOSE. You should have received a copy of GPLv2\n+ * along with this software; if not, see\n+ * http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.\n+ *\n+ * Red Hat trademarks are not licensed under GPLv2. No permission is\n+ * granted to use or replicate Red Hat trademarks that are incorporated\n+ * in this software or its documentation.\n+ */\n+package com.suse.manager.webui.services.impl;\n+\n+import com.google.gson.reflect.TypeToken;\n+import com.google.gson.JsonElement;\n+import com.redhat.rhn.domain.server.MinionServer;\n+import com.suse.manager.reactor.SaltReactor;\n+import com.suse.manager.virtualization.GuestDefinition;\n+import com.suse.manager.webui.services.impl.runner.MgrK8sRunner;\n+import com.suse.manager.webui.services.impl.runner.MgrUtilRunner;\n+import com.suse.manager.webui.utils.gson.BootstrapParameters;\n+import com.suse.manager.webui.utils.salt.custom.ScheduleMetadata;\n+import com.suse.salt.netapi.calls.LocalAsyncResult;\n+import com.suse.salt.netapi.calls.LocalCall;\n+import com.suse.salt.netapi.calls.modules.SaltUtil;\n+import com.suse.salt.netapi.calls.modules.State;\n+import com.suse.salt.netapi.calls.modules.Zypper;\n+import com.suse.salt.netapi.calls.runner.Jobs;\n+import com.suse.salt.netapi.calls.wheel.Key;\n+import com.suse.salt.netapi.datatypes.target.MinionList;\n+import com.suse.salt.netapi.datatypes.target.Target;\n+import com.suse.salt.netapi.errors.GenericError;\n+import com.suse.salt.netapi.event.EventStream;\n+import com.suse.salt.netapi.exception.SaltException;\n+import com.suse.salt.netapi.results.Result;\n+import com.suse.salt.netapi.results.SSHResult;\n+\n+import java.time.LocalDateTime;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.CompletionStage;\n+\n+/**\n+ * Interface containing methods for directly interacting and getting information from\n+ * a system.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8cbafa49fa3348ea923b52991e78ec4d8e844d9"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzYwOTMxNA==", "bodyText": "This is really not important, but I would prefer if we would use a unified way of doing indentation. In this new interface we already use 3 different ways of indenting the arguments: 8 spaces after the method name (my least preferred one), 8 spaces starting from the beginning of the line and 4 spaces from the beginning of the line one argument per line. It would be a good opportunity now to use just one of those ways, at least throughout this new interface.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r387609314", "createdAt": "2020-03-04T11:33:39Z", "author": {"login": "renner"}, "path": "java/code/src/com/suse/manager/webui/services/impl/SystemQuery.java", "diffHunk": "@@ -0,0 +1,498 @@\n+/**\n+ * Copyright (c) 2016 SUSE LLC\n+ *\n+ * This software is licensed to you under the GNU General Public License,\n+ * version 2 (GPLv2). There is NO WARRANTY for this software, express or\n+ * implied, including the implied warranties of MERCHANTABILITY or FITNESS\n+ * FOR A PARTICULAR PURPOSE. You should have received a copy of GPLv2\n+ * along with this software; if not, see\n+ * http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.\n+ *\n+ * Red Hat trademarks are not licensed under GPLv2. No permission is\n+ * granted to use or replicate Red Hat trademarks that are incorporated\n+ * in this software or its documentation.\n+ */\n+package com.suse.manager.webui.services.impl;\n+\n+import com.google.gson.reflect.TypeToken;\n+import com.google.gson.JsonElement;\n+import com.redhat.rhn.domain.server.MinionServer;\n+import com.suse.manager.reactor.SaltReactor;\n+import com.suse.manager.virtualization.GuestDefinition;\n+import com.suse.manager.webui.services.impl.runner.MgrK8sRunner;\n+import com.suse.manager.webui.services.impl.runner.MgrUtilRunner;\n+import com.suse.manager.webui.utils.gson.BootstrapParameters;\n+import com.suse.manager.webui.utils.salt.custom.ScheduleMetadata;\n+import com.suse.salt.netapi.calls.LocalAsyncResult;\n+import com.suse.salt.netapi.calls.LocalCall;\n+import com.suse.salt.netapi.calls.modules.SaltUtil;\n+import com.suse.salt.netapi.calls.modules.State;\n+import com.suse.salt.netapi.calls.modules.Zypper;\n+import com.suse.salt.netapi.calls.runner.Jobs;\n+import com.suse.salt.netapi.calls.wheel.Key;\n+import com.suse.salt.netapi.datatypes.target.MinionList;\n+import com.suse.salt.netapi.datatypes.target.Target;\n+import com.suse.salt.netapi.errors.GenericError;\n+import com.suse.salt.netapi.event.EventStream;\n+import com.suse.salt.netapi.exception.SaltException;\n+import com.suse.salt.netapi.results.Result;\n+import com.suse.salt.netapi.results.SSHResult;\n+\n+import java.time.LocalDateTime;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.CompletionStage;\n+\n+/**\n+ * Interface containing methods for directly interacting and getting information from\n+ * a system.\n+ * Note: This interface should be split up further at some point.\n+ */\n+public interface SystemQuery {\n+\n+    /**\n+     * Query virtual host and domains capabilities.\n+     *\n+     * @param minionId the salt minion virtual host to ask about\n+     * @return the output of the salt virt.all_capabilities call in JSON\n+     */\n+    Optional<Map<String, JsonElement>> getCapabilities(String minionId);\n+\n+    /**\n+     * Query the list of virtual networks defined on a salt minion.\n+     *\n+     * @param minionId the minion to ask about\n+     * @return a list of the network names\n+     */\n+    Map<String, JsonElement> getNetworks(String minionId);\n+\n+    /**\n+     * Query virtual machine definition\n+     *\n+     * @param minionId the host minion ID\n+     * @param domainName the domain name to look for\n+     * @return the XML definition or an empty Optional\n+     */\n+    Optional<GuestDefinition> getGuestDefinition(String minionId, String domainName);\n+\n+    /**\n+     * call salt test.ping\n+     * @param minionId id of the target minion\n+     * @return true\n+     */\n+    Optional<Boolean> ping(String minionId);\n+\n+    /**\n+     * Get the minion keys from salt with their respective status.\n+     *\n+     * @return the keys with their respective status as returned from salt\n+     */\n+    Key.Names getKeys();\n+\n+    /**\n+     * For a given minion id check if there is a key in any of the given status. If no status is given as parameter,\n+     * all the available status are considered.\n+     *\n+     * @param id the id to check for\n+     * @param statusIn array of key status to consider\n+     * @return true if there is a key with the given id, false otherwise\n+     */\n+    boolean keyExists(String id, SaltService.KeyStatus... statusIn);\n+\n+    /**\n+     * Get the minion keys from salt with their respective status and fingerprint.\n+     *\n+     * @return the keys with their respective status and fingerprint as returned from salt\n+     */\n+    Key.Fingerprints getFingerprints();\n+\n+    /**\n+     * Generate a key pair for the given id and accept the public key.\n+     *\n+     * @param id the id to use\n+     * @param force set true to overwrite an already existing key\n+     * @return the generated key pair\n+     */\n+    Key.Pair generateKeysAndAccept(String id, boolean force);\n+\n+    /**\n+     * Get the machine id for a given minion.\n+     *\n+     * @param minionId id of the target minion\n+     * @return the machine id as a string\n+     */\n+    Optional<String> getMachineId(String minionId);\n+\n+    /**\n+     * Delete a given minion's key.\n+     *\n+     * @param minionId id of the minion\n+     */\n+    void deleteKey(String minionId);\n+\n+    /**\n+     * Accept all keys matching the given pattern\n+     *\n+     * @param match a pattern for minion ids\n+     */\n+    void acceptKey(String match);\n+\n+    /**\n+     * Reject a given minion's key.\n+     *\n+     * @param minionId id of the minion\n+     */\n+    void rejectKey(String minionId);\n+\n+    /**\n+     * Delete a Salt key from the \"Rejected Keys\" category using the mgrutil runner.\n+     *\n+     * @param minionId the minionId to look for in \"Rejected Keys\"\n+     * @return the result of the runner call as a map\n+     */\n+    Optional<MgrUtilRunner.ExecResult> deleteRejectedKey(String minionId);\n+\n+    /**\n+     * Return the stream of events happening in salt.\n+     *\n+     * @return the event stream\n+     * @throws SaltException exception occured during connection (if any)\n+     */\n+    EventStream getEventStream() throws SaltException;\n+\n+    /**\n+     * Run a remote command on a given minion.\n+     *\n+     * @param target the target\n+     * @param cmd the command\n+     * @return the output of the command\n+     */\n+    Map<String, Result<String>> runRemoteCommand(MinionList target, String cmd);\n+\n+    /**\n+     * Run a remote command on a given minion asynchronously.\n+     * @param target the target\n+     * @param cmd the command to execute\n+     * @param cancel a future used to cancel waiting on return events\n+     * @return a map holding a {@link CompletionStage}s for each minion\n+     */\n+    Map<String, CompletionStage<Result<String>>> runRemoteCommandAsync(\n+            MinionList target, String cmd, CompletableFuture<GenericError> cancel);\n+\n+    /**\n+     * Query the list of virtual storage pools defined on a salt minion.\n+     *\n+     * @param minionId the minion to ask about\n+     * @return a map associating pool names with their informations as Json elements\n+     */\n+    Map<String, JsonElement> getPools(String minionId);\n+\n+    /**\n+     * Query the list of virtual storage volumes defined on a salt minion.\n+     *\n+     * @param minionId the minion to ask about\n+     * @return a map associating pool names with the list of volumes it contains mapped by their names\n+     */\n+    Map<String, Map<String, JsonElement>> getVolumes(String minionId);\n+\n+    /**\n+     * Returns the currently running jobs on the target\n+     *\n+     * @param target the target\n+     * @return list of running jobs\n+     */\n+    Map<String, Result<List<SaltUtil.RunningInfo>>> running(MinionList target);\n+\n+    /**\n+     * Return the result for a jobId\n+     *\n+     * @param jid the job id\n+     * @return map from minion to result\n+     */\n+    Optional<Jobs.Info> listJob(String jid);\n+\n+    /**\n+     * Match the given target expression asynchronously.\n+     * @param target the target expression\n+     * @param cancel  a future used to cancel waiting on return events\n+     * @return a map holding a {@link CompletionStage}s for each minion\n+     */\n+    Map<String, CompletionStage<Result<Boolean>>> matchAsync(\n+            String target, CompletableFuture<GenericError> cancel);\n+\n+    /**\n+     * Executes match.glob in another thread and returns a {@link CompletionStage}.\n+     * @param target the target to pass to match.glob\n+     * @param cancel a future used to cancel waiting\n+     * @return a future or Optional.empty if there's no ssh-push minion in the db\n+     */\n+    Optional<CompletionStage<Map<String, Result<Boolean>>>> matchAsyncSSH(\n+            String target, CompletableFuture<GenericError> cancel);\n+\n+    /**\n+     * Call 'saltutil.refresh_pillar' to sync the grains to the target minion(s).\n+     * @param minionList minion list\n+     */\n+    void refreshPillar(MinionList minionList);\n+\n+    /**\n+     * Call 'saltutil.sync_grains' to sync the grains to the target minion(s).\n+     * @param minionList minion list\n+     */\n+    void syncGrains(MinionList minionList);\n+\n+    /**\n+     * Call 'saltutil.sync_modules' to sync the grains to the target minion(s).\n+     * @param minionList minion list\n+     */\n+    void syncModules(MinionList minionList);\n+\n+    /**\n+     * Call 'saltutil.sync_all' to sync everything to the target minion(s).\n+     * @param minionList minion list\n+     */\n+    void syncAll(MinionList minionList);\n+\n+    /**\n+     * Performs an test.echo on a target set of minions for checkIn purpose.\n+     * @param targetIn the target\n+     * @return the LocalAsyncResult of the test.echo call\n+     * @throws SaltException if we get a failure from Salt\n+     */\n+    Optional<LocalAsyncResult<String>> checkIn(MinionList targetIn) throws SaltException;\n+\n+    /**\n+     * Apply util.systeminfo state on the specified minion list\n+     * @param minionTarget minion list\n+     */\n+    void updateSystemInfo(MinionList minionTarget);\n+\n+    /**\n+     * Gets a minion's master hostname.\n+     *\n+     * @param minionId the minion id\n+     * @return the master hostname\n+     */\n+    Optional<String> getMasterHostname(String minionId);\n+\n+    /**\n+     * Bootstrap a system using salt-ssh.\n+     *\n+     * @param parameters - bootstrap parameters\n+     * @param bootstrapMods - state modules to be applied during the bootstrap\n+     * @param pillarData - pillar data used salt-ssh call\n+     * @throws SaltException if something goes wrong during command execution or\n+     * during manipulation the salt-ssh roster\n+     * @return the result of the underlying ssh call for given host\n+     */\n+    Result<SSHResult<Map<String, State.ApplyResult>>> bootstrapMinion(\n+            BootstrapParameters parameters, List<String> bootstrapMods,\n+            Map<String, Object> pillarData) throws SaltException;\n+\n+    /**\n+     * Store the files uploaded by a minion to the SCAP storage directory.\n+     * @param minion the minion\n+     * @param uploadDir the uploadDir\n+     * @param actionId the action id\n+     * @return a map with one element: @{code true} -> scap store path,\n+     * {@code false} -> err message\n+     *\n+     */\n+    Map<Boolean, String> storeMinionScapFiles(\n+            MinionServer minion, String uploadDir, Long actionId);\n+\n+    /**\n+     * Call the custom mgrutil.ssh_keygen runner if the key files are not present.\n+     *\n+     * @param path of the key files\n+     * @return the result of the runner call as a map\n+     */\n+    Optional<MgrUtilRunner.ExecResult> generateSSHKey(String path);\n+\n+    /**\n+     * Chain ssh calls over one or more hops to run a command on the last host in the chain.\n+     * This calls the mgrutil.chain_ssh_command runner.\n+     *\n+     * @param hosts a list of hosts, where the last one is where\n+     *              the command will be executed\n+     * @param clientKey the ssh key to use to connect to the first host\n+     * @param proxyKey the ssh key path to use for the rest of the hosts\n+     * @param user the user\n+     * @param options ssh options\n+     * @param command the command to execute\n+     * @param outputfile the file to which to dump the command stdout\n+     * @return the execution result\n+     */\n+    Optional<MgrUtilRunner.ExecResult> chainSSHCommand(List<String> hosts,\n+        String clientKey,\n+        String proxyKey,\n+        String user,\n+        Map<String, String> options,\n+        String command,\n+        String outputfile);\n+\n+    /**\n+     * Get information about all containers running in a Kubernetes cluster.\n+     * @param kubeconfig path to the kubeconfig file\n+     * @param context kubeconfig context to use\n+     * @return a list of containers\n+     */\n+    Optional<List<MgrK8sRunner.Container>> getAllContainers(String kubeconfig, String context);\n+\n+    /**\n+     * Remove SUSE Manager specific configuration from a Salt minion.\n+     *\n+     * @param minion the minion.\n+     * @param timeout operation timeout\n+     * @return list of error messages or empty if no error\n+     */\n+    Optional<List<String>> cleanupMinion(MinionServer minion, int timeout);\n+\n+    /**\n+     * Send notification about a system id to be generated.\n+     * @param minion target minion.\n+     * @throws InstantiationException if signature generation fails\n+     * @throws SaltException if anything goes wrong.\n+     */\n+    void notifySystemIdGenerated(MinionServer minion) throws InstantiationException, SaltException;\n+\n+    /**\n+     * Get pending resume information.\n+     * @param minionIds to target.\n+     * @return pending resume information.\n+     * @throws SaltException if anything goes wrong.\n+     */\n+    Map<String, Result<Map<String, String>>> getPendingResume(List<String> minionIds) throws SaltException;\n+\n+    /**\n+     * Return show highstate result.\n+     * @param minionId of the target minion.\n+     * @return show highstate result.\n+     * @throws SaltException if anything goes wrong.\n+     */\n+    Map<String, Result<Object>> showHighstate(String minionId) throws SaltException;\n+\n+    /**\n+     * Query product information.\n+     * @param minionId of the target minion.\n+     * @return product information\n+     */\n+    Optional<List<Zypper.ProductInfo>> getProducts(String minionId);\n+\n+    /**\n+     * Execute a LocalCall asynchronously on the default Salt client.\n+     *\n+     * @deprecated this function is too general and should be replaced by more specific functionality.\n+     * @param <T> the return type of the call\n+     * @param callIn the call to execute\n+     * @param target minions targeted by the call\n+     * @param metadataIn the metadata to be passed in the call\n+     * @return the LocalAsyncResult of the call\n+     * @throws SaltException in case of an error executing the job with Salt\n+     */\n+    @Deprecated\n+    <T> Optional<LocalAsyncResult<T>> callAsync(LocalCall<T> callIn, Target<?> target,\n+                                                       Optional<ScheduleMetadata> metadataIn) throws SaltException;\n+\n+    /**\n+     * Sync the channels of a list of minions\n+     * @param minionIds of the targets.\n+     * @throws SaltException if anything goes wrong.\n+     */\n+    void deployChannels(List<String> minionIds) throws SaltException;\n+\n+    /**\n+     * Upload built Kiwi image to SUSE Manager\n+     *\n+     * @param minion     the minion\n+     * @param filepath   the filepath of the image to upload, in the build host\n+     * @param imageStore the image store location\n+     * @return the execution result\n+     */\n+    Optional<MgrUtilRunner.ExecResult> collectKiwiImage(MinionServer minion, String filepath,\n+                                                               String imageStore);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8cbafa49fa3348ea923b52991e78ec4d8e844d9"}, "originalPosition": 415}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ecb0302737532cef2105c6281f652f073d296bd0", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/ecb0302737532cef2105c6281f652f073d296bd0", "committedDate": "2020-03-04T15:24:29Z", "message": "rename saltService variables to systemQuery"}, "afterCommit": {"oid": "eb9f69dafb50fce7c130edc71a107d639cc2287e", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/eb9f69dafb50fce7c130edc71a107d639cc2287e", "committedDate": "2020-03-04T16:34:49Z", "message": "rename saltService variables to systemQuery"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "79dc74a4a2178641864ed1e863821ad8ffff2708", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/79dc74a4a2178641864ed1e863821ad8ffff2708", "committedDate": "2020-03-06T12:38:39Z", "message": "cleanup unused variable"}, "afterCommit": {"oid": "fb7a40835797dc57a6441eeb82ce0c046d19b28a", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/fb7a40835797dc57a6441eeb82ce0c046d19b28a", "committedDate": "2020-03-09T12:52:21Z", "message": "cleanup unused variable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fb7a40835797dc57a6441eeb82ce0c046d19b28a", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/fb7a40835797dc57a6441eeb82ce0c046d19b28a", "committedDate": "2020-03-09T12:52:21Z", "message": "cleanup unused variable"}, "afterCommit": {"oid": "e2c368aa5a7ce2bf502203de5c0f2396f4dbc0fa", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e2c368aa5a7ce2bf502203de5c0f2396f4dbc0fa", "committedDate": "2020-03-10T11:04:37Z", "message": "cleanup unused variable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e2c368aa5a7ce2bf502203de5c0f2396f4dbc0fa", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e2c368aa5a7ce2bf502203de5c0f2396f4dbc0fa", "committedDate": "2020-03-10T11:04:37Z", "message": "cleanup unused variable"}, "afterCommit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/b1922b23994b09fe2cf427769d93c833ff122f3f", "committedDate": "2020-03-10T14:52:47Z", "message": "cleanup unused variable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyNjk0MDMw", "url": "https://github.com/uyuni-project/uyuni/pull/1954#pullrequestreview-372694030", "createdAt": "2020-03-11T11:58:35Z", "commit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f"}, "state": "COMMENTED", "comments": {"totalCount": 8, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxMTo1ODozNVrOF0z98A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMVQxNToyNzoyNVrOF08H2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkyMTcxMg==", "bodyText": "I assume we will use this systemQuery later in some other PR, right?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r390921712", "createdAt": "2020-03-11T11:58:35Z", "author": {"login": "admd"}, "path": "java/code/src/com/redhat/rhn/common/messaging/MessageQueue.java", "diffHunk": "@@ -267,9 +268,9 @@ public static boolean isMessaging() {\n     /**\n      * Configures defaut messaging actions needed by RHN\n      * This method should be called directly after <code>startMessaging</code>.\n-     *\n+     * @param systemQuery instance for gathering data from a system.\n      */\n-    public static void configureDefaultActions() {\n+    public static void configureDefaultActions(SystemQuery systemQuery) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkyMjQwNA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Configures defaut messaging actions needed by RHN\n          \n          \n            \n                 * Configures default messaging actions needed by RHN", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r390922404", "createdAt": "2020-03-11T11:59:59Z", "author": {"login": "admd"}, "path": "java/code/src/com/redhat/rhn/common/messaging/MessageQueue.java", "diffHunk": "@@ -267,9 +268,9 @@ public static boolean isMessaging() {\n     /**\n      * Configures defaut messaging actions needed by RHN", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDkzNDk1NA==", "bodyText": "Nice to have this constructor but do we need it?  If not, let's add it when we need it.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r390934954", "createdAt": "2020-03-11T12:27:07Z", "author": {"login": "admd"}, "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/HandlerFactory.java", "diffHunk": "@@ -28,16 +82,103 @@\n  */\n \n public class HandlerFactory {\n-    private ManifestFactory factory;\n-    private static final String PKG_NAME = \"com.redhat.rhn.frontend.xmlrpc\";\n+    private final Map<String, BaseHandler> handlers;\n \n-    /** private constructor */\n+    /**\n+     *  Creates an empty HandlerFactory.\n+     */\n     public HandlerFactory() {\n-        this(new ClassBuilder(PKG_NAME, \"handler-manifest.xml\"));\n+        this.handlers = new HashMap<>();\n+    }\n+\n+    /**\n+     * Creates a HandlerFactory prepopulated with handlers.\n+     * @param handlersIn to add to the handler factory.\n+     */\n+    public HandlerFactory(Map<String, BaseHandler> handlersIn) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk1NTcxMA==", "bodyText": "Haven't tested it but wouldn't handlers.getHandler(namespace).getClass() always return java.util.Optional  class here?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r390955710", "createdAt": "2020-03-11T13:07:14Z", "author": {"login": "admd"}, "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/api/ApiHandler.java", "diffHunk": "@@ -83,17 +88,12 @@ private Collection getNamespaces() {\n      *        #prop_desc(\"string\", \"handler\", \"API Handler\")\n      *   #struct_end()\n      */\n-    public Map getApiNamespaces(User loggedInUser) {\n-        Map namespacesHash = new HashMap();\n-        HandlerFactory hf = new HandlerFactory();\n-\n-        Iterator i = getNamespaces().iterator();\n-        while (i.hasNext()) {\n-                String namespace = (String)i.next();\n-                namespacesHash.put(namespace, StringUtil.getClassNameNoPackage(\n-                                                hf.getHandler(namespace).getClass()));\n-        }\n-        return namespacesHash;\n+    public Map<String, String> getApiNamespaces(User loggedInUser) {\n+        return handlers.getKeys().stream().collect(Collectors.toMap(\n+           namespace -> namespace,\n+           namespace -> StringUtil.getClassNameNoPackage(\n+                       handlers.getHandler(namespace).getClass())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f"}, "originalPosition": 63}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDk2Mjg5OQ==", "bodyText": "We will be removing all of such methods, right?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r390962899", "createdAt": "2020-03-11T13:19:09Z", "author": {"login": "admd"}, "path": "java/code/src/com/redhat/rhn/manager/formula/FormulaManager.java", "diffHunk": "@@ -64,10 +65,10 @@ public static synchronized FormulaManager getInstance() {\n \n     /**\n      * This method is only for testing purpose.\n-     * @param saltServiceIn to set\n+     * @param systemQueryIn to set\n      */\n-    public void setSaltService(SaltService saltServiceIn) {\n-        this.saltService = saltServiceIn;\n+    public void setSystemQuery(SaltService systemQueryIn) {\n+        this.systemQuery = systemQueryIn;\n     }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f"}, "originalPosition": 35}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzMTY0Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param systemQueryIn the system to use\n          \n          \n            \n                 * @param systemQueryIn systemQuery instance for gathering data from a system.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r391031642", "createdAt": "2020-03-11T14:55:47Z", "author": {"login": "admd"}, "path": "java/code/src/com/suse/manager/reactor/messaging/MinionStartEventMessageAction.java", "diffHunk": "@@ -32,22 +32,15 @@\n     private static final Logger LOG = Logger.getLogger(MinionStartEventMessageAction.class);\n \n     // Reference to the SaltService instance\n-    private final SaltService SALT_SERVICE;\n+    private final SystemQuery systemQuery;\n \n     /**\n-     * Default constructor.\n-     */\n-    public MinionStartEventMessageAction() {\n-        this(SaltService.INSTANCE);\n-    }\n-\n-    /**\n-     * Constructor taking a {@link SaltService} instance.\n+     * Constructor taking a {@link SystemQuery} instance.\n      *\n-     * @param saltService the salt service to use\n+     * @param systemQueryIn the system to use", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTAzMjQxMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @param systemQueryIn the salt service to use\n          \n          \n            \n                 * @param systemQueryIn systemQuery instance for gathering data from a system.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r391032410", "createdAt": "2020-03-11T14:56:46Z", "author": {"login": "admd"}, "path": "java/code/src/com/suse/manager/reactor/messaging/RegisterMinionEventMessageAction.java", "diffHunk": "@@ -93,25 +93,18 @@\n             RegisterMinionEventMessageAction.class);\n \n     // Reference to the SaltService instance\n-    private final SaltService SALT_SERVICE;\n+    private final SystemQuery systemQuery;\n \n     private static final String FQDN = \"fqdn\";\n     private static final String TERMINALS_GROUP_NAME = \"TERMINALS\";\n \n     /**\n-     * Default constructor.\n-     */\n-    public RegisterMinionEventMessageAction() {\n-        this(SaltService.INSTANCE);\n-    }\n-\n-    /**\n-     * Constructor taking a {@link SaltService} instance.\n+     * Constructor taking a {@link SystemQuery} instance.\n      *\n-     * @param saltService the salt service to use\n+     * @param systemQueryIn the salt service to use", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA1NTMyMA==", "bodyText": "iface? Out of curiosity, what does it represent?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r391055320", "createdAt": "2020-03-11T15:27:25Z", "author": {"login": "admd"}, "path": "java/code/src/com/suse/manager/webui/services/iface/SystemQuery.java", "diffHunk": "@@ -0,0 +1,511 @@\n+/**\n+ * Copyright (c) 2020 SUSE LLC\n+ *\n+ * This software is licensed to you under the GNU General Public License,\n+ * version 2 (GPLv2). There is NO WARRANTY for this software, express or\n+ * implied, including the implied warranties of MERCHANTABILITY or FITNESS\n+ * FOR A PARTICULAR PURPOSE. You should have received a copy of GPLv2\n+ * along with this software; if not, see\n+ * http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.\n+ *\n+ * Red Hat trademarks are not licensed under GPLv2. No permission is\n+ * granted to use or replicate Red Hat trademarks that are incorporated\n+ * in this software or its documentation.\n+ */\n+package com.suse.manager.webui.services.iface;\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1922b23994b09fe2cf427769d93c833ff122f3f"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcyOTI3NDM2", "url": "https://github.com/uyuni-project/uyuni/pull/1954#pullrequestreview-372927436", "createdAt": "2020-03-11T16:31:48Z", "commit": {"oid": "7318c81c31a7397cf66421e0de2a4cc07f7860b8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7318c81c31a7397cf66421e0de2a4cc07f7860b8", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/7318c81c31a7397cf66421e0de2a4cc07f7860b8", "committedDate": "2020-03-11T16:27:46Z", "message": "fix ApiHandler"}, "afterCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4b1f6343ef5635bb1b4cf255d7113108be5a9ac9", "committedDate": "2020-03-12T12:45:03Z", "message": "fix ApiHandler"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc0ODA4NjU3", "url": "https://github.com/uyuni-project/uyuni/pull/1954#pullrequestreview-374808657", "createdAt": "2020-03-15T15:25:34Z", "commit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "state": "COMMENTED", "comments": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNToyNTozNFrOF2fitg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNVQxNzoyMDoyMlrOF2gIig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NDIxNA==", "bodyText": "Nitpicks:\n\nmethod name: as this returns a Factory (rather than a Collection of Handlers), shouldn't these be named something like getTestHandlerFactory/getDefaultHandlerFactory instead of mockHandlers/defaultHandlers?\nshouldn't mockHandlers ideally live in unit test code only? Are there cons with that?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392684214", "createdAt": "2020-03-15T15:25:34Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/HandlerFactory.java", "diffHunk": "@@ -28,16 +82,95 @@\n  */\n \n public class HandlerFactory {\n-    private ManifestFactory factory;\n-    private static final String PKG_NAME = \"com.redhat.rhn.frontend.xmlrpc\";\n+    private final Map<String, BaseHandler> handlers;\n \n-    /** private constructor */\n+    /**\n+     *  Creates an empty HandlerFactory.\n+     */\n     public HandlerFactory() {\n-        this(new ClassBuilder(PKG_NAME, \"handler-manifest.xml\"));\n+        this.handlers = new HashMap<>();\n+    }\n+\n+    /**\n+     * HandlerFactory prepopulated with unit test handlers.\n+     * @return HandlerFactory for unit tests.\n+     */\n+    public static HandlerFactory mockHandlers() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 89}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NTU4Ng==", "bodyText": "Code does not agree with comment any longer", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392685586", "createdAt": "2020-03-15T15:39:51Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/HandlerFactory.java", "diffHunk": "@@ -28,16 +82,95 @@\n  */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 69}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4Njg5MA==", "bodyText": "I wonder if we should allow using the non-mocked SaltService in test code (I understand this was the case even before this PR). What is your opinion?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392686890", "createdAt": "2020-03-15T15:54:07Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/system/test/SystemHandlerTest.java", "diffHunk": "@@ -1859,7 +1860,11 @@ public void testSetDetailsBaseEntitlementAsNonOrgAdmin() throws Exception {\n     }\n \n     public void testAddEntitlements() throws Exception {\n-        Server server = ServerTestUtils.createVirtHostWithGuests(admin, 0);\n+        SystemEntitlementManager systemEntitlementManager = new SystemEntitlementManager(\n+                new SystemUnentitler(),\n+                new SystemEntitler(SaltService.INSTANCE)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4NzY5NA==", "bodyText": "I wonder if returning Optional is the right choice here, as I see that basically all call sites immediately use get() on the result.\nHow about instead throwing an unchecked, descriptive Exception here that will result in something like \"handlerName not found\" in logs, instead of NPE, whenever handlers.get yields null - thereby avoiding the Optional wrapping?\nWhat do you think, what would be pros and cons?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392687694", "createdAt": "2020-03-15T16:03:22Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/HandlerFactory.java", "diffHunk": "@@ -46,15 +179,15 @@ protected HandlerFactory(ClassBuilder builder) {\n      * @param handlerName the name of the handler\n      * @return Object of the handler in question.\n      */\n-    public BaseHandler getHandler(String handlerName) {\n-        return (BaseHandler)factory.getObject(handlerName);\n+    public Optional<BaseHandler> getHandler(String handlerName) {\n+        return Optional.ofNullable(handlers.get(handlerName));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 177}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY4OTQxNg==", "bodyText": "Should we move this outside the webui package? This sounds to me as not tied to the UI at all.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392689416", "createdAt": "2020-03-15T16:23:10Z", "author": {"login": "moio"}, "path": "java/code/src/com/suse/manager/webui/services/iface/SystemQuery.java", "diffHunk": "@@ -0,0 +1,511 @@\n+/**\n+ * Copyright (c) 2020 SUSE LLC\n+ *\n+ * This software is licensed to you under the GNU General Public License,\n+ * version 2 (GPLv2). There is NO WARRANTY for this software, express or\n+ * implied, including the implied warranties of MERCHANTABILITY or FITNESS\n+ * FOR A PARTICULAR PURPOSE. You should have received a copy of GPLv2\n+ * along with this software; if not, see\n+ * http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.\n+ *\n+ * Red Hat trademarks are not licensed under GPLv2. No permission is\n+ * granted to use or replicate Red Hat trademarks that are incorporated\n+ * in this software or its documentation.\n+ */\n+package com.suse.manager.webui.services.iface;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5MDc0MA==", "bodyText": "I have to say I felt a bit confused with the name of this interface. My sense of confusion comes from two aspects.\nFirst: in English, \"query\" by and large means \"question\" (see wiktionary), which is not really what we have here. Classes implementing this interface sound more to me like a \"query acceptors\", \"query processors\", \"system information retrievers\" - if we exclude ping, acceptKey/rejectKey and similar methods which are not really \"read-only\".\n\"Querier\" sounds a bit strange but would fit at least for me, at least for the \"read-only\" methods. \"Writing\" methods could be given an \"Actuator\" name or something similar, with SaltService implementing both. How does that feel to you?\nSecond problem, is that at least now I see this as quite coupled with Salt (acceptKey, getFingerprints, refreshPillar...), so I am not sure we want to give it an overgeneral name at least for now. How about using Minion or SaltClient as the prefix instead of System?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392690740", "createdAt": "2020-03-15T16:38:44Z", "author": {"login": "moio"}, "path": "java/code/src/com/suse/manager/webui/services/iface/SystemQuery.java", "diffHunk": "@@ -0,0 +1,511 @@\n+/**\n+ * Copyright (c) 2020 SUSE LLC\n+ *\n+ * This software is licensed to you under the GNU General Public License,\n+ * version 2 (GPLv2). There is NO WARRANTY for this software, express or\n+ * implied, including the implied warranties of MERCHANTABILITY or FITNESS\n+ * FOR A PARTICULAR PURPOSE. You should have received a copy of GPLv2\n+ * along with this software; if not, see\n+ * http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.\n+ *\n+ * Red Hat trademarks are not licensed under GPLv2. No permission is\n+ * granted to use or replicate Red Hat trademarks that are incorporated\n+ * in this software or its documentation.\n+ */\n+package com.suse.manager.webui.services.iface;\n+\n+import com.google.gson.JsonObject;\n+import com.google.gson.reflect.TypeToken;\n+import com.google.gson.JsonElement;\n+import com.redhat.rhn.domain.server.MinionServer;\n+import com.suse.manager.reactor.SaltReactor;\n+import com.suse.manager.virtualization.GuestDefinition;\n+import com.suse.manager.virtualization.PoolCapabilitiesJson;\n+import com.suse.manager.virtualization.PoolDefinition;\n+import com.suse.manager.webui.services.impl.SaltSSHService;\n+import com.suse.manager.webui.services.impl.SaltService;\n+import com.suse.manager.webui.services.impl.runner.MgrK8sRunner;\n+import com.suse.manager.webui.services.impl.runner.MgrUtilRunner;\n+import com.suse.manager.webui.utils.gson.BootstrapParameters;\n+import com.suse.manager.webui.utils.salt.custom.ScheduleMetadata;\n+import com.suse.salt.netapi.calls.LocalAsyncResult;\n+import com.suse.salt.netapi.calls.LocalCall;\n+import com.suse.salt.netapi.calls.modules.SaltUtil;\n+import com.suse.salt.netapi.calls.modules.State;\n+import com.suse.salt.netapi.calls.modules.Zypper;\n+import com.suse.salt.netapi.calls.runner.Jobs;\n+import com.suse.salt.netapi.calls.wheel.Key;\n+import com.suse.salt.netapi.datatypes.target.MinionList;\n+import com.suse.salt.netapi.datatypes.target.Target;\n+import com.suse.salt.netapi.errors.GenericError;\n+import com.suse.salt.netapi.event.EventStream;\n+import com.suse.salt.netapi.exception.SaltException;\n+import com.suse.salt.netapi.results.Result;\n+import com.suse.salt.netapi.results.SSHResult;\n+\n+import java.time.LocalDateTime;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.CompletionStage;\n+\n+/**\n+ * Interface containing methods for directly interacting and getting information from a system.\n+ * Note: This interface should be split up further at some point.\n+ */\n+public interface SystemQuery {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5MTIyOA==", "bodyText": "This seems to be dead code now (as it should be!)\nConsider removing.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392691228", "createdAt": "2020-03-15T16:45:02Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/manager/system/entitling/SystemEntitler.java", "diffHunk": "@@ -330,6 +330,6 @@ else if (toolsChannel == null) {\n      * @param saltServiceIn The SaltService\n      */\n     public void setSaltService(SaltService saltServiceIn) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5MTk5Ng==", "bodyText": "Isn't this pattern more brittle to future changes that require more functionality from SaltService?\nBefore: one only whitelists methods available from mocked class. If an unexpected method is called, it fails immediately\nAfter: one uses the real class, but overwrites some methods. New calls might go undetected, or it might be more difficult to see why they fail\nAm I missing something? Do you see other pros I am currently not seeing?", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392691996", "createdAt": "2020-03-15T16:55:21Z", "author": {"login": "moio"}, "path": "java/code/src/com/suse/manager/matcher/test/MatcherJsonIOTest.java", "diffHunk": "@@ -65,19 +68,22 @@\n     private static final String AMD64_ARCH = \"amd64\";\n     private static final String S390_ARCH = \"s390\";\n     private static final String PPC64LE_ARCH = \"ppc64le\";\n+    private SystemEntitlementManager systemEntitlementManager;\n \n     @Override\n     public void setUp() throws Exception {\n         super.setUp();\n         setImposteriser(ClassImposteriser.INSTANCE);\n \n-        SaltService saltServiceMock = context().mock(SaltService.class);\n-        context().checking(new Expectations() {{\n-            allowing(saltServiceMock).callSync(\n-                    with(any(LocalCall.class)),\n-                    with(any(String.class)));\n-        }});\n-        SystemEntitler.INSTANCE.setSaltService(saltServiceMock);\n+        SaltService saltServiceMock = new SaltService() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 36}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5MjE2MQ==", "bodyText": "Do we even need this class now? All functionality is completely delegated to SystemQuery at this point.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392692161", "createdAt": "2020-03-15T16:57:00Z", "author": {"login": "moio"}, "path": "java/code/src/com/suse/manager/virtualization/VirtManager.java", "diffHunk": "@@ -16,24 +16,25 @@\n \n import com.google.gson.JsonElement;\n import com.google.gson.JsonObject;\n-import com.google.gson.reflect.TypeToken;\n-import com.suse.manager.webui.services.impl.SaltService;\n-import com.suse.salt.netapi.calls.LocalCall;\n+import com.suse.manager.webui.services.iface.SystemQuery;\n \n-import java.util.Arrays;\n-import java.util.HashMap;\n-import java.util.LinkedHashMap;\n-import java.util.List;\n import java.util.Map;\n import java.util.Optional;\n-import java.util.stream.Collectors;\n \n /**\n  * Service providing utility functions to handle virtual machines.\n  */\n public class VirtManager {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5MzU1NQ==", "bodyText": "What motivated the choice of using one thread here, given original code allocated 5?\nhttps://github.com/uyuni-project/uyuni/blob/4.1-alpha1/java/code/src/com/suse/manager/webui/services/impl/SaltService.java#L155\nUnrelated note: SaltService.scheduledExecutorService seems to be dead code now.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392693555", "createdAt": "2020-03-15T17:15:47Z", "author": {"login": "moio"}, "path": "java/code/src/com/suse/manager/webui/services/FutureUtils.java", "diffHunk": "@@ -0,0 +1,49 @@\n+/**\n+ * Copyright (c) 2020 SUSE LLC\n+ *\n+ * This software is licensed to you under the GNU General Public License,\n+ * version 2 (GPLv2). There is NO WARRANTY for this software, express or\n+ * implied, including the implied warranties of MERCHANTABILITY or FITNESS\n+ * FOR A PARTICULAR PURPOSE. You should have received a copy of GPLv2\n+ * along with this software; if not, see\n+ * http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt.\n+ *\n+ * Red Hat trademarks are not licensed under GPLv2. No permission is\n+ * granted to use or replicate Red Hat trademarks that are incorporated\n+ * in this software or its documentation.\n+ */\n+package com.suse.manager.webui.services;\n+\n+import java.util.concurrent.CompletableFuture;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.ScheduledExecutorService;\n+import java.util.concurrent.TimeUnit;\n+import java.util.concurrent.TimeoutException;\n+\n+/**\n+ * Class providing utility methods for futures.\n+ */\n+public class FutureUtils {\n+\n+    private static final ScheduledExecutorService SCHEDULED_EXECUTOR_SERVICE =\n+            Executors.newScheduledThreadPool(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjY5Mzg5OA==", "bodyText": "Nitpick: I'd suggest to either have this tag on all public methods or just remove it everywhere.", "url": "https://github.com/uyuni-project/uyuni/pull/1954#discussion_r392693898", "createdAt": "2020-03-15T17:20:22Z", "author": {"login": "moio"}, "path": "java/code/src/com/suse/manager/webui/services/impl/SaltService.java", "diffHunk": "@@ -226,6 +239,72 @@ public void setReactor(SaltReactor reactorIn) {\n         }\n     }\n \n+    @Override\n+    public Optional<Map<String, JsonElement>> getCapabilities(String minionId) {\n+        LocalCall<Map<String, JsonElement>> call =\n+                new LocalCall<>(\"virt.all_capabilities\", Optional.empty(), Optional.empty(),\n+                        new TypeToken<Map<String, JsonElement>>() { });\n+\n+        return callSync(call, minionId);\n+    }\n+\n+    @Override\n+    public Map<String, JsonObject> getNetworks(String minionId) {\n+        Map<String, Object> args = new LinkedHashMap<>();\n+        LocalCall<Map<String, JsonElement>> call =\n+                new LocalCall<>(\"virt.network_info\", Optional.empty(), Optional.of(args),\n+                        new TypeToken<Map<String, JsonElement>>() { });\n+\n+        Optional<Map<String, JsonElement>> nets = callSync(call, minionId);\n+        Map<String, JsonElement> result = nets.orElse(new HashMap<String, JsonElement>());\n+\n+        // Workaround: Filter out the entries that don't match since we may get a retcode=0 one.\n+        return result.entrySet().stream()\n+                .filter(entry -> entry.getValue().isJsonObject())\n+                .collect(Collectors.toMap(entry -> entry.getKey(), entry -> entry.getValue().getAsJsonObject()));\n+    }\n+\n+    /**\n+     * {@inheritDoc}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4b1f6343ef5635bb1b4cf255d7113108be5a9ac9"}, "originalPosition": 126}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "91422822492f3a8b314e716f7224ba560376219d", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/91422822492f3a8b314e716f7224ba560376219d", "committedDate": "2020-03-17T09:56:08Z", "message": "throw descriptive error message when handler does not exist."}, "afterCommit": {"oid": "4b40ef3d41dc7e2da404823be1fb706a57f72e43", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4b40ef3d41dc7e2da404823be1fb706a57f72e43", "committedDate": "2020-03-17T10:09:50Z", "message": "throw descriptive error message when handler does not exist."}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "558a7b615d301b5b5491cfa8956cb7bd1af7a37d", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/558a7b615d301b5b5491cfa8956cb7bd1af7a37d", "committedDate": "2020-03-17T10:32:43Z", "message": "remove now unused imports"}, "afterCommit": {"oid": "55681ddadbbcbdeb3ddfccd20bc157334406ced5", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/55681ddadbbcbdeb3ddfccd20bc157334406ced5", "committedDate": "2020-03-17T10:44:55Z", "message": "remove now unused imports"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "96ea37e1e6a08662d299db37f9958d307519002f", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/96ea37e1e6a08662d299db37f9958d307519002f", "committedDate": "2020-03-19T16:34:20Z", "message": "extract salt operations into interface"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c3280563c4ce60f266b90a97ba6ee90f43a1e32", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/6c3280563c4ce60f266b90a97ba6ee90f43a1e32", "committedDate": "2020-03-19T16:34:24Z", "message": "extract failAfter to utility class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c7674308e100375e3200ca30ad6cf3a49e0eaad", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9c7674308e100375e3200ca30ad6cf3a49e0eaad", "committedDate": "2020-03-19T16:34:24Z", "message": "refine getAllContainers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73c001245a12914cdd1a2ea785add39ee5765026", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/73c001245a12914cdd1a2ea785add39ee5765026", "committedDate": "2020-03-19T16:34:24Z", "message": "replace callAsync with specific methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "761545bae5f7094f65df1f983b347d73aaf6f4f7", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/761545bae5f7094f65df1f983b347d73aaf6f4f7", "committedDate": "2020-03-19T16:34:24Z", "message": "replace callSync with more specific methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a319bba8fbe3b8d2dff70ffaf2c4e267f7557850", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/a319bba8fbe3b8d2dff70ffaf2c4e267f7557850", "committedDate": "2020-03-19T16:34:25Z", "message": "replace callSync with more specific methods (part1)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82fe6b8b4767f2edc3c4508403c40fee55c36fd8", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/82fe6b8b4767f2edc3c4508403c40fee55c36fd8", "committedDate": "2020-03-19T16:34:25Z", "message": "bootstrap ImageBuildController"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "321c079ad2f994dc94c1c5aec1308492c2029627", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/321c079ad2f994dc94c1c5aec1308492c2029627", "committedDate": "2020-03-19T16:34:25Z", "message": "bootstrap Virtual*Controller"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c08092609eac1b3dec2df2909f98a7f423423b9a", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c08092609eac1b3dec2df2909f98a7f423423b9a", "committedDate": "2020-03-19T16:34:25Z", "message": "bootstrap SystemController"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6505614dd5727092320348bc3bc882e32532ab0f", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/6505614dd5727092320348bc3bc882e32532ab0f", "committedDate": "2020-03-19T16:34:25Z", "message": "bootstrap remaining MessageAction classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44f85c1ea3bef47a6c0b8a10dac53f30d95328d3", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/44f85c1ea3bef47a6c0b8a10dac53f30d95328d3", "committedDate": "2020-03-19T16:34:25Z", "message": "fix compile error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "76dd898667fd17972548117fc344f6b91f5b1ee4", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/76dd898667fd17972548117fc344f6b91f5b1ee4", "committedDate": "2020-03-19T16:34:25Z", "message": "remove reflective handler instanciation to prepare for passing dependnecies to handlers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7cefb0824ddb9dbc14d440faa04c3c2918791efd", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/7cefb0824ddb9dbc14d440faa04c3c2918791efd", "committedDate": "2020-03-19T16:34:26Z", "message": "bootstrap SaltSSHController"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "77181ce0c295f61eeb3e4faf1abc45f1fe084909", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/77181ce0c295f61eeb3e4faf1abc45f1fe084909", "committedDate": "2020-03-19T16:34:26Z", "message": "bootstrap NotificationMessageController"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a886965f5ae99d3492fe05e8a4cfe88e5ca2a29", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/7a886965f5ae99d3492fe05e8a4cfe88e5ca2a29", "committedDate": "2020-03-19T16:34:26Z", "message": "bootstrap RefreshPillarEventAction"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a8b2bb89c1d79e2468d2f074f6a6f1d57d64323", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8a8b2bb89c1d79e2468d2f074f6a6f1d57d64323", "committedDate": "2020-03-19T16:34:26Z", "message": "fix tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "388fe503c889697beaa528331f474105f6e278ff", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/388fe503c889697beaa528331f474105f6e278ff", "committedDate": "2020-03-19T16:34:26Z", "message": "fix checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "30c2708a67161c11e650c989bc3a1b50e8cad91d", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/30c2708a67161c11e650c989bc3a1b50e8cad91d", "committedDate": "2020-03-19T16:34:26Z", "message": "fix copyright date"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cf164a9ef7bad2171dd77c732b4e0d4a5324218", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9cf164a9ef7bad2171dd77c732b4e0d4a5324218", "committedDate": "2020-03-19T16:34:26Z", "message": "unify indentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5be9986706941ea6f4c658cee6ba811a45ed66b", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/f5be9986706941ea6f4c658cee6ba811a45ed66b", "committedDate": "2020-03-19T16:34:26Z", "message": "rename saltService variables to systemQuery"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8fe447825cd3793cff544b880c5af47dc6f3de7d", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8fe447825cd3793cff544b880c5af47dc6f3de7d", "committedDate": "2020-03-19T16:34:27Z", "message": "move SystemQuery to services.iface package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8a93daaa07d046901bfab78371ed97cb5d9487bd", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/8a93daaa07d046901bfab78371ed97cb5d9487bd", "committedDate": "2020-03-19T16:34:27Z", "message": "cleanup unused variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "86f3b9e51b3249f2bc0b1998698c3fcef86a5df3", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/86f3b9e51b3249f2bc0b1998698c3fcef86a5df3", "committedDate": "2020-03-19T16:34:27Z", "message": "Fix typo\n\nCo-Authored-By: Abid Mehmood <amehmood@suse.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4d6c78007a0841fc45ac1e571a06bca1ea721e3", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/a4d6c78007a0841fc45ac1e571a06bca1ea721e3", "committedDate": "2020-03-19T16:34:27Z", "message": "Fix javadoc\n\nCo-Authored-By: Abid Mehmood <amehmood@suse.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a4f517d126109832890c2d8175dceabbd0dec19", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/5a4f517d126109832890c2d8175dceabbd0dec19", "committedDate": "2020-03-19T16:34:27Z", "message": "Fix javadoc\n\nCo-Authored-By: Abid Mehmood <amehmood@suse.de>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de23aab71019068ec6d8495d7d0908bd8adcabd8", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/de23aab71019068ec6d8495d7d0908bd8adcabd8", "committedDate": "2020-03-19T16:34:27Z", "message": "remove unused unused parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "dcf798d7e2efea78698ff3c4867604e5ab555ad7", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/dcf798d7e2efea78698ff3c4867604e5ab555ad7", "committedDate": "2020-03-19T16:34:27Z", "message": "remove unused constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6bbace31e3f55a877cf2d499ad289b10c188af75", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/6bbace31e3f55a877cf2d499ad289b10c188af75", "committedDate": "2020-03-19T16:34:27Z", "message": "fix ApiHandler"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6b818ac91278681705b91463f48afd48e3176c6d", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/6b818ac91278681705b91463f48afd48e3176c6d", "committedDate": "2020-03-19T16:34:28Z", "message": "remove unused code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d49933650993519cbb362ee4b9a3ee198a293cdb", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/d49933650993519cbb362ee4b9a3ee198a293cdb", "committedDate": "2020-03-19T16:34:28Z", "message": "use inheritDoc consistently"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2787082afd936cb3216d4580832cac8e6ba6f5e", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/d2787082afd936cb3216d4580832cac8e6ba6f5e", "committedDate": "2020-03-19T16:34:28Z", "message": "rename handler factory methods and move mocking to test package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be8df239ec17ba376e3e65167971953a22849671", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/be8df239ec17ba376e3e65167971953a22849671", "committedDate": "2020-03-19T16:34:28Z", "message": "throw descriptive error message when handler does not exist."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f8f85a6c0b0c831d3771c77612630c3627614ed", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/0f8f85a6c0b0c831d3771c77612630c3627614ed", "committedDate": "2020-03-19T16:34:28Z", "message": "remove now unused imports"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "55681ddadbbcbdeb3ddfccd20bc157334406ced5", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/55681ddadbbcbdeb3ddfccd20bc157334406ced5", "committedDate": "2020-03-17T10:44:55Z", "message": "remove now unused imports"}, "afterCommit": {"oid": "0f8f85a6c0b0c831d3771c77612630c3627614ed", "author": {"user": {"login": "lucidd", "name": "Kevin Walter"}}, "url": "https://github.com/uyuni-project/uyuni/commit/0f8f85a6c0b0c831d3771c77612630c3627614ed", "committedDate": "2020-03-19T16:34:28Z", "message": "remove now unused imports"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1699, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}