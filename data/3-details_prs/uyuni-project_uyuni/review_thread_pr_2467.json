{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU5OTU2Nzk0", "number": 2467, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozMjoxM1rOEZOsKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTo0MjozN1rOEZO3Ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0ODkwNTM2OnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/common/conf/ConfigDefaults.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozMjoxM1rOHB7lOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozMjoxM1rOHB7lOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4NjgxMA==", "bodyText": "Comment does not seem to agree with code", "url": "https://github.com/uyuni-project/uyuni/pull/2467#discussion_r471786810", "createdAt": "2020-08-17T21:32:13Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/common/conf/ConfigDefaults.java", "diffHunk": "@@ -324,6 +324,11 @@\n      */\n     public static final String AUTOMATIC_SYSTEM_LOCK_CLUSTER_NODES_ENABLED = \"java.automatic_system_lock_cluster_nodes\";\n \n+    /**\n+     * Indicates the salt-api host to connect to (host", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e4f2277afb265db4f7772f85b5a9a21049ccfb"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0ODkxOTkwOnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/errata/ErrataHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozNzozNFrOHB7uDA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozNzozNFrOHB7uDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4OTA2OA==", "bodyText": "Maybe you can inline this 2-parameter variant, since it's only called once.", "url": "https://github.com/uyuni-project/uyuni/pull/2467#discussion_r471789068", "createdAt": "2020-08-17T21:37:34Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/errata/ErrataHandler.java", "diffHunk": "@@ -1384,19 +1402,34 @@ public Errata publishAsOriginal(User loggedInUser, String advisory,\n      * @return a List of channel objects\n      */\n     private List<Channel> verifyChannelList(List<String> channelsLabels, User user) {\n+        return verifyChannelList(channelsLabels, user, Collections.emptyList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e4f2277afb265db4f7772f85b5a9a21049ccfb"}, "originalPosition": 79}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0ODkyMDg1OnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/errata/ErrataHandler.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozNzo1NFrOHB7uog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTozNzo1NFrOHB7uog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc4OTIxOA==", "bodyText": "Maybe add Javadoc for vendorChannelOverride", "url": "https://github.com/uyuni-project/uyuni/pull/2467#discussion_r471789218", "createdAt": "2020-08-17T21:37:54Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/errata/ErrataHandler.java", "diffHunk": "@@ -1384,19 +1402,34 @@ public Errata publishAsOriginal(User loggedInUser, String advisory,\n      * @return a List of channel objects\n      */\n     private List<Channel> verifyChannelList(List<String> channelsLabels, User user) {\n+        return verifyChannelList(channelsLabels, user, Collections.emptyList());\n+    }\n+\n+    /**\n+     * Verify a list of channels labels, and populate their corresponding\n+     *      Channel objects into a List.  This is primarily used before publishing\n+     *      to verify all channels are valid before starting the errata creation\n+     * @param channelsLabels the List of channel labels to verify\n+     * @return a List of channel objects", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e4f2277afb265db4f7772f85b5a9a21049ccfb"}, "originalPosition": 87}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk0ODkzMzcxOnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/manager/channel/ChannelManager.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTo0MjozN1rOHB72eg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xN1QyMTo0MjozN1rOHB72eg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTc5MTIyNg==", "bodyText": "I would suggest to add a bit more descriptive string here, such as \"Package IDs ... added to vendor channel...\" (just like you did above for the errata editing).", "url": "https://github.com/uyuni-project/uyuni/pull/2467#discussion_r471791226", "createdAt": "2020-08-17T21:42:37Z", "author": {"login": "moio"}, "path": "java/code/src/com/redhat/rhn/manager/channel/ChannelManager.java", "diffHunk": "@@ -2421,16 +2421,27 @@ public static void disassociateChannelEntries(Channel c) {\n     public static void addPackages(Channel chan, List<Long> packageIds, User user) {\n \n         if (!UserManager.verifyChannelAdmin(user, chan)) {\n-            StringBuilder msg = new StringBuilder(\"User: \");\n-            msg.append(user.getLogin());\n-            msg.append(\" does not have channel admin access to channel: \");\n-            msg.append(chan.getLabel());\n-\n-            LocalizationService ls = LocalizationService.getInstance();\n-            PermissionException pex = new PermissionException(msg.toString());\n-            pex.setLocalizedTitle(ls.getMessage(\"permission.jsp.title.channel\"));\n-            pex.setLocalizedSummary(ls.getMessage(\"permission.jsp.summary.channel\"));\n-            throw pex;\n+            List<String> allowedList = Config.get().getList(ConfigDefaults.ALLOW_ADDING_PATCHES_VIA_API);\n+            if (chan.isVendorChannel() && allowedList.contains(chan.getLabel())) {\n+                log.warn(\"Channel: \" + chan.getLabel() +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c3e4f2277afb265db4f7772f85b5a9a21049ccfb"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4091, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}