{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4OTY5OTQ2", "number": 2416, "title": "Fix rhel clones products detection", "bodyText": "What does this PR change?\nFix product detection for CentOS and Oracle Linux.\nGUI diff\n\n DONE\n\nDocumentation\n\n\nNo documentation needed: should now behave like documented\n\n\n DONE\n\n\nTest coverage\n\n\nUnit tests were adapted\n\n\n DONE\n\n\nLinks\nFixes SUSE/spacewalk#11873\nTracks # add downstream PR, if any\n\n DONE\n\nChangelogs\nIf you don't need a changelog check, please mark this checkbox:\n\n No changelog needed\n\nIf you uncheck the checkbox after the PR is created, you will need to re-run changelog_test (see below)\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_lint_checkstyle\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-07-14T15:57:36Z", "url": "https://github.com/uyuni-project/uyuni/pull/2416", "merged": true, "mergeCommit": {"oid": "6dd91c635b5d43da1a192083c1a63ec06d25d301"}, "closed": true, "closedAt": "2020-07-20T14:33:58Z", "author": {"login": "mcalmer"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc119z2gFqTQ1MDYxODc1OQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc2ygToAFqTQ1MTY2MDA4Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNjE4NzU5", "url": "https://github.com/uyuni-project/uyuni/pull/2416#pullrequestreview-450618759", "createdAt": "2020-07-17T12:35:11Z", "commit": {"oid": "543176b6fceb8b9cd1b5feedcd3365d0dc411415"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMjozNToxMVrOGzRQrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMjozNToxMVrOGzRQrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQxMzM1OA==", "bodyText": "Tested on Oracle Linux and with Salt 3000 the os grain is OEL.", "url": "https://github.com/uyuni-project/uyuni/pull/2416#discussion_r456413358", "createdAt": "2020-07-17T12:35:11Z", "author": {"login": "mateiw"}, "path": "java/code/src/com/suse/manager/reactor/messaging/RegistrationUtils.java", "diffHunk": "@@ -363,12 +363,14 @@ public static void subscribeMinionToChannels(SystemQuery systemQuery, MinionServ\n                     })).collect(toSet());\n         }\n         else if (\"redhat\".equalsIgnoreCase(grains.getValueAsString(OS)) ||\n-                \"centos\".equalsIgnoreCase(grains.getValueAsString(OS))) {\n+                 \"centos\".equalsIgnoreCase(grains.getValueAsString(OS)) ||\n+                 \"oracle\".equalsIgnoreCase(grains.getValueAsString(OS))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "543176b6fceb8b9cd1b5feedcd3365d0dc411415"}, "originalPosition": 6}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwODEwNDAw", "url": "https://github.com/uyuni-project/uyuni/pull/2416#pullrequestreview-450810400", "createdAt": "2020-07-17T16:49:25Z", "commit": {"oid": "543176b6fceb8b9cd1b5feedcd3365d0dc411415"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNjo0OToyNVrOGzaE7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxNjo0OToyNVrOGzaE7A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjU1NzgwNA==", "bodyText": "In the DB the name of the product is one of oraclelinux-6, oraclelinux-7 or oraclelinux-8 but this method will look for the product by the lower cased name i.e. oraclelinux", "url": "https://github.com/uyuni-project/uyuni/pull/2416#discussion_r456557804", "createdAt": "2020-07-17T16:49:25Z", "author": {"login": "mateiw"}, "path": "java/code/src/com/suse/manager/reactor/utils/RhelUtils.java", "diffHunk": "@@ -207,6 +222,11 @@ public String getRelease() {\n                     majorVersion, release, arch));\n         }\n \n+        // next check if OracleLinux\n+        if (oracleReleaseFile.filter(StringUtils::isNotBlank).isPresent()) {\n+            return oracleReleaseFile.map(v -> detectPlainRHEL(v, arch, \"OracleLinux\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "543176b6fceb8b9cd1b5feedcd3365d0dc411415"}, "originalPosition": 86}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "543176b6fceb8b9cd1b5feedcd3365d0dc411415", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/543176b6fceb8b9cd1b5feedcd3365d0dc411415", "committedDate": "2020-07-16T11:13:58Z", "message": "update changelogs"}, "afterCommit": {"oid": "c960b59aed006fd88bc0900ab3fa8a8b3f3defee", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c960b59aed006fd88bc0900ab3fa8a8b3f3defee", "committedDate": "2020-07-18T11:11:15Z", "message": "update changelogs"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c960b59aed006fd88bc0900ab3fa8a8b3f3defee", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c960b59aed006fd88bc0900ab3fa8a8b3f3defee", "committedDate": "2020-07-18T11:11:15Z", "message": "update changelogs"}, "afterCommit": {"oid": "e8fad9ccb9f4b67d3b8a6681556c8b408fd13e1d", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e8fad9ccb9f4b67d3b8a6681556c8b408fd13e1d", "committedDate": "2020-07-18T11:14:59Z", "message": "update changelog"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e8fad9ccb9f4b67d3b8a6681556c8b408fd13e1d", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/e8fad9ccb9f4b67d3b8a6681556c8b408fd13e1d", "committedDate": "2020-07-18T11:14:59Z", "message": "update changelog"}, "afterCommit": {"oid": "c5fafe25a6e6e2f7d826c9798a664efff358969b", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c5fafe25a6e6e2f7d826c9798a664efff358969b", "committedDate": "2020-07-18T11:17:33Z", "message": "update changelog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06e993e5be24d9729fcc4dc714fcdce929dc33be", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/06e993e5be24d9729fcc4dc714fcdce929dc33be", "committedDate": "2020-07-20T12:59:10Z", "message": "fix redhat-release test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a111be31d3d4cb391b89769e16a9a39375fa331", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/2a111be31d3d4cb391b89769e16a9a39375fa331", "committedDate": "2020-07-20T12:59:10Z", "message": "remove versions from product identifier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd2b2822c00dfe25bd3f833a74a2f70e1da5678d", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/cd2b2822c00dfe25bd3f833a74a2f70e1da5678d", "committedDate": "2020-07-20T12:59:10Z", "message": "find SUSE Products for RedHat clones"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "860249042f6232f6a40badc6ee0513a4a6998a9e", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/860249042f6232f6a40badc6ee0513a4a6998a9e", "committedDate": "2020-07-20T12:59:10Z", "message": "parse and handle oracle-release file to detect OracleLinux"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c835007aaf92e7238925cea002415d81a2797942", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c835007aaf92e7238925cea002415d81a2797942", "committedDate": "2020-07-20T12:59:10Z", "message": "get oracle-release content if exists"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4042690c4ee2d978b1b5641b13bc183f189b63d1", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/4042690c4ee2d978b1b5641b13bc183f189b63d1", "committedDate": "2020-07-20T12:59:10Z", "message": "parse oracle and centos release and return also RedHat like products"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "97bce9437bc67c3e4c19e8db0adf0ca9ac2799b2", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/97bce9437bc67c3e4c19e8db0adf0ca9ac2799b2", "committedDate": "2020-07-20T12:59:45Z", "message": "update changelogs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "538511d621b96bdedacfb0380da5e63dd80318c1", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/538511d621b96bdedacfb0380da5e63dd80318c1", "committedDate": "2020-07-20T12:59:47Z", "message": "fix centos detection"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6b629c63b0fe2f605bd98174692feb795581cf1", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c6b629c63b0fe2f605bd98174692feb795581cf1", "committedDate": "2020-07-20T13:00:09Z", "message": "update changelog"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9e050df333986002694c4de83c909fe6b1f92f1e", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9e050df333986002694c4de83c909fe6b1f92f1e", "committedDate": "2020-07-20T08:24:56Z", "message": "fixup! update changelog"}, "afterCommit": {"oid": "c6b629c63b0fe2f605bd98174692feb795581cf1", "author": {"user": {"login": "mcalmer", "name": "Michael Calmer"}}, "url": "https://github.com/uyuni-project/uyuni/commit/c6b629c63b0fe2f605bd98174692feb795581cf1", "committedDate": "2020-07-20T13:00:09Z", "message": "update changelog"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxNjYwMDgz", "url": "https://github.com/uyuni-project/uyuni/pull/2416#pullrequestreview-451660083", "createdAt": "2020-07-20T14:28:32Z", "commit": {"oid": "c6b629c63b0fe2f605bd98174692feb795581cf1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1219, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}