{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE3Mzg0Nzcw", "number": 2210, "title": "Testsuite - run zypper refresh only when repos are enabled", "bodyText": "What does this PR change?\nThis PR fixes failure in cleanup step I disable repositories after installing Docker in scenario Bootstrap a Salt minion via the GUI using SSH key.\nThere is no need to run zypper refresh, when no repositories are enabled.\nLinks\nRelated CI run\nChangelogs\nIf you don't need a changelog check, please mark this checkbox:\n\n No changelog needed\n\nIf you uncheck the checkbox after the PR is created, you will need to re-run changelog_test (see below)\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_lint_checkstyle\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"ruby_rubocop\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-05-13T14:02:22Z", "url": "https://github.com/uyuni-project/uyuni/pull/2210", "merged": true, "mergeCommit": {"oid": "d94e9559445e5f25197ae2bfb5e2177f36ff6934"}, "closed": true, "closedAt": "2020-05-13T14:50:37Z", "author": {"login": "lkotek"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcg5SfvgH2gAyNDE3Mzg0NzcwOmM3ZjE5YzkxMzNiZTdmMTllMTIzNDRkYTU2YjhlYjY0ZGJiODA3NGM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABchIkYtAFqTQxMTU0MzU0OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "c7f19c9133be7f19e12344da56b8eb64dbb8074c", "author": {"user": null}, "url": "https://github.com/uyuni-project/uyuni/commit/c7f19c9133be7f19e12344da56b8eb64dbb8074c", "committedDate": "2020-05-13T13:56:27Z", "message": "run refresh only when repos are enabled"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwOTYyOTk3", "url": "https://github.com/uyuni-project/uyuni/pull/2210#pullrequestreview-410962997", "createdAt": "2020-05-13T14:08:53Z", "commit": {"oid": "c7f19c9133be7f19e12344da56b8eb64dbb8074c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNDowODo1M1rOGUzbyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xM1QxNDowODo1M1rOGUzbyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDQ2NzQwMA==", "bodyText": "I guess his only needed when the client tools come from D:G:M:* projects?\nOtherwise, why would we need to do the import and the refresh manually?", "url": "https://github.com/uyuni-project/uyuni/pull/2210#discussion_r424467400", "createdAt": "2020-05-13T14:08:53Z", "author": {"login": "juliogonzalez"}, "path": "testsuite/features/step_definitions/common_steps.rb", "diffHunk": "@@ -752,7 +752,10 @@\n     puts $minion.run(\"zypper mr --disable #{repos}\")\n   end\n \n-  $minion.run('zypper -n --gpg-auto-import-keys ref')\n+  # Refresh is only necessary when some repos are enabled\n+  if $minion.run('zypper lr').contains? 'Yes'\n+    $minion.run('zypper -n --gpg-auto-import-keys ref')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7f19c9133be7f19e12344da56b8eb64dbb8074c"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwOTgxODc0", "url": "https://github.com/uyuni-project/uyuni/pull/2210#pullrequestreview-410981874", "createdAt": "2020-05-13T14:27:40Z", "commit": {"oid": "c7f19c9133be7f19e12344da56b8eb64dbb8074c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDEwOTg4OTcz", "url": "https://github.com/uyuni-project/uyuni/pull/2210#pullrequestreview-410988973", "createdAt": "2020-05-13T14:34:41Z", "commit": {"oid": "c7f19c9133be7f19e12344da56b8eb64dbb8074c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDExNTQzNTQ4", "url": "https://github.com/uyuni-project/uyuni/pull/2210#pullrequestreview-411543548", "createdAt": "2020-05-14T07:44:34Z", "commit": {"oid": "c7f19c9133be7f19e12344da56b8eb64dbb8074c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzo0NDozNFrOGVP5jg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNFQwNzo0NDozNFrOGVP5jg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDkzMzc3NA==", "bodyText": "contains? -> include?\nif $minion.run('zypper lr').include? 'Yes'", "url": "https://github.com/uyuni-project/uyuni/pull/2210#discussion_r424933774", "createdAt": "2020-05-14T07:44:34Z", "author": {"login": "calancha"}, "path": "testsuite/features/step_definitions/common_steps.rb", "diffHunk": "@@ -752,7 +752,10 @@\n     puts $minion.run(\"zypper mr --disable #{repos}\")\n   end\n \n-  $minion.run('zypper -n --gpg-auto-import-keys ref')\n+  # Refresh is only necessary when some repos are enabled\n+  if $minion.run('zypper lr').contains? 'Yes'", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c7f19c9133be7f19e12344da56b8eb64dbb8074c"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1446, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}