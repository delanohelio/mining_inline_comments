{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEyMzc4NTgz", "number": 2776, "title": "CLM: fix XMLRPC docs and XMLRPC validation", "bodyText": "The goal of this PR is to:\n\nfix the order of args in the doc of the XMLRPC API method buildProject\nextract the properties validation from frontend to backend (new class ContentPropertiesValidator), so that XMLRPC benefits from it too\ninternationalize the CLM strings\nfix a couple of bugs found on the way:\n\ncouple of validations were missing\nthe error string in the ui was joined with <br />, which didn't work. fixed by reporting each error separately (see the screenshot below)\n\n\n\nI think review commit-by-commit should be the best thing (There is only one twist in the \"Refactor: Move the helper method to appropriate place\" commit (the validator class had a dumb name originally)). Commit msgs sometimes contain useful information.\nbefore:\n\nafter:\n\nTODO\n\n Address the comment from Pascal\n\nDocumentation\n\nNo documentation needed: fix\n\nLinks\nTracks\n\n\ngithub.com/SUSE/spacewalk/issues/12806\n\n\ngithub.com/SUSE/spacewalk/issues/12807\n\n\ngithub.com/SUSE/spacewalk/issues/12808\n\n\n DONE\n\n\nChangelogs\nIf you don't need a changelog check, please mark this checkbox:\n\n No changelog needed\n\nIf you uncheck the checkbox after the PR is created, you will need to re-run changelog_test (see below)\nRe-run a test\nIf you need to re-run a test, please mark the related checkbox, it will be unchecked automatically once it has re-run:\n\n Re-run test \"changelog_test\"\n Re-run test \"backend_unittests_pgsql\"\n Re-run test \"java_lint_checkstyle\"\n Re-run test \"java_pgsql_tests\"\n Re-run test \"schema_migration_test_oracle\"\n Re-run test \"schema_migration_test_pgsql\"\n Re-run test \"susemanager_unittests\"\n Re-run test \"javascript_lint\"\n Re-run test \"spacecmd_unittests\"", "createdAt": "2020-10-29T15:52:34Z", "url": "https://github.com/uyuni-project/uyuni/pull/2776", "merged": true, "mergeCommit": {"oid": "911c0771bcfdea488d9681157b23421eda97ae4e"}, "closed": true, "closedAt": "2020-11-06T08:42:35Z", "author": {"login": "hustodemon"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdXigo7gBqjM5NDAwNDcyNTE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZyrHEgBqjM5NjYwODAwNjM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "775f2bb92b4501a8f4cba5a71678c98642c43e7b", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/775f2bb92b4501a8f4cba5a71678c98642c43e7b", "committedDate": "2020-10-29T16:15:47Z", "message": "fixup! checkstyle"}, "afterCommit": {"oid": "eb8c43b4f6cc8c2511c90bae2ad9c56ce00b020a", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/eb8c43b4f6cc8c2511c90bae2ad9c56ce00b020a", "committedDate": "2020-10-30T08:29:45Z", "message": "Localize CLM messages"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIwODczNzU3", "url": "https://github.com/uyuni-project/uyuni/pull/2776#pullrequestreview-520873757", "createdAt": "2020-10-30T17:14:34Z", "commit": {"oid": "a0b87bdbd266c7f8696cd9190720028f97695561"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNzoxNDozNFrOHrYe3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxNzoxNDozNFrOHrYe3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI1MTkzNA==", "bodyText": "The validation handling for updateContentFilter seems to be missing", "url": "https://github.com/uyuni-project/uyuni/pull/2776#discussion_r515251934", "createdAt": "2020-10-30T17:14:34Z", "author": {"login": "parlt91"}, "path": "java/code/src/com/suse/manager/webui/controllers/contentmanagement/handlers/FilterApiController.java", "diffHunk": "@@ -167,6 +168,10 @@ public static String createContentFilter(Request req, Response res, User user) {\n         catch (EntityExistsException error) {\n             return json(GSON, res, HttpStatus.SC_BAD_REQUEST, ResultJson.error(\"contentmanagement.filter_exists\"));\n         }\n+        catch (ValidatorException e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a0b87bdbd266c7f8696cd9190720028f97695561"}, "originalPosition": 12}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NTMxNDcw", "url": "https://github.com/uyuni-project/uyuni/pull/2776#pullrequestreview-524531470", "createdAt": "2020-11-05T18:05:33Z", "commit": {"oid": "99e272d07039f1942046134b849059cd18b490a5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "370770ed55fcc06729eb8e3f5f4b387e5afed0b0", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/370770ed55fcc06729eb8e3f5f4b387e5afed0b0", "committedDate": "2020-11-06T08:27:14Z", "message": "Fix the order of the arguments in the XMLRPC API doc for contentmanagement.buildProject"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd07c05c6c4bad4338ed114c20775d2666857fc7", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/fd07c05c6c4bad4338ed114c20775d2666857fc7", "committedDate": "2020-11-06T08:27:15Z", "message": "Refactor: Get rid of unneeded 'errors' field in ResultJson\n\nThis was used in Content Lifecycle context only.\n\nFor indicating errors, we can use messages and 'success = false' in\nResultJson. Aligned the code to use this way."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "681f8728635c5759451aa2d9c8521c3bfa1d4db4", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/681f8728635c5759451aa2d9c8521c3bfa1d4db4", "committedDate": "2020-11-06T08:27:15Z", "message": "Refactor: Inline method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1622273e798ec12121cb4da91ec42018d164d90b", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/1622273e798ec12121cb4da91ec42018d164d90b", "committedDate": "2020-11-06T08:27:15Z", "message": "Refactor: Extract Content Project validation from frontend and re-use it from XMLRPC API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "280d9c35165fb796ee9e4287a56317e29676acfb", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/280d9c35165fb796ee9e4287a56317e29676acfb", "committedDate": "2020-11-06T08:27:15Z", "message": "Make use of the Content Project validation in XMLRPC API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "921c6d1e08bdcefac1da3c1506ef9fac8d3c63d5", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/921c6d1e08bdcefac1da3c1506ef9fac8d3c63d5", "committedDate": "2020-11-06T08:27:15Z", "message": "Refactor: Extract Content Environment validation from frontend and re-use it from XMLRPC API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf94f1ac9648eb45145ea5ef5c4a3a4efad05593", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/bf94f1ac9648eb45145ea5ef5c4a3a4efad05593", "committedDate": "2020-11-06T08:27:15Z", "message": "Make use of the Content Environment validation in XMLRPC API"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "43574722c237ec89bfb95b9fb7eb448adb848a30", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/43574722c237ec89bfb95b9fb7eb448adb848a30", "committedDate": "2020-11-06T08:27:15Z", "message": "Remove unused filter frontent validation\n\nIn future, possible filter implementation should go to backend."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f50ac881af45b2edf507a4fac9278390206fcf4", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/9f50ac881af45b2edf507a4fac9278390206fcf4", "committedDate": "2020-11-06T08:27:15Z", "message": "Remove an outdated comment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d84028be3f088359af4449d38ceb4267301acfe1", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/d84028be3f088359af4449d38ceb4267301acfe1", "committedDate": "2020-11-06T08:27:29Z", "message": "Changelog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89cda6d714ea8afd944414f5235d581ff81ebdd0", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/89cda6d714ea8afd944414f5235d581ff81ebdd0", "committedDate": "2020-11-06T08:27:30Z", "message": "Refactor: Move the helper method to appropriate place"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbb4f70976d745a6a9479bcd00ec7b3f3cc18fe7", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/bbb4f70976d745a6a9479bcd00ec7b3f3cc18fe7", "committedDate": "2020-11-06T08:27:30Z", "message": "Localize CLM messages"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "adbc349b08afa1afe894270bdff041fb342095a5", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/adbc349b08afa1afe894270bdff041fb342095a5", "committedDate": "2020-11-06T08:27:30Z", "message": "Refactor: Rename and move the validator class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "924f65d46ca49a47a643bc0a17ce2a604b61e5f7", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/924f65d46ca49a47a643bc0a17ce2a604b61e5f7", "committedDate": "2020-11-06T08:27:30Z", "message": "Fix: Validate Content Environment length, fix a typo, fix a bug with validating incorrect field on update"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "98a91755da1cb2eaa40e4e8c6355b40be3c215ba", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/98a91755da1cb2eaa40e4e8c6355b40be3c215ba", "committedDate": "2020-11-06T08:27:30Z", "message": "Fix: Validate Content Filter properties"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2450dcee3ca45bc6b26a591a1b09bbb6f8222b37", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/2450dcee3ca45bc6b26a591a1b09bbb6f8222b37", "committedDate": "2020-11-06T08:27:30Z", "message": "Fix: Report Content Lifecycle validation errors separately"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53216444087d705ae22fe60f14fff1b63a3c128a", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/53216444087d705ae22fe60f14fff1b63a3c128a", "committedDate": "2020-11-06T08:27:30Z", "message": "Handle the validation exception when updating CLM filters"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "99e272d07039f1942046134b849059cd18b490a5", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/99e272d07039f1942046134b849059cd18b490a5", "committedDate": "2020-10-30T09:33:16Z", "message": "Fix: Report Content Lifecycle validation errors separately"}, "afterCommit": {"oid": "53216444087d705ae22fe60f14fff1b63a3c128a", "author": {"user": {"login": "hustodemon", "name": "Frantisek Kobzik"}}, "url": "https://github.com/uyuni-project/uyuni/commit/53216444087d705ae22fe60f14fff1b63a3c128a", "committedDate": "2020-11-06T08:27:30Z", "message": "Handle the validation exception when updating CLM filters"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 952, "cost": 1, "resetAt": "2021-11-01T16:37:27Z"}}}