{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzMDYwMjY4", "number": 1790, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxMTowMTo1NFrODYI0mw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxMTowMTo1NFrODYI0mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI2NjM2OTU1OnYy", "diffSide": "RIGHT", "path": "spacewalk/certs-tools/rhn_bootstrap_strings.py", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxMTowMTo1NFrOFd0q9w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xNVQxMzowMTozOVrOFd3goA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjgxNTk5MQ==", "bodyText": "Does SLES ES7 has this file as well?", "url": "https://github.com/uyuni-project/uyuni/pull/1790#discussion_r366815991", "createdAt": "2020-01-15T11:01:54Z", "author": {"login": "mcalmer"}, "path": "spacewalk/certs-tools/rhn_bootstrap_strings.py", "diffHunk": "@@ -358,12 +358,22 @@ def getRegistrationStackSh(saltEnabled):\n     function getY_CLIENT_CODE_BASE() {{\n         local BASE=\"\"\n         local VERSION=\"\"\n-        if [ -f /etc/redhat-release ]; then\n-            grep -v '^#' /etc/redhat-release | grep -q '\\(Red Hat\\)' && BASE=\"res\"\n-            VERSION=`grep -v '^#' /etc/redhat-release | grep -Po '(?<=release )\\d+'`\n+        # SLES ES6 is a special case; it will install a symlink named\n+        # centos-release pointing to redhat-release which will make the\n+        # original test fail; reverting the checks does not help as this\n+        # will break genuine CentOS systems. So use the poor man's approach\n+        # to detect this special case. SLES ES7 does not have this issue\n+        # https://bugzilla.suse.com/show_bug.cgi?id=1132576\n+        # https://bugzilla.suse.com/show_bug.cgi?id=1152795\n+        if [ -L /usr/share/doc/sles_es-release ]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ebc2bdd0c5b9be81092e25489d2666ca5b6e11ec"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njg1ODAzNQ==", "bodyText": "No, they have the symlink in /usr/share instead (not in the doc directory). But SLES ES7 is not affected anyway as it does not contain the bogus /etc/centos-release link in the sles_es-release-server package. So SLES ES7 gets correctly detected as \"res\" as we expect.", "url": "https://github.com/uyuni-project/uyuni/pull/1790#discussion_r366858035", "createdAt": "2020-01-15T12:51:02Z", "author": {"login": "mantel"}, "path": "spacewalk/certs-tools/rhn_bootstrap_strings.py", "diffHunk": "@@ -358,12 +358,22 @@ def getRegistrationStackSh(saltEnabled):\n     function getY_CLIENT_CODE_BASE() {{\n         local BASE=\"\"\n         local VERSION=\"\"\n-        if [ -f /etc/redhat-release ]; then\n-            grep -v '^#' /etc/redhat-release | grep -q '\\(Red Hat\\)' && BASE=\"res\"\n-            VERSION=`grep -v '^#' /etc/redhat-release | grep -Po '(?<=release )\\d+'`\n+        # SLES ES6 is a special case; it will install a symlink named\n+        # centos-release pointing to redhat-release which will make the\n+        # original test fail; reverting the checks does not help as this\n+        # will break genuine CentOS systems. So use the poor man's approach\n+        # to detect this special case. SLES ES7 does not have this issue\n+        # https://bugzilla.suse.com/show_bug.cgi?id=1132576\n+        # https://bugzilla.suse.com/show_bug.cgi?id=1152795\n+        if [ -L /usr/share/doc/sles_es-release ]; then", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjgxNTk5MQ=="}, "originalCommit": {"oid": "ebc2bdd0c5b9be81092e25489d2666ca5b6e11ec"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Njg2MjQ5Ng==", "bodyText": "ok", "url": "https://github.com/uyuni-project/uyuni/pull/1790#discussion_r366862496", "createdAt": "2020-01-15T13:01:39Z", "author": {"login": "mcalmer"}, "path": "spacewalk/certs-tools/rhn_bootstrap_strings.py", "diffHunk": "@@ -358,12 +358,22 @@ def getRegistrationStackSh(saltEnabled):\n     function getY_CLIENT_CODE_BASE() {{\n         local BASE=\"\"\n         local VERSION=\"\"\n-        if [ -f /etc/redhat-release ]; then\n-            grep -v '^#' /etc/redhat-release | grep -q '\\(Red Hat\\)' && BASE=\"res\"\n-            VERSION=`grep -v '^#' /etc/redhat-release | grep -Po '(?<=release )\\d+'`\n+        # SLES ES6 is a special case; it will install a symlink named\n+        # centos-release pointing to redhat-release which will make the\n+        # original test fail; reverting the checks does not help as this\n+        # will break genuine CentOS systems. So use the poor man's approach\n+        # to detect this special case. SLES ES7 does not have this issue\n+        # https://bugzilla.suse.com/show_bug.cgi?id=1132576\n+        # https://bugzilla.suse.com/show_bug.cgi?id=1152795\n+        if [ -L /usr/share/doc/sles_es-release ]; then", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjgxNTk5MQ=="}, "originalCommit": {"oid": "ebc2bdd0c5b9be81092e25489d2666ca5b6e11ec"}, "originalPosition": 14}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 209, "cost": 1, "resetAt": "2021-11-12T12:57:47Z"}}}