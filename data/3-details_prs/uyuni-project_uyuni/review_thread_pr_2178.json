{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExNTY4MjA0", "number": 2178, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjoxMzoxOVrOD4HJJw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjoxMzoxOVrOD4HJJw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjYwMTYzODc5OnYy", "diffSide": "RIGHT", "path": "tftpsync/susemanager-tftpsync-recv/susemanager-tftpsync-recv.spec", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0zMFQxNjoxMzoxOVrOGOwdOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNFQwOTo0ODo0M1rOGP5eqw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyNzE2MQ==", "bodyText": "Wasn't there a rule that RPM post scripts should never fail?\nAFAIK RPM would see this as a broken package.\nReporting the error is ok, but I think it should still \"exit 0\".\nMaybe check back with @mlandres", "url": "https://github.com/uyuni-project/uyuni/pull/2178#discussion_r418127161", "createdAt": "2020-04-30T16:13:19Z", "author": {"login": "mcalmer"}, "path": "tftpsync/susemanager-tftpsync-recv/susemanager-tftpsync-recv.spec", "diffHunk": "@@ -70,6 +70,20 @@ if [ -d /srv/tftpboot ]; then\n     chmod 750 /srv/tftpboot\n     chown wwwrun:tftp /srv/tftpboot\n fi\n+if [ -f /etc/apache2/conf.d/susemanager-tftpsync-recv.conf.rpmnew ]; then\n+    PARENT_FQDN=$( egrep -m1 \"^proxy.rhn_parent[[:space:]]*=\" /etc/rhn/rhn.conf | sed 's/^proxy.rhn_parent[[:space:]]*=[[:space:]]*\\(.*\\)/\\1/' || echo \"\" )\n+    if [ -z \"$PARENT_FQDN\" ]; then\n+            echo \"Could not determine SUSE Manager Parent Hostname! Got /etc/rhn/rhn.conf vanished?\" >&2;\n+            exit 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4ab64dcaf2075628a5f6c3f5013b79060d22665"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTIzNDA3OQ==", "bodyText": "If %post exits !=0 rpm will nevertheless consider the package as being installed. It's been successfully extracted to disk and remembered in the rpm database. A failed %post won't undo this. Rpm exits 0.\nZypper however may return 107 - ZYPPER_EXIT_INF_RPM_SCRIPT_FAILED if it detects a failed %post.", "url": "https://github.com/uyuni-project/uyuni/pull/2178#discussion_r419234079", "createdAt": "2020-05-04T06:32:45Z", "author": {"login": "mlandres"}, "path": "tftpsync/susemanager-tftpsync-recv/susemanager-tftpsync-recv.spec", "diffHunk": "@@ -70,6 +70,20 @@ if [ -d /srv/tftpboot ]; then\n     chmod 750 /srv/tftpboot\n     chown wwwrun:tftp /srv/tftpboot\n fi\n+if [ -f /etc/apache2/conf.d/susemanager-tftpsync-recv.conf.rpmnew ]; then\n+    PARENT_FQDN=$( egrep -m1 \"^proxy.rhn_parent[[:space:]]*=\" /etc/rhn/rhn.conf | sed 's/^proxy.rhn_parent[[:space:]]*=[[:space:]]*\\(.*\\)/\\1/' || echo \"\" )\n+    if [ -z \"$PARENT_FQDN\" ]; then\n+            echo \"Could not determine SUSE Manager Parent Hostname! Got /etc/rhn/rhn.conf vanished?\" >&2;\n+            exit 1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyNzE2MQ=="}, "originalCommit": {"oid": "d4ab64dcaf2075628a5f6c3f5013b79060d22665"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI4NDE4OA==", "bodyText": "So what should we do here? In any case the functionality will be broken, so I think we should leave it as it is!?", "url": "https://github.com/uyuni-project/uyuni/pull/2178#discussion_r419284188", "createdAt": "2020-05-04T08:32:40Z", "author": {"login": "mantel"}, "path": "tftpsync/susemanager-tftpsync-recv/susemanager-tftpsync-recv.spec", "diffHunk": "@@ -70,6 +70,20 @@ if [ -d /srv/tftpboot ]; then\n     chmod 750 /srv/tftpboot\n     chown wwwrun:tftp /srv/tftpboot\n fi\n+if [ -f /etc/apache2/conf.d/susemanager-tftpsync-recv.conf.rpmnew ]; then\n+    PARENT_FQDN=$( egrep -m1 \"^proxy.rhn_parent[[:space:]]*=\" /etc/rhn/rhn.conf | sed 's/^proxy.rhn_parent[[:space:]]*=[[:space:]]*\\(.*\\)/\\1/' || echo \"\" )\n+    if [ -z \"$PARENT_FQDN\" ]; then\n+            echo \"Could not determine SUSE Manager Parent Hostname! Got /etc/rhn/rhn.conf vanished?\" >&2;\n+            exit 1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyNzE2MQ=="}, "originalCommit": {"oid": "d4ab64dcaf2075628a5f6c3f5013b79060d22665"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTMyMzU2Mw==", "bodyText": "I am fine if it does not create a problem with RPM.", "url": "https://github.com/uyuni-project/uyuni/pull/2178#discussion_r419323563", "createdAt": "2020-05-04T09:48:43Z", "author": {"login": "mcalmer"}, "path": "tftpsync/susemanager-tftpsync-recv/susemanager-tftpsync-recv.spec", "diffHunk": "@@ -70,6 +70,20 @@ if [ -d /srv/tftpboot ]; then\n     chmod 750 /srv/tftpboot\n     chown wwwrun:tftp /srv/tftpboot\n fi\n+if [ -f /etc/apache2/conf.d/susemanager-tftpsync-recv.conf.rpmnew ]; then\n+    PARENT_FQDN=$( egrep -m1 \"^proxy.rhn_parent[[:space:]]*=\" /etc/rhn/rhn.conf | sed 's/^proxy.rhn_parent[[:space:]]*=[[:space:]]*\\(.*\\)/\\1/' || echo \"\" )\n+    if [ -z \"$PARENT_FQDN\" ]; then\n+            echo \"Could not determine SUSE Manager Parent Hostname! Got /etc/rhn/rhn.conf vanished?\" >&2;\n+            exit 1;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODEyNzE2MQ=="}, "originalCommit": {"oid": "d4ab64dcaf2075628a5f6c3f5013b79060d22665"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4362, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}