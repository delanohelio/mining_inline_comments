{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzMTEwMTEy", "number": 2782, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xOVQxNTo1NTowNVrOFoGv6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xOVQxNTo1NTowNVrOFoGv6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzc3NTk3OTMwOnYy", "diffSide": "RIGHT", "path": "java/code/src/com/redhat/rhn/manager/kickstart/cobbler/CobblerProfileSyncCommand.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0xOVQxNTo1NTowNVrOI6GTXQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMy0yMlQxNjozMToxMFrOI7I6iQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Nzc5MTU4MQ==", "bodyText": "Is the double \"cobbler\" an oversight?", "url": "https://github.com/uyuni-project/uyuni/pull/2782#discussion_r597791581", "createdAt": "2021-03-19T15:55:05Z", "author": {"login": "agraul"}, "path": "java/code/src/com/redhat/rhn/manager/kickstart/cobbler/CobblerProfileSyncCommand.java", "diffHunk": "@@ -152,25 +154,35 @@ private void syncProfileToSpacewalk(Map cobblerProfile, KickstartData profile) {\n         }\n \n         //Now re-set the filename in case someone set it incorrectly\n-        try {\n-        String handle = (String) invokeXMLRPC(\"get_profile_handle\",\n-                cobblerProfile.get(\"name\"), xmlRpcToken);\n-        invokeXMLRPC(\"modify_profile\", handle, \"kickstart\", profile.buildCobblerFileName(),\n-                xmlRpcToken);\n-        invokeXMLRPC(\"save_profile\", handle, xmlRpcToken);\n-\n-        //Lets update the modified date just to make sure\n-        profile.setModified(new Date());\n-        }\n-        catch (RuntimeException re) {\n-            if (re.getCause() instanceof XmlRpcFault) {\n-                XmlRpcFault xrf = (XmlRpcFault)re.getCause();\n-                if (xrf.getMessage().contains(\"unknown profile name\")) {\n-                    log.error(\"Cobbler doesn't know about this profile any more!\");\n-                }\n+        Path kickstartPath = Path.of(\n+                ConfigDefaults.get().getKickstartConfigDir(),\n+                cobblerProfile.get(\"kickstart\").toString()\n+        );\n+        String cobblerKickstartFileName = profile.buildCobblerFileName();\n+        if (!Path.of(cobblerKickstartFileName).equals(kickstartPath)) {\n+            try {\n+                log.info(String.format(\"Updating cobbler cobbler profile, setting 'kickstart' to: %s\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16f572644dd5792e3bef2787622930ce8f8ce122"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU4NjUyMA==", "bodyText": "Yes, it is!", "url": "https://github.com/uyuni-project/uyuni/pull/2782#discussion_r598586520", "createdAt": "2021-03-22T10:18:28Z", "author": {"login": "brejoc"}, "path": "java/code/src/com/redhat/rhn/manager/kickstart/cobbler/CobblerProfileSyncCommand.java", "diffHunk": "@@ -152,25 +154,35 @@ private void syncProfileToSpacewalk(Map cobblerProfile, KickstartData profile) {\n         }\n \n         //Now re-set the filename in case someone set it incorrectly\n-        try {\n-        String handle = (String) invokeXMLRPC(\"get_profile_handle\",\n-                cobblerProfile.get(\"name\"), xmlRpcToken);\n-        invokeXMLRPC(\"modify_profile\", handle, \"kickstart\", profile.buildCobblerFileName(),\n-                xmlRpcToken);\n-        invokeXMLRPC(\"save_profile\", handle, xmlRpcToken);\n-\n-        //Lets update the modified date just to make sure\n-        profile.setModified(new Date());\n-        }\n-        catch (RuntimeException re) {\n-            if (re.getCause() instanceof XmlRpcFault) {\n-                XmlRpcFault xrf = (XmlRpcFault)re.getCause();\n-                if (xrf.getMessage().contains(\"unknown profile name\")) {\n-                    log.error(\"Cobbler doesn't know about this profile any more!\");\n-                }\n+        Path kickstartPath = Path.of(\n+                ConfigDefaults.get().getKickstartConfigDir(),\n+                cobblerProfile.get(\"kickstart\").toString()\n+        );\n+        String cobblerKickstartFileName = profile.buildCobblerFileName();\n+        if (!Path.of(cobblerKickstartFileName).equals(kickstartPath)) {\n+            try {\n+                log.info(String.format(\"Updating cobbler cobbler profile, setting 'kickstart' to: %s\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Nzc5MTU4MQ=="}, "originalCommit": {"oid": "16f572644dd5792e3bef2787622930ce8f8ce122"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODg4Mjk1Mw==", "bodyText": "Fixed. thanks!", "url": "https://github.com/uyuni-project/uyuni/pull/2782#discussion_r598882953", "createdAt": "2021-03-22T16:31:10Z", "author": {"login": "hustodemon"}, "path": "java/code/src/com/redhat/rhn/manager/kickstart/cobbler/CobblerProfileSyncCommand.java", "diffHunk": "@@ -152,25 +154,35 @@ private void syncProfileToSpacewalk(Map cobblerProfile, KickstartData profile) {\n         }\n \n         //Now re-set the filename in case someone set it incorrectly\n-        try {\n-        String handle = (String) invokeXMLRPC(\"get_profile_handle\",\n-                cobblerProfile.get(\"name\"), xmlRpcToken);\n-        invokeXMLRPC(\"modify_profile\", handle, \"kickstart\", profile.buildCobblerFileName(),\n-                xmlRpcToken);\n-        invokeXMLRPC(\"save_profile\", handle, xmlRpcToken);\n-\n-        //Lets update the modified date just to make sure\n-        profile.setModified(new Date());\n-        }\n-        catch (RuntimeException re) {\n-            if (re.getCause() instanceof XmlRpcFault) {\n-                XmlRpcFault xrf = (XmlRpcFault)re.getCause();\n-                if (xrf.getMessage().contains(\"unknown profile name\")) {\n-                    log.error(\"Cobbler doesn't know about this profile any more!\");\n-                }\n+        Path kickstartPath = Path.of(\n+                ConfigDefaults.get().getKickstartConfigDir(),\n+                cobblerProfile.get(\"kickstart\").toString()\n+        );\n+        String cobblerKickstartFileName = profile.buildCobblerFileName();\n+        if (!Path.of(cobblerKickstartFileName).equals(kickstartPath)) {\n+            try {\n+                log.info(String.format(\"Updating cobbler cobbler profile, setting 'kickstart' to: %s\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Nzc5MTU4MQ=="}, "originalCommit": {"oid": "16f572644dd5792e3bef2787622930ce8f8ce122"}, "originalPosition": 43}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4007, "cost": 1, "resetAt": "2021-11-13T12:26:42Z"}}}