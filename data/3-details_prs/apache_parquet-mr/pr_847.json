{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM5MDg4MzA2", "number": 847, "title": "[PARQUET-1951] Allow different strategies to combine key values when \u2026", "bodyText": "\u2026merging parquet files\nJira\n\n[ X] My PR addresses the following Parquet Jira issues and references them in the PR title.\n\nTests\n\n[X ] My PR adds the following unit tests: TestParquetFileWriter#testMergeMetadataWithNoConflictingKeyValues, and testMergeMetadataWithConflictingKeyValues\n\nCommits\n\n[ X] My commits all reference Jira issues in their subject lines. In addition, my commits follow the guidelines from \"How to write a good git commit message\":\n\nSubject is separated from body by a blank line\nSubject is limited to 50 characters (not including Jira issue reference)\nSubject does not end with a period\nSubject uses the imperative mood (\"add\", not \"adding\")\nBody wraps at 72 characters\nBody explains \"what\" and \"why\", not \"how\"\n\n\n\nDocumentation\n\n[ X] In case of new functionality, my PR adds documentation that describes how to use it.\n\nAll the public functions and the classes in the PR contain Javadoc that explain what it does", "createdAt": "2020-12-14T02:44:11Z", "url": "https://github.com/apache/parquet-mr/pull/847", "merged": true, "mergeCommit": {"oid": "02170613d12b5122b07149136382a71505fa39d8"}, "closed": true, "closedAt": "2021-01-07T09:44:39Z", "author": {"login": "satishkotha"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdl8wQpgBqjQxMDY5MDE3MzY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdtw6XIgFqTU2MzM0MjcwNg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8e0f5ab82abdcb662ab6d31d57e3ca500e301f9d", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/8e0f5ab82abdcb662ab6d31d57e3ca500e301f9d", "committedDate": "2020-12-14T02:39:15Z", "message": "[PARQUET-1951] Allow different strategies to combine key values when merging parquet files"}, "afterCommit": {"oid": "4d2201a9d0bb768ac0f2e1a9f68eb40efb9de439", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/4d2201a9d0bb768ac0f2e1a9f68eb40efb9de439", "committedDate": "2020-12-14T02:56:56Z", "message": "[PARQUET-1951] Allow different strategies to combine key values when merging parquet files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79", "committedDate": "2020-12-14T03:13:49Z", "message": "[PARQUET-1951] Allow different strategies to combine key values when merging parquet files"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4d2201a9d0bb768ac0f2e1a9f68eb40efb9de439", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/4d2201a9d0bb768ac0f2e1a9f68eb40efb9de439", "committedDate": "2020-12-14T02:56:56Z", "message": "[PARQUET-1951] Allow different strategies to combine key values when merging parquet files"}, "afterCommit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79", "committedDate": "2020-12-14T03:13:49Z", "message": "[PARQUET-1951] Allow different strategies to combine key values when merging parquet files"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYwOTMwMTA4", "url": "https://github.com/apache/parquet-mr/pull/847#pullrequestreview-560930108", "createdAt": "2021-01-04T10:39:05Z", "commit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxMDozOTowNlrOINs5iw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQxMDo0NjozMVrOINtJOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTIzODAyNw==", "bodyText": "I think, this interface does not support all types of the potential merge strategy implementations. For example if you would like to use the value which is common in the most files you cannot do it because you only have the distinct values. What do you think about using a List<String> instead of a Set<String>?", "url": "https://github.com/apache/parquet-mr/pull/847#discussion_r551238027", "createdAt": "2021-01-04T10:39:06Z", "author": {"login": "gszadovszky"}, "path": "parquet-hadoop/src/main/java/org/apache/parquet/hadoop/metadata/KeyValueMetadataMergeStrategy.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.parquet.hadoop.metadata;\n+\n+import org.apache.parquet.schema.MessageType;\n+\n+import java.io.Serializable;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Map.Entry;\n+import java.util.Objects;\n+import java.util.Set;\n+\n+import static java.util.Collections.unmodifiableMap;\n+\n+/**\n+ * Strategy to merge metadata. Possible implementations:\n+ * 1) Expect metadata to be exactly identical. Otherwise throw error (this is the default strategy implementation)\n+ * 2) Custom strategy to merge metadata if the values are not identical. Example: concatenate values.\n+ */\n+public interface KeyValueMetadataMergeStrategy extends Serializable {\n+  /**\n+   * @param keyValueMetaData the merged app specific metadata\n+   *\n+   * @throws NullPointerException if keyValueMetaData is {@code null}\n+   */\n+  Map<String, String> merge(Map<String, Set<String>> keyValueMetaData);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTI0MDAyNw==", "bodyText": "You do not need to instantiate an object to get its class. Simply use DefaultKeyValueMetadataMergeStrategy.class", "url": "https://github.com/apache/parquet-mr/pull/847#discussion_r551240027", "createdAt": "2021-01-04T10:43:08Z", "author": {"login": "gszadovszky"}, "path": "parquet-tools/src/main/java/org/apache/parquet/tools/command/MergeCommand.java", "diffHunk": "@@ -41,6 +46,21 @@\n           \"   <output> is the destination parquet file\"\n   };\n \n+  private static final String DEFAULT_KEY_VALUE_MERGE_STRATEGY = new DefaultKeyValueMetadataMergeStrategy().getClass().getName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTI0MjA0Mg==", "bodyText": "I do not really like the naming of this class. This is the default implementation, it's fine but the name should suggest what it does. I'm quite sure there is a better naming but what about StrictKeyValueMetadataMergeStrategy?", "url": "https://github.com/apache/parquet-mr/pull/847#discussion_r551242042", "createdAt": "2021-01-04T10:46:31Z", "author": {"login": "gszadovszky"}, "path": "parquet-hadoop/src/main/java/org/apache/parquet/hadoop/metadata/DefaultKeyValueMetadataMergeStrategy.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.parquet.hadoop.metadata;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n+/**\n+ *  Default strategy to throw errors in metadata if there are multiple values for a given key in metadata.\n+ */\n+public class DefaultKeyValueMetadataMergeStrategy implements KeyValueMetadataMergeStrategy {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNDA1Mjk2", "url": "https://github.com/apache/parquet-mr/pull/847#pullrequestreview-561405296", "createdAt": "2021-01-04T22:56:05Z", "commit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQyMjo1NjowNVrOIOEDPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQyMzowNzowM1rOIOES7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTYxNzM0Mg==", "bodyText": "The signature doesn't have NullPointerException.", "url": "https://github.com/apache/parquet-mr/pull/847#discussion_r551617342", "createdAt": "2021-01-04T22:56:05Z", "author": {"login": "shangxinli"}, "path": "parquet-hadoop/src/main/java/org/apache/parquet/hadoop/metadata/KeyValueMetadataMergeStrategy.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.parquet.hadoop.metadata;\n+\n+import org.apache.parquet.schema.MessageType;\n+\n+import java.io.Serializable;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Map.Entry;\n+import java.util.Objects;\n+import java.util.Set;\n+\n+import static java.util.Collections.unmodifiableMap;\n+\n+/**\n+ * Strategy to merge metadata. Possible implementations:\n+ * 1) Expect metadata to be exactly identical. Otherwise throw error (this is the default strategy implementation)\n+ * 2) Custom strategy to merge metadata if the values are not identical. Example: concatenate values.\n+ */\n+public interface KeyValueMetadataMergeStrategy extends Serializable {\n+  /**\n+   * @param keyValueMetaData the merged app specific metadata\n+   *\n+   * @throws NullPointerException if keyValueMetaData is {@code null}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTYxNzcyOA==", "bodyText": "Remove one space in the beginning", "url": "https://github.com/apache/parquet-mr/pull/847#discussion_r551617728", "createdAt": "2021-01-04T22:57:03Z", "author": {"login": "shangxinli"}, "path": "parquet-hadoop/src/main/java/org/apache/parquet/hadoop/metadata/GlobalMetaData.java", "diffHunk": "@@ -87,19 +87,25 @@ public String toString() {\n    * Will merge the metadata as if it was coming from a single file.\n    * (for all part files written together this will always work)\n    * If there are conflicting values an exception will be thrown\n+   * \n+   * Provided for backward compatibility\n    * @return the merged version of this\n    */\n-  public FileMetaData merge() {\n+   public FileMetaData merge() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTYyMTM1Nw==", "bodyText": "People may already rely on the 'set' to do the dedup.", "url": "https://github.com/apache/parquet-mr/pull/847#discussion_r551621357", "createdAt": "2021-01-04T23:07:03Z", "author": {"login": "shangxinli"}, "path": "parquet-hadoop/src/main/java/org/apache/parquet/hadoop/metadata/KeyValueMetadataMergeStrategy.java", "diffHunk": "@@ -0,0 +1,44 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.parquet.hadoop.metadata;\n+\n+import org.apache.parquet.schema.MessageType;\n+\n+import java.io.Serializable;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Map.Entry;\n+import java.util.Objects;\n+import java.util.Set;\n+\n+import static java.util.Collections.unmodifiableMap;\n+\n+/**\n+ * Strategy to merge metadata. Possible implementations:\n+ * 1) Expect metadata to be exactly identical. Otherwise throw error (this is the default strategy implementation)\n+ * 2) Custom strategy to merge metadata if the values are not identical. Example: concatenate values.\n+ */\n+public interface KeyValueMetadataMergeStrategy extends Serializable {\n+  /**\n+   * @param keyValueMetaData the merged app specific metadata\n+   *\n+   * @throws NullPointerException if keyValueMetaData is {@code null}\n+   */\n+  Map<String, String> merge(Map<String, Set<String>> keyValueMetaData);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTIzODAyNw=="}, "originalCommit": {"oid": "25f7fb30eef0aaeb0be97e5c474f8586a9e7ae79"}, "originalPosition": 43}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYxNDEyMzA3", "url": "https://github.com/apache/parquet-mr/pull/847#pullrequestreview-561412307", "createdAt": "2021-01-04T23:12:37Z", "commit": {"oid": "48102d94f3ea59e77fa6c003c9ca4e6ffff8af36"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQyMzoxMjozN1rOIOEauA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNFQyMzoxMjozN1rOIOEauA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTYyMzM1Mg==", "bodyText": "The delimiter needs to be parameterized in other non-hudi cases.", "url": "https://github.com/apache/parquet-mr/pull/847#discussion_r551623352", "createdAt": "2021-01-04T23:12:37Z", "author": {"login": "shangxinli"}, "path": "parquet-hadoop/src/main/java/org/apache/parquet/hadoop/metadata/ConcatenatingKeyValueMetadataMergeStrategy.java", "diffHunk": "@@ -0,0 +1,43 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.parquet.hadoop.metadata;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+/**\n+ *  Strategy to concatenate if there are multiple values for a given key in metadata.\n+ *  Note: use this with caution. This is expected to work only for certain use cases.\n+ */\n+public class ConcatenatingKeyValueMetadataMergeStrategy implements KeyValueMetadataMergeStrategy {\n+  /**\n+   * @param keyValueMetaData the merged app specific metadata\n+   *\n+   * @throws NullPointerException if keyValueMetaData is {@code null}\n+   */\n+  public Map<String, String> merge(Map<String, Set<String>> keyValueMetaData) {\n+    Map<String, String> mergedKeyValues = new HashMap<String, String>();\n+    for (Map.Entry<String, Set<String>> entry : keyValueMetaData.entrySet()) {\n+      mergedKeyValues.put(entry.getKey(), entry.getValue().stream().collect(Collectors.joining(\",\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "48102d94f3ea59e77fa6c003c9ca4e6ffff8af36"}, "originalPosition": 39}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf180c06afc7552726e17f40bb10d1665aca7253", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/bf180c06afc7552726e17f40bb10d1665aca7253", "committedDate": "2021-01-05T00:02:42Z", "message": "Address code review comments:\n1) Rename DefaultKeyValueMetadataMergeStrategy.java to StrictKeyValueMetadataMergeStrategy.java\n2) Add one more strategy to concatenate values for same key\n3) parameterize delimiter"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "48102d94f3ea59e77fa6c003c9ca4e6ffff8af36", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/48102d94f3ea59e77fa6c003c9ca4e6ffff8af36", "committedDate": "2021-01-04T22:00:24Z", "message": "Address code review comments:\n1) Rename DefaultKeyValueMetadataMergeStrategy.java to StrictKeyValueMetadataMergeStrategy.java\n2) Add one more strategy to concatenate values for same key"}, "afterCommit": {"oid": "bf180c06afc7552726e17f40bb10d1665aca7253", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/bf180c06afc7552726e17f40bb10d1665aca7253", "committedDate": "2021-01-05T00:02:42Z", "message": "Address code review comments:\n1) Rename DefaultKeyValueMetadataMergeStrategy.java to StrictKeyValueMetadataMergeStrategy.java\n2) Add one more strategy to concatenate values for same key\n3) parameterize delimiter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e37bc551250760859f710e5271cdde2ac1514aa2", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/e37bc551250760859f710e5271cdde2ac1514aa2", "committedDate": "2021-01-06T01:30:22Z", "message": "Add additional option to CLI to load custom strategy"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYyNTQ0NTE1", "url": "https://github.com/apache/parquet-mr/pull/847#pullrequestreview-562544515", "createdAt": "2021-01-06T10:39:18Z", "commit": {"oid": "e37bc551250760859f710e5271cdde2ac1514aa2"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxMDozOToxOFrOIO5zaw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0wNlQxMDozOToxOFrOIO5zaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjQ5ODAyNw==", "bodyText": "We should list the available options here. (The best way would be do it by iterating over the enum so a potential extension later would not forget about this part.)\nnit: in command line we rarely use upper case arguments. Maybe it would be nicer to convert the enum names to lower case.", "url": "https://github.com/apache/parquet-mr/pull/847#discussion_r552498027", "createdAt": "2021-01-06T10:39:18Z", "author": {"login": "gszadovszky"}, "path": "parquet-tools/src/main/java/org/apache/parquet/tools/command/MergeCommand.java", "diffHunk": "@@ -46,19 +47,34 @@\n           \"   <output> is the destination parquet file\"\n   };\n \n-  private static final String DEFAULT_KEY_VALUE_MERGE_STRATEGY = StrictKeyValueMetadataMergeStrategy.class.getName();\n+  private static enum MergeStrategy {\n+    STRICT,\n+    CONCAT,\n+    CUSTOM,\n+  }\n+  \n   public static final Options OPTIONS;\n \n   static {\n     OPTIONS = new Options();\n     Option mergeStrategy = Option.builder(\"s\")\n       .longOpt(\"mergeStrategy\")\n       .desc(\"Strategy to merge (key, value) pairs in metadata if there are multiple values for same key \" +\n-        \"(default: \" + DEFAULT_KEY_VALUE_MERGE_STRATEGY + \")\")\n+        \"(default: \" + MergeStrategy.STRICT + \"). You can provide your custom implementation by specifying \" +", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e37bc551250760859f710e5271cdde2ac1514aa2"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e8e4db8687de5b12cf66f29c88f9469de6fd92ad", "author": {"user": {"login": "satishkotha", "name": null}}, "url": "https://github.com/apache/parquet-mr/commit/e8e4db8687de5b12cf66f29c88f9469de6fd92ad", "committedDate": "2021-01-06T20:40:11Z", "message": "Update description for strategy option"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzMzQyNzA2", "url": "https://github.com/apache/parquet-mr/pull/847#pullrequestreview-563342706", "createdAt": "2021-01-07T09:43:01Z", "commit": {"oid": "e8e4db8687de5b12cf66f29c88f9469de6fd92ad"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2141, "cost": 1, "resetAt": "2021-10-29T19:57:52Z"}}}