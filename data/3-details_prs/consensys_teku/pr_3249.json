{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTIyNzcxNzU5", "number": 3249, "title": "Don't require a base block when regenerating states", "bodyText": "PR Description\nDon't require a base block when regenerating states.  Once a base state is found on which we can build, we only need to retrieve blocks that build on top of that state - there's no need to require the block corresponding to the base state.\nWithout this change, we could run into errors trying to regenerate states when starting up from a recent (non-genesis) state.\nAlso, delete some logic that was unused in production.\nFixed Issue(s)\nRelates to #3063\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.", "createdAt": "2020-11-17T23:33:42Z", "url": "https://github.com/ConsenSys/teku/pull/3249", "merged": true, "mergeCommit": {"oid": "48f566e240bd3e32607005fc8085ea72ffbc2600"}, "closed": true, "closedAt": "2020-11-18T18:31:05Z", "author": {"login": "mbaxter"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddiHc4gH2gAyNTIyNzcxNzU5OjE0NDc1MmI1NWE2MTgyMDU1ZWNiNmFjNmI4ZjFlOGYxZmY4ODUzYzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABddyJJagH2gAyNTIyNzcxNzU5OjQ3YjM0MDA5NTRiNTEwNGM2ZThmMjEyYzk0ZmJhMmZjMDgwZDBmNTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "144752b55a6182055ecb6ac6b8f1e8f1ff8853c4", "author": {"user": {"login": "mbaxter", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/144752b55a6182055ecb6ac6b8f1e8f1ff8853c4", "committedDate": "2020-11-17T23:25:57Z", "message": "Cut unused logic"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e51ef350d203d78e06e225f74e00b63d1d9918b5", "author": {"user": {"login": "mbaxter", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/e51ef350d203d78e06e225f74e00b63d1d9918b5", "committedDate": "2020-11-17T23:26:57Z", "message": "Don't require a base state when regenerating states"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "70c11fa6663fbecedefc369348e67f0895bcc433", "author": {"user": {"login": "mbaxter", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/70c11fa6663fbecedefc369348e67f0895bcc433", "committedDate": "2020-11-17T23:48:06Z", "message": "Cut unused variables"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTMyOTE1NjYw", "url": "https://github.com/ConsenSys/teku/pull/3249#pullrequestreview-532915660", "createdAt": "2020-11-18T00:11:29Z", "commit": {"oid": "70c11fa6663fbecedefc369348e67f0895bcc433"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwMDoxMToyOVrOH1Qo8w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xOFQwMDoxMToyOVrOH1Qo8w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTYwOTIwMw==", "bodyText": "nit: Remove unnecessary parenthesis:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                              (stateAndBlock) -> {\n          \n          \n            \n                              stateAndBlock -> {", "url": "https://github.com/ConsenSys/teku/pull/3249#discussion_r525609203", "createdAt": "2020-11-18T00:11:29Z", "author": {"login": "ajsutton"}, "path": "ethereum/core/src/main/java/tech/pegasys/teku/core/stategenerator/AsyncChainStateGenerator.java", "diffHunk": "@@ -153,9 +169,9 @@ public static AsyncChainStateGenerator create(\n                   ChainStateGenerator.create(chainBlocks, startState, true);\n               final AtomicReference<BeaconState> lastState = new AtomicReference<>(null);\n               chainStateGenerator.generateStates(\n-                  (block, state) -> {\n-                    lastState.set(state);\n-                    handler.handle(block, state);\n+                  (stateAndBlock) -> {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "70c11fa6663fbecedefc369348e67f0895bcc433"}, "originalPosition": 82}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e44d31af0329211775ec8d529a428edff5dbc6c", "author": {"user": {"login": "mbaxter", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/9e44d31af0329211775ec8d529a428edff5dbc6c", "committedDate": "2020-11-18T01:58:58Z", "message": "Remove unnecessary parens"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47b3400954b5104c6e8f212c94fba2fc080d0f55", "author": {"user": {"login": "mbaxter", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/47b3400954b5104c6e8f212c94fba2fc080d0f55", "committedDate": "2020-11-18T18:06:17Z", "message": "Merge branch 'master' into bug/fix-state-regen-bug"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3204, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}