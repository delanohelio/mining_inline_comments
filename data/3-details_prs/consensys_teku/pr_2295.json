{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzMjg0MTg5", "number": 2295, "title": "rpc exceptions now output a limited 256 bytes of message", "bodyText": "renamed SimpleOffsetSszEncoder to DefaultRpcPayloadEncoder\n\n\nadded a round trip encoder to demonstrate the same message that is encoded comes out of the decoder.\n\n\nAdded log message for decode failure.\n\n\npartially addresses #2078\nSigned-off-by: Paul Harris paul.harris@consensys.net\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.", "createdAt": "2020-07-02T05:29:15Z", "url": "https://github.com/ConsenSys/teku/pull/2295", "merged": true, "mergeCommit": {"oid": "ba4db87c3dda4ee6d6f0f58b3e6e2b84963c03b6"}, "closed": true, "closedAt": "2020-07-02T22:07:36Z", "author": {"login": "rolfyone"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcw3_e9AH2gAyNDQzMjg0MTg5OjIyMmU2MGMwYjAzNzE4MDY1Yzg0MDZiYzE1NWRiYzI1MzQyYTE5NmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcxGGj1AH2gAyNDQzMjg0MTg5OjVhODdjMGI3OTg0MjRmODlhM2FjYjI1OTBmM2VlM2I4OGJkN2M5ZTc=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "222e60c0b03718065c8406bc155dbc25342a196f", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/222e60c0b03718065c8406bc155dbc25342a196f", "committedDate": "2020-07-02T05:28:34Z", "message": "rpc exceptions now output a limited 256 bytes of message\n\n - renamed SimpleOffsetSszEncoder to DefaultRpcPayloadEncoder\n\n - added a round trip encoder to demonstrate the same message that is encoded comes out of the decoder.\n\n - Added log message for decode failure.\n\npartially addresses #2078\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9d08d969513de41f214577cd840e070182fceee", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/d9d08d969513de41f214577cd840e070182fceee", "committedDate": "2020-07-02T05:29:35Z", "message": "Merge remote-tracking branch 'upstream/master' into 2078-exception-bytes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyMDE4MDA5", "url": "https://github.com/ConsenSys/teku/pull/2295#pullrequestreview-442018009", "createdAt": "2020-07-02T21:04:51Z", "commit": {"oid": "d9d08d969513de41f214577cd840e070182fceee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMTowNDo1MlrOGsc-eQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQyMTowNDo1MlrOGsc-eQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTI2NTI3Mw==", "bodyText": "nit: shouldn't we be casting to (Bytes) here since the clazz is Bytes.class anyway? or does the compiler not allow that? or lastly is that just unnecessary?", "url": "https://github.com/ConsenSys/teku/pull/2295#discussion_r449265273", "createdAt": "2020-07-02T21:04:52Z", "author": {"login": "cemozerr"}, "path": "networking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/rpc/core/encodings/ssz/DefaultRpcPayloadEncoder.java", "diffHunk": "@@ -22,22 +22,28 @@\n import tech.pegasys.teku.networking.eth2.rpc.core.encodings.RpcPayloadEncoder;\n import tech.pegasys.teku.ssz.sos.SimpleOffsetSerializable;\n \n-public class SimpleOffsetSszEncoder<T> implements RpcPayloadEncoder<T> {\n+public class DefaultRpcPayloadEncoder<T> implements RpcPayloadEncoder<T> {\n   private static final Logger LOG = LogManager.getLogger();\n   private final Class<T> clazz;\n \n-  public SimpleOffsetSszEncoder(final Class<T> clazz) {\n+  public DefaultRpcPayloadEncoder(final Class<T> clazz) {\n     this.clazz = clazz;\n   }\n \n   @Override\n   public Bytes encode(final T message) {\n-    return SimpleOffsetSerializer.serialize((SimpleOffsetSerializable) message);\n+    return message instanceof Bytes\n+        ? (Bytes) message\n+        : SimpleOffsetSerializer.serialize((SimpleOffsetSerializable) message);\n   }\n \n+  @SuppressWarnings(\"unchecked\")\n   @Override\n   public T decode(final Bytes message) throws RpcException {\n     try {\n+      if (clazz.equals(Bytes.class)) {\n+        return (T) message;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9d08d969513de41f214577cd840e070182fceee"}, "originalPosition": 27}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0de0af0db187b25a1d75e8e546775247615aa52f", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/0de0af0db187b25a1d75e8e546775247615aa52f", "committedDate": "2020-07-02T21:07:45Z", "message": "Merge remote-tracking branch 'upstream/master' into 2078-exception-bytes"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQyMDIwODcy", "url": "https://github.com/ConsenSys/teku/pull/2295#pullrequestreview-442020872", "createdAt": "2020-07-02T21:10:44Z", "commit": {"oid": "d9d08d969513de41f214577cd840e070182fceee"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7ac2d672e2f0c2db52ce19f51a9a1f0b63cacef0", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/7ac2d672e2f0c2db52ce19f51a9a1f0b63cacef0", "committedDate": "2020-07-02T21:36:09Z", "message": "Merge remote-tracking branch 'upstream/master' into 2078-exception-bytes\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>\n\n# Conflicts:\n#\tnetworking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/rpc/core/RpcResponseDecoder.java\n#\tnetworking/eth2/src/test/java/tech/pegasys/teku/networking/eth2/rpc/core/encodings/DefaultRpcPayloadEncoderTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5a87c0b798424f89a3acb2590f3ee3b88bd7c9e7", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/5a87c0b798424f89a3acb2590f3ee3b88bd7c9e7", "committedDate": "2020-07-02T21:54:58Z", "message": "Merge remote-tracking branch 'upstream/master' into 2078-exception-bytes"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3790, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}