{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQzMjAxNTI2", "number": 3421, "title": "Implement SSZ state retrieval on `/eth/v1/debug/beacon/states/:state_id`", "bodyText": "if accept-header application/octet-stream is passed, then SSZ will be returned, otherwise JSON will be returned if the accept header is empty or set to application/json.\n\n\nthis functionality was previously available on /teku/v1/beacon/states/:state_id, which has been deprecated in favour of the standard api implementation.\n\n\nimplements ethereum/beacon-APIs#119\n\n\nfixes #3411\nSigned-off-by: Paul Harris paul.harris@consensys.net\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.", "createdAt": "2020-12-21T03:52:42Z", "url": "https://github.com/ConsenSys/teku/pull/3421", "merged": true, "mergeCommit": {"oid": "843d683b4c267af7cfb3bb3937e535b0a9a83c0b"}, "closed": true, "closedAt": "2020-12-24T00:59:42Z", "author": {"login": "rolfyone"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdoNqH_gH2gAyNTQzMjAxNTI2OmRkODNhZTRjMTBhYTEyZjcxZmNhNmIxZTQ5ZGVkMTYwN2Y1NjBmYmY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdpI2DugH2gAyNTQzMjAxNTI2Ojg5MDYwZTc1MzdmMTM4NDkzNGYyMjFmZjNkNGQ3NDY2NmFlYzllZjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "dd83ae4c10aa12f71fca6b1e49ded1607f560fbf", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/dd83ae4c10aa12f71fca6b1e49ded1607f560fbf", "committedDate": "2020-12-21T03:48:59Z", "message": "Implement SSZ state retrieval on `/eth/v1/debug/beacon/states/:state_id`\n\n - if accept-header `application/octet-stream` is passed, then SSZ will be returned, otherwise JSON will be returned if the accept header is empty or set to `application/json`.\n\n - this functionality was previously available on `/teku/v1/beacon/states/:state_id`, which has been deprecated in favor of the standard api implementation.\n\nfixes #3411\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecccb0b8b20bd668edcc062b07fb898b4d17944c", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/ecccb0b8b20bd668edcc062b07fb898b4d17944c", "committedDate": "2020-12-21T05:32:56Z", "message": "Merge remote-tracking branch 'upstream/master' into 3411"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU4MDM5MjA5", "url": "https://github.com/ConsenSys/teku/pull/3421#pullrequestreview-558039209", "createdAt": "2020-12-23T16:15:45Z", "commit": {"oid": "ecccb0b8b20bd668edcc062b07fb898b4d17944c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxNjoxNTo0NVrOIKpYPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yM1QxNjoxNTo0NVrOIKpYPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0ODAzNDYyMQ==", "bodyText": "May be worth another test with an empty accept header", "url": "https://github.com/ConsenSys/teku/pull/3421#discussion_r548034621", "createdAt": "2020-12-23T16:15:45Z", "author": {"login": "mbaxter"}, "path": "data/beaconrestapi/src/integration-test/java/tech/pegasys/teku/beaconrestapi/v1/debug/GetStateIntegrationTest.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.beaconrestapi.v1.debug;\n+\n+import static javax.servlet.http.HttpServletResponse.SC_BAD_REQUEST;\n+import static javax.servlet.http.HttpServletResponse.SC_OK;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static tech.pegasys.teku.beaconrestapi.RestApiConstants.HEADER_ACCEPT_JSON;\n+import static tech.pegasys.teku.beaconrestapi.RestApiConstants.HEADER_ACCEPT_OCTET;\n+\n+import java.io.IOException;\n+import okhttp3.Response;\n+import org.apache.tuweni.bytes.Bytes;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import tech.pegasys.teku.api.response.v1.debug.GetStateResponse;\n+import tech.pegasys.teku.beaconrestapi.AbstractDataBackedRestAPIIntegrationTest;\n+import tech.pegasys.teku.beaconrestapi.handlers.v1.debug.GetState;\n+import tech.pegasys.teku.datastructures.state.BeaconState;\n+import tech.pegasys.teku.datastructures.util.SimpleOffsetSerializer;\n+\n+public class GetStateIntegrationTest extends AbstractDataBackedRestAPIIntegrationTest {\n+  @BeforeEach\n+  public void setup() {\n+    startRestAPIAtGenesis();\n+  }\n+\n+  @Test\n+  public void shouldGetStateAsJson() throws IOException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ecccb0b8b20bd668edcc062b07fb898b4d17944c"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57c2ef25b2e30111420bd3ca9df3edd75f0cc06a", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/57c2ef25b2e30111420bd3ca9df3edd75f0cc06a", "committedDate": "2020-12-23T21:06:53Z", "message": "Merge remote-tracking branch 'upstream/master' into 3411"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "89060e7537f1384934f221ff3d4d74666aec9ef5", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/89060e7537f1384934f221ff3d4d74666aec9ef5", "committedDate": "2020-12-24T00:46:25Z", "message": "add test for requesting state without an accept header.\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4400, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}