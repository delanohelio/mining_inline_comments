{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzcxNjQ2NTI4", "number": 1138, "title": "Remove usage of grpc for validator signing", "bodyText": "PR Description\nAvoids creating insecure open ports that expose the signing key\nAvoids port conflicts when running multiple instances on the same host\nFixes intermittency in ValidatorCoordinatorTest which was caused by those port conflicts.\nThere is still an interface in place so remote validator signing services could be used later, but there's no point in using GRPC and network sockets while we're hard coded to use the signing service in the same process anyway.\nFixed Issue(s)\nFixes #1134", "createdAt": "2020-02-06T00:08:08Z", "url": "https://github.com/ConsenSys/teku/pull/1138", "merged": true, "mergeCommit": {"oid": "31bd87681f555bfa88e1d2cc32605af708ec31df"}, "closed": true, "closedAt": "2020-02-06T02:05:26Z", "author": {"login": "ajsutton"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcBfRDAgH2gAyMzcxNjQ2NTI4OjNlNTRmNjY4NWE4ZWJiNWI4Y2JkNTRlOTI0YmRjNzk1YWJiZmI1NTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcBf1YNAFqTM1NDEzOTI5MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3e54f6685a8ebb5b8cbd54e924bdc795abbfb554", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/3e54f6685a8ebb5b8cbd54e924bdc795abbfb554", "committedDate": "2020-02-06T00:05:41Z", "message": "Remove usage of grpc for validator signing.\nAvoids creating insecure open ports that expose the signing key\nAvoids port conflicts when running multiple instances on the same host"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0MTM2MDY3", "url": "https://github.com/ConsenSys/teku/pull/1138#pullrequestreview-354136067", "createdAt": "2020-02-06T00:34:45Z", "commit": {"oid": "3e54f6685a8ebb5b8cbd54e924bdc795abbfb554"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQwMDozNDo0NVrOFmL52g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0wNlQwMDozNDo0NVrOFmL52g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTU4NTI0Mg==", "bodyText": "Unrelated but, it might be a good idea to move the naughtyValidator functionality to the test environment.", "url": "https://github.com/ConsenSys/teku/pull/1138#discussion_r375585242", "createdAt": "2020-02-06T00:34:45Z", "author": {"login": "cemozerr"}, "path": "validator/coordinator/src/main/java/tech/pegasys/artemis/validator/coordinator/ValidatorLoader.java", "diffHunk": "@@ -47,14 +44,11 @@\n     // Validators map\n     for (int i = 0; i < keypairs.size(); i++) {\n       BLSKeyPair keypair = keypairs.get(i);\n-      int port =\n-          Constants.VALIDATOR_CLIENT_PORT_BASE + i + keyProvider.getValidatorPortStartIndex();\n-      new ValidatorClient(keypair, port);\n-      ManagedChannel channel =\n-          ManagedChannelBuilder.forAddress(\"localhost\", port).usePlaintext().build();\n+      final LocalMessageSignerService signerService = new LocalMessageSignerService(keypair);\n       STDOUT.log(Level.DEBUG, \"Validator \" + i + \": \" + keypair.getPublicKey().toString());\n \n-      validators.put(keypair.getPublicKey(), new ValidatorInfo(numNaughtyValidators > 0, channel));\n+      validators.put(\n+          keypair.getPublicKey(), new ValidatorInfo(numNaughtyValidators > 0, signerService));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3e54f6685a8ebb5b8cbd54e924bdc795abbfb554"}, "originalPosition": 33}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzU0MTM5Mjkw", "url": "https://github.com/ConsenSys/teku/pull/1138#pullrequestreview-354139290", "createdAt": "2020-02-06T00:45:22Z", "commit": {"oid": "3e54f6685a8ebb5b8cbd54e924bdc795abbfb554"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4280, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}