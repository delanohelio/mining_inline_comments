{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUxMDI1MDQz", "number": 2376, "title": "Extract BLS interfaces for pluggable implementations", "bodyText": "PR Description\nExtract BLS implementation interfaces to make the BLS implementation pluggable\nFixed Issue(s)\nIs a part of #2300\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.", "createdAt": "2020-07-17T10:52:13Z", "url": "https://github.com/ConsenSys/teku/pull/2376", "merged": true, "mergeCommit": {"oid": "55d04f87b422112312f79c1b4d662b3d58e3ca74"}, "closed": true, "closedAt": "2020-07-21T10:52:42Z", "author": {"login": "Nashatyrev"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1jLJJgH2gAyNDUxMDI1MDQzOjdmZDUzMWJiNzM1NjE2NDA2YmRhYjZmNzJiZmNjZGY4ZWNhZjYyMWQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc3DvExgH2gAyNDUxMDI1MDQzOmQ2M2VkNzk5OTcxMzlmMTZiYzk2YzVmNTMyZDY5MWJhZGE2YTVlYWQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "7fd531bb735616406bdab6f72bfccdf8ecaf621d", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/7fd531bb735616406bdab6f72bfccdf8ecaf621d", "committedDate": "2020-07-16T18:02:55Z", "message": "Initial draft for BLS interfaces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69300d6d746f78fa517e2f43c8da168adf84b450", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/69300d6d746f78fa517e2f43c8da168adf84b450", "committedDate": "2020-07-16T19:02:44Z", "message": "exclude outdated junit transitive dependency from json-simple module"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8724e7f1e9d3bbff924de56ee13f0e83e47521ef", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/8724e7f1e9d3bbff924de56ee13f0e83e47521ef", "committedDate": "2020-07-16T20:06:23Z", "message": "Rename test file to Win compatible"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "84691cd609aed1ee0aa357b8c33dad7b152aa45b", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/84691cd609aed1ee0aa357b8c33dad7b152aa45b", "committedDate": "2020-07-16T20:23:20Z", "message": "Merge branch 'fix-bls-tests-1' into feature-bls-interfaces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8bafde8097d10593540eb8c0270bae987d62107", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/a8bafde8097d10593540eb8c0270bae987d62107", "committedDate": "2020-07-17T10:49:19Z", "message": "Another portion of draft changes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b5762f4aee4b16a48a31b7ac859eabdf527eba07", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/b5762f4aee4b16a48a31b7ac859eabdf527eba07", "committedDate": "2020-07-17T13:01:37Z", "message": "Adjust bls tests by separating them to abstract and implementation specific"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27aace71b79d77d6391efb4e797039e8be085abd", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/27aace71b79d77d6391efb4e797039e8be085abd", "committedDate": "2020-07-17T13:18:31Z", "message": "Add NoopBLS12381 implementation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5f93ac4be839856ed8ce4982d1c608ef08d70929", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/5f93ac4be839856ed8ce4982d1c608ef08d70929", "committedDate": "2020-07-17T13:24:24Z", "message": "Fix warnings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7c4faf635ea6915804b85790653e329101568426", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/7c4faf635ea6915804b85790653e329101568426", "committedDate": "2020-07-17T13:33:17Z", "message": "Fix more warns"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c221980d33528bc0e081a9445d2ba7af6df2c3fe", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/c221980d33528bc0e081a9445d2ba7af6df2c3fe", "committedDate": "2020-07-17T13:37:37Z", "message": "Merge remote-tracking branch 'pegasys/master' into feature-bls-interfaces\n\n# Conflicts:\n#\tbls/src/main/java/tech/pegasys/teku/bls/BLS.java\n#\tbls/src/main/java/tech/pegasys/teku/bls/BLSPublicKey.java\n#\tbls/src/test/java/tech/pegasys/teku/bls/BLSPublicKeyTest.java\n#\tdata/provider/src/main/java/tech/pegasys/teku/api/schema/BLSPubKey.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c41c8d8a21a6be79118bac9892cdbca6f02ab9b", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/8c41c8d8a21a6be79118bac9892cdbca6f02ab9b", "committedDate": "2020-07-17T13:55:44Z", "message": "Resolve merge conflicts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "aab091f6a18e7a86df5b45d5a6f2cddeb9244205", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/aab091f6a18e7a86df5b45d5a6f2cddeb9244205", "committedDate": "2020-07-17T14:39:45Z", "message": "Fix the test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2040313237e184415e6ec626704ca5946ab045c3", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/2040313237e184415e6ec626704ca5946ab045c3", "committedDate": "2020-07-20T10:54:35Z", "message": "Fix the test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "69313d7198d78bec898b98c1d3d932c72bedf9bd", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/69313d7198d78bec898b98c1d3d932c72bedf9bd", "committedDate": "2020-07-20T11:10:26Z", "message": "Merge remote-tracking branch 'pegasys/master' into feature-bls-interfaces"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUxNzI4NTI4", "url": "https://github.com/ConsenSys/teku/pull/2376#pullrequestreview-451728528", "createdAt": "2020-07-20T15:40:42Z", "commit": {"oid": "69313d7198d78bec898b98c1d3d932c72bedf9bd"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNTo1MjoyMlrOG0UfYg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzowODo1NlrOG0Xd5A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzUxNDg1MA==", "bodyText": "Any particular reason to use a single instance here?  We should probably make the constructor private if we're going to use this pattern.", "url": "https://github.com/ConsenSys/teku/pull/2376#discussion_r457514850", "createdAt": "2020-07-20T15:52:22Z", "author": {"login": "mbaxter"}, "path": "bls/src/main/java/tech/pegasys/teku/bls/impl/mikuli/MikuliBLS12381.java", "diffHunk": "@@ -46,8 +52,9 @@\n  * <p>Apache Milagro can be included using the gradle dependency\n  * 'org.miracl.milagro.amcl:milagro-crypto-java'.\n  */\n-public final class BLS12381 {\n+public class MikuliBLS12381 implements BLS12381 {\n \n+  public static final MikuliBLS12381 INSTANCE = new MikuliBLS12381();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69313d7198d78bec898b98c1d3d932c72bedf9bd"}, "originalPosition": 32}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzUyNTA2MQ==", "bodyText": "Instead of assuming these keys are a specific type, what if we have a static helper method MikuliPublicKey.create() that either casts and returns the signature or creates a new signature of the right type?", "url": "https://github.com/ConsenSys/teku/pull/2376#discussion_r457525061", "createdAt": "2020-07-20T16:05:40Z", "author": {"login": "mbaxter"}, "path": "bls/src/main/java/tech/pegasys/teku/bls/impl/mikuli/MikuliBLS12381.java", "diffHunk": "@@ -199,25 +216,50 @@ public static boolean coreAggregateVerify(\n    *\n    * @return the pair of values above in an opaque instance\n    */\n-  public static BatchSemiAggregate prepareBatchVerify(\n-      int index, List<PublicKey> publicKeys, Bytes message, Signature signature) {\n-\n+  @Override\n+  public BatchSemiAggregate prepareBatchVerify(\n+      int index, List<? extends PublicKey> publicKeys, Bytes message, Signature signature) {\n     G2Point sigG2Point;\n     G2Point msgG2Point;\n+\n+    List<MikuliPublicKey> mikuliPublicKeys =\n+        publicKeys.stream().map(pk -> (MikuliPublicKey) pk).collect(Collectors.toList());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69313d7198d78bec898b98c1d3d932c72bedf9bd"}, "originalPosition": 191}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU2MzYyMA==", "bodyText": "Do we need this?  Seems potentially dangerous ...", "url": "https://github.com/ConsenSys/teku/pull/2376#discussion_r457563620", "createdAt": "2020-07-20T17:08:56Z", "author": {"login": "mbaxter"}, "path": "bls/src/main/java/tech/pegasys/teku/bls/BLSSecretKey.java", "diffHunk": "@@ -79,4 +74,9 @@ public boolean equals(final Object o) {\n   public int hashCode() {\n     return Objects.hash(secretKey);\n   }\n+\n+  @Override\n+  public String toString() {\n+    return \"BLSSecretKey{\" + toBytes() + '}';", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "69313d7198d78bec898b98c1d3d932c72bedf9bd"}, "originalPosition": 41}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0f52af3ffd9cfd2056209232365ba9d0d0af532e", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/0f52af3ffd9cfd2056209232365ba9d0d0af532e", "committedDate": "2020-07-20T17:42:55Z", "message": "Make singleton constructor private"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cdd7a380e55372520a0599eeabc5aea4fd5c107d", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/cdd7a380e55372520a0599eeabc5aea4fd5c107d", "committedDate": "2020-07-20T17:47:09Z", "message": "Remove BLSSecretKey.toString() as might be dangerous"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "198f872611fb6d5452009114eac4e3b70120439e", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/198f872611fb6d5452009114eac4e3b70120439e", "committedDate": "2020-07-20T17:58:24Z", "message": "Fallback to creating MikuliPublickKey and MikuliSignature from bytes when passed instance is not of Mikuli type"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "000e6d51ca34b8b84315fc27133ae54f365ab2dd", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/000e6d51ca34b8b84315fc27133ae54f365ab2dd", "committedDate": "2020-07-20T18:14:34Z", "message": "Apply spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "677d313834bb17fd3a7c9777fe054b0ea5fffda5", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/677d313834bb17fd3a7c9777fe054b0ea5fffda5", "committedDate": "2020-07-20T18:19:22Z", "message": "Make MikuliBLS12381 constructor protected since the NoopBLS12381 is derived"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "832d7c068112f9993d25383e9cf79212bc14768d", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/832d7c068112f9993d25383e9cf79212bc14768d", "committedDate": "2020-07-20T19:09:20Z", "message": "Use MikuliSignature.fromSignature instead of cast"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7497b1f936ac2917c6eb86e1a132d23052663b6", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/d7497b1f936ac2917c6eb86e1a132d23052663b6", "committedDate": "2020-07-20T19:10:13Z", "message": "Merge remote-tracking branch 'pegasys/master' into feature-bls-interfaces"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23d706a0821e197726fb388c40c42cf1f51d8790", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/23d706a0821e197726fb388c40c42cf1f51d8790", "committedDate": "2020-07-21T10:32:57Z", "message": "Add log warning that BLS verification is disables for NoopBLS12381"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d63ed79997139f16bc96c5f532d691bada6a5ead", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/d63ed79997139f16bc96c5f532d691bada6a5ead", "committedDate": "2020-07-21T10:33:03Z", "message": "Merge remote-tracking branch 'pegasys/master' into feature-bls-interfaces"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3640, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}