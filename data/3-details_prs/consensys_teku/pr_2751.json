{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDgxODUwMzQ3", "number": 2751, "title": "Passing additional metadata to external signers", "bodyText": "PR Description\nPass additional meta-data to external signers so that they can apply slashing protection.\nRemoved MessageSignerService. Signer interface is now implemented directly by LocalSigner and ExternalSigner. This makes related metadata available to external signer's sign methods directly.\nThe Path (which is suffixed to external signer url) has been updated from /signer/sign to /api/v1/eth2/sign.\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.\n\nSigned-off-by: Usman Saleem usman@usmans.info", "createdAt": "2020-09-08T07:44:13Z", "url": "https://github.com/ConsenSys/teku/pull/2751", "merged": true, "mergeCommit": {"oid": "a6beea5c3962b14877b8fe253d7d9dd4e79cdd40"}, "closed": true, "closedAt": "2020-09-11T00:06:45Z", "author": {"login": "usmansaleem"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdGyp2qgH2gAyNDgxODUwMzQ3OmNiZmNhYzRiZDIyMTZkYjZkYjFlOWEzMTQ4ZGE2NjAwNDQ2OTFjZDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHpuPNgH2gAyNDgxODUwMzQ3OjgzNTU1NjRmOTU2MDI2ZmQ3ODFjNjhlNzMyZGQ0OTZhMzAwYTdiYmI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "cbfcac4bd2216db6db1e9a3148da660044691cd4", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/cbfcac4bd2216db6db1e9a3148da660044691cd4", "committedDate": "2020-09-08T07:41:45Z", "message": "Passing additional metadata to external signer\n\n -- so that external signer can apply slash protection rules\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a8ffba31b142c7b175883d4c340ab994ebe38345", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/a8ffba31b142c7b175883d4c340ab994ebe38345", "committedDate": "2020-09-08T07:44:37Z", "message": "Merge remote-tracking branch 'upstream/master' into external_signer_with_slash_protection\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4330f4c069d3cc44ed9ecfeb325ccd9cdcf6593a", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/4330f4c069d3cc44ed9ecfeb325ccd9cdcf6593a", "committedDate": "2020-09-08T23:30:02Z", "message": "Fixing LocalMessageSignerServiceTest\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2a858c5f3b80f41780e5161cd9c56f453183d18c", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/2a858c5f3b80f41780e5161cd9c56f453183d18c", "committedDate": "2020-09-09T00:39:30Z", "message": "Fixing SignerTest\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "996a194adf2fd8a1ffffe395ec5bd757fe80c0c6", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/996a194adf2fd8a1ffffe395ec5bd757fe80c0c6", "committedDate": "2020-09-09T00:39:43Z", "message": "Merge remote-tracking branch 'upstream/master' into external_signer_with_slash_protection\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ec92b2168ac04edc9fc37ce3a3beee36e25ef699", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/ec92b2168ac04edc9fc37ce3a3beee36e25ef699", "committedDate": "2020-09-09T01:48:48Z", "message": "Merge remote-tracking branch 'upstream/master' into external_signer_with_slash_protection\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb7c875789fd83a378df221f2a2742156cf6b6f8", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/bb7c875789fd83a378df221f2a2742156cf6b6f8", "committedDate": "2020-09-09T04:21:27Z", "message": "MessageSignerService sign method signatures to take additionalProperties\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NjUxNDE1", "url": "https://github.com/ConsenSys/teku/pull/2751#pullrequestreview-484651415", "createdAt": "2020-09-09T04:25:23Z", "commit": {"oid": "bb7c875789fd83a378df221f2a2742156cf6b6f8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwNDoyNToyM1rOHO2JzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwNDoyNToyM1rOHO2JzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTMyOTM1Ng==", "bodyText": "I'm not sure this is the right approach.  We shouldn't need to create a map of properties when we already have the required data in a suitable format.  I'd suggest that the MessageSignerService interface is removed and just move everything up to the Signer interface which has the required data and is where the built-in slashing protection hooks in.\nMay need to extract a helper class to compute the signing root for data rather than having to duplicate that logic but that's doable.", "url": "https://github.com/ConsenSys/teku/pull/2751#discussion_r485329356", "createdAt": "2020-09-09T04:25:23Z", "author": {"login": "ajsutton"}, "path": "ethereum/core/src/main/java/tech/pegasys/teku/core/signatures/LocalMessageSignerService.java", "diffHunk": "@@ -43,22 +43,26 @@ public LocalMessageSignerService(final BLSKeyPair keypair, final AsyncRunner asy\n   }\n \n   @Override\n-  public SafeFuture<BLSSignature> signAggregationSlot(final Bytes signingRoot) {\n+  public SafeFuture<BLSSignature> signAggregationSlot(\n+      final Bytes signingRoot, final Map<String, Object> additionalProperties) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb7c875789fd83a378df221f2a2742156cf6b6f8"}, "originalPosition": 6}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf7a48b8fd68077d040554be1e880f088a2aeab4", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/bf7a48b8fd68077d040554be1e880f088a2aeab4", "committedDate": "2020-09-09T04:25:28Z", "message": "Fixing LocalMessageSignerServiceTest\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg0NjcyNzUx", "url": "https://github.com/ConsenSys/teku/pull/2751#pullrequestreview-484672751", "createdAt": "2020-09-09T05:33:45Z", "commit": {"oid": "bf7a48b8fd68077d040554be1e880f088a2aeab4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwNTozMzo0NVrOHO3UGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQwNTozMzo0NVrOHO3UGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTM0ODM3Nw==", "bodyText": "This and the below sign methods don't require any additional parameters for the signing protection it's only the attestation and block", "url": "https://github.com/ConsenSys/teku/pull/2751#discussion_r485348377", "createdAt": "2020-09-09T05:33:45Z", "author": {"login": "jframe"}, "path": "ethereum/core/src/main/java/tech/pegasys/teku/core/signatures/LocalMessageSignerService.java", "diffHunk": "@@ -30,32 +31,38 @@ public LocalMessageSignerService(final BLSKeyPair keypair, final AsyncRunner asy\n   }\n \n   @Override\n-  public SafeFuture<BLSSignature> signBlock(final Bytes signingRoot) {\n+  public SafeFuture<BLSSignature> signBlock(\n+      final Bytes signingRoot, final Map<String, Object> additionalProperties) {\n     return sign(signingRoot);\n   }\n \n   @Override\n-  public SafeFuture<BLSSignature> signAttestation(final Bytes signingRoot) {\n+  public SafeFuture<BLSSignature> signAttestation(\n+      final Bytes signingRoot, final Map<String, Object> additionalProperties) {\n     return sign(signingRoot);\n   }\n \n   @Override\n-  public SafeFuture<BLSSignature> signAggregationSlot(final Bytes signingRoot) {\n+  public SafeFuture<BLSSignature> signAggregationSlot(\n+      final Bytes signingRoot, final Map<String, Object> additionalProperties) {\n     return sign(signingRoot);\n   }\n \n   @Override\n-  public SafeFuture<BLSSignature> signAggregateAndProof(final Bytes signingRoot) {\n+  public SafeFuture<BLSSignature> signAggregateAndProof(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bf7a48b8fd68077d040554be1e880f088a2aeab4"}, "originalPosition": 34}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "939e0d8e8abbeda4b83ef6eb8a2821f6b9fa44f1", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/939e0d8e8abbeda4b83ef6eb8a2821f6b9fa44f1", "committedDate": "2020-09-09T09:39:37Z", "message": "Merge remote-tracking branch 'upstream/master' into external_signer_with_slash_protection\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1084cd018fc59ea580e6ee67e63b89554988b2f7", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/1084cd018fc59ea580e6ee67e63b89554988b2f7", "committedDate": "2020-09-10T03:19:48Z", "message": "Review suggestion - remove MessageSignerService\n\n -- LocalSigner and ExternalSigner implements Signer interface\n-- Update references and test cases\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "057bde7f5df928259c443343098d03d9b4819572", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/057bde7f5df928259c443343098d03d9b4819572", "committedDate": "2020-09-10T03:20:01Z", "message": "Merge remote-tracking branch 'upstream/master' into external_signer_with_slash_protection\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "351f772158a0fd66306a071cf790cc1c7a2c04e3", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/351f772158a0fd66306a071cf790cc1c7a2c04e3", "committedDate": "2020-09-10T03:31:46Z", "message": "minor refactoring signingrequestbody\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb2092bdd9c76546c6ba47711e2287f214e8bdab", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/bb2092bdd9c76546c6ba47711e2287f214e8bdab", "committedDate": "2020-09-10T03:45:49Z", "message": "cleaning SigningRequestBody\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1NTUwOTI1", "url": "https://github.com/ConsenSys/teku/pull/2751#pullrequestreview-485550925", "createdAt": "2020-09-10T04:08:20Z", "commit": {"oid": "bb2092bdd9c76546c6ba47711e2287f214e8bdab"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwNDowODoyMFrOHPiLGg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQwNDoxNDoyN1rOHPiQ6Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjA1MDU4Ng==", "bodyText": "This name seems odd, shouldSignBlock?", "url": "https://github.com/ConsenSys/teku/pull/2751#discussion_r486050586", "createdAt": "2020-09-10T04:08:20Z", "author": {"login": "jframe"}, "path": "ethereum/core/src/test/java/tech/pegasys/teku/core/signatures/LocalSignerTest.java", "diffHunk": "@@ -0,0 +1,121 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.core.signatures;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+import org.apache.tuweni.bytes.Bytes;\n+import org.junit.jupiter.api.Test;\n+import tech.pegasys.teku.bls.BLSKeyPair;\n+import tech.pegasys.teku.bls.BLSSignature;\n+import tech.pegasys.teku.datastructures.blocks.BeaconBlock;\n+import tech.pegasys.teku.datastructures.operations.AggregateAndProof;\n+import tech.pegasys.teku.datastructures.operations.AttestationData;\n+import tech.pegasys.teku.datastructures.operations.VoluntaryExit;\n+import tech.pegasys.teku.datastructures.state.ForkInfo;\n+import tech.pegasys.teku.datastructures.util.DataStructureUtil;\n+import tech.pegasys.teku.infrastructure.async.SafeFuture;\n+import tech.pegasys.teku.infrastructure.async.StubAsyncRunner;\n+import tech.pegasys.teku.infrastructure.unsigned.UInt64;\n+\n+class LocalSignerTest {\n+  private final DataStructureUtil dataStructureUtil = new DataStructureUtil();\n+  private final ForkInfo fork = dataStructureUtil.randomForkInfo();\n+\n+  private static final BLSKeyPair KEYPAIR = BLSKeyPair.random(1234);\n+  private final StubAsyncRunner asyncRunner = new StubAsyncRunner();\n+\n+  private final LocalSigner signer = new LocalSigner(KEYPAIR, asyncRunner);\n+\n+  @Test\n+  public void shouldSignBlock1() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb2092bdd9c76546c6ba47711e2287f214e8bdab"}, "originalPosition": 42}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjA1MTAyMA==", "bodyText": "Is this needed? It looks almost the same as the LocalSigner.", "url": "https://github.com/ConsenSys/teku/pull/2751#discussion_r486051020", "createdAt": "2020-09-10T04:10:12Z", "author": {"login": "jframe"}, "path": "ethereum/core/src/testFixtures/java/tech/pegasys/teku/core/signatures/TestSigner.java", "diffHunk": "@@ -0,0 +1,83 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.core.signatures;\n+\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignAggregateAndProof;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignAggregationSlot;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignAttestationData;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignBlock;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignVoluntaryExit;\n+\n+import org.apache.tuweni.bytes.Bytes;\n+import tech.pegasys.teku.bls.BLS;\n+import tech.pegasys.teku.bls.BLSKeyPair;\n+import tech.pegasys.teku.bls.BLSSignature;\n+import tech.pegasys.teku.datastructures.blocks.BeaconBlock;\n+import tech.pegasys.teku.datastructures.operations.AggregateAndProof;\n+import tech.pegasys.teku.datastructures.operations.AttestationData;\n+import tech.pegasys.teku.datastructures.operations.VoluntaryExit;\n+import tech.pegasys.teku.datastructures.state.ForkInfo;\n+import tech.pegasys.teku.infrastructure.async.SafeFuture;\n+import tech.pegasys.teku.infrastructure.unsigned.UInt64;\n+\n+public class TestSigner implements Signer {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb2092bdd9c76546c6ba47711e2287f214e8bdab"}, "originalPosition": 34}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjA1MjA3Mw==", "bodyText": "can we include the type on all the sign requests. although there will be no additional data it would be nice for our metrics to seperate the type of signing request.", "url": "https://github.com/ConsenSys/teku/pull/2751#discussion_r486052073", "createdAt": "2020-09-10T04:14:27Z", "author": {"login": "jframe"}, "path": "validator/client/src/main/java/tech/pegasys/teku/validator/client/signer/ExternalSigner.java", "diffHunk": "@@ -0,0 +1,162 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.validator.client.signer;\n+\n+import static java.util.Collections.emptyMap;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForRandaoReveal;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignAggregateAndProof;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignAggregationSlot;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignAttestationData;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignBlock;\n+import static tech.pegasys.teku.core.signatures.SigningRootUtil.signingRootForSignVoluntaryExit;\n+\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import java.net.URI;\n+import java.net.URL;\n+import java.net.http.HttpClient;\n+import java.net.http.HttpRequest;\n+import java.net.http.HttpRequest.BodyPublishers;\n+import java.net.http.HttpResponse;\n+import java.net.http.HttpResponse.BodyHandlers;\n+import java.time.Duration;\n+import java.util.Map;\n+import org.apache.tuweni.bytes.Bytes;\n+import tech.pegasys.teku.bls.BLSPublicKey;\n+import tech.pegasys.teku.bls.BLSSignature;\n+import tech.pegasys.teku.core.signatures.Signer;\n+import tech.pegasys.teku.datastructures.blocks.BeaconBlock;\n+import tech.pegasys.teku.datastructures.operations.AggregateAndProof;\n+import tech.pegasys.teku.datastructures.operations.AttestationData;\n+import tech.pegasys.teku.datastructures.operations.VoluntaryExit;\n+import tech.pegasys.teku.datastructures.state.ForkInfo;\n+import tech.pegasys.teku.infrastructure.async.SafeFuture;\n+import tech.pegasys.teku.infrastructure.unsigned.UInt64;\n+import tech.pegasys.teku.provider.JsonProvider;\n+\n+public class ExternalSigner implements Signer {\n+  public static final String EXTERNAL_SIGNER_ENDPOINT = \"/api/v1/eth2/sign\";\n+  private final JsonProvider jsonProvider = new JsonProvider();\n+  private final URL signingServiceUrl;\n+  private final BLSPublicKey blsPublicKey;\n+  private final Duration timeout;\n+  private final HttpClient httpClient = HttpClient.newHttpClient();\n+\n+  public ExternalSigner(\n+      final URL signingServiceUrl, final BLSPublicKey blsPublicKey, final Duration timeout) {\n+    this.signingServiceUrl = signingServiceUrl;\n+    this.blsPublicKey = blsPublicKey;\n+    this.timeout = timeout;\n+  }\n+\n+  @Override\n+  public SafeFuture<BLSSignature> createRandaoReveal(final UInt64 epoch, final ForkInfo forkInfo) {\n+    return sign(signingRootForRandaoReveal(epoch, forkInfo), emptyMap());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "bb2092bdd9c76546c6ba47711e2287f214e8bdab"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c737ce56bbb28ccd924f346ec507e97869dea408", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/c737ce56bbb28ccd924f346ec507e97869dea408", "committedDate": "2020-09-10T06:15:10Z", "message": "Removing TestSigner as LocalSigner can be used instead\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e22c17ba39254a91c8fddf2da293f00e790bd03", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/9e22c17ba39254a91c8fddf2da293f00e790bd03", "committedDate": "2020-09-10T06:44:44Z", "message": "Send sign type to external signer\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "45117ceefbfd1a105de5da64f11521729e5ccf0f", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/45117ceefbfd1a105de5da64f11521729e5ccf0f", "committedDate": "2020-09-10T06:49:54Z", "message": "Using SyncRunner in tests\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2f048f8739ec778a712c5b0a8c53693547d443d", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/c2f048f8739ec778a712c5b0a8c53693547d443d", "committedDate": "2020-09-10T06:51:13Z", "message": "Merge remote-tracking branch 'upstream/master' into external_signer_with_slash_protection\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b00410a30da2117401bd4487821985be5a1aa6f4", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/b00410a30da2117401bd4487821985be5a1aa6f4", "committedDate": "2020-09-10T07:00:23Z", "message": "Adding test fixture dependency\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg2Mzc3NzEx", "url": "https://github.com/ConsenSys/teku/pull/2751#pullrequestreview-486377711", "createdAt": "2020-09-10T23:29:39Z", "commit": {"oid": "b00410a30da2117401bd4487821985be5a1aa6f4"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzoyOTozOVrOHQJGjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xMFQyMzoyOTozOVrOHQJGjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY4ODM5Nw==", "bodyText": "Any particular reason to used a LinkedHashMap instead of just HashMap here?", "url": "https://github.com/ConsenSys/teku/pull/2751#discussion_r486688397", "createdAt": "2020-09-10T23:29:39Z", "author": {"login": "ajsutton"}, "path": "validator/client/src/main/java/tech/pegasys/teku/validator/client/signer/SigningRequestBody.java", "diffHunk": "@@ -13,28 +13,51 @@\n \n package tech.pegasys.teku.validator.client.signer;\n \n-import com.fasterxml.jackson.annotation.JsonCreator;\n-import com.fasterxml.jackson.annotation.JsonGetter;\n-import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n+import com.fasterxml.jackson.annotation.JsonAnyGetter;\n+import com.fasterxml.jackson.annotation.JsonAnySetter;\n import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.util.LinkedHashMap;\n+import java.util.Map;\n import org.apache.tuweni.bytes.Bytes;\n \n-@JsonIgnoreProperties(ignoreUnknown = true)\n public class SigningRequestBody {\n+  @JsonProperty(\"signingRoot\")\n+  private Bytes signingRoot;\n \n-  private final Bytes data;\n+  @JsonProperty(\"type\")\n+  private SignType type;\n \n-  @JsonCreator\n-  public SigningRequestBody(@JsonProperty(\"data\") final String data) {\n-    this.data = Bytes.fromHexString(data);\n+  @JsonAnySetter private final Map<String, Object> metadata = new LinkedHashMap<>();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b00410a30da2117401bd4487821985be5a1aa6f4"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c29fa046a1478b98965ee1c85357ca4bf2a651c7", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/c29fa046a1478b98965ee1c85357ca4bf2a651c7", "committedDate": "2020-09-10T23:49:49Z", "message": "Merge remote-tracking branch 'upstream/master' into external_signer_with_slash_protection\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8355564f956026fd781c68e732dd496a300a7bbb", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/8355564f956026fd781c68e732dd496a300a7bbb", "committedDate": "2020-09-10T23:51:19Z", "message": "review suggestion - using Hashmap in SigningRequestBody\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3404, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}