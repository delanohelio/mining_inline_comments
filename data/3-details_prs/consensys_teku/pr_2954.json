{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxODg2Mzc5", "number": 2954, "title": "Improve REST API error reporting", "bodyText": "PR Description\nLog unexpected errors instead of just returning a 500 result and suppressing the exception.\nHandle NodeSyncingException and report as 503 status.\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.", "createdAt": "2020-10-12T23:55:49Z", "url": "https://github.com/ConsenSys/teku/pull/2954", "merged": true, "mergeCommit": {"oid": "13f8611ca687c924b33f7a1d4e573e71a7cab49a"}, "closed": true, "closedAt": "2020-10-13T00:37:39Z", "author": {"login": "ajsutton"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdR8yH6AH2gAyNTAxODg2Mzc5OjNkMDdhNGIwZGVmNTIyNjk3ZDg5MjUxNDFhNDAyYWJjNGYzZTcxYjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdR9jBygFqTUwNjk5NjQ3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "3d07a4b0def522697d8925141a402abc4f3e71b2", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/3d07a4b0def522697d8925141a402abc4f3e71b2", "committedDate": "2020-10-12T23:43:00Z", "message": "Report internal server errors correctly.\nHandle NodeSyncingException and report as 503 status."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "53cd4feb7dada1adc82390f4b1f51c546d981f07", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/53cd4feb7dada1adc82390f4b1f51c546d981f07", "committedDate": "2020-10-12T23:56:22Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into report-internal-server-errors"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2OTkwMTQz", "url": "https://github.com/ConsenSys/teku/pull/2954#pullrequestreview-506990143", "createdAt": "2020-10-13T00:13:24Z", "commit": {"oid": "53cd4feb7dada1adc82390f4b1f51c546d981f07"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwMDoxMzoyNFrOHgROGQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xM1QwMDoxMzoyNFrOHgROGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzU5ODYxNw==", "bodyText": "this breaks a lot of the old api's if we care about that?", "url": "https://github.com/ConsenSys/teku/pull/2954#discussion_r503598617", "createdAt": "2020-10-13T00:13:24Z", "author": {"login": "rolfyone"}, "path": "data/beaconrestapi/src/main/java/tech/pegasys/teku/beaconrestapi/BeaconRestApi.java", "diffHunk": "@@ -161,19 +166,32 @@ private String readResource(final String fileName, Charset charset) throws IOExc\n   }\n \n   private void addExceptionHandlers() {\n+    app.exception(ChainDataUnavailableException.class, (e, ctx) -> ctx.status(SC_NO_CONTENT));\n     app.exception(\n-        ChainDataUnavailableException.class,\n+        NodeSyncingException.class,\n         (e, ctx) -> {\n-          ctx.status(SC_NO_CONTENT);\n+          ctx.status(SC_SERVICE_UNAVAILABLE);\n+          setErrorBody(ctx, () -> BadRequest.serviceUnavailable(jsonProvider));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "53cd4feb7dada1adc82390f4b1f51c546d981f07"}, "originalPosition": 42}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2OTk2NDc4", "url": "https://github.com/ConsenSys/teku/pull/2954#pullrequestreview-506996478", "createdAt": "2020-10-13T00:36:25Z", "commit": {"oid": "53cd4feb7dada1adc82390f4b1f51c546d981f07"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3349, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}