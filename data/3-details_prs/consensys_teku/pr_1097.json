{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0NjM3ODQz", "number": 1097, "title": "Update to 0.9.4 spec", "bodyText": "PR Description\nApply the changes from 0.9.3 and 0.9.4 spec updates.  Unfortunately has a lot of changes because of the move from BeaconBlock to SignedBeaconBlock.\nForkChoiceUtil has a PROCESS_ATTESTATIONS_EARLY flag in it which is currently set to preserve a spec bug which is fixed in 0.9.3.  Attestations shouldn't be processed in the same slot they are created. The check for this was broken in previous spec versions so it was allowed and Artemis currently has no way to defer attestation processing.  So for now we continue to allow attestations from the current slot but should remove this one delaying attestations is supported. Created https://pegasys1.atlassian.net/browse/BC-218 for this.", "createdAt": "2020-01-20T04:37:14Z", "url": "https://github.com/ConsenSys/teku/pull/1097", "merged": true, "mergeCommit": {"oid": "1b30ae4c3a9931299d1777fb0986a38e2405bbab"}, "closed": true, "closedAt": "2020-01-20T22:49:53Z", "author": {"login": "ajsutton"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7_mwqgH2gAyMzY0NjM3ODQzOjE0OWQxYTkzMGM4N2RkNGIyNzhjZGFiNzBiZTE3Y2NlMjE3ZjhjYjc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb8UcxngH2gAyMzY0NjM3ODQzOmUzNmY4MWM2M2JlZDI1OWYwNjRlNjNmNDJjNGQ3MGY2N2UwMjczZWU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "149d1a930c87dd4b278cdab70be17cce217f8cb7", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/149d1a930c87dd4b278cdab70be17cce217f8cb7", "committedDate": "2020-01-19T22:22:49Z", "message": "Signed wrappers."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1298939827995fd5215fe7fe63ce985071f6727c", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/1298939827995fd5215fe7fe63ce985071f6727c", "committedDate": "2020-01-20T01:42:49Z", "message": "Make reference tests work.  Include actual name of reference test in JUnit test name."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "420981c1f896c755351ab425c36ddbe2ebb23362", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/420981c1f896c755351ab425c36ddbe2ebb23362", "committedDate": "2020-01-20T03:43:59Z", "message": "Final updates to fork choice.\nNote change from unix time to store time in ForkChoiceUtil."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "859edde72e4e96821064121950dccab537096f95", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/859edde72e4e96821064121950dccab537096f95", "committedDate": "2020-01-20T04:27:43Z", "message": "Restore the bug that allows attestations from the current slot to be processed until we support delaying them."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "02f1572eb2d557502b16a19e198740ffd1fa0ac9", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/02f1572eb2d557502b16a19e198740ffd1fa0ac9", "committedDate": "2020-01-20T04:31:32Z", "message": "Default to verifying signatures and state."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "83318eb1161b6c6bd0581096917b7f75be0b71d5", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/83318eb1161b6c6bd0581096917b7f75be0b71d5", "committedDate": "2020-01-20T05:15:14Z", "message": "Spotless."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MTY2OTQy", "url": "https://github.com/ConsenSys/teku/pull/1097#pullrequestreview-345166942", "createdAt": "2020-01-20T09:18:05Z", "commit": {"oid": "83318eb1161b6c6bd0581096917b7f75be0b71d5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1NDI5MjY1", "url": "https://github.com/ConsenSys/teku/pull/1097#pullrequestreview-345429265", "createdAt": "2020-01-20T16:40:41Z", "commit": {"oid": "83318eb1161b6c6bd0581096917b7f75be0b71d5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9503d6542b07862937c083fb3a1d75e2750b8e63", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/9503d6542b07862937c083fb3a1d75e2750b8e63", "committedDate": "2020-01-20T20:02:44Z", "message": "Merge branch 'master' into 0.9.4"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1NTE2MDM0", "url": "https://github.com/ConsenSys/teku/pull/1097#pullrequestreview-345516034", "createdAt": "2020-01-20T20:16:24Z", "commit": {"oid": "9503d6542b07862937c083fb3a1d75e2750b8e63"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQyMDoxNjoyNVrOFfoZ2w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQyMDoxNjoyNVrOFfoZ2w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODcxMjE1NQ==", "bodyText": "I think the last Bytes.EMPTY here should be removed since I reckon that was for the signature", "url": "https://github.com/ConsenSys/teku/pull/1097#discussion_r368712155", "createdAt": "2020-01-20T20:16:25Z", "author": {"login": "cemozerr"}, "path": "ethereum/datastructures/src/main/java/tech/pegasys/artemis/datastructures/blocks/BeaconBlock.java", "diffHunk": "@@ -45,72 +41,51 @@\n   // Body\n   private BeaconBlockBody body;\n \n-  // Signature\n-  private BLSSignature signature;\n-\n   public BeaconBlock(\n-      UnsignedLong slot,\n-      Bytes32 parent_root,\n-      Bytes32 state_root,\n-      BeaconBlockBody body,\n-      BLSSignature signature) {\n+      UnsignedLong slot, Bytes32 parent_root, Bytes32 state_root, BeaconBlockBody body) {\n     this.slot = slot;\n     this.parent_root = parent_root;\n     this.state_root = state_root;\n     this.body = body;\n-    this.signature = signature;\n   }\n \n   public BeaconBlock() {\n     this.slot = UnsignedLong.ZERO;\n     this.parent_root = Bytes32.ZERO;\n     this.state_root = Bytes32.ZERO;\n     this.body = new BeaconBlockBody();\n-    this.signature = BLSSignature.empty();\n   }\n \n   public BeaconBlock(Bytes32 state_root) {\n     this.slot = UnsignedLong.ZERO;\n     this.parent_root = Bytes32.ZERO;\n     this.state_root = state_root;\n     this.body = new BeaconBlockBody();\n-    this.signature = BLSSignature.empty();\n   }\n \n   @Override\n   public int getSSZFieldCount() {\n-    return SSZ_FIELD_COUNT + body.getSSZFieldCount() + signature.getSSZFieldCount();\n+    return SSZ_FIELD_COUNT + body.getSSZFieldCount();\n   }\n \n   @Override\n   public List<Bytes> get_fixed_parts() {\n-    List<Bytes> fixedPartsList = new ArrayList<>();\n-    fixedPartsList.addAll(\n-        List.of(\n-            SSZ.encodeUInt64(slot.longValue()),\n-            SSZ.encode(writer -> writer.writeFixedBytes(parent_root)),\n-            SSZ.encode(writer -> writer.writeFixedBytes(state_root)),\n-            Bytes.EMPTY));\n-    fixedPartsList.addAll(signature.get_fixed_parts());\n-    return fixedPartsList;\n+    return List.of(\n+        SSZ.encodeUInt64(slot.longValue()),\n+        SSZ.encode(writer -> writer.writeFixedBytes(parent_root)),\n+        SSZ.encode(writer -> writer.writeFixedBytes(state_root)),\n+        Bytes.EMPTY);\n   }\n \n   @Override\n   public List<Bytes> get_variable_parts() {\n-    List<Bytes> variablePartsList = new ArrayList<>();\n-    variablePartsList.addAll(\n-        List.of(\n-            Bytes.EMPTY,\n-            Bytes.EMPTY,\n-            Bytes.EMPTY,\n-            SimpleOffsetSerializer.serialize(body),\n-            Bytes.EMPTY));\n-    return variablePartsList;\n+    return List.of(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9503d6542b07862937c083fb3a1d75e2750b8e63"}, "originalPosition": 97}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a16a03debb9d4f38ba015ddbaa53ff24544e47f2", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/a16a03debb9d4f38ba015ddbaa53ff24544e47f2", "committedDate": "2020-01-20T20:36:55Z", "message": "Remove unnecessary Bytes.EMPTY."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e36f81c63bed259f064e63f42c4d70f67e0273ee", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/e36f81c63bed259f064e63f42c4d70f67e0273ee", "committedDate": "2020-01-20T22:39:55Z", "message": "Update benchmarks for SignedBeaconBlock."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4203, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}