{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAwNjAzNzgz", "number": 1554, "title": "added a default path for data folder", "bodyText": "added a default path for log files\nUpdated regression tests to cope with the user path based defaults.\nSigned-off-by: Paul Harris paul.harris@consensys.net", "createdAt": "2020-04-08T03:11:34Z", "url": "https://github.com/ConsenSys/teku/pull/1554", "merged": true, "mergeCommit": {"oid": "a2a83af02ade91710b8e7614d30afc84161941bb"}, "closed": true, "closedAt": "2020-04-09T02:43:33Z", "author": {"login": "rolfyone"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcVfEjFgH2gAyNDAwNjAzNzgzOjk2NGExZWEwNjViMmVhYTIyNWU3ODY2YjgyMmNmYzEwMzIwMzg5MmI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVzFHJAH2gAyNDAwNjAzNzgzOmNlZmQ5MjMxMzg3NDVjYWUzNTY2MGQ2OGQyMzEzMmIyYzQ3OWQwOTE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "964a1ea065b2eaa225e7866b822cfc103203892b", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/964a1ea065b2eaa225e7866b822cfc103203892b", "committedDate": "2020-04-08T03:10:31Z", "message": "added a default path for data folder\n\nadded a default path for log files\n\nUpdated regression tests to cope with the user path based defaults.\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "16bc210cf4b349be51d55bab9d872d3b0830846c", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/16bc210cf4b349be51d55bab9d872d3b0830846c", "committedDate": "2020-04-08T03:11:54Z", "message": "Merge remote-tracking branch 'upstream/master' into 1411-default-storage-path"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5NjgyMzI2", "url": "https://github.com/ConsenSys/teku/pull/1554#pullrequestreview-389682326", "createdAt": "2020-04-08T06:24:48Z", "commit": {"oid": "16bc210cf4b349be51d55bab9d872d3b0830846c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwNjoyNDo0OFrOGCgohA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwNjoyNDo0OFrOGCgohA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTI4NDk5Ng==", "bodyText": "interesting - I changed BEACONCHAIN to BEACON", "url": "https://github.com/ConsenSys/teku/pull/1554#discussion_r405284996", "createdAt": "2020-04-08T06:24:48Z", "author": {"login": "macfarla"}, "path": "artemis/src/test/java/tech/pegasys/artemis/cli/BeaconNodeCommandTest.java", "diffHunk": "@@ -228,9 +242,9 @@ private ArtemisConfigurationBuilder expectedConfigurationBuilder() {\n         .setMetricsInterface(\"127.0.0.1\")\n         .setMetricsCategories(Arrays.asList(\"BEACONCHAIN\", \"JVM\", \"PROCESS\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16bc210cf4b349be51d55bab9d872d3b0830846c"}, "originalPosition": 59}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5ODIxMjYz", "url": "https://github.com/ConsenSys/teku/pull/1554#pullrequestreview-389821263", "createdAt": "2020-04-08T09:50:44Z", "commit": {"oid": "16bc210cf4b349be51d55bab9d872d3b0830846c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwOTo1MDo0NFrOGCnrrg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQwOTo1MDo0NFrOGCnrrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQwMDQ5NA==", "bodyText": "@rolfyone Hold on your PR as toml to yaml config changes are coming, the complete_config.toml will be moved, you might be required to update these changes in complete_config.yaml.", "url": "https://github.com/ConsenSys/teku/pull/1554#discussion_r405400494", "createdAt": "2020-04-08T09:50:44Z", "author": {"login": "usmansaleem"}, "path": "artemis/src/test/resources/complete_config.toml", "diffHunk": "@@ -29,6 +29,13 @@ eth1-endpoint=\"http://localhost:8545\"\n # output\n #Xtransaction-record-directory=\"/tmp/teku\"\n \n+# logging\n+log-color-enabled=true", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16bc210cf4b349be51d55bab9d872d3b0830846c"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2db08c1b3434854fa3385c22851c3ad7903cd9fa", "author": {"user": {"login": "usmansaleem", "name": "Usman Saleem"}}, "url": "https://github.com/ConsenSys/teku/commit/2db08c1b3434854fa3385c22851c3ad7903cd9fa", "committedDate": "2020-04-08T10:13:14Z", "message": "Merge remote-tracking branch 'remotes/upstream/master' into 1411_default_storage-path\n\nSigned-off-by: Usman Saleem <usman@usmans.info>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5ODgzMzA1", "url": "https://github.com/ConsenSys/teku/pull/1554#pullrequestreview-389883305", "createdAt": "2020-04-08T11:24:23Z", "commit": {"oid": "16bc210cf4b349be51d55bab9d872d3b0830846c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMToyNDoyM1rOGCqxsA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxMToyNDoyM1rOGCqxsA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTQ1MTE4NA==", "bodyText": "This should be the $XDG_DATA_HOME:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                return \"~/.teku\";\n          \n          \n            \n                return \"~/.local/share/teku\";\n          \n      \n    \n    \n  \n\n\n$XDG_DATA_HOME defines the base directory relative to which user specific data files should be stored. If $XDG_DATA_HOME is either not set or empty, a default equal to $HOME/.local/share should be used.\n\nhttps://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html\n\nHistorically, Unix programs were free to spread their data all over the $HOME directory, putting their data in dot-files (files starting with \".\") or subdirectories such as ~/.vimrc and ~/.vim. The new specification is intended to make this behavior more predictable.\n\nhttps://askubuntu.com/questions/14535/whats-the-local-folder-for-in-my-home-directory", "url": "https://github.com/ConsenSys/teku/pull/1554#discussion_r405451184", "createdAt": "2020-04-08T11:24:23Z", "author": {"login": "q9f"}, "path": "util/src/main/java/tech/pegasys/artemis/util/cli/VersionProvider.java", "diffHunk": "@@ -45,6 +45,16 @@ public static String detectJvm() {\n     return detectedVM + \"-java-\" + detectedJavaVersion;\n   }\n \n+  public static String defaultStoragePath() {\n+    final String detectedOS = normalizeOS(normalize(\"os.name\"));\n+    if (detectedOS.equals(\"windows\")) {\n+      return System.getenv(\"LOCALAPPDATA\") + \"/teku\";\n+    } else if (detectedOS.equals(\"osx\")) {\n+      return System.getenv(\"HOME\") + \"/Library/teku\";\n+    }\n+    return \"~/.teku\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16bc210cf4b349be51d55bab9d872d3b0830846c"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c375a1572dabdf2e3524576f81d1e89335fddcea", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/c375a1572dabdf2e3524576f81d1e89335fddcea", "committedDate": "2020-04-09T00:03:24Z", "message": "Merge pull request #1 from usmansaleem/1411_default_storage-path\n\nFix Merge conflicts from Teku master"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93831e8e7ff77e6cacb21c676bcea8b2dcc819dd", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/93831e8e7ff77e6cacb21c676bcea8b2dcc819dd", "committedDate": "2020-04-09T00:03:47Z", "message": "Merge remote-tracking branch 'upstream/master' into 1411-default-storage-path"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNDE3MTc5", "url": "https://github.com/ConsenSys/teku/pull/1554#pullrequestreview-390417179", "createdAt": "2020-04-09T00:25:17Z", "commit": {"oid": "93831e8e7ff77e6cacb21c676bcea8b2dcc819dd"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b88ea92227fa54a5bfae3d0f392e62d909c6b09c", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/b88ea92227fa54a5bfae3d0f392e62d909c6b09c", "committedDate": "2020-04-09T02:10:40Z", "message": "changes from review feedback\n\nalso restructured to allow testing.\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e26e19d08a4937eaf814a0d4f92d53b7c7b7d3ea", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/e26e19d08a4937eaf814a0d4f92d53b7c7b7d3ea", "committedDate": "2020-04-09T02:12:40Z", "message": "Merge remote-tracking branch 'upstream/master' into 1411-default-storage-path"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwNDUxNTUw", "url": "https://github.com/ConsenSys/teku/pull/1554#pullrequestreview-390451550", "createdAt": "2020-04-09T02:26:06Z", "commit": {"oid": "e26e19d08a4937eaf814a0d4f92d53b7c7b7d3ea"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwMjoyNjowNlrOGDHbTQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOVQwMjoyNjowNlrOGDHbTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTkyMDU4OQ==", "bodyText": "nit: our standard is US spelling ie ize", "url": "https://github.com/ConsenSys/teku/pull/1554#discussion_r405920589", "createdAt": "2020-04-09T02:26:06Z", "author": {"login": "macfarla"}, "path": "util/src/test/java/tech/pegasys/artemis/util/cli/VersionProviderTest.java", "diffHunk": "@@ -0,0 +1,67 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.artemis.util.cli;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static tech.pegasys.artemis.util.cli.VersionProvider.ENV_HOME;\n+import static tech.pegasys.artemis.util.cli.VersionProvider.ENV_LOCALAPPDATA;\n+import static tech.pegasys.artemis.util.cli.VersionProvider.ENV_XDG_DATA_HOME;\n+\n+import java.util.Map;\n+import org.apache.logging.log4j.util.Strings;\n+import org.junit.jupiter.api.Test;\n+\n+class VersionProviderTest {\n+  private final String TEKU = \"/teku\";\n+\n+  @Test\n+  void defaultStoragePath_shouldHandleWindowsPath() {\n+    final String homeFolder = \"c:\\\\users\\\\myUser\\\\AppData\\\\local\";\n+    final Map<String, String> env = Map.of(ENV_LOCALAPPDATA, homeFolder);\n+    assertThat(VersionProvider.defaultStoragePathForNormalisedOS(\"windows\", env))\n+        .isEqualTo(homeFolder + \"\\\\teku\");\n+  }\n+\n+  @Test\n+  void defaultStoragePath_shouldHandleMacPath() {\n+    final String homeFolder = \"/Users/myUser\";\n+    Map<String, String> env = Map.of(ENV_HOME, homeFolder);\n+    assertThat(VersionProvider.defaultStoragePathForNormalisedOS(\"osx\", env))\n+        .isEqualTo(homeFolder + \"/Library\" + TEKU);\n+  }\n+\n+  @Test\n+  void defaultStoragePath_shouldHandleXdgHome() {\n+    final String homeFolder = \"/data/myUser\";\n+    Map<String, String> env = Map.of(ENV_XDG_DATA_HOME, homeFolder);\n+    assertThat(VersionProvider.defaultStoragePathForNormalisedOS(\"linux\", env))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e26e19d08a4937eaf814a0d4f92d53b7c7b7d3ea"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cefd923138745cae35660d68d23132b2c479d091", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/cefd923138745cae35660d68d23132b2c479d091", "committedDate": "2020-04-09T02:29:14Z", "message": "changes from review feedback\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4249, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}