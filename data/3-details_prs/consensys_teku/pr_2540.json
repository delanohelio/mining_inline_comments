{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MjE0OTc4", "number": 2540, "title": "Switch from UnsignedLong to UInt64", "bodyText": "PR Description\nThis is an almost entirely mechanical rename from UnsignedLong to UInt64.  In a couple of places UInt64 max and min get used instead of the previously external static functions.\nFixed Issue(s)\nfixes #2297\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.", "createdAt": "2020-08-09T23:08:49Z", "url": "https://github.com/ConsenSys/teku/pull/2540", "merged": true, "mergeCommit": {"oid": "8b2d8fa7e6021de2fa360e391304d7b4258c9510"}, "closed": true, "closedAt": "2020-08-10T01:40:23Z", "author": {"login": "ajsutton"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9VwL3AH2gAyNDY1MjE0OTc4OmQ0N2QyZTM3ZWY5ZDc5ZjAyY2JjNGFlZDM1YmQ1ODc5ZDdjZjgwZTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc9Wr5JgH2gAyNDY1MjE0OTc4OmVkZDZjNGJiMGI3YTQwNWRkZmFkMzMwNmVjMWM1NmQ0OTQ3MTZkMDE=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "d47d2e37ef9d79f02cbc4aed35bd5879d7cf80e4", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/d47d2e37ef9d79f02cbc4aed35bd5879d7cf80e4", "committedDate": "2020-08-09T22:56:06Z", "message": "Add unsigned dependency by default."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0553dc71ad637b33e01d08b2c30906425b79c4cd", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/0553dc71ad637b33e01d08b2c30906425b79c4cd", "committedDate": "2020-08-09T23:00:08Z", "message": "Switch UnsignedLong to UInt64."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "44f183f2dd697cfb10eec3e6457c238e4e1c6630", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/44f183f2dd697cfb10eec3e6457c238e4e1c6630", "committedDate": "2020-08-09T23:00:12Z", "message": "Use built-in min and max instead of static utilities."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c58bfa273ba1a1c2e311633422789501dedd88f8", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/c58bfa273ba1a1c2e311633422789501dedd88f8", "committedDate": "2020-08-09T23:07:42Z", "message": "One more rename."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "589d79dd2b2d3a71e598bc7f4cf07ca9f97241bc", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/589d79dd2b2d3a71e598bc7f4cf07ca9f97241bc", "committedDate": "2020-08-09T23:38:52Z", "message": "Use lowercase uint64 consistently in OpenAPI docs.\nAdd UInt64.SIZE instead of having separate constants to define it."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d3b236b4e78750bc8e4bfdb143f7a6fc3c71a4d", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/0d3b236b4e78750bc8e4bfdb143f7a6fc3c71a4d", "committedDate": "2020-08-09T23:44:15Z", "message": "Rename a few unsigned_long to uint64."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTExMTEx", "url": "https://github.com/ConsenSys/teku/pull/2540#pullrequestreview-463911111", "createdAt": "2020-08-09T23:11:30Z", "commit": {"oid": "c58bfa273ba1a1c2e311633422789501dedd88f8"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQyMzoxMTozMFrOG9-fog==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQyMzoxOTowNlrOG9-irg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY0MDIyNg==", "bodyText": "We make UInt64 available everywhere by default.  Have to exclude the unsigned module itself and errorprone-checks from that to avoid recursive dependency loops.", "url": "https://github.com/ConsenSys/teku/pull/2540#discussion_r467640226", "createdAt": "2020-08-09T23:11:30Z", "author": {"login": "ajsutton"}, "path": "build.gradle", "diffHunk": "@@ -532,6 +532,10 @@ subprojects {\n     testFixturesImplementation 'org.assertj:assertj-core'\n   }\n \n+  if (project.name != 'unsigned' && project.name != 'errorprone-checks') {\n+    dependencies.implementation(project(':infrastructure:unsigned'))\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58bfa273ba1a1c2e311633422789501dedd88f8"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY0MDM2Ng==", "bodyText": "@rolfyone Do we want this to still say UnsignedLong?  I've changed all the places that openapi referred to UnsignedLong to uint64 so its consistent with the @Schema annotations we have.", "url": "https://github.com/ConsenSys/teku/pull/2540#discussion_r467640366", "createdAt": "2020-08-09T23:12:57Z", "author": {"login": "ajsutton"}, "path": "data/beaconrestapi/src/main/java/tech/pegasys/teku/beaconrestapi/RestApiConstants.java", "diffHunk": "@@ -48,9 +48,9 @@\n       \"No content may be returned if the genesis block has not been set, meaning that there is no head to query.\";\n   public static final String INVALID_BODY_SUPPLIED = \"Invalid body supplied.\";\n \n-  public static final String EPOCH_QUERY_DESCRIPTION = \"`UnsignedLong` Epoch number to query.\";\n+  public static final String EPOCH_QUERY_DESCRIPTION = \"`UInt64` Epoch number to query.\";\n   public static final String SLOT_QUERY_DESCRIPTION =\n-      \"`UnsignedLong` Slot to query in the canonical chain.\";\n+      \"`UInt64` Slot to query in the canonical chain.\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58bfa273ba1a1c2e311633422789501dedd88f8"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY0MTAwNg==", "bodyText": "We should review this to make sure it can never overflow. But that's not for this PR.", "url": "https://github.com/ConsenSys/teku/pull/2540#discussion_r467641006", "createdAt": "2020-08-09T23:19:06Z", "author": {"login": "ajsutton"}, "path": "ethereum/core/src/main/java/tech/pegasys/teku/core/epoch/EpochProcessorUtil.java", "diffHunk": "@@ -318,28 +314,26 @@ public static void process_registry_updates(MutableBeaconState state)\n    *     <a>https://github.com/ethereum/eth2.0-specs/blob/v0.8.0/specs/core/0_beacon-chain.md#slashings</a>\n    */\n   public static void process_slashings(MutableBeaconState state) {\n-    UnsignedLong epoch = get_current_epoch(state);\n-    UnsignedLong total_balance = get_total_active_balance(state);\n+    UInt64 epoch = get_current_epoch(state);\n+    UInt64 total_balance = get_total_active_balance(state);\n \n     SSZList<Validator> validators = state.getValidators();\n     for (int index = 0; index < validators.size(); index++) {\n       Validator validator = validators.get(index);\n       if (validator.isSlashed()\n           && epoch\n-              .plus(UnsignedLong.valueOf(EPOCHS_PER_SLASHINGS_VECTOR / 2))\n+              .plus(UInt64.valueOf(EPOCHS_PER_SLASHINGS_VECTOR / 2))\n               .equals(validator.getWithdrawable_epoch())) {\n-        UnsignedLong increment = EFFECTIVE_BALANCE_INCREMENT;\n-        UnsignedLong penalty_numerator =\n+        UInt64 increment = EFFECTIVE_BALANCE_INCREMENT;\n+        UInt64 penalty_numerator =\n             validator\n                 .getEffective_balance()\n                 .dividedBy(increment)\n                 .times(\n-                    min(\n-                        UnsignedLong.valueOf(\n-                            state.getSlashings().stream().mapToLong(UnsignedLong::longValue).sum()\n-                                * 3),\n-                        total_balance));\n-        UnsignedLong penalty = penalty_numerator.dividedBy(total_balance).times(increment);\n+                    UInt64.valueOf(\n+                            state.getSlashings().stream().mapToLong(UInt64::longValue).sum() * 3)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c58bfa273ba1a1c2e311633422789501dedd88f8"}, "originalPosition": 165}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c2bf7a577eafa717a64e6f99cf7bb3f0508f4d61", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/c2bf7a577eafa717a64e6f99cf7bb3f0508f4d61", "committedDate": "2020-08-09T23:51:17Z", "message": "Ahem, UInt64 is 64 bits which is only 8 bytes...."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzOTE1NjYx", "url": "https://github.com/ConsenSys/teku/pull/2540#pullrequestreview-463915661", "createdAt": "2020-08-09T23:56:35Z", "commit": {"oid": "c2bf7a577eafa717a64e6f99cf7bb3f0508f4d61"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "edd6c4bb0b7a405ddfad3306ec1c56d494716d01", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/edd6c4bb0b7a405ddfad3306ec1c56d494716d01", "committedDate": "2020-08-10T00:01:19Z", "message": "Reapply fix for GetValidatorsTest that was lost in the merge."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3601, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}