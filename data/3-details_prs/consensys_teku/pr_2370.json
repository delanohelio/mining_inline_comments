{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDUwNzM0MDg5", "number": 2370, "title": "Extract a separate async module", "bodyText": "PR Description\nExtract the async package (SafeFuture, AsyncRunner and related classes) out of the util module into a new infrastrucutre:async module.  Mostly just tidies things up instead of having util be a giant catch all module.\nI had a better reason for starting this work but forgot it by the time I got to the end...\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.", "createdAt": "2020-07-17T03:43:09Z", "url": "https://github.com/ConsenSys/teku/pull/2370", "merged": true, "mergeCommit": {"oid": "6f8ec886cee6f68b6464d124ffe842ea62003e86"}, "closed": true, "closedAt": "2020-07-17T22:41:16Z", "author": {"login": "ajsutton"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc1rbAWgH2gAyNDUwNzM0MDg5OjUyMWMyYjRhZTUyZTBlOGRhOWJiNGU1OGI0M2E5MjAwZjcwMjJjYWM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc17l4xgH2gAyNDUwNzM0MDg5OjE5OGMxOTRiN2ExZDRjZTYzOWUwMGQ3NDk2MGI3NzRlMzA1NDU5ZGQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "521c2b4ae52e0e8da9bb4e58b43a9200f7022cac", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/521c2b4ae52e0e8da9bb4e58b43a9200f7022cac", "committedDate": "2020-07-17T03:39:29Z", "message": "Extract a separate async module, separate to utils."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwMzU0MTUy", "url": "https://github.com/ConsenSys/teku/pull/2370#pullrequestreview-450354152", "createdAt": "2020-07-17T03:45:18Z", "commit": {"oid": "521c2b4ae52e0e8da9bb4e58b43a9200f7022cac"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMzo0NToxOFrOGzEXDQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QwMzo0NToxOFrOGzEXDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIwMTk5Nw==", "bodyText": "Somehow these didn't make it into #2362.  Should be the only actual code changes in here (the rest being build files and imports changing).", "url": "https://github.com/ConsenSys/teku/pull/2370#discussion_r456201997", "createdAt": "2020-07-17T03:45:18Z", "author": {"login": "ajsutton"}, "path": "infrastructure/async/src/test/java/tech/pegasys/teku/infrastructure/async/SafeFutureTest.java", "diffHunk": "@@ -441,6 +441,33 @@ public void propagateTo_propagatesExceptionalResult() {\n     assertThatSafeFuture(target).isCompletedExceptionallyWith(exception);\n   }\n \n+  @Test\n+  public void propagateToAsync_propagatesSuccessfulResult() {\n+    final StubAsyncRunner asyncRunner = new StubAsyncRunner();\n+    final SafeFuture<String> target = new SafeFuture<>();\n+    final SafeFuture<String> source = new SafeFuture<>();\n+    source.propagateToAsync(target, asyncRunner);\n+    source.complete(\"Yay\");\n+    assertThat(target).isNotDone();\n+\n+    asyncRunner.executeQueuedActions();\n+    assertThat(target).isCompletedWithValue(\"Yay\");\n+  }\n+\n+  @Test\n+  public void propagateToAsync_propagatesExceptionalResult() {\n+    final StubAsyncRunner asyncRunner = new StubAsyncRunner();\n+    final SafeFuture<String> target = new SafeFuture<>();\n+    final SafeFuture<String> source = new SafeFuture<>();\n+    source.propagateToAsync(target, asyncRunner);\n+    final RuntimeException exception = new RuntimeException(\"Oh no!\");\n+    source.completeExceptionally(exception);\n+    assertThat(target).isNotDone();\n+\n+    asyncRunner.executeQueuedActions();\n+    assertThatSafeFuture(target).isCompletedExceptionallyWith(exception);\n+  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "521c2b4ae52e0e8da9bb4e58b43a9200f7022cac"}, "originalPosition": 52}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb0ec2593237ec2ac0325d7815b755142e870274", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/eb0ec2593237ec2ac0325d7815b755142e870274", "committedDate": "2020-07-17T03:46:32Z", "message": "Fix license for new module."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDUwNzk2MDY4", "url": "https://github.com/ConsenSys/teku/pull/2370#pullrequestreview-450796068", "createdAt": "2020-07-17T16:28:07Z", "commit": {"oid": "eb0ec2593237ec2ac0325d7815b755142e870274"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7768dce5816f5f91a8beb696c9a53e1c1f63d0c5", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/7768dce5816f5f91a8beb696c9a53e1c1f63d0c5", "committedDate": "2020-07-17T21:23:45Z", "message": "Merge branch 'master' into extract-async-module"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "198c194b7a1d4ce639e00d74960b774e305459dd", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/198c194b7a1d4ce639e00d74960b774e305459dd", "committedDate": "2020-07-17T22:29:51Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into extract-async-module"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3637, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}