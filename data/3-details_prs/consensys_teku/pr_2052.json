{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDI3NTQxMDY3", "number": 2052, "title": "Fix off by one error when validating required deposits are available", "bodyText": "PR Description\nBeaconState.eth1_deposit_index is the number of of deposits included (so effectively a 1 based index) but our deposit index is 0 based.  So when there was a deposit tracked by DepositProvider and all deposits had been included in the chain, it incorrectly threw a MissingDepositsException.  If there were no known deposits, it would work correctly.\nFixed Issue(s)\nfixes #2047", "createdAt": "2020-06-04T01:50:58Z", "url": "https://github.com/ConsenSys/teku/pull/2052", "merged": true, "mergeCommit": {"oid": "684ff804c6f94cae7d62a9f328efc312709b97dc"}, "closed": true, "closedAt": "2020-06-04T20:47:22Z", "author": {"login": "ajsutton"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcn0DszAH2gAyNDI3NTQxMDY3OjgzMmZlNjFkNjk4YjExYjMyNGI2NTM2MmJmYmZkN2IwNzIzZWM2Njg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcoEE9AgH2gAyNDI3NTQxMDY3OjRjNDg1ZWNjMTVhZTNjZmJmMTNkZWE4NjQ5NWVkNzU2OWRlMTM3MTM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "832fe61d698b11b324b65362bfbfd7b0723ec668", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/832fe61d698b11b324b65362bfbfd7b0723ec668", "committedDate": "2020-06-04T01:48:14Z", "message": "Fix off by one error and try to explain why Deposit.index is 0 based but BeaconState.eth1_deposit_index is one based."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d42353710e921f06745fe7319c6a377c1d745b44", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/d42353710e921f06745fe7319c6a377c1d745b44", "committedDate": "2020-06-04T01:51:06Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into fix-off-by-one-error"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDI0NTQxMTY1", "url": "https://github.com/ConsenSys/teku/pull/2052#pullrequestreview-424541165", "createdAt": "2020-06-04T15:00:37Z", "commit": {"oid": "d42353710e921f06745fe7319c6a377c1d745b44"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTowMDozN1rOGfKQwA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wNFQxNTowMDozN1rOGfKQwA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTMyNzE2OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  final UnsignedLong eth1DepositCount, final UnsignedLong fromDepositIndex) {\n          \n          \n            \n                  final UnsignedLong eth1DepositCount, final UnsignedLong eth1DepositIndex) {", "url": "https://github.com/ConsenSys/teku/pull/2052#discussion_r435327168", "createdAt": "2020-06-04T15:00:37Z", "author": {"login": "mbaxter"}, "path": "validator/coordinator/src/main/java/tech/pegasys/teku/validator/coordinator/DepositProvider.java", "diffHunk": "@@ -124,6 +121,18 @@ public void onMinGenesisTimeBlock(MinGenesisTimeBlockEvent event) {}\n         Deposit.class);\n   }\n \n+  private void checkRequiredDepositsAvailable(\n+      final UnsignedLong eth1DepositCount, final UnsignedLong fromDepositIndex) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d42353710e921f06745fe7319c6a377c1d745b44"}, "originalPosition": 26}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1ad5bada5768297391d96705ba33d864fe2ce77c", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/1ad5bada5768297391d96705ba33d864fe2ce77c", "committedDate": "2020-06-04T20:19:48Z", "message": "Rename variables."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2d6a2b5b9163f811547213f8cb8b9a40715039f", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/f2d6a2b5b9163f811547213f8cb8b9a40715039f", "committedDate": "2020-06-04T20:20:01Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into fix-off-by-one-error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c485ecc15ae3cfbf13dea86495ed7569de13713", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/4c485ecc15ae3cfbf13dea86495ed7569de13713", "committedDate": "2020-06-04T20:28:05Z", "message": "Update new test."}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4095, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}