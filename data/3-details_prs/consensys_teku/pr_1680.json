{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA5NjcwNDUy", "number": 1680, "title": "[BC-371] Set up Gossip options and a bit more", "bodyText": "PR Description\n\nMake NetworkConfig optional parameters modifiable and add default values for them (to avoid extra boilerplate code)\nAdd Gossip parameters according to spec (https://github.com/ethereum/eth2.0-specs/blob/v0.11.1/specs/phase0/p2p-interface.md#the-gossip-domain-gossipsub)\nMake wire logging options configurable\n\nQuestions\n\ndo we need to expose Gossip options to config/CLI ?\n\nFixed Issue(s)\nJira BC-371", "createdAt": "2020-04-27T18:30:10Z", "url": "https://github.com/ConsenSys/teku/pull/1680", "merged": true, "mergeCommit": {"oid": "1b602d356ccebd65f2bad31e083b7cc20b3a3b65"}, "closed": true, "closedAt": "2020-04-28T21:14:04Z", "author": {"login": "Nashatyrev"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcbzbgBAH2gAyNDA5NjcwNDUyOjgwODVkNzdmMDYxNmMyNDBkYzQ2Yjk5Zjk5YjE1MmQxOWE1MmE0MTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABccKEXjgH2gAyNDA5NjcwNDUyOjAwNGQxZjAyZTgxNzY4MjYzNGI5MmRjZjIwODhiZTY1MzY1Y2M3MWI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "8085d77f0616c240dc46b99f99b152d19a52a416", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/8085d77f0616c240dc46b99f99b152d19a52a416", "committedDate": "2020-04-27T18:17:14Z", "message": "Add Gossip options to the NetworkConfig"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "967fa4c6d1d09bb4e0fbee97378ce92b95fc1caf", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/967fa4c6d1d09bb4e0fbee97378ce92b95fc1caf", "committedDate": "2020-04-27T18:17:58Z", "message": "Make wire logging options configurable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMzg5MDI3", "url": "https://github.com/ConsenSys/teku/pull/1680#pullrequestreview-401389027", "createdAt": "2020-04-27T23:07:58Z", "commit": {"oid": "967fa4c6d1d09bb4e0fbee97378ce92b95fc1caf"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QyMzowNzo1OVrOGM7akQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yN1QyMzoyNTowM1rOGM71nQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjIwOTU1Mw==", "bodyText": "Can we make this X prefixed options with the hidden flag set?  They're useful to have for debugging but likely to be overly confusing for users and are quite implementation dependent so may change in the future.  The flags in InteropOptions are examples of this approach.  They don't show up in the normal help output (we need to make them show up if you run teku -X at some point).\nAlso, sorry I just created a lot of conflicts for you on this..", "url": "https://github.com/ConsenSys/teku/pull/1680#discussion_r416209553", "createdAt": "2020-04-27T23:07:59Z", "author": {"login": "ajsutton"}, "path": "artemis/src/main/java/tech/pegasys/artemis/cli/options/LoggingOptions.java", "diffHunk": "@@ -28,6 +28,10 @@\n   public static final String LOG_DESTINATION_OPTION_NAME = \"--log-destination\";\n   public static final String LOG_FILE_OPTION_NAME = \"--log-file\";\n   public static final String LOG_FILE_NAME_PATTERN_OPTION_NAME = \"--log-file-name-pattern\";\n+  public static final String LOG_WIRE_CIPHER_ENABLED_OPTION_NAME = \"--log-wire-cipher-enabled\";\n+  public static final String LOG_WIRE_PLAIN_ENABLED_OPTION_NAME = \"--log-wire-plain-enabled\";\n+  public static final String LOG_WIRE_MUX_ENABLED_OPTION_NAME = \"--log-wire-mux-enabled\";\n+  public static final String LOG_WIRE_GOSSIP_ENABLED_OPTION_NAME = \"--log-wire-gossip-enabled\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967fa4c6d1d09bb4e0fbee97378ce92b95fc1caf"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjIxNTU1OQ==", "bodyText": "Given these come from the spec I'd be tempted to just make them constants.  Unless there's some value in making them configurable?\nI kind of like having them still come from the NetworkConfig object though.", "url": "https://github.com/ConsenSys/teku/pull/1680#discussion_r416215559", "createdAt": "2020-04-27T23:22:47Z", "author": {"login": "ajsutton"}, "path": "networking/p2p/src/main/java/tech/pegasys/artemis/networking/p2p/network/NetworkConfig.java", "diffHunk": "@@ -31,9 +32,22 @@\n   private final boolean isDiscoveryEnabled;\n   private final List<String> bootnodes;\n   private final TargetPeerRange targetPeerRange;\n-  private final boolean logWireCipher;\n-  private final boolean logWirePlain;\n-  private final boolean logMuxFrames;\n+\n+  // Gossip options\n+  // https://github.com/ethereum/eth2.0-specs/blob/v0.11.1/specs/phase0/p2p-interface.md#the-gossip-domain-gossipsub\n+  private int gossipD = 6;\n+  private int gossipDLow = 4;\n+  private int gossipDHigh = 12;\n+  private int gossipDLazy = 6;\n+  private Duration gossipFanoutTTL = Duration.ofSeconds(60);\n+  private int gossipAdvertise = 3;\n+  private int gossipHistory = 5;\n+  private Duration gossipHeartbeatInterval = Duration.ofSeconds(1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967fa4c6d1d09bb4e0fbee97378ce92b95fc1caf"}, "originalPosition": 25}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjIxNjQ3Nw==", "bodyText": "We've been trying to move more towards objects being immutable so would be good to just inject anything configurable into the constructor rather than having setters.", "url": "https://github.com/ConsenSys/teku/pull/1680#discussion_r416216477", "createdAt": "2020-04-27T23:25:03Z", "author": {"login": "ajsutton"}, "path": "networking/p2p/src/main/java/tech/pegasys/artemis/networking/p2p/network/NetworkConfig.java", "diffHunk": "@@ -114,7 +155,71 @@ public boolean isLogWirePlain() {\n     return logWirePlain;\n   }\n \n-  public boolean isLogMuxFrames() {\n-    return logMuxFrames;\n+  public boolean isLogWireMuxFrames() {\n+    return logWireMuxFrames;\n+  }\n+\n+  public boolean isLogWireGossip() {\n+    return logWireGossip;\n+  }\n+\n+  public NetworkConfig setGossipD(int gossipD) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "967fa4c6d1d09bb4e0fbee97378ce92b95fc1caf"}, "originalPosition": 110}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "951c81a55c213b32111d8464016358bef20cb144", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/951c81a55c213b32111d8464016358bef20cb144", "committedDate": "2020-04-28T09:41:25Z", "message": "Inline option names and default values. Make wire log options hidden"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cfb16a9657aa4980e8b7b38dc751a552b96e443e", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/cfb16a9657aa4980e8b7b38dc751a552b96e443e", "committedDate": "2020-04-28T09:41:34Z", "message": "Merge remote-tracking branch 'pegasys/master' into feature-gossip-options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2c92947a4d47982e6e3ce9fe828b1ee6554cf9f", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/f2c92947a4d47982e6e3ce9fe828b1ee6554cf9f", "committedDate": "2020-04-28T10:39:31Z", "message": "Move Gossip and WireLogs configs to a separate classes with default instances. Make all the classes back immutable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8d7da373f833e5f9911c72146289bfa883e16b89", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/8d7da373f833e5f9911c72146289bfa883e16b89", "committedDate": "2020-04-28T10:42:57Z", "message": "Revert accidentally committed change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "92b7f060cd57fc86dd3ad6833eb31e2f2695c465", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/92b7f060cd57fc86dd3ad6833eb31e2f2695c465", "committedDate": "2020-04-28T11:10:04Z", "message": "Fix the unit test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAyMTU1Njcx", "url": "https://github.com/ConsenSys/teku/pull/1680#pullrequestreview-402155671", "createdAt": "2020-04-28T19:43:21Z", "commit": {"oid": "92b7f060cd57fc86dd3ad6833eb31e2f2695c465"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "004d1f02e817682634b92dcf2088be65365cc71b", "author": {"user": {"login": "Nashatyrev", "name": "Anton Nashatyrev"}}, "url": "https://github.com/ConsenSys/teku/commit/004d1f02e817682634b92dcf2088be65365cc71b", "committedDate": "2020-04-28T20:39:47Z", "message": "Merge branch 'master' into feature-gossip-options"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4131, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}