{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5MDI5ODAx", "number": 1379, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMDo1NzoyMVrODojIPg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMToxNTowMVrODojS2A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzODQ1MTgyOnYy", "diffSide": "RIGHT", "path": "logging/src/main/java/tech/pegasys/teku/logging/LoggingConfigurator.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMDo1NzoyMVrOF3KkiQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMzoyNjowNlrOF3MxRw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4OTE5Mw==", "bodyText": "At minimum COLOR would be accessed from multiple threads so needs to be either volatile or an AtomicBoolean. I suspect they all need to be thread safe since Log4J could be reconfigured from any thread which would lead these to be accessed.\nMight be best to just make the public methods all synchronized.", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393389193", "createdAt": "2020-03-17T00:57:21Z", "author": {"login": "ajsutton"}, "path": "logging/src/main/java/tech/pegasys/teku/logging/LoggingConfigurator.java", "diffHunk": "@@ -0,0 +1,182 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.logging;\n+\n+import org.apache.logging.log4j.Level;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.core.Appender;\n+import org.apache.logging.log4j.core.Layout;\n+import org.apache.logging.log4j.core.LoggerContext;\n+import org.apache.logging.log4j.core.appender.ConsoleAppender;\n+import org.apache.logging.log4j.core.appender.RollingFileAppender;\n+import org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.OnStartupTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy;\n+import org.apache.logging.log4j.core.config.AbstractConfiguration;\n+import org.apache.logging.log4j.core.config.Configurator;\n+import org.apache.logging.log4j.core.config.LoggerConfig;\n+import org.apache.logging.log4j.core.layout.PatternLayout;\n+import org.apache.logging.log4j.status.StatusLogger;\n+\n+public class LoggingConfigurator {\n+\n+  static final String EVENT_LOGGER_NAME = \"teku-event-log\";\n+  static final String STATUS_LOGGER_NAME = \"teku-status-log\";\n+\n+  private static final String CONSOLE_APPENDER_NAME = \"teku-console-appender\";\n+  private static final String CONSOLE_FORMAT = \"%d{HH:mm:ss.SSS} [%-5level] - %msg%n\";\n+  private static final String FILE_APPENDER_NAME = \"teku-log-appender\";\n+  private static final String FILE_MESSAGE_FORMAT =\n+      \"%d{yyyy-MM-dd HH:mm:ss.SSSZZZ} | %t | %-5level | %c{1} | %msg%n\";\n+\n+  private static LoggingDestination DESTINATION;\n+  private static boolean COLOR;\n+  private static boolean INCLUDE_EVENTS;\n+  private static String FILE;\n+  private static String FILE_PATTERN;\n+  private static Level LOG_LEVEL = Level.INFO;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQxNTUwMQ==", "bodyText": "Yes, you are correct.\nThese were all volatile a while ago ...but I neglected to bring that keyword across from the discard branch \ud83d\ude44\nSynchronizing the methods is an interesting idea \ud83e\udd14", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393415501", "createdAt": "2020-03-17T02:47:55Z", "author": {"login": "CjHare"}, "path": "logging/src/main/java/tech/pegasys/teku/logging/LoggingConfigurator.java", "diffHunk": "@@ -0,0 +1,182 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.logging;\n+\n+import org.apache.logging.log4j.Level;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.core.Appender;\n+import org.apache.logging.log4j.core.Layout;\n+import org.apache.logging.log4j.core.LoggerContext;\n+import org.apache.logging.log4j.core.appender.ConsoleAppender;\n+import org.apache.logging.log4j.core.appender.RollingFileAppender;\n+import org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.OnStartupTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy;\n+import org.apache.logging.log4j.core.config.AbstractConfiguration;\n+import org.apache.logging.log4j.core.config.Configurator;\n+import org.apache.logging.log4j.core.config.LoggerConfig;\n+import org.apache.logging.log4j.core.layout.PatternLayout;\n+import org.apache.logging.log4j.status.StatusLogger;\n+\n+public class LoggingConfigurator {\n+\n+  static final String EVENT_LOGGER_NAME = \"teku-event-log\";\n+  static final String STATUS_LOGGER_NAME = \"teku-status-log\";\n+\n+  private static final String CONSOLE_APPENDER_NAME = \"teku-console-appender\";\n+  private static final String CONSOLE_FORMAT = \"%d{HH:mm:ss.SSS} [%-5level] - %msg%n\";\n+  private static final String FILE_APPENDER_NAME = \"teku-log-appender\";\n+  private static final String FILE_MESSAGE_FORMAT =\n+      \"%d{yyyy-MM-dd HH:mm:ss.SSSZZZ} | %t | %-5level | %c{1} | %msg%n\";\n+\n+  private static LoggingDestination DESTINATION;\n+  private static boolean COLOR;\n+  private static boolean INCLUDE_EVENTS;\n+  private static String FILE;\n+  private static String FILE_PATTERN;\n+  private static Level LOG_LEVEL = Level.INFO;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4OTE5Mw=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQyMjY0MQ==", "bodyText": "Okay, I went with both.\nCOLOR being exposed as a simple getter is an AtomicBoolean with a non-synchronized getter and the other public methods are now all synchronized.\nThis should avoid any locking/performance problems with the getter (which is used in the two new logger classes) which will be more frequently under normal usage then the set/update.", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393422641", "createdAt": "2020-03-17T03:14:59Z", "author": {"login": "CjHare"}, "path": "logging/src/main/java/tech/pegasys/teku/logging/LoggingConfigurator.java", "diffHunk": "@@ -0,0 +1,182 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.logging;\n+\n+import org.apache.logging.log4j.Level;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.core.Appender;\n+import org.apache.logging.log4j.core.Layout;\n+import org.apache.logging.log4j.core.LoggerContext;\n+import org.apache.logging.log4j.core.appender.ConsoleAppender;\n+import org.apache.logging.log4j.core.appender.RollingFileAppender;\n+import org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.OnStartupTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy;\n+import org.apache.logging.log4j.core.config.AbstractConfiguration;\n+import org.apache.logging.log4j.core.config.Configurator;\n+import org.apache.logging.log4j.core.config.LoggerConfig;\n+import org.apache.logging.log4j.core.layout.PatternLayout;\n+import org.apache.logging.log4j.status.StatusLogger;\n+\n+public class LoggingConfigurator {\n+\n+  static final String EVENT_LOGGER_NAME = \"teku-event-log\";\n+  static final String STATUS_LOGGER_NAME = \"teku-status-log\";\n+\n+  private static final String CONSOLE_APPENDER_NAME = \"teku-console-appender\";\n+  private static final String CONSOLE_FORMAT = \"%d{HH:mm:ss.SSS} [%-5level] - %msg%n\";\n+  private static final String FILE_APPENDER_NAME = \"teku-log-appender\";\n+  private static final String FILE_MESSAGE_FORMAT =\n+      \"%d{yyyy-MM-dd HH:mm:ss.SSSZZZ} | %t | %-5level | %c{1} | %msg%n\";\n+\n+  private static LoggingDestination DESTINATION;\n+  private static boolean COLOR;\n+  private static boolean INCLUDE_EVENTS;\n+  private static String FILE;\n+  private static String FILE_PATTERN;\n+  private static Level LOG_LEVEL = Level.INFO;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4OTE5Mw=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQyNTIyMw==", "bodyText": "Suspect they need to be synchronized actually, otherwise you risk applying a half-updated config.", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393425223", "createdAt": "2020-03-17T03:26:06Z", "author": {"login": "ajsutton"}, "path": "logging/src/main/java/tech/pegasys/teku/logging/LoggingConfigurator.java", "diffHunk": "@@ -0,0 +1,182 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.logging;\n+\n+import org.apache.logging.log4j.Level;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.core.Appender;\n+import org.apache.logging.log4j.core.Layout;\n+import org.apache.logging.log4j.core.LoggerContext;\n+import org.apache.logging.log4j.core.appender.ConsoleAppender;\n+import org.apache.logging.log4j.core.appender.RollingFileAppender;\n+import org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.OnStartupTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy;\n+import org.apache.logging.log4j.core.config.AbstractConfiguration;\n+import org.apache.logging.log4j.core.config.Configurator;\n+import org.apache.logging.log4j.core.config.LoggerConfig;\n+import org.apache.logging.log4j.core.layout.PatternLayout;\n+import org.apache.logging.log4j.status.StatusLogger;\n+\n+public class LoggingConfigurator {\n+\n+  static final String EVENT_LOGGER_NAME = \"teku-event-log\";\n+  static final String STATUS_LOGGER_NAME = \"teku-status-log\";\n+\n+  private static final String CONSOLE_APPENDER_NAME = \"teku-console-appender\";\n+  private static final String CONSOLE_FORMAT = \"%d{HH:mm:ss.SSS} [%-5level] - %msg%n\";\n+  private static final String FILE_APPENDER_NAME = \"teku-log-appender\";\n+  private static final String FILE_MESSAGE_FORMAT =\n+      \"%d{yyyy-MM-dd HH:mm:ss.SSSZZZ} | %t | %-5level | %c{1} | %msg%n\";\n+\n+  private static LoggingDestination DESTINATION;\n+  private static boolean COLOR;\n+  private static boolean INCLUDE_EVENTS;\n+  private static String FILE;\n+  private static String FILE_PATTERN;\n+  private static Level LOG_LEVEL = Level.INFO;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4OTE5Mw=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzODQ1MzAwOnYy", "diffSide": "RIGHT", "path": "logging/src/main/java/tech/pegasys/teku/logging/LoggingConfigurator.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMDo1ODowNlrOF3KlNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMDo1ODowNlrOF3KlNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM4OTM2Nw==", "bodyText": "Not sure Programmatic logging setup is meaningful to a user.\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                StatusLogger.getLogger().info(\"Programmatic logging setup: {}\", DESTINATION);\n          \n          \n            \n                StatusLogger.getLogger().info(\"Configuring logging for destination: {}\", DESTINATION);", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393389367", "createdAt": "2020-03-17T00:58:06Z", "author": {"login": "ajsutton"}, "path": "logging/src/main/java/tech/pegasys/teku/logging/LoggingConfigurator.java", "diffHunk": "@@ -0,0 +1,182 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.logging;\n+\n+import org.apache.logging.log4j.Level;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.core.Appender;\n+import org.apache.logging.log4j.core.Layout;\n+import org.apache.logging.log4j.core.LoggerContext;\n+import org.apache.logging.log4j.core.appender.ConsoleAppender;\n+import org.apache.logging.log4j.core.appender.RollingFileAppender;\n+import org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.OnStartupTriggeringPolicy;\n+import org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy;\n+import org.apache.logging.log4j.core.config.AbstractConfiguration;\n+import org.apache.logging.log4j.core.config.Configurator;\n+import org.apache.logging.log4j.core.config.LoggerConfig;\n+import org.apache.logging.log4j.core.layout.PatternLayout;\n+import org.apache.logging.log4j.status.StatusLogger;\n+\n+public class LoggingConfigurator {\n+\n+  static final String EVENT_LOGGER_NAME = \"teku-event-log\";\n+  static final String STATUS_LOGGER_NAME = \"teku-status-log\";\n+\n+  private static final String CONSOLE_APPENDER_NAME = \"teku-console-appender\";\n+  private static final String CONSOLE_FORMAT = \"%d{HH:mm:ss.SSS} [%-5level] - %msg%n\";\n+  private static final String FILE_APPENDER_NAME = \"teku-log-appender\";\n+  private static final String FILE_MESSAGE_FORMAT =\n+      \"%d{yyyy-MM-dd HH:mm:ss.SSSZZZ} | %t | %-5level | %c{1} | %msg%n\";\n+\n+  private static LoggingDestination DESTINATION;\n+  private static boolean COLOR;\n+  private static boolean INCLUDE_EVENTS;\n+  private static String FILE;\n+  private static String FILE_PATTERN;\n+  private static Level LOG_LEVEL = Level.INFO;\n+\n+  public static boolean isColorEnabled() {\n+    return COLOR;\n+  }\n+\n+  public static void setAllLevels(final Level level) {\n+    StatusLogger.getLogger().info(\"Setting logging level to {}\", level.name());\n+    Configurator.setAllLevels(\"\", level);\n+    LOG_LEVEL = level;\n+  }\n+\n+  public static void update(final LoggingConfiguration configuration) {\n+    COLOR = configuration.isColorEnabled();\n+    DESTINATION = configuration.getDestination();\n+    INCLUDE_EVENTS = configuration.isIncludeEventsEnabled();\n+    FILE = configuration.getFile();\n+    FILE_PATTERN = configuration.getFileNamePattern();\n+\n+    final LoggerContext ctx = (LoggerContext) LogManager.getContext(false);\n+    addLoggersProgrammatically((AbstractConfiguration) ctx.getConfiguration());\n+    ctx.updateLoggers();\n+  }\n+\n+  public static void addLoggersProgrammatically(final AbstractConfiguration configuration) {\n+\n+    if (DESTINATION == null) {\n+      return;\n+    }\n+\n+    StatusLogger.getLogger().info(\"Programmatic logging setup: {}\", DESTINATION);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 78}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzODQ3NDE5OnYy", "diffSide": "RIGHT", "path": "util/build.gradle", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMToxMjowMVrOF3KyPw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwNDoxNDoyOFrOF3Nbhg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MjcwMw==", "bodyText": "This is a very unfortunate dependency to add.", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393392703", "createdAt": "2020-03-17T01:12:01Z", "author": {"login": "ajsutton"}, "path": "util/build.gradle", "diffHunk": "@@ -5,6 +5,8 @@ plugins {\n dependencies {\n   api 'org.bouncycastle:bcprov-jdk15on'\n \n+  implementation project(':logging')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQxNzU1OA==", "bodyText": "How so? ...currently logging is pretty much a leaf dependency (only depending on tuweni-bytes),  or is it more that things are being done in utils shouldn't be needing the new logging?", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393417558", "createdAt": "2020-03-17T02:56:36Z", "author": {"login": "CjHare"}, "path": "util/build.gradle", "diffHunk": "@@ -5,6 +5,8 @@ plugins {\n dependencies {\n   api 'org.bouncycastle:bcprov-jdk15on'\n \n+  implementation project(':logging')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MjcwMw=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQyNDM1Mg==", "bodyText": "I was living in my happy little world where util was a relatively small module - keep forgetting that it's a giant monolith of random stuff...", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393424352", "createdAt": "2020-03-17T03:22:08Z", "author": {"login": "ajsutton"}, "path": "util/build.gradle", "diffHunk": "@@ -5,6 +5,8 @@ plugins {\n dependencies {\n   api 'org.bouncycastle:bcprov-jdk15on'\n \n+  implementation project(':logging')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MjcwMw=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQzNjAzOA==", "bodyText": "True, util does quite a bit, but as I've made in the inversion now \ud83e\udd37\u200d\u2642", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393436038", "createdAt": "2020-03-17T04:14:28Z", "author": {"login": "CjHare"}, "path": "util/build.gradle", "diffHunk": "@@ -5,6 +5,8 @@ plugins {\n dependencies {\n   api 'org.bouncycastle:bcprov-jdk15on'\n \n+  implementation project(':logging')", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MjcwMw=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzODQ3NjYwOnYy", "diffSide": "RIGHT", "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMToxMzoyOFrOF3KzoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMToxMzoyOFrOF3KzoQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzA1Nw==", "bodyText": "Typically ArtemisConfiguration sticks to just the raw data types so I think we probably should invert this dependency.  So ArtemisConfiguration.getLoggingDestination just returns a string and LoggingDestination has a fromConfig that has this mapping.", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393393057", "createdAt": "2020-03-17T01:13:28Z", "author": {"login": "ajsutton"}, "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "diffHunk": "@@ -399,4 +431,25 @@ public int getBeaconRestAPIPortNumber() {\n   public boolean getBeaconRestAPIEnableSwagger() {\n     return config.getBoolean(\"beaconrestapi.enableSwagger\");\n   }\n+\n+  private LoggingDestination getLoggingDestination() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzODQ3Njc3OnYy", "diffSide": "RIGHT", "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMToxMzozOFrOF3Kzuw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMjo1Njo1OVrOF3MTsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzA4Mw==", "bodyText": "Probably should warn on unknown values.", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393393083", "createdAt": "2020-03-17T01:13:38Z", "author": {"login": "ajsutton"}, "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "diffHunk": "@@ -399,4 +431,25 @@ public int getBeaconRestAPIPortNumber() {\n   public boolean getBeaconRestAPIEnableSwagger() {\n     return config.getBoolean(\"beaconrestapi.enableSwagger\");\n   }\n+\n+  private LoggingDestination getLoggingDestination() {\n+    switch (config.getString(\"logging.destination\")) {\n+      case \"consoleOnly\":\n+        return LoggingDestination.CONSOLE_ONLY;\n+      case \"fileOnly\":\n+        return LoggingDestination.FILE_ONLY;\n+      case \"both\":\n+      default:\n+        return LoggingDestination.BOTH;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQxNzY1MQ==", "bodyText": "Sound sensible, can do \ud83d\udc4d", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393417651", "createdAt": "2020-03-17T02:56:59Z", "author": {"login": "CjHare"}, "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "diffHunk": "@@ -399,4 +431,25 @@ public int getBeaconRestAPIPortNumber() {\n   public boolean getBeaconRestAPIEnableSwagger() {\n     return config.getBoolean(\"beaconrestapi.enableSwagger\");\n   }\n+\n+  private LoggingDestination getLoggingDestination() {\n+    switch (config.getString(\"logging.destination\")) {\n+      case \"consoleOnly\":\n+        return LoggingDestination.CONSOLE_ONLY;\n+      case \"fileOnly\":\n+        return LoggingDestination.FILE_ONLY;\n+      case \"both\":\n+      default:\n+        return LoggingDestination.BOTH;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzA4Mw=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 68}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzODQ3ODk2OnYy", "diffSide": "RIGHT", "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "isResolved": false, "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwMToxNTowMVrOF3K1Cg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QwNDoxNzo0NlrOF3NeMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzQxOA==", "bodyText": "Probably should invert this dependency too so have LoggingConfiguration.fromConfig(ArtemisConfiguration).", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393393418", "createdAt": "2020-03-17T01:15:01Z", "author": {"login": "ajsutton"}, "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "diffHunk": "@@ -399,4 +431,25 @@ public int getBeaconRestAPIPortNumber() {\n   public boolean getBeaconRestAPIEnableSwagger() {\n     return config.getBoolean(\"beaconrestapi.enableSwagger\");\n   }\n+\n+  private LoggingDestination getLoggingDestination() {\n+    switch (config.getString(\"logging.destination\")) {\n+      case \"consoleOnly\":\n+        return LoggingDestination.CONSOLE_ONLY;\n+      case \"fileOnly\":\n+        return LoggingDestination.FILE_ONLY;\n+      case \"both\":\n+      default:\n+        return LoggingDestination.BOTH;\n+    }\n+  }\n+\n+  public LoggingConfiguration getLoggingConfiguration() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQxNjc5Mw==", "bodyText": "Yeah, I would have done but ...circular dependency issues.\nArtemisConfiguration resides in the artemis module that has a dependency on the logging module. Referencing ArtemisConfiguration in logging would now require logging be dependant on artemis.\nUnless I were to move ArtemisConfiguration into that conveniently named config module \ud83e\udd14", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393416793", "createdAt": "2020-03-17T02:53:26Z", "author": {"login": "CjHare"}, "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "diffHunk": "@@ -399,4 +431,25 @@ public int getBeaconRestAPIPortNumber() {\n   public boolean getBeaconRestAPIEnableSwagger() {\n     return config.getBoolean(\"beaconrestapi.enableSwagger\");\n   }\n+\n+  private LoggingDestination getLoggingDestination() {\n+    switch (config.getString(\"logging.destination\")) {\n+      case \"consoleOnly\":\n+        return LoggingDestination.CONSOLE_ONLY;\n+      case \"fileOnly\":\n+        return LoggingDestination.FILE_ONLY;\n+      case \"both\":\n+      default:\n+        return LoggingDestination.BOTH;\n+    }\n+  }\n+\n+  public LoggingConfiguration getLoggingConfiguration() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzQxOA=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQyMzY2OQ==", "bodyText": "Turns out (after checking) ArtemisConfiguration is in util and not artemis, the inverting idea works \ud83d\udc4d", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393423669", "createdAt": "2020-03-17T03:19:33Z", "author": {"login": "CjHare"}, "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "diffHunk": "@@ -399,4 +431,25 @@ public int getBeaconRestAPIPortNumber() {\n   public boolean getBeaconRestAPIEnableSwagger() {\n     return config.getBoolean(\"beaconrestapi.enableSwagger\");\n   }\n+\n+  private LoggingDestination getLoggingDestination() {\n+    switch (config.getString(\"logging.destination\")) {\n+      case \"consoleOnly\":\n+        return LoggingDestination.CONSOLE_ONLY;\n+      case \"fileOnly\":\n+        return LoggingDestination.FILE_ONLY;\n+      case \"both\":\n+      default:\n+        return LoggingDestination.BOTH;\n+    }\n+  }\n+\n+  public LoggingConfiguration getLoggingConfiguration() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzQxOA=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQyNTA0NA==", "bodyText": "ArtemisConfiguration is in util currently.  So this would have logging depend on util rather than the other way around.  config is not actually a module, it's a directory that holds the config file. :) But I definitely wouldn't object to splitting ArtemisConfiguration out of util on the basis that util has way too much stuff in it.  Not entirely sure it's worth it.\nThe other possibility is to do what NetworkConfig currently does and just leave someone else to do the mapping ie https://github.com/PegaSysEng/teku/blob/9cd23ae4a876ca08b416349164d1c07b4412022f/services/beaconchain/src/main/java/tech/pegasys/artemis/services/beaconchain/BeaconChainController.java#L247\nI do think there is value in keep ArtemisConfiguration working with primitives because it's going to get a major rewrite soon so the simpler it is the simpler that will be.", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393425044", "createdAt": "2020-03-17T03:25:27Z", "author": {"login": "ajsutton"}, "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "diffHunk": "@@ -399,4 +431,25 @@ public int getBeaconRestAPIPortNumber() {\n   public boolean getBeaconRestAPIEnableSwagger() {\n     return config.getBoolean(\"beaconrestapi.enableSwagger\");\n   }\n+\n+  private LoggingDestination getLoggingDestination() {\n+    switch (config.getString(\"logging.destination\")) {\n+      case \"consoleOnly\":\n+        return LoggingDestination.CONSOLE_ONLY;\n+      case \"fileOnly\":\n+        return LoggingDestination.FILE_ONLY;\n+      case \"both\":\n+      default:\n+        return LoggingDestination.BOTH;\n+    }\n+  }\n+\n+  public LoggingConfiguration getLoggingConfiguration() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzQxOA=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQzNjQxMw==", "bodyText": "it's going to get a major rewrite soon\n\nExcellent \ud83d\udc4d", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393436413", "createdAt": "2020-03-17T04:16:17Z", "author": {"login": "CjHare"}, "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "diffHunk": "@@ -399,4 +431,25 @@ public int getBeaconRestAPIPortNumber() {\n   public boolean getBeaconRestAPIEnableSwagger() {\n     return config.getBoolean(\"beaconrestapi.enableSwagger\");\n   }\n+\n+  private LoggingDestination getLoggingDestination() {\n+    switch (config.getString(\"logging.destination\")) {\n+      case \"consoleOnly\":\n+        return LoggingDestination.CONSOLE_ONLY;\n+      case \"fileOnly\":\n+        return LoggingDestination.FILE_ONLY;\n+      case \"both\":\n+      default:\n+        return LoggingDestination.BOTH;\n+    }\n+  }\n+\n+  public LoggingConfiguration getLoggingConfiguration() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzQxOA=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 72}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzQzNjcyMA==", "bodyText": "The other possibility is to do what NetworkConfig\n\nAs the conversion is done only once, I'll follow the NetworkConfig  pattern", "url": "https://github.com/ConsenSys/teku/pull/1379#discussion_r393436720", "createdAt": "2020-03-17T04:17:46Z", "author": {"login": "CjHare"}, "path": "util/src/main/java/tech/pegasys/artemis/util/config/ArtemisConfiguration.java", "diffHunk": "@@ -399,4 +431,25 @@ public int getBeaconRestAPIPortNumber() {\n   public boolean getBeaconRestAPIEnableSwagger() {\n     return config.getBoolean(\"beaconrestapi.enableSwagger\");\n   }\n+\n+  private LoggingDestination getLoggingDestination() {\n+    switch (config.getString(\"logging.destination\")) {\n+      case \"consoleOnly\":\n+        return LoggingDestination.CONSOLE_ONLY;\n+      case \"fileOnly\":\n+        return LoggingDestination.FILE_ONLY;\n+      case \"both\":\n+      default:\n+        return LoggingDestination.BOTH;\n+    }\n+  }\n+\n+  public LoggingConfiguration getLoggingConfiguration() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzM5MzQxOA=="}, "originalCommit": {"oid": "aab2a73b0093f21f8ecd2da3b4fede6f183d54ff"}, "originalPosition": 72}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2549, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}