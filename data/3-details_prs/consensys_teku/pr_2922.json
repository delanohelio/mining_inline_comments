{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAwMTU4MjM3", "number": 2922, "title": "[QS] Adhere to best practices for Teku", "bodyText": "PR Description\nAdhere to best practices. Excluding jvm-libp2p, and discovery libraries.\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.", "createdAt": "2020-10-08T20:07:00Z", "url": "https://github.com/ConsenSys/teku/pull/2922", "merged": true, "mergeCommit": {"oid": "340e8ec4a7b1b4e8a19bb486595762c6bf3c1265"}, "closed": true, "closedAt": "2020-10-13T14:34:19Z", "author": {"login": "cemozerr"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdQmIMdAH2gAyNTAwMTU4MjM3OmIwYTQxM2E2N2JmODMxYTJmYjc2NDc5YjI2N2M2MTk0ZThjZDkwZTQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdSJU43AH2gAyNTAwMTU4MjM3OmExOWNkMzA3MmMzZDI3ZmJlYzAyM2U4YjA4NTE5NDU1NDI3YzM5YjI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b0a413a67bf831a2fb76479b267c6194e8cd90e4", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/b0a413a67bf831a2fb76479b267c6194e8cd90e4", "committedDate": "2020-10-08T18:45:22Z", "message": "2) Fix redundantly declared exception"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e9bdf83688ace3d9ba36426d8fade3ce5e2cbd69", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/e9bdf83688ace3d9ba36426d8fade3ce5e2cbd69", "committedDate": "2020-10-08T18:48:13Z", "message": "4) Simplify to return the condition"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bf8e6dfb0a08656bec9a95ea0cd63246065f26df", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/bf8e6dfb0a08656bec9a95ea0cd63246065f26df", "committedDate": "2020-10-08T18:57:43Z", "message": "5) Remove redundant final keyword"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "74c12083df136f0b8a38b8f131a0ed62dc918853", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/74c12083df136f0b8a38b8f131a0ed62dc918853", "committedDate": "2020-10-08T18:58:11Z", "message": "6) Check that the api server is not null before setting options"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27fd32b22aa464f3d2bff6cf45b8196348b167c2", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/27fd32b22aa464f3d2bff6cf45b8196348b167c2", "committedDate": "2020-10-08T18:58:17Z", "message": "8) Delete redundant public key serializer"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "701d694d16b52f90d1e2291c82f1052e69cc9096", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/701d694d16b52f90d1e2291c82f1052e69cc9096", "committedDate": "2020-10-08T19:10:48Z", "message": "26) Remove unnecessary return statement"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab37079c850887a515e660116893c4be026f4cd0", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/ab37079c850887a515e660116893c4be026f4cd0", "committedDate": "2020-10-08T19:23:20Z", "message": "37) Use class level constants for HTTP codes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d7172171ac86a7affff40b9c8e1c1310d2af1482", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/d7172171ac86a7affff40b9c8e1c1310d2af1482", "committedDate": "2020-10-08T19:24:46Z", "message": "Make combinedChainDataClient final"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b345d26e613383b9b6fb88728d30308d4d4b5cf6", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/b345d26e613383b9b6fb88728d30308d4d4b5cf6", "committedDate": "2020-10-08T19:33:54Z", "message": "38) 1) Make gas limit a class level constant"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9c1f5e4141924d469b3c716a699414f1983eb2c8", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/9c1f5e4141924d469b3c716a699414f1983eb2c8", "committedDate": "2020-10-08T20:05:35Z", "message": "39) Order class members by scope"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f822521b1ece384b794a3fad9f2d836921626eca", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/f822521b1ece384b794a3fad9f2d836921626eca", "committedDate": "2020-10-08T20:06:09Z", "message": "Run spotless"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA1MTQyMzU4", "url": "https://github.com/ConsenSys/teku/pull/2922#pullrequestreview-505142358", "createdAt": "2020-10-08T20:30:33Z", "commit": {"oid": "74c12083df136f0b8a38b8f131a0ed62dc918853"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQyMDozMDozM1rOHevShw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wOFQyMDozNzoxOFrOHevf9w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk5NDExOQ==", "bodyText": "This is redundant - it will throw a NullPointerException with or without requireNonNull because that's what requireNonNull does when the param is null.  We shouldn't make any change here - the server is known to not be null at this point, just the analyser doesn't know that.", "url": "https://github.com/ConsenSys/teku/pull/2922#discussion_r501994119", "createdAt": "2020-10-08T20:30:33Z", "author": {"login": "ajsutton"}, "path": "data/beaconrestapi/src/main/java/tech/pegasys/teku/beaconrestapi/BeaconRestApi.java", "diffHunk": "@@ -105,8 +107,8 @@ private void initialize(\n             return jettyServer;\n           });\n     }\n-    app.server().setServerHost(configuration.getRestApiInterface());\n-    app.server().setServerPort(configuration.getRestApiPort());\n+    Objects.requireNonNull(app.server()).setServerHost(configuration.getRestApiInterface());\n+    Objects.requireNonNull(app.server()).setServerPort(configuration.getRestApiPort());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "74c12083df136f0b8a38b8f131a0ed62dc918853"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk5NDg0Mg==", "bodyText": "I'd restore this.  While it is redundant today, it's not a good idea to catch and ignore an error then continue on. If code was later added after the catch block, the missing return here would likely go unnoticed and cause bugs.", "url": "https://github.com/ConsenSys/teku/pull/2922#discussion_r501994842", "createdAt": "2020-10-08T20:32:00Z", "author": {"login": "ajsutton"}, "path": "networking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/gossip/topics/validation/BlockValidator.java", "diffHunk": "@@ -87,7 +88,6 @@ public BlockValidator(RecentChainData recentChainData, StateTransition stateTran\n                 }\n               } catch (EpochProcessingException | SlotProcessingException e) {\n                 LOG.error(\"BlockValidator: Unable to process block state.\", e);\n-                return InternalValidationResult.REJECT;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "701d694d16b52f90d1e2291c82f1052e69cc9096"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk5Njk2Nw==", "bodyText": "Do these need to be public?  And can we use a predefined constant like from HttpServletResponse or one of the various HttpStatus classes?", "url": "https://github.com/ConsenSys/teku/pull/2922#discussion_r501996967", "createdAt": "2020-10-08T20:36:06Z", "author": {"login": "ajsutton"}, "path": "data/provider/src/main/java/tech/pegasys/teku/api/ValidatorDataProvider.java", "diffHunk": "@@ -62,6 +63,10 @@\n   private CombinedChainDataClient combinedChainDataClient;\n   private final BlockImporter blockImporter;\n \n+  public static final int INTERNAL_ERROR_HTTP_CODE = 500;\n+  public static final int ACCEPTED_HTTP_CODE = 202;\n+  public static final int OK_HTTP_CODE = 200;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ab37079c850887a515e660116893c4be026f4cd0"}, "originalPosition": 41}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTk5NzU1OQ==", "bodyText": "This constant is redundant and just makes the code harder to read.  We're literally in a method called getGasLimit so I think it's clear what the 200_000 means and REASONABLE_GAS_LIMIT doesn't provide any additional information, but does make the actual value one step further removed so harder to find.", "url": "https://github.com/ConsenSys/teku/pull/2922#discussion_r501997559", "createdAt": "2020-10-08T20:37:18Z", "author": {"login": "ajsutton"}, "path": "teku/src/main/java/tech/pegasys/teku/cli/deposit/DepositTransactionSender.java", "diffHunk": "@@ -128,7 +130,7 @@ public BigInteger getGasLimit(final String contractFunc) {\n \n     @Override\n     public BigInteger getGasLimit() {\n-      return BigInteger.valueOf(200_000L);\n+      return BigInteger.valueOf(REASONABLE_GAS_LIMIT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b345d26e613383b9b6fb88728d30308d4d4b5cf6"}, "originalPosition": 33}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a6ce02ad2aaf31866ec3c3a40bdd122327843830", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/a6ce02ad2aaf31866ec3c3a40bdd122327843830", "committedDate": "2020-10-08T21:17:40Z", "message": "Revert \"Run spotless\"\n\nThis reverts commit f822521b1ece384b794a3fad9f2d836921626eca."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17cad6a8a4a996f5fd4b89037ee63dbc8598a3a7", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/17cad6a8a4a996f5fd4b89037ee63dbc8598a3a7", "committedDate": "2020-10-08T21:17:50Z", "message": "Revert \"39) Order class members by scope\"\n\nThis reverts commit 9c1f5e4141924d469b3c716a699414f1983eb2c8."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f18c087b2856677d4f759b5595fab6e23a3321e0", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/f18c087b2856677d4f759b5595fab6e23a3321e0", "committedDate": "2020-10-08T21:18:18Z", "message": "Revert \"6) Check that the api server is not null before setting options\"\n\nThis reverts commit 74c12083df136f0b8a38b8f131a0ed62dc918853."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0efb2b9d8d23309772905d846f7d920f3c36428", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/f0efb2b9d8d23309772905d846f7d920f3c36428", "committedDate": "2020-10-08T21:19:02Z", "message": "Revert \"26) Remove unnecessary return statement\"\n\nThis reverts commit 701d694d16b52f90d1e2291c82f1052e69cc9096."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "152eedead21c071aae4474b095ce3117a38c0a95", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/152eedead21c071aae4474b095ce3117a38c0a95", "committedDate": "2020-10-09T17:49:53Z", "message": "Rename status codes and make them private"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b05604b9d5d8b49f68ac2134a75ce0f5c47ac14c", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/b05604b9d5d8b49f68ac2134a75ce0f5c47ac14c", "committedDate": "2020-10-09T17:51:32Z", "message": "Revert \"38) 1) Make gas limit a class level constant\"\n\nThis reverts commit b345d26e613383b9b6fb88728d30308d4d4b5cf6."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "55382aed71c9b31ecddf8144de94fd633398852b", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/55382aed71c9b31ecddf8144de94fd633398852b", "committedDate": "2020-10-09T17:52:27Z", "message": "Run spotless"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebcfa3c3fd01a18a0b7f0a63f64daf2bef04268f", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/ebcfa3c3fd01a18a0b7f0a63f64daf2bef04268f", "committedDate": "2020-10-09T17:55:26Z", "message": "Merge branch 'master' into qs/adhere-to-best-practices"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MjE4NzU3", "url": "https://github.com/ConsenSys/teku/pull/2922#pullrequestreview-506218757", "createdAt": "2020-10-11T21:38:47Z", "commit": {"oid": "ebcfa3c3fd01a18a0b7f0a63f64daf2bef04268f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a19cd3072c3d27fbec023e8b08519455427c39b2", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/a19cd3072c3d27fbec023e8b08519455427c39b2", "committedDate": "2020-10-13T14:19:50Z", "message": "Merge branch 'master' into qs/adhere-to-best-practices"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3323, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}