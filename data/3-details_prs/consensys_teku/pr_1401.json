{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkwMTc5Mzg0", "number": 1401, "title": "add custom 404 page for when swagger is enabled", "bodyText": "Add a simple custom 404 page providing a link to swagger, if swagger is enabled.", "createdAt": "2020-03-18T02:35:46Z", "url": "https://github.com/ConsenSys/teku/pull/1401", "merged": true, "mergeCommit": {"oid": "2779825dbd9210399daba2e6cc1820693678e891"}, "closed": true, "closedAt": "2020-03-18T20:24:43Z", "author": {"login": "rolfyone"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOt957AH2gAyMzkwMTc5Mzg0OjZlNzA4YWU2NzU1MTA3MjFmY2QwZTdjZGVhNDc4OTJmZjA5ZDYxZjE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcO9HjigH2gAyMzkwMTc5Mzg0OjdlZGZiZjQ5NjcwZmIzZGVjYmE3OWYzMjQ3OWJiN2JlNTgwYTE0NTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6e708ae675510721fcd0e7cdea47892ff09d61f1", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/6e708ae675510721fcd0e7cdea47892ff09d61f1", "committedDate": "2020-03-18T02:34:22Z", "message": "add custom 404 page for when swagger is enabled"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NTMwODM4", "url": "https://github.com/ConsenSys/teku/pull/1401#pullrequestreview-376530838", "createdAt": "2020-03-18T02:48:37Z", "commit": {"oid": "6e708ae675510721fcd0e7cdea47892ff09d61f1"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwMjo0ODozN1rOF30n7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQwMjo1NDozOFrOF30trQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDA3ODE4OA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                <title>404 - Page no found</title>\n          \n          \n            \n                <title>404 - Page not found</title>", "url": "https://github.com/ConsenSys/teku/pull/1401#discussion_r394078188", "createdAt": "2020-03-18T02:48:37Z", "author": {"login": "macfarla"}, "path": "data/beaconrestapi/src/main/resources/404.html", "diffHunk": "@@ -0,0 +1,11 @@\n+<!DOCTYPE html>\n+<html lang=\"en\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <title>404 - Page no found</title>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e708ae675510721fcd0e7cdea47892ff09d61f1"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDA3ODk0Nw==", "bodyText": "nit: should prob pull the filename out as a constant", "url": "https://github.com/ConsenSys/teku/pull/1401#discussion_r394078947", "createdAt": "2020-03-18T02:51:58Z", "author": {"login": "macfarla"}, "path": "data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/BeaconRestApi.java", "diffHunk": "@@ -50,14 +58,37 @@\n public class BeaconRestApi {\n   private final Javalin app;\n   private final JsonProvider jsonProvider = new JsonProvider();\n+  private static final Logger LOG = LogManager.getLogger();\n \n-  private void initialise(final DataProvider dataProvider, final int requestedPortNumber) {\n-    app.server().setServerPort(requestedPortNumber);\n+  private void initialise(\n+      final DataProvider dataProvider, final ArtemisConfiguration configuration) {\n+    app.server().setServerPort(configuration.getBeaconRestAPIPortNumber());\n \n     addBeaconHandlers(dataProvider);\n     addNetworkHandlers(dataProvider.getNetworkDataProvider());\n     addNodeHandlers(dataProvider);\n     addValidatorHandlers(dataProvider);\n+    addCustomErrorPages(configuration);\n+  }\n+\n+  private void addCustomErrorPages(final ArtemisConfiguration configuration) {\n+    if (configuration.getBeaconRestAPIEnableSwagger()) {\n+      try {\n+        String content = readResource(\"404.html\", Charsets.UTF_8);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e708ae675510721fcd0e7cdea47892ff09d61f1"}, "originalPosition": 45}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDA3OTY2MQ==", "bodyText": "do we need to use jetty 404?", "url": "https://github.com/ConsenSys/teku/pull/1401#discussion_r394079661", "createdAt": "2020-03-18T02:54:38Z", "author": {"login": "macfarla"}, "path": "data/beaconrestapi/src/main/java/tech/pegasys/artemis/beaconrestapi/BeaconRestApi.java", "diffHunk": "@@ -13,14 +13,22 @@\n \n package tech.pegasys.artemis.beaconrestapi;\n \n+import static org.eclipse.jetty.http.HttpStatus.NOT_FOUND_404;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6e708ae675510721fcd0e7cdea47892ff09d61f1"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b4b070a21f8d468296e2bf685ac667f80ee4e3aa", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/b4b070a21f8d468296e2bf685ac667f80ee4e3aa", "committedDate": "2020-03-18T03:43:00Z", "message": "review feedback"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f1a3c6192037967752286c2e3b0979512b40831", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/4f1a3c6192037967752286c2e3b0979512b40831", "committedDate": "2020-03-18T03:55:53Z", "message": "Merge remote-tracking branch 'upstream/master' into custom-404"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc2NjUyOTAw", "url": "https://github.com/ConsenSys/teku/pull/1401#pullrequestreview-376652900", "createdAt": "2020-03-18T08:34:30Z", "commit": {"oid": "4f1a3c6192037967752286c2e3b0979512b40831"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7edfbf49670fb3decba79f32479bb7be580a1459", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/7edfbf49670fb3decba79f32479bb7be580a1459", "committedDate": "2020-03-18T20:13:29Z", "message": "Merge remote-tracking branch 'upstream/master' into custom-404"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4001, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}