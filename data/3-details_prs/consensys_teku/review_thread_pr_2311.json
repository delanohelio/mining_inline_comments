{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQzODM1ODQ4", "number": 2311, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwMzo0Nzo0MFrOELHUAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwMzo0Nzo0MFrOELHUAw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgwMDg5NjAzOnYy", "diffSide": "RIGHT", "path": "sync/src/main/java/tech/pegasys/teku/sync/PeerSync.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwMzo0Nzo0MFrOGsi3RQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wM1QwMzo0Nzo0MFrOGsi3RQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTM2MTczMw==", "bodyText": "Can we use a single labelled counter for this instead:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                this.blockImportSuccessResult =\n          \n          \n            \n                    metricsSystem.createCounter(\n          \n          \n            \n                        TekuMetricCategory.BEACON,\n          \n          \n            \n                        \"block_import_success_result\",\n          \n          \n            \n                        \"The number of block imports that have been successfully completed\");\n          \n          \n            \n            \n          \n          \n            \n                this.blockImportFailureResult =\n          \n          \n            \n                    metricsSystem.createCounter(\n          \n          \n            \n                        TekuMetricCategory.BEACON,\n          \n          \n            \n                        \"block_import_failure_result\",\n          \n          \n            \n                        \"The number of block imports that have failed\");\n          \n          \n            \n                final LabelledMetric<Counter> blockImportCounter =  metricsSystem.createLabelledCounter(\n          \n          \n            \n                        TekuMetricCategory.BEACON,\n          \n          \n            \n                        \"block_import_total\",\n          \n          \n            \n                        \"The number of block imports performed\",\n          \n          \n            \n                        \"result\");\n          \n          \n            \n                this.blockImportSuccessResult = blockImportCounter.labels(\"imported\");\n          \n          \n            \n                this.blockImportFailureResult = blockImportCounter.labels(\"rejected\");\n          \n      \n    \n    \n  \n\nThat way it's easy to show both these metrics on one graph or sum them together.", "url": "https://github.com/ConsenSys/teku/pull/2311#discussion_r449361733", "createdAt": "2020-07-03T03:47:40Z", "author": {"login": "ajsutton"}, "path": "sync/src/main/java/tech/pegasys/teku/sync/PeerSync.java", "diffHunk": "@@ -46,16 +49,31 @@\n   private final BlockImporter blockImporter;\n \n   private final AsyncRunner asyncRunner;\n+  private final Counter blockImportSuccessResult;\n+  private final Counter blockImportFailureResult;\n \n   private volatile UnsignedLong startingSlot = UnsignedLong.valueOf(0);\n \n   public PeerSync(\n       final AsyncRunner asyncRunner,\n       final RecentChainData storageClient,\n-      final BlockImporter blockImporter) {\n+      final BlockImporter blockImporter,\n+      final MetricsSystem metricsSystem) {\n     this.asyncRunner = asyncRunner;\n     this.storageClient = storageClient;\n     this.blockImporter = blockImporter;\n+\n+    this.blockImportSuccessResult =\n+        metricsSystem.createCounter(\n+            TekuMetricCategory.BEACON,\n+            \"block_import_success_result\",\n+            \"The number of block imports that have been successfully completed\");\n+\n+    this.blockImportFailureResult =\n+        metricsSystem.createCounter(\n+            TekuMetricCategory.BEACON,\n+            \"block_import_failure_result\",\n+            \"The number of block imports that have failed\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8fb836385be108b409d38fa76b03277cc25d2136"}, "originalPosition": 42}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3513, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}