{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDExOTIwMzA1", "number": 1701, "title": "Skip requesting genesis block in PeerChainValidator", "bodyText": "PR Description\nWhen validating that a peer is on the same chain, if we haven't finalised anything past genesis, assume that the fork digest check is enough to validate the chain and don't specifically request genesis.", "createdAt": "2020-05-01T00:59:54Z", "url": "https://github.com/ConsenSys/teku/pull/1701", "merged": true, "mergeCommit": {"oid": "c161c13497c200343156b822d1849f2c4898263b"}, "closed": true, "closedAt": "2020-05-01T21:42:47Z", "author": {"login": "ajsutton"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcc27vIgH2gAyNDExOTIwMzA1OmFhNGY4ZTE1NzdlODg4OTIxZDQ2ZTA3YTk4MDQwNzE1NjA3Mzg3NDE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcdImD9AH2gAyNDExOTIwMzA1OjQ1NzZmZWVkNWI4NjRhNWViMTFiMzk3N2Y3NTI5ODljMzU0NmM3NTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "aa4f8e1577e888921d46e07a9804071560738741", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/aa4f8e1577e888921d46e07a9804071560738741", "committedDate": "2020-05-01T00:56:05Z", "message": "Skip checking that the genesis block matches.  The fork digest check is enough of a check."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "852514a31fdccfd10826f68380f5c9453650f18c", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/852514a31fdccfd10826f68380f5c9453650f18c", "committedDate": "2020-05-01T00:56:21Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into skip-checking-genesis"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA0MTkzMzkx", "url": "https://github.com/ConsenSys/teku/pull/1701#pullrequestreview-404193391", "createdAt": "2020-05-01T14:36:44Z", "commit": {"oid": "852514a31fdccfd10826f68380f5c9453650f18c"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxNDozNjo0NFrOGPLbIA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wMVQxNDozOToxMlrOGPLgPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU2ODk5Mg==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private void remoteOnSameChainButReturnsResponseWhenGenesisRequested() {\n          \n          \n            \n              private void remoteOnSameChainButReturnsInvalidResponseWhenGenesisRequested() {", "url": "https://github.com/ConsenSys/teku/pull/1701#discussion_r418568992", "createdAt": "2020-05-01T14:36:44Z", "author": {"login": "mbaxter"}, "path": "networking/eth2/src/test/java/tech/pegasys/artemis/networking/eth2/peers/PeerChainValidatorTest.java", "diffHunk": "@@ -317,15 +317,18 @@ private void remoteChainIsAheadOnSameChain() {\n     when(peer.requestBlockBySlot(earlierBlockSlot)).thenReturn(blockFuture);\n   }\n \n-  private void remoteOnSameChainButWillNotReturnGenesis() {\n-    final SafeFuture<SignedBeaconBlock> postGenesisBlock = SafeFuture.completedFuture(earlierBlock);\n+  private void remoteOnSameChainButReturnsResponseWhenGenesisRequested() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852514a31fdccfd10826f68380f5c9453650f18c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODU3MDMwMg==", "bodyText": "I think we can return early before we pull this block by checking if the finalizedEpochSlot is the genesis slot", "url": "https://github.com/ConsenSys/teku/pull/1701#discussion_r418570302", "createdAt": "2020-05-01T14:39:12Z", "author": {"login": "mbaxter"}, "path": "networking/eth2/src/main/java/tech/pegasys/artemis/networking/eth2/peers/PeerChainValidator.java", "diffHunk": "@@ -193,11 +193,14 @@ private boolean remoteEpochIsInvalid(\n         .thenApply(maybeBlock -> blockToSlot(finalizedEpochSlot, maybeBlock))\n         .thenCompose(\n             blockSlot -> {\n+              if (blockSlot.equals(UnsignedLong.valueOf(Constants.GENESIS_SLOT))) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "852514a31fdccfd10826f68380f5c9453650f18c"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1d1417e7427ef33c8e0ddf206fe6671770c5297a", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/1d1417e7427ef33c8e0ddf206fe6671770c5297a", "committedDate": "2020-05-01T15:56:36Z", "message": "Merge branch 'master' into skip-checking-genesis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "93a90a897beeb8eb94784f5a8276f8899ab873e3", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/93a90a897beeb8eb94784f5a8276f8899ab873e3", "committedDate": "2020-05-01T21:26:02Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into skip-checking-genesis"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d512cfcc7472a6d3b0695692aeea9e9cd584076e", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/d512cfcc7472a6d3b0695692aeea9e9cd584076e", "committedDate": "2020-05-01T21:29:10Z", "message": "Review feedback."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4576feed5b864a5eb11b3977f752989c3546c754", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/4576feed5b864a5eb11b3977f752989c3546c754", "committedDate": "2020-05-01T21:30:42Z", "message": "Merge branch 'skip-checking-genesis' of github.com:ajsutton/teku into skip-checking-genesis"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4150, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}