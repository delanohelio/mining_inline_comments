{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIzODY4MDIz", "number": 1981, "title": "Added new ValidatorOptions validation rule and improved readability of existing error + tests.", "bodyText": "PR Description\nAdded some extra validation for ValidatorOptions CLI options and improved readability of the existing message.  New tests added.\nFixed Issue(s)\n\n\nFixes #1774", "createdAt": "2020-05-27T13:52:58Z", "url": "https://github.com/ConsenSys/teku/pull/1981", "merged": true, "mergeCommit": {"oid": "8bf8db9b9cfcb95eb7c5cfe8fcd4a13c27df636a"}, "closed": true, "closedAt": "2020-05-29T00:26:24Z", "author": {"login": "mark-terry"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABclZlruAH2gAyNDIzODY4MDIzOjE1MTJjODViOGQ1ODg3OTJhNjNhOTk3N2FlYjMzZmYyM2JmNDViNjA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcl26XJAH2gAyNDIzODY4MDIzOmY3NTFhZWFlZDZhNzhmOTdhYjYyNWJiODRjNzM5YjNlOTc0OWMxMzk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "1512c85b8d588792a63a9977aeb33ff23bf45b60", "author": {"user": {"login": "mark-terry", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/1512c85b8d588792a63a9977aeb33ff23bf45b60", "committedDate": "2020-05-27T13:50:04Z", "message": "Added new ValidatorOptions validation rule and improved readability of existing error + tests."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "03c109a47cf07452d8852deb7b2d63cff4b4ab1c", "author": {"user": {"login": "mark-terry", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/03c109a47cf07452d8852deb7b2d63cff4b4ab1c", "committedDate": "2020-05-27T14:02:46Z", "message": "Build fix."}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDE5NjAyNDcy", "url": "https://github.com/ConsenSys/teku/pull/1981#pullrequestreview-419602472", "createdAt": "2020-05-27T20:57:23Z", "commit": {"oid": "03c109a47cf07452d8852deb7b2d63cff4b4ab1c"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMDo1NzoyM1rOGbc2xg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yN1QyMDo1ODo0MlrOGbc5hQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQzNzUxMA==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      \"Invalid configuration. '--validators-key-files' and '--validators-key-password-files' cannot be specified separately\";\n          \n          \n            \n                      \"Invalid configuration. '--validators-key-files' and '--validators-key-password-files' must be specified together\";", "url": "https://github.com/ConsenSys/teku/pull/1981#discussion_r431437510", "createdAt": "2020-05-27T20:57:23Z", "author": {"login": "macfarla"}, "path": "util/src/main/java/tech/pegasys/teku/util/config/TekuConfiguration.java", "diffHunk": "@@ -456,17 +457,30 @@ public void validateConfig() throws IllegalArgumentException {\n               \"Invalid configuration. Interop number of validators [%d] must be greater than or equal to [%d]\",\n               interopNumberOfValidators, Constants.SLOTS_PER_EPOCH));\n     }\n-    validateKeyStoreFilesAndPasswordFilesSize();\n+    validateKeyStoreFilesAndPasswordFilesConfig();\n   }\n \n-  private void validateKeyStoreFilesAndPasswordFilesSize() {\n+  private void validateKeyStoreFilesAndPasswordFilesConfig() {\n     final List<String> validatorKeystoreFiles = getValidatorKeystoreFiles();\n     final List<String> validatorKeystorePasswordFiles = getValidatorKeystorePasswordFiles();\n \n+    if ((validatorKeystoreFiles != null && validatorKeystorePasswordFiles == null)\n+        || (validatorKeystoreFiles == null && validatorKeystorePasswordFiles != null)) {\n+      final String errorMessage =\n+          \"Invalid configuration. '--validators-key-files' and '--validators-key-password-files' cannot be specified separately\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03c109a47cf07452d8852deb7b2d63cff4b4ab1c"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTQzODIxMw==", "bodyText": "number of arguments doesn't seem quite right. The argument is a list, containing a number of items? Size or length might be more accurate", "url": "https://github.com/ConsenSys/teku/pull/1981#discussion_r431438213", "createdAt": "2020-05-27T20:58:42Z", "author": {"login": "macfarla"}, "path": "util/src/main/java/tech/pegasys/teku/util/config/TekuConfiguration.java", "diffHunk": "@@ -456,17 +457,30 @@ public void validateConfig() throws IllegalArgumentException {\n               \"Invalid configuration. Interop number of validators [%d] must be greater than or equal to [%d]\",\n               interopNumberOfValidators, Constants.SLOTS_PER_EPOCH));\n     }\n-    validateKeyStoreFilesAndPasswordFilesSize();\n+    validateKeyStoreFilesAndPasswordFilesConfig();\n   }\n \n-  private void validateKeyStoreFilesAndPasswordFilesSize() {\n+  private void validateKeyStoreFilesAndPasswordFilesConfig() {\n     final List<String> validatorKeystoreFiles = getValidatorKeystoreFiles();\n     final List<String> validatorKeystorePasswordFiles = getValidatorKeystorePasswordFiles();\n \n+    if ((validatorKeystoreFiles != null && validatorKeystorePasswordFiles == null)\n+        || (validatorKeystoreFiles == null && validatorKeystorePasswordFiles != null)) {\n+      final String errorMessage =\n+          \"Invalid configuration. '--validators-key-files' and '--validators-key-password-files' cannot be specified separately\";\n+      throw new InvalidConfigurationException(errorMessage);\n+    }\n+\n     if (validatorKeystoreFiles.size() != validatorKeystorePasswordFiles.size()) {\n+      StatusLogger.getLogger()\n+          .debug(\n+              \"Invalid configuration. The size of validator.validatorsKeystoreFiles {} and validator.validatorsKeystorePasswordFiles {} must match\",\n+              validatorKeystoreFiles.size(),\n+              validatorKeystorePasswordFiles.size());\n+\n       final String errorMessage =\n           String.format(\n-              \"Invalid configuration. The size of validator.validatorsKeystoreFiles [%d] and validator.validatorsKeystorePasswordFiles [%d] must match\",\n+              \"Invalid configuration. The number of arguments for --validators-key-files [%d] and --validators-key-password-files [%d] must match\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "03c109a47cf07452d8852deb7b2d63cff4b4ab1c"}, "originalPosition": 47}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1de2911eea4bfe03dbc5a027824d321c309e43e7", "author": {"user": {"login": "mark-terry", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/1de2911eea4bfe03dbc5a027824d321c309e43e7", "committedDate": "2020-05-27T22:42:03Z", "message": "Update util/src/main/java/tech/pegasys/teku/util/config/TekuConfiguration.java\n\nCo-authored-by: Sally MacFarlane <sally.macfarlane@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3357680ad409a5bfeb280a0b629c30bfdf1fe5e6", "author": {"user": {"login": "mark-terry", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/3357680ad409a5bfeb280a0b629c30bfdf1fe5e6", "committedDate": "2020-05-28T12:34:49Z", "message": "Altered exception message.\n\nSigned-off-by: Mark Terry <mark.terry@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b22f1221cf06134647232efca26511ee943e3ea", "author": {"user": {"login": "mark-terry", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/9b22f1221cf06134647232efca26511ee943e3ea", "committedDate": "2020-05-28T12:35:43Z", "message": "Merge branch 'master' into 1774"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNDYwMTQ3", "url": "https://github.com/ConsenSys/teku/pull/1981#pullrequestreview-420460147", "createdAt": "2020-05-28T20:17:38Z", "commit": {"oid": "9b22f1221cf06134647232efca26511ee943e3ea"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1fae06853e4050fcef38c638e3bd434385fb5962", "author": {"user": {"login": "mark-terry", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/1fae06853e4050fcef38c638e3bd434385fb5962", "committedDate": "2020-05-28T23:44:48Z", "message": "Merge branch 'master' into 1774"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4fedba65b25406704328a43a051700d10e765c5", "author": {"user": {"login": "mark-terry", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/a4fedba65b25406704328a43a051700d10e765c5", "committedDate": "2020-05-28T23:56:01Z", "message": "String fixes.\n\nSigned-off-by: Mark Terry <mark.terry@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f751aeaed6a78f97ab625bb84c739b3e9749c139", "author": {"user": {"login": "mark-terry", "name": null}}, "url": "https://github.com/ConsenSys/teku/commit/f751aeaed6a78f97ab625bb84c739b3e9749c139", "committedDate": "2020-05-28T23:59:54Z", "message": "Spotless.\n\nSigned-off-by: Mark Terry <mark.terry@consensys.net>"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4045, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}