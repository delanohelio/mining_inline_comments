{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk1MjQzMjUy", "number": 1499, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwMDoxMjo0NVrODsefqQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwMTo1OToxNlrODsfNug==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3OTYzNTYxOnYy", "diffSide": "RIGHT", "path": "logging/src/main/java/tech/pegasys/teku/logging/EventLogger.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwMDoxMjo0NVrOF9Wcrw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQyMzowNTo1OVrOF9_dBg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg3NTI0Nw==", "bodyText": "It doesn't show in the GitHub UI but the second of these asterisks is slightly superscript.  Was that intentional? It's kind of cool but slightly disconcerting...", "url": "https://github.com/ConsenSys/teku/pull/1499#discussion_r399875247", "createdAt": "2020-03-30T00:12:45Z", "author": {"login": "ajsutton"}, "path": "logging/src/main/java/tech/pegasys/teku/logging/EventLogger.java", "diffHunk": "@@ -33,25 +33,52 @@ private EventLogger(final String name) {\n   }\n \n   public void genesisEvent(final Bytes32 hashTreeRoot, final Bytes32 genesisBlockRoot) {\n-    info(\"******* Eth2Genesis Event*******\", Color.WHITE);\n-    log.info(\"Initial state root is {}\", hashTreeRoot.toHexString());\n-    log.info(\"Genesis block root is {}\", genesisBlockRoot.toHexString());\n+    final String genesisEventLog =\n+        String.format(\n+            \"Genesis Event *** Initial state root: %s, Genesis block root: %s\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22929c70b33015f817f6decdadb783de8af2d397"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDEwOTY3OQ==", "bodyText": "Are you using the Fira Code font?\ntonsky/FiraCode#480", "url": "https://github.com/ConsenSys/teku/pull/1499#discussion_r400109679", "createdAt": "2020-03-30T11:11:21Z", "author": {"login": "q9f"}, "path": "logging/src/main/java/tech/pegasys/teku/logging/EventLogger.java", "diffHunk": "@@ -33,25 +33,52 @@ private EventLogger(final String name) {\n   }\n \n   public void genesisEvent(final Bytes32 hashTreeRoot, final Bytes32 genesisBlockRoot) {\n-    info(\"******* Eth2Genesis Event*******\", Color.WHITE);\n-    log.info(\"Initial state root is {}\", hashTreeRoot.toHexString());\n-    log.info(\"Genesis block root is {}\", genesisBlockRoot.toHexString());\n+    final String genesisEventLog =\n+        String.format(\n+            \"Genesis Event *** Initial state root: %s, Genesis block root: %s\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg3NTI0Nw=="}, "originalCommit": {"oid": "22929c70b33015f817f6decdadb783de8af2d397"}, "originalPosition": 9}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU0NzA3OA==", "bodyText": "Yes, interesting.  Didn't expected three asterisks to be special.", "url": "https://github.com/ConsenSys/teku/pull/1499#discussion_r400547078", "createdAt": "2020-03-30T23:05:59Z", "author": {"login": "ajsutton"}, "path": "logging/src/main/java/tech/pegasys/teku/logging/EventLogger.java", "diffHunk": "@@ -33,25 +33,52 @@ private EventLogger(final String name) {\n   }\n \n   public void genesisEvent(final Bytes32 hashTreeRoot, final Bytes32 genesisBlockRoot) {\n-    info(\"******* Eth2Genesis Event*******\", Color.WHITE);\n-    log.info(\"Initial state root is {}\", hashTreeRoot.toHexString());\n-    log.info(\"Genesis block root is {}\", genesisBlockRoot.toHexString());\n+    final String genesisEventLog =\n+        String.format(\n+            \"Genesis Event *** Initial state root: %s, Genesis block root: %s\",", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg3NTI0Nw=="}, "originalCommit": {"oid": "22929c70b33015f817f6decdadb783de8af2d397"}, "originalPosition": 9}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ3OTc1MzU0OnYy", "diffSide": "RIGHT", "path": "services/beaconchain/src/main/java/tech/pegasys/artemis/services/beaconchain/BeaconChainController.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQwMTo1OToxNlrOF9XdBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMFQxMTowOToxOFrOF9kshw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg5MTcxNg==", "bodyText": "We've wound up re-enabling quite a lot of processing by removing the isSyncActive check here. Time event handling is an area that's still pretty messy (hence the Thread.sleep calls in here) and since our fork choice isn't yet optimised we can wind up failing to keep up with these tick events which cause a bunch of other issues.  The early abort while syncing is a bit of a band-aid fix for that while we work through a complete solution.\nI've played around with it a bit and my suggestion would be 18c0ed2. It still winds up running fork choice on each slot while syncing which hurts at the moment since it's unoptimised but I think gives the results we need without doing any unnecessary work.", "url": "https://github.com/ConsenSys/teku/pull/1499#discussion_r399891716", "createdAt": "2020-03-30T01:59:16Z", "author": {"login": "ajsutton"}, "path": "services/beaconchain/src/main/java/tech/pegasys/artemis/services/beaconchain/BeaconChainController.java", "diffHunk": "@@ -380,7 +380,7 @@ private void onStoreInitialized() {\n \n   @Override\n   public void onTick(Date date) {\n-    if (chainStorageClient.isPreGenesis() || syncService.isSyncActive()) {\n+    if (chainStorageClient.isPreGenesis()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "22929c70b33015f817f6decdadb783de8af2d397"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDEwODY3OQ==", "bodyText": "The simplest solution is that we revert commit 66e18fa for now and come up with a proper solution for #1497 - this would leave all the logging implemented but still aborts early (therefore not posting synclogs - yet).\nOtherwise, 18c0ed2 looks good to me if you also prefer to have some sync logging. Let me compile it and see if it also addresses the /node/syncing endpoint issue.", "url": "https://github.com/ConsenSys/teku/pull/1499#discussion_r400108679", "createdAt": "2020-03-30T11:09:18Z", "author": {"login": "q9f"}, "path": "services/beaconchain/src/main/java/tech/pegasys/artemis/services/beaconchain/BeaconChainController.java", "diffHunk": "@@ -380,7 +380,7 @@ private void onStoreInitialized() {\n \n   @Override\n   public void onTick(Date date) {\n-    if (chainStorageClient.isPreGenesis() || syncService.isSyncActive()) {\n+    if (chainStorageClient.isPreGenesis()) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTg5MTcxNg=="}, "originalCommit": {"oid": "22929c70b33015f817f6decdadb783de8af2d397"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1770, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}