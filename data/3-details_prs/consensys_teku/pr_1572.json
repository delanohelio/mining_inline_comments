{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNzU4Nzcz", "number": 1572, "title": "Upgrade to v0.11.1 spec", "bodyText": "PR Description\nUpgrade Teku to the v0.11.1 spec, excluding network changes.\nNote that fork choice changes haven't been started yet and validator changes are incomplete.", "createdAt": "2020-04-10T05:05:45Z", "url": "https://github.com/ConsenSys/teku/pull/1572", "merged": true, "mergeCommit": {"oid": "c2b5733301a99e0e234dab7de4de2cd9d2b09305"}, "closed": true, "closedAt": "2020-04-15T01:14:59Z", "author": {"login": "ajsutton"}, "timelineItems": {"totalCount": 22, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWJ59SAH2gAyNDAxNzU4NzczOjEwNWIzNGVhOGZhZGExMWY0MWY1ODZlOTQ1MmRkYzQ3OTYxZWRiZmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcXtaVdAH2gAyNDAxNzU4NzczOjViYjgyM2ZiODhhNTg5YTM1MWI3MzFiNzU4M2ZkMmViYWUxMWNhOTA=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "105b34ea8fada11f41f586e9452ddc47961edbfd", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/105b34ea8fada11f41f586e9452ddc47961edbfd", "committedDate": "2020-04-10T05:04:52Z", "message": "Apply changes from beacon-chain.md (and knock on effects)."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9ab74e9b0c21d94ceb10cafdde7e6b290ac995d8", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/9ab74e9b0c21d94ceb10cafdde7e6b290ac995d8", "committedDate": "2020-04-10T05:06:16Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into v0.11.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af5acaa887cef53621f624b48915e95f7b0224bf", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/af5acaa887cef53621f624b48915e95f7b0224bf", "committedDate": "2020-04-10T06:38:34Z", "message": "Fix Eth1DataManagerTest."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e53201f1e22b36ad59cc9abbdb6fe4a49a8e1f3a", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/e53201f1e22b36ad59cc9abbdb6fe4a49a8e1f3a", "committedDate": "2020-04-10T06:46:38Z", "message": "Fix genesis generator."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "eb8d006a2fff15213212295cdd892c6c36af4128", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/eb8d006a2fff15213212295cdd892c6c36af4128", "committedDate": "2020-04-10T07:12:37Z", "message": "Remove ResponseRpcDecoderTestWithSaphireTestnetData.java as we're deliberately not compatible with that 0.9.1 data."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "13aebbfcf38a0b2e2f6992bd0a9a3e99e38843d8", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/13aebbfcf38a0b2e2f6992bd0a9a3e99e38843d8", "committedDate": "2020-04-13T23:23:26Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into v0.11.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9415489e731c9aee6f26c74aa53fee8f645e1b17", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/9415489e731c9aee6f26c74aa53fee8f645e1b17", "committedDate": "2020-04-13T23:38:38Z", "message": "Update expected signing roots for SignerTest."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a0952985688c00a90ba5ff52a060671ae3460d57", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/a0952985688c00a90ba5ff52a060671ae3460d57", "committedDate": "2020-04-13T23:48:22Z", "message": "Handle tests adding blocks more than one epoch in the future."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b9ebc86216f96a71ad91deb88695bbddcef2bbe5", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/b9ebc86216f96a71ad91deb88695bbddcef2bbe5", "committedDate": "2020-04-13T23:58:58Z", "message": "Implement equals and hashCode."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cbfc62956e7b805975a3ff0df9a55fb047b6cdb", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/4cbfc62956e7b805975a3ff0df9a55fb047b6cdb", "committedDate": "2020-04-14T00:02:25Z", "message": "Spotless."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "19d4aaac46f75c2ca7a2473561b1cbf8b77ad1ad", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/19d4aaac46f75c2ca7a2473561b1cbf8b77ad1ad", "committedDate": "2020-04-14T01:50:36Z", "message": "Implement get_forkchoice_store."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6d44a7329be080fb7cf5d9b1740344521d52dc64", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/6d44a7329be080fb7cf5d9b1740344521d52dc64", "committedDate": "2020-04-14T02:16:37Z", "message": "Split out helper methods from on_attestation."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d8bda78487c0597eac6dffb8afe8702864eeb4bb", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/d8bda78487c0597eac6dffb8afe8702864eeb4bb", "committedDate": "2020-04-14T02:50:09Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into v0.11.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f8df60ccc68dafee0ade113e11e5545876f34fb8", "author": {"user": {"login": "cemozerr", "name": "Cem Ozer"}}, "url": "https://github.com/ConsenSys/teku/commit/f8df60ccc68dafee0ade113e11e5545876f34fb8", "committedDate": "2020-04-14T17:26:29Z", "message": "Merge branch 'master' into v0.11.1"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMTk2NzMw", "url": "https://github.com/ConsenSys/teku/pull/1572#pullrequestreview-393196730", "createdAt": "2020-04-14T18:40:38Z", "commit": {"oid": "f8df60ccc68dafee0ade113e11e5545876f34fb8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODo0MDozOFrOGFb-4Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODo0MDozOFrOGFb-4Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM1NDUyOQ==", "bodyText": "Seems like these 3 variables could go into the Constants file", "url": "https://github.com/ConsenSys/teku/pull/1572#discussion_r408354529", "createdAt": "2020-04-14T18:40:38Z", "author": {"login": "cemozerr"}, "path": "ethereum/core/src/main/java/tech/pegasys/artemis/core/EpochProcessorUtil.java", "diffHunk": "@@ -612,22 +610,22 @@ public static void process_final_updates(MutableBeaconState state) {\n     for (int index = 0; index < validators.size(); index++) {\n       Validator validator = validators.get(index);\n       UnsignedLong balance = balances.get(index);\n-      long HALF_INCREMENT = Constants.EFFECTIVE_BALANCE_INCREMENT / 2;\n-      if (balance.compareTo(validator.getEffective_balance()) < 0\n-          || validator\n-                  .getEffective_balance()\n-                  .plus(UnsignedLong.valueOf(3 * HALF_INCREMENT))\n-                  .compareTo(balance)\n-              < 0) {\n \n+      final UnsignedLong hysteresis_increment =\n+          EFFECTIVE_BALANCE_INCREMENT.dividedBy(HYSTERESIS_QUOTIENT);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8df60ccc68dafee0ade113e11e5545876f34fb8"}, "originalPosition": 99}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMTk3ODUy", "url": "https://github.com/ConsenSys/teku/pull/1572#pullrequestreview-393197852", "createdAt": "2020-04-14T18:42:12Z", "commit": {"oid": "f8df60ccc68dafee0ade113e11e5545876f34fb8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODo0MjoxMlrOGFcCVQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xNFQxODo0MjoxMlrOGFcCVQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODM1NTQxMw==", "bodyText": "nit:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        forkIfno.getFork(),\n          \n          \n            \n                        forkInfo.getFork(),", "url": "https://github.com/ConsenSys/teku/pull/1572#discussion_r408355413", "createdAt": "2020-04-14T18:42:12Z", "author": {"login": "cemozerr"}, "path": "ethereum/core/src/main/java/tech/pegasys/artemis/core/Signer.java", "diffHunk": "@@ -35,29 +36,49 @@ public Signer(final MessageSignerService signerService) {\n     this.signerService = signerService;\n   }\n \n-  public SafeFuture<BLSSignature> createRandaoReveal(final UnsignedLong epoch, final Fork fork) {\n-    Bytes domain = get_domain(Constants.DOMAIN_RANDAO, epoch, fork);\n+  public SafeFuture<BLSSignature> createRandaoReveal(\n+      final UnsignedLong epoch, final ForkInfo forkIfno) {\n+    Bytes domain =\n+        get_domain(\n+            Constants.DOMAIN_RANDAO,\n+            epoch,\n+            forkIfno.getFork(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f8df60ccc68dafee0ade113e11e5545876f34fb8"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkzMjM0NDgw", "url": "https://github.com/ConsenSys/teku/pull/1572#pullrequestreview-393234480", "createdAt": "2020-04-14T19:34:24Z", "commit": {"oid": "f8df60ccc68dafee0ade113e11e5545876f34fb8"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d0714139f31d4c2ab67bef4910da950f2ec5c06", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/0d0714139f31d4c2ab67bef4910da950f2ec5c06", "committedDate": "2020-04-14T21:01:14Z", "message": "Merge branch 'master' of github.com:PegaSysEng/teku into v0.11.1"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "23bc3836396a57489da3ac18e797741367cfffda", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/23bc3836396a57489da3ac18e797741367cfffda", "committedDate": "2020-04-14T21:04:19Z", "message": "Update schema."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d144c9282d92d437b6883f276f010f1f5e541908", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/d144c9282d92d437b6883f276f010f1f5e541908", "committedDate": "2020-04-14T21:09:12Z", "message": "Spotless."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47ef6d5d959df983348ac8523ac879c8fa2c19c1", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/47ef6d5d959df983348ac8523ac879c8fa2c19c1", "committedDate": "2020-04-15T00:02:45Z", "message": "Fix typo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bb823fb88a589a351b731b7583fd2ebae11ca90", "author": {"user": {"login": "ajsutton", "name": "Adrian Sutton"}}, "url": "https://github.com/ConsenSys/teku/commit/5bb823fb88a589a351b731b7583fd2ebae11ca90", "committedDate": "2020-04-15T01:00:50Z", "message": "Merge branch 'master' into v0.11.1"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4262, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}