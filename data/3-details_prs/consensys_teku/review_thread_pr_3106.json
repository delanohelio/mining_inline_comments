{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTExNzY2MzAw", "number": 3106, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMDozNDoyNFrOEzDVcg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMDo0Njo1OFrOEzDelg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTY3NDc0OnYy", "diffSide": "RIGHT", "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/attestation/AttestationManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMDozNDoyNFrOHqCYXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxODoxMzoxOFrOHra9Sg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0MTI0NA==", "bodyText": "If we already know the attestation should be saved for future, do we need to run it through the attestation processor or can it just be added to the pending pool immediately?", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r513841244", "createdAt": "2020-10-29T00:34:24Z", "author": {"login": "ajsutton"}, "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/attestation/AttestationManager.java", "diffHunk": "@@ -49,38 +52,80 @@\n   private final Subscribers<ProcessedAttestationListener> processedAttestationSubscriber =\n       Subscribers.create(true);\n \n+  private final AttestationValidator attestationValidator;\n+  private final AggregateAttestationValidator aggregateValidator;\n+\n   AttestationManager(\n       final EventBus eventBus,\n       final ForkChoice attestationProcessor,\n       final PendingPool<ValidateableAttestation> pendingAttestations,\n       final FutureItems<ValidateableAttestation> futureAttestations,\n-      final AggregatingAttestationPool aggregatingAttestationPool) {\n+      final AggregatingAttestationPool aggregatingAttestationPool,\n+      final AttestationValidator attestationValidator,\n+      final AggregateAttestationValidator aggregateValidator) {\n     this.eventBus = eventBus;\n     this.attestationProcessor = attestationProcessor;\n     this.pendingAttestations = pendingAttestations;\n     this.futureAttestations = futureAttestations;\n     this.aggregatingAttestationPool = aggregatingAttestationPool;\n+    this.attestationValidator = attestationValidator;\n+    this.aggregateValidator = aggregateValidator;\n   }\n \n   public static AttestationManager create(\n       final EventBus eventBus,\n       final PendingPool<ValidateableAttestation> pendingAttestations,\n       final FutureItems<ValidateableAttestation> futureAttestations,\n       final ForkChoice attestationProcessor,\n-      final AggregatingAttestationPool aggregatingAttestationPool) {\n+      final AggregatingAttestationPool aggregatingAttestationPool,\n+      final AttestationValidator attestationValidator,\n+      final AggregateAttestationValidator aggregateValidator) {\n     return new AttestationManager(\n         eventBus,\n         attestationProcessor,\n         pendingAttestations,\n         futureAttestations,\n-        aggregatingAttestationPool);\n+        aggregatingAttestationPool,\n+        attestationValidator,\n+        aggregateValidator);\n   }\n \n   public void subscribeToProcessedAttestations(\n       ProcessedAttestationListener processedAttestationListener) {\n     processedAttestationSubscriber.subscribe(processedAttestationListener);\n   }\n \n+  public SafeFuture<InternalValidationResult> addAttestation(ValidateableAttestation attestation) {\n+    SafeFuture<InternalValidationResult> validationResult =\n+        attestationValidator.validate(attestation);\n+    processInternallyValidatedAttestation(validationResult, attestation);\n+    return validationResult;\n+  }\n+\n+  public SafeFuture<InternalValidationResult> addAggregate(ValidateableAttestation attestation) {\n+    SafeFuture<InternalValidationResult> validationResult =\n+        aggregateValidator.validate(attestation);\n+    processInternallyValidatedAttestation(validationResult, attestation);\n+    return validationResult;\n+  }\n+\n+  @SuppressWarnings(\"FutureReturnValueIgnored\")\n+  private void processInternallyValidatedAttestation(\n+      SafeFuture<InternalValidationResult> validationResult, ValidateableAttestation attestation) {\n+    validationResult.thenAccept(\n+        internalValidationResult -> {\n+          if (internalValidationResult.equals(InternalValidationResult.ACCEPT)\n+              || internalValidationResult.equals(InternalValidationResult.SAVE_FOR_FUTURE)) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 80}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI5MjQ5MA==", "bodyText": "Made an issue here to solve later on: #3114", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r515292490", "createdAt": "2020-10-30T18:13:18Z", "author": {"login": "cemozerr"}, "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/attestation/AttestationManager.java", "diffHunk": "@@ -49,38 +52,80 @@\n   private final Subscribers<ProcessedAttestationListener> processedAttestationSubscriber =\n       Subscribers.create(true);\n \n+  private final AttestationValidator attestationValidator;\n+  private final AggregateAttestationValidator aggregateValidator;\n+\n   AttestationManager(\n       final EventBus eventBus,\n       final ForkChoice attestationProcessor,\n       final PendingPool<ValidateableAttestation> pendingAttestations,\n       final FutureItems<ValidateableAttestation> futureAttestations,\n-      final AggregatingAttestationPool aggregatingAttestationPool) {\n+      final AggregatingAttestationPool aggregatingAttestationPool,\n+      final AttestationValidator attestationValidator,\n+      final AggregateAttestationValidator aggregateValidator) {\n     this.eventBus = eventBus;\n     this.attestationProcessor = attestationProcessor;\n     this.pendingAttestations = pendingAttestations;\n     this.futureAttestations = futureAttestations;\n     this.aggregatingAttestationPool = aggregatingAttestationPool;\n+    this.attestationValidator = attestationValidator;\n+    this.aggregateValidator = aggregateValidator;\n   }\n \n   public static AttestationManager create(\n       final EventBus eventBus,\n       final PendingPool<ValidateableAttestation> pendingAttestations,\n       final FutureItems<ValidateableAttestation> futureAttestations,\n       final ForkChoice attestationProcessor,\n-      final AggregatingAttestationPool aggregatingAttestationPool) {\n+      final AggregatingAttestationPool aggregatingAttestationPool,\n+      final AttestationValidator attestationValidator,\n+      final AggregateAttestationValidator aggregateValidator) {\n     return new AttestationManager(\n         eventBus,\n         attestationProcessor,\n         pendingAttestations,\n         futureAttestations,\n-        aggregatingAttestationPool);\n+        aggregatingAttestationPool,\n+        attestationValidator,\n+        aggregateValidator);\n   }\n \n   public void subscribeToProcessedAttestations(\n       ProcessedAttestationListener processedAttestationListener) {\n     processedAttestationSubscriber.subscribe(processedAttestationListener);\n   }\n \n+  public SafeFuture<InternalValidationResult> addAttestation(ValidateableAttestation attestation) {\n+    SafeFuture<InternalValidationResult> validationResult =\n+        attestationValidator.validate(attestation);\n+    processInternallyValidatedAttestation(validationResult, attestation);\n+    return validationResult;\n+  }\n+\n+  public SafeFuture<InternalValidationResult> addAggregate(ValidateableAttestation attestation) {\n+    SafeFuture<InternalValidationResult> validationResult =\n+        aggregateValidator.validate(attestation);\n+    processInternallyValidatedAttestation(validationResult, attestation);\n+    return validationResult;\n+  }\n+\n+  @SuppressWarnings(\"FutureReturnValueIgnored\")\n+  private void processInternallyValidatedAttestation(\n+      SafeFuture<InternalValidationResult> validationResult, ValidateableAttestation attestation) {\n+    validationResult.thenAccept(\n+        internalValidationResult -> {\n+          if (internalValidationResult.equals(InternalValidationResult.ACCEPT)\n+              || internalValidationResult.equals(InternalValidationResult.SAVE_FOR_FUTURE)) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0MTI0NA=="}, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 80}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTY3NjQyOnYy", "diffSide": "RIGHT", "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/block/BlockManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMDozNToxMlrOHqCZSA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0zMFQxODoxMzoyM1rOHra9bA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0MTQ4MA==", "bodyText": "Same as for attestations - if it's save for future should we just add it to the pending pool without further processing?", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r513841480", "createdAt": "2020-10-29T00:35:12Z", "author": {"login": "ajsutton"}, "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/block/BlockManager.java", "diffHunk": "@@ -91,6 +98,20 @@ public static BlockManager create(\n     return doImportBlock(block);\n   }\n \n+  @SuppressWarnings(\"FutureReturnValueIgnored\")\n+  public SafeFuture<InternalValidationResult> validateAndImportBlock(\n+      final SignedBeaconBlock block) {\n+    SafeFuture<InternalValidationResult> validationResult = validator.validate(block);\n+    validationResult.thenAccept(\n+        result -> {\n+          if (result.equals(InternalValidationResult.ACCEPT)\n+              || result.equals(InternalValidationResult.SAVE_FOR_FUTURE)) {\n+            importBlock(block).finish(err -> LOG.error(\"Failed to process received block.\", err));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTI5MjUyNA==", "bodyText": "Made an issue here to solve later on: #3114", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r515292524", "createdAt": "2020-10-30T18:13:23Z", "author": {"login": "cemozerr"}, "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/block/BlockManager.java", "diffHunk": "@@ -91,6 +98,20 @@ public static BlockManager create(\n     return doImportBlock(block);\n   }\n \n+  @SuppressWarnings(\"FutureReturnValueIgnored\")\n+  public SafeFuture<InternalValidationResult> validateAndImportBlock(\n+      final SignedBeaconBlock block) {\n+    SafeFuture<InternalValidationResult> validationResult = validator.validate(block);\n+    validationResult.thenAccept(\n+        result -> {\n+          if (result.equals(InternalValidationResult.ACCEPT)\n+              || result.equals(InternalValidationResult.SAVE_FOR_FUTURE)) {\n+            importBlock(block).finish(err -> LOG.error(\"Failed to process received block.\", err));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0MTQ4MA=="}, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 58}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTY3ODQ5OnYy", "diffSide": "RIGHT", "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/validation/AttestationValidator.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMDozNjozMFrOHqCakg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNzozNjozMlrOHqnMmw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0MTgxMA==", "bodyText": "Why did we switch from OptionalInt to Optional<Integer>?  OptionalInt is probably better if it's possible to stick with it.", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r513841810", "createdAt": "2020-10-29T00:36:30Z", "author": {"login": "ajsutton"}, "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/validation/AttestationValidator.java", "diffHunk": "@@ -113,7 +112,8 @@ private InternalValidationResult singleAttestationChecks(final Attestation attes\n   }\n \n   SafeFuture<InternalValidationResult> singleOrAggregateAttestationChecks(\n-      final ValidateableAttestation validateableAttestation, final OptionalInt receivedOnSubnetId) {\n+      final ValidateableAttestation validateableAttestation,\n+      final Optional<Integer> receivedOnSubnetId) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ0NDQ0Mw==", "bodyText": "Reversed.", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r514444443", "createdAt": "2020-10-29T17:36:32Z", "author": {"login": "cemozerr"}, "path": "ethereum/statetransition/src/main/java/tech/pegasys/teku/statetransition/validation/AttestationValidator.java", "diffHunk": "@@ -113,7 +112,8 @@ private InternalValidationResult singleAttestationChecks(final Attestation attes\n   }\n \n   SafeFuture<InternalValidationResult> singleOrAggregateAttestationChecks(\n-      final ValidateableAttestation validateableAttestation, final OptionalInt receivedOnSubnetId) {\n+      final ValidateableAttestation validateableAttestation,\n+      final Optional<Integer> receivedOnSubnetId) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0MTgxMA=="}, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 56}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTY4ODM4OnYy", "diffSide": "RIGHT", "path": "networking/eth2/src/integration-test/java/tech/pegasys/teku/networking/eth2/GossipMessageHandlerIntegrationTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMDo0MTozOFrOHqCgMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNzozNzoxMFrOHqnOLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0MzI1MQ==", "bodyText": "Probably shouldn't make this change as part of this PR.", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r513843251", "createdAt": "2020-10-29T00:41:38Z", "author": {"login": "ajsutton"}, "path": "networking/eth2/src/integration-test/java/tech/pegasys/teku/networking/eth2/GossipMessageHandlerIntegrationTest.java", "diffHunk": "@@ -341,7 +368,7 @@ private NodeManager createNodeManager(final Consumer<Eth2P2PNetworkBuilder> netw\n   }\n \n   public static Stream<Arguments> getEncodings() {\n-    final List<GossipEncoding> encodings = List.of(GossipEncoding.SSZ, GossipEncoding.SSZ_SNAPPY);\n+    final List<GossipEncoding> encodings = List.of(GossipEncoding.SSZ_SNAPPY);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 134}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ0NDg0Ng==", "bodyText": "Reversed.", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r514444846", "createdAt": "2020-10-29T17:37:10Z", "author": {"login": "cemozerr"}, "path": "networking/eth2/src/integration-test/java/tech/pegasys/teku/networking/eth2/GossipMessageHandlerIntegrationTest.java", "diffHunk": "@@ -341,7 +368,7 @@ private NodeManager createNodeManager(final Consumer<Eth2P2PNetworkBuilder> netw\n   }\n \n   public static Stream<Arguments> getEncodings() {\n-    final List<GossipEncoding> encodings = List.of(GossipEncoding.SSZ, GossipEncoding.SSZ_SNAPPY);\n+    final List<GossipEncoding> encodings = List.of(GossipEncoding.SSZ_SNAPPY);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0MzI1MQ=="}, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 134}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTY5NDA3OnYy", "diffSide": "RIGHT", "path": "networking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/gossip/AggregateGossipManager.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMDo0NDo0OVrOHqCjlw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxODoyMjo0NlrOHqpA7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0NDExOQ==", "bodyText": "I don't think we can afford to leave this TODO undone as we'd wind up validating more aggregates than we need to.", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r513844119", "createdAt": "2020-10-29T00:44:49Z", "author": {"login": "ajsutton"}, "path": "networking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/gossip/AggregateGossipManager.java", "diffHunk": "@@ -53,7 +51,8 @@ public void onNewAggregate(final ValidateableAttestation validateableAttestation\n     if (!validateableAttestation.isAggregate() || !validateableAttestation.markGossiped()) {\n       return;\n     }\n-    validator.addSeenAggregate(validateableAttestation);\n+    // TODO: implement adding the on new aggregate to the validator\n+    //    validator.addSeenAggregate(validateableAttestation);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ3NDIyMQ==", "bodyText": "I believe we had put this here in order to make sure we don\u2019t process aggregates that we\u2019ve created ourselves when they do come back at us. Thinking out loud, there should probably be a check for this at a lower level. I\u2019m guessing jvm-libp2p does not deliver messages that we\u2019ve created back to us.\nNevertheless, in case it doesn\u2019t, I added the functionality again. This time, after we process attestations at the AttestationManager, for in-house produced attestations, we call attestation and aggregate validators methods to mark them as seen. I saw no reason for calling .addSeen for aggregates and not for single attestations so I added that as well.", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r514474221", "createdAt": "2020-10-29T18:22:46Z", "author": {"login": "cemozerr"}, "path": "networking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/gossip/AggregateGossipManager.java", "diffHunk": "@@ -53,7 +51,8 @@ public void onNewAggregate(final ValidateableAttestation validateableAttestation\n     if (!validateableAttestation.isAggregate() || !validateableAttestation.markGossiped()) {\n       return;\n     }\n-    validator.addSeenAggregate(validateableAttestation);\n+    // TODO: implement adding the on new aggregate to the validator\n+    //    validator.addSeenAggregate(validateableAttestation);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0NDExOQ=="}, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzIxOTY5ODE0OnYy", "diffSide": "RIGHT", "path": "networking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/gossip/topics/GossipSubValidationUtil.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQwMDo0Njo1OFrOHqCl6A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0yOVQxNzozNzozN1rOHqnPLw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0NDcxMg==", "bodyText": "Probably should be an IllegalArgumentException.", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r513844712", "createdAt": "2020-10-29T00:46:58Z", "author": {"login": "ajsutton"}, "path": "networking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/gossip/topics/GossipSubValidationUtil.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.networking.eth2.gossip.topics;\n+\n+import io.libp2p.core.pubsub.ValidationResult;\n+import tech.pegasys.teku.statetransition.validation.InternalValidationResult;\n+\n+public class GossipSubValidationUtil {\n+\n+  public static ValidationResult fromInternalValidationResult(InternalValidationResult result) {\n+    switch (result) {\n+      case ACCEPT:\n+        return ValidationResult.Valid;\n+      case SAVE_FOR_FUTURE:\n+      case IGNORE:\n+        return ValidationResult.Ignore;\n+      case REJECT:\n+        return ValidationResult.Invalid;\n+      default:\n+        throw new UnsupportedOperationException(\"Unexpected validation result: \" + result);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQ0NTEwMw==", "bodyText": "Donne.", "url": "https://github.com/ConsenSys/teku/pull/3106#discussion_r514445103", "createdAt": "2020-10-29T17:37:37Z", "author": {"login": "cemozerr"}, "path": "networking/eth2/src/main/java/tech/pegasys/teku/networking/eth2/gossip/topics/GossipSubValidationUtil.java", "diffHunk": "@@ -0,0 +1,34 @@\n+/*\n+ * Copyright 2020 ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package tech.pegasys.teku.networking.eth2.gossip.topics;\n+\n+import io.libp2p.core.pubsub.ValidationResult;\n+import tech.pegasys.teku.statetransition.validation.InternalValidationResult;\n+\n+public class GossipSubValidationUtil {\n+\n+  public static ValidationResult fromInternalValidationResult(InternalValidationResult result) {\n+    switch (result) {\n+      case ACCEPT:\n+        return ValidationResult.Valid;\n+      case SAVE_FOR_FUTURE:\n+      case IGNORE:\n+        return ValidationResult.Ignore;\n+      case REJECT:\n+        return ValidationResult.Invalid;\n+      default:\n+        throw new UnsupportedOperationException(\"Unexpected validation result: \" + result);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzg0NDcxMg=="}, "originalCommit": {"oid": "c8b3c3e45f4460e8a01c2c28bb8a3aee6684edcf"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3117, "cost": 1, "resetAt": "2021-11-12T11:57:46Z"}}}