{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzNzE5MDk3", "number": 3118, "title": "update `/eth/v1/beacon/states/{state_id}/finality_checkpoints` to select state more efficiently", "bodyText": "Because states were always being translated to slot, there were efficiencies to be gained by making better use of stored states.\nThere are still times that the slot needs to be used, states like 'head' and 'finalized' are readily accessible and should be retrieved as efficiently as possible.\nSigned-off-by: Paul Harris paul.harris@consensys.net\nDocumentation\n\n I thought about documentation and added the documentation label to this PR if updates are required.", "createdAt": "2020-11-02T00:12:18Z", "url": "https://github.com/ConsenSys/teku/pull/3118", "merged": true, "mergeCommit": {"oid": "3b947cab6c8f9a03549f3e77313bc46797908cd8"}, "closed": true, "closedAt": "2020-11-02T00:28:08Z", "author": {"login": "rolfyone"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYYgUBAH2gAyNTEzNzE5MDk3OjJlNGRlNGJkZDVjODRmNGEzNGU1ZjdmMDUzNWE0NjNjZmI3OGJhNWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYZUMVAFqTUyMTI3ODYxNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2e4de4bdd5c84f4a34e5f7f0535a463cfb78ba5a", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/2e4de4bdd5c84f4a34e5f7f0535a463cfb78ba5a", "committedDate": "2020-11-01T23:24:26Z", "message": "update `/eth/v1/beacon/states/{state_id}/finality_checkpoints` to select state more accurately\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ed8e287a34875ace65a15cd90f90643b7e20afa", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/8ed8e287a34875ace65a15cd90f90643b7e20afa", "committedDate": "2020-11-02T00:14:17Z", "message": "update `/eth/v1/beacon/states/{state_id}/finality_checkpoints` to select state more accurately\n\nSigned-off-by: Paul Harris <paul.harris@consensys.net>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "401c184d6e8fe7fe3a538bdd2b59929c310415b1", "author": {"user": {"login": "rolfyone", "name": "Paul Harris"}}, "url": "https://github.com/ConsenSys/teku/commit/401c184d6e8fe7fe3a538bdd2b59929c310415b1", "committedDate": "2020-11-02T00:16:10Z", "message": "Merge remote-tracking branch 'upstream/master' into state-finality-checkpoints"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMjc4NjE0", "url": "https://github.com/ConsenSys/teku/pull/3118#pullrequestreview-521278614", "createdAt": "2020-11-02T00:18:27Z", "commit": {"oid": "401c184d6e8fe7fe3a538bdd2b59929c310415b1"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwMDoxODoyN1rOHrzaTw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQwMDoxODoyN1rOHrzaTw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY5MzEzNQ==", "bodyText": "Assuming we don't need this because testing for pre-genesis is now just covered by the state selector which would return empty.", "url": "https://github.com/ConsenSys/teku/pull/3118#discussion_r515693135", "createdAt": "2020-11-02T00:18:27Z", "author": {"login": "ajsutton"}, "path": "data/beaconrestapi/src/test/java/tech/pegasys/teku/beaconrestapi/handlers/v1/beacon/GetStateFinalityCheckpointsTest.java", "diffHunk": "@@ -28,42 +26,31 @@\n import tech.pegasys.teku.datastructures.state.BeaconState;\n import tech.pegasys.teku.datastructures.util.DataStructureUtil;\n import tech.pegasys.teku.infrastructure.async.SafeFuture;\n-import tech.pegasys.teku.infrastructure.unsigned.UInt64;\n \n public class GetStateFinalityCheckpointsTest extends AbstractBeaconHandlerTest {\n   final DataStructureUtil dataStructureUtil = new DataStructureUtil();\n   final BeaconState state = dataStructureUtil.randomBeaconState();\n \n-  @Test\n-  public void shouldReturnUnavailableWhenStoreNotAvailable() throws Exception {\n-    final GetStateFinalityCheckpoints handler =\n-        new GetStateFinalityCheckpoints(chainDataProvider, jsonProvider);\n-    when(context.pathParamMap()).thenReturn(Map.of(\"state_id\", \"head\"));\n-    when(chainDataProvider.isStoreAvailable()).thenReturn(false);\n-\n-    handler.handle(context);\n-    verifyStatusCode(SC_NOT_FOUND);\n-  }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "401c184d6e8fe7fe3a538bdd2b59929c310415b1"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3287, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}