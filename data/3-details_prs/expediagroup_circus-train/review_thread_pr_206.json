{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE4NTExMzkw", "number": 206, "reviewThreads": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDowNDo0N1rOE3Pavg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToxNTo0MlrOE7dJCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzU5NzQyOnYy", "diffSide": "RIGHT", "path": "circus-train-core/src/test/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperationTest.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDowNDo0N1rOHweCkQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDowNDo0N1rOHweCkQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU4NTg3Mw==", "bodyText": "these test were wrong cause the \"test\" table object was injected into the real code and then mutated so the test weren't testing what they thought they were testing. Was never failing.", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r520585873", "createdAt": "2020-11-10T14:04:47Z", "author": {"login": "patduin"}, "path": "circus-train-core/src/test/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperationTest.java", "diffHunk": "@@ -55,8 +55,8 @@ public void setUp() throws TException {\n     toTable.setTableName(TO_TABLE_NAME);\n     fromTable.setDbName(FROM_DB_NAME);\n     toTable.setDbName(TO_DB_NAME);\n-    when(client.getTable(FROM_DB_NAME, FROM_TABLE_NAME)).thenReturn(fromTable);\n-    when(client.getTable(TO_DB_NAME, TO_TABLE_NAME)).thenReturn(toTable);\n+    when(client.getTable(FROM_DB_NAME, FROM_TABLE_NAME)).thenReturn(new Table(fromTable));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 17}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzY1OTk2OnYy", "diffSide": "RIGHT", "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "isResolved": false, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDoxODoxNFrOHwepgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToxMzoxNVrOH3HOaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5NTg0MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      .info(\"Alter table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),\n          \n          \n            \n                      .info(\"Renaming table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r520595840", "createdAt": "2020-11-10T14:18:14Z", "author": {"login": "massdosage"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5Njc5Mg==", "bodyText": "Also, shouldn't the first two arguments be the \"from\" values? Same in the log statement below.", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r520596792", "createdAt": "2020-11-10T14:19:24Z", "author": {"login": "massdosage"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5NTg0MA=="}, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5NzU4Ng==", "bodyText": "Alternatively we remove these two new log statements and just keep the one we already had.", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r520597586", "createdAt": "2020-11-10T14:20:25Z", "author": {"login": "massdosage"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5NTg0MA=="}, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 28}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MjEwNQ==", "bodyText": "It's more clear when you actually read the log messages in test and when running CT.", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r527552105", "createdAt": "2020-11-20T09:13:15Z", "author": {"login": "patduin"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5NTg0MA=="}, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 28}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzY2MTAzOnYy", "diffSide": "RIGHT", "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDoxODoyOFrOHweqNA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToxMjozN1rOH3HNBQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5NjAyMA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      .info(\"Alter table {}.{} to {}.{}\", fromDatabaseName, fromTableName, fromTable.getDbName(),\n          \n          \n            \n                      .info(\"Renamed table {}.{} to {}.{}\", fromDatabaseName, fromTableName, fromTable.getDbName(),", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r520596020", "createdAt": "2020-11-10T14:18:28Z", "author": {"login": "massdosage"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),\n+              toTable.getTableName());\n       client.alter_table(toTable.getDbName(), toTableName, toTable);\n-      client.alter_table(fromTable.getDbName(), fromTableName, fromTable);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", fromDatabaseName, fromTableName, fromTable.getDbName(),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 33}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MTc0OQ==", "bodyText": "that's wrong, I kept the \"alter\" but changed to \"Altering\"\nIf you run the tests the logs read like this and are very clear:\n- Renaming table old_db.old_table to new_db.new_table\n- Altering table new_db.new_table to new_db.new_table_delete_me\n- Altering table old_db.old_table to new_db.new_table\n- Dropping table new_db.new_table_delete_me", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r527551749", "createdAt": "2020-11-20T09:12:37Z", "author": {"login": "patduin"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),\n+              toTable.getTableName());\n       client.alter_table(toTable.getDbName(), toTableName, toTable);\n-      client.alter_table(fromTable.getDbName(), fromTableName, fromTable);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", fromDatabaseName, fromTableName, fromTable.getDbName(),", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5NjAyMA=="}, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 33}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzY3MjIyOnYy", "diffSide": "RIGHT", "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDoyMDo0MFrOHwexAA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToxMDo1OVrOH3HJeA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5Nzc2MA==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  LOG.info(\"Drop table {}.{}\", toTable.getDbName(), toDelete);\n          \n          \n            \n                  LOG.info(\"Dropping table {}.{}\", toTable.getDbName(), toDelete);", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r520597760", "createdAt": "2020-11-10T14:20:40Z", "author": {"login": "massdosage"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),\n+              toTable.getTableName());\n       client.alter_table(toTable.getDbName(), toTableName, toTable);\n-      client.alter_table(fromTable.getDbName(), fromTableName, fromTable);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", fromDatabaseName, fromTableName, fromTable.getDbName(),\n+              fromTable.getTableName());\n+      client.alter_table(fromDatabaseName, fromTableName, fromTable);\n     } finally {\n+      LOG.info(\"Drop table {}.{}\", toTable.getDbName(), toDelete);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MDg0MA==", "bodyText": "done", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r527550840", "createdAt": "2020-11-20T09:10:59Z", "author": {"login": "patduin"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", toTable.getDbName(), toTableName, toTable.getDbName(),\n+              toTable.getTableName());\n       client.alter_table(toTable.getDbName(), toTableName, toTable);\n-      client.alter_table(fromTable.getDbName(), fromTableName, fromTable);\n+      LOG\n+          .info(\"Alter table {}.{} to {}.{}\", fromDatabaseName, fromTableName, fromTable.getDbName(),\n+              fromTable.getTableName());\n+      client.alter_table(fromDatabaseName, fromTableName, fromTable);\n     } finally {\n+      LOG.info(\"Drop table {}.{}\", toTable.getDbName(), toDelete);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU5Nzc2MA=="}, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzY5Nzk3OnYy", "diffSide": "RIGHT", "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDoyNTo0NFrOHwfAzQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToxMDo1MVrOH3HJIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYwMTgwNQ==", "bodyText": "Might be worth adding in the comment lines above the logs like we have in Cloverleaf? I find it a bit easier to follow", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r520601805", "createdAt": "2020-11-10T14:25:44Z", "author": {"login": "JayGreeeen"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MDc1NA==", "bodyText": "ok", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r527550754", "createdAt": "2020-11-20T09:10:51Z", "author": {"login": "patduin"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();\n     String toDelete = toTableName + DELETE_ME;\n     try {\n+      fromTable.setDbName(toTable.getDbName());\n       fromTable.setTableName(toTableName);\n       toTable.setTableName(toDelete);\n+      LOG", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYwMTgwNQ=="}, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzI2MzcwNDM3OnYy", "diffSide": "RIGHT", "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0xMFQxNDoyNzowOVrOHwfE4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToxMDo0N1rOH3HI-g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYwMjg1MQ==", "bodyText": "Worth also having String toDatabaseName = toTable.getDbName() ?\ntoTable.getDbName() is called quite a few times", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r520602851", "createdAt": "2020-11-10T14:27:09Z", "author": {"login": "JayGreeeen"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MDcxNA==", "bodyText": "sure", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r527550714", "createdAt": "2020-11-20T09:10:47Z", "author": {"login": "patduin"}, "path": "circus-train-core/src/main/java/com/hotels/bdp/circustrain/core/replica/hive/RenameTableOperation.java", "diffHunk": "@@ -40,20 +40,27 @@ public RenameTableOperation(DropTableService dropTableService) {\n    * renamed.\n    */\n   public void execute(CloseableMetaStoreClient client, Table from, Table to) throws Exception {\n-    LOG\n-        .info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(),\n-            to.getTableName());\n+    LOG.info(\"Renaming table {}.{} to {}.{}\", from.getDbName(), from.getTableName(), to.getDbName(), to.getTableName());\n     Table fromTable = client.getTable(from.getDbName(), from.getTableName());\n     Table toTable = client.getTable(to.getDbName(), to.getTableName());\n+    String fromDatabaseName = fromTable.getDbName();\n     String fromTableName = fromTable.getTableName();\n     String toTableName = toTable.getTableName();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYwMjg1MQ=="}, "originalCommit": {"oid": "0f4027feef3cf970731f8dca5c620873a438b723"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzMwNzc4ODkwOnYy", "diffSide": "RIGHT", "path": "CHANGELOG.md", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToxNTo0MlrOH3HT0A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yMFQwOToyMDowNVrOH3Hdrg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MzQ4OA==", "bodyText": "version number?", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r527553488", "createdAt": "2020-11-20T09:15:42Z", "author": {"login": "JayGreeeen"}, "path": "CHANGELOG.md", "diffHunk": "@@ -1,3 +1,7 @@\n+## [TBD] - TBD", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c9a9720ec99b6e1067465fef6d50212fd022c8fb"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1Mzk2NQ==", "bodyText": "Yup, 16.3.3 I guess?", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r527553965", "createdAt": "2020-11-20T09:16:36Z", "author": {"login": "massdosage"}, "path": "CHANGELOG.md", "diffHunk": "@@ -1,3 +1,7 @@\n+## [TBD] - TBD", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MzQ4OA=="}, "originalCommit": {"oid": "c9a9720ec99b6e1067465fef6d50212fd022c8fb"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1NTQ4Mg==", "bodyText": "can go in next release, this is a \"safety\" fix we're not using different database in Circus Train though.", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r527555482", "createdAt": "2020-11-20T09:19:16Z", "author": {"login": "patduin"}, "path": "CHANGELOG.md", "diffHunk": "@@ -1,3 +1,7 @@\n+## [TBD] - TBD", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MzQ4OA=="}, "originalCommit": {"oid": "c9a9720ec99b6e1067465fef6d50212fd022c8fb"}, "originalPosition": 1}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1NjAxNA==", "bodyText": "OK, fine, just leave it then.", "url": "https://github.com/ExpediaGroup/circus-train/pull/206#discussion_r527556014", "createdAt": "2020-11-20T09:20:05Z", "author": {"login": "massdosage"}, "path": "CHANGELOG.md", "diffHunk": "@@ -1,3 +1,7 @@\n+## [TBD] - TBD", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU1MzQ4OA=="}, "originalCommit": {"oid": "c9a9720ec99b6e1067465fef6d50212fd022c8fb"}, "originalPosition": 1}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3919, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}