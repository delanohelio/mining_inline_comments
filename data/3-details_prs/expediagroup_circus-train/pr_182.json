{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk2Mzg2OTk4", "number": 182, "title": "Disable coveralls for forks", "bodyText": "This change only runs Coveralls for pull requests on non-forked branches. This is because secrets (like the Coveralls repo token) aren't allowed to be shared outside of the org (makes sense) but this was previously failing the build right at the end when trying to send the report to Coveralls as the token for that was missing. So instead what we do is disable the Coveralls report if the secret is missing. I've tested this from a fork and non-fork and it seems to work correctly.", "createdAt": "2020-03-31T14:47:35Z", "url": "https://github.com/ExpediaGroup/circus-train/pull/182", "merged": true, "mergeCommit": {"oid": "b7b046bc9a45de156a3b9f41940df075fb42cdb6"}, "closed": true, "closedAt": "2020-04-02T10:04:43Z", "author": {"login": "massdosage"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTBMBogH2gAyMzk2Mzg2OTk4OmJkOTlkMzU3YWY1ZjQ5MzgzYTZmZmVlZjAzNDk4OTNjOWRmYmI0MmQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcToxThAFqTM4NjI0ODU0Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "bd99d357af5f49383a6ffeef0349893c9dfbb42d", "author": {"user": {"login": "massdosage", "name": "Adrian Woodhead"}}, "url": "https://github.com/ExpediaGroup/circus-train/commit/bd99d357af5f49383a6ffeef0349893c9dfbb42d", "committedDate": "2020-03-31T11:13:41Z", "message": "trim workflow down for testing"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7981fbe99acd74b73f953caa7e736936c0f07fe0", "author": {"user": {"login": "massdosage", "name": "Adrian Woodhead"}}, "url": "https://github.com/ExpediaGroup/circus-train/commit/7981fbe99acd74b73f953caa7e736936c0f07fe0", "committedDate": "2020-03-31T12:45:16Z", "message": "change echo message"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdd24d4e7eede5c698a9c1dc2a3489e9e0885355", "author": {"user": {"login": "massdosage", "name": "Adrian Woodhead"}}, "url": "https://github.com/ExpediaGroup/circus-train/commit/bdd24d4e7eede5c698a9c1dc2a3489e9e0885355", "committedDate": "2020-03-31T14:46:38Z", "message": "attempt at skipping coveralls"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ed46415ae3e192a42d351159b828cbe3c3324e4d", "author": {"user": {"login": "massdosage", "name": "Adrian Woodhead"}}, "url": "https://github.com/ExpediaGroup/circus-train/commit/ed46415ae3e192a42d351159b828cbe3c3324e4d", "committedDate": "2020-03-31T15:15:00Z", "message": "re-enable mvn command to test coveralls from non-forked branch"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c61400ddb01dcede827564e641a71b3912c628e2", "author": {"user": {"login": "massdosage", "name": "Adrian Woodhead"}}, "url": "https://github.com/ExpediaGroup/circus-train/commit/c61400ddb01dcede827564e641a71b3912c628e2", "committedDate": "2020-03-31T15:58:54Z", "message": "remove whitespace"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MDI0MjIw", "url": "https://github.com/ExpediaGroup/circus-train/pull/182#pullrequestreview-385024220", "createdAt": "2020-03-31T19:06:50Z", "commit": {"oid": "c61400ddb01dcede827564e641a71b3912c628e2"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxOTowNjo1MFrOF-kJlQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxOTowNjo1MFrOF-kJlQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE0ODMwOQ==", "bodyText": "Was a bit unfamiliar with how github handled passing dynamic variables in between build steps in a workflow. Interesting that they went this log syntax: https://help.github.com/en/actions/reference/workflow-commands-for-github-actions#setting-an-environment-variable", "url": "https://github.com/ExpediaGroup/circus-train/pull/182#discussion_r401148309", "createdAt": "2020-03-31T19:06:50Z", "author": {"login": "KenFigueiredo"}, "path": ".github/workflows/main.yml", "diffHunk": "@@ -10,9 +10,22 @@ jobs:\n     - uses: actions/checkout@v2\n       with:\n         fetch-depth: 0\n+    - name: Init Coveralls\n+      shell: bash\n+      run: |\n+          COVERALLS_TOKEN=${{ secrets.COVERALLS_REPO_TOKEN }}\n+          if [[ -z \"${COVERALLS_TOKEN}\" ]];\n+          then\n+             echo \"Coveralls token not available\"\n+             COVERALLS_SKIP=true\n+          else\n+             echo \"Coveralls token available\"\n+             COVERALLS_SKIP=false\n+          fi\n+          echo ::set-env name=COVERALLS_SKIP::${COVERALLS_SKIP}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c61400ddb01dcede827564e641a71b3912c628e2"}, "originalPosition": 16}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MDI4MDM2", "url": "https://github.com/ExpediaGroup/circus-train/pull/182#pullrequestreview-385028036", "createdAt": "2020-03-31T19:12:33Z", "commit": {"oid": "c61400ddb01dcede827564e641a71b3912c628e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MjI3MTgw", "url": "https://github.com/ExpediaGroup/circus-train/pull/182#pullrequestreview-386227180", "createdAt": "2020-04-02T08:52:49Z", "commit": {"oid": "c61400ddb01dcede827564e641a71b3912c628e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg2MjQ4NTQy", "url": "https://github.com/ExpediaGroup/circus-train/pull/182#pullrequestreview-386248542", "createdAt": "2020-04-02T09:20:42Z", "commit": {"oid": "c61400ddb01dcede827564e641a71b3912c628e2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3800, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}