{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0MjcxODIy", "number": 8025, "title": "Fix 8007", "bodyText": "Backend changes for #8007", "createdAt": "2020-11-02T19:29:49Z", "url": "https://github.com/cBioPortal/cbioportal/pull/8025", "merged": true, "mergeCommit": {"oid": "497e2cb9134f1f51286ad49cc2c5a80cc9f29d9f"}, "closed": true, "closedAt": "2020-11-06T18:28:25Z", "author": {"login": "kalletlak"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYquphgBqjM5NDk5Nzc2NjY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZnD3sAFqTUyNDU2NTE5NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c6ce15dce0739001b610c4b17b282b30202d014", "author": {"user": {"login": "kalletlak", "name": "Karthik K"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/4c6ce15dce0739001b610c4b17b282b30202d014", "committedDate": "2020-11-02T19:28:43Z", "message": "Use both gene1 and gene2 for calculating structural variants counts"}, "afterCommit": {"oid": "b6d5d5066647abc07ae0368906d4a284cf6766b9", "author": {"user": {"login": "kalletlak", "name": "Karthik K"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/b6d5d5066647abc07ae0368906d4a284cf6766b9", "committedDate": "2020-11-02T20:36:43Z", "message": "Use both gene1 and gene2 for calculating structural variants counts"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3e1335af9cb164e4dcb1d99118e01df44f75096", "author": {"user": {"login": "kalletlak", "name": "Karthik K"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/f3e1335af9cb164e4dcb1d99118e01df44f75096", "committedDate": "2020-11-03T20:22:30Z", "message": "Use both gene1 and gene2 for calculating structural variants counts"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b6d5d5066647abc07ae0368906d4a284cf6766b9", "author": {"user": {"login": "kalletlak", "name": "Karthik K"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/b6d5d5066647abc07ae0368906d4a284cf6766b9", "committedDate": "2020-11-02T20:36:43Z", "message": "Use both gene1 and gene2 for calculating structural variants counts"}, "afterCommit": {"oid": "f3e1335af9cb164e4dcb1d99118e01df44f75096", "author": {"user": {"login": "kalletlak", "name": "Karthik K"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/f3e1335af9cb164e4dcb1d99118e01df44f75096", "committedDate": "2020-11-03T20:22:30Z", "message": "Use both gene1 and gene2 for calculating structural variants counts"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NTY1MTk0", "url": "https://github.com/cBioPortal/cbioportal/pull/8025#pullrequestreview-524565194", "createdAt": "2020-11-05T18:50:26Z", "commit": {"oid": "f3e1335af9cb164e4dcb1d99118e01df44f75096"}, "state": "APPROVED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxODo1MDoyNlrOHuRj-A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wNVQxODo1NToxNVrOHuRvGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI4NDI4MA==", "bodyText": "Where is this SUMMARY coming from? Why isn't this a constant?", "url": "https://github.com/cBioPortal/cbioportal/pull/8025#discussion_r518284280", "createdAt": "2020-11-05T18:50:26Z", "author": {"login": "Luke-Sikina"}, "path": "service/src/main/java/org/cbioportal/service/util/MutationMapperUtils.java", "diffHunk": "@@ -90,12 +101,16 @@\n                             } else {\n                                 try {\n                                     Gene site2Gene = geneService.getGene(site2GeneSymbol);\n-                                    if (site2Gene != null) {\n-                                        structuralVariant.setSite2EntrezGeneId(site2Gene.getGeneticEntityId());\n-                                        structuralVariant.setSite2HugoSymbol(site2Gene.getHugoGeneSymbol());\n-                                    }\n+                                    structuralVariant.setSite2EntrezGeneId(site2Gene.getEntrezGeneId());\n+                                    structuralVariant.setSite2HugoSymbol(site2Gene.getHugoGeneSymbol());\n                                 } catch (Exception e) {\n-                                    // Site2 gene is not set when gene symbol is not found in database\n+                                    // Site2 gene is not set when gene symbol is not found in database. Check if it is an alias\n+                                    List<Gene> aliasGenes = geneService.getAllGenes(null, site2GeneSymbol, \"SUMMARY\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3e1335af9cb164e4dcb1d99118e01df44f75096"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI4NTg5Nw==", "bodyText": "So what was molecularAlterationFilterType doing here? It looks like it was doing absolutely nothing - is that correct?", "url": "https://github.com/cBioPortal/cbioportal/pull/8025#discussion_r518285897", "createdAt": "2020-11-05T18:53:07Z", "author": {"login": "Luke-Sikina"}, "path": "web/src/main/java/org/cbioportal/web/util/StudyViewFilterApplier.java", "diffHunk": "@@ -272,8 +271,7 @@ public SampleIdentifier apply(Sample sample) {\n     }\n \n     private List<SampleIdentifier> filterMutatedGenes(List<GeneFilter> mutatedGenefilters,\n-            Map<String, MolecularProfile> molecularProfileMap, MolecularAlterationType molecularAlterationFilterType,\n-            List<SampleIdentifier> sampleIdentifiers) {\n+            Map<String, MolecularProfile> molecularProfileMap, List<SampleIdentifier> sampleIdentifiers) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3e1335af9cb164e4dcb1d99118e01df44f75096"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI4NzEzMQ==", "bodyText": "We should probably document these changes with a unit test or two.", "url": "https://github.com/cBioPortal/cbioportal/pull/8025#discussion_r518287131", "createdAt": "2020-11-05T18:55:15Z", "author": {"login": "Luke-Sikina"}, "path": "service/src/main/java/org/cbioportal/service/impl/MolecularProfileServiceImpl.java", "diffHunk": "@@ -163,18 +163,17 @@ public BaseMeta getMetaMolecularProfilesInStudies(List<String> studyIds) {\n \n         //TODO: remove mutation profile once fusions are migrated to structural variant in the database\n         getMolecularProfilesInStudies(studyIds, \"SUMMARY\").stream().forEach(molecularProfile -> {\n-            if (!mapByStudyId.containsKey(molecularProfile.getCancerStudyIdentifier())) {\n-                if (molecularProfile.getMolecularAlterationType()\n-                        .equals(MolecularProfile.MolecularAlterationType.MUTATION_EXTENDED)\n-                        || (molecularProfile.getMolecularAlterationType()\n-                                .equals(MolecularProfile.MolecularAlterationType.STRUCTURAL_VARIANT)\n-                                && molecularProfile.getDatatype() == \"SV\")) {\n+            if (molecularProfile.getMolecularAlterationType().equals(MolecularProfile.MolecularAlterationType.FUSION)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f3e1335af9cb164e4dcb1d99118e01df44f75096"}, "originalPosition": 10}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1573, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}