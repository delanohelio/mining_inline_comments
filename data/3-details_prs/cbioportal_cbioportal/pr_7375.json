{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNTc1NDc3", "number": 7375, "title": "Fix mouse seed database exception", "bodyText": "Fix #7372.\nresources/gene_symbol_disambiguation.txt is human specific. When running a mouse portal, there will be a run time exception. This PR is to fix the run time exception.\nChecks\n\n Runs on heroku\n Has tests or has a separate issue that describes the types of test that should be created. If no test is included it should explicitly be mentioned in the PR why there is no test.\n The commit log is comprehensible. It follows 7 rules of great commit messages. For most PRs a single commit should suffice, in some cases multiple topical commits can be useful. During review it is ok to see tiny commits (e.g. Fix reviewer comments), but right before the code gets merged to master or rc branch, any such commits should be squashed since they are useless to the other developers. Definitely avoid merge commits, use rebase instead.\n Is this PR adding logic based on one or more clinical attributes? If yes, please make sure validation for this attribute is also present in the data validation / data loading layers (in backend repo) and documented in File-Formats Clinical data section!\n\nAny screenshots or GIFs?\nIf this is a new visual feature please add a before/after screenshot or gif\nhere with e.g. Giphy CAPTURE or Peek\nNotify reviewers\nRead our Pull request merging\npolicy. It can help to figure out who worked on the\nfile before you. Please use git blame <filename> to determine that\nand notify them either through slack or by assigning them as a reviewer on the PR", "createdAt": "2020-04-09T18:22:20Z", "url": "https://github.com/cBioPortal/cbioportal/pull/7375", "merged": true, "mergeCommit": {"oid": "893d717c755213bea5cc13f02daca3f49cff77a4"}, "closed": true, "closedAt": "2020-04-27T20:18:15Z", "author": {"login": "jjgao"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWAshpgH2gAyNDAxNTc1NDc3OmY3NDY4ZGMzY2Y3YzcyMDI5MTljMTc5YTc3MjYwNzA2ZWExMmJiY2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcb1IU3AFqTQwMTI5MjgwMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce", "author": {"user": {"login": "jjgao", "name": "JianJiong Gao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/f7468dc3cf7c7202919c179a77260706ea12bbce", "committedDate": "2020-04-09T18:21:03Z", "message": "Update DaoGeneOptimized.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNTYyMTUx", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#pullrequestreview-391562151", "createdAt": "2020-04-10T17:26:09Z", "commit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNzoyNjowOVrOGEAr1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNzoyNjowOVrOGEAr1w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjg1ODcxMQ==", "bodyText": "Just curious, are Exceptions besides IOException thrown here?", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#discussion_r406858711", "createdAt": "2020-04-10T17:26:09Z", "author": {"login": "n1zea144"}, "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "diffHunk": "@@ -95,11 +95,12 @@ private synchronized void fillCache() {\n                 if (gene==null) {\n                     ProgressMonitor.logWarning(line+\" in config file [resources\" + GENE_SYMBOL_DISAMBIGUATION_FILE +\n                             \"]is not valid. You should either update this file or update the `gene` and `gene_alias` tables to fix this.\");\n+                } else {\n+                    disambiguousGenes.put(parts[0], gene);\n                 }\n-                disambiguousGenes.put(parts[0], gene);\n             }\n             in.close();\n-        } catch(IOException e) {\n+        } catch(Exception e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3Mzc2ODY4", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#pullrequestreview-397376868", "createdAt": "2020-04-21T14:18:00Z", "commit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNDoxODowMFrOGJIQEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNToyMTo1M1rOGJLpAg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIyNTU1Mw==", "bodyText": "This is a good fix. It would not make sense to put pairs of <\"GENEID\", null> into the disambiguousGenes map.", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#discussion_r412225553", "createdAt": "2020-04-21T14:18:00Z", "author": {"login": "sheridancbio"}, "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "diffHunk": "@@ -95,11 +95,12 @@ private synchronized void fillCache() {\n                 if (gene==null) {\n                     ProgressMonitor.logWarning(line+\" in config file [resources\" + GENE_SYMBOL_DISAMBIGUATION_FILE +\n                             \"]is not valid. You should either update this file or update the `gene` and `gene_alias` tables to fix this.\");\n+                } else {\n+                    disambiguousGenes.put(parts[0], gene);\n                 }\n-                disambiguousGenes.put(parts[0], gene);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI4MTA5MA==", "bodyText": "@jjgao : Is the runtime exception caused because the file gene_symbol_disambiguation.txt does not exist? (that is the only additional problem with a mouse portal I can imagine). If that is the case, I think it would be better to add a check for that condition. Something like:\ntry {\nif (GENE_SYMBOL_DISAMBIGUATION_FILE == null) {\nProgressMonitor.logWarning(\"gene disambiguation file not defined - leaving gene disambiguation map empty.\");\nreturn;\n}\nInputStream disambiguationStream = getClass().getResourceAsStream(GENE_SYMBOL_DISAMBIGUATION_FILE);\nif (disambiguationStream == null) {\nProgressMonitor.logWarning(\"file \" + GENE_SYMBOL_DISAMBIGUATION_FILE + \" not present - leaving gene disambiguation map empty.\");\nreturn;\n}\nBufferedReader in = new BufferedReader(new InputStreamReader(disambiguationStream));\n...\nA blanket \"log exception but continue\" approach makes bug detection harder in the future.", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#discussion_r412281090", "createdAt": "2020-04-21T15:21:53Z", "author": {"login": "sheridancbio"}, "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "diffHunk": "@@ -95,11 +95,12 @@ private synchronized void fillCache() {\n                 if (gene==null) {\n                     ProgressMonitor.logWarning(line+\" in config file [resources\" + GENE_SYMBOL_DISAMBIGUATION_FILE +\n                             \"]is not valid. You should either update this file or update the `gene` and `gene_alias` tables to fix this.\");\n+                } else {\n+                    disambiguousGenes.put(parts[0], gene);\n                 }\n-                disambiguousGenes.put(parts[0], gene);\n             }\n             in.close();\n-        } catch(IOException e) {\n+        } catch(Exception e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjg1ODcxMQ=="}, "originalCommit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "originalPosition": 11}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "072d72dfcbd6b2c2ec8aa74470c4b065e0889f25", "author": {"user": {"login": "jjgao", "name": "JianJiong Gao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/072d72dfcbd6b2c2ec8aa74470c4b065e0889f25", "committedDate": "2020-04-24T18:22:36Z", "message": "Update DaoGeneOptimized.java"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDAxMjkyODAx", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#pullrequestreview-401292801", "createdAt": "2020-04-27T20:16:06Z", "commit": {"oid": "072d72dfcbd6b2c2ec8aa74470c4b065e0889f25"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1753, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}