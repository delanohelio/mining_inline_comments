{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxNTc1NDc3", "number": 7375, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNzoyNjowOVrODwzyWg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNDoxODowMFrOD0RRWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjUyNTA2NzE0OnYy", "diffSide": "RIGHT", "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNzoyNjowOVrOGEAr1w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMlQyMjoyNToxOFrOGKOXYw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjg1ODcxMQ==", "bodyText": "Just curious, are Exceptions besides IOException thrown here?", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#discussion_r406858711", "createdAt": "2020-04-10T17:26:09Z", "author": {"login": "n1zea144"}, "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "diffHunk": "@@ -95,11 +95,12 @@ private synchronized void fillCache() {\n                 if (gene==null) {\n                     ProgressMonitor.logWarning(line+\" in config file [resources\" + GENE_SYMBOL_DISAMBIGUATION_FILE +\n                             \"]is not valid. You should either update this file or update the `gene` and `gene_alias` tables to fix this.\");\n+                } else {\n+                    disambiguousGenes.put(parts[0], gene);\n                 }\n-                disambiguousGenes.put(parts[0], gene);\n             }\n             in.close();\n-        } catch(IOException e) {\n+        } catch(Exception e) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjg4ODY2NQ==", "bodyText": "There was a RuntimeException, but should be fixed with the fix above.\nJust trying to cast a wider net since not being able to load the disambiguate file is not critical issue and shouldn't bring down the application.", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#discussion_r406888665", "createdAt": "2020-04-10T18:38:17Z", "author": {"login": "jjgao"}, "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "diffHunk": "@@ -95,11 +95,12 @@ private synchronized void fillCache() {\n                 if (gene==null) {\n                     ProgressMonitor.logWarning(line+\" in config file [resources\" + GENE_SYMBOL_DISAMBIGUATION_FILE +\n                             \"]is not valid. You should either update this file or update the `gene` and `gene_alias` tables to fix this.\");\n+                } else {\n+                    disambiguousGenes.put(parts[0], gene);\n                 }\n-                disambiguousGenes.put(parts[0], gene);\n             }\n             in.close();\n-        } catch(IOException e) {\n+        } catch(Exception e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjg1ODcxMQ=="}, "originalCommit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI4MTA5MA==", "bodyText": "@jjgao : Is the runtime exception caused because the file gene_symbol_disambiguation.txt does not exist? (that is the only additional problem with a mouse portal I can imagine). If that is the case, I think it would be better to add a check for that condition. Something like:\ntry {\nif (GENE_SYMBOL_DISAMBIGUATION_FILE == null) {\nProgressMonitor.logWarning(\"gene disambiguation file not defined - leaving gene disambiguation map empty.\");\nreturn;\n}\nInputStream disambiguationStream = getClass().getResourceAsStream(GENE_SYMBOL_DISAMBIGUATION_FILE);\nif (disambiguationStream == null) {\nProgressMonitor.logWarning(\"file \" + GENE_SYMBOL_DISAMBIGUATION_FILE + \" not present - leaving gene disambiguation map empty.\");\nreturn;\n}\nBufferedReader in = new BufferedReader(new InputStreamReader(disambiguationStream));\n...\nA blanket \"log exception but continue\" approach makes bug detection harder in the future.", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#discussion_r412281090", "createdAt": "2020-04-21T15:21:53Z", "author": {"login": "sheridancbio"}, "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "diffHunk": "@@ -95,11 +95,12 @@ private synchronized void fillCache() {\n                 if (gene==null) {\n                     ProgressMonitor.logWarning(line+\" in config file [resources\" + GENE_SYMBOL_DISAMBIGUATION_FILE +\n                             \"]is not valid. You should either update this file or update the `gene` and `gene_alias` tables to fix this.\");\n+                } else {\n+                    disambiguousGenes.put(parts[0], gene);\n                 }\n-                disambiguousGenes.put(parts[0], gene);\n             }\n             in.close();\n-        } catch(IOException e) {\n+        } catch(Exception e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjg1ODcxMQ=="}, "originalCommit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM3Mzc0NA==", "bodyText": "No it was b/c the entrez IDs in the file are human IDs and therefore do not exist in mouse genes, ie. gene==NULL. As a result, disambiguousGenes.put(parts[0], gene); throws runtime exception.", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#discussion_r413373744", "createdAt": "2020-04-22T22:24:01Z", "author": {"login": "jjgao"}, "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "diffHunk": "@@ -95,11 +95,12 @@ private synchronized void fillCache() {\n                 if (gene==null) {\n                     ProgressMonitor.logWarning(line+\" in config file [resources\" + GENE_SYMBOL_DISAMBIGUATION_FILE +\n                             \"]is not valid. You should either update this file or update the `gene` and `gene_alias` tables to fix this.\");\n+                } else {\n+                    disambiguousGenes.put(parts[0], gene);\n                 }\n-                disambiguousGenes.put(parts[0], gene);\n             }\n             in.close();\n-        } catch(IOException e) {\n+        } catch(Exception e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjg1ODcxMQ=="}, "originalCommit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzM3NDMwNw==", "bodyText": "I am ok to revert this one as long as we get the change to line 99 in :)", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#discussion_r413374307", "createdAt": "2020-04-22T22:25:18Z", "author": {"login": "jjgao"}, "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "diffHunk": "@@ -95,11 +95,12 @@ private synchronized void fillCache() {\n                 if (gene==null) {\n                     ProgressMonitor.logWarning(line+\" in config file [resources\" + GENE_SYMBOL_DISAMBIGUATION_FILE +\n                             \"]is not valid. You should either update this file or update the `gene` and `gene_alias` tables to fix this.\");\n+                } else {\n+                    disambiguousGenes.put(parts[0], gene);\n                 }\n-                disambiguousGenes.put(parts[0], gene);\n             }\n             in.close();\n-        } catch(IOException e) {\n+        } catch(Exception e) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjg1ODcxMQ=="}, "originalCommit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjU2MTM1NTEzOnYy", "diffSide": "LEFT", "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNDoxODowMFrOGJIQEQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0yMVQxNDoxODowMFrOGJIQEQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIyNTU1Mw==", "bodyText": "This is a good fix. It would not make sense to put pairs of <\"GENEID\", null> into the disambiguousGenes map.", "url": "https://github.com/cBioPortal/cbioportal/pull/7375#discussion_r412225553", "createdAt": "2020-04-21T14:18:00Z", "author": {"login": "sheridancbio"}, "path": "core/src/main/java/org/mskcc/cbio/portal/dao/DaoGeneOptimized.java", "diffHunk": "@@ -95,11 +95,12 @@ private synchronized void fillCache() {\n                 if (gene==null) {\n                     ProgressMonitor.logWarning(line+\" in config file [resources\" + GENE_SYMBOL_DISAMBIGUATION_FILE +\n                             \"]is not valid. You should either update this file or update the `gene` and `gene_alias` tables to fix this.\");\n+                } else {\n+                    disambiguousGenes.put(parts[0], gene);\n                 }\n-                disambiguousGenes.put(parts[0], gene);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f7468dc3cf7c7202919c179a77260706ea12bbce"}, "originalPosition": 7}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3623, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}