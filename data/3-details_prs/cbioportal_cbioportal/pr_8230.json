{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQ0MTk1NDc5", "number": 8230, "title": "Study-view: Fix bug in genefilter applier", "bodyText": "Fix #8226", "createdAt": "2020-12-22T15:31:55Z", "url": "https://github.com/cBioPortal/cbioportal/pull/8230", "merged": true, "mergeCommit": {"oid": "e6c741019480c5295464e451dcc9518f3431be64"}, "closed": true, "closedAt": "2020-12-23T15:41:58Z", "author": {"login": "kalletlak"}, "timelineItems": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdostx9AFqTU1NzE4MTAxOQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdotVSRgBqjQxNDA5Mjk1MjY=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTU3MTgxMDE5", "url": "https://github.com/cBioPortal/cbioportal/pull/8230#pullrequestreview-557181019", "createdAt": "2020-12-22T15:54:01Z", "commit": {"oid": "6f9061b10d14958337c733cadf57bbd392a4c03f"}, "state": "APPROVED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNTo1NDowMVrOIJ_8RQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMlQxNTo1ODo0MVrOIKAHHQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM1NTcxNw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                .filter(molecularProfileId -> molecularProfileMap.containsKey(molecularProfileId))\n          \n          \n            \n                                .map(molecularProfileId -> molecularProfileMap.get(molecularProfileId))\n          \n          \n            \n                                .filter(molecularProfileMap::containsKey)\n          \n          \n            \n                                .map(molecularProfileMap::get)", "url": "https://github.com/cBioPortal/cbioportal/pull/8230#discussion_r547355717", "createdAt": "2020-12-22T15:54:01Z", "author": {"login": "Luke-Sikina"}, "path": "web/src/main/java/org/cbioportal/web/util/StudyViewFilterApplier.java", "diffHunk": "@@ -414,14 +414,24 @@ private void splitGeneFiltersByMolecularAlterationType(List<GeneFilter> genefilt\n         for (GeneFilter genefilter : genefilters) {\n \n             List<MolecularProfile> filteredMolecularProfiles = genefilter.getMolecularProfileIds().stream()\n+                    // need this filter criteria since profile id might be present\n+                    // in filter but the study might already been filtered out\n+                    .filter(molecularProfileId -> molecularProfileMap.containsKey(molecularProfileId))\n                     .map(molecularProfileId -> molecularProfileMap.get(molecularProfileId))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f9061b10d14958337c733cadf57bbd392a4c03f"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzM1ODQ5Mw==", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                .map(molecularProfile -> molecularProfile.getStableId())\n          \n          \n            \n                                .map(MolecularProfile::getStableId)", "url": "https://github.com/cBioPortal/cbioportal/pull/8230#discussion_r547358493", "createdAt": "2020-12-22T15:58:41Z", "author": {"login": "Luke-Sikina"}, "path": "web/src/main/java/org/cbioportal/web/util/StudyViewFilterApplier.java", "diffHunk": "@@ -414,14 +414,24 @@ private void splitGeneFiltersByMolecularAlterationType(List<GeneFilter> genefilt\n         for (GeneFilter genefilter : genefilters) {\n \n             List<MolecularProfile> filteredMolecularProfiles = genefilter.getMolecularProfileIds().stream()\n+                    // need this filter criteria since profile id might be present\n+                    // in filter but the study might already been filtered out\n+                    .filter(molecularProfileId -> molecularProfileMap.containsKey(molecularProfileId))\n                     .map(molecularProfileId -> molecularProfileMap.get(molecularProfileId))\n                     .collect(Collectors.toList());\n \n             Set<MolecularAlterationType> alterationTypes = filteredMolecularProfiles.stream()\n-                    .map(MolecularProfile::getMolecularAlterationType).collect(Collectors.toSet());\n+                    .map(MolecularProfile::getMolecularAlterationType)\n+                    .collect(Collectors.toSet());\n \n             Set<String> dataTypes = filteredMolecularProfiles.stream().map(MolecularProfile::getDatatype)\n                     .collect(Collectors.toSet());\n+            \n+            Set<String> filteredMolecularProfileIds = filteredMolecularProfiles\n+                    .stream()\n+                    .map(molecularProfile -> molecularProfile.getStableId())", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "6f9061b10d14958337c733cadf57bbd392a4c03f"}, "originalPosition": 20}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a4bf7d4f3aab9cd561b208b92f3825aa98339aa6", "author": {"user": {"login": "kalletlak", "name": "Karthik K"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/a4bf7d4f3aab9cd561b208b92f3825aa98339aa6", "committedDate": "2020-12-22T16:42:27Z", "message": "Study-view: Fix bug in genefilter applier"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f9061b10d14958337c733cadf57bbd392a4c03f", "author": {"user": {"login": "kalletlak", "name": "Karthik K"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/6f9061b10d14958337c733cadf57bbd392a4c03f", "committedDate": "2020-12-22T15:30:51Z", "message": "Study-view: Fix bug in genefilter applier"}, "afterCommit": {"oid": "a4bf7d4f3aab9cd561b208b92f3825aa98339aa6", "author": {"user": {"login": "kalletlak", "name": "Karthik K"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/a4bf7d4f3aab9cd561b208b92f3825aa98339aa6", "committedDate": "2020-12-22T16:42:27Z", "message": "Study-view: Fix bug in genefilter applier"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1604, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}