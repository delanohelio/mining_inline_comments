{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgzMTI4OTcw", "number": 7259, "title": "updating database schema for resource feature", "bodyText": "Fix #7234", "createdAt": "2020-03-03T19:20:45Z", "url": "https://github.com/cBioPortal/cbioportal/pull/7259", "merged": true, "mergeCommit": {"oid": "8a95eec3ded1c03c2a53b66ba6a0ed7f99696a8f"}, "closed": true, "closedAt": "2020-03-09T20:08:14Z", "author": {"login": "dippindots"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcKJDw_gFqTM2ODMzMTQ2MA==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcLGNDMAFqTM3MDYwODUxMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MzMxNDYw", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#pullrequestreview-368331460", "createdAt": "2020-03-03T21:18:35Z", "commit": {"oid": "b1ec4ceb008a8f725a20f4b862524a1df119e616"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4MzQxMzkw", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#pullrequestreview-368341390", "createdAt": "2020-03-03T21:34:38Z", "commit": {"oid": "b1ec4ceb008a8f725a20f4b862524a1df119e616"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QyMTozNDozOVrOFxXWBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QyMTozNjoyN1rOFxXZYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMwNzAxMg==", "bodyText": "may be declare it as enum\nRESOURCE_TYPE ENUM('STUDY', 'PATIENT', 'SAMPLE') NOT NULL,", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r387307012", "createdAt": "2020-03-03T21:34:39Z", "author": {"login": "kalletlak"}, "path": "db-scripts/src/main/resources/cgds.sql", "diffHunk": "@@ -865,5 +869,46 @@ CREATE TABLE `info` (\n   `DB_SCHEMA_VERSION` varchar(24),\n   `GENESET_VERSION` varchar(24)\n );\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) NOT NULL,\n+  `DESCRIPTION` varchar(2048) NOT NULL,\n+  `RESOURCE_TYPE` varchar(255) NOT NULL COMMENT 'STUDY, PATIENT or SAMPLE',", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ec4ceb008a8f725a20f4b862524a1df119e616"}, "originalPosition": 21}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMwNzg3Mg==", "bodyText": "@adamabeshouse just want to confirm that there won't be a duplicate RESOURCE_ID for different types within a study", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r387307872", "createdAt": "2020-03-03T21:36:27Z", "author": {"login": "kalletlak"}, "path": "db-scripts/src/main/resources/cgds.sql", "diffHunk": "@@ -865,5 +869,46 @@ CREATE TABLE `info` (\n   `DB_SCHEMA_VERSION` varchar(24),\n   `GENESET_VERSION` varchar(24)\n );\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) NOT NULL,\n+  `DESCRIPTION` varchar(2048) NOT NULL,\n+  `RESOURCE_TYPE` varchar(255) NOT NULL COMMENT 'STUDY, PATIENT or SAMPLE',\n+  `OPEN_BY_DEFAULT` BOOLEAN NOT NULL,\n+  `PRIORITY` int(11) NOT NULL,\n+  `CANCER_STUDY_ID` int(11) NOT NULL,\n+  PRIMARY KEY (`RESOURCE_ID`,`CANCER_STUDY_ID`),", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ec4ceb008a8f725a20f4b862524a1df119e616"}, "originalPosition": 25}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY4ODQ1NjI3", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#pullrequestreview-368845627", "createdAt": "2020-03-04T14:55:31Z", "commit": {"oid": "b1ec4ceb008a8f725a20f4b862524a1df119e616"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNDo1NTozMVrOFxweCA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQxNDo1NTozMVrOFxweCA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzcxODY2NA==", "bodyText": "set default value to false(0)", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r387718664", "createdAt": "2020-03-04T14:55:31Z", "author": {"login": "kalletlak"}, "path": "db-scripts/src/main/resources/cgds.sql", "diffHunk": "@@ -865,5 +869,46 @@ CREATE TABLE `info` (\n   `DB_SCHEMA_VERSION` varchar(24),\n   `GENESET_VERSION` varchar(24)\n );\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) NOT NULL,\n+  `DESCRIPTION` varchar(2048) NOT NULL,\n+  `RESOURCE_TYPE` varchar(255) NOT NULL COMMENT 'STUDY, PATIENT or SAMPLE',\n+  `OPEN_BY_DEFAULT` BOOLEAN NOT NULL,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b1ec4ceb008a8f725a20f4b862524a1df119e616"}, "originalPosition": 22}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b1ec4ceb008a8f725a20f4b862524a1df119e616", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/b1ec4ceb008a8f725a20f4b862524a1df119e616", "committedDate": "2020-03-03T19:18:10Z", "message": "update resources schema"}, "afterCommit": {"oid": "16bd41483886fd183bd98a189bd2e31f48d9f7b7", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/16bd41483886fd183bd98a189bd2e31f48d9f7b7", "committedDate": "2020-03-04T20:23:46Z", "message": "update resources schema"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MTA2NzM3", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#pullrequestreview-369106737", "createdAt": "2020-03-04T20:41:56Z", "commit": {"oid": "16bd41483886fd183bd98a189bd2e31f48d9f7b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5MTQ0NzYw", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#pullrequestreview-369144760", "createdAt": "2020-03-04T21:43:03Z", "commit": {"oid": "16bd41483886fd183bd98a189bd2e31f48d9f7b7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY5NTk2OTA5", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#pullrequestreview-369596909", "createdAt": "2020-03-05T14:09:43Z", "commit": {"oid": "16bd41483886fd183bd98a189bd2e31f48d9f7b7"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxNDowOTo0NFrOFyU53w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxNDowOTo0NFrOFyU53w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODMxNTYxNQ==", "bodyText": "@dippindots @adamabeshouse any specific reason why DISPLAY_NAME could be null and DESCRIPTION not to be?", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r388315615", "createdAt": "2020-03-05T14:09:44Z", "author": {"login": "kalletlak"}, "path": "db-scripts/src/main/resources/migration.sql", "diffHunk": "@@ -812,3 +812,41 @@ WHERE NOT EXISTS (SELECT * FROM genetic_profile WHERE  STABLE_ID=CONCAT(`fusion_\n     AND CANCER_STUDY_ID = `fusion_studies`.CANCER_STUDY_ID);\n DROP TEMPORARY TABLE fusion_studies;\n UPDATE `info` SET `DB_SCHEMA_VERSION`=\"2.12.3\";\n+\n+##version: 2.12.4\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) DEFAULT NULL,\n+  `DESCRIPTION` varchar(2048) NOT NULL,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "16bd41483886fd183bd98a189bd2e31f48d9f7b7"}, "originalPosition": 9}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "16bd41483886fd183bd98a189bd2e31f48d9f7b7", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/16bd41483886fd183bd98a189bd2e31f48d9f7b7", "committedDate": "2020-03-04T20:23:46Z", "message": "update resources schema"}, "afterCommit": {"oid": "0862994b01798eee690841311aeb28eb44ad94d0", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/0862994b01798eee690841311aeb28eb44ad94d0", "committedDate": "2020-03-05T19:30:19Z", "message": "update resources schema"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0862994b01798eee690841311aeb28eb44ad94d0", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/0862994b01798eee690841311aeb28eb44ad94d0", "committedDate": "2020-03-05T19:30:19Z", "message": "update resources schema"}, "afterCommit": {"oid": "7b7d5e428bf49557ad64a7c6a96b18cf09bd4ab6", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/7b7d5e428bf49557ad64a7c6a96b18cf09bd4ab6", "committedDate": "2020-03-06T18:09:17Z", "message": "update resources schema"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNTMyMzY2", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#pullrequestreview-370532366", "createdAt": "2020-03-06T18:24:40Z", "commit": {"oid": "7b7d5e428bf49557ad64a7c6a96b18cf09bd4ab6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxODoyNDo0MFrOFzCx3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxODoyNDo0MFrOFzCx3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA2NzIzMA==", "bodyText": "Since this ID is never used at all, why. not make (INTERNAL_ID, RESOURCE_ID, URL) as primary key?", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#discussion_r389067230", "createdAt": "2020-03-06T18:24:40Z", "author": {"login": "kalletlak"}, "path": "db-scripts/src/main/resources/cgds.sql", "diffHunk": "@@ -865,5 +869,52 @@ CREATE TABLE `info` (\n   `DB_SCHEMA_VERSION` varchar(24),\n   `GENESET_VERSION` varchar(24)\n );\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_definition` (\n+  `RESOURCE_ID` varchar(255) NOT NULL,\n+  `DISPLAY_NAME` varchar(255) NOT NULL,\n+  `DESCRIPTION` varchar(2048) DEFAULT NULL,\n+  `RESOURCE_TYPE` ENUM('STUDY', 'PATIENT', 'SAMPLE') NOT NULL,\n+  `OPEN_BY_DEFAULT` BOOLEAN DEFAULT 0,\n+  `PRIORITY` int(11) NOT NULL,\n+  `CANCER_STUDY_ID` int(11) NOT NULL,\n+  PRIMARY KEY (`RESOURCE_ID`,`CANCER_STUDY_ID`),\n+  FOREIGN KEY (`CANCER_STUDY_ID`) REFERENCES `cancer_study` (`CANCER_STUDY_ID`) ON DELETE CASCADE\n+);\n+\n+-- --------------------------------------------------------\n+CREATE TABLE `resource_sample` (\n+  `ID` INT(11) NOT NULL auto_increment,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7b7d5e428bf49557ad64a7c6a96b18cf09bd4ab6"}, "originalPosition": 31}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "966212da755752fc6ca4192d9cea90f008b4bade", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/966212da755752fc6ca4192d9cea90f008b4bade", "committedDate": "2020-03-06T20:06:57Z", "message": "update resources schema"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7b7d5e428bf49557ad64a7c6a96b18cf09bd4ab6", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/7b7d5e428bf49557ad64a7c6a96b18cf09bd4ab6", "committedDate": "2020-03-06T18:09:17Z", "message": "update resources schema"}, "afterCommit": {"oid": "966212da755752fc6ca4192d9cea90f008b4bade", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/966212da755752fc6ca4192d9cea90f008b4bade", "committedDate": "2020-03-06T20:06:57Z", "message": "update resources schema"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzcwNjA4NTEz", "url": "https://github.com/cBioPortal/cbioportal/pull/7259#pullrequestreview-370608513", "createdAt": "2020-03-06T20:32:56Z", "commit": {"oid": "966212da755752fc6ca4192d9cea90f008b4bade"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1716, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}