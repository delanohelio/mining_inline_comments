{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDc3MzU4MjQz", "number": 7856, "title": "Fix generic meta endpoint error when fetching by stable ids only", "bodyText": "Fix #7841\nWhen fetching generic assay meta by only giving the stable ids, since the allStableIdMap is empty, then given stable ids will be filtered out, and will get empty result.\nResolve this by using following logic:\n\nhave molecular profiles ids and stable ids: use the shared stable ids\nonly has molecular profiles ids: use stable ids derived from molecular profiles ids\nonly has stable ids: use the given stable ids", "createdAt": "2020-09-01T21:53:23Z", "url": "https://github.com/cBioPortal/cbioportal/pull/7856", "merged": true, "mergeCommit": {"oid": "18f9930153583a62e50d7ce605e978a3b3580e69"}, "closed": true, "closedAt": "2020-09-03T15:01:50Z", "author": {"login": "dippindots"}, "timelineItems": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdEukj7AH2gAyNDc3MzU4MjQzOjI4NmJkODZlN2RlZmY1MDk4ZWE5NDdjZTY0MDIwNTVhYjBkOTkxZDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdFBY8-gFqTQ4MTI0NDQzMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "286bd86e7deff5098ea947ce6402055ab0d991d2", "author": {"user": {"login": "dippindots", "name": "Gaofei Zhao"}}, "url": "https://github.com/cBioPortal/cbioportal/commit/286bd86e7deff5098ea947ce6402055ab0d991d2", "committedDate": "2020-09-01T21:48:30Z", "message": "Fix generic meta endpoint error when fetching by stable ids only"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDgxMjQ0NDMz", "url": "https://github.com/cBioPortal/cbioportal/pull/7856#pullrequestreview-481244433", "createdAt": "2020-09-02T19:43:25Z", "commit": {"oid": "286bd86e7deff5098ea947ce6402055ab0d991d2"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxOTo0MzoyNVrOHMA13Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wMlQxOTo0MzoyNVrOHMA13Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM1ODc0OQ==", "bodyText": "Not important, you could use identity function here\n.collect(Collectors.toMap(Function.identity(), Function.identity()));", "url": "https://github.com/cBioPortal/cbioportal/pull/7856#discussion_r482358749", "createdAt": "2020-09-02T19:43:25Z", "author": {"login": "kalletlak"}, "path": "service/src/main/java/org/cbioportal/service/impl/GenericAssayServiceImpl.java", "diffHunk": "@@ -58,16 +58,22 @@\n                 List<String> stableIdsInMolecularProfiles = genericAssayRepository.getGenericAssayStableIdsByMolecularIds(distinctMolecularProfileIds);\n                 allStableIds.addAll(stableIdsInMolecularProfiles);\n             }\n-        } \n-        if (stableIds != null) {\n-\t\t\tMap<String, String> allStableIdMap = allStableIds\n-\t\t\t\t\t.stream()\n-\t\t\t\t\t.collect(Collectors.toMap(stableId -> stableId, stableId -> stableId));\n-\n-\t\t\tallStableIds = stableIds\n-\t\t\t\t\t.stream()\n-\t\t\t\t\t.filter(stableId -> allStableIdMap.containsKey(stableId))\n-\t\t\t\t\t.collect(Collectors.toSet());\n+            // if stableIds and molecularProfileIds both exist, find the common\n+            if (stableIds != null) {\n+                Map<String, String> allStableIdMap = allStableIds\n+                        .stream()\n+                        .collect(Collectors.toMap(stableId -> stableId, stableId -> stableId));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "286bd86e7deff5098ea947ce6402055ab0d991d2"}, "originalPosition": 18}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1685, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}