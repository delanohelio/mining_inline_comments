{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE1MTI3ODM0", "number": 8959, "title": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment ", "bodyText": "Fix #8934\nTurns out, assigning to switch is not the problem. In fact, wrapping switch inside a function foo() makes the problem disappear.\n$ cat ExpressionSwitchBugs.java\npublic class ExpressionSwitchBugs {\n    private static final int staticValue = 2;\n    private void foo() {\n        final int someVariable = switch (staticValue) {\n            case 0 -> -1;\n            case 2 -> 2;\n            default -> 3;\n        };\n    }\n}\n\njava -jar .\\checkstyle-8.37-all.jar -c config.xml ExpressionSwitchBugs.java\nStarting audit...\nAudit done.\n\nHere's what went wrong in #8934:\nThe NPE occurs at line 482, when checkstyle is reading case 0 -> -1;\n\n  \n    \n      checkstyle/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/FinalLocalVariableCheck.java\n    \n    \n        Lines 481 to 482\n      in\n      3fc9dd9\n    \n    \n    \n    \n\n        \n          \n           private void updateUninitializedVariables(Deque<DetailAST> scopeUninitializedVariableData) { \n        \n\n        \n          \n               final Iterator<DetailAST> iterator = currentScopeAssignedVariables.peek().iterator(); \n        \n    \n  \n\n\nBasically, when executing line 482, currentScopeAssignedVariables is an empty Deque => .peek() returns null => accessing .iterator() return NPE\ncurrentScopeAssignedVariables is empty because there are no scope yet. The only place a new scope is added to currentScopeAssignedVariables is:\n\n  \n    \n      checkstyle/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/FinalLocalVariableCheck.java\n    \n    \n        Lines 273 to 274\n      in\n      3fc9dd9\n    \n    \n    \n    \n\n        \n          \n           case TokenTypes.SLIST: \n        \n\n        \n          \n               currentScopeAssignedVariables.push(new ArrayDeque<>()); \n        \n    \n  \n\n\nBut,\npublic class ExpressionSwitchBugs {\n...\n}\n\nis an OBJBLOCK, not a SLIST => line 274 was never executed => there was no scope at the time line 482 was executing. That explains why wrapping the switch inside a function foo() makes it work (Because foo() is a scope)\n=> I fixed this bug by checking if (!currentScopeAssignedVariables.isEmpty()) before executing final Iterator<DetailAST> iterator = currentScopeAssignedVariables.peek().iterator();\nTest input was added inside the existing test file: InputFinalLocalVariableCheckSwitchExpressions.java\nDiff Regression config: https://gist.githubusercontent.com/anhminhtran235/c74908614e3465fade5de3c1d33fad5e/raw/ec75fe33dd75befe6b23185b9521c93cebb1c18b/check.xml\nDiff Regression projects: https://gist.githubusercontent.com/anhminhtran235/2da94f96d35ab9471624c5b6c4421c66/raw/82b014453ca421085199b4635f6a13c26a62941d/projects-to-test-on.properties", "createdAt": "2020-11-04T04:37:13Z", "url": "https://github.com/checkstyle/checkstyle/pull/8959", "merged": true, "mergeCommit": {"oid": "306374415af07636b51a5b989fb788240fcae2e4"}, "closed": true, "closedAt": "2020-11-11T10:20:50Z", "author": {"login": "anhminhtran235"}, "timelineItems": {"totalCount": 24, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdZRpatABqjM5NTg4MTk4MDY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdbbSTQgFqTUyODA0MTg3Mg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "05f7a7687b83b24eeecfb2917b6dc2a3bef6e941", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/05f7a7687b83b24eeecfb2917b6dc2a3bef6e941", "committedDate": "2020-11-04T04:03:39Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "557c27889f3099be75815485997e62755481c0ae", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/557c27889f3099be75815485997e62755481c0ae", "committedDate": "2020-11-04T17:58:09Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "557c27889f3099be75815485997e62755481c0ae", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/557c27889f3099be75815485997e62755481c0ae", "committedDate": "2020-11-04T17:58:09Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "ee234d05e8853e41a477db445b79c430b687c0fc", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/ee234d05e8853e41a477db445b79c430b687c0fc", "committedDate": "2020-11-04T18:15:56Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ee234d05e8853e41a477db445b79c430b687c0fc", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/ee234d05e8853e41a477db445b79c430b687c0fc", "committedDate": "2020-11-04T18:15:56Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "1be5731fe7d33e14f8d4d4b14ca0dec98853a096", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/1be5731fe7d33e14f8d4d4b14ca0dec98853a096", "committedDate": "2020-11-06T04:33:45Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d0c2f43136be19051cdb1dd8d3417fccb94dcd19", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/d0c2f43136be19051cdb1dd8d3417fccb94dcd19", "committedDate": "2020-11-06T05:36:45Z", "message": "Merge branch 'fix-switch-NPE' of https://github.com/anhminhtran235/checkstyle into fix-switch-NPE"}, "afterCommit": {"oid": "c91b6508584b6dd056ec79e5e8b93fbda76f65fd", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/c91b6508584b6dd056ec79e5e8b93fbda76f65fd", "committedDate": "2020-11-06T17:59:19Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c91b6508584b6dd056ec79e5e8b93fbda76f65fd", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/c91b6508584b6dd056ec79e5e8b93fbda76f65fd", "committedDate": "2020-11-06T17:59:19Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "689e483b237badbd9f8a4a766d827447cdc77c02", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/689e483b237badbd9f8a4a766d827447cdc77c02", "committedDate": "2020-11-06T18:03:12Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1NTk2OTk3", "url": "https://github.com/checkstyle/checkstyle/pull/8959#pullrequestreview-525596997", "createdAt": "2020-11-07T04:31:31Z", "commit": {"oid": "689e483b237badbd9f8a4a766d827447cdc77c02"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QwNDozMTozMlrOHvDPdw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QwNDozNTowMlrOHvDQgA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA5ODIzMQ==", "bodyText": "Please move new code block to the end of file so you will not have this change", "url": "https://github.com/checkstyle/checkstyle/pull/8959#discussion_r519098231", "createdAt": "2020-11-07T04:31:32Z", "author": {"login": "romani"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/checks/coding/FinalLocalVariableCheckTest.java", "diffHunk": "@@ -297,10 +297,10 @@ public void testReceiverParameter() throws Exception {\n     public void testFinalLocalVariableSwitchExpressions() throws Exception {\n         final DefaultConfiguration checkConfig = createModuleConfig(FinalLocalVariableCheck.class);\n         final String[] expected = {\n-            \"12:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n-            \"50:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n-            \"88:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n-            \"122:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n+            \"19:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n+            \"57:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n+            \"95:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n+            \"129:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n             };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "689e483b237badbd9f8a4a766d827447cdc77c02"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTA5ODQ5Ng==", "bodyText": "Please extend Input for default config", "url": "https://github.com/checkstyle/checkstyle/pull/8959#discussion_r519098496", "createdAt": "2020-11-07T04:35:02Z", "author": {"login": "romani"}, "path": "src/test/resources-noncompilable/com/puppycrawl/tools/checkstyle/checks/coding/finallocalvariable/InputFinalLocalVariableCheckSwitchExpressions.java", "diffHunk": "@@ -7,6 +7,13 @@\n  * tokens = {VARIABLE_DEF}\n  */\n public class InputFinalLocalVariableCheckSwitchExpressions {\n+    private static final int staticValue = 2;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "689e483b237badbd9f8a4a766d827447cdc77c02"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "689e483b237badbd9f8a4a766d827447cdc77c02", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/689e483b237badbd9f8a4a766d827447cdc77c02", "committedDate": "2020-11-06T18:03:12Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "7c77902b22953244911918d579de5711191bb248", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/7c77902b22953244911918d579de5711191bb248", "committedDate": "2020-11-07T05:41:06Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7c77902b22953244911918d579de5711191bb248", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/7c77902b22953244911918d579de5711191bb248", "committedDate": "2020-11-07T05:41:06Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "a40fafdc90211343b51194563c030a7b5e8be254", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/a40fafdc90211343b51194563c030a7b5e8be254", "committedDate": "2020-11-07T05:42:58Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a40fafdc90211343b51194563c030a7b5e8be254", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/a40fafdc90211343b51194563c030a7b5e8be254", "committedDate": "2020-11-07T05:42:58Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "b64d62e59c540ff459ffd889a8166c22698c4e2b", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/b64d62e59c540ff459ffd889a8166c22698c4e2b", "committedDate": "2020-11-07T05:44:58Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1NjYwOTQx", "url": "https://github.com/checkstyle/checkstyle/pull/8959#pullrequestreview-525660941", "createdAt": "2020-11-07T15:35:26Z", "commit": {"oid": "b64d62e59c540ff459ffd889a8166c22698c4e2b"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNTozNToyNlrOHvIydQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxNTozNToyNlrOHvIydQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTE4OTEwOQ==", "bodyText": "As @romani stated in his items, please create a new UT and input file.  It would be good to show:\n\nviolations: definitions where variable is not declared final but is never reassigned\nacceptable variable definitions (those that are declared final and never reassigned)\nacceptable variable definitions (where the variable is not declared final AND is reassigned).\n\n...  where a switch expression is on RHS of the assignment.   Try to put the code within methods, class blocks, constructors, even nested switch expressions, etc. to make sure that we can successfully check all.", "url": "https://github.com/checkstyle/checkstyle/pull/8959#discussion_r519189109", "createdAt": "2020-11-07T15:35:26Z", "author": {"login": "nmancus1"}, "path": "src/test/resources-noncompilable/com/puppycrawl/tools/checkstyle/checks/coding/finallocalvariable/InputFinalLocalVariableCheckSwitchExpressions.java", "diffHunk": "@@ -132,5 +132,12 @@ void foo4() throws Exception {\n         }\n \n     }\n+\n+    private static final int staticValue = 2;\n+    private static final int staticField = switch(staticValue) {\n+        case 0 -> -1;\n+        case 2-> 2;\n+        default -> 3;\n+    };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b64d62e59c540ff459ffd889a8166c22698c4e2b"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b64d62e59c540ff459ffd889a8166c22698c4e2b", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/b64d62e59c540ff459ffd889a8166c22698c4e2b", "committedDate": "2020-11-07T05:44:58Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "0e209ca33e230846072fd0ea3b6ef5880545f861", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/0e209ca33e230846072fd0ea3b6ef5880545f861", "committedDate": "2020-11-07T18:54:41Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0e209ca33e230846072fd0ea3b6ef5880545f861", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/0e209ca33e230846072fd0ea3b6ef5880545f861", "committedDate": "2020-11-07T18:54:41Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "c5fc0bb00482b9c0ab6d98ea173a63cbc011c9da", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/c5fc0bb00482b9c0ab6d98ea173a63cbc011c9da", "committedDate": "2020-11-07T18:56:05Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c5fc0bb00482b9c0ab6d98ea173a63cbc011c9da", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/c5fc0bb00482b9c0ab6d98ea173a63cbc011c9da", "committedDate": "2020-11-07T18:56:05Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "1d726198940e7d592c6325679d3889bf611f2839", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/1d726198940e7d592c6325679d3889bf611f2839", "committedDate": "2020-11-07T19:03:06Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1Njc1NDA3", "url": "https://github.com/checkstyle/checkstyle/pull/8959#pullrequestreview-525675407", "createdAt": "2020-11-07T19:24:47Z", "commit": {"oid": "1d726198940e7d592c6325679d3889bf611f2839"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxOToyNDo0N1rOHvKCKg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wN1QxOToyNDo0N1rOHvKCKg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTIwOTUxNA==", "bodyText": "Please add test case for violation inside case", "url": "https://github.com/checkstyle/checkstyle/pull/8959#discussion_r519209514", "createdAt": "2020-11-07T19:24:47Z", "author": {"login": "romani"}, "path": "src/test/resources-noncompilable/com/puppycrawl/tools/checkstyle/checks/coding/finallocalvariable/InputFinalLocalVariableCheckSwitchAssignment.java", "diffHunk": "@@ -0,0 +1,59 @@\n+//non-compiled with javac: Compilable with Java14\n+package com.puppycrawl.tools.checkstyle.checks.coding.finallocalvariable;\n+\n+/* Config:\n+ * default\n+ */\n+public class InputFinalLocalVariableCheckSwitchAssignment {\n+    private static final int staticValue = 2;\n+    private static final int staticField = switch(staticValue) {\n+        case 0 -> -1;\n+        case 2-> 2;\n+        default -> 3;\n+    };\n+\n+    public InputFinalLocalVariableCheckSwitchAssignment() throws Exception {\n+        int a = 0; // violation\n+        final int b = 0;\n+        int c = 10;\n+        int d = 0;\n+\n+        c = switch (a) {\n+            case 0 -> 5;\n+            case 1 -> 10;\n+            default -> switch(b) {\n+                    case 2 -> {\n+                        if (a == 0) {\n+                            d = 1; // reassign d\n+                        }\n+                        throw new Exception();\n+                    }\n+                    default -> 2;\n+                };\n+        };\n+    }\n+\n+    public void foo() {\n+        final int a = 0;\n+\n+        int b = switch(a) { // violation", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1d726198940e7d592c6325679d3889bf611f2839"}, "originalPosition": 39}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1d726198940e7d592c6325679d3889bf611f2839", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/1d726198940e7d592c6325679d3889bf611f2839", "committedDate": "2020-11-07T19:03:06Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "adcf1c63d18e3c0223c09b0e26c108330b3dd62a", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/adcf1c63d18e3c0223c09b0e26c108330b3dd62a", "committedDate": "2020-11-07T19:31:41Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1NjgwNzY3", "url": "https://github.com/checkstyle/checkstyle/pull/8959#pullrequestreview-525680767", "createdAt": "2020-11-07T20:47:36Z", "commit": {"oid": "adcf1c63d18e3c0223c09b0e26c108330b3dd62a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1ODAzOTg0", "url": "https://github.com/checkstyle/checkstyle/pull/8959#pullrequestreview-525803984", "createdAt": "2020-11-08T12:39:40Z", "commit": {"oid": "adcf1c63d18e3c0223c09b0e26c108330b3dd62a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOFQxMjozOTo0MVrOHvUypA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOFQxMjozOTo0MVrOHvUypA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTM4NTc2NA==", "bodyText": "Indentation: should be 8.", "url": "https://github.com/checkstyle/checkstyle/pull/8959#discussion_r519385764", "createdAt": "2020-11-08T12:39:41Z", "author": {"login": "nmancus1"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/checks/coding/FinalLocalVariableCheckTest.java", "diffHunk": "@@ -307,4 +307,17 @@ public void testFinalLocalVariableSwitchExpressions() throws Exception {\n             expected);\n     }\n \n+    @Test\n+    public void testFinalLocalVariableSwitchAssignment() throws Exception {\n+        final DefaultConfiguration checkConfig = createModuleConfig(FinalLocalVariableCheck.class);\n+        final String[] expected = {\n+            \"16:13: \" + getCheckMessage(MSG_KEY, \"a\"),\n+            \"39:13: \" + getCheckMessage(MSG_KEY, \"b\"),\n+            \"41:21: \" + getCheckMessage(MSG_KEY, \"x\"),\n+            };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "adcf1c63d18e3c0223c09b0e26c108330b3dd62a"}, "originalPosition": 11}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "adcf1c63d18e3c0223c09b0e26c108330b3dd62a", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/adcf1c63d18e3c0223c09b0e26c108330b3dd62a", "committedDate": "2020-11-07T19:31:41Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "42d24472bcafd5cc86973005cbf457d061a47ba8", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/42d24472bcafd5cc86973005cbf457d061a47ba8", "committedDate": "2020-11-08T18:00:08Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI1ODMyODQ0", "url": "https://github.com/checkstyle/checkstyle/pull/8959#pullrequestreview-525832844", "createdAt": "2020-11-08T18:22:38Z", "commit": {"oid": "42d24472bcafd5cc86973005cbf457d061a47ba8"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOFQxODoyMjozOFrOHvZUCg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wOFQxODoyMjozOFrOHvZUCg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTQ1OTg1MA==", "bodyText": "@anhminhtran235 please make this as separate commit, such as minor: fix indentation since this was not related to #8934. Some GSOC student must've missed this over the summer :)", "url": "https://github.com/checkstyle/checkstyle/pull/8959#discussion_r519459850", "createdAt": "2020-11-08T18:22:38Z", "author": {"login": "nmancus1"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/checks/coding/FinalLocalVariableCheckTest.java", "diffHunk": "@@ -301,10 +301,23 @@ public void testFinalLocalVariableSwitchExpressions() throws Exception {\n             \"50:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n             \"88:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n             \"122:19: \" + getCheckMessage(MSG_KEY, \"e\"),\n-            };\n+        };", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "42d24472bcafd5cc86973005cbf457d061a47ba8"}, "originalPosition": 5}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "714aef87bfe2ba179e7f34d73061e0aef7ec50df", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/714aef87bfe2ba179e7f34d73061e0aef7ec50df", "committedDate": "2020-11-08T19:13:37Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "42d24472bcafd5cc86973005cbf457d061a47ba8", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/42d24472bcafd5cc86973005cbf457d061a47ba8", "committedDate": "2020-11-08T18:00:08Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}, "afterCommit": {"oid": "714aef87bfe2ba179e7f34d73061e0aef7ec50df", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/714aef87bfe2ba179e7f34d73061e0aef7ec50df", "committedDate": "2020-11-08T19:13:37Z", "message": "Issue #8934: FinalLocalVariable throws a NPE on Switch expression in assignment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7048ded374e1fc9b48b65fb35ab99d91ac0ee6d2", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/7048ded374e1fc9b48b65fb35ab99d91ac0ee6d2", "committedDate": "2020-11-08T20:19:43Z", "message": "minor: fix indentation(#8934)"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1516595d97d9c0e5ef4b932feee1e5acdc9dfd6c", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/1516595d97d9c0e5ef4b932feee1e5acdc9dfd6c", "committedDate": "2020-11-08T19:16:28Z", "message": "minor: fix indentation"}, "afterCommit": {"oid": "7048ded374e1fc9b48b65fb35ab99d91ac0ee6d2", "author": {"user": {"login": "anhminhtran235", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/7048ded374e1fc9b48b65fb35ab99d91ac0ee6d2", "committedDate": "2020-11-08T20:19:43Z", "message": "minor: fix indentation(#8934)"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI4MDQxODcy", "url": "https://github.com/checkstyle/checkstyle/pull/8959#pullrequestreview-528041872", "createdAt": "2020-11-11T10:20:37Z", "commit": {"oid": "7048ded374e1fc9b48b65fb35ab99d91ac0ee6d2"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1391, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}