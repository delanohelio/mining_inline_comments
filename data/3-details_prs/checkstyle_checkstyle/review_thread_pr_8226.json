{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzMzEwNjc1", "number": 8226, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwNDozMDo0MVrOD9In0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNDoyMjo0MFrOD90kuw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NDMwOTkzOnYy", "diffSide": "RIGHT", "path": ".ci/travis/travis.sh", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QwNDozMDo0MVrOGWeKgw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQwMTowNjozM1rOGWk_bg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjA2Nw==", "bodyText": "For some reason I feel that this should be done ones, at post script actions, the same as we do for git status", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r426216067", "createdAt": "2020-05-17T04:30:41Z", "author": {"login": "romani"}, "path": ".ci/travis/travis.sh", "diffHunk": "@@ -253,6 +266,10 @@ no-error-test-sbe)\n     \"s/'com.puppycrawl.tools:checkstyle:.*'/'com.puppycrawl.tools:checkstyle:$CS_POM_VERSION'/\" \\\n     build.gradle\n   ./gradlew build --stacktrace\n+  cd ..\n+  removeFolderWithProtectedFiles simple-binary-encoding\n+  cd ..\n+  validateTempDirectoryEmpty", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e0523c2d7fe42629eea87f3aa92a79dc741e0c6d"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjIyMA==", "bodyText": "See #7892 (comment)", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r426216220", "createdAt": "2020-05-17T04:33:23Z", "author": {"login": "nmancus1"}, "path": ".ci/travis/travis.sh", "diffHunk": "@@ -253,6 +266,10 @@ no-error-test-sbe)\n     \"s/'com.puppycrawl.tools:checkstyle:.*'/'com.puppycrawl.tools:checkstyle:$CS_POM_VERSION'/\" \\\n     build.gradle\n   ./gradlew build --stacktrace\n+  cd ..\n+  removeFolderWithProtectedFiles simple-binary-encoding\n+  cd ..\n+  validateTempDirectoryEmpty", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjA2Nw=="}, "originalCommit": {"oid": "e0523c2d7fe42629eea87f3aa92a79dc741e0c6d"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMxMzI3OA==", "bodyText": "this does not explain this ...\nTravis has \n  \n    \n      checkstyle/.travis.yml\n    \n    \n        Lines 358 to 361\n      in\n      11baaf2\n    \n    \n    \n    \n\n        \n          \n           after_success: \n        \n\n        \n          \n             - | \n        \n\n        \n          \n               set -e \n        \n\n        \n          \n               if [[ -n $CMD_AFTER_SUCCESS \n        \n    \n  \n\n\nif you put this function here ... it will be good.", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r426313278", "createdAt": "2020-05-17T22:44:17Z", "author": {"login": "romani"}, "path": ".ci/travis/travis.sh", "diffHunk": "@@ -253,6 +266,10 @@ no-error-test-sbe)\n     \"s/'com.puppycrawl.tools:checkstyle:.*'/'com.puppycrawl.tools:checkstyle:$CS_POM_VERSION'/\" \\\n     build.gradle\n   ./gradlew build --stacktrace\n+  cd ..\n+  removeFolderWithProtectedFiles simple-binary-encoding\n+  cd ..\n+  validateTempDirectoryEmpty", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjA2Nw=="}, "originalCommit": {"oid": "e0523c2d7fe42629eea87f3aa92a79dc741e0c6d"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyNzkxOA==", "bodyText": "It is done.", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r426327918", "createdAt": "2020-05-18T01:06:33Z", "author": {"login": "nmancus1"}, "path": ".ci/travis/travis.sh", "diffHunk": "@@ -253,6 +266,10 @@ no-error-test-sbe)\n     \"s/'com.puppycrawl.tools:checkstyle:.*'/'com.puppycrawl.tools:checkstyle:$CS_POM_VERSION'/\" \\\n     build.gradle\n   ./gradlew build --stacktrace\n+  cd ..\n+  removeFolderWithProtectedFiles simple-binary-encoding\n+  cd ..\n+  validateTempDirectoryEmpty", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjA2Nw=="}, "originalCommit": {"oid": "e0523c2d7fe42629eea87f3aa92a79dc741e0c6d"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MTI0MDQ2OnYy", "diffSide": "RIGHT", "path": ".travis.yml", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzoyMTo1MVrOGXgIhA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzo0Mjo0MlrOGXhDsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5NjkwMA==", "bodyText": "fix indentation, it should be same as fail", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r427296900", "createdAt": "2020-05-19T13:21:51Z", "author": {"login": "romani"}, "path": ".travis.yml", "diffHunk": "@@ -396,3 +396,15 @@ after_success:\n         echo \"deploy to maven snapshot repository is finished\";\n     fi\n     sleep 5s\n+  - |\n+    fail=0\n+      if [ -z \"$(ls -A .ci-temp)\" ]; then", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2a197dbc7fcc002a9b574f880e07121833d97f9"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxMjA1MQ==", "bodyText": "Fixed.", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r427312051", "createdAt": "2020-05-19T13:42:42Z", "author": {"login": "nmancus1"}, "path": ".travis.yml", "diffHunk": "@@ -396,3 +396,15 @@ after_success:\n         echo \"deploy to maven snapshot repository is finished\";\n     fi\n     sleep 5s\n+  - |\n+    fail=0\n+      if [ -z \"$(ls -A .ci-temp)\" ]; then", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5NjkwMA=="}, "originalCommit": {"oid": "b2a197dbc7fcc002a9b574f880e07121833d97f9"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MTI1MDU0OnYy", "diffSide": "RIGHT", "path": ".ci/travis/travis.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzoyNDowMVrOGXgOzw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxMzo0MjoyMlrOGXhCsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5ODUxMQ==", "bodyText": "please move this to separate commit, as it is not related to .ci-temp commit.", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r427298511", "createdAt": "2020-05-19T13:24:01Z", "author": {"login": "romani"}, "path": ".ci/travis/travis.sh", "diffHunk": "@@ -288,8 +292,10 @@ no-exception-test-guava)\n   mvn -e clean install -Pno-validations\n   cd .ci-temp/contribution/checkstyle-tester\n   export MAVEN_OPTS=\"-Xmx2048m\"\n-  groovy ./launch.groovy --listOfProjects projects-to-test-on.properties\n+  groovy ./launch.groovy --listOfProjects projects-to-test-on.properties \\", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b2a197dbc7fcc002a9b574f880e07121833d97f9"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxMTc5NQ==", "bodyText": "Done.", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r427311795", "createdAt": "2020-05-19T13:42:22Z", "author": {"login": "nmancus1"}, "path": ".ci/travis/travis.sh", "diffHunk": "@@ -288,8 +292,10 @@ no-exception-test-guava)\n   mvn -e clean install -Pno-validations\n   cd .ci-temp/contribution/checkstyle-tester\n   export MAVEN_OPTS=\"-Xmx2048m\"\n-  groovy ./launch.groovy --listOfProjects projects-to-test-on.properties\n+  groovy ./launch.groovy --listOfProjects projects-to-test-on.properties \\", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI5ODUxMQ=="}, "originalCommit": {"oid": "b2a197dbc7fcc002a9b574f880e07121833d97f9"}, "originalPosition": 23}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY2MTUxMDk5OnYy", "diffSide": "RIGHT", "path": ".travis.yml", "isResolved": true, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQxNDoyMjo0MFrOGXi2sA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yMFQwMzo0NDo1NlrOGX6PGg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM0MTQ4OA==", "bodyText": "we need to sleep before exit.\nTo let output successfully flushed in log file before container closure (base on experience, command before exit usually excluded from logs). I always wanted to find time to report this to Travis or find existing issue on this, as it might have already more elegant solution. If you have time please investigate this.", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r427341488", "createdAt": "2020-05-19T14:22:40Z", "author": {"login": "romani"}, "path": ".travis.yml", "diffHunk": "@@ -396,3 +396,15 @@ after_success:\n         echo \"deploy to maven snapshot repository is finished\";\n     fi\n     sleep 5s\n+  - |\n+    fail=0\n+    if [ -z \"$(ls -A .ci-temp)\" ]; then\n+        echo \"Empty .ci-temp/ validation did not find any warnings.\"\n+    else\n+        echo \"Directory .ci-temp/ is not empty. Verification failed.\"\n+        echo \"Contents of .ci-temp/:\"\n+        fail=1\n+    fi\n+    ls -A .ci-temp --color=auto\n+    exit $fail\n+    sleep 5s", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "40c6b9c4ac11565f01609e7893faec2fed56549c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM2Njc0OQ==", "bodyText": "Ok! I didn't know why all the sleeps were in there, I just figured it was for appearance/ human readability.  Fixed.", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r427366749", "createdAt": "2020-05-19T14:53:04Z", "author": {"login": "nmancus1"}, "path": ".travis.yml", "diffHunk": "@@ -396,3 +396,15 @@ after_success:\n         echo \"deploy to maven snapshot repository is finished\";\n     fi\n     sleep 5s\n+  - |\n+    fail=0\n+    if [ -z \"$(ls -A .ci-temp)\" ]; then\n+        echo \"Empty .ci-temp/ validation did not find any warnings.\"\n+    else\n+        echo \"Directory .ci-temp/ is not empty. Verification failed.\"\n+        echo \"Contents of .ci-temp/:\"\n+        fail=1\n+    fi\n+    ls -A .ci-temp --color=auto\n+    exit $fail\n+    sleep 5s", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM0MTQ4OA=="}, "originalCommit": {"oid": "40c6b9c4ac11565f01609e7893faec2fed56549c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM3MjYzNA==", "bodyText": "Do you notice this issue only when nonzero exit status occurs, or always?  Also, I didn't use set -e, should I update to include set -e option?", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r427372634", "createdAt": "2020-05-19T15:00:24Z", "author": {"login": "nmancus1"}, "path": ".travis.yml", "diffHunk": "@@ -396,3 +396,15 @@ after_success:\n         echo \"deploy to maven snapshot repository is finished\";\n     fi\n     sleep 5s\n+  - |\n+    fail=0\n+    if [ -z \"$(ls -A .ci-temp)\" ]; then\n+        echo \"Empty .ci-temp/ validation did not find any warnings.\"\n+    else\n+        echo \"Directory .ci-temp/ is not empty. Verification failed.\"\n+        echo \"Contents of .ci-temp/:\"\n+        fail=1\n+    fi\n+    ls -A .ci-temp --color=auto\n+    exit $fail\n+    sleep 5s", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM0MTQ4OA=="}, "originalCommit": {"oid": "40c6b9c4ac11565f01609e7893faec2fed56549c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM3NDk2OQ==", "bodyText": "Please add set -e it is always good to fail quick in CI even on minors. It is much better than miss leak of violations or errors.", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r427374969", "createdAt": "2020-05-19T15:03:25Z", "author": {"login": "romani"}, "path": ".travis.yml", "diffHunk": "@@ -396,3 +396,15 @@ after_success:\n         echo \"deploy to maven snapshot repository is finished\";\n     fi\n     sleep 5s\n+  - |\n+    fail=0\n+    if [ -z \"$(ls -A .ci-temp)\" ]; then\n+        echo \"Empty .ci-temp/ validation did not find any warnings.\"\n+    else\n+        echo \"Directory .ci-temp/ is not empty. Verification failed.\"\n+        echo \"Contents of .ci-temp/:\"\n+        fail=1\n+    fi\n+    ls -A .ci-temp --color=auto\n+    exit $fail\n+    sleep 5s", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM0MTQ4OA=="}, "originalCommit": {"oid": "40c6b9c4ac11565f01609e7893faec2fed56549c"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzcyNDU3MA==", "bodyText": "@romani This looks like what you're describing: https://travis-ci.community/t/log-are-truncated-when-my-script-exits-abnormally/5878/4 Note that the OP is stating that this happens when script exits normally or with error.", "url": "https://github.com/checkstyle/checkstyle/pull/8226#discussion_r427724570", "createdAt": "2020-05-20T03:44:56Z", "author": {"login": "nmancus1"}, "path": ".travis.yml", "diffHunk": "@@ -396,3 +396,15 @@ after_success:\n         echo \"deploy to maven snapshot repository is finished\";\n     fi\n     sleep 5s\n+  - |\n+    fail=0\n+    if [ -z \"$(ls -A .ci-temp)\" ]; then\n+        echo \"Empty .ci-temp/ validation did not find any warnings.\"\n+    else\n+        echo \"Directory .ci-temp/ is not empty. Verification failed.\"\n+        echo \"Contents of .ci-temp/:\"\n+        fail=1\n+    fi\n+    ls -A .ci-temp --color=auto\n+    exit $fail\n+    sleep 5s", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM0MTQ4OA=="}, "originalCommit": {"oid": "40c6b9c4ac11565f01609e7893faec2fed56549c"}, "originalPosition": 15}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 999, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}