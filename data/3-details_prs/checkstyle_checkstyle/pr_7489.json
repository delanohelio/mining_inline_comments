{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY0Mjg1NjI4", "number": 7489, "title": "Issue 7487 add method hasChildren() to DetailAST", "bodyText": "Issue #7487\nFirst commit to add the method.\nSecond commit to switch ast.getChildCount() > 0 to ast.hasChildren() and ast.getChildCount() == 0 to !ast.hasChildren()\nSome if's are inverted for readablity. The method isOnEnumConstant is rewritten to eliminate multiple calls to getPrevSiblingSkipComments\nRegression\nInvalidJavadocPosition, DesignForExtension, JavadocContentLocation, MissingJavadocPackage\nAtclauseOrder, JavadocBlockTagLocation, JavadocParagraph, JavadocTagContinuationIndentation, MissingDeprecated, NonEmptyAtclauseDescription, SingleLineJavadoc, SummaryJavadoc\nSummaryJavadoc only", "createdAt": "2020-01-17T19:25:32Z", "url": "https://github.com/checkstyle/checkstyle/pull/7489", "merged": true, "mergeCommit": {"oid": "bd45909e6345b2d3ef5c5472d35a3ad926a31eb9"}, "closed": true, "closedAt": "2020-01-26T13:04:12Z", "author": {"login": "pbludov"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb7T49GABqjI5NTkyNDYzODQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb9z578gBqjI5NzkzMjE4MzU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9ac0a83e76a546915e674ce4d327932b7f4a384b", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9ac0a83e76a546915e674ce4d327932b7f4a384b", "committedDate": "2020-01-17T19:18:19Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}, "afterCommit": {"oid": "57eb1d9f475a6de4ca7fa560a32022a2987addb9", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/57eb1d9f475a6de4ca7fa560a32022a2987addb9", "committedDate": "2020-01-17T19:26:37Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0Nzk2MDI1", "url": "https://github.com/checkstyle/checkstyle/pull/7489#pullrequestreview-344796025", "createdAt": "2020-01-17T19:32:24Z", "commit": {"oid": "9ac0a83e76a546915e674ce4d327932b7f4a384b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "57eb1d9f475a6de4ca7fa560a32022a2987addb9", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/57eb1d9f475a6de4ca7fa560a32022a2987addb9", "committedDate": "2020-01-17T19:26:37Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}, "afterCommit": {"oid": "4c2f86e5775c29a6e037631f4969e080f0b15168", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/4c2f86e5775c29a6e037631f4969e080f0b15168", "committedDate": "2020-01-17T19:40:52Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0ODAwNjI1", "url": "https://github.com/checkstyle/checkstyle/pull/7489#pullrequestreview-344800625", "createdAt": "2020-01-17T19:41:05Z", "commit": {"oid": "57eb1d9f475a6de4ca7fa560a32022a2987addb9"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxOTo0MTowNVrOFfDVRQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QxOTo0MTowNVrOFfDVRQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEwNDc3Mw==", "bodyText": "@romani Does it make sense we add similar method with this parameter in addition to the other?", "url": "https://github.com/checkstyle/checkstyle/pull/7489#discussion_r368104773", "createdAt": "2020-01-17T19:41:05Z", "author": {"login": "rnveach"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java", "diffHunk": "@@ -388,10 +388,15 @@ private static boolean isExprSurrounded(DetailAST ast) {\n      */\n     private static boolean isLambdaSingleParameterSurrounded(DetailAST ast) {\n         final DetailAST firstChild = ast.getFirstChild();\n-        return firstChild.getType() == TokenTypes.LPAREN\n-                && firstChild.getNextSibling().getChildCount(TokenTypes.PARAMETER_DEF) == 1\n-                && firstChild.getNextSibling().getFirstChild().findFirstToken(TokenTypes.TYPE)\n-                        .getChildCount() == 0;\n+        boolean result = false;\n+        if (firstChild.getType() == TokenTypes.LPAREN) {\n+            final DetailAST parameters = firstChild.getNextSibling();\n+            if (parameters.getChildCount(TokenTypes.PARAMETER_DEF) == 1", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "57eb1d9f475a6de4ca7fa560a32022a2987addb9"}, "originalPosition": 11}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0ODc4MDEx", "url": "https://github.com/checkstyle/checkstyle/pull/7489#pullrequestreview-344878011", "createdAt": "2020-01-17T22:36:37Z", "commit": {"oid": "4c2f86e5775c29a6e037631f4969e080f0b15168"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QyMjozNjozN1rOFfG-_w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QyMjozNjozN1rOFfG-_w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODE2NDYwNw==", "bodyText": "Pitest issue should be fixed.", "url": "https://github.com/checkstyle/checkstyle/pull/7489#discussion_r368164607", "createdAt": "2020-01-17T22:36:37Z", "author": {"login": "pbludov"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/AbstractSuperCheck.java", "diffHunk": "@@ -136,7 +136,7 @@ private boolean isSuperCallInOverridingMethod(DetailAST ast) {\n      */\n     private static boolean hasArguments(DetailAST methodCallDotAst) {\n         final DetailAST argumentsList = methodCallDotAst.getNextSibling();\n-        return argumentsList.getChildCount() > 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4c2f86e5775c29a6e037631f4969e080f0b15168"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4c2f86e5775c29a6e037631f4969e080f0b15168", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/4c2f86e5775c29a6e037631f4969e080f0b15168", "committedDate": "2020-01-17T19:40:52Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}, "afterCommit": {"oid": "ac3b962a7a286ad7e201dc1be5ce9954b0717cc6", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/ac3b962a7a286ad7e201dc1be5ce9954b0717cc6", "committedDate": "2020-01-20T21:44:34Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MzA0Njk1", "url": "https://github.com/checkstyle/checkstyle/pull/7489#pullrequestreview-348304695", "createdAt": "2020-01-25T02:23:29Z", "commit": {"oid": "ac3b962a7a286ad7e201dc1be5ce9954b0717cc6"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQwMjoyMzoyOVrOFhua0g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNVQwMjoyNDozNFrOFhubDg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDkwNzg1OA==", "bodyText": "unfortunately I am not confident in this refactoring.\nPlease provide regression report for affected Checks that use this function.", "url": "https://github.com/checkstyle/checkstyle/pull/7489#discussion_r370907858", "createdAt": "2020-01-25T02:23:29Z", "author": {"login": "romani"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/utils/BlockCommentPosition.java", "diffHunk": "@@ -169,15 +169,21 @@ public static boolean isOnConstructor(DetailAST blockComment) {\n      * @return true if node is before enum constant\n      */\n     public static boolean isOnEnumConstant(DetailAST blockComment) {\n-        final boolean isOnPlainConst = blockComment.getParent() != null\n-                && blockComment.getParent().getType() == TokenTypes.ENUM_CONSTANT_DEF\n-                && getPrevSiblingSkipComments(blockComment).getType() == TokenTypes.ANNOTATIONS\n-                && getPrevSiblingSkipComments(blockComment).getChildCount() == 0;\n-        final boolean isOnConstWithAnnotation = !isOnPlainConst && blockComment.getParent() != null\n-                && blockComment.getParent().getType() == TokenTypes.ANNOTATION\n-                && blockComment.getParent().getParent().getParent().getType()\n-                    == TokenTypes.ENUM_CONSTANT_DEF;\n-        return isOnPlainConst || isOnConstWithAnnotation;\n+        final DetailAST parent = blockComment.getParent();\n+        boolean result = false;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac3b962a7a286ad7e201dc1be5ce9954b0717cc6"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDkwNzkxOA==", "bodyText": "Do we need this test ?\nWe try to avoid pure UTs as much as possible.", "url": "https://github.com/checkstyle/checkstyle/pull/7489#discussion_r370907918", "createdAt": "2020-01-25T02:24:34Z", "author": {"login": "romani"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/DetailAstImplTest.java", "diffHunk": "@@ -134,6 +135,22 @@ public void testGetChildCount() throws Exception {\n         assertEquals(firstLevelA, firstLevelB.getPreviousSibling(), \"Invalid previous sibling\");\n     }\n \n+    @Test\n+    public void testHasChildren() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ac3b962a7a286ad7e201dc1be5ce9954b0717cc6"}, "originalPosition": 13}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "41651b88c8b430864d04fa8b4cc2401fd2889494", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/41651b88c8b430864d04fa8b4cc2401fd2889494", "committedDate": "2020-01-25T07:18:39Z", "message": "Issue #7487: add method hasChildren() to DetailAST"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ac3b962a7a286ad7e201dc1be5ce9954b0717cc6", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/ac3b962a7a286ad7e201dc1be5ce9954b0717cc6", "committedDate": "2020-01-20T21:44:34Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}, "afterCommit": {"oid": "c1be1f7f0e4c9d7e28d1e8624d4bf3f169cdb2b9", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/c1be1f7f0e4c9d7e28d1e8624d4bf3f169cdb2b9", "committedDate": "2020-01-25T07:18:39Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c1be1f7f0e4c9d7e28d1e8624d4bf3f169cdb2b9", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/c1be1f7f0e4c9d7e28d1e8624d4bf3f169cdb2b9", "committedDate": "2020-01-25T07:18:39Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}, "afterCommit": {"oid": "394c6967e1787bd6f51c157a588845259541bc25", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/394c6967e1787bd6f51c157a588845259541bc25", "committedDate": "2020-01-25T09:29:38Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "394c6967e1787bd6f51c157a588845259541bc25", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/394c6967e1787bd6f51c157a588845259541bc25", "committedDate": "2020-01-25T09:29:38Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}, "afterCommit": {"oid": "9ea61df42604db4ea6447c9dbc2582138386b287", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9ea61df42604db4ea6447c9dbc2582138386b287", "committedDate": "2020-01-25T13:52:03Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "885af2af382b5830c2ec03591d4a64920fbdd28f", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/885af2af382b5830c2ec03591d4a64920fbdd28f", "committedDate": "2020-01-25T13:52:34Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9ea61df42604db4ea6447c9dbc2582138386b287", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9ea61df42604db4ea6447c9dbc2582138386b287", "committedDate": "2020-01-25T13:52:03Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}, "afterCommit": {"oid": "885af2af382b5830c2ec03591d4a64920fbdd28f", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/885af2af382b5830c2ec03591d4a64920fbdd28f", "committedDate": "2020-01-25T13:52:34Z", "message": "Issue #7487: refactor code to use DetailAST.hasChildren()"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1225, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}