{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ4Nzk5NjYz", "number": 8445, "title": "Issue #7498: add github actions file to generate diff report", "bodyText": "#7498\nAdding .yml file, which generates diff report for every pull request.\nTriggers on opening, reopening, editing and new commit of pull request and when someone write comment \"report\".\nAlso, the body of pull request should contain two lines:\nDiff Regression projects: {{URI to file like projects-to-test-on.properties}}\nDiff Regression config: {{URI to file like my_checks.xml}}\nResult: new comment from github-actions bot with link on generated diff report\nRequirements:\nAs it push reports to aws bucket you will need:\n\n\nsecrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n\n\nsecrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n\n\nsecrets.GITHUB_TOKEN - to sent new comment by github-actions bot [built-in github token]\n\n\n.yml file start working only when it is located on master branch, so you need to merge it to master.\n\n\nAn example of how it works I created on my second account: jack1515#1\nExample of pr with no links: jack1515#3", "createdAt": "2020-07-14T10:41:37Z", "url": "https://github.com/checkstyle/checkstyle/pull/8445", "merged": true, "mergeCommit": {"oid": "26d0571a354074c056ab076ac0a1a9897a0138ad"}, "closed": true, "closedAt": "2020-07-14T14:16:48Z", "author": {"login": "kate2513"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc0z0xygFqTQ0Nzk5ODAyMw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc02vOaAFqTQ0ODE0OTQ3OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ3OTk4MDIz", "url": "https://github.com/checkstyle/checkstyle/pull/8445#pullrequestreview-447998023", "createdAt": "2020-07-14T10:51:33Z", "commit": {"oid": "612d47016529e0e7b60a9febcec0af0a60cf3938"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMDo1MTozNFrOGxOeNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMDo1Mjo1MVrOGxOhDA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDUxOQ==", "bodyText": "need to add new line to file end", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454270519", "createdAt": "2020-07-14T10:51:34Z", "author": {"login": "strkkk"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p origin/${{needs.parse_body.outputs.branch}} -c config.xml -l proj.properties\n+        \n+     - name: Configure AWS Credentials\n+       uses: aws-actions/configure-aws-credentials@v1\n+       with:\n+        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n+        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n+        aws-region: ${{ env.AWS_REGION }}\n+       \n+     - name: Copy Report to AWS S3 Bucket\n+       run: |\n+        bash\n+        TEST_VAR=`date +%Y%H%M%S`\n+        aws s3 cp ./contribution/checkstyle-tester/reports/diff s3://${{ env.AWS_BUCKET_NAME }}/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/ --recursive\n+        echo https://${{env.AWS_BUCKET_NAME}}.s3.${{env.AWS_REGION}}.amazonaws.com/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/index.html > message\n+        \n+     - name: Set output\n+       id: out\n+       run: echo ::set-output name=message::$(cat message)   \n+      \n+     - name: Comment PR\n+       uses:  kate2513/javascript-test-action@master \n+       with:\n+        message: ${{steps.out.outputs.message}}\n+        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "612d47016529e0e7b60a9febcec0af0a60cf3938"}, "originalPosition": 145}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDc4MA==", "bodyText": "line is too long - should be less than 100 chars", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454270780", "createdAt": "2020-07-14T10:52:06Z", "author": {"login": "strkkk"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p origin/${{needs.parse_body.outputs.branch}} -c config.xml -l proj.properties\n+        \n+     - name: Configure AWS Credentials\n+       uses: aws-actions/configure-aws-credentials@v1\n+       with:\n+        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n+        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n+        aws-region: ${{ env.AWS_REGION }}\n+       \n+     - name: Copy Report to AWS S3 Bucket\n+       run: |\n+        bash\n+        TEST_VAR=`date +%Y%H%M%S`\n+        aws s3 cp ./contribution/checkstyle-tester/reports/diff s3://${{ env.AWS_BUCKET_NAME }}/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/ --recursive", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "612d47016529e0e7b60a9febcec0af0a60cf3938"}, "originalPosition": 134}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDg5Nw==", "bodyText": "same here", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454270897", "createdAt": "2020-07-14T10:52:18Z", "author": {"login": "strkkk"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p origin/${{needs.parse_body.outputs.branch}} -c config.xml -l proj.properties\n+        \n+     - name: Configure AWS Credentials\n+       uses: aws-actions/configure-aws-credentials@v1\n+       with:\n+        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n+        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n+        aws-region: ${{ env.AWS_REGION }}\n+       \n+     - name: Copy Report to AWS S3 Bucket\n+       run: |\n+        bash\n+        TEST_VAR=`date +%Y%H%M%S`\n+        aws s3 cp ./contribution/checkstyle-tester/reports/diff s3://${{ env.AWS_BUCKET_NAME }}/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/ --recursive\n+        echo https://${{env.AWS_BUCKET_NAME}}.s3.${{env.AWS_REGION}}.amazonaws.com/${{needs.parse_body.outputs.branch}}_$TEST_VAR/reports/diff/index.html > message", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "612d47016529e0e7b60a9febcec0af0a60cf3938"}, "originalPosition": 135}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MDk3MA==", "bodyText": "same here", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454270970", "createdAt": "2020-07-14T10:52:26Z", "author": {"login": "strkkk"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p origin/${{needs.parse_body.outputs.branch}} -c config.xml -l proj.properties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "612d47016529e0e7b60a9febcec0af0a60cf3938"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MTA4Nw==", "bodyText": "same here", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454271087", "createdAt": "2020-07-14T10:52:37Z", "author": {"login": "strkkk"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"fail\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: (needs.parse_body.outputs.proj_link != 'fail') && (needs.parse_body.outputs.config_link != 'fail')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "612d47016529e0e7b60a9febcec0af0a60cf3938"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3MTI0NA==", "bodyText": "same here", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454271244", "createdAt": "2020-07-14T10:52:51Z", "author": {"login": "strkkk"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: (github.event_name == 'pull_request') || (github.event_name == 'issue_comment' && github.event.comment.body == 'report')", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "612d47016529e0e7b60a9febcec0af0a60cf3938"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MDAyOTYy", "url": "https://github.com/checkstyle/checkstyle/pull/8445#pullrequestreview-448002962", "createdAt": "2020-07-14T10:59:23Z", "commit": {"oid": "612d47016529e0e7b60a9febcec0af0a60cf3938"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMDo1OToyM1rOGxOt5Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMDo1OToyM1rOGxOt5Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDI3NDUzMw==", "bodyText": "Chekstyle -> Checkstyle \nthere is a typo", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454274533", "createdAt": "2020-07-14T10:59:23Z", "author": {"login": "strkkk"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,145 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Chekstyle report.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "612d47016529e0e7b60a9febcec0af0a60cf3938"}, "originalPosition": 2}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f6aebd7ec5cff012ae5e0aa4fde5acd7bd91fc88", "author": {"user": {"login": "kate2513", "name": "\u0415\u043a\u0430\u0442\u0435\u0440\u0438\u043d\u0430 \u0413\u043e\u043b\u043e\u0432\u0438\u043d\u0430"}}, "url": "https://github.com/checkstyle/checkstyle/commit/f6aebd7ec5cff012ae5e0aa4fde5acd7bd91fc88", "committedDate": "2020-07-14T12:02:40Z", "message": "Issue #7498: whitelist.words updated"}, "afterCommit": {"oid": "411968f37718cba8d39786d2e82d6123833b978d", "author": {"user": {"login": "kate2513", "name": "\u0415\u043a\u0430\u0442\u0435\u0440\u0438\u043d\u0430 \u0413\u043e\u043b\u043e\u0432\u0438\u043d\u0430"}}, "url": "https://github.com/checkstyle/checkstyle/commit/411968f37718cba8d39786d2e82d6123833b978d", "committedDate": "2020-07-14T12:31:02Z", "message": "Issue #7498: add github actions file to generate diff report\n\n Issue #7498: fixed lines\n\nIssue #7498: whitelist.words updated"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5", "author": {"user": {"login": "kate2513", "name": "\u0415\u043a\u0430\u0442\u0435\u0440\u0438\u043d\u0430 \u0413\u043e\u043b\u043e\u0432\u0438\u043d\u0430"}}, "url": "https://github.com/checkstyle/checkstyle/commit/cd33a599db08b8401aee6d2d40e564acd012dba5", "committedDate": "2020-07-14T13:08:15Z", "message": "Issue #7498: add github actions file to generate diff report"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "411968f37718cba8d39786d2e82d6123833b978d", "author": {"user": {"login": "kate2513", "name": "\u0415\u043a\u0430\u0442\u0435\u0440\u0438\u043d\u0430 \u0413\u043e\u043b\u043e\u0432\u0438\u043d\u0430"}}, "url": "https://github.com/checkstyle/checkstyle/commit/411968f37718cba8d39786d2e82d6123833b978d", "committedDate": "2020-07-14T12:31:02Z", "message": "Issue #7498: add github actions file to generate diff report\n\n Issue #7498: fixed lines\n\nIssue #7498: whitelist.words updated"}, "afterCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5", "author": {"user": {"login": "kate2513", "name": "\u0415\u043a\u0430\u0442\u0435\u0440\u0438\u043d\u0430 \u0413\u043e\u043b\u043e\u0432\u0438\u043d\u0430"}}, "url": "https://github.com/checkstyle/checkstyle/commit/cd33a599db08b8401aee6d2d40e564acd012dba5", "committedDate": "2020-07-14T13:08:15Z", "message": "Issue #7498: add github actions file to generate diff report"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MTAyMjYz", "url": "https://github.com/checkstyle/checkstyle/pull/8445#pullrequestreview-448102263", "createdAt": "2020-07-14T13:25:00Z", "commit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMzoyNTowMFrOGxThyA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMzoyNTowMFrOGxThyA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM1MzM1Mg==", "bodyText": "Maybe thoughts for the future, to start a discussion:\nWhat about handling PRs where only patch regression (no comparison to master)? This is for things like new checks.\nWhat about handling PRs where base config is different from patch config? This is for things like where we split properties, change property types, add a new property, etc...", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454353352", "createdAt": "2020-07-14T13:25:00Z", "author": {"login": "rnveach"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         bash\n+         REF=\"origin/${{needs.parse_body.outputs.branch}}\"\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p $REF -c config.xml -l proj.properties", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 123}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MTI1ODE2", "url": "https://github.com/checkstyle/checkstyle/pull/8445#pullrequestreview-448125816", "createdAt": "2020-07-14T13:51:26Z", "commit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxMzo1MToyNlrOGxUobQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNFQxNDowNTozNVrOGxVQIQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3MTQzNw==", "bodyText": "what is pro ?\nplease use full word", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454371437", "createdAt": "2020-07-14T13:51:26Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3MTgzMQ==", "bodyText": "proj -> project\nno need to be cryptic.", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454371831", "createdAt": "2020-07-14T13:52:00Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NDU1MQ==", "bodyText": "Parsing issue comment", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454374551", "createdAt": "2020-07-14T13:55:43Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NDk1OQ==", "bodyText": "please use \" in around all variable references, fix all other cases", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454374959", "createdAt": "2020-07-14T13:56:17Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NTIzMg==", "bodyText": "Parsing PR description", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454375232", "createdAt": "2020-07-14T13:56:34Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NTcyMg==", "bodyText": "Parsing content of PR comment/description", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454375722", "createdAt": "2020-07-14T13:57:16Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 53}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3Njg0Ng==", "bodyText": "grep \"^Diff Regression projects:\" text | cat > temp\nplease use the same for all other cases like this.", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454376846", "createdAt": "2020-07-14T13:58:48Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 56}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3NzE3Ng==", "bodyText": "proj --> project", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454377176", "createdAt": "2020-07-14T13:59:18Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3ODA1Mw==", "bodyText": "should be project_link", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454378053", "createdAt": "2020-07-14T14:00:26Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 79}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3ODc0NA==", "bodyText": "what for this ?", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454378744", "createdAt": "2020-07-14T14:01:26Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 98}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3OTUxOQ==", "bodyText": "shoud we use fetch-depth ? ref ?\nas we did for checkstyle clone", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454379519", "createdAt": "2020-07-14T14:02:37Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 105}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM4MDgwNQ==", "bodyText": "please remove this, mercurial is used only for old jdk repos, right now all of them are on github.\nso such install is not required.", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454380805", "createdAt": "2020-07-14T14:04:28Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         bash\n+         REF=\"origin/${{needs.parse_body.outputs.branch}}\"\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 121}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM4MTYwMQ==", "bodyText": "this is ok for now , but should be changed in next PRs", "url": "https://github.com/checkstyle/checkstyle/pull/8445#discussion_r454381601", "createdAt": "2020-07-14T14:05:35Z", "author": {"login": "romani"}, "path": ".github/workflows/diff_report.yml", "diffHunk": "@@ -0,0 +1,150 @@\n+#------------------------------------------------------------------------------------\n+# Github Action to generate Checkstyle report.\n+# \n+# Workflow starts when:\n+# 1) pull request  - opened, reopened, synchronized, edited\n+# 2) issue comment - created\n+#\n+# Requirements:\n+# 1) secrets.AWS_ACCESS_KEY_ID - access key for AWS S3 service user\n+# 2) secrets.AWS_SECRET_ACCESS_KEY - security access key for AWS S3 service user\n+#\n+# If you need to change bucket name or region, change AWS_REGION and AWS_BUCKET_NAME variables.\n+# For another bucket, you will need to change the secrets.\n+#------------------------------------------------------------------------------------\n+name: Diff-Report\n+env:\n+  AWS_REGION: us-east-2\n+  AWS_BUCKET_NAME: \"checkstyle-diff-reports\"\n+on: \n+  pull_request:\n+    types: [opened, reopened, synchronize, edited]\n+  issue_comment:\n+    types: [created]\n+\n+jobs:\n+# Parse PR Body, search pro, xml links\n+  parse_body:\n+    if: github.event_name == 'pull_request' || github.event.comment.body == 'report'\n+    runs-on: ubuntu-latest\n+    outputs:\n+      proj_link: ${{ steps.parse.outputs.proj_link }}\n+      config_link: ${{ steps.parse.outputs.config_link }}\n+      user: ${{ steps.branch.outputs.user }}\n+      branch: ${{ steps.branch.outputs.ref }}\n+      \n+    steps:\n+    \n+     - name: Issue comment action\n+       if: github.event_name == 'issue_comment'\n+       run: |\n+        echo \"${{github.event.issue.body}}\" > text\n+        echo \"${{github.event.issue.user.login}}\" > user\n+        wget -q ${{github.event.issue.pull_request.url}} -O info.json\n+        jq .head.ref info.json > branch\n+       \n+     - name: PR action\n+       if: github.event_name == 'pull_request'\n+       run: |\n+        echo \"${{github.event.pull_request.body}}\" > text\n+        echo ${{github.event.pull_request.user.login}} > user\n+        echo ${{github.event.pull_request.head.ref}} > branch\n+        \n+     - name: Parse body\n+       id: parse\n+       run: |\n+        grep \"^Diff Regression projects:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression projects: //' temp > proj\n+        echo ::set-output name=proj_link::$(cat proj)\n+        grep \"^Diff Regression config:\" text > temp || echo \"\" > temp\n+        sed 's/Diff Regression config: //' temp > config\n+        echo ::set-output name=config_link::$(cat config)\n+        \n+     - name: Set branch and head_label\n+       id: branch\n+       run: |\n+        echo ::set-output name=user::$(cat user)\n+        echo ::set-output name=ref::$(cat branch)\n+      \n+     - name: info\n+       run: |\n+        cat user\n+        cat branch\n+        echo ${{steps.branch.outputs.ref}}\n+        echo ${{steps.branch.outputs.user}}:\n+     \n+  make_report:\n+    runs-on: ubuntu-latest\n+    needs: parse_body\n+    if: needs.parse_body.outputs.proj_link != '' && needs.parse_body.outputs.config_link != ''\n+    steps: \n+       \n+     - name: Download files\n+       run: |\n+        wget -q ${{needs.parse_body.outputs.proj_link}} -O proj.properties\n+        wget -q ${{needs.parse_body.outputs.config_link}} -O config.xml\n+        \n+     - name: Download checkstyle\n+       uses: actions/checkout@v2\n+       with:\n+        repository: ${{needs.parse_body.outputs.user}}/checkstyle\n+        ref: master\n+        path: checkstyle\n+        fetch-depth: 0\n+        \n+     - name: Check branches\n+       run: |\n+         cd checkstyle\n+         git branch -r\n+         cd ../\n+     \n+     - name: Download contribution\n+       uses: actions/checkout@v2\n+       with:\n+        repository: checkstyle/contribution\n+        path: contribution\n+         \n+     - name: Print branch\n+       run: |\n+         echo ${{needs.parse_body.outputs.branch}}\n+         \n+     - name: Relocate .xml and .properties \n+       run: |\n+         mv config.xml ./contribution/checkstyle-tester/\n+         mv proj.properties ./contribution/checkstyle-tester/\n+         \n+     - name: Generate report\n+       run: |\n+         bash\n+         REF=\"origin/${{needs.parse_body.outputs.branch}}\"\n+         cd contribution/checkstyle-tester\n+         sudo apt-get install mercurial\n+         sudo apt install groovy\n+         groovy diff.groovy -r ../../checkstyle -b master -p $REF -c config.xml -l proj.properties\n+        \n+     - name: Configure AWS Credentials\n+       uses: aws-actions/configure-aws-credentials@v1\n+       with:\n+        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n+        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n+        aws-region: ${{ env.AWS_REGION }}\n+       \n+     - name: Copy Report to AWS S3 Bucket\n+       run: |\n+        bash\n+        TIME=`date +%Y%H%M%S`\n+        FOLDER=\"${{needs.parse_body.outputs.branch}}_$TIME\"\n+        DIFF=\"./contribution/checkstyle-tester/reports/diff\"\n+        LINK=\"https://${{env.AWS_BUCKET_NAME}}.s3.${{env.AWS_REGION}}.amazonaws.com\"\n+        aws s3 cp $DIFF s3://${{env.AWS_BUCKET_NAME}}/$FOLDER/reports/diff/ --recursive\n+        echo $LINK/$FOLDER/reports/diff/index.html > message\n+        \n+     - name: Set output\n+       id: out\n+       run: echo ::set-output name=message::$(cat message)   \n+      \n+     - name: Comment PR\n+       uses:  kate2513/javascript-test-action@master ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "originalPosition": 147}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MTQzNjAz", "url": "https://github.com/checkstyle/checkstyle/pull/8445#pullrequestreview-448143603", "createdAt": "2020-07-14T14:10:27Z", "commit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ4MTQ5NDc4", "url": "https://github.com/checkstyle/checkstyle/pull/8445#pullrequestreview-448149478", "createdAt": "2020-07-14T14:16:36Z", "commit": {"oid": "cd33a599db08b8401aee6d2d40e564acd012dba5"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 473, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}