{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTEzNjA1Mjc1", "number": 8950, "title": "config: make semaphore ci commands easy to run on local", "bodyText": "From #8920 (comment)\n\none day this execution will fail in CI in PR, contributor might not be very experienced in CI to figureout how to reproduce it on local, so we will share with him link to single line in config for simple copy and paste in terminal, and it works.", "createdAt": "2020-11-01T11:31:13Z", "url": "https://github.com/checkstyle/checkstyle/pull/8950", "merged": true, "mergeCommit": {"oid": "88ec7af3ba14383111e75e6bc0b5985ba6dc665f"}, "closed": true, "closedAt": "2020-11-02T14:33:30Z", "author": {"login": "pbludov"}, "timelineItems": {"totalCount": 16, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYO0GqABqjM5NDUxMDQ4MTc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdYgBHgABqjM5NDY3NjE3NDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca754d43aa53665abce1ad1ca272c685d3c2f7da", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/ca754d43aa53665abce1ad1ca272c685d3c2f7da", "committedDate": "2020-11-01T11:30:15Z", "message": "infra: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "bb85a09d3a06173d06125311fcf3f3521c1b5c48", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/bb85a09d3a06173d06125311fcf3f3521c1b5c48", "committedDate": "2020-11-01T12:06:25Z", "message": "infra: make semaphore ci commands easy to run on local"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bb85a09d3a06173d06125311fcf3f3521c1b5c48", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/bb85a09d3a06173d06125311fcf3f3521c1b5c48", "committedDate": "2020-11-01T12:06:25Z", "message": "infra: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "eedbf0617d69f09aef2fc3d784dbd1aa38a4b587", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/eedbf0617d69f09aef2fc3d784dbd1aa38a4b587", "committedDate": "2020-11-01T12:26:59Z", "message": "infra: make semaphore ci commands easy to run on local"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eedbf0617d69f09aef2fc3d784dbd1aa38a4b587", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/eedbf0617d69f09aef2fc3d784dbd1aa38a4b587", "committedDate": "2020-11-01T12:26:59Z", "message": "infra: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "07e21d93846dccc66d1ea27f8f0684960b8fdfdf", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/07e21d93846dccc66d1ea27f8f0684960b8fdfdf", "committedDate": "2020-11-01T12:38:28Z", "message": "infra: make semaphore ci commands easy to run on local"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "07e21d93846dccc66d1ea27f8f0684960b8fdfdf", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/07e21d93846dccc66d1ea27f8f0684960b8fdfdf", "committedDate": "2020-11-01T12:38:28Z", "message": "infra: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "2cccc21e3c75018e793a4740477a81a56cb118d1", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/2cccc21e3c75018e793a4740477a81a56cb118d1", "committedDate": "2020-11-01T12:47:19Z", "message": "infra: make semaphore ci commands easy to run on local"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMjI2NDc1", "url": "https://github.com/checkstyle/checkstyle/pull/8950#pullrequestreview-521226475", "createdAt": "2020-11-01T13:50:57Z", "commit": {"oid": "2cccc21e3c75018e793a4740477a81a56cb118d1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMjMwODA0", "url": "https://github.com/checkstyle/checkstyle/pull/8950#pullrequestreview-521230804", "createdAt": "2020-11-01T14:41:53Z", "commit": {"oid": "2cccc21e3c75018e793a4740477a81a56cb118d1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQxNDo0MTo1M1rOHrvlaQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQxNDo0MTo1M1rOHrvlaQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTYzMDQ0MQ==", "bodyText": "check-missing-pitests was assigned priority 10 originally, and no-error-pmd was assigned 80. Now, priority assignment will be automatic from semaphore. Out of all these tests, no-error-pmd is the most frequently failed one for me, so I think that it made sense for it to have higher priority so that the build fails faster and not waste time/resources. I am not sure how many builds we can run in parallel, and if this even matters, but I thought it would be good to mention.", "url": "https://github.com/checkstyle/checkstyle/pull/8950#discussion_r515630441", "createdAt": "2020-11-01T14:41:53Z", "author": {"login": "nmancus1"}, "path": ".semaphore/semaphore.yml", "diffHunk": "@@ -56,34 +34,22 @@ blocks:\n             - sem-version java 8 # NonDex only supports Java 8\n             - .ci/validation.sh nondex\n \n-        - name: No error test on pmd\n-          priority:\n-            - value: 80\n-              when: true\n-          commands:\n-            - mvn -e install -Pno-validations\n-            - .ci/validation.sh no-error-pmd\n-\n-        - name: No error test on Configurate\n-          priority:\n-            - value: 80\n-              when: true\n-          commands:\n-            - sem-version java 14\n-            - mvn -e install -Pno-validations\n-            - .ci/validation.sh no-violation-test-configurate\n-\n-        - name: No violation testing on josm\n-          commands:\n-            - mvn -e install -Pno-validations\n-            - .ci/validation.sh no-violation-test-josm\n-\n-        - name: No exception test\n+        - name: Validation (openjdk11)\n           matrix:\n-            - env_var: PROJECT\n+            - env_var: CMD\n               values:\n-                - guava-with-google-checks\n-                - guava-with-sun-checks\n-          commands:\n-            - mvn -e install -Pno-validations\n-            - .ci/no-exception-test.sh $PROJECT\n+                - .ci/no-exception-test.sh guava-with-google-checks\n+                - .ci/no-exception-test.sh guava-with-sun-checks\n+                - .ci/validation.sh all-sevntu-checks\n+                - .ci/validation.sh check-missing-pitests\n+                - .ci/validation.sh eclipse-static-analysis\n+                - .ci/validation.sh no-error-pmd", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2cccc21e3c75018e793a4740477a81a56cb118d1"}, "originalPosition": 78}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2cccc21e3c75018e793a4740477a81a56cb118d1", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/2cccc21e3c75018e793a4740477a81a56cb118d1", "committedDate": "2020-11-01T12:47:19Z", "message": "infra: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "fc39e5605b5046916f4ac3f253ae1401f9164f98", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/fc39e5605b5046916f4ac3f253ae1401f9164f98", "committedDate": "2020-11-01T15:08:11Z", "message": "infra: make semaphore ci commands easy to run on local"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fc39e5605b5046916f4ac3f253ae1401f9164f98", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/fc39e5605b5046916f4ac3f253ae1401f9164f98", "committedDate": "2020-11-01T15:08:11Z", "message": "infra: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "c66c8b70adcaf75838ef8f8f2b071c35d39145aa", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/c66c8b70adcaf75838ef8f8f2b071c35d39145aa", "committedDate": "2020-11-01T15:11:51Z", "message": "infra: make semaphore ci commands easy to run on local"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c66c8b70adcaf75838ef8f8f2b071c35d39145aa", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/c66c8b70adcaf75838ef8f8f2b071c35d39145aa", "committedDate": "2020-11-01T15:11:51Z", "message": "infra: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "dfaae93003442e2a93f132248b25eae35eb58040", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/dfaae93003442e2a93f132248b25eae35eb58040", "committedDate": "2020-11-01T15:28:57Z", "message": "config: make semaphore ci commands easy to run on local"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMjM0Nzky", "url": "https://github.com/checkstyle/checkstyle/pull/8950#pullrequestreview-521234792", "createdAt": "2020-11-01T15:30:19Z", "commit": {"oid": "dfaae93003442e2a93f132248b25eae35eb58040"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dfaae93003442e2a93f132248b25eae35eb58040", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/dfaae93003442e2a93f132248b25eae35eb58040", "committedDate": "2020-11-01T15:28:57Z", "message": "config: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "f091136533b661b6b019e656d4a703878bd73e1c", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/f091136533b661b6b019e656d4a703878bd73e1c", "committedDate": "2020-11-01T15:46:26Z", "message": "config: make semaphore ci commands easy to run on local"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f091136533b661b6b019e656d4a703878bd73e1c", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/f091136533b661b6b019e656d4a703878bd73e1c", "committedDate": "2020-11-01T15:46:26Z", "message": "config: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "dfe962d0e32b56000d5f35925cbef1ccb062372c", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/dfe962d0e32b56000d5f35925cbef1ccb062372c", "committedDate": "2020-11-01T19:24:02Z", "message": "config: make semaphore ci commands easy to run on local"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxMjU3Nzcy", "url": "https://github.com/checkstyle/checkstyle/pull/8950#pullrequestreview-521257772", "createdAt": "2020-11-01T20:24:05Z", "commit": {"oid": "dfe962d0e32b56000d5f35925cbef1ccb062372c"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQyMDoyNDowNVrOHrx2IQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMVQyMDoyNDowNVrOHrx2IQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY2NzQ4OQ==", "bodyText": "put fast in front... it will also group them a better  to read way\nmake it like:\n                - .ci/validation.sh all-sevntu-checks\n                - .ci/validation.sh check-missing-pitests\n                - .ci/validation.sh eclipse-static-analysis\n                - mvn -e clean install -Pno-validations\n                    && .ci/no-exception-test.sh guava-with-google-checks\n                - mvn -e clean install -Pno-validations\n                    && .ci/no-exception-test.sh guava-with-sun-checks\n                - mvn -e clean install -Pno-validations\n                    && .ci/validation.sh no-violation-test-josm", "url": "https://github.com/checkstyle/checkstyle/pull/8950#discussion_r515667489", "createdAt": "2020-11-01T20:24:05Z", "author": {"login": "romani"}, "path": ".semaphore/semaphore.yml", "diffHunk": "@@ -27,63 +27,55 @@ blocks:\n               cache store m2 $HOME/.m2\n             fi\n       jobs:\n-        - name: Check for missing pitests\n-          priority:\n-            - value: 10\n-              when: true\n-          commands:\n-            - .ci/validation.sh check-missing-pitests\n-\n-        - name: Eclipse static analysis\n-          priority:\n-            - value: 10\n-              when: true\n-          commands:\n-            - .ci/validation.sh eclipse-static-analysis\n-\n-        - name: Ensure that all Sevntu check are used\n-          priority:\n-            - value: 10\n-              when: true\n-          commands:\n-            - .ci/validation.sh all-sevntu-checks\n-\n         - name: NonDex (openjdk8)\n           priority:\n-            - value: 80\n+            - value: 90\n               when: true\n+          matrix:\n+            - env_var: CMD\n+              values:\n+                - .ci/validation.sh nondex\n           commands:\n             - sem-version java 8 # NonDex only supports Java 8\n-            - .ci/validation.sh nondex\n-\n-        - name: No error test on pmd\n-          priority:\n-            - value: 80\n-              when: true\n-          commands:\n-            - mvn -e install -Pno-validations\n-            - .ci/validation.sh no-error-pmd\n+            - echo \"eval of CMD is starting\";\n+            - echo \"CMD=$CMD\";\n+            - eval $CMD;\n+            - echo \"eval of CMD is completed\";\n \n-        - name: No error test on Configurate\n+        - name: Validation (openjdk11, slow pool)\n           priority:\n             - value: 80\n               when: true\n+          matrix:\n+            - env_var: CMD\n+              values:\n+                - mvn -e clean install -Pno-validations\n+                    && .ci/validation.sh no-error-pmd\n+                - mvn -e clean install -Pno-validations\n+                    && .ci/validation.sh no-violation-test-configurate\n           commands:\n-            - sem-version java 14\n-            - mvn -e install -Pno-validations\n-            - .ci/validation.sh no-violation-test-configurate\n-\n-        - name: No violation testing on josm\n-          commands:\n-            - mvn -e install -Pno-validations\n-            - .ci/validation.sh no-violation-test-josm\n+            - sem-version java 11\n+            - echo \"eval of CMD is starting\";\n+            - echo \"CMD=$CMD\";\n+            - eval $CMD;\n+            - echo \"eval of CMD is completed\";\n \n-        - name: No exception test\n+        - name: Validation (openjdk11, fast pool)\n           matrix:\n-            - env_var: PROJECT\n+            - env_var: CMD\n               values:\n-                - guava-with-google-checks\n-                - guava-with-sun-checks\n+                - mvn -e clean install -Pno-validations\n+                    && .ci/no-exception-test.sh guava-with-google-checks\n+                - mvn -e clean install -Pno-validations\n+                    && .ci/no-exception-test.sh guava-with-sun-checks\n+                - .ci/validation.sh all-sevntu-checks\n+                - .ci/validation.sh check-missing-pitests\n+                - .ci/validation.sh eclipse-static-analysis\n+                - mvn -e clean install -Pno-validations", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "dfe962d0e32b56000d5f35925cbef1ccb062372c"}, "originalPosition": 101}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dfe962d0e32b56000d5f35925cbef1ccb062372c", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/dfe962d0e32b56000d5f35925cbef1ccb062372c", "committedDate": "2020-11-01T19:24:02Z", "message": "config: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "8cadd66da43994102442029b99776b1e21cbbe29", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/8cadd66da43994102442029b99776b1e21cbbe29", "committedDate": "2020-11-01T20:29:19Z", "message": "config: make semaphore ci commands easy to run on local"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ac28e84a8df9627db63fc3abe9a8d11202c6d1ee", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/ac28e84a8df9627db63fc3abe9a8d11202c6d1ee", "committedDate": "2020-11-02T08:09:09Z", "message": "config: make semaphore ci commands easy to run on local"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8cadd66da43994102442029b99776b1e21cbbe29", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/8cadd66da43994102442029b99776b1e21cbbe29", "committedDate": "2020-11-01T20:29:19Z", "message": "config: make semaphore ci commands easy to run on local"}, "afterCommit": {"oid": "ac28e84a8df9627db63fc3abe9a8d11202c6d1ee", "author": {"user": {"login": "pbludov", "name": "Pavel Bludov"}}, "url": "https://github.com/checkstyle/checkstyle/commit/ac28e84a8df9627db63fc3abe9a8d11202c6d1ee", "committedDate": "2020-11-02T08:09:09Z", "message": "config: make semaphore ci commands easy to run on local"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1385, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}