{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg5ODk2MDgw", "number": 7882, "title": "Issue #6988: Sort XPath Results in Document Order", "bodyText": "Resolves #6988\nExtending the work and implementing @rnveach's sort criteria discussed in PR #7485.\nExample from: #7485 (comment)\n$ cat test.java\n\npublic class test {\n    void method() {\n    }\n}\n\nBefore:\n$  java -jar checkstyle-8.29-all.jar -b \"//CLASS_DEF/*\" test.java \nCLASS_DEF -> CLASS_DEF [1:0]\n|--IDENT -> test [1:13]\n---------\nCLASS_DEF -> CLASS_DEF [1:0]\n|--LITERAL_CLASS -> class [1:7]\n---------\nCLASS_DEF -> CLASS_DEF [1:0]\n|--MODIFIERS -> MODIFIERS [1:0]\n---------\nCLASS_DEF -> CLASS_DEF [1:0]\n`--OBJBLOCK -> OBJBLOCK [1:18]\n\nAfter:\n$ java -jar checkstyle-8.31-SNAPSHOT-all.jar -b \"//CLASS_DEF/*\" test.java\nCLASS_DEF -> CLASS_DEF [1:0]\n|--MODIFIERS -> MODIFIERS [1:0]\n---------\nCLASS_DEF -> CLASS_DEF [1:0]\n|--LITERAL_CLASS -> class [1:7]\n---------\nCLASS_DEF -> CLASS_DEF [1:0]\n|--IDENT -> test [1:13]\n---------\nCLASS_DEF -> CLASS_DEF [1:0]\n`--OBJBLOCK -> OBJBLOCK [1:18]\n\nDiff Report: https://gaurabdg.github.io/checkstyle-tester-reports/regression/XPathSort/diff/", "createdAt": "2020-03-17T15:10:29Z", "url": "https://github.com/checkstyle/checkstyle/pull/7882", "merged": true, "mergeCommit": {"oid": "9b11abca1807e715f267fa74365ec7bdb6ffaace"}, "closed": true, "closedAt": "2020-04-18T13:10:26Z", "author": {"login": "gaurabdg"}, "timelineItems": {"totalCount": 39, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcOlz_lABqjMxMzgyNDcwMzU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcY1o-FgFqTM5NTkxMjY3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6577c3ae71fad61437ada50bfe01c5ca0860a766", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/6577c3ae71fad61437ada50bfe01c5ca0860a766", "committedDate": "2020-03-17T14:52:04Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "9a59bcef22a298d2cea76d34bc07b73f602c9870", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9a59bcef22a298d2cea76d34bc07b73f602c9870", "committedDate": "2020-03-17T17:03:42Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a59bcef22a298d2cea76d34bc07b73f602c9870", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9a59bcef22a298d2cea76d34bc07b73f602c9870", "committedDate": "2020-03-17T17:03:42Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "d4692760829471270e7e16258d957e282bc2dc2e", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/d4692760829471270e7e16258d957e282bc2dc2e", "committedDate": "2020-03-17T23:50:34Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d4692760829471270e7e16258d957e282bc2dc2e", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/d4692760829471270e7e16258d957e282bc2dc2e", "committedDate": "2020-03-17T23:50:34Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/8f299ad249e59706cc2e2194d053d88ca5bafb4a", "committedDate": "2020-03-18T00:06:45Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MzQ3NDQ2", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-377347446", "createdAt": "2020-03-19T01:02:54Z", "commit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMTowMjo1NFrOF4cZwg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQwMTowNzozNlrOF4cj-w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcyOTkyMg==", "bodyText": "@gaurabdg @timurt How often is compareOrder called for different queries? Is it a big impact that we have to calculate the depth each time it is called?", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r394729922", "createdAt": "2020-03-19T01:02:54Z", "author": {"login": "rnveach"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -81,6 +81,23 @@ public ElementNode(AbstractNode root, AbstractNode parent, DetailAST detailAst)\n         createChildren();\n     }\n \n+    /**\n+     * Compares current object with specified for order.\n+     * @param other another {@code NodeInfo} object\n+     * @return number representing order of current object to specified one\n+     */\n+    @Override\n+    public int compareOrder(NodeInfo other) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDczMDAzNA==", "bodyText": "Shouldn't this line be part of if (other != null) {?", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r394730034", "createdAt": "2020-03-19T01:03:18Z", "author": {"login": "rnveach"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -81,6 +81,23 @@ public ElementNode(AbstractNode root, AbstractNode parent, DetailAST detailAst)\n         createChildren();\n     }\n \n+    /**\n+     * Compares current object with specified for order.\n+     * @param other another {@code NodeInfo} object\n+     * @return number representing order of current object to specified one\n+     */\n+    @Override\n+    public int compareOrder(NodeInfo other) {\n+        int result = 0;\n+        if (other != null) {\n+            result = getRootDepth(this) - getRootDepth(other);\n+        }\n+        if (result == 0 && other instanceof ElementNode) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDczMjUzOQ==", "bodyText": "Why is there a check for null? Does this not happen naturally?", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r394732539", "createdAt": "2020-03-19T01:07:36Z", "author": {"login": "rnveach"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/ElementNodeTest.java", "diffHunk": "@@ -58,6 +58,14 @@ public void init() throws Exception {\n         rootNode = new RootNode(rootAst);\n     }\n \n+    @Test\n+    public void testCompareOrderWrongInstance() throws Exception {\n+        final String xpath = \"//OBJBLOCK\";\n+        final List<NodeInfo> nodes = getXpathItems(xpath, rootNode);\n+        final int result = nodes.get(0).compareOrder(null);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "originalPosition": 8}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/8f299ad249e59706cc2e2194d053d88ca5bafb4a", "committedDate": "2020-03-18T00:06:45Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "c54ebad102e47d9766bf8778495db0f4badc9f33", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/c54ebad102e47d9766bf8778495db0f4badc9f33", "committedDate": "2020-03-19T06:35:08Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c54ebad102e47d9766bf8778495db0f4badc9f33", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/c54ebad102e47d9766bf8778495db0f4badc9f33", "committedDate": "2020-03-19T06:35:08Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "7e688965b6322c2dd4bd287ca0d007f9c4a23cb3", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/7e688965b6322c2dd4bd287ca0d007f9c4a23cb3", "committedDate": "2020-03-19T09:35:45Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7e688965b6322c2dd4bd287ca0d007f9c4a23cb3", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/7e688965b6322c2dd4bd287ca0d007f9c4a23cb3", "committedDate": "2020-03-19T09:35:45Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "37f5435b04b1e07164a8399579bb3fecd13aa7f0", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/37f5435b04b1e07164a8399579bb3fecd13aa7f0", "committedDate": "2020-03-19T09:43:00Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "37f5435b04b1e07164a8399579bb3fecd13aa7f0", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/37f5435b04b1e07164a8399579bb3fecd13aa7f0", "committedDate": "2020-03-19T09:43:00Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "0d47c369352de47f71dbb133f503a3e8b9c312c9", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/0d47c369352de47f71dbb133f503a3e8b9c312c9", "committedDate": "2020-03-19T12:59:00Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3NzM1NzQ1", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-377735745", "createdAt": "2020-03-19T13:49:24Z", "commit": {"oid": "0d47c369352de47f71dbb133f503a3e8b9c312c9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMzo0OToyNVrOF4vOjQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOVQxMzo0OToyNVrOF4vOjQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTAzODM0OQ==", "bodyText": "We are not expecting new items as we are trying to shrink the list. Let me review this before giving more guidance.", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r395038349", "createdAt": "2020-03-19T13:49:25Z", "author": {"login": "rnveach"}, "path": ".ci/pitest.sh", "diffHunk": "@@ -215,6 +215,14 @@ pitest-utils)\n   checkPitestReport \"${ignoredItems[@]}\"\n   ;;\n \n+pitest-xpath)\n+  mvn -e -P$1 clean test org.pitest:pitest-maven:mutationCoverage;\n+  declare -a ignoredItems=(\n+  \"ElementNode.java.html:<td class='covered'><pre><span  class='survived'>            if (parentDepth == -1) {</span></pre></td></tr>\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d47c369352de47f71dbb133f503a3e8b9c312c9"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0d47c369352de47f71dbb133f503a3e8b9c312c9", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/0d47c369352de47f71dbb133f503a3e8b9c312c9", "committedDate": "2020-03-19T12:59:00Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "a5ed95d2ff887815116704ca787ff28e0fe60976", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a5ed95d2ff887815116704ca787ff28e0fe60976", "committedDate": "2020-03-19T16:06:45Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzc3MDQ4OTc2", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-377048976", "createdAt": "2020-03-18T16:45:53Z", "commit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xOFQxNjo0NTo1NFrOF4N3Bg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yMlQxMTo1NjozNlrOF5vHYg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ5MTY1NA==", "bodyText": "@gaurabdg interesting approach, but can we store this depth inside object to avoid unnecessary calculations", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r394491654", "createdAt": "2020-03-18T16:45:54Z", "author": {"login": "timurt"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -81,6 +81,23 @@ public ElementNode(AbstractNode root, AbstractNode parent, DetailAST detailAst)\n         createChildren();\n     }\n \n+    /**\n+     * Compares current object with specified for order.\n+     * @param other another {@code NodeInfo} object\n+     * @return number representing order of current object to specified one\n+     */\n+    @Override\n+    public int compareOrder(NodeInfo other) {\n+        int result = 0;\n+        if (other != null) {\n+            result = getRootDepth(this) - getRootDepth(other);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ5Mzg2NQ==", "bodyText": "Could you also add more tests here\n\ncompare order between two sibling nodes\nparent not with child or even grand child node", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r394493865", "createdAt": "2020-03-18T16:49:13Z", "author": {"login": "timurt"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/ElementNodeTest.java", "diffHunk": "@@ -58,6 +58,14 @@ public void init() throws Exception {\n         rootNode = new RootNode(rootAst);\n     }\n \n+    @Test\n+    public void testCompareOrderWrongInstance() throws Exception {\n+        final String xpath = \"//OBJBLOCK\";\n+        final List<NodeInfo> nodes = getXpathItems(xpath, rootNode);\n+        final int result = nodes.get(0).compareOrder(null);\n+        assertEquals(0, result, \"Expected result wrong\");\n+    }\n+", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ5NjUxMQ==", "bodyText": "could you please also one more test, to query many nodes and check that results are sorted in document order,\nsimilar test I made for line/column approach here https://github.com/checkstyle/checkstyle/pull/7485/files#diff-39f05e8712ca7f402d8723874f834436R966", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r394496511", "createdAt": "2020-03-18T16:52:54Z", "author": {"login": "timurt"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/XpathMapperTest.java", "diffHunk": "@@ -946,7 +946,7 @@ public void testQueryElementPrecedingTwo() throws Exception {\n         final DetailAST expectedPackageDefNode = getSiblingByType(rootNode.getUnderlyingNode(),\n                 TokenTypes.PACKAGE_DEF);\n         final DetailAST expectedAnnotationsNode = expectedPackageDefNode.getFirstChild();\n-        final DetailAST[] expected = {expectedAnnotationsNode, expectedPackageDefNode};\n+        final DetailAST[] expected = {expectedPackageDefNode, expectedAnnotationsNode};\n         assertThat(\"Result nodes differ from expected\", actual, equalTo(expected));\n     }\n ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4NDgwMg==", "bodyText": "you need to check this.nodeDepth  == -1 and only then starting calculating current depth. Otherwise this method will make extra redundant calculations", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r396084802", "createdAt": "2020-03-22T11:52:54Z", "author": {"login": "timurt"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -154,6 +175,36 @@ public NodeInfo getRoot() {\n         return root;\n     }\n \n+    /**\n+     * Sets Node Depth.\n+     * @param nodeDepth Depth of the Node\n+     */\n+    public void setNodeDepth(int nodeDepth) {\n+        this.nodeDepth = nodeDepth;\n+    }\n+\n+    /**\n+     * Calculates the depth of the node from the root of the tree.\n+     * @return number representing depth of the node\n+     */\n+    public int calcRootDepth() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5ed95d2ff887815116704ca787ff28e0fe60976"}, "originalPosition": 57}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4NDgxNg==", "bodyText": "@gaurabdg please add tests", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r396084816", "createdAt": "2020-03-22T11:53:05Z", "author": {"login": "timurt"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/ElementNodeTest.java", "diffHunk": "@@ -58,6 +58,14 @@ public void init() throws Exception {\n         rootNode = new RootNode(rootAst);\n     }\n \n+    @Test\n+    public void testCompareOrderWrongInstance() throws Exception {\n+        final String xpath = \"//OBJBLOCK\";\n+        final List<NodeInfo> nodes = getXpathItems(xpath, rootNode);\n+        final int result = nodes.get(0).compareOrder(null);\n+        assertEquals(0, result, \"Expected result wrong\");\n+    }\n+", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ5Mzg2NQ=="}, "originalCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4NDgzMQ==", "bodyText": "@gaurabdg please add test", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r396084831", "createdAt": "2020-03-22T11:53:19Z", "author": {"login": "timurt"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/XpathMapperTest.java", "diffHunk": "@@ -946,7 +946,7 @@ public void testQueryElementPrecedingTwo() throws Exception {\n         final DetailAST expectedPackageDefNode = getSiblingByType(rootNode.getUnderlyingNode(),\n                 TokenTypes.PACKAGE_DEF);\n         final DetailAST expectedAnnotationsNode = expectedPackageDefNode.getFirstChild();\n-        final DetailAST[] expected = {expectedAnnotationsNode, expectedPackageDefNode};\n+        final DetailAST[] expected = {expectedPackageDefNode, expectedAnnotationsNode};\n         assertThat(\"Result nodes differ from expected\", actual, equalTo(expected));\n     }\n ", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDQ5NjUxMQ=="}, "originalCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjA4NTA5MA==", "bodyText": "@gaurabdg @rnveach\nMy suggestion was - we can set nodeDepth during constructing xpath tree\nnodeDepth will field be of the AbstractNode class\nRootNode.nodeDepth will be zero\nand at this line we will have:\nnodeDepth = parent.nodeDepth + 1;\nand that's all, share your ideas", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r396085090", "createdAt": "2020-03-22T11:56:36Z", "author": {"login": "timurt"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -75,12 +78,30 @@ public ElementNode(AbstractNode root, AbstractNode parent, DetailAST detailAst)\n         this.parent = parent;\n         this.root = root;\n         this.detailAst = detailAst;\n+        nodeDepth = -1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a5ed95d2ff887815116704ca787ff28e0fe60976"}, "originalPosition": 14}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a5ed95d2ff887815116704ca787ff28e0fe60976", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a5ed95d2ff887815116704ca787ff28e0fe60976", "committedDate": "2020-03-19T16:06:45Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "0b9425aae9c3a313df18db145b5dc6bce1819d91", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/0b9425aae9c3a313df18db145b5dc6bce1819d91", "committedDate": "2020-03-25T15:32:35Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0b9425aae9c3a313df18db145b5dc6bce1819d91", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/0b9425aae9c3a313df18db145b5dc6bce1819d91", "committedDate": "2020-03-25T15:32:35Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "9b9f4c8c58527172b3803ec62a734056ad080da5", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9b9f4c8c58527172b3803ec62a734056ad080da5", "committedDate": "2020-03-25T16:00:36Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9b9f4c8c58527172b3803ec62a734056ad080da5", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9b9f4c8c58527172b3803ec62a734056ad080da5", "committedDate": "2020-03-25T16:00:36Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "019c8cf427eddbf12b9b808d7075ee51665292cc", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/019c8cf427eddbf12b9b808d7075ee51665292cc", "committedDate": "2020-03-25T16:20:10Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDAyMjcx", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-381402271", "createdAt": "2020-03-25T18:00:04Z", "commit": {"oid": "019c8cf427eddbf12b9b808d7075ee51665292cc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxODowMDowNFrOF7npqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNVQxODozMToxMlrOF7o5AQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA1OTk0Nw==", "bodyText": "I am not sure ElementNodeTest is appropriate class for this method, please move it to XpathMapperTest", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r398059947", "createdAt": "2020-03-25T18:00:04Z", "author": {"login": "timurt"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/ElementNodeTest.java", "diffHunk": "@@ -58,6 +59,61 @@ public void init() throws Exception {\n         rootNode = new RootNode(rootAst);\n     }\n \n+    @Test\n+    public void testNodeOrdering() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "019c8cf427eddbf12b9b808d7075ee51665292cc"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODA4MDI1Nw==", "bodyText": "I executed this test with different compareOrder method implementation, it always passes, it is not ok\nAs far as I understand this depth approach, it should be fully correlate with line/column ordering.\nIt means for all nodes in getXpathItems(xpath, rootNode); the following condition is true:\nnode[i].lineNumber < node[j].lineNumber or (node[i].lineNumber = node[j].lineNumber and node[i].columnNumber < node[j].columnNumber) where i < j.\nIt is easier to write because all NodeInfo subclasses implement getLineNumber(), getColumnNumber() using real DetailAst values.\nThere is more difficult way to write this test:\n\nget results from getXpathItems(xpath, rootNode);\nconvert them to DetailAST[] using convertToArray(List<NodeInfo> nodes) method\nget rootAst from RootNode\ntraverse rootAst with DFS and check that all elements DetailAST[] appear in exact same order", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r398080257", "createdAt": "2020-03-25T18:31:12Z", "author": {"login": "timurt"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/ElementNodeTest.java", "diffHunk": "@@ -58,6 +59,61 @@ public void init() throws Exception {\n         rootNode = new RootNode(rootAst);\n     }\n \n+    @Test\n+    public void testNodeOrdering() throws Exception {\n+        final String xpath = \"//METHOD_DEF[./IDENT[@text='callSomeMethod']]/SLIST/*\";\n+        final List<NodeInfo> nodes = getXpathItems(xpath, rootNode);\n+        final boolean result = nodes", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "019c8cf427eddbf12b9b808d7075ee51665292cc"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "019c8cf427eddbf12b9b808d7075ee51665292cc", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/019c8cf427eddbf12b9b808d7075ee51665292cc", "committedDate": "2020-03-25T16:20:10Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "e8e3057bc39059585ee17694403ee3b50db5ed96", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/e8e3057bc39059585ee17694403ee3b50db5ed96", "committedDate": "2020-03-26T10:28:16Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e8e3057bc39059585ee17694403ee3b50db5ed96", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/e8e3057bc39059585ee17694403ee3b50db5ed96", "committedDate": "2020-03-26T10:28:16Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "dfb78626b609dff4bfb954f5f1729004bb91d697", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/dfb78626b609dff4bfb954f5f1729004bb91d697", "committedDate": "2020-03-26T13:57:55Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "dfb78626b609dff4bfb954f5f1729004bb91d697", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/dfb78626b609dff4bfb954f5f1729004bb91d697", "committedDate": "2020-03-26T13:57:55Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "a9b8a62ba814e885353598e147f2a42afee90484", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a9b8a62ba814e885353598e147f2a42afee90484", "committedDate": "2020-03-26T14:17:13Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a9b8a62ba814e885353598e147f2a42afee90484", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a9b8a62ba814e885353598e147f2a42afee90484", "committedDate": "2020-03-26T14:17:13Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "2ed348be8b603c64b3c54d548c913e9f4e4afa0a", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/2ed348be8b603c64b3c54d548c913e9f4e4afa0a", "committedDate": "2020-03-26T17:23:06Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2ed348be8b603c64b3c54d548c913e9f4e4afa0a", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/2ed348be8b603c64b3c54d548c913e9f4e4afa0a", "committedDate": "2020-03-26T17:23:06Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "0192c262564c14d2df40bd7e68ab688c1edd537f", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/0192c262564c14d2df40bd7e68ab688c1edd537f", "committedDate": "2020-03-26T23:13:35Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MDI5OTU2", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-385029956", "createdAt": "2020-03-31T19:15:20Z", "commit": {"oid": "0192c262564c14d2df40bd7e68ab688c1edd537f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxOToxNToyMVrOF-kc2Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0zMVQxOToxNToyOVrOF-kdGw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE1MzI0MQ==", "bodyText": "@gaurabdg\nXpathMapperTest should contain tests those test different xpath queries, like you did in testNodeOrdering()\nHere you test compareOrder method of ElementNode class and there is no xpath query, so I would suggest to move this test to ElementNodeTest", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r401153241", "createdAt": "2020-03-31T19:15:21Z", "author": {"login": "timurt"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/XpathMapperTest.java", "diffHunk": "@@ -45,6 +48,65 @@ protected String getPackageLocation() {\n         return \"com/puppycrawl/tools/checkstyle/xpath/xpathmapper\";\n     }\n \n+    @Test\n+    public void testNodeOrdering() throws Exception {\n+        final String xpath = \"//METHOD_DEF[./IDENT[@text='callSomeMethod']]/SLIST/*\";\n+        final RootNode rootNode = getRootNode(\"InputXpathMapperAst.java\");\n+        final List<NodeInfo> nodes = getXpathItems(xpath, rootNode);\n+        for (int i = 1; i < nodes.size(); i++) {\n+            final NodeInfo curr = nodes.get(i);\n+            final NodeInfo prev = nodes.get(i - 1);\n+\n+            if (curr.getLineNumber() == prev.getLineNumber()) {\n+                assertWithMessage(\"Column number is not in document order\")\n+                    .that(curr.getColumnNumber())\n+                    .isGreaterThan(prev.getColumnNumber());\n+            }\n+            else {\n+                assertWithMessage(\"Line number is not in document order\")\n+                    .that(curr.getLineNumber())\n+                    .isGreaterThan(prev.getLineNumber());\n+            }\n+        }\n+    }\n+\n+    @Test\n+    public void testParentChildOrdering() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0192c262564c14d2df40bd7e68ab688c1edd537f"}, "originalPosition": 48}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTE1MzMwNw==", "bodyText": "same here", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r401153307", "createdAt": "2020-03-31T19:15:29Z", "author": {"login": "timurt"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/XpathMapperTest.java", "diffHunk": "@@ -45,6 +48,65 @@ protected String getPackageLocation() {\n         return \"com/puppycrawl/tools/checkstyle/xpath/xpathmapper\";\n     }\n \n+    @Test\n+    public void testNodeOrdering() throws Exception {\n+        final String xpath = \"//METHOD_DEF[./IDENT[@text='callSomeMethod']]/SLIST/*\";\n+        final RootNode rootNode = getRootNode(\"InputXpathMapperAst.java\");\n+        final List<NodeInfo> nodes = getXpathItems(xpath, rootNode);\n+        for (int i = 1; i < nodes.size(); i++) {\n+            final NodeInfo curr = nodes.get(i);\n+            final NodeInfo prev = nodes.get(i - 1);\n+\n+            if (curr.getLineNumber() == prev.getLineNumber()) {\n+                assertWithMessage(\"Column number is not in document order\")\n+                    .that(curr.getColumnNumber())\n+                    .isGreaterThan(prev.getColumnNumber());\n+            }\n+            else {\n+                assertWithMessage(\"Line number is not in document order\")\n+                    .that(curr.getLineNumber())\n+                    .isGreaterThan(prev.getLineNumber());\n+            }\n+        }\n+    }\n+\n+    @Test\n+    public void testParentChildOrdering() throws Exception {\n+        final RootNode rootNode = getRootNode(\"InputXpathMapperAst.java\");\n+        final DetailAstImpl detailAST = new DetailAstImpl();\n+        detailAST.setType(TokenTypes.VARIABLE_DEF);\n+\n+        final DetailAstImpl parentAST = new DetailAstImpl();\n+        parentAST.setFirstChild(detailAST);\n+        parentAST.setType(TokenTypes.METHOD_DEF);\n+\n+        final AbstractNode parentNode = new ElementNode(rootNode, rootNode, parentAST);\n+        final AbstractNode childNode = new ElementNode(rootNode, parentNode, detailAST);\n+        assertEquals(-1, parentNode.compareOrder(childNode), \"Incorrect ordering value\");\n+        assertEquals(1, childNode.compareOrder(parentNode), \"Incorrect ordering value\");\n+    }\n+\n+    @Test\n+    public void testSiblingsOrdering() throws Exception {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0192c262564c14d2df40bd7e68ab688c1edd537f"}, "originalPosition": 64}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0192c262564c14d2df40bd7e68ab688c1edd537f", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/0192c262564c14d2df40bd7e68ab688c1edd537f", "committedDate": "2020-03-26T23:13:35Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "34b3fd8ee0c12ac6fd606a770065e9facb20de58", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/34b3fd8ee0c12ac6fd606a770065e9facb20de58", "committedDate": "2020-03-31T19:45:40Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "34b3fd8ee0c12ac6fd606a770065e9facb20de58", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/34b3fd8ee0c12ac6fd606a770065e9facb20de58", "committedDate": "2020-03-31T19:45:40Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "e16716ea0b377d31ae4a755c1f081cb0d1cab848", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/e16716ea0b377d31ae4a755c1f081cb0d1cab848", "committedDate": "2020-03-31T19:54:58Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg1MjYwMTQ0", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-385260144", "createdAt": "2020-04-01T04:37:07Z", "commit": {"oid": "e16716ea0b377d31ae4a755c1f081cb0d1cab848"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e16716ea0b377d31ae4a755c1f081cb0d1cab848", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/e16716ea0b377d31ae4a755c1f081cb0d1cab848", "committedDate": "2020-03-31T19:54:58Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "1db5280cf15c0cc224e0246237627be0b26c93d4", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/1db5280cf15c0cc224e0246237627be0b26c93d4", "committedDate": "2020-04-01T14:44:22Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3Njc2Njcw", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-387676670", "createdAt": "2020-04-04T07:32:44Z", "commit": {"oid": "1db5280cf15c0cc224e0246237627be0b26c93d4"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQwNzozMjo0NFrOGAv52Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wNFQwNzo0MDozMFrOGAv8sQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQzODA0MQ==", "bodyText": "This test fails for the xpath \"//METHOD_DEF/SLIST/*\"", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r403438041", "createdAt": "2020-04-04T07:32:44Z", "author": {"login": "pbludov"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/xpath/XpathMapperTest.java", "diffHunk": "@@ -45,6 +46,28 @@ protected String getPackageLocation() {\n         return \"com/puppycrawl/tools/checkstyle/xpath/xpathmapper\";\n     }\n \n+    @Test\n+    public void testNodeOrdering() throws Exception {\n+        final String xpath = \"//METHOD_DEF[./IDENT[@text='callSomeMethod']]/SLIST/*\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1db5280cf15c0cc224e0246237627be0b26c93d4"}, "originalPosition": 14}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQzODc2OQ==", "bodyText": "The order of cousins will be wrong. Consider\nCLASS_DEF\n   METHOD_DEF1\n       VARIABLE_DEF1-1\n       VARIABLE_DEF1-2\n   METHOD_DEF2\n       VARIABLE_DEF2-1\n       VARIABLE_DEF2-2\n\nThe list of nodes for the xpath \"//VARIABLE_DEF\" will be VARIABLE_DEF1-1, VARIABLE_DEF2-1,VARIABLE_DEF2-2,VARIABLE_DEF1-2.\nWe still need some sort of recursion here. When the depth is different, the result is clear.\nWhen the depth matches, there should be a check for order for the parent nodes (in case both nodes do not belong to the same parent).", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r403438769", "createdAt": "2020-04-04T07:40:30Z", "author": {"login": "pbludov"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -81,6 +81,23 @@ public ElementNode(AbstractNode root, AbstractNode parent, DetailAST detailAst)\n         createChildren();\n     }\n \n+    /**\n+     * Compares current object with specified for order.\n+     * @param other another {@code NodeInfo} object\n+     * @return number representing order of current object to specified one\n+     */\n+    @Override\n+    public int compareOrder(NodeInfo other) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDcyOTkyMg=="}, "originalCommit": {"oid": "8f299ad249e59706cc2e2194d053d88ca5bafb4a"}, "originalPosition": 10}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1db5280cf15c0cc224e0246237627be0b26c93d4", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/1db5280cf15c0cc224e0246237627be0b26c93d4", "committedDate": "2020-04-01T14:44:22Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "a1ede9ea147db3229fb09d388191a4d634199ca9", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a1ede9ea147db3229fb09d388191a4d634199ca9", "committedDate": "2020-04-04T13:08:55Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a1ede9ea147db3229fb09d388191a4d634199ca9", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a1ede9ea147db3229fb09d388191a4d634199ca9", "committedDate": "2020-04-04T13:08:55Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "ca7398893c1a57f85262e3a878dcf453d4a46ac1", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/ca7398893c1a57f85262e3a878dcf453d4a46ac1", "committedDate": "2020-04-04T13:29:19Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg3NzA1NDYy", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-387705462", "createdAt": "2020-04-04T14:45:57Z", "commit": {"oid": "ca7398893c1a57f85262e3a878dcf453d4a46ac1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzg5OTYyNDkw", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-389962490", "createdAt": "2020-04-08T13:16:03Z", "commit": {"oid": "ca7398893c1a57f85262e3a878dcf453d4a46ac1"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkyMTg2NDg1", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-392186485", "createdAt": "2020-04-13T14:39:52Z", "commit": {"oid": "ca7398893c1a57f85262e3a878dcf453d4a46ac1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNDozOTo1MlrOGEomLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xM1QxNDozOTo1MlrOGEomLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzUxMjYyMg==", "bodyText": "We check instance to be ElementNode but do a cast to AbstractNode. Shouldn't both be the same class?", "url": "https://github.com/checkstyle/checkstyle/pull/7882#discussion_r407512622", "createdAt": "2020-04-13T14:39:52Z", "author": {"login": "rnveach"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -77,10 +77,45 @@ public ElementNode(AbstractNode root, AbstractNode parent, DetailAST detailAst)\n         this.detailAst = detailAst;\n         text = TokenUtil.getTokenName(detailAst.getType());\n         indexAmongSiblings = parent.getChildren().size();\n+        setDepth(parent.getDepth() + 1);\n         createTextAttribute();\n         createChildren();\n     }\n \n+    /**\n+     * Compares current object with specified for order.\n+     * @param other another {@code NodeInfo} object\n+     * @return number representing order of current object to specified one\n+     */\n+    @Override\n+    public int compareOrder(NodeInfo other) {\n+        int result = 0;\n+        if (other instanceof ElementNode) {\n+            result = getDepth() - ((AbstractNode) other).getDepth();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ca7398893c1a57f85262e3a878dcf453d4a46ac1"}, "originalPosition": 18}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ca7398893c1a57f85262e3a878dcf453d4a46ac1", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/ca7398893c1a57f85262e3a878dcf453d4a46ac1", "committedDate": "2020-04-04T13:29:19Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "2497bcf5980fd851ab424238693293e0991314ed", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/2497bcf5980fd851ab424238693293e0991314ed", "committedDate": "2020-04-13T17:07:42Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2497bcf5980fd851ab424238693293e0991314ed", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/2497bcf5980fd851ab424238693293e0991314ed", "committedDate": "2020-04-13T17:07:42Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "5cb1e87e446de9ee6380004f4702103be7112ea3", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/5cb1e87e446de9ee6380004f4702103be7112ea3", "committedDate": "2020-04-16T21:21:18Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5cb1e87e446de9ee6380004f4702103be7112ea3", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/5cb1e87e446de9ee6380004f4702103be7112ea3", "committedDate": "2020-04-16T21:21:18Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "2f611cc81c02a70aba44c0a87de6a1bd6d2e6992", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/2f611cc81c02a70aba44c0a87de6a1bd6d2e6992", "committedDate": "2020-04-16T21:25:17Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2f611cc81c02a70aba44c0a87de6a1bd6d2e6992", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/2f611cc81c02a70aba44c0a87de6a1bd6d2e6992", "committedDate": "2020-04-16T21:25:17Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "1b7aec062d6e506892e9395f0ea5c71faeb180c3", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/1b7aec062d6e506892e9395f0ea5c71faeb180c3", "committedDate": "2020-04-17T08:28:57Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1b7aec062d6e506892e9395f0ea5c71faeb180c3", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/1b7aec062d6e506892e9395f0ea5c71faeb180c3", "committedDate": "2020-04-17T08:28:57Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "74aa198bb8e5b3e41a7c81b121503a780ce619b0", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/74aa198bb8e5b3e41a7c81b121503a780ce619b0", "committedDate": "2020-04-17T08:36:37Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4cfdcaf060937dced01b80f8af19bda700343acc", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/4cfdcaf060937dced01b80f8af19bda700343acc", "committedDate": "2020-04-17T14:20:10Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "74aa198bb8e5b3e41a7c81b121503a780ce619b0", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/74aa198bb8e5b3e41a7c81b121503a780ce619b0", "committedDate": "2020-04-17T08:36:37Z", "message": "Issue #6988: Sort XPath results in Document Order"}, "afterCommit": {"oid": "4cfdcaf060937dced01b80f8af19bda700343acc", "author": {"user": {"login": "gaurabdg", "name": "Gaurab Dasgupta"}}, "url": "https://github.com/checkstyle/checkstyle/commit/4cfdcaf060937dced01b80f8af19bda700343acc", "committedDate": "2020-04-17T14:20:10Z", "message": "Issue #6988: Sort XPath results in Document Order"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk1OTEyNjcx", "url": "https://github.com/checkstyle/checkstyle/pull/7882#pullrequestreview-395912671", "createdAt": "2020-04-18T13:09:59Z", "commit": {"oid": "4cfdcaf060937dced01b80f8af19bda700343acc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 872, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}