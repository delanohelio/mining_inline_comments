{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTAxMTQzMDcx", "number": 8892, "title": "Issue #8879: fix local variable detection in resource node", "bodyText": "Closes #8879\nIssue is in common method for local variable definition detection, thus several checks are affected.\nDiff Regression projects: https://gist.githubusercontent.com/nmancus1/e3988f8092d919b5cbe70f5359c4d9e8/raw/a0f6f5860f8025c19868061dee6e0e40960b992f/projects-to-test-on.properties\nDiff Regression config: https://gist.githubusercontent.com/strkkk/ac73db2366737f5a2d9ac0b3a39e81fa/raw/88d42f4621b0802ae77b8bc50e20d437afa5b763/8879.xml\nReg report (checks that invoke this method directly or via isClassDeclarationDef method)\nhttps://checkstyle-diff-reports.s3.us-east-2.amazonaws.com/8879_local_variable_false_positive_2020151659/reports/diff/index.html\nIt shows that some other false positives have been fixed and also one NPE", "createdAt": "2020-10-11T14:06:23Z", "url": "https://github.com/checkstyle/checkstyle/pull/8892", "merged": true, "mergeCommit": {"oid": "516c8823119a0eb90fdfd768dd823c6a1bf3be7f"}, "closed": true, "closedAt": "2020-10-12T20:42:29Z", "author": {"login": "strkkk"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdRi8VIgFqTUwNjIwMDcwNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdR5QcjABqjM4NjgwMzM3NjQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MjAwNzA3", "url": "https://github.com/checkstyle/checkstyle/pull/8892#pullrequestreview-506200707", "createdAt": "2020-10-11T17:36:37Z", "commit": {"oid": "9baeffbe2fcc450c159a5f0375aa0b0251514e01"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2MjAwNzg3", "url": "https://github.com/checkstyle/checkstyle/pull/8892#pullrequestreview-506200787", "createdAt": "2020-10-11T17:37:48Z", "commit": {"oid": "9baeffbe2fcc450c159a5f0375aa0b0251514e01"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxNzozNzo0OFrOHfpSQg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMVQxNzozNzo0OFrOHfpSQg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjk0NDMyMg==", "bodyText": "Should it be node.getChildCount() > 1 ?", "url": "https://github.com/checkstyle/checkstyle/pull/8892#discussion_r502944322", "createdAt": "2020-10-11T17:37:48Z", "author": {"login": "pbludov"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/utils/ScopeUtil.java", "diffHunk": "@@ -266,7 +266,7 @@ public static boolean isLocalVariableDef(DetailAST node) {\n         }\n \n         if (node.getType() == TokenTypes.RESOURCE) {\n-            localVariableDef = true;\n+            localVariableDef = node.getChildCount() != 1;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9baeffbe2fcc450c159a5f0375aa0b0251514e01"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9baeffbe2fcc450c159a5f0375aa0b0251514e01", "author": {"user": {"login": "strkkk", "name": "Andrei Paikin"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9baeffbe2fcc450c159a5f0375aa0b0251514e01", "committedDate": "2020-10-11T14:04:16Z", "message": "Issue #8879: fix local variable detection in resource node"}, "afterCommit": {"oid": "28467fb6794b1088a9170c1c060e25eb16d798b6", "author": {"user": {"login": "strkkk", "name": "Andrei Paikin"}}, "url": "https://github.com/checkstyle/checkstyle/commit/28467fb6794b1088a9170c1c060e25eb16d798b6", "committedDate": "2020-10-11T19:01:33Z", "message": "Issue #8879: fix local variable detection in resource node"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "28467fb6794b1088a9170c1c060e25eb16d798b6", "author": {"user": {"login": "strkkk", "name": "Andrei Paikin"}}, "url": "https://github.com/checkstyle/checkstyle/commit/28467fb6794b1088a9170c1c060e25eb16d798b6", "committedDate": "2020-10-11T19:01:33Z", "message": "Issue #8879: fix local variable detection in resource node"}, "afterCommit": {"oid": "0f14c9df19f33ddd12f96c75f33de9a5d765842a", "author": {"user": {"login": "strkkk", "name": "Andrei Paikin"}}, "url": "https://github.com/checkstyle/checkstyle/commit/0f14c9df19f33ddd12f96c75f33de9a5d765842a", "committedDate": "2020-10-11T19:51:08Z", "message": "Issue #8879: fix local variable detection in resource node"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2Mjg1MDg0", "url": "https://github.com/checkstyle/checkstyle/pull/8892#pullrequestreview-506285084", "createdAt": "2020-10-12T04:29:16Z", "commit": {"oid": "0f14c9df19f33ddd12f96c75f33de9a5d765842a"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNDoyOToxNlrOHfurfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0xMlQwNDoyOToxNlrOHfurfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzAzMjcwMw==", "bodyText": "Can we avoid this type of tests ?\nWe did do much to avoid this level of fakes that make no good to code.", "url": "https://github.com/checkstyle/checkstyle/pull/8892#discussion_r503032703", "createdAt": "2020-10-12T04:29:16Z", "author": {"login": "romani"}, "path": "src/test/java/com/puppycrawl/tools/checkstyle/utils/ScopeUtilTest.java", "diffHunk": "@@ -166,7 +166,18 @@ public void testIsLocalVariableDefUnexpected() {\n \n     @Test\n     public void testIsLocalVariableDefResource() {\n-        assertTrue(ScopeUtil.isLocalVariableDef(getNode(TokenTypes.RESOURCE)), \"invalid result\");\n+        final DetailAstImpl resourceTwoChildren = getNode(TokenTypes.RESOURCE);\n+        final DetailAstImpl modifiers = new DetailAstImpl();\n+        modifiers.setType(TokenTypes.MODIFIERS);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0f14c9df19f33ddd12f96c75f33de9a5d765842a"}, "originalPosition": 7}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTA2NzkyMzg1", "url": "https://github.com/checkstyle/checkstyle/pull/8892#pullrequestreview-506792385", "createdAt": "2020-10-12T17:16:27Z", "commit": {"oid": "0f14c9df19f33ddd12f96c75f33de9a5d765842a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "0f14c9df19f33ddd12f96c75f33de9a5d765842a", "author": {"user": {"login": "strkkk", "name": "Andrei Paikin"}}, "url": "https://github.com/checkstyle/checkstyle/commit/0f14c9df19f33ddd12f96c75f33de9a5d765842a", "committedDate": "2020-10-11T19:51:08Z", "message": "Issue #8879: fix local variable detection in resource node"}, "afterCommit": {"oid": "efd4785ceb17050a50729718c6d012c6c4674c9c", "author": {"user": {"login": "strkkk", "name": "Andrei Paikin"}}, "url": "https://github.com/checkstyle/checkstyle/commit/efd4785ceb17050a50729718c6d012c6c4674c9c", "committedDate": "2020-10-12T19:16:16Z", "message": "Issue #8879: fix local variable detection in resource node"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7db3611b79fc59a2fe3923e83762b76757fa2c0d", "author": {"user": {"login": "strkkk", "name": "Andrei Paikin"}}, "url": "https://github.com/checkstyle/checkstyle/commit/7db3611b79fc59a2fe3923e83762b76757fa2c0d", "committedDate": "2020-10-12T19:35:43Z", "message": "Issue #8879: fix local variable detection in resource node"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "efd4785ceb17050a50729718c6d012c6c4674c9c", "author": {"user": {"login": "strkkk", "name": "Andrei Paikin"}}, "url": "https://github.com/checkstyle/checkstyle/commit/efd4785ceb17050a50729718c6d012c6c4674c9c", "committedDate": "2020-10-12T19:16:16Z", "message": "Issue #8879: fix local variable detection in resource node"}, "afterCommit": {"oid": "7db3611b79fc59a2fe3923e83762b76757fa2c0d", "author": {"user": {"login": "strkkk", "name": "Andrei Paikin"}}, "url": "https://github.com/checkstyle/checkstyle/commit/7db3611b79fc59a2fe3923e83762b76757fa2c0d", "committedDate": "2020-10-12T19:35:43Z", "message": "Issue #8879: fix local variable detection in resource node"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1348, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}