{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDA4NDM3Njc1", "number": 8177, "title": "Issue #5711: JavadocTagContinuationIndentation: no violation with block tag starting the line", "bodyText": "Fixes #5711, resolves #8183\nSimilar to #8002, the problem is with the logic behind how a violation is determined. Previously we only checked the TEXT node itself. If the TEXT is only a short whitespace (not enough indentation), we ignored it when in fact we need to check if there is a non-newline token (such as a JAVADOC_INLINE_TAG ) immediately after it.\nRegression: https://wltan.github.io/checkstyle-reports/2020-05-10/javadoctagcont-blocktag/\nThere are violations within Checkstyle itself which were not previously detected due to this issue. They can be found in the regression report as well. I've fixed those violations to use the correct indentation, in a separate commit so it's easier to tell from the main changes, and I'll squash it back into one commit if requested after review.\nInternal violations have been merged, and manual regression report is deprecated.\nDiff Regression projects: https://raw.githubusercontent.com/wltan/checkstyle-reports/master/auto-generate/pr-8177/projects-to-test-on.properties\nDiff Regression config: https://raw.githubusercontent.com/wltan/checkstyle-reports/master/auto-generate/pr-8177/my_check.xml", "createdAt": "2020-04-24T09:28:29Z", "url": "https://github.com/checkstyle/checkstyle/pull/8177", "merged": true, "mergeCommit": {"oid": "ac5bc13ea8d453397fe78e5727491d808c34b04f"}, "closed": true, "closedAt": "2021-02-21T15:52:39Z", "author": {"login": "wltan"}, "timelineItems": {"totalCount": 18, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcauu-FgBqjMyNjg3NzE1NDQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABd8K_JfgFqTU5NDgwNDU2NA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8bbcff325ec0a5a85637bd0fe4b398f54348c0d4", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/8bbcff325ec0a5a85637bd0fe4b398f54348c0d4", "committedDate": "2020-04-24T06:56:46Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "767bbcb57586398c32ba9ad5d88c30d4c94d0436", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/767bbcb57586398c32ba9ad5d88c30d4c94d0436", "committedDate": "2020-04-24T10:06:06Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "767bbcb57586398c32ba9ad5d88c30d4c94d0436", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/767bbcb57586398c32ba9ad5d88c30d4c94d0436", "committedDate": "2020-04-24T10:06:06Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "8e6dced13b8c383bfed98c3d738877249906db91", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/8e6dced13b8c383bfed98c3d738877249906db91", "committedDate": "2020-04-24T11:32:31Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8e6dced13b8c383bfed98c3d738877249906db91", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/8e6dced13b8c383bfed98c3d738877249906db91", "committedDate": "2020-04-24T11:32:31Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "83544eb34e57923d447d512aae731e79c58dec0e", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/83544eb34e57923d447d512aae731e79c58dec0e", "committedDate": "2020-04-24T12:11:34Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "83544eb34e57923d447d512aae731e79c58dec0e", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/83544eb34e57923d447d512aae731e79c58dec0e", "committedDate": "2020-04-24T12:11:34Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "89fb50f90b28fc9bd20e28794cdfdc33e66f0c99", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/89fb50f90b28fc9bd20e28794cdfdc33e66f0c99", "committedDate": "2020-04-24T12:17:02Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "89fb50f90b28fc9bd20e28794cdfdc33e66f0c99", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/89fb50f90b28fc9bd20e28794cdfdc33e66f0c99", "committedDate": "2020-04-24T12:17:02Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "4b21bb08b82814bdce8e6a20ed8dcd2cde1ac13b", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/4b21bb08b82814bdce8e6a20ed8dcd2cde1ac13b", "committedDate": "2020-05-08T07:43:31Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4b21bb08b82814bdce8e6a20ed8dcd2cde1ac13b", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/4b21bb08b82814bdce8e6a20ed8dcd2cde1ac13b", "committedDate": "2020-05-08T07:43:31Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "b110199bbd983212ab189c601126de854f49d196", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/b110199bbd983212ab189c601126de854f49d196", "committedDate": "2020-05-09T15:07:01Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b110199bbd983212ab189c601126de854f49d196", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/b110199bbd983212ab189c601126de854f49d196", "committedDate": "2020-05-09T15:07:01Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "68bfc469ce2d165298d7cbad09a8022721e36927", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/68bfc469ce2d165298d7cbad09a8022721e36927", "committedDate": "2020-11-09T00:08:43Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "68bfc469ce2d165298d7cbad09a8022721e36927", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/68bfc469ce2d165298d7cbad09a8022721e36927", "committedDate": "2020-11-09T00:08:43Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "a3a51c4f2910f4d8cd077219968ca39998e0374f", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a3a51c4f2910f4d8cd077219968ca39998e0374f", "committedDate": "2020-12-08T03:00:31Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a3a51c4f2910f4d8cd077219968ca39998e0374f", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a3a51c4f2910f4d8cd077219968ca39998e0374f", "committedDate": "2020-12-08T03:00:31Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "65da8f31d31011acb2d66342cf66d6376dbefde4", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/65da8f31d31011acb2d66342cf66d6376dbefde4", "committedDate": "2021-01-13T06:48:27Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "65da8f31d31011acb2d66342cf66d6376dbefde4", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/65da8f31d31011acb2d66342cf66d6376dbefde4", "committedDate": "2021-01-13T06:48:27Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "9f6ec5fa861ebcfe077fe576b9ca941f94ad09ff", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9f6ec5fa861ebcfe077fe576b9ca941f94ad09ff", "committedDate": "2021-01-18T04:43:44Z", "message": "minor: fix internal Checkstyle violations"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcwMzY5MTQz", "url": "https://github.com/checkstyle/checkstyle/pull/8177#pullrequestreview-570369143", "createdAt": "2021-01-18T10:43:38Z", "commit": {"oid": "9f6ec5fa861ebcfe077fe576b9ca941f94ad09ff"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9f6ec5fa861ebcfe077fe576b9ca941f94ad09ff", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/9f6ec5fa861ebcfe077fe576b9ca941f94ad09ff", "committedDate": "2021-01-18T04:43:44Z", "message": "minor: fix internal Checkstyle violations"}, "afterCommit": {"oid": "a588fd1dac43621cef62c6b7c9b80582008a6c34", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a588fd1dac43621cef62c6b7c9b80582008a6c34", "committedDate": "2021-01-19T03:48:48Z", "message": "Issue #5711: JavadocTagContinuationIndentation: no violation with block tag starting the line"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a588fd1dac43621cef62c6b7c9b80582008a6c34", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/a588fd1dac43621cef62c6b7c9b80582008a6c34", "committedDate": "2021-01-19T03:48:48Z", "message": "Issue #5711: JavadocTagContinuationIndentation: no violation with block tag starting the line"}, "afterCommit": {"oid": "96637b309ccaed9561249bea6203bab39094c980", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/96637b309ccaed9561249bea6203bab39094c980", "committedDate": "2021-02-08T16:13:02Z", "message": "Issue #5711: JavadocTagContinuationIndentation: no violation with block tag starting the line"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTg1NzU0OTU3", "url": "https://github.com/checkstyle/checkstyle/pull/8177#pullrequestreview-585754957", "createdAt": "2021-02-08T17:38:20Z", "commit": {"oid": "96637b309ccaed9561249bea6203bab39094c980"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wOFQxNzozODoyMFrOIhusww==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMi0wOFQxODowODozMFrOIhv-WQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MjIzOTA0Mw==", "bodyText": "Please add some more complicated test cases, such as:\n    /**\n     * Javadoc\n     * @param args  // ok\n     * {@code this} line is not correctly indented // violation\n     *    {@code this}  // ok\n     * <pre>this line is not correctly indented</pre> // violation\n     */\n\nAlso, it would be good to show violations for html tags and other problem areas for sequential lines, such as:\n    /**\n     * Javadoc\n     * @param args  // ok\n     * {@code this} line is not correctly indented // violation\n     * {@code this} line is not correctly indented // violation\n     * <pre>this line is not correctly indented</pre> // violation\n     */\nThere is a good test case with html list in diff report, too: https://checkstyle-diff-reports.s3.us-east-2.amazonaws.com/javadoctagcont-blocktag_2021170726/reports/diff/apache-ant/xref/home/runner/work/checkstyle/checkstyle/contribution/checkstyle-tester/repositories/apache-ant/src/main/org/apache/tools/ant/taskdefs/AbstractCvsTask.java.html#L749", "url": "https://github.com/checkstyle/checkstyle/pull/8177#discussion_r572239043", "createdAt": "2021-02-08T17:38:20Z", "author": {"login": "nmancus1"}, "path": "src/test/resources/com/puppycrawl/tools/checkstyle/checks/javadoc/javadoctagcontinuationindentation/InputJavadocTagContinuationIndentationBlockTag.java", "diffHunk": "@@ -0,0 +1,54 @@\n+package com.puppycrawl.tools.checkstyle.checks.javadoc.javadoctagcontinuationindentation;\n+\n+import java.io.Serializable;\n+\n+/**\n+ * Config:\n+ * offset = 4\n+ */\n+public class InputJavadocTagContinuationIndentationBlockTag {\n+\n+    /**\n+     * Example from issue 5711.\n+     * Returns the value represented by the specified string of the specified\n+     * type. Returns 0 for types other than float, double, int, and long.\n+     * @param text the string to be parsed.\n+     * @param type the token type of the text. Should be a constant of\n+     * {@link TokenTypes}. // violation\n+     * @return the double value represented by the string argument.\n+     */\n+    public static double parseDouble(String text, int type) {\n+        return 0;\n+    }\n+\n+    /**\n+     * Javadoc.\n+     *\n+     * @param x this line is normal\n+     * {@code this} line is wrongly indented // violation\n+     */", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "96637b309ccaed9561249bea6203bab39094c980"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3MjI1OTkyOQ==", "bodyText": "Maybe a bit more detail here.", "url": "https://github.com/checkstyle/checkstyle/pull/8177#discussion_r572259929", "createdAt": "2021-02-08T18:08:30Z", "author": {"login": "nmancus1"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/javadoc/JavadocTagContinuationIndentationCheck.java", "diffHunk": "@@ -175,18 +175,42 @@ public void visitJavadocToken(DetailNode ast) {\n             final List<DetailNode> textNodes = getAllNewlineNodes(ast);\n             for (DetailNode newlineNode : textNodes) {\n                 final DetailNode textNode = JavadocUtil.getNextSibling(newlineNode);\n-                if (textNode.getType() == JavadocTokenTypes.TEXT) {\n-                    final String text = textNode.getText();\n-                    if (!CommonUtil.isBlank(text.trim())\n-                            && (text.length() <= offset\n-                                    || !text.substring(1, offset + 1).trim().isEmpty())) {\n-                        log(textNode.getLineNumber(), MSG_KEY, offset);\n-                    }\n+                if (textNode.getType() == JavadocTokenTypes.TEXT && isViolation(textNode)) {\n+                    log(textNode.getLineNumber(), MSG_KEY, offset);\n                 }\n             }\n         }\n     }\n \n+    /**\n+     * Checks if a text node meets the criteria for a violation.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "96637b309ccaed9561249bea6203bab39094c980"}, "originalPosition": 19}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb32f8ade8d6ad1950267396e8e084fa2d7c6cc7", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/fb32f8ade8d6ad1950267396e8e084fa2d7c6cc7", "committedDate": "2021-02-19T18:10:00Z", "message": "Issue #5711: JavadocTagContinuationIndentation: no violation with block tag starting the line"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "96637b309ccaed9561249bea6203bab39094c980", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/96637b309ccaed9561249bea6203bab39094c980", "committedDate": "2021-02-08T16:13:02Z", "message": "Issue #5711: JavadocTagContinuationIndentation: no violation with block tag starting the line"}, "afterCommit": {"oid": "fb32f8ade8d6ad1950267396e8e084fa2d7c6cc7", "author": {"user": {"login": "wltan", "name": "Tan Wei Liang"}}, "url": "https://github.com/checkstyle/checkstyle/commit/fb32f8ade8d6ad1950267396e8e084fa2d7c6cc7", "committedDate": "2021-02-19T18:10:00Z", "message": "Issue #5711: JavadocTagContinuationIndentation: no violation with block tag starting the line"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk0NzQ3NjY4", "url": "https://github.com/checkstyle/checkstyle/pull/8177#pullrequestreview-594747668", "createdAt": "2021-02-20T12:25:46Z", "commit": {"oid": "fb32f8ade8d6ad1950267396e8e084fa2d7c6cc7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTk0ODA0NTY0", "url": "https://github.com/checkstyle/checkstyle/pull/8177#pullrequestreview-594804564", "createdAt": "2021-02-21T04:00:43Z", "commit": {"oid": "fb32f8ade8d6ad1950267396e8e084fa2d7c6cc7"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 541, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}