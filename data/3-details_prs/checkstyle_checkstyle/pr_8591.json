{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYxNjg2MDg4", "number": 8591, "title": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "bodyText": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath\nThis PR is to Find Node by Xpath.\nPreview\nCorrect Xpath Query:\nBefore\n\nAfter\n\nIncorrect Xpath Query:\nBefore:\n\nAfter:", "createdAt": "2020-08-02T04:03:22Z", "url": "https://github.com/checkstyle/checkstyle/pull/8591", "merged": true, "mergeCommit": {"oid": "3f045f19d40ed017fe4647d6dc2efcda73107e7e"}, "closed": true, "closedAt": "2020-08-13T10:03:14Z", "author": {"login": "developerhb"}, "timelineItems": {"totalCount": 12, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9PMM9AFqTQ2Mzg4MjE1Ng==", "endCursor": "Y3Vyc29yOnYyOpPPAAABc-L2W9gFqTQ2NTk0MjM4OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYzODgyMTU2", "url": "https://github.com/checkstyle/checkstyle/pull/8591#pullrequestreview-463882156", "createdAt": "2020-08-09T15:16:07Z", "commit": {"oid": "25d59aeab775a52b955bfcc2e7b714b67b87b7cc"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQxNToxNjowN1rOG97xgQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wOVQxNToxNzoxMVrOG97yCw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU5NTY0OQ==", "bodyText": "something like:\n    private boolean search(DetailAST root, String xpath, Stack<DetailAST> nodes) {\n       boolean result = false;\n        if(xpath.equals(XpathQueryGenerator.generateXpathQuery(root))) {\n                nodes.push(root);\n                result = false;\n        } else {\n        if(root.hasChildren()) {\n            DetailAST child = root.getFirstChild();    \n            while(child!=null)\n            {\n                if(search(child, xpath, nodes)) {\n                    nodes.push(root);\n                    result = true;\n                    break;\n                }\n                child = child.getNextSibling();\n            }\n        }\n\n        }\n\n        return result;\n    }", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r467595649", "createdAt": "2020-08-09T15:16:07Z", "author": {"login": "romani"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java", "diffHunk": "@@ -190,6 +191,63 @@ private void setColumnsInitialWidth() {\n         getColumn(\"Type\").setPreferredWidth(preferredTypeColumnWidth);\n     }\n \n+    /**\n+     * Search node by Xpath.\n+     * \n+     * @param root {@code DetailAST} root ast element\n+     * @param xpath {@code String} xpath query\n+     * @param nodes {@code Stack<DetailAST>} stack of nodes in selection path\n+     * @return {@code boolean} node found or not\n+     */\n+    private boolean search(DetailAST root, String xpath, Stack<DetailAST> nodes) {\n+        if(xpath.equals(XpathQueryGenerator.generateXpathQuery(root))) {\n+                nodes.push(root);\n+                return true;\n+        }\n+        \n+        if(root.hasChildren()) {\n+            DetailAST child = root.getFirstChild();    \n+            while(child!=null)\n+            {\n+                if(search(child, xpath, nodes)) {\n+                    nodes.push(root);\n+                    return true;\n+                }\n+                child = child.getNextSibling();\n+            }\n+        }\n+        return false;\n+    }", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25d59aeab775a52b955bfcc2e7b714b67b87b7cc"}, "originalPosition": 38}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU5NTc4Nw==", "bodyText": "expalin this update.\nif it is unrelated to your changes but non-required config - please send removal in separarte PR.", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r467595787", "createdAt": "2020-08-09T15:17:11Z", "author": {"login": "romani"}, "path": "config/import-control.xml", "diffHunk": "@@ -159,8 +159,8 @@\n     <!-- until https://github.com/checkstyle/checkstyle/issues/3095 -->\n     <allow pkg=\"antlr\"/>\n     <allow class=\"com.puppycrawl.tools.checkstyle.DetailAstImpl\"/>\n-    <allow class=\"java.nio.charset.StandardCharsets\" />", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "25d59aeab775a52b955bfcc2e7b714b67b87b7cc"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "25d59aeab775a52b955bfcc2e7b714b67b87b7cc", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/25d59aeab775a52b955bfcc2e7b714b67b87b7cc", "committedDate": "2020-08-02T03:53:05Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}, "afterCommit": {"oid": "c89fa97ce40425c55c87e1ca9dbfab7b21afa97b", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/c89fa97ce40425c55c87e1ca9dbfab7b21afa97b", "committedDate": "2020-08-10T03:56:12Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c89fa97ce40425c55c87e1ca9dbfab7b21afa97b", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/c89fa97ce40425c55c87e1ca9dbfab7b21afa97b", "committedDate": "2020-08-10T03:56:12Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}, "afterCommit": {"oid": "99a86e816e60c8090c0754f4a80c218c77a10430", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/99a86e816e60c8090c0754f4a80c218c77a10430", "committedDate": "2020-08-10T04:47:53Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "99a86e816e60c8090c0754f4a80c218c77a10430", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/99a86e816e60c8090c0754f4a80c218c77a10430", "committedDate": "2020-08-10T04:47:53Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}, "afterCommit": {"oid": "d46b3f8f07b61f54d92684cbbc0508d9b65c9ae4", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/d46b3f8f07b61f54d92684cbbc0508d9b65c9ae4", "committedDate": "2020-08-10T04:54:33Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0Nzc0Mjg5", "url": "https://github.com/checkstyle/checkstyle/pull/8591#pullrequestreview-464774289", "createdAt": "2020-08-11T06:12:56Z", "commit": {"oid": "c4ddc5f8aaf7a5b6334979cc4f98fa748a8f011f"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwNjoxMjo1NlrOG-puMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQwNjoxMjo1NlrOG-puMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM0ODQ2Ng==", "bodyText": "\\n^ wrong xpath query", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r468348466", "createdAt": "2020-08-11T06:12:56Z", "author": {"login": "romani"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java", "diffHunk": "@@ -190,6 +192,64 @@ private void setColumnsInitialWidth() {\n         getColumn(\"Type\").setPreferredWidth(preferredTypeColumnWidth);\n     }\n \n+    /**\n+     * Search node by Xpath.\n+     *\n+     * @param root {@code DetailAST} root ast element\n+     * @param xpath {@code String} xpath query\n+     * @param nodes {@code Deque<DetailAST>} stack of nodes in selection path\n+     * @return {@code boolean} node found or not\n+     */\n+    private static boolean search(DetailAST root, String xpath, Deque<DetailAST> nodes) {\n+        boolean result = false;\n+        if (xpath.equals(XpathQueryGenerator.generateXpathQuery(root))) {\n+            nodes.push(root);\n+            result = true;\n+        }\n+        else {\n+            if (root.hasChildren()) {\n+                DetailAST child = root.getFirstChild();\n+                while (child != null) {\n+                    if (search(child, xpath, nodes)) {\n+                        nodes.push(root);\n+                        result = true;\n+                        break;\n+                    }\n+                    child = child.getNextSibling();\n+                }\n+            }\n+        }\n+        return result;\n+    }\n+\n+    /**\n+     * Select Node by Xpath.\n+     */\n+    public void selectNodeByXpath() {\n+        final DetailAST rootAST = (DetailAST) tree.getModel().getRoot();\n+        if (rootAST.hasChildren()) {\n+            final String xpath = \"/EOF\" + xpathEditor.getText();\n+            final Deque<DetailAST> nodes = new ArrayDeque<>();\n+            if (search(rootAST, xpath, nodes)) {\n+                TreePath path = new TreePath(nodes.pop());\n+                while (!nodes.isEmpty()) {\n+                    path = path.pathByAddingChild(nodes.pop());\n+                    if (!tree.isExpanded(path)) {\n+                        tree.expandPath(path);\n+                    }\n+                    tree.setSelectionPath(path);\n+                    makeCodeSelection();\n+                }\n+            }\n+            else {\n+                xpathEditor.setText(xpathEditor.getText() + \"- wrong xpath query\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c4ddc5f8aaf7a5b6334979cc4f98fa748a8f011f"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "db26401b58ed18f7082eee435a8fceb14c690766", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/db26401b58ed18f7082eee435a8fceb14c690766", "committedDate": "2020-08-11T09:20:13Z", "message": "minor: remove unused allowed import from import-config.xml"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c4ddc5f8aaf7a5b6334979cc4f98fa748a8f011f", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/c4ddc5f8aaf7a5b6334979cc4f98fa748a8f011f", "committedDate": "2020-08-10T04:57:29Z", "message": "minor: remove unused allowed import from import-config.xml"}, "afterCommit": {"oid": "2c1db5c368a3a95a36f5a0f7166b00d672b813ad", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/2c1db5c368a3a95a36f5a0f7166b00d672b813ad", "committedDate": "2020-08-11T09:25:16Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MTExNjU3", "url": "https://github.com/checkstyle/checkstyle/pull/8591#pullrequestreview-465111657", "createdAt": "2020-08-11T14:16:03Z", "commit": {"oid": "2c1db5c368a3a95a36f5a0f7166b00d672b813ad"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1NjExMjIw", "url": "https://github.com/checkstyle/checkstyle/pull/8591#pullrequestreview-465611220", "createdAt": "2020-08-12T06:00:04Z", "commit": {"oid": "2c1db5c368a3a95a36f5a0f7166b00d672b813ad"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQwNjowMDowNVrOG_S3RA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMlQwNjowMDowNVrOG_S3RA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAyMjUzMg==", "bodyText": "This if is redundant. When the root has no children, root.getFirstChild() will return null and the entire loop will be skipped.", "url": "https://github.com/checkstyle/checkstyle/pull/8591#discussion_r469022532", "createdAt": "2020-08-12T06:00:05Z", "author": {"login": "pbludov"}, "path": "src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java", "diffHunk": "@@ -190,6 +192,64 @@ private void setColumnsInitialWidth() {\n         getColumn(\"Type\").setPreferredWidth(preferredTypeColumnWidth);\n     }\n \n+    /**\n+     * Search node by Xpath.\n+     *\n+     * @param root {@code DetailAST} root ast element\n+     * @param xpath {@code String} xpath query\n+     * @param nodes {@code Deque<DetailAST>} stack of nodes in selection path\n+     * @return {@code boolean} node found or not\n+     */\n+    private static boolean search(DetailAST root, String xpath, Deque<DetailAST> nodes) {\n+        boolean result = false;\n+        if (xpath.equals(XpathQueryGenerator.generateXpathQuery(root))) {\n+            nodes.push(root);\n+            result = true;\n+        }\n+        else {\n+            if (root.hasChildren()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2c1db5c368a3a95a36f5a0f7166b00d672b813ad"}, "originalPosition": 29}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0647c5c9a149ccb27a73f60a3ca9d0a1d472b9bc", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/0647c5c9a149ccb27a73f60a3ca9d0a1d472b9bc", "committedDate": "2020-08-12T13:04:04Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2c1db5c368a3a95a36f5a0f7166b00d672b813ad", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/2c1db5c368a3a95a36f5a0f7166b00d672b813ad", "committedDate": "2020-08-11T09:25:16Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}, "afterCommit": {"oid": "0647c5c9a149ccb27a73f60a3ca9d0a1d472b9bc", "author": {"user": {"login": "developerhb", "name": null}}, "url": "https://github.com/checkstyle/checkstyle/commit/0647c5c9a149ccb27a73f60a3ca9d0a1d472b9bc", "committedDate": "2020-08-12T13:04:04Z", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1OTQyMzg5", "url": "https://github.com/checkstyle/checkstyle/pull/8591#pullrequestreview-465942389", "createdAt": "2020-08-12T13:57:43Z", "commit": {"oid": "0647c5c9a149ccb27a73f60a3ca9d0a1d472b9bc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1170, "cost": 1, "resetAt": "2021-11-01T13:07:16Z"}}}