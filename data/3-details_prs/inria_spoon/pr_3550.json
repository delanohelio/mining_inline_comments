{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDczNDgyMzcx", "number": 3550, "title": "fix: fixed identifier correctness check when simplenamePart == \"\"", "bodyText": "Exception when indexing https://github.com/google/gson library in module mode (with module-info.java and package-info.javas) with https://github.com/sourcegraph/lsif-java with #3549 applied.\nException does not occur when the library is not a module (with module-info.java and package-info.javas removed) (Note, need to double check the behaviour in each scenario: gson-module+3549, gson-not-module+3549, gson-module, gson-not-module)\nOccurs with TypeToken<List<String>[]> @ https://github.com/google/gson/blob/master/gson/src/test/java/com/google/gson/GenericArrayTypeTest.java#L45\nDebug state screenshots for context:\n\nStacktrace\nException in thread \"main\" java.lang.StringIndexOutOfBoundsException: String index out of range: 0\n        at java.base/java.lang.StringLatin1.charAt(StringLatin1.java:48)\n        at java.base/java.lang.String.charAt(String.java:711)\n        at spoon.support.reflect.reference.CtReferenceImpl.checkIdentifierChars(CtReferenceImpl.java:129)\n        at spoon.support.reflect.reference.CtReferenceImpl.checkAllParts(CtReferenceImpl.java:119)\n        at spoon.support.reflect.reference.CtReferenceImpl.checkIdentiferForJLSCorrectness(CtReferenceImpl.java:107)\n        at spoon.support.reflect.reference.CtReferenceImpl.setSimpleName(CtReferenceImpl.java:52)\n        at spoon.support.compiler.jdt.ReferenceBuilder.getTypeParameterReference(ReferenceBuilder.java:738)\n        at spoon.support.compiler.jdt.ReferenceBuilder.getTypeReference(ReferenceBuilder.java:691)\n        at spoon.support.compiler.jdt.ReferenceBuilder.getTypeReference(ReferenceBuilder.java:637)\n        at spoon.support.compiler.jdt.ReferenceBuilder.getTypeReference(ReferenceBuilder.java:519)\n        at spoon.support.compiler.jdt.ReferenceBuilder.getExecutableReference(ReferenceBuilder.java:457)\n        at spoon.support.compiler.jdt.JDTTreeBuilder.visit(JDTTreeBuilder.java:907)\n        at org.eclipse.jdt.internal.compiler.ast.QualifiedAllocationExpression.traverse(QualifiedAllocationExpression.java:673)\n        at org.eclipse.jdt.internal.compiler.ast.MessageSend.traverse(MessageSend.java:1110)\n        at org.eclipse.jdt.internal.compiler.ast.LocalDeclaration.traverse(LocalDeclaration.java:480)\n        at org.eclipse.jdt.internal.compiler.ast.MethodDeclaration.traverse(MethodDeclaration.java:365)\n        at org.eclipse.jdt.internal.compiler.ast.TypeDeclaration.traverse(TypeDeclaration.java:1479)\n        at org.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.traverse(CompilationUnitDeclaration.java:826)\n        at org.eclipse.jdt.internal.compiler.ast.CompilationUnitDeclaration.traverse(CompilationUnitDeclaration.java:787)\n        at spoon.support.compiler.jdt.JDTBasedSpoonCompiler.lambda$buildModel$0(JDTBasedSpoonCompiler.java:437)\n        at spoon.support.compiler.jdt.JDTBasedSpoonCompiler.forEachCompilationUnit(JDTBasedSpoonCompiler.java:466)\n        at spoon.support.compiler.jdt.JDTBasedSpoonCompiler.buildModel(JDTBasedSpoonCompiler.java:435)\n        at spoon.support.compiler.jdt.JDTBasedSpoonCompiler.buildUnitsAndModel(JDTBasedSpoonCompiler.java:372)\n        at spoon.support.compiler.jdt.JDTBasedSpoonCompiler.buildSources(JDTBasedSpoonCompiler.java:337)\n        at spoon.support.compiler.jdt.JDTBasedSpoonCompiler.build(JDTBasedSpoonCompiler.java:114)\n        at spoon.support.compiler.jdt.JDTBasedSpoonCompiler.build(JDTBasedSpoonCompiler.java:97)\n        at spoon.Launcher.buildModel(Launcher.java:755)\n        at ProjectIndexer.index(ProjectIndexer.java:44)\n        at Main.main(Main.java:16)\n\n\n\nScreenshots", "createdAt": "2020-08-25T20:56:59Z", "url": "https://github.com/INRIA/spoon/pull/3550", "merged": true, "mergeCommit": {"oid": "a14923c0630272c03b9de44e80bf2522d3964c78"}, "closed": true, "closedAt": "2020-09-11T07:21:30Z", "author": {"login": "Strum355"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdCd3OVgFqTQ3NDkwOTU2MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABdHuxHRgH2gAyNDczNDgyMzcxOmIwNzNmMDVlOTU2YzljNTlkYTc0OWQ3MTE4NDkzZDJmZmFiNzUxNjU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDc0OTA5NTYx", "url": "https://github.com/INRIA/spoon/pull/3550#pullrequestreview-474909561", "createdAt": "2020-08-25T21:12:39Z", "commit": {"oid": "097d231b80c6980a6f6d1385da671f2524b9f080"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5d392924ba3fd0ca73b6d1f94ad100e16004c941", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/5d392924ba3fd0ca73b6d1f94ad100e16004c941", "committedDate": "2020-09-09T10:56:49Z", "message": "Added test case for JLSCorrectness with simpleName List<String>[]"}, "afterCommit": {"oid": "85411b0a121fd70496101ca3290e09ebab05c16e", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/85411b0a121fd70496101ca3290e09ebab05c16e", "committedDate": "2020-09-09T10:58:05Z", "message": "Added test case for JLSCorrectness with simpleName List<String>[]"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e6de5e1c591e7135466327325d4050883f2263c4", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/e6de5e1c591e7135466327325d4050883f2263c4", "committedDate": "2020-09-09T10:58:58Z", "message": "Fixed JSLCorrectness fix when simplenamePart == \"\""}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "85411b0a121fd70496101ca3290e09ebab05c16e", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/85411b0a121fd70496101ca3290e09ebab05c16e", "committedDate": "2020-09-09T10:58:05Z", "message": "Added test case for JLSCorrectness with simpleName List<String>[]"}, "afterCommit": {"oid": "bc483e2d1f15297246579dc63b678da201425283", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/bc483e2d1f15297246579dc63b678da201425283", "committedDate": "2020-09-09T10:59:32Z", "message": "Added test case for JLSCorrectness with simpleName List<String>[]"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "bc483e2d1f15297246579dc63b678da201425283", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/bc483e2d1f15297246579dc63b678da201425283", "committedDate": "2020-09-09T10:59:32Z", "message": "Added test case for JLSCorrectness with simpleName List<String>[]"}, "afterCommit": {"oid": "80d2ad68385c388665bfc16e4a85d853c58c05d6", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/80d2ad68385c388665bfc16e4a85d853c58c05d6", "committedDate": "2020-09-09T11:00:31Z", "message": "Added test case for JLSCorrectness with simpleName List<String>[]"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fd3313d5820f5aca1b1a949aa621bb0502913c70", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/fd3313d5820f5aca1b1a949aa621bb0502913c70", "committedDate": "2020-09-09T11:02:45Z", "message": "Added test case for JLSCorrectness with simpleName List<String>[]"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "80d2ad68385c388665bfc16e4a85d853c58c05d6", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/80d2ad68385c388665bfc16e4a85d853c58c05d6", "committedDate": "2020-09-09T11:00:31Z", "message": "Added test case for JLSCorrectness with simpleName List<String>[]"}, "afterCommit": {"oid": "fd3313d5820f5aca1b1a949aa621bb0502913c70", "author": {"user": {"login": "Strum355", "name": "Noah S-C"}}, "url": "https://github.com/INRIA/spoon/commit/fd3313d5820f5aca1b1a949aa621bb0502913c70", "committedDate": "2020-09-09T11:02:45Z", "message": "Added test case for JLSCorrectness with simpleName List<String>[]"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MDQwNjE0", "url": "https://github.com/INRIA/spoon/pull/3550#pullrequestreview-485040614", "createdAt": "2020-09-09T14:01:07Z", "commit": {"oid": "fd3313d5820f5aca1b1a949aa621bb0502913c70"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNDowMTowN1rOHPI2dg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0wOVQxNDowMTowN1rOHPI2dg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTYzNTcwMg==", "bodyText": "is that a valid name for a local variable reference? Maybe you mean a type reference instead?", "url": "https://github.com/INRIA/spoon/pull/3550#discussion_r485635702", "createdAt": "2020-09-09T14:01:07Z", "author": {"login": "monperrus"}, "path": "src/test/java/spoon/generating/CorrectIdentifierTest.java", "diffHunk": "@@ -69,4 +69,10 @@ public void correctIdentiferUtfChinese() {\n \t\tCtLocalVariableReference<Object> localVariableRef = new Launcher().getFactory().createLocalVariableReference();\n \t\tassertDoesNotThrow(() -> localVariableRef.setSimpleName(\"\u51e6\u7406\"));\n \t}\n+\n+\t@Test\n+\tpublic void correctSquareBrackets() {\n+\t\tCtLocalVariableReference<Object> localVariableRef = new Launcher().getFactory().createLocalVariableReference();\n+\t\tassertDoesNotThrow(() -> localVariableRef.setSimpleName(\"List<String>[]\"));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fd3313d5820f5aca1b1a949aa621bb0502913c70"}, "originalPosition": 8}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6a8b0a20d36173f0e13a119f0844078427cf7bd9", "author": {"user": {"login": "monperrus", "name": "Martin Monperrus"}}, "url": "https://github.com/INRIA/spoon/commit/6a8b0a20d36173f0e13a119f0844078427cf7bd9", "committedDate": "2020-09-11T05:36:48Z", "message": "Merge branch 'master' into jlscorrect-fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b073f05e956c9c59da749d7118493d2ffab75165", "author": {"user": {"login": "monperrus", "name": "Martin Monperrus"}}, "url": "https://github.com/INRIA/spoon/commit/b073f05e956c9c59da749d7118493d2ffab75165", "committedDate": "2020-09-11T05:43:59Z", "message": "up"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1350, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}