{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg3MTg3NTQz", "number": 3303, "title": "refactor: Test can be annotated with @Ignore(\"UnresolveBug\")", "bodyText": "Instead of having a specific annotation @UnresolvedBug, we just use @Ignore with a specific value \"UnresolvedBug\".\nThis way, by default maven does not run these tests. But we have a test UnresolvedBugTest#checkThatUnresolvedBugTestFail() that do run them and check that they are failing. Previous test that checked that all of these UnresolvedBug testcase do have a corresponding @GitHubIssue tag remains, but checkGithubIssueAnnotations is now ignored because it was flacky in CI.\nHere is an example:\n@Test\n@GitHubIssue(issueNumber = 3281)\n@Ignore(\"UnresolvedBug\")\npublic void test_AnnotationWithNamedElement_HasImplicitAnnotationTypePackage() throws Exception {\n\tLauncher launcher = new Launcher();\n\tlauncher.addInputResource(new VirtualFile(\"class Cls { @SuppressWarnings(value=\\\"unchecked\\\") void meth() {} }\"));\n\tCtModel model = launcher.buildModel();\n\tList<CtElement> elems = model.getElements(e -> e instanceof CtAnnotation);\n\tassertEquals(1, elems.size());\n\tCtAnnotation<?> annotation = (CtAnnotation<?>) elems.get(0);\n\tassertTrue(annotation.getAnnotationType().getPackage().isImplicit());\n}", "createdAt": "2020-03-12T11:24:58Z", "url": "https://github.com/INRIA/spoon/pull/3303", "merged": true, "mergeCommit": {"oid": "adf6d34131dd6eb539a821cb7ebbf9c2336a8ed8"}, "closed": true, "closedAt": "2020-03-13T11:16:01Z", "author": {"login": "nharrand"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcM54hdAH2gAyMzg3MTg3NTQzOjk5OTQ4OWIxYWIxY2Y3MDI1OTY2OTllYTk2ZmRlNWQ0MDQwZTEyZDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcNOAm9AH2gAyMzg3MTg3NTQzOjI1OTMxNzVmMzI1ZmVhMDUzYWJjZjAxNzQyMDM0MjFhMjgxMDI1YTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "999489b1ab1cf702596699ea96fde5d4040e12d7", "author": {"user": {"login": "nharrand", "name": "Nicolas Harrand"}}, "url": "https://github.com/INRIA/spoon/commit/999489b1ab1cf702596699ea96fde5d4040e12d7", "committedDate": "2020-03-12T11:19:30Z", "message": "refactor(UnresolvedBug): Test annotated with @Ignore(\"UnresvoledBug\") are run and should fail"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4309b8fb07efa987b5e7ddafc0e9eccd63aa5126", "author": {"user": {"login": "nharrand", "name": "Nicolas Harrand"}}, "url": "https://github.com/INRIA/spoon/commit/4309b8fb07efa987b5e7ddafc0e9eccd63aa5126", "committedDate": "2020-03-12T11:25:13Z", "message": "oops"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzczNTA1NTkz", "url": "https://github.com/INRIA/spoon/pull/3303#pullrequestreview-373505593", "createdAt": "2020-03-12T12:19:48Z", "commit": {"oid": "4309b8fb07efa987b5e7ddafc0e9eccd63aa5126"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMjoxOTo0OFrOF1cSfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xMlQxMjoxOTo0OFrOF1cSfw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTU4MjMzNQ==", "bodyText": "how about https://docs.oracle.com/javase/7/docs/api/java/lang/String.html#equalsIgnoreCase(java.lang.String) instead of equals?", "url": "https://github.com/INRIA/spoon/pull/3303#discussion_r391582335", "createdAt": "2020-03-12T12:19:48Z", "author": {"login": "MartinWitt"}, "path": "src/test/java/spoon/test/UnresolvedBugTest.java", "diffHunk": "@@ -12,31 +12,52 @@\n import java.io.IOException;\n import java.io.InputStreamReader;\n import java.net.URL;\n+import java.util.ArrayList;\n import java.util.List;\n import java.util.stream.Collectors;\n \n import com.google.gson.Gson;\n import com.google.gson.JsonObject;\n \n+import org.junit.BeforeClass;\n+import org.junit.Ignore;\n import org.junit.Test;\n-import org.junit.experimental.categories.Category;\n \n+import org.junit.runner.Description;\n+import org.junit.runner.JUnitCore;\n+import org.junit.runner.notification.Failure;\n+import org.junit.runner.notification.RunListener;\n+import org.junit.runner.notification.RunNotifier;\n+import org.junit.runners.BlockJUnit4ClassRunner;\n+import org.junit.runners.model.FrameworkMethod;\n+import org.junit.runners.model.InitializationError;\n import spoon.FluentLauncher;\n import spoon.reflect.declaration.CtMethod;\n import spoon.reflect.visitor.filter.TypeFilter;\n \n public class UnresolvedBugTest {\n \n \tprivate static final String OPEN_ISSUE_TEXT = \"open\";\n-\tprivate List<CtMethod<?>> testMethods = findTestMethods();\n+\tprivate static List<CtMethod<?>> testMethods = findTestMethods();\n \tprivate final String githubURL = \"https://api.github.com/repos/INRIA/spoon/issues/\";\n \n+\n+\t@BeforeClass\n+\tpublic static void setup() {\n+\t\ttestMethods = testMethods.stream()\n+\t\t\t\t.filter(v -> v.hasAnnotation(Test.class) &&  v.hasAnnotation(Ignore.class)\n+\t\t\t\t\t\t&& v.getAnnotation(Ignore.class).value().equals(\"UnresolvedBug\"))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4309b8fb07efa987b5e7ddafc0e9eccd63aa5126"}, "originalPosition": 40}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fec61ebd69ef9d09249c6e1be4df9db207b4b774", "author": {"user": {"login": "nharrand", "name": "Nicolas Harrand"}}, "url": "https://github.com/INRIA/spoon/commit/fec61ebd69ef9d09249c6e1be4df9db207b4b774", "committedDate": "2020-03-12T12:23:09Z", "message": "Update UnresolvedBugTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f4ca100bf7b53350764332e1315a205ad912378e", "author": {"user": {"login": "nharrand", "name": "Nicolas Harrand"}}, "url": "https://github.com/INRIA/spoon/commit/f4ca100bf7b53350764332e1315a205ad912378e", "committedDate": "2020-03-12T12:30:09Z", "message": "Update travis-jdk8.sh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2876551151bdd420970e4a069b0db22da8d75193", "author": {"user": {"login": "nharrand", "name": "Nicolas Harrand"}}, "url": "https://github.com/INRIA/spoon/commit/2876551151bdd420970e4a069b0db22da8d75193", "committedDate": "2020-03-12T12:30:20Z", "message": "Update travis-jdk11.sh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e79bf84f194852cd3015b3a574c880c3d91ec859", "author": {"user": {"login": "nharrand", "name": "Nicolas Harrand"}}, "url": "https://github.com/INRIA/spoon/commit/e79bf84f194852cd3015b3a574c880c3d91ec859", "committedDate": "2020-03-12T12:30:28Z", "message": "Update travis-jdk10.sh"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8be4e216ca3d0ddab8dcaaf601ac61e58283dcfc", "author": {"user": {"login": "monperrus", "name": "Martin Monperrus"}}, "url": "https://github.com/INRIA/spoon/commit/8be4e216ca3d0ddab8dcaaf601ac61e58283dcfc", "committedDate": "2020-03-13T10:42:53Z", "message": "Update AnnotationTest.java"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2593175f325fea053abcf0174203421a281025a4", "author": {"user": {"login": "monperrus", "name": "Martin Monperrus"}}, "url": "https://github.com/INRIA/spoon/commit/2593175f325fea053abcf0174203421a281025a4", "committedDate": "2020-03-13T10:46:26Z", "message": "Merge branch 'master' into ref-unresolved"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1423, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}