{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDk3Mjk2NDA2", "number": 3631, "title": "refactor: remove unused fields + corresponding architectural test", "bodyText": "As discussed in #3628, here is a test case checking that every private field has a read. We dont need to check for writes, because a fieldRead without a fieldWrite before will never happen. Will writing this test case i found 8 unused fields.\n\nOne was a constructor parameter and i added a comment\nOne is for later use and i commented it out\n6 were simply unused.", "createdAt": "2020-10-03T15:50:02Z", "url": "https://github.com/INRIA/spoon/pull/3631", "merged": true, "mergeCommit": {"oid": "676e696d362ca158d8c612dbd08a186800fe900c"}, "closed": true, "closedAt": "2020-10-06T14:43:49Z", "author": {"login": "MartinWitt"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdO8eM4AH2gAyNDk3Mjk2NDA2OjI3N2QyY2VmZmQ3ZTk2Y2UwMzEzMzMwNjNlN2I4ZWQ1MzE0YzZiOWU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdP1CSbAH2gAyNDk3Mjk2NDA2OmMwZTNhOWNhODMwZGUzNGJkYjYxZDcxYzUwYzFhNzlkOWViNThiYTk=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "277d2ceffd7e96ce031333063e7b8ed5314c6b9e", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/277d2ceffd7e96ce031333063e7b8ed5314c6b9e", "committedDate": "2020-10-03T15:39:28Z", "message": "remove unused field, but keep constructor parameter"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6c7ff67d58b414a52951e1c71c7cfab5fb8e7200", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/6c7ff67d58b414a52951e1c71c7cfab5fb8e7200", "committedDate": "2020-10-03T15:40:34Z", "message": "comment out field, because it is for later use"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb877c4e05b8c39f6652e63f2ae2b1a4235cb3a7", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/cb877c4e05b8c39f6652e63f2ae2b1a4235cb3a7", "committedDate": "2020-10-03T15:41:37Z", "message": "remove unused fields"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c7965d60936f165f924a389a8b5ef091eddf3228", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/c7965d60936f165f924a389a8b5ef091eddf3228", "committedDate": "2020-10-03T15:44:53Z", "message": "add test checking, that every private field has a read"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c05a1bad1965470565958f414a93164756647923", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/c05a1bad1965470565958f414a93164756647923", "committedDate": "2020-10-04T15:05:06Z", "message": "add newline"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1b305ed2f541da86207510b05fd4670775200d3", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/a1b305ed2f541da86207510b05fd4670775200d3", "committedDate": "2020-10-04T15:05:34Z", "message": "remove newline triggering CI"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "df0b3cfd69a51aa5d6e1bb90a1f15e34e251da6d", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/df0b3cfd69a51aa5d6e1bb90a1f15e34e251da6d", "committedDate": "2020-10-04T15:23:50Z", "message": "comment out references"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "442e8f3c2be65a696c1357ab6827d2da9c65b910", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/442e8f3c2be65a696c1357ab6827d2da9c65b910", "committedDate": "2020-10-04T15:51:05Z", "message": "remove assignment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTAyMjEwNjQx", "url": "https://github.com/INRIA/spoon/pull/3631#pullrequestreview-502210641", "createdAt": "2020-10-05T16:10:01Z", "commit": {"oid": "442e8f3c2be65a696c1357ab6827d2da9c65b910"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjoxMDowMlrOHckE-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMC0wNVQxNjoxMDoyOVrOHckGGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTcxMzI3NA==", "bodyText": "Instead of commenting the fields and co, it would be better to simply remove them", "url": "https://github.com/INRIA/spoon/pull/3631#discussion_r499713274", "createdAt": "2020-10-05T16:10:02Z", "author": {"login": "monperrus"}, "path": "src/main/java/spoon/metamodel/MMMethodKind.java", "diffHunk": "@@ -77,13 +77,12 @@\n \tprivate final Predicate<CtMethod<?>> detector;\n \tprivate final int level;\n \tprivate final boolean multi;\n-\tprivate final int valueParameterIndex;\n \n \tMMMethodKind(int valueParameterIndex, boolean multi, int level, Predicate<CtMethod<?>> detector) {\n \t\tthis.multi = multi;\n \t\tthis.level = level;\n \t\tthis.detector = detector;\n-\t\tthis.valueParameterIndex = valueParameterIndex;\n+\t\t// valueParameterindex is never used", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "442e8f3c2be65a696c1357ab6827d2da9c65b910"}, "originalPosition": 11}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTcxMzU2MQ==", "bodyText": "out of curiosity how long does this new check take?", "url": "https://github.com/INRIA/spoon/pull/3631#discussion_r499713561", "createdAt": "2020-10-05T16:10:29Z", "author": {"login": "monperrus"}, "path": "src/test/java/spoon/test/architecture/SpoonArchitectureEnforcerTest.java", "diffHunk": "@@ -459,4 +465,23 @@ private static String computeDifference(Set<?> set1, Set<?> set2) {\n \t\t}\n \t\treturn StringUtils.join(results, \"\\n\");\n \t}\n+\tprivate void checkFields(CtModel model) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "442e8f3c2be65a696c1357ab6827d2da9c65b910"}, "originalPosition": 48}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "6ed0ad94f5924bf67e7aa687556eb4c4a6d614ac", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/6ed0ad94f5924bf67e7aa687556eb4c4a6d614ac", "committedDate": "2020-10-05T16:31:57Z", "message": "remove unused fields instead of commenting them out"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f3cfd9e22d8306d46c7de427eec9e28c3f956fac", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/f3cfd9e22d8306d46c7de427eec9e28c3f956fac", "committedDate": "2020-10-05T20:55:47Z", "message": "improve performance of test case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bc114f6a01638d75627ff166178f62fb64016415", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/bc114f6a01638d75627ff166178f62fb64016415", "committedDate": "2020-10-05T21:14:06Z", "message": " add test case to architecture documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c0e3a9ca830de34bdb61d71c50c1a79d9eb58ba9", "author": {"user": {"login": "MartinWitt", "name": null}}, "url": "https://github.com/INRIA/spoon/commit/c0e3a9ca830de34bdb61d71c50c1a79d9eb58ba9", "committedDate": "2020-10-06T09:33:34Z", "message": "remove valueParameterIndex completly"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1310, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}