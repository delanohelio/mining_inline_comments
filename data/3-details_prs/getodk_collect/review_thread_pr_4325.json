{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTQyNTU1ODE5", "number": 4325, "reviewThreads": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNDoyMTo0MlrOFHM-0Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNDoyMTo0MlrOFHM-0Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzQzMDk3MDQxOnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/openrosa/OpenRosaFormSource.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xOFQxNDoyMTo0MlrOIIksBA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0yMFQxMTo0MToxMVrOIJDdtQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTg2MDYxMg==", "bodyText": "Wouldn't it be better to check this in mapException and throw new FormSourceException(FETCH_ERROR) there? Then it would be in one place.", "url": "https://github.com/getodk/collect/pull/4325#discussion_r545860612", "createdAt": "2020-12-18T14:21:42Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/openrosa/OpenRosaFormSource.java", "diffHunk": "@@ -100,13 +100,27 @@ public ManifestFile fetchManifest(String manifestURL) throws FormSourceException\n     }\n \n     @Override\n-    public @NotNull InputStream fetchForm(String formURL) throws FormSourceException {\n-        return fetchFile(formURL);\n+    @NotNull\n+    public InputStream fetchForm(String formURL) throws FormSourceException {\n+        InputStream formFile = mapException(() -> openRosaXMLFetcher.getFile(formURL, null));\n+\n+        if (formFile != null) {\n+            return formFile;\n+        } else {\n+            throw new FormSourceException(FETCH_ERROR);\n+        }\n     }\n \n     @Override\n+    @NotNull\n     public InputStream fetchMediaFile(String mediaFileURL) throws FormSourceException {\n-        return mapException(() -> openRosaXMLFetcher.getFile(mediaFileURL, null));\n+        InputStream mediaFile = mapException(() -> openRosaXMLFetcher.getFile(mediaFileURL, null));\n+\n+        if (mediaFile != null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "df2f027766fdaaaed32b8b9d9029b0725a3624ac"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjM2NDg1Mw==", "bodyText": "Yeah, I think you're right. It feels like a good place for some defensive programming.", "url": "https://github.com/getodk/collect/pull/4325#discussion_r546364853", "createdAt": "2020-12-20T11:41:11Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/openrosa/OpenRosaFormSource.java", "diffHunk": "@@ -100,13 +100,27 @@ public ManifestFile fetchManifest(String manifestURL) throws FormSourceException\n     }\n \n     @Override\n-    public @NotNull InputStream fetchForm(String formURL) throws FormSourceException {\n-        return fetchFile(formURL);\n+    @NotNull\n+    public InputStream fetchForm(String formURL) throws FormSourceException {\n+        InputStream formFile = mapException(() -> openRosaXMLFetcher.getFile(formURL, null));\n+\n+        if (formFile != null) {\n+            return formFile;\n+        } else {\n+            throw new FormSourceException(FETCH_ERROR);\n+        }\n     }\n \n     @Override\n+    @NotNull\n     public InputStream fetchMediaFile(String mediaFileURL) throws FormSourceException {\n-        return mapException(() -> openRosaXMLFetcher.getFile(mediaFileURL, null));\n+        InputStream mediaFile = mapException(() -> openRosaXMLFetcher.getFile(mediaFileURL, null));\n+\n+        if (mediaFile != null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTg2MDYxMg=="}, "originalCommit": {"oid": "df2f027766fdaaaed32b8b9d9029b0725a3624ac"}, "originalPosition": 23}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3093, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}