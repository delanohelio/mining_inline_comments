{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTE0MTY5MTc4", "number": 4197, "title": "Show warning when importing legacy settings", "bodyText": "Closes  #4111\nWhat has been done to verify that this works as intended?\nNew test to check flow.\nWhy is this the best possible solution? Were any other approaches considered?\nThis could probably be improved a bit but I didn't want to spend much time on this given we want to remove it soon!\nHow does this change affect users? Describe intentional changes to behavior and behavior that could have accidentally been affected by code changes. In other words, what are the regression risks?\nShouldn't change anything. Good to check the .settings and .settings.json flows.\nBefore submitting this PR, please make sure you have:\n\n run ./gradlew checkAll and confirmed all checks still pass OR confirm CircleCI build passes and run ./gradlew connectedDebugAndroidTest locally.\n verified that any code or assets from external sources are properly credited in comments and/or in the about file.\n verified that any new UI elements use theme colors. UI Components Style guidelines", "createdAt": "2020-11-02T16:18:49Z", "url": "https://github.com/getodk/collect/pull/4197", "merged": true, "mergeCommit": {"oid": "1fd528cd621c994ace51e5137cde6b1a45848a7c"}, "closed": true, "closedAt": "2020-11-09T16:40:24Z", "author": {"login": "seadowg"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdYl2KgAH2gAyNTE0MTY5MTc4OjRiOTgwNTY1YmZkZWYwNzAzYTQwODZhMTkyYmQ1NmM3NTZhYjUyYjI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdZl_tYgFqTUyNDUxMDQxMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4b980565bfdef0703a4086a192bd56c756ab52b2", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/4b980565bfdef0703a4086a192bd56c756ab52b2", "committedDate": "2020-11-02T14:57:04Z", "message": "Add failing test for legacy settings flows"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4f36b3cdee4537cde82f91362b57cd26824c60e8", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/4f36b3cdee4537cde82f91362b57cd26824c60e8", "committedDate": "2020-11-02T15:36:43Z", "message": "Show dialog when legacy settings are imported"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe0f48b6654669aa014e75892b7c7af648a26772", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/fe0f48b6654669aa014e75892b7c7af648a26772", "committedDate": "2020-11-02T15:52:18Z", "message": "Delete test replaced by Espresso"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "12024edd97a307db55f4fe062ad6376c6c967ad2", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/12024edd97a307db55f4fe062ad6376c6c967ad2", "committedDate": "2020-11-02T16:10:10Z", "message": "Encapsulate legacy import logic in use case"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5178ef1db21f96cd92a47a0003eb30bed20cdb6", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/f5178ef1db21f96cd92a47a0003eb30bed20cdb6", "committedDate": "2020-11-02T16:17:45Z", "message": "Simplify import UI logic"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTIxNzg1MTMy", "url": "https://github.com/getodk/collect/pull/4197#pullrequestreview-521785132", "createdAt": "2020-11-02T16:22:25Z", "commit": {"oid": "f5178ef1db21f96cd92a47a0003eb30bed20cdb6"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNjoyMjoyNlrOHsLojA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0wMlQxNjoyMjoyNlrOHsLojA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNjA4OTk5Ng==", "bodyText": "This actually wouldn't ever have worked as LegacySettingsFileReader deleted the files. I've moved that out to a separate action so this should now fire correctly.", "url": "https://github.com/getodk/collect/pull/4197#discussion_r516089996", "createdAt": "2020-11-02T16:22:26Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/activities/MainMenuActivity.java", "diffHunk": "@@ -574,31 +582,4 @@ private void displayBannerWithSuccessStorageMigrationResult() {\n             storageMigrationRepository.clearResult();\n         });\n     }\n-\n-    private void importSettingsFromLegacyFiles() {\n-        try {\n-            String settings = new LegacySettingsFileReader(storagePathProvider).toJSON();\n-\n-            if (settings != null) {\n-                String type = new File(storagePathProvider.getStorageRootDirPath() + \"/collect.settings.json\").exists()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f5178ef1db21f96cd92a47a0003eb30bed20cdb6"}, "originalPosition": 70}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTI0NTEwNDEx", "url": "https://github.com/getodk/collect/pull/4197#pullrequestreview-524510411", "createdAt": "2020-11-05T17:41:25Z", "commit": {"oid": "f5178ef1db21f96cd92a47a0003eb30bed20cdb6"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2451, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}