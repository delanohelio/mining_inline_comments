{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE4MTk3MjQy", "number": 3835, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwNDowMjoyMFrOD8uXSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwNDozNjowM1rOD8upUg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MDAwNzc4OnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwNDowMjoyMFrOGV1wFw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xN1QyMDo1ODoxN1rOGWjjIw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1Mzk0Mw==", "bodyText": "I think we should make this a separate change for v1.28. Most translators won\u2019t have time to get to this in the next few days so the strings will show up in English where they were translated before.", "url": "https://github.com/getodk/collect/pull/3835#discussion_r425553943", "createdAt": "2020-05-15T04:02:20Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "diffHunk": "@@ -83,6 +83,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n \n         Intent intent = new IntentIntegrator(getActivity())\n                 .setDesiredBarcodeFormats(getSupportedCodeFormats())\n+                .setPrompt(getContext().getString(R.string.barcode_scanner_prompt))", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7d238f07ba6c5b0fafd15b0e934ac529ce42afdb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc5MTI1NA==", "bodyText": "We have over 20 translations for that string the default zxing message also is translatable but I noticed it contains less translations so maybe it's better to have this our own?.", "url": "https://github.com/getodk/collect/pull/3835#discussion_r425791254", "createdAt": "2020-05-15T13:12:06Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "diffHunk": "@@ -83,6 +83,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n \n         Intent intent = new IntentIntegrator(getActivity())\n                 .setDesiredBarcodeFormats(getSupportedCodeFormats())\n+                .setPrompt(getContext().getString(R.string.barcode_scanner_prompt))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1Mzk0Mw=="}, "originalCommit": {"oid": "7d238f07ba6c5b0fafd15b0e934ac529ce42afdb"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMwNDI5MQ==", "bodyText": "Oh, right, this string was already in use for the barcode widget. This change just also uses it in the settings QR code context. That makes a lot of sense, thanks.", "url": "https://github.com/getodk/collect/pull/3835#discussion_r426304291", "createdAt": "2020-05-17T20:58:17Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "diffHunk": "@@ -83,6 +83,7 @@ public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle sa\n \n         Intent intent = new IntentIntegrator(getActivity())\n                 .setDesiredBarcodeFormats(getSupportedCodeFormats())\n+                .setPrompt(getContext().getString(R.string.barcode_scanner_prompt))", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU1Mzk0Mw=="}, "originalCommit": {"oid": "7d238f07ba6c5b0fafd15b0e934ac529ce42afdb"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MDA1MjkzOnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwNDozNToyMFrOGV2L4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxNDozMDoyMlrOGWHTsw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU2MTA1OA==", "bodyText": "Passing in an Action to configure the fragment makes it hard to track what the different behavior is between the two types of scanners. Did you consider an abstract BarcodeScannerFragment with SettingsQRCodeScannerFragment and BarcodeWidgetScannerFragment subtypes or something like that? You'd have abstract handleBarcodeResult and getSupportedCodeFormats methods that are the only things implemented by those concrete classes, making the different behavior really clear.", "url": "https://github.com/getodk/collect/pull/3835#discussion_r425561058", "createdAt": "2020-05-15T04:35:20Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "diffHunk": "@@ -24,43 +26,70 @@\n \n import com.google.zxing.ResultPoint;\n import com.google.zxing.client.android.BeepManager;\n+import com.google.zxing.client.android.Intents;\n+import com.google.zxing.integration.android.IntentIntegrator;\n import com.journeyapps.barcodescanner.BarcodeCallback;\n import com.journeyapps.barcodescanner.BarcodeResult;\n+import com.journeyapps.barcodescanner.CaptureManager;\n import com.journeyapps.barcodescanner.DecoratedBarcodeView;\n+import com.journeyapps.barcodescanner.camera.CameraSettings;\n \n import org.odk.collect.android.R;\n import org.odk.collect.android.preferences.utilities.SettingsUtils;\n+import org.odk.collect.android.utilities.CameraUtils;\n import org.odk.collect.android.utilities.CompressionUtils;\n import org.odk.collect.android.utilities.ToastUtils;\n \n import org.odk.collect.android.listeners.PermissionListener;\n import org.odk.collect.android.utilities.PermissionUtils;\n+import org.odk.collect.android.utilities.WidgetAppearanceUtils;\n \n import java.io.IOException;\n+import java.util.Collection;\n+import java.util.Collections;\n import java.util.List;\n import java.util.zip.DataFormatException;\n \n public class QRScannerFragment extends Fragment implements DecoratedBarcodeView.TorchListener {\n \n-    DecoratedBarcodeView barcodeScannerView;\n+    private static final String ACTION = \"action\";\n+\n+    public enum Action { BARCODE_WIDGET, APPLY_SETTINGS };\n+\n+    private CaptureManager capture;\n+    private DecoratedBarcodeView barcodeScannerView;\n     private Button switchFlashlightButton;\n     private BeepManager beepManager;\n+    private Action action;\n+\n+    public static QRScannerFragment newInstance(Action action) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b9b3d4d00815afd2c16435d4e2d2479331f4b0b"}, "originalPosition": 50}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTg0MTU4Nw==", "bodyText": "You are right. I Implemented it in that way. Thanks.", "url": "https://github.com/getodk/collect/pull/3835#discussion_r425841587", "createdAt": "2020-05-15T14:30:22Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "diffHunk": "@@ -24,43 +26,70 @@\n \n import com.google.zxing.ResultPoint;\n import com.google.zxing.client.android.BeepManager;\n+import com.google.zxing.client.android.Intents;\n+import com.google.zxing.integration.android.IntentIntegrator;\n import com.journeyapps.barcodescanner.BarcodeCallback;\n import com.journeyapps.barcodescanner.BarcodeResult;\n+import com.journeyapps.barcodescanner.CaptureManager;\n import com.journeyapps.barcodescanner.DecoratedBarcodeView;\n+import com.journeyapps.barcodescanner.camera.CameraSettings;\n \n import org.odk.collect.android.R;\n import org.odk.collect.android.preferences.utilities.SettingsUtils;\n+import org.odk.collect.android.utilities.CameraUtils;\n import org.odk.collect.android.utilities.CompressionUtils;\n import org.odk.collect.android.utilities.ToastUtils;\n \n import org.odk.collect.android.listeners.PermissionListener;\n import org.odk.collect.android.utilities.PermissionUtils;\n+import org.odk.collect.android.utilities.WidgetAppearanceUtils;\n \n import java.io.IOException;\n+import java.util.Collection;\n+import java.util.Collections;\n import java.util.List;\n import java.util.zip.DataFormatException;\n \n public class QRScannerFragment extends Fragment implements DecoratedBarcodeView.TorchListener {\n \n-    DecoratedBarcodeView barcodeScannerView;\n+    private static final String ACTION = \"action\";\n+\n+    public enum Action { BARCODE_WIDGET, APPLY_SETTINGS };\n+\n+    private CaptureManager capture;\n+    private DecoratedBarcodeView barcodeScannerView;\n     private Button switchFlashlightButton;\n     private BeepManager beepManager;\n+    private Action action;\n+\n+    public static QRScannerFragment newInstance(Action action) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU2MTA1OA=="}, "originalCommit": {"oid": "3b9b3d4d00815afd2c16435d4e2d2479331f4b0b"}, "originalPosition": 50}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1MDA1Mzk0OnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQwNDozNjowM1rOGV2MgA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xNVQxMjozOTowNVrOGWDGig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU2MTIxNg==", "bodyText": "This should be in a different package, now. It's also no longer just a QR code scanner.", "url": "https://github.com/getodk/collect/pull/3835#discussion_r425561216", "createdAt": "2020-05-15T04:36:03Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "diffHunk": "@@ -24,43 +26,70 @@\n \n import com.google.zxing.ResultPoint;\n import com.google.zxing.client.android.BeepManager;\n+import com.google.zxing.client.android.Intents;\n+import com.google.zxing.integration.android.IntentIntegrator;\n import com.journeyapps.barcodescanner.BarcodeCallback;\n import com.journeyapps.barcodescanner.BarcodeResult;\n+import com.journeyapps.barcodescanner.CaptureManager;\n import com.journeyapps.barcodescanner.DecoratedBarcodeView;\n+import com.journeyapps.barcodescanner.camera.CameraSettings;\n \n import org.odk.collect.android.R;\n import org.odk.collect.android.preferences.utilities.SettingsUtils;\n+import org.odk.collect.android.utilities.CameraUtils;\n import org.odk.collect.android.utilities.CompressionUtils;\n import org.odk.collect.android.utilities.ToastUtils;\n \n import org.odk.collect.android.listeners.PermissionListener;\n import org.odk.collect.android.utilities.PermissionUtils;\n+import org.odk.collect.android.utilities.WidgetAppearanceUtils;\n \n import java.io.IOException;\n+import java.util.Collection;\n+import java.util.Collections;\n import java.util.List;\n import java.util.zip.DataFormatException;\n \n public class QRScannerFragment extends Fragment implements DecoratedBarcodeView.TorchListener {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3b9b3d4d00815afd2c16435d4e2d2479331f4b0b"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTc3MjY4Mg==", "bodyText": "Right, fixed.", "url": "https://github.com/getodk/collect/pull/3835#discussion_r425772682", "createdAt": "2020-05-15T12:39:05Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/qr/QRScannerFragment.java", "diffHunk": "@@ -24,43 +26,70 @@\n \n import com.google.zxing.ResultPoint;\n import com.google.zxing.client.android.BeepManager;\n+import com.google.zxing.client.android.Intents;\n+import com.google.zxing.integration.android.IntentIntegrator;\n import com.journeyapps.barcodescanner.BarcodeCallback;\n import com.journeyapps.barcodescanner.BarcodeResult;\n+import com.journeyapps.barcodescanner.CaptureManager;\n import com.journeyapps.barcodescanner.DecoratedBarcodeView;\n+import com.journeyapps.barcodescanner.camera.CameraSettings;\n \n import org.odk.collect.android.R;\n import org.odk.collect.android.preferences.utilities.SettingsUtils;\n+import org.odk.collect.android.utilities.CameraUtils;\n import org.odk.collect.android.utilities.CompressionUtils;\n import org.odk.collect.android.utilities.ToastUtils;\n \n import org.odk.collect.android.listeners.PermissionListener;\n import org.odk.collect.android.utilities.PermissionUtils;\n+import org.odk.collect.android.utilities.WidgetAppearanceUtils;\n \n import java.io.IOException;\n+import java.util.Collection;\n+import java.util.Collections;\n import java.util.List;\n import java.util.zip.DataFormatException;\n \n public class QRScannerFragment extends Fragment implements DecoratedBarcodeView.TorchListener {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTU2MTIxNg=="}, "originalCommit": {"oid": "3b9b3d4d00815afd2c16435d4e2d2479331f4b0b"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3362, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}