{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYwMzA5MDU2", "number": 4002, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNjo0NTo0N1rOEUH3jQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQyMDo0NTo1NFrOEUar5w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5NTM1ODg1OnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/application/initialization/ApplicationInitializer.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNjo0NTo0N1rOG6PGEg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0zMVQxNjo0NTo0N1rOG6PGEg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzcxNzkwNg==", "bodyText": "I wanted to do this here rather than when the settings are changed/imported as it avoids handling all the different possible cases and also makes sure we always have a value for this property set. It means the values we have are probably going to be slightly behind (as we'll be waiting for the next time the app boots for the property to be set) but I think that'll be ok.", "url": "https://github.com/getodk/collect/pull/4002#discussion_r463717906", "createdAt": "2020-07-31T16:45:47Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/application/initialization/ApplicationInitializer.java", "diffHunk": "@@ -55,21 +60,30 @@ public void initialize() {\n         initializeLocale();\n     }\n \n-    public void initializePreferences() {\n+    private void initializePreferences() {\n         performMigrations();\n         reloadSharedPreferences();\n     }\n \n-    public void initializeFrameworks() {\n+    private void initializeFrameworks() {\n         NotificationUtils.createNotificationChannel(context);\n         JodaTimeAndroid.init(context);\n         initializeLogging();\n         AppCompatDelegate.setCompatVectorFromResourcesEnabled(true);\n         initializeMapFrameworks();\n         initializeJavaRosa();\n+        initializeAnalytics();\n     }\n \n-    public void initializeLocale() {\n+    private void initializeAnalytics() {\n+        String formUpdateMode = generalSharedPreferences\n+                .getSharedPreferences()\n+                .getString(GeneralKeys.KEY_FORM_UPDATE_MODE, FormUpdateMode.MANUAL.getValue(context));\n+\n+        analytics.setUserProperty(\"FormUpdateMode\", formUpdateMode);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1235ae7002de37e87704c49db7371f41a4586fda"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg5ODQ0MTk5OnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/formmanagement/BlankFormsListViewModel.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wMlQyMDo0NTo1NFrOG6nvYA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wM1QwOToyNjowNlrOG6yfaw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMTY5Ng==", "bodyText": "What do you think of using the hostname instead of the raw setting value? The raw server setting value would mean we differentiate between different Central App Users. Hostname would give us a sense of organizations that use match exactly and specifically the manual sync button.", "url": "https://github.com/getodk/collect/pull/4002#discussion_r464121696", "createdAt": "2020-08-02T20:45:54Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/formmanagement/BlankFormsListViewModel.java", "diffHunk": "@@ -87,6 +99,12 @@ public void syncWithServer() {\n         });\n     }\n \n+    private void logManualSync() {\n+        String url = preferencesProvider.getGeneralSharedPreferences().getString(GeneralKeys.KEY_SERVER_URL, \"\");\n+        String urlHash = FileUtils.getMd5Hash(new ByteArrayInputStream(url.getBytes()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "1235ae7002de37e87704c49db7371f41a4586fda"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDI5NzgzNQ==", "bodyText": "Yeah that makes more sense", "url": "https://github.com/getodk/collect/pull/4002#discussion_r464297835", "createdAt": "2020-08-03T09:26:06Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/formmanagement/BlankFormsListViewModel.java", "diffHunk": "@@ -87,6 +99,12 @@ public void syncWithServer() {\n         });\n     }\n \n+    private void logManualSync() {\n+        String url = preferencesProvider.getGeneralSharedPreferences().getString(GeneralKeys.KEY_SERVER_URL, \"\");\n+        String urlHash = FileUtils.getMd5Hash(new ByteArrayInputStream(url.getBytes()));", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDEyMTY5Ng=="}, "originalCommit": {"oid": "1235ae7002de37e87704c49db7371f41a4586fda"}, "originalPosition": 68}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3254, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}