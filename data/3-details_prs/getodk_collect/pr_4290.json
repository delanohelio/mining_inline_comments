{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM1OTE0OTc4", "number": 4290, "title": "Audio analytics", "bodyText": "This adds analytics for the audio features. The different events and what we hope to track with them is detailed in AnalyticsEvents.\nWhat has been done to verify that this works as intended?\nRan tests.\nWhy is this the best possible solution? Were any other approaches considered?\nComments inline.\nHow does this change affect users? Describe intentional changes to behavior and behavior that could have accidentally been affected by code changes. In other words, what are the regression risks?\nShouldn't have any effect. This can be merged without QA.\nBefore submitting this PR, please make sure you have:\n\n run ./gradlew checkAll and confirmed all checks still pass OR confirm CircleCI build passes and run ./gradlew connectedDebugAndroidTest locally.\n verified that any code or assets from external sources are properly credited in comments and/or in the about file.\n verified that any new UI elements use theme colors. UI Components Style guidelines", "createdAt": "2020-12-10T12:52:26Z", "url": "https://github.com/getodk/collect/pull/4290", "merged": true, "mergeCommit": {"oid": "37efa38d3467850827a0edc24ddf03f8c07976c5"}, "closed": true, "closedAt": "2020-12-10T16:51:15Z", "author": {"login": "seadowg"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdkgnBzAH2gAyNTM1OTE0OTc4OjY1ZWM5ODlmMzYxOWY5ZjI4NjhiMGVmZjMwZTQ3YjZmNzE4OGY2MTk=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdk2QKPAFqTU0OTQwMTQyMA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "65ec989f3619f9f2868b0eff30e47b6f7188f619", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/65ec989f3619f9f2868b0eff30e47b6f7188f619", "committedDate": "2020-12-09T15:38:06Z", "message": "Remove repeat analytics"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1311e54f6d2f99b70426c8ed297743cee4f598d4", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/1311e54f6d2f99b70426c8ed297743cee4f598d4", "committedDate": "2020-12-09T15:57:57Z", "message": "Send analytics event when audio player seek used"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7976a9b08bfada69ffb5dc85b8c627bf02ce61e5", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/7976a9b08bfada69ffb5dc85b8c627bf02ce61e5", "committedDate": "2020-12-09T16:09:45Z", "message": "Move URL question analytics out of WidgetFactory"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1674c3546cfbcf1d2df8b417d4838eda4e649b2c", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/1674c3546cfbcf1d2df8b417d4838eda4e649b2c", "committedDate": "2020-12-09T16:11:59Z", "message": "Add analytics event when audio question is shown"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "158208b6d83f264a9f17ab541af9d06441fe7543", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/158208b6d83f264a9f17ab541af9d06441fe7543", "committedDate": "2020-12-09T16:21:54Z", "message": "Add event when audio recording is paused"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f9af66c90313948723536c33320771e42dbcc544", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/f9af66c90313948723536c33320771e42dbcc544", "committedDate": "2020-12-09T16:34:46Z", "message": "Add logging method to view model to make it simpler to log form events"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a474d3e5a5c06ca9754d2581ca263188b67c943", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/4a474d3e5a5c06ca9754d2581ca263188b67c943", "committedDate": "2020-12-09T16:46:29Z", "message": "Use viewmodel for event"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9a7ce13ed172cd5258804dc4e05d345413d0a2ee", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/9a7ce13ed172cd5258804dc4e05d345413d0a2ee", "committedDate": "2020-12-09T18:37:45Z", "message": "Log analytics events when recording or choosing audio"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "333c78ee2dd3303701a1b29a16124e6655ffe32a", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/333c78ee2dd3303701a1b29a16124e6655ffe32a", "committedDate": "2020-12-10T11:41:51Z", "message": "Log analytics event when question answered during recording"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fb098383b171467c277bac80de7c9676d8ca66c1", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/fb098383b171467c277bac80de7c9676d8ca66c1", "committedDate": "2020-12-10T11:57:38Z", "message": "Add analytics event for when user opts in to using internal recording"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MjY0NDQ3", "url": "https://github.com/getodk/collect/pull/4290#pullrequestreview-549264447", "createdAt": "2020-12-10T14:42:53Z", "commit": {"oid": "fb098383b171467c277bac80de7c9676d8ca66c1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNDo0Mjo1M1rOIDMn9g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNDo0Mjo1M1rOIDMn9g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDIyMzQ3OA==", "bodyText": "We initially talked abut an event for when an audio question (using internal) recording appeared in a field-list. I realized it was actually easier to just track the underlying behaviour we were interested in here.", "url": "https://github.com/getodk/collect/pull/4290#discussion_r540223478", "createdAt": "2020-12-10T14:42:53Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/analytics/AnalyticsEvents.java", "diffHunk": "@@ -153,4 +147,37 @@ private AnalyticsEvents() {\n      * Track usage of legacy Aggregate < 1 form list API code paths.\n      */\n     public static final String LEGACY_FORM_LIST = \"LegacyFormList\";\n+\n+    /**\n+     * Tracks how often the audio player seek bar is used.\n+     */\n+    public static final String AUDIO_PLAYER_SEEK = \"AudioPlayerSeek\";\n+\n+    /**\n+     * Tracks how many forms include an audio question.\n+     */\n+    public static final String AUDIO_QUESTION = \"AudioQuestion\";\n+\n+    /**\n+     * Tracks how often pause action is used while recording audio\n+     */\n+    public static final String AUDIO_RECORDING_PAUSE = \"AudioRecordingPause\";\n+\n+    /**\n+     * Tracks usage or internal recording vs external recording vs choosing files for\n+     * audio question\n+     */\n+    public static final String AUDIO_RECORDING_INTERNAL = \"AudioRecordingInternal\";\n+    public static final String AUDIO_RECORDING_EXTERNAL = \"AudioRecordingExternal\";\n+    public static final String AUDIO_RECORDING_CHOOSE = \"AudioRecordingChoose\";\n+\n+    /**\n+     * Tracks how often questions are answered while an audio recording is being made\n+     */\n+    public static final String ANSWER_WHILE_RECORDING = \"AnswerWhileRecording\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb098383b171467c277bac80de7c9676d8ca66c1"}, "originalPosition": 44}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5MjY2Nzkz", "url": "https://github.com/getodk/collect/pull/4290#pullrequestreview-549266793", "createdAt": "2020-12-10T14:45:01Z", "commit": {"oid": "fb098383b171467c277bac80de7c9676d8ca66c1"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNDo0NTowMVrOIDMuoA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0xMFQxNDo0NTowMVrOIDMuoA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDIyNTE4NA==", "bodyText": "Rather than having to pass the (or grab statically) form identifier hash around it seemed nice to just encapsulate the logging on the view model here. I think we'd want a FormEventLogger interface if we were logging inside a widget (or anywhere it doesn't make sense to have a ViewModel) but I didn't run into that.", "url": "https://github.com/getodk/collect/pull/4290#discussion_r540225184", "createdAt": "2020-12-10T14:45:01Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/formentry/FormEntryViewModel.java", "diffHunk": "@@ -164,19 +156,34 @@ public void openHierarchy() {\n         formController.getAuditEventLogger().logEvent(AuditEvent.AuditEventType.HIERARCHY, true, clock.getCurrentTime());\n     }\n \n+    public void logFormEvent(String event) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "fb098383b171467c277bac80de7c9676d8ca66c1"}, "originalPosition": 64}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "71f6782c1ace906c438f70119e6be81b430ca051", "author": {"user": {"login": "seadowg", "name": "Callum Stott"}}, "url": "https://github.com/getodk/collect/commit/71f6782c1ace906c438f70119e6be81b430ca051", "committedDate": "2020-12-10T16:27:50Z", "message": "Remove Audio question event and use new style for URL question event"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQ5NDAxNDIw", "url": "https://github.com/getodk/collect/pull/4290#pullrequestreview-549401420", "createdAt": "2020-12-10T16:51:02Z", "commit": {"oid": "71f6782c1ace906c438f70119e6be81b430ca051"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2360, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}