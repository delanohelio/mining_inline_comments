{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTM3MTY2MzA2", "number": 4297, "title": "Do not ask for storage permissions when it's a fresh installation", "bodyText": "Closes #4288\nWhat has been done to verify that this works as intended?\nI tested the behavior.\nWhy is this the best possible solution? Were any other approaches considered?\nI decided to call requestStoragePermissions() like before but add one trick which is here:\nhttps://github.com/getodk/collect/pull/4297/files#diff-fe2bc5034d6dfe946ff681f198d0552c83038caed992865f5e7ce030447a276bR98\nAnother option would be to check if we need storage permission before calling requestStoragePermissions() but that would require adding more if/else statements and the code would be more cluttered.\nHow does this change affect users? Describe intentional changes to behavior and behavior that could have accidentally been affected by code changes. In other words, what are the regression risks?\nFresh installs should not ask for storage permission that's the only change. In order to confirm that everything works fine it would be good to go through some functionalities where normally we would be asked for permissions.\nDo we need any specific form for testing your changes? If so, please attach one.\nNo.\nDoes this change require updates to documentation? If so, please file an issue here and include the link below.\nNo.\nBefore submitting this PR, please make sure you have:\n\n run ./gradlew checkAll and confirmed all checks still pass OR confirm CircleCI build passes and run ./gradlew connectedDebugAndroidTest locally.\n verified that any code or assets from external sources are properly credited in comments and/or in the about file.\n verified that any new UI elements use theme colors. UI Components Style guidelines", "createdAt": "2020-12-11T17:11:14Z", "url": "https://github.com/getodk/collect/pull/4297", "merged": true, "mergeCommit": {"oid": "6f0c92fda4b91a2380c47f1d72de3d55f2c11fe3"}, "closed": true, "closedAt": "2021-01-26T16:00:21Z", "author": {"login": "grzesiek2010"}, "timelineItems": {"totalCount": 66, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdt0TDTABqjQxNzk5MjA3NDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdz6-6XgBqjQyNTA1MTY2NTU=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "19a432a4384111a9f782334c8fa4377213cca0a9", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/19a432a4384111a9f782334c8fa4377213cca0a9", "committedDate": "2020-12-11T15:02:11Z", "message": "Fixed pmd"}, "afterCommit": {"oid": "4289b3afdcdaf2d791628e90a5c2735bec5c5d35", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/4289b3afdcdaf2d791628e90a5c2735bec5c5d35", "committedDate": "2021-01-07T13:38:32Z", "message": "Fixed tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4289b3afdcdaf2d791628e90a5c2735bec5c5d35", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/4289b3afdcdaf2d791628e90a5c2735bec5c5d35", "committedDate": "2021-01-07T13:38:32Z", "message": "Fixed tests"}, "afterCommit": {"oid": "fc3b134af98850da7b66907a5c4e56307ea4222e", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/fc3b134af98850da7b66907a5c4e56307ea4222e", "committedDate": "2021-01-07T13:52:11Z", "message": "Fixed tests"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTYzNzU0NzU2", "url": "https://github.com/getodk/collect/pull/4297#pullrequestreview-563754756", "createdAt": "2021-01-07T19:17:28Z", "commit": {"oid": "fc3b134af98850da7b66907a5c4e56307ea4222e"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "fc3b134af98850da7b66907a5c4e56307ea4222e", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/fc3b134af98850da7b66907a5c4e56307ea4222e", "committedDate": "2021-01-07T13:52:11Z", "message": "Fixed tests"}, "afterCommit": {"oid": "cfa08fecd502652135d71cd0d513212903d987ee", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/cfa08fecd502652135d71cd0d513212903d987ee", "committedDate": "2021-01-11T13:09:32Z", "message": "Reuse PermissionsProvider injected to CollectAbstractActivity"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY3NjY4NDgz", "url": "https://github.com/getodk/collect/pull/4297#pullrequestreview-567668483", "createdAt": "2021-01-13T21:26:07Z", "commit": {"oid": "cfa08fecd502652135d71cd0d513212903d987ee"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xM1QyMToyNjowN1rOITC8-Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0xM1QyMToyNjowN1rOITC8-Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Njg0MjIzMw==", "bodyText": "This should be true so that the last assertion is true!", "url": "https://github.com/getodk/collect/pull/4297#discussion_r556842233", "createdAt": "2021-01-13T21:26:07Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/test/java/org/odk/collect/android/permissions/PermissionsProviderTest.java", "diffHunk": "@@ -0,0 +1,141 @@\n+package org.odk.collect.android.permissions;\n+\n+import android.Manifest;\n+\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+import org.odk.collect.android.storage.StorageStateProvider;\n+\n+import static org.hamcrest.CoreMatchers.is;\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+public class PermissionsProviderTest {\n+    private PermissionsChecker permissionsChecker;\n+    private StorageStateProvider storageStateProvider;\n+    private PermissionsProvider permissionsProvider;\n+\n+    @Before\n+    public void setup() {\n+        permissionsChecker = mock(PermissionsChecker.class);\n+        storageStateProvider = mock(StorageStateProvider.class);\n+    }\n+\n+    @Test\n+    public void whenStoragePermissionsGrantedAndScopedStorageNotUsed_shouldAreStoragePermissionsGrantedReturnTrue() {\n+        when(permissionsChecker.isPermissionGranted(Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE)).thenReturn(true);\n+        when(storageStateProvider.isScopedStorageUsed()).thenReturn(false);\n+        permissionsProvider = new PermissionsProvider(permissionsChecker, storageStateProvider);\n+\n+        assertThat(permissionsProvider.areStoragePermissionsGranted(), is(true));\n+    }\n+\n+    @Test\n+    public void whenStoragePermissionsGrantedAndScopedStorageUsed_shouldAreStoragePermissionsGrantedReturnTrue() {\n+        when(permissionsChecker.isPermissionGranted(Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE)).thenReturn(true);\n+        when(storageStateProvider.isScopedStorageUsed()).thenReturn(true);\n+        permissionsProvider = new PermissionsProvider(permissionsChecker, storageStateProvider);\n+\n+        assertThat(permissionsProvider.areStoragePermissionsGranted(), is(true));\n+    }\n+\n+    @Test\n+    public void whenStoragePermissionsNotGrantedAndScopedStorageNotUsed_shouldAreStoragePermissionsGrantedReturnFalse() {\n+        when(permissionsChecker.isPermissionGranted(Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE)).thenReturn(false);\n+        when(storageStateProvider.isScopedStorageUsed()).thenReturn(false);\n+        permissionsProvider = new PermissionsProvider(permissionsChecker, storageStateProvider);\n+\n+        assertThat(permissionsProvider.areStoragePermissionsGranted(), is(false));\n+    }\n+\n+    @Test\n+    public void whenStoragePermissionsNotGrantedAndScopedStorageUsed_shouldAreStoragePermissionsGrantedReturnTrue() {\n+        when(permissionsChecker.isPermissionGranted(Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE)).thenReturn(false);\n+        when(storageStateProvider.isScopedStorageUsed()).thenReturn(false);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cfa08fecd502652135d71cd0d513212903d987ee"}, "originalPosition": 56}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTY3NjcwNTY1", "url": "https://github.com/getodk/collect/pull/4297#pullrequestreview-567670565", "createdAt": "2021-01-13T21:29:11Z", "commit": {"oid": "cfa08fecd502652135d71cd0d513212903d987ee"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a59690ce0f7125558de50ee98effe3d3283c9534", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/a59690ce0f7125558de50ee98effe3d3283c9534", "committedDate": "2021-01-14T10:19:28Z", "message": "Implemented AppStateProvider"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "34667887d6d5bbe7529eb669887a3c2b7cc822ba", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/34667887d6d5bbe7529eb669887a3c2b7cc822ba", "committedDate": "2021-01-14T10:19:28Z", "message": "Enable scoped storage for fresh installs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f154afd15404c7c1e49f28c34ab4ef24cf995882", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/f154afd15404c7c1e49f28c34ab4ef24cf995882", "committedDate": "2021-01-14T10:19:28Z", "message": "Don't ask for storage permission if scoped storage is used"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f519e6763008e5f7d62fc5a7143c2b8c294765e5", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/f519e6763008e5f7d62fc5a7143c2b8c294765e5", "committedDate": "2021-01-14T10:19:28Z", "message": "Use injected permissionUtils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c34f2fa990eb77c529b582cb6549bf68e5416a3b", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/c34f2fa990eb77c529b582cb6549bf68e5416a3b", "committedDate": "2021-01-14T10:19:28Z", "message": "Pass storageStateProvider to PermissionUtils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab274f1a5ff6a04b6199cd8d4455673530f23d7b", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/ab274f1a5ff6a04b6199cd8d4455673530f23d7b", "committedDate": "2021-01-14T10:19:28Z", "message": "Use storageStateProvider object to determine if should ask for storage permission"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0bafab9f8abba68354f70c2c62f2e09516a4d450", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/0bafab9f8abba68354f70c2c62f2e09516a4d450", "committedDate": "2021-01-14T10:19:28Z", "message": "areStoragePermissionsGranted() shoul not be static"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0040fea4d959528f8ec176d17160e861e219b950", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/0040fea4d959528f8ec176d17160e861e219b950", "committedDate": "2021-01-14T10:19:28Z", "message": "Fixed areStoragePermissionsGranted()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9cbb76aec5d76be83c8c0df03593e15539030faf", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/9cbb76aec5d76be83c8c0df03593e15539030faf", "committedDate": "2021-01-14T10:20:18Z", "message": "Removed redundant code from providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "662430b2c3dc754313e272c562850fb6bc61f0d8", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/662430b2c3dc754313e272c562850fb6bc61f0d8", "committedDate": "2021-01-14T10:20:18Z", "message": "Fixed tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b72331ce0ceedf83e04a35c0921eabd099df9be3", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/b72331ce0ceedf83e04a35c0921eabd099df9be3", "committedDate": "2021-01-14T10:20:18Z", "message": "Call Dexter.withContext instead of deprecated withActivity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "65705f9b5e13633965b9b55be00337231ec63537", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/65705f9b5e13633965b9b55be00337231ec63537", "committedDate": "2021-01-14T10:20:18Z", "message": "Removed redundant finishAllActivities() method from PermissionUtils"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bbd812e91debb1045e4bae3164f28fd5146ed602", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/bbd812e91debb1045e4bae3164f28fd5146ed602", "committedDate": "2021-01-14T10:20:18Z", "message": "Got rid of static methods in PermissionUtils class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d00b793072eba812f0cc1f207aad3a836a78eddd", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/d00b793072eba812f0cc1f207aad3a836a78eddd", "committedDate": "2021-01-14T10:20:18Z", "message": "Implemented PermissionsChecker"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c5b50d4fba3f1c514ece62f4c427594a1064269", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/0c5b50d4fba3f1c514ece62f4c427594a1064269", "committedDate": "2021-01-14T10:20:18Z", "message": "Do not pass dialogTheme to PermissionUtils constructor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "265c183e8343092e89ec8d0c2ae47c9c22cd5119", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/265c183e8343092e89ec8d0c2ae47c9c22cd5119", "committedDate": "2021-01-14T10:20:18Z", "message": "Moved permissionUtils class to permissions package"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e7d97823a196718baf07a48ef8ced5e6211dc991", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/e7d97823a196718baf07a48ef8ced5e6211dc991", "committedDate": "2021-01-14T10:20:18Z", "message": "Renamed PermissionUtils -> PermissionsProvider"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2ca5372b002457291e4fd604860bb2818a7a5aa7", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/2ca5372b002457291e4fd604860bb2818a7a5aa7", "committedDate": "2021-01-14T10:20:18Z", "message": "Removed duplicated AlwaysGrantStoragePermissionsPermissionsProvider class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d1aa0d3a3a74117f1af39b1158284ff3b2a3a1c4", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/d1aa0d3a3a74117f1af39b1158284ff3b2a3a1c4", "committedDate": "2021-01-14T10:20:18Z", "message": "Added tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1a7d363f6f771bdfd8071fb38ae0a863ae45da11", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/1a7d363f6f771bdfd8071fb38ae0a863ae45da11", "committedDate": "2021-01-14T10:20:18Z", "message": "Reuse PermissionsProvider injected to CollectAbstractActivity"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "513b64b2f59138815709826295554bd64ebb2539", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/513b64b2f59138815709826295554bd64ebb2539", "committedDate": "2021-01-14T10:20:18Z", "message": "Fixed bugs in tests"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "cfa08fecd502652135d71cd0d513212903d987ee", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/cfa08fecd502652135d71cd0d513212903d987ee", "committedDate": "2021-01-11T13:09:32Z", "message": "Reuse PermissionsProvider injected to CollectAbstractActivity"}, "afterCommit": {"oid": "513b64b2f59138815709826295554bd64ebb2539", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/513b64b2f59138815709826295554bd64ebb2539", "committedDate": "2021-01-14T10:20:18Z", "message": "Fixed bugs in tests"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "643a492125862b541024926ea440e41b5db463f3", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/643a492125862b541024926ea440e41b5db463f3", "committedDate": "2021-01-19T18:42:18Z", "message": "Use Storage Access Framework to access files in MediaLoadingTask"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3cb8c9bc6bd33ae369c9f0b2d5778fce3d0cfe4f", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/3cb8c9bc6bd33ae369c9f0b2d5778fce3d0cfe4f", "committedDate": "2021-01-19T19:10:23Z", "message": "All widgets that use files should use the same code to load them"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "702d409c5198973a27016faeddf7d6f8afe7c46e", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/702d409c5198973a27016faeddf7d6f8afe7c46e", "committedDate": "2021-01-19T19:10:24Z", "message": "Removed unused code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "de50836e8a120f26458827601f79f56d674ad1d7", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/de50836e8a120f26458827601f79f56d674ad1d7", "committedDate": "2021-01-19T20:04:34Z", "message": "Fixed custom splash screen image"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "32734194499287365954afcc86f08840f1a04600", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/32734194499287365954afcc86f08840f1a04600", "committedDate": "2021-01-19T20:58:47Z", "message": "Remove unused code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcxNzkwMDYx", "url": "https://github.com/getodk/collect/pull/4297#pullrequestreview-571790061", "createdAt": "2021-01-20T01:04:12Z", "commit": {"oid": "32734194499287365954afcc86f08840f1a04600"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQwMTowNDoxMlrOIWoi-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQwMTozMDoxNVrOIWpGZA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDYwMzg5OA==", "bodyText": "This happens to work for some common types like image/jpeg but the subtype name is not guaranteed to be the extension. For example the SVG MIME type is image/svg+xml but its extension is .svg. Or audio/amr-wb and .amr. I think you have to use MimeTypeMap#getExtensionFromMimeType.", "url": "https://github.com/getodk/collect/pull/4297#discussion_r560603898", "createdAt": "2021-01-20T01:04:12Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/dao/helpers/ContentResolverHelper.java", "diffHunk": "@@ -76,20 +73,8 @@ public static String getFormPath(Uri uri) {\n         return formPath;\n     }\n \n-    /**\n-     * Using contentResolver to get a file's extension by the uri\n-     *\n-     * @param fileUri Whose name we want to get\n-     * @return The file's extension without a dot eg. \"mp3\" not \".mp3\"\n-     */\n-    public static String getFileExtensionFromUri(Context context, Uri fileUri) {\n-        String fileName = new MediaUtils().getFileNameFromUri(context, fileUri);\n-        if (fileName != null && fileName.contains(\".\")) {\n-            return fileName.substring(fileName.lastIndexOf('.') + 1);\n-        } else {\n-            return fileUri.getScheme() != null && fileUri.getScheme().equals(ContentResolver.SCHEME_CONTENT)\n-                    ? MimeTypeMap.getSingleton().getExtensionFromMimeType(context.getContentResolver().getType(fileUri))\n-                    : MimeTypeMap.getFileExtensionFromUrl(fileUri.toString());\n-        }\n+    public static String getFileExtensionFromUri(Uri fileUri) {\n+        String mimeType = getContentResolver().getType(fileUri);\n+        return mimeType.substring(mimeType.lastIndexOf(\"/\") + 1);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32734194499287365954afcc86f08840f1a04600"}, "originalPosition": 40}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDYwODA5Mg==", "bodyText": "I think this can all go away once we don't support files in /sdcard/odk/ anymore but at the moment, removing it could result in a crash if someone's migration failed, they haven't yet granted permissions, and they try to access forms from an external app, right?", "url": "https://github.com/getodk/collect/pull/4297#discussion_r560608092", "createdAt": "2021-01-20T01:16:34Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/provider/FormsProvider.java", "diffHunk": "@@ -87,12 +86,6 @@ public static void releaseDatabaseHelper() {\n \n     @Override\n     public boolean onCreate() {\n-\n-        if (!areStoragePermissionsGranted(getContext())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32734194499287365954afcc86f08840f1a04600"}, "originalPosition": 13}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDYwODIyMQ==", "bodyText": "Same question as for FormsProvider.", "url": "https://github.com/getodk/collect/pull/4297#discussion_r560608221", "createdAt": "2021-01-20T01:16:58Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/provider/InstanceProvider.java", "diffHunk": "@@ -87,11 +86,6 @@ public static void releaseDatabaseHelper() {\n \n     @Override\n     public boolean onCreate() {\n-        if (!areStoragePermissionsGranted(getContext())) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32734194499287365954afcc86f08840f1a04600"}, "originalPosition": 12}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDYxMjk2NA==", "bodyText": "This seems unnecessary and likely to fail. It should be possible to use FileProvider#getType.", "url": "https://github.com/getodk/collect/pull/4297#discussion_r560612964", "createdAt": "2021-01-20T01:30:15Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/utilities/MediaUtils.java", "diffHunk": "@@ -82,362 +60,8 @@ public void openFile(Context context, File file) {\n         }\n     }\n \n-    public String getMimeType(String url) {\n+    private String getMimeType(String url) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32734194499287365954afcc86f08840f1a04600"}, "originalPosition": 60}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTcxODA1MDI2", "url": "https://github.com/getodk/collect/pull/4297#pullrequestreview-571805026", "createdAt": "2021-01-20T01:43:20Z", "commit": {"oid": "32734194499287365954afcc86f08840f1a04600"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQwMTo0MzoyMFrOIWpXPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMFQwMTo0MzoyMFrOIWpXPQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDYxNzI3Nw==", "bodyText": "FormSaveViewModel.createAnswerFile returns a LiveData<Result<String>> used to set the data from a file name. Have you tried this change with internal recording?", "url": "https://github.com/getodk/collect/pull/4297#discussion_r560617277", "createdAt": "2021-01-20T01:43:20Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/widgets/AudioWidget.java", "diffHunk": "@@ -144,40 +144,25 @@ public IAnswerData getAnswer() {\n         }\n     }\n \n-    /**", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "32734194499287365954afcc86f08840f1a04600"}, "originalPosition": 4}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0c1ff84374c4ca7dc7c83067cea384473fcb1767", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/0c1ff84374c4ca7dc7c83067cea384473fcb1767", "committedDate": "2021-01-20T13:11:08Z", "message": "Protect the app from crashes when ContentProviders are used from external apps"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9cf9074baf82bb68c822144de6fa995d942c6406", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/9cf9074baf82bb68c822144de6fa995d942c6406", "committedDate": "2021-01-20T13:08:29Z", "message": "Protect the app from crashes when ContentProviders are used from external apps"}, "afterCommit": {"oid": "0c1ff84374c4ca7dc7c83067cea384473fcb1767", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/0c1ff84374c4ca7dc7c83067cea384473fcb1767", "committedDate": "2021-01-20T13:11:08Z", "message": "Protect the app from crashes when ContentProviders are used from external apps"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "484d006515792d6d64664ebdfb4c86cb73167029", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/484d006515792d6d64664ebdfb4c86cb73167029", "committedDate": "2021-01-20T13:52:16Z", "message": "Fixed getMimeType() method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "692c702cac3b5575ff4446b34468397bf642ae77", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/692c702cac3b5575ff4446b34468397bf642ae77", "committedDate": "2021-01-20T13:53:57Z", "message": "Removed unused methods from FileUtil class"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "17f71d23762d4e3d2b5b4c03d9851dc4fea95f21", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/17f71d23762d4e3d2b5b4c03d9851dc4fea95f21", "committedDate": "2021-01-20T14:09:54Z", "message": "Fixed bugs"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "094c81c742d4a21dda05fa1d58a995b8ad1a3701", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/094c81c742d4a21dda05fa1d58a995b8ad1a3701", "committedDate": "2021-01-20T14:31:59Z", "message": "Improved VideoWidget and opening files"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e3e436ed0fdfc9ece9fa63bd101e6db400786b97", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/e3e436ed0fdfc9ece9fa63bd101e6db400786b97", "committedDate": "2021-01-20T18:49:34Z", "message": "Improved getFileExtensionFromUri() method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9acae2277aea888be2c36d8775e56d601a9d1dcf", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/9acae2277aea888be2c36d8775e56d601a9d1dcf", "committedDate": "2021-01-20T19:09:48Z", "message": "Fixed bug in MediaUtils#openFile() method"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "024918cecbb3a10f0338f3dd29cbd44e4c21193e", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/024918cecbb3a10f0338f3dd29cbd44e4c21193e", "committedDate": "2021-01-20T14:44:41Z", "message": "Check if read permission granted before using uris"}, "afterCommit": {"oid": "9acae2277aea888be2c36d8775e56d601a9d1dcf", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/9acae2277aea888be2c36d8775e56d601a9d1dcf", "committedDate": "2021-01-20T19:09:48Z", "message": "Fixed bug in MediaUtils#openFile() method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4a62f094a2da89faaae0c9a9e8fbb9896b4f0822", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/4a62f094a2da89faaae0c9a9e8fbb9896b4f0822", "committedDate": "2021-01-20T19:20:58Z", "message": "Improved getFileExtensionFromUri() method"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "280d9d45844263522b837861c5f952732f72e437", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/280d9d45844263522b837861c5f952732f72e437", "committedDate": "2021-01-20T19:30:38Z", "message": "Fixed getMimeType()"}, "afterCommit": {"oid": "f702b0b7cd82a52749a028dfe3043b6c22127b25", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/f702b0b7cd82a52749a028dfe3043b6c22127b25", "committedDate": "2021-01-20T19:43:45Z", "message": "Fixed getMimeType()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "768b62b9fdbc193a4212726bd5ff682dfdb48289", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/768b62b9fdbc193a4212726bd5ff682dfdb48289", "committedDate": "2021-01-21T10:37:04Z", "message": "Fixed getMimeType()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "333fc9fec7e0f73a1f7dfd5590a454b9f47dbcf6", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/333fc9fec7e0f73a1f7dfd5590a454b9f47dbcf6", "committedDate": "2021-01-21T10:42:25Z", "message": "Fixed pmd"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d66f2240fcd39f9babec8d0e6b71801e969cb2f", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/0d66f2240fcd39f9babec8d0e6b71801e969cb2f", "committedDate": "2021-01-21T11:10:28Z", "message": "Improved saveAnswerFileFromUri method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "889404636a05331d9d83d1dff5ffca97411ecb77", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/889404636a05331d9d83d1dff5ffca97411ecb77", "committedDate": "2021-01-21T11:11:54Z", "message": "Improved getFileExtensionFromUri() methdo"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ecbf1d5a1754de75064fd83d115911308a7619ee", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/ecbf1d5a1754de75064fd83d115911308a7619ee", "committedDate": "2021-01-21T11:14:20Z", "message": "Fixed pmd"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f702b0b7cd82a52749a028dfe3043b6c22127b25", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/f702b0b7cd82a52749a028dfe3043b6c22127b25", "committedDate": "2021-01-20T19:43:45Z", "message": "Fixed getMimeType()"}, "afterCommit": {"oid": "ecbf1d5a1754de75064fd83d115911308a7619ee", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/ecbf1d5a1754de75064fd83d115911308a7619ee", "committedDate": "2021-01-21T11:14:20Z", "message": "Fixed pmd"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "08e3c9ed26a0d2ff17017c7d045d72c70c4faf27", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/08e3c9ed26a0d2ff17017c7d045d72c70c4faf27", "committedDate": "2021-01-21T12:30:32Z", "message": "Fixed ArbitraryFileWidgetTest"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6f335cfcddabc0576ae0e67286e87ff11d087d3", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/c6f335cfcddabc0576ae0e67286e87ff11d087d3", "committedDate": "2021-01-21T13:19:18Z", "message": "Fixed VideoWidgetTest"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTczNTEyMjA2", "url": "https://github.com/getodk/collect/pull/4297#pullrequestreview-573512206", "createdAt": "2021-01-21T16:30:51Z", "commit": {"oid": "714a264d9334378dc499b51d8a9edbe836d97269"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMVQxNjozMDo1MVrOIX_EFA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMS0wMS0yMVQxNjozMDo1MVrOIX_EFA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjAyMTM5Ng==", "bodyText": "Wouldn't we always be dealing with content URIs here? In what cases would we have file URIs?", "url": "https://github.com/getodk/collect/pull/4297#discussion_r562021396", "createdAt": "2021-01-21T16:30:51Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/dao/helpers/ContentResolverHelper.java", "diffHunk": "@@ -76,20 +79,43 @@ public static String getFormPath(Uri uri) {\n         return formPath;\n     }\n \n-    /**\n-     * Using contentResolver to get a file's extension by the uri\n-     *\n-     * @param fileUri Whose name we want to get\n-     * @return The file's extension without a dot eg. \"mp3\" not \".mp3\"\n-     */\n-    public static String getFileExtensionFromUri(Context context, Uri fileUri) {\n-        String fileName = new MediaUtils().getFileNameFromUri(context, fileUri);\n-        if (fileName != null && fileName.contains(\".\")) {\n-            return fileName.substring(fileName.lastIndexOf('.') + 1);\n-        } else {\n-            return fileUri.getScheme() != null && fileUri.getScheme().equals(ContentResolver.SCHEME_CONTENT)\n-                    ? MimeTypeMap.getSingleton().getExtensionFromMimeType(context.getContentResolver().getType(fileUri))\n-                    : MimeTypeMap.getFileExtensionFromUrl(fileUri.toString());\n+    public static String getFileExtensionFromUri(Uri fileUri) {\n+        String mimeType = getContentResolver().getType(fileUri);\n+\n+        String extension = fileUri.getScheme() != null && fileUri.getScheme().equals(ContentResolver.SCHEME_CONTENT)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "714a264d9334378dc499b51d8a9edbe836d97269"}, "originalPosition": 44}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d23c73d536891d04f8401d8b80fd12f735f25c9b", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/d23c73d536891d04f8401d8b80fd12f735f25c9b", "committedDate": "2021-01-21T16:33:29Z", "message": "Fixed AudioWidget"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "714a264d9334378dc499b51d8a9edbe836d97269", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/714a264d9334378dc499b51d8a9edbe836d97269", "committedDate": "2021-01-21T16:11:53Z", "message": "Fixed AudioWidget"}, "afterCommit": {"oid": "d23c73d536891d04f8401d8b80fd12f735f25c9b", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/d23c73d536891d04f8401d8b80fd12f735f25c9b", "committedDate": "2021-01-21T16:33:29Z", "message": "Fixed AudioWidget"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTczNTcxMDUz", "url": "https://github.com/getodk/collect/pull/4297#pullrequestreview-573571053", "createdAt": "2021-01-21T17:31:45Z", "commit": {"oid": "d23c73d536891d04f8401d8b80fd12f735f25c9b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bdfce87fdfb29cf4b5343a312c9755b7a3d036f7", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/bdfce87fdfb29cf4b5343a312c9755b7a3d036f7", "committedDate": "2021-01-25T12:53:29Z", "message": "Check Uri permission before accesing it"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "57909eb117e74aa77a3a0937aec068bfe9359975", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/57909eb117e74aa77a3a0937aec068bfe9359975", "committedDate": "2021-01-25T13:05:55Z", "message": "Check Uri permission before accesing it in ODKView"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cb1a1a616e8e59202c988f179a1f02e8aa3cb1bf", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/cb1a1a616e8e59202c988f179a1f02e8aa3cb1bf", "committedDate": "2021-01-25T13:12:02Z", "message": "Improved tests for intent group"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7f9a90a485292516c13cf0213f243419d993e396", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/7f9a90a485292516c13cf0213f243419d993e396", "committedDate": "2021-01-25T13:17:03Z", "message": "Moved the new message about not granted file permission to strings"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8ace0bfad0a015240e4ff7b820a511610a040e96", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/8ace0bfad0a015240e4ff7b820a511610a040e96", "committedDate": "2021-01-25T13:23:04Z", "message": "Added tests to PermissionsProviderTest"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "a580e7437038d5a3d812203c81c1aab43651c57c", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/a580e7437038d5a3d812203c81c1aab43651c57c", "committedDate": "2021-01-26T11:50:45Z", "message": "Improved isReadUriPermissionGranted() method"}, "afterCommit": {"oid": "67b416cd70c356723dfb34e14c07109ceb4ad5ea", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/67b416cd70c356723dfb34e14c07109ceb4ad5ea", "committedDate": "2021-01-26T12:22:39Z", "message": "Improved isReadUriPermissionGranted() method"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bb23041a24e96e57c6f8b331a0a91ca3220f167b", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/bb23041a24e96e57c6f8b331a0a91ca3220f167b", "committedDate": "2021-01-26T12:50:15Z", "message": "Improved isReadUriPermissionGranted() method"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "67b416cd70c356723dfb34e14c07109ceb4ad5ea", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/67b416cd70c356723dfb34e14c07109ceb4ad5ea", "committedDate": "2021-01-26T12:22:39Z", "message": "Improved isReadUriPermissionGranted() method"}, "afterCommit": {"oid": "bb23041a24e96e57c6f8b331a0a91ca3220f167b", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/bb23041a24e96e57c6f8b331a0a91ca3220f167b", "committedDate": "2021-01-26T12:50:15Z", "message": "Improved isReadUriPermissionGranted() method"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2366, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}