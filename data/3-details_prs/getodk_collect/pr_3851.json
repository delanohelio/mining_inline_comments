{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDIxMTg1MTI0", "number": 3851, "title": "Fixed Dialog Button for Experimental Magenta Theme", "bodyText": "Work towards #3849\n\nWhat has been done to verify that this works as intended?\nI tested it.\n\n\n\nLight Theme\nMagenta Theme\n\n\n\n\n\n\n\n\n\nWhy is this the best possible solution? Were any other approaches considered?\nI replaced Progress dialog with Alert dialog, and inflated the view with progress_dialog.xml file.\nHow does this change affect users? Describe intentional changes to behavior and behavior that could have accidentally been affected by code changes. In other words, what are the regression risks?\nNo\nDo we need any specific form for testing your changes? If so, please attach one.\nNo\nDoes this change require updates to documentation? If so, please file an issue here and include the link below.\nNo\nBefore submitting this PR, please make sure you have:\n\n run ./gradlew checkAll and confirmed all checks still pass OR confirm CircleCI build passes and run ./gradlew connectedDebugAndroidTest locally.\n verified that any code or assets from external sources are properly credited in comments and/or in the about file.\n verified that any new UI elements use theme colors. UI Components Style guidelines", "createdAt": "2020-05-21T06:56:15Z", "url": "https://github.com/getodk/collect/pull/3851", "merged": true, "mergeCommit": {"oid": "5c7b7da6768e0939df8f891883eaeb57f1059c9f"}, "closed": true, "closedAt": "2020-06-04T14:18:58Z", "author": {"login": "SaumiaSinghal"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcl-mkHgFqTQyMDc3Mjg5MQ==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcn8pgTABqjM0MDY0Njc2OTQ=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIwNzcyODkx", "url": "https://github.com/getodk/collect/pull/3851#pullrequestreview-420772891", "createdAt": "2020-05-29T08:57:20Z", "commit": {"oid": "2a9ed6bc971a2514a627613b48b12c316d57d90c"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwODo1NzoyMFrOGcUhOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0yOVQwODo1NzoyMFrOGcUhOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjM0OTQ5OA==", "bodyText": "Could this not use a ProgressDialogFragment instead?", "url": "https://github.com/getodk/collect/pull/3851#discussion_r432349498", "createdAt": "2020-05-29T08:57:20Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/activities/FormDownloadListActivity.java", "diffHunk": "@@ -683,7 +684,7 @@ public void onClick(DialogInterface dialog, int i) {\n     }\n \n     private void createProgressDialog() {\n-        progressDialog = new ProgressDialog(this);\n+        progressDialog = new AlertDialog.Builder(this).create();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2a9ed6bc971a2514a627613b48b12c316d57d90c"}, "originalPosition": 22}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIyNjQ0MDA2", "url": "https://github.com/getodk/collect/pull/3851#pullrequestreview-422644006", "createdAt": "2020-06-02T12:53:27Z", "commit": {"oid": "30b6145ba5af9bbfd7da28087861efb31bb92e73"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjo1MzoyN1rOGdwL_Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNi0wMlQxMjo1NDoxNlrOGdwNxw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg1MTM4OQ==", "bodyText": "This is the right thing to do, but we have a helper that does it for you! You can use DialogUtils.dismissDialog should help you out here.", "url": "https://github.com/getodk/collect/pull/3851#discussion_r433851389", "createdAt": "2020-06-02T12:53:27Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/activities/FormDownloadListActivity.java", "diffHunk": "@@ -253,26 +258,18 @@ public void onClick(View v) {\n         if (getLastCustomNonConfigurationInstance() instanceof DownloadFormListTask) {\n             downloadFormListTask = (DownloadFormListTask) getLastCustomNonConfigurationInstance();\n             if (downloadFormListTask.getStatus() == AsyncTask.Status.FINISHED) {\n-                try {\n-                    if (progressDialog != null && progressDialog.isShowing()) {\n-                        progressDialog.dismiss();\n-                    }\n-                    viewModel.setProgressDialogShowing(false);\n-                } catch (IllegalArgumentException e) {\n-                    Timber.i(\"Attempting to close a dialog that was not previously opened\");\n+                Fragment dialogFragment = getSupportFragmentManager().findFragmentByTag(ProgressDialogFragment.COLLECT_PROGRESS_DIALOG_TAG);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30b6145ba5af9bbfd7da28087861efb31bb92e73"}, "originalPosition": 51}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzg1MTg0Nw==", "bodyText": "Like with dismissing you can use DialogUtils.showIfNotShowing. Sorry I should have pointed those out before leading you down the ProgressDialogFragment path!", "url": "https://github.com/getodk/collect/pull/3851#discussion_r433851847", "createdAt": "2020-06-02T12:54:16Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/activities/FormDownloadListActivity.java", "diffHunk": "@@ -321,11 +318,8 @@ private void downloadFormList() {\n             }\n         } else {\n             viewModel.clearFormDetailsByFormId();\n-            if (progressDialog != null) {\n-                // This is needed because onPrepareDialog() is broken in 1.6.\n-                progressDialog.setMessage(viewModel.getProgressDialogMsg());\n-            }\n-            createProgressDialog();\n+            refreshFormListDialogFragment = new RefreshFormListDialogFragment();\n+            refreshFormListDialogFragment.show(getSupportFragmentManager(), ProgressDialogFragment.COLLECT_PROGRESS_DIALOG_TAG);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "30b6145ba5af9bbfd7da28087861efb31bb92e73"}, "originalPosition": 83}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDIzNzE4Mzc4", "url": "https://github.com/getodk/collect/pull/3851#pullrequestreview-423718378", "createdAt": "2020-06-03T16:14:55Z", "commit": {"oid": "aeb8df007f4aa36938eaee8d1ff5dbbd164c3ade"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "95637da39bb9261d5a72b307438e839f30450a5a", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/95637da39bb9261d5a72b307438e839f30450a5a", "committedDate": "2020-06-04T11:47:44Z", "message": "used alert dialog with view progress_dialog.xml in form download list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ebca7c6d8f197e93d12b77a8137dd4fbd4394781", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/ebca7c6d8f197e93d12b77a8137dd4fbd4394781", "committedDate": "2020-06-04T11:47:44Z", "message": "shifted text appearance attribute from xml to progress dialog fragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "878a0307ed14c28ba4d3e30b8c9af35189ecea69", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/878a0307ed14c28ba4d3e30b8c9af35189ecea69", "committedDate": "2020-06-04T11:47:44Z", "message": "move text appearance to progress_dialog.xml file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9f30b7e7c04fd1671e7f46ca76573148955228e9", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/9f30b7e7c04fd1671e7f46ca76573148955228e9", "committedDate": "2020-06-04T11:47:44Z", "message": "create Refresh Form dialog fragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9dae961c4b33f71f291e0e102736c05a71e11599", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/9dae961c4b33f71f291e0e102736c05a71e11599", "committedDate": "2020-06-04T11:47:44Z", "message": "added test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3f1f34863ab75ab0d0bbc0a6974222a616589714", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/3f1f34863ab75ab0d0bbc0a6974222a616589714", "committedDate": "2020-06-04T11:47:44Z", "message": "replace alert dialog with RefreshFormListDialogFragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "bafab3c3bc221f12e97ad34dffac72f70a8ec229", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/bafab3c3bc221f12e97ad34dffac72f70a8ec229", "committedDate": "2020-06-04T11:47:44Z", "message": "fixed checkstyle"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0726e5b22f2bf36000ab99dd13b4015e1944c4b9", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/0726e5b22f2bf36000ab99dd13b4015e1944c4b9", "committedDate": "2020-06-04T11:47:44Z", "message": "add unit test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1e02111af2dc58b7dd8c7b4244bcfaa330405155", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/1e02111af2dc58b7dd8c7b4244bcfaa330405155", "committedDate": "2020-06-04T11:47:44Z", "message": "replace fargment.dismiss() by DialogUtils.dismissDialog()"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "24c295bb9e3570ad1a12e8b9d9e72feefaa159f8", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/24c295bb9e3570ad1a12e8b9d9e72feefaa159f8", "committedDate": "2020-06-04T11:47:44Z", "message": "replace fragment.show() by DialogUtils.showIfNotShowing()"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "aeb8df007f4aa36938eaee8d1ff5dbbd164c3ade", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/aeb8df007f4aa36938eaee8d1ff5dbbd164c3ade", "committedDate": "2020-06-02T13:28:05Z", "message": "replace fragment.show() by DialogUtils.showIfNotShowing()"}, "afterCommit": {"oid": "24c295bb9e3570ad1a12e8b9d9e72feefaa159f8", "author": {"user": {"login": "SaumiaSinghal", "name": "Saumia Singhal"}}, "url": "https://github.com/getodk/collect/commit/24c295bb9e3570ad1a12e8b9d9e72feefaa159f8", "committedDate": "2020-06-04T11:47:44Z", "message": "replace fragment.show() by DialogUtils.showIfNotShowing()"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2705, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}