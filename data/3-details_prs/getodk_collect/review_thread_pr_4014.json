{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDYzNTY5NzA2", "number": 4014, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwOTozNToyMVrOEVwJBQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwOTo0Njo0MFrOEVwfpw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMjQ0MjkzOnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/ExperimentalPreferencesFragment.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwOTozNToyMVrOG8r3hg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwOTozNToyMVrOG8r3hg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjI4NjQ3MA==", "bodyText": "Ah nice. These were left over from when they were androidx. and everything else was just android.", "url": "https://github.com/getodk/collect/pull/4014#discussion_r466286470", "createdAt": "2020-08-06T09:35:21Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/ExperimentalPreferencesFragment.java", "diffHunk": "@@ -6,13 +6,12 @@\n import androidx.annotation.NonNull;\n import androidx.annotation.Nullable;\n import androidx.fragment.app.FragmentActivity;\n-import androidx.preference.PreferenceFragmentCompat;\n \n import org.odk.collect.android.R;\n import org.odk.collect.android.activities.CollectAbstractActivity;\n import org.odk.collect.android.injection.DaggerUtils;\n \n-public class ExperimentalPreferencesFragment extends PreferenceFragmentCompat {\n+public class ExperimentalPreferencesFragment extends BasePreferenceFragment {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "64323d1dd8a3b0112b5fa162890208555a72e127"}, "originalPosition": 11}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMjQ4OTY0OnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/GeneralPreferencesFragment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwOTo0MzozNFrOG8sWoQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMTo1MDo1OFrOG8wK3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjI5NDQzMw==", "bodyText": "Are we not losing the adminMode argument here?", "url": "https://github.com/getodk/collect/pull/4014#discussion_r466294433", "createdAt": "2020-08-06T09:43:34Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/GeneralPreferencesFragment.java", "diffHunk": "@@ -82,22 +82,21 @@ public void onCreate(final Bundle savedInstanceState) {\n     public boolean onPreferenceClick(Preference preference) {\n         if (MultiClickGuard.allowClick(getClass().getName())) {\n             PreferenceFragmentCompat basePreferenceFragment = null;\n-            boolean adminMode = getArguments().getBoolean(INTENT_KEY_ADMIN_MODE, false);\n             switch (preference.getKey()) {\n                 case \"protocol\":\n-                    basePreferenceFragment = ServerPreferencesFragment.newInstance(adminMode);\n+                    basePreferenceFragment = new ServerPreferencesFragment();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2cfcdf83c3221ac7ede2fb434ef7e7ba28d8dbbe"}, "originalPosition": 8}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM1Njk1OA==", "bodyText": "No I just pass arguments from activity to fragments https://github.com/getodk/collect/pull/4014/files#diff-fc03fbca20bb6f86edfdee031f3509a4R74", "url": "https://github.com/getodk/collect/pull/4014#discussion_r466356958", "createdAt": "2020-08-06T11:50:58Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/GeneralPreferencesFragment.java", "diffHunk": "@@ -82,22 +82,21 @@ public void onCreate(final Bundle savedInstanceState) {\n     public boolean onPreferenceClick(Preference preference) {\n         if (MultiClickGuard.allowClick(getClass().getName())) {\n             PreferenceFragmentCompat basePreferenceFragment = null;\n-            boolean adminMode = getArguments().getBoolean(INTENT_KEY_ADMIN_MODE, false);\n             switch (preference.getKey()) {\n                 case \"protocol\":\n-                    basePreferenceFragment = ServerPreferencesFragment.newInstance(adminMode);\n+                    basePreferenceFragment = new ServerPreferencesFragment();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjI5NDQzMw=="}, "originalCommit": {"oid": "2cfcdf83c3221ac7ede2fb434ef7e7ba28d8dbbe"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMjQ5ODk1OnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/AdminPreferencesFragment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwOTo0NjowN1rOG8scNQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMTo0NzoxOVrOG8wEXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjI5NTg2MQ==", "bodyText": "Can we do a conditional cast here like in BasePreferencesFragment?", "url": "https://github.com/getodk/collect/pull/4014#discussion_r466295861", "createdAt": "2020-08-06T09:46:07Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/AdminPreferencesFragment.java", "diffHunk": "@@ -45,17 +47,15 @@\n import static org.odk.collect.android.preferences.GeneralKeys.CONSTRAINT_BEHAVIOR_ON_SWIPE;\n import static org.odk.collect.android.preferences.PreferencesActivity.INTENT_KEY_ADMIN_MODE;\n \n-public class AdminPreferencesFragment extends BasePreferenceFragment implements Preference.OnPreferenceClickListener {\n+public class AdminPreferencesFragment extends PreferenceFragmentCompat implements Preference.OnPreferenceClickListener {\n \n     public static final String ADMIN_PREFERENCES = \"admin_prefs\";\n \n     @Override\n     public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {\n-        super.onCreatePreferences(savedInstanceState, rootKey);\n-\n         getPreferenceManager().setSharedPreferencesName(ADMIN_PREFERENCES);\n-\n         setPreferencesFromResource(R.xml.admin_preferences, rootKey);\n+        ((CollectAbstractActivity) getActivity()).initToolbar(getPreferenceScreen().getTitle());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d395d59aeae2abdcb740baae8b8ea7a4a5cf5289"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM1NTI5Mw==", "bodyText": "Now it doesn't exist there and we set title only in BasePreferenceFragment which works for every screen.", "url": "https://github.com/getodk/collect/pull/4014#discussion_r466355293", "createdAt": "2020-08-06T11:47:19Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/AdminPreferencesFragment.java", "diffHunk": "@@ -45,17 +47,15 @@\n import static org.odk.collect.android.preferences.GeneralKeys.CONSTRAINT_BEHAVIOR_ON_SWIPE;\n import static org.odk.collect.android.preferences.PreferencesActivity.INTENT_KEY_ADMIN_MODE;\n \n-public class AdminPreferencesFragment extends BasePreferenceFragment implements Preference.OnPreferenceClickListener {\n+public class AdminPreferencesFragment extends PreferenceFragmentCompat implements Preference.OnPreferenceClickListener {\n \n     public static final String ADMIN_PREFERENCES = \"admin_prefs\";\n \n     @Override\n     public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {\n-        super.onCreatePreferences(savedInstanceState, rootKey);\n-\n         getPreferenceManager().setSharedPreferencesName(ADMIN_PREFERENCES);\n-\n         setPreferencesFromResource(R.xml.admin_preferences, rootKey);\n+        ((CollectAbstractActivity) getActivity()).initToolbar(getPreferenceScreen().getTitle());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjI5NTg2MQ=="}, "originalCommit": {"oid": "d395d59aeae2abdcb740baae8b8ea7a4a5cf5289"}, "originalPosition": 27}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjkxMjUwMDg3OnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/preferences/AdminPreferencesFragment.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQwOTo0Njo0MFrOG8sdXA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNlQxMTo0NzoyNlrOG8wEiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjI5NjE1Ng==", "bodyText": "Conditional cast for the child Fragments as well.", "url": "https://github.com/getodk/collect/pull/4014#discussion_r466296156", "createdAt": "2020-08-06T09:46:40Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/AdminPreferencesFragment.java", "diffHunk": "@@ -144,36 +144,31 @@ public boolean onPreferenceClick(Preference preference) {\n         return false;\n     }\n \n-    public static class MainMenuAccessPreferences extends BasePreferenceFragment {\n-\n+    public static class MainMenuAccessPreferences extends PreferenceFragmentCompat {\n         @Override\n-        public void onCreate(Bundle savedInstanceState) {\n-            super.onCreate(savedInstanceState);\n+        public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {\n             getPreferenceManager().setSharedPreferencesName(ADMIN_PREFERENCES);\n-\n-            addPreferencesFromResource(R.xml.main_menu_access_preferences);\n+            setPreferencesFromResource(R.xml.main_menu_access_preferences, rootKey);\n+            ((CollectAbstractActivity) getActivity()).initToolbar(getPreferenceScreen().getTitle());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d395d59aeae2abdcb740baae8b8ea7a4a5cf5289"}, "originalPosition": 46}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM1NTMzOQ==", "bodyText": "Now it doesn't exist there and we set title only in BasePreferenceFragment which works for every screen.", "url": "https://github.com/getodk/collect/pull/4014#discussion_r466355339", "createdAt": "2020-08-06T11:47:26Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/preferences/AdminPreferencesFragment.java", "diffHunk": "@@ -144,36 +144,31 @@ public boolean onPreferenceClick(Preference preference) {\n         return false;\n     }\n \n-    public static class MainMenuAccessPreferences extends BasePreferenceFragment {\n-\n+    public static class MainMenuAccessPreferences extends PreferenceFragmentCompat {\n         @Override\n-        public void onCreate(Bundle savedInstanceState) {\n-            super.onCreate(savedInstanceState);\n+        public void onCreatePreferences(Bundle savedInstanceState, String rootKey) {\n             getPreferenceManager().setSharedPreferencesName(ADMIN_PREFERENCES);\n-\n-            addPreferencesFromResource(R.xml.main_menu_access_preferences);\n+            setPreferencesFromResource(R.xml.main_menu_access_preferences, rootKey);\n+            ((CollectAbstractActivity) getActivity()).initToolbar(getPreferenceScreen().getTitle());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjI5NjE1Ng=="}, "originalCommit": {"oid": "d395d59aeae2abdcb740baae8b8ea7a4a5cf5289"}, "originalPosition": 46}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3265, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}