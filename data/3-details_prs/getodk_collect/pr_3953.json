{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQyNjE0OTQ2", "number": 3953, "title": "Avoid crashes that might occur while initializing map providers", "bodyText": "Closes #3846\nWhat has been done to verify that this works as intended?\nI reviewed implemented changes.\nWhy is this the best possible solution? Were any other approaches considered?\nThe first commit is not strictly a fix for the issue but should catch possible exceptions like:\nhttps://console.firebase.google.com/u/0/project/api-project-322300403941/crashlytics/app/android:org.odk.collect.android/issues/45c613c546aa3cea42be7d9fa55c286d?time=last-seven-days&sessionId=5EF99A4C0180000114A81ED19C1D1285_DNE_0_v2\nThe second commit I prepared based on:\nmapbox/mapbox-gl-native-android#126 (comment)\nand\nhttps://docs.mapbox.com/android/maps/overview/#5-lifecycle-methods\n@lognaturel you said that we should at least handle on destroy but in bot cases (links) they say that we should handle all lifecycle methods so just in case I think it's a good idea to do that.\nHow does this change affect users? Describe intentional changes to behavior and behavior that could have accidentally been affected by code changes. In other words, what are the regression risks?\nIt shouldn't change anything in behavior. It should just prevent from crashes so i'm not even sure if this pr requires testing.\nDo we need any specific form for testing your changes? If so, please attach one.\nNo.\nDoes this change require updates to documentation? If so, please file an issue here and include the link below.\nNo.\nBefore submitting this PR, please make sure you have:\n\n run ./gradlew checkAll and confirmed all checks still pass OR confirm CircleCI build passes and run ./gradlew connectedDebugAndroidTest locally.\n verified that any code or assets from external sources are properly credited in comments and/or in the about file.\n verified that any new UI elements use theme colors. UI Components Style guidelines", "createdAt": "2020-07-01T10:47:24Z", "url": "https://github.com/getodk/collect/pull/3953", "merged": true, "mergeCommit": {"oid": "e3af6bbd17588e7c6acf649d5da38af1d187314f"}, "closed": true, "closedAt": "2020-07-08T22:52:31Z", "author": {"login": "grzesiek2010"}, "timelineItems": {"totalCount": 10, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcwnl_9gH2gAyNDQyNjE0OTQ2OjU1ZDNjODAwNmI4Yzg0ZDU1YjFkNzlmOTUyYjJjZTU4MTJhYWM4ZDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABczCgqDAFqTQ0NTE4MDgxMg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "55d3c8006b8c84d55b1d79f952b2ce5812aac8d3", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/55d3c8006b8c84d55b1d79f952b2ce5812aac8d3", "committedDate": "2020-07-01T10:22:15Z", "message": "Catch possible exceptions while initializing map providers"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "2f1a3df90ea26afeb4eb46c74d8683af69e3883c", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/2f1a3df90ea26afeb4eb46c74d8683af69e3883c", "committedDate": "2020-07-01T11:15:05Z", "message": "Manage mapbox map lifecycle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "2629931ca97acf819845208d59f144ec475cce37", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/2629931ca97acf819845208d59f144ec475cce37", "committedDate": "2020-07-01T10:26:32Z", "message": "Manage mapbox map lifecycle"}, "afterCommit": {"oid": "2f1a3df90ea26afeb4eb46c74d8683af69e3883c", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/2f1a3df90ea26afeb4eb46c74d8683af69e3883c", "committedDate": "2020-07-01T11:15:05Z", "message": "Manage mapbox map lifecycle"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxMjY5Mzcx", "url": "https://github.com/getodk/collect/pull/3953#pullrequestreview-441269371", "createdAt": "2020-07-02T00:09:11Z", "commit": {"oid": "2f1a3df90ea26afeb4eb46c74d8683af69e3883c"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQxODIzMDkx", "url": "https://github.com/getodk/collect/pull/3953#pullrequestreview-441823091", "createdAt": "2020-07-02T15:53:47Z", "commit": {"oid": "2f1a3df90ea26afeb4eb46c74d8683af69e3883c"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo1Mzo0N1rOGsTu5g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0wMlQxNTo1Mzo0N1rOGsTu5g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTExMzgzMA==", "bodyText": "I'm just wondering if it's possible to put the MapView in a Fragment so we can have all the lifecycle \"forwarding\" in there. Thinking we have like a MapBoxInitializationFragment that the MainMenuActivity can host. Then we can keep all this noise out of MainMenuActivity.", "url": "https://github.com/getodk/collect/pull/3953#discussion_r449113830", "createdAt": "2020-07-02T15:53:47Z", "author": {"login": "seadowg"}, "path": "collect_app/src/main/java/org/odk/collect/android/activities/MainMenuActivity.java", "diffHunk": "@@ -314,6 +316,14 @@ public void onClick(View v) {\n         }\n     }\n \n+    @Override\n+    protected void onStart() {\n+        super.onStart();\n+        if (mapView != null) {\n+            mapView.onStart();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2f1a3df90ea26afeb4eb46c74d8683af69e3883c"}, "originalPosition": 17}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "29e54365e272f78e7322ec39c0c22f0c31da9abd", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/29e54365e272f78e7322ec39c0c22f0c31da9abd", "committedDate": "2020-07-08T11:12:10Z", "message": "Moved mapbox map to a separate fragment"}, "afterCommit": {"oid": "223406b784d75681837035a1a6c55bcf4bbfbd41", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/223406b784d75681837035a1a6c55bcf4bbfbd41", "committedDate": "2020-07-08T11:15:32Z", "message": "Moved mapbox map to a separate fragment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "223406b784d75681837035a1a6c55bcf4bbfbd41", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/223406b784d75681837035a1a6c55bcf4bbfbd41", "committedDate": "2020-07-08T11:15:32Z", "message": "Moved mapbox map to a separate fragment"}, "afterCommit": {"oid": "ab1d36290d9dfc5e32a619ffae07ba204af63a0e", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/ab1d36290d9dfc5e32a619ffae07ba204af63a0e", "committedDate": "2020-07-08T11:22:12Z", "message": "Moved mapbox map to a separate fragment"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f5e815bd6fc9b9f64bd2a6af4e2f078595374472", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/f5e815bd6fc9b9f64bd2a6af4e2f078595374472", "committedDate": "2020-07-08T11:53:50Z", "message": "Moved mapbox map to a separate fragment"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ab1d36290d9dfc5e32a619ffae07ba204af63a0e", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/ab1d36290d9dfc5e32a619ffae07ba204af63a0e", "committedDate": "2020-07-08T11:22:12Z", "message": "Moved mapbox map to a separate fragment"}, "afterCommit": {"oid": "f5e815bd6fc9b9f64bd2a6af4e2f078595374472", "author": {"user": {"login": "grzesiek2010", "name": "Grzegorz Orczykowski"}}, "url": "https://github.com/getodk/collect/commit/f5e815bd6fc9b9f64bd2a6af4e2f078595374472", "committedDate": "2020-07-08T11:53:50Z", "message": "Moved mapbox map to a separate fragment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDQ1MTgwODEy", "url": "https://github.com/getodk/collect/pull/3953#pullrequestreview-445180812", "createdAt": "2020-07-08T22:51:42Z", "commit": {"oid": "f5e815bd6fc9b9f64bd2a6af4e2f078595374472"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2524, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}