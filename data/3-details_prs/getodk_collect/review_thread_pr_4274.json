{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTMzNjgxMjc5", "number": 4274, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNjo1MToyNVrOFB4M2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNjo1MjozOVrOFB4PZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM3NTEzNjkwOnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/utilities/CameraUtils.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNjo1MToyNVrOIAwRhQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QyMjo0MzoxMVrOIA-LXg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY2MTgyOQ==", "bodyText": "If you're going to be creating a new StoragePathProvider here anyway I think you can do away with the indirection and just use new StoragePathProvider().getTmpVideoPath() inline.", "url": "https://github.com/getodk/collect/pull/4274#discussion_r537661829", "createdAt": "2020-12-07T16:51:25Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/utilities/CameraUtils.java", "diffHunk": "@@ -123,10 +124,8 @@ public static void savePhoto(String path, byte[] data) {\n             Timber.e(e);\n         }\n     }\n-  \n-    public static String getVideoFilePath(Context context) {\n-        final File dir = context.getExternalFilesDir(null);\n-        return (dir == null ? \"\" : (dir.getAbsolutePath() + \"/\"))\n-                + System.currentTimeMillis() + \".mp4\";\n+\n+    public static String getVideoFilePath() {\n+        return new StoragePathProvider().getTmpVideoPath();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a88266cc20e3cf296efa8e6ae4adc96d3a567116"}, "originalPosition": 19}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg4OTYzMA==", "bodyText": "Done.", "url": "https://github.com/getodk/collect/pull/4274#discussion_r537889630", "createdAt": "2020-12-07T22:43:11Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/utilities/CameraUtils.java", "diffHunk": "@@ -123,10 +124,8 @@ public static void savePhoto(String path, byte[] data) {\n             Timber.e(e);\n         }\n     }\n-  \n-    public static String getVideoFilePath(Context context) {\n-        final File dir = context.getExternalFilesDir(null);\n-        return (dir == null ? \"\" : (dir.getAbsolutePath() + \"/\"))\n-                + System.currentTimeMillis() + \".mp4\";\n+\n+    public static String getVideoFilePath() {\n+        return new StoragePathProvider().getTmpVideoPath();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY2MTgyOQ=="}, "originalCommit": {"oid": "a88266cc20e3cf296efa8e6ae4adc96d3a567116"}, "originalPosition": 19}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzM3NTE0MzQyOnYy", "diffSide": "RIGHT", "path": "collect_app/src/main/java/org/odk/collect/android/storage/StoragePathProvider.java", "isResolved": false, "comments": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wN1QxNjo1MjozOVrOIAwVPQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMi0wOFQxMTowOTo1N1rOIBULAQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY2Mjc4MQ==", "bodyText": "This is an existing issue but still want to highlight it. I don't think we know the image is a jpg. It could be a png, bmp, ... We should fix this at some point. Maybe a separate issue?", "url": "https://github.com/getodk/collect/pull/4274#discussion_r537662781", "createdAt": "2020-12-07T16:52:39Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/storage/StoragePathProvider.java", "diffHunk": "@@ -79,11 +79,11 @@ public String getStorageRootDirPath() {\n                 : getUnscopedStorageRootDirPath();\n     }\n \n-    public String getTmpFilePath() {\n+    public String getTmpImageFilePath() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "277e217f110903c7f6269659c87424bca96939aa"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzg5MjE4MA==", "bodyText": "You are right I'll file an issue.", "url": "https://github.com/getodk/collect/pull/4274#discussion_r537892180", "createdAt": "2020-12-07T22:48:20Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/storage/StoragePathProvider.java", "diffHunk": "@@ -79,11 +79,11 @@ public String getStorageRootDirPath() {\n                 : getUnscopedStorageRootDirPath();\n     }\n \n-    public String getTmpFilePath() {\n+    public String getTmpImageFilePath() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY2Mjc4MQ=="}, "originalCommit": {"oid": "277e217f110903c7f6269659c87424bca96939aa"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzkwMDQ3Ng==", "bodyText": "Hmm unfortunately I think it's not possible... we pass our tmp file starting a camera app because it's a way to capture a full-size photo:\nhttps://developer.android.com/training/camera/photobasics#TaskPath\nwe don't know what format such an external app is going to return so like in the documentation we use jpg. Then the captured photo is saved to our tmp file.", "url": "https://github.com/getodk/collect/pull/4274#discussion_r537900476", "createdAt": "2020-12-07T23:05:22Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/storage/StoragePathProvider.java", "diffHunk": "@@ -79,11 +79,11 @@ public String getStorageRootDirPath() {\n                 : getUnscopedStorageRootDirPath();\n     }\n \n-    public String getTmpFilePath() {\n+    public String getTmpImageFilePath() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY2Mjc4MQ=="}, "originalCommit": {"oid": "277e217f110903c7f6269659c87424bca96939aa"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzkwNDk0Mg==", "bodyText": "I see. Can we check the mime type and fix the extension later? I think all images are submitted with a jpg extension but maybe I\u2019m remembering wrong.", "url": "https://github.com/getodk/collect/pull/4274#discussion_r537904942", "createdAt": "2020-12-07T23:14:34Z", "author": {"login": "lognaturel"}, "path": "collect_app/src/main/java/org/odk/collect/android/storage/StoragePathProvider.java", "diffHunk": "@@ -79,11 +79,11 @@ public String getStorageRootDirPath() {\n                 : getUnscopedStorageRootDirPath();\n     }\n \n-    public String getTmpFilePath() {\n+    public String getTmpImageFilePath() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY2Mjc4MQ=="}, "originalCommit": {"oid": "277e217f110903c7f6269659c87424bca96939aa"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODI0OTk4NQ==", "bodyText": "No really, I mean we can read mime type using the tmp file where an external app saves captured photos but it's pointless because it will always be jpeg.", "url": "https://github.com/getodk/collect/pull/4274#discussion_r538249985", "createdAt": "2020-12-08T11:09:57Z", "author": {"login": "grzesiek2010"}, "path": "collect_app/src/main/java/org/odk/collect/android/storage/StoragePathProvider.java", "diffHunk": "@@ -79,11 +79,11 @@ public String getStorageRootDirPath() {\n                 : getUnscopedStorageRootDirPath();\n     }\n \n-    public String getTmpFilePath() {\n+    public String getTmpImageFilePath() {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzY2Mjc4MQ=="}, "originalCommit": {"oid": "277e217f110903c7f6269659c87424bca96939aa"}, "originalPosition": 5}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3198, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}