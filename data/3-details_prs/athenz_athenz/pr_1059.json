{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU3MTY0OTY1", "number": 1059, "title": "Remove references to Role Tokens and N Tokes from Documentation", "bodyText": "I confirm that this contribution is made under the terms of the license found in the root directory of this repository's source tree and that I have the authority necessary to make this contribution on behalf of its copyright owner.", "createdAt": "2020-07-27T13:29:14Z", "url": "https://github.com/AthenZ/athenz/pull/1059", "merged": true, "mergeCommit": {"oid": "a9e47ca2bb0b3370b1ce0e98e02ef60fea2bb358"}, "closed": true, "closedAt": "2020-08-21T00:08:47Z", "author": {"login": "OferLevi85"}, "timelineItems": {"totalCount": 14, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5CmjQgBqjM1OTAwOTY0NDM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdA5Yi3AFqTQ3MjA2MzExMw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "681f0769f0b7aea33a63954a075b545ec642c1e3", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/681f0769f0b7aea33a63954a075b545ec642c1e3", "committedDate": "2020-07-27T13:28:26Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}, "afterCommit": {"oid": "4eec273e45b67c203c8d7b88b0fe348d7b6ef7e9", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/4eec273e45b67c203c8d7b88b0fe348d7b6ef7e9", "committedDate": "2020-07-27T14:21:20Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4eec273e45b67c203c8d7b88b0fe348d7b6ef7e9", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/4eec273e45b67c203c8d7b88b0fe348d7b6ef7e9", "committedDate": "2020-07-27T14:21:20Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}, "afterCommit": {"oid": "1f34a70ad437885b9395e835c08dfdb542c12bf8", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/1f34a70ad437885b9395e835c08dfdb542c12bf8", "committedDate": "2020-07-27T14:26:24Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1f34a70ad437885b9395e835c08dfdb542c12bf8", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/1f34a70ad437885b9395e835c08dfdb542c12bf8", "committedDate": "2020-07-27T14:26:24Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}, "afterCommit": {"oid": "4d6d5f42dd7850853e6b0076676a906656052c1d", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/4d6d5f42dd7850853e6b0076676a906656052c1d", "committedDate": "2020-07-27T14:52:50Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODkwMjM5", "url": "https://github.com/AthenZ/athenz/pull/1059#pullrequestreview-455890239", "createdAt": "2020-07-27T15:26:07Z", "commit": {"oid": "4d6d5f42dd7850853e6b0076676a906656052c1d"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU1ODk2MDYz", "url": "https://github.com/AthenZ/athenz/pull/1059#pullrequestreview-455896063", "createdAt": "2020-07-27T15:32:33Z", "commit": {"oid": "4d6d5f42dd7850853e6b0076676a906656052c1d"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozMjozM1rOG3n58Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yN1QxNTozMjozM1rOG3n58Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDk3ODY3Mw==", "bodyText": "We should mention Access tokens here with appropriate generic details about claims in the token.", "url": "https://github.com/AthenZ/athenz/pull/1059#discussion_r460978673", "createdAt": "2020-07-27T15:32:33Z", "author": {"login": "abvaidya"}, "path": "docs/data_model.md", "diffHunk": "@@ -199,92 +196,4 @@ perspective.\n A Service Identity may be used as a principal when specifying Roles, just like a\n User. Athenz provides support for registering such a Service Identity, in a domain,\n along with its public key that can be used to later verify an NToken that is\n-presented by the service.\n-\n-## Tokens\n---------\n-\n-Athenz authorization system utilizes 2 types of tokens: Principal Tokens\n-(NTokens) and RoleTokens (ZTokens).\n-\n-### Principal Token (NToken)\n-----------------------------\n-\n-The Principal token can be thought of an identity token because it\n-identifies either a user or a service. Users submit their credentials\n-to ZMS, which validates those credentials and generates, signs and\n-returns principal tokens. A service generates its principal token using\n-the service's private key. The principal token can then be used to access\n-role tokens.\n-\n-A principal token is serialized as a string with following attributes:\n-\n--   version (v) - the version of the token - U1 for user tokens and S1\n-    for service tokens\n--   domain (d) - the domain of principal. For users this will always be\n-    \"user\"\n--   name (n) - the name of the principal\n--   host (h) - the FQDN of the host that issued this token\n--   salt (a) - a salt\n--   time (t) - the time the token was issued\n--   expires (e) - the time the token expires\n--   keyId (k) - the key identifier of the private key that was used to\n-    sign this token\n--   ip (i) - the IP address where the request to get this token was\n-    initiated from\n--   authorized-services (b) - the list of services authorized to use\n-    this user token\n--   signature (s) - the signature of the other items\n-\n-The single letter in parentheses is the key in the serialized string,\n-where semicolons separate key value pairs, and the key and value are\n-separated by an equals sign.\n-\n-For example:\n-\n-    v=U1;d=user;n=joe;h=host.athenz.org;a=bb4e;t=1442255237;e=1442258837;k=0;i=10.72.42.32;s=Jw8SvYGYrk\n-\n-Note that requests that include a principal token should be protected to\n-keep the token from being intercepted and reused (for the lifetime of\n-the token). It is strongly recommended to always use HTTPS for such\n-requests.\n-\n-### Role Token (ZToken)\n------------------------\n-\n-Role tokens represent an authoritative statement that a given principal\n-may assume some number of roles in a domain for a limited period of\n-time. Like NTokens, they are signed to prevent tampering. In a sense,\n-the ZTS is an authority except that it is an authority\n-over Roles instead of Users.\n-\n-A role token is serialized as a string with following attributes:\n-\n--   version (v) - the version of the token - Z1\n--   domain (d) - the domain of role token\n--   roles (r) - a list of comma-separated role names\n--   principal (p) - the name of the principal (user/service) who\n-    requested this role token\n--   host (h) - the FQDN of the ZTS host that issued this token\n--   salt (a) - a salt\n--   time (t) - the time the token was issued\n--   expires (e) - the time the token expires\n--   keyId (k) - the key identifier of the ZTS private key that was\n-    used to sign this token\n--   ip (i) - the IP address where the request to get this token was\n-    initiated from\n--   signature (s) - the signature of the other items\n-\n-The single letter in parentheses is the key in the serialized string,\n-where semicolons separate key value pairs, and the key and value are\n-separated by an equals sign.\n-\n-For example:\n-\n-    v=Z1;d=media.news;r=editor;p=user.joe;h=host.athenz.com;a=bb4e;t=1442255237;e=1442258837;k=0;i=10.72.42.32;s=P43Vp_LQh1\"\n-\n-Note that requests that include a ZToken should be encrypted to keep the\n-ZToken from being intercepted and reused (for the lifetime of the\n-token). It is strongly recommended to always use HTTPS for such\n-requests.\n-", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4d6d5f42dd7850853e6b0076676a906656052c1d"}, "originalPosition": 102}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "4d6d5f42dd7850853e6b0076676a906656052c1d", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/4d6d5f42dd7850853e6b0076676a906656052c1d", "committedDate": "2020-07-27T14:52:50Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}, "afterCommit": {"oid": "f03142f48631e86b1e374642deb2bcac73434548", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/f03142f48631e86b1e374642deb2bcac73434548", "committedDate": "2020-07-30T09:03:43Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f03142f48631e86b1e374642deb2bcac73434548", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/f03142f48631e86b1e374642deb2bcac73434548", "committedDate": "2020-07-30T09:03:43Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}, "afterCommit": {"oid": "7ac1570196517d6feeb4e326f11f7b78c45d59e9", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/7ac1570196517d6feeb4e326f11f7b78c45d59e9", "committedDate": "2020-07-30T09:27:50Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxOTMwNjY1", "url": "https://github.com/AthenZ/athenz/pull/1059#pullrequestreview-461930665", "createdAt": "2020-08-05T18:45:29Z", "commit": {"oid": "7ac1570196517d6feeb4e326f11f7b78c45d59e9"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxODo0NTozMFrOG8WJfw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0wNVQxODo0OToxNlrOG8WRig==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkzMDYyMw==", "bodyText": "extra ) in concepts", "url": "https://github.com/AthenZ/athenz/pull/1059#discussion_r465930623", "createdAt": "2020-08-05T18:45:30Z", "author": {"login": "havetisyan"}, "path": "docs/data_model.md", "diffHunk": "@@ -11,11 +11,9 @@\n     * [Principals](#principals)\n         * [Users](#users)\n         * [Services](#services)\n-* [Tokens](#tokens)\n-    * [Principal Token - NToken](#principal-token-ntoken)\n-    * [Role Token - ZToken](#role-token-ztoken)\n+    *[Access Tokens](#access-tokens)\n \n-Having a firm grasp on some fundamental concepts will help you\n+Having a firm grasp on some fundamental concep)ts will help you", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ac1570196517d6feeb4e326f11f7b78c45d59e9"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkzMjE0Nw==", "bodyText": "This is actually not quite correct. ZMS does not issue certificates and the user may not their own x.509 certificates (like we issue based on ssh credentials). So the UserToken is the correct reference here as the environment may use any type of Principal Authority to authorize the user.", "url": "https://github.com/AthenZ/athenz/pull/1059#discussion_r465932147", "createdAt": "2020-08-05T18:48:19Z", "author": {"login": "havetisyan"}, "path": "docs/zms_client.md", "diffHunk": "@@ -81,19 +81,13 @@ Use the `-z` option to point to the required environment for executing commands.\n ## How the ZMS Client Authenticates\n -----------------------------------\n \n-The Athenz ZMS server requires the user to provide its `UserToken` to\n-authorize the requests. The `UserToken` is obtained from the ZMS Server\n+The Athenz ZMS server requires the user to authenticate using X509 certificate", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ac1570196517d6feeb4e326f11f7b78c45d59e9"}, "originalPosition": 6}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTkzMjY4Mg==", "bodyText": "Again this is only specific to VM and will not be valid for opensource. The ZMS authorization is based on the configured authority.", "url": "https://github.com/AthenZ/athenz/pull/1059#discussion_r465932682", "createdAt": "2020-08-05T18:49:16Z", "author": {"login": "havetisyan"}, "path": "docs/zms_client.md", "diffHunk": "@@ -81,19 +81,13 @@ Use the `-z` option to point to the required environment for executing commands.\n ## How the ZMS Client Authenticates\n -----------------------------------\n \n-The Athenz ZMS server requires the user to provide its `UserToken` to\n-authorize the requests. The `UserToken` is obtained from the ZMS Server\n+The Athenz ZMS server requires the user to authenticate using X509 certificate\n+and private key. The certificate and private key are obtained from the ZMS Server\n with the user\u2019s credentials and is valid for one hour.\n \n-Before communicating with the ZMS Server, the `zms-cli` utility:\n-\n-1.  prompts for the user's password\n-2.  generates an Authorization header and passes it to ZMS to retrieve a `UserToken`\n-\n After communicating with the ZMS Server, the `zms-cli` utility caches\n-the user's NToken in the user's home directory in the file `.ntoken`.\n-It will continue to use the token until it expires, and then will prompt\n-for the user's password.\n+the user's certificate and private key are stored in $HOME/.athenz directory with key and cert filenames. ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7ac1570196517d6feeb4e326f11f7b78c45d59e9"}, "originalPosition": 19}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "7ac1570196517d6feeb4e326f11f7b78c45d59e9", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/7ac1570196517d6feeb4e326f11f7b78c45d59e9", "committedDate": "2020-07-30T09:27:50Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}, "afterCommit": {"oid": "36895dc024c20a07a8548d10ef503525042fe304", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/36895dc024c20a07a8548d10ef503525042fe304", "committedDate": "2020-08-11T05:59:30Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MjM5Mjk5", "url": "https://github.com/AthenZ/athenz/pull/1059#pullrequestreview-465239299", "createdAt": "2020-08-11T16:35:44Z", "commit": {"oid": "36895dc024c20a07a8548d10ef503525042fe304"}, "state": "CHANGES_REQUESTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNjozNTo0NFrOG_AD-g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMVQxNjozNzozMVrOG_AILg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNDQ5MA==", "bodyText": "Let's not remove the Principal Token section - this is still valid and might be used by properties. Only role token references should be removed.", "url": "https://github.com/AthenZ/athenz/pull/1059#discussion_r468714490", "createdAt": "2020-08-11T16:35:44Z", "author": {"login": "havetisyan"}, "path": "docs/data_model.md", "diffHunk": "@@ -197,94 +195,16 @@ that the parent domain is an authority for the service itself, from a management\n perspective. \n \n A Service Identity may be used as a principal when specifying Roles, just like a\n-User. Athenz provides support for registering such a Service Identity, in a domain,\n-along with its public key that can be used to later verify an NToken that is\n-presented by the service.\n-\n-## Tokens\n---------\n-\n-Athenz authorization system utilizes 2 types of tokens: Principal Tokens\n-(NTokens) and RoleTokens (ZTokens).\n-\n-### Principal Token (NToken)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36895dc024c20a07a8548d10ef503525042fe304"}, "originalPosition": 43}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNDc2NA==", "bodyText": "This is still valid and should not be removed.", "url": "https://github.com/AthenZ/athenz/pull/1059#discussion_r468714764", "createdAt": "2020-08-11T16:36:12Z", "author": {"login": "havetisyan"}, "path": "docs/principal_authentication.md", "diffHunk": "@@ -106,29 +106,10 @@ to the `/etc/shadow` file. There are two options available:\n   group.\n \n User Authority is typically not allowed to carry out any authorized\n-operation. It is required that the user first must obtain an NToken\n-for his/her identity and use that NToken to carry out the authorized\n+operation. It is required that the user first must obtain an X509 certificate\n+for his/her identity and use that certificate to carry out the authorized\n request.\n \n-### Principal Authority", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36895dc024c20a07a8548d10ef503525042fe304"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNTI4OA==", "bodyText": "this is not correct since ZMS Server does not sign any x.509 certs. the previous text is correct. it is used for singing Principal Tokens (NTokens)", "url": "https://github.com/AthenZ/athenz/pull/1059#discussion_r468715288", "createdAt": "2020-08-11T16:37:03Z", "author": {"login": "havetisyan"}, "path": "docs/setup_zms.md", "diffHunk": "@@ -52,7 +52,7 @@ $ bin/setup_dev_zms.sh\n \n Running this setup script completes the following two tasks:\n \n-* Generate a unique private key that ZMS Server will use to sign any NTokens it issues\n+* Generate a unique private key that ZMS Server will use to sign any X509 certificates it issues", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36895dc024c20a07a8548d10ef503525042fe304"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODcxNTU2Ng==", "bodyText": "same comment as above. No certificates - only Principal Tokens (Ntokens)", "url": "https://github.com/AthenZ/athenz/pull/1059#discussion_r468715566", "createdAt": "2020-08-11T16:37:31Z", "author": {"login": "havetisyan"}, "path": "docs/setup_zms_prod.md", "diffHunk": "@@ -152,7 +152,7 @@ as input and returns key value that is your configured password.\n ---------------\n \n Generate a unique private key that ZMS Server will use\n-to sign any NTokens it issues. From the `athenz-zms-X.Y` directory\n+to sign any certificates it issues. From the `athenz-zms-X.Y` directory", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36895dc024c20a07a8548d10ef503525042fe304"}, "originalPosition": 5}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "36895dc024c20a07a8548d10ef503525042fe304", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/36895dc024c20a07a8548d10ef503525042fe304", "committedDate": "2020-08-11T05:59:30Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}, "afterCommit": {"oid": "5f0ff8e594f1f9eb67ee64c66f81c17dbcbc6fd4", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/5f0ff8e594f1f9eb67ee64c66f81c17dbcbc6fd4", "committedDate": "2020-08-19T12:56:52Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7a87f8bcfacdb52444681f059f49c075e3be8d84", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/7a87f8bcfacdb52444681f059f49c075e3be8d84", "committedDate": "2020-08-19T13:33:09Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5f0ff8e594f1f9eb67ee64c66f81c17dbcbc6fd4", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/5f0ff8e594f1f9eb67ee64c66f81c17dbcbc6fd4", "committedDate": "2020-08-19T12:56:52Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}, "afterCommit": {"oid": "7a87f8bcfacdb52444681f059f49c075e3be8d84", "author": {"user": {"login": "OferLevi85", "name": "Ofer Levi"}}, "url": "https://github.com/AthenZ/athenz/commit/7a87f8bcfacdb52444681f059f49c075e3be8d84", "committedDate": "2020-08-19T13:33:09Z", "message": "Remove references to Role Tokens and N Tokes from Documentation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDcyMDYzMTEz", "url": "https://github.com/AthenZ/athenz/pull/1059#pullrequestreview-472063113", "createdAt": "2020-08-21T00:08:38Z", "commit": {"oid": "7a87f8bcfacdb52444681f059f49c075e3be8d84"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3027, "cost": 1, "resetAt": "2021-11-01T11:59:11Z"}}}