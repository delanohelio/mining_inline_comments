{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNTIwMTI5", "number": 529, "title": "Fixing invalid database path and close connection handling", "bodyText": "Fixing the close path for the db2 driver.\nFixing an issue with the invalid database names, when the db2 server stops responding properly.\nAll the connection tests for the TCK are passing now.\nRelated to #490\nSigned-off-by: Mark Swatosh mark.swatosh@gmail.com", "createdAt": "2020-02-26T21:38:43Z", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/529", "merged": true, "mergeCommit": {"oid": "e6a62a632950d585fd9165146e15d079f14bf781"}, "closed": true, "closedAt": "2020-02-27T17:06:02Z", "author": {"login": "mswatosh"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcINs6fAH2gAyMzgwNTIwMTI5OmIzYmQ0NGJmOTM0MzE2MmU0NTdlYzljMWMwZmY0MjRmZTdlYjM2NDA=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIeYLLAFqTM2NTgzMzM0OQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "b3bd44bf9343162e457ec9c1c0ff424fe7eb3640", "author": {"user": {"login": "mswatosh", "name": "Mark Swatosh"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/b3bd44bf9343162e457ec9c1c0ff424fe7eb3640", "committedDate": "2020-02-26T21:35:18Z", "message": "Fixing invalid database path and close connection handling\n\nSigned-off-by: Mark Swatosh <mark.swatosh@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MjY2NDEx", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/529#pullrequestreview-365266411", "createdAt": "2020-02-26T21:45:56Z", "commit": {"oid": "b3bd44bf9343162e457ec9c1c0ff424fe7eb3640"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMTo0NTo1N1rOFu9dlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQyMTo0NTo1N1rOFu9dlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDc4NTgxMg==", "bodyText": "should this be a DB2Exception instead of Throwable? Also, in most cases when this handler runs this InitialHandshakeCommand will already be completed, so calling cmd.fail() on a command that previously completed normally seems odd", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/529#discussion_r384785812", "createdAt": "2020-02-26T21:45:57Z", "author": {"login": "aguibert"}, "path": "vertx-db2-client/src/main/java/io/vertx/db2client/impl/codec/InitialHandshakeCommandCodec.java", "diffHunk": "@@ -47,6 +47,12 @@\n     @Override\n     void encode(DB2Encoder encoder) {\n         super.encode(encoder);\n+        encoder.socketConnection.closeHandler(h -> {\n+          if (status == ST_CONNECTING) {\n+            //Sometimes DB2 closes the connection when sending an invalid Database name.\n+            cmd.fail(new Throwable(\"Socket closed during connection\"));           ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3bd44bf9343162e457ec9c1c0ff424fe7eb3640"}, "originalPosition": 7}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d6bd82b887d43f2a410fac679bc00f0e8d156116", "author": {"user": {"login": "mswatosh", "name": "Mark Swatosh"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/d6bd82b887d43f2a410fac679bc00f0e8d156116", "committedDate": "2020-02-27T16:13:31Z", "message": "Review: Changing to DB2Exception"}, "afterCommit": {"oid": "eae5bfa19b79382313aff515162134e20544800a", "author": {"user": {"login": "mswatosh", "name": "Mark Swatosh"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/eae5bfa19b79382313aff515162134e20544800a", "committedDate": "2020-02-27T16:15:33Z", "message": "Review: Changing to DB2Exception\n\nSigned-off-by: Mark Swatosh <mark.swatosh@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1df2564df19f2bc0636b905d732dfbd5d7835e7b", "author": {"user": {"login": "mswatosh", "name": "Mark Swatosh"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/1df2564df19f2bc0636b905d732dfbd5d7835e7b", "committedDate": "2020-02-27T16:23:13Z", "message": "Review: Changing to DB2Exception\n\nSigned-off-by: Mark Swatosh <mark.swatosh@gmail.com>"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "eae5bfa19b79382313aff515162134e20544800a", "author": {"user": {"login": "mswatosh", "name": "Mark Swatosh"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/eae5bfa19b79382313aff515162134e20544800a", "committedDate": "2020-02-27T16:15:33Z", "message": "Review: Changing to DB2Exception\n\nSigned-off-by: Mark Swatosh <mark.swatosh@gmail.com>"}, "afterCommit": {"oid": "1df2564df19f2bc0636b905d732dfbd5d7835e7b", "author": {"user": {"login": "mswatosh", "name": "Mark Swatosh"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/1df2564df19f2bc0636b905d732dfbd5d7835e7b", "committedDate": "2020-02-27T16:23:13Z", "message": "Review: Changing to DB2Exception\n\nSigned-off-by: Mark Swatosh <mark.swatosh@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1ODMzMzQ5", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/529#pullrequestreview-365833349", "createdAt": "2020-02-27T17:01:02Z", "commit": {"oid": "1df2564df19f2bc0636b905d732dfbd5d7835e7b"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1561, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}