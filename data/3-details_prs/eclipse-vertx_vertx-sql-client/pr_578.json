{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDAxODk2Nzcw", "number": 578, "title": "Prepared statement created by SqlConnection#prepare should not be cached ", "bodyText": "Motivation:\nfixes #577\nConformance:\nYour commits should be signed and you should have signed the Eclipse Contributor Agreement as explained in https://github.com/eclipse/vert.x/blob/master/CONTRIBUTING.md\nPlease also make sure you adhere to the code style guidelines: https://github.com/vert-x3/wiki/wiki/Vert.x-code-style-guidelines", "createdAt": "2020-04-10T12:51:06Z", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/578", "merged": true, "mergeCommit": {"oid": "e53235cbe2bc2fd96aabe35350ab05ba840b164f"}, "closed": true, "closedAt": "2020-04-22T13:34:12Z", "author": {"login": "BillyYccc"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcWQUMKgH2gAyNDAxODk2NzcwOmRiNTc3NzhiODU5NDMxNjVjZTliYTYxZGMwNGZlM2VkMWZmM2FlMDg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcZ6bCggFqTM5NzY4Mjk1MA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "db57778b85943165ce9ba61dc04fe3ed1ff3ae08", "author": {"user": {"login": "BillyYccc", "name": "Billy Yuan"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/db57778b85943165ce9ba61dc04fe3ed1ff3ae08", "committedDate": "2020-04-10T12:32:57Z", "message": "non one-shot preparedQuery should not be cached\n\nSigned-off-by: Billy Yuan <billy112487983@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5ca29be8b1b286c92ae211d37a7ccd18bfecf49f", "author": {"user": {"login": "BillyYccc", "name": "Billy Yuan"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/5ca29be8b1b286c92ae211d37a7ccd18bfecf49f", "committedDate": "2020-04-10T12:47:36Z", "message": "update documentation and examples\n\nSigned-off-by: Billy Yuan <billy112487983@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e42d269d4d7b96dfd70c1a62ac229cce5141b4e5", "author": {"user": {"login": "BillyYccc", "name": "Billy Yuan"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/e42d269d4d7b96dfd70c1a62ac229cce5141b4e5", "committedDate": "2020-04-10T12:56:50Z", "message": "update the db2 examples as well\n\nSigned-off-by: Billy Yuan <billy112487983@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkxNTE4NTc5", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/578#pullrequestreview-391518579", "createdAt": "2020-04-10T15:58:08Z", "commit": {"oid": "e42d269d4d7b96dfd70c1a62ac229cce5141b4e5"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNTo1ODowOVrOGD-b7g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0xMFQxNTo1ODowOVrOGD-b7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjgyMTg3MA==", "bodyText": "I think this should not be public because it is not needed by back-ends, this is an package protected internal data that is relevant only to the API and SocketConnectionBase, also the name should be more explicit like shared or cacheable that will tell whether it the prepared statement result can be shared or not.", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/578#discussion_r406821870", "createdAt": "2020-04-10T15:58:09Z", "author": {"login": "vietj"}, "path": "vertx-sql-client/src/main/java/io/vertx/sqlclient/impl/command/PrepareStatementCommand.java", "diffHunk": "@@ -22,18 +22,25 @@\n public class PrepareStatementCommand extends CommandBase<PreparedStatement> {\n \n   private final String sql;\n-  public long statement; // 0 means unamed statement otherwise CString\n+  private final boolean auto;\n \n-  public PrepareStatementCommand(String sql) {\n+  public PrepareStatementCommand(String sql, boolean auto) {\n     this.sql = sql;\n+    this.auto = auto;\n   }\n \n   public String sql() {\n     return sql;\n   }\n \n-  public long statement() {\n-    return statement;\n+  /**\n+   * Indicate whether this command is scheduled from {@link io.vertx.sqlclient.SqlClient#preparedQuery(String) one-shot preparedQuery} or {@link io.vertx.sqlclient.SqlConnection#prepare(String)}.\n+   * This flag will tell if lifecycle of the statement will be controlled by the client or not.\n+   *\n+   * @return true if the command is a one-shot prepared query.\n+   */\n+  public boolean auto() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e42d269d4d7b96dfd70c1a62ac229cce5141b4e5"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9408a3b5b127a37cc74af466c55ce26d1d07ad89", "author": {"user": {"login": "BillyYccc", "name": "Billy Yuan"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/9408a3b5b127a37cc74af466c55ce26d1d07ad89", "committedDate": "2020-04-10T23:43:11Z", "message": "rename auto to cacheable\n\nSigned-off-by: Billy Yuan <billy112487983@gmail.com>"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "304dfe0f1b1bc313f3b5b9f0c08ef9d23c7e4f7a", "author": {"user": {"login": "BillyYccc", "name": "Billy Yuan"}}, "url": "https://github.com/eclipse-vertx/vertx-sql-client/commit/304dfe0f1b1bc313f3b5b9f0c08ef9d23c7e4f7a", "committedDate": "2020-04-17T14:38:43Z", "message": "add a test for postgres statement close\n\nSigned-off-by: Billy Yuan <billy112487983@gmail.com>"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3Mzk3NjgyOTUw", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/578#pullrequestreview-397682950", "createdAt": "2020-04-21T21:18:13Z", "commit": {"oid": "304dfe0f1b1bc313f3b5b9f0c08ef9d23c7e4f7a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1602, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}