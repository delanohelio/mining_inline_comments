{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY5NTE5MDg4", "number": 741, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwMDo0Njo1NFrOEaPhMw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwMDo1OTozN1rOEaPzlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1OTUyNjkxOnYy", "diffSide": "RIGHT", "path": "vertx-mysql-client/src/test/java/io/vertx/mysqlclient/junit/MySQLRule.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwMDo0Njo1NFrOHDjKqw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwNzoyMToxMFrOHDvi8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ4Mzk0Nw==", "bodyText": "that's a good idea indeed \ud83d\ude03", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/741#discussion_r473483947", "createdAt": "2020-08-20T00:46:54Z", "author": {"login": "BillyYccc"}, "path": "vertx-mysql-client/src/test/java/io/vertx/mysqlclient/junit/MySQLRule.java", "diffHunk": "@@ -88,7 +88,7 @@ private void initServer() throws IOException {\n       server.withClasspathResourceMapping(\"tls/files\", \"/etc/mysql/tls\", BindMode.READ_ONLY);\n     } else {\n       server.withClasspathResourceMapping(\"tls/files\", \"/etc/mysql/tls\", BindMode.READ_ONLY);\n-      String cmd = \"--max_allowed_packet=33554432 --max_prepared_stmt_count=16382 --local_infile=true --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci\";\n+      String cmd = \"--max_allowed_packet=33554432 --max_prepared_stmt_count=1024 --local_infile=true --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci\";", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b006b85d4bd03ac4e41204ab22200d2011bd88cd"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY4Njc2OQ==", "bodyText": "indeed, I found this issue because I wanted tests to take less time on my machine :-)", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/741#discussion_r473686769", "createdAt": "2020-08-20T07:21:10Z", "author": {"login": "vietj"}, "path": "vertx-mysql-client/src/test/java/io/vertx/mysqlclient/junit/MySQLRule.java", "diffHunk": "@@ -88,7 +88,7 @@ private void initServer() throws IOException {\n       server.withClasspathResourceMapping(\"tls/files\", \"/etc/mysql/tls\", BindMode.READ_ONLY);\n     } else {\n       server.withClasspathResourceMapping(\"tls/files\", \"/etc/mysql/tls\", BindMode.READ_ONLY);\n-      String cmd = \"--max_allowed_packet=33554432 --max_prepared_stmt_count=16382 --local_infile=true --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci\";\n+      String cmd = \"--max_allowed_packet=33554432 --max_prepared_stmt_count=1024 --local_infile=true --character-set-server=utf8mb4 --collation-server=utf8mb4_general_ci\";", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ4Mzk0Nw=="}, "originalCommit": {"oid": "b006b85d4bd03ac4e41204ab22200d2011bd88cd"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjk1OTU3Mzk2OnYy", "diffSide": "RIGHT", "path": "vertx-sql-client/src/main/java/io/vertx/sqlclient/impl/cache/LruCache.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwMDo1OTozN1rOHDjqcQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0yMFQwNzoyMDo0MFrOHDvhYA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ5MjA4MQ==", "bodyText": "I wonder if we could prune this and the removeEldestEntry method in this change since the capacity check is happening before inserting and controlled by us now.", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/741#discussion_r473492081", "createdAt": "2020-08-20T00:59:37Z", "author": {"login": "BillyYccc"}, "path": "vertx-sql-client/src/main/java/io/vertx/sqlclient/impl/cache/LruCache.java", "diffHunk": "@@ -16,23 +16,52 @@\n import io.vertx.sqlclient.impl.PreparedStatement;\n \n import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.Iterator;\n import java.util.LinkedHashMap;\n import java.util.List;\n import java.util.Map;\n \n /**\n  * A LRU replacement strategy cache based on {@link java.util.LinkedHashMap} for prepared statements.\n  */\n-class LruCache<K, V> extends LinkedHashMap<K, V> {\n+public class LruCache<K, V> extends LinkedHashMap<K, V> {\n \n   List<V> removed;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b006b85d4bd03ac4e41204ab22200d2011bd88cd"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzY4NjM2OA==", "bodyText": "LinkedHashMap is still needed as it guarantees to find the eldest entry in the cache", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/741#discussion_r473686368", "createdAt": "2020-08-20T07:20:40Z", "author": {"login": "vietj"}, "path": "vertx-sql-client/src/main/java/io/vertx/sqlclient/impl/cache/LruCache.java", "diffHunk": "@@ -16,23 +16,52 @@\n import io.vertx.sqlclient.impl.PreparedStatement;\n \n import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.Iterator;\n import java.util.LinkedHashMap;\n import java.util.List;\n import java.util.Map;\n \n /**\n  * A LRU replacement strategy cache based on {@link java.util.LinkedHashMap} for prepared statements.\n  */\n-class LruCache<K, V> extends LinkedHashMap<K, V> {\n+public class LruCache<K, V> extends LinkedHashMap<K, V> {\n \n   List<V> removed;", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzQ5MjA4MQ=="}, "originalCommit": {"oid": "b006b85d4bd03ac4e41204ab22200d2011bd88cd"}, "originalPosition": 16}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4403, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}