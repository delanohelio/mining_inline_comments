{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDE5MzI3MDQ5", "number": 642, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMDoyOToyMlrOD9VdKA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNzozODoxN1rOD9rHpg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1NjQxMjU2OnYy", "diffSide": "RIGHT", "path": "vertx-pg-client/src/main/java/io/vertx/pgclient/impl/codec/Response.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMDoyOToyM1rOGWxIug==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxMzoyOToxMVrOGW3MNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUyNjkwNg==", "bodyText": "I think we don't actually need this API, we can put the fields in the PgException. In addition I'm not sure if all the fields are necessary to be exposed directly in the API.", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/642#discussion_r426526906", "createdAt": "2020-05-18T10:29:23Z", "author": {"login": "BillyYccc"}, "path": "vertx-pg-client/src/main/java/io/vertx/pgclient/impl/codec/Response.java", "diffHunk": "@@ -1,209 +1,58 @@\n /*\n- * Copyright (C) 2017 Julien Viet\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n  *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- * http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0\n+ * which is available at https://www.apache.org/licenses/LICENSE-2.0.\n  *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0\n  */\n \n package io.vertx.pgclient.impl.codec;\n \n+import io.vertx.codegen.annotations.VertxGen;\n+\n /**\n  *\n  * <p>\n  * A common response message for PostgreSQL\n  * <a href=\"https://www.postgresql.org/docs/9.5/static/protocol-error-fields.html\">Error and Notice Message Fields</a>\n- *\n- * @author <a href=\"mailto:emad.albloushi@gmail.com\">Emad Alblueshi</a>\n  */\n+@VertxGen\n+public interface Response {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "3d7a87bb8574f9b68a53681eefa5670d80b1bc70"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjU4NDEwMQ==", "bodyText": "agreeing with you, let's have fields on exception", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/642#discussion_r426584101", "createdAt": "2020-05-18T12:20:59Z", "author": {"login": "vietj"}, "path": "vertx-pg-client/src/main/java/io/vertx/pgclient/impl/codec/Response.java", "diffHunk": "@@ -1,209 +1,58 @@\n /*\n- * Copyright (C) 2017 Julien Viet\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n  *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- * http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0\n+ * which is available at https://www.apache.org/licenses/LICENSE-2.0.\n  *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0\n  */\n \n package io.vertx.pgclient.impl.codec;\n \n+import io.vertx.codegen.annotations.VertxGen;\n+\n /**\n  *\n  * <p>\n  * A common response message for PostgreSQL\n  * <a href=\"https://www.postgresql.org/docs/9.5/static/protocol-error-fields.html\">Error and Notice Message Fields</a>\n- *\n- * @author <a href=\"mailto:emad.albloushi@gmail.com\">Emad Alblueshi</a>\n  */\n+@VertxGen\n+public interface Response {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUyNjkwNg=="}, "originalCommit": {"oid": "3d7a87bb8574f9b68a53681eefa5670d80b1bc70"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjYyNjEwMQ==", "bodyText": "Ok, I'll copy the fields into PgException.\nAll fields that are reported by PostgreSQL can be useful in some cases. Other clients report all of them: vert-x3/vertx-mysql-postgresql-client, dotConnect, tokio_postgres::error::DbError, DBD::Pg#pg_error_field. The PostgreSQL developers decided to send the fields, which ones should we drop and why?", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/642#discussion_r426626101", "createdAt": "2020-05-18T13:29:11Z", "author": {"login": "julianladisch"}, "path": "vertx-pg-client/src/main/java/io/vertx/pgclient/impl/codec/Response.java", "diffHunk": "@@ -1,209 +1,58 @@\n /*\n- * Copyright (C) 2017 Julien Viet\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n  *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- * http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0\n+ * which is available at https://www.apache.org/licenses/LICENSE-2.0.\n  *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0\n  */\n \n package io.vertx.pgclient.impl.codec;\n \n+import io.vertx.codegen.annotations.VertxGen;\n+\n /**\n  *\n  * <p>\n  * A common response message for PostgreSQL\n  * <a href=\"https://www.postgresql.org/docs/9.5/static/protocol-error-fields.html\">Error and Notice Message Fields</a>\n- *\n- * @author <a href=\"mailto:emad.albloushi@gmail.com\">Emad Alblueshi</a>\n  */\n+@VertxGen\n+public interface Response {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUyNjkwNg=="}, "originalCommit": {"oid": "3d7a87bb8574f9b68a53681eefa5670d80b1bc70"}, "originalPosition": 37}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1Nzg0NTM5OnYy", "diffSide": "RIGHT", "path": "vertx-pg-client/src/test/java/io/vertx/pgclient/impl/codec/ResponseHelper.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOFQxNjozODoyMlrOGW_LdA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNzoyMTo0NlrOGXTDTQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc1Njk4MA==", "bodyText": "rather reuse the existing io.vertx.pgclient.impl.util.Util class that contains already similar static methods", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/642#discussion_r426756980", "createdAt": "2020-05-18T16:38:22Z", "author": {"login": "vietj"}, "path": "vertx-pg-client/src/test/java/io/vertx/pgclient/impl/codec/ResponseHelper.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0\n+ * which is available at https://www.apache.org/licenses/LICENSE-2.0.\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0\n+ */\n+\n+package io.vertx.pgclient.impl.codec;\n+\n+import io.vertx.pgclient.PgException;\n+\n+public final class ResponseHelper {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "ea0a6c7aede3b1f3224bcef87865653a1867c054"}, "originalPosition": 16}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA4MjU3Mw==", "bodyText": "The Response methods setMessage, setSeverity, etc. are package-private.\nResponse is in main/java/io/vertx/pgclient/impl/codec/Response.java.\nResponseHelper is a test helper located in test/java/io/vertx/pgclient/impl/codec/ResponseHelper.java. It is in test/... because it is needed for testing only. It is in io/vertx/pgclient/impl/codec to have access to the package-private methods of Response.java.\nMoving the ResponseHelper methods into main/io/vertx/pgclient/impl/Util.java fails because of the package-private access restriction, and having a test helper needed for testing only should not got into main/...", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/642#discussion_r427082573", "createdAt": "2020-05-19T07:21:46Z", "author": {"login": "julianladisch"}, "path": "vertx-pg-client/src/test/java/io/vertx/pgclient/impl/codec/ResponseHelper.java", "diffHunk": "@@ -0,0 +1,45 @@\n+/*\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0\n+ * which is available at https://www.apache.org/licenses/LICENSE-2.0.\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0\n+ */\n+\n+package io.vertx.pgclient.impl.codec;\n+\n+import io.vertx.pgclient.PgException;\n+\n+public final class ResponseHelper {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc1Njk4MA=="}, "originalCommit": {"oid": "ea0a6c7aede3b1f3224bcef87865653a1867c054"}, "originalPosition": 16}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjY1OTk2MTk4OnYy", "diffSide": "RIGHT", "path": "vertx-pg-client/src/main/java/io/vertx/pgclient/PgErrorCodes.java", "isResolved": true, "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQwNzozODoxN1rOGXTmMg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0xOVQyMjo1MjoxNVrOGX1W_Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA5MTUwNg==", "bodyText": "I think this should be instead an enum", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/642#discussion_r427091506", "createdAt": "2020-05-19T07:38:17Z", "author": {"login": "vietj"}, "path": "vertx-pg-client/src/main/java/io/vertx/pgclient/PgErrorCodes.java", "diffHunk": "@@ -0,0 +1,306 @@\n+/*\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0\n+ * which is available at https://www.apache.org/licenses/LICENSE-2.0.\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0\n+ */\n+\n+package io.vertx.pgclient;\n+\n+/**\n+ * SQLSTATE codes used by PostgreSQL\n+ * (<a href=\"https://www.postgresql.org/docs/current/errcodes-appendix.html\">PostgreSQL Error Codes</a>,\n+ * <a href=\"https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/utils/errcodes.txt;hb=HEAD\">\n+ * errcodes.txt</a>)\n+ */\n+public class PgErrorCodes {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "81bc0f6f418aebd31b9f39f4207032ca5fda897b"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzE2NjQ4OA==", "bodyText": "I don't think so.\nThe list of error codes is never complete. New PostgreSQL versions may add new codes, and any application can use custom codes: do $$ begin raise sqlstate '99999'; end $$;\nSub-classing PgErrorCodes allows to add custom codes.\nAn enum cannot be extended to support more codes.\nThere is no need to get a human readable name for a code at runtime because PgException contains a message and a detail field. PgErrorCodes provides a human readable name for an expected code used in a unit test or when to handle a specific error.\n\"You should use enum types any time you need to represent a fixed set of constants.\" (quote from https://docs.oracle.com/javase/tutorial/java/javaOO/enum.html )", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/642#discussion_r427166488", "createdAt": "2020-05-19T09:36:59Z", "author": {"login": "julianladisch"}, "path": "vertx-pg-client/src/main/java/io/vertx/pgclient/PgErrorCodes.java", "diffHunk": "@@ -0,0 +1,306 @@\n+/*\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0\n+ * which is available at https://www.apache.org/licenses/LICENSE-2.0.\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0\n+ */\n+\n+package io.vertx.pgclient;\n+\n+/**\n+ * SQLSTATE codes used by PostgreSQL\n+ * (<a href=\"https://www.postgresql.org/docs/current/errcodes-appendix.html\">PostgreSQL Error Codes</a>,\n+ * <a href=\"https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/utils/errcodes.txt;hb=HEAD\">\n+ * errcodes.txt</a>)\n+ */\n+public class PgErrorCodes {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA5MTUwNg=="}, "originalCommit": {"oid": "81bc0f6f418aebd31b9f39f4207032ca5fda897b"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI3MTU0MA==", "bodyText": "ok, then I think we should not have this list or error codes in the code", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/642#discussion_r427271540", "createdAt": "2020-05-19T12:43:34Z", "author": {"login": "vietj"}, "path": "vertx-pg-client/src/main/java/io/vertx/pgclient/PgErrorCodes.java", "diffHunk": "@@ -0,0 +1,306 @@\n+/*\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0\n+ * which is available at https://www.apache.org/licenses/LICENSE-2.0.\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0\n+ */\n+\n+package io.vertx.pgclient;\n+\n+/**\n+ * SQLSTATE codes used by PostgreSQL\n+ * (<a href=\"https://www.postgresql.org/docs/current/errcodes-appendix.html\">PostgreSQL Error Codes</a>,\n+ * <a href=\"https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/utils/errcodes.txt;hb=HEAD\">\n+ * errcodes.txt</a>)\n+ */\n+public class PgErrorCodes {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA5MTUwNg=="}, "originalCommit": {"oid": "81bc0f6f418aebd31b9f39f4207032ca5fda897b"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY0NDY2OQ==", "bodyText": "I've removed the file PgErrorCodes.java.", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/642#discussion_r427644669", "createdAt": "2020-05-19T22:52:15Z", "author": {"login": "julianladisch"}, "path": "vertx-pg-client/src/main/java/io/vertx/pgclient/PgErrorCodes.java", "diffHunk": "@@ -0,0 +1,306 @@\n+/*\n+ * Copyright (c) 2020 Contributors to the Eclipse Foundation\n+ *\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0, or the Apache License, Version 2.0\n+ * which is available at https://www.apache.org/licenses/LICENSE-2.0.\n+ *\n+ * SPDX-License-Identifier: EPL-2.0 OR Apache-2.0\n+ */\n+\n+package io.vertx.pgclient;\n+\n+/**\n+ * SQLSTATE codes used by PostgreSQL\n+ * (<a href=\"https://www.postgresql.org/docs/current/errcodes-appendix.html\">PostgreSQL Error Codes</a>,\n+ * <a href=\"https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/utils/errcodes.txt;hb=HEAD\">\n+ * errcodes.txt</a>)\n+ */\n+public class PgErrorCodes {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzA5MTUwNg=="}, "originalCommit": {"oid": "81bc0f6f418aebd31b9f39f4207032ca5fda897b"}, "originalPosition": 20}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4492, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}