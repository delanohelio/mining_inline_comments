{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzg4NDY0MDE0", "number": 547, "reviewThreads": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxMzoyNTozNVrODoVLow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNTo0MjowMVrODoxqLA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQzNjE2Njc1OnYy", "diffSide": "RIGHT", "path": "vertx-db2-client/src/main/java/io/vertx/db2client/impl/drda/DRDAQueryResponse.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxMzoyNTozNVrOF20CIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xNlQxMzoyNTozNVrOF20CIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzAxOTkzOA==", "bodyText": "In this file I'm intentionally leaving the commented out code in place because this is the code that's ported from Apache Derby and I'm keeping the commented out code for easy reference in the near future.", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/547#discussion_r393019938", "createdAt": "2020-03-16T13:25:35Z", "author": {"login": "aguibert"}, "path": "vertx-db2-client/src/main/java/io/vertx/db2client/impl/drda/DRDAQueryResponse.java", "diffHunk": "@@ -116,15 +116,50 @@ public void readOpenQuery() { // @AGG removed callback StatementCallbackInterfac\n         endOfSameIdChainData();\n     }\n     \n+    /**\n+     * Parse the reply for the Open Query Command. This method handles the\n+     * parsing of all command replies and reply data for the opnqry command.\n+     */\n+    public void readBeginOpenQuery() { // @AGG removed callback StatementCallbackInterface statementI) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bbfc62c01867462f2064d79d4c49c2dd9133797"}, "originalPosition": 8}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQ0MDgzMjQ0OnYy", "diffSide": "RIGHT", "path": "vertx-db2-client/src/main/java/io/vertx/db2client/impl/drda/ClientTypes.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNTo0MjowMlrOF3iGnw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0xN1QxNTo1NToyNVrOF3iu7Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc3NDc1MQ==", "bodyText": "For BINARY and BLOB, why do we return true if it is a B/boolean?", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/547#discussion_r393774751", "createdAt": "2020-03-17T15:42:02Z", "author": {"login": "gjwatts"}, "path": "vertx-db2-client/src/main/java/io/vertx/db2client/impl/drda/ClientTypes.java", "diffHunk": "@@ -198,4 +199,48 @@ static public int mapDB2TypeToDriverType(boolean isDescribed, int sqlType, long\n             return 0;\n         }\n     }\n+    \n+    public static boolean canConvert(Object value, int toType) {\n+    \tClass<?> clazz = value.getClass();\n+    \t// Everything can convert to String\n+    \tif (clazz == String.class)\n+    \t\treturn true; \n+    \tswitch (toType) {\n+        case ClientTypes.BIGINT:\n+        case ClientTypes.BIT:\n+        case ClientTypes.BOOLEAN:\n+        case ClientTypes.CHAR:\n+        case ClientTypes.DECIMAL:\n+        case ClientTypes.DOUBLE:\n+        case ClientTypes.INTEGER:\n+        case ClientTypes.LONGVARCHAR:\n+        case ClientTypes.REAL:\n+        case ClientTypes.SMALLINT:\n+        \treturn clazz == boolean.class ||\n+        \t\t   clazz == Boolean.class ||\n+        \t\t   clazz == double.class ||\n+        \t\t   clazz == Double.class ||\n+        \t\t   clazz == float.class ||\n+        \t\t   clazz == Float.class ||\n+        \t\t   clazz == int.class ||\n+        \t\t   clazz == Integer.class ||\n+        \t\t   clazz == long.class ||\n+        \t\t   clazz == Long.class ||\n+        \t\t   clazz == short.class ||\n+        \t\t   clazz == Short.class ||\n+        \t\t   clazz == BigDecimal.class;\n+        case ClientTypes.BINARY:\n+        case ClientTypes.BLOB:\n+        \treturn clazz == boolean.class ||\n+        \t\t   clazz == Boolean.class ||", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5bbfc62c01867462f2064d79d4c49c2dd9133797"}, "originalPosition": 54}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NTA2OQ==", "bodyText": "According to this DB2 doc a BINARY column is a varying-length binary string where 0 < length <= 255 with a default length of 1. I think the most common use case here is to just store a length=1 binary string which would fit into a B/boolean Java type.\nA BLOB is also a variable-length binary string where 0 <= length <= 2G with a default size of 1M. Normally this will only fit into a byte array, but in some cases it could be length=1.\nOverall, the checks in this method don't need to be perfect, they are just client-side checking and if we get some incompatible data the user will get an error message later on, but the error message we can give here will probably be more specific/clear than the error message later on.", "url": "https://github.com/eclipse-vertx/vertx-sql-client/pull/547#discussion_r393785069", "createdAt": "2020-03-17T15:55:25Z", "author": {"login": "aguibert"}, "path": "vertx-db2-client/src/main/java/io/vertx/db2client/impl/drda/ClientTypes.java", "diffHunk": "@@ -198,4 +199,48 @@ static public int mapDB2TypeToDriverType(boolean isDescribed, int sqlType, long\n             return 0;\n         }\n     }\n+    \n+    public static boolean canConvert(Object value, int toType) {\n+    \tClass<?> clazz = value.getClass();\n+    \t// Everything can convert to String\n+    \tif (clazz == String.class)\n+    \t\treturn true; \n+    \tswitch (toType) {\n+        case ClientTypes.BIGINT:\n+        case ClientTypes.BIT:\n+        case ClientTypes.BOOLEAN:\n+        case ClientTypes.CHAR:\n+        case ClientTypes.DECIMAL:\n+        case ClientTypes.DOUBLE:\n+        case ClientTypes.INTEGER:\n+        case ClientTypes.LONGVARCHAR:\n+        case ClientTypes.REAL:\n+        case ClientTypes.SMALLINT:\n+        \treturn clazz == boolean.class ||\n+        \t\t   clazz == Boolean.class ||\n+        \t\t   clazz == double.class ||\n+        \t\t   clazz == Double.class ||\n+        \t\t   clazz == float.class ||\n+        \t\t   clazz == Float.class ||\n+        \t\t   clazz == int.class ||\n+        \t\t   clazz == Integer.class ||\n+        \t\t   clazz == long.class ||\n+        \t\t   clazz == Long.class ||\n+        \t\t   clazz == short.class ||\n+        \t\t   clazz == Short.class ||\n+        \t\t   clazz == BigDecimal.class;\n+        case ClientTypes.BINARY:\n+        case ClientTypes.BLOB:\n+        \treturn clazz == boolean.class ||\n+        \t\t   clazz == Boolean.class ||", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc3NDc1MQ=="}, "originalCommit": {"oid": "5bbfc62c01867462f2064d79d4c49c2dd9133797"}, "originalPosition": 54}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4449, "cost": 1, "resetAt": "2021-11-12T18:49:56Z"}}}