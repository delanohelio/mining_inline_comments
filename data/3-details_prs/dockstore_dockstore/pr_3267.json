{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzc5OTAwNTk3", "number": 3267, "title": "Add classes for dockstore.yml", "bodyText": "#3241\nProbably could come up with a better pattern\nin DockstoreYamlHelper, but this works.\nPut it in dockstore-common because someday dockstore-cli might use it.", "createdAt": "2020-02-26T00:13:50Z", "url": "https://github.com/dockstore/dockstore/pull/3267", "merged": true, "mergeCommit": {"oid": "4fc2211ee73b8feb840e96ae013f10641d112659"}, "closed": true, "closedAt": "2020-02-27T20:51:11Z", "author": {"login": "coverbeck"}, "timelineItems": {"totalCount": 11, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcIHtK6gFqTM2NDk0ODUyNw==", "endCursor": "Y3Vyc29yOnYyOpPPAAABcIfxEoAFqTM2NTkwMzAxNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0OTQ4NTI3", "url": "https://github.com/dockstore/dockstore/pull/3267#pullrequestreview-364948527", "createdAt": "2020-02-26T14:36:08Z", "commit": {"oid": "efb3d8553066a51cd2e2146a77a3607a5b1fb97e"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxNDozNjowOFrOFut6RQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxNDozNjowOFrOFut6RQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDUzMTAxMw==", "bodyText": "Should we just user uppercase then?", "url": "https://github.com/dockstore/dockstore/pull/3267#discussion_r384531013", "createdAt": "2020-02-26T14:36:08Z", "author": {"login": "agduncan94"}, "path": "dockstore-common/src/main/java/io/dockstore/common/yaml/Service12.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/*\n+ *    Copyright 2020 OICR\n+ *\n+ *    Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *    you may not use this file except in compliance with the License.\n+ *    You may obtain a copy of the License at\n+ *\n+ *        http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *    Unless required by applicable law or agreed to in writing, software\n+ *    distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *    See the License for the specific language governing permissions and\n+ *    limitations under the License.\n+ */\n+package io.dockstore.common.yaml;\n+\n+import javax.validation.constraints.NotNull;\n+import javax.validation.constraints.Pattern;\n+\n+import io.dockstore.common.DescriptorLanguageSubclass;\n+\n+/**\n+ * A service defined in a 1.2 .dockstore.yml. It differs from 1.1 in that there is a subclass instead of a type property.\n+ * And the subclass property is an enum, not a string.\n+ *\n+ * Couldn't get SnakeYaml to directly load the YAML into the JavaBean with an enum, because our values are lower-case\n+ * and the enums are upper-case. See https://stackoverflow.com/questions/25079332/parse-enum-by-value-using-snakeyaml.", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efb3d8553066a51cd2e2146a77a3607a5b1fb97e"}, "originalPosition": 28}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY0OTk3NjIx", "url": "https://github.com/dockstore/dockstore/pull/3267#pullrequestreview-364997621", "createdAt": "2020-02-26T15:31:03Z", "commit": {"oid": "efb3d8553066a51cd2e2146a77a3607a5b1fb97e"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxNTozMTowM1rOFuwP3g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yNlQxNTozNjozOFrOFuwewQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDU2OTMxMA==", "bodyText": "Version probably redundant (should be managed in the root pom.xml since we use snakeyaml in a few places)", "url": "https://github.com/dockstore/dockstore/pull/3267#discussion_r384569310", "createdAt": "2020-02-26T15:31:03Z", "author": {"login": "denis-yuen"}, "path": "dockstore-common/pom.xml", "diffHunk": "@@ -46,6 +46,11 @@\n             <version>${postgresql.version}</version>\n             <scope>runtime</scope>\n         </dependency>\n+        <dependency>\n+            <groupId>org.yaml</groupId>\n+            <artifactId>snakeyaml</artifactId>\n+            <version>1.24</version>", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efb3d8553066a51cd2e2146a77a3607a5b1fb97e"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDU3MDQyNQ==", "bodyText": "This model is one of our creation, so could use javadoc particularly with the less intuitive fields like environment, data, port", "url": "https://github.com/dockstore/dockstore/pull/3267#discussion_r384570425", "createdAt": "2020-02-26T15:32:42Z", "author": {"login": "denis-yuen"}, "path": "dockstore-common/src/main/java/io/dockstore/common/yaml/AbstractYamlService.java", "diffHunk": "@@ -0,0 +1,225 @@\n+/*\n+ *    Copyright 2020 OICR\n+ *\n+ *    Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *    you may not use this file except in compliance with the License.\n+ *    You may obtain a copy of the License at\n+ *\n+ *        http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *    Unless required by applicable law or agreed to in writing, software\n+ *    distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *    See the License for the specific language governing permissions and\n+ *    limitations under the License.\n+ */\n+package io.dockstore.common.yaml;\n+\n+import java.util.List;\n+import java.util.Map;\n+\n+import javax.validation.constraints.NotNull;\n+\n+/**\n+ * Abstract base class for services defined in .dockstore.yml\n+ */\n+public abstract class AbstractYamlService {\n+    private String name;\n+    private String author;\n+    private String description;\n+    private List<String> files;\n+    private Scripts scripts;\n+    private Map<String, EnvironmentVariable> environment;\n+    private Map<String, DataSet> data;\n+\n+    public String getAuthor() {\n+        return author;\n+    }\n+\n+    public void setAuthor(String author) {\n+        this.author = author;\n+    }\n+\n+    public String getName() {\n+        return name;\n+    }\n+\n+    public void setName(String name) {\n+        this.name = name;\n+    }\n+\n+    public String getDescription() {\n+        return description;\n+    }\n+\n+    public void setDescription(String description) {\n+        this.description = description;\n+    }\n+\n+    public List<String> getFiles() {\n+        return files;\n+    }\n+\n+    public void setFiles(List<String> files) {\n+        this.files = files;\n+    }\n+\n+    public Scripts getScripts() {\n+        return scripts;\n+    }\n+\n+    public void setScripts(Scripts scripts) {\n+        this.scripts = scripts;\n+    }\n+\n+    public Map<String, EnvironmentVariable> getEnvironment() {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efb3d8553066a51cd2e2146a77a3607a5b1fb97e"}, "originalPosition": 75}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDU3MTEyNA==", "bodyText": "Can probably simplify with !isEmpty", "url": "https://github.com/dockstore/dockstore/pull/3267#discussion_r384571124", "createdAt": "2020-02-26T15:33:39Z", "author": {"login": "denis-yuen"}, "path": "dockstore-common/src/main/java/io/dockstore/common/yaml/Dockstore12Validator.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ *    Copyright 2020 OICR\n+ *\n+ *    Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *    you may not use this file except in compliance with the License.\n+ *    You may obtain a copy of the License at\n+ *\n+ *        http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *    Unless required by applicable law or agreed to in writing, software\n+ *    distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *    See the License for the specific language governing permissions and\n+ *    limitations under the License.\n+ */\n+package io.dockstore.common.yaml;\n+\n+import javax.validation.ConstraintValidator;\n+import javax.validation.ConstraintValidatorContext;\n+\n+/**\n+ * Validates that a DockstoreYaml12 instance has at least one workflow or at least one service\n+ */\n+public class Dockstore12Validator implements ConstraintValidator<ValidDockstore12, DockstoreYaml12> {\n+    @Override\n+    public void initialize(ValidDockstore12 constraintAnnotation) {\n+    }\n+\n+    @Override\n+    public boolean isValid(DockstoreYaml12 value, ConstraintValidatorContext context) {\n+        return value.getServices().size() > 0 || value.getWorkflows().size() > 0;", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efb3d8553066a51cd2e2146a77a3607a5b1fb97e"}, "originalPosition": 31}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDU3MzEyMQ==", "bodyText": "This isn't being highlighted as an annotation in the GitHub web ui, watch out in case there is a formatting thing going on", "url": "https://github.com/dockstore/dockstore/pull/3267#discussion_r384573121", "createdAt": "2020-02-26T15:36:38Z", "author": {"login": "denis-yuen"}, "path": "dockstore-common/src/main/java/io/dockstore/common/yaml/Service12.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/*\n+ *    Copyright 2020 OICR\n+ *\n+ *    Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *    you may not use this file except in compliance with the License.\n+ *    You may obtain a copy of the License at\n+ *\n+ *        http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *    Unless required by applicable law or agreed to in writing, software\n+ *    distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *    See the License for the specific language governing permissions and\n+ *    limitations under the License.\n+ */\n+package io.dockstore.common.yaml;\n+\n+import javax.validation.constraints.NotNull;\n+import javax.validation.constraints.Pattern;\n+\n+import io.dockstore.common.DescriptorLanguageSubclass;\n+\n+/**\n+ * A service defined in a 1.2 .dockstore.yml. It differs from 1.1 in that there is a subclass instead of a type property.\n+ * And the subclass property is an enum, not a string.\n+ *\n+ * Couldn't get SnakeYaml to directly load the YAML into the JavaBean with an enum, because our values are lower-case\n+ * and the enums are upper-case. See https://stackoverflow.com/questions/25079332/parse-enum-by-value-using-snakeyaml.\n+ */\n+public class Service12 extends AbstractYamlService {\n+\n+    public  static final String SUBCLASS_ERROR = \"subclass value must be \\\"docker-compose\\\", \\\"helm\\\", \\\"swarm\\\", \\\"kubernetes\\\", or \\\"n/a\\\"\";\n+    private String subclass;\n+    private DescriptorLanguageSubclass descriptorLanguageSubclass;\n+\n+\n+    @NotNull(message = \"Missing property \\\"subclass\\\"\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "efb3d8553066a51cd2e2146a77a3607a5b1fb97e"}, "originalPosition": 37}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1MDc5MjYz", "url": "https://github.com/dockstore/dockstore/pull/3267#pullrequestreview-365079263", "createdAt": "2020-02-26T17:04:09Z", "commit": {"oid": "efb3d8553066a51cd2e2146a77a3607a5b1fb97e"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1NzAyMjcy", "url": "https://github.com/dockstore/dockstore/pull/3267#pullrequestreview-365702272", "createdAt": "2020-02-27T14:00:46Z", "commit": {"oid": "daf04f818deb0c894ea7bc92ad3dd5abb872bcc0"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8f14609605b273a6dfc2ca7e869572f38b35f0c2", "author": {"user": {"login": "coverbeck", "name": "Charles Overbeck"}}, "url": "https://github.com/dockstore/dockstore/commit/8f14609605b273a6dfc2ca7e869572f38b35f0c2", "committedDate": "2020-02-27T17:29:28Z", "message": "Add classes for dockstore.yml\n\n#3241\n\nProbably could come up with a better pattern\nin DockstoreYamlHelper, but this works."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1751db5a1e5c479322cc9f4910579086ff3b7627", "author": {"user": {"login": "coverbeck", "name": "Charles Overbeck"}}, "url": "https://github.com/dockstore/dockstore/commit/1751db5a1e5c479322cc9f4910579086ff3b7627", "committedDate": "2020-02-27T17:29:29Z", "message": "PR and Codacy feedback."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "73180024854f8b33f7171cf77278edd5d8289ac0", "author": {"user": {"login": "coverbeck", "name": "Charles Overbeck"}}, "url": "https://github.com/dockstore/dockstore/commit/73180024854f8b33f7171cf77278edd5d8289ac0", "committedDate": "2020-02-27T17:29:29Z", "message": "More JavaDoc (PR feedback)"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0e0250cb6fefa457320b8d04b010a1afe9d7b91a", "author": {"user": {"login": "coverbeck", "name": "Charles Overbeck"}}, "url": "https://github.com/dockstore/dockstore/commit/0e0250cb6fefa457320b8d04b010a1afe9d7b91a", "committedDate": "2020-02-27T17:29:31Z", "message": "One more test"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "daf04f818deb0c894ea7bc92ad3dd5abb872bcc0", "author": {"user": {"login": "coverbeck", "name": "Charles Overbeck"}}, "url": "https://github.com/dockstore/dockstore/commit/daf04f818deb0c894ea7bc92ad3dd5abb872bcc0", "committedDate": "2020-02-26T22:05:48Z", "message": "One more test"}, "afterCommit": {"oid": "0e0250cb6fefa457320b8d04b010a1afe9d7b91a", "author": {"user": {"login": "coverbeck", "name": "Charles Overbeck"}}, "url": "https://github.com/dockstore/dockstore/commit/0e0250cb6fefa457320b8d04b010a1afe9d7b91a", "committedDate": "2020-02-27T17:29:31Z", "message": "One more test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1ODk0OTM4", "url": "https://github.com/dockstore/dockstore/pull/3267#pullrequestreview-365894938", "createdAt": "2020-02-27T18:26:14Z", "commit": {"oid": "0e0250cb6fefa457320b8d04b010a1afe9d7b91a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzY1OTAzMDE3", "url": "https://github.com/dockstore/dockstore/pull/3267#pullrequestreview-365903017", "createdAt": "2020-02-27T18:38:08Z", "commit": {"oid": "0e0250cb6fefa457320b8d04b010a1afe9d7b91a"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1785, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}