{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYxMDQ5NDAz", "number": 3120, "title": "Feature/3045/starred organization events", "bodyText": "For partial #3045 , UI remains\nAdd query for events related to starred organization (unused)\nAdd query for events related to starred organization OR starred entries\nThe previous query for events related to starred entries is also unused\nAlso need to remove all swagger annotations from the eventresource", "createdAt": "2020-01-09T16:33:17Z", "url": "https://github.com/dockstore/dockstore/pull/3120", "merged": true, "mergeCommit": {"oid": "8842ab41d67d5a315647d57023d9e53363487a63"}, "closed": true, "closedAt": "2020-01-13T21:18:41Z", "author": {"login": "garyluu"}, "timelineItems": {"totalCount": 21, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb4v9ungBqjI5MzYzNDUwMDc=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb6CHgqgFqTM0MjEwODE0MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "74dabaf7491c62ecc780bd0545ce8914dcc0bff5", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/74dabaf7491c62ecc780bd0545ce8914dcc0bff5", "committedDate": "2020-01-09T20:14:57Z", "message": "Fix for recent events not being recent"}, "afterCommit": {"oid": "1ae26d39549be9fdb64efe323eaa2d630de2b356", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/1ae26d39549be9fdb64efe323eaa2d630de2b356", "committedDate": "2020-01-09T20:27:28Z", "message": "Update swagger/openapi"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "1ae26d39549be9fdb64efe323eaa2d630de2b356", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/1ae26d39549be9fdb64efe323eaa2d630de2b356", "committedDate": "2020-01-09T20:27:28Z", "message": "Update swagger/openapi"}, "afterCommit": {"oid": "5f10c8bb97dd047c4ae1c30d52cc5b723de79a75", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/5f10c8bb97dd047c4ae1c30d52cc5b723de79a75", "committedDate": "2020-01-09T20:40:34Z", "message": "Update swagger/openapi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4c5a095ab466310a8081fa19c8b0a1302dccf38b", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/4c5a095ab466310a8081fa19c8b0a1302dccf38b", "committedDate": "2020-01-09T21:24:02Z", "message": "Get events for organizations starred"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d831642e9d9b20609438b3e905e515ea35070a48", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/d831642e9d9b20609438b3e905e515ea35070a48", "committedDate": "2020-01-09T21:24:02Z", "message": "Fix for hidden user auth"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "476dcfb652f78dec440d60e70a0f6b09f420d8e6", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/476dcfb652f78dec440d60e70a0f6b09f420d8e6", "committedDate": "2020-01-09T21:24:02Z", "message": "Initial test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a1c531ff0f981b08c077ff9424fb5f7a0a6a4bb4", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/a1c531ff0f981b08c077ff9424fb5f7a0a6a4bb4", "committedDate": "2020-01-09T21:24:02Z", "message": "Refactor test methods"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5c86396d7fda47f7293f4d6d7715118bf47e3ede", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/5c86396d7fda47f7293f4d6d7715118bf47e3ede", "committedDate": "2020-01-09T21:24:02Z", "message": "Enhance test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "af621a4e1103d1f9873544cdc8a6e9fe246ca18f", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/af621a4e1103d1f9873544cdc8a6e9fe246ca18f", "committedDate": "2020-01-09T21:24:02Z", "message": "Fix for recent events not being recent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "72b280340aa58f359da9b13730bbedd7cb91f916", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/72b280340aa58f359da9b13730bbedd7cb91f916", "committedDate": "2020-01-09T21:24:02Z", "message": "Add ALL_STARRED"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQwODM1Mzk1", "url": "https://github.com/dockstore/dockstore/pull/3120#pullrequestreview-340835395", "createdAt": "2020-01-09T21:47:03Z", "commit": {"oid": "5f10c8bb97dd047c4ae1c30d52cc5b723de79a75"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMTo0NzowM1rOFcEWIg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0wOVQyMTo0NzowM1rOFcEWIg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDk3NTY1MA==", "bodyText": "Why did you change this from a List to a Set? Won't you lose the queries' sort orders?", "url": "https://github.com/dockstore/dockstore/pull/3120#discussion_r364975650", "createdAt": "2020-01-09T21:47:03Z", "author": {"login": "coverbeck"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/resources/EventResource.java", "diffHunk": "@@ -68,20 +72,32 @@ public EventResource(EventDAO eventDAO, UserDAO userDAO) {\n         this.eventDAO = eventDAO;\n         this.userDAO = userDAO;\n     }\n-    @SuppressWarnings(\"checkstyle:MagicNumber\")\n+\n     @GET\n     @Timed\n     @UnitOfWork(readOnly = true)\n     @Operation(description = DESCRIPTION, summary = SUMMARY, security = @SecurityRequirement(name = \"bearer\"))\n     @ApiOperation(value = SUMMARY, authorizations = {\n             @Authorization(value = JWT_SECURITY_DEFINITION_NAME) }, notes = DESCRIPTION, responseContainer = \"List\", response = Event.class)\n-    public List<Event> getEvents(@ApiParam(hidden = true) @Auth User user, @QueryParam(\"event_search_type\") EventSearchType eventSearchType, @Min(1) @Max(MAX_LIMIT) @DefaultValue(PAGINATION_DEFAULT_STRING) @ApiParam(defaultValue = PAGINATION_DEFAULT_STRING, allowableValues = PAGINATION_RANGE) @Parameter(schema = @Schema(maximum = \"100\", minimum = \"1\")) @QueryParam(\"limit\") int limit, @QueryParam(\"offset\") @DefaultValue(\"0\") Integer offset) {\n-        if (eventSearchType.equals(EventSearchType.STARRED_ENTRIES)) {\n-            User userWithSession = this.userDAO.findById(user.getId());\n+    public Set<Event> getEvents(@Parameter(hidden = true) @ApiParam(hidden = true) @Auth User user, @QueryParam(\"event_search_type\") EventSearchType eventSearchType, @Min(1) @Max(MAX_LIMIT) @DefaultValue(PAGINATION_DEFAULT_STRING) @ApiParam(defaultValue = PAGINATION_DEFAULT_STRING, allowableValues = PAGINATION_RANGE) @Parameter(schema = @Schema(maximum = \"100\", minimum = \"1\")) @QueryParam(\"limit\") int limit, @QueryParam(\"offset\") @DefaultValue(\"0\") Integer offset) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5f10c8bb97dd047c4ae1c30d52cc5b723de79a75"}, "originalPosition": 45}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "5f10c8bb97dd047c4ae1c30d52cc5b723de79a75", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/5f10c8bb97dd047c4ae1c30d52cc5b723de79a75", "committedDate": "2020-01-09T20:40:34Z", "message": "Update swagger/openapi"}, "afterCommit": {"oid": "47802b43d7de831d3c0c963f3a51ff4ad5bc7046", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/47802b43d7de831d3c0c963f3a51ff4ad5bc7046", "committedDate": "2020-01-09T22:04:55Z", "message": "Change back to list"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "47802b43d7de831d3c0c963f3a51ff4ad5bc7046", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/47802b43d7de831d3c0c963f3a51ff4ad5bc7046", "committedDate": "2020-01-09T22:04:55Z", "message": "Change back to list"}, "afterCommit": {"oid": "3cdd9be0a6676f14b596a79b76f1c24073c87e1f", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/3cdd9be0a6676f14b596a79b76f1c24073c87e1f", "committedDate": "2020-01-09T22:09:44Z", "message": "Change back to list"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d9b45aea3132055021b54288d72f5e8141af3828", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/d9b45aea3132055021b54288d72f5e8141af3828", "committedDate": "2020-01-09T22:15:11Z", "message": "Change back to list"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "3cdd9be0a6676f14b596a79b76f1c24073c87e1f", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/3cdd9be0a6676f14b596a79b76f1c24073c87e1f", "committedDate": "2020-01-09T22:09:44Z", "message": "Change back to list"}, "afterCommit": {"oid": "d9b45aea3132055021b54288d72f5e8141af3828", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/d9b45aea3132055021b54288d72f5e8141af3828", "committedDate": "2020-01-09T22:15:11Z", "message": "Change back to list"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMzMwMTY3", "url": "https://github.com/dockstore/dockstore/pull/3120#pullrequestreview-341330167", "createdAt": "2020-01-10T18:03:16Z", "commit": {"oid": "d9b45aea3132055021b54288d72f5e8141af3828"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxMzkzNTUw", "url": "https://github.com/dockstore/dockstore/pull/3120#pullrequestreview-341393550", "createdAt": "2020-01-10T20:03:48Z", "commit": {"oid": "d9b45aea3132055021b54288d72f5e8141af3828"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNDY3MDM5", "url": "https://github.com/dockstore/dockstore/pull/3120#pullrequestreview-341467039", "createdAt": "2020-01-10T23:03:09Z", "commit": {"oid": "d9b45aea3132055021b54288d72f5e8141af3828"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxNDc0NzY0", "url": "https://github.com/dockstore/dockstore/pull/3120#pullrequestreview-341474764", "createdAt": "2020-01-10T23:34:13Z", "commit": {"oid": "d9b45aea3132055021b54288d72f5e8141af3828"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQxOTU1NTcz", "url": "https://github.com/dockstore/dockstore/pull/3120#pullrequestreview-341955573", "createdAt": "2020-01-13T16:08:23Z", "commit": {"oid": "d9b45aea3132055021b54288d72f5e8141af3828"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxNjowODoyNFrOFc8Avg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xM1QxNjowODoyNFrOFc8Avg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTg4NzY3OA==", "bodyText": "A bit misleading, the test only checks that there are 6 events in general.\nSame idea with two lines down", "url": "https://github.com/dockstore/dockstore/pull/3120#discussion_r365887678", "createdAt": "2020-01-13T16:08:24Z", "author": {"login": "denis-yuen"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/OrganizationIT.java", "diffHunk": "@@ -331,6 +334,31 @@ public void testCreateNewOrganization() {\n         assertEquals(\"potato\", organization.getDescription());\n         String description = organizationsApiUser2.getOrganizationDescription(organization.getId());\n         assertEquals(\"potato\", description);\n+\n+        testStarredOrganizationEvents(organizationsApiUser2, organization);\n+    }\n+\n+    private void testStarredOrganizationEvents(OrganizationsApi organizationsApiUser2, Organization organization) {\n+        organizationsApiUser2.starOrganization(organization.getId(), SwaggerUtility.createStarRequest(true));\n+        final io.dockstore.openapi.client.ApiClient openAPIWebClientUser2 = getOpenAPIWebClient(USER_2_USERNAME, testingPostgres);\n+        EventsApi eventsApi = new EventsApi(openAPIWebClientUser2);\n+        List<io.dockstore.openapi.client.model.Event> events = eventsApi\n+                .getEvents(EventSearchType.STARRED_ORGANIZATION.toString(), null, null);\n+        Assert.assertEquals(\"Should have 1 create, 1 approve, 4 modify events\", 6, events.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d9b45aea3132055021b54288d72f5e8141af3828"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "e04bd030271cd798c9c8032770676a2743790fc4", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/e04bd030271cd798c9c8032770676a2743790fc4", "committedDate": "2020-01-13T19:33:50Z", "message": "Test for newest events"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQyMTA4MTQx", "url": "https://github.com/dockstore/dockstore/pull/3120#pullrequestreview-342108141", "createdAt": "2020-01-13T20:10:33Z", "commit": {"oid": "e04bd030271cd798c9c8032770676a2743790fc4"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1861, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}