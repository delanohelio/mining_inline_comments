{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDg2OTQzODE4", "number": 3809, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMzo1ODozMFrOEjXg7A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoyMDo1NVrOEjzcMQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NTIwODc2OnYy", "diffSide": "RIGHT", "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMzo1ODozMFrOHRrmOQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMzo1ODozMFrOHRrmOQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMwMjEzNw==", "bodyText": "You need a fail after this line; otherwise if the test doesn't throw an error it will pass.", "url": "https://github.com/dockstore/dockstore/pull/3809#discussion_r488302137", "createdAt": "2020-09-14T23:58:30Z", "author": {"login": "coverbeck"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "diffHunk": "@@ -131,4 +145,33 @@ public void testUpdateNotification() {\n         assertEquals(currentMsg, message);  // confirm that the database entry was updated\n \n     }\n+    @Test\n+    public void testLongNotification() throws IOException {\n+\n+        // set up a notification that is too long\n+        Notification notification = longNotification();\n+\n+        // try to create notification with too long of a message\n+        try {\n+            curationApiAdmin.createNotification(notification);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e57b07ca87fc49c28c96bae2e458208a585cc7f3"}, "originalPosition": 48}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NTIwOTMyOnYy", "diffSide": "RIGHT", "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMzo1ODo0OFrOHRrmlA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNFQyMzo1ODo0OFrOHRrmlA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODMwMjIyOA==", "bodyText": "Also need fail after this line.", "url": "https://github.com/dockstore/dockstore/pull/3809#discussion_r488302228", "createdAt": "2020-09-14T23:58:48Z", "author": {"login": "coverbeck"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "diffHunk": "@@ -131,4 +145,33 @@ public void testUpdateNotification() {\n         assertEquals(currentMsg, message);  // confirm that the database entry was updated\n \n     }\n+    @Test\n+    public void testLongNotification() throws IOException {\n+\n+        // set up a notification that is too long\n+        Notification notification = longNotification();\n+\n+        // try to create notification with too long of a message\n+        try {\n+            curationApiAdmin.createNotification(notification);\n+        } catch (ApiException e) {\n+            assertEquals(Response.Status.BAD_REQUEST.getStatusCode(), e.getCode()); // this should return a 400 code right now\n+        }\n+\n+        // make another notification that will be updated\n+        Notification updateNotification = curationApiAdmin.createNotification(testNotification());\n+        long id = updateNotification.getId();\n+        notification.setId(id);\n+\n+        // try to update notification with long notification\n+        try {\n+            curationApiAdmin.updateNotification(id, notification);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e57b07ca87fc49c28c96bae2e458208a585cc7f3"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1NzkzMzY3OnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/core/Notification.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNDo0MzozNFrOHSFaTA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxODoxMToxNlrOHSOGww==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODcyNTA2OA==", "bodyText": "Seems like an arbitrary number before and now. Can you make some sort of general comment about the number chosen?", "url": "https://github.com/dockstore/dockstore/pull/3809#discussion_r488725068", "createdAt": "2020-09-15T14:43:34Z", "author": {"login": "garyluu"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/core/Notification.java", "diffHunk": "@@ -44,7 +44,7 @@\n     private long id;\n \n     @Column\n-    @Size(max = 280)\n+    @Size(max = 1024)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e57b07ca87fc49c28c96bae2e458208a585cc7f3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyODI2Ng==", "bodyText": "It is mostly an arbitrary number I believe, I think the original was 280 similar to a tweet length but ran into problems with markdown characters/hyper links taking up a significant amount of those 280 characters. I originally doubled to 560 but Louise suggest going to 2^10 just to be safe.", "url": "https://github.com/dockstore/dockstore/pull/3809#discussion_r488828266", "createdAt": "2020-09-15T17:12:27Z", "author": {"login": "nolwarre"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/core/Notification.java", "diffHunk": "@@ -44,7 +44,7 @@\n     private long id;\n \n     @Column\n-    @Size(max = 280)\n+    @Size(max = 1024)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODcyNTA2OA=="}, "originalCommit": {"oid": "e57b07ca87fc49c28c96bae2e458208a585cc7f3"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2NzUyMw==", "bodyText": "Make a comment in the code", "url": "https://github.com/dockstore/dockstore/pull/3809#discussion_r488867523", "createdAt": "2020-09-15T18:11:16Z", "author": {"login": "garyluu"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/core/Notification.java", "diffHunk": "@@ -44,7 +44,7 @@\n     private long id;\n \n     @Column\n-    @Size(max = 280)\n+    @Size(max = 1024)", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODcyNTA2OA=="}, "originalCommit": {"oid": "e57b07ca87fc49c28c96bae2e458208a585cc7f3"}, "originalPosition": 5}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1Nzk3ODc5OnYy", "diffSide": "RIGHT", "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "isResolved": false, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxNDo1MjozN1rOHSF2fg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQxODoxMTowN1rOHSOGew==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODczMjI4Ng==", "bodyText": "You can use Java 11's Files.readString(Paths.get(ResourceHelpers.resourceFilePath(\"longNotification\"))); instead of Apache commons", "url": "https://github.com/dockstore/dockstore/pull/3809#discussion_r488732286", "createdAt": "2020-09-15T14:52:37Z", "author": {"login": "garyluu"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "diffHunk": "@@ -45,6 +50,15 @@ private Notification anotherTestNotification() {\n         return notification;\n     }\n \n+    private Notification longNotification() throws IOException {\n+        Notification notification = new Notification();\n+        String message = FileUtils.readFileToString(new File(ResourceHelpers.resourceFilePath(\"longNotification.txt\")), StandardCharsets.UTF_8);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e57b07ca87fc49c28c96bae2e458208a585cc7f3"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyNjI2MQ==", "bodyText": "I changed it to the suggestion, what are the advantages of this approach as opposed to the Apache commons?", "url": "https://github.com/dockstore/dockstore/pull/3809#discussion_r488826261", "createdAt": "2020-09-15T17:08:50Z", "author": {"login": "nolwarre"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "diffHunk": "@@ -45,6 +50,15 @@ private Notification anotherTestNotification() {\n         return notification;\n     }\n \n+    private Notification longNotification() throws IOException {\n+        Notification notification = new Notification();\n+        String message = FileUtils.readFileToString(new File(ResourceHelpers.resourceFilePath(\"longNotification.txt\")), StandardCharsets.UTF_8);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODczMjI4Ng=="}, "originalCommit": {"oid": "e57b07ca87fc49c28c96bae2e458208a585cc7f3"}, "originalPosition": 26}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg2NzQ1MQ==", "bodyText": "Don't need to use a 3rd party library when it can be done natively. One day we might be able to remove the 3rd party library entirely", "url": "https://github.com/dockstore/dockstore/pull/3809#discussion_r488867451", "createdAt": "2020-09-15T18:11:07Z", "author": {"login": "garyluu"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "diffHunk": "@@ -45,6 +50,15 @@ private Notification anotherTestNotification() {\n         return notification;\n     }\n \n+    private Notification longNotification() throws IOException {\n+        Notification notification = new Notification();\n+        String message = FileUtils.readFileToString(new File(ResourceHelpers.resourceFilePath(\"longNotification.txt\")), StandardCharsets.UTF_8);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODczMjI4Ng=="}, "originalCommit": {"oid": "e57b07ca87fc49c28c96bae2e458208a585cc7f3"}, "originalPosition": 26}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMzA1OTc4NDE3OnYy", "diffSide": "RIGHT", "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoyMDo1NVrOHSXsHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0xNVQyMjoyMDo1NVrOHSXsHw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTAyNDU0Mw==", "bodyText": "I know you just changed this, and I overlooked it in my first review, but I think it would be better to generate the string right here. Java 11 has a feature has a feature Sting.repeat. If you do it this way:\n\nYou know exactly how long the string is. How long is longNotification.txt? I have to open it an editor or run some tool that counts chars. At a glance, I don't know if you're really over testing the limit or not.\nYou could easily test different inputs, up to the limit, just over the limit, etc.\n\nSomething like this:\nString message = \"a\".repeat(1024);\n\nYou could make 1024 a parameter on line 53, so then you test it with exactly 1024, then test again with 1025.\nYou could even make the length a parameter on line 53.", "url": "https://github.com/dockstore/dockstore/pull/3809#discussion_r489024543", "createdAt": "2020-09-15T22:20:55Z", "author": {"login": "coverbeck"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/NotificationIT.java", "diffHunk": "@@ -45,6 +50,15 @@ private Notification anotherTestNotification() {\n         return notification;\n     }\n \n+    private Notification longNotification() throws IOException {\n+        Notification notification = new Notification();\n+        String message = Files.readString(Paths.get(ResourceHelpers.resourceFilePath(\"longNotification.txt\")));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "db6c467a596fbce198740b5c6c82c26baafb8243"}, "originalPosition": 29}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 2845, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}