{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwODk1MjQy", "number": 3276, "reviewThreads": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNzoxNzoxMFrODjin4w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzo0MzoxMFrODj0Sog==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NTk0MDE5OnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/helpers/AbstractImageRegistry.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxNzoxNzoxMFrOFvZ9nA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxOTozODozN1rOFveoDQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI1Mjc2NA==", "bodyText": "I don't have the whole context for this, and I see the ticket says to only log the type, but since you're in here anyways why not log the actual tool as well?\nJust a thought, which may not be applicable.", "url": "https://github.com/dockstore/dockstore/pull/3276#discussion_r385252764", "createdAt": "2020-02-27T17:17:10Z", "author": {"login": "coverbeck"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/helpers/AbstractImageRegistry.java", "diffHunk": "@@ -276,6 +280,17 @@ public Tool refreshTool(final long toolId, final Long userId, final UserDAO user\n         return updatedTool;\n     }\n \n+    /**\n+     * Logs a refresh statement with the tool's descriptor language(s)\n+     * @param tool                tool that is being refreshed\n+     */\n+    private void logToolRefresh(final Tool tool) {\n+        List<String> descriptorTypes = tool.getDescriptorType();\n+        for (String descriptorType : descriptorTypes) {\n+            LOG.info(\"Refreshing \" + descriptorType + \" tool\");", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d76771b510d8e416042a921b705d452d693c58c"}, "originalPosition": 29}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTMyOTE2NQ==", "bodyText": "I don't see any harm in logging the tool name as well. However, if the intention is to create metrics that can be displayed on Grafana based on the tool names (ex: which tools are refreshed the most), it will be difficult unless we know exactly which tools we want to monitor.", "url": "https://github.com/dockstore/dockstore/pull/3276#discussion_r385329165", "createdAt": "2020-02-27T19:38:37Z", "author": {"login": "kathy-t"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/helpers/AbstractImageRegistry.java", "diffHunk": "@@ -276,6 +280,17 @@ public Tool refreshTool(final long toolId, final Long userId, final UserDAO user\n         return updatedTool;\n     }\n \n+    /**\n+     * Logs a refresh statement with the tool's descriptor language(s)\n+     * @param tool                tool that is being refreshed\n+     */\n+    private void logToolRefresh(final Tool tool) {\n+        List<String> descriptorTypes = tool.getDescriptorType();\n+        for (String descriptorType : descriptorTypes) {\n+            LOG.info(\"Refreshing \" + descriptorType + \" tool\");", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI1Mjc2NA=="}, "originalCommit": {"oid": "0d76771b510d8e416042a921b705d452d693c58c"}, "originalPosition": 29}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NjIyNTU4OnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/resources/WorkflowResource.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxODo0MTo1MVrOFvcxZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QxODo0MTo1MVrOFvcxZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTI5ODc5MA==", "bodyText": "Could use an additional comment on why it's logging it.", "url": "https://github.com/dockstore/dockstore/pull/3276#discussion_r385298790", "createdAt": "2020-02-27T18:41:51Z", "author": {"login": "garyluu"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/resources/WorkflowResource.java", "diffHunk": "@@ -363,6 +365,16 @@ private void refreshHelper(final SourceCodeRepoInterface sourceCodeRepoInterface\n         }\n     }\n \n+    /**\n+     * Logs a refresh statement with the workflow's descriptor language if workflow is a FULL workflow", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "0d76771b510d8e416042a921b705d452d693c58c"}, "originalPosition": 21}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NjY0NjM1OnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/DockstoreWebserviceConfiguration.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDo1NjoyMFrOFvg5ow==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMDo1NjoyMFrOFvg5ow==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM2NjQzNQ==", "bodyText": "I think the name is redundant, but it doesn't hurt.", "url": "https://github.com/dockstore/dockstore/pull/3276#discussion_r385366435", "createdAt": "2020-02-27T20:56:20Z", "author": {"login": "coverbeck"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/DockstoreWebserviceConfiguration.java", "diffHunk": "@@ -481,6 +483,15 @@ public void setExternalGoogleClientIdPrefixes(List<String> externalGoogleClientI\n         this.externalGoogleClientIdPrefixes = externalGoogleClientIdPrefixes;\n     }\n \n+    @JsonProperty(\"dashboard\")", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f9cdbd35e4dd0e621aefd85dea42366a5acdbd97"}, "originalPosition": 13}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4NjcyNTUyOnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/resources/WorkflowResource.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMToyMjo1MVrOFvhqOg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMToyMjo1MVrOFvhqOg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTM3ODg3NA==", "bodyText": "workflow.getEntryPath() here, tool.getEntryPath() up there seems simpler.", "url": "https://github.com/dockstore/dockstore/pull/3276#discussion_r385378874", "createdAt": "2020-02-27T21:22:51Z", "author": {"login": "garyluu"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/resources/WorkflowResource.java", "diffHunk": "@@ -363,6 +367,17 @@ private void refreshHelper(final SourceCodeRepoInterface sourceCodeRepoInterface\n         }\n     }\n \n+    /**\n+     * Logs a refresh statement with the workflow's descriptor language if workflow is a FULL workflow.\n+     * These logs will be monitored by CloudWatch and displayed on Grafana.\n+     * @param workflow                workflow that is being refreshed\n+     */\n+    private void logFullWorkflowRefresh(final Workflow workflow) {\n+        if (workflow.getMode() == WorkflowMode.FULL) {\n+            LOG.info(String.format(\"%s: Refreshing %s workflow named %s\", dashboardPrefix, workflow.getDescriptorType(), workflow.getWorkflowPath()));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f9cdbd35e4dd0e621aefd85dea42366a5acdbd97"}, "originalPosition": 43}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4ODgzNDkwOnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/helpers/AbstractImageRegistry.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzo0MzoxMFrOFv1V6g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxMzo0MzoxMFrOFv1V6g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTcwMTM1NA==", "bodyText": "Missing new parameter in function JavaDoc.", "url": "https://github.com/dockstore/dockstore/pull/3276#discussion_r385701354", "createdAt": "2020-02-28T13:43:10Z", "author": {"login": "agduncan94"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/helpers/AbstractImageRegistry.java", "diffHunk": "@@ -145,7 +145,7 @@\n     @SuppressWarnings(\"checkstyle:parameternumber\")\n     public List<Tool> refreshTools(final long userId, final UserDAO userDAO, final ToolDAO toolDAO, final TagDAO tagDAO,\n             final FileDAO fileDAO, final FileFormatDAO fileFormatDAO, final HttpClient client, final Token githubToken, final Token bitbucketToken, final Token gitlabToken,\n-            String organization, final EventDAO eventDAO) {\n+            String organization, final EventDAO eventDAO, final String dashboardPrefix) {\n         // Get all the namespaces for the given registry", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f9cdbd35e4dd0e621aefd85dea42366a5acdbd97"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3017, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}