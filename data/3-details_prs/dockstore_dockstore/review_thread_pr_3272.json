{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzgwNTM3NDgz", "number": 3272, "reviewThreads": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwMDozNTo0NVrODjSy8A==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMzo0MjoyNFrODlzNWQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4MzM0NzA0OnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/test/java/core/WDLParseTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QwMDozNTo0NVrOFvBbUQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yN1QyMzoxNjoxN1rOFvkhtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDg1MDc2OQ==", "bodyText": "If instead of validation.getMessage().entrySet... you did validation.getMessage.values()... and it would make your code a little less complicated.", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r384850769", "createdAt": "2020-02-27T00:35:45Z", "author": {"login": "coverbeck"}, "path": "dockstore-webservice/src/test/java/core/WDLParseTest.java", "diffHunk": "@@ -130,6 +134,49 @@ private static SourceFile getSourceFile2() {\n     }\n \n \n+    /**\n+     * Tests that Dockstore can handle a workflow with locally recursive imports\n+     */\n+    @Test\n+    public void testLocallyRecursiveImport() {\n+        String type = \"workflow\";\n+        File recursiveWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/localrecursive.wdl\"));\n+        //String primaryDescriptorFilePath = recursiveWDL.getAbsolutePath();\n+        String primaryDescriptorFilePath = \"localrecursive.wdl\";\n+        SourceFile sourceFile = new SourceFile();\n+\n+        File recursiveimportWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/first-import.wdl\"));\n+        SourceFile importsourceFile = new SourceFile();\n+\n+        try {\n+            sourceFile.setContent(FileUtils.readFileToString(recursiveWDL, StandardCharsets.UTF_8));\n+            sourceFile.setAbsolutePath(\"/localrecursive.wdl\");\n+            sourceFile.setPath(\"localrecursive.wdl\");\n+            sourceFile.setType(DescriptorLanguage.FileType.DOCKSTORE_WDL);\n+\n+            importsourceFile.setContent(FileUtils.readFileToString(recursiveimportWDL, StandardCharsets.UTF_8));\n+            importsourceFile.setAbsolutePath(\"/first-import.wdl\");\n+            importsourceFile.setPath(\"first-import.wdl\");\n+            importsourceFile.setType(DescriptorLanguage.FileType.DOCKSTORE_WDL);\n+\n+            Set<SourceFile> sourceFileSet = new HashSet<>();\n+            sourceFileSet.add(sourceFile);\n+\n+            sourceFileSet.add(importsourceFile);\n+\n+            WDLHandler wdlHandler = new WDLHandler();\n+            VersionTypeValidation validation = wdlHandler.validateEntrySet(sourceFileSet, primaryDescriptorFilePath, type);\n+            Assert.assertFalse(validation.isValid());\n+            // Go through message part and verify it says 'Recursive local import detected'\n+            Optional<Map.Entry<String, String>> validationEntryMap = validation.getMessage().entrySet().stream()", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "13fc40c6e9d09c4e6b3a5cd62f4e9b67634d376e"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQyNTg0NA==", "bodyText": "fixed", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r385425844", "createdAt": "2020-02-27T23:16:17Z", "author": {"login": "wshands"}, "path": "dockstore-webservice/src/test/java/core/WDLParseTest.java", "diffHunk": "@@ -130,6 +134,49 @@ private static SourceFile getSourceFile2() {\n     }\n \n \n+    /**\n+     * Tests that Dockstore can handle a workflow with locally recursive imports\n+     */\n+    @Test\n+    public void testLocallyRecursiveImport() {\n+        String type = \"workflow\";\n+        File recursiveWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/localrecursive.wdl\"));\n+        //String primaryDescriptorFilePath = recursiveWDL.getAbsolutePath();\n+        String primaryDescriptorFilePath = \"localrecursive.wdl\";\n+        SourceFile sourceFile = new SourceFile();\n+\n+        File recursiveimportWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/first-import.wdl\"));\n+        SourceFile importsourceFile = new SourceFile();\n+\n+        try {\n+            sourceFile.setContent(FileUtils.readFileToString(recursiveWDL, StandardCharsets.UTF_8));\n+            sourceFile.setAbsolutePath(\"/localrecursive.wdl\");\n+            sourceFile.setPath(\"localrecursive.wdl\");\n+            sourceFile.setType(DescriptorLanguage.FileType.DOCKSTORE_WDL);\n+\n+            importsourceFile.setContent(FileUtils.readFileToString(recursiveimportWDL, StandardCharsets.UTF_8));\n+            importsourceFile.setAbsolutePath(\"/first-import.wdl\");\n+            importsourceFile.setPath(\"first-import.wdl\");\n+            importsourceFile.setType(DescriptorLanguage.FileType.DOCKSTORE_WDL);\n+\n+            Set<SourceFile> sourceFileSet = new HashSet<>();\n+            sourceFileSet.add(sourceFile);\n+\n+            sourceFileSet.add(importsourceFile);\n+\n+            WDLHandler wdlHandler = new WDLHandler();\n+            VersionTypeValidation validation = wdlHandler.validateEntrySet(sourceFileSet, primaryDescriptorFilePath, type);\n+            Assert.assertFalse(validation.isValid());\n+            // Go through message part and verify it says 'Recursive local import detected'\n+            Optional<Map.Entry<String, String>> validationEntryMap = validation.getMessage().entrySet().stream()", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDg1MDc2OQ=="}, "originalCommit": {"oid": "13fc40c6e9d09c4e6b3a5cd62f4e9b67634d376e"}, "originalPosition": 60}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTU5OTUxOnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/test/java/core/WDLParseTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNzoxODowOFrOFv8m5w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwMDoyNDoyM1rOFw0OdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTgyMDM5MQ==", "bodyText": "No need to change, but FYI, if you change findAny to anyMatch you directly get a boolean and makes your life slightly easier.", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r385820391", "createdAt": "2020-02-28T17:18:08Z", "author": {"login": "coverbeck"}, "path": "dockstore-webservice/src/test/java/core/WDLParseTest.java", "diffHunk": "@@ -130,6 +134,49 @@ private static SourceFile getSourceFile2() {\n     }\n \n \n+    /**\n+     * Tests that Dockstore can handle a workflow with locally recursive imports\n+     */\n+    @Test\n+    public void testLocallyRecursiveImport() {\n+        String type = \"workflow\";\n+        File recursiveWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/localrecursive.wdl\"));\n+        //String primaryDescriptorFilePath = recursiveWDL.getAbsolutePath();\n+        String primaryDescriptorFilePath = \"localrecursive.wdl\";\n+        SourceFile sourceFile = new SourceFile();\n+\n+        File recursiveimportWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/first-import.wdl\"));\n+        SourceFile importsourceFile = new SourceFile();\n+\n+        try {\n+            sourceFile.setContent(FileUtils.readFileToString(recursiveWDL, StandardCharsets.UTF_8));\n+            sourceFile.setAbsolutePath(\"/localrecursive.wdl\");\n+            sourceFile.setPath(\"localrecursive.wdl\");\n+            sourceFile.setType(DescriptorLanguage.FileType.DOCKSTORE_WDL);\n+\n+            importsourceFile.setContent(FileUtils.readFileToString(recursiveimportWDL, StandardCharsets.UTF_8));\n+            importsourceFile.setAbsolutePath(\"/first-import.wdl\");\n+            importsourceFile.setPath(\"first-import.wdl\");\n+            importsourceFile.setType(DescriptorLanguage.FileType.DOCKSTORE_WDL);\n+\n+            Set<SourceFile> sourceFileSet = new HashSet<>();\n+            sourceFileSet.add(sourceFile);\n+\n+            sourceFileSet.add(importsourceFile);\n+\n+            WDLHandler wdlHandler = new WDLHandler();\n+            VersionTypeValidation validation = wdlHandler.validateEntrySet(sourceFileSet, primaryDescriptorFilePath, type);\n+            assertFalse(validation.isValid());\n+            // Go through message part and verify it says 'Recursive local import detected'\n+            Optional<String> validationEntryMap = validation.getMessage().values().stream()\n+                    .filter(msg -> StringUtils.contains(msg, \"Recursive local import detected\")).findAny();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de19fe1cb7fa70c3229831e0f2099241487c2056"}, "originalPosition": 68}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjczMTYzNg==", "bodyText": "changed findAny to anyMatch", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r386731636", "createdAt": "2020-03-03T00:24:23Z", "author": {"login": "wshands"}, "path": "dockstore-webservice/src/test/java/core/WDLParseTest.java", "diffHunk": "@@ -130,6 +134,49 @@ private static SourceFile getSourceFile2() {\n     }\n \n \n+    /**\n+     * Tests that Dockstore can handle a workflow with locally recursive imports\n+     */\n+    @Test\n+    public void testLocallyRecursiveImport() {\n+        String type = \"workflow\";\n+        File recursiveWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/localrecursive.wdl\"));\n+        //String primaryDescriptorFilePath = recursiveWDL.getAbsolutePath();\n+        String primaryDescriptorFilePath = \"localrecursive.wdl\";\n+        SourceFile sourceFile = new SourceFile();\n+\n+        File recursiveimportWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/first-import.wdl\"));\n+        SourceFile importsourceFile = new SourceFile();\n+\n+        try {\n+            sourceFile.setContent(FileUtils.readFileToString(recursiveWDL, StandardCharsets.UTF_8));\n+            sourceFile.setAbsolutePath(\"/localrecursive.wdl\");\n+            sourceFile.setPath(\"localrecursive.wdl\");\n+            sourceFile.setType(DescriptorLanguage.FileType.DOCKSTORE_WDL);\n+\n+            importsourceFile.setContent(FileUtils.readFileToString(recursiveimportWDL, StandardCharsets.UTF_8));\n+            importsourceFile.setAbsolutePath(\"/first-import.wdl\");\n+            importsourceFile.setPath(\"first-import.wdl\");\n+            importsourceFile.setType(DescriptorLanguage.FileType.DOCKSTORE_WDL);\n+\n+            Set<SourceFile> sourceFileSet = new HashSet<>();\n+            sourceFileSet.add(sourceFile);\n+\n+            sourceFileSet.add(importsourceFile);\n+\n+            WDLHandler wdlHandler = new WDLHandler();\n+            VersionTypeValidation validation = wdlHandler.validateEntrySet(sourceFileSet, primaryDescriptorFilePath, type);\n+            assertFalse(validation.isValid());\n+            // Go through message part and verify it says 'Recursive local import detected'\n+            Optional<String> validationEntryMap = validation.getMessage().values().stream()\n+                    .filter(msg -> StringUtils.contains(msg, \"Recursive local import detected\")).findAny();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTgyMDM5MQ=="}, "originalCommit": {"oid": "de19fe1cb7fa70c3229831e0f2099241487c2056"}, "originalPosition": 68}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM4OTY2ODU3OnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "isResolved": true, "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMi0yOFQxNzozOTo1M1rOFv9PxA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwMDoyNDozN1rOFw0OtA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTgzMDg1Mg==", "bodyText": "This code mostly duplicates similary code in parseWorkflowContent. Could you create a new function and call from both places?", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r385830852", "createdAt": "2020-02-28T17:39:53Z", "author": {"login": "coverbeck"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "diffHunk": "@@ -226,6 +226,16 @@ public VersionTypeValidation validateEntrySet(Set<SourceFile> sourcefiles, Strin\n                 String content = FileUtils.readFileToString(tempMainDescriptor, StandardCharsets.UTF_8);\n                 checkForRecursiveHTTPImports(content, new HashSet<>());\n \n+                // Check for local recursive imports in the WDL files", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "de19fe1cb7fa70c3229831e0f2099241487c2056"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTk1MTI5OA==", "bodyText": "Other thought: If this is similar to parseWorkflowContent, does it mean we end up looking through all the imports twice?\nIs there a way to avoid this?", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r385951298", "createdAt": "2020-02-28T22:27:02Z", "author": {"login": "denis-yuen"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "diffHunk": "@@ -226,6 +226,16 @@ public VersionTypeValidation validateEntrySet(Set<SourceFile> sourcefiles, Strin\n                 String content = FileUtils.readFileToString(tempMainDescriptor, StandardCharsets.UTF_8);\n                 checkForRecursiveHTTPImports(content, new HashSet<>());\n \n+                // Check for local recursive imports in the WDL files", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTgzMDg1Mg=="}, "originalCommit": {"oid": "de19fe1cb7fa70c3229831e0f2099241487c2056"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjczMTcwMA==", "bodyText": "added a new function", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r386731700", "createdAt": "2020-03-03T00:24:37Z", "author": {"login": "wshands"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "diffHunk": "@@ -226,6 +226,16 @@ public VersionTypeValidation validateEntrySet(Set<SourceFile> sourcefiles, Strin\n                 String content = FileUtils.readFileToString(tempMainDescriptor, StandardCharsets.UTF_8);\n                 checkForRecursiveHTTPImports(content, new HashSet<>());\n \n+                // Check for local recursive imports in the WDL files", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTgzMDg1Mg=="}, "originalCommit": {"oid": "de19fe1cb7fa70c3229831e0f2099241487c2056"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjM5NjI2ODg1OnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wM1QwNjoxMjoxOVrOFw5aYQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNFQyMjoyODozNVrOFx__xQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgxNjYwOQ==", "bodyText": "This feels wrong to either append the result to an existing map or create a new map -- it's not very functional.\nI would suggest changing this method to just return an Optional, then have the caller append to the result to the map, if present. The caller will have the key.", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r386816609", "createdAt": "2020-03-03T06:12:19Z", "author": {"login": "coverbeck"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "diffHunk": "@@ -173,6 +171,31 @@ public Version parseWorkflowContent(String filepath, String content, Set<SourceF\n         return version;\n     }\n \n+\n+    /**\n+     * A common helper method for checking for local recursive imports\n+     * @param primaryDescriptorContent content of primary descriptor\n+     * @param sourcefiles Set of sourcefiles to validate\n+     * @param primaryDescriptorFilePath Path of primary descriptor\n+     * @param validationMessageObject Object in which to store messages\n+     * @return an optional validationMessageObject\n+     */\n+    public Optional<Map<String, String>>  reportValidationForLocalRecursiveImports(String primaryDescriptorContent, Set<SourceFile> sourcefiles,\n+            String primaryDescriptorFilePath, Map<String, String> validationMessageObject) {\n+        try {\n+            String parent = primaryDescriptorFilePath.startsWith(\"/\") ? new File(primaryDescriptorFilePath).getParent() : \"/\";\n+            checkForRecursiveLocalImports(primaryDescriptorContent, sourcefiles, new HashSet<>(), parent);\n+        } catch (ParseException e) {\n+            LOG.error(\"Recursive local imports found: \", e);\n+            if (validationMessageObject == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "88e5ae0e36a7206777da3505b87b07a9875f9f34"}, "originalPosition": 59}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzk3MzA2MQ==", "bodyText": "fixed; now returns an Optional String", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r387973061", "createdAt": "2020-03-04T22:28:35Z", "author": {"login": "wshands"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "diffHunk": "@@ -173,6 +171,31 @@ public Version parseWorkflowContent(String filepath, String content, Set<SourceF\n         return version;\n     }\n \n+\n+    /**\n+     * A common helper method for checking for local recursive imports\n+     * @param primaryDescriptorContent content of primary descriptor\n+     * @param sourcefiles Set of sourcefiles to validate\n+     * @param primaryDescriptorFilePath Path of primary descriptor\n+     * @param validationMessageObject Object in which to store messages\n+     * @return an optional validationMessageObject\n+     */\n+    public Optional<Map<String, String>>  reportValidationForLocalRecursiveImports(String primaryDescriptorContent, Set<SourceFile> sourcefiles,\n+            String primaryDescriptorFilePath, Map<String, String> validationMessageObject) {\n+        try {\n+            String parent = primaryDescriptorFilePath.startsWith(\"/\") ? new File(primaryDescriptorFilePath).getParent() : \"/\";\n+            checkForRecursiveLocalImports(primaryDescriptorContent, sourcefiles, new HashSet<>(), parent);\n+        } catch (ParseException e) {\n+            LOG.error(\"Recursive local imports found: \", e);\n+            if (validationMessageObject == null) {", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgxNjYwOQ=="}, "originalCommit": {"oid": "88e5ae0e36a7206777da3505b87b07a9875f9f34"}, "originalPosition": 59}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwNjY1OTQwOnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNVQxNzozNDozOVrOFydKAw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQwMDoyMjoxMFrOFyow3g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQ1MDgxOQ==", "bodyText": "Returns a string", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r388450819", "createdAt": "2020-03-05T17:34:39Z", "author": {"login": "coverbeck"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "diffHunk": "@@ -173,6 +173,26 @@ public Version parseWorkflowContent(String filepath, String content, Set<SourceF\n         return version;\n     }\n \n+\n+    /**\n+     * A common helper method for checking for local recursive imports\n+     * @param primaryDescriptorContent content of primary descriptor\n+     * @param sourcefiles Set of sourcefiles to validate\n+     * @param primaryDescriptorFilePath Path of primary descriptor\n+     * @return an optional validationMessageObject", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "8fd27c81874e4d222bb0180a0d6867d8cc89209c"}, "originalPosition": 49}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODY0MDk5MA==", "bodyText": "Fixed", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r388640990", "createdAt": "2020-03-06T00:22:10Z", "author": {"login": "wshands"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/languages/WDLHandler.java", "diffHunk": "@@ -173,6 +173,26 @@ public Version parseWorkflowContent(String filepath, String content, Set<SourceF\n         return version;\n     }\n \n+\n+    /**\n+     * A common helper method for checking for local recursive imports\n+     * @param primaryDescriptorContent content of primary descriptor\n+     * @param sourcefiles Set of sourcefiles to validate\n+     * @param primaryDescriptorFilePath Path of primary descriptor\n+     * @return an optional validationMessageObject", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODQ1MDgxOQ=="}, "originalCommit": {"oid": "8fd27c81874e4d222bb0180a0d6867d8cc89209c"}, "originalPosition": 49}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjQwOTYyOTA1OnYy", "diffSide": "RIGHT", "path": "dockstore-webservice/src/test/java/core/WDLParseTest.java", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxMzo0MjoyNFrOFy5FVw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0wNlQxNjozOToyN1rOFy_X7g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwODM3NQ==", "bodyText": "If keeping this commented code in the PR I would add a note saying why it is there.", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r388908375", "createdAt": "2020-03-06T13:42:24Z", "author": {"login": "agduncan94"}, "path": "dockstore-webservice/src/test/java/core/WDLParseTest.java", "diffHunk": "@@ -130,6 +134,47 @@ private static SourceFile getSourceFile2() {\n     }\n \n \n+    /**\n+     * Tests that Dockstore can handle a workflow with locally recursive imports\n+     */\n+    @Test\n+    public void testLocallyRecursiveImport() {\n+        String type = \"workflow\";\n+        File recursiveWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/localrecursive.wdl\"));\n+        //String primaryDescriptorFilePath = recursiveWDL.getAbsolutePath();", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "7155be2eee1d2392951a30179c1b9c91c9a0866d"}, "originalPosition": 37}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTAxMTQzOA==", "bodyText": "fixed removed commented code", "url": "https://github.com/dockstore/dockstore/pull/3272#discussion_r389011438", "createdAt": "2020-03-06T16:39:27Z", "author": {"login": "wshands"}, "path": "dockstore-webservice/src/test/java/core/WDLParseTest.java", "diffHunk": "@@ -130,6 +134,47 @@ private static SourceFile getSourceFile2() {\n     }\n \n \n+    /**\n+     * Tests that Dockstore can handle a workflow with locally recursive imports\n+     */\n+    @Test\n+    public void testLocallyRecursiveImport() {\n+        String type = \"workflow\";\n+        File recursiveWDL = new File(ResourceHelpers.resourceFilePath(\"local-recursive-import/localrecursive.wdl\"));\n+        //String primaryDescriptorFilePath = recursiveWDL.getAbsolutePath();", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODkwODM3NQ=="}, "originalCommit": {"oid": "7155be2eee1d2392951a30179c1b9c91c9a0866d"}, "originalPosition": 37}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 3010, "cost": 1, "resetAt": "2021-11-12T13:16:51Z"}}}