{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI0NDUxNzc4", "number": 3939, "title": "Feature/3917/circle ci cleanup", "bodyText": "Stuff done:\n\nm2 cache between jobs (not just between workflows)\nmerge to parent\nremove some repetitive integration tests commands\nreduced resource to \"large\"\nswap to postgres11.8\n\nStill missing:\n\nUnit tests still uses postgres 9.x.x, it requires migration changes (splitting to different ticket)\nremove coveralls from travis and pom\nanother issue that's already created will deal with the flakey tests\nSome sort of connection leak (by the internal dropwizard validation query), could not figure out how to fix, just increased db max_connections\nPGP error fix, currently disabled\nThere's a regression test that requires Docker\n\nRuns:\n4/5 passed, 1 got cancelled for some reason (not timeout, just cancelled...)", "createdAt": "2020-11-20T05:55:23Z", "url": "https://github.com/dockstore/dockstore/pull/3939", "merged": true, "mergeCommit": {"oid": "ea04f1f898e97d7c293500fffd9c5e51ceb56423"}, "closed": true, "closedAt": "2020-11-23T23:00:18Z", "author": {"login": "garyluu"}, "timelineItems": {"totalCount": 27, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABddcRv5AH2gAyNTI0NDUxNzc4OjU5MDM0Y2I2OWE3MDdkMDM2OWJlYTRiNTdmOTQ2NDYzMTdiOWIwOTg=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdfdTaIAFqTUzNjkxMDYxNQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "59034cb69a707d0369bea4b57f94646317b9b098", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/59034cb69a707d0369bea4b57f94646317b9b098", "committedDate": "2020-11-17T16:37:46Z", "message": "Update postgres, resource class, cache m2"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "8c9453061873aa78af426035b10540d937b8ebb3", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/8c9453061873aa78af426035b10540d937b8ebb3", "committedDate": "2020-11-17T16:50:48Z", "message": "Fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "20f51ea7a4ee3caadcd10afad4d9ac48c0384f2e", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/20f51ea7a4ee3caadcd10afad4d9ac48c0384f2e", "committedDate": "2020-11-17T18:04:56Z", "message": "Don't decrypt twice"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f2d298eba7340aa426912845b470cd603300d35e", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/f2d298eba7340aa426912845b470cd603300d35e", "committedDate": "2020-11-17T18:04:56Z", "message": "Merge with parent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "47050ceefda45b6ef23f688630a2675a3e57a767", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/47050ceefda45b6ef23f688630a2675a3e57a767", "committedDate": "2020-11-18T16:54:30Z", "message": "Simplify + prettier"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "82d1003d1e7381d4d613603bbd8af9aadf5e86df", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/82d1003d1e7381d4d613603bbd8af9aadf5e86df", "committedDate": "2020-11-18T18:55:55Z", "message": "Disable cache in hopes of fixing test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "78368f790f8be58f16972fa3f472efc3d0eae3b2", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/78368f790f8be58f16972fa3f472efc3d0eae3b2", "committedDate": "2020-11-18T18:59:46Z", "message": "Fix checkstyle"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9ed997103ee6afa8b78ed59616a60dad1e08605", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/c9ed997103ee6afa8b78ed59616a60dad1e08605", "committedDate": "2020-11-20T06:59:40Z", "message": "Reduce even more"}, "afterCommit": {"oid": "989a04f0d7651ad123a0bd3a83d29ca695ef6296", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/989a04f0d7651ad123a0bd3a83d29ca695ef6296", "committedDate": "2020-11-20T15:16:34Z", "message": "Don't use cache for unit tests to maybe avoid PGP error"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f1da6a6cd6e5410405769090c0d9587266509a8c", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/f1da6a6cd6e5410405769090c0d9587266509a8c", "committedDate": "2020-11-20T15:23:12Z", "message": "Fix test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3763ceea92d72cbc5c3a7c6872c8d22d74d79035", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/3763ceea92d72cbc5c3a7c6872c8d22d74d79035", "committedDate": "2020-11-20T15:23:12Z", "message": "Attempt to prevent connection leak"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7695004c57f4ac5e51a2101aa7f98fbf74208e28", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/7695004c57f4ac5e51a2101aa7f98fbf74208e28", "committedDate": "2020-11-20T15:23:12Z", "message": "Close health check"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "718fbc7ac3da2fd342d30fc491d9d434ab4bccff", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/718fbc7ac3da2fd342d30fc491d9d434ab4bccff", "committedDate": "2020-11-20T15:23:12Z", "message": "Close more health checks"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1295b4f0710f9774f7139712e95e9310bf67a91b", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/1295b4f0710f9774f7139712e95e9310bf67a91b", "committedDate": "2020-11-20T15:23:12Z", "message": "Remove locks to make problems more apparent"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "06ab704fde72a108c1c63445702e20f2c71d7328", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/06ab704fde72a108c1c63445702e20f2c71d7328", "committedDate": "2020-11-20T15:23:47Z", "message": "Merge branch 'develop' into feature/3917/CircleCICleanup"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "989a04f0d7651ad123a0bd3a83d29ca695ef6296", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/989a04f0d7651ad123a0bd3a83d29ca695ef6296", "committedDate": "2020-11-20T15:16:34Z", "message": "Don't use cache for unit tests to maybe avoid PGP error"}, "afterCommit": {"oid": "06ab704fde72a108c1c63445702e20f2c71d7328", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/06ab704fde72a108c1c63445702e20f2c71d7328", "committedDate": "2020-11-20T15:23:47Z", "message": "Merge branch 'develop' into feature/3917/CircleCICleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "27f5f26d2d85b6d8f4d303b3fe20d2dd8539ecb3", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/27f5f26d2d85b6d8f4d303b3fe20d2dd8539ecb3", "committedDate": "2020-11-20T15:50:14Z", "message": "Remove all caching from unit tests for PGP debug"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3ebebd76be02000c4e4988510963584842781bc1", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/3ebebd76be02000c4e4988510963584842781bc1", "committedDate": "2020-11-20T18:37:58Z", "message": "Make it smaller so there's more time to release connections"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d81e91027ed7f3a422809b6515bd3712aa71678e", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/d81e91027ed7f3a422809b6515bd3712aa71678e", "committedDate": "2020-11-20T19:41:58Z", "message": "Disable PGP for now"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "f6f2d6db8d2dac99c813eb9de8d16af42f2853a6", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/f6f2d6db8d2dac99c813eb9de8d16af42f2853a6", "committedDate": "2020-11-20T22:13:57Z", "message": "Sleep while waiting for connections to die"}, "afterCommit": {"oid": "3d8b23989a6780f11e917fc33f6639fb2fa6afe0", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/3d8b23989a6780f11e917fc33f6639fb2fa6afe0", "committedDate": "2020-11-20T22:41:12Z", "message": "Sleep while waiting for connections to die"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "c9f18d1d0f1879b493daa6cdd12c898a4c37cd94", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/c9f18d1d0f1879b493daa6cdd12c898a4c37cd94", "committedDate": "2020-11-21T00:04:10Z", "message": "Even smaller machine"}, "afterCommit": {"oid": "3516e0b5a93dfb272876442159970b6667149599", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/3516e0b5a93dfb272876442159970b6667149599", "committedDate": "2020-11-21T02:11:17Z", "message": "Increase max connections, revert everything else"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "b53ada79085f9b43248dcd0e3074e188cb642f83", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/b53ada79085f9b43248dcd0e3074e188cb642f83", "committedDate": "2020-11-21T03:40:12Z", "message": "Try another way"}, "afterCommit": {"oid": "870bf58a602004b7e79fe4e95839f00eba1d4235", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/870bf58a602004b7e79fe4e95839f00eba1d4235", "committedDate": "2020-11-21T04:30:55Z", "message": "Increase max connections"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "870bf58a602004b7e79fe4e95839f00eba1d4235", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/870bf58a602004b7e79fe4e95839f00eba1d4235", "committedDate": "2020-11-21T04:30:55Z", "message": "Increase max connections"}, "afterCommit": {"oid": "9a9bea1286b52237ed9f7c891011ce8c147886c9", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/9a9bea1286b52237ed9f7c891011ce8c147886c9", "committedDate": "2020-11-21T06:04:58Z", "message": "Increase max connections"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9e354bb43469c6e1af5d24bdd5a04563f30f9631", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/9e354bb43469c6e1af5d24bdd5a04563f30f9631", "committedDate": "2020-11-21T07:01:48Z", "message": "Increase max connections"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "9a9bea1286b52237ed9f7c891011ce8c147886c9", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/9a9bea1286b52237ed9f7c891011ce8c147886c9", "committedDate": "2020-11-21T06:04:58Z", "message": "Increase max connections"}, "afterCommit": {"oid": "9e354bb43469c6e1af5d24bdd5a04563f30f9631", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/9e354bb43469c6e1af5d24bdd5a04563f30f9631", "committedDate": "2020-11-21T07:01:48Z", "message": "Increase max connections"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2NjYxNTI3", "url": "https://github.com/dockstore/dockstore/pull/3939#pullrequestreview-536661527", "createdAt": "2020-11-23T16:49:12Z", "commit": {"oid": "9e354bb43469c6e1af5d24bdd5a04563f30f9631"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2ODg0NzM4", "url": "https://github.com/dockstore/dockstore/pull/3939#pullrequestreview-536884738", "createdAt": "2020-11-23T22:10:56Z", "commit": {"oid": "9e354bb43469c6e1af5d24bdd5a04563f30f9631"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMjoxMDo1NlrOH4hWZg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yM1QyMjoxMDo1NlrOH4hWZg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTAyODcxMA==", "bodyText": "I must have missed this in the previous review, but do the instructions for updating the confidential file mention this file? Or maybe a comment in encrypt.sh\nDigression: it would be nicer if the zip didn't have the nested directory, then you wouldn't need to specify the folder as a second param. But that's way out of scope, and there are possibly issues doing it that way.", "url": "https://github.com/dockstore/dockstore/pull/3939#discussion_r529028710", "createdAt": "2020-11-23T22:10:56Z", "author": {"login": "coverbeck"}, "path": ".circleci/config.yml", "diffHunk": "@@ -279,31 +278,15 @@ commands:\n       - run:\n           name: install pip dependencies\n           command: scripts/install-tests.sh\n-      - run:\n-          name: Install postgresql client\n-          command: |\n-            sudo rm -rf /var/lib/apt/lists/*\n-            sudo apt update\n-            sudo apt install -y postgresql-client\n-      - run:\n-          name: decrypt\n-          command: |\n-            sudo apt install openssl -y\n-            openssl aes-256-cbc -d -in circle_ci_test_data.zip.enc -k $CIRCLE_CI_KEY -iv $CIRCLE_CI_IV >> test_data.zip\n-            bash expand_confidential_bundle.sh test_data.zip abandonDatabaseConnectionsWithOrcid            \n       - run:\n           name: expand confidential data\n           command: |\n             bash expand_confidential_bundle.sh test_data.zip abandonDatabaseConnectionsWithOrcid ", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9e354bb43469c6e1af5d24bdd5a04563f30f9631"}, "originalPosition": 251}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM2OTEwNjE1", "url": "https://github.com/dockstore/dockstore/pull/3939#pullrequestreview-536910615", "createdAt": "2020-11-23T22:57:20Z", "commit": {"oid": "9e354bb43469c6e1af5d24bdd5a04563f30f9631"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1631, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}