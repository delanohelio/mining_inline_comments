{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzkzNzUxMjQ3", "number": 3347, "title": "Fix up 1.9.0 migration for new parentid", "bodyText": "We might also be generating openapi slightly differently in develop?", "createdAt": "2020-03-25T18:20:28Z", "url": "https://github.com/dockstore/dockstore/pull/3347", "merged": true, "mergeCommit": {"oid": "32526f0012d6fb9e06bd88934f800076522487e7"}, "closed": true, "closedAt": "2020-03-27T00:12:29Z", "author": {"login": "denis-yuen"}, "timelineItems": {"totalCount": 7, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcRLrcQAH2gAyMzkzNzUxMjQ3OjRkNmI5NmE4NGQ4NjAyNDE5MWJhZjEzNzc4ZjlkYmFkZjlhNWNkYmM=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcRlKXKAFqTM4MjQ5OTc4OA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "4d6b96a84d86024191baf13778f9dbadf9a5cdbc", "author": {"user": {"login": "denis-yuen", "name": "Denis Yuen"}}, "url": "https://github.com/dockstore/dockstore/commit/4d6b96a84d86024191baf13778f9dbadf9a5cdbc", "committedDate": "2020-03-25T18:19:12Z", "message": "Seems to work locally"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgxNDk1MDM0", "url": "https://github.com/dockstore/dockstore/pull/3347#pullrequestreview-381495034", "createdAt": "2020-03-25T20:06:02Z", "commit": {"oid": "4d6b96a84d86024191baf13778f9dbadf9a5cdbc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b571e4c1364d1333937c08f46c6e9b5834e60b28", "author": {"user": {"login": "denis-yuen", "name": "Denis Yuen"}}, "url": "https://github.com/dockstore/dockstore/commit/b571e4c1364d1333937c08f46c6e9b5834e60b28", "committedDate": "2020-03-26T19:02:43Z", "message": "Revert \"Switch to postgres 11.6 (#3285)\"\n\nThis reverts commit 135d3687c1fc4721ea630d3108a2530cb24b43cf."}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4aa934fd66185f6cc7b7d3c38e89f993201d2bdc", "author": {"user": {"login": "denis-yuen", "name": "Denis Yuen"}}, "url": "https://github.com/dockstore/dockstore/commit/4aa934fd66185f6cc7b7d3c38e89f993201d2bdc", "committedDate": "2020-03-26T21:18:33Z", "message": "Try this temporarily"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDc3NjM4", "url": "https://github.com/dockstore/dockstore/pull/3347#pullrequestreview-382477638", "createdAt": "2020-03-26T22:58:53Z", "commit": {"oid": "4aa934fd66185f6cc7b7d3c38e89f993201d2bdc"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMjo1ODo1M1rOF8ddjg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yNlQyMjo1ODo1M1rOF8ddjg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk0MTU4Mg==", "bodyText": "FYI @agduncan94  looks like handleGitHubRelease might be creating duplicates", "url": "https://github.com/dockstore/dockstore/pull/3347#discussion_r398941582", "createdAt": "2020-03-26T22:58:53Z", "author": {"login": "denis-yuen"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/webservice/WebhookIT.java", "diffHunk": "@@ -97,10 +97,14 @@ public void testWorkflowMigration() throws Exception {\n         // Refresh should work\n         workflow = workflowApi.refresh(workflow.getId());\n         assertEquals(\"Workflow should be FULL mode\", Workflow.ModeEnum.FULL, workflow.getMode());\n-        assertTrue(\"All versions should be legacy\", workflow.getWorkflowVersions().stream().allMatch(workflowVersion -> workflowVersion.isLegacyVersion()));\n+        assertTrue(\"All versions should be legacy\", workflow.getWorkflowVersions().stream().allMatch(WorkflowVersion::isLegacyVersion));\n+\n+        // seems like handleGitHubRelease has issue with versions that already exist\n+        testingPostgres.runUpdateStatement(\"delete from workflowversion where parentid = \" + workflow.getId());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "4aa934fd66185f6cc7b7d3c38e89f993201d2bdc"}, "originalPosition": 8}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDc5MjA5", "url": "https://github.com/dockstore/dockstore/pull/3347#pullrequestreview-382479209", "createdAt": "2020-03-26T23:02:50Z", "commit": {"oid": "4aa934fd66185f6cc7b7d3c38e89f993201d2bdc"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzgyNDk5Nzg4", "url": "https://github.com/dockstore/dockstore/pull/3347#pullrequestreview-382499788", "createdAt": "2020-03-27T00:00:26Z", "commit": {"oid": "4aa934fd66185f6cc7b7d3c38e89f993201d2bdc"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QwMDowMDoyNlrOF8esNw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMy0yN1QwMDowMDoyNlrOF8esNw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk2MTcxOQ==", "bodyText": "Andrew and I were looking at this and I'm trying to fix.", "url": "https://github.com/dockstore/dockstore/pull/3347#discussion_r398961719", "createdAt": "2020-03-27T00:00:26Z", "author": {"login": "coverbeck"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/webservice/WebhookIT.java", "diffHunk": "@@ -97,10 +97,14 @@ public void testWorkflowMigration() throws Exception {\n         // Refresh should work\n         workflow = workflowApi.refresh(workflow.getId());\n         assertEquals(\"Workflow should be FULL mode\", Workflow.ModeEnum.FULL, workflow.getMode());\n-        assertTrue(\"All versions should be legacy\", workflow.getWorkflowVersions().stream().allMatch(workflowVersion -> workflowVersion.isLegacyVersion()));\n+        assertTrue(\"All versions should be legacy\", workflow.getWorkflowVersions().stream().allMatch(WorkflowVersion::isLegacyVersion));\n+\n+        // seems like handleGitHubRelease has issue with versions that already exist\n+        testingPostgres.runUpdateStatement(\"delete from workflowversion where parentid = \" + workflow.getId());", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODk0MTU4Mg=="}, "originalCommit": {"oid": "4aa934fd66185f6cc7b7d3c38e89f993201d2bdc"}, "originalPosition": 8}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1852, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}