{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NTI2MTE0ODE4", "number": 3943, "title": "Feature/seab 315/confidential bundle", "bodyText": "The usual place where we store the unencrypted test confidential data is probably not necessary since it should be easy enough to decrypt locally now.\nInstructions:\nHave the CIRCLE_CI_KEY and CIRCLE_CI_IV environment variables (find it in the usual credentials location). You're going to want to set it permanently\nbash encrypt.sh to encrypt (the circle_ci_test_data.zip.enc will then be updated, you'll need to Git add + commit it)\nbash scripts/decrypt.sh to decrypt (the files will automatically move to the right places)\ndoesn't get too much easier than that\nCons:\n\nthe confidential files are no longer in a flattened structure, the original directory structure is maintained (dockstore-integration-testing/src/test/resources/dockstore.yml) so that the expand_bundle script is not needed.\nthe directory name (abandonDatabaseConnectionsWithOrcid) which gives a hint on the last change is now removed, so check the Git history of the circle_ci_test_data.zip.enc to see what changed.", "createdAt": "2020-11-24T01:36:16Z", "url": "https://github.com/dockstore/dockstore/pull/3943", "merged": true, "mergeCommit": {"oid": "25fc6f112a19466d00a510797f177f6727da4630"}, "closed": true, "closedAt": "2020-11-27T15:35:15Z", "author": {"login": "garyluu"}, "timelineItems": {"totalCount": 13, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdfdd4DAH2gAyNTI2MTE0ODE4OjQ4ODQ0MzA0YmE1MDk0Yzc5ODdkZmRjOWEwYTllZDkwNjE1YjE1ZmE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdgYX3WAH2gAyNTI2MTE0ODE4OjM2NjI1N2VmMWYxMDAwMzUwNmQxNTRkMzBiNGZkOTJmMTBlYWRlYTg=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "48844304ba5094c7987dfdc9a0a9ed90615b15fa", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/48844304ba5094c7987dfdc9a0a9ed90615b15fa", "committedDate": "2020-11-23T23:08:46Z", "message": "initial test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "37bbf53761803656d1c00bed6b2c41406931e6a4", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/37bbf53761803656d1c00bed6b2c41406931e6a4", "committedDate": "2020-11-23T23:40:21Z", "message": "Shell check, add comments"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "174000d41effd15c71ce40506f6b1c38b928463f", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/174000d41effd15c71ce40506f6b1c38b928463f", "committedDate": "2020-11-23T23:44:42Z", "message": "Fix Travis decrypt"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c6062afe83580f206805528682e85db93dca0e4a", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/c6062afe83580f206805528682e85db93dca0e4a", "committedDate": "2020-11-24T00:15:06Z", "message": "Upload partial non-confidential Dropwizard yml file"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9084f604635eee4759cc8d4e27b76d83dd57f04c", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/9084f604635eee4759cc8d4e27b76d83dd57f04c", "committedDate": "2020-11-24T00:56:57Z", "message": "Fix some deprecated GitHub library accessors"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d2c46ecdffc24afb0c8f4252bf0c8e8bd3cf7225", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/d2c46ecdffc24afb0c8f4252bf0c8e8bd3cf7225", "committedDate": "2020-11-24T00:57:58Z", "message": "Delete after expanding test data"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "be43cf47bdb22afae562da544595c5c1779a9169", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/be43cf47bdb22afae562da544595c5c1779a9169", "committedDate": "2020-11-24T15:51:45Z", "message": "Add comment"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NzM3MzQ3", "url": "https://github.com/dockstore/dockstore/pull/3943#pullrequestreview-537737347", "createdAt": "2020-11-24T17:17:11Z", "commit": {"oid": "be43cf47bdb22afae562da544595c5c1779a9169"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "f0f0a5b8edc138205e8666e46c7aff842011d13f", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/f0f0a5b8edc138205e8666e46c7aff842011d13f", "committedDate": "2020-11-24T17:59:08Z", "message": "Check variables before running script"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3Nzc4MDU2", "url": "https://github.com/dockstore/dockstore/pull/3943#pullrequestreview-537778056", "createdAt": "2020-11-24T18:06:43Z", "commit": {"oid": "be43cf47bdb22afae562da544595c5c1779a9169"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM3NzkwMTE3", "url": "https://github.com/dockstore/dockstore/pull/3943#pullrequestreview-537790117", "createdAt": "2020-11-24T18:22:50Z", "commit": {"oid": "f0f0a5b8edc138205e8666e46c7aff842011d13f"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxODoyMjo1MFrOH5Pq4g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0xMS0yNFQxODoyNDoxMlrOH5PuPg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTc4NzYxOA==", "bodyText": "For my understanding, the other confidential files like config_file, confidential1_1.5.0 are being expanded out to their final locations?", "url": "https://github.com/dockstore/dockstore/pull/3943#discussion_r529787618", "createdAt": "2020-11-24T18:22:50Z", "author": {"login": "denis-yuen"}, "path": "scripts/decrypt.sh", "diffHunk": "@@ -1,13 +1,20 @@\n #!/usr/bin/env bash\n-# This script decrypts our test database \n-# WARNING: Edit decrypt.template.mustache not decrypt.sh which is a generated file\n+# This script decrypts our test database\n # Bash3 Boilerplate. Copyright (c) 2014, kvz.io\n+# You will need the environment variables CIRCLE_CI_KEY and CIRCLE_CI_IV\n \n set -o errexit\n set -o pipefail\n set -o nounset\n set -o xtrace\n \n-openssl aes-256-cbc -K $encrypted_f3e772af0e32_key -iv $encrypted_f3e772af0e32_iv -in secrets.tar.enc -out secrets.tar -d\n+: \"$CIRCLE_CI_KEY\"\n+: \"$CIRCLE_CI_IV\"\n+\n+openssl aes-256-cbc -d -in circle_ci_test_data.zip.enc -k \"$CIRCLE_CI_KEY\" -iv \"$CIRCLE_CI_IV\" -out secrets.tar\n tar xvf secrets.tar", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0f0a5b8edc138205e8666e46c7aff842011d13f"}, "originalPosition": 18}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTc4ODQ3OA==", "bodyText": "The old approach had different keys when a new confidential bundle was uploaded.\nWhat is the strategy when someone wants to work on a new bundle in a branch but other builds need to use the old bundle?", "url": "https://github.com/dockstore/dockstore/pull/3943#discussion_r529788478", "createdAt": "2020-11-24T18:24:12Z", "author": {"login": "denis-yuen"}, "path": "scripts/decrypt.sh", "diffHunk": "@@ -1,13 +1,20 @@\n #!/usr/bin/env bash\n-# This script decrypts our test database \n-# WARNING: Edit decrypt.template.mustache not decrypt.sh which is a generated file\n+# This script decrypts our test database\n # Bash3 Boilerplate. Copyright (c) 2014, kvz.io\n+# You will need the environment variables CIRCLE_CI_KEY and CIRCLE_CI_IV\n \n set -o errexit\n set -o pipefail\n set -o nounset\n set -o xtrace\n \n-openssl aes-256-cbc -K $encrypted_f3e772af0e32_key -iv $encrypted_f3e772af0e32_iv -in secrets.tar.enc -out secrets.tar -d", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "f0f0a5b8edc138205e8666e46c7aff842011d13f"}, "originalPosition": 13}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5NTI4MjQy", "url": "https://github.com/dockstore/dockstore/pull/3943#pullrequestreview-539528242", "createdAt": "2020-11-26T19:46:26Z", "commit": {"oid": "f0f0a5b8edc138205e8666e46c7aff842011d13f"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestCommit", "commit": {"oid": "366257ef1f10003506d154d30b4fd92f10eadea8", "author": {"user": {"login": "denis-yuen", "name": "Denis Yuen"}}, "url": "https://github.com/dockstore/dockstore/commit/366257ef1f10003506d154d30b4fd92f10eadea8", "committedDate": "2020-11-26T19:46:36Z", "message": "Merge branch 'develop' into feature/SEAB-315/confidentialBundle"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1636, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}