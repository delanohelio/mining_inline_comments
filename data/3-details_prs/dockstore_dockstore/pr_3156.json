{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzYzNzU5MDc2", "number": 3156, "title": "Feature/add version to event", "bodyText": "For #3045\nAdding version information and a separate event for each new tag (not all versions)\nNot sure if this is 1.9.0 or 1.8.0.  If it's 1.9.0, need to handle version events missing version information", "createdAt": "2020-01-16T17:21:25Z", "url": "https://github.com/dockstore/dockstore/pull/3156", "merged": true, "mergeCommit": {"oid": "b84804990f1ef4c567661d1825034e8d3f03d780"}, "closed": true, "closedAt": "2020-01-29T21:03:23Z", "author": {"login": "garyluu"}, "timelineItems": {"totalCount": 25, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABb69sKbgBqjI5NTU0NDYzMTY=", "endCursor": "Y3Vyc29yOnYyOpPPAAABb_G7sBgBqjI5ODk3NDk1NDM=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "10e3a45921d31746981fe24ef7c8b65e2216e913", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/10e3a45921d31746981fe24ef7c8b65e2216e913", "committedDate": "2020-01-16T16:23:41Z", "message": "Update swagger/openapi"}, "afterCommit": {"oid": "e8361c003b9de44ace2427f4db5358b40b3045a2", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/e8361c003b9de44ace2427f4db5358b40b3045a2", "committedDate": "2020-01-16T17:34:43Z", "message": "Add test"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0MTg0ODE3", "url": "https://github.com/dockstore/dockstore/pull/3156#pullrequestreview-344184817", "createdAt": "2020-01-16T20:11:00Z", "commit": {"oid": "e8361c003b9de44ace2427f4db5358b40b3045a2"}, "state": "DISMISSED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ0ODQzNTM3", "url": "https://github.com/dockstore/dockstore/pull/3156#pullrequestreview-344843537", "createdAt": "2020-01-17T21:11:08Z", "commit": {"oid": "e8361c003b9de44ace2427f4db5358b40b3045a2"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QyMToxMTowOFrOFfFXHw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0xN1QyMToyMzoxOVrOFfFmXQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzODAxNQ==", "bodyText": "Nitpick: easier to read using isEmpty", "url": "https://github.com/dockstore/dockstore/pull/3156#discussion_r368138015", "createdAt": "2020-01-17T21:11:08Z", "author": {"login": "denis-yuen"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/BasicIT.java", "diffHunk": "@@ -249,18 +249,19 @@ public void testVersionTagDockerhub() {\n         starRequest.setStar(true);\n         toolsApi.starEntry(tool.getId(), starRequest);\n         events = eventsApi.getEvents(EventSearchType.STARRED_ENTRIES.toString(), 10, 0);\n-        Assert.assertEquals(\"Should be an event for the tag that was automatically created for the newly registered tool\", 1, events.size());\n+        Assert.assertEquals(\"Should not be an event for the non-tag version that was automatically created for the newly registered tool\", 0, events.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8361c003b9de44ace2427f4db5358b40b3045a2"}, "originalPosition": 5}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODEzODA2Mw==", "bodyText": "Ditto", "url": "https://github.com/dockstore/dockstore/pull/3156#discussion_r368138063", "createdAt": "2020-01-17T21:11:18Z", "author": {"login": "denis-yuen"}, "path": "dockstore-integration-testing/src/test/java/io/dockstore/client/cli/BasicIT.java", "diffHunk": "@@ -1393,7 +1394,7 @@ public void eventResourcePaginationTest() {\n         starRequest.setStar(true);\n         toolsApi.starEntry(tool.getId(), starRequest);\n         events = eventsApi.getEvents(EventSearchType.STARRED_ENTRIES.toString(), 10, 0);\n-        Assert.assertEquals(\"Should be an event for the tag that was automatically created for the newly registered tool\", 1, events.size());\n+        Assert.assertEquals(\"Should not be an event for the non-tag version that was automatically created for the newly registered tool\", 0, events.size());", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8361c003b9de44ace2427f4db5358b40b3045a2"}, "originalPosition": 27}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODE0MTgyMg==", "bodyText": "Avoid this change", "url": "https://github.com/dockstore/dockstore/pull/3156#discussion_r368141822", "createdAt": "2020-01-17T21:23:05Z", "author": {"login": "denis-yuen"}, "path": "dockstore-webservice/src/main/resources/openapi.yaml", "diffHunk": "@@ -6682,17 +6682,184 @@ components:\n         content:\n           type: string\n     BioWorkflow:\n-      allOf:\n-        - $ref: \"#/components/schemas/Workflow\"\n-        - type: object\n-          properties:\n-            parent_id:\n-              type: integer\n-              format: int64\n-              readOnly: true\n-            is_checker:\n-              type: boolean\n-          description: This describes one workflow in the dockstore\n+      type: object", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8361c003b9de44ace2427f4db5358b40b3045a2"}, "originalPosition": 15}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODE0MTkxNw==", "bodyText": "Ditto", "url": "https://github.com/dockstore/dockstore/pull/3156#discussion_r368141917", "createdAt": "2020-01-17T21:23:19Z", "author": {"login": "denis-yuen"}, "path": "dockstore-webservice/src/main/resources/swagger.yaml", "diffHunk": "@@ -6262,18 +6262,209 @@ definitions:\n       content:\n         type: \"string\"\n   BioWorkflow:\n-    allOf:\n-    - $ref: \"#/definitions/Workflow\"\n-    - type: \"object\"\n-      properties:\n-        parent_id:\n-          type: \"integer\"\n-          format: \"int64\"\n-          readOnly: true\n-        is_checker:\n-          type: \"boolean\"\n-          position: 23\n-      description: \"This describes one workflow in the dockstore\"\n+    type: \"object\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "e8361c003b9de44ace2427f4db5358b40b3045a2"}, "originalPosition": 16}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "e8361c003b9de44ace2427f4db5358b40b3045a2", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/e8361c003b9de44ace2427f4db5358b40b3045a2", "committedDate": "2020-01-16T17:34:43Z", "message": "Add test"}, "afterCommit": {"oid": "60b818c6f6c74dbfaa3ec6e65f4bdc265138e783", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/60b818c6f6c74dbfaa3ec6e65f4bdc265138e783", "committedDate": "2020-01-20T15:33:17Z", "message": "Update openapi/swagger"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ1MzkwMjIy", "url": "https://github.com/dockstore/dockstore/pull/3156#pullrequestreview-345390222", "createdAt": "2020-01-20T15:38:26Z", "commit": {"oid": "60b818c6f6c74dbfaa3ec6e65f4bdc265138e783"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNTozODoyN1rOFfiM8Q==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yMFQxNTozODoyN1rOFfiM8Q==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODYxMDU0NQ==", "bodyText": "Think this needs @JsonIgnoreProperties like the others", "url": "https://github.com/dockstore/dockstore/pull/3156#discussion_r368610545", "createdAt": "2020-01-20T15:38:27Z", "author": {"login": "denis-yuen"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/core/Event.java", "diffHunk": "@@ -80,6 +80,11 @@\n     @ApiModelProperty(value = \"User initiating the event.\", position = 6)\n     private User initiatorUser;\n \n+    @ManyToOne", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "60b818c6f6c74dbfaa3ec6e65f4bdc265138e783"}, "originalPosition": 4}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "88314c47ba405b46cd1cdc03befecbabbbec76a7", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/88314c47ba405b46cd1cdc03befecbabbbec76a7", "committedDate": "2020-01-20T17:09:32Z", "message": "Move migration to 1.9.0"}, "afterCommit": {"oid": "c0e447fc33404adbeca3020c0b222656331da872", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/c0e447fc33404adbeca3020c0b222656331da872", "committedDate": "2020-01-20T17:15:26Z", "message": "Move migration to 1.9.0"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "93d607278a3eb46ac8cc5dc02f05f5551de0b210", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/93d607278a3eb46ac8cc5dc02f05f5551de0b210", "committedDate": "2020-01-20T17:28:47Z", "message": "Update openapi3"}, "afterCommit": {"oid": "673cf010897619742cef11dc87e47b4283d07e74", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/673cf010897619742cef11dc87e47b4283d07e74", "committedDate": "2020-01-20T18:26:29Z", "message": "Update openapi3"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "673cf010897619742cef11dc87e47b4283d07e74", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/673cf010897619742cef11dc87e47b4283d07e74", "committedDate": "2020-01-20T18:26:29Z", "message": "Update openapi3"}, "afterCommit": {"oid": "849ef695fd30b66f0f902aa84b997f0b286e258c", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/849ef695fd30b66f0f902aa84b997f0b286e258c", "committedDate": "2020-01-24T19:47:33Z", "message": "Update swagger/openapi"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "8ee969fc9d3c3df99321cc15d4c42ad0bcf7b91f", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/8ee969fc9d3c3df99321cc15d4c42ad0bcf7b91f", "committedDate": "2020-01-24T20:45:31Z", "message": "Remove version related events without versions"}, "afterCommit": {"oid": "d4488c5e7c2ec1d6071339f479496e365db8463d", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/d4488c5e7c2ec1d6071339f479496e365db8463d", "committedDate": "2020-01-24T20:46:09Z", "message": "Remove version related events without versions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ4MjM0MTQ1", "url": "https://github.com/dockstore/dockstore/pull/3156#pullrequestreview-348234145", "createdAt": "2020-01-24T21:26:57Z", "commit": {"oid": "d4488c5e7c2ec1d6071339f479496e365db8463d"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQyMToyNjo1OFrOFhq37g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yNFQyMToyNjo1OFrOFhq37g==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDg0OTc3NA==", "bodyText": "Should the 3rd param by byId instead of tag? Don't know Hibernate well enough to say if it matters.\nIn DockerRepoTagResource, you use byId.", "url": "https://github.com/dockstore/dockstore/pull/3156#discussion_r370849774", "createdAt": "2020-01-24T21:26:58Z", "author": {"login": "coverbeck"}, "path": "dockstore-webservice/src/main/java/io/dockstore/webservice/resources/DockerRepoResource.java", "diffHunk": "@@ -499,15 +498,15 @@ public Tool registerManual(@ApiParam(hidden = true) @Auth User user,\n         if (tool.isPrivateAccess() && Strings.isNullOrEmpty(tool.getToolMaintainerEmail())) {\n             throw new CustomWebApplicationException(\"Tool maintainer email is required for private tools.\", HttpStatus.SC_BAD_REQUEST);\n         }\n-        boolean releaseCreated = false;\n         // populate user in tool\n         tool.addUser(user);\n         // create dependent Tags before creating tool\n         Set<Tag> createdTags = new HashSet<>();\n         for (Tag tag : tool.getWorkflowVersions()) {\n             final long l = tagDAO.create(tag);\n-            createdTags.add(tagDAO.findById(l));\n-            releaseCreated = true;\n+            Tag byId = tagDAO.findById(l);\n+            createdTags.add(byId);\n+            this.eventDAO.createAddTagToEntryEvent(user, tool, tag);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "d4488c5e7c2ec1d6071339f479496e365db8463d"}, "originalPosition": 23}]}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d4488c5e7c2ec1d6071339f479496e365db8463d", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/d4488c5e7c2ec1d6071339f479496e365db8463d", "committedDate": "2020-01-24T20:46:09Z", "message": "Remove version related events without versions"}, "afterCommit": {"oid": "11d0dbb47e124b61798f06317fb839368c644860", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/11d0dbb47e124b61798f06317fb839368c644860", "committedDate": "2020-01-24T21:34:28Z", "message": "Remove version related events without versions"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5NTI4MTQ2", "url": "https://github.com/dockstore/dockstore/pull/3156#pullrequestreview-349528146", "createdAt": "2020-01-28T16:40:15Z", "commit": {"oid": "6f8e0d4a29c533734311d25c9d2847a920cd7469"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzQ5NTI5OTAw", "url": "https://github.com/dockstore/dockstore/pull/3156#pullrequestreview-349529900", "createdAt": "2020-01-28T16:42:26Z", "commit": {"oid": "6f8e0d4a29c533734311d25c9d2847a920cd7469"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "6f8e0d4a29c533734311d25c9d2847a920cd7469", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/6f8e0d4a29c533734311d25c9d2847a920cd7469", "committedDate": "2020-01-24T21:36:24Z", "message": "PR change"}, "afterCommit": {"oid": "ccab1840cc8806999d387f198ce2490fae179157", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/ccab1840cc8806999d387f198ce2490fae179157", "committedDate": "2020-01-28T16:46:59Z", "message": "Update swagger/openapi"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0046bbcc6de1d025085fe3eb09f7b8a6abf1210c", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/0046bbcc6de1d025085fe3eb09f7b8a6abf1210c", "committedDate": "2020-01-29T14:33:01Z", "message": "Add version information, only create event for tags"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d5c0dfc7a355220d25ac26ff71a3e14451b2cf59", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/d5c0dfc7a355220d25ac26ff71a3e14451b2cf59", "committedDate": "2020-01-29T14:33:01Z", "message": "Add migration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9701e872e46cba881ec06766ee9b8b93bca56443", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/9701e872e46cba881ec06766ee9b8b93bca56443", "committedDate": "2020-01-29T14:33:01Z", "message": "Add test"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "50c1801112ea294c278163d0ff22324616f3321a", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/50c1801112ea294c278163d0ff22324616f3321a", "committedDate": "2020-01-29T14:33:01Z", "message": "Fix unused variable"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "3bf9ad6475744ac9d11f50e6e8be053f4c5f1290", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/3bf9ad6475744ac9d11f50e6e8be053f4c5f1290", "committedDate": "2020-01-29T14:33:01Z", "message": "Test cleanup"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fc4a0eb390f351f2eadf1bfe1e0da31bf6af0946", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/fc4a0eb390f351f2eadf1bfe1e0da31bf6af0946", "committedDate": "2020-01-29T14:33:01Z", "message": "Remove all collections from Event versions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d3a5fe085aac494ba86ebc807e00a06444f72b97", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/d3a5fe085aac494ba86ebc807e00a06444f72b97", "committedDate": "2020-01-29T14:33:01Z", "message": "Move migration to 1.9.0"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "deeecdb743ec72585e9f525c815b408c2b3df373", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/deeecdb743ec72585e9f525c815b408c2b3df373", "committedDate": "2020-01-29T14:33:01Z", "message": "Remove version related events without versions"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "c8ebbb9d706d2a1e89971ea4d6329b648620188f", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/c8ebbb9d706d2a1e89971ea4d6329b648620188f", "committedDate": "2020-01-29T14:33:01Z", "message": "PR change"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "675e04865d7de97bb3fdb04d3ba0b55a80e81b38", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/675e04865d7de97bb3fdb04d3ba0b55a80e81b38", "committedDate": "2020-01-29T14:36:40Z", "message": "Update swagger/openapi"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "ccab1840cc8806999d387f198ce2490fae179157", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/ccab1840cc8806999d387f198ce2490fae179157", "committedDate": "2020-01-28T16:46:59Z", "message": "Update swagger/openapi"}, "afterCommit": {"oid": "675e04865d7de97bb3fdb04d3ba0b55a80e81b38", "author": {"user": {"login": "garyluu", "name": "Gary Luu"}}, "url": "https://github.com/dockstore/dockstore/commit/675e04865d7de97bb3fdb04d3ba0b55a80e81b38", "committedDate": "2020-01-29T14:36:40Z", "message": "Update swagger/openapi"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 1869, "cost": 1, "resetAt": "2021-11-01T13:51:04Z"}}}