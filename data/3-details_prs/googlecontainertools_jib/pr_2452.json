{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDEzNzkyMTU0", "number": 2452, "title": "Add maven extra directory target configuration", "bodyText": "Maven side of #1581. Adds the following to Maven extra directory configuration:\n<extraDirectories>\n  <paths>\n    <path>\n      <from>source/directory</from>\n      <into>/target/directory</into>\n    </path>\n    <path>old/shorthand/also/works</path>\n  </paths>\n</extraDirectories>\n\nI totally forgot set() was a thing, so this ended up not being as messy as I thought it would be.", "createdAt": "2020-05-05T22:53:38Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2452", "merged": true, "mergeCommit": {"oid": "02ece43ce36c2ab9c66223cb46a7059774164674"}, "closed": true, "closedAt": "2020-05-06T18:36:04Z", "author": {"login": "TadCordle"}, "timelineItems": {"totalCount": 15, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABccF9rDgH2gAyNDEzNzkyMTU0OjY1NDhjNzVlZmVmZTNmYTc5M2M2ZGMzYjdmZDFiNDRiMzZkMzU0N2U=", "endCursor": "Y3Vyc29yOnYyOpPPAAABces2SoAH2gAyNDEzNzkyMTU0OmEyZDk1MDY4YmQyYTkxYWNjZjYyMTdlMTNjOTZhODJiZTc4YmIxYzI=", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6548c75efefe3fa793c6dc3b7fd1b44b36d3547e", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/6548c75efefe3fa793c6dc3b7fd1b44b36d3547e", "committedDate": "2020-04-28T15:52:51Z", "message": "Minor refactoring to prepare for extra directory targets"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "48dc792779ffd77ecc8c54a7539ae08559818292", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/48dc792779ffd77ecc8c54a7539ae08559818292", "committedDate": "2020-04-28T15:57:59Z", "message": "Merge branch 'master' of github.com:GoogleContainerTools/jib into 1581-extra-dir-target-refactor"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "b1dd2fe6c8afcb2b1934d42435cc0b516c742465", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/b1dd2fe6c8afcb2b1934d42435cc0b516c742465", "committedDate": "2020-05-05T19:18:20Z", "message": "Merge branch 'master' of github.com:GoogleContainerTools/jib into i1581-extra-dir-target-maven"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "fe0565e0b73f11cd154e43a93e3c273456ef38b4", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/fe0565e0b73f11cd154e43a93e3c273456ef38b4", "committedDate": "2020-05-05T19:20:20Z", "message": "Merge"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9b0d0e1c3728777b52f9f5596c5182cc1ae22373", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/9b0d0e1c3728777b52f9f5596c5182cc1ae22373", "committedDate": "2020-05-05T19:25:39Z", "message": "Add maven extra directory target configuration"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "068af40b825bba8969fddf3748f6d7bbd128ea4c", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/068af40b825bba8969fddf3748f6d7bbd128ea4c", "committedDate": "2020-05-05T22:09:18Z", "message": "Progress"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "7013fc8c647164288ecfeec5ee9e4328a953b32d", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/7013fc8c647164288ecfeec5ee9e4328a953b32d", "committedDate": "2020-05-05T22:29:13Z", "message": "Fix git/refactor confusion"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "35ceb7f7dd2df8d75c82bb6c6f289828e3fb8e72", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/35ceb7f7dd2df8d75c82bb6c6f289828e3fb8e72", "committedDate": "2020-05-05T22:31:48Z", "message": "More fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "0d9cdee787a44534b99cc7eadf450156aab70ebb", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/0d9cdee787a44534b99cc7eadf450156aab70ebb", "committedDate": "2020-05-05T22:32:38Z", "message": "More fix"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "9046468963609b0c5c972f44cdf6e2adaaf69c74", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/9046468963609b0c5c972f44cdf6e2adaaf69c74", "committedDate": "2020-05-05T22:54:18Z", "message": "Format"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2Nzc0Nzk3", "url": "https://github.com/GoogleContainerTools/jib/pull/2452#pullrequestreview-406774797", "createdAt": "2020-05-06T16:17:18Z", "commit": {"oid": "9046468963609b0c5c972f44cdf6e2adaaf69c74"}, "state": "COMMENTED", "comments": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNjoxNzoxOFrOGRa1BA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxNjoyNTowMFrOGRbJOw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDkxODUzMg==", "bodyText": "I think we can remove unmodifiableList for consistency. It's weird to sometimes return a modifiable list (line 242) and other times an unmodifiable one.", "url": "https://github.com/GoogleContainerTools/jib/pull/2452#discussion_r420918532", "createdAt": "2020-05-06T16:17:18Z", "author": {"login": "chanseokoh"}, "path": "jib-maven-plugin/src/main/java/com/google/cloud/tools/jib/maven/skaffold/FilesMojoV2.java", "diffHunk": "@@ -251,7 +252,17 @@ public void execute() throws MojoExecutionException, MojoFailureException {\n           Xpp3Dom paths = extraDirectoriesConfiguration.getChild(\"paths\");\n           if (paths != null) {\n             // <extraDirectories><paths><path>...</path><path>...</path></paths></extraDirectories>\n-            return xpp3ToList(paths, Paths::get);\n+            // paths can contain either strings or ExtraDirectory objects\n+            List<Path> pathList = new ArrayList<>();\n+            for (Xpp3Dom path : paths.getChildren()) {\n+              Xpp3Dom from = path.getChild(\"from\");\n+              if (from != null) {\n+                pathList.add(Paths.get(from.getValue()));\n+              } else {\n+                pathList.add(Paths.get(path.getValue()));\n+              }\n+            }\n+            return Collections.unmodifiableList(pathList);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9046468963609b0c5c972f44cdf6e2adaaf69c74"}, "originalPosition": 23}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDkyMDU3MA==", "bodyText": "Are we comparing instances of this class? Where? If not, we should probably remove equals and hashCode?", "url": "https://github.com/GoogleContainerTools/jib/pull/2452#discussion_r420920570", "createdAt": "2020-05-06T16:20:28Z", "author": {"login": "chanseokoh"}, "path": "jib-maven-plugin/src/main/java/com/google/cloud/tools/jib/maven/ExtraDirectory.java", "diffHunk": "@@ -0,0 +1,73 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.maven;\n+\n+import java.io.File;\n+import java.nio.file.Path;\n+import java.util.Objects;\n+import org.apache.maven.plugins.annotations.Parameter;\n+\n+/** A bean that configures the source and destination of an extra directory. */\n+public class ExtraDirectory {\n+\n+  @Parameter private File from = new File(\"\");\n+  @Parameter private String into = \"/\";\n+\n+  // Need default constructor for Maven\n+  public ExtraDirectory() {}\n+\n+  public ExtraDirectory(File from, String into) {\n+    this.from = from;\n+    this.into = into;\n+  }\n+\n+  // Allows <path>source</path> shorthand instead of forcing\n+  // <path><from>source</from><into>/</into></path>\n+  public void set(File path) {\n+    this.from = path;\n+    this.into = \"/\";\n+  }\n+\n+  public Path getFrom() {\n+    return from.toPath();\n+  }\n+\n+  public void setFrom(File from) {\n+    this.from = from;\n+  }\n+\n+  String getInto() {\n+    return into;\n+  }\n+\n+  @Override\n+  public boolean equals(Object other) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9046468963609b0c5c972f44cdf6e2adaaf69c74"}, "originalPosition": 58}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDkyMzcwNw==", "bodyText": "Can we name this ExtraDirectoryParameters and move it to JibPluginConfiguration for consistency?", "url": "https://github.com/GoogleContainerTools/jib/pull/2452#discussion_r420923707", "createdAt": "2020-05-06T16:25:00Z", "author": {"login": "chanseokoh"}, "path": "jib-maven-plugin/src/main/java/com/google/cloud/tools/jib/maven/ExtraDirectory.java", "diffHunk": "@@ -0,0 +1,73 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.maven;\n+\n+import java.io.File;\n+import java.nio.file.Path;\n+import java.util.Objects;\n+import org.apache.maven.plugins.annotations.Parameter;\n+\n+/** A bean that configures the source and destination of an extra directory. */\n+public class ExtraDirectory {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "9046468963609b0c5c972f44cdf6e2adaaf69c74"}, "originalPosition": 25}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "4e11ceb2f60c80b9363a50d5869765705f23e600", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/4e11ceb2f60c80b9363a50d5869765705f23e600", "committedDate": "2020-05-06T18:01:22Z", "message": "Feedback and changelog"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "36770d8be18f6fdcf721cb8c96658727c52e468e", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/36770d8be18f6fdcf721cb8c96658727c52e468e", "committedDate": "2020-05-06T18:08:28Z", "message": "Make sure source directory is set"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDA2ODY3MjM1", "url": "https://github.com/GoogleContainerTools/jib/pull/2452#pullrequestreview-406867235", "createdAt": "2020-05-06T18:12:58Z", "commit": {"oid": "36770d8be18f6fdcf721cb8c96658727c52e468e"}, "state": "APPROVED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxODoxMjo1OVrOGRfagg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNS0wNlQxODoxMjo1OVrOGRfagg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDk5MzY2Ng==", "bodyText": "Not necessary, but import ... JibPluginConfiguration.ExtraDirectoryParameters to import the nested type may work?", "url": "https://github.com/GoogleContainerTools/jib/pull/2452#discussion_r420993666", "createdAt": "2020-05-06T18:12:59Z", "author": {"login": "chanseokoh"}, "path": "jib-maven-plugin/src/main/java/com/google/cloud/tools/jib/maven/MojoCommon.java", "diffHunk": "@@ -94,15 +94,25 @@ static void finishUpdateChecker(\n    * @param jibPluginConfiguration the build configuration\n    * @return the list of resolved extra directories\n    */\n-  static List<Path> getExtraDirectories(JibPluginConfiguration jibPluginConfiguration) {\n-    List<Path> paths = jibPluginConfiguration.getExtraDirectories();\n-    if (!paths.isEmpty()) {\n-      return paths;\n+  static List<JibPluginConfiguration.ExtraDirectoryParameters> getExtraDirectories(", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "36770d8be18f6fdcf721cb8c96658727c52e468e"}, "originalPosition": 17}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a2d95068bd2a91accf6217e13c96a82be78bb1c2", "author": {"user": {"login": "TadCordle", "name": "Tad Cordle"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/a2d95068bd2a91accf6217e13c96a82be78bb1c2", "committedDate": "2020-05-06T18:18:56Z", "message": "Import"}}]}}}, "rateLimit": {"limit": 5000, "remaining": 231, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}