{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDQ5NjA5Nzk2", "number": 2586, "reviewThreads": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxODowNTozMlrOEOzGyg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1MTozMVrOEQTwGQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzOTUyODQyOnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxODowNTozMlrOGyJzWw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxODozNjo0OVrOGyK9zw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI0MjU4Nw==", "bodyText": "So a couple of things to keep in mind when doing this.\n\n\nDown below (retryOnException) is designed to retry this loop if a FileSystemException occurs. So we probably don't want to actually use this here.\n\n\nIn intellij you can search for classes and inspect their contents (ctrl-shift-n ?). If we take a look at FileSystemException there a few constructors in there. The single string constructor actually expects a file as the first parameter. (We're probably not going to use FileSystemException here because of earlier point)", "url": "https://github.com/GoogleContainerTools/jib/pull/2586#discussion_r455242587", "createdAt": "2020-07-15T18:05:32Z", "author": {"login": "loosebazooka"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "diffHunk": "@@ -88,7 +88,13 @@ private static void moveIfDoesNotExist(Path source, Path destination) throws IOE\n                     // previously-cached layer.\n                     return true;\n                   }\n-                  Files.move(source, destination);\n+                  try{\n+                    Files.move(source, destination);\n+                  } catch (FileSystemException e){\n+                    String message = \"Unable to copy file from %s to %s. This operation may not be supported by the\" +\n+                            \"file system.\";\n+                    throw new FileSystemException(message);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2087bee975b5f9fdc3c43c45c90af02ad7fdccc0"}, "originalPosition": 10}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI2MTY0Nw==", "bodyText": "Thanks for pointing that out! Moved this message down to the if (!success)) condition.", "url": "https://github.com/GoogleContainerTools/jib/pull/2586#discussion_r455261647", "createdAt": "2020-07-15T18:36:49Z", "author": {"login": "mpeddada1"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "diffHunk": "@@ -88,7 +88,13 @@ private static void moveIfDoesNotExist(Path source, Path destination) throws IOE\n                     // previously-cached layer.\n                     return true;\n                   }\n-                  Files.move(source, destination);\n+                  try{\n+                    Files.move(source, destination);\n+                  } catch (FileSystemException e){\n+                    String message = \"Unable to copy file from %s to %s. This operation may not be supported by the\" +\n+                            \"file system.\";\n+                    throw new FileSystemException(message);", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI0MjU4Nw=="}, "originalCommit": {"oid": "2087bee975b5f9fdc3c43c45c90af02ad7fdccc0"}, "originalPosition": 10}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjgzOTUzMjYzOnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "isResolved": false, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxODowNjozOVrOGyJ2AQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xNVQxODozNzoxM1rOGyK-oA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI0MzI2NQ==", "bodyText": "It's quite possible that instead of here, we show this message down at line 104 (if (!success)) as one of the possibilities that a move/copy failed.", "url": "https://github.com/GoogleContainerTools/jib/pull/2586#discussion_r455243265", "createdAt": "2020-07-15T18:06:39Z", "author": {"login": "loosebazooka"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "diffHunk": "@@ -88,7 +88,13 @@ private static void moveIfDoesNotExist(Path source, Path destination) throws IOE\n                     // previously-cached layer.\n                     return true;\n                   }\n-                  Files.move(source, destination);\n+                  try{\n+                    Files.move(source, destination);\n+                  } catch (FileSystemException e){", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2087bee975b5f9fdc3c43c45c90af02ad7fdccc0"}, "originalPosition": 7}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI2MTg1Ng==", "bodyText": "Good point, done.", "url": "https://github.com/GoogleContainerTools/jib/pull/2586#discussion_r455261856", "createdAt": "2020-07-15T18:37:13Z", "author": {"login": "mpeddada1"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "diffHunk": "@@ -88,7 +88,13 @@ private static void moveIfDoesNotExist(Path source, Path destination) throws IOE\n                     // previously-cached layer.\n                     return true;\n                   }\n-                  Files.move(source, destination);\n+                  try{\n+                    Files.move(source, destination);\n+                  } catch (FileSystemException e){", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI0MzI2NQ=="}, "originalCommit": {"oid": "2087bee975b5f9fdc3c43c45c90af02ad7fdccc0"}, "originalPosition": 7}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg0NzI0MjA3OnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMzoyNjozN1rOGzS75w==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0xN1QxMzoyNjozN1rOGzS75w==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQ0MDgwNw==", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                          \"unable to move: %s to %s; such failures are often caused by interference from antivirus or if the\" +\n          \n          \n            \n                                  \"operation is not supported by the file system\",\n          \n          \n            \n                          \"unable to move: %s to %s; such failures are often caused by interference from antivirus or if the \" +\n          \n          \n            \n                                  \"operation is not supported by the file system (for example, special non-local file system)\",", "url": "https://github.com/GoogleContainerTools/jib/pull/2586#discussion_r456440807", "createdAt": "2020-07-17T13:26:37Z", "author": {"login": "chanseokoh"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "diffHunk": "@@ -98,7 +98,8 @@ private static void moveIfDoesNotExist(Path source, Path destination) throws IOE\n     if (!success) {\n       String message =\n           String.format(\n-              \"unable to move: %s to %s; such failures are often caused by interference from antivirus\",\n+              \"unable to move: %s to %s; such failures are often caused by interference from antivirus or if the\" +\n+                      \"operation is not supported by the file system\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a1b33dcd75bf33cdd572a516aefca44f6fdce68d"}, "originalPosition": 6}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjg1NTM2MjgxOnYy", "diffSide": "RIGHT", "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "isResolved": false, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1MTozMVrOG0Y9qw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yMFQxNzo1MTozMVrOG0Y9qw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzU4ODEzOQ==", "bodyText": "Not sure about the formatting, should for example, -> for example:?", "url": "https://github.com/GoogleContainerTools/jib/pull/2586#discussion_r457588139", "createdAt": "2020-07-20T17:51:31Z", "author": {"login": "loosebazooka"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/cache/CacheStorageWriter.java", "diffHunk": "@@ -98,7 +98,8 @@ private static void moveIfDoesNotExist(Path source, Path destination) throws IOE\n     if (!success) {\n       String message =\n           String.format(\n-              \"unable to move: %s to %s; such failures are often caused by interference from antivirus\",\n+              \"unable to move: %s to %s; such failures are often caused by interference from antivirus or if the \"\n+                  + \"operation is not supported by the file system (for example, special non-local file system)\",", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "b3e5290e2e1fcce5655a403f035e45ed5eb8f71b"}, "originalPosition": 6}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 252, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}