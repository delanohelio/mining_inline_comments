{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDY1MDI5NTQw", "number": 2683, "title": "Add defaults to FilePropertiesStack", "bodyText": "The way we use FileEntriesLayer.addEntry requires non-null values to be entered. So work with defaults directly here, so we can always pass all properties to that method instead of complicated logic to determine based on null values which addEntry to call.", "createdAt": "2020-08-08T13:05:19Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2683", "merged": true, "mergeCommit": {"oid": "cf427cb70f0dc8b3d881033174d2df6fc0825a0b"}, "closed": true, "closedAt": "2020-08-11T19:04:54Z", "author": {"login": "loosebazooka"}, "timelineItems": {"totalCount": 6, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc9m_ZVAH2gAyNDY1MDI5NTQwOjZlNjUwMWQ5ZjIxNjhiZmFjNmEyNTQwNTlkYjhkMzkwODQyMDA4YWE=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc97gtFgFqTQ2NTM0MzA3MQ==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "6e6501d9f2168bfac6a254059db8d390842008aa", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/6e6501d9f2168bfac6a254059db8d390842008aa", "committedDate": "2020-08-10T19:01:06Z", "message": "Add defaults to FilePropertiesStack"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "cbacfaf70c4de4fd71545cf964eacb903a6db508", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/cbacfaf70c4de4fd71545cf964eacb903a6db508", "committedDate": "2020-08-10T19:01:06Z", "message": "remove unnecessary nullable"}}, {"__typename": "HeadRefForcePushedEvent", "beforeCommit": {"oid": "d9e1ebce86feccdc1d03b519f67a0de82e9e4034", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/d9e1ebce86feccdc1d03b519f67a0de82e9e4034", "committedDate": "2020-08-10T18:56:38Z", "message": "remove unnecessary nullable"}, "afterCommit": {"oid": "cbacfaf70c4de4fd71545cf964eacb903a6db508", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/cbacfaf70c4de4fd71545cf964eacb903a6db508", "committedDate": "2020-08-10T19:01:06Z", "message": "remove unnecessary nullable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY0NTQ1Mjcw", "url": "https://github.com/GoogleContainerTools/jib/pull/2683#pullrequestreview-464545270", "createdAt": "2020-08-10T20:08:28Z", "commit": {"oid": "cbacfaf70c4de4fd71545cf964eacb903a6db508"}, "state": "COMMENTED", "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMDowODoyOFrOG-dwSg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOC0xMFQyMToxNzowNVrOG-gG6A==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE1MjM5NA==", "bodyText": "Now that ownership is not nullable, How about\n  ownership = (user != null ? user : \"\") + (group != null ? \":\" + group : \"\")?\nor\n  ownership = user != null ? user : \"\";\n  if (group != null) {\n    ownership += \":\" + group;\n  }\n? Your preference.", "url": "https://github.com/GoogleContainerTools/jib/pull/2683#discussion_r468152394", "createdAt": "2020-08-10T20:08:28Z", "author": {"login": "chanseokoh"}, "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/buildfile/FilePropertiesStack.java", "diffHunk": "@@ -76,7 +86,9 @@ private void updateProperties() {\n       group = properties.getGroup().orElse(group);\n     }\n     // ownership calculations\n-    if (group == null) {\n+    if (group == null && user == null) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbacfaf70c4de4fd71545cf964eacb903a6db508"}, "originalPosition": 60}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE5MDk1Mg==", "bodyText": "Do we need another release? 0.5.0? I don't recall new changes since 0.4.0.", "url": "https://github.com/GoogleContainerTools/jib/pull/2683#discussion_r468190952", "createdAt": "2020-08-10T21:17:05Z", "author": {"login": "chanseokoh"}, "path": "jib-cli/src/main/java/com/google/cloud/tools/jib/cli/buildfile/FilePropertiesStack.java", "diffHunk": "@@ -34,10 +34,23 @@\n   // TODO perhaps use a fixed size list here\n   private final List<FilePropertiesSpec> stack = new ArrayList<>(3);\n \n-  @Nullable private FilePermissions filePermissions;\n-  @Nullable private FilePermissions directoryPermissions;\n-  @Nullable private Instant modificationTime;\n-  @Nullable private String ownership;\n+  private FilePermissions filePermissions;\n+  private FilePermissions directoryPermissions;\n+  private Instant modificationTime;\n+  private String ownership;\n+\n+  /** Create new FilePropertiesStack with defaults. */\n+  public FilePropertiesStack() {\n+    setDefaults();\n+  }\n+\n+  private void setDefaults() {\n+    filePermissions = FilePermissions.DEFAULT_FILE_PERMISSIONS;\n+    directoryPermissions = FilePermissions.DEFAULT_FOLDER_PERMISSIONS;\n+    modificationTime = FileEntriesLayer.DEFAULT_MODIFICATION_TIME;\n+    // TODO: get default from FileEntriesLayer (requires buildplan release)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "cbacfaf70c4de4fd71545cf964eacb903a6db508"}, "originalPosition": 37}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "055bb5ee788352bf959eed6a0a18c2009040dbf9", "author": {"user": {"login": "loosebazooka", "name": "Appu"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/055bb5ee788352bf959eed6a0a18c2009040dbf9", "committedDate": "2020-08-11T00:33:13Z", "message": "reorganize ownership computation"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY1MzQzMDcx", "url": "https://github.com/GoogleContainerTools/jib/pull/2683#pullrequestreview-465343071", "createdAt": "2020-08-11T18:55:35Z", "commit": {"oid": "055bb5ee788352bf959eed6a0a18c2009040dbf9"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4946, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}