{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0MzY3NjI0NjI1", "number": 2251, "reviewThreads": {"totalCount": 3, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxNzo1NzoxNlrODa-DSw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxODowNDowNFrODa-LdA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NjA2MjE5OnYy", "diffSide": "RIGHT", "path": "jib-maven-plugin/scripts/prepare_release.sh", "isResolved": true, "comments": {"totalCount": 2, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxNzo1NzoxNlrOFiL_2g==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxODowMjowMlrOFiMJFg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5MjQ3NA==", "bodyText": "Q: I put the GCS update stuff in a separate script since the maven release process takes some time. Should we just combine the scripts anyway and not worry about GCS reporting an unrelease version for a few minutes/hours?", "url": "https://github.com/GoogleContainerTools/jib/pull/2251#discussion_r371392474", "createdAt": "2020-01-27T17:57:16Z", "author": {"login": "TadCordle"}, "path": "jib-maven-plugin/scripts/prepare_release.sh", "diffHunk": "@@ -58,3 +58,4 @@ EchoGreen 'File a PR for the new release branch:'\n echo https://github.com/GoogleContainerTools/jib/pull/new/${BRANCH}\n \n EchoGreen \"Merge the PR after the plugin is released.\"\n+EchoGreen \"Run './scripts/update_gcs_latest ${VERSION}' when the release is complete to update the latest version string on GCS.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c60b66350c56d33a62d9166f8aa55fe3acd77f89"}, "originalPosition": 4}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5NDgzOA==", "bodyText": "I think we should update the version only after we verify a new release is available for consumption for both Gradle and Maven.\nAdd .sh.", "url": "https://github.com/GoogleContainerTools/jib/pull/2251#discussion_r371394838", "createdAt": "2020-01-27T18:02:02Z", "author": {"login": "chanseokoh"}, "path": "jib-maven-plugin/scripts/prepare_release.sh", "diffHunk": "@@ -58,3 +58,4 @@ EchoGreen 'File a PR for the new release branch:'\n echo https://github.com/GoogleContainerTools/jib/pull/new/${BRANCH}\n \n EchoGreen \"Merge the PR after the plugin is released.\"\n+EchoGreen \"Run './scripts/update_gcs_latest ${VERSION}' when the release is complete to update the latest version string on GCS.\"", "state": "SUBMITTED", "replyTo": {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5MjQ3NA=="}, "originalCommit": {"oid": "c60b66350c56d33a62d9166f8aa55fe3acd77f89"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NjA2ODA3OnYy", "diffSide": "RIGHT", "path": "jib-gradle-plugin/scripts/prepare_release.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxNzo1OToxNVrOFiMDkw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxNzo1OToxNVrOFiMDkw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5MzQyNw==", "bodyText": "update_gcs_latest.sh (add .sh)", "url": "https://github.com/GoogleContainerTools/jib/pull/2251#discussion_r371393427", "createdAt": "2020-01-27T17:59:15Z", "author": {"login": "chanseokoh"}, "path": "jib-gradle-plugin/scripts/prepare_release.sh", "diffHunk": "@@ -59,3 +59,4 @@ echo https://github.com/GoogleContainerTools/jib/pull/new/${BRANCH}\n \n EchoGreen \"Once approved, checkout the 'v${VERSION}-gradle' tag and run './gradlew jib-gradle-plugin:publishPlugins'.\"\n EchoGreen \"Merge the PR after the plugin is released.\"\n+EchoGreen \"Run './scripts/update_gcs_latest ${VERSION}' when the release is complete to update the latest version string on GCS.\"", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "c60b66350c56d33a62d9166f8aa55fe3acd77f89"}, "originalPosition": 4}]}}, {"id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5NjA4MzA4OnYy", "diffSide": "RIGHT", "path": "jib-gradle-plugin/scripts/update_gcs_latest.sh", "isResolved": true, "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxODowNDowNFrOFiMMzA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wMS0yN1QxODowNDowNFrOFiMMzA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTM5NTc4OA==", "bodyText": "I believe this is unnecessary and the file will be overwritten. This is safer in the case gsutil cp fails.", "url": "https://github.com/GoogleContainerTools/jib/pull/2251#discussion_r371395788", "createdAt": "2020-01-27T18:04:04Z", "author": {"login": "chanseokoh"}, "path": "jib-gradle-plugin/scripts/update_gcs_latest.sh", "diffHunk": "@@ -0,0 +1,42 @@\n+#!/bin/bash -\n+# Usage: ./scripts/update_gcs_latest.sh <release version>\n+\n+set -e\n+\n+EchoRed() {\n+\techo \"$(tput setaf 1; tput bold)$1$(tput sgr0)\"\n+}\n+EchoGreen() {\n+\techo \"$(tput setaf 2; tput bold)$1$(tput sgr0)\"\n+}\n+\n+Die() {\n+\tEchoRed \"$1\"\n+\texit 1\n+}\n+\n+# Usage: CheckVersion <version>\n+CheckVersion() {\n+    [[ $1 =~ ^[0-9]+\\.[0-9]+\\.[0-9]+(-[0-9A-Za-z]+)?$ ]] || Die \"Version: $1 not in ###.###.###[-XXX] format.\"\n+}\n+\n+[ $# -ne 1 ] && Die \"Usage: ./scripts/update_gcs_latest.sh <release version>\"\n+\n+CheckVersion $1\n+\n+versionString=\"{\\\"latest\\\":\\\"$1\\\"}\"\n+destination=\"gs://jib-versions/jib-gradle\"\n+\n+echo $versionString > jib-gradle\n+gsutil rm $destination", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "5c17fa310ecdfa1388d3e1b10a366bd337d8a6e9"}, "originalPosition": 31}]}}]}}}, "rateLimit": {"limit": 5000, "remaining": 477, "cost": 1, "resetAt": "2021-11-12T19:05:54Z"}}}