{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDkyMDY5NTgy", "number": 2783, "title": "Fix platform configuration in Gradle plugin", "bodyText": "Fixes #2781.\nWe started with the default amd64/linux, and we were always adding new platforms.", "createdAt": "2020-09-23T22:17:41Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2783", "merged": true, "mergeCommit": {"oid": "212cc8a372737cce901e01b6ae6b395ff77283de"}, "closed": true, "closedAt": "2020-09-24T18:44:54Z", "author": {"login": "chanseokoh"}, "timelineItems": {"totalCount": 9, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABdL0HdmgH2gAyNDkyMDY5NTgyOjVlZWRlNTFjMjhmNDI3MTViYTk2YmFmMjE1Y2Y1MjlhYWJmMzU5MDI=", "endCursor": "Y3Vyc29yOnYyOpPPAAABdMDvvLgFqTQ5NTc0NjcyNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "5eede51c28f42715ba96baf215cf529aabf35902", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/5eede51c28f42715ba96baf215cf529aabf35902", "committedDate": "2020-09-23T22:13:37Z", "message": "Fix platform configuration in Gradle plugin"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d97224ce6ff00d9e2b3b969671609dc34dac3e98", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/d97224ce6ff00d9e2b3b969671609dc34dac3e98", "committedDate": "2020-09-23T22:16:44Z", "message": "Remove dead code"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "1257b11ec821aac1ba963eb824fec5475dfad8af", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/1257b11ec821aac1ba963eb824fec5475dfad8af", "committedDate": "2020-09-23T22:21:37Z", "message": "CHANGELOG"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "a80b6daeb85f297aba9a5650a9490fe88727e8d4", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/a80b6daeb85f297aba9a5650a9490fe88727e8d4", "committedDate": "2020-09-23T22:30:52Z", "message": "code style"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1MTQ0OTM4", "url": "https://github.com/GoogleContainerTools/jib/pull/2783#pullrequestreview-495144938", "createdAt": "2020-09-24T00:34:47Z", "commit": {"oid": "a80b6daeb85f297aba9a5650a9490fe88727e8d4"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwMDozNDo0OFrOHXFvrA==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQwMDozNDo0OFrOHXFvrA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mzk3MzQyMA==", "bodyText": "It does feel a little weird that a getter is mutating things.", "url": "https://github.com/GoogleContainerTools/jib/pull/2783#discussion_r493973420", "createdAt": "2020-09-24T00:34:48Z", "author": {"login": "loosebazooka"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/BaseImageParameters.java", "diffHunk": "@@ -35,23 +35,32 @@\n   private final PlatformParametersSpec platformParametersSpec;\n   private final ListProperty<PlatformParameters> platforms;\n \n+  private final ObjectFactory objectFactory;\n+\n   @Inject\n   public BaseImageParameters(ObjectFactory objectFactory) {\n+    this.objectFactory = objectFactory;\n     auth = objectFactory.newInstance(AuthParameters.class, \"from.auth\");\n     platforms = objectFactory.listProperty(PlatformParameters.class).empty();\n     platformParametersSpec =\n         objectFactory.newInstance(PlatformParametersSpec.class, objectFactory, platforms);\n-\n-    PlatformParameters platform = new PlatformParameters();\n-    platform.setOs(\"linux\");\n-    platform.setArchitecture(\"amd64\");\n-    platforms.add(platform);\n   }\n \n   @Nested\n   @Optional\n   public ListProperty<PlatformParameters> getPlatforms() {\n-    return platforms;\n+    if (!platforms.get().isEmpty()) {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "a80b6daeb85f297aba9a5650a9490fe88727e8d4"}, "originalPosition": 24}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "d64c1ecb24ac47b3063e2e598334e4bc4ec959a2", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/d64c1ecb24ac47b3063e2e598334e4bc4ec959a2", "committedDate": "2020-09-24T14:27:29Z", "message": "Reset default platform when given \"platforms\" action"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "939c4ef72eda3489883f7b2116de10847e777276", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/939c4ef72eda3489883f7b2116de10847e777276", "committedDate": "2020-09-24T14:35:06Z", "message": "Remove unused variable"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1NjQxNjA1", "url": "https://github.com/GoogleContainerTools/jib/pull/2783#pullrequestreview-495641605", "createdAt": "2020-09-24T14:35:54Z", "commit": {"oid": "939c4ef72eda3489883f7b2116de10847e777276"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDozNTo1NFrOHXeCiw==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wOS0yNFQxNDozNTo1NFrOHXeCiw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDM3MTQ2Nw==", "bodyText": "empty() turns out to be unnecessary.", "url": "https://github.com/GoogleContainerTools/jib/pull/2783#discussion_r494371467", "createdAt": "2020-09-24T14:35:54Z", "author": {"login": "chanseokoh"}, "path": "jib-gradle-plugin/src/main/java/com/google/cloud/tools/jib/gradle/BaseImageParameters.java", "diffHunk": "@@ -38,14 +38,14 @@\n   @Inject\n   public BaseImageParameters(ObjectFactory objectFactory) {\n     auth = objectFactory.newInstance(AuthParameters.class, \"from.auth\");\n-    platforms = objectFactory.listProperty(PlatformParameters.class).empty();\n+    platforms = objectFactory.listProperty(PlatformParameters.class);", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "939c4ef72eda3489883f7b2116de10847e777276"}, "originalPosition": 5}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk1NzQ2NzI0", "url": "https://github.com/GoogleContainerTools/jib/pull/2783#pullrequestreview-495746724", "createdAt": "2020-09-24T16:26:11Z", "commit": {"oid": "939c4ef72eda3489883f7b2116de10847e777276"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4779, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}