{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0Mzk3NjE3Njk2", "number": 2380, "title": "Add Maven plugin extension API", "bodyText": "The main plugin extension point is through the following method signature. The focus is on the capability to adjust a build plan prepared by Jib plugins.\nContainerBuildPlan extendContainerBuildPlan(\n      ContainerBuildPlan buildPlan,\n      MavenProject project,\n      MavenSession session,\n      ExtensionLogger logger)\n      throws JibPluginExtensionException;\n\nJibPluginExtensionException is defined to allow extensions to propagate any problems during extension execution.\nExtensionLogger is to allow extensions to log to the console. Note it is not dependent on any of the logging facilities in jib-core.", "createdAt": "2020-04-02T14:33:10Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2380", "merged": true, "mergeCommit": {"oid": "847987f36bc1236b2627a0cf2d3605502d3cfe8b"}, "closed": true, "closedAt": "2020-04-08T21:08:30Z", "author": {"login": "chanseokoh"}, "timelineItems": {"totalCount": 5, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABcTtAAtgH2gAyMzk3NjE3Njk2OjI0NjVmZDViNWY2NmQwNDM2OTI0ZDBiZjlmMTkxYTBkNDdkMmRhNjU=", "endCursor": "Y3Vyc29yOnYyOpPPAAABcVuLg1AFqTM5MDMxOTE2Mw==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "2465fd5b5f66d0436924d0bf9f191a0d47d2da65", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/2465fd5b5f66d0436924d0bf9f191a0d47d2da65", "committedDate": "2020-04-02T14:16:23Z", "message": "Add extension API classes"}}, {"__typename": "PullRequestCommit", "commit": {"oid": "5bd5d3919bbb00bd1c6bef101bc59c1e5de93d96", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/5bd5d3919bbb00bd1c6bef101bc59c1e5de93d96", "committedDate": "2020-04-08T14:50:33Z", "message": "Merge branch 'master' into plugin-extension-java-src"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMTUyOTYw", "url": "https://github.com/GoogleContainerTools/jib/pull/2380#pullrequestreview-390152960", "createdAt": "2020-04-08T16:48:36Z", "commit": {"oid": "2465fd5b5f66d0436924d0bf9f191a0d47d2da65"}, "state": "COMMENTED", "comments": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjo0ODozN1rOGC3_VQ==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNC0wOFQxNjo1Mjo1OFrOGC4KaA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY2NzY2OQ==", "bodyText": "So we just inject an implementation of this that connects to the jib event system?", "url": "https://github.com/GoogleContainerTools/jib/pull/2380#discussion_r405667669", "createdAt": "2020-04-08T16:48:37Z", "author": {"login": "loosebazooka"}, "path": "jib-maven-plugin-extension-api/src/main/java/com/google/cloud/tools/jib/maven/extension/JibMavenPluginExtension.java", "diffHunk": "@@ -0,0 +1,49 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.maven.extension;\n+\n+import com.google.cloud.tools.jib.api.buildplan.ContainerBuildPlan;\n+import com.google.cloud.tools.jib.plugins.extension.ExtensionLogger;\n+import com.google.cloud.tools.jib.plugins.extension.JibPluginExtension;\n+import com.google.cloud.tools.jib.plugins.extension.JibPluginExtensionException;\n+import org.apache.maven.execution.MavenSession;\n+import org.apache.maven.project.MavenProject;\n+\n+/**\n+ * Jib Maven plugin extension API. If a class implementing the interface is visible on the classpath\n+ * of the Jib Maven plugin, the Jib plugin extension framework calls the interface method of the\n+ * class.\n+ */\n+public interface JibMavenPluginExtension extends JibPluginExtension {\n+\n+  /**\n+   * Extends the build plan prepared by the Jib Maven plugin.\n+   *\n+   * @param buildPlan original build plan prepared by the Jib Maven plugin\n+   * @param project the {@link MavenProject}\n+   * @param session the {@link MavenSession}\n+   * @param logger logger for writing log messages\n+   * @return updated build plan\n+   * @throws JibPluginExtensionException if an error occurs while running the plugin extension\n+   */\n+  ContainerBuildPlan extendContainerBuildPlan(\n+      ContainerBuildPlan buildPlan,\n+      MavenProject project,\n+      MavenSession session,\n+      ExtensionLogger logger)", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2465fd5b5f66d0436924d0bf9f191a0d47d2da65"}, "originalPosition": 47}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY2ODQ4MA==", "bodyText": "this is used just to indentify the services to load?", "url": "https://github.com/GoogleContainerTools/jib/pull/2380#discussion_r405668480", "createdAt": "2020-04-08T16:49:48Z", "author": {"login": "loosebazooka"}, "path": "jib-plugins-extension-common/src/main/java/com/google/cloud/tools/jib/plugins/extension/JibPluginExtension.java", "diffHunk": "@@ -0,0 +1,20 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.plugins.extension;\n+\n+/** Base type for Jib plugin extensions. */\n+public interface JibPluginExtension {}", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2465fd5b5f66d0436924d0bf9f191a0d47d2da65"}, "originalPosition": 20}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY2ODk2Nw==", "bodyText": "It doesn't feel like ExecutionException is the right Exception to extend? Do we even need to really extend an exception like this?", "url": "https://github.com/GoogleContainerTools/jib/pull/2380#discussion_r405668967", "createdAt": "2020-04-08T16:50:29Z", "author": {"login": "loosebazooka"}, "path": "jib-plugins-extension-common/src/main/java/com/google/cloud/tools/jib/plugins/extension/JibPluginExtensionException.java", "diffHunk": "@@ -0,0 +1,59 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.plugins.extension;\n+\n+import java.util.concurrent.ExecutionException;\n+\n+/** Exception while running Jib plugin extensions. */\n+public class JibPluginExtensionException extends ExecutionException {", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2465fd5b5f66d0436924d0bf9f191a0d47d2da65"}, "originalPosition": 22}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTY3MDUwNA==", "bodyText": "Instead of MavenProject, MavenSession should we send a MavenStuff (not Stuff but something like that) that contains anything from Maven that we inject?\nIf we ever extend this out to include to more Maven things, like stuff from the Reactor or something, then we can just add them to MavenStuff without changing the API and older extensions will continue to work?", "url": "https://github.com/GoogleContainerTools/jib/pull/2380#discussion_r405670504", "createdAt": "2020-04-08T16:52:58Z", "author": {"login": "loosebazooka"}, "path": "jib-maven-plugin-extension-api/src/main/java/com/google/cloud/tools/jib/maven/extension/JibMavenPluginExtension.java", "diffHunk": "@@ -0,0 +1,49 @@\n+/*\n+ * Copyright 2020 Google LLC.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n+ * use this file except in compliance with the License. You may obtain a copy of\n+ * the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n+ * License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+\n+package com.google.cloud.tools.jib.maven.extension;\n+\n+import com.google.cloud.tools.jib.api.buildplan.ContainerBuildPlan;\n+import com.google.cloud.tools.jib.plugins.extension.ExtensionLogger;\n+import com.google.cloud.tools.jib.plugins.extension.JibPluginExtension;\n+import com.google.cloud.tools.jib.plugins.extension.JibPluginExtensionException;\n+import org.apache.maven.execution.MavenSession;\n+import org.apache.maven.project.MavenProject;\n+\n+/**\n+ * Jib Maven plugin extension API. If a class implementing the interface is visible on the classpath\n+ * of the Jib Maven plugin, the Jib plugin extension framework calls the interface method of the\n+ * class.\n+ */\n+public interface JibMavenPluginExtension extends JibPluginExtension {\n+\n+  /**\n+   * Extends the build plan prepared by the Jib Maven plugin.\n+   *\n+   * @param buildPlan original build plan prepared by the Jib Maven plugin\n+   * @param project the {@link MavenProject}\n+   * @param session the {@link MavenSession}\n+   * @param logger logger for writing log messages\n+   * @return updated build plan\n+   * @throws JibPluginExtensionException if an error occurs while running the plugin extension\n+   */\n+  ContainerBuildPlan extendContainerBuildPlan(\n+      ContainerBuildPlan buildPlan,\n+      MavenProject project,", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "2465fd5b5f66d0436924d0bf9f191a0d47d2da65"}, "originalPosition": 45}]}}, {"__typename": "PullRequestCommit", "commit": {"oid": "ab59c73e0c7303009b78776bc9d8ab3f5353df40", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/ab59c73e0c7303009b78776bc9d8ab3f5353df40", "committedDate": "2020-04-08T20:43:04Z", "message": "MavenData and remove ExecutionException"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3MzkwMzE5MTYz", "url": "https://github.com/GoogleContainerTools/jib/pull/2380#pullrequestreview-390319163", "createdAt": "2020-04-08T20:46:42Z", "commit": {"oid": "ab59c73e0c7303009b78776bc9d8ab3f5353df40"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 182, "cost": 1, "resetAt": "2021-11-01T14:20:25Z"}}}