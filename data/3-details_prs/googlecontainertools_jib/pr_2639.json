{"data": {"repository": {"pullRequest": {"id": "MDExOlB1bGxSZXF1ZXN0NDU4MDgzOTIx", "number": 2639, "title": "(Merging to PR #2634) update code styles in PR #2634", "bodyText": "", "createdAt": "2020-07-28T22:06:55Z", "url": "https://github.com/GoogleContainerTools/jib/pull/2639", "merged": true, "mergeCommit": {"oid": "463b2e8734f658f46271a2b1cdfaac75b98c1582"}, "closed": true, "closedAt": "2020-07-28T22:19:03Z", "author": {"login": "louismurerwa"}, "timelineItems": {"totalCount": 4, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpPPAAABc5dx4pAH2gAyNDU4MDgzOTIxOjU2OGRiNzFjMWMyNjc4MGE5NmY2YmZmYmY5MmQ5ZjAwNWY0MDc1MzQ=", "endCursor": "Y3Vyc29yOnYyOpPPAAABc5eA3oAFqTQ1NzA2NzkwNA==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"__typename": "PullRequestCommit", "commit": {"oid": "568db71c1c26780a96f6bffbf92d9f005f407534", "author": {"user": {"login": "chanseokoh", "name": "Chanseok Oh"}}, "url": "https://github.com/GoogleContainerTools/jib/commit/568db71c1c26780a96f6bffbf92d9f005f407534", "committedDate": "2020-07-28T22:01:30Z", "message": "Update code"}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MDY1Mjc3", "url": "https://github.com/GoogleContainerTools/jib/pull/2639#pullrequestreview-457065277", "createdAt": "2020-07-28T22:12:21Z", "commit": {"oid": "568db71c1c26780a96f6bffbf92d9f005f407534"}, "state": "COMMENTED", "comments": {"totalCount": 1, "pageInfo": {"startCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMjoxMjoyMVrOG4hbLg==", "endCursor": "Y3Vyc29yOnYyOpK0MjAyMC0wNy0yOFQyMjoxMjoyMVrOG4hbLg==", "hasNextPage": false, "hasPreviousPage": false}, "nodes": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTkyMTA3MA==", "bodyText": "This is some clever implementation right here", "url": "https://github.com/GoogleContainerTools/jib/pull/2639#discussion_r461921070", "createdAt": "2020-07-28T22:12:21Z", "author": {"login": "louismurerwa"}, "path": "jib-core/src/main/java/com/google/cloud/tools/jib/builder/steps/PullBaseImageStep.java", "diffHunk": "@@ -187,35 +189,33 @@ public ImagesAndRegistryClient call()\n    * @throws BadContainerConfigurationFormatException if the container configuration is in a bad\n    *     format\n    */\n-  private ImagesAndRegistryClient pullBaseImages(\n+  private List<Image> pullBaseImages(\n       RegistryClient registryClient, ProgressEventDispatcher progressEventDispatcher)\n       throws IOException, RegistryException, LayerPropertyNotFoundException,\n           LayerCountMismatchException, BadContainerConfigurationFormatException {\n-    List<Image> images = new ArrayList<>();\n-\n     ManifestAndDigest<?> manifestAndDigest =\n         registryClient.pullManifest(buildContext.getBaseImageConfiguration().getImageQualifier());\n     ManifestTemplate manifestTemplate = manifestAndDigest.getManifest();\n \n-    // special handling if we happen upon a manifest list, extract manifests handle them normally\n+    // If a manifest list, search for the manifests matching the given platforms.\n     if (manifestTemplate instanceof V22ManifestListTemplate) {\n-      Set<Platform> platforms = buildContext.getContainerConfiguration().getPlatforms();\n-      for (Platform platform : platforms) {\n+      List<Image> images = new ArrayList<>();\n+\n+      for (Platform platform : buildContext.getContainerConfiguration().getPlatforms()) {\n         manifestAndDigest =\n             obtainPlatformSpecificImageManifest(\n                 registryClient, (V22ManifestListTemplate) manifestTemplate, platform);\n         images.add(jsonManifestToImage(manifestAndDigest, registryClient, progressEventDispatcher));\n       }\n-\n-    } else {\n-      images.add(jsonManifestToImage(manifestAndDigest, registryClient, progressEventDispatcher));\n+      return images;\n     }\n \n-    return new ImagesAndRegistryClient(images, registryClient);\n+    return Collections.singletonList(\n+        jsonManifestToImage(manifestAndDigest, registryClient, progressEventDispatcher));", "state": "SUBMITTED", "replyTo": null, "originalCommit": {"oid": "568db71c1c26780a96f6bffbf92d9f005f407534"}, "originalPosition": 85}]}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MDY1NTA0", "url": "https://github.com/GoogleContainerTools/jib/pull/2639#pullrequestreview-457065504", "createdAt": "2020-07-28T22:12:51Z", "commit": {"oid": "568db71c1c26780a96f6bffbf92d9f005f407534"}, "state": "COMMENTED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}, {"__typename": "PullRequestReview", "id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDU3MDY3OTA0", "url": "https://github.com/GoogleContainerTools/jib/pull/2639#pullrequestreview-457067904", "createdAt": "2020-07-28T22:17:52Z", "commit": {"oid": "568db71c1c26780a96f6bffbf92d9f005f407534"}, "state": "APPROVED", "comments": {"totalCount": 0, "pageInfo": {"startCursor": null, "endCursor": null, "hasNextPage": false, "hasPreviousPage": false}, "nodes": []}}]}}}, "rateLimit": {"limit": 5000, "remaining": 4898, "cost": 1, "resetAt": "2021-11-01T14:51:55Z"}}}